import{a as Eo,b as Es,i as Ir,I as YP,c as QP,_ as Rf,e as cs,f as Qo,r as en,g as ub,h as db,j as XP,k as ZP,l as JP,m as ex,n as zI,o as tx,q as rx}from"./core-modules-BzDo6MtP.js";import{V as ox}from"./v2-ui-BJrcNSEM.js";import{r as nx,d as ax,c as ix}from"./data-So-wGb1N.js";import"./vendor-BnBlqqbr.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();const _W=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),sx="#001589",lx="#ffffff";let FC=!1;function oi(e,t){try{if(t&&t.localStorage)return t.localStorage.getItem(e);if(typeof window<"u"&&window.localStorage)return window.localStorage.getItem(e)}catch(r){FC||(console.warn("Unable to read localStorage preference",r),FC=!0)}return null}function cx(e,t){if(!t)return;const r=t.querySelector('meta[name="theme-color"]');r&&r.setAttribute("content",e?"#1c1c1e":"#f9f9f9")}function ux(e,t,r){if(!t)return;const o=t.classList.contains("high-contrast")||r&&r.classList.contains("high-contrast"),n=o?lx:e;t.style.setProperty("--accent-color",n),o?t.style.removeProperty("--link-color"):t.style.setProperty("--link-color",e),t.style.setProperty("--logo-background-color",n),t.style.setProperty("--logo-accent-color",n),r&&(r.style.setProperty("--accent-color",n),o?r.style.removeProperty("--link-color"):r.style.setProperty("--link-color",e),r.style.setProperty("--logo-background-color",n),r.style.setProperty("--logo-accent-color",n))}function dx({darkEnabled:e,pinkEnabled:t}){return t?e?"pink-dark":"pink-light":e?"dark":"light"}function fx(e,t,r,o){const n=dx({darkEnabled:e,pinkEnabled:t});r&&typeof r.setAttribute=="function"&&r.setAttribute("data-theme",n),o&&typeof o.setAttribute=="function"&&o.setAttribute("data-theme",n)}function NC(e=window){if(typeof document>"u")return;const t=document.documentElement,r=document.body,o=oi("highContrast",e)==="true";t&&t.classList.toggle("high-contrast",o),r&&r.classList.toggle("high-contrast",o);let n=oi("reduceMotion",e);n===null&&e&&typeof e.matchMedia=="function"&&(n=e.matchMedia("(prefers-reduced-motion: reduce)").matches?"true":"false");const a=n==="true";t&&t.classList.toggle("reduce-motion",a),r&&r.classList.toggle("reduce-motion",a);const i=oi("relaxedSpacing",e)==="true";t&&t.classList.toggle("relaxed-spacing",i),r&&r.classList.toggle("relaxed-spacing",i);let s=oi("cameraPowerPlanner_pinkMode",e);(s==null||s==="")&&(s=oi("pinkMode",e));const u=s==="true";t&&t.classList.toggle("pink-mode",u),r&&r.classList.toggle("pink-mode",u);const l=oi("fontSize",e);l&&t&&(t.style.fontSize=l+"px");const d=oi("fontFamily",e);d&&t&&t.style.setProperty("--font-family",d);let p=oi("darkMode",e);p===null&&e&&typeof e.matchMedia=="function"&&(p=e.matchMedia("(prefers-color-scheme: dark)").matches?"true":"false");const g=p==="true";t&&(t.classList.toggle("dark-mode",g),t.classList.toggle("light-mode",!g)),r&&(r.classList.toggle("dark-mode",g),r.classList.toggle("light-mode",!g)),cx(g,document),fx(g,u,t,r);const A=oi("accentColor",e)||sx;u?(t&&(t.style.removeProperty("--accent-color"),t.style.removeProperty("--link-color"),t.style.removeProperty("--logo-background-color"),t.style.removeProperty("--logo-accent-color")),r&&(r.style.removeProperty("--accent-color"),r.style.removeProperty("--link-color"),r.style.removeProperty("--logo-background-color"),r.style.removeProperty("--logo-accent-color"))):ux(A,t,r)}(function(){const e=typeof window<"u"?window:void 0;NC(e),typeof document<"u"&&document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",()=>NC(e))})();function rv(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function px(e){if(typeof structuredClone=="function")return structuredClone;const t=e||Eo();return t&&typeof t.structuredClone=="function"?t.structuredClone.bind(t):null}function UI(e){const t=px(e);return t?function(o){if(o===null||typeof o!="object")return o;try{return t(o)}catch{}return rv(o)}:rv}function $I(e){const t=e||Eo();if(t&&typeof t.__cineDeepClone=="function")return t.__cineDeepClone;const r=UI(t);return t&&typeof t=="object"&&Es(t,"__cineDeepClone",r),r}const mx=$I(),Ma=Eo();function Ja(){return Eo()}function gy(e,t){if(!e)return;const r=Eo();if(!r)return typeof t=="function"?t():t;if(typeof r[e]<"u")return r[e];const o=typeof t=="function"?t():t;return Es(r,e,o),o}const gx=rv,yx=UI,vc=mx,bx={getCoreGlobalObject:Ja,ensureCoreGlobalValue:gy,jsonDeepClone:gx,createResilientDeepClone:yx,ensureDeepClone:$I,CORE_DEEP_CLONE:vc,CORE_GLOBAL_SCOPE:Ma};Ma&&(Ma.cineCoreRuntimeGlobalTools||(Ma.cineCoreRuntimeGlobalTools=bx),Ma.ensureCoreGlobalValue||(Ma.ensureCoreGlobalValue=gy),Ma.getCoreGlobalObject||(Ma.getCoreGlobalObject=Ja),Ma.CORE_DEEP_CLONE||(Ma.CORE_DEEP_CLONE=vc));typeof window<"u"&&(console.log("[Vite Global Patches] Applying global shims..."),window.getCoreGlobalObject=Ja,window.CORE_GLOBAL_SCOPE=window,window.iconGlyph=Ir,window.ICON_GLYPHS=YP,window.iconMarkup=QP,typeof window.CORE_RUNTIME_CANDIDATE_SCOPES>"u"&&(window.CORE_RUNTIME_CANDIDATE_SCOPES=null),typeof window.CORE_RUNTIME_STATE_SUPPORT>"u"&&(window.CORE_RUNTIME_STATE_SUPPORT=null),console.log("[Vite Global Patches] Shims applied."));function fl(e,t,r){if(!e.document)return;const o=e.document.getElementById(t);if(o&&o.options.length<=1)try{e.populateSelect(o,r),console.log(`[ForcePopulate] Populated ${t} with ${Object.keys(r).length} items`)}catch(n){console.error(`[ForcePopulate] Failed to populate ${t}`,n)}}function HC(e,t){if(!e||!e.devices||!e.populateSelect)return console.log("[ForcePopulate] Waiting for dependencies..."),!1;console.log("[ForcePopulate] Dependencies ready. Populating...");const r=e.devices;if(r.cameras&&fl(e,"cameraSelect",r.cameras),r.monitors&&fl(e,"monitorSelect",r.monitors),r.video&&fl(e,"videoSelect",r.video),r.batteries&&fl(e,"batterySelect",r.batteries),r.batteryHotswaps&&fl(e,"batteryHotswapSelect",r.batteryHotswaps),r.fiz&&["motor1Select","motor2Select","motor3Select","motor4Select","controller1Select","controller2Select","controller3Select","controller4Select"].forEach(o=>{fl(e,o,r.fiz)}),typeof e.processCoreBootQueue=="function")console.log("[ForcePopulate] Triggering boot queue processing..."),e.processCoreBootQueue();else if(e.CORE_BOOT_QUEUE&&e.CORE_BOOT_QUEUE.length>0){console.warn("[ForcePopulate] processCoreBootQueue not found, manually draining queue...");const o=e.CORE_BOOT_QUEUE;o.splice(0,o.length).forEach(a=>{try{a()}catch{}})}if(console.log("[ForcePopulate] Dismissing loading overlay..."),e.document){const o=e.document.getElementById("cineGlobalLoadingIndicator");o&&(o.style.display="none",o.setAttribute("aria-hidden","true")),e.document.body&&e.document.body.classList.add("app-ready")}console.log("[ForcePopulate] Initializing V2 Bootstrap...");try{t&&typeof t.init=="function"&&t.init()}catch(o){console.error("[ForcePopulate] V2 Bootstrap init failed",o)}try{e.dispatchEvent&&typeof CustomEvent=="function"&&e.dispatchEvent(new CustomEvent("cine-loader-complete"))}catch(o){console.error(o)}return!0}function hx(e,t,r=100){if(!(typeof e>"u")&&(console.log("[ForcePopulate] Script loaded (Module)"),!HC(e,t))){const o=setInterval(()=>{HC(e,t)&&clearInterval(o)},r);return o}}(function(){const e=typeof window<"u"?window:void 0;e&&hx(e,ox)})();const Sx={texts:{appTitle:"Cine Power Planner",tagline:"Plan your film rig and calculate power consumption & battery life.",printPreview:{title:"Print & Export",closeLabel:"Close Preview",layoutModeTitle:"Layout Mode",layoutRentalLabel:"Rental Friendly",layoutRentalDescription:"Optimizes layout for rental by grouping items by category.",sectionsTitle:"Sections",sectionProject:"Production Requirements",sectionDevices:"Camera Package Devices",sectionDiagram:"Power Diagram",sectionGearList:"Kit List",sectionBattery:"Battery Comparison",exportPdfButton:"Export PDF",printButton:"Print",generatedTitle:"Overview",generatedProjectNameLabel:"Project Name:",generatedProductionLabel:"Production:",generatedDateLabel:"Date:",generatedNoProjectRequirements:"No production requirements data.",generatedDeviceSelectionTitle:"Camera Package Devices",generatedNoDevicesSelected:"No devices selected.",generatedPowerDiagramTitle:"Power Diagram",generatedPowerSummaryTitle:"Power Summary",generatedGearListTitle:"Kit List",generatedTotalLoad:"Total Load",generatedPeak:"Peak:",generatedEstRuntime:"Est. Runtime",generatedWith:"w/",generatedDailyNeeds:"Daily Needs",generatedBatts:"Batts",generatedFor12hDay:"for 12h day"},skipToContent:"Skip to content",offlineIndicator:"Offline",offlineIndicatorHelp:"Appears when the planner is offline or the service worker reports degraded connectivity. All projects, backups and device data stay stored on this device so you can keep working. Force reload and other network actions stay disabled until connectivity recovers.",offlineIndicatorDegraded:"Connectivity degraded — working from cached copy.",offlineIndicatorDegradedHelp:"The service worker served cached content after a failed probe. Continue working from the offline copy and retry once the banner clears.",offlineIndicatorReasonCacheFallback:"Service worker served the cached bundle after a network error.",offlineIndicatorReasonGetFailed:"Network request for the reload check failed.",offlineIndicatorReasonTimeout:"Connectivity probe timed out before the server responded.",offlineIndicatorReasonUnreachable:"The probe could not reach the server.",offlineIndicatorReasonReloadBlocked:"Reload is paused until a healthy connection is confirmed.",offlineIndicatorReasonUnknown:"Connectivity degraded. Keep working offline until the banner clears.",globalLoadingIndicator:"Loading data…",globalLoadingIndicatorPreparing:"Preparing planner…",globalLoadingIndicatorModules:"Loading planner interface…",globalLoadingIndicatorData:"Loading planner data…",globalLoadingIndicatorAlmostReady:"Almost ready…",installBannerText:"Install Cine Power Planner on your device for quick access.",installBannerDismiss:"Dismiss",installHelpTitleIos:"Install Cine Power Planner on iOS",installHelpTitleAndroid:"Install Cine Power Planner on Android",installHelpIntroIos:"Add the planner to your Home Screen to use it like an app.",installHelpIntroAndroid:"Add the planner to your Home Screen to use it like an app.",installHelpStepsIos:["Open Cine Power Planner in Safari.","Tap the Share button.","Choose Add to Home Screen and confirm."],installHelpStepsAndroid:["Open Cine Power Planner in Chrome.","Tap the browser menu (⋮).","Choose Add to Home Screen and confirm."],installHelpNoteIos:"Once installed, launch Cine Power Planner from your Home Screen.",installHelpNoteAndroid:"Android keeps using the same storage for the browser and the installed app, so your projects stay available.",installHelpMigrationTitle:"Move your existing data into the app",installHelpClose:"Close",iosPwaHelpTitle:"Keep your data when installing on iOS",iosPwaHelpIntro:"Safari keeps the browser tab and the installed app separate. To move your Cine Power Planner data into the app:",iosPwaHelpStep1:"Open Cine Power Planner in Safari where your projects are still visible.",iosPwaHelpStep2:"Go to Settings → Backup & Restore → Backup to download a copy of your data.",iosPwaHelpStep3:"Open Cine Power Planner from your home screen.",iosPwaHelpStep4:"Go to Settings → Backup & Restore → Restore and pick the backup file.",iosPwaHelpNote:"After restoring once, all changes stay inside the installed app. Keep the backup if you plan to reinstall or switch devices.",iosPwaHelpClose:"Got it",impressum:"Imprint",privacy:"Privacy Policy",setupManageHeading:"Project Overview",deviceSelectionHeading:"Camera Package",overviewDeviceSelectionHeading:"Camera Package Devices",resultsHeading:"Power Summary",deviceManagerHeading:"Device Library",batteryComparisonHeading:"Battery Comparison",batteryComparisonDescription:"Review every compatible battery to see runtime estimates for your current setup.",batteryComparisonDescriptionHelp:"This table lists every compatible battery and updates as you change your setup. Hover any heading to learn what the numbers represent.",batteryComparisonTableHelp:"Rows show compatible batteries. Runtime includes current draw calculations, and the colored bar compares runtime length at a glance.",setupDiagramHeading:"Power Diagram",diagramPdfNote:"The Power Diagram is not included in the PDF export. Open the print view to review the layout.",projectRequirementsNav:"Production Requirements",projectRequirementsNavHelp:"Jump to the Production Requirements output once generated.",gearListNav:"Kit List",gearListNavHelp:"View the generated kit list with all items and categories.",ownGearNav:"Own Gear",ownGearNavHelp:"Track personal gear you already have on hand and reuse it across projects.",overviewExportTitleSuffix:"Kit List and Production Requirements",openSettingsNav:"Settings",openSettingsNavHelp:"Open Settings to adjust language, themes, accessibility options and backups.",openHelpNav:"Help Center",openHelpNavHelp:"Open the in-app help guide with tutorials, troubleshooting tips and shortcuts.",setupManageHeadingHelp:"Manage saved projects: save, load, or clear configurations.",deviceSelectionHeadingHelp:"Choose cameras, monitors, and accessories for your camera package.",resultsHeadingHelp:"See power consumption, estimated runtime, and battery counts.",resultsPlainSummaryTitle:"Quick summary",resultsPlainSummaryHelp:"Explains the power summary in plain language so you can confirm runtime and battery needs without reading every table.",resultsPlainSummaryPrompt:"Add devices and choose a battery to see a plain-language summary of runtime and consumption.",resultsPlainSummaryNeedBattery:"Choose a battery to see how long the rig will run and how many packs to pack.",resultsPlainSummaryRuntime:"With {batteryName}, expect about {hours} hours of runtime. Pack {batteryCount} batteries for a 10-hour day. Your rig currently draws {totalPower} W.",resultsPlainSummaryUnlimited:"With {batteryName}, your rig draws {totalPower} W, so runtime stays unlimited. Keep a charged pack connected before recording.",resultsPlainSummaryNote:"Pins and D-Tap status updates as you add gear.",resultsPlainSummaryPinsZero:"Pins: no 12V draw yet.",resultsPlainSummaryPinsOk:"Pins: {current}A within the {max}A limit.",resultsPlainSummaryPinsNear:"Pins: {current}A is close to the {max}A limit.",resultsPlainSummaryPinsExceeded:"Pins: {current}A exceeds the {max}A limit.",resultsPlainSummaryPinsUnknown:"Pins: draw is {current}A but no limit is documented.",resultsPlainSummaryDtapZero:"D-Tap: idle.",resultsPlainSummaryDtapOk:"D-Tap: {current}A within the {max}A rating.",resultsPlainSummaryDtapNear:"D-Tap: {current}A is close to the {max}A rating.",resultsPlainSummaryDtapExceeded:"D-Tap: {current}A exceeds the {max}A rating.",resultsPlainSummaryDtapUnavailable:"D-Tap: auxiliary port disabled for this battery selection.",resultsPlainSummaryDtapUnavailableBMount:"D-Tap: B-Mount cameras disable the aux port.",resultsPlainSummaryDtapUnknown:"D-Tap: rating missing, treat {current}A with caution.",resultsPlainSummaryUnnamedBattery:"your selected battery",deviceManagerHeadingHelp:"Add, edit or remove entries from the device database, including categories, subcategories and attributes.",batteryComparisonHeadingHelp:"Compare runtimes for all compatible batteries.",batteryTableBatteryHelp:"Battery name and mount that can power your current build.",batteryTableRuntimeHelp:"Estimated runtime in hours plus which outputs supply enough current.",batteryTableGraphLabel:"Runtime comparison bar",batteryTableGraphHelp:"Bar length compares runtime across batteries. Green covers pins and D-Tap, orange means only main pins, and blue marks infinite runtime estimates.",setupDiagramHeadingHelp:"View the Power Diagram showing how power, video, and control connect across the rig.",setupDiagramPlaceholder:"Select devices to visualize the project.",diagramLegendPower:"Power",diagramLegendVideo:"Video",diagramLegendFIZ:"FIZ",downloadDiagramBtn:"Download Power Diagram",gridSnapToggle:"Snap to Grid",existingDevicesHeading:"Existing Devices",deviceLibrarySearchLabel:"Search entire library",deviceLibrarySearchPlaceholder:"Search all device categories…",deviceLibrarySearchHelp:"Filter across every category at once. Press Enter to jump to the closest match.",deviceLibrarySearchStatusDefault:"Showing all {total} devices.",deviceLibrarySearchResultOne:"Showing {visible} of {total} devices.",deviceLibrarySearchResultOther:"Showing {visible} of {total} devices.",deviceLibrarySearchNoResults:"No devices match “{query}”.",darkModeLabel:"Toggle dark mode",themeVariantLabel:"Theme",themeVariantHelp:"Switch between light, dark, pink light, and pink dark themes.",themeVariantLight:"Light",themeVariantDark:"Dark",themeVariantPinkLight:"Pink Light",themeVariantPinkDark:"Pink Dark",existingDevicesSubtitle:"Browse and manage devices in your library",existingDevicesTitle:"Existing Devices",addDeviceSubtitle:"Create a custom device entry for your database",addNewDeviceTitle:"Add New Device",tabBrowseLibrary:"Browse Library",tabAddDevice:"Add Device",deviceLibrarySubtitle:"Add, edit, and manage devices in your local database",deviceLibraryTitle:"Device Library",v2ui:{revision:"REV.02"},pinkModeLabel:"Toggle pink mode",menuToggleLabel:"Menu",menuToggleHelp:"Open the sidebar to jump between planner sections or reveal controls on smaller screens. Click again to close it.",sideMenuTitle:"Planner sections",sideMenuTitleHelp:"Swipe up to explore planner sections and mobile controls. Your project keeps saving automatically while you browse.",sideMenuClose:"Close navigation",sideMenuCloseHelp:"Close the navigation drawer and return to the planner. Your data stays saved and ready to restore if needed.",sideMenuHelp:"Sidebar navigation listing planner sections. Select a section to scroll there and the menu closes automatically.",contacts:{heading:"Contacts",description:"Save crew members once, keep them stored offline and reuse them for every project.",addContactButton:"Add contact",importButton:"Import vCard",importHint:"Import .vcf files to add contacts instantly. Existing details are preserved automatically.",emptyState:"No contacts saved yet. Add your crew to reuse them later.",close:"Close",selectLabel:"Saved contacts",selectPlaceholder:"Select contact",saveContact:"Save to contacts",openManager:"Open contacts",linkedBadge:"Linked to contact",linkedProfileBadge:"Linked to user profile",contactMissingDetails:"Enter a name, email, phone number or website before saving this contact.",websiteLabel:"Website",websitePlaceholder:"https://example.com",avatarOptionsTitle:"Photo options",avatarOptionsDescription:"Preview this photo, choose how to update it, or click outside the window to save and close.",avatarOptionsClose:"Close",avatarDelete:"Delete photo",avatarEditAction:"Edit framing",avatarChange:"Change photo",avatarCleared:"Profile photo removed.",avatarTooLarge:"Choose an image under 300 KB.",avatarReadError:"Could not read the selected image.",avatarUpdated:"Profile photo updated.",avatarEditInstructions:"Drag the photo to adjust the framing.",avatarEditZoomLabel:"Zoom",avatarEditCancel:"Cancel",avatarEditApply:"Apply framing",avatarMissingImage:"Add a photo before editing.",avatarEditUnavailable:"Photo editor unavailable.",avatarEditFailed:"Could not update the photo framing.",userProfileHeading:"Your profile",userProfileDescription:"Add your name, role, phone and email so your gear shows as “User”.",userProfileNameLabel:"Display name",userProfileNamePlaceholder:"Your name",userProfileRoleLabel:"Role or title",userProfileRolePlaceholder:"Select role",userProfilePhoneLabel:"Phone number",userProfilePhonePlaceholder:"Your phone number",userProfileEmailLabel:"Email address",userProfileEmailPlaceholder:"name@example.com",userProfileHint:"Used to show your first name and last initial for the “User” option in the provided by dropdown. Phone and email appear on exports and backups so crews can reach you offline.",userProfileAvatarButton:"Change photo",userProfileAvatarRemove:"Remove photo",userProfileSaved:"Profile saved.",contactDetached:"Crew row disconnected from saved contact.",contactApplied:"Crew row updated from contact.",contactDeleted:"Contact removed. Project rows keep their details.",contactSaved:"Contact saved for future projects.",contactUpdated:"Contact updated.",contactDraftCreated:"New contact ready. Fill in the details.",contactFallbackName:"Crew contact",useInProject:"Add to project crew",contactAddedToProject:"Contact added to the current project.",deleteContact:"Delete contact",deleteConfirm:"Remove this contact? Project rows will keep their details.",importSummary:"{added} added, {updated} updated.",importNone:"No new contacts found in the file.",importError:"Could not import the selected file.",rolePlaceholder:"Select role"},featureSearchPlaceholder:"Search features, devices, actions, or help...",featureSearchLabel:"Search features, devices, actions, and help",featureSearchHelp:`Type to jump to features, devices, quick actions like Save or Backup, or help topics. Suggestions prioritize direct feature and device matches before help topics so navigation lands on controls first. Each entry shows whether it opens a Feature, Action, Device or Help topic so you know what happens before pressing Enter. Exact matches and items you've used recently jump to the top automatically, so your go-to controls stay first. Every suggestion also includes a short description so you can confirm what it will do at a glance. Search also reads the same tooltip and help text shown around controls, so words like "JSON" or "autosave" still land on the right button even if the label differs. Small typos are forgiven too, so "bakcup" still finds Backup or Save. Connector and media abbreviations like "USB-C", "Micro-HDMI", "SDXC", "CFexpress", "V-Mount" or "D-Tap" automatically match their full names, so type whichever version you remember. Exposure and color vocabulary is linked the same way—ISO, EI, ASA, exposure index, ND or neutral density, and WB, white balance or color temperature terms all resolve together so any phrasing points to the right controls. Press Enter to navigate, / or Ctrl+K (Cmd+K on Mac) to focus the search from anywhere, use Escape or × to clear the query, and notice how clearing the field floats your most recently used matches to the top for faster repeats. Prefix your query with "feature", "action", "device" or "help" (or your localized equivalents) (for example, "help: battery") to filter suggestions to that type. Start with "recent" or "history" (or your localized equivalents) (for example, "recent iso") to search only items you've used lately before scanning the full catalog. Wrap any phrase in double quotes to force an exact match, so typing "battery health" with quotes jumps ahead of broader matches. Common filler words are ignored automatically, so conversational questions like "how do I back up" still surface the important keywords.`,featureSearchFilterAliases:{feature:["feature","features","setting","settings"],action:["action","actions","command","commands"],device:["device","devices","gear","equipment"],help:["help","doc","docs","guide","guides","support"],recent:["recent","recents","recently","history","histories","frequent","frequently"]},featureSearchStopWords:["how","do","does","did","done","doing","can","cant","cannot","should","could","would","please","need","needs","needing","want","wants","wanting","i","im","ive","ill","id","we","were","weve","well","you","youre","youve","youll","they","theyre","theyve","them","us","me","my","mine","our","ours","your","yours","their","theirs","the","and","for","with","about","what","where","when","why","which","who","whom","whose","this","that","these","those","also","still","really","very","just","maybe","perhaps","again"],featureSearchClear:"Clear search",featureSearchClearHelp:"Clear the search box and show all results again. Press Escape to clear quickly.",featureSearchTypeFeature:"Feature",featureSearchTypeAction:"Action",featureSearchTypeDevice:"Device",featureSearchTypeHelp:"Help topic",darkModeHelp:"Switch between light and dark themes for comfortable viewing. Press D to toggle. The preference is saved.",pinkModeHelp:"Add a playful pink accent theme. The unicorn icon cycles every 30 seconds with a gentle pop animation while pink mode is on, and the setting works with light or dark mode and is remembered for next time.",settingsButton:"Settings",settingsButtonHelp:"Open Settings to personalize language, colors, fonts, accessibility options and backups.",settingsHeading:"Settings",settingsHeadingHelp:"Adjust language, themes, typography, accessibility preferences and backups in one place.",settingsSectionsLabel:"Settings sections",settingsTabGeneral:"General",settingsTabGeneralHelp:"Adjust language, theme, typography and branding preferences.",generalSectionLanguageHeading:"Language & units",generalSectionAppearanceHeading:"Appearance",generalSectionCameraColorsHeading:"Camera designations",generalSectionTypographyHeading:"Typography",generalSectionBrandingHeading:"Branding",documentationTrackerHeading:"Documentation update tracker",documentationTrackerDescription:"Use this log to mark translation, help and print guide refreshes before distributing offline bundles.",documentationTrackerAddRelease:"New release log",documentationTrackerEmpty:"No releases tracked yet. Add the upcoming release to start logging updates.",documentationTrackerSummaryIntro:"Create release log entries to track translations, help topics, READMEs and print guides until every item is verified.",documentationTrackerLocalesHeading:"Localized README coverage",documentationTrackerLocaleEnglish:"English README",documentationTrackerLocaleGerman:"German README",documentationTrackerLocaleSpanish:"Spanish README",documentationTrackerLocaleFrench:"French README",documentationTrackerLocaleItalian:"Italian README",documentationTrackerHelpHeading:"Help center topics",helpGroupEssentials:"Essentials",helpGroupGuides:"Guides",helpGroupReference:"Topic Reference",helpServiceUnavailable:"Help service unavailable.",helpSearchNoResultsTitle:"No results found",helpSearchNoResultsHint:"Try adjusting your search terms.",helpSearchClearLabel:"Clear search",helpV2WelcomeTitle:"Welcome to V2",helpV2WelcomeKeywords:"v2 new interface update overview navigation sidebar",helpV2WelcomeContent:`<p>Welcome to the new Cine Power Planner V2 interface! We've redesigned the experience to be faster, more intuitive, and fully responsive.</p>
<h4>Key Improvements</h4>
<ul>
<li><strong>New Sidebar Navigation:</strong> Quickly access Projects, Tools, and Settings from the dedicated sidebar. Mobile users can access this via the menu button in the header.</li>
<li><strong>Enhanced Visuals:</strong> A modern, clean look with improved Dark Mode and Pink Mode support.</li>
<li><strong>Better Performance:</strong> Faster loading times and smoother transitions between views.</li>
</ul>
<h4>Getting Around</h4>
<p>The sidebar is your main control center:</p>
<ul>
<li><strong>Projects:</strong> View and manage all your power plans. Filter by Active or Archive.</li>
<li><strong>Tools:</strong> Access the Device Library, Contacts, and Auto Gear Rules.</li>
<li><strong>Settings:</strong> Configure app preferences, backup data, and manage storage.</li>
</ul>`,helpV2ProjectsTitle:"Managing Projects",helpV2ProjectsKeywords:"projects create new delete archive filter active dashboard",helpV2ProjectsContent:`<p>The Projects Dashboard is where your work begins.</p>
<h4>Creating a Project</h4>
<p>Click the <strong>+ New Project</strong> button in the top right to start a fresh plan. You'll be prompted to enter a name and optional details.</p>
<h4>Project Status & Filtering</h4>
<p>Use the sidebar to filter your projects:</p>
<ul>
<li><strong>All Projects:</strong> Everything you've created.</li>
<li><strong>Active Projects:</strong> Projects you are currently working on.</li>
<li><strong>Archive:</strong> Completed or on-hold projects. You can archive a project from its context menu.</li>
</ul>
<h4>Project Actions</h4>
<p>Right-click (or long-press on touch devices) on any project tile to access the context menu:</p>
<ul>
<li><strong>Rename:</strong> Change the project details.</li>
<li><strong>Duplicate:</strong> Create an exact copy of a project.</li>
<li><strong>Archive/Unarchive:</strong> Move the project to or from the archive.</li>
<li><strong>Delete:</strong> Permanently remove the project.</li>
</ul>`,helpV2SidebarSearchTitle:"Sidebar Search",helpV2SidebarSearchKeywords:"search sidebar features devices actions help keyboard offline",helpV2SidebarSearchContent:`<p>The sidebar search now runs fully offline and blends features, devices, actions, and help topics into one fast list.</p>
<h4>What It Covers</h4>
<ul>
<li><strong>Features:</strong> Jump straight to inputs, sections, and dialogs.</li>
<li><strong>Devices:</strong> Search the local device catalog and open the matching entry.</li>
<li><strong>Actions:</strong> Trigger quick commands like Save, Export, or Settings.</li>
<li><strong>Help:</strong> Open the most relevant help topic without leaving the planner.</li>
</ul>
<h4>Keyboard Navigation</h4>
<ul>
<li><strong>Arrow keys:</strong> Move through suggestions.</li>
<li><strong>Enter:</strong> Activate the highlighted result.</li>
<li><strong>Esc:</strong> Clear the query and close the list.</li>
</ul>`,helpV2DeviceLibraryTitle:"Device Library",helpV2DeviceLibraryKeywords:"devices library equipment custom gear add edit database",helpV2DeviceLibraryContent:`<p>The Device Library allows you to manage the equipment available for your power plans.</p>
<h4>Browsing Devices</h4>
<p>Devices are organized by category (Cameras, Monitors, etc.). Use the tabs or dropdowns to switch between categories. You can also use the search bar to find specific gear instantly.</p>
<h4>Adding Custom Gear</h4>
<p>Can't find your equipment? Click <strong>Add Device</strong> to create a custom entry. You'll need to specify:</p>
<ul>
<li><strong>Name:</strong> The model name.</li>
<li><strong>Power Draw:</strong> Typical power consumption in Watts (W).</li>
<li><strong>Voltage:</strong> Operating voltage range (optional but recommended).</li>
</ul>
<p>Once added, custom devices are available for all your projects.</p>`,helpV2ContactsTitle:"Contacts",helpV2ContactsKeywords:"contacts people crew rental houses list",helpV2ContactsContent:`<p>Keep track of rental houses, crew members, and clients directly in the app.</p>
<h4>Managing Contacts</h4>
<ul>
<li><strong>Add Contact:</strong> Click the <strong>New Contact</strong> button to add details like Name, Role, Phone, and Email.</li>
<li><strong>Edit/Delete:</strong> Use the action buttons on each contact card to update or remove information.</li>
</ul>
<p>Contacts can be assigned to projects for quick reference (coming soon to project details).</p>`,helpV2SettingsTitle:"Settings & Data",helpV2SettingsKeywords:"settings preferences backup restore data storage theme language",helpV2SettingsContent:`<p>Customize your experience and keep your data safe.</p>
<h4>Data Management</h4>
<ul>
<li><strong>Backup:</strong> Download a full backup of all your projects and custom devices. We recommend doing this regularly.</li>
<li><strong>Restore:</strong> Load a previously saved backup file. <em>Note: This replaces current data.</em></li>
<li><strong>Auto-Backups:</strong> Enable automatic snapshots to protect against accidental data loss.</li>
</ul>
<h4>Preferences</h4>
<ul>
<li><strong>Units:</strong> Toggle between Metric and Imperial measurements (if applicable).</li>
<li><strong>Theme:</strong> Force Dark Mode, Light Mode, or the special Pink Mode.</li>
</ul>`,helpV2SaveShareBackupTitle:"Save, Share & Restore Safety",helpV2SaveShareBackupKeywords:"save manual autosave auto backup share export import json restore rehearsal offline safety snapshot",helpV2SaveShareBackupContent:`<p>Every save, export, and backup stays on this device so your data remains private and fully offline.</p>
<h4>Save Layers</h4>
<ul>
<li><strong>Manual Save:</strong> Use <strong>Save</strong> in the project header (or <kbd>Ctrl</kbd>/<kbd>⌘</kbd>+<kbd>S</kbd>) to commit a named snapshot to your local project library.</li>
<li><strong>Autosave:</strong> While you edit, the autosave status in the header updates in the background so the latest changes are always recoverable.</li>
<li><strong>Auto Backups:</strong> Each manual save queues a timestamped snapshot. Enable <strong>Show auto backups in project list</strong> in <em>Settings → Backup & Restore</em> to surface them, and note that a safety snapshot is captured before destructive actions.</li>
</ul>
<h4>Export & Import (JSON)</h4>
<ul>
<li><strong>Export Project:</strong> In a project, choose <strong>Export Project</strong> to download a JSON share file for offline sharing.</li>
<li><strong>Import Project:</strong> From the Projects dashboard, click <strong>Import Project</strong> and select the JSON file. The project opens in the editor; nothing replaces your saved data until you press <strong>Save</strong>.</li>
<li><strong>Conflict handling:</strong> If shared Auto Gear rules differ, the import dialog asks whether to apply them just for this project or globally. If a project name already exists, rename before saving to avoid overwriting.</li>
</ul>
<h4>Full Backup & Restore</h4>
<ul>
<li><strong>Download Backup:</strong> <em>Settings → Backup & Restore → Download Backup</em> captures projects, devices, rules, and preferences.</li>
<li><strong>Download Full Backup:</strong> <em>Settings → Data & Storage → Download Full Backup</em> creates an archival copy for rotation.</li>
<li><strong>Restore:</strong> <em>Settings → Backup & Restore → Restore</em> loads a backup file and creates a safety snapshot first so you can roll back.</li>
<li><strong>Restore Rehearsal:</strong> Use <strong>Restore Rehearsal</strong> to rehearse a restore in a safe sandbox before committing.</li>
</ul>
<h4>Offline Integrity Guarantees</h4>
<ul>
<li><strong>Offline-first:</strong> Saves, exports, backups, and imports never leave this device.</li>
<li><strong>Safe-save:</strong> Writes are protected so partial saves never replace good data.</li>
<li><strong>Backup-before-delete:</strong> Deleting or resetting data captures a safety snapshot first.</li>
</ul>`,helpV2AutoGearTitle:"Auto Gear Rules",helpV2AutoGearKeywords:"auto gear rules automation kit list scenarios production requirements",helpV2AutoGearContent:`<p>Automate your kit list generation with smart rules based on production scenarios.</p>
<h4>How it Works</h4>
<p>Auto Gear Rules monitor your project's <strong>Production Requirements</strong> (e.g., "Handheld", "Studio", "Car Rig") and automatically add or remove specific items from your kit list.</p>
<h4>Creating Rules</h4>
<p>Go to the <strong>Auto Gear Rules</strong> tool and click <strong>Add Rule</strong>. You can define:</p>
<ul>
<li><strong>Conditions:</strong> Triggers based on scenarios, camera models, or other gear selections.</li>
<li><strong>Actions:</strong> Items to <strong>Add</strong> (e.g., "Shoulder Pad" for "Handheld") or <strong>Remove</strong>.</li>
</ul>
<h4>Presets</h4>
<p>Save your favorite rule sets as <strong>Presets</strong> to quickly switch between different production styles (e.g., "Narrative Feature" vs "Commercial").</p>`,helpV2PrintExportTitle:"Printing & Exporting",helpV2PrintExportKeywords:"print pdf export share report kit list diagram",helpV2PrintExportContent:`<p>Share your power plans with your team or rental house.</p>
<h4>Project Overview</h4>
<p>From the Project Detail view, use the <strong>Print / Export PDF</strong> button to generate a clean summary of your project, including power totals and battery estimates.</p>
<h4>Kit List</h4>
<p>Generate a dedicated equipment list for quotes and prep. You can filter by department and customize columns before printing.</p>
<h4>Power Diagram</h4>
<p>Need a visual aid? Export the <strong>Connection Diagram</strong> as an image (PNG/JPG) or SVG to include in your tech pack.</p>
<h4>PDF Tips</h4>
<p>To save as a PDF, click "Print" and select <strong>"Save as PDF"</strong> as your destination in the print dialog.</p>`,helpV2QuickStartTitle:"Quick Start Checklist",helpV2QuickStartKeywords:"quickstart onboarding tutorial first steps workflow basics getting started new project guide",helpV2QuickStartContent:`<p>Welcome to Cine Power Planner! Follow these steps to get your first project ready.</p>
<ol>
<li>
<strong>Start Guided Tutorial:</strong>
<button type="button" class="button-link help-onboarding-secondary" data-onboarding-tour-trigger="secondary">Start guided tutorial</button>
to walk through every workflow with offline progress tracking.
</li>
<li>
<strong>Name Your Project:</strong>
Enter a name in the <em>Project Name</em> field and click <strong>Save</strong> (or press <kbd>Enter</kbd>/<kbd>Ctrl</kbd>+<kbd>S</kbd>) to capture the current rig.
</li>
<li>
<strong>Configure Devices:</strong>
Walk through <em>Configure Devices</em>, check the <em>Power Summary</em>, and review the <em>Connection Diagram</em>.
</li>
<li>
<strong>Secure Your Data:</strong>
Download an <strong>Export Project</strong> JSON and a full-app <strong>Backup</strong> so you have two offline recovery copies.
</li>
<li>
<strong>Check Offline Status:</strong>
Confirm the offline indicator (in the header) glows before disconnecting.
</li>
<li>
<strong>Rehearse Restore:</strong>
Open <strong>Restore rehearsal</strong> in Settings to verify your backup in a sandbox environment.
</li>
</ol>
<p class="help-callout-note">
Tip: Keep backups on separate drives when travelling—<strong>Restore</strong> always creates a fresh safety copy so nothing is lost when you undo a change.
</p>`,helpV2DataSafetyTitle:"Data Safety Essentials",helpV2DataSafetyKeywords:"backup restore protect save autosave export share import rehearsal offline integrity",helpV2DataSafetyContent:`<p>Protect every project with this offline-first safety checklist.</p>
<h4>Manual Save, Autosave & Auto-Backups</h4>
<ul>
<li><strong>Manual Save:</strong> Click <strong>Save</strong> (or press <kbd>Ctrl</kbd>/<kbd>⌘</kbd>+<kbd>S</kbd>) to capture an immediate project snapshot.</li>
<li><strong>Autosave:</strong> Runs quietly in the background while you edit, keeping rolling snapshots for quick recovery.</li>
<li><strong>Auto-backups list:</strong> Enable <strong>Show auto-backups in project list</strong> and adjust <strong>Backup Retention (copies per project)</strong> to control how many snapshots stay visible.</li>
</ul>
<h4>Project Export / Share (JSON) & Import</h4>
<ul>
<li><strong>Export Project:</strong> Download a share-ready JSON bundle from the project detail view for offline handoff.</li>
<li><strong>Import Project:</strong> Use <strong>Import Project</strong> on the dashboard, choose the JSON, and review the metadata + automatic gear rule options before applying.</li>
<li><strong>Conflict handling:</strong> Imports never overwrite your live project until you confirm Save. If a name already exists (or is missing), the planner saves a new “-imported” project instead.</li>
</ul>
<h4>Full Backup, Restore & Restore Rehearsal</h4>
<ul>
<li><strong>Download Backup:</strong> Create a manual full-app snapshot from <strong>Settings → Backup &amp; Restore</strong>.</li>
<li><strong>Download Full Backup:</strong> Grab an extra full storage export from <strong>Settings → Data &amp; Storage</strong> when you want redundant media.</li>
<li><strong>Restore:</strong> Load a backup file; the planner captures a safety snapshot first. Use <strong>Compare Versions</strong> to review differences.</li>
<li><strong>Restore Rehearsal:</strong> Launch a sandbox that compares counts, clears itself automatically, and keeps live data untouched until you choose to restore.</li>
</ul>
<h4>Offline & Data Integrity Guarantees</h4>
<ul>
<li><strong>Offline-first:</strong> Saves, exports, imports, and backups all run without a network connection.</li>
<li><strong>Safety snapshots:</strong> Restores and <strong>Factory reset</strong> capture a backup before any destructive change.</li>
<li><strong>Copy, not delete:</strong> Exports and backups always duplicate data—keep at least two offline copies before removing anything.</li>
</ul>
<p class="help-callout-note">Tip: Run <strong>Restore Rehearsal</strong> after major milestones so you can verify the backup while staying fully offline.</p>`,helpV2ShortcutsTitle:"Essential Shortcuts",helpV2ShortcutsKeywords:"keyboard shortcuts hotkeys fast navigation",helpV2ShortcutsContent:`<ul>
<li><kbd>?</kbd>, <kbd>H</kbd>, <kbd>F1</kbd>: Open Help</li>
<li><kbd>Ctrl</kbd>+<kbd>/</kbd> (<kbd>⌘</kbd>+<kbd>/</kbd>): Toggle Help</li>
<li><kbd>/</kbd> or <kbd>Ctrl</kbd>+<kbd>F</kbd> (<kbd>⌘</kbd>+<kbd>F</kbd>): Help Search</li>
<li><kbd>Ctrl</kbd>+<kbd>K</kbd> (<kbd>⌘</kbd>+<kbd>K</kbd>): Global Feature Search</li>
<li><kbd>Ctrl</kbd>+<kbd>,</kbd> (<kbd>⌘</kbd>+<kbd>,</kbd>): Open Settings</li>
<li><kbd>Ctrl</kbd>+<kbd>S</kbd> (<kbd>⌘</kbd>+<kbd>S</kbd>): Save Project</li>
<li><kbd>D</kbd>: Toggle Dark Mode</li>
<li><kbd>P</kbd>: Toggle Pink Mode</li>
</ul>`,helpV2FeaturesTitle:"Features at a Glance",helpV2FeaturesKeywords:"overview capabilities highlights offline favorites search",helpV2FeaturesContent:`<ul>
<li><strong>Rig Planning:</strong> Configure cameras, monitors, and accessories in <em>Configure Devices</em>.</li>
<li><strong>Power Analysis:</strong> Review draw and runtime in <em>Power Summary</em>.</li>
<li><strong>Visual Diagram:</strong> Map connections with the interactive <em>Connection Diagram</em>.</li>
<li><strong>Battery Comparison:</strong> Compare runtimes and output limits.</li>
<li><strong>Device Library:</strong> Customize the database with your own gear.</li>
<li><strong>Contacts & Own Gear:</strong> Manage crew info and personal kits.</li>
<li><strong>Print & Export:</strong> Generate clean PDF summaries and kit lists.</li>
<li><strong>Offline Capable:</strong> Works fully without an internet connection.</li>
<li><strong>Customizable:</strong> Adjust themes (Dark, Light, Pink), fonts, and accent colors.</li>
</ul>`,helpTopics:{projectManagement:{title:"Project Management",content:"Name projects and press **Save** to capture snapshots in Saved Projects. Saving won’t overwrite other projects until you confirm the name. Autosave and auto-backups protect drafts, and Delete removes entries only after a safety snapshot is created."},saveShareBackup:{title:"Save, Share & Backup",content:"Use **Export Project** to download a JSON bundle (optionally include automatic gear rules and owned-gear markers). Use **Share Project** to create a share bundle for offline import; recipients open it with **Import Project** and nothing overwrites their current setup until they confirm Save. Use **Backup & Restore** for full-app backups, restore rehearsals, version comparisons, and the local backup vault when automatic downloads are blocked."},deviceConfiguration:{title:"Camera Package",content:"Build your camera package by selecting devices. Start with a **Camera**, then add **Monitors**, **Wireless Transmitters**, and **FIZ** systems. Use the Device Library to import or export custom gear so offline edits stay with your projects."},powerCalculation:{title:"Power Calculation",content:"The **Power Summary** shows the total power consumption of your rig and estimated runtime based on the selected battery and mount voltages. Watch for **Pin** and **D-Tap** warnings, and use the quick summary to explain results offline."},connectionDiagram:{title:"Power Diagram",content:"The **Power Diagram** shows how power, video, and control gear connect. Drag to arrange nodes, zoom and pan to inspect details, and download SVG or JPG snapshots for sharing."},gearList:{title:"Kit List",content:"Generate a detailed **Kit List** from camera package devices and production requirements. Edit quantities, providers, temporary extras and owned-gear badges, then print or export it for rental or crew."},contacts:{title:"Contacts",content:"Save crew members in **Contacts** or import vCards. Entries reuse across projects and flow into providers, backups and exports."},ownGear:{title:"Own Gear",content:"Track your personal inventory in **Own Gear**. Mark items you own so kit list rows can be flagged and exported with those annotations."},settings:{title:"Settings",content:"Customize the planner in **Settings**. Adjust **Language**, themes, typography, branding and **Backup & Restore** safeguards, plus automatic gear rules and documentation tracking."},offlineUse:{title:"Offline Use",content:"Cine Power Planner works fully **Offline** with locally stored icons, fonts and help content. Verify the offline indicator. Export at least one project and create a full backup before disconnecting. Run a restore rehearsal (or at minimum confirm the latest autosave timestamp in Settings → Data & Storage)."},troubleshooting:{title:"Troubleshooting",content:`If things aren't working as expected:

- **Force reload**: Open the toolbar help/status menu and choose **Force reload** to refresh the app without touching your data.
- **Export + Backup**: Before clearing browser cache or site data, **Export Project** and run **Backup & Restore** to capture your project and a full local backup.
- **Browser cache/site data**: Only if issues persist, clear your browser cache or site data. **Warning:** clearing site data can delete locally stored projects.`},shortcuts:{title:"Keyboard Shortcuts",content:`Navigate faster with these keys:

- **?**, **H**, **F1**: Open Help
- **/**: Focus Search
- **Esc**: Close dialogs or menus
- **D**: Toggle Dark Mode`},pinkMode:{title:"Pink Mode",content:"Activate **Pink Mode** in Settings or the top bar to add playful accents and animated icons. The unicorn icon cycles every 30 seconds, and floating stickers drift across the screen. Click any floating sticker **3 times** to trigger a celebratory rain effect."}},documentationTrackerHelpStart:"Start Here & navigation",documentationTrackerHelpSave:"Saving, sharing & exports",documentationTrackerHelpBackup:"Backup & restore drills",documentationTrackerHelpOwnGear:"Own gear & imports",documentationTrackerHelpOffline:"Offline readiness & service worker",documentationTrackerHelpPinkMode:"Pink mode & animations",documentationTrackerPrintHeading:"Printable guides",documentationTrackerPrintChecklist:"Documentation update checklist",documentationTrackerPrintMaintenance:"Documentation maintenance guide",documentationTrackerPrintSaveShare:"Save, share, import, backup & restore reference",documentationTrackerPrintOffline:"Offline readiness drill",documentationTrackerReleaseNameLabel:"Release name",documentationTrackerReleaseDateLabel:"Target release date",documentationTrackerNotesLabel:"Verification notes",documentationTrackerNotesPlaceholder:"Record what changed, who reviewed it and where the artifacts were stored.",documentationTrackerMarkAllComplete:"Mark all complete",documentationTrackerArchiveRelease:"Archive release",documentationTrackerRestoreRelease:"Reopen release",documentationTrackerArchivedBadge:"Archived",documentationTrackerArchiveConfirm:'Archive "{name}"? Completed checkmarks stay logged for audits.',documentationTrackerSummaryPending:'{remaining} of {total} documentation tasks remain for "{name}".',documentationTrackerSummaryComplete:'All {total} documentation tasks for "{name}" are complete.',documentationTrackerFallbackReleaseName:"Documentation release",documentationTrackerProgress:"{completed}/{total} complete",documentationTrackerSectionProgress:"{completed}/{total}",documentationTrackerUpdatedAt:"Updated {time}",documentationTrackerTargetSummary:"Target {date}",documentationTrackerDefaultReleaseName:"Release {date}",settingsTabBackup:"Backup & Restore",settingsTabData:"Data & Storage",settingsTabAbout:"About & Support",generalSectionInterfaceHeading:"Interface & Accessibility",generalSectionInterfaceHelp:"Manage font sizes, high contrast mode and animation preferences.",settingsBackupAutomatedHeading:"Automated Backups",settingsBackupManualHeading:"Manual Actions",settingsBackupDangerHeading:"Danger Zone",settingsDataStorageStatusHeading:"Storage Status",settingsDataPersistenceHeading:"Persistence & Backup",settingsDataLoggingHeading:"Logging",settingsAboutHeading:"About & Support",rulesViewTitle:"Auto Gear Rules",rulesViewSubtitle:"Manage automatic gear additions based on your equipment selection.",buttonAddRule:"Add Rule",rulesEmptyTitle:"No rules defined",rulesEmptyText:"Create your first rule to automate your gear list.",ruleBadgeAlways:"Always",ruleTagConditions:"Conditions",ruleTagItemsAdded:"Items Added",confirmDeleteRule:"Are you sure you want to delete this rule?",modalTitleCreateRule:"Create Rule",modalTitleEditRule:"Edit Rule",tabGeneral:"General",tabContext:"Context",tabCamera:"Camera",tabMonitoring:"Monitoring",tabSupport:"Support",tabCrew:"Crew",tabActions:"Actions",labelRuleName:"Rule Name",labelRuleEnabled:"Rule Enabled",labelRuleAlways:"Always Apply",helpRuleAlways:"Overrides all other conditions.",placeholderRuleName:"e.g. Add Batteries for Monitor",sectionScenarios:"Scenarios",sectionCameraModels:"Camera Models",sectionMatteboxes:"Matteboxes",sectionViewfinders:"Viewfinders / Top Handles (Extensions)",sectionMonitors:"Monitors",sectionWireless:"Wireless",sectionTripodHeads:"Tripod Heads",sectionBowlSize:"Bowl Size",sectionLegTypes:"Leg Types",sectionSpreaders:"Spreaders",sectionCrewPresent:"Crew Present",sectionCrewAbsent:"Crew Absent",sectionItemsToAdd:"Items to Add",sectionItemsToRemove:"Items to Remove",buttonAddItem:"+ Add Item",labelItemName:"Item Name",placeholderItemSearch:"Search...",labelCategory:"Category",labelQty:"Qty",buttonAdd:"Add",textNoOptions:"No options available.",textNoItems:"No items defined.",buttonSaveRule:"Save Rule",buttonCancel:"Cancel",buttonEdit:"Edit",buttonDelete:"Delete",alertEnterRuleName:"Please enter a rule name.",contactsViewTitle:"Contacts",contactsViewSubtitle:"Manage your crew and vendor contacts.",buttonAddContact:"Add Contact",buttonAddFirstContact:"+ Add First Contact",contactsEmptyTitle:"No contacts found",contactsEmptyText:"Add people and companies to your contact list to quickly assign them to projects.",linkWebsite:"Website",contactUnnamed:"Unnamed Contact",contactNoRole:"No Role",modalTitleDeleteContact:"Delete Contact",confirmDeleteContact:"Are you sure you want to delete this contact? This action cannot be undone.",buttonDeleteRed:"Delete",modalTitleNewContact:"New Contact",modalTitleEditContact:"Edit Contact",buttonUploadPhoto:"Upload Photo",buttonRemovePhoto:"Remove",labelName:"Name",labelRole:"Role",labelPhone:"Phone",labelEmail:"Email",labelWebsite:"Website / Link",labelNotes:"Notes",placeholderFullName:"Full Name",placeholderRole:"e.g. 1st AC",placeholderPhone:"+1 234 567 890",placeholderEmail:"email@example.com",placeholderWebsite:"https://...",placeholderNotes:"Additional details...",buttonSaveContact:"Save Contact",alertEnterName:"Please enter a name.",ownGearViewTitle:"Owned Gear",ownGearViewSubtitle:"Manage your personal equipment inventory.",buttonAddGearItem:"Add Item",buttonAddFirstGearItem:"+ Add First Item",ownGearEmptyTitle:"No gear found",ownGearEmptyText:"Add items to your personal inventory to quickly add them to projects.",labelQtyPrefix:"Qty: ",labelSourcePrefix:"Source: ",confirmDeleteGearItem:"Are you sure you want to delete this item?",modalTitleNewGearItem:"New Gear Item",modalTitleEditGearItem:"Edit Gear Item",placeholderGearName:"e.g. Arri Alexa Mini",placeholderGearQty:"1",placeholderGearNotes:"Condition, serial number, etc...",buttonSaveGearItem:"Save Item",alertInvalidItemData:"Invalid item data.",alertSaveItemFailed:"Failed to save item.",labelQuantity:"Quantity",buttonDownloadBackup:"Download Backup",buttonDownloadFullBackup:"Download Full Backup",buttonRestore:"Restore",buttonRestoreRehearsal:"Restore Rehearsal",buttonFactoryReset:"Factory Reset",buttonCompareVersions:"Compare Versions",buttonReset:"Reset",buttonUploadSvg:"Upload SVG",buttonClose:"Close",buttonExportLog:"Export Log",buttonChooseFile:"Choose File",buttonSupport:"Support",buttonReportBug:"Report Bug",buttonSuggestFeature:"Suggest Feature",buttonRequestPersistence:"Request Persistent Storage",labelBackupRetention:"Backup Retention (copies per project)",labelBaselineVersion:"Baseline Version",labelComparisonVersion:"Comparison Version",labelIncidentNotes:"Incident Notes",labelSelectFile:"Select File",labelNoFileSelected:"No file selected",labelLatestProjectSave:"Latest Project Save",labelLatestAutoBackup:"Latest Auto Backup",labelLatestFullBackup:"Latest Full Backup",tableHeaderData:"Data",tableHeaderDifference:"Difference",labelLogLevel:"Log Level",labelHistoryLimit:"History Limit",labelNamespaceFilter:"Namespace Filter",placeholderIncidentNotes:"Context for this comparison...",checkboxAutoBackupList:"Show auto-backups in project list",checkboxHighContrast:"High Contrast Elements",checkboxReduceMotion:"Reduce Motion",checkboxRelaxedSpacing:"Relaxed Spacing",checkboxMirrorConsole:"Mirror to Console",checkboxCaptureConsole:"Capture Console Output",checkboxCaptureGlobalErrors:"Capture Global Errors",checkboxPersistSession:"Persist Session Between Reloads",brandingNoLogo:"No custom logo set",documentationTrackerEmptyShort:"No releases tracked.",settingsFactoryResetHelp:"Reset the application to its initial state. All data will be deleted.",backupDiffModalTitle:"Version Comparison",backupDiffModalSubtitle:"Pick two manual saves or automatic backups to inspect changes.",backupDiffEmptyState:"Select versions to see differences.",rehearsalModalSubtitle:"Load a backup into a disposable workspace to verify it before running a full restore.",rehearsalModalSourceLabel:"Choose a rehearsal source",rehearsalModalSourceBackup:"Full app backup (.json)",rehearsalModalSourceProject:"Project bundle (.json)",textManageLocalData:"Manage your local data.",textRequestPersistence:"Request persistent storage verification to prevent browser eviction.",statusCheckingPersistence:"Checking storage protection...",textNoLogEntries:"No log entries.",optionLogLevelAll:"All levels",optionLogLevelInfo:"Info and above",optionLogLevelWarn:"Warnings and errors",optionLogLevelError:"Errors only",appCreator:"Created by Luca Zanner",languageSetting:"Language",settingsLanguageHelp:"Choose the interface language. Changes apply immediately and are remembered for next time.",darkModeSetting:"Dark mode",settingsDarkModeHelp:"Switch between light and dark themes from any control. The onboarding selector, top-bar toggle and Settings checkbox stay synchronized instantly.",pinkModeSetting:"Pink mode",settingsPinkModeHelp:"Enable the playful pink accent theme from Settings.",accentColorSetting:"Accent color",accentColorHelp:"Pick the accent color used for buttons, highlights and diagrams. The choice is saved with your settings.",cameraColorSettingDescription:"Assign a highlight color to each camera letter so linked gear stays coordinated across your lists.",cameraColorInputHelp:"Choose the highlight color for camera %s.",cameraColorALabel:"Camera A color",cameraColorBLabel:"Camera B color",cameraColorCLabel:"Camera C color",cameraColorDLabel:"Camera D color",cameraColorELabel:"Camera E color",accentColorReset:"Reset to default",accentColorResetHelp:"Revert the accent color to the original theme color while keeping other preferences intact.",temperatureUnitSetting:"Temperature unit",temperatureUnitSettingHelp:"Choose whether temperatures are shown in Celsius or Fahrenheit throughout the app.",focusScaleSetting:"Focus scale",focusScaleSettingHelp:"Choose the measurement markings displayed for focus scales in lens notes and overviews.",focusScaleMetric:"Metric",focusScaleImperial:"Imperial",mountVoltageSettingsHeading:"Battery mount voltages",mountVoltageSettingsHelp:"Adjust the voltages used for current draw calculations across B-Mount, V-Mount and Gold Mount setups.",mountVoltageDescription:"Set the default high and low voltages for each battery mount so the planner matches your hardware.",mountVoltageReset:"Restore defaults",mountVoltageResetHelp:"Reset all mount voltages to their factory defaults.",mountVoltageHighLabel:"High-voltage output",mountVoltageLowLabel:"Low-voltage output",mountVoltageHighHelp:"Used to calculate total current at the battery's main output such as the high-voltage pins.",mountVoltageLowHelp:"Used to calculate total current at auxiliary outputs such as D-Tap ports or B-Mount low-voltage pins.",mountVoltageNote:"These voltages update the totals in the power summary, runtime estimates and pin warnings.",mountVoltageCardLabelV:"V-Mount",mountVoltageCardLabelGold:"Gold Mount",mountVoltageCardLabelB:"B-Mount",totalCurrentHighLabelTemplate:"Total Current (at {voltage}V):",totalCurrentLowLabelTemplate:"Total Current (at {voltage}V):",totalCurrentHighHelpTemplate:"Current draw at the battery's main output ({voltage}V).",totalCurrentLowHelpTemplate:"Current draw at auxiliary outputs ({voltage}V).",temperatureUnitCelsius:"Celsius (°C)",temperatureUnitFahrenheit:"Fahrenheit (°F)",temperatureUnitSymbolCelsius:"°C",temperatureUnitSymbolFahrenheit:"°F",fontSizeSetting:"Font size",fontSizeSettingHelp:"Set the base interface font size to improve readability or fit more information on screen.",fontFamilySetting:"Font",fontFamilySettingHelp:"Select the typeface used throughout the planner. Added local fonts appear in this menu.",bundledFontsGroup:"Bundled fonts",localFontsGroup:"Local fonts",localFontsButton:"Add local font…",localFontsButtonHelp:"Allow the planner to use installable fonts from this device when your browser supports it.",localFontsUnsupported:"Local fonts aren't supported in this browser.",localFontsFileFallback:"Your browser can't list installed fonts automatically. Upload font files instead.",localFontsAdded:"Added: %s",localFontsAlreadyAdded:"Already added: %s",localFontsNoFonts:"No fonts were selected.",localFontsError:"Could not access local fonts.",localFontsPermissionNeeded:"Access to installed fonts was denied. Upload font files instead.",localFontsUnsupportedFiles:"Some files weren't recognized as fonts: %s.",localFontsSaveError:"Font added for this session but couldn't be saved for offline use.",logoSetting:"Logo (SVG)",logoSettingHelp:"Upload an SVG logo to brand printable overviews and include it in backups.",logoFormatError:"Unsupported logo format. Please choose an SVG file.",autoGearHeading:"Automatic Gear Rules",autoGearHeadingHelp:"Adjust which Production Requirements scenarios automatically add or remove kit items.",autoGearDescription:"Create scenario-based rules that tweak the generated kit list. Rules apply after the default planner suggestions.",autoGearPresetDescription:"Save and reuse complete sets of automatic gear rules.",autoGearPresetLabel:"Preset",autoGearPresetPlaceholder:"Custom rules",autoGearAutoPresetLabel:"Autosaved rules",autoGearSavePresetButton:"Save preset",autoGearDeletePresetButton:"Delete preset",autoGearPresetNamePrompt:"Name this preset",autoGearPresetNameRequired:"Enter a preset name to continue.",autoGearPresetOverwriteConfirm:"Replace the existing preset “%s”?",autoGearPresetApplyConfirm:"Replace your automatic gear rules with the preset “%s”?",autoGearPresetSaved:"Automatic gear preset saved.",autoGearPresetDeleted:"Automatic gear preset deleted.",autoGearPresetApplied:"Preset applied.",autoGearPresetExportSuccess:"Automatic gear presets downloaded.",autoGearPresetExportError:"Automatic gear preset export failed.",autoGearAddRule:"Add rule",autoGearNoRules:"No custom rules yet.",autoGearNoMatches:"No rules match your filters.",autoGearNoFocusMatches:"No rules match the selected dashboard filter.",autoGearSummaryHeading:"Rule coverage overview",autoGearSummaryDescription:"Review automatic gear rules for duplicate triggers, conflicts, stacked scenarios and uncovered coverage.",autoGearSummaryEmpty:"Add a rule to unlock coverage insights.",autoGearSummaryTotalLabel:"Rules tracked",autoGearSummaryTotalDescription:"Rules currently saved in this setup.",autoGearSummaryCoverageLabel:"Scenario coverage",autoGearSummaryCoverageDescription:"{covered} of {total} scenarios covered",autoGearSummaryCoverageEmpty:"Add scenarios to measure coverage.",autoGearSummaryNetLabel:"Net change",autoGearSummaryNetDescription:"Adds {adds} · Removes {removes}",autoGearSummaryDuplicatesLabel:"Duplicated triggers",autoGearSummaryDuplicatesSome:"{rules} across {groups} groups",autoGearSummaryDuplicatesNone:"No duplicate triggers.",autoGearSummaryConflictsLabel:"Potential conflicts",autoGearSummaryConflictsSome:"{rules} affected across {items} items",autoGearSummaryConflictsNone:"No conflicting adds/removes.",autoGearSummaryOverlapsLabel:"Stacked scenarios",autoGearSummaryOverlapsSome:"{count} scenarios touched by multiple rules",autoGearSummaryOverlapsNone:"No scenarios currently stack multiple rules.",autoGearSummaryUncoveredLabel:"Uncovered scenarios",autoGearSummaryUncoveredSome:"Review {count} scenario gaps",autoGearSummaryUncoveredNone:"All required scenarios covered.",autoGearSummaryDetailsIntro:"Focus cards to inspect coverage percentages, stacked scenarios, duplicates and conflicts before exporting or printing.",autoGearSummaryDetailsDuplicatesHeading:"Duplicated triggers",autoGearSummaryDuplicateGroupTitle:"Matching triggers",autoGearSummaryDetailsConflictsHeading:"Potential conflicts",autoGearSummaryConflictAddsLabel:"Adds",autoGearSummaryConflictRemovesLabel:"Removes",autoGearSummaryDetailsOverlapsHeading:"Scenarios with stacked rules",autoGearSummaryDetailsOverlapsNone:"No scenarios currently stack multiple rules.",autoGearSummaryDetailsUncoveredHeading:"Uncovered scenarios",autoGearSummaryResetFocus:"Clear dashboard filter",autoGearSummaryDetailsFocusEmpty:"No coverage details match the current focus.",autoGearSummaryJumpToRule:"Jump to rule",autoGearSummarySetScenarioFilter:"Filter to scenario {scenario}",autoGearSummaryRuleReference:"Rule {position}: {label}",autoGearSummaryRuleReferenceUntitled:"Rule {position}",autoGearSummaryFilteredDescription:"Showing {visible} of {total} rules after filters.",autoGearSearchLabel:"Search rules",autoGearSearchHelp:"Filter automatic gear rules by name, scenario or items. Results update instantly as you type.",autoGearSearchPlaceholder:"Search by name, scenario or item",autoGearFilterScenarioLabel:"Filter by scenario",autoGearFilterScenarioHelp:"Show only rules that require a specific scenario.",autoGearFilterScenarioAny:"All scenarios",autoGearFilterClear:"Clear filters",autoGearRuleNameLabel:"Rule name",autoGearRuleNameHelp:"Optional label displayed in the rules list.",autoGearConditionSelectLabel:"Add a condition",autoGearConditionSelectHelp:"Reveal the selectors you want to use as rule conditions.",autoGearAddCondition:"Add condition",autoGearConditionPlaceholder:"Choose a condition",autoGearConditionAddShortcut:"Add another condition",autoGearConditionRemove:"Remove this condition",autoGearConditionLogicLabel:"Match behavior",autoGearConditionLogicHelp:"Choose how the selected values interact before the rule activates.",autoGearConditionLogicAll:"Require every selected value",autoGearConditionLogicAny:"Match any selected value",autoGearConditionLogicOr:"Start a new OR group (matches any selected value)",autoGearConditionLogicNone:"Require none of the selected values",autoGearConditionLogicMultiplier:"Multiply by matched values",autoGearConditionRepeatHint:"Condition already added. Existing inputs for {condition} are highlighted so you can add more selections.",autoGearAlwaysLabel:"Always include",autoGearAlwaysHelp:"Apply this rule to every kit list.",autoGearAlwaysMeta:"Always active",autoGearScenariosLabel:"Required scenarios",autoGearScenariosHelp:"Pick every scenario that must be selected for this rule to apply. Hold Ctrl (Cmd on Mac) to choose multiple.",autoGearScenarioPlaceholder:"Select scenarios",autoGearScenarioModeLabel:"Scenario matching",autoGearScenarioModeHelp:"Choose how the selected scenarios interact before the rule activates.",autoGearScenarioModeAll:"Require every selected scenario",autoGearScenarioModeAny:"Match any selected scenario",autoGearScenarioModeMultiplier:"Multiply when combined",autoGearScenarioBaseLabel:"Base scenario",autoGearScenarioBaseHelp:"Items always add when this scenario is active.",autoGearScenarioBasePlaceholder:"Select a base scenario",autoGearScenarioFactorLabel:"Multiplier factor",autoGearScenarioFactorHelp:"Scale item quantities when every additional scenario is active.",autoGearShootingDaysLabel:"Shooting days condition",autoGearShootingDaysHelp:"Activate this rule when the shooting schedule meets your chosen minimum or maximum, or repeat the gear for each block of days.",autoGearShootingDaysModeMinimum:"Minimum",autoGearShootingDaysModeMaximum:"Maximum",autoGearShootingDaysModeEvery:"Every",autoGearShootingDaysValueLabel:"Shooting days value",autoGearMatteboxLabel:"Mattebox options",autoGearMatteboxHelp:"Apply this rule when these mattebox choices are selected. Clamp-on rules automatically add the matching backing sizes for the selected lens fronts.",autoGearMatteboxPlaceholder:"Select mattebox options",autoGearCameraHandleLabel:"Camera handles",autoGearCameraHandleHelp:"Apply this rule when these camera handle options are selected.",autoGearCameraHandlePlaceholder:"Select camera handles",autoGearViewfinderExtensionLabel:"Viewfinder extension",autoGearViewfinderExtensionHelp:"Apply this rule when these viewfinder extension choices are selected.",autoGearViewfinderExtensionPlaceholder:"Select viewfinder extension options",autoGearDeliveryResolutionLabel:"Delivery resolution",autoGearDeliveryResolutionHelp:"Apply this rule when these delivery resolutions are selected.",autoGearDeliveryResolutionPlaceholder:"Select delivery resolutions",autoGearVideoDistributionLabel:"Video distribution",autoGearVideoDistributionHelp:"Apply this rule when these video distribution preferences are selected.",autoGearVideoDistributionPlaceholder:"Select video distribution options",autoGearTripodHeadBrandLabel:"Tripod head brand",autoGearTripodHeadBrandHelp:"Apply this rule when the tripod head preferences include these brands.",autoGearTripodHeadBrandPlaceholder:"Select tripod head brands",autoGearTripodBowlLabel:"Tripod bowl size",autoGearTripodBowlHelp:"Apply this rule when the tripod head preferences include these bowl sizes.",autoGearTripodBowlPlaceholder:"Select tripod bowl sizes",autoGearTripodTypesLabel:"Tripod types",autoGearTripodTypesHelp:"Apply this rule when the tripod preferences include these tripod types.",autoGearTripodTypesPlaceholder:"Select tripod types",autoGearTripodSpreaderLabel:"Tripod spreader",autoGearTripodSpreaderHelp:"Apply this rule when the tripod preferences include these spreader options.",autoGearTripodSpreaderPlaceholder:"Select tripod spreaders",autoGearVideoDistributionNone:"No video distribution selected",autoGearCameraLabel:"Camera selection",autoGearCameraHelp:"Apply this rule when these camera bodies are selected.",autoGearCameraWeightLabel:"Camera weight",autoGearCameraWeightHelp:"Compare the selected camera's weight to the threshold before triggering this rule.",autoGearCameraWeightOperatorLabel:"Weight comparison",autoGearCameraWeightOperatorGreater:"Heavier than",autoGearCameraWeightOperatorLess:"Lighter than",autoGearCameraWeightOperatorEqual:"Exactly",autoGearCameraWeightValueLabel:"Weight threshold (grams)",autoGearCameraWeightValueRequired:"Enter a camera weight threshold before saving.",autoGearMonitorLabel:"Onboard monitors",autoGearMonitorDefaultsHeading:"Monitor defaults",autoGearMonitorDefaultsDescription:"Choose which monitors should be preselected for new kit lists.",autoGearDefaultFocusMonitorLabel:"Focus monitor",autoGearDefaultHandheldMonitorLabel:'7" handheld monitor',autoGearDefaultComboMonitorLabel:'Combo monitor 15-21"',autoGearDefaultDirectorMonitorLabel:'Director monitor 15-21"',autoGearMonitorDefaultPlaceholder:"Use recommended automatically",autoGearMonitorHelp:"Apply this rule when these onboard monitors are selected.",autoGearCrewPresentLabel:"Crew present",autoGearCrewPresentHelp:"Apply this rule when these crew roles are listed on the project.",autoGearCrewAbsentLabel:"Crew absent",autoGearCrewAbsentHelp:"Apply this rule when these crew roles are not listed on the project.",autoGearWirelessLabel:"Wireless transmitters",autoGearWirelessHelp:"Apply this rule when these wireless transmitters are selected.",autoGearMotorsLabel:"FIZ motors",autoGearMotorsAny:"Any motor selected",autoGearMotorsHelp:"Apply this rule when these FIZ motors are selected.",autoGearControllersLabel:"FIZ controllers",autoGearControllersHelp:"Apply this rule when these FIZ controllers are selected.",autoGearDistanceLabel:"FIZ distance devices",autoGearDistanceHelp:"Apply this rule when these distance devices are selected.",autoGearRuleConditionRequired:"Select at least one scenario, camera, monitor, wireless transmitter, motor, controller, distance device, mattebox option, camera handle, viewfinder extension or video distribution before saving.",autoGearAddItemsHeading:"Add these items",autoGearOwnGearLabel:"Own gear item",autoGearOwnGearHelp:"Select an item you own to link this rule to your inventory.",autoGearConditionOwnGearLabel:"Own gear",autoGearConditionOwnGearHelp:"Apply this rule when these items are saved in your own gear list.",autoGearOwnGearMissing:"Removed own gear",autoGearOwnGearPlaceholder:"Manual entry",autoGearOwnGearBadge:"Own gear",autoGearAddItemLabel:"Item",autoGearAddCategoryLabel:"Category",autoGearAddQuantityLabel:"Qty",autoGearAddItemButton:"Add item",autoGearUpdateItemButton:"Save item",autoGearAddMultipleHint:"Separate multiple items with semicolons.",autoGearRemoveItemsHeading:"Remove these items",autoGearRemoveItemLabel:"Item",autoGearRemoveCategoryLabel:"Category",autoGearRemoveQuantityLabel:"Qty",autoGearRemoveItemButton:"Add removal",autoGearRemoveMultipleHint:"Separate multiple items with semicolons.",autoGearSaveRule:"Save rule",autoGearRuleSaved:"Automatic gear rule saved.",autoGearCancelEdit:"Cancel",autoGearResetFactoryButton:"Reset to factory additions",autoGearResetFactoryHelp:"Restore the automatic gear rules generated from the planner's default scenarios. Your current presets download before anything changes.",autoGearResetFactoryConfirm:"Replace your automatic gear rules with the default additions?",autoGearResetFactoryDone:"Automatic gear rules restored to factory additions.",autoGearResetFactoryEmpty:"Factory additions unavailable. Automatic gear rules cleared.",autoGearResetFactoryError:"Reset failed. Please try again.",autoGearResetFactoryExportFailed:"Automatic gear preset export failed. Reset cancelled.",autoGearExportButton:"Export rules",autoGearExportHelp:"Download your automatic gear rules as a JSON file.",autoGearExportSuccess:"Automatic gear rules downloaded.",autoGearExportError:"Automatic gear rules export failed.",autoGearImportButton:"Import rules",autoGearImportHelp:"Replace your automatic gear rules with a file you previously exported.",autoGearImportConfirm:"Replace your automatic gear rules with the imported file?",autoGearImportSuccess:"Automatic gear rules imported.",autoGearImportError:"Import failed. Please choose a valid automatic gear rules file.",autoGearImportSchemaError:"Import failed. The file does not match the automatic gear rules export format.",autoGearImportMetadataLabelType:"type marker",autoGearImportMetadataLabelVersion:"version",autoGearImportMetadataLabelTimestamp:"marca temporale",autoGearImportMissingMetadataWarning:"Imported rules are missing required metadata: {fields}. Confirm the file comes from a trusted export before saving.",autoGearImportInvalidMetadataWarning:"Imported rules include invalid metadata: {fields}. Confirm the file comes from a trusted export before saving.",autoGearImportNewerVersionWarning:"Imported rules were created with version {importVersion}, which is newer than this build ({appVersion}). Double-check compatibility before relying on them.",autoGearImportOlderVersionWarning:"Imported rules were created with version {importVersion}, which is older than this build ({appVersion}). Review them to confirm they still match your workflow.",autoGearImportInvalidVersionWarning:'Imported rules report version "{value}", which is not a valid semantic version string.',autoGearImportInvalidTimestampWarning:'The import timestamp "{value}" could not be verified. Confirm the file has not been modified.',autoGearBackupsHeading:"Automatic backups",autoGearBackupsDescription:"Backups save your rules every 10 minutes when changes occur and keep up to 50 tracked changes between full snapshots. Restore a snapshot if something goes wrong.",autoGearShowBackupsLabel:"Show automatic backups",autoGearShowBackupsHelp:"Reveal the snapshots captured in the background.",autoGearBackupsHidden:"Automatic backups stay hidden until you turn them on.",autoGearBackupSelectLabel:"Choose a backup",autoGearBackupSelectPlaceholder:"Select a backup to restore",autoGearBackupEmpty:"No automatic backups yet.",autoGearBackupRestore:"Restore",autoGearBackupRestoreConfirm:"Replace your automatic gear rules with this backup?",autoGearBackupRestoreSuccess:"Automatic gear backup restored.",autoGearBackupRestoreError:"Automatic gear backup restore failed.",autoGearBackupSaved:"Automatic gear backup saved.",autoGearBackupFailed:"Automatic gear backup failed.",autoGearBackupRetentionLabel:"Automatic backup retention",autoGearBackupRetentionHelp:"Choose how many automatic gear backups stay on this device.",autoGearBackupRetentionSummary:"Keeping the latest {limit}. Currently {stored} stored.",autoGearBackupRetentionWarning:"Lowering to {limit} will remove {trimmed}. A safety snapshot will be saved first.",autoGearBackupRetentionConfirm:"Save a safety snapshot and trim older backups now?",autoGearBackupRetentionSafetyNote:"Retention lowered to {limit}.",autoGearBackupRetentionSafetyNoteTrimmed:"Retention lowered to {limit}. Removed {trimmed} in this change.",autoGearBackupRetentionSafetySaved:"Safety snapshot captured before trimming backups.",autoGearBackupRetentionSafetyFailed:"Safety snapshot failed. Retention was not changed.",autoGearBackupRetentionUpdated:"Retention updated to {limit}. Removed {trimmed}.",autoGearBackupRetentionUpdatedNoTrim:"Retention updated to {limit}. No backups were removed.",autoGearBackupRetentionExpanded:"Retention updated to {limit}.",autoGearBackupRetentionUpdateFailed:"Could not apply the new retention limit. Try again.",autoGearRulesCountOne:"%s rule",autoGearRulesCountOther:"%s rules",autoGearRuleToggleEnable:"Enable rule",autoGearRuleToggleDisable:"Disable rule",autoGearRuleEnabledLabel:"Enabled",autoGearRuleDisabledLabel:"Disabled",autoGearSummaryAllDisabled:"All automatic gear rules are disabled.",autoGearSummaryDisabledSuffix:"{count} disabled rules are ignored in coverage.",autoGearSummaryDisabledNote:"Disabled rules are visible below but ignored until re-enabled.",autoGearBackupClearsRules:"Clears all rules",autoGearBackupMeta:"%s · %s",autoGearAddsCountOne:"%s addition",autoGearAddsCountOther:"%s additions",autoGearAddsListLabel:"Adds",autoGearItemSummaryWithCategory:"%s × %s (%s)",autoGearItemSummary:"%s × %s",autoGearRemovalsCountOne:"%s removal",autoGearRemovalsCountOther:"%s removals",autoGearDuplicateRule:"Duplicate",autoGearDuplicateSuffix:"Copy",autoGearDeleteRule:"Delete",autoGearDeleteConfirm:"Delete this rule?",autoGearItemNameRequired:"Enter an item name first.",autoGearEditSingleItemWarning:"Edit one item at a time.",autoGearRuleScenarioRequired:"Select a scenario before saving.",autoGearRuleNeedsItems:"Add at least one item to add or remove before saving.",autoGearListRemove:"Remove",autoGearListEdit:"Edit",autoGearEmptyList:"No items yet.",autoGearDraftImpactHeading:"Draft impact preview",autoGearDraftImpactDescription:"Simulated totals showing how this draft would change shared gear outputs.",autoGearDraftImpactEmpty:"No changes detected yet. Add or adjust items to preview the impact.",autoGearDraftImpactUnavailable:"Preview becomes available after this rule includes at least one item.",autoGearDraftImpactTotals:"Current total: %s → After save: %s",autoGearDraftImpactChange:"Change: %s",autoGearDraftImpactStackedOne:"Stacked across %s rule.",autoGearDraftImpactStackedOther:"Stacked across %s rules.",autoGearDraftImpactConflictOne:"Removals also active in %s rule.",autoGearDraftImpactConflictOther:"Removals also active in %s rules.",autoGearDraftWarningHeading:"Warnings",autoGearDraftWarningCritical:"%s would drop out of the kit list.",autoGearDraftWarningConflict:"%s has conflicting add and remove instructions.",autoGearDraftWarningRedundant:"%s is added by multiple rules without increasing totals.",autoGearDraftWarningConfirm:"Save anyway? Review the impact warnings below before confirming.",autoGearCustomCategory:"Custom Additions",autoGearAddScreenSizeLabel:"Screen size",autoGearAddSelectorTypeLabel:"Selector",autoGearAddSelectorDefaultLabel:"Default item",autoGearAddSelectorIncludeLabel:"Include selector",autoGearAddNotesLabel:"Notes",autoGearRemoveScreenSizeLabel:"Screen size",autoGearRemoveSelectorTypeLabel:"Selector",autoGearRemoveSelectorDefaultLabel:"Default item",autoGearRemoveSelectorIncludeLabel:"Include selector",autoGearRemoveNotesLabel:"Notes",autoGearSelectorDefaultPlaceholder:"Choose a default device",autoGearSelectorNoneOption:"No selector",autoGearSelectorMonitorOption:"Monitor selector",autoGearSelectorDirectorOption:"Director monitor selector",autoGearSelectorTripodHeadOption:"Tripod head selector",autoGearSelectorTripodBowlOption:"Tripod bowl selector",autoGearSelectorTripodTypesOption:"Tripod type selector",autoGearSelectorTripodSpreaderOption:"Tripod spreader selector",autoGearSelectorFizHandUnitOption:"FIZ hand unit selector",autoGearSelectorScrollHint:"Scroll to see more devices.",autoGearSelectorSummaryWithDefault:"%s selector (default: %s)",autoGearSelectorSummary:"%s selector",autoGearSelectorSummaryNoSelector:"%s default: %s",autoGearRuleTooltipNamed:"Added by automatic gear rule “%s”.",autoGearRuleTooltipUnnamed:"Added by an automatic gear rule.",autoGearRuleBadgeNamed:"Rule: %s",autoGearRuleBadgeUnnamed:"Automatic rule",accessibilityHeading:"Accessibility",accessibilityHeadingHelp:"Adjust contrast and other options that improve legibility.",highContrastSetting:"High contrast",highContrastSettingHelp:"Increase contrast for text and outlines to boost readability in any theme.",reduceMotionSetting:"Reduce motion",reduceMotionSettingHelp:"Limit color and interface animations so transitions feel steady for motion-sensitive users.",relaxedSpacingSetting:"Relaxed spacing",relaxedSpacingSettingHelp:"Increase line spacing and control padding to make text easier to scan and tap.",backupHeading:"Backup & Restore",backupHeadingHelp:"Manage full backups of settings, saved projects, custom devices, queued vault entries, and runtime feedback.",backupVaultHeading:"Data Vault (Backups)",backupVaultLoading:"Loading backups…",backupVaultEmptyTitle:"No backups found in the vault.",backupVaultEmptySubtitle:"Backups are created automatically when you save projects.",backupVaultLoadError:"Failed to load backups: {message}",backupVaultLoadErrorFallback:"Unable to load backups.",backupVaultRestoreAriaLabel:"Restore {name}",backupVaultDeleteAriaLabel:"Delete {name}",backupVaultRestoreConfirm:"Restore {name}? This will overwrite current data.",backupVaultUnknownFormat:"Unknown backup format.",backupVaultRestoreSuccess:"Project restored successfully!",backupVaultRestoreLocked:"This project is locked by another session.",backupVaultRestoreUnknownError:"Unknown error.",backupVaultRestoreFailed:"Restore failed. {reason}",backupVaultRestoreError:"Failed to restore: {message}",backupVaultDeleteConfirm:"Delete {name}?",backupVaultDeleteError:"Failed to delete backup: {message}",backupVaultDeleteErrorFallback:"Failed to delete backup.",projectBackupsHeading:"Project Backups",projectBackupsDescription:"Manage automatic snapshots and compare saved versions before restoring changes.",showAutoBackupsSetting:"Show auto backups in project list",showAutoBackupsHelp:"Temporarily list automatic backup snapshots in Saved Projects so you can restore them manually.",versionCompareButton:"Compare versions",versionCompareButtonHelp:"Review differences between saves, add notes, and export a comparison log.",versionCompareHeading:"Version comparison",versionCompareIntro:"Pick two manual saves or automatic backups to inspect changes before archiving a log.",versionComparePrimaryLabel:"Baseline version",versionCompareSecondaryLabel:"Comparison version",versionCompareSelectPlaceholder:"Select a version",versionCompareEmpty:"Save a project or wait for auto-backups to start comparing versions.",versionCompareNoSelection:"Choose two versions to generate a diff.",versionCompareSameSelection:"Select two different versions to compare.",versionCompareDifferencesCountOne:"%s difference noted.",versionCompareDifferencesCountOther:"%s differences noted.",versionCompareIdentical:"Versions match—no changes detected.",versionCompareManualLabel:"Manual save",versionCompareAutoLabel:"Auto backup",versionCompareAutoDeleteLabel:"Auto backup before delete",versionCompareNotesLabel:"Incident notes",versionCompareNotesPlaceholder:"Record context, on-set observations, or required follow-up.",versionCompareExport:"Export log",versionCompareExportHelp:"Download a JSON copy of this comparison and your notes.",versionCompareClose:"Close",versionCompareExportSuccess:"Comparison log exported.",versionCompareExportFailure:"Comparison export failed.",versionCompareMissingSelection:"Select two versions before exporting a log.",versionCompareChangeAdded:"Added",versionCompareChangeRemoved:"Removed",versionCompareChangeUpdated:"Updated",versionCompareMissingValue:"Not present",versionCompareRootPath:"Entire setup",versionCompareListItemLabel:"Item %s",versionCompareSummaryAdded:"Added: %s",versionCompareSummaryRemoved:"Removed: %s",versionCompareSummaryChanged:"Updated: %s",backupSettings:"Backup",backupSettingsHelp:"Download a full JSON backup containing every project, device edit, preference, auto-gear rule, queued backup vault entry, and runtime log stored on this device. Keep multiple copies in your offline archive.",restoreSettings:"Restore",restoreSettingsHelp:"Restore a full JSON backup. The planner captures a fresh safety copy first, then replaces stored preferences and session data with the selected file so you can roll back immediately if anything looks wrong.",restoreRehearsalButton:"Restore rehearsal",restoreRehearsalButtonHelp:"Test a backup or project bundle in a disposable sandbox before you restore your live data.",restoreRehearsalHeading:"Restore rehearsal",restoreRehearsalIntro:"Load a backup or project bundle into a disposable workspace. We compare key counts with your live profile and clear the sandbox automatically.",restoreRehearsalModeLabel:"Choose a rehearsal source",restoreRehearsalModeBackup:"Full app backup (.json)",restoreRehearsalModeProject:"Project bundle (.json)",restoreRehearsalFileLabel:"Select file",restoreRehearsalFileButton:"Choose file",restoreRehearsalNoFile:"No file selected yet.",restoreRehearsalReady:"Sandbox ready. Pick a JSON file to inspect.",restoreRehearsalProcessing:"Loading file in an isolated sandbox…",restoreRehearsalMatch:"All counts match. The sandbox was cleared automatically.",restoreRehearsalMismatch:"Differences detected: %s. The sandbox was cleared automatically.",restoreRehearsalError:"Restore rehearsal failed. Check the file and try again.",restoreRehearsalBackupMismatch:"File doesn't look like a full app backup. Double-check the source and try again.",restoreRehearsalProjectMismatch:"File doesn't look like a project bundle. Double-check the source and try again.",restoreRehearsalRuleHeading:"Automatic gear rule changes",restoreRehearsalRuleIntro:"Compare every automatic gear rule before loading the sandbox. Live rules stay untouched.",restoreRehearsalRuleEmpty:"No automatic gear rule differences found.",restoreRehearsalRuleAddsLabel:"Automatic additions",restoreRehearsalRuleRemovesLabel:"Automatic removals",restoreRehearsalRuleScenariosLabel:"Scenario scope",restoreRehearsalRuleNone:"None",restoreRehearsalRuleLogicLabel:"Scenario logic",restoreRehearsalRuleBaseLabel:"Base scenario",restoreRehearsalRuleMultiplierLabel:"Multiplier",restoreRehearsalRuleRequiredLabel:"Required scenarios",restoreRehearsalRuleAlwaysLabel:"Always active",restoreRehearsalRuleFallback:"Automatic rule change",restoreRehearsalProceed:"Resume restore rehearsal",restoreRehearsalProceedHelp:"Stage the sandbox snapshot to continue the rehearsal.",restoreRehearsalProceedMessage:"Sandbox snapshot staged. Live data remains untouched until you perform a full restore.",restoreRehearsalAbort:"Abort rehearsal",restoreRehearsalAbortHelp:"Discard the sandbox snapshot and keep live data unchanged.",restoreRehearsalAbortMessage:"Rehearsal sandbox cleared. Live data remains untouched.",restoreRehearsalTableCaption:"Backup rehearsal comparison",restoreRehearsalMetricColumn:"Data type",restoreRehearsalLiveColumn:"Live profile",restoreRehearsalSandboxColumn:"Sandbox import",restoreRehearsalDifferenceColumn:"Difference",restoreRehearsalClose:"Close rehearsal",restoreRehearsalMetricProjects:"Projects",restoreRehearsalMetricProjectDetails:"Project details",restoreRehearsalMetricCrew:"Crew entries",restoreRehearsalMetricSchedule:"Schedule entries",restoreRehearsalMetricRules:"Automatic gear rules",restoreRehearsalMetricFavorites:"Favorites",restoreRehearsalMetricDeviceLibrary:"Device library entries",restoreRehearsalMetricSession:"Stored session snapshot",restoreRehearsalMetricFeedback:"Feedback drafts",restoreRehearsalMetricAutoPresets:"Automatic gear presets",restoreRehearsalMetricAutoBackups:"Automatic gear backups",restoreRehearsalMetricBackupHistory:"Backup history entries",restoreRehearsalMetricCustomFonts:"Custom fonts",restoreRehearsalMetricCustomLogo:"Custom logo saved",restoreRehearsalMetricPreferences:"Stored preferences",restoreRehearsalMetricSchemaCache:"Device schema cache",restoreRehearsalMatchLabel:"Match",restoreRehearsalDifferenceListJoin:", ",restoreRehearsalIncreaseLabel:"Sandbox includes %d more %s.",restoreRehearsalDecreaseLabel:"Sandbox includes %d fewer %s.",factoryResetButton:"Factory reset",factoryResetButtonHelp:"Create a backup and wipe all planner data after confirmation.",confirmFactoryReset:"Create a backup and wipe all planner data?",confirmFactoryResetAgain:"Last warning: all projects, devices, settings and feedback will be deleted. Continue?",factoryResetBackupFailed:"Backup failed. Data was not deleted.",factoryResetAwaitDownload:"Allow downloads to save your backup. The factory reset will continue after you accept the download.",factoryResetDownloadBlocked:"The backup download was blocked. Data was not deleted.",factoryResetSuccess:"Backup downloaded. All planner data cleared. Reloading…",factoryResetError:"Factory reset failed. Please try again.",preDeleteBackupSuccess:"Automatic safety copy stored before deletion. Find the matching auto-backup entry under Saved Projects and rename it if you plan to keep it permanently.",preDeleteBackupFailed:"Automatic backup failed. The action was cancelled.",restoreBackupFailed:"Backup failed. Restore cancelled.",restoreBackupQueuedConfirm:"The safety backup is waiting in the local vault. Continue with the restore now?",manualDownloadFallback:"The download didn't start automatically. A new tab opened with the file contents so you can copy or save them manually.",manualDownloadCopyHint:"Select all the text below and copy it to keep the file safe.",dataHeading:"Data & Storage",dataHeadingHelp:"Review what the planner stores locally and how much space backups take.",storageSummaryIntro:"Everything below stays in this browser unless you export or clear it.",storageSummaryFootnote:"Backups download human-readable JSON with each entry—Quick safeguards keep fresh copies one click away.",storageSummaryEmpty:"No planner data is currently stored.",storagePersistenceHeading:"Storage reliability",storagePersistenceHeadingHelp:"Ask the browser to keep Cine Power Planner's data safe from automatic cleanups.",storagePersistenceIntro:"Request persistent storage so the browser keeps planner data even when space runs low.",storagePersistenceRequest:"Protect storage on this device",storagePersistenceRequestHelp:"Tell the browser to mark Cine Power Planner's data as persistent.",storagePersistenceStatusIdle:"Request persistent storage to reduce the risk of automatic cleanup.",storagePersistenceStatusChecking:"Checking storage protection…",storagePersistenceStatusRequesting:"Requesting persistent storage from the browser…",storagePersistenceStatusGranted:"Persistent storage granted. Planner data is protected from automatic cleanup.",storagePersistenceStatusDenied:"The browser could not grant persistent storage. Keep exporting backups regularly.",storagePersistenceStatusSafariIncompatible:"Safari currently blocks persistent storage requests. Treat this as a browser limitation.",storagePersistenceStatusError:"Persistent storage request failed. Try again after freeing space or review browser settings.",storagePersistenceStatusUnsupported:"This browser cannot grant persistent storage automatically. Continue keeping external backups.",storagePersistenceUsage:"Approximate usage: {used} of {quota}.",storagePersistenceUsageUnknown:"Approximate usage: {used}.",storageActionsHeading:"Quick safeguards",storageActionsHeadingHelp:"Download full backups or jump straight to restore tools from here.",storageActionsIntro:"Capture a fresh full backup or open restore utilities without leaving this tab.",storageBackupNow:"Download full backup",storageBackupNowHelp:"Exports the entire planner snapshot, including projects, auto backups and preferences.",storageOpenBackupTab:"Open Backup & Restore",storageOpenBackupTabHelp:"Switch to the Backup & Restore tab for rehearsal, restore and factory reset tools.",storageStatusHeading:"Latest activity",storageStatusHeadingHelp:"Review the most recent saves and backups at a glance.",storageStatusLastProjectLabel:"Latest project save",storageStatusLastAutoBackupLabel:"Latest auto backup",autoBackupInProgressNotice:"Auto backup running. Performance may pause briefly.",storageStatusLastFullBackupLabel:"Latest full app backup",loggingSectionHelp:"Review runtime diagnostics without leaving Settings. Service worker entries stream in automatically so offline cache and activation events stay visible.",loggingHeading:"Diagnostics log",loggingHeadingHelp:"Review runtime diagnostics without leaving Settings.",loggingIntro:"The log updates live while Settings stay open. Console capture runs by default so transcripts stay local; adjust the toggles below if you need to change diagnostics behavior. Nothing leaves this device.",loggingLevelFilterLabel:"Show entries from",loggingLevelFilterHelp:"Choose the minimum level to display.",loggingLevelFilterAll:"All levels",loggingLevelFilterInfo:"Info and above",loggingLevelFilterWarn:"Warnings and errors",loggingLevelFilterError:"Errors only",loggingNamespaceFilterLabel:"Namespace filter",loggingNamespaceFilterPlaceholder:"Filter namespaces (for example, backup)",loggingNamespaceFilterHelp:"Type a namespace such as “backup”, “autosave” or “logging”.",loggingHistoryLimitLabel:"History size",loggingHistoryLimitHelp:"Maximum entries stored on this device.",loggingHistoryLimitStatus:"Storing up to {count} entries locally.",loggingHistoryLimitAria:"Set how many log entries stay available offline",loggingConsoleOutputLabel:"Mirror to console",loggingConsoleOutputHelp:"Keep the browser console in sync with these entries.",loggingCaptureConsoleLabel:"Capture console output",loggingCaptureConsoleHelp:"Record console messages for diagnostics. Leave this enabled unless you need to reduce logging overhead.",loggingCaptureErrorsLabel:"Capture global errors",loggingCaptureErrorsHelp:"Record uncaught errors and unhandled promise rejections.",loggingPersistSessionLabel:"Keep log between reloads",loggingPersistSessionHelp:"Store entries in session storage so diagnostics survive refreshes.",loggingExportButton:"Export log",loggingExportHelp:"Download the full diagnostics log as a JSON file.",loggingExportSuccess:"Diagnostics log exported.",loggingExportError:"Log export failed. Try again after reloading Settings.",loggingExportUnavailable:"Logging unavailable. Try again after reloading Settings.",loggingStatusIdle:"Live log ready.",loggingStatusUpdating:"Updating log…",loggingStatusExporting:"Preparing log export…",loggingStatusExported:"Diagnostics log ready for download.",loggingStatusExportFailed:"Log export failed.",loggingStorageEstimateUpdated:"Storage estimate refreshed.",loggingStorageQuotaOnly:"Available storage: {quota}.",loggingStatusError:"Logging unavailable. Diagnostics remain in the browser console.",loggingEmptyState:"No log entries captured yet.",loggingEmptyFiltered:"No log entries match the current filters.",loggingUnavailable:"Logging module unavailable. Console output continues as a fallback.",loggingLevelDebug:"Debug",loggingLevelInfo:"Info",loggingLevelWarn:"Warning",loggingLevelError:"Error",loggingEntryTimestampLabel:"Time",loggingEntryNamespaceLabel:"Namespace",loggingEntryMetaLabel:"Meta",loggingEntryDetailLabel:"Details",loggingTimestampCombined:"{local} ({iso})",storageStatusNever:"Not captured yet.",storageStatusStoredWithoutTimestamp:"Stored (timestamp not recorded).",storageStatusTimestamp:"Captured {relative} ({absolute}).",storageStatusTimestampAbsolute:"Captured {absolute}.",storageStatusWithName:"{name} — {time}",storageStatusReminderUpToDate:"Backups look fresh. Keep autosave running and capture a full backup after major changes.",storageStatusReminderSaveProject:"Save a named project so your latest work stays protected offline.",storageStatusReminderRefreshProject:"Save your project again soon (last save {time}).",storageStatusReminderAutoBackupFirst:"Keep Cine Power Planner open until it captures an automatic backup.",storageStatusReminderAutoBackup:"Let an automatic backup run again soon (last snapshot {time}).",storageStatusReminderFullBackupFirst:"Download a full backup to archive every dataset before going offline.",storageStatusReminderFullBackup:"Download another full backup when possible (last archive {time}).",storageStatusReminderConnectivity:"Connectivity degraded — {reason} Keep working from the offline copy and avoid clearing caches until the banner clears.",storageKeyProjects:"Saved projects",storageKeyProjectsDesc:"Configurations saved from Manage Project.",storageProjectsCountOne:"%s project",storageProjectsCountOther:"%s projects",storageKeyAutoBackups:"Auto backups",storageKeyAutoBackupsDesc:"Timestamped safety copies saved every 10 minutes or after 50 tracked changes. Switching projects, importing, exporting or preparing to reload triggers an immediate snapshot even if that cadence hasn't elapsed.",storageAutoBackupsCountOne:"%s auto backup",storageAutoBackupsCountOther:"%s auto backups",storageKeyGearLists:"Kit list snapshots",storageKeyGearListsDesc:"Printable overviews and production requirements.",storageGearListsCountOne:"%s entry",storageGearListsCountOther:"%s entries",storageKeyDevices:"Custom or modified devices",storageKeyDevicesDesc:"Differences from the built-in device library.",storageDevicesCountOne:"%s device",storageDevicesCountOther:"%s devices",storageDeviceCategories:"Affected categories: %s",storageKeyFavorites:"Pinned favorites",storageKeyFavoritesDesc:"Dropdown entries marked with a star.",storageFavoritesCountOne:"%s favorite",storageFavoritesCountOther:"%s favorites",storageKeyFeedback:"Runtime feedback",storageKeyFeedbackDesc:"User-submitted runtime reports.",storageFeedbackCountOne:"%s entry",storageFeedbackCountOther:"%s entries",storageKeySession:"Unsaved session",storageKeySessionDesc:"Restores the working project after a reload.",storageKeyFullBackups:"Full app backups",storageKeyFullBackupsDesc:"Downloads created from Backup & Restore or hourly safety copies, including queued vault entries.",storageFullBackupsCountOne:"%s backup",storageFullBackupsCountOther:"%s backups",queuedBackupDownloadDeferred:"Automatic downloads were blocked. We saved {fileName} in the local vault so the next tap can export it safely.",queuedBackupVaultEmpty:"No queued backups are waiting in the local vault.",queuedBackupVaultTitle:"Local backup vault",queuedBackupVaultIntro:"Automatic downloads were blocked. Review the backups below and download them manually while you have the browser ready offline.",queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.",queuedBackupBannerMessageOne:"1 backup saved in the local vault.",queuedBackupBannerMessageOther:"{count} backups saved in the local vault.",queuedBackupBannerGesture:"Interact with the planner to export them safely.",queuedBackupBannerAction:"Open local backup vault",queuedBackupFallbackHint:"Emergency fallback storage active. Export queued backups immediately.",storageSessionStored:"Stored",storageSessionNotStored:"Not stored",storageKeyTotalSize:"Approximate backup size",storageKeyTotalSizeDesc:"Based on the current backup export.",storageKeyIntegrityGuard:"Backup guardian",storageKeyIntegrityGuardDesc:"Mirrors every critical storage key into a backup slot before any edits.",storageIntegrityGuardStatus:"Active",storageIntegrityGuardStatusCreated:"Mirrored {count} key(s) this session",storageIntegrityGuardStatusIssue:"{count} issue(s) — check console",storageIntegrityGuardStatusMissing:"Waiting for first save",storageTotalSizeValue:"~%s KB",aboutHeading:"About & Support",aboutHeadingHelp:"Review version details and reach support resources.",versionLabel:"Version",supportLink:"Support",supportLinkHelp:"Open the GitHub repository in a new tab.",reportBugLink:"Report a bug",reportBugLinkHelp:"Open the GitHub issues tracker to report a bug.",suggestFeatureLink:"Suggest a feature",suggestFeatureLinkHelp:"Open the GitHub issues tracker to share feature ideas.",restoreSuccess:"Settings restored. Reload to apply all changes.",restoreVerificationMatch:"Restore verification passed. Live data matches the backup snapshot.",restoreVerificationMismatch:"Restore verification found differences. Review the counts before continuing:",restoreVerificationDifference:"{label}: backup {expected}, live {actual}",restoreVerificationFailed:"Restore verification could not confirm the imported data. Review the backup manually.",restoreVerificationUnknownMetric:"Metric",restoreFailed:"Restore failed. Check the backup file and try again.",restoreVersionWarning:"Backup created with a different version. Some features might not transfer.",restoreVersionSummaryTitle:"Older backup detected",restoreVersionSummaryHeading:"This backup was created with {oldVersion} and you are running {newVersion}.",restoreVersionCoreMissing:"Not included in this backup:",restoreVersionStorageMissing:"Stored preferences not included:",restoreVersionOptionalMissing:"Optional items you may need to recreate:",restoreVersionNoIssues:"All modern data sections were found in this backup.",restoreVersionTip:"We saved a safety backup of your current data before importing.",restoreVersionFooter:"You can continue and manually recreate the missing items afterward.",restoreVersionUnknownVersion:"unknown version",restoreVersionBackupLabel:"Safety backup saved before restore: {fileName}",restoreSectionDevices:"Device library",restoreSectionSetups:"Saved setups",restoreSectionProjects:"Projects",restoreSectionFavorites:"Favorites",restoreSectionAutoGearRules:"Automatic gear rules",restoreSectionAutoGearPresets:"Automatic gear presets",restoreSectionAutoGearBackups:"Automatic gear backups",restoreSectionAutoGearActivePreset:"Selected automatic gear preset",restoreSectionAutoGearAutoPreset:"Automatic assignment preset",restoreSectionAutoGearVisibility:"Automatic backup visibility",restoreSectionAutoGearBackupRetention:"Automatic backup retention",restoreSectionAutoGearSeeded:"Automatic gear onboarding status",restoreSectionAutoGearMonitorDefaults:"Monitor defaults",restoreSectionSession:"Current planner session",restoreSectionFeedback:"Feedback drafts",restoreSectionPreferences:"App preferences",restoreSectionCustomLogo:"Custom logo",restoreSectionCustomFonts:"Custom fonts",restoreSectionSchemaCache:"Device schema cache",restoreSectionFullBackupHistory:"Backup history",restoreSectionStoredSettings:"Stored settings snapshot",restoreSectionStoredSession:"Stored session snapshot",saveSettings:"Save",saveSettingsHelp:"Apply personalization changes and close Settings.",cancelSettings:"Cancel",cancelSettingsHelp:"Close Settings without saving; previous colors and logo are restored.",reloadAppLabel:"Force reload",reloadAppHelp:"Clear cached files, unregister outdated service workers and reload without removing saved data. The app now verifies connectivity before cleanup, broadcasts fallback status to the offline banner, and preloads the fresh bundle so the new version appears faster.",reloadAppOfflineNotice:"Offline or degraded — force reload pings the server first, so reconnect and try again.",favoriteToggleLabel:"Toggle favorite",favoriteToggleHelp:"Mark the current selection as a favorite to pin it to the top of the list.",savedSetupsLabel:"Saved Projects:",newSetupOption:"-- New Project --",setupNameLabel:"Project Name:",generatedOnLabel:"Generated on",deleteSetupBtn:"Delete",saveSetupBtn:"Save",updateSetupBtn:"Update",clearFilter:"Clear filter",shareSetupBtn:"Export Project",shareSetupPrompt:"Project file ready to export. Crew contacts are included.",shareLinkCopied:"Project file downloaded.",shareExportFailed:"Project export failed.",shareLinkTooLong:"Project data is too large to export.",shareFilenamePrompt:"Enter a name for the exported project file (default: {defaultName}).",shareFilenameInvalid:"Please enter a valid file name to continue.",shareIncludeAutoGearConfirm:"Include automatic gear rules in the exported file? Select OK to include them or Cancel to skip.",shareIncludeAutoGearLabel:"Include automatic gear rules",shareIncludeAutoGearHelp:"Add your automatic gear rules to the exported project file.",shareIncludeOwnedGearLabel:"Mark owned gear in export",shareIncludeOwnedGearHelp:"Add ownership badges for gear you marked as yours when exporting.",shareDialogTitle:"Export Project",shareFilenameLabel:"Export file name",shareDialogConfirm:"Download",shareDialogCancel:"Cancel",sharedLinkLabel:"Project file",loadSharedLinkBtn:"Import Project",invalidSharedLink:"Invalid project file.",sharedImportAutoGearLabel:"Automatic gear rules",sharedImportAutoGearNone:"Do not import automatic gear rules",sharedImportAutoGearNoneHelp:"Load the project without applying the shared automatic rules.",sharedImportAutoGearProject:"Use shared rules for this project only",sharedImportAutoGearProjectHelp:"Save the shared automatic gear rules as a preset, apply it here, and restore your previous preset for other projects.",sharedImportAutoGearGlobal:"Use shared rules for all projects",sharedImportAutoGearGlobalHelp:"Save the shared automatic gear rules as a preset, activate it, and keep it selected for every project.",sharedImportAutoGearPresetName:"Shared rules – %s",sharedImportAutoGearPresetFallback:"Shared automatic gear rules",sharedImportDialogTitle:"Automatic gear rules",sharedImportDialogMessage:"Choose how to apply the shared automatic gear rules from this project.",sharedImportMetadataTimestamp:"Exported {timestamp}",sharedImportMetadataVersion:"Planner version {version}",sharedImportMetadataVersionMismatch:"Planner version {importVersion} (current build {appVersion})",sharedImportMetadataIncludesAutoGear:"Includes automatic gear rules",sharedImportMetadataIncludesOwnedGear:"Marks owned gear items",sharedImportMetadataUnavailable:"Export details unavailable.",sharedImportDialogConfirm:"Apply",sharedImportDialogCancel:"Cancel",cameraLabel:"Camera:",monitorLabel:"Monitor:",videoLabel:"Wireless Transmitter:",cageLabel:"Camera Cage:",distanceLabel:"Distance Sensor:",batteryLabel:"Battery:",batteryBMountLabel:"B-Mount Battery:",batteryPlateLabel:"Battery Plate:",batteryHotswapLabel:"Battery Hotswap:",lensesLabel:"Lenses:",fizLegend:"FIZ (Follow Focus) Systems",fizMotorsLabel:"FIZ Motors:",fizControllersLabel:"FIZ Controllers:",fizLegendHelp:"Add motors, controllers or distance units for focus/iris/zoom control.",fizMotorsHelp:"Select focus, iris or zoom motors.",fizControllersHelp:"Choose hand units or controllers for your FIZ system.",breakdownListHelp:"Power consumption per device category.",totalPowerLabel:"Total Consumption:",totalPowerHelp:"Combined power draw of all selected devices.",availablePowerLabel:"Available Power:",totalCurrent144Label:"Total Current (at 14.4V):",totalCurrent144Help:"Current draw at the battery's high-voltage output (e.g., 14.4V pins).",totalCurrent12Label:"Total Current (at 12V):",totalCurrent12Help:"Current draw from a 12V output such as D-Tap.",totalCurrent336Label:"Total Current (at 33.6V):",totalCurrent336Help:"Current draw at the battery's high-voltage output (e.g., 33.6V pins).",totalCurrent216Label:"Total Current (at 21.6V):",totalCurrent216Help:"Current draw from a 21.6V output such as B-Mount low-voltage.",batteryLifeLabel:"Runtime (estimated):",batteryLifeHelp:"Estimated runtime based on total draw and chosen battery capacity.",batteryCountLabel:"Batteries for 10h shoot:",batteryCountHelp:"Batteries needed for a 10-hour shoot.",runtimeFeedbackBtn:"Submit User Runtime Feedback",selectedGearHeading:"Selected Gear",recommendationsHeading:"Recommended Accessories",recommendationsHeadingHelp:"Accessories suggested based on selected devices.",weightingHeading:"Runtime Weighting Breakdown",pinWarningHelp:"Alerts if current exceeds what the battery pins can supply.",dtapWarningHelp:"Alerts if current exceeds what the D-Tap port can supply.",hotswapWarningHelp:"Alerts if the selected hotswap restricts available current.",methodPinsOnly:"pins only!",methodPinsAndDTap:"both pins and D-Tap",methodInfinite:"infinite",pinOk:"Battery pins can supply up to {max}A – current draw is within limits.",dtapOk:"D-Tap can supply up to {max}A – current draw is within limits.",warnPinExceededLevel:"warning",warnPinNearLevel:"note",warnDTapExceededLevel:"warning",warnDTapNearLevel:"note",warnPinExceeded:"WARNING: current draw ({current}A at ~12V) exceeds the battery's main output rating ({max}A)!",warnPinNear:"Note: current draw is close to the main output limit ({current}A of {max}A).",warnDTapExceeded:"WARNING: current draw ({current}A) exceeds the battery's D-Tap output ({max}A)!",warnDTapNear:"Note: current draw uses over 80% of the D-Tap capacity ({current}A of {max}A).",warnHotswapLower:"WARNING: hotswap current limit ({max}A) is lower than battery ({batt}A).",powerWarningTitle:"Battery cannot power this load",powerWarningLimitsHeading:"Output limits",powerWarningMessage:"“{battery}” must deliver {current}A, which exceeds every available output.",powerWarningPinsDetail:"Pins limit: {max}A",powerWarningPinsUnavailable:"Pins limit unavailable.",powerWarningDtapDetail:"D-Tap limit: {max}A",powerWarningDtapUnavailable:"No D-Tap output is available.",powerWarningDtapBlocked:"D-Tap cannot be used with the current configuration.",powerWarningAdvice:"Choose another battery, reduce the draw, or adjust your power distribution.",powerWarningClose:"Understood",incompatibleFIZWarning:"WARNING: incompatible FIZ brands selected.",missingFIZControllerWarning:"ERROR: FIZ motors require a controller with LBUS/CAM connection.",arriUMC4Warning:"WARNING: UMC-4 only works with LCS (LEMO 7-pin) to LBUS cable with LBUS devices.",arriRIA1Warning:"WARNING: RIA-1 or cforce RF controllers are not compatible with CLM-3/4/5.",arriCLMNoUMC4Warning:"WARNING: No FIZ controller present. Select a UMC-4 for a complete project. CLM-3/4/5 are not compatible with RIA-1, cforce RF or Master Grips.",distanceControllerWarning:"WARNING: Distance units require UMC-4, RIA-1 or cforce RF.",masterGripWirelessWarning:"WARNING: Master Grip has no wireless capability. Use RIA-1, UMC-4 or cforce RF for wireless control.",amiraCforceRemoteWarning:"ERROR: AMIRA with cforce Mini/Plus requires RIA-1, cforce RF, or UMC-4 for remote focus. Master Grips only allow local operator focus.",category_cameras:"Cameras",category_lenses:"Lenses",category_viewfinders:"Viewfinders",category_monitors:"Monitors",category_video:"Wireless Transmitter",category_wirelessReceivers:"Wireless Receiver",category_cages:"Cages",category_fiz_motors:"FIZ Motors",category_fiz_controllers:"FIZ Controllers",category_fiz_distance:"FIZ Distance",category_batteries:"Batteries",category_batteryHotswaps:"Battery Hotswap",category_accessory_batteries:"Accessory Batteries",category_cables:"Cables",category_camera_support:"Camera Support",category_chargers:"Chargers",category_cardReaders:"Card Reader",lensSpecBrandLabel:"Brand",lensSpecTypeLabel:"Lens Type",lensSpecMountLabel:"Mount",lensSpecFrontDiameterLabel:"Front Diameter",lensSpecTStopLabel:"T-stop",lensSpecImageCircleLabel:"Image Circle",lensSpecLengthLabel:"Length",lensSpecMinFocusLabel:"Minimum Focus",lensSpecWeightLabel:"Weight",lensSpecRodStandardLabel:"Rod Standard",lensSpecRodLengthLabel:"Rod Length",lensSpecClampOnLabel:"Clamp-on",lensSpecSupportLabel:"Lens Support",lensSpecCategoryGeneralLabel:"General",lensSpecCategoryOpticsLabel:"Optics",lensSpecCategoryPhysicalLabel:"Physical",lensSpecCategorySupportLabel:"Support",lensSpecCategoryNotesLabel:"Notes",lensSpecNotesLabel:"Notes",lensSpecFocusScaleLabel:"Focus Scale",lensSpecYes:"Yes",lensSpecNo:"No",lensSpecSupportRequired:"Required",lensSpecSupportNotRequired:"Not required",lensSpecUnknownValue:"Unknown",addDeviceHeading:"Add New Device",categoryLabel:"Category:",subcategoryLabel:"Subcategory:",deviceNameLabel:"Name:",consumptionLabel:"Consumption (W):",capacityLabel:"Capacity (Wh):",pinLabel:"Max Pin A:",dtapLabel:"Max D-Tap A:",cameraWattLabel:"Power Draw (W):",cameraVoltageLabel:"Voltage Range:",cameraPortTypeLabel:"Port Type:",cameraPlatesLabel:"Battery Plates:",cameraMediaLabel:"Recording Media:",cameraLensMountLabel:"Lens Mount:",lensDeviceMountHeading:"Lens Mount Options",lensDeviceMountLabel:"Mount options:",lensDeviceMountHelp:'Add every mount this lens supports. Choose "native" when no adapter is required.',lensFocusScaleLabel:"Focus scale unit:",lensFocusScaleHelp:"Choose the measurement markings shown for this lens. Leave the global default to follow project settings.",lensFocusScaleDefault:"Use global focus scale",powerInputsHeading:"Power Inputs",powerDistributionHeading:"Power Distribution",videoOutputsHeading:"Video Outputs",fizConnectorHeading:"FIZ Connector",mediaHeading:"Media",viewfinderHeading:"Viewfinder",lensMountHeading:"Lens Mount",timecodeHeading:"Timecode",powerDistributionLabel:"Outputs:",videoOutputsLabel:"Outputs:",fizConnectorLabel:"Connectors:",viewfinderLabel:"Viewfinders:",timecodeLabel:"Timecode:",monitorScreenSizeLabel:"Screen Size (in):",monitorBrightnessLabel:"Brightness (nits):",monitorWattLabel:"Power Draw (W):",monitorVoltageLabel:"Voltage Range:",monitorPortTypeLabel:"Port Type:",monitorVideoInputsHeading:"Video Inputs",monitorVideoInputsLabel:"Inputs:",monitorVideoOutputsHeading:"Video Outputs",monitorVideoOutputsLabel:"Outputs:",monitorWirelessTxLabel:"Wireless TX:",monitorLatencyLabel:"Latency:",monitorLatencyHelp:"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.",monitorAudioOutputLabel:"Audio Output:",viewfinderDetailsHeading:"Viewfinder Details",viewfinderScreenSizeLabel:"Screen Size (in):",viewfinderBrightnessLabel:"Brightness (nits):",viewfinderPowerHeading:"Power Input",viewfinderWattLabel:"Power Draw (W):",viewfinderVoltageLabel:"Voltage Range:",viewfinderPortTypeLabel:"Port Type:",viewfinderVideoInputsHeading:"Video Inputs",viewfinderVideoInputsLabel:"Inputs:",viewfinderVideoOutputsHeading:"Video Outputs",viewfinderVideoOutputsLabel:"Outputs:",viewfinderWirelessTxLabel:"Wireless TX:",viewfinderLatencyLabel:"Latency:",viewfinderLatencyHelp:"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.",videoPowerInputsHeading:"Power Inputs",videoVideoInputsHeading:"Video Inputs",videoVideoInputsLabel:"Inputs:",videoVideoOutputsHeading:"Video Outputs",videoVideoOutputsLabel:"Outputs:",videoPowerInputLabel:"Connectors:",videoPowerInputHelp:"Add every supported power connector, including battery plates. Use notes for mount adapters or other details.",videoPowerTypeLabel:"Connector",videoPowerVoltageLabel:"Voltage range",videoPowerNotesLabel:"Notes",videoPowerVoltagePlaceholder:"Voltage range (e.g. 6-28V)",videoPowerNotesPlaceholder:"Notes (mount, adapter, etc.)",videoFrequencyLabel:"Frequency:",videoLatencyLabel:"Latency:",motorConnectorLabel:"Connector:",motorInternalLabel:"Internal Controller:",motorTorqueLabel:"Torque (Nm):",motorGearLabel:"Gear Types:",controllerConnectorLabel:"Connector:",controllerPowerLabel:"Power Source:",controllerBatteryLabel:"Battery Type:",controllerConnectivityLabel:"Connectivity:",distanceConnectionLabel:"Connection:",distanceMethodLabel:"Method:",distanceRangeLabel:"Range:",distanceAccuracyLabel:"Accuracy:",distanceOutputLabel:"Display:",notesLabel:"Notes:",monitorDetailsHeading:"Monitor Details",monitorPowerHeading:"Power Input",addDeviceBtn:"Add",addDeviceBtnHelp:"Add the new device to the database.",updateDeviceBtn:"Update",updateDeviceBtnHelp:"Save changes to the current device.",editBtn:"Edit",editBtnHelp:"Modify this device's details.",deleteDeviceBtn:"Delete",deleteDeviceBtnHelp:"Remove this device from the database.",cancelEditBtn:"Cancel",cancelEditBtnHelp:"Cancel editing and clear the form.",exportDataBtn:"Export Database",exportDataBtnHelp:"Download the current device database as a JSON file.",importDataBtn:"Import Database",importDataBtnHelp:"Load a device database from a JSON file.",alertImportSuccess:"Database imported successfully! {num_devices} devices loaded.",alertImportError:"Failed to import database. Invalid file or data format.",confirmExportAndRevert:"Are you sure you want to export the current database AND then revert to the default database? This will overwrite your current saved data with the original defaults.",alertExportAndRevertSuccess:"Database exported and reverted to defaults successfully.",alertStorageError:"Storage error: Unable to access local data. Changes may not be saved.",alertSessionFallback:"Warning: Local storage is unavailable. Data will only persist for this browser tab.",placeholder_deviceName:"Device name",placeholder_watt:"e.g. 12.5",placeholder_capacity:"e.g. 98",placeholder_pin:"e.g. 10",placeholder_dtap:"e.g. 5",placeholder_voltage:"11V-34V DC",placeholder_port:"Bat LEMO 8-pin",placeholder_plates:'[{"type":"V-Mount","mount":"native"}]',placeholder_media:'[{"type":"CFast 2.0"}]',placeholder_lensmount:"ARRI PL",placeholder_powerdist:"[{}]",placeholder_videooutputs:"[{}]",placeholder_fizconnector:"[{}]",placeholder_timecode:"[{}]",placeholder_filter:"Filter {item}...",toggleDeviceManager:"Edit Device Data…",hideDeviceManager:"Hide Device Data",showDetails:"Show Details",hideDetails:"Hide Details",batteryTableLabel:"Battery",batteryLifeHeading:"Runtime comparison",runtimeLabel:"Estimated Runtime (h)",batteryLifeUnit:"hrs",runtimeAverageNote:"Note: runtime estimate uses a weighted average of user-submitted runtimes adjusted for resolution, codec, frame rate, brightness and temperature.",runtimeUserCountNote:"Based on {count} user reports for this project.",temperatureNoteHeading:"Temperature impact on runtime:",temperatureNoteHelp:"Shows how different temperatures affect battery runtime.",temperatureLabel:"Temperature",batteryCountTempLabel:"Batteries needed",noBatterySupports:"No battery can supply this load.",alertSetupName:"Please enter a name for the project.",alertSetupNeedsDevice:"You can save a project even if no devices are selected yet.",alertSetupSaved:'Project "{name}" saved in this browser. It stays available after closing or reopening tabs unless you clear the browser cache.',alertSetupSavedNoDevices:`Project "{name}" saved in this browser with no devices yet. Add gear and requirements whenever you're ready—we'll keep everything protected.`,alertSetupRenameSaveFailed:"We couldn’t finish saving the renamed project. Your original project is still available—please try saving again to keep everything in sync.",alertNoSetupSelected:"Please select a saved project to delete.",alertNoSetupSelectedTitle:"No Project Selected",alertSetupDeleted:'Project "{name}" deleted.',confirmDeleteSetup:'Really delete project "{name}"?',confirmDeleteSetupAgain:"This will permanently delete the project. Are you sure?",confirmDeleteDevice:'Really delete device "{name}"?',alertDeviceExists:"A device with this name already exists in this category.",alertDeviceAdded:'Device "{name}" added to category "{category}".',alertDeviceUpdated:'Device "{name}" updated in category "{category}".',alertDeviceFields:"Please provide valid values for capacity, Pin A and D-Tap A.",alertDeviceWatt:"Please enter a valid watt value.",alertDeviceName:"Device name cannot be empty.",alertInvalidCameraJSON:"Invalid JSON for camera details",generateOverviewBtn:"Generate Overview",generateGearListBtn:"Generate Kit List and Production Requirements",addExtraGearBtn:"Add temporary extra gear",editProjectBtn:"Edit Project requirements",projectForm:{heading:"Production Requirements",projectName:"Project Name:",productionCompany:"Production Company:",productionCompanyAddress:"Production Company Address (optional):",productionCompanyStreet:"Street address",productionCompanyStreetPlaceholder:"123 Production Way",productionCompanyStreet2:"Address line 2 (optional)",productionCompanyStreet2Placeholder:"Suite, building, etc.",productionCompanyCity:"City",productionCompanyCityPlaceholder:"Los Angeles",productionCompanyRegion:"State / Province / Region",productionCompanyRegionPlaceholder:"California",productionCompanyPostalCode:"Postal code",productionCompanyPostalCodePlaceholder:"90001",productionCompanyCountry:"Country",productionCompanyCountryPlaceholder:"United States",rentalHouse:"Rental:",crewHeading:"Crew",prepLabel:"Prep Days:",shootLabel:"Shooting Days:",returnLabel:"Return Day(s):",deliveryResolution:"Delivery Resolution:",recordingResolution:"Recording Resolution:",sensorMode:"Sensor Mode:",aspectRatio:"Aspect Ratio:",codec:"Codec:",baseFrameRate:"Base Frame Rate:",recordingFrameRate:"Recording Frame Rate:",recordingFrameRateRangeHint:"Enter a recording frame rate from 1 to {max} fps.",recordingFrameRateDefaultHint:"Enter the recording frame rate in frames per second.",slowMotionHeading:"Slow Motion Frame Rate",slowMotionRecordingResolution:"Slow Motion Recording Resolution:",slowMotionSensorMode:"Slow Motion Sensor Mode:",slowMotionAspectRatio:"Slow Motion Aspect Ratio:",slowMotionBaseFrameRate:"Slow Motion Base Frame Rate:",slowMotionRecordingFrameRate:"Slow Motion Recording Frame Rate:",slowMotionRecordingFrameRateRangeHint:"Enter a slow motion recording frame rate from 1 to {max} fps.",slowMotionRecordingFrameRateDefaultHint:"Enter the slow motion recording frame rate in frames per second.",lensesHeading:"Lenses",lensManufacturerStep:"Step 1: Select manufacturer",lensManufacturerPlaceholder:"Choose a manufacturer",lensSeriesStep:"Step 2: Select series",lensSeriesPlaceholder:"Choose a series",lensSeriesEmpty:"No series available for this manufacturer.",lensesLabel:"Step 3: Choose lenses",lensOptionsEmpty:"No lenses available for this series.",lensSelectionsLabel:"Selected lenses",lensSelectionsHint:"Selections update as you add or remove lenses.",lensRemoveLabel:"Remove {lens}",lensMountLabel:"Mount",riggingHeading:"Rigging & Mounting",requiredScenarios:"Shooting Scenarios & Environments",cameraHandle:"Camera Handle:",viewfinderExtension:"Viewfinder Extension:",viewfinderExtensionNone:"No",viewfinderExtensionYes:"Yes",matteboxFilterHeading:"Mattebox and Filter",mattebox:"Mattebox:",filter:"Filter:",storageHeading:"Storage & Media",storageNeedsLabel:"Recording media needs:",storageQuantityLabel:"Quantity",storageTypeLabel:"Media type:",storageVariantLabel:"Brand & capacity:",storageNotesLabel:"Notes:",storageTypePlaceholder:"Select media type",storageVariantPlaceholder:"Select brand & size",storageNotesPlaceholder:"Add notes (brand, capacity, recorder...)",storageDuplicateEntry:"Duplicate media row",storageSummaryFallback:"Media",monitoringHeading:"Monitoring",monitoringConfiguration:"Camera Monitoring Configuration:",viewfinderSettings:"Viewfinder Settings:",frameGuides:"Frameguides:",aspectMaskOpacity:"Aspect Mask Opacity:",videoDistribution:"Video distribution:",monitorUserButtons:"Onboard Monitor User Buttons:",cameraUserButtons:"Camera User Buttons:",viewfinderUserButtons:"Viewfinder User Buttons:",userButtonFunctions:{user1:"User 1",user2:"User 2",user3:"User 3",user4:"User 4",toggleLut:"Toggle LUT",falseColor:"False Color",peaking:"Peaking",anamorphicDesqueeze:"Anamorphic Desqueeze",surroundView:"Surround View",oneToOneZoom:"1:1 Zoom",waveform:"Waveform",histogram:"Histogram",vectorscope:"Vectorscope",zebra:"Zebra",playback:"Playback",record:"Record",zoom:"Zoom",frameLines:"Frame Lines",frameGrab:"Frame Grab",wb:"WB",iso:"ISO",nd:"ND",fps:"FPS",shutter:"Shutter"},tripodPreferencesHeading:"Tripod Preferences",tripodHeadBrand:"Head Brand:",tripodBowl:"Bowl type:",tripodTypes:"Tripod types:",tripodSpreader:"Spreader Preference:",cancel:"Cancel",addEntry:"Add",removeEntry:"Remove",submit:"OK",crewNamePlaceholder:"Name",crewPhonePlaceholder:"Phone",crewEmailPlaceholder:"Email",crewWebsitePlaceholder:"Website",crewRoleLabel:"Crew role",crewNameLabel:"Crew member name",crewPhoneLabel:"Crew member phone",crewEmailLabel:"Crew member email",crewWebsiteLabel:"Crew member website"},projectFields:{productionCompany:"Production Company",productionCompanyAddress:"Production Company Address",productionCompanyStreet:"Street address",productionCompanyStreetPlaceholder:"123 Production Way",productionCompanyStreet2:"Address line 2 (optional)",productionCompanyStreet2Placeholder:"Suite, building, etc.",productionCompanyCity:"City",productionCompanyCityPlaceholder:"Los Angeles",productionCompanyRegion:"State / Province / Region",productionCompanyRegionPlaceholder:"California",productionCompanyPostalCode:"Postal code",productionCompanyPostalCodePlaceholder:"90001",productionCompanyCountry:"Country",productionCompanyCountryPlaceholder:"United States",rentalHouse:"Rental",rentalHouseContact:"Rental contact",rentalHouseAddress:"Rental address",crew:"Crew",prepDays:"Prep Days",shootingDays:"Shooting Days",returnDays:"Return Days",deliveryResolution:"Delivery Resolution",recordingResolution:"Recording Resolution",aspectRatio:"Aspect Ratio",codec:"Codec",baseFrameRate:"Base Frame Rate",recordingFrameRate:"Recording Frame Rate",slowMotionRecordingResolution:"Slow Motion Recording Resolution",slowMotionSensorMode:"Slow Motion Sensor Mode",slowMotionAspectRatio:"Slow Motion Aspect Ratio",slowMotionBaseFrameRate:"Slow Motion Base Frame Rate",slowMotionRecordingFrameRate:"Slow Motion Recording Frame Rate",sensorMode:"Sensor Mode",lenses:"Lenses",requiredScenarios:"Required Scenarios",cameraHandle:"Camera Handle",viewfinderExtension:"Viewfinder Extension",viewfinderEyeLeatherColor:"Viewfinder Eye Leather Color",mattebox:"Mattebox",gimbal:"Gimbal",videoDistribution:"Video Distribution",monitoringSupport:"Monitoring support",monitoringConfiguration:"Monitoring configuration",focusMonitor:"Focus Monitor",monitorUserButtons:"Onboard Monitor User Buttons",cameraUserButtons:"Camera User Buttons",viewfinderUserButtons:"Viewfinder User Buttons",tripodHeadBrand:"Tripod Head Brand",tripodBowl:"Tripod Bowl",tripodTypes:"Tripod Types",tripodSpreader:"Tripod Spreader",sliderBowl:"Slider Bowl",easyrig:"Further Stabilisation",storageRequirements:"Storage & Media"},crewRoles:{Producer:"Producer","Production Manager":"Production Manager",Director:"Director","Assistant Director":"1st AD","Production Assistant":"Production Assistant",DoP:"DoP","Camera Operator":"Camera Operator","B-Camera Operator":"B-Camera Operator","Steadicam Operator":"Steadicam Operator","Drone Operator":"Drone Operator","1st AC":"1st AC","2nd AC":"2nd AC",DIT:"DIT","Video Operator":"Video Operator","Key Gaffer":"Gaffer",Gaffer:"Electric","Best Boy Electric":"Best Boy Electric",Electrician:"Electrician","Rigging Gaffer":"Rigging Gaffer","Key Grip":"Key Grip","Best Boy Grip":"Best Boy Grip",Grip:"Grip","Dolly Grip":"Dolly Grip","Rigging Grip":"Rigging Grip"},scenarios:{Indoor:"Indoor",Outdoor:"Outdoor",Studio:"Studio",Tripod:"Tripod",Handheld:"Handheld",Easyrig:"Easyrig","Cine Saddle":"Cine Saddle",Steadybag:"Steadybag",Dolly:"Dolly",Slider:"Slider",Steadicam:"Steadicam",Gimbal:"Gimbal",Trinity:"Trinity",Rollcage:"Rollcage","Car Mount":"Car Mount",Jib:"Jib","Undersling mode":"Undersling Mode",Crane:"Crane","Remote Head":"Remote Head","Extreme cold (snow)":"Extreme Cold (Snow)","Extreme rain":"Extreme Rain","Extreme heat":"Extreme Heat","Rain Machine":"Rain Machine","Slow Motion":"Slow Motion","Battery Belt":"Battery Belt"},gearListNoteLabel:"Note:",gearListAutosaveNote:"Autosaved after each rig tweak so the offline gear manifest mirrors your latest camera build.",gearListAddCustomItem:"Add custom item",gearListAddCustomItemToCategory:"Add custom item to {category}",gearListRemoveCustomItem:"Remove",gearListRemoveCustomItemFromCategory:"Remove custom item from {category}",gearListCustomItemQuantityLabel:"Quantity",gearListCustomItemQuantityAria:"Quantity for custom item in {category}",gearListCustomItemNameLabel:"Item name",gearListCustomItemNameAria:"Item name for custom item in {category}",gearListCustomItemNamePlaceholder:"Custom item",gearListCustomItemPreviewFallback:"Custom item",gearListCartSelectorLabel:"Camera cart",gearListCartConfigurationLabel:"Cart configuration",gearListCartAccessoriesLabel:"Cart accessories",gearListExcludeRentalToggle:"Exclude for rental",gearListIncludeRentalToggle:"Include for rental",gearListRentalNote:"Rental handles this item",gearListEditProviderLabel:"Provided by",gearListEditProviderHelp:"Select who provides this item. Rental stays the default unless the item is in your own gear list.",gearListProviderRental:"Rental",gearListProviderUser:"User",gearListProviderCrewHeading:"Crew",gearListProviderUnknown:"Custom provider",gearListEditOwnedLabel:"Owned",gearListEditOwnedHelp:"Add or remove this line from your Own Gear list to keep your inventory in sync.",gearListOwnedExportLabel:"Owned by %s",gearListEditCameraLinkLabel:"Camera link",gearListEditCameraAssignmentLabel:"Camera designation",gearListEditCameraAssignmentHelp:"Pick the letter for this camera body. Linked accessories will share its color.",gearListEditCameraLinkHelp:"Highlight items that should follow a specific camera letter so crews know which kit moves together.",gearListEditCameraLinkNoneOption:"No camera link",gearListEditCameraLinkCameraOption:"Camera %s — %s",gearListEditCameraLinkUnavailableOption:"Camera %s (unassigned)",gearListEditCameraLinkDefaultLabel:"Camera %s",gearListCameraLinkBadgeLabel:"Linked to camera",gearListEditDialogTitle:"Edit gear item",gearListEditQuantityLabel:"Quantity",gearListEditNameLabel:"Item name",gearListEditAttributesLabel:"Attributes",gearListEditNoteLabel:"Note",gearListEditExtraLabel:"Temporary extra gear",gearListEditExtraHelp:"Flag this item as a short-term addition. Set the period so everyone schedules it correctly.",gearListEditExtraStartLabel:"Needed from",gearListEditExtraEndLabel:"Needed until",gearListEditExtraPeriodHelp:"Leave the dates blank when the schedule is still tentative.",gearListExtraCategoryLabel:"Temporary Extras",gearListExtraIndicatorRange:"Temporary extra: %s – %s",gearListExtraIndicatorOpen:"Temporary extra from %s",gearListExtraIndicatorEnd:"Temporary extra until %s",gearListExtraIndicatorNoPeriod:"Temporary extra",gearListEditRentalLabel:"Exclude from rental",gearListEditSave:"Save",gearListEditCancel:"Cancel",gearListEditButton:"Edit gear item",gearListEditCustomItem:"Edit custom item",gearListEditReset:"Reset name",gearListEditDeviceHeading:"Device attributes",gearListEditDeviceEdit:"Edit device attributes",gearListEditDeviceEmpty:"No device attributes recorded yet. Update the device to add details.",gearListEditDeviceCategory:"Device library: %s",gearListLensCoverageWarning:"This lens may not cover the full sensor of this camera!",autoGearHighlightToggle:"Highlight automatic gear",autoGearHighlightToggleHelp:"Toggle a temporary color overlay for gear added by automatic rules. Useful while debugging gear rule behavior.",autoGearHighlightToggleStateOn:"On",autoGearHighlightToggleStateOff:"Off",deleteGearListBtn:"Delete Kit List",deleteGearListBtnHelp:"Remove the saved kit list from this project and hide the table.",deleteGearListDialogTitle:"Delete Gear List",deleteGearListConfirmLabel:"Delete",confirmDeleteGearList:"Delete kit list?",deleteGearListConfirmAgainTitle:"Are you sure?",deleteGearListConfirmAgainLabel:"Confirm Delete",confirmDeleteGearListAgain:"This will permanently delete the kit list. Are you sure?",ownGearDialogTitle:"Own gear",ownGearDialogDescription:"Capture the equipment you personally own so you can plan around what's already in your kit.",ownGearAddHeading:"Add gear",ownGearAddHelp:"Start typing to search our catalog for suggestions or describe custom items you own. Entries save immediately.",ownGearNameLabel:"Item",ownGearNamePlaceholder:"Lens, monitor, adapter…",ownGearNameHelp:"Required. Use the exact model name so suggestions and exports stay clear.",ownGearQuantityLabel:"Quantity",ownGearQuantityPlaceholder:"1",ownGearQuantityHelp:"Enter how many of this item you own. Leave blank when it varies.",ownGearNotesLabel:"Notes",ownGearNotesPlaceholder:"Condition, accessories, case number…",ownGearNotesHelp:"Optional notes about accessories, serial numbers or case locations.",ownGearSaveButton:"Save item",ownGearUpdateButton:"Update item",ownGearResetButton:"Reset form",ownGearCloseButton:"Close",ownGearListHeading:"Your gear",ownGearListEmpty:"No gear saved yet. Add the equipment you own to reuse it across projects.",ownGearListSummaryOne:"%s item tracked",ownGearListSummaryOther:"%s items tracked",ownGearEditButton:"Edit",ownGearEditButtonAria:"Edit “%s”",ownGearDeleteButton:"Remove",ownGearDeleteButtonAria:"Remove “%s” from your own gear list",ownGearDeleteConfirm:"Remove “%s” from your own gear list? This only removes it from your inventory.",ownGearQuantityInvalid:"Enter a non-negative quantity or leave the field blank.",ownGearNameRequired:"Enter the item name to save it.",alertSelectSetupForOverview:"Please select a saved project to generate an overview.",overviewTitle:"Project Overview",backToAppBtn:"Back to App",printBtn:"Print",exportPdfBtn:"Export PDF / Print",exportRentalPdfBtn:"Export PDF for Rental",rentalPrintDialogTitle:"Export PDF / Print",rentalPrintDialogDescription:"Choose what to include before exporting or printing.",rentalPrintDialogSectionsLabel:"Sections to include",rentalPrintDialogConfirm:"Export PDF",rentalPrintDialogCancel:"Cancel",rentalPrintDialogSelectAll:"Select all",printOptionsLayoutLabel:"Layout",printOptionsLayoutStandard:"Standard layout",printOptionsLayoutRental:"Rental-friendly layout",rentalPrintSectionProject:"Production Requirements",rentalPrintSectionDevices:"Camera Package Devices",rentalPrintSectionPower:"Power Summary",rentalPrintSectionDiagram:"Power Diagram",rentalPrintSectionGearList:"Kit List",rentalPrintSectionBattery:"Battery Comparison",pdfWarningsHeading:"Warnings",exportAndRevertBtn:"Export and revert to default database",exportAndRevertBtnHelp:"Export your database and restore default entries.",helpButtonLabel:"Help",helpButtonTitle:"Help (press ?, H, F1 or Ctrl+/)",helpButtonHelp:"Open the help dialog for step-by-step guidance. Keyboard shortcuts: F1, Ctrl + /, Cmd + /, ? or H.",helpButtonShortcuts:"F1; Ctrl + /; Cmd + /; ?; H",helpButtonAriaShortcuts:"F1 Control+Slash Meta+Slash Shift+Slash KeyH",helpClose:"Close (Esc)",helpCloseHelp:"Close the help dialog and return to the planner (press Esc).",helpTitle:"How to use",helpSearchPlaceholder:"Search help topics...",helpSearchLabel:"Search help topics",helpResultsSummaryAll:"All %s help topics are shown.",helpResultsSummaryFiltered:"Showing %1$s of %2$s help topics for “%3$s”.",helpResultsAssist:"Tip: Press Tab to move into the quick links, or press Enter to open the top visible topic.",helpNoResults:"No help topics match your search. Try shorter keywords, synonyms, or clear the field to browse everything.",helpNoResultsSuggestionsHeading:"Need a different result?",helpNoResultsSuggestionsIntro:"Try these steps to get back on track while keeping your data safe and confirming offline safeguards:",helpNoResultsSuggestionClear:"Use %s to browse every article again.",helpNoResultsSuggestionSynonyms:"Search for equipment nicknames, battery part numbers, or shorter keywords.",helpNoResultsSuggestionQuickStart:"Jump to the %s for a guided refresher on saving, sharing, and backups.",helpNoResultsSuggestionBackup:"Open %1$s, start a %2$s to confirm your offline exports, and review Settings → Data & Storage for the latest autosave timestamp before you continue.",helpOnboardingTutorialCopy:"to follow every workflow with offline progress tracking—including the Power Summary checkpoint and the offline safety net drill—before configuring your first project. Use the step navigator and progress meter to review completed sections offline.",onboardingTour:{startLabel:"Start guided tutorial",restartLabel:"Replay guided tutorial",resumeLabel:"Resume guided tutorial",skipLabel:"Skip tutorial",backLabel:"Back",nextLabel:"Next",introStartLabel:"Start onboarding tour",doneLabel:"Finish tutorial",stepIndicator:"Step {current} of {total}",completionIndicator:"First project secured offline",prefaceIndicator:"Welcome",stepListAriaLabel:"Tutorial steps",stepStatusCurrent:"Current step",stepStatusComplete:"Completed",stepStatusUpcoming:"Up next",resumeHint:"Picking up right where you paused. Use the step navigator to revisit earlier workflows without clearing offline progress.",resumeHintDetailed:"Resuming at step {current} of {total}. {completed} steps are already complete and locked into your offline saves.",userProfileInteractionIntro:"Enter your crew details once. Each update syncs to Contacts instantly, stays cached offline and flows into exports so crews always know who owns the setup.",userProfileInteractionSkipHint:"Press Next when you are ready—Contacts in the sidebar always shows these saved details without resetting tutorial progress.",userProfileAvatarAction:"Add profile photo",userProfileAvatarEditAction:"Edit photo",projectRequirementsMiniIntro:"Fill these proxy fields while the Production Requirements dialog stays open.",projectRequirementsMiniOfflineHint:"Every edit saves offline instantly—use Back/Next here without risking data loss.",unitsPreferencesLanguageLabel:"Language",unitsPreferencesThemeLabel:"Theme",unitsPreferencesThemeLight:"Light",unitsPreferencesThemeDark:"Dark",unitsPreferencesPinkLabel:"Pink mode accents",unitsPreferencesPinkOff:"Disabled",unitsPreferencesPinkOn:"Enabled",unitsPreferencesUnitsLabel:"Temperature units",unitsPreferencesPersistenceHint:"Request persistent storage so the browser keeps planner data even when space runs low.",unitsPreferencesPersistenceAction:"Protect storage on this device",progressMeterLabel:"Tutorial progress",progressValueLabel:"Completed {completed} of {total} steps",resumeLabelWithProgress:"Resume guided tutorial ({completed}/{total} complete)",helpStatusNotStarted:"Guided tutorial progress saves offline as you advance. Up next: {next}.",helpStatusInProgress:"Offline progress saved: {completed} steps completed out of {total}. Next workflow: {next}.",helpStatusResume:"Paused on {current}. {completed} of {total} steps already secured offline.",helpStatusSkipped:"Tutorial skipped. Restart whenever you're ready—saved progress stays available offline.",helpStatusCompleted:"Tutorial completed. Replay any step anytime for a refresher.",helpStatusLastCompleted:"Last completed: {step} ({timeAgo}).",helpStatusLastUpdated:"Last update: {timeAgo}.",helpStatusTimeJustNow:"just now",helpStatusTimeMinute:"1 minute ago",helpStatusTimeMinutes:"{count} minutes ago",helpStatusTimeHour:"1 hour ago",helpStatusTimeHours:"{count} hours ago",helpStatusTimeDay:"1 day ago",helpStatusTimeDays:"{count} days ago",skipConfirmationTitle:"Skip the guided tutorial?",skipConfirmationBody:"You can reopen the tutorial from Help or use the step navigator to replay any section later.",skipConfirmationAccept:"Skip tutorial",skipConfirmationCancel:"Continue tutorial",steps:{intro:{hero:{heading:"Welcome to Cine Power Planner!",subheading:"Safeguard every camera setup with power checks, AutoGear kits, and rental-ready handoffs—kept fully offline.",summary:"Plan safe camera setups, verify power limits, auto-build kit lists from production requirements, and export rental-ready PDFs—every save stays local before call time.",badgeIcon:"",badgeLabel:"Crew-first · Offline forever",badgeDescription:"No servers, no accounts, no subscriptions. Every save, autosave, backup, restore, share, and import lives on this device.",highlights:[{icon:"",title:"Lock in power, safety, and backups",body:"Model draw, runtime, changeovers, and redundant pack coverage so battery safety margins are confirmed before rolling."},{icon:"",title:"AutoGear builds reusable kits",body:"Generate full kit lists from shooting scenarios with AutoGear rules, adjust those rules for the day, and reuse the presets."},{icon:"",title:"Project requirements ready to hand off",body:"Track requirements, crew coverage, and rental notes, then export PDF packets the crew, rental, and production rely on."},{icon:"",title:"Offline-first, subscription-free PWA",body:"Run the planner entirely offline, install it as a mobile PWA, and keep workflows available without subscriptions or servers."},{icon:"",title:"Data is sacred",body:"Autosave, backup/restore, share, and import safeguards protect every project snapshot. Restore rehearsals prove nothing is lost."}],languageLabel:"Language",languageHint:"Choose the interface language so this tour, the help center, and exports translate instantly across offline saves.",offlineSummary:"Cine Power Planner is built for field reliability: offline by default, installable on mobile, and always storing redundant saves locally so crews retain control of their data."}},userProfile:{title:"Complete your crew profile",body:"Set your display name, role, phone, email and photo. Each update syncs to Contacts immediately, stays in offline saves and appears on exports."},unitsPreferences:{title:"Tune theme and units",body:"Open Settings → General to choose the theme, optional pink highlights, focus scale and temperature units. Request persistent storage so the browser keeps preferences and safeguards saves during cleanups."},nameProject:{title:"Name your first project",body:"Give the project a descriptive name to anchor autosave, history, exports and backups. Every workflow references it so your offline library stays organized and easy to restore."},saveProject:{title:"Capture an immediate save",body:"Select Save (or press Ctrl+S/⌘S/Enter) to capture a complete offline snapshot—devices, power math, requirements, notes and diagnostics. The next workflow unlocks once the save finishes."},addCamera:{title:"Select the primary camera",body:"Choose the camera body you are planning. Offline search works inside the menu. That selection unlocks matching accessories, power draws and diagrams."},addMonitoring:{title:"Add monitors, wireless video and FIZ",body:"Pick onboard monitors, wireless transmitters and FIZ motors or controllers. Each selection feeds runtime math, diagrams and automatic gear rules so the generated kit reflects the full build."},selectBattery:{title:"Choose batteries",body:"Select the battery system that powers the rig. Runtime projections update immediately and the selection is stored with your offline project snapshots and backups."},resultsTotalDraw:{title:"Power Summary: Total draw",body:"Start your Power Summary review by confirming the Total Draw card and peak load so the demand math stays accurate before moving on to deeper checks."},resultsBatteryPacks:{title:"Power Summary: Battery runtimes",body:"Review each battery pack's projected runtime, all framed around a worst-case draw so most kits run longer—helping you know how many packs to bring, feel confident the rig won't demand constant swaps, and automatically pair the right batteries with each camera."},resultsChangeover:{title:"Power Summary: Changeovers",body:"Use the changeover card to review the category-by-category draw chart, see exactly which devices contribute the most load, and confirm every swap sequence keeps enough headroom. The breakdown ties each accessory to its watt draw so the next charged pack is staged for the hungriest circuit and the saved snapshot captures the latest handoff plan."},resultsWarnings:{title:"Power Summary: Warnings and backups",body:"Check the connector warning boxes: green shows the pin or D-Tap battery feed is safe, yellow means the feed is near its limit, and red means the rig is pulling more than that line can supply. Change out batteries and devices to get both boxes to appear green again. Rest assured the warnings keep you from pushing higher loads than a battery can safely handle."},batteryComparison:{title:"Battery Comparison",body:"Battery Comparison evaluates alternate packs side by side so you can lock in the safest runtime margin. The table shows which batteries can power the rig—green pins and D-Tap feeds are safe, orange pins-only outputs cover the rig without D-Tap support—and how long each pack runs."},runtimeFeedback:{title:"Submit runtime feedback",body:"Use the runtime feedback button to log real-world results. Entries sync with the current project, strengthen future estimates and remain available offline for audits."},connectionDiagram:{title:"Inspect the power diagram",body:"The interactive Power Diagram shows how power, video and control gear connect. Drag nodes to plan rig layout, double-click devices to open hover details, then save so the arrangement and annotations persist across exports and restores."},connectionDiagramDetails:{title:"Open device hover details",body:"Double-click any device node in the diagram to reveal its hover detail popup. Review draw notes, connector callouts and saved annotations, then close it to keep arranging the layout before saving."},editDeviceDataAdd:{title:"Add a device to the library",body:"Open Device Library, choose the correct category, enter the draw and connector details, then press Add. This stores the gear in the offline catalog so autosave, backups and shares all capture the new entry."},editDeviceDataReview:{title:"Review the device details",body:"Locate the device you just saved under Existing Devices and expand its details panel. Confirm the draw, outputs and compatibility information look right before relying on the data for runtime math or exports."},editDeviceDataEdit:{title:"Update and resave the device",body:"Use the Edit button on that entry, adjust specs or notes, and save again. This verifies the autosave timeline, backups and exports are refreshed with the latest numbers without risking any user data."},ownGearAccess:{title:"Open the Own Gear dialog",body:"Press the Own Gear button in the sidebar to launch your inventory dialog, then review the summary banner and your own gear list so you know where saved items, edit buttons and counts live. Finish by exploring the Add gear form—item search, quantity, notes, plus the Save and Reset controls—so you can add equipment instantly once the tour ends."},ownGearAddDevice:{title:"Add your first owned device",body:"Enter the item name, optional quantity and notes, then save. Owned gear is stored offline, included in backups and marked inside exports so teams instantly see what is available without duplicating requests."},projectRequirementsBrief:{title:"Capture the project brief",body:"Open the Production Requirements dialog from Generate Kit List and Production Requirements, then document production company, address, rental preferences, deliverables and schedule notes. These entries auto-fill rental-ready PDFs, stay cached offline and prepare the next sections."},projectRequirementsCrew:{title:"Map crew coverage and contacts",body:"Populate Crew, Prep, Shooting and Return rows with names, roles and coverage notes. Link saved Contacts, add emergency details and duplicate rows when multiple days share assignments so exports show who is on set and when."},projectRequirementsLogistics:{title:"Log lenses, rigging and monitoring plans",body:"Work through camera specs, the lens workflow, rigging scenarios, storage/media counts, matte box preferences and monitoring layouts. These entries feed automatic gear rules and storage math so the generated checklist reflects the full shoot plan."},generateGearAndRequirements:{title:"Save and rebuild the outputs",body:"Press OK inside the Production Requirements dialog to store every entry, regenerate the requirements summary and rebuild the categorized kit list. The planner snapshots the result with the active project so exports, backups and shares stay current."},autoGearRulesAccess:{title:"Open Automatic Gear Rules",body:"Go to Settings → Automatic Gear Rules to review automation controls. Opening the tab shows the presets, stock rules (including smart tripod logic that references your head/legs preference) and safety backups stored with your offline saves."},autoGearRulesEdit:{title:"Edit stock automatic gear rules",body:"Use the rules list to inspect factory additions. Select a stock rule to open it in the editor, adjust items or conditions, then save so the updated automation stays cached with backups and share bundles."},autoGearRulesCreate:{title:"Add a new automatic gear rule",body:"Press Add rule to create a custom automation. Name it, add conditions and required gear, then save. The planner runs new rules offline each time you regenerate the kit and includes them in exports, shares and backups."},projectRequirements:{title:"Refine production requirements boxes",body:"Review the regenerated Production Requirements summary beside the kit list. Confirm the brief, crew coverage and logistics boxes mirror the data you just saved, then rerun exports or backups so downstream teams get the updated context with every share."},gearList:{title:"Audit the generated kit list",body:"Check the categorized kit list for duplicates, counts and auto-added accessories. Edits save instantly, are included in share bundles and appear in printouts and PDFs."},exportImport:{title:"Export and import projects",body:"Use Export Project to download a JSON safety copy and Import Project to rehearse restores. Store exports on redundant media so no workstation loses data if a browser profile resets. Always keep the original export untouched so you can re-import even if a working copy gets edited."},overviewAndPrint:{title:"Generate overview, PDF and printouts",body:"Generate the project overview to access PDF, print and share-ready summaries. The dialog uses saved data only, so you can print or export even while fully offline."},help:{title:"Open the Help center",body:"The Help dialog includes searchable documentation, translation notes and onboarding references. Keep it pinned while working—articles stay cached offline and update when new features arrive."},settingsGeneral:{title:"Revisit Settings → General",body:"Adjust language, typography, theme, pink mode, focus scale and other presentation options anytime. Preferences save locally, sync across projects and are bundled with backups."},settingsData:{title:"Monitor Data & Storage",body:"Use the Data & Storage tab to request persistent storage, watch save timestamps and launch quick safeguards. These controls verify that every project snapshot remains available offline."},settingsBackup:{title:"Maintain Backup & Restore",body:"The Backup & Restore tab manages full-app exports, restore rehearsals and diagnostics. Run backups before major changes, archive the files on external media and verify restores regularly."},completion:{title:"Tutorial complete",body:"You now know every safeguard. Keep saving often, export redundant backups and revisit any step from Help whenever you want a refresher. Cine Power Planner will keep protecting your data offline."}}},helpQuickStartChecklistTitle:"Quick start checklist",helpDataSafetyTitle:"Protect your work",helpRestoreDrillTitle:"Restore rehearsal drill",helpDataAuditTitle:"Monthly data health check",helpDataAuditStep1:"Open %1$s, switch to %2$s, then use %3$s under %4$s to capture a fresh full-app snapshot before auditing downloads.",helpDataAuditStep2:"Export each active project with %1$s, confirm each download opens without errors, and store the files in two separate locations.",helpDataAuditStep3:"While offline, reload using %1$s and confirm the %2$s stays visible while projects and help articles load from local storage. Test %3$s with one of the new exports to ensure share bundles restore without reconnecting.",helpDataAuditStep4:"Run %1$s with your latest backup, verify every project, device, and rule, then record the runtime guard output from %2$s in your verification log before closing the rehearsal without publishing changes.",helpDataAuditNote:"Log the results, capture a screenshot of Settings → Data & Storage with the latest autosave timestamp, and archive the console guard output with your backup rotation checklist so you always know which copies were verified offline.",helpRestoreDrillNote:"Log filenames, timestamps and verification results in your backup rotation checklist so every rehearsal documents a restorable copy.",helpSearchClear:"Clear search",helpSearchHelp:"Type keywords or alternate spellings to instantly filter help topics. Quick links update as you type and highlight the matching article when you press Enter. Press '/' or Ctrl+F (Cmd+F on Mac) to focus the search box when the help dialog is open (instead of the browser find), then press Tab to step through filtered quick links without leaving your project.",helpSearchClearHelp:"Clear the search box and show all help topics again.",helpSearchStatusAll:"Showing {count} help topics.",helpSearchStatusWithQuery:"Showing {count} results for “{query}”.",helpQuickLinksHeading:"Jump to a topic",helpQuickLinksAriaLabel:"Help topics quick navigation",helpQuickLinksHelp:"Jump directly to any section of the help dialog. Buttons only show topics that match the current search.",helpQuickLinkButtonHelp:"Scroll to the “%s” section in the help dialog.",hoverHelpButtonLabel:"Hover for help",hoverHelpButtonHelp:"Activate hover help so moving the cursor over buttons, fields, dropdowns or headers reveals brief explanations. You can open Settings while hover help is active to explore preferences without leaving this mode. Hovered controls are outlined and the tooltip shows their title alongside any available details. Longer descriptions are automatically broken into readable steps or bullet lists when available. Keyboard shortcuts are displayed whenever they exist so you can learn faster ways to use each control. When a control doesn't have custom guidance, the planner fills in contextual descriptions automatically so every interface element explains itself.",hoverHelpExitHint:"Press Esc or click anywhere to exit hover help.",hoverHelpShortcutsHeading:"Shortcuts",hoverHelpFallbackGeneric:"Interactive control.",hoverHelpFallbackButton:"Button. Activate to perform this action.",hoverHelpFallbackToggleButton:"Toggle button. Activate to switch between on and off states.",hoverHelpFallbackMenuButton:"Menu button. Opens a menu with related options.",hoverHelpFallbackLink:"Link. Opens the referenced section without leaving the app.",hoverHelpFallbackSelect:"Dropdown list. Open to choose one of the available options.",hoverHelpFallbackTextInput:"Text field. Type to enter information and press Enter to confirm when needed.",hoverHelpFallbackNumberInput:"Number field. Type a value or use arrow keys to adjust the number.",hoverHelpFallbackTextarea:"Multiline text field. Type paragraphs or paste notes.",hoverHelpFallbackCheckbox:"Checkbox. Select to enable, deselect to disable.",hoverHelpFallbackRadio:"Radio option. Select exactly one choice from this group.",hoverHelpFallbackSwitch:"Switch control. Toggle between on and off.",hoverHelpFallbackSlider:"Slider. Drag or use arrow keys to set the value.",hoverHelpFallbackFileInput:"File picker. Browse your device for files to add.",hoverHelpFallbackColorInput:"Color picker. Choose a color value.",hoverHelpFallbackDetails:"Expandable details section. Activate to show or hide the extra content.",hoverHelpFallbackDialog:"Dialog. Remains on top until you close it. Complete or cancel before returning to the main planner.",hoverHelpFallbackTablist:"Tab list. Use arrow keys to move between tabs.",hoverHelpFallbackTab:"Tab. Activate to display its panel of settings.",hoverHelpFallbackMenu:"Menu. Use arrow keys to move through options and Enter to select.",hoverHelpFallbackProgress:"Progress indicator showing current completion.",hoverHelpFallbackStatus:"Status message that updates automatically.",hoverHelpFallbackAlert:"Important alert that may require your attention.",setupSelectHelp:"Pick a previously saved configuration or select '-- New Project --' to start from scratch.",setupNameHelp:"Enter a descriptive name for the current project so you can recognize it later.",deleteSetupHelp:"Remove the highlighted saved project permanently from your browser.",saveSetupHelp:"Capture a full snapshot of the current project—devices, requirements, notes, runtime logs and diagram layout—and store it in your local library. The autosave status dot beside Project Name pulses while the write finishes, and the background auto-backup queue schedules the matching timestamped snapshot right after the save so redundancy stays current. Press Enter or Ctrl+S (⌘S on Mac) for the same result; the Save button stays disabled until you enter a project name. Saving never overwrites other projects until you confirm the name, so your prior data remains protected.",generateOverviewHelp:"Rebuilds the print-ready summary for the selected saved project and opens the overview dialog so you can review power and connection details before printing when ready. Lens selections render with brand, mount, diameter, focus, weight, rod support and notes so exports cover spec-sensitive checkouts.",generateGearListHelp:"Build a categorized kit list that combines selected gear with production requirements. The list refreshes on every change, merges duplicate items with counts and auto-adds required cables, rigging, lens supports, matte box parts, battery counts with hotswap hardware, default monitors for each role and scenario-specific accessories. Entries are sorted alphabetically and include hover descriptions.",shareSetupHelp:"Download a JSON safety bundle of the current project—covering custom gear, favorites, runtime feedback and devices—ready to archive or share offline. Store the file with your redundant crew backups before closing the planner so every workstation can restore it without network access. The export leaves your current project unchanged, so nothing is lost while you create the share bundle.",applySharedLinkHelp:"Load the configuration from a JSON backup exported via Save & Share or Backup & Restore. Review the preview diff before applying—nothing overwrites your current project until you confirm Save, and the planner schedules a fresh auto-backup beforehand so you can roll back instantly. Unnamed imports are saved automatically under an “-imported” title so the data lands even when the bundle omitted a project name. The imported project remains local and offline-ready immediately after you save.",sharedLinkHelp:"Choose a project JSON exported from Save & Share or Backup & Restore. Keep the original file in your backups after import—the planner only reads a copy and logs the attempt in diagnostics for your records so you can audit every restore.",cameraSelectHelp:"Choose the camera body that anchors your rig.",monitorSelectHelp:"Choose an on-board or wireless monitor to include.",videoSelectHelp:"Choose a transmitter/receiver pair or other wireless video link.",cageSelectHelp:"Choose a camera cage for mounting accessories.",distanceSelectHelp:"Choose an optional distance or range-finder sensor.",batterySelectHelp:"Choose the battery model that will power the entire rig.",batteryPlateSelectHelp:"Choose the battery plate or adapter that connects the battery to the camera.",batteryHotswapSelectHelp:"Select the hot-swap buffer that keeps power during battery changes.",runtimeFeedbackBtnHelp:"Open a form where you can submit real-world runtime data for this configuration.",zoomOutHelp:"Zoom out of the project diagram to view more of the layout.",zoomInHelp:"Zoom in on the project diagram for a closer look at connections.",downloadDiagramHelp:"Download the Power Diagram as an SVG or JPG image.",gridSnapToggleHelp:"Turn grid snapping on or off to help align items in the diagram.",resetViewBtn:"Reset View",resetViewHelp:"Reset zoom and pan to their defaults.",toggleDeviceManagerHelp:"Open the editor where you can add, modify, export or import device data.",hideDeviceManagerHelp:"Close the device database editor and return to normal mode.",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",diagramHoverNotice:"Double click for details",diagramDetailBackLabel:"Back",diagramDetailDefaultHeading:"Diagram details",diagramMoveHint:"Drag nodes to rearrange; drag empty space to pan.",v2:{dashboard:{header:{title:"Projects"},actions:{newProject:"New Project",importProject:"Import Project"},projects:"Projects",newProject:"New Project",projectLocked:"The project '{projectName}' is already open in another tab.",emptyState:{title:"No Projects Yet",subtitle:"Create your first power plan to get started.",help:"Need help getting started?",archiveTitle:"No Archived Projects",archiveSubtitle:"Projects you archive will appear here."},search:{noResults:{title:"No Results",subtitle:'No projects match "{query}"'},clear:"Clear search"},projectTile:{prep:"Prep:",shoot:"Shoot:",return:"Return:",openProject:"Open Project",renameAndEdit:"Rename & Edit",moreOptions:"More options",actionsFor:"Actions for {project}"},contextMenu:{open:"Open Project",rename:"Rename & Edit",duplicate:"Duplicate",archive:"Archive",unarchive:"Restore",delete:"Delete",print:"Print",pdf:"Export PDF"},status:{draft:"Draft",planning:"Planning",waitingForApproval:"Waiting for Approval",approved:"Approved",shooting:"Shooting",completed:"Completed",archived:"Archived"}},sidebar:{nav:{allProjects:"All Projects",activeProjects:"Active Projects",archive:"Archive",autoBackups:"Auto Backups",deviceLibrary:"Device Library",contacts:"Contacts",autoGearRules:"Auto Gear Rules",ownedGear:"Owned Gear",createProject:"Create New Project",projectsSection:"Projects",toolsSection:"Tools",supportSection:"Support",help:"Help",settings:"Settings"},search:{placeholder:"Search features, devices, actions...",label:"Search features, devices, actions, and help"}},detail:{backButton:"Back to Projects",header:{export:"Export Project",print:"Print / Export PDF",generateReqs:"Reqs & Gear",generateOverview:"Generate Overview",save:"Save"},tabs:{cameraPackage:"Camera Package",powerSummary:"Power Summary",requirements:"Requirements",gearList:"Gear List"},actions:{projectRequirements:"Project Requirements",generateRequirements:"Generate Requirements",generateRequirementsHelp:'Click "Generate Requirements" to create your production report.',gearList:"Gear List",generateGearList:"Generate Gear List",generateGearListHelp:'Click "Generate Gear List" to create your equipment list.'},diagram:{zoomIn:"Zoom In",zoomOut:"Zoom Out",resetView:"Reset View",download:"Download Diagram"},errors:{statusUpdateFailed:"Unable to update the project status because storage is unavailable. Please check your browser storage settings and try again."}}}},categoryNames:{cameras:"Camera",viewfinders:"Viewfinder",monitors:"Monitor",video:"Wireless Transmitter","fiz.motors":"FIZ Motor","fiz.controllers":"FIZ Controller","fiz.distance":"FIZ Distance",batteries:"Battery",batteryHotswaps:"Battery Hotswap",wirelessReceivers:"Wireless Receiver","accessories.batteries":"Accessory Battery","accessories.cables":"Cable","accessories.cages":"Camera Cage","accessories.cameraSupport":"Camera Support","accessories.chargers":"Charger",cages:"Camera Cage",chargers:"Charger",directorMonitors:"Director Monitor",iosVideo:"iOS Video",videoAssist:"Video Assist",media:"Recording Media","accessories.cardReaders":"Card Reader",cardReaders:"Card Reader",lenses:"Lens",filterOptions:"Filter Option",other:"Other"},gearItems:{"Tennis ball":"Tennis ball","Clapper Stick":"Clapper Stick"}},_o="en",qm={de:()=>Rf(()=>import("./de-D4ATzMXf.js"),[]),es:()=>Rf(()=>import("./es-Bz06fnSf.js"),[]),fr:()=>Rf(()=>import("./fr-DIroa6ai.js"),[]),it:()=>Rf(()=>import("./it-BmXF3RXs.js"),[])},Cs=new Set;function Yu(e){if(Array.isArray(e))return e.map(t=>Yu(t));if(e&&typeof e=="object"){const t={};return Object.keys(e).forEach(r=>{t[r]=Yu(e[r])}),t}return e}function Qu(e,t=new WeakMap){if(!e||typeof e!="object"||t.has(e))return e;t.set(e,!0),Array.isArray(e)?e.forEach(r=>Qu(r,t)):Object.values(e).forEach(r=>Qu(r,t));try{Object.isFrozen(e)||Object.freeze(e)}catch{}return e}function ov(e,t){const r=Array.isArray(e)?"array":e===null?"null":typeof e,o=Array.isArray(t)?"array":t===null?"null":typeof t;if(r==="array"){if(o!=="array")return Yu(e);const n=e.length,a=new Array(n);for(let i=0;i<n;i++){const s=e[i],u=i<t.length?t[i]:void 0;a[i]=ov(s,u)}return a}if(r==="object"){if(o!=="object")return Yu(e);const n=t&&typeof t=="object"?t:{};return Object.keys(e||{}).forEach(i=>{const s=e[i],u=Object.prototype.hasOwnProperty.call(n,i)?n[i]:void 0;n[i]=ov(s,u)}),Object.keys(n).forEach(i=>{Object.prototype.hasOwnProperty.call(e,i)||delete n[i]}),n}return o===r&&typeof t<"u"?t:Yu(e)}function fb(e,t){const r={};return Object.keys(e||{}).forEach(n=>{const a=e[n],i=t&&Object.prototype.hasOwnProperty.call(t,n)?t[n]:void 0;r[n]=ov(a,i)}),r}function qI(e,t,r){if(!e||!t||!r)return;r.texts=r.texts||{},r.categoryNames=r.categoryNames||{},r.gearItems=r.gearItems||{};const o=t.texts||{},n=t.categoryNames||{},a=t.gearItems||{};let i=r.texts[_o]?{texts:r.texts[_o],categoryNames:r.categoryNames[_o],gearItems:r.gearItems[_o]}:null;e===_o&&(Qu(o),Qu(n),Qu(a),i={texts:o,categoryNames:n,gearItems:a});const s=i||{texts:{},categoryNames:{},gearItems:{}},u=e===_o?s.texts:fb(s.texts,o),l=e===_o?s.categoryNames:fb(s.categoryNames,n),d=e===_o?s.gearItems:fb(s.gearItems,a);r.texts[e]=u,r.categoryNames[e]=l,r.gearItems[e]=d}function vx(e){if(typeof e!="string")return _o;const t=e.trim();if(!t)return _o;const r=t.toLowerCase();if(qm[r])return r;const o=r.split("-")[0];return qm[o]?o:_o}async function Ax(e,t){if(Cs.has(e))return;const r=vx(e);if(r===_o&&Cs.has(_o)){Cs.add(e);return}if(qm[r])try{const o=await qm[r]();qI(r,o.data,t),Cs.add(r),Cs.add(e)}catch(o){console.error(`Failed to load locale: ${r}`,o)}}function Ex(e){Cs.has(_o)||(qI(_o,Sx,e),Cs.add(_o))}const AA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};Ex(AA);async function EA(e){return Ax(e,AA)}AA.__cineTranslationsLoader__={loadLanguage:EA};const Cx={loadLanguage:EA},wx=Object.freeze(Object.defineProperty({__proto__:null,default:Cx,loadLanguage:EA},Symbol.toStringTag,{value:"Module"})),Di=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:global,VI='<svg viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="m1 40c0-8 3-17 3-17a4.84 4.84 0 0 0-1.829-3.064 1 1 0 0 1 .45-1.716 19.438 19.438 0 0 1 4.379-.22c.579-2.317-1.19-3.963-2.782-4.938a1 1 0 0 1 .393-1.85 14.128 14.128 0 0 1 6.389.788c0-.958-1.147-2.145-2.342-3.122a1 1 0 0 1 .708-1.773 40.655 40.655 0 0 1 6.634.895 3.723 3.723 0 0 0-1.049-2.264 1 1 0 0 1 .823-1.652c6.151.378 9.226 1.916 9.226 1.916l10-1s8.472-2.311 15.954.5a1 1 0 0 1-.084 1.9c-1.455.394-2.87 1.143-2.87 2.6 0 0 4.426.738 5.675 4.114a1 1 0 0 1-1.228 1.317c-1.64-.48-4.273-.88-6.447.569Z" fill="#805333" /><path d="m30.18 42.82c1.073 2.7 2.6 9.993 3.357 13.8a2 2 0 0 1-1.964 2.38h-28.573a2 2 0 0 1-2-2v-18c0-2.55 10.03-22.11 23.99-23.87Z" fill="#a56a43" /><path d="m55.67 48.46-6.34 2.97a6 6 0 0 1-7.98-2.88l-.25-.54-.76-1.6a4.956 4.956 0 0 0-4.68-2.87c-.22.01-.44.02-.66.02a16.019 16.019 0 0 1-8.28-29.66c-1.81-2.97-3.45-8.03 2.03-12.49a2.1 2.1 0 0 1 2.5 0c4.23 3.45 4.21 7.25 3.16 10.17a16 16 0 0 1 15.91 11.36l5.31 11.31 2.92 6.22a6.008 6.008 0 0 1-2.88 7.99Z" fill="#cb8252" /><circle cx="42" cy="26" r="3" fill="#2c2f38" /><circle cx="54" cy="43" r="1" fill="#805333" /><path d="m58.55 40.47-2.92-6.22-14.53 13.76.25.54a6 6 0 0 0 7.98 2.88l6.34-2.97a6.008 6.008 0 0 0 2.88-7.99Zm-4.55 3.53a1 1 0 1 1 1-1 1 1 0 0 1-1 1Z" fill="#cf976a" /><circle cx="41" cy="25" r="1.25" fill="#ecf0f1" /></svg>',Lx='<path d="M44 19 L56 5 L49 22 Z" fill="#ffd700" />',CA=VI.replace("</svg>",Lx+"</svg>"),Rx=CA.replace(/#805333/g,"#d63384").replace(/#a56a43/g,"#e83e8c").replace(/#cb8252/g,"#fd7e14").replace(/#cf976a/g,"#ffc0cb"),Ix=CA.replace(/#805333/g,"#6f42c1").replace(/#a56a43/g,"#d63384").replace(/#cb8252/g,"#e83e8c").replace(/#cf976a/g,"#e0cffc"),Tx=CA.replace(/#805333/g,"#0dcaf0").replace(/#a56a43/g,"#6f42c1").replace(/#cb8252/g,"#d63384").replace(/#cf976a/g,"#9ec5fe"),Ox=[{className:"icon-svg pink-mode-icon",markup:Rx,lottiePath:"src/animations/horn.json"},{className:"icon-svg pink-mode-icon",markup:Ix,lottiePath:"src/animations/unicorn.json"},{className:"icon-svg pink-mode-icon",markup:Tx,lottiePath:"src/animations/rainbow.json"}],Gx={off:{className:"icon-svg pink-mode-icon",markup:VI},onSequence:Ox};class kx{constructor(){this.active=!1}activate(){this.active=!0,typeof document<"u"&&document.body&&document.body.classList.add("pink-mode-active")}deactivate(){this.active=!1,typeof document<"u"&&document.body&&document.body.classList.remove("pink-mode-active")}}const WI=new kx;function Bx(){if(Di.lottie)return Promise.resolve(Di.lottie);if(Di.bodymovin)return Promise.resolve(Di.bodymovin);if(typeof document>"u")return Promise.resolve(null);const e=document.querySelector('script[data-loader="pink-mode-lottie"]');return e?new Promise(t=>{e.dataset.loaded==="true"?t(Di.lottie):e.addEventListener("load",()=>t(Di.lottie),{once:!0})}):new Promise((t,r)=>{const o=document.createElement("script");o.src="src/vendor/lottie.min.js",o.async=!0,o.setAttribute("data-loader","pink-mode-lottie"),o.onload=()=>{o.dataset.loaded="true",t(Di.lottie)},o.onerror=r,document.head.appendChild(o)})}const Px=e=>typeof e=="string"?e.trim():"",xx=()=>!1,Mx=()=>Promise.resolve(),Dx=()=>Di.lottie,_x=()=>WI.activate(),Fx=()=>WI.deactivate(),Nx=()=>{},Hx=()=>{},jx=()=>null,zx=()=>{},Ux=()=>0,$x=()=>{},qx=3e4,Vx="pink-mode-icon-pop",Wx=450,Kx=[],Yx={pinkModeIcons:Gx,ensureSvgHasAriaHidden:Px,setPinkModeIconSequence:xx,loadPinkModeIconsFromFiles:Mx,ensurePinkModeLottieRuntime:Bx,resolvePinkModeLottieRuntime:Dx,startPinkModeAnimatedIcons:_x,stopPinkModeAnimatedIcons:Fx,triggerPinkModeIconRain:Nx,startPinkModeIconPreload:Hx,getPinkModeIconRotationTimer:jx,setPinkModeIconRotationTimer:zx,getPinkModeIconIndex:Ux,setPinkModeIconIndex:$x,PINK_MODE_ICON_INTERVAL_MS:qx,PINK_MODE_ICON_ANIMATION_CLASS:Vx,PINK_MODE_ICON_ANIMATION_RESET_DELAY:Wx,PINK_MODE_ICON_FALLBACK_MARKUP:Kx},Iu=Yx;typeof module<"u"&&module.exports&&(module.exports={PINK_MODE_SUPPORT_API:Iu});typeof globalThis<"u"?globalThis.PINK_MODE_SUPPORT_API=Iu:typeof window<"u"?window.PINK_MODE_SUPPORT_API=Iu:typeof self<"u"?self.PINK_MODE_SUPPORT_API=Iu:typeof global<"u"&&(global.PINK_MODE_SUPPORT_API=Iu);var KI={focus:"autoGearDefaultFocusMonitorLabel",handheld7:"autoGearDefaultHandheldMonitorLabel",combo15:"autoGearDefaultComboMonitorLabel",director15:"autoGearDefaultDirectorMonitorLabel"};function Qx(){if(typeof AUTO_GEAR_CONDITION_KEYS<"u"&&Array.isArray(AUTO_GEAR_CONDITION_KEYS))return AUTO_GEAR_CONDITION_KEYS;var e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=e&&typeof e.AUTO_GEAR_UI_HELPERS=="object"&&e.AUTO_GEAR_UI_HELPERS?e.AUTO_GEAR_UI_HELPERS:null;if(t){if(Array.isArray(t.AUTO_GEAR_CONDITION_KEYS))return t.AUTO_GEAR_CONDITION_KEYS;if(t.autoGearConditionSelects&&typeof t.autoGearConditionSelects=="object")return Object.keys(t.autoGearConditionSelects)}return[]}var Xx=function(e){return function(t){return callCoreFunctionIfAvailable(e,[t],{defer:!0})}};function Zx(){if(autoGearConditionSelect)try{autoGearConditionSelect.focus({preventScroll:!0})}catch{autoGearConditionSelect.focus()}}function Jx(){var e,t,r,o,n=((e=texts[currentLang])===null||e===void 0?void 0:e.autoGearConditionAddShortcut)||((t=texts.en)===null||t===void 0?void 0:t.autoGearConditionAddShortcut)||"Add another condition",a=((r=texts[currentLang])===null||r===void 0?void 0:r.autoGearConditionRemove)||((o=texts.en)===null||o===void 0?void 0:o.autoGearConditionRemove)||"Remove this condition",i=Qx();i.length&&i.forEach(function(s){var u=getAutoGearConditionConfig(s);u&&(u.addShortcut&&(setButtonLabelWithIconBinding(u.addShortcut,"",ICON_GLYPHS.add),u.addShortcut.setAttribute("aria-label",n),u.addShortcut.setAttribute("title",n),u.addShortcut.setAttribute("data-help",n)),u.removeButton&&(setButtonLabelWithIconBinding(u.removeButton,"",ICON_GLYPHS.minus),u.removeButton.setAttribute("aria-label",a),u.removeButton.setAttribute("title",a),u.removeButton.setAttribute("data-help",a)))})}var YI={createDeferredAutoGearRefresher:Xx,focusAutoGearConditionPicker:Zx,configureAutoGearConditionButtons:Jx,AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS:KI};typeof module<"u"&&module.exports&&(module.exports=YI);if(typeof globalThis<"u"){var eM=typeof globalThis.AUTO_GEAR_UI_HELPERS=="object"&&globalThis.AUTO_GEAR_UI_HELPERS?globalThis.AUTO_GEAR_UI_HELPERS:globalThis.AUTO_GEAR_UI_HELPERS={};Object.assign(eM,YI),globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS=KI}var Tn=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{},tM=(function(){for(var e=[Tn,Tn&&Tn.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(typeof r.stableStringify=="function")return r.stableStringify;if(r.cineCoreShared&&typeof r.cineCoreShared.stableStringify=="function")return r.cineCoreShared.stableStringify}}for(var o=function(n){if(n===null)return"null";if(n===void 0)return"undefined";if(Array.isArray(n)){for(var a="[",i=0;i<n.length;i+=1)i>0&&(a+=","),a+=o(n[i]);return a+="]",a}if(typeof n=="object"){for(var s=Object.keys(n).sort(),a="{",u=0;u<s.length;u+=1){var l=s[u];u>0&&(a+=","),a+="".concat(JSON.stringify(l),":").concat(o(n[l]))}return a+="}",a}return JSON.stringify(n)},t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")&&typeof r.stableStringify!="function")try{r.stableStringify=o}catch{try{Object.defineProperty(r,"stableStringify",{configurable:!0,enumerable:!1,writable:!0,value:o})}catch{}}}return o})();function rM(){for(var e=[Tn,Tn&&Tn.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(typeof r.DEFAULT_LANGUAGE_SAFE=="string"&&r.DEFAULT_LANGUAGE_SAFE)return r.DEFAULT_LANGUAGE_SAFE;if(typeof r.CPP_DEFAULT_LANGUAGE_SAFE=="string"&&r.CPP_DEFAULT_LANGUAGE_SAFE)return r.CPP_DEFAULT_LANGUAGE_SAFE;if(r.cineCoreShared&&typeof r.cineCoreShared.DEFAULT_LANGUAGE_SAFE=="string"&&r.cineCoreShared.DEFAULT_LANGUAGE_SAFE)return r.cineCoreShared.DEFAULT_LANGUAGE_SAFE}}return null}function QI(){var e=rM();return e||(typeof navigator<"u"&&typeof navigator.language=="string"&&navigator.language?navigator.language.slice(0,2).toLowerCase():"en")}function jC(e,t){if(!(!e||typeof e!="object"&&typeof e!="function")){var r=function(o){if(typeof e[o]!="string"||!e[o])try{e[o]=t}catch{try{Object.defineProperty(e,o,{configurable:!0,enumerable:!1,writable:!0,value:t})}catch{}}};r("DEFAULT_LANGUAGE_SAFE"),r("CPP_DEFAULT_LANGUAGE_SAFE")}}function oM(){var e=QI(),t=[Tn,Tn&&Tn.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];t.forEach(function(r){!r||typeof r!="object"&&typeof r!="function"||(jC(r,e),r.cineCoreShared&&typeof r.cineCoreShared=="object"&&jC(r.cineCoreShared,e))})}oM();function yy(){var e=QI();try{var t=getLanguageTexts(e);if(t&&typeof t=="object")return t}catch{}return{}}var nM=Object.freeze(["none","monitor","directorMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","fizHandUnit"]);function aM(e){var t=e&&e.AUTO_GEAR_SELECTOR_TYPE_MAP&&typeof e.AUTO_GEAR_SELECTOR_TYPE_MAP=="object"?e.AUTO_GEAR_SELECTOR_TYPE_MAP:null,r=t&&Object.keys(t).length?t:nM.reduce(function(a,i){return a[i.toLowerCase()]=i,a},Object.create(null)),o=e&&e.AUTO_GEAR_SELECTOR_TYPE_SET instanceof Set?e.AUTO_GEAR_SELECTOR_TYPE_SET:null,n=o&&o.size?o:new Set(Object.keys(r));return e&&typeof e=="object"&&(e.AUTO_GEAR_SELECTOR_TYPE_MAP||(e.AUTO_GEAR_SELECTOR_TYPE_MAP=r),e.AUTO_GEAR_SELECTOR_TYPE_SET||(e.AUTO_GEAR_SELECTOR_TYPE_SET=n)),{map:r,set:n}}var XI=aM(Tn),iM=XI.map,sM=XI.set;function Fc(e){var t=e||"rule";return typeof crypto<"u"&&crypto.randomUUID?"".concat(t,"-").concat(crypto.randomUUID()):"".concat(t,"-").concat(Math.random().toString(36).slice(2),"-").concat(Date.now())}function Nc(e){var t=parseInt(e,10);return Number.isFinite(t)&&t>0?t:1}function ZI(e){if(typeof e!="string")return[];var t=e.trim();if(!t)return[];var r=/[;\n\r]/.test(t),o=r?t.split(/[;\n\r]+/):[t];return o.map(function(n){var a=n.trim();if(!a)return null;var i=a.match(/^([+-])\s*(.+)$/),s=i?i[1]==="-"?"remove":"add":null,u=i?i[2].trim():a;if(!u)return null;var l=u.match(/^(\d+)\s*[x×]\s*(.+)$/i);if(l){var d=l[2].trim();return d?{name:d,quantity:Nc(l[1]),listType:s}:null}return{name:u,listType:s}}).filter(Boolean)}function Na(e,t){var r=t===void 0?{}:t,o=r.collapseWhitespace,n=o===void 0?!0:o;if(typeof e=="number"&&Number.isFinite(e))return String(e);if(typeof e!="string")return"";var a=e.trim();return n?a.replace(/\s+/g," "):a}function Hc(e){var t=typeof e=="string"?e.trim().toLowerCase():"";if(!t)return"none";var r=typeof AUTO_GEAR_SELECTOR_TYPE_SET<"u"&&AUTO_GEAR_SELECTOR_TYPE_SET||sM,o=typeof AUTO_GEAR_SELECTOR_TYPE_MAP<"u"&&AUTO_GEAR_SELECTOR_TYPE_MAP||iM;return!r||!r.has(t)?"none":o&&o[t]||"none"}function by(e,t,r){var o=Na(t);if(!o)return"";var n=RA(e,r?{selectorContext:r}:null);if(!n.length)return o;var a=n.find(function(i){return i.toLowerCase()===o.toLowerCase()});return a||o}var Sd={focus:"monitor",handheld7:"monitor",combo15:"directorMonitor",director15:"directorMonitor"};function hy(e){var t={focus:"",handheld7:"",combo15:"",director15:""};return!e||typeof e!="object"||Object.keys(Sd).forEach(function(r){var o=Sd[r],n=by(o,e[r]);t[r]=n}),t}function wA(){if(DEVICE_GLOBAL_SCOPE&&DEVICE_GLOBAL_SCOPE.devices&&typeof DEVICE_GLOBAL_SCOPE.devices=="object")return DEVICE_GLOBAL_SCOPE.devices;try{return typeof devices<"u"&&devices&&typeof devices=="object"?devices:null}catch(e){if(e&&typeof e=="object"&&e.name==="ReferenceError")return null;throw e}}function JI(e){var t=e&&typeof e=="object"?e:{},r=new Set,o=[],n=function(d){!d||typeof d!="object"&&typeof d!="function"||r.has(d)||(r.add(d),o.push(d))};try{typeof DEVICE_GLOBAL_SCOPE<"u"&&n(DEVICE_GLOBAL_SCOPE)}catch{}n(typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null),n(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null),n(typeof CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE<"u"?CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE:null),n(typeof globalThis<"u"?globalThis:null),n(typeof window<"u"?window:null),n(typeof self<"u"?self:null),n(typeof global<"u"?global:null);for(var a=0;a<o.length;a+=1){var i=o[a];if(i){try{i.devices=t}catch{try{Object.defineProperty(i,"devices",{configurable:!0,writable:!0,value:t})}catch{}}try{var s=i.CORE_SHARED||i.cineCoreShared;if(s&&typeof s=="object"&&(s.devices=t,typeof s.updateDevices=="function"))try{s.updateDevices(t)}catch(d){}}catch{}i&&i.global&&i.global!==i&&n(i.global);var u=i.__cineRuntimeState;if(u&&typeof u=="object")try{u.devices=t}catch{}}}var l=lM();if(l&&typeof l=="object")try{l.devices=t,typeof l.updateDevices=="function"&&l.updateDevices(t)}catch{}if(typeof module<"u"&&module&&typeof module.exports=="object"&&module.exports)try{module.exports.devices=t}catch{}return t}function lM(){for(var e=[Tn,Tn&&Tn.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(r.CORE_SHARED&&typeof r.CORE_SHARED=="object")return r.CORE_SHARED;if(r.cineCoreShared&&typeof r.cineCoreShared=="object")return r.cineCoreShared}}return null}function LA(e){if(typeof document>"u")return null;var t=AUTO_GEAR_TRIPOD_FIELD_IDS[e];return t?document.getElementById(t):null}function Sy(e){if(!AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(e))return[];var t=LA(e);if(!t||!t.options)return[];var r=Array.from(t.options),o=new Set,n=[];return r.forEach(function(a){if(a){var i=typeof a.value=="string"?a.value.trim():"",s=typeof a.textContent=="string"?a.textContent.trim():"",u=i||s;if(u){var l=u.toLowerCase();o.has(l)||(o.add(l),n.push({value:u,label:s||u}))}}}),n}function RA(e,t){var r=Hc(e),o=wA();if(!o||typeof o!="object")return[];if(r==="monitor"){var n=o&&o.monitors?o.monitors:null;return!n||typeof n!="object"?[]:Object.keys(n).filter(function(h){return h&&h!=="None"}).sort(localeSort)}if(r==="directorMonitor"){var a=o&&o.directorMonitors?o.directorMonitors:null;return!a||typeof a!="object"?[]:Object.keys(a).filter(function(h){return h&&h!=="None"}).sort(localeSort)}if(r==="fizHandUnit"){var i=typeof AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"?AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS:typeof globalThis<"u"&&typeof globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"?globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS:Object.create(null),s=typeof AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"?AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP:typeof globalThis<"u"&&typeof globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"?globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP:Object.create(null),u="";if(t&&typeof t=="object"){var l=t.selectorContext||t.context;typeof l=="string"&&(u=l.trim())}else typeof t=="string"&&(u=t.trim());var d=null;if(u&&(d=i[u]||null,!d)){var p=$i(u);p&&(i[p]?d=i[p]:s[p]&&i[s[p]]&&(d=i[s[p]]))}if(d&&Array.isArray(d.options))return d.options.slice();var g=[];return Object.values(i).forEach(function(h){!h||!Array.isArray(h.options)||h.options.forEach(function(A){!A||g.includes(A)||g.push(A)})}),g}return AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(r)?Sy(r).map(function(h){return h.value}):[]}function eT(e){var t=Hc(e),r=getLanguageTexts(currentLang),o=yy();return t==="monitor"?r.autoGearSelectorMonitorOption||o.autoGearSelectorMonitorOption||"Monitor selector":t==="directorMonitor"?r.autoGearSelectorDirectorOption||o.autoGearSelectorDirectorOption||"Director monitor selector":t==="tripodHeadBrand"?r.autoGearSelectorTripodHeadOption||o.autoGearSelectorTripodHeadOption||"Tripod head selector":t==="tripodBowl"?r.autoGearSelectorTripodBowlOption||o.autoGearSelectorTripodBowlOption||"Tripod bowl selector":t==="tripodTypes"?r.autoGearSelectorTripodTypesOption||o.autoGearSelectorTripodTypesOption||"Tripod type selector":t==="tripodSpreader"?r.autoGearSelectorTripodSpreaderOption||o.autoGearSelectorTripodSpreaderOption||"Tripod spreader selector":t==="fizHandUnit"?r.autoGearSelectorFizHandUnitOption||o.autoGearSelectorFizHandUnitOption||"FIZ hand unit selector":r.autoGearSelectorNoneOption||o.autoGearSelectorNoneOption||"No selector"}function tT(){var e=getLanguageTexts(currentLang),t=yy();return e.autoGearSelectorScrollHint||t.autoGearSelectorScrollHint||"Scroll to see more devices."}function rT(){var e=getLanguageTexts(currentLang),t=yy();return e.autoGearSelectorDefaultPlaceholder||t.autoGearSelectorDefaultPlaceholder||"Choose a default device"}function oT(){var e=getLanguageTexts(currentLang),t=yy();return e.autoGearMonitorDefaultPlaceholder||t.autoGearMonitorDefaultPlaceholder||"Use recommended automatically"}function nT(e,t){var r=typeof t=="string"?t.trim():"";if(!r)return"";var o=Hc(e);if(AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(o)){var n=Sy(o),a=n.find(function(i){return i.value.toLowerCase()===r.toLowerCase()});if(a&&a.label)return a.label}return typeof addArriKNumber=="function"&&(o==="monitor"||o==="directorMonitor"||o==="fizHandUnit")?addArriKNumber(r):r}function aT(e,t){var r,o;if(e){var n=typeof t=="string"?t:"",a=typeof currentLang=="string"?currentLang:"en";e.innerHTML="",GEAR_LIST_CATEGORIES.forEach(function(s){var u=document.createElement("option");u.value=s,u.textContent=s,n===s&&(u.selected=!0),e.appendChild(u)});var i=document.createElement("option");i.value=AUTO_GEAR_CUSTOM_CATEGORY,i.textContent=((r=texts==null?void 0:texts[a])===null||r===void 0?void 0:r.autoGearCustomCategory)||((o=texts==null?void 0:texts.en)===null||o===void 0?void 0:o.autoGearCustomCategory)||"Custom Additions",(!n||n===AUTO_GEAR_CUSTOM_CATEGORY)&&(i.selected=!0),e.appendChild(i)}}function vy(e){if(!e||typeof e.name!="string")return"";var t=typeof e?.quantity=="number"?String(e.quantity):e?.quantity,r=formatOwnGearQuantityText(t);return r?"".concat(e.name," (").concat(r,")"):e.name}function IA(e){if(autoGearOwnGearSelect){var t=Array.isArray(e)?e.filter(function(s){return typeof s=="string"}).map(function(s){return s.trim()}).filter(Boolean):collectAutoGearSelectedValues(e,"ownGear");autoGearOwnGearSelect.innerHTML="",autoGearOwnGearSelect.multiple=!0;var r=getAutoGearOwnGearItems(),o=new Set,n=function(s,u,l){if(l===void 0&&(l={}),typeof s=="string"){var d=s.trim();if(!(!d||o.has(d))){var p=document.createElement("option");p.value=d,p.textContent=u||d,l.dataset&&p.dataset&&Object.entries(l.dataset).forEach(function(g){var h=g[0],A=g[1];A!=null&&(p.dataset[h]=A)}),l.fallback&&(p.dataset.autoGearFallback="true"),t.includes(d)&&(p.selected=!0),autoGearOwnGearSelect.appendChild(p),o.add(d)}}};r.forEach(function(s){if(!(!s||typeof s.id!="string")){var u=s.id.trim();if(u){var l={};typeof s.name=="string"&&s.name&&(l.name=s.name);var d=formatOwnGearQuantityText(s.quantity);d&&(l.quantity=d),typeof s.notes=="string"&&s.notes&&(l.notes=s.notes),n(u,vy(s)||s.name||u,{dataset:l})}}}),t.forEach(function(s){if(!(!s||o.has(s))){var u=typeof findAutoGearOwnGearById=="function"?findAutoGearOwnGearById(s):null,l=u?.name||s;n(s,l,{fallback:!0})}});var a=Array.from(autoGearOwnGearSelect.options||[]).filter(function(s){return!s.disabled});autoGearOwnGearSelect.size=computeAutoGearMultiSelectSize(a.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS});var i=a.some(function(s){return s.dataset.autoGearFallback!=="true"});autoGearOwnGearSelect.disabled=!i&&t.length===0}}function iT(){var e=[autoGearAddOwnGearSelect,autoGearRemoveOwnGearSelect].filter(Boolean);if(e.length){var t=getAutoGearOwnGearItems();e.forEach(function(r){var o,n;if(r){var a=r.value||"",i=r.getAttribute("data-placeholder")||((o=texts[currentLang])===null||o===void 0?void 0:o.autoGearOwnGearPlaceholder)||((n=texts.en)===null||n===void 0?void 0:n.autoGearOwnGearPlaceholder)||"Manual entry";r.innerHTML="";var s=document.createElement("option");s.value="",s.textContent=i,r.appendChild(s),t.forEach(function(u){if(!(!u||typeof u.id!="string"||!u.id||typeof u.name!="string")){var l=document.createElement("option");l.value=u.id,l.textContent=vy(u)||u.name,l.dataset.name=u.name,u.notes&&(l.dataset.notes=u.notes),u.source&&(l.dataset.source=u.source);var d=formatOwnGearQuantityText(u.quantity);d&&(l.dataset.quantity=d),u.id===a&&(l.selected=!0),r.appendChild(l)}}),a&&r.value!==a&&(r.querySelector('option[value="'.concat(a,'"]'))?r.value=a:r.value=""),r.disabled=t.length===0}}),IA(Array.isArray(autoGearEditorDraft==null?void 0:autoGearEditorDraft.ownGear)?autoGearEditorDraft.ownGear:void 0)}}function Ql(e){return typeof e!="string"?!1:e.trim().toLowerCase()==="monitoring"}function TA(e){var t;if(!e)return!1;var r=typeof e.value=="string"?e.value:"";if(Ql(r))return!0;var o=((t=e.options)===null||t===void 0?void 0:t[e.selectedIndex])||null;if(!o)return!1;var n=typeof o.value=="string"?o.value:"";if(Ql(n))return!0;var a=typeof o.textContent=="string"?o.textContent:"";return Ql(a)}function Xu(e){var t=typeof e=="string"?e.trim().toLowerCase():"";return t?t==="camera support"||t==="grip"?!0:t.includes("tripod"):!1}function OA(e){var t;if(!e)return!1;var r=typeof e.value=="string"?e.value:"";if(Xu(r))return!0;var o=((t=e.options)===null||t===void 0?void 0:t[e.selectedIndex])||null;if(!o)return!1;if(Xu(o.value))return!0;var n=typeof o.textContent=="string"?o.textContent:"";return Xu(n)}function Zu(e,t){if(e)if(t)if(e.hidden=!1,e.removeAttribute("hidden"),e.removeAttribute("aria-hidden"),Object.prototype.hasOwnProperty.call(e.dataset,"autoGearHiddenDisplay")){var r=e.dataset.autoGearHiddenDisplay;r?e.style.display=r:e.style.removeProperty("display"),delete e.dataset.autoGearHiddenDisplay}else e.style.display==="none"&&e.style.removeProperty("display");else e.hidden=!0,e.setAttribute("hidden",""),e.setAttribute("aria-hidden","true"),Object.prototype.hasOwnProperty.call(e.dataset,"autoGearHiddenDisplay")||(e.dataset.autoGearHiddenDisplay=e.style.display||""),e.style.display="none"}function sT(e){if(!(!e||!e.select)){var t=e.select,r=e.screenSizeField,o=e.screenSizeInput,n=e.selectorTypeField,a=e.selectorTypeSelect,i=e.selectorDefaultField,s=e.selectorDefaultInput,u=TA(t),l=OA(t),d=u,p=u||l;Zu(r,d),Zu(n,p),Zu(i,p),!d&&o&&(o.value=""),p||(a&&(a.value="none"),s&&(s.value="",Object.prototype.hasOwnProperty.call(s.dataset||{},"autoGearPreferredDefault")&&delete s.dataset.autoGearPreferredDefault))}}function GA(e){var t=[];if(!e||typeof e!="string")return{baseName:"",contexts:t};for(var r=e.trim(),o=/^(.*\([^()]*\)) \(([^()]+)\)$/,n=r.match(o);n;){var a=n[2].trim();if(/handheld\b/i.test(a)||/15-21"?$/.test(a))t.unshift(a),r=n[1].trim();else break;n=r.match(o)}return{baseName:r,contexts:t}}function vd(e){if(!e||typeof e!="object")return null;var t=Na(e.name),r=typeof e.ownGearId=="string"?e.ownGearId.trim():"",o=Na(e.ownGearLabel),n=Na(e.ownGearName),a=null;r&&(a=findAutoGearOwnGearById(r)||null);var i=a?.name||n||t;if(!i)return null;var s=GA(t||i),u=s.baseName,l=s.contexts,d=u||i,p=Array.isArray(e.contextNotes)?e.contextNotes.filter(function($){return typeof $=="string"&&$.trim()}):[];p.forEach(function($){var z=$.trim();z&&(l.includes(z)||l.push(z))});var g=Na(e.category),h=Nc(e.quantity),A=typeof e.id=="string"&&e.id?e.id:Fc("item"),m=Na(e.screenSize),y=Hc(e.selectorType),S=typeof e.selectorContext=="string"?e.selectorContext.trim():"",E=by(y,e.selectorDefault,S),I=!!e.selectorEnabled;y==="none"?I=!1:Ql(g)&&(I=!0);var L=Na(e.notes),R="",G="";if(a){if(R=a.id,G=a.name||"",d=a.name||d,!L&&typeof a.notes=="string"){var j=Na(a.notes);j&&(L=j)}}else r&&(R=r,G=o||n||d);return{id:A,name:d,category:g,quantity:h,screenSize:m,selectorType:y,selectorDefault:E,selectorEnabled:I,selectorContext:S,notes:L,contextNotes:l,ownGearId:R,ownGearLabel:G}}function Jr(e){return Array.isArray(e)?Array.from(new Set(e.map(function(t){return typeof t=="string"?t.trim():""}).filter(Boolean))):[]}var cM=new Set(["all","any","multiplier"]);function kA(e){if(typeof e!="string")return"all";var t=e.trim().toLowerCase();return t?t==="or"?"any":t==="and"?"all":t==="any"?"any":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":cM.has(t)?t:"all":"all"}var uM=new Set(["all","any","or","none","multiplier"]),BA={mattebox:"matteboxLogic",cameraHandle:"cameraHandleLogic",viewfinderExtension:"viewfinderExtensionLogic",deliveryResolution:"deliveryResolutionLogic",videoDistribution:"videoDistributionLogic",camera:"cameraLogic",ownGear:"ownGearLogic",monitor:"monitorLogic",tripodHeadBrand:"tripodHeadBrandLogic",tripodBowl:"tripodBowlLogic",tripodTypes:"tripodTypesLogic",tripodSpreader:"tripodSpreaderLogic",crewPresent:"crewPresentLogic",crewAbsent:"crewAbsentLogic",wireless:"wirelessLogic",motors:"motorsLogic",controllers:"controllersLogic",distance:"distanceLogic"};function zt(e){if(typeof e!="string")return"all";var t=e.trim().toLowerCase();return t?t==="or"?"or":t==="and"?"all":t==="any"?"any":t==="none"||t==="no"||t==="exclude"||t==="absent"?"none":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":uM.has(t)?t:(typeof console<"u"&&typeof console.warn=="function"&&console.warn('Unknown auto gear condition logic joiner. Falling back to "all".',e),"all"):"all"}function ro(e,t){if(!e||typeof e!="object")return"all";var r=BA[t],o;if(r&&Object.prototype.hasOwnProperty.call(e,r)&&(o=e[r]),o==null){var n="".concat(t,"Mode");Object.prototype.hasOwnProperty.call(e,n)&&(o=e[n])}return o==null&&e.conditionLogic&&typeof e.conditionLogic=="object"&&(o=e.conditionLogic[t]),zt(o)}function PA(e){var t=parseInt(e,10);return Number.isFinite(t)&&t>1?t:1}function xA(e){return typeof e=="string"?e.trim():""}function MA(e){if(!Array.isArray(e))return[];var t=Jr(e),r=new Set,o=[];return t.forEach(function(n){var a=n.toLowerCase(),i=a==="__none__"||a==="none"?"__none__":n;!i||r.has(i)||(r.add(i),o.push(i))}),o}function $i(e){return typeof e=="string"?e.trim().toLowerCase():""}function lT(e){if(!e||typeof e!="object")return"";var t=Array.isArray(e.mattebox)?e.mattebox:[];return t.length?t.map($i).filter(Boolean).sort(function(r,o){return r.localeCompare(o)}).join("|"):""}var dM=new Set(["minimum","maximum","every"]);function DA(e){if(typeof e!="string")return"minimum";var t=e.trim().toLowerCase();return t?dM.has(t)?t:t==="min"||t==="at least"?"minimum":t==="max"||t==="at most"?"maximum":t==="each"||t==="every"?"every":"minimum":"minimum"}function Ad(e){if(typeof e=="number"&&Number.isFinite(e)){var t=Math.round(e);return t>0?t:null}if(typeof e=="string"){var r=e.trim();if(!r)return null;var o=Number.parseInt(r,10);return Number.isFinite(o)&&o>0?o:null}return null}function _A(e){if(!Array.isArray(e))return[];var t=new Set;return e.forEach(function(r){var o=Ad(r);Number.isFinite(o)&&o>0&&t.add(o)}),Array.from(t).sort(function(r,o){return r-o})}function df(e){var t,r,o,n,a,i,s,u,l;if(!e)return null;if(Array.isArray(e)){var d=_A(e);if(!d.length)return null;var p=d[d.length-1];return Number.isFinite(p)&&p>0?{mode:"minimum",value:p}:null}if(typeof e=="object"){var g=(n=(o=(r=(t=e.mode)!==null&&t!==void 0?t:e.type)!==null&&r!==void 0?r:e.comparison)!==null&&o!==void 0?o:e.condition)!==null&&n!==void 0?n:e.kind,h=DA(g),A=(l=(u=(s=(i=(a=e.value)!==null&&a!==void 0?a:e.count)!==null&&i!==void 0?i:e.days)!==null&&s!==void 0?s:e.minimum)!==null&&u!==void 0?u:e.maximum)!==null&&l!==void 0?l:e.frequency,m=Ad(A);return Number.isFinite(m)&&m>0?{mode:h,value:m}:null}var y=Ad(e);return Number.isFinite(y)&&y>0?{mode:"minimum",value:y}:null}function ff(e){if(!e||typeof e!="object")return null;var t=typeof e.id=="string"&&e.id?e.id:Fc("rule"),r=typeof e.label=="string"?e.label.trim():"",o=!0;if(typeof e.enabled=="string"){var n=e.enabled.trim().toLowerCase();(n==="false"||n==="0")&&(o=!1)}else e.enabled===!1&&(o=!1);var a=!1;if(Array.isArray(e.always))a=e.always.some(function(ge){if(typeof ge=="string"){var pe=ge.trim().toLowerCase();return!(!pe||pe==="false"||pe==="0")}return!!ge});else if(typeof e.always=="string"){var i=e.always.trim().toLowerCase();a=i==="true"||i&&i!=="false"&&i!=="0"}else a=!!e.always;var s=Jr(e.scenarios),u=kA(e.scenarioLogic),l=1,d="";if(u==="multiplier"){l=PA(e.scenarioMultiplier);var p=xA(e.scenarioPrimary),g=$i(p);if(g){var h=s.find(function(ge){return $i(ge)===g});h?d=h:p&&(d=p,s.push(p))}!d&&s.length&&(d=s[0])}if(s=s.sort(function(ge,pe){return ge.localeCompare(pe)}),u==="multiplier"&&d){var A=$i(d),m=s.some(function(ge){return $i(ge)===A});m||(s.push(d),s.sort(function(ge,pe){return ge.localeCompare(pe)}))}var y=Jr(e.mattebox).sort(function(ge,pe){return ge.localeCompare(pe)}),S=Jr(e.cameraHandle).sort(function(ge,pe){return ge.localeCompare(pe)}),E=Jr(e.viewfinderExtension).sort(function(ge,pe){return ge.localeCompare(pe)}),I=Jr(e.deliveryResolution).sort(function(ge,pe){return ge.localeCompare(pe)}),L=MA(e.videoDistribution).sort(function(ge,pe){return ge.localeCompare(pe)}),R=Jr(e.camera).sort(function(ge,pe){return ge.localeCompare(pe)}),G=Jr(e.ownGear).sort(function(ge,pe){return ge.localeCompare(pe)}),j=normalizeAutoGearCameraWeightCondition(e.cameraWeight),$=Jr(e.monitor).sort(function(ge,pe){return ge.localeCompare(pe)}),z=Jr(e.tripodHeadBrand).sort(function(ge,pe){return ge.localeCompare(pe)}),te=Jr(e.tripodBowl).sort(function(ge,pe){return ge.localeCompare(pe)}),oe=Jr(e.tripodTypes).sort(function(ge,pe){return ge.localeCompare(pe)}),k=Jr(e.tripodSpreader).sort(function(ge,pe){return ge.localeCompare(pe)}),Z=Jr(e.crewPresent).sort(function(ge,pe){return ge.localeCompare(pe)}),ue=Jr(e.crewAbsent).sort(function(ge,pe){return ge.localeCompare(pe)}),H=Jr(e.wireless).sort(function(ge,pe){return ge.localeCompare(pe)}),Y=Jr(e.motors).sort(function(ge,pe){return ge.localeCompare(pe)}),N=Jr(e.controllers).sort(function(ge,pe){return ge.localeCompare(pe)}),ae=Jr(e.distance).sort(function(ge,pe){return ge.localeCompare(pe)}),de=df(e.shootingDays),Q=ro(e,"mattebox"),ne=ro(e,"cameraHandle"),V=ro(e,"viewfinderExtension"),fe=ro(e,"deliveryResolution"),J=ro(e,"videoDistribution"),Ae=ro(e,"camera"),Le=ro(e,"ownGear"),_e=ro(e,"monitor"),Je=ro(e,"tripodHeadBrand"),xe=ro(e,"tripodBowl"),Ze=ro(e,"tripodTypes"),Ve=ro(e,"tripodSpreader"),Dt=ro(e,"crewPresent"),We=ro(e,"crewAbsent"),ft=ro(e,"wireless"),D=ro(e,"motors"),q=ro(e,"controllers"),we=ro(e,"distance"),ve={};if(u&&u!=="all"&&(ve.scenarios=u),Q&&Q!=="all"&&(ve.mattebox=Q),ne&&ne!=="all"&&(ve.cameraHandle=ne),V&&V!=="all"&&(ve.viewfinderExtension=V),fe&&fe!=="all"&&(ve.deliveryResolution=fe),J&&J!=="all"&&(ve.videoDistribution=J),Ae&&Ae!=="all"&&(ve.camera=Ae),Le&&Le!=="all"&&(ve.ownGear=Le),_e&&_e!=="all"&&(ve.monitor=_e),Je&&Je!=="all"&&(ve.tripodHeadBrand=Je),xe&&xe!=="all"&&(ve.tripodBowl=xe),Ze&&Ze!=="all"&&(ve.tripodTypes=Ze),Ve&&Ve!=="all"&&(ve.tripodSpreader=Ve),Dt&&Dt!=="all"&&(ve.crewPresent=Dt),We&&We!=="all"&&(ve.crewAbsent=We),ft&&ft!=="all"&&(ve.wireless=ft),D&&D!=="all"&&(ve.motors=D),q&&q!=="all"&&(ve.controllers=q),we&&we!=="all"&&(ve.distance=we),!a&&!s.length&&!de&&!y.length&&!S.length&&!E.length&&!I.length&&!L.length&&!R.length&&!G.length&&!j&&!$.length&&!z.length&&!te.length&&!oe.length&&!k.length&&!Z.length&&!ue.length&&!H.length&&!Y.length&&!N.length&&!ae.length)return null;var Se=Array.isArray(e.add)?e.add.map(vd).filter(Boolean):[],he=Array.isArray(e.remove)?e.remove.map(vd).filter(Boolean):[];return!Se.length&&!he.length?null:{id:t,label:r,always:a,scenarioLogic:u,scenarioPrimary:d,scenarioMultiplier:l,scenarios:s,mattebox:y,cameraHandle:S,viewfinderExtension:E,deliveryResolution:I,videoDistribution:L,camera:R,ownGear:G,cameraWeight:j,monitor:$,tripodHeadBrand:z,tripodBowl:te,tripodTypes:oe,tripodSpreader:k,crewPresent:Z,crewAbsent:ue,wireless:H,motors:Y,controllers:N,distance:ae,shootingDays:de,matteboxLogic:Q,cameraHandleLogic:ne,viewfinderExtensionLogic:V,deliveryResolutionLogic:fe,videoDistributionLogic:J,cameraLogic:Ae,ownGearLogic:Le,monitorLogic:_e,tripodHeadBrandLogic:Je,tripodBowlLogic:xe,tripodTypesLogic:Ze,tripodSpreaderLogic:Ve,crewPresentLogic:Dt,crewAbsentLogic:We,wirelessLogic:ft,motorsLogic:D,controllersLogic:q,distanceLogic:we,conditionLogic:ve,add:Se,remove:he,enabled:o}}function Ay(e){var t=vd(e);if(!t)return{name:"",category:"",quantity:0,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:"",ownGearId:"",ownGearLabel:""};var r=t.name,o=t.category,n=t.quantity,a=t.screenSize,i=t.selectorType,s=t.selectorDefault,u=t.selectorEnabled,l=t.notes,d=t.ownGearId,p=t.ownGearLabel;return{name:r,category:o,quantity:Nc(n),screenSize:a,selectorType:i,selectorDefault:s,selectorEnabled:u,notes:l,ownGearId:d,ownGearLabel:p}}function Ac(e){var t=Ay(e),r=t.name||"",o=t.category||"",n=Nc(t.quantity),a=t.screenSize||"",i=t.selectorType||"none",s=t.selectorDefault||"",u=t.selectorEnabled?"1":"0",l=t.notes||"",d=t.ownGearId||"",p=t.ownGearLabel||"";return"".concat(r,"|").concat(o,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(u,"|").concat(s,"|").concat(l,"|").concat(d,"|").concat(p)}function FA(e){var t=ff(e);if(!t)return null;var r=function(o){return o.map(Ay).sort(function(n,a){return Ac(n).localeCompare(Ac(a))})};return{label:t.label||"",always:t.always?1:0,scenarios:t.scenarios.slice().sort(function(o,n){return o.localeCompare(n)}),mattebox:t.mattebox.slice().sort(function(o,n){return o.localeCompare(n)}),cameraHandle:t.cameraHandle.slice().sort(function(o,n){return o.localeCompare(n)}),viewfinderExtension:t.viewfinderExtension.slice().sort(function(o,n){return o.localeCompare(n)}),deliveryResolution:t.deliveryResolution.slice().sort(function(o,n){return o.localeCompare(n)}),videoDistribution:t.videoDistribution.slice().sort(function(o,n){return o.localeCompare(n)}),camera:t.camera.slice().sort(function(o,n){return o.localeCompare(n)}),cameraWeight:t.cameraWeight?{operator:t.cameraWeight.operator,value:t.cameraWeight.value}:null,monitor:t.monitor.slice().sort(function(o,n){return o.localeCompare(n)}),tripodHeadBrand:t.tripodHeadBrand.slice().sort(function(o,n){return o.localeCompare(n)}),tripodBowl:t.tripodBowl.slice().sort(function(o,n){return o.localeCompare(n)}),tripodTypes:t.tripodTypes.slice().sort(function(o,n){return o.localeCompare(n)}),tripodSpreader:t.tripodSpreader.slice().sort(function(o,n){return o.localeCompare(n)}),crewPresent:t.crewPresent.slice().sort(function(o,n){return o.localeCompare(n)}),crewAbsent:t.crewAbsent.slice().sort(function(o,n){return o.localeCompare(n)}),wireless:t.wireless.slice().sort(function(o,n){return o.localeCompare(n)}),motors:t.motors.slice().sort(function(o,n){return o.localeCompare(n)}),controllers:t.controllers.slice().sort(function(o,n){return o.localeCompare(n)}),distance:t.distance.slice().sort(function(o,n){return o.localeCompare(n)}),shootingDays:df(t.shootingDays),matteboxLogic:zt(t.matteboxLogic),cameraHandleLogic:zt(t.cameraHandleLogic),viewfinderExtensionLogic:zt(t.viewfinderExtensionLogic),deliveryResolutionLogic:zt(t.deliveryResolutionLogic),videoDistributionLogic:zt(t.videoDistributionLogic),cameraLogic:zt(t.cameraLogic),monitorLogic:zt(t.monitorLogic),tripodHeadBrandLogic:zt(t.tripodHeadBrandLogic),tripodBowlLogic:zt(t.tripodBowlLogic),tripodTypesLogic:zt(t.tripodTypesLogic),tripodSpreaderLogic:zt(t.tripodSpreaderLogic),crewPresentLogic:zt(t.crewPresentLogic),crewAbsentLogic:zt(t.crewAbsentLogic),wirelessLogic:zt(t.wirelessLogic),motorsLogic:zt(t.motorsLogic),controllersLogic:zt(t.controllersLogic),distanceLogic:zt(t.distanceLogic),conditionLogic:t.conditionLogic?Object.keys(t.conditionLogic).reduce(function(o,n){return o[n]=zt(t.conditionLogic[n]),o},{}):{},add:r(t.add),remove:r(t.remove),enabled:t.enabled?1:0}}function Vm(e){var t=e&&e.always?"1":"0",r=Array.isArray(e.scenarios)?e.scenarios.join("|"):"",o=Array.isArray(e.mattebox)?e.mattebox.join("|"):"",n=Array.isArray(e.cameraHandle)?e.cameraHandle.join("|"):"",a=Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.join("|"):"",i=Array.isArray(e.deliveryResolution)?e.deliveryResolution.join("|"):"",s=Array.isArray(e.videoDistribution)?e.videoDistribution.join("|"):"",u=Array.isArray(e.camera)?e.camera.join("|"):"",l=normalizeAutoGearCameraWeightCondition(e?.cameraWeight),d=l?"".concat(l.operator,":").concat(l.value):"",p=Array.isArray(e.monitor)?e.monitor.join("|"):"",g=Array.isArray(e.tripodHeadBrand)?e.tripodHeadBrand.join("|"):"",h=Array.isArray(e.tripodBowl)?e.tripodBowl.join("|"):"",A=Array.isArray(e.tripodTypes)?e.tripodTypes.join("|"):"",m=Array.isArray(e.tripodSpreader)?e.tripodSpreader.join("|"):"",y=Array.isArray(e.crewPresent)?e.crewPresent.join("|"):"",S=Array.isArray(e.crewAbsent)?e.crewAbsent.join("|"):"",E=Array.isArray(e.wireless)?e.wireless.join("|"):"",I=Array.isArray(e.motors)?e.motors.join("|"):"",L=Array.isArray(e.controllers)?e.controllers.join("|"):"",R=Array.isArray(e.distance)?e.distance.join("|"):"",G=df(e?.shootingDays),j=G?"".concat(G.mode,":").concat(G.value):"",$=zt(e?.matteboxLogic),z=zt(e?.cameraHandleLogic),te=zt(e?.viewfinderExtensionLogic),oe=zt(e?.deliveryResolutionLogic),k=zt(e?.videoDistributionLogic),Z=zt(e?.cameraLogic),ue=zt(e?.monitorLogic),H=zt(e?.tripodHeadBrandLogic),Y=zt(e?.tripodBowlLogic),N=zt(e?.tripodTypesLogic),ae=zt(e?.tripodSpreaderLogic),de=zt(e?.crewPresentLogic),Q=zt(e?.crewAbsentLogic),ne=zt(e?.wirelessLogic),V=zt(e?.motorsLogic),fe=zt(e?.controllersLogic),J=zt(e?.distanceLogic),Ae=Array.isArray(e.add)?e.add.map(Ac).join("|"):"",Le=Array.isArray(e.remove)?e.remove.map(Ac).join("|"):"";return"".concat(t,"|").concat(r,"|").concat(o,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(u,"|").concat(d,"|").concat(p,"|").concat(g,"|").concat(h,"|").concat(A,"|").concat(m,"|").concat(y,"|").concat(S,"|").concat(E,"|").concat(I,"|").concat(L,"|").concat(R,"|").concat(j,"|").concat($,"|").concat(z,"|").concat(te,"|").concat(oe,"|").concat(k,"|").concat(Z,"|").concat(ue,"|").concat(H,"|").concat(Y,"|").concat(N,"|").concat(ae,"|").concat(de,"|").concat(Q,"|").concat(ne,"|").concat(V,"|").concat(fe,"|").concat(J,"|").concat(e.label||"","|").concat(Ae,"|").concat(Le)}function NA(e){var t=(Array.isArray(e)?e:[]).map(FA).filter(Boolean).sort(function(r,o){return Vm(r).localeCompare(Vm(o))});return tM(t)}function cT(e){if(!e||typeof e!="object")return null;var t=typeof e.label=="string"?e.label.trim():"";if(!t)return null;var r=Array.isArray(e.rules)?e.rules:[],o=r.map(ff).filter(Boolean),n=typeof e.id=="string"&&e.id?e.id:Fc("preset"),a=NA(o);return{id:n,label:t,rules:o,fingerprint:a}}function uT(e){if(!e||typeof e!="object")return null;var t=typeof e.createdAt=="string"?e.createdAt:null,r=t?Date.parse(t):NaN;if(!Number.isFinite(r))return null;var o=new Date(r).toISOString(),n=Array.isArray(e.rules)?e.rules:[],a=n.map(ff).filter(Boolean),i=n.length===0?[]:a,s=typeof e.id=="string"&&e.id?e.id:Fc("backup"),u=hy(e.monitorDefaults),l=typeof e.note=="string"?e.note:"";return{id:s,createdAt:o,rules:i,monitorDefaults:u,note:l}}var nv={generateAutoGearId:Fc,normalizeAutoGearQuantity:Nc,parseAutoGearDraftNames:ZI,normalizeAutoGearText:Na,normalizeAutoGearSelectorType:Hc,normalizeAutoGearSelectorDefault:by,resolveDevicesSnapshot:wA,updateGlobalDevicesReference:JI,resolveTripodPreferenceSelect:LA,collectTripodPreferenceOptions:Sy,getAutoGearSelectorOptions:RA,getAutoGearSelectorLabel:eT,getAutoGearSelectorScrollHint:tT,getAutoGearSelectorDefaultPlaceholder:rT,getAutoGearMonitorDefaultPlaceholder:oT,formatAutoGearSelectorValue:nT,populateAutoGearCategorySelect:aT,formatAutoGearOwnGearLabel:vy,refreshAutoGearOwnGearConditionOptions:IA,updateAutoGearOwnGearOptions:iT,isAutoGearMonitoringCategory:Ql,isMonitoringCategorySelected:TA,matchesTripodCategory:Xu,isTripodCategorySelected:OA,setAutoGearFieldVisibility:Zu,updateAutoGearMonitorFieldGroup:sT,extractAutoGearContextNotes:GA,normalizeAutoGearItem:vd,normalizeAutoGearTriggerList:Jr,normalizeAutoGearScenarioLogic:kA,normalizeAutoGearConditionLogic:zt,readAutoGearConditionLogic:ro,normalizeAutoGearScenarioMultiplier:PA,normalizeAutoGearScenarioPrimary:xA,normalizeVideoDistributionTriggerList:MA,normalizeAutoGearTriggerValue:$i,normalizeAutoGearShootingDayMode:DA,normalizeAutoGearShootingDayValue:Ad,normalizeAutoGearShootingDaysList:_A,normalizeAutoGearShootingDaysCondition:df,normalizeAutoGearRule:ff,autoGearItemSnapshot:Ay,autoGearItemSortKey:Ac,autoGearRuleMatteboxKey:lT,snapshotAutoGearRuleForFingerprint:FA,autoGearRuleSortKey:Vm,createAutoGearRulesFingerprint:NA,normalizeAutoGearPreset:cT,normalizeAutoGearBackupEntry:uT,normalizeAutoGearMonitorDefaults:hy,AUTO_GEAR_MONITOR_DEFAULT_TYPES:Sd,AUTO_GEAR_CONDITION_LOGIC_FIELDS:BA};typeof module<"u"&&module.exports&&(module.exports=nv);if(typeof globalThis<"u"){var fM=typeof globalThis.AUTO_GEAR_NORMALIZER_EXPORTS=="object"&&globalThis.AUTO_GEAR_NORMALIZER_EXPORTS?globalThis.AUTO_GEAR_NORMALIZER_EXPORTS:globalThis.AUTO_GEAR_NORMALIZER_EXPORTS={};Object.assign(fM,nv),Object.assign(globalThis,nv),globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES=Sd,globalThis.normalizeAutoGearMonitorDefaults=hy}const pM=Object.freeze(Object.defineProperty({__proto__:null,AUTO_GEAR_CONDITION_LOGIC_FIELDS:BA,AUTO_GEAR_MONITOR_DEFAULT_TYPES:Sd,autoGearItemSnapshot:Ay,autoGearItemSortKey:Ac,autoGearRuleMatteboxKey:lT,autoGearRuleSortKey:Vm,collectTripodPreferenceOptions:Sy,createAutoGearRulesFingerprint:NA,extractAutoGearContextNotes:GA,formatAutoGearOwnGearLabel:vy,formatAutoGearSelectorValue:nT,generateAutoGearId:Fc,getAutoGearMonitorDefaultPlaceholder:oT,getAutoGearSelectorDefaultPlaceholder:rT,getAutoGearSelectorLabel:eT,getAutoGearSelectorOptions:RA,getAutoGearSelectorScrollHint:tT,isAutoGearMonitoringCategory:Ql,isMonitoringCategorySelected:TA,isTripodCategorySelected:OA,matchesTripodCategory:Xu,normalizeAutoGearBackupEntry:uT,normalizeAutoGearConditionLogic:zt,normalizeAutoGearItem:vd,normalizeAutoGearMonitorDefaults:hy,normalizeAutoGearPreset:cT,normalizeAutoGearQuantity:Nc,normalizeAutoGearRule:ff,normalizeAutoGearScenarioLogic:kA,normalizeAutoGearScenarioMultiplier:PA,normalizeAutoGearScenarioPrimary:xA,normalizeAutoGearSelectorDefault:by,normalizeAutoGearSelectorType:Hc,normalizeAutoGearShootingDayMode:DA,normalizeAutoGearShootingDayValue:Ad,normalizeAutoGearShootingDaysCondition:df,normalizeAutoGearShootingDaysList:_A,normalizeAutoGearText:Na,normalizeAutoGearTriggerList:Jr,normalizeAutoGearTriggerValue:$i,normalizeVideoDistributionTriggerList:MA,parseAutoGearDraftNames:ZI,populateAutoGearCategorySelect:aT,readAutoGearConditionLogic:ro,refreshAutoGearOwnGearConditionOptions:IA,resolveDevicesSnapshot:wA,resolveTripodPreferenceSelect:LA,setAutoGearFieldVisibility:Zu,snapshotAutoGearRuleForFingerprint:FA,updateAutoGearMonitorFieldGroup:sT,updateAutoGearOwnGearOptions:iT,updateGlobalDevicesReference:JI},Symbol.toStringTag,{value:"Module"}));var mM=36,pb=1,gM=120,yM="cineAutoGearPersistence",zC=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;function Ed(e){if(!zC)return null;var t=zC[e];return typeof t=="number"&&Number.isFinite(t)?t:null}function Ci(){var e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof self<"u"&&e.push(self),typeof global<"u"&&e.push(global);for(var t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(r.cineAutoGearPersistence)return r.cineAutoGearPersistence;var o=r.cineModules;if(o&&typeof o.get=="function"){var n=o.get(yM);if(n)return n}}}return null}function al(e,t){var r=Ci();if(!r||typeof r[e]!="function")return null;var o=r[e](t);return o&&typeof o.catch=="function"&&o.catch(function(n){console.warn("Auto-Gear persistence failed for ".concat(e),n)}),o}function bM(e,t,r){if(typeof e!="number"||!Number.isFinite(e))return null;var o=Math.round(e);return Number.isFinite(o)?o<t?t:o>r?r:o:null}function Wm(){var e=Ed("AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE");if(e!==null)return Math.max(pb,Math.round(e));var t=Ed("AUTO_GEAR_BACKUP_RETENTION_MIN");return t!==null?Math.max(pb,Math.round(t)):pb}function dT(){var e=Ed("AUTO_GEAR_BACKUP_RETENTION_MAX");return e!==null?Math.max(Wm(),Math.round(e)):Math.max(Wm(),gM)}function Km(){for(var e=Wm(),t=dT(),r=[Ed("AUTO_GEAR_BACKUP_RETENTION_DEFAULT"),Ed("AUTO_GEAR_BACKUP_RETENTION_DEFAULT_VALUE"),mM],o=0;o<r.length;o+=1){var n=r[o],a=bM(n,e,t);if(typeof a=="number")return a}return e}function fT(e){e===void 0&&(e=Km());var t=[],r=Ci();if(r&&typeof r.readAutoGearBackups=="function")t=r.readAutoGearBackups();else if(typeof loadAutoGearBackups=="function")try{t=loadAutoGearBackups()}catch(n){console.warn("Failed to load automatic gear backups",n),t=[]}if(!Array.isArray(t))return[];var o=Ec(e);return t.map(normalizeAutoGearBackupEntry).filter(Boolean).sort(function(n,a){return n.createdAt===a.createdAt?0:n.createdAt>a.createdAt?-1:1}).slice(0,o)}function hM(e){return e.sort(function(t,r){return t.label.localeCompare(r.label,void 0,{sensitivity:"base",numeric:!0})})}function SM(){var e=[],t=Ci();if(t&&typeof t.readAutoGearPresets=="function")e=t.readAutoGearPresets();else if(typeof loadAutoGearPresets=="function")try{e=loadAutoGearPresets()}catch(r){console.warn("Failed to load automatic gear presets",r),e=[]}return Array.isArray(e)?hM(e.map(normalizeAutoGearPreset).filter(Boolean)):[]}function vM(e){var t=Array.isArray(e)?e.map(function(r){return{id:r.id,label:r.label,rules:Array.isArray(r.rules)?r.rules:[]}}):[];if(!al("persistAutoGearPresets",t)&&typeof saveAutoGearPresets=="function")try{saveAutoGearPresets(t);return}catch(r){console.warn("Failed to save automatic gear presets",r)}}function AM(){var e={},t=Ci();if(t&&typeof t.readAutoGearMonitorDefaults=="function")e=t.readAutoGearMonitorDefaults();else if(typeof loadAutoGearMonitorDefaults=="function")try{e=loadAutoGearMonitorDefaults()}catch(r){console.warn("Failed to load automatic gear monitor defaults",r),e={}}return normalizeAutoGearMonitorDefaults(e)}function EM(e){var t=normalizeAutoGearMonitorDefaults(e);if(al("persistAutoGearMonitorDefaults",t))return t;if(typeof saveAutoGearMonitorDefaults=="function")try{return saveAutoGearMonitorDefaults(t),t}catch(r){console.warn("Failed to save automatic gear monitor defaults",r)}return t}function CM(){var e=Ci();if(e&&typeof e.readActivePresetId=="function")return e.readActivePresetId();if(typeof loadAutoGearActivePresetId=="function")try{var t=loadAutoGearActivePresetId();return typeof t=="string"?t:""}catch(r){return console.warn("Failed to load automatic gear active preset id",r),""}return""}function wM(e){if(!al("persistActivePresetId",e)&&typeof saveAutoGearActivePresetId=="function")try{saveAutoGearActivePresetId(typeof e=="string"?e:"");return}catch(t){console.warn("Failed to save automatic gear active preset id",t)}}function LM(){var e=Ci();if(e&&typeof e.readAutoPresetId=="function")return e.readAutoPresetId();if(typeof loadAutoGearAutoPresetId=="function")try{var t=loadAutoGearAutoPresetId();return typeof t=="string"?t:""}catch(r){return console.warn("Failed to load automatic gear auto preset id",r),""}return""}function RM(e){if(!al("persistAutoPresetId",e)&&typeof saveAutoGearAutoPresetId=="function")try{saveAutoGearAutoPresetId(typeof e=="string"?e:"");return}catch(t){console.warn("Failed to save automatic gear auto preset id",t)}}function IM(){var e=Ci();if(e&&typeof e.readBackupVisibility=="function")return e.readBackupVisibility();if(typeof loadAutoGearBackupVisibility=="function")try{return!!loadAutoGearBackupVisibility()}catch(t){return console.warn("Failed to load automatic gear backup visibility",t),!1}return!1}function TM(e){var t=!!e;if(!al("persistBackupVisibility",t)&&typeof saveAutoGearBackupVisibility=="function")try{saveAutoGearBackupVisibility(t);return}catch(r){console.warn("Failed to save automatic gear backup visibility",r)}}function Ec(e){var t=Number(e);if(!Number.isFinite(t))return Km();var r=Math.round(t);if(!Number.isFinite(r))return Km();var o=Wm(),n=dT();return r<o?o:r>n?n:r}function OM(){var e=Ci();if(e&&typeof e.readBackupRetention=="function"){var t=e.readBackupRetention();if(t!==null&&typeof t<"u")return Ec(t)}if(typeof loadAutoGearBackupRetention=="function")try{return Ec(loadAutoGearBackupRetention())}catch(r){console.warn("Failed to load automatic gear backup retention",r)}return Km()}function av(e){var t=Ec(e);if(al("persistBackupRetention",t))return!0;if(typeof saveAutoGearBackupRetention=="function")try{return saveAutoGearBackupRetention(t),!0}catch(r){console.warn("Failed to save automatic gear backup retention",r)}return!1}function iv(e){var t=Array.isArray(e)?e.map(function(o){return{id:o.id,createdAt:o.createdAt,rules:Array.isArray(o.rules)?o.rules:[],monitorDefaults:normalizeAutoGearMonitorDefaults(o.monitorDefaults),note:typeof o.note=="string"?o.note:void 0}}):[];if(al("persistAutoGearBackups",t))return t;if(typeof saveAutoGearBackups=="function"){var r=saveAutoGearBackups(t);return Array.isArray(r)?r:t}throw new Error("Storage unavailable")}function If(e,t){var r=[];typeof globalThis<"u"&&r.push(globalThis),typeof window<"u"&&r.push(window),typeof self<"u"&&r.push(self),typeof global<"u"&&r.push(global);for(var o=0;o<r.length;o+=1){var n=r[o];if(n&&Object.prototype.hasOwnProperty.call(n,e))return n[e]=t,!0}return!1}function GM(e){var t=Ec(e),r=autoGearBackupRetention;if(t===r)return callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!0,trimmed:[],previousLimit:r};var o=autoGearBackups.slice(),n=[],a=av(t);if(!a)return autoGearBackupRetentionInput&&(autoGearBackupRetentionInput.value=String(autoGearBackupRetention)),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!1,error:new Error("retention-persist-failed"),previousLimit:r};if(If("autoGearBackupRetention",t),autoGearBackups.length>t){var i=autoGearBackups.slice(0,t);n.push.apply(n,autoGearBackups.slice(t));try{var s=iv(i)||[],u=Array.isArray(s)?s:[];u.length<i.length&&n.push.apply(n,i.slice(u.length)),If("autoGearBackups",u)}catch(l){console.warn("Failed to trim automatic gear backups to retention limit",l),If("autoGearBackupRetention",r),av(r);try{iv(o)}catch(d){console.warn("Failed to restore automatic gear backups after trim error",d)}return If("autoGearBackups",fT(r)),callCoreFunctionIfAvailable("renderAutoGearBackupControls",[],{defer:!0}),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!1,error:l,previousLimit:r}}}return callCoreFunctionIfAvailable("renderAutoGearBackupControls",[],{defer:!0}),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!0,trimmed:n,previousLimit:r}}function kM(){var e=[],t=Ci();if(t&&typeof t.readAutoGearRules=="function")e=t.readAutoGearRules();else if(typeof loadAutoGearRules<"u"&&typeof loadAutoGearRules=="function")try{e=loadAutoGearRules()}catch(r){console.warn("Failed to load automatic gear rules",r),e=[]}return Array.isArray(e)?e.map(normalizeAutoGearRule).filter(Boolean):[]}var Ym={readAutoGearBackupsFromStorage:fT,readAutoGearPresetsFromStorage:SM,persistAutoGearPresets:vM,normalizeAutoGearMonitorDefaults,readAutoGearMonitorDefaultsFromStorage:AM,persistAutoGearMonitorDefaults:EM,readActiveAutoGearPresetIdFromStorage:CM,persistActiveAutoGearPresetId:wM,readAutoGearAutoPresetIdFromStorage:LM,persistAutoGearAutoPresetId:RM,readAutoGearBackupVisibilityFromStorage:IM,persistAutoGearBackupVisibility:TM,clampAutoGearBackupRetentionLimit:Ec,readAutoGearBackupRetentionFromStorage:OM,persistAutoGearBackupRetention:av,persistAutoGearBackups:iv,enforceAutoGearBackupRetentionLimit:GM,readAutoGearRulesFromStorage:kM};typeof module<"u"&&module.exports&&(module.exports=Ym);if(typeof globalThis<"u"){var BM=typeof globalThis.AUTO_GEAR_STORAGE_EXPORTS=="object"&&globalThis.AUTO_GEAR_STORAGE_EXPORTS?globalThis.AUTO_GEAR_STORAGE_EXPORTS:globalThis.AUTO_GEAR_STORAGE_EXPORTS={};Object.assign(BM,Ym)}(function(){for(var e=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],t=function(u,l,d){if(!(!u||typeof u!="object"&&typeof u!="function")&&typeof u[l]!="function")try{u[l]=d}catch{try{Object.defineProperty(u,l,{configurable:!0,enumerable:!1,writable:!0,value:d})}catch{}}},r=Object.keys(Ym),o=0;o<e.length;o+=1){var n=e[o];if(n)for(var a=0;a<r.length;a+=1){var i=r[a],s=Ym[i];typeof s=="function"&&t(n,i,s)}}})();const PM=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Cd=`
`;function wd(e,t=Cd){const r=typeof t=="string"&&t?t:Cd;if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"){try{return String(e)}catch{}return""}if(Array.isArray(e)){const o=[];for(let n=0;n<e.length;n+=1){const a=wd(e[n],r);a&&o.push(a)}return o.join(r)}if(e&&typeof e=="object"){if(typeof e.text=="string")return e.text;if(Array.isArray(e.text))return wd(e.text,r);if(typeof e.label=="string")return e.label;try{const o=String(e);if(o&&o!=="[object Object]")return o}catch{}}return""}function pT(e,t,r,o="",n=Cd){const a=typeof o=="string"?o:"",i=[];e&&(typeof e=="object"||typeof e=="function")&&i.push(e),t&&t!==e&&(typeof t=="object"||typeof t=="function")&&i.push(t);for(let s=0;s<i.length;s+=1){const u=i[s];let l;try{l=u[r]}catch{l=void 0}if(typeof l>"u"||l===null)continue;const d=wd(l,n);if(typeof d=="string")return d}return a}const xM=Object.freeze(Object.defineProperty({__proto__:null,TEXT_ENTRY_SEPARATOR:Cd,normaliseTextEntryValue:wd,resolveTextEntry:pT},Symbol.toStringTag,{value:"Module"}));function HA(){return typeof document<"u"?document:null}function jc(e){let t=null;const r=HA();return r&&(t=r.createElement("div")),t?(t.textContent=e,t.innerHTML):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function Cc(e){if(typeof e!="string"||e==="")return"";try{return jc(e)}catch{}return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function sv(e){return typeof e!="number"?!1:typeof Number.isFinite=="function"?Number.isFinite(e):isFinite(e)}function Tf(e,t){const r=parseInt(e,t);if(!sv(r)||r<0)return"";try{if(typeof String.fromCodePoint=="function")return String.fromCodePoint(r)}catch{}return r<=65535?String.fromCharCode(r):""}function UC(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.match(/^(?:\\)+u([0-9A-Fa-f]{4})$/);if(r){const i=Tf(r[1],16);if(i)return i}const o=t.match(/^(?:\\)+u\{([0-9A-Fa-f]+)\}$/);if(o){const i=Tf(o[1],16);if(i)return i}const n=t.match(/^&#x([0-9A-Fa-f]+);$/i);if(n){const i=Tf(n[1],16);if(i)return i}const a=t.match(/^&#(\d+);$/);if(a){const i=Tf(a[1],10);if(i)return i}return t}function MM(e){if(typeof e=="string")return Cc(e);if(e===null||typeof e>"u")return"";try{return Cc(String(e))}catch{}return""}function DM(e){if(!e)return null;if(typeof e=="string"){const l=UC(e);return l?{char:l,font:"uicons",className:""}:null}if(typeof e!="object")return null;const t=typeof e.markup=="string"?e.markup.trim():"",r=typeof e.className=="string"?e.className:"",o=typeof e.style=="string"?e.style:"",n=e.size,a=e.scale;if(t)return{markup:t,className:r,style:o,size:n,scale:a};const i=typeof e.char=="string"&&e.char?e.char:typeof e.character=="string"&&e.character?e.character:typeof e.glyph=="string"&&e.glyph?e.glyph:typeof e.unicode=="string"&&e.unicode?e.unicode:"",s=UC(i);if(!s)return null;const u=typeof e.font=="string"&&e.font.trim()?e.font.trim():"uicons";return{char:s,font:u,className:r,style:o,size:n,scale:a}}function jA(e,t){const r=DM(e);if(!r)return"";const o=["icon-glyph"];typeof t=="string"&&t&&o.unshift(t),r.className&&r.className.split(/\s+/).filter(Boolean).forEach(l=>{o.indexOf(l)===-1&&o.push(l)});const n=[];sv(r.size)&&r.size>0?n.push(`--icon-size: ${r.size}px`):typeof r.size=="string"&&r.size.trim()&&n.push(`--icon-size: ${r.size.trim()}`),sv(r.scale)&&r.scale>0?n.push(`--icon-scale: ${r.scale}`):typeof r.scale=="string"&&r.scale.trim()&&n.push(`--icon-scale: ${r.scale.trim()}`),typeof r.style=="string"&&r.style.trim()&&n.push(r.style.trim());const a=n.length?` style="${n.join(";")}"`:"";if(r.markup)return`<span class="${o.join(" ")}"${a} aria-hidden="true">${r.markup}</span>`;const i=typeof r.char=="string"?r.char:"";if(!i)return"";const s=typeof r.font=="string"?r.font:"uicons",u=s?` data-icon-font="${MM(s)}"`:"";return`<span class="${o.join(" ")}"${a}${u} aria-hidden="true">${jc(i)}</span>`}function mT(e,t){if(!e)return"";if(typeof t=="function")try{return t(e,"btn-icon")}catch{}return jA(e,"btn-icon")}function gT(e,t,r,o){if(!e)return;const n=HA(),a=mT(r,o),i=typeof t=="string"?t:"";if(e.firstChild)for(;e.firstChild;)e.removeChild(e.firstChild);if(n&&a){const s=n.createElement("span");for(s.innerHTML=a;s.firstChild;)e.appendChild(s.firstChild)}else if(!n&&a&&typeof e.innerHTML=="string"){e.innerHTML=`${a}${Cc(i)}`;return}n?e.appendChild(n.createTextNode(i)):typeof e.textContent=="string"?e.textContent=i:typeof e.innerHTML=="string"&&(e.innerHTML=Cc(i))}function yT(e,t,r={}){if(!e||typeof t!="function")return!1;const o=HA();if(!o)return!1;const n=d=>{let p=o.getElementById(d);if(!p)try{p=o.querySelector(d)}catch{}return p},a=n(e);if(a){try{t(a)}catch(d){typeof console<"u"&&console.error(`whenElementAvailable: handler for ${e} failed`,d)}return!0}const i=typeof r.maxAttempts=="number"?r.maxAttempts:150,s=typeof r.interval=="number"&&r.interval>0?r.interval:100;let u=0;const l=()=>{u+=1;const d=n(e);if(d){try{t(d)}catch(p){typeof console<"u"&&console.error(`whenElementAvailable: polled handler for ${e} failed`,p)}return}if(u<i)setTimeout(l,s);else if(typeof r.onTimeout=="function")try{r.onTimeout()}catch{}};return setTimeout(l,s),!0}(()=>{if(typeof window>"u")return null;try{if(!("localStorage"in window))return null;const{localStorage:e}=window,t="__schema_cache__";return e.setItem(t,"1"),e.removeItem(t),e}catch(e){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Device schema cache disabled",e),null}})();const _M=xM,FM="cameraPowerPlanner_temperatureUnit";function NM(e=[]){for(const t of e)if(t){if(t.TEMPERATURE_STORAGE_KEY)return t.TEMPERATURE_STORAGE_KEY;if(t.TEMPERATURE_UNIT_STORAGE_KEY)return t.TEMPERATURE_UNIT_STORAGE_KEY;if(t.CORE_SHARED?.TEMPERATURE_STORAGE_KEY)return t.CORE_SHARED.TEMPERATURE_STORAGE_KEY;if(t.__cineStorageApi){if(t.__cineStorageApi.TEMPERATURE_STORAGE_KEY)return t.__cineStorageApi.TEMPERATURE_STORAGE_KEY;if(typeof t.__cineStorageApi.getTemperaturePreferenceStorageKey=="function")try{const r=t.__cineStorageApi.getTemperaturePreferenceStorageKey();if(r)return r}catch{}}if(typeof t.resolveTemperatureStorageKey=="function")try{const r=t.resolveTemperatureStorageKey();if(r)return r}catch{}}return FM}function pf(e,t,r){return r&&r[e]?r[e]:typeof window<"u"&&window[e]?window[e]:null}NM(cs());const HM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};function Ea(e,t){return pf(e,t,HM)}const mb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:null;mb&&(mb.resolveTextEntryInternal||(mb.resolveTextEntryInternal=_M.resolveTextEntry));function Cr(e){return!!e&&(typeof e=="object"||typeof e=="function")}function Hs(e){return typeof e=="function"?e:typeof require=="function"?require:null}function Qs(e){return Array.isArray(e)?e.slice():[]}function bT(e,t){const r=arguments.length>1,o=r?e:null,n=r?t:e,a={};if(o&&Cr(o)&&!Array.isArray(o)){const s=Object.keys(o);for(let u=0;u<s.length;u+=1){const l=s[u];a[l]=o[l]}}a.resolveCoreSupportModule=typeof a.resolveCoreSupportModule=="function"?a.resolveCoreSupportModule:null,a.requireFn=Hs(a.requireFn),a.runtimeScope=a.runtimeScope&&Cr(a.runtimeScope)?a.runtimeScope:null,a.coreGlobalScope=a.coreGlobalScope&&Cr(a.coreGlobalScope)?a.coreGlobalScope:null,a.fallbackScopes=Qs(a.fallbackScopes);function i(s){if(!s)return;if(Array.isArray(s)){a.fallbackScopes=s.slice();return}if(!Cr(s))return;Array.isArray(s.fallbackScopes)?a.fallbackScopes=s.fallbackScopes.slice():s.fallbackScopes&&(a.fallbackScopes=[s.fallbackScopes]),s.runtimeScope&&Cr(s.runtimeScope)&&(a.runtimeScope=s.runtimeScope),s.coreGlobalScope&&Cr(s.coreGlobalScope)&&(a.coreGlobalScope=s.coreGlobalScope),typeof s.requireFn=="function"?a.requireFn=s.requireFn:Object.prototype.hasOwnProperty.call(s,"requireFn")&&(a.requireFn=Hs(s.requireFn)),typeof s.resolveCoreSupportModule=="function"?a.resolveCoreSupportModule=s.resolveCoreSupportModule:Object.prototype.hasOwnProperty.call(s,"resolveCoreSupportModule")&&(a.resolveCoreSupportModule=null);const u=Object.keys(s);for(let l=0;l<u.length;l+=1){const d=u[l];d==="fallbackScopes"||d==="runtimeScope"||d==="coreGlobalScope"||d==="requireFn"||d==="resolveCoreSupportModule"||(a[d]=s[d])}}return i(n),a.requireFn=Hs(a.requireFn),a.fallbackScopes=Qs(a.fallbackScopes),a}function zA(e,t,r){if(!Array.isArray(e))return[];const o=e.slice();t&&Cr(t)&&o.indexOf(t)===-1&&o.push(t),r&&Cr(r)&&o.indexOf(r)===-1&&o.push(r);const n=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let a=0;a<n.length;a+=1){const i=n[a];!i||!Cr(i)||o.indexOf(i)===-1&&o.push(i)}return o}function UA(e){const t=bT(e),r=t.runtimeScope,o=t.coreGlobalScope,n=Qs(t.fallbackScopes),a=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||(t._isResolvingEnvironment?null:hT(t)),i=t.bootstrapResultsTools||(e&&e.getBootstrapResultsTools?e.getBootstrapResultsTools(t):null);if(i&&typeof i.collectBootstrapFallbackScopes=="function"){const s=a&&typeof a.collectFallbackScopes=="function"?function(l){try{const d=a.collectFallbackScopes({fallbackScopes:Array.isArray(l)?l:Qs(l),runtimeScope:r,coreGlobalScope:o});if(Array.isArray(d))return d}catch{}if(Array.isArray(l))try{const d=a.collectFallbackScopes(l);if(Array.isArray(d))return d}catch{}return null}:null;try{const u=i.collectBootstrapFallbackScopes({fallbackScopes:n,runtimeScope:r,coreGlobalScope:o,collectFallbackScopes:s});if(Array.isArray(u))return u}catch{}}if(a&&typeof a.collectFallbackScopes=="function"){try{const s=a.collectFallbackScopes({fallbackScopes:n,runtimeScope:r,coreGlobalScope:o});if(Array.isArray(s))return s}catch{}if(Array.isArray(n))try{const s=a.collectFallbackScopes(n);if(Array.isArray(s))return s}catch{}}return zA(n,r,o)}function $A(e,t,r){const o=r&&Cr(r.directNamespace)?r.directNamespace:null;if(o)return o;const n=r&&typeof r.resolveCoreSupportModule=="function"?r.resolveCoreSupportModule:null;if(n)try{const s=n(e,t);if(s&&Cr(s))return s}catch{}const a=Hs(r&&r.requireFn);if(typeof a=="function"&&t)try{const s=a(t);if(s&&Cr(s))return s}catch{}const i=UA(r);for(let s=0;s<i.length;s+=1){const u=i[s];if(!(!u||!Cr(u)))try{const l=u[e];if(l&&Cr(l))return l}catch{}}return null}function hT(e){return e&&Cr(e.bootstrapEnvironmentTools)?e.bootstrapEnvironmentTools:e&&Cr(e.bootstrapEnvironment)?e.bootstrapEnvironment:ST(e)}function ST(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):{};return!t.directNamespace&&e&&Cr(e.directBootstrapEnvironmentNamespace)&&(t.directNamespace=e.directBootstrapEnvironmentNamespace),t._isResolvingEnvironment=!0,$A("cineCoreAppCoreBootstrapEnvironment","./modules/app-core/bootstrap.js",t)}function vT(e){const t=e&&Cr(e.runtimeScope)?e.runtimeScope:null,r=e&&Cr(e.coreGlobalScope)?e.coreGlobalScope:null;return zA(Qs(e&&e.fallbackScopes),t,r)}function ys(e){return!!e&&typeof e=="object"&&typeof e.resolveBootstrapTools=="function"&&typeof e.resolveBootstrapFallbackTools=="function"&&typeof e.createInlineLocalizationFallback=="function"&&typeof e.createInlineRuntimeSharedFallback=="function"}function AT(e){const t=e&&Cr(e.directResolverNamespace)?e.directResolverNamespace:null;if(ys(t))return t;const r={resolveCoreSupportModule:e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,requireFn:Hs(e&&e.requireFn),runtimeScope:e&&Cr(e.runtimeScope)?e.runtimeScope:null,coreGlobalScope:e&&Cr(e.coreGlobalScope)?e.coreGlobalScope:null,fallbackScopes:Qs(e&&e.fallbackScopes)},o=$A("cineCoreAppCoreBootstrapResolver","./modules/app-core/bootstrap.js",Object.assign({},r,{directNamespace:t}));if(ys(o))return o;if(o&&Cr(o.cineCoreAppCoreBootstrapResolver)&&ys(o.cineCoreAppCoreBootstrapResolver))return o.cineCoreAppCoreBootstrapResolver;if(o&&Cr(o.cineCoreAppCoreBootstrap)&&ys(o.cineCoreAppCoreBootstrap))return o.cineCoreAppCoreBootstrap;const n=UA(r);for(let a=0;a<n.length;a+=1){const i=n[a];if(!(!i||!Cr(i)))try{const s=i.cineCoreAppCoreBootstrapResolver;if(ys(s))return s;const u=i.cineCoreAppCoreBootstrap;if(ys(u))return u}catch{}}return null}function jM(e){const t=Hs(e&&e.requireFn),r=e&&Cr(e.runtimeScope)?e.runtimeScope:null,o=e&&Cr(e.coreGlobalScope)?e.coreGlobalScope:null,n=vT({runtimeScope:r,coreGlobalScope:o,fallbackScopes:e&&e.fallbackScopes}),a=AT({directResolverNamespace:e&&e.directResolverNamespace,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:o,fallbackScopes:n});return{fallbackScopes:n,bootstrapResolverTools:a}}const La={createBootstrapEnvironment:jM,resolveBootstrapResolverTools:AT,resolveBootstrapEnvironmentTools:ST,collectFallbackScopes:vT,normalizeBootstrapInvocationOptions:bT,collectBootstrapFallbackScopes:UA,resolveNamespace:$A,ensureRequireFn:Hs,ensureArray:Qs,isObject:Cr,appendFallbackScopes:zA,hasBootstrapResolverCapabilities:ys,getBootstrapEnvironmentTools:hT},{isObject:fr,ensureArray:$C,ensureRequireFn:ET}=La;function Dn(e,t){!t||!fr(t)||Array.isArray(e)&&e.indexOf(t)===-1&&e.push(t)}function js(e,t){if(typeof e!="function")return null;try{const r=e(t);return r&&typeof r=="object"?r:null}catch{}return null}function Ey(e){const t=e&&fr(e.runtimeScope)?e.runtimeScope:null,r=e&&fr(e.coreGlobalScope)?e.coreGlobalScope:null,o=e?e.fallbackScopes:null;if(e&&typeof e.collectFallbackScopes=="function")try{const a=e.collectFallbackScopes(o);if(Array.isArray(a)){const i=$C(a);return Dn(i,t),Dn(i,r),Dn(i,typeof globalThis<"u"?globalThis:null),Dn(i,typeof window<"u"?window:null),Dn(i,typeof self<"u"?self:null),Dn(i,typeof global<"u"?global:null),i}}catch{}const n=$C(o);return Dn(n,t),Dn(n,r),Dn(n,typeof globalThis<"u"?globalThis:null),Dn(n,typeof window<"u"?window:null),Dn(n,typeof self<"u"?self:null),Dn(n,typeof global<"u"?global:null),n}function CT(){return{localizationSupport:null,localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function wT(e){const t=Ey(e||null),r=e&&fr(e.currentRuntimeShared)?e.currentRuntimeShared:null;function o(){for(let a=0;a<t.length;a+=1){const i=t[a];if(fr(i))try{const s=i.cineCoreRuntimeShared;if(s&&typeof s=="object")return s}catch{}}return null}let n=r;if((!n||typeof n!="object")&&(n=o()),!n||typeof n!="object")try{n=Object.create(null)}catch{n={}}return{runtimeSharedNamespace:null,runtimeSharedResolver:null,existingRuntimeShared:n,runtimeShared:n,fallbackResolveRuntimeSharedFromGlobal:o}}function LT(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):{};return!t.directNamespace&&e&&fr(e.directBootstrapResultsNamespace)&&(t.directNamespace=e.directBootstrapResultsNamespace),La.resolveNamespace("cineCoreAppCoreBootstrapResults","./modules/app-core/bootstrap.js",t)}function zM(e){return e&&fr(e.bootstrapResultsTools)?e.bootstrapResultsTools:e&&fr(e.resultsTools)?e.resultsTools:LT(e)}function UM(e){const t=e&&fr(e.runtimeScope)?e.runtimeScope:null,r=e&&fr(e.coreGlobalScope)?e.coreGlobalScope:null,o=Ey({runtimeScope:t,coreGlobalScope:r,fallbackScopes:e&&e.fallbackScopes,collectFallbackScopes:e&&e.collectFallbackScopes}),n=ET(e&&e.requireFn),a=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,i={localizationSupportTools:e&&fr(e.localizationSupportTools)?e.localizationSupportTools:null,localizationBootstrapTools:e&&fr(e.localizationBootstrapTools)?e.localizationBootstrapTools:null,localizationRuntimeTools:e&&fr(e.localizationRuntimeTools)?e.localizationRuntimeTools:null,resolveCoreSupportModule:a,requireFn:n,runtimeScope:t,coreGlobalScope:r,fallbackScopes:o,currentLocalization:e&&fr(e.currentLocalization)?e.currentLocalization:null},s=e&&fr(e.bootstrapTools)?e.bootstrapTools:null;let u=js(s&&s.createLocalizationBootstrapResult,i);if(u||(u=js(s&&s.createLocalizationBootstrapFallback,i)),!u){const l=e&&typeof e.createInlineLocalizationFallback=="function"?e.createInlineLocalizationFallback:null;u=js(l,{fallbackTools:e&&fr(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:null,resolveCoreSupportModule:a,requireFn:n,runtimeScope:t,coreGlobalScope:r,fallbackScopes:o,localizationFallbackOptions:e&&e.localizationFallbackOptions?e.localizationFallbackOptions:null})}return u||(u=CT()),u}function $M(e){const t=e&&fr(e.runtimeScope)?e.runtimeScope:null,r=e&&fr(e.coreGlobalScope)?e.coreGlobalScope:null,o=Ey({runtimeScope:t,coreGlobalScope:r,fallbackScopes:e&&e.fallbackScopes,collectFallbackScopes:e&&e.collectFallbackScopes}),n=ET(e&&e.requireFn),a=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,i={runtimeSharedBootstrapResolverTools:e&&fr(e.runtimeSharedBootstrapResolverTools)?e.runtimeSharedBootstrapResolverTools:null,runtimeSharedBootstrapTools:e&&fr(e.runtimeSharedBootstrapTools)?e.runtimeSharedBootstrapTools:null,runtimeSharedNamespaceTools:e&&fr(e.runtimeSharedNamespaceTools)?e.runtimeSharedNamespaceTools:null,runtimeSharedBootstrapInlineTools:e&&fr(e.runtimeSharedBootstrapInlineTools)?e.runtimeSharedBootstrapInlineTools:null,runtimeSharedBootstrapResultTools:e&&fr(e.runtimeSharedBootstrapResultTools)?e.runtimeSharedBootstrapResultTools:null,runtimeSharedBootstrapLoaderTools:e&&fr(e.runtimeSharedBootstrapLoaderTools)?e.runtimeSharedBootstrapLoaderTools:null,runtimeSharedBootstrapManagerTools:e&&fr(e.runtimeSharedBootstrapManagerTools)?e.runtimeSharedBootstrapManagerTools:null,resolveCoreSupportModule:a,requireFn:n,runtimeScope:t,coreGlobalScope:r,currentRuntimeShared:e&&fr(e.currentRuntimeShared)?e.currentRuntimeShared:null,fallbackScopes:o,runtimeSharedBootstrapInlineRequirePath:e&&e.runtimeSharedBootstrapInlineRequirePath?e.runtimeSharedBootstrapInlineRequirePath:null,runtimeSharedBootstrapResultRequirePath:e&&e.runtimeSharedBootstrapResultRequirePath?e.runtimeSharedBootstrapResultRequirePath:null},s=e&&fr(e.bootstrapTools)?e.bootstrapTools:null;let u=js(s&&s.createRuntimeSharedBootstrapResult,i);if(u||(u=js(s&&s.createRuntimeSharedBootstrapFallback,i)),!u){const l=e&&typeof e.createInlineRuntimeSharedFallback=="function"?e.createInlineRuntimeSharedFallback:null;u=js(l,{fallbackTools:e&&fr(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:null,resolveCoreSupportModule:a,requireFn:n,runtimeScope:t,coreGlobalScope:r,fallbackScopes:o,currentRuntimeShared:e&&fr(e.currentRuntimeShared)?e.currentRuntimeShared:null})}return u||(u=wT({runtimeScope:t,coreGlobalScope:r,fallbackScopes:o,currentRuntimeShared:e&&fr(e.currentRuntimeShared)?e.currentRuntimeShared:null})),u}const qA={resolveLocalizationBootstrapResult:UM,resolveRuntimeSharedBootstrapResult:$M,collectBootstrapFallbackScopes:function(e){return Ey(e||null)},createLocalizationFallbackSkeleton:CT,createRuntimeSharedFallbackSkeleton:wT,resolveBootstrapResultsTools:LT,getBootstrapResultsTools:zM,attemptFactory:js},{isObject:ut,ensureRequireFn:VA,ensureArray:qM,resolveNamespace:RT,normalizeBootstrapInvocationOptions:Xs,collectBootstrapFallbackScopes:WA,getBootstrapEnvironmentTools:KA,resolveBootstrapResolverTools:IT,resolveBootstrapEnvironmentTools:TT,createBootstrapEnvironment:VM}=La,{createLocalizationFallbackSkeleton:WM,createRuntimeSharedFallbackSkeleton:KM,resolveLocalizationBootstrapResult:YM,resolveRuntimeSharedBootstrapResult:OT,resolveBootstrapResultsTools:GT,attemptFactory:gb,getBootstrapResultsTools:YA}=qA;function kT(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):{};return!t.directNamespace&&e&&ut(e.directBootstrapNamespace)&&(t.directNamespace=e.directBootstrapNamespace),RT("cineCoreAppCoreBootstrap","./modules/app-core/bootstrap.js",t)}function QA(e){const t=e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):{};return!t.directNamespace&&e&&ut(e.directBootstrapFallbackNamespace)&&(t.directNamespace=e.directBootstrapFallbackNamespace),RT("cineCoreAppCoreBootstrapFallbacks","./modules/app-core/bootstrap.js",t)}function BT(e){return e&&ut(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:e&&ut(e.fallbackTools)?e.fallbackTools:QA(e)}function PT(e){return e&&ut(e.bootstrapResolverTools)&&La.hasBootstrapResolverCapabilities(e.bootstrapResolverTools)?e.bootstrapResolverTools:IT(e)}function QM(e){const t=e&&ut(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.resolveBootstrapTools=="function")try{const i=t.resolveBootstrapTools(e);if(i&&ut(i))return i}catch{}const r=e&&ut(e.directBootstrapNamespace)?e.directBootstrapNamespace:null;if(r&&ut(r))return r;const o=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null;if(o)try{const i=o("cineCoreAppCoreBootstrap","./modules/app-core/bootstrap.js");if(i&&ut(i))return i}catch{}const n=VA(e&&e.requireFn);if(typeof n=="function")try{const i=n("./modules/app-core/bootstrap.js");if(i&&ut(i))return i}catch{}const a=La.collectFallbackScopes(e);for(let i=0;i<a.length;i+=1){const s=a[i];if(!(!s||!ut(s)))try{const u=s.cineCoreAppCoreBootstrap;if(u&&ut(u))return u}catch{}}return null}function XM(e){const t=e&&ut(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.resolveBootstrapFallbackTools=="function")try{const i=t.resolveBootstrapFallbackTools(e);if(i&&ut(i))return i}catch{}const r=e&&ut(e.directBootstrapFallbackNamespace)?e.directBootstrapFallbackNamespace:null;if(r&&ut(r))return r;const o=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null;if(o)try{const i=o("cineCoreAppCoreBootstrapFallbacks","./modules/app-core/bootstrap.js");if(i&&ut(i))return i}catch{}const n=VA(e&&e.requireFn);if(typeof n=="function")try{const i=n("./modules/app-core/bootstrap.js");if(i&&ut(i.cineCoreAppCoreBootstrapFallbacks))return i.cineCoreAppCoreBootstrapFallbacks;if(i&&ut(i))return i}catch{}const a=La.collectFallbackScopes(e);for(let i=0;i<a.length;i+=1){const s=a[i];if(!(!s||!ut(s)))try{const u=s.cineCoreAppCoreBootstrapFallbacks;if(u&&ut(u))return u}catch{}}return null}function ZM(e){const t=e&&ut(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.createInlineLocalizationFallback=="function")try{const o=t.createInlineLocalizationFallback(e);if(o&&ut(o))return o}catch{}const r=e&&ut(e.fallbackTools)?e.fallbackTools:null;if(r&&typeof r.createLocalizationBootstrapFallback=="function")try{const o=r.createLocalizationBootstrapFallback(e);if(o&&ut(o))return o}catch{}return Cy()}function JM(e){const t=e&&ut(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.createInlineRuntimeSharedFallback=="function")try{const i=t.createInlineRuntimeSharedFallback(e);if(i&&ut(i))return i}catch{}const r=e&&ut(e.fallbackTools)?e.fallbackTools:null;if(r&&typeof r.createRuntimeSharedBootstrapFallback=="function")try{const i=r.createRuntimeSharedBootstrapFallback(e);if(i&&ut(i))return i}catch{}const o=La.collectFallbackScopes(e);function n(){for(let i=0;i<o.length;i+=1){const s=o[i];if(!(!s||!ut(s)))try{const u=s.cineCoreRuntimeShared;if(u&&ut(u))return u}catch{}}return null}let a=e&&ut(e.currentRuntimeShared)?e.currentRuntimeShared:null;if(a||(a=n()),!a||typeof a!="object")try{a=Object.create(null)}catch{a={}}return{runtimeSharedNamespace:null,runtimeSharedResolver:null,existingRuntimeShared:a,runtimeShared:a,fallbackResolveRuntimeSharedFromGlobal:n}}function eD(e){const t=e&&ut(e.localizationSupportTools)?e.localizationSupportTools:null,r=e&&ut(e.localizationBootstrapTools)?e.localizationBootstrapTools:null,o=e&&ut(e.localizationRuntimeTools)?e.localizationRuntimeTools:null,n=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,a=VA(e&&e.requireFn),i=e&&ut(e.runtimeScope)?e.runtimeScope:null,s=e&&ut(e.coreGlobalScope)?e.coreGlobalScope:null,u=La.appendFallbackScopes(qM(e&&e.fallbackScopes),i,s),l={localizationSupportTools:t,resolveCoreSupportModule:n,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:u};let d=gb(r&&r.createLocalizationBootstrapResult,l);return d||(d=gb(o&&o.resolveRuntimeLocalization,{currentLocalization:e&&e.currentLocalization,resolveCoreSupportModule:n,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:u})),d||(d=gb(o&&o.createFallbackLocalizationRuntimeSetup,{currentLocalization:e&&e.currentLocalization,resolveCoreSupportModule:n,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:u})),d||(d=Cy()),d}function tD(e){const t=OT(e);return t||wy(e)}function Cy(){return WM()}function wy(e){return KM(e)}function lv(e){const t=Xs(e),r=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||KA(t),o=t.bootstrapResultsTools||YA(t),n=t.localizationFallbackOptions||null,a=Xs(t,{bootstrapEnvironmentTools:r,bootstrapEnvironment:r,bootstrapResultsTools:o,fallbackScopes:t.fallbackScopes}),i=WA(a);a.fallbackScopes=i;const s=t.bootstrapResolverTools||PT(a),u=t.bootstrapFallbackTools||t.fallbackTools||BT(a),l=t.bootstrapSuite&&ut(t.bootstrapSuite)?t.bootstrapSuite:null;if(s&&typeof s.createInlineLocalizationFallback=="function")try{const d=s.createInlineLocalizationFallback({fallbackTools:u,resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:t.requireFn,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,fallbackScopes:i,localizationFallbackOptions:n});if(d&&ut(d))return d}catch{}if(l&&typeof l.createLocalizationBootstrapFallback=="function")try{const d=l.createLocalizationBootstrapFallback({fallbackScopes:i,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,localizationFallbackOptions:n});if(d&&ut(d))return d}catch{}if(u&&typeof u.createLocalizationBootstrapFallback=="function")try{const d=u.createLocalizationBootstrapFallback({resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:t.requireFn,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,fallbackScopes:i,localizationFallbackOptions:n});if(d&&ut(d))return d}catch{}if(o&&typeof o.createLocalizationFallbackSkeleton=="function")try{const d=o.createLocalizationFallbackSkeleton();if(d&&ut(d))return d}catch{}return Cy()}function cv(e){const t=Xs(e),r=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||KA(t),o=t.bootstrapResultsTools||YA(t),n=Xs(t,{bootstrapEnvironmentTools:r,bootstrapEnvironment:r,bootstrapResultsTools:o,fallbackScopes:t.fallbackScopes}),a=WA(n);n.fallbackScopes=a;const i=t.bootstrapResolverTools||PT(n),s=t.bootstrapFallbackTools||t.fallbackTools||BT(n),u=t.bootstrapSuite&&ut(t.bootstrapSuite)?t.bootstrapSuite:null;if(i&&typeof i.createInlineRuntimeSharedFallback=="function")try{const l=i.createInlineRuntimeSharedFallback({fallbackTools:s,resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:t.requireFn,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,fallbackScopes:a,currentRuntimeShared:t.currentRuntimeShared});if(l&&ut(l))return l}catch{}if(u&&typeof u.createRuntimeSharedBootstrapFallback=="function")try{const l=u.createRuntimeSharedBootstrapFallback({fallbackScopes:a,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,currentRuntimeShared:t.currentRuntimeShared});if(l&&ut(l))return l}catch{}if(s&&typeof s.createRuntimeSharedBootstrapFallback=="function")try{const l=s.createRuntimeSharedBootstrapFallback({resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:t.requireFn,runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,fallbackScopes:a,currentRuntimeShared:t.currentRuntimeShared});if(l&&ut(l))return l}catch{}if(o&&typeof o.createRuntimeSharedFallbackSkeleton=="function")try{const l=o.createRuntimeSharedFallbackSkeleton({runtimeScope:t.runtimeScope,coreGlobalScope:t.coreGlobalScope,fallbackScopes:a,currentRuntimeShared:t.currentRuntimeShared});if(l&&ut(l))return l}catch{}return wy(t)}function uv(e){const t=VM(e),{fallbackScopes:r,bootstrapResolverTools:o}=t,n=QM({directBootstrapNamespace:e&&e.directBootstrapNamespace,bootstrapResolverTools:o,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:e&&e.requireFn,runtimeScope:e&&e.runtimeScope,coreGlobalScope:e&&e.coreGlobalScope,fallbackScopes:r}),a=XM({directBootstrapFallbackNamespace:e&&e.directBootstrapFallbackNamespace,bootstrapResolverTools:o,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:e&&e.requireFn,runtimeScope:e&&e.runtimeScope,coreGlobalScope:e&&e.coreGlobalScope,fallbackScopes:r});function i(){return ZM({bootstrapResolverTools:o,fallbackTools:a,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:e&&e.requireFn,runtimeScope:e&&e.runtimeScope,coreGlobalScope:e&&e.coreGlobalScope,fallbackScopes:r})}function s(l){const d=l&&l.fallbackScopes?l.fallbackScopes:r;return JM({bootstrapResolverTools:o,fallbackTools:a,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:e&&e.requireFn,runtimeScope:e&&e.runtimeScope,coreGlobalScope:e&&e.coreGlobalScope,fallbackScopes:d,currentRuntimeShared:l&&ut(l.currentRuntimeShared)?l.currentRuntimeShared:null})}function u(l){return La.collectFallbackScopes({runtimeScope:e&&e.runtimeScope,coreGlobalScope:e&&e.coreGlobalScope,fallbackScopes:l})}return{fallbackScopes:r,bootstrapResolverTools:o,bootstrapTools:n,bootstrapFallbackTools:a,createInlineLocalizationFallback:i,createInlineRuntimeSharedFallback:s,collectFallbackScopes:u}}function rD(e){const t=Xs(e),r=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||KA(t),o=t.bootstrapResultsTools||YA(t),n=uv(t),{bootstrapTools:a,bootstrapFallbackTools:i,bootstrapResolverTools:s}=n;function u(E){return Xs(t,E)}function l(E){return n.collectFallbackScopes(E)}function d(E){const I=u(E);return uv(I)}function p(E){const I=u(E);if(I.fallbackScopes=l(E),!I.bootstrapTools&&a&&(I.bootstrapTools=a),!I.bootstrapFallbackTools&&i&&(I.bootstrapFallbackTools=i),o&&typeof o.resolveLocalizationBootstrapResult=="function")try{const L=o.resolveLocalizationBootstrapResult(I);if(L&&ut(L))return L}catch{}return YM(I)}function g(E){const I=u(E);if(I.fallbackScopes=l(E),E&&E.createInlineLocalizationFallback?I.createInlineLocalizationFallback=E.createInlineLocalizationFallback:I.createInlineLocalizationFallback=n.createInlineLocalizationFallback,o&&typeof o.createLocalizationFallbackSkeleton=="function")try{const L=o.createLocalizationFallbackSkeleton(I);if(L&&ut(L))return L}catch{}return lv(I)}function h(E){const I=u(E);if(I.fallbackScopes=l(E),!I.bootstrapTools&&a&&(I.bootstrapTools=a),!I.bootstrapFallbackTools&&i&&(I.bootstrapFallbackTools=i),I.createInlineRuntimeSharedFallback||(I.createInlineRuntimeSharedFallback=(r&&typeof r.createInlineRuntimeSharedFallback=="function"?r.createInlineRuntimeSharedFallback:null)||(a&&typeof a.createInlineRuntimeSharedFallback=="function"?a.createInlineRuntimeSharedFallback:cv)),o&&typeof o.resolveRuntimeSharedBootstrapResult=="function")try{const L=o.resolveRuntimeSharedBootstrapResult(I);if(L&&ut(L))return L}catch{}return OT(I)}function A(E){const I=u(E);if(I.fallbackScopes=l(E),o&&typeof o.createRuntimeSharedFallbackSkeleton=="function")try{const L=o.createRuntimeSharedFallbackSkeleton(I);if(L&&ut(L))return L}catch{}if(i&&typeof i.createRuntimeSharedBootstrapFallback=="function")try{const L=i.createRuntimeSharedBootstrapFallback(I);if(L&&ut(L))return L}catch{}return wy(I)}function m(E){const I=u(E);return I.fallbackScopes=l(E),!I.fallbackTools&&i&&(I.fallbackTools=i),lv(I)}function y(E){const I=u(E);return I.fallbackScopes=l(E),!I.fallbackTools&&i&&(I.fallbackTools=i),cv(I)}const S={bootstrapTools:a,bootstrapFallbackTools:i,bootstrapEnvironmentTools:r,bootstrapResultsTools:o,collectBootstrapFallbackScopes:l,createBootstrapEnvironment:d,createLocalizationBootstrapResult:p,createLocalizationBootstrapFallback:g,createRuntimeSharedBootstrapResult:h,createRuntimeSharedBootstrapFallback:A,createInlineLocalizationFallback:m,createInlineRuntimeSharedFallback:y,resolveBootstrapTools:kT,resolveBootstrapFallbackTools:QA,resolveBootstrapEnvironmentTools:TT,resolveBootstrapResultsTools:GT};try{S.bootstrapEnvironment=d(t.bootstrapEnvironmentOptions||null)}catch{S.bootstrapEnvironment=null}return S}const dn={createLocalizationBootstrapResult:eD,createLocalizationBootstrapFallback:Cy,createRuntimeSharedBootstrapResult:tD,createRuntimeSharedBootstrapFallback:wy,normalizeBootstrapInvocationOptions:Xs,collectBootstrapFallbackScopes:WA,resolveBootstrapTools:kT,resolveBootstrapFallbackTools:QA,resolveBootstrapEnvironmentTools:TT,resolveBootstrapResultsTools:GT,createInlineLocalizationFallback:lv,createInlineRuntimeSharedFallback:cv,createBootstrapSuite:rD,resolveBootstrapResolverTools:IT,createBootstrapEnvironment:uv},xT={createLocalizationBootstrapFallback:dn.createLocalizationBootstrapFallback,createRuntimeSharedBootstrapFallback:dn.createRuntimeSharedBootstrapFallback},MT={resolveBootstrapTools:dn.resolveBootstrapTools,resolveBootstrapFallbackTools:dn.resolveBootstrapFallbackTools,resolveBootstrapEnvironmentTools:dn.resolveBootstrapEnvironmentTools,resolveBootstrapResultsTools:dn.resolveBootstrapResultsTools,resolveBootstrapResolverTools:dn.resolveBootstrapResolverTools,createInlineLocalizationFallback:dn.createInlineLocalizationFallback,createInlineRuntimeSharedFallback:dn.createInlineRuntimeSharedFallback,createBootstrapSuite:dn.createBootstrapSuite,normalizeBootstrapInvocationOptions:dn.normalizeBootstrapInvocationOptions,collectBootstrapFallbackScopes:dn.collectBootstrapFallbackScopes};(function(){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{};Es(t,"cineCoreAppCoreBootstrap",dn),Es(t,"cineCoreAppCoreBootstrapFallbacks",xT),Es(t,"cineCoreAppCoreBootstrapEnvironment",La),Es(t,"cineCoreAppCoreBootstrapResults",qA),Es(t,"cineCoreAppCoreBootstrapResolver",MT)})();const Ca=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};Ca.cineCoreAppLocalizationSupport=Ca.cineCoreAppLocalizationSupport||{};Ca.cineCoreAppLocalizationBootstrap=Ca.cineCoreAppLocalizationBootstrap||{};Ca.cineCoreAppRuntimeLocalization=Ca.cineCoreAppRuntimeLocalization||{};Ca.cineCoreAppLocalizationAccessors=Ca.cineCoreAppLocalizationAccessors||{};const oD=Ca.cineCoreAppLocalizationSupport,nD=Ca.cineCoreAppLocalizationBootstrap,aD=Ca.cineCoreAppRuntimeLocalization;(function(){function e(d){return!!d&&(typeof d=="object"||typeof d=="function")}function t(d){return e(d)?d:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(d){return typeof d=="function"?d:typeof require=="function"?require:null}function o(d,p,g){if(typeof d=="function")return d;const h=t(g);if(e(h)&&typeof h.resolveCoreSupportModule=="function")try{return h.resolveCoreSupportModule.bind(h)}catch{}if(e(h)&&h.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof h.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return h.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(h.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof p=="function"?function(m,y){if(typeof m!="string"||!m||typeof y!="string"||!y)return null;try{const S=p(y);return e(S)?S:null}catch{}return null}:function(){return null}}function n(d,p){return e(d)?d:t(p)}function a(d){const p=r(d&&d.requireFn),g=n(d&&d.runtimeScope),h=n(d&&d.coreGlobalScope,g),A=o(d&&d.resolveCoreSupportModule,p,g||h),m=A("cineCoreLocalizationRuntimeEnvironment","../core/localization-runtime-environment.js"),y=m&&typeof m.createLocalizationRuntimeEnvironment=="function"?m.createLocalizationRuntimeEnvironment({resolveCoreSupportModule:A,requireFn:p,runtimeScope:g,coreGlobalScope:h}):null,S=y&&e(y.coreLocalizationBridge)?y.coreLocalizationBridge:null,E=y&&e(y.coreLocalizationFallbacks)?y.coreLocalizationFallbacks:null,I=y&&e(y.coreInlineLocalizationFallbacks)?y.coreInlineLocalizationFallbacks:null,L=y&&typeof y.localizationFallbackSupport<"u"?y.localizationFallbackSupport:null,R=y&&typeof y.createBasicLocalizationFallbackResolvers=="function"?y.createBasicLocalizationFallbackResolvers:function(){return null},G=y&&e(y.localizationFallbackRegistry)?y.localizationFallbackRegistry:{createFallbackResolvers(oe){return R(oe)}},j=y&&e(y.localizationFallbackResolvers)?y.localizationFallbackResolvers:G&&typeof G.createFallbackResolvers=="function"?G.createFallbackResolvers({directNamespace:E,inlineNamespace:I}):R({directNamespace:E,inlineNamespace:I}),$=y&&typeof y.localizationFallbackNamespace<"u"?y.localizationFallbackNamespace:null,z=y&&typeof y.fallbackResolveLocaleModule=="function"?y.fallbackResolveLocaleModule:function(){return null},te=y&&typeof y.createLocaleFallbacks=="function"?y.createLocaleFallbacks:function(){return null};return{localizationRuntimeEnvironment:y,localizationBridge:S,localizationFallbacks:E,inlineLocalizationFallbacks:I,localizationFallbackSupport:L,createBasicLocalizationFallbackResolvers:R,localizationFallbackRegistry:G,localizationFallbackResolvers:j,localizationFallbackNamespace:$,fallbackResolveLocaleModule:z,createLocaleFallbacks:te}}const i={createAppLocalizationSupport:a},s=t(),u="cineCoreAppLocalizationSupport",l=e(s)&&e(s[u])?s[u]:{};for(const d of Object.keys(i))l[d]=i[d];if(e(s))try{s[u]=l}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=l)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return e(m)?m:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(m){return typeof m=="function"?m:typeof require=="function"?require:null}function o(m,y){return e(m)?m:t(y)}function n(m,y,S){if(typeof m=="function")return m;const E=o(S);if(E&&typeof E.resolveCoreSupportModule=="function")try{return E.resolveCoreSupportModule.bind(E)}catch{}if(E&&E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof y=="function"?function(L,R){if(typeof L!="string"||!L||typeof R!="string"||!R)return null;try{const G=y(R);return e(G)?G:null}catch{}return null}:function(){return null}}function a(m,y){e(y)&&m.indexOf(y)===-1&&m.push(y)}function i(m,y,S){const E=Array.isArray(m)?m.slice():[];return a(E,y),a(E,S),a(E,typeof globalThis<"u"?globalThis:null),a(E,typeof window<"u"?window:null),a(E,typeof self<"u"?self:null),a(E,typeof global<"u"?global:null),E}function s(m){if(m&&e(m.localizationSupportTools))return m.localizationSupportTools;const y=m&&typeof m.resolveCoreSupportModule=="function"?m.resolveCoreSupportModule:null;if(y)try{const I=y("cineCoreAppLocalizationSupport","./modules/app-core/localization-fixed.js");if(e(I))return I}catch{}const S=r(m&&m.requireFn);if(typeof S=="function")try{const I=S("./modules/app-core/localization-fixed.js");if(e(I))return I}catch{}const E=i(m&&m.fallbackScopes,m&&m.runtimeScope,m&&m.coreGlobalScope);for(let I=0;I<E.length;I+=1){const L=E[I];try{const R=L&&L.cineCoreAppLocalizationSupport;if(e(R))return R}catch{}}return null}function u(m){const y=s(m);if(y&&typeof y.createAppLocalizationSupport=="function")try{return y.createAppLocalizationSupport({resolveCoreSupportModule:m&&m.resolveCoreSupportModule,requireFn:m&&m.requireFn,runtimeScope:m&&m.runtimeScope,coreGlobalScope:m&&m.coreGlobalScope})}catch{}return null}function l(m){const y=r(m&&m.requireFn),S=o(m&&m.runtimeScope),E=o(m&&m.coreGlobalScope,S),I=n(m&&m.resolveCoreSupportModule,y,S||E),L=i(m&&m.fallbackScopes,S,E),R=u({localizationSupportTools:m&&m.localizationSupportTools,resolveCoreSupportModule:I,requireFn:y,runtimeScope:S,coreGlobalScope:E,fallbackScopes:L}),G=R&&R.localizationRuntimeEnvironment?R.localizationRuntimeEnvironment:null,j=R&&R.localizationBridge?R.localizationBridge:null,$=R&&R.localizationFallbacks?R.localizationFallbacks:null,z=R&&R.inlineLocalizationFallbacks?R.inlineLocalizationFallbacks:null,te=R&&typeof R.localizationFallbackSupport<"u"?R.localizationFallbackSupport:null,oe=R&&typeof R.createBasicLocalizationFallbackResolvers=="function"?R.createBasicLocalizationFallbackResolvers:function(){return null},k=R&&R.localizationFallbackRegistry?R.localizationFallbackRegistry:{createFallbackResolvers(N){return oe(N)}},Z=R&&R.localizationFallbackResolvers?R.localizationFallbackResolvers:k&&typeof k.createFallbackResolvers=="function"?k.createFallbackResolvers({directNamespace:$,inlineNamespace:z}):oe({directNamespace:$,inlineNamespace:z}),ue=R&&typeof R.localizationFallbackNamespace<"u"?R.localizationFallbackNamespace:null,H=R&&typeof R.fallbackResolveLocaleModule=="function"?R.fallbackResolveLocaleModule:function(){return null},Y=R&&typeof R.createLocaleFallbacks=="function"?R.createLocaleFallbacks:function(){return null};return{localizationSupport:R,localizationRuntimeEnvironment:G,localizationBridge:j,localizationFallbacks:$,inlineLocalizationFallbacks:z,localizationFallbackSupport:te,createBasicLocalizationFallbackResolvers:oe,localizationFallbackRegistry:k,localizationFallbackResolvers:Z,localizationFallbackNamespace:ue,fallbackResolveLocaleModule:H,createLocaleFallbacks:Y}}function d(m){const y=m&&e(m.localizationBootstrapResult)?m.localizationBootstrapResult:null,S=y&&e(y.localizationSupport)?y.localizationSupport:null,E=y&&e(y.localizationRuntimeEnvironment)?y.localizationRuntimeEnvironment:null,I=y&&e(y.localizationBridge)?y.localizationBridge:null,L=y&&e(y.localizationFallbacks)?y.localizationFallbacks:null,R=y&&e(y.inlineLocalizationFallbacks)?y.inlineLocalizationFallbacks:null,G=y&&typeof y.localizationFallbackSupport<"u"?y.localizationFallbackSupport:null,j=y&&typeof y.createBasicLocalizationFallbackResolvers=="function"?y.createBasicLocalizationFallbackResolvers:function(){return null},$=y&&e(y.localizationFallbackRegistry)?y.localizationFallbackRegistry:{createFallbackResolvers(Z){return j(Z)}},z=y&&e(y.localizationFallbackResolvers)?y.localizationFallbackResolvers:$&&typeof $.createFallbackResolvers=="function"?$.createFallbackResolvers({directNamespace:L,inlineNamespace:R}):j({directNamespace:L,inlineNamespace:R}),te=y&&typeof y.localizationFallbackNamespace<"u"?y.localizationFallbackNamespace:null,oe=y&&typeof y.fallbackResolveLocaleModule=="function"?y.fallbackResolveLocaleModule:function(){return null},k=y&&typeof y.createLocaleFallbacks=="function"?y.createLocaleFallbacks:function(){return null};return{localizationBootstrapResult:y,localizationSupport:S,localizationRuntimeEnvironment:E,localizationBridge:I,localizationFallbacks:L,inlineLocalizationFallbacks:R,localizationFallbackSupport:G,createBasicLocalizationFallbackResolvers:j,localizationFallbackRegistry:$,localizationFallbackResolvers:z,localizationFallbackNamespace:te,fallbackResolveLocaleModule:oe,createLocaleFallbacks:k}}const p={createLocalizationBootstrapResult:l,createLocalizationBootstrapWiring:d},g=t(),h="cineCoreAppLocalizationBootstrap",A=e(g)&&e(g[h])?g[h]:{};if(Object.assign(A,p),e(g))try{g[h]=A}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=A)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return typeof m=="function"?m:typeof require=="function"?require:null}function r(m,y,S){const E=[],I=typeof Set=="function"?new Set:null;function L(R){if(e(R)){if(I){if(I.has(R))return;I.add(R),E.push(R);return}E.indexOf(R)===-1&&E.push(R)}}if(L(m),L(y),Array.isArray(S))for(let R=0;R<S.length;R+=1)L(S[R]);return L(typeof globalThis<"u"?globalThis:null),L(typeof window<"u"?window:null),L(typeof self<"u"?self:null),L(typeof global<"u"?global:null),E}function o(m){const y=typeof m=="string"&&m?m:"en";return function(E){if(!E)return y;try{return String(E).trim().toLowerCase()||y}catch{}return y}}function n(m,y){const S=Array.isArray(m)&&m.length?m:["ar","fa","he","ur"];return function(I){const R=y(I).split("-")[0];return S.indexOf(R)!==-1}}function a(m,y){return function(E){if(typeof document<"u"&&document&&document.documentElement)try{const I=document.documentElement.getAttribute("dir");if(I)return I}catch{}return y(E)?"rtl":"ltr"}}function i(m,y,S){if(m){if(y)try{m.lang=y}catch{}if(S)try{m.dir=S}catch{}}}function s(m,y,S){return function(){for(let I=0;I<m.length;I+=1){const L=m[I];if(!e(L))continue;const R=L.texts;if(e(R))return R}if(typeof y=="function")try{const I=y(S);if(e(I)&&e(I.texts))return I.texts}catch{}return{}}}function u(m,y){const S=typeof y=="string"&&y?y:"en";return function(I){const L=m();let R=null;if(typeof I=="string"&&I)try{R=String(I).trim().toLowerCase()}catch{R=null}let G=R&&Object.prototype.hasOwnProperty.call(L,R)?R:"";if(!G&&R){const z=R.split("-")[0];z&&Object.prototype.hasOwnProperty.call(L,z)&&(G=z)}G||(G=S);const j=L&&G&&e(L[G])?L[G]:null;if(j)return j;if(G!==S){const z=L&&e(L[S])?L[S]:null;if(z)return z}if(L&&e(L.en))return L.en;const $=L?Object.keys(L):[];if($.length){const z=$[0],te=L[z];if(e(te))return te}return{}}}function l(m,y){return function(E){if(m&&typeof m.ensureGlobalGetLanguageTextsAvailability=="function")try{m.ensureGlobalGetLanguageTextsAvailability();return}catch{}const I=typeof E=="function"?E:function(){return{}};for(let L=0;L<y.length;L+=1){const R=y[L];if(e(R)&&typeof R.getLanguageTexts!="function")try{R.getLanguageTexts=I}catch{}}}}function d(m){const y=e(m&&m.coreLocalizationRuntime)?m.coreLocalizationRuntime:null,S=e(m&&m.coreLocalizationBridge)?m.coreLocalizationBridge:null,E=m&&m.corePartRuntimeScope,I=m&&m.coreGlobalScope,L=m&&m.additionalLocalizationScopes,R=m&&typeof m.fallbackResolveLocaleModule=="function"?m.fallbackResolveLocaleModule:null,G=t(m&&m.requireFn),j=m&&typeof m.translationsRequirePath=="string"&&m.translationsRequirePath?m.translationsRequirePath:"./translations.js",$=r(E,I,L),z=y&&y.localeModule||(R?R(E):null),te=y&&y.defaultLanguage||(z&&typeof z.DEFAULT_LANGUAGE=="string"?z.DEFAULT_LANGUAGE:"en"),oe=y&&y.rtlLanguageCodes||(z&&Array.isArray(z.RTL_LANGUAGE_CODES)&&z.RTL_LANGUAGE_CODES.length>0?z.RTL_LANGUAGE_CODES:["ar","fa","he","ur"]),k=o(te),Z=y&&typeof y.normalizeLanguageCode=="function"?function(J){try{return y.normalizeLanguageCode(J)}catch{}return k(J)}:S&&typeof S.normalizeLanguageCode=="function"?function(J){try{return S.normalizeLanguageCode(J,E)}catch{}return k(J)}:k,ue=n(oe,Z),H=y&&typeof y.isRtlLanguage=="function"?function(J){try{return y.isRtlLanguage(J)}catch{}return ue(J)}:S&&typeof S.isRtlLanguage=="function"?function(J){try{return S.isRtlLanguage(J,E)}catch{}return ue(J)}:ue,Y=a(Z,H),N=y&&typeof y.resolveDocumentDirection=="function"?function(J){try{return y.resolveDocumentDirection(J)}catch{}return Y(J)}:S&&typeof S.resolveDocumentDirection=="function"?function(J){try{return S.resolveDocumentDirection(J,E)}catch{}return Y(J)}:Y,ae=y&&typeof y.applyLocaleMetadata=="function"?function(J,Ae,Le){try{return y.applyLocaleMetadata(J,Ae,Le)}catch{}return i(J,Ae,Le)}:S&&typeof S.applyLocaleMetadata=="function"?function(J,Ae,Le){try{return S.applyLocaleMetadata(J,Ae,Le,E)}catch{}return i(J,Ae,Le)}:i,de=s($,G,j),Q=u(de,te),ne=y&&typeof y.getLanguageTexts=="function"?function(J){try{return y.getLanguageTexts(J)}catch{}return Q(J)}:Q,V=l(y,$);return{localeModule:e(z)?z:null,defaultLanguage:typeof te=="string"&&te?te:"en",rtlLanguageCodes:Array.isArray(oe)&&oe.length?oe:["ar","fa","he","ur"],normalizeLanguageCode:Z,isRtlLanguage:H,resolveDocumentDirection:N,applyLocaleMetadata:ae,getLanguageTexts:ne,ensureGlobalGetLanguageTextsAvailability:V,fallbackResolveTranslationDataset:de}}const p={createLocalizationAccessors:d},g=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,h="cineCoreAppLocalizationAccessors",A=e(g)&&e(g[h])?g[h]:{};if(Object.assign(A,p),e(g))try{g[h]=A}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=A)})();(function(){function e(A){return!!A&&(typeof A=="object"||typeof A=="function")}function t(A){return e(A)?A:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(A,m){return e(A)?A:t(m)}function o(A){return typeof A=="function"?A:typeof require=="function"?require:null}function n(A,m,y){if(typeof A=="function")return A;const S=t(y);if(S&&typeof S.resolveCoreSupportModule=="function")try{return S.resolveCoreSupportModule.bind(S)}catch{}if(S&&S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof m=="function"?function(I,L){if(typeof I!="string"||!I||typeof L!="string"||!L)return null;try{const R=m(L);return e(R)?R:null}catch{}return null}:function(){return null}}function a(A,m){const y=[];e(A)&&y.indexOf(A)===-1&&y.push(A),e(m)&&y.indexOf(m)===-1&&y.push(m);const S=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let E=0;E<S.length;E+=1){const I=S[E];e(I)&&y.indexOf(I)===-1&&y.push(I)}return y}function i(A){const m=A&&A.resolveCoreSupportModule,y=A&&A.requireFn,S=A&&A.runtimeScope,E=A&&A.coreGlobalScope;let I=null;if(typeof m=="function")try{I=m("cineCoreAppLocalizationSupport","../app-core/localization-fixed.js")}catch{I=null}if(!e(I)&&typeof y=="function")try{const R=y("../app-core/localization-fixed.js");e(R)&&(I=R)}catch{}if(e(I))return I;const L=a(S,E);for(let R=0;R<L.length;R+=1){const G=L[R];try{const j=G&&G.cineCoreAppLocalizationSupport;if(e(j))return j}catch{}}return null}function s(){function A(){return null}const m={createFallbackResolvers(E){return A()}};function y(){return null}function S(){return null}return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers:A,localizationFallbackRegistry:m,localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule:y,createLocaleFallbacks:S}}function u(A,m){if(e(A)&&typeof A.createAppLocalizationSupport=="function")try{return A.createAppLocalizationSupport(m)}catch{}return null}function l(A){const m=o(A&&A.requireFn),y=r(A&&A.runtimeScope),S=r(A&&A.coreGlobalScope,y),E=n(A&&A.resolveCoreSupportModule,m,y||S),I=i({resolveCoreSupportModule:E,requireFn:m,runtimeScope:y,coreGlobalScope:S}),L=u(I,{resolveCoreSupportModule:E,requireFn:m,runtimeScope:y,coreGlobalScope:S});return e(L)?L:s()}const d={createLocalizationRuntimeBridge:l},p="cineCoreAppLocalizationRuntimeBridge",g=t(),h=e(g)&&e(g[p])?g[p]:{};for(const A of Object.keys(d))h[A]=d[A];if(e(g))try{g[p]=h}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=h)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return e(m)?m:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(m,y){return e(m)?m:t(y)}function o(m){return typeof m=="function"?m:typeof require=="function"?require:null}function n(m,y,S){if(typeof m=="function")return m;const E=t(S);if(E&&typeof E.resolveCoreSupportModule=="function")try{return E.resolveCoreSupportModule.bind(E)}catch{}if(E&&E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof y=="function"?function(L,R){if(typeof L!="string"||!L||typeof R!="string"||!R)return null;try{const G=y(R);return e(G)?G:null}catch{}return null}:function(){return null}}function a(m,y){const S=[];e(m)&&S.indexOf(m)===-1&&S.push(m),e(y)&&S.indexOf(y)===-1&&S.push(y);const E=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let I=0;I<E.length;I+=1){const L=E[I];e(L)&&S.indexOf(L)===-1&&S.push(L)}return S}function i(m){const y=m&&m.resolveCoreSupportModule,S=m&&m.requireFn,E=m&&m.runtimeScope,I=m&&m.coreGlobalScope;let L=null;if(typeof y=="function")try{L=y("cineCoreAppLocalizationRuntimeBridge","./modules/app-core/localization-fixed.js")}catch{L=null}if(!e(L)&&typeof S=="function")try{const G=S("./modules/app-core/localization-fixed.js");e(G)&&(L=G)}catch{}if(e(L))return L;const R=a(E,I);for(let G=0;G<R.length;G+=1){const j=R[G];try{const $=j&&j.cineCoreAppLocalizationRuntimeBridge;if(e($))return $}catch{}}return null}function s(){function m(){return null}const y={createFallbackResolvers(I){return m()}};function S(){return null}function E(){return null}return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers:m,localizationFallbackRegistry:y,localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule:S,createLocaleFallbacks:E}}function u(m){const y=m&&m.requireFn,S=m&&m.runtimeScope,E=m&&m.coreGlobalScope,I=i(m);if(e(I)&&typeof I.createLocalizationRuntimeBridge=="function")return I.createLocalizationRuntimeBridge;if(typeof y=="function")try{const R=y("./modules/app-core/localization-fixed.js");if(e(R)&&typeof R.createLocalizationRuntimeBridge=="function")return R.createLocalizationRuntimeBridge}catch{}const L=a(S,E);for(let R=0;R<L.length;R+=1){const G=L[R];try{const j=G&&G.cineCoreAppLocalizationRuntimeBridge;if(e(j)&&typeof j.createLocalizationRuntimeBridge=="function")return j.createLocalizationRuntimeBridge}catch{}}return function(){return s()}}function l(m){const y=e(m)?m:s(),S=e(y.localizationRuntimeEnvironment)?y.localizationRuntimeEnvironment:null,E=e(y.localizationBridge)?y.localizationBridge:null,I=e(y.localizationFallbacks)?y.localizationFallbacks:null,L=e(y.inlineLocalizationFallbacks)?y.inlineLocalizationFallbacks:null,R=typeof y.localizationFallbackSupport<"u"?y.localizationFallbackSupport:null,G=typeof y.createBasicLocalizationFallbackResolvers=="function"?y.createBasicLocalizationFallbackResolvers:function(){return null},j=e(y.localizationFallbackRegistry)?y.localizationFallbackRegistry:{createFallbackResolvers(k){return G(k)}},$=typeof y.fallbackResolveLocaleModule=="function"?y.fallbackResolveLocaleModule:function(){return null},z=typeof y.createLocaleFallbacks=="function"?y.createLocaleFallbacks:function(){return null},te=typeof y.localizationFallbackNamespace<"u"?y.localizationFallbackNamespace:null,oe=y.localizationFallbackResolvers?y.localizationFallbackResolvers:j&&typeof j.createFallbackResolvers=="function"?j.createFallbackResolvers({directNamespace:I,inlineNamespace:L}):G({directNamespace:I,inlineNamespace:L});return{localizationRuntimeEnvironment:S,localizationBridge:E,localizationFallbacks:I,inlineLocalizationFallbacks:L,localizationFallbackSupport:R,createBasicLocalizationFallbackResolvers:G,localizationFallbackRegistry:j,localizationFallbackResolvers:oe,localizationFallbackNamespace:te,fallbackResolveLocaleModule:$,createLocaleFallbacks:z}}function d(m){const y=o(m&&m.requireFn),S=r(m&&m.runtimeScope),E=r(m&&m.coreGlobalScope,S),I=n(m&&m.resolveCoreSupportModule,y,S||E),R=u({resolveCoreSupportModule:I,requireFn:y,runtimeScope:S,coreGlobalScope:E})({resolveCoreSupportModule:I,requireFn:y,runtimeScope:S,coreGlobalScope:E});return l(R)}const p={createLocalizationRuntimeSetup:d},g="cineCoreAppLocalizationRuntimeSetup",h=t(),A=e(h)&&e(h[g])?h[g]:{};for(const m of Object.keys(p))A[m]=p[m];if(e(h))try{h[g]=A}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=A)})();(function(){function e(y){return!!y&&(typeof y=="object"||typeof y=="function")}function t(y){return e(y)?y:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(y,S){return e(y)?y:t(S)}function o(y){return typeof y=="function"?y:typeof require=="function"?require:null}function n(y,S,E){if(typeof y=="function")return y;const I=r(E);if(I&&typeof I.resolveCoreSupportModule=="function")try{return I.resolveCoreSupportModule.bind(I)}catch{}if(I&&I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof S=="function"?function(R,G){if(typeof R!="string"||!R||typeof G!="string"||!G)return null;try{const j=S(G);return e(j)?j:null}catch{}return null}:null}function a(y,S){e(S)&&y.indexOf(S)===-1&&y.push(S)}function i(y,S){const E=[];return a(E,y),a(E,S),a(E,typeof globalThis<"u"?globalThis:null),a(E,typeof window<"u"?window:null),a(E,typeof self<"u"?self:null),a(E,typeof global<"u"?global:null),E}function s(){return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function u(y){let S=!1,E=null;return function(){if(S||(S=!0,typeof y!="function"))return E;try{const L=y("./modules/app-core/localization-fixed.js");e(L)&&(E=L)}catch{}return E}}function l(y,S,E){let I=null;if(typeof y=="function")try{I=y("cineCoreAppRuntimeLocalization","./modules/app-core/localization-fixed.js")}catch{I=null}if(e(I)||(I=E()),e(I))return I;for(let L=0;L<S.length;L+=1){const R=S[L];try{const G=R&&R.cineCoreAppRuntimeLocalization;if(e(G))return G}catch{}}return null}function d(y,S,E,I){if(e(S)&&typeof S[y]=="function")return S[y];const L=I();if(e(L)&&typeof L[y]=="function")return L[y];for(let R=0;R<E.length;R+=1){const G=E[R];try{const j=G&&G.cineCoreAppRuntimeLocalization;if(e(j)&&typeof j[y]=="function")return j[y]}catch{}}return null}function p(y){const S=o(y&&y.requireFn),E=r(y&&y.runtimeScope),I=r(y&&y.coreGlobalScope,E),L=n(y&&y.resolveCoreSupportModule,S,E||I),R=i(E,I),G=u(S),j=l(L,R,G),$=d("resolveRuntimeLocalization",j,R,G),z=d("createFallbackLocalizationRuntimeSetup",j,R,G)||s;return(typeof $=="function"?$({resolveCoreSupportModule:L,requireFn:S,runtimeScope:E,coreGlobalScope:I}):null)||(typeof z=="function"?z():s())||s()}const g={resolveLocalizationRuntimeSetup:p,createInlineFallbackLocalizationRuntimeSetup:s},h=t(),A="cineCoreAppRuntimeLocalizationResolver",m=e(h)&&e(h[A])?h[A]:{};if(Object.assign(m,g),e(h))try{h[A]=m}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=m)})();(function(){function e(y){return!!y&&(typeof y=="object"||typeof y=="function")}function t(y){return e(y)?y:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(y,S){return e(y)?y:t(S)}function o(y){return typeof y=="function"?y:typeof require=="function"?require:null}function n(y,S,E){if(typeof y=="function")return y;const I=t(E);if(I&&typeof I.resolveCoreSupportModule=="function")try{return I.resolveCoreSupportModule.bind(I)}catch{}if(I&&I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(I.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof S=="function"?function(R,G){if(typeof R!="string"||!R||typeof G!="string"||!G)return null;try{const j=S(G);return e(j)?j:null}catch{}return null}:function(){return null}}function a(y,S){e(S)&&y.indexOf(S)===-1&&y.push(S)}function i(y,S){const E=[];return a(E,y),a(E,S),a(E,typeof globalThis<"u"?globalThis:null),a(E,typeof window<"u"?window:null),a(E,typeof self<"u"?self:null),a(E,typeof global<"u"?global:null),E}function s(){return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function u(y){const S=y&&y.resolveCoreSupportModule,E=y&&y.requireFn,I=y&&y.runtimeScope,L=y&&y.coreGlobalScope;let R=null;if(typeof S=="function")try{R=S("cineCoreAppLocalizationRuntimeSetup","./modules/app-core/localization-fixed.js")}catch{R=null}if(!e(R)&&typeof E=="function")try{const G=E("./modules/app-core/localization-fixed.js");e(G)&&(R=G)}catch{}if(!e(R)){const G=i(I,L);for(let j=0;j<G.length;j+=1){const $=G[j];if(e($))try{const z=$.cineCoreAppLocalizationRuntimeSetup;if(e(z)){R=z;break}}catch{}}}return e(R)&&typeof R.createLocalizationRuntimeSetup=="function"?R.createLocalizationRuntimeSetup:null}function l(y,S){return typeof y=="function"?y:S}function d(y){const S=s(),E=e(y)?y:{},I=e(E.localizationRuntimeEnvironment)?E.localizationRuntimeEnvironment:S.localizationRuntimeEnvironment,L=e(E.localizationBridge)?E.localizationBridge:S.localizationBridge,R=e(E.localizationFallbacks)?E.localizationFallbacks:S.localizationFallbacks,G=e(E.inlineLocalizationFallbacks)?E.inlineLocalizationFallbacks:S.inlineLocalizationFallbacks,j=Object.prototype.hasOwnProperty.call(E,"localizationFallbackSupport")?E.localizationFallbackSupport:S.localizationFallbackSupport,$=l(E.createBasicLocalizationFallbackResolvers,S.createBasicLocalizationFallbackResolvers),z=e(E.localizationFallbackRegistry)?E.localizationFallbackRegistry:{createFallbackResolvers(ue){return $(ue)}};let te=E.localizationFallbackResolvers;if(!te&&z){const ue=l(z.createFallbackResolvers,null);if(ue)try{te=ue({directNamespace:R,inlineNamespace:G})}catch{te=null}}if(!te&&typeof $=="function")try{te=$({directNamespace:R,inlineNamespace:G})}catch{te=null}te||(te=S.localizationFallbackResolvers);const oe=Object.prototype.hasOwnProperty.call(E,"localizationFallbackNamespace")?E.localizationFallbackNamespace:S.localizationFallbackNamespace,k=l(E.fallbackResolveLocaleModule,S.fallbackResolveLocaleModule),Z=l(E.createLocaleFallbacks,S.createLocaleFallbacks);return{localizationRuntimeEnvironment:I,localizationBridge:L,localizationFallbacks:R,inlineLocalizationFallbacks:G,localizationFallbackSupport:j,createBasicLocalizationFallbackResolvers:$,localizationFallbackRegistry:z,localizationFallbackResolvers:te,localizationFallbackNamespace:oe,fallbackResolveLocaleModule:k,createLocaleFallbacks:Z}}function p(y){const S=y&&y.currentLocalization;if(e(S))return d(S);const E=o(y&&y.requireFn),I=r(y&&y.runtimeScope),L=r(y&&y.coreGlobalScope,I),R=n(y&&y.resolveCoreSupportModule,E,I||L),G=u({resolveCoreSupportModule:R,requireFn:E,runtimeScope:I,coreGlobalScope:L});if(typeof G=="function")try{const j=G({resolveCoreSupportModule:R,requireFn:E,runtimeScope:I,coreGlobalScope:L});return d(j)}catch{}return s()}const g={resolveRuntimeLocalization:p,createFallbackLocalizationRuntimeSetup:s},h="cineCoreAppRuntimeLocalization",A=t(),m=e(A)&&e(A[h])?A[h]:{};for(const y of Object.keys(g))m[y]=g[y];if(e(A))try{A[h]=m}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=m)})();const jl=dn,iD=aD,sD=oD,am=nD,DT=MT,_T=xT,FT=La,NT=qA;function HT(){return typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE?CORE_PART1_RUNTIME_SCOPE:null}function jT(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null}const tn=jl&&typeof jl.createBootstrapSuite=="function"?jl.createBootstrapSuite({directResolverNamespace:DT,directBootstrapNamespace:jl,directBootstrapFallbackNamespace:_T,directBootstrapEnvironmentNamespace:FT,directBootstrapResultsNamespace:NT,resolveCoreSupportModule:Ea,requireFn:typeof require=="function"?require:null,runtimeScope:HT(),coreGlobalScope:jT()}):null;tn&&tn.bootstrapEnvironmentTools;const lD=tn&&tn.bootstrapResultsTools||NT||null,Qm=tn&&tn.bootstrapEnvironment||null;tn&&tn.bootstrapEnvironment&&tn.bootstrapEnvironment.bootstrapResolverTools||Qm&&Qm.bootstrapResolverTools;const zT=tn&&tn.bootstrapFallbackTools||Qm&&Qm.bootstrapFallbackTools||_T||null,cD=(function(){if(tn&&typeof tn.createLocalizationBootstrapResult=="function"){const t={bootstrapTools:jl,bootstrapFallbackTools:zT,localizationSupportTools:sD,localizationBootstrapTools:am,localizationRuntimeTools:iD,resolveCoreSupportModule:Ea,requireFn:typeof require=="function"?require:null,runtimeScope:HT(),coreGlobalScope:jT(),fallbackScopes:[]};return tn.createLocalizationBootstrapResult(t)}return null})(),Of=am&&typeof am.createLocalizationBootstrapWiring=="function"&&am.createLocalizationBootstrapWiring({localizationBootstrapResult:cD})||null;typeof globalThis<"u"?globalThis.localizationBootstrapWiring=Of:typeof window<"u"?window.localizationBootstrapWiring=Of:typeof self<"u"?self.localizationBootstrapWiring=Of:typeof global<"u"&&(global.localizationBootstrapWiring=Of);const Xm=Eo(),Xa=Qo,uD=typeof Xa.getModuleRegistry=="function"?Xa.getModuleRegistry(Xm):null,UT=typeof Xa.freezeDeep=="function"?function(t){try{return Xa.freezeDeep(t)}catch{}return t}:function(t){return t},dD=typeof Xa.exposeGlobal=="function"?function(t,r,o){return Xa.exposeGlobal(t,r,Xm,o||{})}:function(t,r){try{return Xm[t]=r,!0}catch{}return!1},fD=typeof Xa.registerOrQueueModule=="function"?function(t,r,o,n){return Xa.registerOrQueueModule(t,r,o,n,Xm,uD)}:function(){return!1},pD=typeof Xa.safeWarn=="function"?function(t,r){try{Xa.safeWarn(t,r)}catch{}}:function(t,r){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof r>"u"?console.warn(t):console.warn(t,r)}catch{}},dv="en",$T=["ar","fa","he","ur"];function qT(e){if(!e)return dv;try{return String(e).trim().toLowerCase()}catch{}return dv}function VT(e){const r=qT(e).split("-")[0];return $T.indexOf(r)!==-1}function mD(e,t){const r=t||(typeof document<"u"?document:null);if(r&&r.documentElement)try{const o=r.documentElement.getAttribute("dir");if(o==="rtl"||o==="ltr")return o}catch{}return VT(e)?"rtl":"ltr"}function gD(e,t,r){if(e){if(t)try{e.lang=t}catch{}if(r)try{e.dir=r}catch{}}}const XA={DEFAULT_LANGUAGE:dv,RTL_LANGUAGE_CODES:UT([].concat($T)),normalizeLanguageCode:qT,isRtlLanguage:VT,resolveDocumentDirection:mD,applyLocaleMetadata:gD};UT(XA);fD("cineLocale",XA,{category:"localisation",description:"Language helpers shared between the runtime core and UI modules.",replace:!0},function(e){pD("Unable to register cineLocale module.",e)});dD("cineLocale",XA,{configurable:!0,enumerable:!1,writable:!1});function WT(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const KT=WT();function yD(e){const t=e||KT;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}const rn=yD(KT),bD=rn&&typeof rn.detectGlobalScope=="function"?rn.detectGlobalScope:WT,yi=bD();function hD(e){const t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}const YT=rn&&typeof rn.collectCandidateScopes=="function"?function(e){return rn.collectCandidateScopes(e||yi)}:function(e){return hD(e||yi)},SD=rn&&typeof rn.tryRequire=="function"?rn.tryRequire:function(e){return null};let qC,VC=!1;function vD(){if(Qo&&typeof Qo=="object")return Qo;const e=YT(yi);if(rn&&typeof rn.resolveFromScopes=="function"){const t=rn.resolveFromScopes("cineModuleBase",{scopes:e});if(t&&typeof t=="object")return t}for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r.cineModuleBase=="object")return r.cineModuleBase}return null}function Ra(){return VC||(qC=vD(),VC=!0),qC}let Gf,WC=!1;function Xo(){if(!WC){const e=Ra();if(e&&typeof e.getGlobalScope=="function")try{Gf=e.getGlobalScope()||yi}catch{Gf=yi}else Gf=yi;WC=!0}return Gf}function ZA(e){const t=Ra();if(t&&typeof t.collectCandidateScopes=="function")try{const r=t.collectCandidateScopes(e||Xo());if(Array.isArray(r))return r}catch{}return YT(e||Xo())}function QT(){const e=Ra();return e&&typeof e.tryRequire=="function"?e.tryRequire:SD}function fv(e){const t=Ra(),r=e||Xo();if(t&&typeof t.resolveModuleRegistry=="function")try{return t.resolveModuleRegistry(r)}catch{}if(en&&typeof en=="object")return en;const o=ZA(r);if(rn&&typeof rn.resolveFromScopes=="function"){const n=rn.resolveFromScopes("cineModules",{scopes:o});if(n&&typeof n=="object")return n}for(let n=0;n<o.length;n+=1){const a=o[n];if(a&&typeof a.cineModules=="object")return a.cineModules}return null}let KC,YC=!1;function Ly(e){return e&&e!==Xo()?fv(e):(YC||(KC=fv(Xo()),YC=!0),KC)}function JA(){const e=Ra();return e&&typeof e.PENDING_QUEUE_KEY=="string"?e.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"}function AD(e){if(!e||typeof e!="object")return null;const t=JA();let r=e[t];if(Array.isArray(r))return r;try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t]}catch{try{Array.isArray(e[t])||(e[t]=[]),r=e[t]}catch{return null}}return r}function eE(e,t,r,o){const n=Ra(),a=e||Xo();if(n&&typeof n.queueModuleRegistration=="function")try{return n.queueModuleRegistration(t,r,o,a)}catch{}const i=AD(a);if(!i)return!1;const s=Object.freeze({name:t,api:r,options:Object.freeze({...o||{}})});try{i.push(s)}catch{i[i.length]=s}return!0}function tE(e,t,r,o,n,a){const i=Ra(),s=e||Xo(),u=t||Ly(s);if(i&&typeof i.registerOrQueueModule=="function")try{return i.registerOrQueueModule(r,o,n,a,s,u)}catch{}if(u&&typeof u.register=="function")try{return u.register(r,o,n),!0}catch(l){typeof a=="function"&&a(l)}return eE(s,r,o,n),!1}function pv(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(ED(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{let t=null;try{typeof console<"u"&&console&&(t=console)}catch(r){}if(t){if(e===t)return!0;try{if(e.__cameraPowerPlannerOriginal&&e.__cameraPowerPlannerOriginal===t)return!0}catch(r){}}try{if(typeof e.log=="function"&&typeof e.warn=="function"&&typeof e.error=="function"){const r=e.constructor&&e.constructor.name;if(r&&/Console/i.test(r))return!0;if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const o=e[Symbol.toStringTag];if(typeof o=="string"&&/Console/i.test(o))return!0}}}catch(r){}}catch{return!1}return!1}function mv(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;try{if(typeof e.require=="function"&&typeof e.loaded=="boolean"&&((Array.isArray?Array.isArray(e.children):Object.prototype.toString.call(e.children)==="[object Array]")||typeof e.paths<"u"))return!0}catch{}return!1}function gv(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(yi&&typeof yi=="object")try{if(e===yi.ethereum)return!0}catch{return!0}try{if(e.isMetaMask===!0)return!0}catch(t){if(t&&typeof t.message=="string"&&/metamask/i.test(t.message))return!0}try{if(typeof e.request=="function"&&typeof e.on=="function"){if(typeof e.removeListener=="function"||typeof e.removeEventListener=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Ethereum|MetaMask|Provider/i.test(t))return!0}}catch{return!0}return!1}function ED(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function yv(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const t=e[Symbol.toStringTag];if(typeof t=="string"&&/Stream|Port/i.test(t))return!0}}catch{}return!1}function CD(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function XT(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||yv(e)||gv(e)||pv(e)||mv(e))return e;const r=CD(t);if(r.has(e))return e;r.add(e);const o=Object.getOwnPropertyNames(e);for(let n=0;n<o.length;n+=1){const a=o[n];let i;try{i=Object.getOwnPropertyDescriptor(e,a)}catch{i=null}if(i&&(typeof i.get=="function"||typeof i.set=="function"))continue;let s;try{s=e[a]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||yv(s)||gv(s)||pv(s)||mv(s)||XT(s,r)}try{return Object.freeze(e)}catch{return e}}function Zm(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||yv(e)||gv(e)||pv(e)||mv(e))return e;const r=Ra();return(r&&typeof r.freezeDeep=="function"?r.freezeDeep:XT)(e,t)}function wD(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function rE(e,t){const r=Ra();(r&&typeof r.safeWarn=="function"?r.safeWarn:wD)(e,t)}function LD(e,t,r,o={}){if(!r||typeof r!="object")return!1;const n={configurable:o.configurable!==!1,enumerable:!!o.enumerable,value:t,writable:o.writable===!0};try{return Object.defineProperty(r,e,n),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function oE(e,t,r,o){const n=r||Xo(),a=Ra();return a&&typeof a.exposeGlobal=="function"?a.exposeGlobal(e,t,n,o):LD(e,t,n,o)}function RD(e={}){const t=e&&typeof e.scope=="object"?e.scope:Xo(),r=e&&e.registry?e.registry:Ly(t),o={tryRequire(n){return QT()(n)},queueModuleRegistration(n,a,i){return eE(t,n,a,i)},registerOrQueueModule(n,a,i,s){return tE(t,r,n,a,i,s)},freezeDeep:Zm,safeWarn:rE,exposeGlobal(n,a,i){return oE(n,a,t,i)},collectCandidateScopes(){return Object.freeze(ZA(t).slice())},PENDING_QUEUE_KEY:JA()};return Object.defineProperties(o,{scope:{configurable:!1,enumerable:!0,get(){return t}},registry:{configurable:!1,enumerable:!0,get(){return r}}}),Zm(o)}const nE=Zm({getModuleBase:Ra,getGlobalScope:Xo,getModuleRegistry:Ly,resolveModuleRegistry:fv,collectCandidateScopes:ZA,tryRequire(e){return QT()(e)},queueModuleRegistration(e,t,r,o){return eE(o||Xo(),e,t,r)},registerOrQueueModule(e,t,r,o,n,a){return tE(n||Xo(),a,e,t,r,o)},freezeDeep:Zm,safeWarn:rE,exposeGlobal(e,t,r,o){return oE(e,t,r||Xo(),o)},PENDING_QUEUE_KEY:JA(),createScopedEnvironment:RD});tE(Xo(),Ly(),"cineModuleEnvironment",nE,{category:"infrastructure",description:"Shared environment bootstrap that harmonizes module communication across bundles.",replace:!0,connections:["cineModuleBase","cineModuleGlobals","cineEnvironmentBridge"]},e=>{rE("Unable to register cineModuleEnvironment.",e)});oE("cineModuleEnvironment",nE,Xo(),{configurable:!0,enumerable:!1,writable:!1});const Xl=nE;var QC={};function ID(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}var Zi=ID();function Jm(e){var t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function ZT(e){return null}function TD(e){if(Xl&&typeof Xl=="object")return Xl;for(var t=Jm(e||Zi),r=0;r<t.length;r+=1){var o=t[r];if(o&&typeof o.cineModuleEnvironment=="object")return o.cineModuleEnvironment}return null}function OD(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function GD(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(OD(e)||JT(e))return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;var t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){var r=e[Symbol.toStringTag];if(typeof r=="string"&&/Stream|Port/i.test(r))return!0}}catch{}return!1}function JT(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(Zi&&typeof Zi=="object")try{if(e===Zi.ethereum)return!0}catch{return!0}try{if(e.isMetaMask===!0)return!0}catch(r){if(r&&typeof r.message=="string"&&/metamask/i.test(r.message))return!0}try{if(typeof e.request=="function"&&typeof e.on=="function"){if(typeof e.removeListener=="function"||typeof e.removeEventListener=="function")return!0;var t=e.constructor&&e.constructor.name;if(t&&/Ethereum|MetaMask|Provider/i.test(t))return!0}}catch{return!0}return!1}function eO(e,t){var r=t;if(!r)if(typeof WeakSet=="function")r=new WeakSet;else{var o=[];r={add:function(a){o.push(a)},has:function(a){return o.indexOf(a)!==-1}}}if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||GD(e))return e;if(typeof process<"u"&&process&&QC&&QC.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}if(JT(e)||typeof r.has=="function"&&r.has(e))return e;typeof r.add=="function"&&r.add(e);try{Object.freeze(e)}catch{}return e}function tO(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function rO(e,t,r,o){if(!r||typeof r!="object")return!1;var n={configurable:!o||o.configurable!==!1,enumerable:!!(o&&o.enumerable),value:t,writable:!!(o&&o.writable===!0)};try{return Object.defineProperty(r,e,n),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function kD(e,t){if(!e||typeof e!="object")return null;var r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r))return r;try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t]}catch{try{Array.isArray(e[t])||(e[t]=[]),r=e[t]}catch{return null}}return r}function BD(e){if(!e||typeof e!="object")return{};var t={},r=[];try{r=Object.keys(e)}catch{r=[]}for(var o=0;o<r.length;o+=1){var n=r[o];try{t[n]=e[n]}catch{}}return t}function aE(e){var t=e||Zi,r="__cinePendingModuleRegistrations__",o=null,n=!1;function a(d){if(en&&typeof en=="object")return en;for(var p=Jm(d),g=0;g<p.length;g+=1){var h=p[g];if(h&&typeof h.cineModules=="object")return h.cineModules}return null}function i(){return n||(o=a(t),n=!0),o}function s(d,p,g){var h=kD(t,r);if(!h)return!1;var A=Object.freeze(BD(g)),m=Object.freeze({name:d,api:p,options:A});try{h.push(m)}catch{h[h.length]=m}return!0}function u(d,p,g,h){var A=i();if(A&&typeof A.register=="function")try{return A.register(d,p,g||{}),!0}catch(m){if(typeof h=="function")try{h(m)}catch{}}return s(d,p,g)}function l(){var d=Jm(t);return d.slice()}return{scope:t,registry:i(),tryRequire:function(p){return ZT()},queueModuleRegistration:function(p,g,h){return s(p,g,h)},registerOrQueueModule:function(p,g,h,A){return u(p,g,h,A)},freezeDeep:function(p,g){return eO(p,g)},safeWarn:function(p,g){tO(p,g)},exposeGlobal:function(p,g,h){return rO(p,g,t,h||{})},collectCandidateScopes:function(){return Object.freeze(l())},PENDING_QUEUE_KEY:r}}function iE(e){var t=e||Zi,r=TD(t);if(r&&typeof r.createScopedEnvironment=="function")try{var o=r.createScopedEnvironment({scope:t});if(o&&typeof o=="object")return{scope:o.scope||t,moduleEnv:r,environment:o}}catch{}var n=aE(t);return{scope:n.scope||t,moduleEnv:r||null,environment:n}}var Ju=null;function Ry(){return Ju||(Ju=iE(Zi)),Ju}function PD(e){var t=e&&e.scope?e.scope:Zi;return Ju=iE(t),Ju}function vi(e,t){try{return e()}catch{return t}}function bi(){return Ry().scope}function us(){return Ry().environment}function Iy(){return Ry().moduleEnv}function oO(e){if(e&&e!==bi()){var t=Iy();if(t&&typeof t.getModuleRegistry=="function")return vi(function(){return t.getModuleRegistry(e)},null);var r=iE(e);return r.environment&&r.environment.registry?r.environment.registry:null}var o=Ry();if(o.environment&&o.environment.registry)return o.environment.registry;var n=o.moduleEnv;return n&&typeof n.getModuleRegistry=="function"?vi(function(){return n.getModuleRegistry(o.scope)},null):null}function xD(e){var t=us();if(t&&typeof t.tryRequire=="function"){var r=vi(function(){return t.tryRequire(e)},void 0);if(typeof r<"u")return r}var o=Iy();if(o&&typeof o.tryRequire=="function"){var n=vi(function(){return o.tryRequire(e)},void 0);if(typeof n<"u")return n}return ZT()}function nO(e,t,r){var o=us();if(o&&typeof o.queueModuleRegistration=="function")return vi(function(){return o.queueModuleRegistration(e,t,r)},!1);var n=aE(bi());return n.queueModuleRegistration(e,t,r)}function MD(e,t,r,o,n){var a=us();if(a&&typeof a.registerOrQueueModule=="function")return vi(function(){return a.registerOrQueueModule(e,t,r,o)},!1);var i=n||bi(),s=aE(i);return s.registerOrQueueModule(e,t,r,o)}function DD(e,t){return eO(e,t)}function aO(e,t){var r=us();if(r&&typeof r.safeWarn=="function"){vi(function(){r.safeWarn(e,t)},void 0);return}tO(e,t)}function XC(e,t,r,o){var n=us();return n&&typeof n.exposeGlobal=="function"?vi(function(){return n.exposeGlobal(e,t,o)},!1):rO(e,t,r||bi(),o||{})}function _D(e){var t=us();if(t&&typeof t.collectCandidateScopes=="function"){var r=vi(function(){return t.collectCandidateScopes(e)},[]);if(Array.isArray(r))return r.slice()}return Jm(e||bi())}function FD(){var e=us();if(e&&typeof e.PENDING_QUEUE_KEY=="string")return e.PENDING_QUEUE_KEY;var t=Iy();return t&&typeof t.PENDING_QUEUE_KEY=="string"?t.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"}var Ld=Object.freeze({getGlobalScope:bi,getEnvironment:us,getModuleEnvironment:Iy,getModuleRegistry:oO,tryRequire:xD,queueModuleRegistration:nO,registerOrQueueModule:MD,freezeDeep:DD,safeWarn:aO,exposeGlobal:function(t,r,o){return XC(t,r,bi(),o||{})},exposeGlobalScoped:function(t,r,o,n){return XC(t,r,o||bi(),n||{})},collectCandidateScopes:function(t){return Object.freeze(_D(t))},getPendingQueueKey:FD,refresh:function(t){return Object.freeze(PD(t||{}))}}),kf=bi();if(kf&&typeof kf=="object")try{Object.defineProperty(kf,"cineEnvironmentBridge",{configurable:!0,enumerable:!1,writable:!1,value:Ld})}catch{try{kf.cineEnvironmentBridge=Ld}catch{}}var yb=oO();if(yb&&typeof yb.register=="function")try{yb.register("cineEnvironmentBridge",Ld,{category:"infrastructure",description:"Provides consistent global environment access between Cine modules.",replace:!0,connections:["cineModuleEnvironment","cineModuleGlobals"]})}catch(e){aO("Unable to register cineEnvironmentBridge.",e)}else nO("cineEnvironmentBridge",Ld,{category:"infrastructure",description:"Provides consistent global environment access between Cine modules.",replace:!0,connections:["cineModuleEnvironment","cineModuleGlobals"]});const bb=Ld;var ZC={};(function(){function e(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const t=e(),r="__cineReloadProbe__",o="x-cine-connectivity-probe",n="x-cine-connectivity-probe-result",a="network",i="fallback",s="cine-sw-logs",u="cine-sw:connectivity-status";function l(b){if(typeof require=="function")try{return require("./helpers/module-linker.js")}catch{}const v=[b];typeof globalThis<"u"&&v.indexOf(globalThis)===-1&&v.push(globalThis),typeof window<"u"&&v.indexOf(window)===-1&&v.push(window),typeof self<"u"&&v.indexOf(self)===-1&&v.push(self),typeof global<"u"&&v.indexOf(global)===-1&&v.push(global);for(let T=0;T<v.length;T+=1){const P=v[T];try{const x=P&&P.cineModuleLinker;if(x&&typeof x=="object")return x}catch{}}return null}function d(b){if(typeof require=="function")try{return require("./environment.js")}catch{}const v=[b];typeof globalThis<"u"&&v.indexOf(globalThis)===-1&&v.push(globalThis),typeof window<"u"&&v.indexOf(window)===-1&&v.push(window),typeof self<"u"&&v.indexOf(self)===-1&&v.push(self),typeof global<"u"&&v.indexOf(global)===-1&&v.push(global);for(let T=0;T<v.length;T+=1){const P=v[T];if(P&&typeof P.cineModuleEnvironment=="object")return P.cineModuleEnvironment}return null}function p(b){if(typeof require=="function")try{return require("./environment-bridge.js")}catch{}const v=[b];typeof globalThis<"u"&&v.indexOf(globalThis)===-1&&v.push(globalThis),typeof window<"u"&&v.indexOf(window)===-1&&v.push(window),typeof self<"u"&&v.indexOf(self)===-1&&v.push(self),typeof global<"u"&&v.indexOf(global)===-1&&v.push(global);for(let T=0;T<v.length;T+=1){const P=v[T];if(P&&typeof P.cineEnvironmentBridge=="object")return P.cineEnvironmentBridge}return null}const g=l(t),h=g&&typeof g.getModuleEnvironment=="function"?g.getModuleEnvironment():d(t),A=g&&typeof g.getEnvironmentBridge=="function"?g.getEnvironmentBridge():p(t),m=(g&&typeof g.getGlobalScope=="function"?g.getGlobalScope():null)||(A&&typeof A.getGlobalScope=="function"?A.getGlobalScope():null)||(h&&typeof h.getGlobalScope=="function"?h.getGlobalScope():null)||t;function y(){if(typeof require=="function")try{const v=require("./globals.js");if(v&&typeof v=="object")return v}catch{}const b=[m];typeof globalThis<"u"&&b.indexOf(globalThis)===-1&&b.push(globalThis),typeof window<"u"&&b.indexOf(window)===-1&&b.push(window),typeof self<"u"&&b.indexOf(self)===-1&&b.push(self),typeof global<"u"&&b.indexOf(global)===-1&&b.push(global);for(let v=0;v<b.length;v+=1){const T=b[v];if(T&&typeof T.cineModuleGlobals=="object")return T.cineModuleGlobals}return null}const S=(g&&typeof g.getModuleGlobals=="function"?g.getModuleGlobals():null)||y();let E=null,I=!1,L=null;const R=new Set;function G(b){if(!b)return null;if(typeof b=="string")return b;if(typeof b=="number")return Number.isFinite(b)?b:null;if(typeof b=="boolean")return b;if(typeof b=="object"){const v={},T=typeof b.name=="string"&&b.name?b.name:null,P=typeof b.message=="string"&&b.message?b.message:null,x=typeof b.code=="string"&&b.code?b.code:null;if(T&&(v.name=T),P&&(v.message=P),x&&(v.code=x),typeof b.status=="number"&&Number.isFinite(b.status)&&(v.status=b.status),typeof b.type=="string"&&b.type&&(v.type=b.type),Object.keys(v).length===0){try{const _=String(b);if(_&&_!=="[object Object]")return _}catch{}return null}return v}try{return String(b)}catch{return null}}function j(b){if(!b)return null;if(typeof b!="object")return G(b);const v={};if(typeof b.status=="number"&&Number.isFinite(b.status)&&(v.status=b.status),typeof b.statusText=="string"&&b.statusText&&(v.statusText=b.statusText),typeof b.probeResult=="string"&&b.probeResult&&(v.probeResult=b.probeResult),typeof b.reason=="string"&&b.reason&&(v.reason=b.reason),typeof b.stage=="string"&&b.stage&&(v.stage=b.stage),typeof b.source=="string"&&b.source&&(v.source=b.source),typeof b.message=="string"&&b.message&&(v.message=b.message),typeof b.code=="string"&&b.code&&(v.code=b.code),b.head&&typeof b.head=="object"){const T=j(b.head);T&&(v.head=T)}if(b.error){const T=G(b.error);T&&(v.error=T)}if(b.detail&&typeof b.detail=="object"&&b.detail!==b){const T=j(b.detail);T&&(v.detail=T)}return Object.keys(v).length?v:null}function $(){if(I)return null;if(E)return E;if(typeof BroadcastChannel!="function")return I=!0,null;try{return E=new BroadcastChannel(s),E}catch(b){return I=!0,q("cineOffline: Unable to open connectivity broadcast channel",b),null}}function z(b){if(!(!m||typeof m!="object"))try{m.cineConnectivityStatus=b}catch{}}function te(b){R.forEach(v=>{try{v(b)}catch(T){q("cineOffline: connectivity listener failed",T)}})}function oe(b){const v=$();if(v)try{v.postMessage({type:u,state:b})}catch(T){q("cineOffline: Unable to broadcast connectivity state",T);try{v.close()}catch{}E=null,I=!0}}function k(b){try{return Dt(b)}catch(v){return q("cineOffline: Unable to freeze connectivity state",v),b}}function Z(b){const v=L&&typeof L=="object"?L:{status:"unknown",detail:null,source:"cineOffline"},T={status:typeof b.status=="string"&&b.status?b.status:v.status||"unknown",reason:typeof b.reason=="string"&&b.reason?b.reason:null,detail:typeof b.detail>"u"?v.detail:j(b.detail),timestamp:typeof b.timestamp=="number"&&Number.isFinite(b.timestamp)?b.timestamp:Date.now(),source:typeof b.source=="string"&&b.source?b.source:v.source||"cineOffline"};return k(T)}function ue(b){if(typeof document>"u"||!document)return;const v=document.getElementById("offlineIndicator");v&&(b.status==="offline"?typeof v.removeAttribute=="function"&&v.removeAttribute("hidden"):typeof v.setAttribute=="function"&&v.setAttribute("hidden",""))}function H(b){if(!b||typeof b!="object")return L;const v=Z(b);return L&&L.status===v.status&&L.reason===v.reason&&L.detail===v.detail&&L.source===v.source?(L=v,z(v),ue(v),L):(L=v,z(v),ue(v),te(v),oe(v),L)}function Y(b,v){if(g&&typeof g.recordModule=="function"&&g.recordModule(b,v),!(!S||typeof S.recordModule!="function"))try{S.recordModule(b,v)}catch{}}function N(b){if(typeof require!="function")return null;try{return require(b)}catch{return null}}const ae=(function(){return g&&typeof g.tryRequire=="function"?g.tryRequire:S&&typeof S.tryRequire=="function"?S.tryRequire:A&&typeof A.tryRequire=="function"?function(T){const P=A.tryRequire(T);return typeof P>"u"?N(T):P}:h&&typeof h.tryRequire=="function"?h.tryRequire:N})();function de(b){const v=b||m;if(g&&typeof g.getModuleRegistry=="function"){const x=g.getModuleRegistry(v);if(x)return x}if(S&&typeof S.resolveModuleRegistry=="function")try{const x=S.resolveModuleRegistry(v);if(x)return x}catch{}if(A&&typeof A.getModuleRegistry=="function")try{const x=A.getModuleRegistry(v);if(x)return x}catch{}if(h&&typeof h.resolveModuleRegistry=="function")try{const x=h.resolveModuleRegistry(v);if(x)return x}catch{}const T=ae("./registry.js");if(T&&typeof T=="object")return T;const P=[v];typeof globalThis<"u"&&P.indexOf(globalThis)===-1&&P.push(globalThis),typeof window<"u"&&P.indexOf(window)===-1&&P.push(window),typeof self<"u"&&P.indexOf(self)===-1&&P.push(self),typeof global<"u"&&P.indexOf(global)===-1&&P.push(global);for(let x=0;x<P.length;x+=1){const _=P[x];if(_&&typeof _.cineModules=="object")return _.cineModules}return null}const Q=(function(){if(g&&typeof g.getModuleRegistry=="function"){const b=g.getModuleRegistry(m);if(b)return b}if(S&&typeof S.getModuleRegistry=="function")try{const b=S.getModuleRegistry(m);if(b)return b}catch{}if(A&&typeof A.getModuleRegistry=="function")try{const b=A.getModuleRegistry(m);if(b)return b}catch{}if(h&&typeof h.getModuleRegistry=="function")try{const b=h.getModuleRegistry(m);if(b)return b}catch{}return de(m)})(),ne=(function(){if(S&&typeof S.getPendingQueueKey=="function")try{const v=S.getPendingQueueKey();if(typeof v=="string"&&v)return v}catch{}if(A&&typeof A.getPendingQueueKey=="function")try{const v=A.getPendingQueueKey();if(typeof v=="string"&&v)return v}catch{}return h&&typeof h.PENDING_QUEUE_KEY=="string"?h.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function V(b){if(!b||typeof b!="object")return{};const v={},T=Object.keys(b);for(let P=0;P<T.length;P+=1){const x=T[P];v[x]=b[x]}return v}function fe(b,v,T){if(!m||typeof m!="object")return!1;const P=Object.freeze({name:b,api:v,options:Object.freeze(V(T))});let x=m[ne];if(!Array.isArray(x))try{Object.defineProperty(m,ne,{configurable:!0,enumerable:!1,writable:!0,value:[]}),x=m[ne]}catch{try{Array.isArray(m[ne])||(m[ne]=[]),x=m[ne]}catch{return!1}}try{x.push(P)}catch{x[x.length]=P}return!0}function J(b,v,T){if(S&&typeof S.queueModuleRegistration=="function")try{if(S.queueModuleRegistration(b,v,T,m))return!0}catch{}if(A&&typeof A.queueModuleRegistration=="function")try{if(A.queueModuleRegistration(b,v,T))return!0}catch{}return h&&typeof h.queueModuleRegistration=="function"?h.queueModuleRegistration(b,v,T,m):fe(b,v,T)}function Ae(b,v,T,P){if(Q&&typeof Q.register=="function")try{return Q.register(b,v,T),!0}catch(x){if(typeof P=="function")try{P(x)}catch{}}return J(b,v,T),!1}const Le=(function(){return S&&typeof S.registerOrQueueModule=="function"?function(T,P,x,_){try{if(S.registerOrQueueModule(T,P,x,_,m,Q))return!0}catch{}return Ae(T,P,x,_)}:A&&typeof A.registerOrQueueModule=="function"?function(T,P,x,_){try{if(A.registerOrQueueModule(T,P,x,_,m,Q))return!0}catch{}return Ae(T,P,x,_)}:h&&typeof h.registerOrQueueModule=="function"?function(T,P,x,_){return h.registerOrQueueModule(T,P,x,_,m,Q)}:Ae})();function _e(b){if(!b||typeof process>"u"||!process)return!1;if(b===process)return!0;if(typeof b=="object"){try{if(b.constructor&&b.constructor.name==="process")return!0}catch{}if(typeof b.pid=="number"&&typeof b.nextTick=="function"&&typeof b.emit=="function"&&typeof b.binding=="function")return!0}if(typeof b=="function"){if(b===process.binding||b===process._linkedBinding||b===process.dlopen)return!0;try{const v=b.name||"";if(v&&(v==="binding"||v==="dlopen")){const T=Function.prototype.toString.call(b);if(T&&T.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function Je(b){if(!b||typeof b=="function"||typeof b!="object"&&typeof b!="function")return!1;if(_e(b)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof b.pipe=="function"&&typeof b.unpipe=="function")return!0;if(typeof b.on=="function"&&typeof b.emit=="function"){if(typeof b.write=="function"||typeof b.read=="function")return!0;const v=b.constructor&&b.constructor.name;if(v&&/Stream|Emitter|Port/i.test(v))return!0}if(typeof Symbol<"u"&&b[Symbol.toStringTag]){const v=b[Symbol.toStringTag];if(typeof v=="string"&&/Stream|Port/i.test(v))return!0}}catch{}return!1}function xe(b){if(b&&typeof b.has=="function"&&typeof b.add=="function")return b;if(Array.isArray(b))return{has(T){return b.indexOf(T)!==-1},add(T){b.indexOf(T)===-1&&b.push(T)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const v=[];return{has(T){return v.indexOf(T)!==-1},add(T){v.indexOf(T)===-1&&v.push(T)}}}function Ze(b,v){if(!b||typeof b!="object"||Je(b))return b;if(typeof process<"u"&&process&&ZC&&ZC.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(b)}catch{}return b}const T=xe(v);if(T.has(b))return b;T.add(b);const P=Object.getOwnPropertyNames(b);for(let x=0;x<P.length;x+=1){const _=P[x];let ce;try{ce=b[_]}catch{ce=void 0}!ce||typeof ce=="function"||typeof ce!="object"&&typeof ce!="function"||Ze(ce,T)}try{return Object.freeze(b)}catch{return b}}let Ve;function Dt(b,v){return We()(b,v)}function We(){return Ve||(Ve=ft()),Ve}function ft(){return S&&typeof S.freezeDeep=="function"?S.freezeDeep:A&&typeof A.freezeDeep=="function"?function(v,T){try{return A.freezeDeep(v,T)}catch{return Ze(v,T)}}:h&&typeof h.freezeDeep=="function"?h.freezeDeep:Ze}function D(b,v){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof v>"u"?console.warn(b):console.warn(b,v)}catch{}}const q=(function(){return S&&typeof S.safeWarn=="function"?S.safeWarn:A&&typeof A.safeWarn=="function"?function(T,P){try{A.safeWarn(T,P)}catch{D(T,P)}}:h&&typeof h.safeWarn=="function"?h.safeWarn:D})();L=H({status:"unknown",source:"cineOffline"});const we=700,ve=3500,Se=180;let he=!1;function ge(b){return!b||typeof b.then!="function"?Promise.resolve(!1):b.then(()=>!0).catch(()=>!1)}function pe(b){if(!b)return!1;let v="";try{v=typeof b.message=="string"?b.message:""}catch{v=""}let T="";try{T=typeof b.name=="string"?b.name:""}catch{T=""}const P=v.toLowerCase(),x=T.toLowerCase();return x.includes("cors")||x.includes("accesscontrol")?!0:P?!!(P.includes("access control")||P.includes("cors")||P.includes("cross-origin")):!1}function ze(b,v){if(!b)return!1;let T="";try{T=typeof b.message=="string"?b.message:""}catch{T=""}let P="";try{P=typeof b.name=="string"?b.name:""}catch{P=""}const x=T.toLowerCase(),_=P.toLowerCase();if(pe(b)||_==="aborted"||_==="aborterror"||x.includes("load failed")||x.includes("cancelled")||x.includes("canceled"))return!0;if(typeof DOMException=="function")try{if(b instanceof DOMException&&(b.name==="NetworkError"||b.code===DOMException.NETWORK_ERR))return!0}catch{}if(v&&typeof v=="string")try{const ce=typeof location=="object"&&location?br(location):void 0,X=typeof URL=="function"?new URL(v,ce||void 0):null;if(X&&X.protocol&&X.protocol!=="http:"&&X.protocol!=="https:")return!0}catch{}return!1}function ke(b,v){const T=v||_t();if(T&&typeof T.safari=="object"&&T.safari&&typeof T.safari.pushNotification=="object")return!0;const P=b&&typeof b.vendor=="string"?b.vendor:"",x=b&&typeof b.userAgent=="string"?b.userAgent:"";if(!P&&!x)return!1;const ce=P.toLowerCase().trim(),X=x.toLowerCase(),ye=["crios","fxios","edgios","edga","edge","opr/","opt/","opera","chrome","chromium"];for(let zr=0;zr<ye.length;zr+=1){const Ur=ye[zr];if(X.includes(Ur))return!1}const Be=ce.includes("apple"),Ue=X.includes("safari"),be=X.includes("applewebkit"),Fe=X.includes("version/"),bt=X.includes("mobile/"),it=X.includes("macintosh")||X.includes("iphone")||X.includes("ipad")||X.includes("ipod")||X.includes("watch")||X.includes("apple tv"),Kt=ce.length===0,Mt=Ue||be&&(Fe||bt||it),xr=Kt&&be&&Mt;if(!Be&&!xr)return!1;if(Be&&Mt||xr)return!0;let Xr=!1;if(b&&typeof b.standalone=="boolean"?Xr=b.standalone:T&&T.navigator&&typeof T.navigator.standalone=="boolean"&&(Xr=T.navigator.standalone),!Xr&&T&&typeof T.matchMedia=="function")try{const zr=T.matchMedia("(display-mode: standalone)");zr&&zr.matches&&(Xr=!0)}catch{}return Xr}function nt(b,v){return typeof wt(v)!="function"?!1:ke(b,v)}function Ct(b={}){const v=typeof b.nextHref=="string"?b.nextHref:"";if(!v)return null;const T=_t(b.window),P=kt(b.fetch,T);if(typeof P!="function")return null;const x=b.location&&typeof b.location=="object"?b.location:T&&T.location?T.location:null;if(!so(x,v))return null;const _=_r(b.navigator);if(_&&_.onLine===!1)return null;const ce=nt(_,T);let X=null;if(typeof AbortController=="function")try{X=new AbortController}catch{X=null}let ye=!1,Be=!1;const Ue=[],be=Ft=>{typeof Ft=="function"&&Ue.push(Ft)},Fe=ge(b.serviceWorkerPromise).then(Ft=>(ye=!0,Ft)),bt=ge(b.cachePromise).then(Ft=>(Be=!0,Ft)),it=b.allowCache===!0,Kt=(()=>{const Ft=br(x),Zr=kr(x);if(!Zr)return!1;const Rr=wo(v,Ft);return!!Rr&&Rr===Zr})(),Mt="same-origin",xr=Kt?"same-origin":"omit",Xr=(()=>{const Ft=br(x),Rr=Lr(x,typeof Ft=="string"&&Ft?Ft:v,v);if(typeof Rr!="string"||!Rr)return"";const fo=kr(x);if(typeof URL=="function"){const lo=typeof Ft=="string"&&Ft?Ft:void 0;try{const Mr=new URL(Rr,lo);if(fo&&Mr.origin&&Mr.origin!==fo)return"";const co=`${Mr.pathname||""}${Mr.search||""}${Mr.hash||""}`;if(co)return co;if(fo&&(!Mr.pathname||Mr.pathname==="/"))return"/"}catch{}}if(typeof fo=="string"&&fo&&typeof Rr=="string"&&Rr.startsWith(fo)){const lo=Rr.slice(fo.length);if(!lo||lo.startsWith("/")||lo.startsWith("?")||lo.startsWith("#"))return lo||"/"}return typeof Rr=="string"&&(Rr.startsWith("/")||!Rr.includes("://"))?Rr:""})(),Ur=(async()=>{const Ft=typeof b.warmupWaitMs=="number"?b.warmupWaitMs:Se;try{await Promise.allSettled([Ot(Fe,Ft),Ot(bt,Ft)])}catch{}const Zr=it&&ye&&Be,Rr=(pt={})=>{const dt={cache:Zr?"reload":"no-store",credentials:xr,mode:Mt,redirect:"follow"};return X&&X.signal&&(dt.signal=X.signal),Object.assign(dt,pt)},fo=async(pt={})=>{const dt=Rr(pt),Br=Xr||v;return P.call(T||void 0,Br,dt)};X&&be(()=>{try{X.abort()}catch{}});const lo=()=>{if(!ce)return null;const pt=wt(T);if(typeof pt!="function")return null;const dt=Xr||v;if(!dt)return null;let Br;try{Br=new pt}catch{Br=null}if(!Br)return null;let Do=!1;be(()=>{if(Br){Do=!0;try{Br.abort()}catch{}}});const Vo=new Promise(Fr=>{const to=Wo=>{Fr&&Fr(Wo)};Br.addEventListener("load",()=>{if(Do){to(!1);return}try{Br.responseText}catch{}const Wo=typeof Br.status=="number"?Br.status:0;if(!Wo){to(!0);return}to(Wo>=200&&Wo<400)}),Br.addEventListener("error",()=>{to(!1)}),Br.addEventListener("abort",()=>{to(!1)}),Br.addEventListener("timeout",()=>{to(!1)})});try{Br.open("GET",dt,!0)}catch{return null}try{Br.responseType="text"}catch{}try{Br.send(null)}catch{return null}return Vo.then(Fr=>!!Fr)},Mr=()=>X&&X.signal&&X.signal.aborted===!0;let co=null,$r=null,et=!ce;if(ce)try{const pt=await lo();if(pt===!0)return!0;pt===!1?et=!1:et=!0}catch{et=!0}if(et)try{co=await fo()}catch(pt){$r=pt}if(!co){if(Mr()||pe($r))return!1;let pt=null,dt=$r;const Br=Zr?"reload":"no-store",Do=[];Zr&&Do.push("no-cache"),Do.push("no-store"),Do.push("default");for(let Vo=0;Vo<Do.length&&!pt;Vo+=1){const Fr=Do[Vo];if(Fr!==Br)try{pt=await fo({cache:Fr}),dt=null}catch(to){dt=to||dt||$r,pt=null}}if(!pt){if(Mr())return!1;const Vo=ze(dt||$r,v);return!he&&!Vo&&(he=!0,q("Reload warmup fetch failed",dt||$r)),!1}co=pt}if(!co)return!1;try{const pt=typeof co.clone=="function"?co.clone():co;pt&&typeof pt.text=="function"&&pt.bodyUsed!==!0&&await pt.text()}catch{}return!0})();return Ur&&typeof Ur.catch=="function"&&Ur.catch(()=>{}),{cancel(){for(let Ft=0;Ft<Ue.length;Ft+=1){const Zr=Ue[Ft];if(typeof Zr=="function")try{Zr()}catch{}}},promise:Ur,done:Ur}}function Ot(b,v,T,P){if(!b||typeof b.then!="function")return Promise.resolve({timedOut:!1,result:b});const x=typeof v=="number"&&v>=0?v:null,_=typeof setTimeout=="function"?setTimeout:null,ce=typeof clearTimeout=="function"?clearTimeout:null;if(x===null||!_)return b.then(Be=>({timedOut:!1,result:Be}));let X=!1,ye=null;return new Promise((Be,Ue)=>{b.then(be=>{if(X)return be;if(X=!0,ye!=null&&ce)try{ce(ye)}catch{}return Be({timedOut:!1,result:be}),be},be=>{if(X){if(typeof P=="function")try{P(be)}catch{}return null}if(X=!0,ye!=null&&ce)try{ce(ye)}catch{}return Ue(be),null}),ye=_(()=>{if(!X){if(X=!0,typeof T=="function")try{T()}catch{}Be({timedOut:!0,result:void 0})}},x),ye&&typeof ye.unref=="function"&&ye.unref()})}function xt(b,v){if(!m||typeof m!="object")return!1;try{return Object.defineProperty(m,b,{configurable:!0,enumerable:!1,value:v,writable:!1}),!0}catch{try{return m[b]=v,!0}catch{return!1}}}const or=(function(){return S&&typeof S.exposeGlobal=="function"?function(T,P,x){try{return S.exposeGlobal(T,P,x)}catch{return xt(T,P)}}:A&&typeof A.exposeGlobal=="function"?function(T,P,x){try{return A.exposeGlobal(T,P,x)}catch{return xt(T,P)}}:h&&typeof h.exposeGlobal=="function"?function(T,P,x){return h.exposeGlobal(T,P,m,x)}:xt})(),er=["cameraPowerPlanner_schemaCache","cinePowerPlanner_schemaCache"],wr=["","__backup","__legacyMigrationBackup"],Pt=new Set;let Pr=null;function Wt(b){if(!(!m||typeof m!="object"&&typeof m!="function"))try{return m[b]}catch{return}}function _t(b){return b||(typeof window<"u"?window:Wt("window"))}function _r(b){if(b)return b;if(typeof navigator<"u")return navigator;const v=_t();return v&&typeof v.navigator<"u"?v.navigator:Wt("navigator")}function Oe(b){return!b||typeof b!="object"||typeof b.onLine!="boolean"?!1:b.onLine===!1}function ct(b){if(b)return b;if(typeof caches<"u")return caches;const v=_t();return v&&typeof v.caches<"u"?v.caches:Wt("caches")}function Gt(b){if(b&&typeof b=="object")return b;const v=_t();return v&&v.location&&typeof v.location=="object"?v.location:Wt("location")}function kt(b,v){if(typeof b=="function")return b;if(typeof fetch=="function")return fetch;const T=v||_t();if(T&&typeof T.fetch=="function")try{return T.fetch.bind(T)}catch{return T.fetch}const P=Wt("fetch");return typeof P=="function"?P:null}function O(){if(typeof AbortController!="function")return null;try{return new AbortController}catch{return null}}function U(b){const v=new Error(b);return v.name="TimeoutError",v.code="ETIMEDOUT",v}function F(b,v,T,P){if(typeof b!="function")return Promise.resolve({successful:!1,error:new Error("Fetch unavailable"),timedOut:!1});const x=T?{...T}:{},_=O();let ce=null,X=!1;if(_&&typeof _.signal<"u")try{x.signal=_.signal}catch{}let ye=null;typeof P=="number"&&P>0&&typeof setTimeout=="function"&&(ye=new Promise((Fe,bt)=>{try{ce=setTimeout(()=>{if(X=!0,_&&typeof _.abort=="function")try{_.abort()}catch(it){}bt(U("Connectivity probe timed out"))},P)}catch{ye=null}}));const Be=()=>{if(ce)try{clearTimeout(ce)}catch{}},Ue=(()=>{try{return b(v,x)}catch(Fe){return Be(),Promise.reject(Fe)}})();return(ye?Promise.race([Ue,ye]):Ue).then(Fe=>(Be(),{successful:!0,value:Fe,timedOut:!1})).catch(Fe=>(Be(),{successful:!1,error:Fe,timedOut:X}))}function W(b){if(!b)return!1;try{if(b.ok===!0)return!0}catch{}let v=0;try{v=typeof b.status=="number"?b.status:0}catch{v=0}return v===0?!0:v>=200&&v<400}function se(b,v){if(!b||typeof b!="string"||typeof v>"u"||v===null)return b;let T;if(typeof v=="string")T=v;else try{T=String(v)}catch{return b}if(!T)return b;let P=b,x="";const _=P.indexOf("#");_!==-1&&(x=P.slice(_),P=P.slice(0,_));const ce=P.indexOf("?")===-1?"?":"&",X=encodeURIComponent(r),ye=encodeURIComponent(T);return`${P}${ce}${X}=${ye}${x}`}function me(b){if(!b||!b.headers||typeof b.headers.get!="function")return null;try{const v=b.headers.get(n);if(typeof v=="string"&&v)return v.toLowerCase()}catch{}return null}function Re(b,v){if(b&&typeof b.nextHref=="string"&&b.nextHref)return b.nextHref;if(b&&typeof b.originalHref=="string"&&b.originalHref)return b.originalHref;const T=br(v);if(T)return T;const P=Wr(v);return P||"index.html"}async function De({navigatorLike:b,windowLike:v,locationLike:T,fetchFn:P,forceReloadUrl:x,timeoutMs:_}){if(Oe(b))return{reachable:!1,reason:"offline"};const ce=P||kt(void 0,v);if(typeof ce!="function")return{reachable:!0,reason:"fetch-unavailable"};const X=`${Date.now().toString(36)}-${Math.random().toString(36).slice(2)}`,ye=se(Re(x,T),X),Be={"Cache-Control":"no-store, max-age=0",Pragma:"no-cache"};typeof X=="string"&&X&&(Be[o]=X);let Ue=null;const be=await F(ce,ye,{method:"HEAD",cache:"no-store",credentials:"same-origin",headers:Be},_);if(be.successful){let bt=0;try{bt=be.value&&typeof be.value.status=="number"?be.value.status:0}catch{bt=0}const it=me(be.value);if(it&&it!==a)Ue={source:"head",status:bt,probeResult:it||i};else{if(W(be.value))return{reachable:!0,reason:"head-ok"};Ue={source:"head",status:bt}}}else{if(be.timedOut)return{reachable:!1,reason:"timeout",detail:be.error};be.error&&(Ue={source:"head",error:be.error})}const Fe=await F(ce,ye,{method:"GET",cache:"no-store",credentials:"same-origin",headers:{...Be}},_);if(Fe.successful){const bt=me(Fe.value);return bt&&bt!==a?{reachable:!1,reason:"cache-fallback",detail:{status:Fe.value&&typeof Fe.value.status=="number"?Fe.value.status:void 0,head:Ue,probeResult:bt||i}}:W(Fe.value)?{reachable:!0,reason:"get-ok"}:{reachable:!1,reason:"get-failed",detail:{status:Fe.value&&typeof Fe.value.status=="number"?Fe.value.status:void 0,head:Ue}}}return Fe.timedOut?{reachable:!1,reason:"timeout",detail:Fe.error}:{reachable:!1,reason:"unreachable",detail:Fe.error||Ue||be.error}}function ot(b){return typeof b!="function"?function(){}:(R.add(b),function(){try{R.delete(b)}catch{}})}function at(b){if(typeof b=="function")try{R.delete(b)}catch{}}function vt(b,v){if(!b||typeof b!="object")return;const T=b.detail&&typeof b.detail=="object"?{...b.detail,stage:v&&v.stage||"probe",source:v&&v.source||"probe"}:{stage:v&&v.stage||"probe",source:v&&v.source||"probe"};if(b.reachable){H({status:"online",reason:typeof b.reason=="string"&&b.reason?b.reason:"probe-ok",detail:T,source:v&&v.source||"probe"});return}const P=b.reason==="offline"?"offline":"degraded";H({status:P,reason:typeof b.reason=="string"&&b.reason?b.reason:"unknown",detail:T,source:v&&v.source||"probe"})}function wt(b){const v=b||_t();if(v&&typeof v.XMLHttpRequest=="function")return v.XMLHttpRequest;if(typeof XMLHttpRequest=="function")return XMLHttpRequest;const T=Wt("XMLHttpRequest");return typeof T=="function"?T:null}function Qt(b,v,T){if(!v||typeof v!="object"&&typeof v!="function")return;const P=typeof v.removeItem=="function",x=typeof v.delete=="function";!P&&!x||b.add(v)}function yr(b,v,T){if(!v||typeof v!="object"&&typeof v!="function")return;try{Qt(b,v.SAFE_LOCAL_STORAGE,`${T}.SAFE_LOCAL_STORAGE`)}catch(x){const _=`${T}.SAFE_LOCAL_STORAGE`;Pt.has(_)||(Pt.add(_),q(`Unable to inspect ${_} while clearing UI caches`,x))}try{Qt(b,v.localStorage,`${T}.localStorage`)}catch(x){const _=`${T}.localStorage`;Pt.has(_)||(Pt.add(_),q(`Unable to inspect ${_} while clearing UI caches`,x))}try{Qt(b,v.sessionStorage,`${T}.sessionStorage`)}catch(x){const _=`${T}.sessionStorage`;Pt.has(_)||(Pt.add(_),q(`Unable to inspect ${_} while clearing UI caches`,x))}let P=null;try{P=v.__cineGlobal}catch(x){const _=`${T}.__cineGlobal`;Pt.has(_)||(Pt.add(_),q(`Unable to inspect ${_} while clearing UI caches`,x))}P&&P!==v&&yr(b,P,`${T}.__cineGlobal`)}function tr(b={}){const v=new Set,T=typeof b.resolveSafeLocalStorage=="function"?b.resolveSafeLocalStorage:typeof Wt("resolveSafeLocalStorage")=="function"?Wt("resolveSafeLocalStorage"):null,P=b.safeLocalStorage||Wt("SAFE_LOCAL_STORAGE");try{const X=T?T():null;Qt(v,X,"safeLocalStorage")}catch(X){q("resolveSafeLocalStorage() failed while collecting UI cache storages",X)}if(P)try{Qt(v,P,"SAFE_LOCAL_STORAGE")}catch(X){const ye="SAFE_LOCAL_STORAGE";Pt.has(ye)||(Pt.add(ye),q("Unable to inspect SAFE_LOCAL_STORAGE while clearing UI caches",X))}const x=b.scopeCandidates||[{scope:Wt("globalThis"),label:"globalThis"},{scope:_t(b.window),label:"window"},{scope:typeof self<"u"?self:Wt("self"),label:"self"},{scope:Wt("global"),label:"global"}],_=typeof m<"u"?m.__cineGlobal:void 0;typeof _<"u"&&x.push({scope:_,label:"__cineGlobal"}),x.forEach(({scope:X,label:ye})=>{yr(v,X,ye)});const ce=_t(b.window);if(ce){try{Qt(v,ce.localStorage,"window.localStorage")}catch(X){const ye="window.localStorage";Pt.has(ye)||(Pt.add(ye),q("Unable to inspect window.localStorage while clearing UI caches",X))}try{Qt(v,ce.sessionStorage,"window.sessionStorage")}catch(X){const ye="window.sessionStorage";Pt.has(ye)||(Pt.add(ye),q("Unable to inspect window.sessionStorage while clearing UI caches",X))}}return v}function rr(b={}){const v=b.storages||tr(b);if(!v||!v.size)return!1;let T=!1;return v.forEach(P=>{er.forEach(x=>{typeof x!="string"||!x||wr.forEach(_=>{const ce=_?`${x}${_}`:x;try{typeof P.removeItem=="function"?(P.removeItem(ce),T=!0):typeof P.delete=="function"&&(P.delete(ce),T=!0)}catch(X){q("Failed to remove UI cache entry",{entryKey:ce,error:X})}})})}),T}async function bn(b){const v=_r(b);if(!v||!v.serviceWorker)return[];const{serviceWorker:T}=v,P=[],x=_=>{_&&P.push(_)};try{if(typeof T.getRegistrations=="function"){const _=await T.getRegistrations();Array.isArray(_)&&_.forEach(x)}else if(typeof T.getRegistration=="function"){const _=await T.getRegistration();x(_)}else if(T.ready&&typeof T.ready.then=="function")try{const _=await T.ready;x(_)}catch(_){q("Failed to await active service worker",_)}}catch(_){q("Failed to query service worker registrations",_)}return P}async function io(b){if(!b)return[];try{const v=await Promise.resolve(b);return Array.isArray(v)?v.filter(T=>!!T):[]}catch(v){q("Failed to resolve prefetched service worker registrations",v)}return[]}async function $o(b,v){const T=_r(b);if(!T||!T.serviceWorker)return!1;let P=await io(v);return P.length||(P=await bn(T)),P.length?(await Promise.all(P.map(x=>!x||typeof x.unregister!="function"?Promise.resolve(!1):x.unregister().catch(_=>(q("Service worker unregister failed",_),!1)))),!0):!1}function hn(b){const v=_r(b);if(!v||!v.serviceWorker)return null;const{serviceWorker:T}=v;if(!T)return null;let P=!1,x=null,_=null,ce=!1;const X=Be=>{if(P)return;P=!0;const Ue=_;if(_=null,typeof x=="function"){try{x()}catch{}x=null}if(typeof Ue=="function")try{Ue(Be)}catch{}},ye=new Promise(Be=>{if(_=Be,T.controller){X(!0);return}const Ue=()=>{X(!0)};try{if(typeof T.addEventListener=="function")T.addEventListener("controllerchange",Ue),x=()=>{try{T.removeEventListener("controllerchange",Ue)}catch(be){}},ce=!0;else if("oncontrollerchange"in T){const be=T.oncontrollerchange;T.oncontrollerchange=function(bt){if(typeof be=="function")try{be.call(this,bt)}catch(it){q("Existing service worker controllerchange handler failed",it)}Ue(bt)},x=()=>{try{T.oncontrollerchange=be}catch(Fe){}},ce=!0}else X(!1)}catch(be){q("Failed to observe service worker controllerchange",be),X(!1)}});return!ce&&!T.controller?(X(!1),null):{promise:ye,cancel(){X(!1)}}}const Sn=["cine-power-planner","cinepowerplanner"];function ei(){const b=Wt("CINE_CACHE_NAME");return typeof b=="string"&&b?b:null}function Xe(b,v,T){if(typeof b!="string"||!b)return!1;if(v&&(b===v||b.toLowerCase()===T))return!0;const P=b.toLowerCase();for(let x=0;x<Sn.length;x+=1)if(P.includes(Sn[x]))return!0;return!1}async function ti(b){const v=ct(b);if(!v||typeof v.keys!="function")return!1;const T=ei(),P=T?T.toLowerCase():null;try{const x=await v.keys();if(!Array.isArray(x)||!x.length)return!1;const _=x.filter(X=>Xe(X,T,P));if(!_.length)return!1;let ce=!1;return await Promise.all(_.map(X=>!X||typeof v.delete!="function"?Promise.resolve(!1):v.delete(X).then(ye=>(ce=ce||!!ye,ye)).catch(ye=>(q("Failed to delete cache",{key:X,error:ye}),!1)))),ce}catch(x){return q("Cache clear failed",x),!1}}function br(b){if(!b||typeof b!="object")return"";try{const v=b.href;return typeof v=="string"?v:""}catch{return""}}function Wr(b){if(!b||typeof b!="object")return"";try{const v=b.pathname;return typeof v=="string"?v:""}catch{return""}}function kr(b){if(!b||typeof b!="object")return"";try{const P=b.origin;if(typeof P=="string"&&P)return P}catch{}const v=br(b);if(!v)return"";if(typeof URL=="function")try{return new URL(v).origin}catch{}const T=v.match(/^([a-zA-Z][a-zA-Z\d+.-]*:\/\/[^/]+)/);return T&&T[1]?T[1]:""}function wo(b,v){if(typeof b!="string"||!b)return"";const T=typeof v=="string"&&v?v:void 0;if(typeof URL=="function")try{const x=new URL(b,T);if(x&&typeof x.origin=="string")return x.origin}catch{}const P=b.match(/^([a-zA-Z][a-zA-Z\d+.-]*:\/\/[^/]+)/);return P&&P[1]?P[1]:""}function so(b,v){if(typeof v!="string"||!v)return!1;const T=b&&typeof b=="object"?b:typeof window<"u"&&window&&window.location?window.location:null,P=br(b)||br(T),x=wo(v,P);if(!x)return!0;const _=kr(b)||kr(T);return _?x===_:!1}function Ga(b,v){const T=[],P=new Set,x=ye=>{if(typeof ye!="string")return;const Be=ye.trim();!Be||P.has(Be)||(P.add(Be),T.push(Be))},_=br(b);_&&x(_),typeof v=="string"&&v&&x(v);const ce=kr(b),X=Wr(b);if(ce&&(X&&x(`${ce}${X}`),x(`${ce}/`)),typeof window<"u"&&window&&window.location){const ye=br(window.location);ye&&x(ye)}return T}function Po(b,v){if(typeof b!="string")return"";const T=b.trim();if(!T)return"";if(typeof URL=="function")try{return new URL(T).toString()}catch{if(typeof v=="string"&&v)try{return new URL(T,v).toString()}catch{}}return T}function Lr(b,v,T){if(so(b,T))return T;const P=br(b),x=typeof v=="string"&&v?v:"",_=[];P&&so(b,P)&&_.push(P),x&&so(b,x)&&_.push(x);const ce=_.length?_[0]:P,X=kr(b);if(typeof URL=="function"&&ce)try{const ye=new URL(T,ce),Be=`${ye.origin||""}${ye.pathname||""}${ye.search||""}${ye.hash||""}`;if(Be&&so(b,Be))return Be}catch{}if(typeof T=="string"&&X){const ye=/^[a-zA-Z][a-zA-Z\d+.-]*:\/\/[^/]+(.*)$/,Be=T.match(ye);if(Be&&Be[1]){const Ue=`${X}${Be[1]}`;if(so(b,Ue))return Ue}}return _.length?_[0]:X||""}function xo(b,v,T="forceReload"){const P=v&&typeof v.param=="string"&&v.param?v.param:T,x=v&&typeof v.timestamp=="string"&&v.timestamp?v.timestamp:Date.now().toString(36),ce=(v&&typeof v.originalHref=="string"&&v.originalHref?v.originalHref:br(b))||br(b),X=v&&typeof v.nextHref=="string"&&v.nextHref?v.nextHref:ce,ye=Lr(b,ce,X);return{originalHref:ce,nextHref:ye,param:P,timestamp:x}}function ln(b,v){const T=v,P=Date.now().toString(36),x=br(b),_=Ga(b,x);if(!x)return{originalHref:x,nextHref:x,param:T,timestamp:P};if(typeof URL=="function"){const Fe=[x,..._];for(let bt=0;bt<Fe.length;bt+=1){const it=Fe[bt];try{const Kt=bt===0?new URL(it):new URL(x,it);Kt.searchParams.set(T,P);const Mt=Kt.toString();return{originalHref:x,nextHref:Lr(b,x,Mt),param:T,timestamp:P}}catch{}}}let ce=x,X="";const ye=ce.indexOf("#");ye!==-1&&(X=ce.slice(ye),ce=ce.slice(0,ye));const Be=new RegExp(`([?&])${T}=[^&]*`),Ue=`$1${T}=${P}`;if(Be.test(ce)?ce=ce.replace(Be,Ue):ce.indexOf("?")!==-1?ce+=`&${T}=${P}`:ce&&(ce+=`?${T}=${P}`),typeof URL=="function")for(let Fe=0;Fe<_.length;Fe+=1){const bt=_[Fe];try{const Kt=new URL(ce+X,bt).toString();return{originalHref:x,nextHref:Lr(b,x,Kt),param:T,timestamp:P}}catch{}}const be=ce?ce+X:x;return{originalHref:x,nextHref:Lr(b,x,be),param:T,timestamp:P}}function Pn(b,v){if(typeof b!="string"||!b)return!1;const T=b.trim();if(!T)return!1;const x=`#${typeof v=="string"&&v?v:"forceReload"}`;if(!T.startsWith(x))return!1;if(T.length===x.length)return!0;const _=T.slice(x.length);return/^[-=]/.test(_)}function Mo(b,v){if(typeof b!="string"||!b)return b;if(typeof URL=="function"){const T=typeof v=="string"&&v?v:void 0;try{const P=new URL(b,T);return`${P.pathname||""}${P.search||""}${P.hash||""}`||P.toString()}catch{}}return b}function Jn(b,v="forceReload"){const T=_t(b);if(!T||!T.location)return!1;const{location:P}=T,x=br(P);if(!x)return!1;const _=typeof v=="string"&&v?v:"forceReload";let ce=x,X=!1,ye=!1;if(typeof URL=="function")try{const be=new URL(x);be.searchParams&&typeof be.searchParams.delete=="function"&&be.searchParams.has(_)&&(be.searchParams.delete(_),X=!0),Pn(be.hash,_)&&(be.hash="",ye=!0),ce=be.toString()}catch{}if(!X){let be=ce,Fe="";const bt=be.indexOf("#");bt!==-1&&(Fe=be.slice(bt),be=be.slice(0,bt));const it=be.indexOf("?");if(it!==-1){const Kt=be.slice(0,it),xr=be.slice(it+1).split("&"),Xr=[];for(let zr=0;zr<xr.length;zr+=1){const Ur=xr[zr];if(!Ur)continue;const Ft=Ur.indexOf("=");if((Ft===-1?Ur:Ur.slice(0,Ft))===_){X=!0;continue}Xr.push(Ur)}be=Xr.length?`${Kt}?${Xr.join("&")}`:Kt}ce=Fe?`${be}${Fe}`:be}if(!ye&&Pn(T.location&&T.location.hash,_)&&(ye=!0,ce=ce.replace(/#.*$/,"")),!X&&!ye)return!1;const Be=Po(x,x)||x;let Ue=null;try{Ue=T.history||null}catch(be){q("Force reload cleanup failed to access history object",be),Ue=null}if(Ue&&typeof Ue.replaceState=="function"){let be=null,Fe=!1;try{be=Ue.state,Fe=!0}catch(it){q("Force reload cleanup failed to snapshot history state",it)}const bt=Mo(ce,Be);try{return Ue.replaceState(Fe?be:null,"",bt),!0}catch(it){q("Force reload cleanup failed to update history state",it)}}if(ye)try{if(typeof T.location.hash=="string"&&Pn(T.location.hash,_))return T.location.hash="",!0}catch(be){q("Force reload cleanup failed to clear hash fallback",be)}return!1}function ea(b,v,T,P,x,_){let ce=null;try{typeof window<"u"&&window&&typeof window.setTimeout=="function"&&(ce=window.setTimeout.bind(window))}catch{}if(!ce)if(typeof setTimeout=="function")ce=setTimeout;else{q("Forced reload navigation attempt did not update location",{description:T,before:P,after:_,expected:x});return}let X=!1;const ye=()=>{const Ue=br(b),be=Po(Ue,v);return x&&(be===x||be===`${x}#`)||P!==be&&be&&(!x||be===x)?(X=!0,{matched:!0,value:be}):{matched:!1,value:be}},Be=[90,240,480];Be.forEach((Ue,be)=>{const Fe=be===Be.length-1,bt=()=>{if(X)return;const it=ye();it.matched||Fe&&(X=!0,q("Forced reload navigation attempt did not update location",{description:T,before:P,after:it.value,expected:x}))};try{ce(bt,Ue)}catch{Fe&&bt()}})}function xn(b,v,T,P,x){if(!b||typeof P!="function"||typeof v!="string"||!v)return!1;const _=br(b),ce=Po(_,T);try{P(v)}catch(Ue){return q("Forced reload navigation helper failed",{description:x,error:Ue}),!1}const X=br(b),ye=Po(X,T),Be=Po(v,T);return Be&&(ye===Be||ye===`${Be}#`)||ce!==ye&&ye&&(!Be||ye===Be)?!0:(ea(b,T,x,ce,Be,ye),!1)}function vn(b,v,T,P){if(!b||!v||typeof T!="string"||!T)return!1;let x=null;try{x=b.history||null}catch(it){q("Forced reload history access failed",it),x=null}if(!x||typeof x.replaceState!="function")return!1;const _=br(v),ce=Po(_,P),X=Po(T,P);let ye=T;try{const it=_||P||void 0,Kt=typeof URL=="function"?new URL(T,it):null;Kt&&(ye=`${Kt.pathname||""}${Kt.search||""}${Kt.hash||""}`||Kt.toString())}catch(it){q("Forced reload history fallback URL parse failed",it),ye=T}let Be=null,Ue=!1;try{Be=x.state,Ue=!0}catch(it){q("Forced reload history state snapshot failed",it)}try{x.replaceState(Ue?Be:null,"",ye)}catch(it){return q("Forced reload history replaceState failed",it),!1}const be=br(v),Fe=Po(be,P);if(!(X&&(Fe===X||Fe===`${X}#`)||ce!==Fe&&Fe&&(!X||Fe===X)))return ea(v,P,"history.replaceState",ce,X,Fe),!1;if(typeof v.reload=="function")try{return v.reload(),!0}catch(it){q("Forced reload via history replaceState reload failed",it)}return!0}function ta(b,v,T={}){if(!b||!v)return;let P=null;try{typeof b.setTimeout=="function"&&(P=b.setTimeout.bind(b))}catch{}if(!P)if(typeof setTimeout=="function")P=setTimeout;else return;const x=T.hasReload===!0&&typeof v.reload=="function",_=typeof T.baseHref=="string"?T.baseHref:"",ce=typeof T.nextHref=="string"?T.nextHref:"",X=typeof T.originalHref=="string"?T.originalHref:"",ye=ce||_||X||"",Be=ye?ye.split("#")[0]:_||X||"",Ue=typeof T.timestamp=="string"&&T.timestamp?T.timestamp:Date.now().toString(36),be=Be?`${Be}#forceReload-${Ue}`:"",Fe=[];let bt=120;const it=120,Kt=Mt=>{Fe.push({delay:bt,run:Mt}),bt+=it};if(ye&&(typeof v.assign=="function"&&Kt(()=>{try{v.assign(ye)}catch(Mt){q("Forced reload fallback via location.assign failed",Mt)}}),typeof v.replace=="function"&&Kt(()=>{try{v.replace(ye)}catch(Mt){q("Forced reload fallback via location.replace failed",Mt)}}),Kt(()=>{try{v.href=ye}catch(Mt){q("Forced reload fallback via href assignment failed",Mt)}})),be&&be!==ye&&Kt(()=>{try{v.href=be}catch(Mt){q("Forced reload fallback via hash injection failed",Mt)}}),x){const Mt=Fe.length?Math.max(bt,280):280;Fe.push({delay:Mt,run(){try{v.reload()}catch(xr){q("Timed force reload fallback failed",xr)}}})}Fe.length&&Fe.forEach(Mt=>{try{P(Mt.run,Mt.delay)}catch(xr){q("Unable to schedule forced reload fallback",xr)}})}function ka(b,v){const T=_t(b);if(!T||!T.location)return!1;const{location:P}=T,x=P&&typeof P.replace=="function",_=P&&typeof P.assign=="function",ce=P&&typeof P.reload=="function";let X=!1;const ye=v&&typeof v=="object"?v:ln(P,"forceReload"),Be=xo(P,ye,"forceReload"),be=(typeof Be.originalHref=="string"&&Be.originalHref?Be.originalHref:br(P))||br(P),Fe=typeof Be.nextHref=="string"?Be.nextHref:"",bt=Be.timestamp,it=Po(be,be)||be;if(x&&Fe&&(X=xn(P,Fe,it,Mt=>{P.replace(Mt)},"location.replace")),_&&!X&&Fe&&(X=xn(P,Fe,it,Mt=>{P.assign(Mt)},"location.assign")),!X&&Fe&&Fe!==be&&(X=xn(P,Fe,it,Mt=>{P.href=Mt},"location.href assignment")),!X&&T&&Fe&&(X=vn(T,P,Fe,it)),!X&&(!Fe||Fe===be)&&ce)try{P.reload(),X=!0}catch(Mt){q("Forced reload via location.reload failed",Mt)}return X||ta(T,P,{originalHref:be,baseHref:it,nextHref:Fe,hasReload:ce,timestamp:bt}),X}async function Ti(b={}){const v=_t(b.window),T=Gt(b.location||v&&v.location),P=xo(T,ln(T,"forceReload"),"forceReload"),x=_r(b.navigator),_=await De({navigatorLike:x,windowLike:v,locationLike:T,fetchFn:kt(b.fetch,v),forceReloadUrl:P,timeoutMs:typeof b.connectivityProbeTimeoutMs=="number"?b.connectivityProbeTimeoutMs:ve});if(vt(_,{stage:"reload-app-probe",source:"reloadApp.probe"}),!_.reachable){const et=typeof b.onOfflineReloadBlocked=="function"?b.onOfflineReloadBlocked:Wt("announceForceReloadOfflineNotice");if(typeof et=="function")try{et({reason:_.reason||"offline",source:"reloadApp"})}catch(pt){q("Failed to announce offline reload guard",pt)}return _.detail&&_.reason!=="offline"&&q("Connectivity probe blocked forced reload",_.detail),H({status:"degraded",reason:"reload-blocked",detail:{previousReason:_.reason||"offline",stage:"reload-app",source:"reloadApp.blocked"},source:"reloadApp.blocked"}),{blocked:!0,reason:_.reason||"offline",uiCacheCleared:!1,serviceWorkersUnregistered:!1,serviceWorkerStatusKnown:!1,warmupCompleted:!1,cachesCleared:!1,reloadTriggered:!1,navigationTriggered:!1}}const ce=x&&x.serviceWorker?bn(x):Promise.resolve([]);let X=!1;const ye=typeof b.clearUiCacheStorageEntries=="function"?b.clearUiCacheStorageEntries:typeof Wt("clearUiCacheStorageEntries")=="function"?Wt("clearUiCacheStorageEntries"):null;if(ye)try{ye(),X=!0}catch(et){q("Failed to clear UI caches via storage helper",et)}if(!X)try{X=rr(b)}catch(et){q("Fallback UI cache clear failed",et)}const Be=(async()=>{try{return await $o(b.navigator,ce)}catch(et){return q("Service worker cleanup failed",et),!1}})(),Ue=(async()=>{try{return await ti(b.caches)}catch(et){return q("Cache clear failed",et),!1}})(),be=Ct({window:v,navigator:b.navigator,fetch:b.fetch,nextHref:P.nextHref,serviceWorkerPromise:Be,cachePromise:Ue,allowCache:!0,warmupWaitMs:typeof b.warmupWaitMs=="number"?b.warmupWaitMs:void 0}),Fe=et=>!et||typeof et!="object"?null:et.promise&&typeof et.promise.then=="function"?et.promise:et.done&&typeof et.done.then=="function"?et.done:null,bt=(et,pt)=>!pt||typeof pt.then!="function"?Promise.resolve({source:et,value:pt,successful:!0,error:null}):Promise.resolve(pt).then(dt=>({source:et,value:dt,successful:!0,error:null})).catch(dt=>({source:et,value:void 0,successful:!1,error:dt})),it=Fe(be),Kt=hn(b.navigator),Mt=Kt?bt("controllerChange",Kt.promise):null;let xr=!1;const zr=bt("serviceWorker",Be).then(et=>(!et.successful&&et.error&&!xr&&(xr=!0,q("Service worker cleanup promise rejected",et.error)),et)),Ur=it?bt("warmup",it):null,Ft=[zr];Ur&&Ft.push(Ur),Mt&&Ft.push(Mt);const Zr=Ft.length>1?Promise.race(Ft):Ft[0];let Rr=!1,fo=!1,lo=!1;try{const et=typeof b.cleanupTimeoutMs=="number"?b.cleanupTimeoutMs:we,pt=await Ot(Zr,et,()=>{q("Service worker cleanup or warmup timed out before reload, continuing anyway.",{timeoutMs:et})},dt=>{if(dt&&dt.source==="warmup"){const Do=dt.error||dt;q("Reload warmup failed after reload triggered",Do);return}const Br=dt&&dt.error?dt.error:dt;q("Service worker cleanup failed after reload triggered",Br)});if(pt&&pt.timedOut!==!0){const dt=pt.result;dt&&dt.source==="serviceWorker"?(lo=!0,dt.successful?Rr=!!dt.value:!xr&&dt.error&&(xr=!0,q("Service worker cleanup promise rejected",dt.error))):dt&&dt.source==="controllerChange"?(lo=!0,!dt.successful&&dt.error&&q("Service worker controllerchange watcher rejected",dt.error)):dt&&dt.source==="warmup"&&(fo=dt.successful&&dt.value===!0,!dt.successful&&dt.error&&q("Reload warmup promise rejected before reload triggered",dt.error))}}catch(et){const pt=et&&et.error?et.error:et;q("Reload preparation gate failed",pt)}finally{if(Kt)try{Kt.cancel()}catch{}}let Mr=!1;const co=typeof b.reloadWindow=="function"?b.reloadWindow:ka;try{Mr=co(b.window,P)}catch(et){q("Forced reload handler failed",et),Mr=ka(b.window,P)}if(!Mr&&v&&v.location&&typeof v.location.reload=="function")try{v.location.reload(),Mr=!0}catch(et){q("Final reload attempt failed",et)}let $r=!1;try{$r=await Ue}catch(et){q("Cache cleanup promise rejected",et),$r=!1}return{uiCacheCleared:X,serviceWorkersUnregistered:Rr,serviceWorkerStatusKnown:lo,warmupCompleted:fo,cachesCleared:$r,reloadTriggered:Mr,navigationTriggered:Mr}}function Ba(b){if(!b||!b.document)return!1;const{document:v}=b;return typeof v.readyState=="string"?v.readyState==="complete":!1}function ra(b="service-worker.js",v={}){const T=_t(v.window),P=_r(v.navigator);if(!P||!P.serviceWorker||typeof P.serviceWorker.register!="function")return Promise.resolve(null);const x=()=>{try{const X=P.serviceWorker.register(b,v.registrationOptions);return X.catch(ye=>{q("Service worker registration failed",ye)}),X}catch(X){return q("Service worker registration threw an exception",X),Promise.reject(X)}},_=X=>{const ye=Promise.resolve(X).finally(()=>{Pr=null});return Pr=ye,ye};if(!T||typeof T.addEventListener!="function")return x();if(Pr)return Pr;if(Ba(T)||v.immediate===!0)return _(Promise.resolve().then(()=>x()));const ce=new Promise((X,ye)=>{const Be=()=>{try{T.removeEventListener("load",Be)}catch{}try{X(x())}catch(Ue){ye(Ue)}};T.addEventListener("load",Be,{once:!0})});return _(ce)}function qo(b){const v=b||_t();!v||typeof v.addEventListener!="function"||(v.addEventListener("online",()=>{H({status:"online",source:"navigator"})}),v.addEventListener("offline",()=>{H({status:"offline",source:"navigator"})}),typeof v.navigator<"u"&&v.navigator.onLine===!1&&H({status:"offline",source:"navigator-init"}))}const Me={registerServiceWorker:ra,reloadApp:Ti,getConnectivityState(){return L},subscribeConnectivityStatus:ot,unsubscribeConnectivityStatus:at,__internal:{collectFallbackUiCacheStorages:tr,clearUiCacheEntriesFallback:rr,unregisterServiceWorkers:$o,clearCacheStorage:ti,triggerReload:ka,cleanupForceReloadArtifacts:Jn,coerceForceReloadUrlDescriptor:xo,scheduleReloadWarmup:Ct,initConnectivityListeners:qo,updateOfflineUi:ue,emitConnectivityState:H}};if(Jn(),qo(),Dt(Me),Y("cineOffline",Me),Le("cineOffline",Me,{category:"offline",description:"Offline helpers for service worker registration and cache recovery.",replace:!0,connections:["cineModuleGlobals","cineModuleEnvironment","cineEnvironmentBridge","cineModuleContext"]},b=>{q("Unable to register cineOffline in module registry.",b)}),m&&typeof m=="object"){let b=null;try{b=m.cineOffline||null}catch{b=null}b!==Me&&(or("cineOffline",Me,{configurable:!0,enumerable:!1,writable:!1})||q("Unable to expose cineOffline globally."))}typeof module<"u"&&module&&module.exports&&(module.exports=Me)})();var JC={};function ND(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}var sE=ND();function Ty(e){var t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function ew(e){return null}function lE(e){for(var t=Ty(sE),r=0;r<t.length;r+=1){var o=t[r];if(o&&typeof o[e]=="object")return o[e]}return null}var pr=(function(){return Qo&&typeof Qo=="object"?Qo:lE("cineModuleBase")})(),mr=(function(){return Xl&&typeof Xl=="object"?Xl:lE("cineModuleEnvironment")})(),sr=(function(){return bb&&typeof bb=="object"?bb:lE("cineEnvironmentBridge")})(),eo=(sr&&typeof sr.getGlobalScope=="function"?sr.getGlobalScope():null)||(mr&&typeof mr.getGlobalScope=="function"?mr.getGlobalScope():null)||(pr&&typeof pr.getGlobalScope=="function"?pr.getGlobalScope():null)||sE,bs=(function(){if(sr&&typeof sr.getPendingQueueKey=="function")try{var t=sr.getPendingQueueKey();if(typeof t=="string"&&t)return t}catch{}return mr&&typeof mr.PENDING_QUEUE_KEY=="string"&&mr.PENDING_QUEUE_KEY?mr.PENDING_QUEUE_KEY:pr&&typeof pr.PENDING_QUEUE_KEY=="string"&&pr.PENDING_QUEUE_KEY?pr.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function iO(e){var t=e||eo;if(!t||typeof t!="object")return null;var r=null;try{r=t[bs]}catch{r=null}if(Array.isArray(r))return r;try{Object.defineProperty(t,bs,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=t[bs]}catch{try{Array.isArray(t[bs])||(t[bs]=[]),r=t[bs]}catch{return null}}return r}function HD(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function jD(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(HD(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;var t="";try{t=e.constructor&&e.constructor.name}catch(o){}if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){var r=e[Symbol.toStringTag];if(typeof r=="string"&&/Stream|Port/i.test(r))return!0}}catch{}return!1}function tw(e,t){var r=t;if(!r)if(typeof WeakSet=="function")r=new WeakSet;else{var o=[];r={add:function(a){o.push(a)},has:function(a){return o.indexOf(a)!==-1}}}if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||jD(e))return e;if(typeof process<"u"&&process&&JC&&JC.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}if(e===sE||typeof globalThis<"u"&&e===globalThis||typeof window<"u"&&e===window||typeof self<"u"&&e===self||typeof global<"u"&&e===global)return e;try{if(typeof r.has=="function"&&r.has(e))return e}catch{}try{typeof r.add=="function"&&r.add(e)}catch{}try{Object.freeze(e)}catch{}return e}var sO=(function(){return sr&&typeof sr.freezeDeep=="function"?function(r,o){try{return sr.freezeDeep(r,o)}catch{return tw(r,o)}}:mr&&typeof mr.freezeDeep=="function"?mr.freezeDeep:pr&&typeof pr.freezeDeep=="function"?pr.freezeDeep:tw})();function rw(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}var cE=(function(){return sr&&typeof sr.safeWarn=="function"?function(r,o){try{sr.safeWarn(r,o)}catch{rw(r,o)}}:mr&&typeof mr.safeWarn=="function"?mr.safeWarn:pr&&typeof pr.safeWarn=="function"?pr.safeWarn:rw})();function zD(e,t,r,o){if(!r||typeof r!="object")return!1;var n={configurable:!o||o.configurable!==!1,enumerable:!!(o&&o.enumerable),value:t,writable:!!(o&&o.writable===!0)};try{return Object.defineProperty(r,e,n),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function bv(e,t,r,o){var n=r||eo;if(sr&&typeof sr.exposeGlobalScoped=="function")try{var a=sr.exposeGlobalScoped(e,t,n,o||{});if(typeof a<"u")return a}catch{}if(sr&&typeof sr.exposeGlobal=="function")try{return sr.exposeGlobal(e,t,o||{})}catch{}if(mr&&typeof mr.exposeGlobal=="function")try{return mr.exposeGlobal(e,t,n,o||{})}catch{}if(pr&&typeof pr.exposeGlobal=="function")try{return pr.exposeGlobal(e,t,n,o||{})}catch{}return zD(e,t,n,o)}var UD=(function(){return sr&&typeof sr.tryRequire=="function"?function(r){var o=sr.tryRequire(r);return typeof o>"u"?ew():o}:mr&&typeof mr.tryRequire=="function"?mr.tryRequire:pr&&typeof pr.tryRequire=="function"?pr.tryRequire:ew})();function hv(e){var t=e||eo;if(sr&&typeof sr.getModuleRegistry=="function")try{var r=sr.getModuleRegistry(t);if(r)return r}catch{}if(mr&&typeof mr.getModuleRegistry=="function")try{var o=mr.getModuleRegistry(t);if(o)return o}catch{}if(pr&&typeof pr.getModuleRegistry=="function")try{var n=pr.getModuleRegistry(t);if(n)return n}catch{}if(en&&typeof en=="object")return en;for(var a=Ty(t),i=0;i<a.length;i+=1){var s=a[i];if(s&&typeof s.cineModules=="object")return s.cineModules}return null}var ow=null,nw=!1;function mf(e){return e&&e!==eo?hv(e):(nw||(ow=hv(eo),nw=!0),ow)}function $D(e){if(!e||typeof e!="object")return{};var t={},r=[];try{r=Object.keys(e)}catch{r=[]}for(var o=0;o<r.length;o+=1){var n=r[o];try{t[n]=e[n]}catch{}}return t}function uE(e,t,r,o){if(sr&&typeof sr.queueModuleRegistration=="function")try{var n=sr.queueModuleRegistration(e,t,r);if(typeof n<"u")return n}catch{}if(mr&&typeof mr.queueModuleRegistration=="function")try{return mr.queueModuleRegistration(e,t,r,o||eo)}catch{}if(pr&&typeof pr.queueModuleRegistration=="function")try{return pr.queueModuleRegistration(e,t,r,o||eo)}catch{}var a=iO(o||eo);if(!a)return!1;var i=Object.freeze({name:e,api:t,options:Object.freeze($D(r))});try{a.push(i)}catch{a[a.length]=i}return!0}function lO(e,t,r,o,n,a){var i=n||eo,s=a||mf(i);if(pr&&typeof pr.registerOrQueueModule=="function")try{var u=pr.registerOrQueueModule(e,t,r,o,i,s);if(u)return ui(e,t),!0}catch{}if(sr&&typeof sr.registerOrQueueModule=="function")try{var l=sr.registerOrQueueModule(e,t,r,o,i,s);if(l)return ui(e,t),!0}catch{}if(mr&&typeof mr.registerOrQueueModule=="function")try{var d=mr.registerOrQueueModule(e,t,r,o,i,s);if(d)return ui(e,t),!0}catch{}if(s&&typeof s.register=="function")try{return s.register(e,t,r||{}),ui(e,t),!0}catch(g){if(typeof o=="function")try{o(g)}catch{}}var p=uE(e,t,r,i);return p&&ui(e,t),p}var Rd=Object.create(null),Zl=Object.create(null);function qD(e,t){if(Zl[e]){var r=Zl[e].slice();Zl[e].length=0;for(var o=0;o<r.length;o+=1){var n=r[o];try{n(t)}catch{}}}}function ui(e,t){return typeof e!="string"||!e||!t?!1:(Rd[e]=t,qD(e,t),!0)}function cO(e,t){if(typeof e!="string"||!e)return null;if(Object.prototype.hasOwnProperty.call(Rd,e))return Rd[e];var r=t&&t.scope?t.scope:eo;try{if(r&&typeof r=="object"&&typeof r[e]<"u")return r[e]}catch{}var o=mf(r);if(o&&typeof o.get=="function")try{var n=o.get(e);if(n)return n}catch{}return null}function VD(e,t){if(typeof e!="string"||!e||typeof t!="function")return!1;var r=cO(e);if(r){try{t(r)}catch{}return!0}return Zl[e]||(Zl[e]=[]),Zl[e].push(t),!0}function WD(){return Object.freeze(Object.keys(Rd))}function KD(){for(var e=[{name:"cineModuleBase",value:pr},{name:"cineModuleEnvironment",value:mr},{name:"cineEnvironmentBridge",value:sr},{name:"cineModules",value:mf(eo)}],t=0;t<e.length;t+=1){var r=e[t];r.value&&ui(r.name,r.value)}}KD();var im={scope:eo,moduleBase:pr,moduleEnvironment:mr,environmentBridge:sr,getModuleRegistry:mf,resolveModuleRegistry:hv,queueModuleRegistration:uE,registerOrQueueModule:lO,freezeDeep:sO,safeWarn:cE,exposeGlobal:function(t,r,o){return bv(t,r,eo,o||{})},exposeGlobalScoped:function(t,r,o,n){return bv(t,r,o||eo,n||{})},tryRequire:UD,collectCandidateScopes:function(t){var r=Ty(t||eo);return Object.freeze(r.slice())},getPendingQueueKey:function(){return bs},ensureQueue:function(t){return iO(t||eo)},recordModule:ui,getModule:cO,whenModuleAvailable:VD,listRecordedModules:WD},li=null,aw=Ty(eo);for(var hb=0;hb<aw.length;hb+=1){var Sb=aw[hb];if(Sb&&typeof Sb.cineModuleGlobals=="object"){li=Sb.cineModuleGlobals;break}}if(li&&li!==im){try{for(var iw=Object.getOwnPropertyNames(li),vb=0;vb<iw.length;vb+=1){var Ab=iw[vb];typeof im[Ab]>"u"&&(im[Ab]=li[Ab])}}catch{}if(typeof li.listRecordedModules=="function")try{var Eb=li.listRecordedModules();if(Array.isArray(Eb))for(var Cb=0;Cb<Eb.length;Cb+=1){var wb=Eb[Cb];if(!Rd[wb]&&typeof li.getModule=="function"){var sw=li.getModule(wb);sw&&ui(wb,sw)}}}catch{}}var Oy=sO(im);ui("cineModuleGlobals",Oy);var YD=lO("cineModuleGlobals",Oy,{category:"infrastructure",description:"Shared module globals for cross-script coordination.",replace:!0,connections:["cineModuleBase","cineModuleEnvironment","cineEnvironmentBridge"]},function(e){cE("Unable to register cineModuleGlobals module.",e)},eo,mf(eo));YD||uE("cineModuleGlobals",Oy,{category:"infrastructure",description:"Shared module globals for cross-script coordination.",replace:!0,connections:["cineModuleBase","cineModuleEnvironment","cineEnvironmentBridge"]},eo);var QD=bv("cineModuleGlobals",Oy,eo,{configurable:!0,enumerable:!1,writable:!1});QD||cE("Unable to expose cineModuleGlobals globally.");var lw={};const eg="__cinePendingModuleRegistrations__";function Id(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function tg(e,t){const r=[];function o(n){!n||typeof n!="object"&&typeof n!="function"||r.indexOf(n)===-1&&r.push(n)}return o(e||t),typeof globalThis<"u"&&o(globalThis),typeof window<"u"&&o(window),typeof self<"u"&&o(self),typeof global<"u"&&o(global),r}function uO(e){return null}function dE(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function fE(e,t,r){const o=e||r,n=typeof t=="string"&&t?t:eg;if(!o||typeof o!="object")return null;let a=o[n];return Array.isArray(a)?a:!dE(o,n,[])||(a=o[n],!Array.isArray(a))?null:a}function XD(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function ZD(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(XD(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const t=e[Symbol.toStringTag];if(typeof t=="string"&&/Stream|Port/i.test(t))return!0}}catch{}return!1}function JD(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function pE(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||ZD(e))return e;if(typeof process<"u"&&process&&lw&&lw.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}const r=JD(t);if(r.has(e))return e;r.add(e);const o=Object.getOwnPropertyNames(e);for(let n=0;n<o.length;n+=1){const a=o[n];let i;try{i=e[a]}catch{i=void 0}!i||typeof i=="function"||typeof i!="object"&&typeof i!="function"||pE(i,r)}try{return Object.freeze(e)}catch{return e}}function dO(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function fO(e,t,r){const o=t||{},n=typeof o.predicate=="function"?o.predicate:null,a=Array.isArray(o.scopes)?o.scopes.slice():tg(o.primaryScope||r,r);for(let i=0;i<a.length;i+=1){const s=a[i];if(!s||typeof s!="object"&&typeof s!="function")continue;if(n){try{if(n(s,e))return s}catch{}continue}const u=s[e];if(typeof u<"u")return u}return null}function e_(e,t,r,o,n,a){const s=fE(e||n,a,n);if(!s)return!1;const u=Object.freeze({name:t,api:r,options:Object.freeze({...o||{}})});try{return s.push(u),!0}catch{}try{return s[s.length]=u,!0}catch{}return!1}function t_(e){const t=e||Id();return{detectGlobalScope:Id,getGlobalScope(){return t},collectCandidateScopes(r){return tg(r||t,t)},tryRequire:uO,defineHiddenProperty:dE,ensureQueue(r,o){return fE(r||t,o,t)},freezeDeep:pE,safeWarn:dO,resolveFromScopes(r,o){return fO(r,o,t)},queueModuleRegistration(r,o,n,a){return e_(r||t,o,n,a,t,eg)},getPendingQueueKey(){return eg},resolveModuleRegistry(r){const n=tg(r||t,t);for(let a=0;a<n.length;a+=1){const i=n[a];if(i&&typeof i.cineModules=="object")return i.cineModules}return null}}}function r_(e){const t=e||Id();return t&&typeof t.cineModuleArchitectureKernel=="object"?t.cineModuleArchitectureKernel:null}const pO=Id(),o_=r_(pO),$t=o_||t_(pO);function Sv(){if($t&&typeof $t.detectGlobalScope=="function")try{const e=$t.detectGlobalScope();if(e)return e}catch{}return Id()}const Gr=$t&&typeof $t.getGlobalScope=="function"?(function(){try{const t=$t.getGlobalScope();if(t)return t}catch{}return Sv()})():Sv();let Td=$t&&typeof $t.getPendingQueueKey=="function"?$t.getPendingQueueKey():eg;function n_(e){if($t&&typeof $t.collectCandidateScopes=="function")try{const t=$t.collectCandidateScopes(e||Gr);if(Array.isArray(t)&&t.length>0)return t}catch{}return tg(e||Gr,Gr)}function gf(e){const t=n_(e||Gr);return Array.isArray(t)?t:[]}function a_(e){if($t&&typeof $t.tryRequire=="function")try{const t=$t.tryRequire(e);if(typeof t<"u")return t}catch{}return uO()}function mO(e,t,r){if($t&&typeof $t.defineHiddenProperty=="function")try{if($t.defineHiddenProperty(e,t,r))return!0}catch{}return dE(e,t,r)}function i_(e){if($t&&typeof $t.freezeDeep=="function")try{return $t.freezeDeep(e)}catch{}return pE(e)}function Zo(e,t){if($t&&typeof $t.safeWarn=="function")try{$t.safeWarn(e,t);return}catch{}dO(e,t)}function Gy(e,t){const r=t?{...t}:{};if(r.primaryScope||(r.primaryScope=Gr),r.scopes||(r.scopes=gf(r.primaryScope)),$t&&typeof $t.resolveFromScopes=="function")try{const o=$t.resolveFromScopes(e,r);if(o)return o}catch(o){Zo(`cineModuleSystem: resolveFromScopes failed for "${e}".`,o)}return fO(e,r,Gr)}let cw=null,uw=!1;function dw(e){e&&typeof e.PENDING_QUEUE_KEY=="string"&&e.PENDING_QUEUE_KEY&&(Td=e.PENDING_QUEUE_KEY)}function fw(e){const t=e||Gr;if(Qo&&typeof Qo=="object")return dw(Qo),Qo;const r=Gy("cineModuleBase",{primaryScope:t,scopes:gf(t)});return r&&typeof r=="object"?(dw(r),r):null}function ky(e){return e&&e!==Gr?fw(e):(uw||(cw=fw(Gr),uw=!0),cw)}function s_(e){const t=e||Gr;if(en&&typeof en=="object")return en;const r=Gy("cineModules",{primaryScope:t,scopes:gf(t)});return r&&typeof r=="object"?r:null}let pw=null,mw=!1;function gw(e){const t=e||Gr;if($t&&typeof $t.resolveModuleRegistry=="function")try{const o=$t.resolveModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Zo("cineModuleSystem: Kernel resolveModuleRegistry failed.",o)}const r=ky(t);if(r&&typeof r.resolveModuleRegistry=="function")try{const o=r.resolveModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Zo("cineModuleSystem: Base resolveModuleRegistry failed.",o)}return s_(t)}function mE(e){return e&&e!==Gr?gw(e):(mw||(pw=gw(Gr),mw=!0),pw)}function l_(e,t,r,o={}){const n=r||Gr;if(!n||typeof n!="object")return!1;const a={configurable:o.configurable!==!1,enumerable:!!o.enumerable,value:t,writable:o.writable===!0};try{return Object.defineProperty(n,e,a),!0}catch{}try{return n[e]=t,!0}catch{}return!1}function gO(e,t,r,o){const n=r||Gr,a=ky(n);if(a&&typeof a.exposeGlobal=="function")try{return a.exposeGlobal(e,t,n,o||{})}catch(i){Zo(`cineModuleSystem: Failed to expose "${e}" through module base.`,i)}return l_(e,t,n,o||{})}function yO(e){const t=e||Gr;if($t&&typeof $t.ensureQueue=="function")try{const r=$t.ensureQueue(t,Td);if(Array.isArray(r))return r}catch(r){Zo("cineModuleSystem: ensureQueue failed via kernel.",r)}return fE(t,Td,Gr)}function bO(e){if(typeof e=="string"&&e.trim())return e.trim();if(typeof e=="number"&&Number.isFinite(e))return String(e);throw new TypeError("cineModuleSystem expected module name to be a non-empty string.")}function hO(e,t,r,o){const n=o||Gr;if($t&&typeof $t.queueModuleRegistration=="function")try{if($t.queueModuleRegistration(n,e,t,r))return!0}catch(u){Zo("cineModuleSystem: queueModuleRegistration failed via kernel.",u)}const a=yO(n);if(!a)return Zo("cineModuleSystem: Unable to queue module registration.",{name:e}),!1;let i;try{i=bO(e)}catch(u){return Zo("cineModuleSystem: Ignoring registration with invalid name.",u),!1}const s=Object.freeze({name:i,api:t,options:Object.freeze({...r||{}})});try{a.push(s)}catch{try{a[a.length]=s}catch(l){return Zo("cineModuleSystem: Failed to record pending module registration.",l),!1}}return!0}function SO(e,t,r,o,n){const a=o||Gr,i=mE(a);if(i&&typeof i.register=="function")try{return i.register(e,t,r||{}),!0}catch(s){if(typeof n=="function")try{n(s)}catch(u){Zo("cineModuleSystem: Error handler threw while processing registration failure.",u)}else Zo(`cineModuleSystem: Unable to register module "${e}".`,s)}return hO(e,t,r,a),!1}function c_(e){const t=e||Gr,r=ky(t);if(r&&typeof r.getGlobalScope=="function")try{const o=r.getGlobalScope();if(o)return o}catch(o){Zo("cineModuleSystem: Unable to obtain global scope from module base.",o)}return t}function u_(e,t={}){const r=bO(e),o=t.scope||Gr,n=mE(o);if(n&&typeof n.get=="function")try{const u=n.get(r);if(u)return u}catch(u){Zo("cineModuleSystem: Registry lookup failed.",u)}const a=t.propertyName||r,i=Array.isArray(t.scopes)&&t.scopes.length>0?t.scopes:gf(o),s=Gy(a,{primaryScope:o,scopes:i,predicate:t.predicate});if(s)return s;if(typeof t.fallback=="function")try{return t.fallback()}catch(u){Zo("cineModuleSystem: Fallback resolver threw while resolving module.",u)}return null}function d_(e,t,r,o,n){const a=o||Gr;return SO(e,t,r,a)?gO(e,t,a,n||{}):!1}function f_(e){return yO(e||Gr)}const vO={getArchitecture(){return $t&&$t.architecture||null},detectGlobalScope:Sv,getGlobalScope:c_,collectCandidateScopes:gf,tryRequire:a_,resolveFromScopes:Gy,getModuleBase:ky,getModuleRegistry:mE,queueModuleRegistration:hO,registerModule:SO,registerAndExpose:d_,resolveModule:u_,exposeGlobal:gO,defineHiddenProperty:mO,freezeDeep:i_,safeWarn:Zo,getPendingQueue:f_,getPendingQueueKey(){return Td}};Object.defineProperty(vO,"PENDING_QUEUE_KEY",{configurable:!1,enumerable:!0,get(){return Td}});const AO=Object.freeze(vO);Gr&&typeof Gr=="object"&&!Gr.cineModuleSystem&&mO(Gr,"cineModuleSystem",AO);const Lb=AO,p_="__cinePendingModuleRegistrations__";function rg(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function og(e){const t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function m_(e){return null}function g_(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function y_(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function EO(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return e;const r=y_(t);if(r.has(e))return e;r.add(e);let o=[];try{o=Object.getOwnPropertyNames(e)}catch{}for(let n=0;n<o.length;n+=1){const a=o[n];let i;try{i=e[a]}catch{i=void 0}!i||typeof i=="function"||typeof i!="object"&&typeof i!="function"||EO(i,r)}try{try{return Object.freeze(e)}catch(n){return e}}catch{return e}}function b_(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function h_(e,t){const r=t||{},o=typeof r.predicate=="function"?r.predicate:null,n=Array.isArray(r.scopes)?r.scopes.slice():og(r.primaryScope);for(let a=0;a<n.length;a+=1){const i=n[a];if(!i||typeof i!="object"&&typeof i!="function")continue;if(o){try{if(o(i,e))return i}catch{}continue}const s=i[e];if(typeof s<"u")return s}return null}function S_(e,t){if(!e||typeof e!="object")return null;let r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r))return r;try{if(Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t],Array.isArray(r))return r}catch{}try{e[t]=[],r=e[t]}catch{return null}return Array.isArray(r)?r:null}const zc=rg();function v_(e){const t=e||zc;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}function A_(e){const t=e||zc;return t&&typeof t.cineModuleArchitectureHelpers=="object"?t.cineModuleArchitectureHelpers:null}function E_(e){const t=e||zc;return Lb&&typeof Lb=="object"?Lb:t&&typeof t.cineModuleSystem=="object"?t.cineModuleSystem:null}const gr=A_(zc);let ed=gr&&typeof gr.pendingQueueKey=="string"?gr.pendingQueueKey:p_;function sm(e){if(!(!e||typeof e!="object"&&typeof e!="function")){try{if(typeof e.getPendingQueueKey=="function"){const t=e.getPendingQueueKey();if(typeof t=="string"&&t){ed=t;return}}}catch{}typeof e.PENDING_QUEUE_KEY=="string"&&e.PENDING_QUEUE_KEY&&(ed=e.PENDING_QUEUE_KEY)}}const It=E_(zc);It&&sm(It);const Jt=(It&&typeof It.getArchitecture=="function"?It.getArchitecture():null)||v_(zc);function yw(){if(It&&typeof It.detectGlobalScope=="function"){try{const e=It.detectGlobalScope();if(e)return e}catch{}if(Jt&&typeof Jt.detectGlobalScope=="function")try{const e=Jt.detectGlobalScope();if(e)return e}catch{}return rg()}if(Jt&&typeof Jt.detectGlobalScope=="function")try{const e=Jt.detectGlobalScope();if(e)return e}catch{}return rg()}const CO=gr&&typeof gr.detectGlobalScope=="function"?function(){try{const t=gr.detectGlobalScope();if(t)return t}catch{}return yw()}:yw,on=CO();function bw(e){const t=e||on;if(It&&typeof It.collectCandidateScopes=="function"){try{const r=It.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}if(Jt&&typeof Jt.collectCandidateScopes=="function")try{const r=Jt.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return og(t)}if(Jt&&typeof Jt.collectCandidateScopes=="function")try{const r=Jt.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return og(t)}const Zs=gr&&typeof gr.collectCandidateScopes=="function"?function(t){const r=t||on;try{const o=gr.collectCandidateScopes(r);if(Array.isArray(o)&&o.length>0)return o}catch{}return bw(r)}:bw;function hw(e){if(It&&typeof It.tryRequire=="function")try{const t=It.tryRequire(e);if(typeof t<"u")return t}catch{}if(Jt&&typeof Jt.tryRequire=="function")try{const t=Jt.tryRequire(e);if(typeof t<"u")return t}catch{}return m_()}const wO=gr&&typeof gr.tryRequire=="function"?function(t){const r=gr.tryRequire(t);return typeof r>"u"?hw(t):r}:hw;function Sw(e,t,r){if(It&&typeof It.defineHiddenProperty=="function")try{if(It.defineHiddenProperty(e,t,r))return!0}catch{}if(Jt&&typeof Jt.defineHiddenProperty=="function")try{if(Jt.defineHiddenProperty(e,t,r))return!0}catch{}return g_(e,t,r)}const LO=gr&&typeof gr.defineHiddenProperty=="function"?function(t,r,o){try{if(gr.defineHiddenProperty(t,r,o))return!0}catch{}return Sw(t,r,o)}:Sw;function vw(e){if(It&&typeof It.freezeDeep=="function")try{return It.freezeDeep(e)}catch{}if(Jt&&typeof Jt.freezeDeep=="function")try{return Jt.freezeDeep(e)}catch{}return EO(e)}const vv=gr&&typeof gr.freezeDeep=="function"?function(t){try{return gr.freezeDeep(t)}catch{}return vw(t)}:vw;function Aw(e,t){if(It&&typeof It.safeWarn=="function")try{It.safeWarn(e,t);return}catch{}if(Jt&&typeof Jt.safeWarn=="function")try{Jt.safeWarn(e,t);return}catch{}b_(e,t)}const Ao=gr&&typeof gr.safeWarn=="function"?function(t,r){try{gr.safeWarn(t,r);return}catch{}Aw(t,r)}:Aw,By=It&&typeof It.resolveFromScopes=="function"?function(t,r){const o={...r||{}};return o.primaryScope||(o.primaryScope=on),o.scopes||(o.scopes=Zs(o.primaryScope)),It.resolveFromScopes(t,o)}:Jt&&typeof Jt.resolveFromScopes=="function"?function(t,r){const o={...r||{}};return o.primaryScope||(o.primaryScope=on),o.scopes||(o.scopes=Zs(o.primaryScope)),Jt.resolveFromScopes(t,o)}:function(t,r){const o={...r||{}};return o.primaryScope||(o.primaryScope=on),o.scopes||(o.scopes=og(o.primaryScope)),h_(t,o)};function Py(e){const t=e||on;if(It&&typeof It.getModuleBase=="function")try{const o=It.getModuleBase(t);if(o&&typeof o=="object")return sm(o),o}catch(o){Ao("cineModuleContext: Unable to resolve module base through module system.",o)}if(Qo&&typeof Qo=="object")return sm(Qo),Qo;const r=By("cineModuleBase",{primaryScope:t,scopes:Zs(t)});return r&&typeof r=="object"?(sm(r),r):null}function gE(e){const t=e||on;if(gr&&typeof gr.ensureQueue=="function")try{const r=gr.ensureQueue(t,ed);if(Array.isArray(r))return r}catch(r){Ao("cineModuleContext: Unable to access pending queue via architecture helpers.",r)}if(It&&typeof It.getPendingQueue=="function")try{const r=It.getPendingQueue(t);if(Array.isArray(r))return r}catch(r){Ao("cineModuleContext: Unable to access pending queue via module system.",r)}if(Jt&&typeof Jt.ensureQueue=="function")try{const r=Jt.ensureQueue(t,ed);if(Array.isArray(r))return r}catch(r){Ao("cineModuleContext: Unable to access pending queue via architecture.",r)}return S_(t,ed)}function yE(e,t,r,o){const n=o||on;if(gr&&typeof gr.queueModuleRegistration=="function")try{if(gr.queueModuleRegistration(n,e,t,r))return!0}catch(s){Ao("cineModuleContext: Architecture helpers queueModuleRegistration failed.",s)}const a=gE(n);if(!a)return!1;const i=Object.freeze({name:e,api:t,options:Object.freeze({...r||{}})});try{a.push(i)}catch{a[a.length]=i}return!0}function bE(e){const t=e||on;if(gr&&typeof gr.resolveModuleRegistry=="function")try{const n=gr.resolveModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Ao("cineModuleContext: Architecture helpers resolveModuleRegistry failed.",n)}if(It&&typeof It.getModuleRegistry=="function")try{const n=It.getModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Ao("cineModuleContext: Unable to resolve module registry via module system.",n)}const r=Py(t);if(r&&typeof r=="object"){if(typeof r.getModuleRegistry=="function")try{const n=r.getModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Ao("cineModuleContext: Module base getModuleRegistry failed.",n)}if(typeof r.resolveModuleRegistry=="function")try{const n=r.resolveModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Ao("cineModuleContext: Module base resolveModuleRegistry failed.",n)}}if(en&&typeof en=="object")return en;const o=By("cineModules",{primaryScope:t,scopes:Zs(t)});return o&&typeof o=="object"?o:null}function hE(e,t,r,o){const n=o||on;if(It&&typeof It.registerModule=="function")try{if(It.registerModule(e,t,r||{},n))return!0}catch(s){Ao("cineModuleContext: Module system failed to register module.",s)}const a=bE(n),i=Py(n);if(i&&typeof i.registerOrQueueModule=="function")try{if(i.registerOrQueueModule(e,t,r||{},u=>{Ao("cineModuleContext: Module base failed to register module.",u)},n,a))return!0}catch(s){Ao("cineModuleContext: Module base threw while registering module.",s)}if(a&&typeof a.register=="function")try{return a.register(e,t,r||{}),!0}catch(s){Ao("cineModuleContext: Registry registration failed.",s)}return yE(e,t,r,n)}function SE(e,t,r,o={}){const n=r||on;if(!n||typeof n!="object")return!1;if(It&&typeof It.exposeGlobal=="function")try{return It.exposeGlobal(e,t,n,o||{})}catch(i){Ao("cineModuleContext: Module system failed to expose global.",i)}const a={configurable:o.configurable!==!1,enumerable:!!o.enumerable,value:t,writable:o.writable===!0};try{return Object.defineProperty(n,e,a),!0}catch{}try{return n[e]=t,!0}catch{}return!1}function C_(e={}){const t=e.scope||on,r=Py(t),o=bE(t);return Object.freeze({getArchitecture(){return Jt||null},getSystem(){return It||null},getScope(){return t},detectGlobalScope(a){const i=a||t;try{if(It&&typeof It.detectGlobalScope=="function"){const s=It.detectGlobalScope(i);if(s)return s}}catch(s){Ao("cineModuleContext: detectGlobalScope via system failed.",s)}if(Jt&&typeof Jt.detectGlobalScope=="function")try{const s=Jt.detectGlobalScope(i);if(s)return s}catch(s){Ao("cineModuleContext: detectGlobalScope via architecture failed.",s)}return rg()},collectCandidateScopes(a){return Zs(a||t)},tryRequire(a){return wO(a)},resolveFromScopes(a,i){const s={...i||{}};return s.primaryScope||(s.primaryScope=t),s.scopes||(s.scopes=Zs(s.primaryScope)),By(a,s)},defineHiddenProperty(a,i,s){return LO(a,i,s)},freezeDeep(a){return vv(a)},safeWarn(a,i){Ao(a,i)},ensureQueue(a){return gE(a||t)},getModuleBase(){return r},getModuleRegistry(){return o},queueModuleRegistration(a,i,s,u){return yE(a,i,s,u||t)},registerModule(a,i,s,u){return hE(a,i,s,u||t)},exposeGlobal(a,i,s,u){return SE(a,i,s||t,u||{})}})}const RO=vv({getArchitecture(){return Jt},getModuleSystem(){return It},detectGlobalScope:CO,collectCandidateScopes:Zs,tryRequire:wO,resolveFromScopes:By,defineHiddenProperty:LO,freezeDeep:vv,safeWarn:Ao,ensureQueue:gE,resolveModuleBase:Py,resolveModuleRegistry:bE,queueModuleRegistration:yE,registerOrQueue:hE,exposeGlobal:SE,createModuleContext:C_,getPrimaryScope(){return on}});hE("cineModuleContext",RO,{category:"infrastructure",description:"Shared context helpers that unify architecture, system and registry lookups.",freeze:!1,connections:["cineModuleBase","cineModuleGlobals","cineModuleEnvironment","cineModuleArchitectureKernel"]},on);SE("cineModuleContext",RO,on,{configurable:!0,enumerable:!1,writable:!1});const xy="__cinePendingModuleRegistrations__";function vE(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const yf=vE();function w_(e){const t=[],r=e||yf;r&&typeof r=="object"&&t.push(r),typeof globalThis<"u"&&t.indexOf(globalThis)===-1&&t.push(globalThis),typeof window<"u"&&t.indexOf(window)===-1&&t.push(window),typeof self<"u"&&t.indexOf(self)===-1&&t.push(self),typeof global<"u"&&t.indexOf(global)===-1&&t.push(global);for(let o=0;o<t.length;o+=1){const n=t[o];if(n&&typeof n.cineModuleArchitectureCore=="object")return n.cineModuleArchitectureCore}return null}function L_(e){const t=e||yf;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}const Dr=L_(yf),lm=w_(yf),jr=lm&&typeof lm.createCore=="function"?lm.createCore({primaryScope:yf,pendingQueueKey:xy}):null;function IO(e){const t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function Ew(){if(jr&&typeof jr.detectGlobalScope=="function")try{const e=jr.detectGlobalScope();if(e)return e}catch{}if(Dr&&typeof Dr.detectGlobalScope=="function")try{const e=Dr.detectGlobalScope();if(e)return e}catch{}return vE()}const TO=Dr&&typeof Dr.detectGlobalScope=="function"?function(){try{const t=Dr.detectGlobalScope();if(t)return t}catch{}return Ew()}:Ew,Ho=TO();function R_(e){const t=e||Ho;if(jr&&typeof jr.collectCandidateScopes=="function")try{const r=jr.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}if(Dr&&typeof Dr.collectCandidateScopes=="function")try{const r=Dr.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return IO(t)}const AE=function(t){const r=t||Ho,o=R_(r);return Array.isArray(o)&&o.length>0?o:IO(r)};function I_(e){return null}function EE(e){if(jr&&typeof jr.tryRequire=="function")try{const t=jr.tryRequire(e);if(typeof t<"u")return t}catch{}if(Dr&&typeof Dr.tryRequire=="function")try{const t=Dr.tryRequire(e);if(typeof t<"u")return t}catch{}return I_()}function OO(e){const t=e||Ho;if(jr&&typeof jr.resolveImmutability=="function")try{const n=jr.resolveImmutability(t);if(n&&typeof n=="object")return n}catch{}if(Dr&&typeof Dr.tryRequire=="function")try{const n=Dr.tryRequire("./immutability.js");if(n&&typeof n=="object")return n}catch{}const r=EE("./immutability.js");if(r&&typeof r=="object")return r;const o=AE(t);for(let n=0;n<o.length;n+=1){const a=o[n];if(a&&typeof a.cineModuleImmutability=="object")return a.cineModuleImmutability}return null}function T_(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function CE(e,t,r){if(jr&&typeof jr.defineHiddenProperty=="function")try{if(jr.defineHiddenProperty(e,t,r))return!0}catch{}if(Dr&&typeof Dr.defineHiddenProperty=="function")try{if(Dr.defineHiddenProperty(e,t,r))return!0}catch{}return T_(e,t,r)}function O_(e,t){if(!e||typeof e!="object")return null;let r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r)||CE(e,t,[])&&(r=e[t],Array.isArray(r)))return r;try{e[t]=[],r=e[t]}catch{return null}return Array.isArray(r)?r:null}function GO(e,t){const r=typeof t=="string"&&t?t:xy,o=e||Ho;if(jr&&typeof jr.ensureQueue=="function")try{const n=jr.ensureQueue(o,r);if(Array.isArray(n))return n}catch{}if(Dr&&typeof Dr.ensureQueue=="function")try{const n=Dr.ensureQueue(o,r);if(Array.isArray(n))return n}catch{}return O_(o,r)}function G_(){function e(r){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return!1;try{if(typeof r.pipe=="function"&&typeof r.unpipe=="function")return!0;if(typeof r.on=="function"&&typeof r.emit=="function"){if(typeof r.write=="function"||typeof r.read=="function")return!0;const o=r.constructor&&r.constructor.name;if(o&&/Stream|Emitter|Port/i.test(o))return!0}if(typeof Symbol<"u"&&r[Symbol.toStringTag]){const o=r[Symbol.toStringTag];if(typeof o=="string"&&/Stream|Port/i.test(o))return!0}}catch{}return!1}function t(r,o=new WeakSet){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function"||e(r)||o.has(r))return r;o.add(r);const n=Object.getOwnPropertyNames(r);for(let a=0;a<n.length;a+=1){const i=n[a];let s;try{s=r[i]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||t(s,o)}try{return Object.freeze(r)}catch(a){return console.warn("fallbackCreateImmutability (helpers): Object.freeze failed",a),r}}return{shouldBypassDeepFreeze:e,freezeDeep:t}}const wE=G_();let Xc=OO(Ho)||wE;function k_(){if(Xc!==wE)return Xc;const e=OO(Ho);return e&&e!==Xc&&(Xc=e),Xc}function Av(e){if(jr&&typeof jr.freezeDeep=="function")try{return jr.freezeDeep(e)}catch{}const t=k_();try{return t.freezeDeep(e)}catch{}return wE.freezeDeep(e)}function B_(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function kO(e,t){if(jr&&typeof jr.safeWarn=="function")try{jr.safeWarn(e,t);return}catch{}if(Dr&&typeof Dr.safeWarn=="function")try{Dr.safeWarn(e,t);return}catch{}B_(e,t)}function BO(e){const t=e||Ho,r=EE("./registry.js");if(r&&typeof r=="object")return r;const o=AE(t);for(let n=0;n<o.length;n+=1){const a=o[n];if(a&&typeof a.cineModules=="object")return a.cineModules}return null}function Ev(e,t,r,o){const a=GO(e||Ho,xy);if(!a)return!1;const i=Av({name:t,api:r,options:Object.freeze({...o||{}})});try{a.push(i)}catch{a[a.length]=i}return!0}const cm=Av({architecture:Dr,architectureCore:lm,detectGlobalScope:TO,getPrimaryScope(){return Ho},collectCandidateScopes:AE,tryRequire:EE,defineHiddenProperty:CE,ensureQueue:GO,freezeDeep:Av,safeWarn:kO,resolveModuleRegistry:BO,queueModuleRegistration:Ev,pendingQueueKey:xy,fallbackDetectGlobalScope:vE}),Rb=BO(Ho),Ib={category:"infrastructure",description:"Shared architecture helpers for scope detection, registry resolution and queue management.",replace:!0,connections:["cineModuleArchitectureKernel","cineModuleArchitectureCore"]};if(Rb&&typeof Rb.register=="function")try{Rb.register("cineModuleArchitectureHelpers",cm,Ib)}catch(e){kO("cineModuleArchitectureHelpers: immediate registry registration failed.",e),Ev(Ho,"cineModuleArchitectureHelpers",cm,Ib)}else Ev(Ho,"cineModuleArchitectureHelpers",cm,Ib);Ho&&typeof Ho=="object"&&!Ho.cineModuleArchitectureHelpers&&CE(Ho,"cineModuleArchitectureHelpers",cm);const LE="__cinePendingModuleRegistrations__";function Js(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function P_(e){return null}function x_(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function PO(e,t,r){const o=typeof r=="function"?r:Js,n=Array.isArray(t)?t:null,a=MO(o,n);if(a)return a(e);const i=[];function s(u){!u||typeof u!="object"&&typeof u!="function"||i.indexOf(u)===-1&&i.push(u)}e&&s(e);try{s(o())}catch{}if(Array.isArray(n))for(let u=0;u<n.length;u+=1)s(n[u]);return typeof globalThis<"u"&&s(globalThis),typeof window<"u"&&s(window),typeof self<"u"&&s(self),typeof global<"u"&&s(global),s(Js()),i}function M_(e,t){const r=t||{},o=typeof r.predicate=="function"?r.predicate:null,n=Array.isArray(r.scopes)?r.scopes.slice():[],a=typeof r.detect=="function"?r.detect:Js,i=Array.isArray(r.additionalScopes)?r.additionalScopes:void 0,s=r.primaryScope,u=PO(s,i,a);for(let l=0;l<u.length;l+=1)n.indexOf(u[l])===-1&&n.push(u[l]);for(let l=0;l<n.length;l+=1){const d=n[l];if(!(!d||typeof d!="object"&&typeof d!="function")){if(o)try{if(o(d,e))return d}catch{}try{if(e in d)return d}catch{}}}return null}const My=Js();function D_(e){const t=e||My;if(ub&&typeof ub=="object")return ub;const r=[];function o(n){!n||typeof n!="object"&&typeof n!="function"||r.indexOf(n)===-1&&r.push(n)}o(t),typeof globalThis<"u"&&o(globalThis),typeof window<"u"&&o(window),typeof self<"u"&&o(self),typeof global<"u"&&o(global);for(let n=0;n<r.length;n+=1){const a=r[n];try{const i=a&&a.cineScopeUtils;if(i&&typeof i=="object")return i}catch{}}return null}const nn=D_(My),Uc=nn&&typeof nn.detectGlobalScope=="function"?function(){try{return nn.detectGlobalScope()}catch{}return Js()}:Js,Cv=nn&&typeof nn.tryRequire=="function"?nn.tryRequire:P_,RE=nn&&typeof nn.defineHiddenProperty=="function"?nn.defineHiddenProperty:x_,IE=nn&&typeof nn.collectCandidateScopes=="function"?function(t,r,o){const n=typeof o=="function"?o:Uc;return nn.collectCandidateScopes(t,r,n)}:PO,xO=nn&&typeof nn.resolveFromScopes=="function"?function(t,r){const o=r?TE(r):{};return o.primaryScope||(o.primaryScope=My),o.detect||(o.detect=Uc),nn.resolveFromScopes(t,o)||null}:M_;function __(){if(db&&typeof db=="function")return{createCollector:db};const e=IE(My,null,Uc);for(let t=0;t<e.length;t+=1){const r=e[t];try{const o=r&&r.__cineScopeCollector;if(o&&typeof o.createCollector=="function")return o}catch{}}return null}const Tb=__(),Cw=Tb&&typeof Tb.createCollector=="function"?Tb.createCollector:null,F_={key:"defaultExtras"},Ob=[];function MO(e,t){if(!Cw)return null;const r=Array.isArray(t)?t:F_;for(let n=0;n<Ob.length;n+=1){const a=Ob[n];if(a.detect===e&&a.extras===r)return a.collector}const o=Cw({detectGlobalScope:e,additionalScopes:Array.isArray(t)?t:void 0});return o?(Ob.push({detect:e,extras:r,collector:o}),o):null}function TE(e){if(!e||typeof e!="object")return{};const t={},r=Object.keys(e);for(let o=0;o<r.length;o+=1){const n=r[o];t[n]=e[n]}return t}function N_(){function e(r){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return!1;try{if(typeof r.pipe=="function"&&typeof r.unpipe=="function")return!0;if(typeof r.on=="function"&&typeof r.emit=="function"){if(typeof r.write=="function"||typeof r.read=="function")return!0;const o=r.constructor&&r.constructor.name;if(o&&/Stream|Emitter|Port/i.test(o))return!0}if(typeof Symbol<"u"&&r[Symbol.toStringTag]){const o=r[Symbol.toStringTag];if(typeof o=="string"&&/Stream|Port/i.test(o))return!0}}catch{}return!1}function t(r,o=new WeakSet){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return r;if(e(r))return process.stdout.write(`architecture.js bypassed freeze for value: ${typeof r}
`),r;if(o.has(r))return r;o.add(r);const n=Object.getOwnPropertyNames(r);for(let a=0;a<n.length;a+=1){const i=n[a];let s;try{s=r[i]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||t(s,o)}try{return Object.freeze(r)}catch{return r}}return{shouldBypassDeepFreeze:e,freezeDeep:t}}const um=N_();function DO(e,t){if(!e||typeof e!="object")return null;const r=typeof t=="string"&&t?t:LE;let o=e[r];if(Array.isArray(o)||RE(e,r,[])&&(o=e[r],Array.isArray(o)))return o;try{if(e[r]=[],o=e[r],Array.isArray(o))return o}catch{}return null}function OE(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function H_(e){const t=IE(e,null,Uc);for(let r=0;r<t.length;r+=1){const o=t[r];if(o&&typeof o.cineModuleArchitectureCore=="object")return o.cineModuleArchitectureCore}return null}function _O(e){const t=e||{},r=t&&(t.primaryScope||t.scope)&&(typeof t.primaryScope=="object"||typeof t.primaryScope=="function"?t.primaryScope:typeof t.scope=="object"||typeof t.scope=="function"?t.scope:null),o=typeof t.detectGlobalScope=="function"?t.detectGlobalScope:null,n=typeof t.resolveFromScopes=="function"?t.resolveFromScopes:null,a=typeof t.freezeDeep=="function"?t.freezeDeep:null,i=typeof t.safeWarn=="function"?t.safeWarn:null,s=typeof t.tryRequire=="function"?t.tryRequire:null,u=Array.isArray(t.additionalScopes)?t.additionalScopes.filter(function(j){return j&&(typeof j=="object"||typeof j=="function")}):[],l=typeof t.pendingQueueKey=="string"&&t.pendingQueueKey?t.pendingQueueKey:LE;let d=null;function p(){try{if(o){const j=o();if(j)return d=j,j}}catch{}if(d)return d;const G=r||Uc();return d=G,G}function g(){return p()}function h(G){const j=G||r,$=MO(p,u);if($)return $(j);const z=[];function te(oe){!oe||typeof oe!="object"&&typeof oe!="function"||z.indexOf(oe)===-1&&z.push(oe)}te(j),te(p()),typeof globalThis<"u"&&te(globalThis),typeof window<"u"&&te(window),typeof self<"u"&&te(self),typeof global<"u"&&te(global);for(let oe=0;oe<u.length;oe+=1)te(u[oe]);return z}const A=s?function(j){try{return s(j)}catch{}return Cv(j)}:Cv;let m=null;function y(G){try{const $=A("./immutability.js");if($&&typeof $=="object")return m=$,$}catch{}const j=h(G);for(let $=0;$<j.length;$+=1){const z=j[$];if(z&&typeof z.cineModuleImmutability=="object")return m=z.cineModuleImmutability,m}return null}function S(G){if(m&&m!==um)return m;const j=y(g());return j&&j!==m?(m=j,j):(m=um,m)}function E(G,j){if(a)try{return a(G,j)}catch{}const $=S();try{return $.freezeDeep(G,j)}catch{}return um.freezeDeep(G,j)}function I(G,j){const $=typeof j=="string"&&j?j:l;return DO(G||g(),$)}function L(G,j){if(n)try{return n(G,j)}catch{}const $=TE(j);return $.scopes||($.scopes=h($.primaryScope)),xO(G,$)}function R(G,j){if(i)try{i(G,j);return}catch{}OE(G,j)}return Object.freeze({detectGlobalScope:p,getPrimaryScope:g,collectCandidateScopes:h,tryRequire:A,resolveFromScopes:L,defineHiddenProperty:RE,ensureQueue:I,freezeDeep:E,safeWarn:R})}const Gb=H_(Uc()),kb=Gb&&typeof Gb.createCore=="function"?Gb.createCore:_O;function j_(e){const t=_O(e);if(!kb||typeof kb!="function")return{primary:t,fallback:t};try{const r=kb(e||{});if(r&&typeof r=="object")return{primary:r,fallback:t}}catch(r){OE("cineModuleArchitecture: core factory failed; using fallback core.",r)}return{primary:t,fallback:t}}function ww(e,t,r,o,n){const a=e&&typeof e[r]=="function"?e[r]:null,i=t&&typeof t[r]=="function"?t[r]:null,s=typeof o=="function"?o:null,u=l=>!l||typeof l.message!="string"?!1:!!(l.message.includes("trap returned extra keys but proxy target is non-extensible")||l.message.includes("Cannot freeze"));return function(){const d=arguments;if(a)try{return a.apply(e,d)}catch(p){if(typeof n=="function")try{u(p)||n("cineModuleArchitecture."+r+": primary implementation failed, using fallback.",p)}catch{}}if(i)return i.apply(t,d);if(s)return s.apply(null,d)}}function FO(e){const t=j_(e||{}),r=t.primary,o=t.fallback,n=ww(r,o,"safeWarn",OE,null);function a(A,m){return ww(r,o,A,m,n)}const i=a("detectGlobalScope",Js),s=a("getPrimaryScope",function(){return i()}),u=a("collectCandidateScopes",function(m){const y=m||s();return IE(y)}),l=a("tryRequire",Cv),d=a("resolveFromScopes",function(m,y){const S=TE(y);return S.scopes||(S.scopes=u(S.primaryScope)),xO(m,S)}),p=a("defineHiddenProperty",RE),g=a("ensureQueue",function(m,y){const S=m||s();return DO(S,y)}),h=a("freezeDeep",function(m,y){return um.freezeDeep(m,y)});return Object.freeze({detectGlobalScope:i,getPrimaryScope:s,collectCandidateScopes:u,tryRequire:l,resolveFromScopes:d,defineHiddenProperty:p,ensureQueue:g,freezeDeep:h,safeWarn:n})}const Yo=FO({}),GE=Object.freeze({detectGlobalScope:Yo.detectGlobalScope,collectCandidateScopes:Yo.collectCandidateScopes,tryRequire:Yo.tryRequire,resolveFromScopes:Yo.resolveFromScopes,defineHiddenProperty:Yo.defineHiddenProperty,ensureQueue:Yo.ensureQueue,freezeDeep:Yo.freezeDeep,safeWarn:Yo.safeWarn});function NO(e){const t=e||{},r=t&&(t.primaryScope||t.scope)&&(typeof t.primaryScope=="object"||typeof t.primaryScope=="function"?t.primaryScope:typeof t.scope=="object"||typeof t.scope=="function"?t.scope:null),o=typeof t.detectGlobalScope=="function"?t.detectGlobalScope:function(){return r||Yo.detectGlobalScope()},n=Array.isArray(t.additionalScopes)?t.additionalScopes.filter(function(g){return g&&(typeof g=="object"||typeof g=="function")}):[],a=typeof t.tryRequire=="function"?t.tryRequire:Yo.tryRequire,i=typeof t.resolveFromScopes=="function"?t.resolveFromScopes:null,s=typeof t.pendingQueueKey=="string"&&t.pendingQueueKey?t.pendingQueueKey:LE,u=typeof t.freezeDeep=="function"?t.freezeDeep:Yo.freezeDeep,l=typeof t.safeWarn=="function"?t.safeWarn:Yo.safeWarn,d=FO({primaryScope:r,detectGlobalScope:o,additionalScopes:n,tryRequire:a,resolveFromScopes:i,pendingQueueKey:s,freezeDeep:u,safeWarn:l});return Object.freeze({detectGlobalScope:d.detectGlobalScope,collectCandidateScopes:d.collectCandidateScopes,tryRequire:d.tryRequire,resolveFromScopes:d.resolveFromScopes,defineHiddenProperty:d.defineHiddenProperty,ensureQueue:d.ensureQueue,freezeDeep:d.freezeDeep,safeWarn:d.safeWarn})}const z_=Object.freeze({...GE,createModuleArchitecture:NO}),qi=Yo.getPrimaryScope?Yo.getPrimaryScope():Yo.detectGlobalScope();qi&&typeof qi=="object"&&!qi.cineModuleArchitecture&&GE.defineHiddenProperty(qi,"cineModuleArchitecture",z_);qi&&typeof qi=="object"&&!qi.cineModuleArchitectureFactory&&GE.defineHiddenProperty(qi,"cineModuleArchitectureFactory",Object.freeze({createModuleArchitecture:NO}));var Lw={};(function(){const e=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};function t(){return typeof e<"u"?e:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function r(){if(typeof require=="function")try{const W=require("./runtime-environment-helpers.js");if(W&&typeof W=="object")return W}catch{}const O=[];function U(W){!W||typeof W!="object"&&typeof W!="function"||O.indexOf(W)===-1&&O.push(W)}const F=t();U(F),typeof e<"u"&&U(e),typeof window<"u"&&U(window),typeof self<"u"&&U(self),typeof global<"u"&&U(global);for(let W=0;W<O.length;W+=1){const se=O[W];try{const me=se&&se.cineRuntimeEnvironmentHelpers;if(me&&typeof me=="object")return me}catch{}}return null}const o=r();function n(O,U,F){if(o&&O&&typeof o[O]=="function")try{const W=o[O].apply(o,Array.isArray(U)?U:[]);if(typeof W<"u")return W}catch{}if(typeof F=="function")return F()}function a(){if(o&&typeof o.fallbackDetectGlobalScope=="function")try{const O=o.fallbackDetectGlobalScope();if(O)return O}catch{}return typeof e<"u"?e:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function i(O){if(o&&typeof o.fallbackCollectCandidateScopes=="function")try{const W=o.fallbackCollectCandidateScopes(O);if(Array.isArray(W))return W}catch{}const U=[];function F(W){!W||typeof W!="object"&&typeof W!="function"||U.indexOf(W)===-1&&U.push(W)}return F(O),typeof e<"u"&&F(e),typeof window<"u"&&F(window),typeof self<"u"&&F(self),typeof global<"u"&&F(global),U}function s(O){return n("fallbackLoadModuleEnvironment",[O],function(){const F=d("./environment.js");if(F&&typeof F=="object")return F;const W=i(O);for(let se=0;se<W.length;se+=1){const me=W[se];if(me&&typeof me.cineModuleEnvironment=="object")return me.cineModuleEnvironment}return null})}function u(O){return n("fallbackLoadEnvironmentBridge",[O],function(){const F=d("./environment-bridge.js");if(F&&typeof F=="object")return F;const W=i(O);for(let se=0;se<W.length;se+=1){const me=W[se];if(me&&typeof me.cineEnvironmentBridge=="object")return me.cineEnvironmentBridge}return null})}function l(O){return n("fallbackResolveModuleGlobals",[O],function(){const F=d("./globals.js");if(F&&typeof F=="object")return F;const W=i(O);for(let se=0;se<W.length;se+=1){const me=W[se];if(me&&typeof me.cineModuleGlobals=="object")return me.cineModuleGlobals}return null})}function d(O){return n("fallbackTryRequire",[O],function(){if(typeof require!="function")return null;try{return require(O)}catch{return null}})}function p(O){return n("resolveModuleLinker",[O],function(){const F=d("./helpers/module-linker.js");if(F&&typeof F=="object")return F;const W=i(O);for(let se=0;se<W.length;se+=1){const me=W[se];try{const Re=me&&me.cineModuleLinker;if(Re&&typeof Re=="object")return Re}catch{}}return null})}const g=a(),h=p(g);function A(O){return n("resolveModuleSystem",[O],function(){const F=O||g,W=d("./system.js");return W&&typeof W=="object"?W:F&&typeof F.cineModuleSystem=="object"?F.cineModuleSystem:null})}const m=A(g);function y(O){return n("resolveEnvironmentContext",[O||g],function(){const F=O||g,W=d("./environment-context.js");return W&&typeof W=="object"?W:F&&typeof F.cineModuleEnvironmentContext=="object"?F.cineModuleEnvironmentContext:null})}const S=y(g);function E(){if(S&&typeof S.detectGlobalScope=="function")try{const O=S.detectGlobalScope();if(O)return O}catch{}return a()}const I=m&&typeof m.detectGlobalScope=="function"?function(){try{const U=m.detectGlobalScope();if(U)return U}catch{}return E()}:E,L=(S&&typeof S.getPrimaryScope=="function"?S.getPrimaryScope():null)||I(),R=(function(){if(m&&typeof m.getGlobalScope=="function")try{const U=m.getGlobalScope(L);if(U)return U}catch{}if(S&&typeof S.getGlobalScope=="function")try{const U=S.getGlobalScope(L);if(U)return U}catch{}return L})(),G=typeof WeakMap=="function"?new WeakMap:null;function j(O){const U=O||R,F=!!G&&U&&(typeof U=="object"||typeof U=="function");if(F)try{const me=G.get(U);if(me&&Array.isArray(me)&&me.length>0)return me.slice()}catch{}if(m&&typeof m.collectCandidateScopes=="function")try{const me=m.collectCandidateScopes(U);if(Array.isArray(me)&&me.length>0){const Re=me.slice();if(F)try{const De=typeof Object.freeze=="function"?Object.freeze(Re.slice()):Re.slice();G.set(U,De)}catch(De){}return Re}}catch{}if(S&&typeof S.collectCandidateScopes=="function")try{const me=S.collectCandidateScopes(U);if(Array.isArray(me)&&me.length>0){const Re=me.slice();if(F)try{const De=typeof Object.freeze=="function"?Object.freeze(Re.slice()):Re.slice();G.set(U,De)}catch(De){}return Re}}catch{}const W=i(U),se=Array.isArray(W)?W.slice():[];if(F&&se.length>0)try{const me=typeof Object.freeze=="function"?Object.freeze(se.slice()):se.slice();G.set(U,me)}catch{}return se}const $=(h&&typeof h.getModuleEnvironment=="function"?h.getModuleEnvironment():null)||(S&&typeof S.resolveModuleEnvironment=="function"?S.resolveModuleEnvironment(R):null)||s(R),z=(h&&typeof h.getEnvironmentBridge=="function"?h.getEnvironmentBridge():null)||(S&&typeof S.resolveEnvironmentBridge=="function"?S.resolveEnvironmentBridge(R):null)||u(R),te=(h&&typeof h.getModuleGlobals=="function"?h.getModuleGlobals():null)||(S&&typeof S.resolveModuleGlobals=="function"?S.resolveModuleGlobals(R):null)||l(R);function oe(O,U){if(h&&typeof h.recordModule=="function"&&h.recordModule(O,U),!(!te||typeof te.recordModule!="function"))try{te.recordModule(O,U)}catch{}}const k=(function(){return h&&typeof h.tryRequire=="function"?h.tryRequire:m&&typeof m.tryRequire=="function"?function(F){const W=m.tryRequire(F);return typeof W>"u"?d(F):W}:S&&typeof S.tryRequire=="function"?function(F){const W=S.tryRequire(F);return typeof W>"u"?d(F):W}:te&&typeof te.tryRequire=="function"?te.tryRequire:z&&typeof z.tryRequire=="function"?function(F){const W=z.tryRequire(F);return typeof W>"u"?d(F):W}:$&&typeof $.tryRequire=="function"?$.tryRequire:d})();function Z(O){const U=O||R;if(h&&typeof h.getModuleRegistry=="function"){const se=h.getModuleRegistry(U);if(se)return se}if(te&&typeof te.resolveModuleRegistry=="function")try{const se=te.resolveModuleRegistry(U);if(se)return se}catch{}if(z&&typeof z.getModuleRegistry=="function")try{const se=z.getModuleRegistry(U);if(se)return se}catch{}if($&&typeof $.resolveModuleRegistry=="function")try{return $.resolveModuleRegistry(U)}catch{}const F=k("./registry.js");if(F&&typeof F=="object")return F;const W=j(U);for(let se=0;se<W.length;se+=1){const me=W[se];if(me&&typeof me.cineModules=="object")return me.cineModules}return null}function ue(O){const U=R;if(m&&typeof m.getModuleRegistry=="function")try{const F=m.getModuleRegistry(U);if(F)return F}catch{}if(S&&typeof S.resolveModuleRegistry=="function")try{const F=S.resolveModuleRegistry(U);if(F)return F}catch{}return Z(U)}const H=(function(){if(h&&typeof h.getModuleRegistry=="function"){const O=h.getModuleRegistry(R);if(O)return O}if(m&&typeof m.getModuleRegistry=="function")try{const O=m.getModuleRegistry(R);if(O)return O}catch{}if(te&&typeof te.getModuleRegistry=="function")try{const O=te.getModuleRegistry(R);if(O)return O}catch{}if(z&&typeof z.getModuleRegistry=="function")try{const O=z.getModuleRegistry(R);if(O)return O}catch{}if($&&typeof $.getModuleRegistry=="function")try{const O=$.getModuleRegistry(R);if(O)return O}catch{}return ue()})(),Y=(function(){if(h&&typeof h.getPendingQueueKey=="function"){const U=h.getPendingQueueKey();if(typeof U=="string"&&U)return U}if(m&&typeof m.getPendingQueueKey=="function")try{const U=m.getPendingQueueKey();if(typeof U=="string"&&U)return U}catch{}if(te&&typeof te.getPendingQueueKey=="function")try{const U=te.getPendingQueueKey();if(typeof U=="string"&&U)return U}catch{}if(z&&typeof z.getPendingQueueKey=="function")try{const U=z.getPendingQueueKey();if(typeof U=="string"&&U)return U}catch{}return $&&typeof $.PENDING_QUEUE_KEY=="string"?$.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function N(O){if(!O||typeof O!="object")return{};const U={},F=Object.keys(O);for(let W=0;W<F.length;W+=1){const se=F[W];U[se]=O[se]}return U}function ae(O){return typeof O=="string"?O:""}function de(O,U){if(!Array.isArray(O)||!U)return;let F=0;for(let W=0;W<O.length;W+=1){const se=O[W];(se&&typeof se.name=="string"?se.name:"")!==U&&(O[F]=se,F+=1)}F<O.length&&(O.length=F)}function Q(O,U,F){const W=ae(O);if(m&&typeof m.queueModuleRegistration=="function")try{if(m.queueModuleRegistration(W||O,U,F,R))return!0}catch{}if(te&&typeof te.queueModuleRegistration=="function")try{if(te.queueModuleRegistration(W||O,U,F,R))return!0}catch{}if(z&&typeof z.queueModuleRegistration=="function")try{if(z.queueModuleRegistration(W||O,U,F))return!0}catch{}if($&&typeof $.queueModuleRegistration=="function")return $.queueModuleRegistration(W||O,U,F,R);if(!R||typeof R!="object"||!W)return!1;const se=Object.freeze({name:W,api:U,options:Object.freeze(N(F))});let me=R[Y];if(!Array.isArray(me))try{Object.defineProperty(R,Y,{configurable:!0,enumerable:!1,writable:!0,value:[]}),me=R[Y]}catch{try{Array.isArray(R[Y])||(R[Y]=[]),me=R[Y]}catch{return!1}}de(me,W);try{me.push(se)}catch{me[me.length]=se}return!0}function ne(O,U,F){if(!H||typeof H.register!="function")return{ok:!1,error:null,reason:"missing-registry"};const W=typeof O=="string"?O:"";if(!W)return{ok:!1,error:new TypeError("cineRuntime expected a module name."),reason:"invalid-name"};if(typeof H.has=="function")try{if(H.has(W)){if(typeof H.get=="function")try{const se=H.get(W);se&&oe(W,se)}catch(se){}return{ok:!0,alreadyRegistered:!0}}}catch(se){return{ok:!1,error:se,reason:"registry-check-failed"}}try{const se=H.register(W,U,F);return oe(W,se||U),{ok:!0,registered:!0}}catch(se){return{ok:!1,error:se,reason:"register-failed"}}}function V(O,U,F,W){if(m&&typeof m.registerModule=="function")return m.registerModule(O,U,F,R,W)?(oe(O,U),!0):!1;let se=null;const me=ne(O,U,F);if(me.ok)return!0;se=me.error||null;const Re=ve({warn:!1});if(Re&&(Re.flushed&&Re.flushed.processed>0||Re.ok)){const De=ne(O,U,F);if(De.ok)return!0;De.error&&(se=De.error)}if(se&&typeof W=="function")try{W(se)}catch{}return Q(O,U,F),!1}const fe=(function(){return m&&typeof m.registerModule=="function"?function(F,W,se,me){return m.registerModule(F,W,se,R,me)?(oe(F,W),!0):!1}:te&&typeof te.registerOrQueueModule=="function"?function(F,W,se,me){try{if(te.registerOrQueueModule(F,W,se,me,R,H))return!0}catch{}return V(F,W,se,me)}:z&&typeof z.registerOrQueueModule=="function"?function(F,W,se,me){try{if(z.registerOrQueueModule(F,W,se,me,R,H))return!0}catch{}return V(F,W,se,me)}:$&&typeof $.registerOrQueueModule=="function"?function(F,W,se,me){return $.registerOrQueueModule(F,W,se,me,R,H)}:V})();function J(O){if(!O||typeof process>"u"||!process)return!1;if(O===process)return!0;if(typeof O=="object"){try{if(O.constructor&&O.constructor.name==="process")return!0}catch{}if(typeof O.pid=="number"&&typeof O.nextTick=="function"&&typeof O.emit=="function"&&typeof O.binding=="function")return!0}if(typeof O=="function"){if(O===process.binding||O===process._linkedBinding||O===process.dlopen)return!0;try{const U=O.name||"";if(U&&(U==="binding"||U==="dlopen")){const F=Function.prototype.toString.call(O);if(F&&F.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function Ae(O){if(!O||typeof O=="function"||typeof O!="object"&&typeof O!="function")return!1;if(J(O)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof module<"u"&&module&&typeof module.constructor=="function"&&O instanceof module.constructor)return!0}catch{}try{if(typeof O.pipe=="function"&&typeof O.unpipe=="function")return!0;if(typeof O.on=="function"&&typeof O.emit=="function"){if(typeof O.write=="function"||typeof O.read=="function")return!0;const U=O.constructor&&O.constructor.name;if(U&&/Stream|Emitter|Port/i.test(U))return!0}if(typeof Symbol<"u"&&O[Symbol.toStringTag]){const U=O[Symbol.toStringTag];if(typeof U=="string"&&/Stream|Port/i.test(U))return!0}}catch{}return!1}const Le=typeof WeakSet=="function"?new WeakSet:null;function _e(O){if(O&&typeof O.has=="function"&&typeof O.add=="function")return O;if(Array.isArray(O))return{has(F){return O.indexOf(F)!==-1},add(F){O.indexOf(F)===-1&&O.push(F)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const U=[];return{has(F){return U.indexOf(F)!==-1},add(F){U.indexOf(F)===-1&&U.push(F)}}}function Je(O,U){if(!O||typeof O!="object"||Ae(O))return O;if(typeof process<"u"&&process&&Lw&&Lw.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(O)}catch{}return O}if(Le&&Le.has(O))return O;const F=_e(U);if(F.has(O))return O;F.add(O);let W=!1;if(typeof Object.isFrozen=="function")try{W=Object.isFrozen(O)}catch{W=!1}let se=[];try{se=Object.getOwnPropertyNames(O)}catch{if(typeof Reflect<"u"&&typeof Reflect.ownKeys=="function")try{se=Reflect.ownKeys(O).filter(function(De){return typeof De=="string"})}catch{se=[]}}for(let me=0;me<se.length;me+=1){const Re=se[me];if(Re==="web3"&&O===R)continue;let De=!0;try{De=Object.prototype.hasOwnProperty.call(O,Re)}catch{De=!0}if(!De)continue;let ot;try{ot=O[Re]}catch{ot=void 0}if(!(!ot||typeof ot=="function"||typeof ot!="object"&&typeof ot!="function"))try{Je(ot,F)}catch{}}if(W){if(Le)try{Le.add(O)}catch{}return O}try{const me=Object.freeze(O);if(Le)try{Le.add(me||O)}catch(Re){}return me}catch{return O}}const xe=(function(){return m&&typeof m.freezeDeep=="function"?m.freezeDeep:te&&typeof te.freezeDeep=="function"?te.freezeDeep:z&&typeof z.freezeDeep=="function"?function(F,W){try{return z.freezeDeep(F,W)}catch{return Je(F,W)}}:$&&typeof $.freezeDeep=="function"?$.freezeDeep:Je})();function Ze(O){if(!O||typeof O!="object"&&typeof O!="function")return O;try{typeof Object.preventExtensions=="function"&&Object.preventExtensions(O)}catch{}try{typeof Object.seal=="function"&&Object.seal(O)}catch{}const U=[];try{const F=Object.getOwnPropertyNames(O);for(let W=0;W<F.length;W+=1)U.push(F[W])}catch{}if(typeof Object.getOwnPropertySymbols=="function")try{const F=Object.getOwnPropertySymbols(O);for(let W=0;W<F.length;W+=1)U.push(F[W])}catch{}for(let F=0;F<U.length;F+=1){const W=U[F];let se;try{se=Object.getOwnPropertyDescriptor(O,W)}catch{se=null}if(!se||!(se.configurable===!0||"writable"in se&&se.writable===!0))continue;const Re={configurable:!1,enumerable:!!se.enumerable};Object.prototype.hasOwnProperty.call(se,"value")?(Re.value=se.value,Re.writable=!1):(Re.get=se.get,Re.set=se.set);try{Object.defineProperty(O,W,Re)}catch{}}return O}function Ve(O){const U=xe(O);if(Object.isFrozen(U))return U;try{const F=Object.freeze(U);if(Object.isFrozen(F))return F}catch{}return Ze(U),U}function Dt(O,U){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof U>"u"?console.warn(O):console.warn(O,U)}catch{}}const We=(function(){return m&&typeof m.safeWarn=="function"?m.safeWarn:te&&typeof te.safeWarn=="function"?te.safeWarn:z&&typeof z.safeWarn=="function"?function(F,W){try{z.safeWarn(F,W)}catch{Dt(F,W)}}:$&&typeof $.safeWarn=="function"?$.safeWarn:Dt})();function ft(O,U){if(!O||typeof O!="object"&&typeof O!="function")return{ok:!1,reason:"invalid-scope"};const F=U||H;if(!F)return{ok:!1,reason:"missing-registry"};try{return O.cineModules===F?{ok:!0,already:!0}:(Object.defineProperty(O,"cineModules",{configurable:!0,enumerable:!1,value:F,writable:!0}),{ok:!0,updated:!0})}catch(W){try{if(O.cineModules=F,O.cineModules===F)return{ok:!0,updated:!0}}catch(se){return{ok:!1,reason:"expose-failed",error:se||W}}}return{ok:!0,updated:!0}}function D(O,U){if(!O||typeof O!="object"&&typeof O!="function")return null;try{const F=O[U];return Array.isArray(F)?F:null}catch{return null}}function q(O,U){if(!Array.isArray(O))return;const F=U&&typeof U.name=="string"?U.name:"";F&&de(O,F);try{O.push(U)}catch{O[O.length]=U}}function we(O={}){const U=O.registry||H,F=typeof O.queueKey=="string"&&O.queueKey?O.queueKey:Y;if(!U||typeof U.register!="function")return Ve({ok:!1,processed:0,requeued:0,scopes:0,queueKey:F,failures:Ve([{reason:"missing-registry"}])});const W=Array.isArray(O.scopes)&&O.scopes.length>0?O.scopes.slice():j(O.scope||R);let se=0,me=0,Re=0;const De=[];for(let ot=0;ot<W.length;ot+=1){const at=W[ot],vt=D(at,F);if(!vt||vt.length===0)continue;Re+=1;const wt=vt.slice();vt.length=0;for(let Qt=0;Qt<wt.length;Qt+=1){const yr=wt[Qt];if(!yr||typeof yr!="object")continue;const tr=typeof yr.name=="string"?yr.name:"";if(!tr)continue;const rr=yr.api,bn=N(yr.options);if(typeof U.has=="function"){let io=!1;try{io=U.has(tr)}catch($o){De.push({name:tr,message:$o&&typeof $o.message=="string"?$o.message:null,reason:"has-check-failed",scopeIndex:ot})}if(io){se+=1;continue}}try{const io=U.register(tr,rr,bn);oe(tr,io||rr),se+=1}catch(io){me+=1,q(vt,yr),De.push({name:tr,message:io&&typeof io.message=="string"?io.message:null,reason:"register-failed",scopeIndex:ot})}}}return De.length>0&&O.warn&&We("cineRuntime.flushPendingModuleQueues() encountered issues while replaying module registrations.",De),Ve({ok:De.length===0,processed:se,requeued:me,scopes:Re,queueKey:F,failures:De.length>0?Ve(De):Ve([])})}function ve(O={}){const U=O.registry||H,F=typeof O.queueKey=="string"&&O.queueKey?O.queueKey:Y,W=Array.isArray(O.scopes)&&O.scopes.length>0?O.scopes.slice():j(O.scope||R),se=[],me=[];for(let at=0;at<W.length;at+=1){const vt=W[at],wt=ft(vt,U);se.push({scopeIndex:at,ok:!!wt.ok,updated:!!wt.updated,already:!!wt.already,reason:typeof wt.reason=="string"?wt.reason:null}),!wt.ok&&wt.reason!=="missing-registry"&&me.push({scopeIndex:at,reason:wt.reason||"expose-failed",message:wt.error&&typeof wt.error.message=="string"?wt.error.message:null})}me.length>0&&O.warn!==!1&&We("cineRuntime.synchronizeModuleLinks() could not expose cineModules on every scope.",me);const Re=we({registry:U,queueKey:F,scopes:W,warn:O.warn!==!1}),De=[];if(Array.isArray(Re.failures))for(let at=0;at<Re.failures.length;at+=1)De.push(Re.failures[at]);if(me.length>0)for(let at=0;at<me.length;at+=1)De.push(me[at]);const ot={ok:Re.ok&&me.length===0,queueKey:F,exposures:se,flushed:Re,failures:De};return Ve(ot)}const Se=ve({warn:!1});function he(O={}){const U=O.registry||H;if(!U||typeof U.list!="function"||typeof U.describe!="function")return Ve({ok:!1,reason:"missing-registry",modules:[],missingConnections:[],errors:[]});let F;try{F=U.list()}catch(ot){return Ve({ok:!1,reason:"list-failed",modules:[],missingConnections:[],errors:Ve([{type:"list",message:ot&&typeof ot.message=="string"?ot.message:null}])})}const W=Array.isArray(F)?F.slice():[],se=[],me=[],Re=[],De=typeof U.has=="function"?function(at){try{return U.has(at)}catch(vt){return Re.push({type:"has",module:at,message:vt&&typeof vt.message=="string"?vt.message:null}),W.indexOf(at)!==-1}}:function(at){return W.indexOf(at)!==-1};for(let ot=0;ot<W.length;ot+=1){const at=W[ot];let vt=null;try{vt=U.describe(at)}catch(tr){Re.push({type:"describe",module:at,message:tr&&typeof tr.message=="string"?tr.message:null})}const wt=new Set,Qt=[],yr=[];if(vt&&vt.connections&&typeof vt.connections[Symbol.iterator]=="function")for(const tr of vt.connections){if(typeof tr!="string")continue;const rr=tr.trim();!rr||wt.has(rr)||(wt.add(rr),Qt.push(rr),De(rr)||(yr.push(rr),me.push({from:at,to:rr})))}se.push(Ve({name:at,connections:Qt,missing:yr,ok:yr.length===0}))}return Ve({ok:me.length===0,modules:se,missingConnections:me,errors:Re})}function ge(O,U){if(!R||typeof R!="object")return!1;try{return Object.defineProperty(R,O,{configurable:!0,enumerable:!1,value:U,writable:!1}),!0}catch{try{return R[O]=U,!0}catch{return!1}}}const pe=(function(){return m&&typeof m.exposeGlobal=="function"?function(F,W,se){try{return m.exposeGlobal(F,W,R,se)}catch{return ge(F,W)}}:te&&typeof te.exposeGlobal=="function"?function(F,W,se){try{return te.exposeGlobal(F,W,se)}catch{return ge(F,W)}}:z&&typeof z.exposeGlobal=="function"?function(F,W,se){try{return z.exposeGlobal(F,W,se)}catch{return ge(F,W)}}:$&&typeof $.exposeGlobal=="function"?function(F,W,se){return $.exposeGlobal(F,W,R,se)}:ge})(),ze=["cinePersistence","cineOffline","cineUi"],ke=["storage.loadDeviceData","storage.saveDeviceData","storage.loadSetups","storage.saveSetups","storage.saveSetup","storage.loadSetup","storage.deleteSetup","storage.renameSetup","storage.loadSessionState","storage.saveSessionState","storage.saveProject","storage.loadProject","storage.deleteProject","storage.exportAllData","storage.importAllData","storage.clearAllData","storage.loadFavorites","storage.saveFavorites","storage.loadFeedback","storage.saveFeedback","storage.loadAutoGearRules","storage.saveAutoGearRules","storage.loadAutoGearBackups","storage.saveAutoGearBackups","storage.loadAutoGearSeedFlag","storage.saveAutoGearSeedFlag","storage.loadAutoGearBackupRetention","storage.saveAutoGearBackupRetention","storage.getAutoGearBackupRetentionDefault","storage.loadAutoGearPresets","storage.saveAutoGearPresets","storage.loadAutoGearActivePresetId","storage.saveAutoGearActivePresetId","storage.loadAutoGearAutoPresetId","storage.saveAutoGearAutoPresetId","storage.loadAutoGearMonitorDefaults","storage.saveAutoGearMonitorDefaults","storage.loadAutoGearBackupVisibility","storage.saveAutoGearBackupVisibility","storage.loadFullBackupHistory","storage.saveFullBackupHistory","storage.recordFullBackupHistoryEntry","storage.requestPersistentStorage","storage.clearUiCacheStorageEntries","storage.ensureCriticalStorageBackups","storage.getLastCriticalStorageGuardResult","autosave.saveSession","autosave.autoSaveSetup","autosave.saveGearList","autosave.restoreSessionState","backups.collectFullBackupData","backups.createSettingsBackup","backups.captureStorageSnapshot","backups.sanitizeBackupPayload","backups.autoBackup","backups.formatFullBackupFilename","backups.downloadPayload","backups.recordFullBackupHistoryEntry","restore.proceed","restore.abort","share.downloadProject","share.encodeSharedSetup","share.decodeSharedSetup","share.applySharedSetup","share.applySharedSetupFromUrl"],nt=["registerServiceWorker","reloadApp"],Ct=[{name:"deviceManagerSection",actions:["show","hide","toggle"]},{name:"shareDialog",actions:["open","submit","cancel","dismiss"]},{name:"sharedImportDialog",actions:["submit","cancel","dismiss","changeMode"]},{name:"backupSettings",actions:["execute"]},{name:"restoreSettings",actions:["openPicker","processFile"]}],Ot=["saveSetup","deleteSetup","shareOpen","shareSubmit","shareCancel","shareApplyFile","shareInputChange","sharedImportSubmit","sharedImportCancel","performBackup","openRestorePicker","applyRestoreFile"],xt=["saveSetup","autoBackupBeforeDeletion","shareProject","sharedImport","backupSettings","restoreSettings"];function or(O){if(!O||!ze.includes(O))throw new TypeError(`cineRuntime cannot resolve unknown module "${O}".`);if(H&&typeof H.get=="function")try{const U=H.get(O);if(U)return U}catch{}if(R&&typeof R=="object")try{const U=R[O];if(U)return U}catch{}switch(O){case"cinePersistence":return k("./persistence.js");case"cineOffline":return k("./offline.js");case"cineUi":return k("./ui.js");default:return null}}function er(O,U={}){const F=or(O);if(!F&&U.optional)return null;if(!F)throw new Error(`cineRuntime could not locate ${O}.`);return F}function wr(O){if(Array.isArray(O))return O.slice();if(typeof O=="string"&&O.trim())return O.split(".");throw new TypeError("cineRuntime expected check paths to be strings or arrays.")}function Pt(O,U,F,W,se){const me=wr(U);let Re=O,De=`${se}`;for(let vt=0;vt<me.length;vt+=1){const wt=me[vt];if(De=De?`${De}.${wt}`:wt,!Re||typeof Re!="object"&&typeof Re!="function"){F.push(De),W[De]=!1;return}Re=Re[wt]}const ot=`${se}.${me.join(".")}`,at=typeof Re=="function";at||F.push(ot),W[ot]=at}function Pr(O,U,F){if(!O||typeof O!="object")return;for(let me=0;me<ke.length;me+=1)Pt(O,ke[me],U,F,"cinePersistence");const W=O.__internal,se=W&&typeof W.inspectBinding=="function"?W.inspectBinding.bind(W):null;if(!se){const me="cinePersistence.__internal.inspectBinding";U.push(me),F[me]=!1;return}for(let me=0;me<ke.length;me+=1){const Re=ke[me],De=wr(Re),ot=De[De.length-1],at=`cinePersistence.bindings.${ot}`;let vt=null;try{vt=se(ot,{refresh:!0})}catch{vt=null}const wt=!!(vt&&vt.available);wt||U.push(at),F[at]=wt,vt&&(F[`${at}.provider`]=vt.providerName||null)}}function Wt(O,U,F){for(let W=0;W<nt.length;W+=1){const se=nt[W],me=O?O[se]:null,Re=`cineOffline.${se}`,De=typeof me=="function";De||U.push(Re),F[Re]=De}}function _t(O,U,F){const W=O&&O.controllers,se=W&&typeof W.get=="function"?W.get.bind(W):null;for(let me=0;me<Ct.length;me+=1){const Re=Ct[me],De=`cineUi.controllers.${Re.name}`;if(!se){U.push(De),F[De]=!1;continue}let ot=null;try{ot=se(Re.name)}catch{ot=null}if(!(!!ot&&typeof ot=="object")){U.push(De),F[De]=!1;continue}F[De]=!0;for(let vt=0;vt<Re.actions.length;vt+=1){const wt=Re.actions[vt],Qt=`${De}.${wt}`,tr=typeof ot[wt]=="function";tr||U.push(Qt),F[Qt]=tr}}}function _r(O,U,F){const W=O&&O.interactions,se=W&&typeof W.get=="function"?W.get.bind(W):null;for(let me=0;me<Ot.length;me+=1){const Re=Ot[me],De=`cineUi.interactions.${Re}`;if(!se){U.push(De),F[De]=!1;continue}let ot=null;try{ot=se(Re)}catch{ot=null}const at=typeof ot=="function";at||U.push(De),F[De]=at}}function Oe(O,U,F){const W=O&&O.help,se=W&&typeof W.resolve=="function"?W.resolve.bind(W):null;for(let me=0;me<xt.length;me+=1){const Re=xt[me],De=`cineUi.help.${Re}`;if(!se){U.push(De),F[De]=!1;continue}let ot=null;try{ot=se(Re)}catch{ot=null}const at=typeof ot=="string"&&!!ot.trim();at||U.push(De),F[De]=at}}function ct(){return Ve({cinePersistence:ke.slice(),cineOffline:nt.slice(),cineUi:{controllers:Ct.map(O=>({name:O.name,actions:O.actions.slice()})),interactions:Ot.slice(),help:xt.slice()}})}function Gt(O={}){const U=ve({warn:O.warnOnFailure}),F=[],W={};U&&typeof U=="object"&&(W["synchronization.ok"]=!!U.ok,Array.isArray(U.failures)&&U.failures.length>0&&(W["synchronization.failures"]=U.failures),U.ok||F.push("cineRuntime synchronization"));let se=null;if(H&&typeof H.assertRegistered=="function")try{se=H.assertRegistered(ze)}catch(wt){We("cineRuntime.verifyCriticalFlows() could not inspect cineModules registry.",wt)}const me=or("cinePersistence"),Re=or("cineOffline"),De=or("cineUi"),ot={cinePersistence:!!me,cineOffline:!!Re,cineUi:!!De};if(se&&se.detail){const wt={},Qt=Object.keys(se.detail);for(let yr=0;yr<Qt.length;yr+=1){const tr=Qt[yr],rr=!!se.detail[tr];wt[tr]=rr,W[`${tr}.registered`]=rr,rr||F.push(`${tr} (not registered)`)}ot.registry=wt}me?(W.cinePersistence=!0,Object.isFrozen(me)?W["cinePersistence.frozen"]=!0:(F.push("cinePersistence (not frozen)"),W["cinePersistence.frozen"]=!1),Pr(me,F,W)):(F.push("cinePersistence"),W.cinePersistence=!1),Re?(W.cineOffline=!0,Object.isFrozen(Re)?W["cineOffline.frozen"]=!0:(F.push("cineOffline (not frozen)"),W["cineOffline.frozen"]=!1),Wt(Re,F,W)):(F.push("cineOffline"),W.cineOffline=!1),De?(W.cineUi=!0,Object.isFrozen(De)?W["cineUi.frozen"]=!0:(F.push("cineUi (not frozen)"),W["cineUi.frozen"]=!1),_t(De,F,W),_r(De,F,W),Oe(De,F,W)):(F.push("cineUi"),W.cineUi=!1);const at=F.length===0,vt=Ve({ok:at,missing:F.slice(),modules:Ve(ot),details:Ve(W),registry:se?Ve(se):null,checks:ct(),synchronization:U});if(!at&&(O.warnOnFailure&&We("cineRuntime.verifyCriticalFlows() detected missing safeguards.",F),O.throwOnFailure)){const wt=new Error("cineRuntime integrity verification failed.");throw wt.details=vt,wt}return vt}const kt=Ve({getPersistence(O){return er("cinePersistence",O)},getOffline(O){return er("cineOffline",O)},getUi(O){return er("cineUi",O)},getModuleRegistry(){return H||null},synchronizeModules(O){return ve(O||{})},inspectModuleConnections(O){return he(O||{})},listCriticalChecks:ct,verifyCriticalFlows:Gt,__internal:Ve({resolveModule:or,ensureModule:er,listCriticalChecks:ct,moduleRegistry:H||null,synchronizeModuleLinks:ve,flushPendingModuleQueues:we,initialSynchronization:Se,inspectModuleConnections:he})});if(oe("cineRuntime",kt),fe("cineRuntime",kt,{category:"runtime",description:"Runtime orchestrator ensuring persistence, offline, and UI safeguards stay intact.",replace:!0,connections:["cinePersistence","cineOffline","cineUi","cineModuleGlobals","cineModuleContext"]},O=>{We("Unable to register cineRuntime module.",O)}),R&&typeof R=="object"){let O=null;try{O=R.cineRuntime||null}catch{O=null}O!==kt&&(pe("cineRuntime",kt,{configurable:!0,enumerable:!1,writable:!1})||We("Unable to expose cineRuntime globally."))}if(typeof module<"u"&&module&&module.exports)if(module.exports&&module.exports!==kt&&typeof module.exports=="object"&&Object.keys(module.exports).length>0)try{module.exports.cineRuntime!==kt&&Object.defineProperty(module.exports,"cineRuntime",{configurable:!0,enumerable:!1,value:kt,writable:!0})}catch(O){We("Unable to attach cineRuntime to existing module.exports.",O)}else module.exports=kt;return kt})();function U_(e){return e&&e.MOUNT_VOLTAGE_RUNTIME_EXPORTS&&typeof e.MOUNT_VOLTAGE_RUNTIME_EXPORTS=="object"?e.MOUNT_VOLTAGE_RUNTIME_EXPORTS:null}function Bf(e,t){const r=U_(e);return r&&typeof r[t]=="function"?r[t]:null}function Gi(e,t,r){if(!(!e||typeof r!="function")&&typeof e[t]!="function")try{e[t]=r}catch{}}function $_(e){const t={},r=["V-Mount","Gold-Mount","B-Mount"];for(const o of r){const n=e&&e[o]?e[o]:null,a=n&&typeof n.high=="number"&&Number.isFinite(n.high)?n.high:o==="B-Mount"?33.6:14.4,i=n&&typeof n.low=="number"&&Number.isFinite(n.low)?n.low:o==="B-Mount"?21.6:12;t[o]={high:a,low:i}}return t}function Zc(e,t){const r=e.DEFAULT_MOUNT_VOLTAGES||$_({}),o=e.SUPPORTED_MOUNT_VOLTAGE_TYPES||["V-Mount","Gold-Mount","B-Mount"],n={},a=(i,s)=>typeof i=="number"?Math.round(Math.min(1e3,Math.max(.1,i))*100)/100:typeof s=="number"?Math.round(Math.min(1e3,Math.max(.1,s))*100)/100:0;for(const i of o){const s=t&&t[i]?t[i]:r[i],u=r[i]||{high:0,low:0};n[i]={high:a(s?.high,u.high),low:a(s?.low,u.low)}}return n}function Rw(e,t){try{if(!e.localStorage)return!1;const r=JSON.stringify(t),o=e.MOUNT_VOLTAGE_STORAGE_KEY||"cameraPowerPlanner_mountVoltages";return e.localStorage.setItem(o,r),e.localStorage.setItem(o+"__backup",r),!0}catch{return!1}}function q_(e){if(!e)return;const t={preferences:Zc(e,null)},r=(s,u)=>{let l=Number.parseFloat(String(s).replace(",","."));return Number.isFinite(l)||(l=Number.parseFloat(String(u).replace(",","."))),Number.isFinite(l)?Math.round(Math.min(1e3,Math.max(.1,l))*100)/100:0},o=s=>{const u=Bf(e,"cloneMountVoltageMap");return u?u(s):Zc(e,s)},n=(s,u)=>{const l=Bf(e,"applyMountVoltagePreferences");return l?l(s,u):(t.preferences=Zc(e,s),u?.persist!==!1&&Rw(e,t.preferences),t.preferences)},a=s=>{const u=Bf(e,"parseStoredMountVoltages");if(u)return u(s);if(!s)return null;try{const l=typeof s=="string"?JSON.parse(s):s;return Zc(e,l)}catch{return null}};function i(s,u){return function(...d){const p=Bf(e,s);return p?p.apply(this,d):u.apply(this,d)}}Gi(e,"parseVoltageValue",i("parseVoltageValue",r)),Gi(e,"cloneMountVoltageMap",i("cloneMountVoltageMap",o)),Gi(e,"applyMountVoltagePreferences",i("applyMountVoltagePreferences",n)),Gi(e,"parseStoredMountVoltages",i("parseStoredMountVoltages",a)),Gi(e,"resetMountVoltagePreferences",i("resetMountVoltagePreferences",s=>n(null,s))),Gi(e,"updateMountVoltageInputsFromState",i("updateMountVoltageInputsFromState",()=>{})),Gi(e,"persistMountVoltagePreferences",i("persistMountVoltagePreferences",s=>Rw(e,s))),Gi(e,"getMountVoltagePreferencesClone",i("getMountVoltagePreferencesClone",()=>Zc(e,t.preferences))),typeof e.mountVoltageInputs>"u"&&(e.mountVoltageInputs=null)}function ng(e){if(e===null||typeof e>"u")return null;const t=Number(e);if(!Number.isFinite(t))return null;const r=Math.round(t);return Number.isFinite(r)?r:null}function bf(e,t,r){let o;try{o=e[t]}catch{}return typeof o>"u"?r:o}function Vi(e,t,r){try{e[t]=r}catch{}return r}function Jc(e,t,r=""){let o=bf(e,t);return typeof o!="string"&&(o=r),Vi(e,t,o)}function Pf(e,t){let r=bf(e,t);return Array.isArray(r)||(r=[]),Vi(e,t,r)}function ni(e,t,r){let o=bf(e,t);return typeof o!="function"&&(o=r),Vi(e,t,o)}function _n(e,t){let r=bf(e,t);return typeof r>"u"&&(r=null),Vi(e,t,r)}function V_(e){const t=HO(e);let r=null;const o=[];Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_MAX")&&o.push(e.AUTO_GEAR_BACKUP_RETENTION_MAX),Object.prototype.hasOwnProperty.call(e,"MAX_AUTO_BACKUPS")&&o.push(e.MAX_AUTO_BACKUPS),e.__cineStorageApi&&Object.prototype.hasOwnProperty.call(e.__cineStorageApi,"AUTO_GEAR_BACKUP_RETENTION_MAX")&&o.push(e.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MAX);for(const n of o){const a=ng(n);if(typeof a!="number")continue;const i=a<t?t:a;(r===null||i>r)&&(r=i)}return r===null&&(r=Math.max(t,120)),{min:t,max:r}}function HO(e){const t=[];Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_MIN")&&t.push(e.AUTO_GEAR_BACKUP_RETENTION_MIN),e.__cineStorageApi&&Object.prototype.hasOwnProperty.call(e.__cineStorageApi,"AUTO_GEAR_BACKUP_RETENTION_MIN")&&t.push(e.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MIN);for(const r of t){const o=ng(r);if(typeof o=="number"&&o>=1)return o<1?1:o}return 1}function W_(e){const t=V_(e),r=t.min,o=t.max,n=[];typeof e.getAutoGearBackupRetentionDefault=="function"&&n.push(()=>e.getAutoGearBackupRetentionDefault()),e.__cineStorageApi&&typeof e.__cineStorageApi.getAutoGearBackupRetentionDefault=="function"&&n.push(()=>e.__cineStorageApi.getAutoGearBackupRetentionDefault()),n.push(()=>Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_DEFAULT")?e.AUTO_GEAR_BACKUP_RETENTION_DEFAULT:null);for(const i of n)try{const s=ng(i());if(typeof s=="number")return s<r?r:s>o?o:s}catch{}let a=ng(36);return typeof a!="number"&&(a=r),a<r&&(a=r),a>o&&(a=o),a}function K_(e){if(!e||typeof e!="object")return"";try{const t=Object.keys(e);if(!t.length)return"";const r=t[0],o=e[r],n=typeof r=="string"?r.replace(/_/g," "):"connector";return o?`${n}: ${o}`:n}catch{return""}}function Y_(e,t){const r=e==null?"":String(e),o=t==null?"":String(t);try{return r.localeCompare(o,void 0,{sensitivity:"accent",numeric:!0})}catch{return r<o?-1:r>o?1:0}}function Q_(e){const t={},r=["V-Mount","Gold-Mount","B-Mount"];for(const o of r){const n=e&&e[o]?e[o]:null,a=n&&typeof n.high=="number"&&Number.isFinite(n.high)?n.high:o==="B-Mount"?33.6:14.4,i=n&&typeof n.low=="number"&&Number.isFinite(n.low)?n.low:o==="B-Mount"?21.6:12;t[o]={high:a,low:i}}return t}function X_(e){if(!e||typeof e!="object")return;Jc(e,"autoGearAutoPresetId",""),Pf(e,"baseAutoGearRules"),_n(e,"autoGearScenarioModeSelect"),_n(e,"autoGearRuleNameInput"),Jc(e,"autoGearSummaryFocus","all"),Pf(e,"autoGearMonitorDefaultControls"),_n(e,"iosPwaHelpDialog"),_n(e,"iosPwaHelpClose"),_n(e,"totalPowerElem"),ni(e,"safeGenerateConnectorSummary",K_),_n(e,"CORE_RUNTIME_SHARED"),_n(e,"CORE_GLOBAL_SCOPE"),_n(e,"autoGearAddOwnGearSelect"),_n(e,"autoGearRemoveOwnGearSelect"),_n(e,"newSubcategorySelect"),ni(e,"syncAutoGearMonitorFieldVisibility",()=>{}),Jc(e,"currentLang","en"),ni(e,"localeSort",Y_),ni(e,"resolveAutoGearBackupRetentionMin",()=>{const a=HO(e);return e&&(typeof e.AUTO_GEAR_BACKUP_RETENTION_MIN!="number"||!Number.isFinite(e.AUTO_GEAR_BACKUP_RETENTION_MIN))&&(e.AUTO_GEAR_BACKUP_RETENTION_MIN=a),a}),ni(e,"resolveAutoGearBackupRetentionDefault",()=>{const a=W_(e);return e&&(typeof e.AUTO_GEAR_BACKUP_RETENTION_DEFAULT!="number"||!Number.isFinite(e.AUTO_GEAR_BACKUP_RETENTION_DEFAULT))&&(e.AUTO_GEAR_BACKUP_RETENTION_DEFAULT=a),a}),ni(e,"getLanguageTexts",a=>{const i=e.texts||{},s=(a||e.DEFAULT_LANGUAGE||"en").trim().toLowerCase();if(i[s])return i[s];const u=s.substring(0,2);return i[u]?i[u]:i.en?i.en:Object.values(i)[0]||{}}),ni(e,"resolveTextEntry",(a,i,s,u)=>{const l=[a,i].filter(d=>d&&typeof d=="object");for(const d of l)try{const p=d[s];if(typeof p=="string"&&p.trim())return p.trim()}catch{}return u!==void 0?String(u):""}),Jc(e,"TEMPERATURE_STORAGE_KEY","cameraPowerPlanner_temperatureUnit"),ni(e,"resolveTemperatureStorageKey",()=>e.TEMPERATURE_STORAGE_KEY);const t=e.TEMPERATURE_UNITS,r={celsius:(t?.celsius||"celsius").trim().toLowerCase(),fahrenheit:(t?.fahrenheit||"fahrenheit").trim().toLowerCase()};Vi(e,"TEMPERATURE_UNITS",r);const o=bf(e,"TEMPERATURE_SCENARIOS",[]),n=Array.isArray(o)?o.filter(a=>a&&a.id&&a.key&&a.label):[];Vi(e,"TEMPERATURE_SCENARIOS",n),Vi(e,"FEEDBACK_TEMPERATURE_MIN",-20),Vi(e,"FEEDBACK_TEMPERATURE_MAX_LIMIT",50),Jc(e,"FOCUS_SCALE_STORAGE_KEY","cameraPowerPlanner_focusScale"),Pf(e,"FOCUS_SCALE_VALUES"),e.FOCUS_SCALE_VALUES.length===0&&(e.FOCUS_SCALE_VALUES=["metric","imperial"]),Pf(e,"SUPPORTED_MOUNT_VOLTAGE_TYPES"),e.SUPPORTED_MOUNT_VOLTAGE_TYPES.length===0&&(e.SUPPORTED_MOUNT_VOLTAGE_TYPES=["V-Mount","Gold-Mount","B-Mount"]),_n(e,"DEFAULT_MOUNT_VOLTAGES"),e.DEFAULT_MOUNT_VOLTAGES||(e.DEFAULT_MOUNT_VOLTAGES=Q_({})),_n(e,"MOUNT_VOLTAGE_RUNTIME_EXPORTS"),e.MOUNT_VOLTAGE_RUNTIME_EXPORTS||(e.MOUNT_VOLTAGE_RUNTIME_EXPORTS={}),q_(e),ni(e,"syncMountVoltageResetButtonGlobal",a=>(e.cineCoreMountVoltage?.syncMountVoltageResetButtonGlobal?e.cineCoreMountVoltage.syncMountVoltageResetButtonGlobal(a):e.mountVoltageResetButton=a,a))}(function(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;e&&X_(e)})();function jO(){const e=[];return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&e.push(CORE_GLOBAL_SCOPE),typeof globalThis<"u"&&globalThis&&e.push(globalThis),typeof window<"u"&&window&&e.push(window),typeof self<"u"&&self&&e.push(self),typeof global<"u"&&global&&e.push(global),e}function il(){const e=jO();for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r=="object")return r}return null}function zO(){const e=il();return e&&typeof e.cineCoreRuntimeModuleLoader=="object"&&e.cineCoreRuntimeModuleLoader?e.cineCoreRuntimeModuleLoader:typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object"?cineCoreRuntimeModuleLoader:null}function wv(e,t){const r=zO();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{return r.resolveCoreRuntimeModule(e,t)}catch{}return null}function ag(e,t){if(typeof e!="string"||!e)return;const r=il();if(!r||typeof r!="object")return;let o=null;try{o=Object.getOwnPropertyDescriptor(r,e)}catch{o=null}if(!(o&&o.configurable===!1&&o.writable===!1)){try{r[e]=t;return}catch{}try{Object.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Unable to expose ${e} globally`,n)}}}function Z_(e){!e||typeof e!="object"||Object.keys(e).forEach(t=>{ag(t,e[t])})}const dm=(function(t){const r="__coreRuntimeBootQueue",o=t&&typeof t=="object"?t:il();if(o){const n=o.__cineCoreBootQueueKey,a=o.CORE_BOOT_QUEUE_KEY;if(typeof a=="string"&&a){try{o.__cineCoreBootQueueKey=a}catch{o.__cineCoreBootQueueKey=a}return a}if(typeof n=="string"&&n){if(typeof o.CORE_BOOT_QUEUE_KEY!="string"||!o.CORE_BOOT_QUEUE_KEY)try{o.CORE_BOOT_QUEUE_KEY=n}catch{o.CORE_BOOT_QUEUE_KEY=n}return n}}if(o){try{o.__cineCoreBootQueueKey=r}catch{o.__cineCoreBootQueueKey=r}try{o.CORE_BOOT_QUEUE_KEY=r}catch{o.CORE_BOOT_QUEUE_KEY=r}}return r})(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null),Od=(function(t){if(Array.isArray(t))return t;const r=typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:il();if(r&&typeof r=="object"){const o=r.cineCoreShared;if(o&&typeof o=="object"){const n=o[dm];if(Array.isArray(n))return n;if(Object.isExtensible(o))return o[dm]=[],o[dm]}return Array.isArray(r.CORE_BOOT_QUEUE)||(r.CORE_BOOT_QUEUE=[]),r.CORE_BOOT_QUEUE}return[]})(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE:null);typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE!==Od&&(CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE=Od);function J_(e){if(typeof e=="function")try{Od.push(e)}catch{try{e()}catch(r){console.error("Failed to run fallback core boot task",r)}}}function UO(){const e=Od;if(console.log("[Runtime Bootstrap] Processing boot queue. Length:",Array.isArray(e)?e.length:"invalid"),!Array.isArray(e))return;const t=e.splice(0,e.length);console.log("[Runtime Bootstrap] Snapshot size:",t.length);for(let r=0;r<t.length;r+=1){const o=t[r];if(typeof o=="function")try{o()}catch(n){console.error("Failed to process core boot task",n)}}console.log("[Runtime Bootstrap] Queue processing complete.")}const el="__cineGridSnapState";function kE(){const e=[],t=typeof CORE_RUNTIME_STATE<"u"&&CORE_RUNTIME_STATE&&typeof CORE_RUNTIME_STATE=="object"?CORE_RUNTIME_STATE:null;if(t&&typeof t.getScopes=="function")try{const o=t.getScopes();if(Array.isArray(o))for(let n=0;n<o.length;n+=1){const a=o[n];a&&e.indexOf(a)===-1&&e.push(a)}}catch{}const r=jO();for(let o=0;o<r.length;o+=1){const n=r[o];n&&e.indexOf(n)===-1&&e.push(n)}return e}function ns(e,t=!1){if(e===!0||e===!1)return e===!0;if(typeof e=="string"){const r=e.trim().toLowerCase();return r?["true","1","yes","on","enabled","enable"].includes(r)?!0:["false","0","no","off","disabled","disable"].includes(r)?!1:t:t}if(typeof e=="number")return Number.isFinite(e)?e>0:t;if(e&&typeof e=="object"){if(Object.prototype.hasOwnProperty.call(e,"enabled"))return ns(e.enabled,t);if(Object.prototype.hasOwnProperty.call(e,"value"))return ns(e.value,t)}return t}function $O(){const e=kE();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object")){try{if(Object.prototype.hasOwnProperty.call(r,el)){const o=r[el],n=ns(o,void 0);if(typeof n=="boolean")return n}}catch{}try{if(Object.prototype.hasOwnProperty.call(r,"gridSnap")){const o=r.gridSnap,n=ns(o,void 0);if(typeof n=="boolean")return n}}catch{}}}}let Ji=ns($O(),!1);function eF(e,t){if(!(!e||typeof e!="object")){try{e[el]=t}catch{try{Object.defineProperty(e,el,{configurable:!0,writable:!0,value:t})}catch{}}try{e.gridSnap=t}catch{try{Object.defineProperty(e,"gridSnap",{configurable:!0,writable:!0,value:t})}catch{}}}}function Dy(e,t=null,r={}){const o=kE(),n=r&&r.persist!==!1;for(let i=0;i<o.length;i+=1){const s=o[i];if(!(!s||typeof s!="object")){if(n!==!1)try{s[el]=e}catch{try{Object.defineProperty(s,el,{configurable:!0,writable:!0,value:e})}catch{}}if(t!==s)try{s.gridSnap=e}catch{try{Object.defineProperty(s,"gridSnap",{configurable:!0,writable:!0,value:e})}catch{}}}}const a=il();return a&&typeof a=="object"&&n!==!1&&eF(a,e),e}function tF(){return Ji}function rF(e){const t=ns(e,Ji);return Ji=t,Dy(t),Ji}function oF(e){const t=ns(e,Ji);return Ji=t,Dy(t,null,{persist:!1}),Ji}Dy(Ji);function nF(e){if(!e||typeof e!="object")return;const t=il();if(!t||typeof t!="object")return;const r=t.cineRuntimeBootstrapExports;if(r&&typeof r=="object"){Object.keys(e).forEach(o=>{r[o]=e[o]});return}try{t.cineRuntimeBootstrapExports=e}catch{}}const Lv={fallbackResolveRuntimeModuleLoader:zO,fallbackRequireCoreRuntimeModule:wv,exposeCoreRuntimeConstant:ag,exposeCoreRuntimeConstants:Z_,CORE_BOOT_QUEUE_KEY:dm,CORE_BOOT_QUEUE:Od,enqueueCoreBootTask:J_,processCoreBootQueue:UO,GRID_SNAP_STATE_STORAGE_KEY:el,getGridSnapStateScopes:kE,normaliseGridSnapPreference:ns,readInitialGridSnapPreference:$O,syncGridSnapStateToScopes:Dy,getGridSnapState:tF,setGridSnapState:rF,applyLegacyGridSnapValue:oF};if(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE)CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule||(CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule=wv),CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant||(CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant=ag);else{const e=il();e&&(e.fallbackRequireCoreRuntimeModule||(e.fallbackRequireCoreRuntimeModule=wv),e.exposeCoreRuntimeConstant||(e.exposeCoreRuntimeConstant=ag))}typeof window<"u"&&(window.processCoreBootQueue=UO);if(typeof module<"u"&&module)try{module.exports=Lv}catch{}else if(typeof exports<"u"&&exports)try{exports.runtimeBootstrapExports=Lv}catch{}nF(Lv);const hf=typeof Ea=="function"?Ea:()=>null,Rv=typeof CORE_RUNTIME_SHARED<"u"?CORE_RUNTIME_SHARED:null,Iv=typeof CORE_ENVIRONMENT_HELPERS<"u"?CORE_ENVIRONMENT_HELPERS:null,aF=hf("cineCoreRuntimeCandidateScopes","./modules/core/runtime-candidate-scopes.js"),Jl=hf("cineCoreAppRuntimeCandidateScopeSupport","./modules/app-core/runtime.js"),Iw=(Jl&&typeof Jl.resolveRuntimeCandidateScopeSupport=="function"?Jl.resolveRuntimeCandidateScopeSupport:null)||(function(){const t=[typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o!="object"))try{const n=o.cineCoreAppRuntimeCandidateScopeSupport;if(n&&typeof n.resolveRuntimeCandidateScopeSupport=="function")return n.resolveRuntimeCandidateScopeSupport}catch{}}return null})(),Tw=(Jl&&typeof Jl.createFallbackRuntimeCandidateScopeSupport=="function"?Jl.createFallbackRuntimeCandidateScopeSupport:null)||(function(){const t=[typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o!="object"))try{const n=o.cineCoreAppRuntimeCandidateScopeSupport;if(n&&typeof n.createFallbackRuntimeCandidateScopeSupport=="function")return n.createFallbackRuntimeCandidateScopeSupport}catch{}}return null})(),Bb=hf("cineCoreAppRuntimeCandidateScopeFallback","./modules/app-core/runtime.js"),iF=Bb&&typeof Bb.createRuntimeCandidateScopeSupportFallback=="function"?Bb.createRuntimeCandidateScopeSupportFallback:(function(){return function(r){const o={collectCandidateScopes(){return[]},collectCandidateScopesWithFallback(){return[]},resolveCandidateScopes(n){return(n&&Array.isArray(n.currentCandidateScopes)?n.currentCandidateScopes:null)||[]},syncCandidateScopes(n,a){const i=Array.isArray(n)?n:[],s=a&&typeof a.assignCurrentCandidateScopes=="function"?a.assignCurrentCandidateScopes:r&&typeof r.assignCurrentCandidateScopes=="function"?r.assignCurrentCandidateScopes:null;if(s)try{s(i)}catch{}return i},ensureCandidateScopes(n){const a=n||{},i=o.resolveCandidateScopes(a);return o.syncCandidateScopes(i,a)}};return o}})(),Tv=typeof Tw=="function"?Tw({runtimeShared:Rv,environmentHelpers:Iv}):iF({runtimeShared:Rv,environmentHelpers:Iv,candidateScopeBridge:aF,corePartRuntimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,assignCurrentCandidateScopes(e){try{CORE_RUNTIME_CANDIDATE_SCOPES=e}catch{}}}),Ow=(typeof Iw=="function"?Iw({resolveCoreSupportModule:hf,requireFn:typeof require=="function"?require:null,runtimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,runtimeShared:Rv,environmentHelpers:Iv}):null)||Tv,Pb=hf("cineCoreAppRuntimeCandidateScopeResolvers","./modules/app-core/runtime.js"),Gw=Pb&&typeof Pb.createRuntimeCandidateScopeResolvers=="function"?Pb.createRuntimeCandidateScopeResolvers:(function(){return null})();function sF(e){const t=e&&e.runtimeCandidateScopeSupport?e.runtimeCandidateScopeSupport:null,r=e&&e.fallbackRuntimeCandidateScopeSupport?e.fallbackRuntimeCandidateScopeSupport:null;function o(s,u){if(!s||typeof s.collectCandidateScopes!="function")return null;try{const l=s.collectCandidateScopes(u);return Array.isArray(l)?l:null}catch{}return null}function n(s,u){if(!s||typeof s.ensureCandidateScopes!="function")return null;try{const l=s.ensureCandidateScopes(u);return Array.isArray(l)?l:null}catch{}return null}function a(s){const u=o(t,s);if(u)return u;const l=o(r,s);return l||[]}function i(s){const u=s&&typeof s=="object"?s:{},l=n(t,u);if(l&&l.length)return l;const d=n(r,u);return d&&d.length?d:a(u.primaryScope)}return{collectCoreRuntimeCandidateScopes:a,ensureCoreRuntimeCandidateScopes:i}}const ec=(typeof Gw=="function"?Gw({runtimeCandidateScopeSupport:Ow,fallbackRuntimeCandidateScopeSupport:Tv}):null)||sF({runtimeCandidateScopeSupport:Ow,fallbackRuntimeCandidateScopeSupport:Tv}),Ka=typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE||typeof globalThis<"u"&&typeof globalThis=="object"&&globalThis||typeof window<"u"&&typeof window=="object"&&window||typeof self<"u"&&typeof self=="object"&&self||typeof global<"u"&&typeof global=="object"&&global||null,lF=ec&&typeof ec.collectCoreRuntimeCandidateScopes=="function"?ec.collectCoreRuntimeCandidateScopes:inlineCollectCoreRuntimeCandidateScopes,cF=Ka&&typeof Ka.collectCoreRuntimeCandidateScopes=="function"?Ka.collectCoreRuntimeCandidateScopes:null,Sf=cF||lF;Ka&&typeof Ka.collectCoreRuntimeCandidateScopes!="function"&&(Ka.collectCoreRuntimeCandidateScopes=Sf);Ka&&(Ka.resolvedCollectCoreRuntimeCandidateScopes=Sf);const ig=(function(){const t=typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,r=ec&&typeof ec.ensureCoreRuntimeCandidateScopes=="function"?ec.ensureCoreRuntimeCandidateScopes:null,o={primaryScope:t,currentCandidateScopes:typeof CORE_RUNTIME_CANDIDATE_SCOPES<"u"&&CORE_RUNTIME_CANDIDATE_SCOPES&&typeof CORE_RUNTIME_CANDIDATE_SCOPES.length=="number"?CORE_RUNTIME_CANDIDATE_SCOPES:null,globalScope:typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,assignCurrentCandidateScopes(n){try{CORE_RUNTIME_CANDIDATE_SCOPES=n}catch{}}};if(typeof r=="function")try{const n=r(o);if(Array.isArray(n))return n}catch{}return Sf(t)})();Ka&&(Ka.CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED=ig,typeof window<"u"&&(window.CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED=ig));const kw=Sf,Bw={powerDrawWatts:"Power (W)",capacity:"Capacity (Wh)",pinA:"Pin A",dtapA:"D-Tap A",mount_type:"Mount",screenSizeInches:"Screen Size (in)",brightnessNits:"Brightness (nits)",torqueNm:"Torque (Nm)",internalController:"Internal Controller",powerSource:"Power Source",batteryType:"Battery Type",connectivity:"Connectivity"};function Ov(e){if(e===null)return"null";if(typeof e>"u")return"undefined";if(Array.isArray(e)){let t="[";for(let r=0;r<e.length;r+=1)r>0&&(t+=","),t+=Ov(e[r]);return t+="]",t}if(typeof e=="object"&&e){const t=Object.keys(e).sort();let r="{";for(let o=0;o<t.length;o+=1){const n=t[o];o>0&&(r+=","),r+=`${JSON.stringify(n)}:${Ov(e[n])}`}return r+="}",r}return JSON.stringify(e)}function uF(e){return e&&Object.prototype.hasOwnProperty.call(Bw,e)?Bw[e]:(typeof e=="string"?e:String(e||"")).replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/^./,r=>r.toUpperCase())}function BE(e,t,r){const o=[];e&&(typeof e=="object"||typeof e=="function")&&o.push(e),t&&(typeof t=="object"||typeof t=="function")&&o.push(t),r&&(typeof r=="object"||typeof r=="function")&&o.push(r),o.push(typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null);const n=[];for(let a=0;a<o.length;a+=1){const i=o[a];if(!i||typeof i!="object"&&typeof i!="function")continue;let s=!1;for(let u=0;u<n.length;u+=1)if(n[u]===i){s=!0;break}s||n.push(i)}return n}function Gv(e){return e&&typeof e=="object"&&e.texts&&typeof e.texts=="object"&&e.texts.en&&typeof e.texts.en=="object"?e.texts.en:{}}function tc(e){if(typeof e!="string")return"greater";const t=e.trim().toLowerCase();return!t||t===">"||t==="gt"||t==="greaterthan"||t==="above"||t==="over"?"greater":t==="<"||t==="lt"||t==="lessthan"||t==="below"||t==="under"?"less":t==="="||t==="=="||t==="equal"||t==="equals"||t==="exactly"||t==="match"||t==="matches"?"equal":"greater"}function kv(e){if(typeof e=="number"&&Number.isFinite(e)){const t=Math.round(e);return t>=0?t:null}if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=t.replace(/[^0-9.,-]/g,"").replace(/,/g,".");if(!r)return null;const o=Number.parseFloat(r);if(!Number.isFinite(o))return null;const n=Math.round(o);return n>=0?n:null}return null}function sg(e){if(!Number.isFinite(e))return"";try{if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")return new Intl.NumberFormat().format(e)}catch{}return String(e)}function dF(e,t){return function(o,n){const a=n||{},i=t(),s=e(o);return s==="less"?a.autoGearCameraWeightOperatorLess||i.autoGearCameraWeightOperatorLess||"Lighter than":s==="equal"?a.autoGearCameraWeightOperatorEqual||i.autoGearCameraWeightOperatorEqual||"Exactly":a.autoGearCameraWeightOperatorGreater||i.autoGearCameraWeightOperatorGreater||"Heavier than"}}function fF(e,t){return function(o,n){if(!o||!Number.isFinite(o.value))return"";const a=t(o.operator,n),i=e(o.value);return a?`${a} ${i} g`:`${i} g`}}function pF(e){const t=e||{},r=t.coreShared&&typeof t.coreShared=="object"?t.coreShared:null,o=t.globalScope&&typeof t.globalScope=="object"?t.globalScope:null,n=function(){return Gv(o||Eo())},a=r&&typeof r.normalizeAutoGearWeightOperator=="function"?function(A){try{return r.normalizeAutoGearWeightOperator(A)||tc(A)}catch{}return tc(A)}:tc,i=r&&typeof r.normalizeAutoGearWeightValue=="function"?function(A){try{const m=r.normalizeAutoGearWeightValue(A);if(typeof m=="number"||m===null)return m}catch{}return kv(A)}:kv,s=r&&typeof r.normalizeAutoGearCameraWeightCondition=="function"?function(A){try{return r.normalizeAutoGearCameraWeightCondition(A)||null}catch{}return null}:function(){return null},u=r&&typeof r.formatAutoGearWeight=="function"?function(A){try{const m=r.formatAutoGearWeight(A);if(typeof m=="string")return m}catch{}return sg(A)}:sg,l=dF(a,n),d=r&&typeof r.getAutoGearCameraWeightOperatorLabel=="function"?function(A,m){try{const y=r.getAutoGearCameraWeightOperatorLabel(A,m);if(typeof y=="string"&&y)return y}catch{}return l(A,m)}:l,p=fF(u,d),g=r&&typeof r.formatAutoGearCameraWeight=="function"?function(A,m){try{const y=r.formatAutoGearCameraWeight(A,m);if(typeof y=="string")return y}catch{}return p(A,m)}:p;return{normalizeAutoGearWeightOperator:a,normalizeAutoGearWeightValue:i,normalizeAutoGearCameraWeightCondition:s,formatAutoGearWeight:u,getAutoGearCameraWeightOperatorLabel:d,formatAutoGearCameraWeight:g,fallbackGetAutoGearCameraWeightOperatorLabel:l,fallbackFormatAutoGearCameraWeight:p,fallbackNormalizeAutoGearCameraWeightCondition:function(A){return null}}}function qO(e,t,r){return typeof kw=="function"?kw([e,t,r]):BE(e,t,r)}function PE(e,t){if(!(typeof e!="string"||!e)&&!(!Array.isArray(t)||t.length===0))for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o!="object"&&typeof o!="function"))try{if(e in o){const n=o[e];if(typeof n<"u")return n}}catch{}}}function xE(e,t,r){if(typeof e!="string"||!e||!Array.isArray(r)||r.length===0)return!1;for(let o=0;o<r.length;o+=1){const n=r[o];if(!(!n||typeof n!="object"&&typeof n!="function")){try{return n[e]=t,!0}catch{}try{return Object.defineProperty(n,e,{configurable:!0,writable:!0,value:t}),!0}catch{}}}return!1}function VO(e,t,r){const o=PE(e,r);if(typeof o<"u")return o;const n=typeof t=="function"?t():t;return xE(e,n,r),n}function mF(e){const t=e||{},r=Eo(),o=typeof t.runtimeScope<"u"?t.runtimeScope:r&&r.CORE_PART2_RUNTIME_SCOPE||null,n=typeof t.sharedScope<"u"?t.sharedScope:r&&r.CORE_SHARED_SCOPE_PART2||null,a=typeof t.globalScope<"u"?t.globalScope:r&&r.CORE_GLOBAL_SCOPE||null;let i=qO(o,n,a);const s=t.resolveSupportModule,u=typeof s=="function"?s:null;let l=null;if(u)try{const h=u("cineCoreAppRuntimeScopeBridge","./modules/app-core/runtime.js");h&&typeof h=="object"&&typeof h.createRuntimeScopeBridge=="function"&&(l=h.createRuntimeScopeBridge({primaryScope:o,additionalScopes:[n,a]}))}catch{}l&&typeof l=="object"&&Array.isArray(l.candidates)&&l.candidates.length>0&&(i=l.candidates);function d(h){return PE(h,i)}function p(h,A){return xE(h,A,i)}function g(h,A){return VO(h,A,i)}return{runtimeScopeBridge:l,runtimeScopeCandidates:i,readCoreScopeValue:l&&typeof l.readValue=="function"?l.readValue:d,writeCoreScopeValue:l&&typeof l.writeValue=="function"?l.writeValue:p,declareCoreFallbackBinding:l&&typeof l.declareFallbackBinding=="function"?l.declareFallbackBinding:g,fallbackReadCoreScopeValue:d,fallbackWriteCoreScopeValue:p,fallbackDeclareCoreFallbackBinding:g}}function Pw(e,t){return function(o,n){const a=n||{},i=t(),s=e(o);return s==="less"?a.autoGearCameraWeightOperatorLess||i.autoGearCameraWeightOperatorLess||"Lighter than":s==="equal"?a.autoGearCameraWeightOperatorEqual||i.autoGearCameraWeightOperatorEqual||"Exactly":a.autoGearCameraWeightOperatorGreater||i.autoGearCameraWeightOperatorGreater||"Heavier than"}}function gF(e,t){return function(o,n){if(!o||!Number.isFinite(o.value))return"";const a=t(o.operator,n),i=e(o.value);return a?`${a} ${i} g`:`${i} g`}}var WO=(function(){let t=null;if(typeof resolveCoreSupportModule=="function")try{const r=resolveCoreSupportModule("cineCorePart2RuntimeHelpers","./modules/app-core/runtime.js");r&&typeof r=="object"&&(t=r)}catch{}return t&&typeof t=="object"?t:{resolveAutoGearWeightHelpers:pF,resolveRuntimeScopeTools:mF,fallbackStableStringify:Ov,fallbackHumanizeKey:uF,fallbackNormalizeAutoGearWeightOperator:tc,fallbackNormalizeAutoGearWeightValue:kv,fallbackFormatAutoGearWeight:sg,fallbackNormalizeAutoGearCameraWeightCondition:function(o){return null},fallbackGetAutoGearCameraWeightOperatorLabel:Pw(tc,function(){return Gv(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)}),fallbackFormatAutoGearCameraWeight:gF(sg,Pw(tc,function(){return Gv(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)})),fallbackCreateRuntimeScopeCandidates:qO,fallbackReadCoreScopeValue:PE,fallbackWriteCoreScopeValue:xE,fallbackDeclareCoreFallbackBinding:VO}})();(function(t){if(!t||typeof t!="object")return;const r=BE(typeof CORE_PART2_RUNTIME_SCOPE<"u"?CORE_PART2_RUNTIME_SCOPE:null,typeof CORE_SHARED_SCOPE_PART2<"u"?CORE_SHARED_SCOPE_PART2:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null);for(let o=0;o<r.length;o+=1){const n=r[o];if(!(!n||typeof n!="object"&&typeof n!="function"))try{const a=n.cineCorePart2RuntimeHelpers;if(a&&typeof a=="object"){if(typeof Object.assign=="function")Object.assign(a,t);else for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);continue}n.cineCorePart2RuntimeHelpers=t}catch{}}})(WO);(function(t){if(!t||typeof t!="object")return;const r=BE(typeof CORE_PART2_RUNTIME_SCOPE<"u"?CORE_PART2_RUNTIME_SCOPE:null,typeof CORE_SHARED_SCOPE_PART2<"u"?CORE_SHARED_SCOPE_PART2:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null);for(let o=0;o<r.length;o+=1){const n=r[o];if(!(!n||typeof n!="object"&&typeof n!="function"))try{if(n.cineCoreShared&&typeof n.cineCoreShared=="object"){const a=n.cineCoreShared.cineCoreRuntimeHelpers;!a||typeof a!="object"?n.cineCoreShared.cineCoreRuntimeHelpers=t:typeof Object.assign=="function"&&Object.assign(a,t)}}catch{}}})(WO);function yF(){const e=Eo(),t=[e];typeof window<"u"&&t.push(window),typeof self<"u"&&t.push(self);for(const o of t)if(o&&o.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS)return o.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS;const r=pf("cineCoreAppRuntimeSharedNamespace");if(e)try{typeof e.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS>"u"&&(e.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS=r)}catch{}return r}const KO=yF(),YO=pf("cineCoreAppRuntimeSharedBootstrap"),bF=pf("cineCoreAppRuntimeSharedBootstrapResolver");function xw(e){return{runtimeSharedNamespace:{},runtimeSharedResolver:null,existingRuntimeShared:null,runtimeShared:{},fallbackResolveRuntimeSharedFromGlobal:()=>null}}function hF(e={}){const{APP_CORE_BOOTSTRAP_TOOLS:t,APP_CORE_BOOTSTRAP_FALLBACK_TOOLS:r,APP_CORE_BOOTSTRAP_SUITE:o,APP_CORE_BOOTSTRAP_RESULTS_TOOLS:n,CORE_RUNTIME_SHARED:a}=e,i={bootstrapTools:t,bootstrapFallbackTools:r,runtimeSharedBootstrapResolverTools:bF,runtimeSharedBootstrapTools:YO,runtimeSharedNamespaceTools:KO,resolveCoreSupportModule:pf,requireFn:null,runtimeScope:Eo(),coreGlobalScope:Eo(),currentRuntimeShared:a,fallbackScopes:[],collectFallbackScopes:()=>[],createInlineRuntimeSharedFallback:xw,runtimeSharedBootstrapInlineRequirePath:null,runtimeSharedBootstrapResultRequirePath:null};if(o?.createRuntimeSharedBootstrapResult)try{return o.createRuntimeSharedBootstrapResult(i)}catch{}if(n?.resolveRuntimeSharedBootstrapResult)try{return n.resolveRuntimeSharedBootstrapResult(i)}catch{}if(t?.createRuntimeSharedBootstrapResult)try{return t.createRuntimeSharedBootstrapResult(i)}catch{}if(t?.createRuntimeSharedBootstrapFallback)try{return t.createRuntimeSharedBootstrapFallback(i)}catch{}return xw()}var SF=KO,vF=YO,Oo=hF({APP_CORE_BOOTSTRAP_TOOLS:jl,APP_CORE_BOOTSTRAP_FALLBACK_TOOLS:zT,APP_CORE_BOOTSTRAP_SUITE:tn,APP_CORE_BOOTSTRAP_RESULTS_TOOLS:lD,CORE_RUNTIME_SHARED:typeof zs<"u"?zs:null}),AF=Oo&&Oo.runtimeSharedNamespace?Oo.runtimeSharedNamespace:null,Bv=Oo&&typeof Oo.runtimeSharedResolver=="function"?Oo.runtimeSharedResolver:null,Tu=(Oo&&Oo.existingRuntimeShared&&typeof Oo.existingRuntimeShared=="object"?Oo.existingRuntimeShared:null)||(typeof zs<"u"&&zs?zs:null),EF=Oo&&typeof Oo.fallbackResolveRuntimeSharedFromGlobal=="function"?Oo.fallbackResolveRuntimeSharedFromGlobal:function(){return null},zs=(Oo&&Oo.runtimeShared&&typeof Oo.runtimeShared=="object"?Oo.runtimeShared:null)||(Tu&&typeof Tu=="object"?Tu:null)||(Bv?(function(){try{const t=Bv({currentShared:Tu,resolveCoreSupportModule:Ea,requireFn:typeof require=="function"?require:null,runtimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null});if(t&&typeof t=="object")return t}catch{}return null})():null)||EF()||Object.create(null);typeof window<"u"&&(window.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS=SF,window.RUNTIME_SHARED_BOOTSTRAP_TOOLS=vF,window.CORE_RUNTIME_SHARED_NAMESPACE=AF,window.CORE_RUNTIME_SHARED_RESOLVER=Bv,window.EXISTING_CORE_RUNTIME_SHARED=Tu,window.CORE_RUNTIME_SHARED=zs,window.cineCoreRuntimeShared=zs);function CF(){return typeof WeakSet=="function"?new WeakSet:[]}function wF(e,t){if(!t||!e)return!1;if(typeof e.has=="function")try{return e.has(t)}catch{return!1}if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]===t)return!0}return!1}function LF(e,t){if(!(!t||!e)){if(typeof e.add=="function"){try{e.add(t)}catch{}return}if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]===t)return;e.push(t)}}}function Ai(e,t){const r=Array.isArray(t)&&t.length>0?t:cs();for(let o=0;o<r.length;o++){const n=r[o];if(!(!n||typeof n!="object"))try{if(e in n)return n[e]}catch{}}}function RF(e,t,r){const o=Array.isArray(r)&&r.length>0?r:cs();for(let n=0;n<o.length;n++){const a=o[n];if(!(!a||typeof a!="object"))try{return a[e]=t,!0}catch{}}return!1}function sn(e,t,r){const o=typeof t=="function"?t:()=>t,n=Array.isArray(r)&&r.length>0?r:cs();for(let a=0;a<n.length;a++){const i=n[a];if(!(!i||typeof i!="object"))try{return typeof i[e]>"u"&&(i[e]=o()),i[e]}catch{}}try{return o()}catch{return}}function QO(e,t,r,o){const n=typeof r=="function"?r:()=>r,a=Array.isArray(o)&&o.length>0?o:cs();for(let i=0;i<a.length;i++){const s=a[i];if(!(!s||typeof s!="object"))try{t(s[e])||(s[e]=n())}catch{}}}const IF={autoGearAutoPresetId:()=>"",baseAutoGearRules:()=>[],autoGearScenarioModeSelect:()=>null,autoGearRuleNameInput:()=>null,autoGearSummaryFocus:()=>"all",autoGearMonitorDefaultControls:()=>[],safeGenerateConnectorSummary:()=>()=>"",totalPowerElem:()=>null};function TF(e,t){const r=IF[t];if(typeof r!="function")return;const o=r();if(typeof e[t]>"u")try{e[t]=o}catch{try{Object.defineProperty(e,t,{configurable:!0,writable:!0,enumerable:!1,value:o})}catch{}}try{const n=e&&e.Function||Function;if(typeof n=="function"){const a=n("value","if (typeof "+t+" === 'undefined') { var "+t+" = value; } else { "+t+` = value; }
           return `+t+";"),i=typeof e[t]>"u"?o:e[t];a(i)}}catch{}}function _y(){return function(t){if(!t||typeof t!="object")return"";if(typeof globalThis.generateConnectorSummary=="function")try{return globalThis.generateConnectorSummary(t)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("generateConnectorSummary failed, using fallback",r)}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Using fallback connector summary generator. Core bindings may have failed to initialise.");try{const r=Object.keys(t);if(!r.length)return"";const o=r[0],n=t[o],a=typeof o=="string"?o.replace(/_/g," "):"connector";return n?`${a}: ${n}`:a}catch{return""}}}let Mw=!1;function OF(e){const t=[],r=Ai("safeGenerateConnectorSummary");typeof r=="function"&&t.push(r);const o=Ai("CORE_SHARED");o&&typeof o.safeGenerateConnectorSummary=="function"&&t.push(o.safeGenerateConnectorSummary),t.push(_y());for(const n of t)try{const a=n(e);if(typeof a=="string")return a;if(a==null)continue;return String(a)}catch(a){Mw||(Mw=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to generate connector summary. Falling back.",a))}return""}const GF={},Fy={formatCoordinate:ZP,positionMarkup:JP,resolveGlyph:XP,applyGlyph:ex};function kF(e){var t=[],r=typeof Set=="function"?new Set:null;function o(a){if(!(!a||typeof a!="object"&&typeof a!="function")){if(r){if(r.has(a))return;r.add(a),t.push(a);return}t.indexOf(a)===-1&&t.push(a)}}if(Array.isArray(e))for(var n=0;n<e.length;n+=1)try{o(e[n])}catch{}return Object.freeze({getScopes:function(){return t.slice()},getPrimaryScope:function(){return t.length>0?t[0]:null},ensureValue:function(i,s){var u=typeof s=="function"?s:function(){return s};if(typeof i!="string"||!i)try{return u()}catch{return}for(var l=0;l<t.length;l+=1){var d=t[l];if(!(!d||typeof d!="object"&&typeof d!="function"))try{return typeof d[i]>"u"&&(d[i]=u()),d[i]}catch{}}try{return u()}catch{return}},normaliseValue:function(i,s,u){for(var l=typeof u=="function"?u:function(){return u},d=0;d<t.length;d+=1){var p=t[d];if(!(!p||typeof p!="object"&&typeof p!="function"))try{s(p[i])||(p[i]=l())}catch{}}}})}function BF(){if(typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object")return cineCoreRuntimeModuleLoader;const e=Eo();return e&&e.cineCoreRuntimeModuleLoader&&typeof e.cineCoreRuntimeModuleLoader=="object"?e.cineCoreRuntimeModuleLoader:null}function PF(e,t){const r=BF();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{return r.resolveCoreRuntimeModule(e,t)}catch{}return null}(function(){const t=cs();let r=null;for(const o of t)if(o&&o.ICON_GLYPHS&&typeof o.ICON_GLYPHS=="object"){r=o.ICON_GLYPHS;break}r||(r={});for(const o of t)sn("ICON_GLYPHS",()=>r,[o])})();var XO=(function(){let t=null;return typeof Ea=="function"&&(t=Ea("cineRuntimeEnvironmentHelpers","./modules/runtime-environment-helpers.js")),t||(t=Ai("cineRuntimeEnvironmentHelpers"),t)})(),Bt=(function(){if(typeof Bt<"u"&&Bt)return Bt;let t=null;return typeof Ea=="function"&&(t=Ea("cineCoreRuntimeShared","./app-core-runtime-shared.js")),t||(t=Ai("cineCoreRuntimeShared")),t})();function ZO(e){if(Bt&&typeof Bt.collectCandidateScopes=="function")try{const t=Bt.collectCandidateScopes(e,XO);if(Array.isArray(t))return t}catch{}return cs(e)}var xf=(function(){if(typeof xf<"u"&&xf&&Array.isArray(xf))return xf;const t=ZO();if(Bt&&typeof Bt.syncCandidateScopes=="function")try{Bt.syncCandidateScopes(t,Eo(),XO)}catch{}else sn("CORE_RUNTIME_CANDIDATE_SCOPES",t);return t})(),mn=(function(){let t=Ai("CORE_RUNTIME_STATE_SUPPORT");if(t||(t=Ai("cineCoreRuntimeState")),t)return t;if(typeof Ea=="function"&&(t=Ea("cineCoreRuntimeState","./modules/core/runtime-state.js")),!t){const r=PF("modules/core/runtime-state.js");r&&typeof r=="object"&&(t=r)}return t&&sn("CORE_RUNTIME_STATE_SUPPORT",t),t})(),lg={queueKey:"__cinePendingTemperatureNote",renderName:"renderTemperatureNote"};if(mn&&typeof mn.resolveTemperatureKeyDefaults=="function")try{const e=mn.resolveTemperatureKeyDefaults();e&&(e.queueKey&&(lg.queueKey=e.queueKey),e.renderName&&(lg.renderName=e.renderName))}catch{}const Gd=lg.queueKey,Ny=lg.renderName;var cg=(function(){if(mn){if(typeof mn.ensureSafeFreezeRegistry=="function")return mn.ensureSafeFreezeRegistry();if(typeof mn.createSafeFreezeRegistry=="function")return mn.createSafeFreezeRegistry()}return CF()})();function xF(e){if(mn&&typeof mn.hasSafeFreezeEntry=="function")try{return mn.hasSafeFreezeEntry(cg,e)}catch{}return wF(cg,e)}function MF(e){if(mn&&typeof mn.registerSafeFreezeEntry=="function")try{return mn.registerSafeFreezeEntry(cg,e)}catch{}return LF(cg,e)}TF(Eo(),"autoGearAutoPresetId");sn("baseAutoGearRules",()=>[]);sn("autoGearScenarioModeSelect",null);sn("createFallbackSafeGenerateConnectorSummary",function(){return _y});sn("safeGenerateConnectorSummary",function(){return _y()});sn("readGlobalScopeValue",()=>Ai);QO("baseAutoGearRules",e=>Array.isArray(e),()=>[]);QO("safeGenerateConnectorSummary",e=>typeof e=="function",()=>_y());sn("ICON_FONT_KEYS",()=>zI());sn("iconGlyph",function(){const t=zI().UICONS||"uicons";return function(o,n){return Object.freeze({char:typeof o=="string"?o:"",font:n&&typeof n=="string"?n:t})}});sn("resolveIconGlyph",()=>GF.resolveIconGlyph);sn("resolveIconGlyph",()=>Fy.resolveGlyph);sn("formatSvgCoordinate",()=>Fy.formatCoordinate);sn("positionSvgMarkup",function(){return Fy.positionMarkup});sn("applyIconGlyph",function(){return Fy.applyGlyph});function Hy(e){return Ai(e)}Hy("autoGearAutoPresetId");Hy("baseAutoGearRules");Hy("autoGearScenarioModeSelect");Hy("safeGenerateConnectorSummary");const ki=Eo();ki&&(ki.coreSafeFreezeRegistryHas=xF,ki.coreSafeFreezeRegistryAdd=MF,ki.generateSafeConnectorSummary=OF,ki.readGlobalScopeValue=Ai,ki.writeGlobalScopeValue=RF,ki.collectEnvironmentRuntimeCandidateScopes=ZO,ki.createLocalRuntimeStateFallback=kF);const zl={_cache:{},getElement:function(e){if(this._cache[e])return this._cache[e];if(typeof document<"u"){const t=document.getElementById(e);if(t)return this._cache[e]=t,t}return null},clear:function(){this._cache={}}},DF=["toggleDeviceManager","device-manager","saveSetupBtn","setupName","deleteSetupBtn","addDeviceBtn","cancelEditBtn","languageSelect","skipLink","importDataBtn","importFileInput","exportDataBtn","generateGearListBtn","deleteGearListProjectBtn","gearItemEditExtra","newSubcategory","newCategory","subcategoryField","lensFocusScaleUnit","newName","newWatt","newCapacity","newPinA","newDtapA","menuToggle","darkModeToggle","pinkModeToggle","settingsButton","helpButton","reloadButton","closeMenuButton","openContactsBtn","shareSetupBtn","applySharedLinkBtn","generateOverviewBtn","runtimeFeedbackBtn","zoomOut","zoomIn","resetView","gridSnapToggle","accentColorReset","localFontsButton","documentationTrackerAddRelease","mountVoltageReset","autoGearSavePreset","autoGearDeletePreset","autoGearBackupRestore","autoGearAddRule","autoGearResetFactory","autoGearHighlightToggle","closePrintPreviewBtn","printPreviewExportBtn","printPreviewPrintBtn","cameraWatt","monitorWatt","viewfinderWatt","cameraVoltage","cameraPortType","monitorScreenSize","monitorBrightness","monitorVoltage","monitorPortType","monitorLatency","monitorAudioOutput","viewfinderScreenSize","viewfinderBrightness","viewfinderVoltage","viewfinderPortType","viewfinderLatency","batteryFields","cameraFields","monitorFields","viewfinderFields","videoFields","motorFields","controllerFields","distanceFields","lensFields","wattField","dynamicFields"];DF.forEach(function(e){Object.defineProperty(zl,e,{get:function(){return this.getElement(e)},enumerable:!0,configurable:!0})});typeof globalThis<"u"?globalThis.cineUiCache=zl:typeof window<"u"?window.cineUiCache=zl:typeof self<"u"?self.cineUiCache=zl:typeof global<"u"&&(global.cineUiCache=zl);function _F(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const fa=_F();function JO(e){let t=null;return typeof iconMarkup=="function"?t=iconMarkup:fa&&typeof fa.iconMarkup=="function"&&(t=fa.iconMarkup),mT(e,t)}function eG(e,t,r){let o=r;typeof o>"u"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.save&&(o=ICON_GLYPHS.save);let n=null;return typeof iconMarkup=="function"?n=iconMarkup:fa&&typeof fa.iconMarkup=="function"&&(n=fa.iconMarkup),gT(e,t,o,n)}const FF={escapeHtml:jc,escapeButtonLabelSafely:Cc,resolveButtonIconMarkup:JO,setButtonLabelWithIcon:eG,whenElementAvailable:yT};if(fa){const e=fa.cineCoreUiHelpers&&typeof fa.cineCoreUiHelpers=="object"?fa.cineCoreUiHelpers:{};e.escapeHtml=jc,e.escapeButtonLabelSafely=Cc,e.resolveButtonIconMarkup=JO,e.setButtonLabelWithIcon=eG,e.whenElementAvailable=yT;try{fa.cineCoreUiHelpers=e}catch{}}const tG=FF;function NF(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const eu=NF();if(eu){const e=eu.cineCoreTextEntries&&typeof eu.cineCoreTextEntries=="object"?eu.cineCoreTextEntries:{};e.TEXT_ENTRY_SEPARATOR=Cd,e.normaliseTextEntryValue=wd,e.resolveTextEntry=pT;try{eu.cineCoreTextEntries=e}catch{}}function HF(e){return e.replace(/([A-Z])/g," $1").replace(/^./,t=>t.toUpperCase())}function jF(e=document){const t=e.getElementById("dynamicFields");t&&(t.innerHTML="",t.hidden=!0)}function zF(e,t,r=document){const o=r.getElementById("wattField");o&&(o.style.display="")}function UF(e,t={},r=[],o=window,n=document){const a=n.getElementById("dynamicFields");if(!a)return;const i=o&&typeof o.getSchemaAttributesForCategory=="function"?o.getSchemaAttributesForCategory:null;if(!i){console.warn("getSchemaAttributesForCategory not found, skipping dynamic fields.");return}const u=(i(e)||[]).filter(l=>!(r.includes(l)||["powerDrawWatts","name","category","subcategory","notes"].includes(l)||["power","video","recordingMedia","lensMount","fizConnectors"].includes(l)));if(u.length===0){a.hidden=!0;return}a.hidden=!1,u.forEach(l=>{const d=n.createElement("div");d.className="form-row";const p=n.createElement("label");p.htmlFor=`dynamic_${l}`,p.textContent=HF(l);let g;l.startsWith("is")||l.startsWith("has")?(g=n.createElement("input"),g.type="checkbox",g.id=`dynamic_${l}`,g.checked=!!t[l]):l.includes("Count")||l.includes("Amount")||l==="capacity"||l==="pinA"||l==="dtapA"?(g=n.createElement("input"),g.type="number",g.id=`dynamic_${l}`,g.step="any",g.value=t[l]!==void 0?t[l]:""):(g=n.createElement("input"),g.type="text",g.id=`dynamic_${l}`,g.value=t[l]||""),g.dataset.dynamicAttr=l,d.appendChild(p),d.appendChild(g),a.appendChild(d)})}const $F=()=>typeof window<"u"?window:globalThis,Mf=$F();Mf&&(Mf.clearDynamicFields=jF,Mf.placeWattField=zF,Mf.buildDynamicFields=UF);function qF(e,t={}){const r=t.globalScope||Eo(),o=e||(typeof document<"u"?document:null);let n;if(!o)n={autoGearRuleNameInput:null,autoGearRuleNameLabel:null,autoGearScenariosSelect:null,autoGearScenariosLabel:null,autoGearScenarioModeSelectElement:null,autoGearScenarioModeLabel:null,autoGearScenarioMultiplierContainer:null,autoGearScenarioBaseSelect:null,autoGearScenarioBaseLabel:null,autoGearScenarioFactorInput:null,autoGearScenarioFactorLabel:null,autoGearShootingDaysMode:null,autoGearShootingDaysInput:null,autoGearShootingDaysLabel:null,autoGearShootingDaysHelp:null,autoGearShootingDaysValueLabel:null,autoGearMatteboxSelect:null,autoGearMatteboxLabel:null,autoGearMatteboxModeLabel:null,autoGearMatteboxModeSelect:null,autoGearCameraHandleSelect:null,autoGearCameraHandleLabel:null,autoGearCameraHandleModeLabel:null,autoGearCameraHandleModeSelect:null,autoGearViewfinderExtensionSelect:null,autoGearViewfinderExtensionLabel:null,autoGearViewfinderExtensionModeLabel:null,autoGearViewfinderExtensionModeSelect:null,autoGearDeliveryResolutionSelect:null,autoGearDeliveryResolutionLabel:null,autoGearDeliveryResolutionModeLabel:null,autoGearDeliveryResolutionModeSelect:null,autoGearVideoDistributionSelect:null,autoGearVideoDistributionLabel:null,autoGearVideoDistributionModeLabel:null,autoGearVideoDistributionModeSelect:null,autoGearCameraSelect:null,autoGearCameraLabel:null,autoGearCameraModeLabel:null,autoGearCameraModeSelect:null,autoGearOwnGearLabel:null,autoGearOwnGearModeLabel:null,autoGearOwnGearModeSelect:null,autoGearOwnGearSelect:null,autoGearCameraWeightLabel:null,autoGearCameraWeightOperator:null,autoGearCameraWeightOperatorLabel:null,autoGearCameraWeightValueInput:null,autoGearCameraWeightValueLabel:null,autoGearCameraWeightHelp:null,autoGearMonitorSelect:null,autoGearMonitorLabel:null,autoGearMonitorModeLabel:null,autoGearMonitorModeSelect:null,autoGearTripodHeadBrandSelect:null,autoGearTripodHeadBrandLabel:null,autoGearTripodHeadBrandModeLabel:null,autoGearTripodHeadBrandModeSelect:null,autoGearTripodBowlSelect:null,autoGearTripodBowlLabel:null,autoGearTripodBowlModeLabel:null,autoGearTripodBowlModeSelect:null,autoGearTripodTypesSelect:null,autoGearTripodTypesLabel:null,autoGearTripodTypesModeLabel:null,autoGearTripodTypesModeSelect:null,autoGearTripodSpreaderSelect:null,autoGearTripodSpreaderLabel:null,autoGearTripodSpreaderModeLabel:null,autoGearTripodSpreaderModeSelect:null,autoGearCrewPresentSelect:null,autoGearCrewPresentLabel:null,autoGearCrewPresentModeLabel:null,autoGearCrewPresentModeSelect:null,autoGearCrewAbsentSelect:null,autoGearCrewAbsentLabel:null,autoGearCrewAbsentModeLabel:null,autoGearCrewAbsentModeSelect:null,autoGearWirelessSelect:null,autoGearWirelessLabel:null,autoGearWirelessModeLabel:null,autoGearWirelessModeSelect:null,autoGearMotorsSelect:null,autoGearMotorsLabel:null,autoGearMotorsModeLabel:null,autoGearMotorsModeSelect:null,autoGearControllersSelect:null,autoGearControllersLabel:null,autoGearControllersModeLabel:null,autoGearControllersModeSelect:null,autoGearDistanceSelect:null,autoGearDistanceLabel:null,autoGearDistanceModeLabel:null,autoGearDistanceModeSelect:null,autoGearConditionLabels:{},autoGearConditionSelects:{},autoGearConditionLogicLabels:{},autoGearConditionLogicSelects:{},AUTO_GEAR_CONDITION_KEYS:[],AUTO_GEAR_REPEATABLE_CONDITIONS:new Set,AUTO_GEAR_CONDITION_FALLBACK_LABELS:{},getViewfinderFallbackLabel:function(Wr){return Wr==="__none__"?"No":typeof Wr=="string"?Wr:""},getVideoDistributionFallbackLabel:function(Wr){return Wr==="__none__"?"No video distribution selected":typeof Wr=="string"?Wr:""},refreshAutoGearShootingDaysValue:function(){},refreshAutoGearScenarioOptions:function(){},refreshAutoGearScenarioBaseSelect:function(){},refreshAutoGearMatteboxOptions:function(){},refreshAutoGearCameraHandleOptions:function(){},refreshAutoGearViewfinderExtensionOptions:function(){},refreshAutoGearDeliveryResolutionOptions:function(){},refreshAutoGearVideoDistributionOptions:function(){},collectAutoGearSelectedValues:function(){return[]},getAutoGearScenarioModeSelectElement:function(){return null},setAutoGearScenarioModeSelectElement:function(){}};else{let Ga=function(Me){if(!y)return;const b=Me&&typeof Me=="object"&&!Array.isArray(Me)?normalizeAutoGearShootingDaysCondition(Me):Array.isArray(Me)&&Me.length?normalizeAutoGearShootingDaysCondition({mode:"minimum",value:Me[0]}):autoGearEditorDraft?.shootingDays?normalizeAutoGearShootingDaysCondition(autoGearEditorDraft.shootingDays):null,v=b?b.mode:"minimum";m&&(m.value=AUTO_GEAR_SHOOTING_DAY_MODES.has(v)?v:"minimum");const T=b?b.value:"";y.value=T?String(T):""},Po=function(Me){if(!s)return;const b=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.scenarios)?autoGearEditorDraft.scenarios:[],v=Array.from(new Set(b.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));s.innerHTML="",s.multiple=!0;const T=o.getElementById("requiredScenarios");let P=!1;if(T&&Array.from(T.options).forEach(_=>{if(!_.value)return;const ce=o.createElement("option");ce.value=_.value,ce.textContent=_.textContent,v.includes(_.value)&&(ce.selected=!0),s.appendChild(ce),P=!0}),P)v.forEach(_=>{if(!Array.from(s.options||[]).some(X=>X&&X.value===_)){const X=o.createElement("option");X.value=_,X.textContent=_,X.selected=!0,s.appendChild(X)}});else{const _=o.createElement("option");_.value="",_.textContent=r.texts[r.currentLang]?.autoGearScenarioPlaceholder||texts.en?.autoGearScenarioPlaceholder||"Select scenarios",_.disabled=!0,_.selected=!0,s.appendChild(_)}const x=Array.from(s.options||[]).filter(_=>!_.disabled);s.size=computeAutoGearMultiSelectSize(x.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS}),Lr(v)},Lr=function(Me){const b=Array.isArray(Me)?Me.filter(P=>typeof P=="string"&&P.trim()):[],v=Array.from(new Set(b)),T=autoGearEditorDraft?normalizeAutoGearScenarioLogic(autoGearEditorDraft.scenarioLogic):normalizeAutoGearScenarioLogic(Wr?.value);if(Wr){const P={all:r.texts[r.currentLang]?.autoGearScenarioModeAll||texts.en?.autoGearScenarioModeAll||"Require every selected scenario",any:r.texts[r.currentLang]?.autoGearScenarioModeAny||texts.en?.autoGearScenarioModeAny||"Match any selected scenario",multiplier:r.texts[r.currentLang]?.autoGearScenarioModeMultiplier||texts.en?.autoGearScenarioModeMultiplier||"Multiply when combined"};Array.from(Wr.options||[]).forEach(_=>{if(!_)return;_.value==="multiplier"?_.disabled=v.length<2:_.disabled=!1;const ce=P[_.value]||P.all;_.textContent=ce});let x=T;x==="multiplier"&&v.length<2&&(x="all"),Wr.value=x,autoGearEditorDraft&&autoGearEditorDraft.scenarioLogic!==x&&(autoGearEditorDraft.scenarioLogic=x),xo(x,v)}else xo(T,v)},xo=function(Me,b){if(!d)return;const v=normalizeAutoGearScenarioLogic(Me),T=Array.isArray(b)?b.filter(x=>typeof x=="string"&&x.trim()):[],P=v==="multiplier"&&T.length>=1;d.hidden=!P,d.setAttribute("aria-hidden",P?"false":"true"),h&&(h.disabled=!P),ln(T,{forceDisable:!P})},ln=function(Me,b={}){if(!p)return;const{forceDisable:v=!1}=b,T=Array.isArray(Me)?Me.filter(ye=>typeof ye=="string"&&ye.trim()):[],P=Array.from(new Set(T)),x=p.value||"";if(p.innerHTML="",v||!P.length){const ye=o.createElement("option");ye.value="",ye.textContent=r.texts[r.currentLang]?.autoGearScenarioBasePlaceholder||texts.en?.autoGearScenarioBasePlaceholder||"Select a base scenario",ye.disabled=!0,ye.selected=!0,p.appendChild(ye),p.disabled=!0;return}P.forEach(ye=>{const Be=o.createElement("option");Be.value=ye,Be.textContent=ye,p.appendChild(Be)});const _=autoGearEditorDraft?normalizeAutoGearScenarioPrimary(autoGearEditorDraft.scenarioPrimary):"",ce=normalizeAutoGearTriggerValue(_);let X="";if(ce){const ye=P.find(Be=>normalizeAutoGearTriggerValue(Be)===ce);ye&&(X=ye)}if(!X&&x){const ye=normalizeAutoGearTriggerValue(x),Be=P.find(Ue=>normalizeAutoGearTriggerValue(Ue)===ye);Be&&(X=Be)}X||(X=P[0]),p.value=X,p.disabled=!1},Pn=function(Me){if(!L)return;const b=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.mattebox)?autoGearEditorDraft.mattebox:[],v=Array.from(new Set(b.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));L.innerHTML="",L.multiple=!0;const T=o.getElementById("mattebox");let P=!1;if(T&&Array.from(T.options).forEach(_=>{if(!_.value)return;const ce=o.createElement("option");ce.value=_.value,ce.textContent=_.textContent,v.includes(_.value)&&(ce.selected=!0),L.appendChild(ce),P=!0}),P)v.forEach(_=>{if(!Array.from(L.options||[]).some(X=>X&&X.value===_)){const X=o.createElement("option");X.value=_,X.textContent=_,X.selected=!0,L.appendChild(X)}});else{const _=o.createElement("option");_.value="",_.textContent=r.texts[r.currentLang]?.autoGearMatteboxPlaceholder||texts.en?.autoGearMatteboxPlaceholder||"Select mattebox options",_.disabled=!0,_.selected=!0,L.appendChild(_)}const x=Array.from(L.options||[]).filter(_=>!_.disabled);L.size=computeAutoGearMultiSelectSize(x.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},Mo=function(Me){if(!$)return;const b=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.cameraHandle)?autoGearEditorDraft.cameraHandle:[],v=Array.from(new Set(b.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));$.innerHTML="",$.multiple=!0;const T=o.getElementById("cameraHandle");let P=!1;if(T&&Array.from(T.options).forEach(_=>{if(!_.value)return;const ce=o.createElement("option");ce.value=_.value,ce.textContent=_.textContent,v.includes(_.value)&&(ce.selected=!0),$.appendChild(ce),P=!0}),P)v.forEach(_=>{if(!Array.from($.options||[]).some(X=>X&&X.value===_)){const X=o.createElement("option");X.value=_,X.textContent=_,X.selected=!0,$.appendChild(X)}});else{const _=o.createElement("option");_.value="",_.textContent=r.texts[r.currentLang]?.autoGearCameraHandlePlaceholder||texts.en?.autoGearCameraHandlePlaceholder||"Select camera handles",_.disabled=!0,_.selected=!0,$.appendChild(_)}const x=Array.from($.options||[]).filter(_=>!_.disabled);$.size=computeAutoGearMultiSelectSize(x.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},Jn=function(Me){if(!Me)return"";const b=typeof Me.value=="string"?Me.value:"";return b||"__none__"},ea=function(Me){return Me==="__none__"?r.texts[r.currentLang]?.viewfinderExtensionNone||texts.en?.viewfinderExtensionNone||"No":Me},xn=function(Me){if(Me==="__none__")return r.texts[r.currentLang]?.autoGearVideoDistributionNone||texts.en?.autoGearVideoDistributionNone||"No video distribution selected";const b=r.texts[r.currentLang]?.videoDistributionOptions?.[Me];return b||Me},vn=function(Me){if(typeof Me!="string")return"";const b=Me.trim();if(!b)return"";const v=b.toLowerCase();return v==="__none__"||v==="none"?"__none__":b},ta=function(Me){if(!k)return;const b=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.viewfinderExtension)?autoGearEditorDraft.viewfinderExtension:[],v=Array.from(new Set(b.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));k.innerHTML="",k.multiple=!0;const T=o.getElementById("viewfinderExtension");let P=!1;if(T&&Array.from(T.options).forEach(_=>{const ce=o.createElement("option"),X=Jn(_);ce.value=X,ce.textContent=_.textContent,v.includes(X)&&(ce.selected=!0),k.appendChild(ce),P=!0}),P)v.forEach(_=>{if(!Array.from(k.options||[]).some(X=>X&&X.value===_)){const X=o.createElement("option");X.value=_,X.textContent=ea(_),X.selected=!0,k.appendChild(X)}});else{const _=o.createElement("option");_.value="",_.textContent=r.texts[r.currentLang]?.autoGearViewfinderExtensionPlaceholder||texts.en?.autoGearViewfinderExtensionPlaceholder||"Select viewfinder extension options",_.disabled=!0,_.selected=!0,k.appendChild(_)}const x=Array.from(k.options||[]).filter(_=>!_.disabled);k.size=computeAutoGearMultiSelectSize(x.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},ka=function(Me){if(!Y)return;const b=Ba(Me,"deliveryResolution");Y.innerHTML="",Y.multiple=!0;const v=new Set,T=(x,_)=>{const ce=typeof x=="string"?x.trim():"";if(!ce||v.has(ce))return;const X=o.createElement("option");X.value=ce,X.textContent=_||ce,b.includes(ce)&&(X.selected=!0),Y.appendChild(X),v.add(ce)};if(deliveryResolutionSelect&&Array.from(deliveryResolutionSelect.options||[]).forEach(x=>{if(!x||typeof x.value!="string")return;const _=x.value.trim();if(!_)return;const ce=(x.textContent||_).trim();T(_,ce)}),b.forEach(x=>{v.has(x)||T(x,x)}),!Y.options.length){const x=o.createElement("option");x.value="",x.textContent=r.texts[r.currentLang]?.autoGearDeliveryResolutionPlaceholder||texts.en?.autoGearDeliveryResolutionPlaceholder||"Select delivery resolutions",x.disabled=!0,x.selected=!0,Y.appendChild(x)}const P=Array.from(Y.options||[]).filter(x=>!x.disabled).length;Y.size=computeAutoGearMultiSelectSize(P,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},Ti=function(Me){if(!Q)return;const b=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.videoDistribution)?autoGearEditorDraft.videoDistribution:[],v=Array.from(new Set(b.map(vn).filter(Boolean))),T=v.includes("__none__"),P=v.filter(ye=>ye!=="__none__");Q.innerHTML="",Q.multiple=!0;const x=o.createElement("option");x.value="__none__",x.textContent=xn("__none__"),T&&(x.selected=!0),Q.appendChild(x);const _=o.getElementById("videoDistribution");let ce=!1;if(_&&Array.from(_.options).forEach(ye=>{const Be=vn(ye.value);if(!Be)return;if(Be==="__none__"){T&&(x.selected=!0);return}const Ue=o.createElement("option");Ue.value=Be,Ue.textContent=ye.textContent,P.includes(Be)&&(Ue.selected=!0),Q.appendChild(Ue),ce=!0}),ce)P.forEach(ye=>{if(!Array.from(Q.options||[]).some(Ue=>Ue&&Ue.value===ye)){const Ue=o.createElement("option");Ue.value=ye,Ue.textContent=xn(ye),Ue.selected=!0,Q.appendChild(Ue)}});else{const ye=o.createElement("option");ye.value="",ye.textContent=r.texts[r.currentLang]?.autoGearVideoDistributionPlaceholder||texts.en?.autoGearVideoDistributionPlaceholder||"Select video distribution options",ye.disabled=!0,ye.selected=!0,Q.appendChild(ye)}const X=Array.from(Q.options||[]).filter(ye=>!ye.disabled);Q.size=computeAutoGearMultiSelectSize(X.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},Ba=function(Me,b){const v=Array.isArray(Me)?Me:typeof Me=="string"&&Me?[Me]:Array.isArray(autoGearEditorDraft?.[b])?autoGearEditorDraft[b]:[];return Array.from(new Set(v.filter(T=>typeof T=="string").map(T=>T.trim()).filter(Boolean)))},ra=function(){return Wr},qo=function(Me){Wr=Me||null};var a=o.getElementById("autoGearRuleName"),i=o.getElementById("autoGearRuleNameLabel"),s=o.getElementById("autoGearScenarios"),u=o.getElementById("autoGearScenariosLabel");let Wr=o.getElementById("autoGearScenarioMode");var l=o.getElementById("autoGearScenarioModeLabel"),d=o.getElementById("autoGearScenarioMultiplierContainer"),p=o.getElementById("autoGearScenarioBase"),g=o.getElementById("autoGearScenarioBaseLabel"),h=o.getElementById("autoGearScenarioFactor"),A=o.getElementById("autoGearScenarioFactorLabel"),m=o.getElementById("autoGearShootingDaysMode"),y=o.getElementById("autoGearShootingDays"),S=o.getElementById("autoGearShootingDaysLabel"),E=o.getElementById("autoGearShootingDaysHelp"),I=o.getElementById("autoGearShootingDaysCountLabel"),L=o.getElementById("autoGearMattebox"),R=o.getElementById("autoGearMatteboxLabel"),G=o.getElementById("autoGearMatteboxModeLabel"),j=o.getElementById("autoGearMatteboxMode"),$=o.getElementById("autoGearCameraHandle"),z=o.getElementById("autoGearCameraHandleLabel"),te=o.getElementById("autoGearCameraHandleModeLabel"),oe=o.getElementById("autoGearCameraHandleMode"),k=o.getElementById("autoGearViewfinderExtension"),Z=o.getElementById("autoGearViewfinderExtensionLabel"),ue=o.getElementById("autoGearViewfinderExtensionModeLabel"),H=o.getElementById("autoGearViewfinderExtensionMode"),Y=o.getElementById("autoGearDeliveryResolution"),N=o.getElementById("autoGearDeliveryResolutionLabel"),ae=o.getElementById("autoGearDeliveryResolutionModeLabel"),de=o.getElementById("autoGearDeliveryResolutionMode"),Q=o.getElementById("autoGearVideoDistribution"),ne=o.getElementById("autoGearVideoDistributionLabel"),V=o.getElementById("autoGearVideoDistributionModeLabel"),fe=o.getElementById("autoGearVideoDistributionMode"),J=o.getElementById("autoGearCamera"),Ae=o.getElementById("autoGearCameraLabel"),Le=o.getElementById("autoGearCameraModeLabel"),_e=o.getElementById("autoGearCameraMode"),Je=o.getElementById("autoGearOwnGearLabel"),xe=o.getElementById("autoGearOwnGearModeLabel"),Ze=o.getElementById("autoGearOwnGearMode"),Ve=o.getElementById("autoGearOwnGear"),Dt=o.getElementById("autoGearCameraWeightLabel"),We=o.getElementById("autoGearCameraWeightOperator"),ft=o.getElementById("autoGearCameraWeightOperatorLabel"),D=o.getElementById("autoGearCameraWeightValue"),q=o.getElementById("autoGearCameraWeightValueLabel"),we=o.getElementById("autoGearCameraWeightHelp"),ve=o.getElementById("autoGearMonitor"),Se=o.getElementById("autoGearMonitorLabel"),he=o.getElementById("autoGearMonitorModeLabel"),ge=o.getElementById("autoGearMonitorMode"),pe=o.getElementById("autoGearTripodHeadBrand"),ze=o.getElementById("autoGearTripodHeadBrandLabel"),ke=o.getElementById("autoGearTripodHeadBrandModeLabel"),nt=o.getElementById("autoGearTripodHeadBrandMode"),Ct=o.getElementById("autoGearTripodBowl"),Ot=o.getElementById("autoGearTripodBowlLabel"),xt=o.getElementById("autoGearTripodBowlModeLabel"),or=o.getElementById("autoGearTripodBowlMode"),er=o.getElementById("autoGearTripodTypes"),wr=o.getElementById("autoGearTripodTypesLabel"),Pt=o.getElementById("autoGearTripodTypesModeLabel"),Pr=o.getElementById("autoGearTripodTypesMode"),Wt=o.getElementById("autoGearTripodSpreader"),_t=o.getElementById("autoGearTripodSpreaderLabel"),_r=o.getElementById("autoGearTripodSpreaderModeLabel"),Oe=o.getElementById("autoGearTripodSpreaderMode"),ct=o.getElementById("autoGearCrewPresent"),Gt=o.getElementById("autoGearCrewPresentLabel"),kt=o.getElementById("autoGearCrewPresentModeLabel"),O=o.getElementById("autoGearCrewPresentMode"),U=o.getElementById("autoGearCrewAbsent"),F=o.getElementById("autoGearCrewAbsentLabel"),W=o.getElementById("autoGearCrewAbsentModeLabel"),se=o.getElementById("autoGearCrewAbsentMode"),me=o.getElementById("autoGearWireless"),Re=o.getElementById("autoGearWirelessLabel"),De=o.getElementById("autoGearWirelessModeLabel"),ot=o.getElementById("autoGearWirelessMode"),at=o.getElementById("autoGearMotors"),vt=o.getElementById("autoGearMotorsLabel"),wt=o.getElementById("autoGearMotorsModeLabel"),Qt=o.getElementById("autoGearMotorsMode"),yr=o.getElementById("autoGearControllers"),tr=o.getElementById("autoGearControllersLabel"),rr=o.getElementById("autoGearControllersModeLabel"),bn=o.getElementById("autoGearControllersMode"),io=o.getElementById("autoGearDistance"),$o=o.getElementById("autoGearDistanceLabel"),hn=o.getElementById("autoGearDistanceModeLabel"),Sn=o.getElementById("autoGearDistanceMode"),ei={always:autoGearAlwaysLabel,scenarios:u,shootingDays:S,mattebox:R,cameraHandle:z,viewfinderExtension:Z,deliveryResolution:N,videoDistribution:ne,camera:Ae,ownGear:Je,cameraWeight:Dt,monitor:Se,tripodHeadBrand:ze,tripodBowl:Ot,tripodTypes:wr,tripodSpreader:_t,crewPresent:Gt,crewAbsent:F,wireless:Re,motors:vt,controllers:tr,distance:$o},Xe={always:null,scenarios:s,shootingDays:y,mattebox:L,cameraHandle:$,viewfinderExtension:k,deliveryResolution:Y,videoDistribution:Q,camera:J,ownGear:Ve,cameraWeight:D,monitor:ve,tripodHeadBrand:pe,tripodBowl:Ct,tripodTypes:er,tripodSpreader:Wt,crewPresent:ct,crewAbsent:U,wireless:me,motors:at,controllers:yr,distance:io},ti={mattebox:G,cameraHandle:te,viewfinderExtension:ue,deliveryResolution:ae,videoDistribution:V,camera:Le,ownGear:xe,monitor:he,tripodHeadBrand:ke,tripodBowl:xt,tripodTypes:Pt,tripodSpreader:_r,crewPresent:kt,crewAbsent:W,wireless:De,motors:wt,controllers:rr,distance:hn},br={mattebox:j,cameraHandle:oe,viewfinderExtension:H,deliveryResolution:de,videoDistribution:fe,camera:_e,ownGear:Ze,monitor:ge,tripodHeadBrand:nt,tripodBowl:or,tripodTypes:Pr,tripodSpreader:Oe,crewPresent:O,crewAbsent:se,wireless:ot,motors:Qt,controllers:bn,distance:Sn};Object.values(br).forEach(Me=>{Me&&(Me.disabled=!0)}),n={autoGearRuleNameInput:a,autoGearRuleNameLabel:i,autoGearScenariosSelect:s,autoGearScenariosLabel:u,autoGearScenarioModeSelectElement:Wr,autoGearScenarioModeLabel:l,autoGearScenarioMultiplierContainer:d,autoGearScenarioBaseSelect:p,autoGearScenarioBaseLabel:g,autoGearScenarioFactorInput:h,autoGearScenarioFactorLabel:A,autoGearShootingDaysMode:m,autoGearShootingDaysInput:y,autoGearShootingDaysLabel:S,autoGearShootingDaysHelp:E,autoGearShootingDaysValueLabel:I,autoGearMatteboxSelect:L,autoGearMatteboxLabel:R,autoGearMatteboxModeLabel:G,autoGearMatteboxModeSelect:j,autoGearCameraHandleSelect:$,autoGearCameraHandleLabel:z,autoGearCameraHandleModeLabel:te,autoGearCameraHandleModeSelect:oe,autoGearViewfinderExtensionSelect:k,autoGearViewfinderExtensionLabel:Z,autoGearViewfinderExtensionModeLabel:ue,autoGearViewfinderExtensionModeSelect:H,autoGearDeliveryResolutionSelect:Y,autoGearDeliveryResolutionLabel:N,autoGearDeliveryResolutionModeLabel:ae,autoGearDeliveryResolutionModeSelect:de,autoGearVideoDistributionSelect:Q,autoGearVideoDistributionLabel:ne,autoGearVideoDistributionModeLabel:V,autoGearVideoDistributionModeSelect:fe,autoGearCameraSelect:J,autoGearCameraLabel:Ae,autoGearCameraModeLabel:Le,autoGearCameraModeSelect:_e,autoGearOwnGearLabel:Je,autoGearOwnGearModeLabel:xe,autoGearOwnGearModeSelect:Ze,autoGearOwnGearSelect:Ve,autoGearCameraWeightLabel:Dt,autoGearCameraWeightOperator:We,autoGearCameraWeightOperatorLabel:ft,autoGearCameraWeightValueInput:D,autoGearCameraWeightValueLabel:q,autoGearCameraWeightHelp:we,autoGearMonitorSelect:ve,autoGearMonitorLabel:Se,autoGearMonitorModeLabel:he,autoGearMonitorModeSelect:ge,autoGearTripodHeadBrandSelect:pe,autoGearTripodHeadBrandLabel:ze,autoGearTripodHeadBrandModeLabel:ke,autoGearTripodHeadBrandModeSelect:nt,autoGearTripodBowlSelect:Ct,autoGearTripodBowlLabel:Ot,autoGearTripodBowlModeLabel:xt,autoGearTripodBowlModeSelect:or,autoGearTripodTypesSelect:er,autoGearTripodTypesLabel:wr,autoGearTripodTypesModeLabel:Pt,autoGearTripodTypesModeSelect:Pr,autoGearTripodSpreaderSelect:Wt,autoGearTripodSpreaderLabel:_t,autoGearTripodSpreaderModeLabel:_r,autoGearTripodSpreaderModeSelect:Oe,autoGearCrewPresentSelect:ct,autoGearCrewPresentLabel:Gt,autoGearCrewPresentModeLabel:kt,autoGearCrewPresentModeSelect:O,autoGearCrewAbsentSelect:U,autoGearCrewAbsentLabel:F,autoGearCrewAbsentModeLabel:W,autoGearCrewAbsentModeSelect:se,autoGearWirelessSelect:me,autoGearWirelessLabel:Re,autoGearWirelessModeLabel:De,autoGearWirelessModeSelect:ot,autoGearMotorsSelect:at,autoGearMotorsLabel:vt,autoGearMotorsModeLabel:wt,autoGearMotorsModeSelect:Qt,autoGearControllersSelect:yr,autoGearControllersLabel:tr,autoGearControllersModeLabel:rr,autoGearControllersModeSelect:bn,autoGearDistanceSelect:io,autoGearDistanceLabel:$o,autoGearDistanceModeLabel:hn,autoGearDistanceModeSelect:Sn,autoGearConditionLabels:ei,autoGearConditionSelects:Xe,autoGearConditionLogicLabels:ti,autoGearConditionLogicSelects:br,AUTO_GEAR_CONDITION_KEYS:["always","scenarios","shootingDays","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","cameraWeight","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"],AUTO_GEAR_REPEATABLE_CONDITIONS:new Set(["scenarios","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"]),AUTO_GEAR_CONDITION_FALLBACK_LABELS:{always:"Always include",scenarios:"Required scenarios",shootingDays:"Shooting days condition",mattebox:"Mattebox options",cameraHandle:"Camera handles",viewfinderExtension:"Viewfinder extension",deliveryResolution:"Delivery resolution",videoDistribution:"Video distribution",camera:"Camera",ownGear:"Own gear items",cameraWeight:"Camera weight",monitor:"Onboard monitor",tripodHeadBrand:"Tripod head brand",tripodBowl:"Tripod bowl size",tripodTypes:"Tripod types",tripodSpreader:"Tripod spreader",crewPresent:"Crew present",crewAbsent:"Crew absent",wireless:"Wireless transmitter",motors:"FIZ motors",controllers:"FIZ controllers",distance:"FIZ distance devices"},getViewfinderFallbackLabel:ea,getVideoDistributionFallbackLabel:xn,refreshAutoGearShootingDaysValue:Ga,refreshAutoGearScenarioOptions:Po,refreshAutoGearScenarioBaseSelect:ln,refreshAutoGearMatteboxOptions:Pn,refreshAutoGearCameraHandleOptions:Mo,refreshAutoGearViewfinderExtensionOptions:ta,refreshAutoGearDeliveryResolutionOptions:ka,refreshAutoGearVideoDistributionOptions:Ti,collectAutoGearSelectedValues:Ba,getAutoGearScenarioModeSelectElement:ra,setAutoGearScenarioModeSelectElement:qo,normalizeVideoDistributionOptionValue:vn}}return n}const hs=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,VF=typeof document<"u"&&document||null,Ou=qF(VF,{globalScope:hs});hs&&typeof hs=="object"&&(hs.cineCoreAutoGearUi=Ou,hs.getViewfinderFallbackLabel=Ou.getViewfinderFallbackLabel,hs.getVideoDistributionFallbackLabel=Ou.getVideoDistributionFallbackLabel,hs.normalizeVideoDistributionOptionValue=Ou.normalizeVideoDistributionOptionValue);const xb=Ou;function WF(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}const Dw=jc||WF,wc=["productionCompanyAddress","productionCompanyStreet","productionCompanyStreet2","productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode","productionCompanyCountry"],KF={productionCompany:["Production Company","Produktionsfirma","Société de production","Productora","Casa di produzione"],productionCompanyAddress:["Production Company Address","Adresse der Produktionsfirma","Adresse de la société de production","Dirección de la productora","Indirizzo della casa di produzione"],productionCompanyStreet:["Street address","Straße und Hausnummer","Adresse","Dirección","Indirizzo"],productionCompanyStreet2:["Address line 2","Adresszusatz","Complément d'adresse","Línea 2 de dirección","Seconda linea indirizzo"],productionCompanyCity:["City","Stadt","Ville","Ciudad","Città"],productionCompanyRegion:["State / Province / Region","Bundesland / Region","État / Région / Département","Estado / Provincia / Región","Regione / Provincia / Stato"],productionCompanyPostalCode:["Postal code","Postleitzahl","Code postal","Código postal","CAP"],productionCompanyCountry:["Country","Land","Pays","País","Paese"]};function ME(e){return typeof e!="string"?"":e.trim().replace(/[:：]\s*$/,"").trim()}function rG(e){const t=typeof window<"u"&&window.texts?window.texts:null,r={},o=t&&t.en&&t.en.projectFields||{};return["productionCompany"].concat(wc).forEach(a=>{const i=new Set,s=l=>{if(typeof l!="string")return;const d=ME(l);d&&i.add(d)};e&&e[a]&&s(e[a]),o&&o[a]&&s(o[a]);const u=KF[a];Array.isArray(u)&&u.forEach(s),r[a]=i}),r}function _w(e,t){if(!e||typeof e!="object")return[];const r=e[t];if(r==null)return[];if(Array.isArray(r)){const o=[];return r.forEach(n=>{if(n==null)return;(typeof n=="string"?n:String(n)).split(/\r?\n/).forEach(i=>{const s=i.trim();s&&o.push(s)})}),o}return typeof r=="string"?r.split(/\r?\n/).map(o=>o.trim()).filter(o=>o):[String(r)].map(o=>o.trim()).filter(o=>o)}function YF(e,t){const r=[],o=[],n=rG(t),a=new Set;Object.values(n).forEach(g=>{g&&g.forEach(h=>{typeof h=="string"&&h&&a.add(h)})});const i=g=>typeof g!="string"||!g.trim()?!1:a.has(ME(g)),s=(g,h,A)=>{if(typeof g!="string")return;const m=g.trim();if(!m)return;const y=Dw(m),S=Array.isArray(A)?A.filter(I=>typeof I=="string"&&I.trim()):[],E=S.length?` data-fields="${Dw(S.join(" "))}"`:"";r.push(h?`<span class="${h}"${E}>${y}</span>`:y),o.push(m)},u={entries:[],indexMap:new Map},l=(g,h)=>{if(typeof g!="string")return;const A=g.trim();if(!A||i(A))return;const m=A.toLowerCase();let y=u.indexMap.get(m);y||(y={value:A,fields:[]},u.entries.push(y),u.indexMap.set(m,y)),typeof h=="string"&&wc.includes(h)&&!y.fields.includes(h)&&y.fields.push(h)};_w(e,"productionCompany").forEach(g=>s(g,"req-primary-line")),wc.forEach(g=>{const h=_w(e,g);h.length&&h.forEach(A=>l(A,g))});const{entries:p}=u;if(p.length){const g=new Set(["productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode"]),h={productionCompanyCity:[],productionCompanyRegion:[],productionCompanyPostalCode:[]},A=[];let m=null;p.forEach($=>{const{value:z,fields:te}=$;(Array.isArray(te)?te.some(k=>g.has(k)):!1)?(m===null&&(m=A.length),te.forEach(k=>{g.has(k)&&h[k].push(z)})):A.push($)});const y=$=>{if(!Array.isArray($))return"";const z=$.find(te=>typeof te=="string"&&te.trim());return z?z.trim():""},S=y(h.productionCompanyCity),E=y(h.productionCompanyRegion),I=y(h.productionCompanyPostalCode),L=[],R=[];S&&(L.push(S),R.push("productionCompanyCity"));const G=[];if(E&&(G.push(E),R.push("productionCompanyRegion")),I&&(G.push(I),R.push("productionCompanyPostalCode")),G.length){const $=G.join(", ");L.push($)}const j=L.join(", ").trim();if(j){const $=j.toLowerCase();if(!A.some(te=>{const oe=typeof te.value=="string"?te.value.trim():"";return oe&&oe.toLowerCase()===$})){const te=m===null?A.length:m;A.splice(te,0,{value:j,fields:R})}}A.forEach($=>{const{value:z,fields:te}=$;s(z,"req-sub-line",te)})}return r.length?{__html:r.join("<br>"),text:o.join(`
`)}:null}function QF(e,t,r){if(!e||typeof e!="object")return!1;const n=YF(t&&typeof t=="object"?t:e,r);return n?(e.productionCompany=n,wc.forEach(a=>{Object.prototype.hasOwnProperty.call(e,a)&&delete e[a]}),!0):!1}function XF(e,t,r){if(typeof e!="string")return null;const o=e.replace(/\r\n?/g,`
`).split(`
`).map(p=>p.trim()).filter(p=>p);if(!o.length)return null;const n=rG(t),a={},[i,...s]=o;i&&(a.productionCompany=i);const u=Array.isArray(r?.lines)?r.lines:null;if(u&&u.length){const p={};if(u.forEach(g=>{if(!g||typeof g.text!="string")return;const h=g.text.trim();if(!h)return;let A=g.fields;typeof A=="string"&&(A=A.split(/\s+/)),!(!Array.isArray(A)||!A.length)&&A.map(m=>typeof m=="string"?m.trim():"").filter(m=>m&&wc.includes(m)).forEach(m=>{p[m]||(p[m]=[]),p[m].push(h)})}),Object.keys(p).length){if(p.productionCompanyAddress&&p.productionCompanyAddress.length&&(a.productionCompanyAddress=p.productionCompanyAddress.join(`
`)),p.productionCompanyStreet&&p.productionCompanyStreet.length){const h=p.productionCompanyStreet;if([a.productionCompanyStreet]=h,h.length>1){const A=h.slice(1).join(`
`);A&&(a.productionCompanyStreet2=A)}}if(p.productionCompanyStreet2&&p.productionCompanyStreet2.length){const h=p.productionCompanyStreet2.join(`
`);h&&(a.productionCompanyStreet2=a.productionCompanyStreet2?`${a.productionCompanyStreet2}
${h}`:h)}const g=h=>{if(!p[h]||!p[h].length)return;const A=p[h].join(" ");A&&(a[h]=A)};return["productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode","productionCompanyCountry"].forEach(g),a}}const l={};let d=null;if(s.forEach(p=>{const g=ME(p);let h=null;if(wc.forEach(A=>{h||!n[A]||n[A].has(g)&&(h=A)}),h){d=h,l[d]||(l[d]=[]);return}if(!d){a.productionCompany?a.productionCompany+=`
${p}`:a.productionCompany=p;return}l[d]||(l[d]=[]),l[d].push(p)}),l.productionCompanyAddress&&l.productionCompanyAddress.length&&(a.productionCompanyAddress=l.productionCompanyAddress.join(`
`)),l.productionCompanyStreet&&l.productionCompanyStreet.length){const p=l.productionCompanyStreet;a.productionCompanyStreet=p[0],p.length>1&&(a.productionCompanyStreet2=p.slice(1).join(`
`))}if(l.productionCompanyStreet2&&l.productionCompanyStreet2.length){const p=l.productionCompanyStreet2.join(`
`);a.productionCompanyStreet2?a.productionCompanyStreet2+=`
${p}`:a.productionCompanyStreet2=p}return l.productionCompanyCity&&l.productionCompanyCity.length&&(a.productionCompanyCity=l.productionCompanyCity.join(" ")),l.productionCompanyRegion&&l.productionCompanyRegion.length&&(a.productionCompanyRegion=l.productionCompanyRegion.join(" ")),l.productionCompanyPostalCode&&l.productionCompanyPostalCode.length&&(a.productionCompanyPostalCode=l.productionCompanyPostalCode.join(" ")),l.productionCompanyCountry&&l.productionCompanyCountry.length&&(a.productionCompanyCountry=l.productionCompanyCountry.join(" ")),a}const ZF=(function(){if(typeof globalThis<"u"&&typeof globalThis.deriveProjectInfo=="function"){const t=globalThis.deriveProjectInfo;if(t&&t.name!=="fallbackDeriveProjectInfo")return t}return function(r){return r||{}}})();function JF(e=""){if(typeof window<"u"&&typeof window.getCurrentProjectName=="function")try{const t=window.getCurrentProjectName();if(typeof t=="string"&&t.trim())return t}catch{}return e}function Cn(e,t,r){if(typeof r=="function")try{return r(e,t)}catch{}return jA(e,t)}function Yr(e){return e?`<span class="info-label-inline">${e}: </span>`:""}function eN(e,t,r,o,n,a){if(!Array.isArray(e)||e.length===0)return"";const i=e.map(d=>{if(!d)return"";const p=d.type||d.name||"Unknown",g=d.voltage||d.voltageRange?` (${d.voltage||d.voltageRange}V)`:"",h=d.maxA?` ${d.maxA}A`:"",A=d.notes?` [${d.notes}]`:"";return`${p}${g}${h}${A}`}).filter(Boolean);if(i.length===0)return"";const s=o?`${o}${n?` ${n}`:""}`:"",u=Yr(s),l=Cn(t,"connector-icon",a);return`<span class="connector-block ${r}">${l}${u}${i.join(", ")}</span>`}function oG(e){let t=Math.floor(e/4);const r=e%4;let o=0,n=0;return r===0||(r===3?t+=1:r>0&&(o+=1)),{quad:t,dual:o,single:n}}function nG(e,{devices:t}={}){if(!e)return e;const r=t||{},o=[r.viewfinders,r.directorMonitors,r.iosVideo,r.videoAssist,r.media,r.lenses];for(const n of o)if(n&&n[e]){const a=n[e];return a.brand&&a.brand.toUpperCase().includes("ARRI")&&a.kNumber&&!e.includes(a.kNumber)?e.replace(/^ARRI\s*/i,`ARRI ${a.kNumber} `):e}if(r.accessories){const n=a=>{if(!a)return null;if(a[e])return a[e];for(const i of Object.values(a))if(i&&typeof i=="object"){const s=n(i);if(s)return s}return null};for(const a of Object.values(r.accessories)){const i=n(a);if(i)return i.brand&&i.brand.toUpperCase().includes("ARRI")&&i.kNumber&&!e.includes(i.kNumber)?/^ARRI\s*/i.test(e)?e.replace(/^ARRI\s*/i,`ARRI ${i.kNumber} `):`ARRI ${i.kNumber} ${e}`:e}}return e}const tN=e=>(e||"").replace(/[()]/g,"").replace(/\s{2,}/g," ").trim(),ai=(e,t)=>{const r=tN(t);return r?`${e} (${r})`:e};function aG(e={}){const{camera:t="",motors:r=[],controllers:o=[],distance:n="",devices:a={}}=e,i="LBUS to LBUS 0,5m",s="Cable UDM – SERIAL (4p) 0,5m",u="Cable UDM – SERIAL (7p) 1,5m",l=[],d=[],p=[],g=r[0]||"",h=o.includes("Arri Master Grip (single unit)"),A=o.includes("Arri RIA-1");let m=n.includes("UDM"),y=n.includes("LCube");y&&(A||t==="Arri Alexa 35")&&(y=!1);const S=/cforce mini rf/i.test(g),E=/cforce mini/i.test(g)&&!S,I=g?`for ${g}`:"for FIZ motor",L="for Arri Master Grip (single unit)",R=n?`for ${n}`:"for distance sensor",G=[];A&&G.push("Arri RIA-1"),S&&G.push("Arri cforce mini RF");const j=G[0]||o[0]||"",$=(z,te)=>{const oe=String(z).replace(".",","),k=te||I;l.push(ai(`LBUS to LBUS ${oe}m`,k)),d.push(Number(z))};if((t==="Arri Alexa Mini"||t==="Arri Alexa Mini LF")&&E?($(.3),y&&$(.4,R),h&&$(.5,L)):t==="Arri Alexa 35"&&E?($(.3),h&&$(.5,L)):S?(y&&$(.4,R),h&&$(.5,L)):A&&E&&($(.4),h&&$(.5,L)),G.length){const z=a.accessories?.cables||{};let te=null;for(const[oe,k]of Object.entries(z)){const Z=[];Array.isArray(k.connectors)&&Z.push(...k.connectors),k.from&&Z.push(k.from),k.to&&Z.push(k.to),!(!Z.some(Y=>/CAM \(7-pin/i.test(Y))||!(k.compatibleControllers||[]).some(Y=>G.some(N=>Y.toLowerCase().includes(N.toLowerCase())))||!(!k.compatibleCameras||k.compatibleCameras.some(Y=>Y.toLowerCase()===t.toLowerCase())))&&(!te||(k.lengthM??1/0)<(z[te].lengthM??1/0))&&(te=oe)}if(te){const oe=t?`for ${t}`:"for camera control";l.push(ai(te,oe)),p.push(te)}else if(A&&z["Cable CAM (7-pin) – D-Tap 0,5m"]){const oe="Cable CAM (7-pin) – D-Tap 0,5m",k=j?`for ${j} power`:"for controller power";l.push(ai(oe,k)),p.push(oe)}}if(m&&(y?l.push(ai(u,R)):(l.push(ai(s,R)),l.push(ai(s,"spare")))),d.length){const z=Math.min(...d),te=String(z).replace(".",",");l.push(ai(`LBUS to LBUS ${te}m`,"spare")),l.push(ai(i,"spare"))}return p.forEach(z=>l.push(ai(z,"spare"))),l}function iG(e,t={}){if(!e||typeof e!="object")return"";const{focusScalePreference:r,normalizeFocusScale:o,currentLang:n="en",diagramConnectorIcons:a={},powerInputTypes:i=()=>[],ICON_GLYPHS:s={},DIAGRAM_MONITOR_ICON:u,parseBatteryCurrentLimit:l=H=>Number(H),iconMarkup:d=jA}=t,p=H=>{if(typeof H!="string")return"";const Y=H.trim().toLowerCase();return Y==="imperial"||Y==="metric"?Y:""},h=(()=>{const H=r||"metric";if(typeof o=="function")try{const N=o(H);if(N==="imperial"||N==="metric")return N}catch{}return p(H)||"metric"})(),A=(H,Y={})=>{const N=typeof H=="string"?Number(H):H;if(!Number.isFinite(N))return"";const ae=typeof Y.maximumFractionDigits=="number"?Y.maximumFractionDigits:0,de=typeof Y.minimumFractionDigits=="number"?Y.minimumFractionDigits:Math.min(0,ae);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{return new Intl.NumberFormat(n,{maximumFractionDigits:ae,minimumFractionDigits:de}).format(N)}catch{}const Q=Math.max(de,Math.min(20,ae));try{return N.toFixed(Q)}catch{}return String(N)},m=(H,Y=h)=>{const N=typeof H=="string"?Number(H):H;if(!Number.isFinite(N))return"";if(Y==="imperial"){const Q=N/453.59237,ne=Q>=10?1:2,V=A(Q,{maximumFractionDigits:ne,minimumFractionDigits:0});return V?`${V} lb`:""}const de=A(N,{maximumFractionDigits:0,minimumFractionDigits:0});return de?`${de} g`:""};let y="";const S=[{items:e.power?.powerDistributionOutputs,icon:a.powerOut,cls:"power-conn",label:"Power",dir:"Out"},{items:i(e).map(H=>({type:H})),icon:a.powerIn,cls:"power-conn",label:"Power",dir:"In"},{items:e.fizConnectors,icon:a.fiz,cls:"fiz-conn",label:"FIZ Port"},{items:e.video?.inputs||e.videoInputs,icon:a.video,cls:"video-conn",label:"Video",dir:"In"},{items:e.video?.outputs||e.videoOutputs,icon:a.video,cls:"video-conn",label:"Video",dir:"Out"},{items:e.timecode,icon:a.timecode,cls:"neutral-conn",label:"Timecode"},{items:e.audioInput?.portType?[{type:e.audioInput.portType}]:void 0,icon:a.audioIn,cls:"neutral-conn",label:"Audio",dir:"In"},{items:e.audioOutput?.portType?[{type:e.audioOutput.portType}]:void 0,icon:a.audioOut,cls:"neutral-conn",label:"Audio",dir:"Out"},{items:e.audioIo?.portType?[{type:e.audioIo.portType}]:void 0,icon:a.audioIo,cls:"neutral-conn",label:"Audio",dir:"I/O"}];for(const{items:H,icon:Y,cls:N,label:ae,dir:de}of S)y+=eN(H,Y,N,ae,de,d);let E="";const I=H=>String(H).replace(/[&<>"']/g,Y=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"})[Y]);if(typeof e.powerDrawWatts=="number"&&(E+=`<span class="info-box power-conn">${Cn(a.powerSpec,"",d)}${Yr("Power")}${e.powerDrawWatts} W</span>`),e.power?.input?.voltageRange&&(E+=`<span class="info-box power-conn">${Cn(s.batteryBolt,"",d)}${Yr("Voltage")}${I(String(e.power.input.voltageRange))}V</span>`),typeof e.weight_g=="number"){const H=m(e.weight_g);H&&(E+=`<span class="info-box neutral-conn">${Cn(s.gears,"",d)}${Yr("Weight")}${I(H)}</span>`)}typeof e.capacity=="number"&&(E+=`<span class="info-box power-conn">${Cn(s.batteryFull,"",d)}${Yr("Capacity")}${e.capacity} Wh</span>`);const L=l(e.pinA);Number.isFinite(L)&&L>0&&(E+=`<span class="info-box power-conn">${Yr("Pins")}${L}A</span>`),typeof e.dtapA=="number"&&(E+=`<span class="info-box power-conn">${Yr("D-Tap")}${e.dtapA}A</span>`),e.mount_type&&(E+=`<span class="info-box power-conn">${Yr("Mount")}${I(String(e.mount_type))}</span>`),typeof e.screenSizeInches=="number"&&(E+=`<span class="info-box video-conn">${Cn(u,"",d)}${Yr("Screen")}${e.screenSizeInches}"</span>`),typeof e.brightnessNits=="number"&&(E+=`<span class="info-box video-conn">${Cn(s.brightness,"",d)}${Yr("Brightness")}${e.brightnessNits} nits</span>`),typeof e.wirelessTx=="boolean"&&(E+=`<span class="info-box video-conn">${Cn(s.wifi,"",d)}${Yr("Wireless")}${e.wirelessTx}</span>`),e.internalController&&(E+=`<span class="info-box fiz-conn">${Cn(a.controller,"",d)}${Yr("Controller")}Internal</span>`),typeof e.torqueNm=="number"&&(E+=`<span class="info-box fiz-conn">${Cn(a.torque,"",d)}${Yr("Torque")}${e.torqueNm} Nm</span>`),e.powerSource&&(E+=`<span class="info-box power-conn">${Cn(a.powerSource,"",d)}${Yr("Power Source")}${I(String(e.powerSource))}</span>`);const R=H=>{if(!Array.isArray(H))return[];const Y=new Set,N=[];return H.forEach(ae=>{const de=ae!=null?String(ae).trim():"";!de||Y.has(de)||(Y.add(de),N.push(I(de)))}),N},G=(H,Y,N,ae,de)=>{const Q=R(Y);if(!Q.length)return H;const ne=Cn(de,"",d),V=Yr(N),fe=`<span class="info-box-values">${Q.join(", ")}</span>`;return`${H}<span class="info-box ${ae} info-box-list">${ne}${V}${fe}</span>`};let j="";if(Array.isArray(e.sensorModes)&&(j=G(j,e.sensorModes,"Sensor Modes","video-conn",s.sensor)),Array.isArray(e.resolutions)&&(j=G(j,e.resolutions,"Resolutions","video-conn",s.screen)),Array.isArray(e.frameRates)){const H=a?.timecode||s.camera;j=G(j,e.frameRates,"Frame Rates","video-conn",H)}if(Array.isArray(e.recordingCodecs)&&(j=G(j,e.recordingCodecs,"Codecs","video-conn",s.camera)),Array.isArray(e.recordingMedia)){const H=e.recordingMedia.map(Y=>Y&&Y.type?Y.type:"");j=G(j,H,"Media","video-conn",s.save)}let $="";if(Array.isArray(e.power?.batteryPlateSupport)&&e.power.batteryPlateSupport.length){const H=e.power.batteryPlateSupport.map(Y=>{const N=Y.mount?` (${I(Y.mount)})`:"";return`${I(Y.type)}${N}`});$+=`<span class="info-box power-conn">${Yr("Battery Plate")}${H.join(", ")}</span>`}if(Array.isArray(e.viewfinder)&&e.viewfinder.length){const H=e.viewfinder.map(Y=>I(Y.type));$+=`<span class="info-box video-conn">${Yr("Viewfinder")}${H.join(", ")}</span>`}if(Array.isArray(e.gearTypes)&&e.gearTypes.length){const H=e.gearTypes.map(Y=>I(Y));$+=`<span class="info-box fiz-conn">${Yr("Gear")}${H.join(", ")}</span>`}e.connectivity&&($+=`<span class="info-box video-conn">${Yr("Connectivity")}${I(String(e.connectivity))}</span>`),e.notes&&($+=`<span class="info-box neutral-conn">${Yr("Notes")}${I(String(e.notes))}</span>`);let z="";if(Array.isArray(e.lensMount)){const H=e.lensMount.map(Y=>{const N=Y.mount?` (${I(Y.mount)})`:"";return`<span class="info-box neutral-conn">${I(Y.type)}${N}</span>`}).join("");H&&(z=`<div class="lens-mount-box">${H}</div>`)}let te="";const oe=(H,Y)=>Y?`<div class="info-label">${H}</div>${Y}`:"";te+=oe("Ports",y),te+=oe("Specs",E),te+=oe("Recording",j),te+=oe("Extras",$),z&&(te+=`<div class="info-label">Lens Mount</div>${z}`);const k=new Set(["power","powerDrawWatts","weight_g","capacity","pinA","dtapA","mount_type","screenSizeInches","brightnessNits","wirelessTx","internalController","torqueNm","powerSource","sensorModes","resolutions","frameRates","recordingCodecs","recordingMedia","viewfinder","gearTypes","connectivity","notes","lensMount","video","videoInputs","videoOutputs","fizConnectors","timecode","audioInput","audioOutput","audioIo"]);let Z="";const ue=H=>H.replace(/([A-Z])/g," $1").replace(/^./,Y=>Y.toUpperCase()).replace(/_/g," ").trim();return Object.entries(e).forEach(([H,Y])=>{if(k.has(H)||Y==null||Y==="")return;if(H==="verified_source"){const ae=String(Y);Z+=`<span class="info-box neutral-conn"><a href="${I(ae)}" target="_blank" rel="noopener noreferrer" style="color:inherit;text-decoration:underline;">Source</a></span>`;return}const N=ue(H);if(Array.isArray(Y)){const ae=Y.map(de=>typeof de=="string"?de:JSON.stringify(de));if(ae.length){const de=`<span class="info-box-values">${ae.map(I).join(", ")}</span>`,Q=s&&s.fileText?Cn(s.fileText,"",d):"";Z+=`<span class="info-box neutral-conn info-box-list">${Q}${Yr(N)}${de}</span>`}}else if(typeof Y!="object"){let ae=String(Y);typeof Y=="boolean"&&(ae=Y?"Yes":"No"),Z+=`<span class="info-box neutral-conn">${Yr(N)}${I(ae)}</span>`}}),Z&&(te+=oe("Other Attributes",Z)),te?`<div class="connector-summary">${te}</div>`:""}function rN(e,t,r,o){if(e)return gT(e,t,r,o)}var Te=jc;const Pv=ZF,Fw=xb&&typeof xb.normalizeVideoDistributionOptionValue=="function"?xb.normalizeVideoDistributionOptionValue:function(t){if(typeof t!="string")return"";const r=t.trim();if(!r)return"";const o=r.toLowerCase();return o==="__none__"||o==="none"?"__none__":r},Df=wx||{};if(Df&&typeof Df.loadLanguage=="function"){const e=typeof currentLang=="string"&&currentLang||typeof DEFAULT_LANGUAGE_SAFE=="string"&&DEFAULT_LANGUAGE_SAFE||Df.defaultLanguage||"en";try{const t=Df.loadLanguage(e);t&&typeof t.then=="function"&&t.catch(r=>{console.warn("Failed to prepare translations for setups module",r)})}catch(t){console.warn("Could not prepare translations runtime for setups module",t)}}const pn=rN,Nw=typeof globalThis<"u"&&globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN?globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN:"__any__";function $c(e=""){return JF(e)}const kd=["A","B","C","D","E"],Hw="cameraPowerPlanner_cameraColors",oN=["ARRI K2.0019797 HEX-3","ARRI K2.0023751 B-Mount Battery Adapter","ARRI K2.74000.0 VEB-3 Viewfinder Extension Bracket","ARRI KK.0037820 Handle Extension Set",'SHAPE Telescopic Handle ARRI Rosette Kit 12"'];let tu=null;function nN(){return tu instanceof Set&&tu.size?tu:typeof normalizeGearNameForComparison!="function"?new Set:(tu=new Set(oN.map(e=>normalizeGearNameForComparison(e))),tu)}function aN(e){if(!e||typeof normalizeGearNameForComparison!="function")return"";const t=Ar(e),r=normalizeGearNameForComparison(t);return nN().has(r)?t:""}function jw(e,t,r){return QF(e,t,r)}function iN(e,t,r){return XF(e,t,r)}const ws="temporary-extras",oa=typeof Object.freeze=="function"?Object.freeze:e=>e;let fm=null,xv=!0;function sN(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function zw(e,t){if(!e||!t)return e;const r=new RegExp(`^${sN(t)}\\s+`,"i");return e.replace(r,"").trim()}function lN(e){if(!e)return!1;const t=e.trim();return t?!!(/^T\d+/i.test(t)||/^f\//i.test(t)||/\d/.test(t)&&(/(?:mm|cm|m|°|ft)$/i.test(t)||/^\d+(?:\.\d+)?x$/i.test(t)||/^\d+-\d+/.test(t))):!1}function cN(e,t){return e&&typeof e.brand=="string"&&e.brand.trim()?e.brand.trim():(typeof t=="string"?t.trim().split(/\s+/)[0]:"")||"Other"}function uN(e,t){if(typeof e!="string"||!e.trim())return"General";let r=e.trim();if(t&&r.toLowerCase().startsWith(t.toLowerCase())&&(r=r.slice(t.length).trim()),!r)return"General";const o=r.split(/\s+/),n=[];for(let i=0;i<o.length;i+=1){const s=o[i];if(lN(s))break;n.push(s)}return n.join(" ").trim()||"General"}function dN(e,t,r){const o=zw(e||"",t||"");return zw(o,r||"").trim()}function fN(...e){for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r!="string")continue;const n=r.toLowerCase().indexOf("mm"),i=(n===-1?r:r.slice(0,n)).match(/\d+(?:\.\d+)?/g);if(i&&i.length){const s=i.map(u=>Number(u)).filter(Number.isFinite);if(s.length)return Math.min(...s)}}return Number.POSITIVE_INFINITY}function sG(e,t){const r=cN(t,e),o=uN(e,r),n=dN(e,r,o),a=fN(n,e);return{manufacturer:r,series:o,focalLabel:n,focalSortKey:a}}function sa(e,t){const r=typeof e=="string"?e:"",o=typeof t=="string"?t:"";return typeof localeSort=="function"?localeSort(r,o):r.localeCompare(o,void 0,{sensitivity:"base"})}const es=(()=>{const e=typeof document<"u"?document:null,t={snapshot(){return{names:[],lensSelections:[],legacyValue:""}},applyInfo(){},refreshCatalog(){},getSelections(){return[]}};if(!e)return t;const r=e.getElementById("lensManufacturer"),o=e.getElementById("lensSeries"),n=e.getElementById("lensManufacturerStep"),a=e.getElementById("lensSeriesStep"),i=e.getElementById("lensOptionsStep"),s=e.getElementById("lensOptions"),u=e.getElementById("lensOptionsEmpty"),l=e.getElementById("lensSeriesEmpty"),d=e.getElementById("lensSelectionChips"),p=e.getElementById("lensSelectionsValue"),g=e.getElementById("lensSelectionsData"),h=e.getElementById("lenses"),A=e.getElementById("lensManufacturerPlaceholder"),m=e.getElementById("lensSeriesPlaceholder");if(!r||!o||!s||!d||!p||!g||!h)return t;const y="data-remove-template",S="data-mount-label",E="lens-step-disabled",I=new Set(["LDS"]),L=new Map([["B4","B4"],["DJI DL","DJI DL"],["DJI DL-S","DJI DL-S"],["DL","DJI DL"],["E","E-mount"],["E-mount","E-mount"],["Sony E","E-mount"],["EF","EF"],["F","F"],["Hasselblad","Hasselblad"],["L","L-Mount"],["L-Mount","L-Mount"],["Leica L","L-Mount"],["Leica M","Leica M"],["Leitz M Mount for ARRI","Leica M"],["M","Leica M"],["MFT","MFT"],["PL","PL"],["PV","PV"],["PV70","PV70"],["RF","RF"],["X","X-mount"],["X-mount","X-mount"],["XPL52","XPL52"],["Z","Z-mount"],["Z-mount","Z-mount"]]),R=typeof localeSort=="function"?localeSort:void 0,G={manufacturer:"",series:"",selections:[]};let j={manufacturers:new Map,lensIndex:new Map};const $=new Map,z=D=>{const q=j.lensIndex.get(D);if(!q||typeof q!="object")return[];const we=new Map,ve=[],Se=(pe,ze="native")=>{const ke=typeof pe=="string"?pe.trim():"";if(!ke)return;const nt=typeof ze=="string"&&ze.trim().toLowerCase()==="adapted"?"adapted":"native";if(we.has(ke)){const Ot=we.get(ke);Ot&&Ot.status!=="native"&&nt==="native"&&(Ot.status="native");return}const Ct={type:ke,status:nt};we.set(ke,Ct),ve.push(ke)},he=(pe,ze="native")=>{if(!pe)return;const ke=k(pe);if(Array.isArray(ke)&&ke.length){ke.forEach(nt=>Se(nt,ze));return}Se(pe,ze)},ge=q?.data?.mountOptions;return Array.isArray(ge)&&ge.length&&ge.forEach(pe=>{if(!pe)return;const ze=typeof pe.mount=="string"&&pe.mount.trim().toLowerCase()==="adapted"?"adapted":"native";he(pe.type,ze)}),!ve.length&&Array.isArray(q.mountLabels)&&q.mountLabels.length&&q.mountLabels.forEach(pe=>Se(pe,"native")),ve.length||he(q?.data?.mount,"native"),ve.map(pe=>we.get(pe)).filter(pe=>pe&&pe.type)},te=D=>z(D).map(q=>q.type),oe=(D,q)=>{D&&(q?D.classList.add("select-placeholder"):D.classList.remove("select-placeholder"))},k=D=>{const q=[],we=new Set,ve=he=>{!he||we.has(he)||(we.add(he),q.push(he))},Se=he=>{if(!he||typeof he!="string")return;he.replace(/\([^)]*\)/g," ").replace(/ or /gi,"/").replace(/\\/g,"/").split("/").forEach(pe=>{pe.split(",").forEach(ze=>{const ke=ze.trim();if(!ke||I.has(ke))return;const nt=L.has(ke)?L.get(ke):ke;nt&&ve(nt)})})};return Array.isArray(D)?D.forEach(he=>Se(he)):Se(D),q},Z=()=>{const D=typeof devices=="object"&&devices&&devices.lenses&&Object.keys(devices.lenses).length?devices.lenses:null;return D||(typeof devices=="object"&&devices&&devices.accessories&&devices.accessories.lenses?devices.accessories.lenses:{})},ue=()=>{const D=Z(),q=new Map,we=new Map,ve=Object.keys(D||{});return ve.length&&R?ve.sort(R):ve.sort(),ve.forEach(Se=>{const he=D[Se]||{},ge=sG(Se,he),{manufacturer:pe,series:ze,focalLabel:ke,focalSortKey:nt}=ge,Ct=k(he.mount),Ot={name:Se,data:he,manufacturer:pe,series:ze,displayName:Se,focalLabel:ke,focalSortKey:nt,mountLabels:Ct,optionMeta:Ct[0]?`Mount: ${Ct[0]}`:""};q.has(pe)||q.set(pe,new Map);const xt=q.get(pe);xt.has(ze)||xt.set(ze,[]),xt.get(ze).push(Ot),we.set(Se,Ot)}),q.forEach(Se=>{Se.forEach(he=>{!Array.isArray(he)||!he.length||he.sort((ge,pe)=>{const ze=Number.isFinite(ge.focalSortKey),ke=Number.isFinite(pe.focalSortKey);return ze&&ke&&ge.focalSortKey!==pe.focalSortKey?ge.focalSortKey-pe.focalSortKey:ze!==ke?ze?-1:1:ge.focalLabel&&pe.focalLabel&&ge.focalLabel!==pe.focalLabel?sa(ge.focalLabel,pe.focalLabel):sa(ge.displayName,pe.displayName)})})}),{manufacturers:q,lensIndex:we}},H=D=>!D||typeof D.type!="string"?"":k(D.type)[0]||"",Y=()=>{const D=e.getElementById("cameraSelect"),q=D&&typeof D.value=="string"?D.value:"";if(!q||typeof devices!="object"||!devices||!devices.cameras)return[];const we=devices.cameras[q];if(!we||!Array.isArray(we.lensMount))return[];const ve=new Map,Se=[];return we.lensMount.forEach(he=>{if(!he)return;const ge=H(he);if(!ge)return;const pe=typeof he.mount=="string"&&he.mount.trim().toLowerCase()==="adapted"?"adapted":"native";if(ve.has(ge)){const ke=ve.get(ge);ke&&ke.status!=="native"&&pe==="native"&&(ke.status="native");return}const ze={type:ge,status:pe};ve.set(ge,ze),Se.push(ge)}),Se.map(he=>ve.get(he)).filter(he=>he&&he.type)},N=(D,q)=>{const we=[],ve=new Set,Se=ze=>{if(!ze)return;const ke=ze.trim();!ke||ve.has(ke)||(ve.add(ke),we.push(ke))};te(q).forEach(Se);const ge=typeof D=="string"?D.trim():"",pe=ge&&ve.has(ge);return{options:we,hiddenValue:pe?"":ge}},ae=(D,q="")=>{const we=z(D),ve=we.map(ke=>ke.type),Se=Y(),he=ke=>{if(!ke)return"";const nt=Se.find(Ot=>Ot.type===ke&&Ot.status==="native")||Se.find(Ot=>Ot.type===ke);if(nt)return nt.status;const Ct=we.find(Ot=>Ot.type===ke);return Ct?Ct.status:""},ge=typeof q=="string"?q.trim():"";if(ge&&ve.includes(ge))return{mount:ge,status:he(ge)};const pe=Se.find(ke=>ke.status==="native"&&ve.includes(ke.type));if(pe)return{mount:pe.type,status:he(pe.type)};const ze=Se.find(ke=>ke.status==="adapted"&&ve.includes(ke.type));if(ze)return{mount:ze.type,status:he(ze.type)};if(we.length){const ke=we[0].type,nt=he(ke),Ct=Se.length>0,Ot=Se.some(or=>or.type===ke);let xt=nt;return(!Ot&&Ct||!xt&&Ct)&&(xt="adapted"),{mount:ke,status:xt}}return{mount:"",status:""}},de=D=>typeof D!="string"?"":D.trim(),Q=()=>{const D=!!G.manufacturer,q=!!G.series;n&&n.classList.toggle(E,!1),a&&(a.classList.toggle(E,!D),a.setAttribute("aria-disabled",D?"false":"true")),i&&(i.classList.toggle(E,!q),i.setAttribute("aria-disabled",q?"false":"true")),o.disabled=!D,oe(o,!G.series),oe(r,!G.manufacturer)},ne=()=>{const D=new Set(G.selections.map(q=>q.name));Array.from(h.options||[]).forEach(q=>{!q||typeof q.value!="string"||(q.selected=D.has(q.value))})},V=({skipEvent:D=!1,skipDirty:q=!1}={})=>{const ve=G.selections.map(pe=>pe.name).join(", "),Se=JSON.stringify(G.selections.map(pe=>{const ze={name:pe.name,mount:pe.mount||""};return pe.mountState&&(ze.mountState=pe.mountState),ze})),he=p.value!==ve,ge=g.value!==Se;if(he&&(p.value=ve),ge&&(g.value=Se),!D&&(he||ge))try{p.dispatchEvent(new Event("change",{bubbles:!0})),g.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}if(!q&&(he||ge))try{Xn()}catch{}ne()},fe=({skipEvent:D=!1,skipDirty:q=!1}={})=>{if(d.innerHTML="",!G.selections.length){V({skipEvent:D,skipDirty:q});return}const we=d.getAttribute(y)||"",ve=d.getAttribute(S)||"Mount";G.selections.forEach((Se,he)=>{const ge=j.lensIndex.get(Se.name),pe=ge?ge.displayName:Se.name,ze=ge&&ge.focalLabel?ge.focalLabel:"",ke=e.createElement("div");ke.className="lens-chip",ke.setAttribute("role","listitem");const nt=e.createElement("div");nt.className="lens-chip-label";const Ct=e.createElement("span");if(Ct.className="lens-chip-name",Ct.textContent=pe,nt.appendChild(Ct),ze){const Oe=e.createElement("span");Oe.className="lens-chip-focal",Oe.textContent=ze,nt.appendChild(Oe)}ke.appendChild(nt);const Ot=`lensMount-${he}`,xt=e.createElement("div"),or=e.createElement("label");or.className="visually-hidden",or.setAttribute("for",Ot),or.textContent=`${ve}: ${pe}`,xt.appendChild(or);const er=e.createElement("select");er.id=Ot,er.dataset.lensName=Se.name;const wr=typeof Se.mount=="string"?Se.mount.trim():"",Pt=ae(Se.name,wr);Se.mount!==Pt.mount&&(Se.mount=Pt.mount),Pt.status?Se.mountState=Pt.status:Se.mountState&&delete Se.mountState;const{options:Pr,hiddenValue:Wt}=N(wr,Se.name);if(Pr.forEach(Oe=>{const ct=e.createElement("option");ct.value=Oe;const kt=ae(Se.name,Oe).status;ct.textContent=kt==="adapted"?`${Oe} (adapted)`:Oe,kt&&(ct.dataset.mountState=kt),Se.mount===Oe&&(ct.selected=!0),er.appendChild(ct)}),Wt){const Oe=e.createElement("option");Oe.value=Wt,Oe.textContent=Wt,Oe.hidden=!0,Oe.disabled=!0,er.appendChild(Oe)}if(Se.mount&&(er.value=Se.mount),!Se.mount&&Pr.length){er.value=Pr[0],Se.mount=er.value;const Oe=ae(Se.name,Se.mount);Oe.status?Se.mountState=Oe.status:Se.mountState&&delete Se.mountState}er.setAttribute("aria-label",`${ve}: ${pe}`),er.addEventListener("change",Oe=>{const ct=Oe.target.dataset.lensName,Gt=typeof Oe.target.value=="string"?Oe.target.value:"",kt=G.selections.find(me=>me.name===ct);if(!kt)return;const O=ae(ct,Gt),U=O.mount,F=O.status,W=kt.mountState||"",se=(F||"")!==W;kt.mount===U&&!se||(kt.mount=U,F?kt.mountState=F:kt.mountState&&delete kt.mountState,Oe.target.value!==U&&(Oe.target.value=U||""),V())}),xt.appendChild(er),ke.appendChild(xt);const _t=e.createElement("button");_t.type="button",_t.className="lens-chip-remove",_t.dataset.lensName=Se.name;const _r=we.includes("{lens}")?we.replace("{lens}",pe):we||pe;_t.setAttribute("aria-label",_r),_t.setAttribute("title",_r),typeof iconMarkup=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.circleX?_t.innerHTML=iconMarkup(ICON_GLYPHS.circleX,"btn-icon"):_t.textContent="×",_t.addEventListener("click",()=>{xe(Se.name,{focus:!0})}),ke.appendChild(_t),d.appendChild(ke)}),V({skipEvent:D,skipDirty:q})},J=()=>{if(s.innerHTML="",$.clear(),!G.series){u&&(u.hidden=!0);return}const D=j.manufacturers.get(G.manufacturer),q=D?D.get(G.series):null;if(!q||!q.length){u&&(u.hidden=!1);return}u&&(u.hidden=!0);const we=e.createElement("div");we.className="lens-options-header";const ve=e.createElement("span");ve.textContent=`${q.length} items`,we.appendChild(ve);const Se=e.createElement("label");Se.className="lens-set-toggle";const he=e.createElement("input");he.type="checkbox";const ge=q.filter(ke=>G.selections.some(nt=>nt.name===ke.name)).length,pe=q.length>0&&ge===q.length,ze=ge>0&&!pe;he.checked=pe,he.indeterminate=ze,he.addEventListener("change",ke=>{Ae(q,ke.target.checked)}),Se.appendChild(he),Se.appendChild(e.createTextNode("Select Full Set")),we.appendChild(Se),s.appendChild(we),q.forEach((ke,nt)=>{const Ct=e.createElement("div");Ct.className="lens-option";const Ot=`lensOption-${nt}`,xt=e.createElement("input");xt.type="checkbox",xt.id=Ot,xt.dataset.lensName=ke.name,xt.checked=G.selections.some(wr=>wr.name===ke.name),xt.addEventListener("change",wr=>{const Pt=!!wr.target.checked;Je(ke.name,Pt)}),Ct.appendChild(xt);const or=e.createElement("label");or.className="lens-option-label",or.setAttribute("for",Ot);const er=e.createElement("span");if(er.className="lens-option-name",er.textContent=ke.displayName,or.appendChild(er),ke.optionMeta){const wr=e.createElement("span");wr.className="lens-option-meta",wr.textContent=ke.optionMeta,or.appendChild(wr)}Ct.appendChild(or),s.appendChild(Ct),$.set(ke.name,xt)})},Ae=(D,q)=>{if(!Array.isArray(D)||!D.length)return;let we=!1;const ve=new Set(D.map(Se=>Se.name));if(q)D.forEach(Se=>{if(!G.selections.some(he=>he.name===Se.name)){const he=ae(Se.name),ge={name:Se.name,mount:he.mount};he.status&&(ge.mountState=he.status),G.selections.push(ge),we=!0}});else{const Se=G.selections.length;G.selections=G.selections.filter(he=>!ve.has(he.name)),G.selections.length!==Se&&(we=!0)}we&&(fe(),J())},Le=()=>{o.innerHTML="",o.appendChild(m);const D=G.manufacturer?j.manufacturers.get(G.manufacturer):null;if(!D||D.size===0){G.series="",l&&(l.hidden=!G.manufacturer),u&&(u.hidden=!0),m.selected=!0,Q();return}const q=Array.from(D.keys());if(!q.length){G.series="",l&&(l.hidden=!1),u&&(u.hidden=!0),m.selected=!0,Q();return}l&&(l.hidden=!0),R?q.sort(R):q.sort(),q.forEach(we=>{const ve=e.createElement("option");ve.value=we,ve.textContent=we,G.series===we&&(ve.selected=!0),o.appendChild(ve)}),D.has(G.series)?o.value=G.series:(G.series="",m.selected=!0),Q()},_e=()=>{r.innerHTML="",r.appendChild(A);const D=Array.from(j.manufacturers.keys());D.length&&(R?D.sort(R):D.sort(),D.forEach(q=>{const we=e.createElement("option");we.value=q,we.textContent=q,G.manufacturer===q&&(we.selected=!0),r.appendChild(we)})),j.manufacturers.has(G.manufacturer)?r.value=G.manufacturer:(G.manufacturer="",A.selected=!0),Q()},Je=(D,q)=>{if(q){if(G.selections.some(Se=>Se.name===D))return;const we=ae(D),ve={name:D,mount:we.mount};we.status&&(ve.mountState=we.status),G.selections.push(ve),fe()}else xe(D)},xe=(D,{focus:q=!1,skipEvent:we=!1,skipDirty:ve=!1}={})=>{const Se=G.selections.findIndex(ge=>ge.name===D);if(Se===-1)return;G.selections.splice(Se,1);const he=$.get(D);he&&(he.checked=!1,q&&he.focus()),fe({skipEvent:we,skipDirty:ve})},Ze=()=>{const D=de(r.value);D!==G.manufacturer&&(G.manufacturer=D,G.series="",_e(),Le(),J())},Ve=()=>{const D=de(o.value);D!==G.series&&(G.series=D,Le(),J())},Dt=(D={})=>{j=ue();const q=new Set(j.lensIndex.keys()),we=[],ve=new Set;if(Array.isArray(D.lensSelections)&&D.lensSelections.forEach(Se=>{if(!Se||typeof Se!="object")return;const he=de(Se.name);if(!he||ve.has(he)||!q.has(he))return;const ge=typeof Se.mount=="string"?Se.mount.trim():"",pe=typeof Se.mountState=="string"?Se.mountState.trim():"";we.push({name:he,mount:ge,mountState:pe}),ve.add(he)}),we.length||Bd(D.lenses).forEach(Se=>{const he=de(Se);!he||ve.has(he)||!q.has(he)||(we.push({name:he,mount:""}),ve.add(he))}),G.selections=we.map(Se=>{const he=typeof Se.mount=="string"?Se.mount.trim():"",ge=ae(Se.name,he),pe={name:Se.name,mount:ge.mount},ze=ge.status||(typeof Se.mountState=="string"?Se.mountState.trim():"");return ze&&(pe.mountState=ze),pe}),G.selections.length){const Se=j.lensIndex.get(G.selections[0].name);G.manufacturer=Se?Se.manufacturer:"",G.series=Se?Se.series:""}else G.manufacturer="",G.series="";_e(),Le(),J(),fe({skipEvent:!0,skipDirty:!0})},We=()=>({names:G.selections.map(D=>D.name),lensSelections:G.selections.map(D=>({name:D.name,mount:D.mount||"",...D.mountState?{mountState:D.mountState}:{}})),legacyValue:G.selections.map(D=>D.name).join(", ")}),ft=({preserveSelections:D=!0,skipEvent:q=!1,skipDirty:we=!1}={})=>{const ve=D?G.selections.map(pe=>({...pe})):[],Se=D?G.manufacturer:"",he=D?G.series:"";j=ue();const ge=new Set(j.lensIndex.keys());if(G.selections=D?ve.filter(pe=>ge.has(pe.name)):[],G.manufacturer=D&&j.manufacturers.has(Se)?Se:"",G.manufacturer){const pe=j.manufacturers.get(G.manufacturer);G.series=pe&&pe.has(he)?he:""}else G.series="";_e(),Le(),J(),fe({skipEvent:q||D,skipDirty:we||D})};return r.addEventListener("change",Ze),o.addEventListener("change",Ve),j=ue(),_e(),Le(),J(),fe({skipEvent:!0,skipDirty:!0}),{snapshot:We,applyInfo:Dt,refreshCatalog:ft,getSelections(){return G.selections.map(D=>({...D}))}}})();typeof globalThis<"u"&&globalThis&&(typeof globalThis.updateLensWorkflowCatalog!="function"&&(globalThis.updateLensWorkflowCatalog=function(t){try{es.refreshCatalog(t||{preserveSelections:!0,skipEvent:!0,skipDirty:!0})}catch{}}),globalThis.lensSelectionManager||(globalThis.lensSelectionManager=es));function Bd(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():"").filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim()).filter(Boolean):[]}function Xn(){xv=!0,fm=null}const Ei=(()=>{function e(r){if(!r)return"";const o=Gn(),n=o&&typeof o.texts=="object"&&o.texts||typeof texts=="object"&&texts||null;if(!n)return"";const a=o&&typeof o.currentLang=="string"&&typeof n[o.currentLang]=="object"?o.currentLang:null,i=typeof currentLang=="string"&&typeof n[currentLang]=="object"?currentLang:null,s=a||i||"en",u=typeof n[s]=="object"&&n[s]||{},l=Object.prototype.hasOwnProperty.call(u,r)?u[r]:void 0;if(typeof l=="string")return l;const d=typeof n.en=="object"&&n.en||{},p=Object.prototype.hasOwnProperty.call(d,r)?d[r]:void 0;return typeof p=="string"?p:""}let t=!1;return function r(o){const n=Gn(),a=n&&typeof n.getLocalizedText=="function"&&n.getLocalizedText!==r?n.getLocalizedText:null;if(a)try{const i=a(o);if(typeof i=="string")return i}catch(i){!t&&typeof console<"u"&&typeof console.warn=="function"&&(console.warn("getLocalizedText fallback used after global failure",i),t=!0)}return e(o)}})(),Mb=Gn();Mb&&typeof Mb.getLocalizedText!="function"&&(Mb.getLocalizedText=Ei);const pN="rentalHouseOptions";function mN(){const e=[];if(typeof require=="function")try{const r=require("../data/rental-houses.js");Array.isArray(r)&&r.length?e.push(r):r&&Array.isArray(r.rentalHouses)&&r.rentalHouses.length?e.push(r.rentalHouses):r&&Array.isArray(r.default)&&r.default.length&&e.push(r.default)}catch(r){const o=r&&r.message?r.message:"";if(r&&r.code!=="MODULE_NOT_FOUND"&&!/Cannot find module/i.test(o))try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to load rental house catalog module",r)}catch{}}const t=Gn();if(t){const r=t.devices;r&&Array.isArray(r.rentalHouses)&&r.rentalHouses.length&&e.push(r.rentalHouses),Array.isArray(t.rentalHouses)&&t.rentalHouses.length&&e.push(t.rentalHouses)}typeof devices<"u"&&devices&&Array.isArray(devices.rentalHouses)&&devices.rentalHouses.length&&e.push(devices.rentalHouses);for(let r=0;r<e.length;r+=1){const o=e[r];if(Array.isArray(o)&&o.length)return o.slice()}return[]}const Uw=50;let _f=null;function lG(e){return!!e&&Array.isArray(e.catalog)&&Array.isArray(e.searchIndex)&&e.lookup&&typeof e.lookup=="object"&&typeof e.signature=="string"}function gN(e){if(!e)return;const t=Gn();if(t){try{t.__cineRentalHouseRuntime=e}catch{}if(!Array.isArray(t.__cineRentalHouseCatalog))try{t.__cineRentalHouseCatalog=e.catalog}catch{}try{t.__cineRentalHouseSearchIndex=e.searchIndex}catch{}try{t.__cineRentalHouseLookup=e.lookup}catch{}try{t.__cineRentalHouseSignature=e.signature}catch{}}}function yN(){const e=Gn();if(e)try{const a=e.__cineRentalHouseRuntime;if(lG(a))return a}catch{}let t=[];if(e)try{const a=e.__cineRentalHouseCatalog;Array.isArray(a)&&a.length&&(t=a.slice())}catch{}t.length||(t=mN());const r=t.map(a=>{if(!a||typeof a!="object")return null;const i=a.name?String(a.name).trim():"";if(!i)return null;const s=Pd(i);if(!s)return null;const u=dG(a),l=rc(i),d=rc(u),p=rc([a.city,a.country,a.address,a.phone,a.email].map(h=>h?String(h).trim():"").filter(Boolean).join(" ")),g=[l,d,p].filter(Boolean).join(" ");return{entry:a,name:i,key:s,location:u,normalizedName:l,normalizedLocation:d,searchKey:g}}).filter(Boolean),o=r.map(a=>`${a.key}|${a.location}`).join("||"),n=Object.create(null);return t.forEach(a=>{if(!a||typeof a!="object")return;const i=Pd(a.name);i&&!n[i]&&(n[i]=a)}),{catalog:t,searchIndex:r,signature:o,lookup:n}}function vf(){return lG(_f)||(_f=yN(),gN(_f)),_f}function rc(e){if(!e)return"";let t=String(e);try{typeof t.normalize=="function"&&(t=t.normalize("NFD"))}catch{}return t.replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[\u2012\u2013\u2014\u2015]/g,"-").replace(/[^a-z0-9]+/g," ").replace(/\s+/g," ").trim()}function Pd(e){return e?String(e).trim().replace(/[\u2012\u2013\u2014\u2015]/g,"-").toLowerCase():""}const bN=new Set(["AG","BV","BVBA","CO","GMBH","INC","KG","LLC","LTD","PLC","PTY","SAS","SARL","SL","SPA","S.P.A","SRL"]);function hN(e){if(!e)return"";const t=typeof e=="object"&&e&&typeof e.shortName=="string"?e.shortName.trim():"";if(t)return t;const r=typeof e=="string"?e:e&&e.name,o=r?String(r).trim():"";if(!o)return"";let n=o.replace(/\s*\([^)]*\)\s*/g," ").replace(/\s+/g," ").trim();const a=n.match(/\s*[\u2012\u2013\u2014\u2015-]\s*/);if(a){const s=n.indexOf(a[0]);s>0&&(n=n.slice(0,s).trim())}n||(n=o.trim());const i=n.match(/\b[A-Z]{2,5}\b/g);if(i&&i.length)for(let s=0;s<i.length;s+=1){const u=i[s];if(!bN.has(u))return u==="ARRI"?"Arri":u}return/^arri\b/i.test(n)?"Arri":/^ludwig\s+kamera/i.test(n)?"Kamera Ludwig":n.trim()}function SN(e={}){const t=e.input||jy();if(e.preferInput!==!1&&t&&typeof t.value=="string"){const a=t.value.trim();if(a)return a}if(typeof e.rentalHouse=="string"&&e.rentalHouse.trim())return e.rentalHouse.trim();let r=null;const o=Gn();if(o&&typeof o.getCurrentProjectInfo=="function")try{r=o.getCurrentProjectInfo()}catch{}const n=r&&typeof r=="object"&&typeof r.rentalHouse=="string"?r.rentalHouse.trim():"";return n||(e.preferInput===!1&&t&&typeof t.value=="string"?t.value.trim():"")}function cG(e={}){const t=typeof e.fallback=="string"?e.fallback:"",r=typeof e.rentalHouse=="string"&&e.rentalHouse.trim()?e.rentalHouse.trim():SN({input:e.input});if(!r)return t;let o=null;if(r){const a=vf(),i=a&&a.lookup;o=i?i[Pd(r)]:null}const n=hN(o||r);return n||t||r}let $w=null;function uG(e={}){const t=Vc(e),r=t.noteLabel&&t.noteLabel.trim()?t.noteLabel.trim():"";if($w===r)return r;$w=r;const o=typeof document<"u"?document:null,n=[];if(typeof gearListOutput<"u"&&gearListOutput&&n.push(gearListOutput),typeof projectRequirementsOutput<"u"&&projectRequirementsOutput&&n.push(projectRequirementsOutput),o&&n.push(o),n.length){const i=".gear-item[data-rental-note], .gear-custom-item[data-rental-note]";n.forEach(s=>{!s||typeof s.querySelectorAll!="function"||s.querySelectorAll(i).forEach(u=>{!u||typeof u.setAttribute!="function"||(r?u.getAttribute("data-rental-note")!==r&&u.setAttribute("data-rental-note",r):typeof u.removeAttribute=="function"&&u.removeAttribute("data-rental-note"))})})}let a=null;if(typeof zo=="function")try{a=zo()}catch(i){if(!i||i.name!=="ReferenceError")throw i}return a&&a.rentalDescription&&(a.rentalDescription.textContent=r,a.rentalDescription.hidden=!r,a.rentalCheckbox&&(r?a.rentalCheckbox.setAttribute("aria-describedby",a.rentalDescription.id):a.rentalCheckbox.removeAttribute("aria-describedby"))),r}function dG(e){const t=[],r=e&&e.city?String(e.city).trim():"",o=e&&e.country?String(e.country).trim():"";return r&&t.push(r),o&&t.push(o),t.join(", ")}function vN(e){if(!e||typeof e!="object")return"";const t=[],r=dG(e),o=e.address?String(e.address).trim():"",n=e.phone?String(e.phone).trim():"",a=e.email?String(e.email).trim():"";return r&&t.push(r),o&&t.push(o),n&&t.push(n),a&&t.push(a),t.join(" • ")}function AN(e){const t=typeof e=="string"?e.trim():"";if(!t)return null;const r=vf(),o=r&&r.lookup,n=Pd(t);if(o&&n&&o[n])return o[n];const a=rc(t);if(!a||!r||!Array.isArray(r.searchIndex))return null;const i=r.searchIndex.find(s=>s&&s.normalizedName===a);return i?i.entry:null}function jy(){return typeof document>"u"?null:document.getElementById("rentalHouse")}function EN(e){if(!e||typeof document>"u")return null;let t=e.getAttribute("list");t||(t=pN,e.setAttribute("list",t));let r=t?document.getElementById(t):null;return r||(r=document.createElement("datalist"),r.id=t,e.insertAdjacentElement("afterend",r)),r}function CN(e,t){if(!t)return 0;if(!e)return Number.POSITIVE_INFINITY;const{normalizedName:r,normalizedLocation:o,searchKey:n}=e;if(!n||n.indexOf(t)===-1)return Number.POSITIVE_INFINITY;const a=r?r.indexOf(t):-1,i=o?o.indexOf(t):-1;if(a===0)return 0;if(i===0)return 100;if(a>0)return 200+a;if(i>0)return 400+i;const s=n.indexOf(t);return 800+(s>=0?s:0)}function qw(e){const t=vf(),r=t&&Array.isArray(t.searchIndex)?t.searchIndex:[],o=rc(e);if(!r.length)return[];if(!o)return r.slice().sort((a,i)=>a.name.localeCompare(i.name)).slice(0,Uw);const n=[];return r.forEach(a=>{const i=CN(a,o);Number.isFinite(i)&&n.push({info:a,score:i})}),n.sort((a,i)=>a.score!==i.score?a.score-i.score:a.info.name.localeCompare(i.info.name)),n.slice(0,Uw).map(a=>a.info)}function pm(e=jy()){const t=vf(),r=t&&Array.isArray(t.searchIndex)?t.searchIndex:[];if(!e||!r.length)return;const o=EN(e);if(!o)return;const n=typeof e.value=="string"?e.value:"",a=rc(n),s=`${t&&typeof t.signature=="string"?t.signature:""}::${a}`;if(o.__rentalHouseSignature===s)return;const u=document.createDocumentFragment(),l=new Set,d=qw(n);(d.length?d:qw("")).forEach(g=>{if(!g||l.has(g.key))return;const h=document.createElement("option");h.value=g.name,g.location&&(h.label=g.location),h.textContent=g.name,u.appendChild(h),l.add(g.key)}),o.innerHTML="",o.appendChild(u),o.__rentalHouseSignature=s}function Gu(e=jy()){if(!e)return;const t=typeof e.value=="string"?e.value.trim():"";let r=null;if(t){const o=vf(),n=o&&o.lookup;r=n?n[Pd(t)]:null}if(r){const o=vN(r);o?(e.title=o,e.setAttribute("data-help",o)):(e.removeAttribute("title"),e.removeAttribute("data-help"))}else e.removeAttribute("title"),e.removeAttribute("data-help");uG({input:e,rentalHouse:t})}const Fn=jy();Fn&&(Gu(Fn),Fn.addEventListener("input",()=>{pm(Fn),Gu(Fn)}),Fn.addEventListener("change",()=>{pm(Fn),Gu(Fn)}),Fn.addEventListener("blur",()=>Gu(Fn)),Fn.addEventListener("focus",()=>pm(Fn)));function mm(e){return typeof e=="string"?e.trim():e==null?"":String(e)}function Gn(){return typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null}function wN(e){if(typeof structuredClone=="function")return structuredClone;if(e&&typeof e.structuredClone=="function")try{return e.structuredClone.bind(e)}catch{}if(typeof require=="function"){try{const t=require("node:util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}try{const t=require("util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}}return null}function Vw(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function LN(e){const t=wN(e);return t?function(o){if(o===null||typeof o!="object")return o;try{return t(o)}catch{}return Vw(o)}:Vw}const Ww=(()=>{const e=Gn();return e&&typeof e.__cineDeepClone=="function"?e.__cineDeepClone:LN(e)})();function Mv(e){const t=typeof e=="string"?e:"",r={projectHtml:"",gearHtml:t},o=Gn(),n=typeof splitGearListHtml=="function"?splitGearListHtml:o&&typeof o.splitGearListHtml=="function"?o.splitGearListHtml:null;if(!n)return r;try{const a=n(t);if(!a||typeof a!="object")return r;const i=typeof a.projectHtml=="string"?a.projectHtml:"",s=typeof a.gearHtml=="string"?a.gearHtml:i?"":t;return{projectHtml:i,gearHtml:s}}catch(a){return console.warn("Failed to split gear list HTML",a),r}}function tt(e,t){const r=typeof document<"u"?document:null;if(r&&typeof r.getElementById=="function"){const n=r.getElementById(e);if(n)return n}const o=Gn();if(o&&t&&typeof o=="object")try{const n=o[t];if(n)return n}catch{}return null}function RN(){const e=Gn(),t=[];if(typeof cineGearList=="object"&&cineGearList&&t.push(cineGearList),e&&typeof e.cineGearList=="object"&&e.cineGearList&&(t.includes(e.cineGearList)||t.push(e.cineGearList)),typeof require=="function")try{const r=require("./modules/gear-list.js");r&&typeof r=="object"&&!t.includes(r)&&t.push(r)}catch{}for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o.setImplementation!="function"))return o}return null}function IN(){const e=RN(),t={getSafeGearListHtmlSections:Mv,generateGearListHtml:qv,getCurrentGearListHtml:hg};if(e&&typeof e.setImplementation=="function")try{return e.setImplementation(t,{source:"app-setups"}),!0}catch(o){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Unable to register gear list implementation with cineGearList.",o)}const r=Gn();if(r&&typeof r=="object"){try{r.getSafeGearListHtmlSections=Mv}catch{}try{r.generateGearListHtml=qv}catch{}try{r.getCurrentGearListHtml=hg}catch{}}return!1}IN();function TN(){return{dialog:tt("shareDialog","shareDialog"),form:tt("shareForm","shareForm"),filenameInput:tt("shareFilename","shareFilenameInput"),filenameMessage:tt("shareFilenameMessage","shareFilenameMessage"),linkMessage:tt("shareLinkMessage","shareLinkMessage"),includeAutoGearCheckbox:tt("shareIncludeAutoGear","shareIncludeAutoGearCheckbox"),includeAutoGearLabel:tt("shareIncludeAutoGearLabel","shareIncludeAutoGearLabelElem"),includeOwnedGearCheckbox:tt("shareIncludeOwnedGear","shareIncludeOwnedGearCheckbox"),includeOwnedGearLabel:tt("shareIncludeOwnedGearLabel","shareIncludeOwnedGearLabelElem"),cancelButton:tt("shareCancelBtn","shareCancelBtn"),sharedLinkInput:tt("sharedLinkInput","sharedLinkInput"),applySharedLinkButton:tt("applySharedLinkBtn","applySharedLinkBtn")}}function ON(){return{dialog:tt("sharedImportDialog","sharedImportDialog"),form:tt("sharedImportForm","sharedImportForm"),modeSelect:tt("sharedImportModeSelect","sharedImportModeSelect"),cancelButton:tt("sharedImportCancelBtn","sharedImportCancelBtn")}}let Db=null,_b=null,Us=null;function wi(e){return e&&typeof e=="object"&&e.context&&typeof e.context=="object"?e.context:(Db||(Db=TN()),Db)}function fG(e){return _b||(_b=ON()),_b}function Lc(e){if(e==null)return e;if(Array.isArray(e))return e.map(t=>Lc(t));if(Object.prototype.toString.call(e)==="[object Object]"){const t={};return Object.keys(e).forEach(r=>{t[r]=Lc(e[r])}),t}return e}function GN(){if(currentProjectInfo)return Lc(currentProjectInfo);if(projectForm)try{return Lc(Af())}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to read current project form data before opening dialog",e)}return{}}function kN(){if(!projectForm){Us=null;return}try{const e=Af();Us=Lc(e)}catch(e){Us=null,typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to capture project dialog snapshot",e)}}function BN(e){projectForm?(Uy(e&&typeof e=="object"?e:{}),kN()):Us=null,openDialog(projectDialog)}function pG(){projectForm&&(Us&&typeof Us=="object"?Uy(Lc(Us)):projectForm.reset())}function mG(e,t=[],r={}){if(typeof callCoreFunctionIfAvailable=="function")return callCoreFunctionIfAvailable(e,t,r);const o=(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null)||null,n=typeof e=="string"?o&&o[e]:e;if(typeof n=="function"){try{return n.apply(o,t)}catch(a){typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,a)}return}if(r&&r.defer===!0){const a=o&&Array.isArray(o.CORE_BOOT_QUEUE)?o.CORE_BOOT_QUEUE:null;a&&a.push(()=>{mG(e,t,{...r,defer:!1})})}return r&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}function Rc(e,t={}){const r=Object.prototype.hasOwnProperty.call(t,"defaultValue")?t.defaultValue:"",o=mG(e,[],{defaultValue:r});if(typeof o=="string")return o;if(o==null)return r;try{return String(o)}catch{return r}}function PN(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!e||typeof e!="object")return null;try{const t=e.cineUi;return t&&typeof t=="object"?t:null}catch{return null}}function Hn(e,t){if(!e||typeof e!="object")return!1;if(typeof e.get=="function")try{return!!e.get(t)}catch{}if(typeof e.list=="function")try{const r=e.list();return Array.isArray(r)&&r.indexOf(t)!==-1}catch{}return!1}function Fb(e,t,r){if(!(!e||typeof e.register!="function"))for(let o=0;o<t.length;o+=1){const n=t[o];if(!(!n||typeof n.name!="string")&&!Hn(e,n.name))try{e.register(n.name,n.value)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn(r,a)}}}function gG(e){if(!e||typeof e!="object")return!1;const t=e.controllers,r=e.interactions,o=e.help;return Hn(t,"shareDialog")&&Hn(t,"sharedImportDialog")&&Hn(r,"shareOpen")&&Hn(r,"shareSubmit")&&Hn(r,"shareCancel")&&Hn(r,"shareApplyFile")&&Hn(r,"shareInputChange")&&Hn(r,"sharedImportSubmit")&&Hn(r,"sharedImportCancel")&&Hn(o,"shareProject")&&Hn(o,"sharedImport")}let Kw=gG(PN());function xN(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof e!="function")return;try{const o=t.cineUi&&typeof t.cineUi=="object"?t.cineUi:null;if(o){e(o);return}}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("cineUi registration callback (setups) failed",o);return}const r="__cineUiReadyQueue";Array.isArray(t[r])||(t[r]=[]),t[r].push(e)}function yG(){if(!batterySelect&&!batteryPlateSelect&&!hotswapSelect)return null;const e=batterySelect?mm(batterySelect.value):"",t=batteryPlateSelect?mm(batteryPlateSelect.value):"",r=hotswapSelect?mm(hotswapSelect.value):"",n={batteryPlate:(typeof normalizeBatteryPlateValue=="function"?normalizeBatteryPlateValue(t,e):t)||"",battery:e||"",batteryHotswap:r||""};return!n.batteryPlate&&!n.battery&&!n.batteryHotswap?null:n}function ug(e){if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=t.replace(/,/g,"."),o=parseFloat(r);return Number.isFinite(o)?o:null}return null}function MN(e,t){if(typeof t!="function")return;const r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;let o=null;if(r){try{typeof r.cineEnsureDeferredScriptsLoaded=="function"&&(o=r.cineEnsureDeferredScriptsLoaded({reason:e}))}catch{}if(!o)try{o=r.cineDeferredScriptsReady}catch{}}if(!o||typeof o.then!="function"){t();return}o.then(()=>{t()}).catch(n=>{typeof console<"u"&&typeof console.error=="function"&&console.error("Deferred scripts failed to load before generating an overview.",n),t()})}const Yw=typeof generateOverviewBtn<"u"?generateOverviewBtn:document.getElementById("generateOverviewBtn");Yw&&Yw.addEventListener("click",()=>{const e=typeof setupSelect<"u"?setupSelect:document.getElementById("setupSelect");if(!e||!e.value){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].alertSelectSetupForOverviewTitle||"No Project Selected",message:texts[currentLang].alertSelectSetupForOverview}):alert(texts[currentLang].alertSelectSetupForOverview);return}MN("overview-dialog",()=>{typeof generatePrintableOverview=="function"?generatePrintableOverview():typeof console<"u"&&typeof console.error=="function"&&console.error("generatePrintableOverview is unavailable after deferred loading.")})});function bG(){const e=batterySelect&&batterySelect.value;if(!e||e==="None"||!(devices&&devices.batteries&&devices.batteries[e]))return!0;const t=devices&&devices.batteries?devices.batteries[e]:null,r=parseFloat(totalCurrent12Elem.textContent);if(!isFinite(r))return!0;const o=ug(t.pinA);return!Number.isFinite(o)||o<=0?!0:r<=o}function hG(){const e=batterySelect&&batterySelect.value;if(!e||e==="None"||!(devices&&devices.batteries&&devices.batteries[e]))return;const t=devices&&devices.batteries?devices.batteries[e]:null,r=parseFloat(totalCurrent12Elem.textContent),o=ug(t.pinA);if(!Number.isFinite(o)||o<=0)return;const n=texts[currentLang].warnPinExceeded.replace("{current}",r.toFixed(2)).replace("{max}",String(o));typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].warnPinExceededTitle||"Current Limit Exceeded",message:n}):alert(n)}const Qw=typeof generateGearListBtn<"u"?generateGearListBtn:document.getElementById("generateGearListBtn");Qw&&Qw.addEventListener("click",()=>{const e=typeof setupSelect<"u"?setupSelect:document.getElementById("setupSelect");if(!e||!e.value){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].alertSelectSetupForOverviewTitle||"No Project Selected",message:texts[currentLang].alertSelectSetupForOverview}):alert(texts[currentLang].alertSelectSetupForOverview);return}if(!bG()){hG();return}const t=GN();t&&typeof t=="object"&&(populateRecordingResolutionDropdown(t.recordingResolution),populateSensorModeDropdown(t.sensorMode),kG(t.codec)),BN(t)});const Xw=typeof deleteGearListProjectBtn<"u"?deleteGearListProjectBtn:document.getElementById("deleteGearListProjectBtn");Xw&&Xw.addEventListener("click",()=>{vg()});const Ic=typeof projectCancelBtn<"u"?projectCancelBtn:null;Ic&&Ic.addEventListener("click",()=>{pG(),closeDialog(projectDialog)});function DN(){if(!projectForm||!projectDialog)return;const e=typeof projectDialog.open=="boolean"?projectDialog.open:null,t=typeof projectDialog.hasAttribute=="function"?projectDialog.hasAttribute("open"):!1;if(!(e===null?t:e||t))return;const o=projectDialog.querySelector('[type="submit"]');if(typeof projectForm.requestSubmit=="function")try{o?projectForm.requestSubmit(o):projectForm.requestSubmit();return}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Project dialog backdrop submit failed to use requestSubmit",a)}const n=new Event("submit",{bubbles:!0,cancelable:!0});projectForm.dispatchEvent(n)}const Zw=typeof projectDialogCloseBtn<"u"?projectDialogCloseBtn:document.getElementById("projectDialogClose");Zw&&Zw.addEventListener("click",()=>{Ic?Ic.click():closeDialog(projectDialog)});const ru=typeof projectDialog<"u"?projectDialog:document.getElementById("projectDialog");ru&&(ru.addEventListener("cancel",e=>{e&&e.preventDefault(),Ic?Ic.click():(pG(),closeDialog(ru))}),ru.addEventListener("click",e=>{e.target===ru&&(e.preventDefault(),e.stopPropagation(),DN())}));const Nb=typeof projectForm<"u"?projectForm:document.getElementById("projectForm");Nb&&(Nb.addEventListener("input",()=>{Xn()}),Nb.addEventListener("submit",e=>{if(e.preventDefault(),!bG()){hG();return}const t=Dj(),r=Af();currentProjectInfo=r,oH(r);const o=qv(r);displayGearAndRequirements(o),_j(t),Fj(),KE(),YE(),QE(),XE(),ZE(),JE(),saveCurrentSession(),scheduleProjectAutoSave(!0),closeDialog(projectDialog)}));function _N(){if(typeof ACTIVE_APP_VERSION=="string"){const e=ACTIVE_APP_VERSION.trim();if(e)return e}if(typeof APP_VERSION=="string"){const e=APP_VERSION.trim();if(e)return e}return""}function FN({includeAutoGear:e,hasAutoGearRules:t,includeOwnedGearMarks:r,hasOwnedGearMarkers:o}){const n={type:"camera-power-planner/project-bundle",includesAutoGearRules:!!(e&&t)};n.includesOwnedGearMarkers=!!(r&&o);const a=_N();a&&(n.version=a);try{const i=new Date;Number.isNaN(i.valueOf())||(n.exportedAt=i.toISOString())}catch(i){console.warn("Unable to capture export timestamp for shared project metadata.",i)}return n.generator="Camera Power Planner",n}function Jw(e){const t=e||gearListOutput;return!t||typeof t.querySelector!="function"?!1:!!t.querySelector("[data-gear-own-gear-id]")}function NN(e){const t=typeof getLocalizedText=="function"?getLocalizedText("gearListOwnedExportLabel"):"",r=texts?.en?.gearListOwnedExportLabel||"Owned by %s",o=t&&t.trim()?t:r;return o.includes("%s")?o.replace("%s",e):`${o} ${e}`.trim()}function qc(e){if(!e||typeof e.getAttribute!="function")return"";const t=e.getAttribute("data-gear-name")||"",r=e.getAttribute("data-gear-label")||"",o=(t||r||"").trim(),n=(e.getAttribute("data-gear-attributes")||"").trim();if(!n)return o;if(!o)return n;const a=o.toLowerCase(),i=n.toLowerCase();return a.includes(i)?o:`${o} (${n})`}function HN(e){const t=e||gearListOutput;if(!t||typeof t.querySelectorAll!="function")return[];const r=t.querySelectorAll("[data-gear-own-gear-id]"),o=[];return r.forEach(n=>{if(!n)return;const a=n.getAttribute("data-gear-own-gear-id");if(!a)return;const i=n.getAttribute("data-gear-provider")||"",s=n.getAttribute("data-gear-provider-label")||"",u=EG(i,{label:s}),l=(u.type==="user"?u.profileDisplayName||u.label||s||DE().user:u.type==="contact"?u.label||s:s||u.label||"").trim(),d={ownedId:a,providerValue:u.value||i,providerLabel:u.label||s,ownerDisplayName:l,ownerProfileName:u.profileName||"",ownerType:u.type||"",contactId:u.contactId||"",gearName:qc(n)};o.push(d)}),o}function jN(e,t,r={}){if(!e||!t||!t.length)return e;let o;try{o=document.implementation.createHTMLDocument("")}catch{}if(!o||!o.body)return e;o.body.innerHTML=e;const n=r.ownerLabelFallback||"Owned";return t.forEach(a=>{if(!a||!a.ownedId)return;const s=`[data-gear-own-gear-id="${typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(a.ownedId):a.ownedId.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"]`,u=o.body.querySelector(s);if(!u)return;a.ownerDisplayName?u.setAttribute("data-gear-owned-export-label",a.ownerDisplayName):u.removeAttribute("data-gear-owned-export-label"),u.querySelectorAll("[data-gear-owned-export]").forEach(y=>{y&&y.parentElement&&y.parentElement.removeChild(y)});const d=a.ownerDisplayName||n,p=NN(d),g=o.createElement("span");g.className="gear-item-provider gear-item-owned-export",g.setAttribute("data-gear-owned-export","true"),g.textContent=p;const A=u.classList?.contains("gear-custom-item")&&u.querySelector(".gear-custom-item-summary")||u,m=A.querySelector(".gear-item-note");m&&m.parentElement===A?A.insertBefore(g,m):A.appendChild(g)}),o.body.innerHTML}async function SG(e,t,r){if(!e)return;const o=wi(this),n=o.linkMessage,a=o.includeAutoGearCheckbox;o.includeAutoGearLabel;const i=$c(),s=H=>H&&typeof H.value=="string"?mm(H.value):"",u=s(batterySelect),l=s(batteryPlateSelect),d=s(hotswapSelect),p={setupName:i},g=(H,Y)=>{if(Y!=null)if(typeof Y=="string"){const N=Y.trim();if(!N||N==="None")return;p[H]=N}else if(Array.isArray(Y)){const N=Y.filter(ae=>typeof ae=="string"&&ae.trim()&&ae!=="None");N.length&&(p[H]=N)}else p[H]=Y};g("camera",cameraSelect.value),g("monitor",monitorSelect.value),g("video",videoSelect.value),g("cage",cageSelect.value),Array.isArray(motorSelects)&&g("motors",motorSelects.map(H=>H.value)),Array.isArray(controllerSelects)&&g("controllers",controllerSelects.map(H=>H.value)),g("distance",distanceSelect.value),g("batteryPlate",normalizeBatteryPlateValue(l,u)),g("battery",u),g("batteryHotswap",d);const h=yG();if(h&&(p.powerSelection=h,p.battery=h.battery||"",p.batteryPlate=h.batteryPlate||"",p.batteryHotswap=h.batteryHotswap||""),typeof getDiagramManualPositions=="function"){const H=getDiagramManualPositions();H&&Object.keys(H).length&&(p.diagramPositions=H)}const A=[];if(currentProjectInfo&&A.push(currentProjectInfo),typeof loadProject=="function"){const H=new Set;if(typeof i=="string"&&i&&H.add(i),typeof getCurrentProjectStorageKey=="function"){const ae=getCurrentProjectStorageKey({allowTyped:!0});typeof ae=="string"&&ae&&H.add(ae)}if(typeof getSetupNameState=="function"){const ae=getSetupNameState();ae&&typeof ae=="object"&&["storageKey","selectedName","typedName"].forEach(de=>{const Q=typeof ae[de]=="string"?ae[de].trim():"";Q&&H.add(Q)})}const Y=async ae=>{if(!(typeof cineFeatureBackup<"u"&&typeof cineFeatureBackup.isAutoBackupName=="function"&&cineFeatureBackup.isAutoBackupName(ae)))try{let de=null;const Q=typeof globalThis<"u"?globalThis:window;if(Q.cineProjectService&&typeof Q.cineProjectService.getProject=="function"&&(de=await Q.cineProjectService.getProject(ae)),!de&&typeof loadProject=="function"){const ne=loadProject(ae);ne&&typeof ne.then!="function"&&(de=ne)}de&&de.projectInfo&&A.push(de.projectInfo)}catch(de){console.warn("Unable to read project info for export from storage key",ae,de)}},N=[];H.forEach(ae=>N.push(Y(ae))),await Promise.all(N)}let m=null,y=null;if(A.forEach(H=>{H&&(m?m=ak(m,H):m=Ro(H))}),m){const H=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(m,{projectNameOverride:i}):m,Y=Ro(H);Y&&typeof Y=="object"&&(y=Y)}const S=nk(ok());Object.keys(S).length&&(p.gearSelectors=S);const E=r?HN(gearListOutput):[],I=hg();if(p.gearListAndProjectRequirementsGenerated=!!I,p.gearListAndProjectRequirementsGenerated){const{projectHtml:H,gearHtml:Y}=Mv(I);if(H&&(p.projectHtml=H),Y){const N=r&&E.length?jN(Y,E):Y;p.gearList=N,r&&E.length&&(p.ownedGearMarkers=E.map(ae=>({...ae})))}}p.gearListAndProjectRequirementsGenerated&&y&&(p.projectInfo=y);const L=getCurrentSetupKey(),R=loadFeedbackSafe()[L]||[];R.length&&(p.feedback=R);const G=getAutoGearRules(),j=Array.isArray(G)&&G.length>0;if(t&&j){p.autoGearRules=G;const H=getAutoGearRuleCoverageSummary({rules:G});H&&(p.autoGearCoverage=H)}const $=(()=>{if(typeof getContactsSnapshot!="function")return[];try{const H=getContactsSnapshot();if(!Array.isArray(H)||!H.length)return[];const Y=N=>typeof N=="string"?N.trim():"";return H.map(N=>{if(!N||typeof N!="object")return null;const ae=Y(N.id);if(!ae)return null;const de=Number.isFinite(N.createdAt)?N.createdAt:Date.now(),Q=Number.isFinite(N.updatedAt)?N.updatedAt:de,ne={id:ae,name:Y(N.name),role:Y(N.role),phone:Y(N.phone),email:Y(N.email),website:Y(N.website),notes:Y(N.notes),avatar:Y(N.avatar),createdAt:de,updatedAt:Q},V=Y(typeof getContactDisplayLabel=="function"?getContactDisplayLabel({...N,...ne}):N&&typeof N.label=="string"?N.label:"");return V&&(ne.label=V),ne}).filter(Boolean)}catch(H){return console.warn("Unable to prepare shared contact snapshot",H),[]}})();$.length&&(p.contacts=$);const z=FN({includeAutoGear:t,hasAutoGearRules:j,includeOwnedGearMarks:r,hasOwnedGearMarkers:E.length>0});z&&typeof z=="object"&&(p.metadata=z);const te=(()=>{const H={};return z&&typeof z=="object"&&Object.keys(z).forEach(Y=>{const N=z[Y];N==null?H[Y]=N:typeof N=="string"?H[Y]=N.length>120?`${N.slice(0,117)}…`:N:typeof N=="object"?H[Y]=Array.isArray(N)?{type:"array",length:N.length}:{type:"object",keys:Object.keys(N).length}:H[Y]=N}),{setupName:typeof i=="string"?i:"",setupKey:typeof L=="string"?L:"",includeAutoGear:!!t,includeOwnedGear:!!r,ownedGearMarkerCount:Array.isArray(E)?E.length:0,metadata:H,contacts:Array.isArray($)?$.length:0}})(),oe=H=>{H?console.warn("Project export failed",te,H):console.warn("Project export failed",te);const Y=getLocalizedText("shareExportFailed")||"Project export failed.";n?(n.textContent=Y,setStatusLevel(n,"danger"),n.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>n.classList.add("hidden"),6e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Export Failed",message:Y}):typeof alert=="function"&&alert(Y)};let k;try{k=JSON.stringify(p,null,2)}catch(H){console.error("Failed to serialize shared project",H),oe(H);return}const Z=downloadBackupPayload(k,e);if(a&&(a.checked=t&&j),o.includeOwnedGearCheckbox&&(o.includeOwnedGearCheckbox.checked=r&&E.length>0),!Z||!Z.success){oe();return}if(Z.method==="window-fallback"){const H=typeof getManualDownloadFallbackMessage=="function"?getManualDownloadFallbackMessage():getLocalizedText("manualDownloadFallback")||"The download did not start automatically. A new tab opened so you can copy or save the file manually.";n?(n.textContent=H,setStatusLevel(n,"warning"),n.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>n.classList.add("hidden"),8e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Download Blocked",message:H}):typeof alert=="function"&&alert(H);return}const ue=typeof getLocalizedText=="function"&&getLocalizedText("shareLinkCopied")||texts?.en?.shareLinkCopied||"Project file downloaded.";n?(n.textContent=ue,setStatusLevel(n,"success"),n.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>n.classList.add("hidden"),4e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Success",message:ue}):typeof alert=="function"&&alert(ue)}let fi=null;function DE(){const e=Bn();return{rental:e.providerRental||"Rental",user:e.providerUser||"User",crewHeading:e.providerCrewHeading||"Crew",unknown:e.providerUnknown||"Custom provider",help:e.providerHelp||""}}function zN(){if(fi={names:new Set,timestamp:Date.now()},typeof loadOwnGear!="function")return fi.names;try{const e=loadOwnGear();Array.isArray(e)&&e.forEach(t=>{if(t&&typeof t.name=="string"){const r=t.name.trim().toLowerCase();r&&fi.names.add(r)}})}catch(e){console.warn("Unable to refresh own gear cache for provider defaults",e)}return fi.names}function UN(){return!fi||!(fi.names instanceof Set)?zN():fi.names}const eL=typeof OWN_GEAR_SOURCE_CATALOG=="string"&&OWN_GEAR_SOURCE_CATALOG?OWN_GEAR_SOURCE_CATALOG:"catalog",$N=typeof OWN_GEAR_SOURCE_CUSTOM=="string"&&OWN_GEAR_SOURCE_CUSTOM?OWN_GEAR_SOURCE_CUSTOM:"custom";function zy(){if(typeof resolveOwnGearModule=="function")try{const t=resolveOwnGearModule();if(t&&typeof t=="object")return t}catch{}const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;return e&&typeof e.cineFeaturesOwnGear<"u"?e.cineFeaturesOwnGear:typeof cineFeaturesOwnGear=="object"&&cineFeaturesOwnGear?cineFeaturesOwnGear:null}function vG(){const e=zy();if(e&&typeof e.generateOwnGearId=="function")try{return e.generateOwnGearId()}catch{}if(typeof generateOwnGearId=="function")try{return generateOwnGearId()}catch{}const t=Date.now().toString(36),r=Math.floor(Math.random()*1e8).toString(36);return`own-${t}-${r}`}function dg(e){if(!e||typeof e!="object")return null;const t=zy();if(t&&typeof t.normalizeOwnGearRecord=="function")try{return t.normalizeOwnGearRecord(e)}catch{}if(typeof normalizeOwnGearRecord=="function")try{return normalizeOwnGearRecord(e)}catch{}const r=typeof e.name=="string"?e.name.trim():"";if(!r)return null;const o={id:typeof e.id=="string"&&e.id.trim()?e.id.trim():vG(),name:r};return typeof e.quantity=="string"&&e.quantity.trim()?o.quantity=e.quantity.trim():typeof e.quantity=="number"&&Number.isFinite(e.quantity)&&(o.quantity=String(e.quantity)),typeof e.notes=="string"&&e.notes.trim()&&(o.notes=e.notes.trim()),typeof e.source=="string"&&e.source.trim()&&(o.source=e.source.trim()),o}function tL(e){return Array.isArray(e)?e.map(t=>dg(t)).filter(Boolean).map(t=>({...t})):[]}function _E(){const e=zy();if(e&&typeof e.loadStoredOwnGearItems=="function")try{const t=e.loadStoredOwnGearItems();if(Array.isArray(t))return tL(t)}catch(t){console.warn("Unable to load own gear items for gear editor via module.",t)}if(typeof loadOwnGear=="function")try{const t=loadOwnGear();if(Array.isArray(t))return tL(t)}catch(t){console.warn("Unable to load own gear items for gear editor from storage.",t)}return[]}function Hb(e){const t=Array.isArray(e)?e.map(o=>dg(o)).filter(Boolean):[],r=zy();if(r&&typeof r.persistOwnGearItems=="function")try{return r.persistOwnGearItems(t),!0}catch(o){console.warn("Unable to persist own gear items via module for gear editor.",o)}if(typeof saveOwnGear=="function")try{return saveOwnGear(t),typeof document<"u"&&typeof document.dispatchEvent=="function"&&typeof CustomEvent=="function"&&document.dispatchEvent(new CustomEvent("own-gear-data-changed")),!0}catch(o){console.warn("Unable to persist own gear items via storage for gear editor.",o)}return!1}function FE(e,t,r){if(!Array.isArray(e))return{index:-1,record:null};const o=typeof t=="string"?t.trim():"",n=typeof r=="string"?r.trim().toLowerCase():"";let a=-1;return o&&(a=e.findIndex(i=>i&&i.id===o)),a===-1&&n&&(a=e.findIndex(i=>!i||typeof i.name!="string"?!1:i.name.trim().toLowerCase()===n)),{index:a,record:a>=0?e[a]:null}}function rL(e){return!e||typeof e!="object"||!e.classList?eL:e.classList.contains("gear-custom-item")?$N:eL}function qN(e,t,r={}){const o=!!(r&&r.wantsOwned),n=r&&typeof r.existingId=="string"?r.existingId.trim():"",a=_E(),i=typeof t.name=="string"?t.name.trim():"",s=typeof t.quantity=="string"?t.quantity.trim():"",{index:u,record:l}=FE(a,n,i);if(o&&i){if(l&&u>=0){let m=!1;const y={...l};l.name!==i&&(y.name=i,m=!0),s?l.quantity!==s&&(y.quantity=s,m=!0):l.quantity&&(delete y.quantity,m=!0);const S=rL(e);if(S&&l.source!==S&&(y.source=S,m=!0),!m)return{id:l.id,changed:!1};const E=dg(y);if(!E)return{id:l.id,changed:!1};const I=a.slice();return I[u]=E,Hb(I)?{id:E.id,changed:!0}:{id:l.id,changed:!1}}const p={id:vG(),name:i};s&&(p.quantity=s);const g=rL(e);g&&(p.source=g);const h=dg(p);if(!h)return{id:"",changed:!1};const A=a.slice();return A.push(h),Hb(A)?{id:h.id,changed:!0}:{id:"",changed:!1}}if(!l||u<0)return{id:"",changed:!1};const d=a.filter((p,g)=>g!==u);return Hb(d)?{id:"",changed:!0}:{id:l.id,changed:!1}}function VN(e,t={}){const r=typeof t.name=="string"?t.name.trim():"",o=typeof t.existingId=="string"?t.existingId.trim():"",n=_E();return FE(n,o,r).record}function fg(e){const t=typeof e=="string"?e.trim():"";return t&&UN().has(t.toLowerCase())?"user":"rental-house"}function WN(e){if(!e)return null;let t=e.querySelector(".gear-item-provider");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;if(t=r.createElement("span"),t.className="gear-item-provider",t.hidden=!0,e.classList?.contains("gear-custom-item")){const a=e.querySelector(".gear-custom-item-summary"),i=e.querySelector(".gear-item-note");if(a)return i?a.insertBefore(t,i):a.appendChild(t),t}const n=e.querySelector(".gear-item-note")||e.querySelector(".gear-item-edit-btn")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn");return n&&n.parentElement?n.parentElement.insertBefore(t,n):e.appendChild(t),t}function AG(e){const t=typeof e=="string"?e.trim():"";if(!t)return"";const r=t.split(/\s+/).filter(Boolean);if(!r.length)return"";const o=r[0];if(r.length===1)return o;const n=r[r.length-1],a=Array.from(n)[0]||"";if(!a)return o;const i=typeof a.toLocaleUpperCase=="function"?a.toLocaleUpperCase():a.toUpperCase();return`${o} ${i}`}function EG(e,t={}){const r=typeof e=="string"?e.trim():"",o=DE();if(!r)return{value:"",label:"",type:""};if(r==="rental-house")return{value:"rental-house",label:o.rental,type:"rental"};if(r==="user"){const n=typeof getUserProfileSnapshot=="function"?getUserProfileSnapshot():null,a=n&&n.name?n.name:"",i=AG(a);return{value:"user",label:i?`${i} — ${o.user}`:t.label||o.user,type:"user",profileName:a,profileDisplayName:i}}if(r.startsWith("contact:")){const n=r.slice(8),a=typeof getContactById=="function"?getContactById(n):null;if(a){const s=typeof getContactDisplayLabel=="function"?getContactDisplayLabel(a):a.name||a.email||a.phone||a.id||o.crewHeading;return{value:r,label:s,type:"contact",contactId:n}}const i=t&&t.label||(typeof getContactsText=="function"?getContactsText("missingContactFallback","Saved contact"):"Saved contact");return{value:r,label:i,type:"contact",contactId:n,missing:!0}}return{value:r,label:t&&t.label?t.label:o.unknown,type:"custom"}}function NE(e,t,r={}){if(!e)return;const o=EG(t||e.getAttribute("data-gear-provider")||"",{label:r.label});o.value?e.setAttribute("data-gear-provider",o.value):e.removeAttribute("data-gear-provider"),o.label?e.setAttribute("data-gear-provider-label",o.label):e.removeAttribute("data-gear-provider-label");const n=WN(e);n&&(o.label?(n.textContent=o.label,n.hidden=!1,n.setAttribute("data-provider-type",o.type||""),n.setAttribute("title",o.label),n.setAttribute("data-help",o.label)):(n.textContent="",n.hidden=!0,n.removeAttribute("data-provider-type"),n.removeAttribute("title"),n.removeAttribute("data-help")))}function oL(e){return e?e.textContent?e.textContent.trim():e.value:""}function CG(e,t={}){if(!e||!e.providerSelect)return;const r=e.providerSelect;for(;r.firstChild;)r.removeChild(r.firstChild);const o=DE(),n=typeof getUserProfileSnapshot=="function"?getUserProfileSnapshot():null,a=typeof getContactsSnapshot=="function"?getContactsSnapshot():[],i=r.ownerDocument||(typeof document<"u"?document:null);if(!i)return;const s=i.createElement("option");s.value="rental-house",s.textContent=o.rental,r.appendChild(s);const u=i.createElement("option");u.value="user";const l=n&&n.name?n.name:"",d=AG(l);if(u.textContent=d?`${d} — ${o.user}`:o.user,r.appendChild(u),a.length){const g=i.createElement("optgroup");g.label=o.crewHeading,a.forEach(h=>{const A=i.createElement("option");A.value=`contact:${h.id}`,A.textContent=h.label||h.name||h.email||h.phone||h.id,g.appendChild(A)}),r.appendChild(g)}const p=typeof t.providedBy=="string"&&t.providedBy.trim()?t.providedBy.trim():fg(t.name||"");if(p&&!Array.from(r.options).some(g=>g.value===p)){const g=i.createElement("option");g.value=p,g.textContent=t.providerLabel||(typeof getContactsText=="function"?getContactsText("missingContactFallback","Saved contact"):o.unknown),g.setAttribute("data-provider-fallback","true"),r.appendChild(g)}r.value=p||"rental-house"}function wG(e,t={}){if(!e||!e.cameraLinkSelect)return;const r=e.cameraLinkSelect;for(;r.firstChild;)r.removeChild(r.firstChild);const o=r.ownerDocument||(typeof document<"u"?document:null);if(!o)return;const n=Bn();if(!!e.isCameraItem){kd.forEach(p=>{const g=o.createElement("option");g.value=p;const h=n.cameraLinkDefaultLabel;g.textContent=h.replace("%s",p),g.dataset.cameraLabel=h.replace("%s",p),r.appendChild(g)});const d=On(typeof t.cameraLink=="string"&&t.cameraLink?t.cameraLink:e.currentCameraLinkValue||"")||"A";r.value=d,r.disabled=!1,r.removeAttribute("aria-disabled");return}const i=o.createElement("option");i.value="",i.textContent=n.cameraLinkNoneOption,r.appendChild(i);const s=HH(),u=new Map;s.forEach(d=>{!d||!d.letter||u.set(d.letter,d)}),kd.forEach(d=>{const p=o.createElement("option");p.value=d;const g=u.get(d),h=n.cameraLinkCameraOption,A=n.cameraLinkUnavailableOption,m=g&&g.label?h.replace("%s",d).replace("%s",g.label):A.replace("%s",d);p.textContent=m;const y=typeof t.cameraLinkLabel=="string"?t.cameraLinkLabel.trim():"";if(g&&g.label)p.dataset.cameraLabel=g.label;else if(y&&On(t.cameraLink)===d)p.dataset.cameraLabel=y;else{const S=n.cameraLinkDefaultLabel;p.dataset.cameraLabel=S.replace("%s",d)}p.dataset.cameraColor=Vy(d),r.appendChild(p)});const l=On(typeof t.cameraLink=="string"&&t.cameraLink?t.cameraLink:e.currentCameraLinkValue||"");r.value=l||""}function nL(e){const t=gearListOutput;if(!t)return;t.querySelectorAll(".gear-item, .gear-custom-item").forEach(o=>{const n=Wn(o);NE(o,n.providedBy,{label:n.providerLabel})}),uG()}async function Dv(){const e=wi(this),t=e.dialog,r=e.form,o=e.filenameInput,n=e.filenameMessage,a=e.includeAutoGearCheckbox,i=e.includeAutoGearLabel;Go();const s=$c(),u=getDefaultShareFilename(s),l=ensureJsonExtension(u);if(!t||!r||!o){const m=promptForSharedFilename(s);if(!m)return;const y=getAutoGearRules(),S=Array.isArray(y)&&y.length>0;let E=!1;S&&(E=await confirmAutoGearSelection(a?a.checked:!1)),a&&(a.checked=E&&S);const I=Jw(gearListOutput),L=I;e.includeOwnedGearCheckbox&&(e.includeOwnedGearCheckbox.checked=L&&I),await SG(m,E,L);return}if(o.value=l,o.setCustomValidity(""),n){const m=getLocalizedText("shareFilenamePrompt")||"";n.textContent=m.includes("{defaultName}")?m.replace("{defaultName}",u):m}const d=getAutoGearRules(),p=Array.isArray(d)&&d.length>0,g=Jw(gearListOutput);a&&(a.disabled=!p,a.setAttribute("aria-disabled",p?"false":"true"),p||(a.checked=!1)),i&&(i.classList.toggle("disabled",!p),i.setAttribute("aria-disabled",p?"false":"true"));const h=e.includeOwnedGearCheckbox,A=e.includeOwnedGearLabel;h&&(h.disabled=!g,h.setAttribute("aria-disabled",g?"false":"true"),h.checked=g),A&&(A.classList.toggle("disabled",!g),A.setAttribute("aria-disabled",g?"false":"true")),openDialog(t),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{o&&(o.focus(),o.select())}):o&&setTimeout(()=>{o.focus(),o.select()},0)}const aL=tt("shareSetupBtn","shareSetupBtn");aL&&aL.addEventListener("click",Dv);async function _v(e){e.preventDefault();const t=wi(this),r=t.filenameInput,o=t.dialog,n=t.includeAutoGearCheckbox,a=t.includeOwnedGearCheckbox;if(!r)return;const i=sanitizeShareFilename(r.value);if(!i){const d=getLocalizedText("shareFilenameInvalid")||"Please enter a valid file name to continue.";r.setCustomValidity(d),r.reportValidity();return}r.setCustomValidity("");const s=ensureJsonExtension(i),u=!!(n&&!n.disabled&&n.checked),l=!!(a&&!a.disabled&&a.checked);closeDialog(o),await SG(s,u,l)}function Fv(){const e=wi(this),t=e.filenameInput,r=e.dialog;t&&t.setCustomValidity(""),closeDialog(r)}function LG(e){e.preventDefault();const t=wi(this),r=t.filenameInput,o=t.dialog;r&&r.setCustomValidity(""),closeDialog(o)}const Sa=wi();Sa.form&&Sa.form.addEventListener("submit",_v);Sa.cancelButton&&Sa.cancelButton.addEventListener("click",Fv);Sa.dialog&&Sa.dialog.addEventListener("cancel",LG);function RG(){const t=wi(this).sharedLinkInput;if(!t||pendingSharedLinkListener)return;const r=t.files&&t.files[0];r&&readSharedProjectFile(r)}function IG(){const t=wi(this).sharedLinkInput;if(!t)return;pendingSharedLinkListener&&(t.removeEventListener("change",pendingSharedLinkListener),pendingSharedLinkListener=null);const r=()=>{t.removeEventListener("change",r),pendingSharedLinkListener=null;const o=t.files&&t.files[0];o&&readSharedProjectFile(o)};pendingSharedLinkListener=r,t.addEventListener("change",r),t.value="",t.click(),t.files&&t.files.length&&r()}Sa.sharedLinkInput&&Sa.sharedLinkInput.addEventListener("change",RG);Sa.applySharedLinkButton&&Sa.sharedLinkInput&&Sa.applySharedLinkButton.addEventListener("click",IG);function TG(){sharedImportPromptActive||lastSharedSetupData!==null&&reapplySharedImportSelection()}function Nv(e){e.preventDefault(),finalizeSharedImportPrompt(),applyStoredSharedImport()}function Hv(){finalizeSharedImportPrompt(),clearStoredSharedImportData()}function OG(e){e.preventDefault(),finalizeSharedImportPrompt(),clearStoredSharedImportData()}const as=fG();as.modeSelect&&as.modeSelect.addEventListener("change",TG);as.form&&as.form.addEventListener("submit",Nv);as.cancelButton&&as.cancelButton.addEventListener("click",Hv);as.dialog&&as.dialog.addEventListener("cancel",OG);xN(GG);function iL(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=typeof texts<"u"&&texts||(e&&typeof e.texts=="object"?e.texts:null),r=typeof currentLang=="string"&&t&&typeof t[currentLang]=="object"?currentLang:"en",o=t&&typeof t[r]=="object"&&t[r]||{},n=t&&typeof t.en=="object"&&t.en||{};return{langTexts:o,fallbackTexts:n}}function GG(e){if(!e||Kw)return;const t=wi(),r=fG();Fb(e.controllers,[{name:"shareDialog",value:{context:t,open:Dv,submit:_v,cancel:Fv,dismiss:LG}},{name:"sharedImportDialog",value:{context:r,submit:Nv,cancel:Hv,dismiss:OG,changeMode:TG}}],"cineUi controller registration (setups) failed"),Fb(e.interactions,[{name:"shareOpen",value:Dv},{name:"shareSubmit",value:_v},{name:"shareCancel",value:Fv},{name:"shareApplyFile",value:IG},{name:"shareInputChange",value:RG},{name:"sharedImportSubmit",value:Nv},{name:"sharedImportCancel",value:Hv}],"cineUi interaction registration (setups) failed"),Fb(e.help,[{name:"shareProject",value:()=>{const{langTexts:o,fallbackTexts:n}=iL();return o.shareSetupHelp||n.shareSetupHelp||"Download a JSON safety bundle of the current project so you can archive or share it offline. Store the file with your crew backups before closing the planner."}},{name:"sharedImport",value:()=>{const{langTexts:o,fallbackTexts:n}=iL();return o.applySharedLinkHelp||n.applySharedLinkHelp||"Load the configuration from a JSON backup exported via Save & Share or Backup & Restore. Review the preview before applying—nothing overwrites your current project until you confirm Save."}}],"cineUi help registration (setups) failed"),Kw=gG(e)}function KN(){const e=typeof globalThis<"u"&&globalThis.cineUi||typeof window<"u"&&window.cineUi||typeof self<"u"&&self.cineUi||null;return e?(GG(e),!0):!1}console.log("Registering setups with cineUi...");const YN=KN();console.log("Setups registration status:",YN);const jb=typeof cineResults=="object"?cineResults:null;jb&&typeof jb.setupRuntimeFeedback=="function"&&jb.setupRuntimeFeedback({openDialog:typeof openDialog=="function"?openDialog:null,closeDialog:typeof closeDialog=="function"?closeDialog:null,getCurrentSetupKey:typeof getCurrentSetupKey=="function"?getCurrentSetupKey:null,loadFeedback:typeof loadFeedbackSafe=="function"?loadFeedbackSafe:typeof loadFeedback=="function"?loadFeedback:null,saveFeedback:typeof saveFeedbackSafe=="function"?saveFeedbackSafe:typeof saveFeedback=="function"?saveFeedback:null,updateCalculations:typeof updateCalculations=="function"?updateCalculations:null,setButtonLabelWithIcon:typeof pn=="function"?pn:null,iconGlyphs:typeof ICON_GLYPHS<"u"?ICON_GLYPHS:null});function sL(e){return iG(e,{focusScalePreference:typeof focusScalePreference<"u"?focusScalePreference:void 0,normalizeFocusScale:typeof normalizeFocusScale=="function"?normalizeFocusScale:void 0,currentLang:typeof currentLang<"u"?currentLang:"en",diagramConnectorIcons:typeof diagramConnectorIcons<"u"?diagramConnectorIcons:{},powerInputTypes:typeof powerInputTypes=="function"?powerInputTypes:()=>[],ICON_GLYPHS:typeof ICON_GLYPHS<"u"?ICON_GLYPHS:{},DIAGRAM_MONITOR_ICON:typeof DIAGRAM_MONITOR_ICON<"u"?DIAGRAM_MONITOR_ICON:"",parseBatteryCurrentLimit:typeof ug=="function"?ug:void 0})}function QN(e){return oG(e)}function Ar(e){return nG(e,{devices:typeof devices<"u"?devices:{}})}const XN=(e,t)=>formatFizCableModule(e,t);function ZN(){const e={camera:typeof cameraSelect<"u"&&cameraSelect?cameraSelect.value:"",motors:typeof motorSelects<"u"?motorSelects.map(t=>t.value).filter(t=>t&&t!=="None"):[],controllers:typeof controllerSelects<"u"?controllerSelects.map(t=>t.value).filter(t=>t&&t!=="None"):[],distance:typeof distanceSelect<"u"&&distanceSelect?distanceSelect.value:"",devices:typeof devices<"u"?devices:{}};return aG(e)}function JN({hasMotor:e=!1,videoDistPrefs:t=[]}={}){const r=(V,fe)=>fe||(typeof document<"u"?document.getElementById(V):null),o=r("cameraSelect",typeof cameraSelect<"u"?cameraSelect:null),n=r("monitorSelect",typeof monitorSelect<"u"?monitorSelect:null),a=r("videoSelect",typeof videoSelect<"u"?videoSelect:null),i=r("batterySelect",typeof batterySelect<"u"?batterySelect:null),s=r("cageSelect",typeof cageSelect<"u"?cageSelect:null),u=r("distanceSelect",typeof distanceSelect<"u"?distanceSelect:null),l=V=>V&&typeof V.value<"u"?V.value:"",d=l(o),p=l(n),g=l(a),h=l(i),A=l(s),m=l(u),y=[],S=[],E=[],I=[],L=[],R=[],G=devices.accessories||{},j=new Set(["D-Tap to LEMO 2-pin","HDMI Cable"]);if(h){const V=(devices&&devices.batteries&&devices.batteries[h])?.mount_type;if(G.powerPlates)for(const[fe,J]of Object.entries(G.powerPlates))(!J.mount||J.mount===V)&&(!J.compatible||J.compatible.includes(d))&&y.push(fe);if(G.chargers){let fe=parseInt(batteryCountElem?.textContent||"",10);Number.isFinite(fe)||(fe=h?1:0);let J=0;if(Array.isArray(t)){const Le=t.filter(Je=>/Monitor(?: \d+")? handheld$/.test(Je)).length;J+=Le*3;const _e=t.filter(Je=>{const xe=Je.match(/Monitor (\d+(?:\.\d+)?)/);return xe&&parseFloat(xe[1])>10&&!/handheld$/.test(Je)}).length;J+=_e*2}e&&(J+=3);const Ae=(Le,_e)=>{if(!Le||_e<=0)return;const Je=QN(_e),xe=Ve=>{for(const[Dt,We]of Object.entries(G.chargers))if(We.mount===Le&&We.slots===Ve)return Dt;return null},Ze=(Ve,Dt)=>{const We=xe(Ve);if(We)for(let ft=0;ft<Dt;ft++)L.push(We)};Ze(4,Je.quad),Ze(2,Je.dual),Ze(1,Je.single)};V==="B-Mount"?(Ae("B-Mount",fe),Ae("V-Mount",J)):Ae(V,fe+J)}}if(d&&G.cages&&(!A||A==="None"))for(const[V,fe]of Object.entries(G.cages))(!fe.compatible||fe.compatible.includes(d))&&y.push(V);const $=G.cables?.power||{},z=(V,fe=S,J=!1)=>{const Ae=V?.power?.input?.type;(Array.isArray(Ae)?Ae:Ae?[Ae]:[]).forEach(_e=>{for(const[Je,xe]of Object.entries($)){const Ze=j.has(Je);xe.to===_e&&(!Ze||J)&&fe.push(Je)}})};d&&devices.cameras&&z(devices.cameras[d]),g&&devices.video&&z(devices.video[g]);const te=p&&devices.monitors?devices.monitors[p]:null;if(te){const V="Onboard monitor",fe=te?.power?.input?.type;(Array.isArray(fe)?fe.includes("LEMO 2-pin"):fe==="LEMO 2-pin")&&E.push(`D-Tap to Lemo-2-pin Cable 0,5m (${V})`,`D-Tap to Lemo-2-pin Cable 0,5m (${V})`);const Le=((d&&devices.cameras?devices.cameras[d]:null)?.videoOutputs||[]).map(Ze=>Ze?.type?.toUpperCase()),_e=(te.videoInputs||[]).map(Ze=>Ze?.type?.toUpperCase()),Je=Le.some(Ze=>Ze&&Ze.includes("SDI"))&&_e.some(Ze=>Ze&&Ze.includes("SDI")),xe=Le.includes("HDMI")&&_e.includes("HDMI");Je?E.push(`Ultraslim BNC Cable 0.5 m (${V})`,`Ultraslim BNC Cable 0.5 m (${V})`):xe&&E.push(`Ultraslim HDMI 0.5 m (${V})`,`Ultraslim HDMI 0.5 m (${V})`),I.push(`ULCS Arm mit 3/8" und 1/4" double (${V})`)}if(g){const V=g.replace(/ TX\b/," RX");devices.wirelessReceivers&&devices.wirelessReceivers[V]&&z(devices.wirelessReceivers[V])}devices.fiz&&devices.fiz.motors&&Array.isArray(motorSelects)&&motorSelects.forEach(V=>{const fe=l(V);fe&&z(devices.fiz.motors[fe])}),devices.fiz&&devices.fiz.controllers&&Array.isArray(controllerSelects)&&controllerSelects.forEach(V=>{const fe=l(V);fe&&z(devices.fiz.controllers[fe])}),devices.fiz&&devices.fiz.distance&&m&&z(devices.fiz.distance[m]);const oe=G.cables?.fiz||{},k=V=>{const fe=[];return V?(Array.isArray(V.fizConnectors)&&V.fizConnectors.forEach(J=>{const Ae=J&&typeof J=="object"?J.type:J;Ae&&fe.push(Ae)}),V.fizConnector&&fe.push(V.fizConnector),[...new Set(fe.filter(Boolean))]):fe},Z=(V,fe)=>{R.push(XN(V,fe))},ue={},H=(V,fe)=>{const J=[sanitizeFizContext(V),sanitizeFizContext(fe)].filter(Boolean);if(!J.length)return"";const Ae=J.join(" ↔ "),Le=Ae.toLowerCase(),_e=(ue[Le]||0)+1;return ue[Le]=_e,_e>1?`${Ae} #${_e}`:Ae},Y=(V,fe,J)=>{if(!V)return!1;const Ae=(Le,_e)=>V.from===Le&&V.to===_e||V.from===_e&&V.to===Le;if(V.from&&V.to&&Ae(fe,J))return!0;if(Array.isArray(V.connectors)){const Le=V.connectors;if(Le.includes(fe)&&Le.includes(J))return!0}return!1},N=motorSelects.map(V=>l(V)).filter(V=>V&&V!=="None").map(V=>({name:V,data:devices.fiz?.motors?.[V]})).filter(V=>V.data),ae=controllerSelects.map(V=>l(V)).filter(V=>V&&V!=="None").map(V=>({name:V,data:devices.fiz?.controllers?.[V]})).filter(V=>V.data);N.forEach(V=>{const fe=k(V.data);ae.forEach(J=>{const Ae=k(J.data);fe.forEach(Le=>{Ae.forEach(_e=>{if(Le===_e){for(const[Je,xe]of Object.entries(oe))if(Y(xe,Le,_e)){const Ze=H(V.name,J.name);Z(Je,Ze)}}})})})}),ZN().forEach(V=>R.push(V));const de=[...new Set(S)],Q=E.slice(),ne=[...new Set(I)];return{cameraSupport:[...new Set(y)],chargers:L,fizCables:R,misc:de,monitoringSupport:Q,rigging:ne}}function lL(e){if(!e||typeof e!="object")return{};const t={...e};return Array.isArray(e.people)&&(t.people=e.people.map(r=>({...r}))),Array.isArray(e.prepDays)&&(t.prepDays=[...e.prepDays]),Array.isArray(e.shootingDays)&&(t.shootingDays=[...e.shootingDays]),Array.isArray(e.returnDays)&&(t.returnDays=[...e.returnDays]),Array.isArray(e.storageRequirements)&&(t.storageRequirements=e.storageRequirements.map(r=>({...r}))),e.monitorBatteries&&typeof e.monitorBatteries=="object"&&(t.monitorBatteries={...e.monitorBatteries}),Array.isArray(e.lensSelections)&&(t.lensSelections=e.lensSelections.map(r=>({...r}))),t}function eH(e){const t={...e};return Array.isArray(e.people)&&(t.people=oa(e.people.map(r=>oa({...r})))),Array.isArray(e.prepDays)&&(t.prepDays=oa([...e.prepDays])),Array.isArray(e.shootingDays)&&(t.shootingDays=oa([...e.shootingDays])),Array.isArray(e.returnDays)&&(t.returnDays=oa([...e.returnDays])),Array.isArray(e.storageRequirements)&&(t.storageRequirements=oa(e.storageRequirements.map(r=>oa({...r})))),e.monitorBatteries&&typeof e.monitorBatteries=="object"&&(t.monitorBatteries=oa({...e.monitorBatteries})),Array.isArray(e.lensSelections)&&(t.lensSelections=oa(e.lensSelections.map(r=>oa({...r})))),oa(t)}function tH(e){if(typeof e!="string")return"";const t=e.trim();return t&&(t.match(/^data:image\/(png|jpeg|jpg|gif|webp);base64,/i)||/^[a-zA-Z0-9._-]+$/.test(t))?t:""}function Af(){if(!projectForm)return{};if(!xv&&fm)return lL(fm);const e=new FormData(projectForm),t=N=>{const ae=e.get(N);return typeof ae=="string"?ae.trim():""},r=N=>{const ae=e.getAll(N);return!ae||ae.length===0?"":ae.map(de=>typeof de=="string"?de:String(de)).join(", ")},o=r("viewfinderSettings"),n=r("frameGuides"),a=r("aspectMaskOpacity"),i=typeof collectFilterSelections=="function"?collectFilterSelections():"",u=(i?i.split(",").map(N=>N.split(":")[0]):[]).some(N=>N==="ND Grad HE"||N==="ND Grad SE")?"Swing Away":t("mattebox"),l=Array.from(crewContainer?.querySelectorAll(".person-row")||[]).map(N=>{const ae=N.querySelector(".person-role-select")?.value,de=N.querySelector(".person-name"),Q=N.querySelector(".person-phone"),ne=N.querySelector(".person-email"),V=N.querySelector(".person-website"),fe=N.querySelector(".person-avatar-data"),J=typeof ae=="string"?ae.trim():ae==null?"":String(ae),Ae=typeof de?.value=="string"?de.value.trim():"",Le=typeof Q?.value=="string"?Q.value.trim():"",_e=typeof ne?.value=="string"?ne.value.trim():"",Je=typeof V?.value=="string"?V.value.trim():"",xe=typeof fe?.value=="string"?fe.value.trim():"",Ze=tH(xe);return{role:J,name:Ae,phone:Le,email:_e,website:Je,avatar:Ze}}).filter(N=>N.role||N.name||N.phone||N.email||N.website||N.avatar),d=(N,ae,de)=>Array.from(N?.querySelectorAll(".period-row")||[]).map(Q=>{const ne=Q.querySelector(ae)?.value,V=Q.querySelector(de)?.value;return[ne,V].filter(Boolean).join(" to ")}).filter(Boolean),p=d(prepContainer,".prep-start",".prep-end"),g=d(shootContainer,".shoot-start",".shoot-end"),h=d(returnContainer,".return-start",".return-end"),A=gearListOutput?(()=>{const N=["gearListDirectorMonitor","gearListDopMonitor","gearListGafferMonitor","gearListDirectorMonitor15","gearListComboMonitor15","gearListDopMonitor15","gearListFocusMonitor","gearListProGaffColor1","gearListProGaffWidth1","gearListProGaffColor2","gearListProGaffWidth2","gearListEyeLeatherColor"],ae=new Map;return N.forEach(de=>{const Q=gearListOutput.querySelector(`#${de}`);if(!Q)return;const ne=Q.value;ae.set(de,typeof ne=="string"?ne:ne==null?"":String(ne))}),ae})():null,m=N=>A&&A.has(N)?A.get(N):"",y=gearListOutput?(()=>{const N={};return gearListOutput.querySelectorAll("select[data-monitor-battery-key]").forEach(ae=>{const de=ae.getAttribute("data-monitor-battery-key");if(!de)return;const Q=ae.value,ne=typeof Q=="string"?Q.trim():Q==null?"":String(Q);ne&&(N[de]=ne)}),N})():{},S=m("gearListProGaffColor1"),E=m("gearListProGaffWidth1"),I=m("gearListProGaffColor2"),L=m("gearListProGaffWidth2"),R={street:t("productionCompanyStreet"),street2:t("productionCompanyStreet2"),city:t("productionCompanyCity"),region:t("productionCompanyRegion"),postalCode:t("productionCompanyPostalCode"),country:t("productionCompanyCountry")},G=[];R.street&&G.push(R.street),R.street2&&G.push(R.street2);const j=[R.city,R.region,R.postalCode].map(N=>N||"").filter(N=>N);j.length&&G.push(j.join(", ")),R.country&&G.push(R.country);const $=es&&typeof es.snapshot=="function"?es.snapshot():{names:Bd(r("lenses")),lensSelections:[]},z=Array.isArray($.names)?$.names.map(N=>typeof N=="string"?N.trim():"").filter(Boolean):Bd($.names),te=Array.isArray($.lensSelections)?$.lensSelections.map(N=>({name:typeof N?.name=="string"?N.name.trim():"",mount:typeof N?.mount=="string"?N.mount.trim():"",mountState:typeof N?.mountState=="string"?N.mountState.trim():""})).filter(N=>N.name):[],oe={productionCompany:t("productionCompany"),productionCompanyAddress:G.join(`
`),productionCompanyStreet:R.street,productionCompanyStreet2:R.street2,productionCompanyCity:R.city,productionCompanyRegion:R.region,productionCompanyPostalCode:R.postalCode,productionCompanyCountry:R.country,rentalHouse:t("rentalHouse"),...l.length?{people:l}:{},prepDays:p,shootingDays:g,returnDays:h,deliveryResolution:t("deliveryResolution"),recordingResolution:t("recordingResolution"),slowMotionRecordingResolution:t("slowMotionRecordingResolution"),aspectRatio:r("aspectRatio"),codec:t("codec"),baseFrameRate:t("baseFrameRate"),recordingFrameRate:t("recordingFrameRate"),slowMotionBaseFrameRate:t("slowMotionBaseFrameRate"),slowMotionRecordingFrameRate:t("slowMotionRecordingFrameRate"),sensorMode:t("sensorMode"),slowMotionSensorMode:t("slowMotionSensorMode"),slowMotionAspectRatio:t("slowMotionAspectRatio"),lenses:z,requiredScenarios:r("requiredScenarios"),cameraHandle:r("cameraHandle"),viewfinderExtension:t("viewfinderExtension"),viewfinderEyeLeatherColor:m("gearListEyeLeatherColor")||t("viewfinderEyeLeatherColor"),mattebox:u,gimbal:r("gimbal"),viewfinderSettings:o,frameGuides:n,aspectMaskOpacity:a,videoDistribution:r("videoDistribution"),monitoringConfiguration:t("monitoringConfiguration"),monitorUserButtons:r("monitorUserButtons"),cameraUserButtons:r("cameraUserButtons"),viewfinderUserButtons:r("viewfinderUserButtons"),tripodHeadBrand:t("tripodHeadBrand"),tripodBowl:t("tripodBowl"),tripodTypes:r("tripodTypes"),tripodSpreader:t("tripodSpreader"),sliderBowl:Rc("getSliderBowlValue"),easyrig:Rc("getEasyrigValue"),filter:i};oe.lensSelections=te,y&&Object.keys(y).length&&(oe.monitorBatteries=y);const k=(N,ae)=>{const de=m(ae);de&&(oe[N]=de)},Z=(N,ae)=>{if(!gearListOutput)return;const de=gearListOutput.querySelector(`#${ae}`);de&&de.dataset&&de.dataset.autoGearManual==="true"&&(oe[`${N}Manual`]=!0)};k("directorMonitor","gearListDirectorMonitor"),k("dopMonitor","gearListDopMonitor"),k("gafferMonitor","gearListGafferMonitor"),k("directorMonitor15","gearListDirectorMonitor15"),k("comboMonitor15","gearListComboMonitor15"),k("dopMonitor15","gearListDopMonitor15"),oe.focusMonitor=m("gearListFocusMonitor")||"",Z("directorMonitor","gearListDirectorMonitor"),Z("dopMonitor","gearListDopMonitor"),Z("gafferMonitor","gearListGafferMonitor"),Z("directorMonitor15","gearListDirectorMonitor15"),Z("comboMonitor15","gearListComboMonitor15"),Z("dopMonitor15","gearListDopMonitor15"),Z("focusMonitor","gearListFocusMonitor"),(S||E)&&(oe.proGaffColor1=S||"",oe.proGaffWidth1=E||""),(I||L)&&(oe.proGaffColor2=I||"",oe.proGaffWidth2=L||"");const ue=Array.from(storageNeedsContainer?.querySelectorAll(".storage-row")||[]).map(N=>{const ae=N.querySelector(".storage-quantity"),de=N.querySelector(".storage-type"),Q=N.querySelector(".storage-variant"),ne=N.querySelector(".storage-notes"),V=ae?parseInt(ae.value,10):NaN,fe=Number.isFinite(V)&&V>0?V:null,J=typeof de?.value=="string"?de.value.trim():"",Ae=typeof Q?.value=="string"?Q.value.trim():"",Le=typeof ne?.value=="string"?ne.value.trim():"";if(!fe&&!J&&!Ae&&!Le)return null;const _e={};return fe&&(_e.quantity=fe),J&&(_e.type=J),Ae&&(_e.variant=Ae),Le&&(_e.notes=Le),_e}).filter(Boolean);ue.length&&(oe.storageRequirements=ue);const H=$c();H&&(oe.projectName=H);const Y=eH(oe);return fm=Y,xv=!1,lL(Y)}const rH=["ND","ND Grad HE","ND Grad SE","ND Grad Reverse","Polarizer","Variable ND","Diopter","Optical Flat","Rota-Pola","Mist","Glimmerglass","Diffusion","Streak","Star","UV","IR","Color","Effect"];function cL(e=[]){const t=document.getElementById("filter");if(!t)return;const r=new Set(rH);Array.isArray(e)&&e.forEach(s=>{s&&r.add(s)});const o=Array.from(r).sort();if(!t.options)return;const n=new Set(Array.from(t.options).map(s=>s.value));if(o.filter(s=>!n.has(s)).length===0&&t.options.length===o.length)return;t.innerHTML="";const i=document.createDocumentFragment();o.forEach(s=>{const u=document.createElement("option");u.value=s,u.textContent=s,i.appendChild(u)}),t.appendChild(i)}function kG(e){const t=document.getElementById("codec");if(t){if(t.options.length<=1){const r=["X-OCN XT","X-OCN ST","X-OCN LT","RAW HQ","RAW SQ","RAW MQ","ProRes 4444 XQ","ProRes 4444","ProRes 422 HQ","ProRes 422","ProRes 422 LT","ProRes 422 Proxy","DNxHR 444","DNxHR HQX","DNxHR HQ","DNxHR SQ","DNxHR LB","H.264","H.265"];t.innerHTML='<option value="">--</option>',r.forEach(o=>{const n=document.createElement("option");n.value=o,n.textContent=o,t.appendChild(n)})}e&&(t.value=e)}}function Uy(e={}){typeof window<"u"&&(window.cineSuppressAutosave=!0);try{const t=typeof projectForm<"u"?projectForm:typeof document<"u"?document.getElementById("projectForm"):null;if(!t)return;t.reset();const r=(g,h)=>{if(h===void 0)return;const A=t.querySelector(`[name="${g}"]`);if(!A)return;let m=h;if(g==="recordingFrameRate"||g==="slowMotionRecordingFrameRate"){if(typeof h=="number"&&Number.isFinite(h))m=h%1?h.toFixed(3).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1"):String(h);else if(typeof h=="string"){const y=h.trim(),S=y.match(/-?\d+(?:\.\d+)?/);if(S){const E=Number.parseFloat(S[0]);Number.isFinite(E)?m=E%1?E.toFixed(3).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1"):String(E):m=y}else m=y}}A.value=m},o=(g,h)=>{const A=projectForm.querySelector(`[name="${g}"]`);if(!A||h===void 0)return;const m=Array.isArray(h)?h:h?h.split(",").map(y=>y.trim()):[];A.options&&Array.from(A.options).forEach(y=>{y.selected=m.includes(y.value)})},n=(g,h)=>g||(typeof document<"u"?document.getElementById(h):null),a=n(typeof crewContainer<"u"?crewContainer:null,"crewContainer"),i=n(typeof prepContainer<"u"?prepContainer:null,"prepContainer"),s=n(typeof shootContainer<"u"?shootContainer:null,"shootContainer"),u=n(typeof returnContainer<"u"?returnContainer:null,"returnContainer"),l=n(typeof storageNeedsContainer<"u"?storageNeedsContainer:null,"storageNeedsContainer");populateRecordingResolutionDropdown(e.recordingResolution),populateSensorModeDropdown(e.sensorMode),kG(e.codec),typeof populateFrameRateDropdown=="function"&&populateFrameRateDropdown(e.recordingFrameRate),populateSlowMotionRecordingResolutionDropdown(e.slowMotionRecordingResolution),populateSlowMotionSensorModeDropdown(e.slowMotionSensorMode),typeof populateSlowMotionFrameRateDropdown=="function"&&populateSlowMotionFrameRateDropdown(e.slowMotionRecordingFrameRate),r("productionCompany",e.productionCompany);const d=(()=>{const g={street:e.productionCompanyStreet||"",street2:e.productionCompanyStreet2||"",city:e.productionCompanyCity||"",region:e.productionCompanyRegion||"",postalCode:e.productionCompanyPostalCode||"",country:e.productionCompanyCountry||""};if(Object.values(g).some(y=>y))return g;const A=typeof e.productionCompanyAddress=="string"?e.productionCompanyAddress.trim():"";if(!A)return g;const m=A.split(/\r?\n/).map(y=>y.trim()).filter(Boolean);return m.length&&(g.street=m[0]||"",g.street2=m[1]||"",m.length>=3&&(g.city=m.slice(2).join(", "))),g})();if(r("productionCompanyStreet",d.street),r("productionCompanyStreet2",d.street2),r("productionCompanyCity",d.city),r("productionCompanyRegion",d.region),r("productionCompanyPostalCode",d.postalCode),r("productionCompanyCountry",d.country),r("rentalHouse",e.rentalHouse),a){a.innerHTML="";const g=Array.isArray(e.people)?e.people.map(h=>h&&typeof h=="object"?{...h}:{}):[];if(typeof profile<"u"&&profile&&typeof profile=="object"){const h=typeof profile.name=="string"?profile.name.trim():""}g.forEach(h=>{createCrewRow(h)})}if(i){i.innerHTML="";const g=Array.isArray(e.prepDays)?e.prepDays:e.prepDays?String(e.prepDays).split(`
`):[""];g.length||g.push(""),g.forEach(h=>{const[A,m]=h.split(" to ");createPrepRow({start:A,end:m})})}if(s){s.innerHTML="";const g=Array.isArray(e.shootingDays)?e.shootingDays:e.shootingDays?String(e.shootingDays).split(`
`):[""];g.length||g.push(""),g.forEach(h=>{const[A,m]=h.split(" to ");createShootRow({start:A,end:m})})}if(u){u.innerHTML="";const g=Array.isArray(e.returnDays)?e.returnDays:e.returnDays?String(e.returnDays).split(`
`):[""];g.length||g.push(""),g.forEach(h=>{const[A,m]=h.split(" to ");createReturnRow({start:A,end:m})})}if(l){l.innerHTML="";const g=Array.isArray(e.storageRequirements)?e.storageRequirements:[];g.length?g.forEach(h=>createStorageRequirementRow(h)):createStorageRequirementRow()}r("deliveryResolution",e.deliveryResolution),o("aspectRatio",e.aspectRatio),r("baseFrameRate",e.baseFrameRate),r("recordingFrameRate",e.recordingFrameRate),r("sensorMode",e.sensorMode),r("slowMotionRecordingResolution",e.slowMotionRecordingResolution),r("slowMotionSensorMode",e.slowMotionSensorMode),r("slowMotionAspectRatio",e.slowMotionAspectRatio),r("slowMotionBaseFrameRate",e.slowMotionBaseFrameRate),r("slowMotionRecordingFrameRate",e.slowMotionRecordingFrameRate),es&&typeof es.applyInfo=="function"&&es.applyInfo(e||{}),o("requiredScenarios",e.requiredScenarios),o("cameraHandle",e.cameraHandle),r("viewfinderExtension",e.viewfinderExtension),r("viewfinderEyeLeatherColor",e.viewfinderEyeLeatherColor),r("mattebox",e.mattebox),o("gimbal",e.gimbal),o("viewfinderSettings",e.viewfinderSettings),o("frameGuides",e.frameGuides),o("aspectMaskOpacity",e.aspectMaskOpacity),o("videoDistribution",e.videoDistribution),r("monitoringConfiguration",e.monitoringConfiguration),o("monitorUserButtons",e.monitorUserButtons),o("cameraUserButtons",e.cameraUserButtons),o("viewfinderUserButtons",e.viewfinderUserButtons),r("tripodHeadBrand",e.tripodHeadBrand),r("tripodBowl",e.tripodBowl),o("tripodTypes",e.tripodTypes),r("tripodSpreader",e.tripodSpreader),typeof setSliderBowlValue=="function"&&setSliderBowlValue(e.sliderBowl||""),typeof setEasyrigValue=="function"&&setEasyrigValue(e.easyrig||"");const p=typeof parseFilterTokens=="function"?parseFilterTokens(e.filter):[];if(typeof cL=="function"&&cL(p.map(g=>g.type)),o("filter",p.map(g=>g.type)),typeof renderFilterDetails=="function"&&renderFilterDetails(p),p.forEach(({type:g,size:h,values:A})=>{const m=document.getElementById(`filter-size-${filterId(g)}`);m&&(m.value=h);const y=document.getElementById(`filter-values-${filterId(g)}`);if(y){const S=Array.isArray(A)?A:[];y.options&&Array.from(y.options).forEach(E=>{E.selected=S.includes(E.value)})}}),projectForm){const g=projectForm.querySelector("#rentalHouse");pm(g),Gu(g)}Xn()}finally{typeof window<"u"&&setTimeout(()=>{window.cineSuppressAutosave=!1},500)}}function oH(e){if(!e||!e.tripodPreferences||!e.tripodPreferences.includes("Zoom Remote handle"))return;let t=motorSelects.map(n=>n.value).filter(n=>n&&n!=="None");if(!t.length)return;if(t.length<2&&motorSelects[1]){let n=t[0];/cforce.*rf/i.test(n)&&devices.fiz.motors["Arri Cforce Mini"]&&(n="Arri Cforce Mini"),motorSelects[1].value=n,t=motorSelects.map(a=>a.value).filter(a=>a&&a!=="None")}const r=new Set(["Arri Master Grip (single unit)","Arri ZMU-4 (body only, wired)","Tilta Nucleus-M Hand Grip (single)","Tilta Nucleus-M II Handle (single)"]);if(!controllerSelects.map(n=>n.value).filter(n=>n&&n!=="None").some(n=>r.has(n))){const n=detectBrand(t[0]);let a=null;n==="arri"?a="Arri Master Grip (single unit)":n==="tilta"&&(a="Tilta Nucleus-M Hand Grip (single)"),a&&controllerSelects[0]&&(controllerSelects[0].value=a)}typeof updateCalculations=="function"&&updateCalculations(),typeof saveCurrentSession=="function"&&saveCurrentSession()}function nH(e){return(e||"").replace(/\s*\([^)]*\)\s*$/,"").trim()}function $s(e){return nH(e).toLowerCase()}function jv(e){const t=typeof normalizeAutoGearText=="function"?normalizeAutoGearText(e,{collapseWhitespace:!0}):(e==null?"":String(e)).trim().replace(/\s+/g," ");return t?t.replace(/^[\s\-–—]+/u,"").trim().toLowerCase():""}function aH(e){if(!e||!e.dataset)return"";const t=typeof e.dataset.autoGearNotes=="string"?e.dataset.autoGearNotes:"";if(t)return jv(t);const r=e.querySelector(".auto-gear-notes");return!r||typeof r.textContent!="string"?"":jv(r.textContent)}function BG(e,t){if(!e||!t)return!1;const r=$s(e),o=$s(t);return r===o?!0:r===$s(t.replace(/^\d+x\s+/,""))}function iH(e){if(typeof e!="string")return!1;const t=$s(Vv);return t?$s(e)===t:!1}function sH(e){return!e||typeof e!="object"?!1:iH(e.name)}function lH(){if(typeof texts=="object"&&texts){const e=texts[currentLang]?.autoGearMonitorLabel;if(typeof e=="string"&&e.trim())return e.trim();const t=texts.en?.autoGearMonitorLabel;if(typeof t=="string"&&t.trim())return t.trim()}return"Onboard monitors"}function cH(e){if(!e||typeof e.querySelectorAll!="function")return;const t=$s(Vv);if(!t)return;const r=lH(),o={id:hj,label:r},n=Array.from(e.querySelectorAll(".gear-item")).filter(a=>{if(!a)return!1;const i=qc(a)||a.textContent||"";return $s(i)===t});n.length&&n.forEach(a=>{const i=Math.max(1,pg(a));if(!a.classList.contains("auto-gear-item")){const u=normalizeAutoGearItem({id:bj,name:Vv,category:"Rigging",quantity:i,contextNotes:[r]});Uv(a,u,i,o);return}MG(a,o),Ky(a,o),zE(a).has(r)?Wi(a):_G(a,[r],i),Yy(a)})}function pg(e){if(!e)return 1;const r=(e.textContent||"").trim().match(/^(\d+)x\s+/);return r?parseInt(r[1],10):1}function HE(e,t){if(!e)return;const r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let o=null;for(;r.nextNode();){const i=r.currentNode;if(/\d+x\s+/i.test(i.textContent)){o=i;break}}if(!o){e.insertBefore(document.createTextNode(`${t}x `),e.firstChild);return}const n=o.textContent||"",a=n.match(/^(\s*)(\d+)x\s+(.*)$/);a?o.textContent=`${a[1]}${t}x ${a[3]}`:o.textContent=n.replace(/^(\d+)x\s+/,`${t}x `)}function uH(e){if(!e)return;const t=Array.from(e.childNodes);let r=!0;for(t.forEach(n=>{if(n.nodeType===Node.TEXT_NODE&&!n.textContent.trim()){e.removeChild(n);return}if(n.nodeName==="BR"){if(r||!n.nextSibling){e.removeChild(n);return}r=!0}else r=!1});e.firstChild&&e.firstChild.nodeName==="BR";)e.removeChild(e.firstChild);for(;e.lastChild&&e.lastChild.nodeName==="BR";)e.removeChild(e.lastChild);if(!(e.textContent?e.textContent.trim():"")&&!e.querySelector(".gear-item")){const n=e.closest("tr"),a=n?n.closest("tbody"):null;a&&a.classList.contains("auto-gear-category")&&a.remove()}}function dH(e){if(!e||!e.length)return null;const t=e.find(u=>u.nodeType===1&&u.classList&&u.classList.contains("gear-item"));if(t){const u=qc(t)||(t.textContent||"").replace(/^(\d+)x\s+/,"").trim(),l=pg(t);return{span:t,name:u,count:l}}const r=document.createElement("div");e.forEach(u=>r.appendChild(u.cloneNode(!0)));let o=r.innerHTML.replace(/<select[\s\S]*?<\/select>/gi,""),n;do n=o,o=o.replace(/<[^>]+>/g,"");while(o!==n);let a=o.trim();if(!a)return null;const i=a.match(/^(\d+)x\s+/);let s=1;return i&&(s=parseInt(i[1],10),a=a.slice(i[0].length).trim()),{span:null,name:a,count:s,wrapper:r}}function fH(e,t,r){if(!e.length)return;let o=!1;for(const n of e)if(n.nodeType===Node.TEXT_NODE){const a=n.textContent||"";if(/\d+x\s+/i.test(a)){n.textContent=a.replace(/^(\s*)(\d+)x\s+/,(i,s)=>`${s}${r}x `),o=!0;break}if(a.trim()){n.textContent=`${r}x ${a.trim().replace(/^(\d+)x\s+/,"")}`,o=!0;break}}else if(n.nodeType===1){const a=n.firstChild;if(a&&a.nodeType===Node.TEXT_NODE&&/\d+x\s+/i.test(a.textContent||"")){a.textContent=(a.textContent||"").replace(/^(\s*)(\d+)x\s+/,(i,s)=>`${s}${r}x `),o=!0;break}}if(!o){const n=e[0],a=n.parentNode;a&&a.insertBefore(document.createTextNode(`${r}x ${t.name}`),n)}}function uL(e,t,r){if(!e)return normalizeAutoGearQuantity(t.quantity);let o=typeof r=="number"?r:normalizeAutoGearQuantity(t.quantity);if(o<=0)return o;const n=Array.from(e.childNodes);if(!n.length)return o;const a=[];let i=[];n.forEach(u=>{u.nodeName==="BR"?(a.push({nodes:i,separator:u}),i=[]):i.push(u)}),a.push({nodes:i,separator:null});let s=!1;return a.forEach(u=>{if(!u.nodes.length||o<=0)return;const l=dH(u.nodes);if(!(!l||!l.name||!BG(t.name,l.name)))if(l.span){const d=l.count;d>o?(HE(l.span,d-o),o=0):(o-=d,u.nodes.forEach(p=>p.remove())),s=!0}else l.count>o&&l.count>1?(fH(u.nodes,l,l.count-o),o=0,s=!0):(o-=l.count,u.nodes.forEach(d=>d.remove()),s=!0)}),s&&uH(e),o}function dL(e){if(typeof e!="string")return"";const t=e.trim();return t?((texts[currentLang]||texts.en||{}).crewRoles||texts.en?.crewRoles||{})?.[t]||t:""}function jE(e){if(!e||typeof e!="object")return"";const t=typeof e.label=="string"?e.label.trim():"";if(t)return t;const r=Array.isArray(e.scenarios)?e.scenarios.filter(Boolean):[];if(r.length)return r.join(" + ");const o=Array.isArray(e.camera)?e.camera.filter(Boolean):[];if(o.length)return o.join(" + ");const n=Array.isArray(e.monitor)?e.monitor.filter(Boolean):[];if(n.length)return n.join(" + ");const a=Array.isArray(e.crewPresent)?e.crewPresent.filter(Boolean):[];if(a.length)return a.map(dL).join(" + ");const i=Array.isArray(e.crewAbsent)?e.crewAbsent.filter(Boolean):[];if(i.length)return i.map(dL).join(" + ");const s=Array.isArray(e.wireless)?e.wireless.filter(Boolean):[];if(s.length)return s.join(" + ");const u=Array.isArray(e.motors)?e.motors.filter(Boolean):[];if(u.length)return u.join(" + ");const l=Array.isArray(e.controllers)?e.controllers.filter(Boolean):[];if(l.length)return l.join(" + ");const d=Array.isArray(e.distance)?e.distance.filter(Boolean):[];if(d.length)return d.join(" + ");const p=Array.isArray(e.mattebox)?e.mattebox.filter(Boolean):[];if(p.length)return p.join(" + ");const g=Array.isArray(e.cameraHandle)?e.cameraHandle.filter(Boolean):[];if(g.length)return g.join(" + ");const h=Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.filter(Boolean).map(getViewfinderFallbackLabel):[];if(h.length)return h.join(" + ");const A=Array.isArray(e.videoDistribution)?e.videoDistribution.filter(Boolean).map(getVideoDistributionFallbackLabel):[];return A.length?A.join(" + "):""}function PG(e){const t=texts[currentLang]||texts.en||{},r=t.autoGearRuleTooltipUnnamed||texts.en?.autoGearRuleTooltipUnnamed||"Added by automatic gear rule";if(!e||typeof e!="object")return r;const o=jE(e);return o?(t.autoGearRuleTooltipNamed||texts.en?.autoGearRuleTooltipNamed||`${r}: %s`).replace("%s",o):r}function xG(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"?e.id.trim():"",r=jE(e);return!t&&!r?null:{id:t,label:r}}function pH(e){if(!e)return null;if(typeof e=="string"){const o=e.trim();return o?{id:"",label:o}:null}if(typeof e!="object")return null;const t=typeof e.id=="string"?e.id.trim():"",r=typeof e.label=="string"?e.label.trim():"";return!t&&!r?null:{id:t,label:r}}function zv(e){if(!Array.isArray(e)||!e.length)return[];const t=new Set,r=[];return e.forEach(o=>{const n=pH(o);if(!n)return;const a=n.id?n.id.toLowerCase():"",i=n.label?n.label.toLowerCase():"",s=a?`id:${a}`:i?`label:${i}`:"";!s||t.has(s)||(t.add(s),r.push({id:n.id,label:n.label}))}),r}function zb(e,t){const r=typeof t=="string"?t:t==null?"":String(t),o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};return typeof o.formatAutoGearSelectorValue=="function"?o.formatAutoGearSelectorValue(e,r):typeof Ar=="function"&&(e==="monitor"||e==="directorMonitor")?Ar(r):r}function xd(e){if(!e||!e.dataset)return[];const t=e.dataset,r=typeof t.autoGearRuleSources=="string"?t.autoGearRuleSources:"";let o=[];if(r)try{const n=JSON.parse(r);Array.isArray(n)&&(o=zv(n))}catch(n){console.warn("Failed to parse automatic gear rule metadata",n),o=[]}return o.length||(o=zv([{id:t.autoGearRuleId,label:t.autoGearRuleLabel}])),o}function $y(e,t){if(!e||!e.dataset)return;const r=zv(t),o=e.dataset;if(!r.length){delete o.autoGearRuleSources,delete o.autoGearRuleId,delete o.autoGearRuleLabel;return}try{o.autoGearRuleSources=JSON.stringify(r)}catch(a){console.warn("Failed to serialize automatic gear rule metadata",a)}const n=r[0];n.id?o.autoGearRuleId=n.id:delete o.autoGearRuleId,n.label?o.autoGearRuleLabel=n.label:delete o.autoGearRuleLabel}function MG(e,t){if(!e||!e.dataset)return;const r=xG(t),o=xd(e);r&&o.push(r),$y(e,o)}function mg(e){if(!Array.isArray(e)||!e.length)return"";const t=e.map(r=>{if(!r)return"";const o=typeof r.label=="string"?r.label.trim():"";return o||(typeof r.id=="string"?r.id.trim():"")}).filter(Boolean);return t.length?PG({label:t.join(", ")}):""}function zE(e){if(!e||!e.dataset||!e.dataset.autoGearContextCounts)return new Map;try{const t=JSON.parse(e.dataset.autoGearContextCounts);if(!t||typeof t!="object")return new Map;const r=new Map;return Object.keys(t).forEach(o=>{const n=o&&o.trim();if(!n)return;const a=Number(t[o]);!Number.isFinite(a)||a<=0||r.set(n,a)}),r}catch{return new Map}}function DG(e,t){if(!e||!e.dataset)return;if(!t||!(t instanceof Map)||t.size===0){delete e.dataset.autoGearContextCounts;return}const r={};t.forEach((n,a)=>{a&&(!Number.isFinite(n)||n<=0||(r[a]=n))}),Object.keys(r).length?e.dataset.autoGearContextCounts=JSON.stringify(r):delete e.dataset.autoGearContextCounts}const fL=new Map([["director handheld",1],["gaffer handheld",2],["dop handheld",3]]);function mH(e,t,r){if(!e||!e.dataset)return;const o=new Map,n=Math.max(0,Number(r)||0);Array.isArray(t)&&t.forEach(a=>{const i=a&&a.trim();i&&o.set(i,(o.get(i)||0)+n)}),DG(e,o),Wi(e)}function _G(e,t,r){if(!e||!e.dataset){Wi(e);return}if(!Array.isArray(t)||!t.length){Wi(e);return}const o=zE(e),n=Math.max(0,Number(r)||0);if(n<=0){Wi(e);return}t.forEach(a=>{const i=a&&a.trim();i&&o.set(i,(o.get(i)||0)+n)}),DG(e,o),Wi(e)}function Wi(e){if(!e)return;const t=zE(e),r=Array.from(t.entries()).filter(([,i])=>Number.isFinite(i)&&i>0);let o=e.querySelector(".auto-gear-context-notes");if(r.length<=1){o&&o.remove();return}const a=` (${r.sort(([i],[s])=>{const u=fL.get(i.trim().toLowerCase())??Number.POSITIVE_INFINITY,l=fL.get(s.trim().toLowerCase())??Number.POSITIVE_INFINITY;return u!==l?u-l:i.localeCompare(s,void 0,{sensitivity:"base"})}).map(([i,s])=>`${s}x ${i}`).join(", ")})`;if(!o){o=document.createElement("span"),o.className="auto-gear-context-notes";const i=e.querySelector(".auto-gear-selector-container"),s=e.querySelector(".auto-gear-notes"),u=i||s;u&&u.parentNode===e?e.insertBefore(o,u):e.appendChild(o)}o.textContent=a}function pL(e){if(!e)return;const t=e.options[e.selectedIndex],r=t?t.text:"",o=document.createElement("span"),n=window.getComputedStyle(e);o.style.fontFamily=n.fontFamily,o.style.fontSize=n.fontSize,o.style.fontWeight=n.fontWeight,o.style.letterSpacing=n.letterSpacing,o.style.textTransform=n.textTransform,o.style.visibility="hidden",o.style.position="absolute",o.style.whiteSpace="pre",o.textContent=r,document.body.appendChild(o);const a=o.getBoundingClientRect().width;document.body.removeChild(o),e.style.width=`calc(${a}px + 2.5em)`}function Uv(e,t,r,o){if(!e||!t)return;const n=t.name?t.name.trim():"";if(!n)return;const a=Vc(),i=a&&typeof a.noteLabel=="string"?a.noteLabel.trim():"",s=e.classList&&e.classList.contains("gear-item-rental-excluded")||e.getAttribute?.("data-rental-excluded")==="true",u=!!e.querySelector("select, input");if(!u)for(;e.firstChild;)e.removeChild(e.firstChild);if(e.classList.add("gear-item"),e.classList.add("auto-gear-item"),e.setAttribute("data-gear-name",n),i?e.setAttribute("data-rental-note",i):e.removeAttribute&&e.removeAttribute("data-rental-note"),e.dataset&&delete e.dataset.autoGearContextCounts,e.dataset){const A=xG(o);$y(e,A?[A]:[])}const l=xd(e),d=l.length?mg(l):PG(o);if(d?e.title=d:e.removeAttribute("title"),u)HE(e,r);else{const A=typeof Ar=="function"?Ar(n):n;e.appendChild(document.createTextNode(`${r}x ${A}`)),t.screenSize&&e.appendChild(document.createTextNode(` - ${t.screenSize}`))}e.dataset&&(t.ownGearId?e.dataset.autoGearOwnGearId=t.ownGearId:Object.prototype.hasOwnProperty.call(e.dataset,"autoGearOwnGearId")&&delete e.dataset.autoGearOwnGearId),t.ownGearId&&NE(e,"user"),Array.isArray(t.contextNotes)&&t.contextNotes.length?mH(e,t.contextNotes,r):Wi(e);const p=t.selectorType||"none",g=t.selectorDefault||"",h=getAutoGearSelectorLabel(p);if(!u&&p&&p!=="none")if(t.selectorEnabled){const A=getAutoGearSelectorOptions(p,t),y=`autoGearSelector_${o&&o.id?o.id.replace(/[^a-zA-Z0-9_-]/g,""):"rule"}_${t.id}`,S=document.createElement("select");S.id=y,S.className="auto-gear-selector",S.dataset.autoGearSelectorType=p,t.selectorContext&&(S.dataset.autoGearSelectorContext=t.selectorContext),h&&S.setAttribute("aria-label",h);let E="";if(A.forEach(L=>{const R=document.createElement("option");R.value=L,R.textContent=zb(p,L),!E&&g&&L.toLowerCase()===g.toLowerCase()&&(E=R.value),S.appendChild(R)}),g&&!E){const L=document.createElement("option");L.value=g,L.textContent=zb(p,g),S.insertBefore(L,S.firstChild),E=g}if(E?S.value=E:S.options.length&&(S.selectedIndex=0),!S.options.length){const L=document.createElement("option");L.value="",L.textContent=h||"",L.disabled=!0,L.selected=!0,S.appendChild(L),S.disabled=!0}const I=document.createElement("span");I.className="auto-gear-selector-container",I.appendChild(S),e.appendChild(document.createTextNode(" - ")),e.appendChild(I),requestAnimationFrame(()=>{pL(S)}),S.addEventListener("change",()=>{pL(S)})}else if(g){const A=zb(p,g);e.appendChild(document.createTextNode(` - ${h}: ${A}`))}else h&&e.appendChild(document.createTextNode(` - ${h}`));if(e.dataset&&(t.notes?e.dataset.autoGearNotes=t.notes:Object.prototype.hasOwnProperty.call(e.dataset,"autoGearNotes")&&delete e.dataset.autoGearNotes),t.notes){const A=t.notes.trim().toLowerCase().startsWith("incl")?" ":" – ",m=document.createElement("span");m.className="auto-gear-notes",m.textContent=`${A}${t.notes}`,e.appendChild(m)}Ef(e,s),Ky(e,o),Yy(e)}function gH(e,t,r){if(!e)return;const o=normalizeAutoGearItem(t);if(!o)return;const n=normalizeAutoGearQuantity(o.quantity);if(n<=0)return;const a=o.name?o.name.trim():"";if(!a)return;const i=Array.from(e.querySelectorAll(".gear-item")),s=jv(o.notes);for(const l of i){const d=qc(l)||(l.textContent||"").replace(/^(\d+)x\s+/,"").trim();if(BG(a,d)){const p=aH(l);if(s){if(l.classList.contains("auto-gear-item")){if(!p||p!==s)continue}else if(p&&p!==s)continue}else if(l.classList.contains("auto-gear-item")&&p)continue;if(l.classList.contains("auto-gear-item")){const g=pg(l)+n;HE(l,g),Array.isArray(o.contextNotes)&&o.contextNotes.length?_G(l,o.contextNotes,n):Wi(l),l.dataset&&(o.notes?l.dataset.autoGearNotes=o.notes:Object.prototype.hasOwnProperty.call(l.dataset,"autoGearNotes")&&delete l.dataset.autoGearNotes),r&&typeof r=="object"?MG(l,r):l.dataset&&$y(l,xd(l));const h=mg(xd(l));h?l.title=h:l.removeAttribute("title"),Ky(l,r),Yy(l)}else{const h=pg(l)+n;Uv(l,o,h,r)}return}}e.childNodes.length&&e.appendChild(document.createElement("br"));const u=document.createElement("span");Uv(u,o,n,r),e.appendChild(u)}function yH(e,t){const r=t&&typeof t=="string"?t.trim():String(t??"").trim(),o=r.toLowerCase(),n=r||AUTO_GEAR_CUSTOM_CATEGORY,a=Array.from(e.querySelectorAll("tbody.category-group")).find(g=>{if(g.dataset){const I=(g.dataset.autoCategory||"").trim().toLowerCase();if(o&&I===o)return!0;const L=(g.dataset.gearTableCategory||"").trim().toLowerCase();if(o&&L===o)return!0}const h=(g.getAttribute("data-auto-category")||"").trim().toLowerCase();if(o&&h===o)return!0;const A=(g.getAttribute("data-gear-table-category")||"").trim().toLowerCase();if(o&&A===o)return!0;const m=g.querySelector(".category-row td");if(!m)return!1;const y=(m.getAttribute("data-gear-category-label")||"").trim().toLowerCase();if(o&&y===o)return!0;let S=m.textContent.trim();S.endsWith("+")&&(S=S.substring(0,S.length-1).trim());const E=S.toLowerCase();return o?E===o:g.classList.contains("auto-gear-category")||E===n.toLowerCase()});if(a)return a.querySelector("tr:not(.category-row) td")||null;const i=document.createElement("tbody");i.className="category-group auto-gear-category",i.dataset.autoCategory=r,i.dataset.gearTableCategory=r||n;const s=document.createElement("tr");s.className="category-row";const u=document.createElement("td"),l=r||texts[currentLang]?.autoGearCustomCategory||texts.en?.autoGearCustomCategory||"Custom Additions";u.setAttribute("data-gear-category-label",l),u.textContent=l,s.appendChild(u),i.appendChild(s);const d=document.createElement("tr"),p=document.createElement("td");return d.appendChild(p),i.appendChild(d),e.appendChild(i),p}function bH(e,t){if(!e)return null;const r=t&&typeof t=="string"?t.trim():String(t??"").trim(),o=r.toLowerCase(),n=r||AUTO_GEAR_CUSTOM_CATEGORY,a=Array.from(e.querySelectorAll("tbody.category-group"));for(const i of a){if(i.dataset){const h=(i.dataset.autoCategory||"").trim().toLowerCase();if(o&&h===o){const m=i.querySelector("tr:not(.category-row) td");if(m)return m}const A=(i.dataset.gearTableCategory||"").trim().toLowerCase();if(o&&A===o){const m=i.querySelector("tr:not(.category-row) td");if(m)return m}}const s=(i.getAttribute("data-auto-category")||"").trim().toLowerCase();if(o&&s===o){const h=i.querySelector("tr:not(.category-row) td");if(h)return h}const u=(i.getAttribute("data-gear-table-category")||"").trim().toLowerCase();if(o&&u===o){const h=i.querySelector("tr:not(.category-row) td");if(h)return h}const l=i.querySelector(".category-row td");if(!l)continue;const d=(l.getAttribute("data-gear-category-label")||"").trim().toLowerCase();if(o&&d===o){const h=i.querySelector("tr:not(.category-row) td");if(h)return h}let p=l.textContent.trim();p.endsWith("+")&&(p=p.substring(0,p.length-1).trim());const g=p.toLowerCase();if(o){if(g===o){const h=i.querySelector("tr:not(.category-row) td");if(h)return h}}else if(i.classList.contains("auto-gear-category")||g===n.toLowerCase()){const h=i.querySelector("tr:not(.category-row) td");if(h)return h}}return null}function hH(e){if(typeof e!="string")return"all";const t=e.trim().toLowerCase();return t?t==="or"?"any":t==="and"?"all":t==="any"?"any":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":"all":"all"}function SH(e){const t=parseInt(e,10);return Number.isFinite(t)&&t>1?t:1}function vH(e,t){if(!e||typeof e!="object")return{active:!0,multiplier:1};const r=Array.isArray(e.scenarios)?e.scenarios.filter(Boolean):[];if(!r.length)return{active:!0,multiplier:1};const o=r.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!o.length)return{active:!1,multiplier:0};const n=hH(e.scenarioLogic);if(n==="any"){const i=o.some(s=>t.has(s));return{active:i,multiplier:i?1:0}}if(n==="multiplier"){const i=typeof e.scenarioPrimary=="string"?e.scenarioPrimary:"",s=normalizeAutoGearTriggerValue(i);let u="";if(s&&o.includes(s)?u=s:u=o[0]||"",!u||!t.has(u))return{active:!1,multiplier:0};const l=o.filter(g=>g!==u);if(!l.length)return{active:!0,multiplier:1};const d=l.every(g=>t.has(g)),p=SH(e.scenarioMultiplier);return{active:!0,multiplier:d?p:1}}const a=o.every(i=>t.has(i));return{active:a,multiplier:a?1:0}}function AH(e){return Number.isFinite(e)?Number(e).toFixed(3):""}function EH(e){if(!Number.isFinite(e))return"";const t=Number(Number(e).toFixed(2));return Number.isFinite(t)?String(t):""}function CH(e){if(!e||typeof e!="object")return!1;const t=Array.isArray(e.mattebox)?e.mattebox.filter(Boolean):[];if(!t.length)return!1;const r=t.map(o=>normalizeAutoGearTriggerValue(o).replace(/-/g," ")).filter(Boolean);return r.length?r.includes("clamp on"):!1}function wH(e){const t=Bd(e?e.lenses:null);if(!t.length)return[];const r=devices&&devices.lenses?devices.lenses:null;if(!r||typeof r!="object")return[];const o=new Map;Object.keys(r).forEach(i=>{if(typeof i!="string"||!i)return;const s=i.trim().toLowerCase();s&&!o.has(s)&&o.set(s,r[i])});const n=new Map;return t.forEach(i=>{if(typeof i!="string")return;const s=i.trim();if(!s)return;const u=s.toLowerCase();let l=Object.prototype.hasOwnProperty.call(r,s)?r[s]:null;if(!l&&o.has(u)&&(l=o.get(u)),!l||typeof l!="object")return;const d=Number(l.frontDiameterMm);if(!Number.isFinite(d)||d<=0)return;const p=AH(d);if(!p)return;n.has(p)||n.set(p,{diameter:d,lenses:[]});const g=n.get(p);g.lenses.indexOf(s)===-1&&g.lenses.push(s)}),n.size?Array.from(n.values()).sort((i,s)=>i.diameter===s.diameter?0:i.diameter<s.diameter?-1:1).map(({diameter:i,lenses:s})=>{const l={name:`Mattebox Clamp-On Backing ${EH(i)||String(Number(i))}mm`,category:"Matte box + filter",quantity:1};return Array.isArray(s)&&s.length&&(l.contextNotes=[`Lenses: ${s.join(", ")}`]),l}):[]}function LH(e,t){const r=[],o=new Set,n=a=>{if(!a||typeof a!="object")return;const i=typeof a.name=="string"?a.name.trim():"";if(!i)return;const s=typeof a.category=="string"?a.category.trim():"",u=`${i.toLowerCase()}|${s.toLowerCase()}`;o.has(u)||(o.add(u),r.push(a))};return e.forEach(n),t.forEach(n),r}function RH(e,t){const r=typeof getEnabledAutoGearRules=="function"?getEnabledAutoGearRules():autoGearRules.filter(D=>!D||D.enabled!==!1);if(!e||!r.length||typeof document>"u")return e;const o=t&&t.requiredScenarios?t.requiredScenarios.split(",").map(D=>D.trim()).filter(Boolean):[],n=new Set(o.map(normalizeAutoGearTriggerValue).filter(Boolean)),a=t&&typeof t.mattebox=="string"?t.mattebox.trim():"",i=normalizeAutoGearTriggerValue(a),u=(t&&typeof t.cameraHandle=="string"?t.cameraHandle.split(",").map(D=>D.trim()).filter(Boolean):[]).map(normalizeAutoGearTriggerValue).filter(Boolean),l=new Set(u),d=t&&typeof t.viewfinderExtension=="string"?t.viewfinderExtension.trim():"",g=!!d?normalizeAutoGearTriggerValue(d):"",h=t&&typeof t.deliveryResolution=="string"?t.deliveryResolution.trim():"",A=normalizeAutoGearTriggerValue(h);let m=[];t&&Array.isArray(t.videoDistribution)?m=t.videoDistribution:t&&typeof t.videoDistribution=="string"&&(m=t.videoDistribution.split(",").map(D=>D.trim()).filter(Boolean));const y=m.map(Fw).map(D=>D==="__none__"?"":normalizeAutoGearTriggerValue(D)).filter(Boolean),S=new Set(y),E=t&&typeof t.cameraSelection=="string"?t.cameraSelection.trim():"",I=normalizeAutoGearTriggerValue(E),L=devices&&devices.cameras?devices.cameras:null,R=(()=>{if(!L)return null;const D={};return Object.keys(L).forEach(q=>{const we=L[q];if(!we||!Number.isFinite(we.weight_g))return;const ve=normalizeAutoGearTriggerValue(q);ve&&!Object.prototype.hasOwnProperty.call(D,ve)&&(D[ve]=Number(we.weight_g))}),D})(),G=(()=>{if(!L)return null;const D=E&&Object.prototype.hasOwnProperty.call(L,E)?L[E]:null;return D&&Number.isFinite(D.weight_g)?Number(D.weight_g):!I||!R?null:Object.prototype.hasOwnProperty.call(R,I)?R[I]:null})(),j=t&&typeof t.monitorSelection=="string"?t.monitorSelection.trim():"",$=normalizeAutoGearTriggerValue(j),z=(()=>{if(typeof getAutoGearOwnGearItems!="function")return new Set;try{const D=getAutoGearOwnGearItems();return new Set((Array.isArray(D)?D:[]).map(q=>q&&typeof q.id=="string"?q.id.trim():"").filter(Boolean))}catch{return new Set}})(),te=t&&typeof t.wirelessSelection=="string"?t.wirelessSelection.trim():"",oe=normalizeAutoGearTriggerValue(te),k=t&&typeof t.tripodHeadBrand=="string"?t.tripodHeadBrand.trim():"",Z=normalizeAutoGearTriggerValue(k),ue=t&&typeof t.tripodBowl=="string"?t.tripodBowl.trim():"",H=normalizeAutoGearTriggerValue(ue),Y=Array.isArray(t?.tripodTypes)?t.tripodTypes:typeof t?.tripodTypes=="string"?t.tripodTypes.split(",").map(D=>D.trim()).filter(Boolean):[],N=new Set(Y.map(D=>normalizeAutoGearTriggerValue(D)).filter(Boolean)),ae=t&&typeof t.tripodSpreader=="string"?t.tripodSpreader.trim():"",de=normalizeAutoGearTriggerValue(ae),Q=new Set(Array.isArray(t?.people)?t.people.map(D=>D&&typeof D.role=="string"?D.role.trim():"").filter(Boolean).map(D=>normalizeAutoGearTriggerValue(D)).filter(Boolean):[]),ne=[];t&&(Array.isArray(t.motorSelections)&&ne.push(...t.motorSelections),Array.isArray(t.motors)&&ne.push(...t.motors));const V=new Set(ne.filter(D=>typeof D=="string").map(D=>normalizeAutoGearTriggerValue(D)).filter(Boolean)),fe=[];t&&(Array.isArray(t.controllerSelections)&&fe.push(...t.controllerSelections),Array.isArray(t.controllers)&&fe.push(...t.controllers));const J=new Set(fe.filter(D=>typeof D=="string").map(D=>normalizeAutoGearTriggerValue(D)).filter(Boolean)),Ae=D=>{if(typeof D!="string")return 0;const q=D.trim();if(!q)return 0;const we=q.split(" to ");let ve=we[0]?we[0].trim():"",Se=we[1]?we[1].trim():"";if(!ve&&Se&&(ve=Se),!Se&&ve&&(Se=ve),!ve)return 0;const he=ke=>ke?Date.parse(`${ke}T00:00:00Z`):NaN,ge=he(ve);let pe=he(Se);return Number.isFinite(ge)?(Number.isFinite(pe)||(pe=ge),pe<ge?1:Math.floor((pe-ge)/(1440*60*1e3))+1):0},_e=(t?Array.isArray(t.shootingDays)?t.shootingDays:typeof t.shootingDays=="string"?t.shootingDays.split(`
`).map(D=>D.trim()).filter(Boolean):[]:[]).reduce((D,q)=>D+Ae(q),0),Je=t&&typeof t.distanceSelection=="string"?t.distanceSelection.trim():"",xe=normalizeAutoGearTriggerValue(Je);if(!o.length&&!r.some(q=>(Array.isArray(q.scenarios)?q.scenarios.filter(Boolean):[]).length===0))return e;const Ze=D=>{if(!D||typeof D!="object")return!1;const q=[];return Array.isArray(D.add)&&q.push(D.add),Array.isArray(D.remove)&&q.push(D.remove),q.some(we=>we.some(ve=>!ve||typeof ve!="object"?!1:(typeof ve.category=="string"?ve.category.trim().toLowerCase():"")==="matte box + filter"))},Ve=[];if(r.forEach(D=>{if(!D)return;let q=1;if(D.always)q=1;else{const Oe=vH(D,n);if(!Oe.active)return;q=Oe.multiplier||1}const we=Array.isArray(D.mattebox)?D.mattebox.filter(Boolean):[];if(we.length){const Oe=we.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!i||!Oe.includes(i))return!1}const ve=Array.isArray(D.camera)?D.camera.filter(Boolean):[],Se=normalizeAutoGearCameraWeightCondition(D.cameraWeight);if(ve.length){const Oe=ve.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!I||!Oe.includes(I))return!1}const he=Array.isArray(D.ownGear)?D.ownGear.filter(Boolean):[];if(he.length){const Oe=he.map(Gt=>typeof Gt=="string"?Gt.trim():"").filter(Boolean);if(!Oe.length)return!1;const ct=normalizeAutoGearConditionLogic(D.ownGearLogic);if(ct==="none"){if(Oe.some(Gt=>z.has(Gt)))return!1}else if(ct==="any"||ct==="or"){if(!Oe.some(Gt=>z.has(Gt)))return!1}else if(!Oe.every(Gt=>z.has(Gt)))return!1}if(Se&&(!Number.isFinite(G)||!evaluateAutoGearCameraWeightCondition(Se,G)))return!1;const ge=Array.isArray(D.monitor)?D.monitor.filter(Boolean):[];if(ge.length){const Oe=ge.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!$||!Oe.includes($))return!1}const pe=Array.isArray(D.tripodHeadBrand)?D.tripodHeadBrand.filter(Boolean):[];if(pe.length){const Oe=pe.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!Z||!Oe.includes(Z))return!1}const ze=Array.isArray(D.tripodBowl)?D.tripodBowl.filter(Boolean):[];if(ze.length){const Oe=ze.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!H||!Oe.includes(H))return!1}const ke=Array.isArray(D.tripodTypes)?D.tripodTypes.filter(Boolean):[];if(ke.length){const Oe=ke.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!Oe.every(ct=>N.has(ct)))return!1}const nt=Array.isArray(D.tripodSpreader)?D.tripodSpreader.filter(Boolean):[];if(nt.length){const Oe=nt.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!de||!Oe.includes(de))return!1}const Ct=Array.isArray(D.crewPresent)?D.crewPresent.filter(Boolean):[];if(Ct.length){const Oe=Ct.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!Oe.every(ct=>Q.has(ct)))return!1}const Ot=Array.isArray(D.crewAbsent)?D.crewAbsent.filter(Boolean):[];if(Ot.length){const Oe=Ot.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||Oe.some(ct=>Q.has(ct)))return!1}const xt=Array.isArray(D.wireless)?D.wireless.filter(Boolean):[];if(xt.length){const Oe=xt.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!oe||!Oe.includes(oe))return!1}const or=Array.isArray(D.motors)?D.motors.filter(Boolean):[];if(or.length){const Oe=or.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length)return!1;const ct=Oe.includes(Nw),Gt=Oe.filter(kt=>kt!==Nw);if(ct&&V.size===0||Gt.length&&!Gt.every(kt=>V.has(kt)))return!1}const er=Array.isArray(D.controllers)?D.controllers.filter(Boolean):[];if(er.length){const Oe=er.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!Oe.every(ct=>J.has(ct)))return!1}const wr=Array.isArray(D.distance)?D.distance.filter(Boolean):[];if(wr.length){const Oe=wr.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!xe||!Oe.includes(xe))return!1}const Pt=normalizeAutoGearShootingDaysCondition(D.shootingDays);if(Pt&&Number.isFinite(Pt.value)&&Pt.value>0){if(Pt.mode==="minimum"){if(_e<Pt.value)return!1}else if(Pt.mode==="maximum"){if(_e>Pt.value)return!1}else if(Pt.mode==="every"){const Oe=Pt.value,ct=Oe>0?Math.floor(_e/Oe):0;if(ct<1)return!1;q*=ct}}const Pr=Array.isArray(D.cameraHandle)?D.cameraHandle.filter(Boolean):[];if(Pr.length){const Oe=Pr.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!Oe.every(ct=>l.has(ct)))return!1}const Wt=Array.isArray(D.viewfinderExtension)?D.viewfinderExtension.filter(Boolean):[];if(Wt.length){const Oe=Wt.map(ct=>normalizeAutoGearTriggerValue(ct)).filter(Boolean);if(!Oe.length||!g||!Oe.includes(g))return!1}const _t=Array.isArray(D.deliveryResolution)?D.deliveryResolution.filter(Boolean):[];if(_t.length){const Oe=_t.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!Oe.length||!A||!Oe.includes(A))return!1}const _r=Array.isArray(D.videoDistribution)?D.videoDistribution.filter(Boolean):[];if(_r.length){const Oe=_r.map(ct=>Fw(ct)).map(ct=>ct==="__none__"?"":normalizeAutoGearTriggerValue(ct)).filter(Boolean);if(!Oe.length||!Oe.every(ct=>S.has(ct)))return!1}Ve.push({rule:D,multiplier:q})}),!Ve.length)return e;if(i){const D=Ve.filter(({rule:q})=>{if(!Ze(q))return!0;const we=Array.isArray(q.mattebox)?q.mattebox.filter(Boolean):[];if(!we.length)return!0;const ve=we.map(normalizeAutoGearTriggerValue).filter(Boolean);return ve.length?ve.includes(i):!1});if(!D.length)return e;Ve.length=0,D.forEach(q=>Ve.push(q))}const Dt=document.createElement("div");Dt.innerHTML=e;const We=Dt.querySelector(".gear-table");if(!We)return e;let ft=!1;return Ve.forEach(({rule:D,multiplier:q})=>{const we=Math.max(1,Math.round(Number.isFinite(q)?q:1));D.remove.forEach(he=>{let ge=normalizeAutoGearQuantity(he.quantity)*we;if(ge<=0)return;const pe=bH(We,he.category);if(pe&&(ge=uL(pe,he,ge)),ge>0){const ze=Array.from(We.querySelectorAll("tbody.category-group tr:not(.category-row) td"));for(const ke of ze)if(ke!==pe&&(ge=uL(ke,he,ge),ge<=0))break}});const ve=Array.isArray(D.add)?D.add.slice():[];let Se=ve;if(CH(D)){const he=wH(t);he.length&&(Se=LH(ve,he))}Se.forEach(he=>{const ge=normalizeAutoGearQuantity(he.quantity)*we,pe=ge===normalizeAutoGearQuantity(he.quantity)?he:{...he,quantity:ge},ze=yH(We,he.category);ze&&gH(ze,pe,D),!ft&&sH(he)&&(ft=!0)})}),ft&&cH(We),Dt.innerHTML}function mL(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.replace(/[^0-9+*#;,]/g,"");return r||""}function gL(e){if(typeof e!="string")return"";const t=e.trim();if(!t||!t.includes("@"))return"";const r=t.replace(/\s+/g,"");if(!r||!r.includes("@"))return"";const o=encodeURIComponent(r);return o?o.replace(/%40/g,"@"):""}function IH(e){if(e&&typeof e=="object"){if(typeof e.__html=="string"&&e.__html)return e.__html;if(Array.isArray(e)&&e.length){const r=e.map(o=>Te(typeof o=="string"?o:String(o||""))).join("<br>");if(r)return r}if(typeof e.text=="string"&&e.text)return Te(e.text).replace(/\n/g,"<br>")}const t=typeof e=="string"?e:e==null?"":String(e);return Te(t).replace(/\n/g,"<br>")}function Rn(e,t,r){const o=texts?.[currentLang]?.[e],n=texts?.en?.[e],a=typeof o=="string"&&o.trim()?o:typeof n=="string"&&n.trim()?n:t;return!r||typeof r!="object"?a:Object.keys(r).reduce((i,s)=>{const u=r[s],l=typeof u=="string"?u:String(u??"");return i.replace(new RegExp(`\\{${s}\\}`,"g"),l)},a)}function Vc(e={}){const t=Rn("gearListExcludeRentalToggle","Exclude for rental"),r=Rn("gearListIncludeRentalToggle","Include for rental"),o=Rn("gearListRentalNote","Rental handles this item"),n=cG({fallback:o,rentalHouse:e&&e.rentalHouse?e.rentalHouse:void 0,input:e&&e.input?e.input:void 0});return{excludeLabel:t,includeLabel:r,noteLabel:n}}function Ef(e,t){if(!e||typeof e!="object")return!1;const r=!!t,o=e.classList?.contains("gear-item-rental-excluded")||e.getAttribute?.("data-rental-excluded")==="true",n=e.querySelector?.(".gear-rental-toggle");if(r?(e.classList?.add("gear-item-rental-excluded"),e.setAttribute?.("data-rental-excluded","true")):(e.classList?.remove("gear-item-rental-excluded"),e.removeAttribute?.("data-rental-excluded")),n){const i=n.getAttribute("data-label-off")||"",s=n.getAttribute("data-label-on")||i;n.setAttribute("aria-pressed",r?"true":"false"),n.textContent=r&&s||i}const{noteLabel:a}=Vc();return a&&e.getAttribute?e.getAttribute("data-rental-note")!==a&&e.setAttribute("data-rental-note",a):e.removeAttribute&&e.removeAttribute("data-rental-note"),o!==r}function gg(e){return typeof e!="string"||!e.trim()?"category":e.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+/,"").replace(/-+$/,"")||"category"}function UE(e){return!gearListOutput||typeof e!="string"?null:gearListOutput.querySelector(`.gear-custom-items[data-gear-custom-list="${e}"]`)}const TH={camera:["cameras"],"camera-support":["accessories.cameraSupport"],media:["media","accessories.media","accessories.cardReaders"],lens:["lenses"],"lens-support":["accessories.cameraSupport","accessories.rigging"],"matte-box-filter":["accessories.matteboxes","accessories.filters"],"lds-fiz":["fiz","accessories.cables.fiz"],"camera-batteries":["batteries","accessories.batteries"],"monitoring-batteries":["batteries","accessories.batteries"],chargers:["accessories.chargers"],monitoring:["monitors","directorMonitors","video","videoAssist","iosVideo"],"monitoring-support":["accessories.rigging","accessories.grip","accessories.carts"],rigging:["accessories.rigging","accessories.grip"],power:["accessories.power","accessories.powerPlates"],grip:["accessories.grip"],"carts-and-transportation":["accessories.carts"],miscellaneous:["accessories.matteboxes","accessories.filters","accessories.cables"],consumables:[]};function OH(e){return!e||typeof e!="object"||Array.isArray(e)?!1:Object.values(e).some(t=>{if(t===null)return!0;const r=typeof t;return!!(r==="string"||r==="number"||r==="boolean"||Array.isArray(t))})}function FG(e){if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([r,o])=>{if(!(!o||typeof o!="object")){if(OH(o)){t.push(r);return}t.push(...FG(o))}}),t}function GH(e){if(!e||typeof e!="string")return[];const t=e.split(".");let r=devices;for(let o=0;o<t.length;o+=1){const n=t[o];if(!r||typeof r!="object")return[];r=r[n]}return!r||typeof r!="object"?[]:FG(r)}function kH(e){if(!gearListOutput||typeof e!="string")return[];const t=gearListOutput.querySelector(`.category-group[data-gear-custom-key="${e}"]`);if(!t)return[];const r=new Set,o=n=>{if(typeof n!="string")return;const a=n.trim();if(!a)return;const i=a.match(/^(?:\d+\s*x\s+)?(.+)$/i),s=i?i[1].trim():a;!s||/^none$/i.test(s)||r.add(s)};return t.querySelectorAll(".gear-standard-items .gear-item").forEach(n=>{const a=qc(n)||n.getAttribute("data-gear-name");o(a||n.textContent||"")}),t.querySelectorAll("select option").forEach(n=>{if(!n||typeof n.value!="string")return;const a=n.value.trim();a&&o(a)}),Array.from(r)}function BH(e,t){const r=e||gg(t||""),o=new Set,n=[];(TH[r]||[]).forEach(s=>{GH(s).forEach(u=>{if(typeof u!="string")return;const l=u.trim();if(!l||/^none$/i.test(l))return;const d=l.toLowerCase();o.has(d)||(o.add(d),n.push(l))})}),kH(r).forEach(s=>{const u=s.trim();if(!u||/^none$/i.test(u))return;const l=u.toLowerCase();o.has(l)||(o.add(l),n.push(u))});const i=typeof localeSort=="function"?localeSort:(s,u)=>s.localeCompare(u,void 0,{sensitivity:"base"});return n.sort(i)}function PH(e,t){const r=UE(e);if(!r)return null;const o=r.ownerDocument||(typeof document<"u"?document:null);if(!o)return null;const n=BH(e,t),a=r.querySelector(`datalist[data-gear-custom-suggestions="${e}"]`);if(!n.length)return a&&a.remove(),null;const i=`gear-custom-suggestions-${e}`,s=n.map(l=>`<option value="${Te(l)}"></option>`).join("");let u=a;return u?u.id!==i&&(u.id=i):(u=o.createElement("datalist"),u.id=i,u.setAttribute("data-gear-custom-suggestions",e),r.appendChild(u)),u._lastRenderedOptions!==s&&(u.innerHTML=s,u._lastRenderedOptions=s),i}function $E(e,t,r){if(!e)return;const o=PH(t,r);o?e.setAttribute("data-gear-suggestions",o):e.removeAttribute("data-gear-suggestions")}function NG(e){if(!e)return;const t=e.querySelector(".gear-custom-item-preview");if(!t)return;const r=(e.getAttribute("data-gear-quantity")||"").trim(),o=e.getAttribute("data-gear-label")||e.getAttribute("data-gear-name")||"",n=String(o||"").trim(),a=(e.getAttribute("data-gear-attributes")||"").trim(),i=Rn("gearListCustomItemPreviewFallback","Custom item");let s="";r&&n?s=`${r}x ${n}`:n?s=n:r?s=`${r}x ${i}`:s=i,a&&(s+=` (${a})`),t.textContent=s}function xH(e,t){if(!e)return;const r=e.querySelector(".gear-item-note");if(!r)return;const o=r.ownerDocument||(typeof document<"u"?document:null),n=typeof Ei=="function"?Ei("gearListNoteLabel"):"",a=typeof n=="string"&&n.trim()?n.trim():"Note:",s=(typeof t=="string"?t:String(t??"")).trim();if(s){let u=r.querySelector(".gear-item-note__label"),l=r.querySelector(".gear-item-note__text");!u&&o&&(u=o.createElement("span"),u.className="gear-item-note__label",r.firstChild?r.insertBefore(u,r.firstChild):r.appendChild(u)),!l&&o&&(l=o.createElement("span"),l.className="gear-item-note__text",r.appendChild(l)),u&&l?(u.textContent=a,l.textContent=s):r.textContent=`${a} ${s}`,r.hidden=!1,r.removeAttribute("hidden"),r.setAttribute("aria-label",`${a} ${s}`.trim())}else{const u=r.querySelector(".gear-item-note__label"),l=r.querySelector(".gear-item-note__text");u&&(u.textContent=""),l&&(l.textContent=""),r.textContent="",r.hidden=!0,r.setAttribute("hidden",""),r.removeAttribute("aria-label")}}function HG(e){if(!e)return null;let t=e.querySelector(".gear-item-note");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-note",t.hidden=!0;const o=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(o)o.appendChild(t);else{const n=e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");n?e.insertBefore(t,n):e.appendChild(t)}return t}function jG(e){if(!e)return null;let t=e.querySelector(".gear-item-extra-indicator");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-extra-indicator",t.hidden=!0;const o=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(o){const n=o.querySelector(".gear-item-note");n?o.insertBefore(t,n):o.appendChild(t)}else{const n=e.querySelector(".gear-item-note")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");n?e.insertBefore(t,n):e.appendChild(t)}return t}let Ff=null;function MH(){if(Ff&&Ff.size)return Ff;const e=new Set;if(["camera","cameras"].forEach(r=>e.add(r)),typeof Ei=="function"){const r=Ei("category_cameras");typeof r=="string"&&r.trim()&&(e.add(r.trim().toLowerCase()),e.add(gg(r)))}const t=typeof texts=="object"&&texts?texts:null;return t&&typeof Object.keys=="function"&&Object.keys(t).forEach(r=>{const o=t[r];if(!o||typeof o!="object")return;const n=o.category_cameras;if(typeof n=="string"&&n.trim()){const a=n.trim().toLowerCase();e.add(a),e.add(gg(n))}}),Ff=e,e}function sl(e){if(!e||typeof e.closest!="function")return!1;const t=e.closest("tbody.category-group");if(!t)return!1;const r=(t.getAttribute("data-gear-category-label")||"").trim().toLowerCase(),o=(t.getAttribute("data-gear-custom-key")||"").trim().toLowerCase(),n=(t.getAttribute("data-gear-table-category")||"").trim().toLowerCase(),a=MH();return r&&a.has(r)||o&&a.has(o)||n&&a.has(n)}function qy(){if(typeof cameraSelect>"u"||!cameraSelect)return"";const e=cameraSelect.options&&cameraSelect.options[cameraSelect.selectedIndex];if(!e||e.value&&e.value==="None")return"";const t=typeof e.text=="string"?e.text:e.textContent||"";return typeof t=="string"?t.trim():""}function zG(e){if(typeof e!="string")return"";const t=e.trim();return t?/^#[0-9a-f]{6}$/i.test(t)?t.toLowerCase():/^[0-9a-f]{6}$/i.test(t)?`#${t.toLowerCase()}`:"":""}function DH(e){const t=()=>{let o=0;if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"){const a=new Uint8Array(1);crypto.getRandomValues(a),o=a[0]/255}else o=Math.random();const n=Math.floor(o*200)+28;return Math.max(24,Math.min(232,n))};return`#${[t(),t(),t()].map(o=>o.toString(16).padStart(2,"0")).join("")}`}let gm=null;function _H(){if(gm)return gm;const e={A:"#d32f2f",B:"#1e88e5",C:"#fdd835",D:"#43a047",E:"#7b1fa2"};let t=null;try{if(typeof localStorage<"u"){const r=localStorage.getItem(Hw);r&&(t=JSON.parse(r))}}catch(r){console.warn("Failed to read stored camera colors",r),t=null}if(t&&typeof t=="object")kd.forEach(r=>{const o=t[r]||t[r.toLowerCase()],n=zG(o);n&&(e[r]=n)});else{const r=DH();r&&(e.E=r);try{typeof localStorage<"u"&&localStorage.setItem(Hw,JSON.stringify(e))}catch(o){console.warn("Unable to persist default camera colors",o)}}return gm=e,e}function On(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";if(t.toLowerCase()==="camera")return"A";const r=t[0].toUpperCase();return kd.includes(r)?r:""}function FH(){const e=_H();if(typeof getCameraLetterColors=="function")try{const t=getCameraLetterColors();if(t&&typeof t=="object"){const r={...e};return kd.forEach(o=>{const n=t[o]||t[o.toLowerCase()],a=zG(n);a&&(r[o]=a)}),r}}catch(t){console.warn("Failed to load camera letter colors",t)}return e}function Vy(e){const t=FH(),r=On(e);return r&&t[r]?t[r]:t.A}function NH(e){if(typeof e!="string"||!e)return"";const t=e.trim().match(/^#?([0-9a-f]{3}|[0-9a-f]{6})$/i);if(!t)return"";let r=t[1];r.length===3&&(r=r.split("").map(s=>s+s).join(""));const o=parseInt(r.slice(0,2),16)/255,n=parseInt(r.slice(2,4),16)/255,a=parseInt(r.slice(4,6),16)/255;return .2126*o+.7152*n+.0722*a>.55?"#111111":"#ffffff"}function HH(e){const t=gearListOutput||(typeof document<"u"?document:null);if(!t||typeof t.querySelectorAll!="function")return[];const r=t.querySelectorAll('[data-gear-camera-role="source"], [data-gear-camera-letter]'),o=new Map;return r.forEach(n=>{if(!n||typeof n.getAttribute!="function"||!sl(n))return;const a=n.getAttribute("data-gear-camera-letter")||n.getAttribute("data-gear-camera-link")||"",i=On(a);if(!i||o.has(i))return;const s=(n.getAttribute("data-gear-camera-link-label")||n.getAttribute("data-gear-label")||n.textContent||"").trim();o.set(i,{letter:i,label:s})}),Array.from(o.values())}function yL(e){const t=gearListOutput||(typeof document<"u"?document:null);if(!t||typeof t.querySelectorAll!="function")return;const r=t.querySelectorAll(".gear-item, .gear-custom-item"),n=Bn().cameraLinkBadgeLabel;r.forEach(a=>{if(!a||typeof a.getAttribute!="function")return;const i=a.getAttribute("data-gear-camera-link")||a.getAttribute("data-gear-camera-letter")||"",s=On(i),u=sl(a),l=a.getAttribute("data-gear-camera-link-label")||(u?qy():"")||"",d=l?`${n} — ${l}`:n,p=s?Vy(s):"";UG(a,!!s,{isPrimary:u,badgeLabel:d,letter:s,color:p})})}function jH(e){if(!e)return null;let t=e.querySelector(".gear-item-camera-link");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;const o=Bn();t=r.createElement("span"),t.className="gear-item-camera-link",t.hidden=!0,t.setAttribute("data-camera-letter","");const n=r.createElement("span");n.className="gear-item-camera-link__icon",n.setAttribute("aria-hidden","true"),n.textContent="A",t.appendChild(n);const a=r.createElement("span");a.className="visually-hidden",a.setAttribute("data-camera-link-assist","true"),a.textContent=o.cameraLinkBadgeLabel,t.appendChild(a);const i=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(i){const s=i.querySelector(".gear-item-note");s?i.insertBefore(t,s):i.appendChild(t)}else{const s=e.querySelector(".gear-item-note")||e.querySelector(".gear-item-provider")||e.querySelector(".gear-item-extra-indicator")||e.querySelector(".gear-item-edit-btn")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn");s?e.insertBefore(t,s):e.appendChild(t)}return t}function UG(e,t,r={}){const o=jH(e);if(!o)return;if(!t){o.hidden=!0,o.setAttribute("hidden",""),o.classList.remove("gear-item-camera-link--primary"),o.removeAttribute("data-camera-letter"),o.style.removeProperty("--camera-link-color"),o.style.removeProperty("--camera-link-text-color");return}const n=Bn();o.hidden=!1,o.removeAttribute("hidden"),o.classList.toggle("gear-item-camera-link--primary",!!r.isPrimary);const a=o.querySelector(".gear-item-camera-link__icon");if(a){const s=On(r.letter||r.iconText||"")||"A";a.textContent=s,o.setAttribute("data-camera-letter",s);const u=r.color||Vy(s);if(u){o.style.setProperty("--camera-link-color",u);const l=NH(u);l?o.style.setProperty("--camera-link-text-color",l):o.style.removeProperty("--camera-link-text-color")}else o.style.removeProperty("--camera-link-color"),o.style.removeProperty("--camera-link-text-color")}const i=o.querySelector("[data-camera-link-assist]");if(i){const s=r.badgeLabel||n.cameraLinkBadgeLabel;i.textContent=s}}function $G(e){if(!e)return null;let t=e.querySelector(".gear-item-text");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-text";const o=[];e.childNodes.forEach(a=>{if(a){if(a.nodeType===1){const i=a.classList;if(i&&(i.contains("gear-item-note")||i.contains("gear-item-extra-indicator")||i.contains("gear-item-edit-btn")||i.contains("gear-custom-item-actions")||i.contains("gear-custom-remove-btn")))return}o.push(a)}});const n=e.querySelector(".gear-item-extra-indicator")||e.querySelector(".gear-item-note")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");return o.forEach(a=>{t.appendChild(a)}),n?e.insertBefore(t,n):e.appendChild(t),t}function qE(e){const t=typeof e=="string"?e.trim():"";if(!t)return{quantity:"",name:"",attributes:""};let r=t,o="";const n=r.match(/^(\d+)\s*x\s*(.*)$/i);n&&(o=n[1]||"",r=n[2]||"");const a=r.match(/^(.*?)(?:\s*\(([^()]+)\))?$/),i=a?(a[1]||"").trim():r.trim(),s=a&&a[2]?a[2].trim():"";return{quantity:o,name:i,attributes:s}}function Wn(e){if(!e)return{quantity:"",name:"",attributes:"",note:"",rentalExcluded:!1};const t=e.getAttribute("data-gear-quantity")||"",r=e.getAttribute("data-gear-label")||e.getAttribute("data-gear-name")||"",o=e.getAttribute("data-gear-attributes")||"",n=e.getAttribute("data-gear-note")||"",a=e.getAttribute("data-gear-provider")||"",i=e.getAttribute("data-gear-provider-label")||"",s=e.getAttribute("data-gear-extra")==="true",u=e.getAttribute("data-gear-extra-start")||"",l=e.getAttribute("data-gear-extra-end")||"",d=e.getAttribute("data-gear-extra-label")||"",p=e.querySelector(".gear-item-text"),g=p?p.textContent:e.textContent||"",h=qE(g),A=t.trim()||h.quantity||"",m=r.trim()||h.name||"",y=o.trim()||h.attributes||"",S=n.trim(),E=e.getAttribute("data-rental-excluded")==="true"||e.classList.contains("gear-item-rental-excluded");let I=a.trim();I||(I=fg(m));const L=i.trim(),R=e.getAttribute("data-gear-camera-link")||"",G=e.getAttribute("data-gear-camera-letter")||"",j=e.getAttribute("data-gear-camera-link-label")||"",$=sl(e);let z=On(R||G);$&&!z&&(z="A");const te=j.trim()||($?qy():"");return{quantity:A,name:m,attributes:y,note:S,rentalExcluded:E,providedBy:I,providerLabel:L,extra:s,extraStart:u.trim(),extraEnd:l.trim(),extraLabel:d.trim(),cameraLink:z,cameraLinkLabel:te}}function $v(e){if(!e)return{name:"",attributes:""};const t=e.getAttribute("data-gear-original-name")||e.getAttribute("data-gear-name")||"",r=qE(t);let o=e.getAttribute("data-gear-original-label")||"",n=e.getAttribute("data-gear-original-attributes")||"";return!o&&r.name&&(o=r.name),!n&&r.attributes&&(n=r.attributes),{name:typeof o=="string"?o.trim():"",attributes:typeof n=="string"?n.trim():""}}function qG(){const e=typeof texts=="object"&&texts?texts:{},t=typeof currentLang=="string"&&e[currentLang]?currentLang:"en",r=e[t]||{},o=e.en||{};return{indicatorBase:r.gearListExtraIndicatorNoPeriod||o.gearListExtraIndicatorNoPeriod||"Temporary extra",indicatorRange:r.gearListExtraIndicatorRange||o.gearListExtraIndicatorRange||"Temporary extra: %s – %s",indicatorStart:r.gearListExtraIndicatorOpen||o.gearListExtraIndicatorOpen||"Temporary extra from %s",indicatorEnd:r.gearListExtraIndicatorEnd||o.gearListExtraIndicatorEnd||"Temporary extra until %s"}}function VG(){const e=typeof texts=="object"&&texts?texts:{},t=typeof currentLang=="string"&&e[currentLang]?currentLang:"en",r=e[t]||{},o=e.en||{};return{categoryLabel:r.gearListExtraCategoryLabel||o.gearListExtraCategoryLabel||"Temporary Extras",addButton:r.addExtraGearBtn||o.addExtraGearBtn||"Add temporary extra gear",checkboxLabel:r.gearListEditExtraLabel||o.gearListEditExtraLabel||"Temporary extra gear",checkboxHelp:r.gearListEditExtraHelp||o.gearListEditExtraHelp||"",periodHelp:r.gearListEditExtraPeriodHelp||o.gearListEditExtraPeriodHelp||"",startLabel:r.gearListEditExtraStartLabel||o.gearListEditExtraStartLabel||"Needed from",endLabel:r.gearListEditExtraEndLabel||o.gearListEditExtraEndLabel||"Needed until"}}function bL(e){const t=typeof e=="string"?e.trim():"";if(!t)return"";const r=new Date(t);if(Number.isNaN(r.getTime()))return t;try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium"}).format(r)}catch{}return t}function WG(e,t){const r=typeof e=="string"?e.trim():"",o=typeof t=="string"?t.trim():"";let n=r,a=o;if(r&&o){const i=new Date(r),s=new Date(o);!Number.isNaN(i.getTime())&&!Number.isNaN(s.getTime())&&i.getTime()>s.getTime()&&(n=o,a=r)}return{start:n,end:a}}function zH(e,t){const r=qG(),o=bL(e),n=bL(t);return o&&n?r.indicatorRange.replace("%s",o).replace("%s",n):o?r.indicatorStart.replace("%s",o):n?r.indicatorEnd.replace("%s",n):r.indicatorBase}function Tc(e,t={},r={}){if(!e)return;const o=e.ownerDocument||(typeof document<"u"?document:null);if(!o)return;const n=e.classList&&e.classList.contains("gear-custom-item"),a=n?e.querySelector(".gear-item-text"):$G(e);if(HG(e),!a&&!n)return;let i=typeof t.quantity=="string"?t.quantity.trim():String(t.quantity??"").trim();const s=typeof t.name=="string"?t.name.trim():String(t.name??"").trim(),u=typeof t.attributes=="string"?t.attributes.trim():String(t.attributes??"").trim(),l=typeof t.note=="string"?t.note.trim():String(t.note??"").trim();if(!n&&!i){const Z=e.querySelector("select[data-monitor-battery-key]");if(Z){const ue=Z.getAttribute("data-monitor-battery-type")||(Z.dataset?Z.dataset.monitorBatteryType:"");ue==="large"?i="2":ue&&(i="3")}}if(!n&&a){const Z=Array.from(a.querySelectorAll("select, input, textarea"));for(Z.forEach(H=>{H&&H.parentElement===a&&a.removeChild(H)});a.firstChild;)a.removeChild(a.firstChild);const ue=!!i&&(s||Z.length||u);i&&a.appendChild(o.createTextNode(`${i}x${ue?" ":""}`)),s&&(a.appendChild(o.createTextNode(s)),(Z.length||u)&&a.appendChild(o.createTextNode(" "))),!s&&Z.length&&i&&a.appendChild(o.createTextNode("")),Z.forEach((H,Y)=>{a.appendChild(H),(Y<Z.length-1||u)&&a.appendChild(o.createTextNode(" "))}),u&&a.appendChild(o.createTextNode(`(${u})`))}i?e.setAttribute("data-gear-quantity",i):e.removeAttribute("data-gear-quantity"),s?e.setAttribute("data-gear-label",s):e.removeAttribute("data-gear-label"),u?e.setAttribute("data-gear-attributes",u):e.removeAttribute("data-gear-attributes"),l?e.setAttribute("data-gear-note",l):e.removeAttribute("data-gear-note");const d=typeof t.providedBy=="string"?t.providedBy.trim():e.getAttribute("data-gear-provider")||"",p=typeof t.providerLabel=="string"?t.providerLabel.trim():e.getAttribute("data-gear-provider-label")||"";NE(e,d,{label:p});const g=On(typeof t.cameraLink=="string"?t.cameraLink.trim():""),h=typeof t.cameraLinkLabel=="string"?t.cameraLinkLabel.trim():"",A=sl(e),m=A&&!g?"A":g,y=!!m,S=h||(A?qy():"");y?(e.setAttribute("data-gear-camera-link",m),A?(e.setAttribute("data-gear-camera-role","source"),e.setAttribute("data-gear-camera-letter",m)):(e.removeAttribute("data-gear-camera-role"),e.removeAttribute("data-gear-camera-letter")),S?e.setAttribute("data-gear-camera-link-label",S):e.removeAttribute("data-gear-camera-link-label")):(e.removeAttribute("data-gear-camera-link"),e.removeAttribute("data-gear-camera-link-label"),e.removeAttribute("data-gear-camera-role"),e.removeAttribute("data-gear-camera-letter")),e.classList&&e.classList.toggle("gear-item-camera-linked",y);const I=Bn().cameraLinkBadgeLabel,L=S?`${I} — ${S}`:I,R=y?m:"",G=R?Vy(R):"";if(UG(e,y,{isPrimary:A,badgeLabel:L,letter:R,color:G}),!e.getAttribute("data-gear-original-name")){const Z=e.getAttribute("data-gear-name");if(Z){e.setAttribute("data-gear-original-name",Z);const ue=qE(Z);!e.getAttribute("data-gear-original-label")&&ue.name&&e.setAttribute("data-gear-original-label",ue.name),!e.getAttribute("data-gear-original-attributes")&&ue.attributes&&e.setAttribute("data-gear-original-attributes",ue.attributes)}}const j=u?`${s||""} (${u})`.trim():s;j?e.setAttribute("data-gear-name",j):i&&e.setAttribute("data-gear-name",`${i}x`);const $=!!(t&&(t.extra===!0||t.extra==="true"||t.extra===1||t.extra==="1")),z=$?WG(Object.prototype.hasOwnProperty.call(t,"extraStart")?t.extraStart:"",Object.prototype.hasOwnProperty.call(t,"extraEnd")?t.extraEnd:""):{start:"",end:""},te=qG(),oe=$?zH(z.start,z.end):"",k=jG(e);if($){e.setAttribute("data-gear-extra","true"),z.start?e.setAttribute("data-gear-extra-start",z.start):e.removeAttribute("data-gear-extra-start"),z.end?e.setAttribute("data-gear-extra-end",z.end):e.removeAttribute("data-gear-extra-end");const Z=oe||te.indicatorBase;if(e.setAttribute("data-gear-extra-label",Z),k){const ue=oe||te.indicatorBase;k.textContent=ue,k.hidden=!1,k.removeAttribute("hidden"),k.setAttribute("aria-label",ue)}}else e.removeAttribute("data-gear-extra"),e.removeAttribute("data-gear-extra-start"),e.removeAttribute("data-gear-extra-end"),e.removeAttribute("data-gear-extra-label"),k&&(k.textContent="",k.hidden=!0,k.setAttribute("hidden",""),k.removeAttribute("aria-label"));xH(e,l),n&&!r.skipPreview&&NG(e),typeof t.rentalExcluded=="boolean"&&Ef(e,t.rentalExcluded)}function UH(e){if(!e||!e.classList||!e.classList.contains("gear-custom-item")||!e.querySelector("[data-gear-custom-input]"))return e;const r=e.parentElement;if(!r)return e;const o=e.getAttribute("data-gear-custom-entry")||"",n=r.getAttribute("data-gear-custom-category")||"",a=e.querySelector('[data-gear-custom-input="quantity"]'),i=e.querySelector('[data-gear-custom-input="name"]'),s=a?String(a.value??""):"",u=i?String(i.value??""):"",l=e.getAttribute("data-gear-attributes")||"",d=e.getAttribute("data-gear-note")||"",p=e.getAttribute("data-rental-excluded")==="true",g=tk(o,n,{quantity:s,name:u,attributes:l,note:d});return g?(r.insertBefore(g,e.nextSibling),e.remove(),Ef(g,p),$E(g,o,n),g):e}function $H(e){if(!e)return null;if(e.querySelector(".gear-item-edit-btn"))return e.querySelector(".gear-item-edit-btn");const t=e.ownerDocument||(typeof document<"u"?document:null);if(!t)return null;const r=t.createElement("button");r.type="button",r.className="gear-item-edit-btn",r.setAttribute("data-gear-edit","");const n=Bn().editButtonLabel;r.setAttribute("aria-label",n),r.setAttribute("title",n);const i=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?ICON_GLYPHS.sliders:null;typeof pn=="function"&&i?pn(r,"",i):typeof iconMarkup=="function"&&i?r.innerHTML=iconMarkup(i,{className:"btn-icon"}):r.textContent=n;const s=e.querySelector(".gear-item-note");return s?e.insertBefore(r,s.nextSibling):e.appendChild(r),r}function qH(e){if(!e)return;e.classList&&e.classList.contains("gear-custom-item")&&(e=UH(e));const t=e.classList&&e.classList.contains("gear-custom-item");HG(e),jG(e),t||($G(e),$H(e));const r=Wn(e);if(!r.quantity){const o=e.querySelector("select[data-monitor-battery-type]");if(o){const n=o.getAttribute("data-monitor-battery-type")==="handheld"?"3":"2";r.quantity=n}}Tc(e,r,{skipPreview:!t})}function VH(){if(!gearListOutput)return null;const e=UE(ws);if(e)return e;const t=gearListOutput.querySelector(".gear-table");if(!t)return null;const r=t.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;const o=VG(),n=o.categoryLabel,a=r.createElement("tbody");a.className="category-group",a.setAttribute("data-gear-custom-key",ws),a.setAttribute("data-gear-table-category",n);const i=r.createElement("tr");i.className="category-row";const s=r.createElement("td");s.setAttribute("data-gear-category-label",n);const u=r.createElement("div");u.className="gear-category-header";const l=r.createElement("span");l.className="gear-category-label",l.textContent=n,u.appendChild(l);const d=r.createElement("button");d.type="button",d.className="gear-custom-add-btn",d.setAttribute("data-gear-custom-add",ws),d.setAttribute("data-gear-custom-category",n),d.setAttribute("data-extra-gear","true"),d.setAttribute("aria-label",o.addButton),d.setAttribute("title",o.addButton);const p=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS,g=p&&(ICON_GLYPHS.add||ICON_GLYPHS.plus);typeof pn=="function"&&p&&g?pn(d,"",g):typeof iconMarkup=="function"&&g?d.innerHTML=iconMarkup(g,{className:"btn-icon"}):d.textContent="+",u.appendChild(d),s.appendChild(u),i.appendChild(s),a.appendChild(i);const h=r.createElement("tr"),A=r.createElement("td"),m=r.createElement("div");m.className="gear-custom-section",m.setAttribute("data-gear-custom-key",ws),m.setAttribute("data-gear-custom-category",n);const y=r.createElement("div");return y.className="gear-custom-items",y.setAttribute("data-gear-custom-list",ws),y.setAttribute("data-gear-custom-category",n),y.setAttribute("aria-live","polite"),m.appendChild(y),A.appendChild(m),h.appendChild(A),a.appendChild(h),t.appendChild(a),y}function WH(){return{dialog:tt("gearItemEditDialog","gearItemEditDialog"),form:tt("gearItemEditForm","gearItemEditForm"),title:tt("gearItemEditTitle","gearItemEditTitle"),preview:tt("gearItemEditPreview","gearItemEditPreview"),quantityInput:tt("gearItemEditQuantity","gearItemEditQuantity"),quantityLabel:tt("gearItemEditQuantityLabel","gearItemEditQuantityLabel"),nameInput:tt("gearItemEditName","gearItemEditName"),nameLabel:tt("gearItemEditNameLabel","gearItemEditNameLabel"),attributesInput:tt("gearItemEditAttributes","gearItemEditAttributes"),attributesLabel:tt("gearItemEditAttributesLabel","gearItemEditAttributesLabel"),noteInput:tt("gearItemEditNote","gearItemEditNote"),noteLabel:tt("gearItemEditNoteLabel","gearItemEditNoteLabel"),deviceSection:tt("gearItemEditDeviceSection","gearItemEditDeviceSection"),deviceHeading:tt("gearItemEditDeviceHeading","gearItemEditDeviceHeading"),deviceCategory:tt("gearItemEditDeviceCategory","gearItemEditDeviceCategory"),deviceSummary:tt("gearItemEditDeviceSummary","gearItemEditDeviceSummary"),deviceEmpty:tt("gearItemEditDeviceEmpty","gearItemEditDeviceEmpty"),deviceButton:tt("gearItemEditDeviceButton","gearItemEditDeviceButton"),extraContainer:tt("gearItemEditExtraContainer","gearItemEditExtraContainer"),extraCheckbox:tt("gearItemEditExtra","gearItemEditExtra"),extraLabel:tt("gearItemEditExtraLabel","gearItemEditExtraLabel"),extraHelp:tt("gearItemEditExtraHelp","gearItemEditExtraHelp"),extraPeriodContainer:tt("gearItemEditExtraPeriod","gearItemEditExtraPeriod"),extraStartInput:tt("gearItemEditExtraStart","gearItemEditExtraStart"),extraStartLabel:tt("gearItemEditExtraStartLabel","gearItemEditExtraStartLabel"),extraEndInput:tt("gearItemEditExtraEnd","gearItemEditExtraEnd"),extraEndLabel:tt("gearItemEditExtraEndLabel","gearItemEditExtraEndLabel"),extraPeriodHelp:tt("gearItemEditExtraPeriodHelp","gearItemEditExtraPeriodHelp"),providerSelect:tt("gearItemEditProvider","gearItemEditProvider"),providerLabel:tt("gearItemEditProviderLabel","gearItemEditProviderLabel"),providerHelp:tt("gearItemEditProviderHelp","gearItemEditProviderHelp"),ownedContainer:tt("gearItemEditOwnedContainer","gearItemEditOwnedContainer"),ownedCheckbox:tt("gearItemEditOwned","gearItemEditOwned"),ownedLabel:tt("gearItemEditOwnedLabel","gearItemEditOwnedLabel"),ownedHelp:tt("gearItemEditOwnedHelp","gearItemEditOwnedHelp"),cameraLinkContainer:tt("gearItemEditCameraLinkContainer","gearItemEditCameraLinkContainer"),cameraLinkSelect:tt("gearItemEditCameraLink","gearItemEditCameraLink"),cameraLinkLabel:tt("gearItemEditCameraLinkLabel","gearItemEditCameraLinkLabel"),cameraLinkHelp:tt("gearItemEditCameraLinkHelp","gearItemEditCameraLinkHelp"),rentalCheckbox:tt("gearItemEditRental","gearItemEditRental"),rentalSection:tt("gearItemEditRentalSection","gearItemEditRentalSection"),rentalLabel:tt("gearItemEditRentalLabel","gearItemEditRentalLabel"),rentalDescription:tt("gearItemEditRentalDescription","gearItemEditRentalDescription"),cancelButton:tt("gearItemEditCancel","gearItemEditCancel"),saveButton:tt("gearItemEditSave","gearItemEditSave"),resetButton:tt("gearItemEditReset","gearItemEditReset"),resetDefaults:null,currentAttributes:"",currentOwnedEntryId:"",currentCameraLinkValue:"",isCameraItem:!1,deviceEditData:null}}let Ub=null;function zo(e){return e&&typeof e=="object"&&e.context&&typeof e.context=="object"?e.context:(Ub||(Ub=WH()),Ub)}function Bn(){const e=typeof texts=="object"&&texts?texts[currentLang]||texts.en||{}:{},t=texts&&texts.en?texts.en:{};return{dialogTitle:e.gearListEditDialogTitle||t.gearListEditDialogTitle||"Edit gear item",quantityLabel:e.gearListEditQuantityLabel||t.gearListEditQuantityLabel||"Quantity",nameLabel:e.gearListEditNameLabel||t.gearListEditNameLabel||"Item name",attributesLabel:e.gearListEditAttributesLabel||t.gearListEditAttributesLabel||"Attributes",noteLabel:e.gearListEditNoteLabel||t.gearListEditNoteLabel||"Note",extraLabel:e.gearListEditExtraLabel||t.gearListEditExtraLabel||"Temporary extra gear",extraHelp:e.gearListEditExtraHelp||t.gearListEditExtraHelp||"",extraStartLabel:e.gearListEditExtraStartLabel||t.gearListEditExtraStartLabel||"Needed from",extraEndLabel:e.gearListEditExtraEndLabel||t.gearListEditExtraEndLabel||"Needed until",extraPeriodHelp:e.gearListEditExtraPeriodHelp||t.gearListEditExtraPeriodHelp||"",providerLabel:e.gearListEditProviderLabel||t.gearListEditProviderLabel||"Provided by",providerHelp:e.gearListEditProviderHelp||t.gearListEditProviderHelp||"",providerRental:e.gearListProviderRental||t.gearListProviderRental||"Rental",providerUser:e.gearListProviderUser||t.gearListProviderUser||"User",providerCrewHeading:e.gearListProviderCrewHeading||t.gearListProviderCrewHeading||"Crew",providerUnknown:e.gearListProviderUnknown||t.gearListProviderUnknown||"Custom provider",ownedLabel:e.gearListEditOwnedLabel||t.gearListEditOwnedLabel||"Owned",ownedHelp:e.gearListEditOwnedHelp||t.gearListEditOwnedHelp||"",cameraLinkLabel:e.gearListEditCameraLinkLabel||t.gearListEditCameraLinkLabel||"Camera link",cameraLinkHelp:e.gearListEditCameraLinkHelp||t.gearListEditCameraLinkHelp||"",cameraAssignmentLabel:e.gearListEditCameraAssignmentLabel||t.gearListEditCameraAssignmentLabel||"Camera designation",cameraAssignmentHelp:e.gearListEditCameraAssignmentHelp||t.gearListEditCameraAssignmentHelp||"",cameraLinkNoneOption:e.gearListEditCameraLinkNoneOption||t.gearListEditCameraLinkNoneOption||"No camera link",cameraLinkCameraOption:e.gearListEditCameraLinkCameraOption||t.gearListEditCameraLinkCameraOption||"Camera %s — %s",cameraLinkUnavailableOption:e.gearListEditCameraLinkUnavailableOption||t.gearListEditCameraLinkUnavailableOption||"Camera %s (unassigned)",cameraLinkDefaultLabel:e.gearListEditCameraLinkDefaultLabel||t.gearListEditCameraLinkDefaultLabel||"Camera %s",cameraLinkBadgeLabel:e.gearListCameraLinkBadgeLabel||t.gearListCameraLinkBadgeLabel||"Linked to camera",rentalLabel:e.gearListEditRentalLabel||t.gearListEditRentalLabel||"Exclude from rental",rentalNote:cG({fallback:e.gearListRentalNote||t.gearListRentalNote||"Rental handles this item"}),saveLabel:e.gearListEditSave||t.gearListEditSave||"Save",cancelLabel:e.gearListEditCancel||t.gearListEditCancel||"Cancel",editButtonLabel:e.gearListEditButton||t.gearListEditButton||"Edit gear item",resetLabel:e.gearListEditReset||t.gearListEditReset||"Reset name",deviceHeading:e.gearListEditDeviceHeading||t.gearListEditDeviceHeading||"Device attributes",deviceEditButton:e.gearListEditDeviceEdit||t.gearListEditDeviceEdit||"Edit device attributes",deviceEmpty:e.gearListEditDeviceEmpty||t.gearListEditDeviceEmpty||"No device attributes recorded yet. Update the device to add details.",deviceCategoryLabel:e.gearListEditDeviceCategory||t.gearListEditDeviceCategory||"Device library: %s"}}function KG(e){if(!e)return;const t=Bn();if(e.title&&(e.title.textContent=t.dialogTitle),e.preview&&(e.preview.textContent="",e.preview.hidden=!0),yg(e),e.quantityLabel&&(e.quantityLabel.textContent=t.quantityLabel),e.nameLabel&&(e.nameLabel.textContent=t.nameLabel),e.noteLabel&&(e.noteLabel.textContent=t.noteLabel),e.attributesLabel&&(e.attributesLabel.textContent=t.attributesLabel),e.extraLabel){const a=e.extraLabel.querySelector("span");a?a.textContent=t.extraLabel:e.extraLabel.textContent=t.extraLabel}if(e.extraCheckbox&&e.extraCheckbox.setAttribute("aria-label",t.extraLabel),e.extraHelp&&(t.extraHelp?(e.extraHelp.textContent=t.extraHelp,e.extraHelp.hidden=!1,e.extraHelp.removeAttribute("hidden")):(e.extraHelp.textContent="",e.extraHelp.hidden=!0,e.extraHelp.setAttribute("hidden",""))),e.extraStartLabel&&(e.extraStartLabel.textContent=t.extraStartLabel),e.extraEndLabel&&(e.extraEndLabel.textContent=t.extraEndLabel),e.extraPeriodHelp&&(t.extraPeriodHelp?(e.extraPeriodHelp.textContent=t.extraPeriodHelp,e.extraPeriodHelp.hidden=!1,e.extraPeriodHelp.removeAttribute("hidden")):(e.extraPeriodHelp.textContent="",e.extraPeriodHelp.hidden=!0,e.extraPeriodHelp.setAttribute("hidden",""))),e.providerLabel&&(e.providerLabel.textContent=t.providerLabel),e.providerHelp&&(e.providerHelp.textContent=t.providerHelp||"",e.providerHelp.hidden=!e.providerHelp.textContent),e.providerSelect&&(e.providerHelp&&e.providerHelp.textContent?e.providerSelect.setAttribute("aria-describedby",e.providerHelp.id):e.providerSelect.removeAttribute("aria-describedby"),e.providerSelect.setAttribute("aria-label",t.providerLabel)),e.cameraLinkLabel&&(e.cameraLinkLabel.textContent=t.cameraLinkLabel),e.cameraLinkHelp){const a=t.cameraLinkHelp||"";e.cameraLinkHelp.textContent=a,a?(e.cameraLinkHelp.hidden=!1,e.cameraLinkHelp.removeAttribute("hidden")):(e.cameraLinkHelp.hidden=!0,e.cameraLinkHelp.setAttribute("hidden",""))}if(e.cameraLinkSelect&&(e.cameraLinkHelp&&e.cameraLinkHelp.textContent?e.cameraLinkSelect.setAttribute("aria-describedby",e.cameraLinkHelp.id):e.cameraLinkSelect.removeAttribute("aria-describedby"),e.cameraLinkSelect.setAttribute("aria-label",t.cameraLinkLabel)),e.deviceHeading&&(e.deviceHeading.textContent=t.deviceHeading),e.deviceButton&&(e.deviceButton.textContent=t.deviceEditButton,e.deviceButton.setAttribute("aria-label",t.deviceEditButton),e.deviceButton.disabled=!0,e.deviceButton.setAttribute("aria-disabled","true")),e.deviceEmpty&&(e.deviceEmpty.textContent=t.deviceEmpty),e.ownedLabel){const a=e.ownedLabel.querySelector("span");a&&(a.textContent=t.ownedLabel)}if(e.ownedHelp){const a=t.ownedHelp||"";e.ownedHelp.textContent=a,e.ownedHelp.hidden=!a}e.ownedCheckbox&&(e.ownedCheckbox.setAttribute("aria-label",t.ownedLabel),e.ownedHelp&&e.ownedHelp.textContent&&!e.ownedHelp.hidden?e.ownedCheckbox.setAttribute("aria-describedby",e.ownedHelp.id):e.ownedCheckbox.removeAttribute("aria-describedby"));const r=Vc(),o=r.excludeLabel||t.rentalLabel,n=t.rentalNote||r.noteLabel||"";if(e.rentalLabel&&(e.rentalLabel.textContent=o),e.rentalCheckbox&&e.rentalCheckbox.setAttribute("aria-label",t.rentalLabel),e.resetButton){const a=t.resetLabel;if(e.resetButton.setAttribute("aria-label",a),e.resetButton.title=a,typeof pn=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS){const i=ICON_GLYPHS.reload||ICON_GLYPHS.save;pn(e.resetButton,a,i)}else e.resetButton.textContent=a}if(e.rentalDescription&&(e.rentalDescription.textContent=n,e.rentalDescription.hidden=!n),e.rentalCheckbox&&(e.rentalDescription&&e.rentalDescription.textContent?e.rentalCheckbox.setAttribute("aria-describedby",e.rentalDescription.id):e.rentalCheckbox.removeAttribute("aria-describedby")),e.cancelButton){const a=t.cancelLabel;e.cancelButton.setAttribute("aria-label",a),typeof pn=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?pn(e.cancelButton,a,ICON_GLYPHS.circleX||ICON_GLYPHS.minus):e.cancelButton.textContent=a}if(e.saveButton){const a=t.saveLabel;typeof pn=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?pn(e.saveButton,a,ICON_GLYPHS.save):e.saveButton.textContent=a}}function KH(e){if(!e)return"";const t=e.quantityInput?e.quantityInput.value.trim():"",r=e.nameInput?e.nameInput.value.trim():"",o=e.attributesInput?e.attributesInput.value.trim():typeof e.currentAttributes=="string"?e.currentAttributes.trim():"",n=[];t&&n.push(`${t}x`),r&&n.push(r);let a=n.join(" ").trim();return o&&(a=a?`${a} (${o})`:`(${o})`),a.trim()}function YG(e){if(!e)return"";const t=KH(e);return e.preview&&(e.preview.textContent=t,e.preview.hidden=!t),t}function $b(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function qb(e){return typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(e):String(e??"").replace(/\r?\n/g,"").replace(/[^a-zA-Z0-9_-]/g,t=>`\\${t}`)}function YH(e){return typeof e!="string"||!e.trim()?"":e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/).filter(Boolean).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function QH(e){return!Array.isArray(e)||!e.length?"":e.map(YH).filter(Boolean).join(" › ")}function XH(e){const t=typeof e=="string"?e.trim():"";if(!t||!devices||typeof devices!="object")return null;const r=new Set,o=(u,l)=>{if(!$b(u)||r.has(u))return null;if(r.add(u),Object.prototype.hasOwnProperty.call(u,t)&&$b(u[t]))return{info:u[t],categoryPath:l.slice()};for(const[d,p]of Object.entries(u)){if(!$b(p))continue;const g=o(p,l.concat(d));if(g)return g}return null},n=o(devices,[]);if(!n)return null;const a=Array.isArray(n.categoryPath)?n.categoryPath.slice():[];let i="",s="";return a.length>=2&&a[0]==="accessories"?(i=`accessories.${a[1]}`,a[1]==="cables"&&a.length>=3&&(s=a[2])):a.length>=2&&a[0]==="fiz"?i=`fiz.${a[1]}`:a.length>=2?i=`${a[0]}.${a[1]}`:a.length===1&&(i=a[0]),{info:n.info,categoryPath:a,categoryKey:i,subcategory:s}}function ZH(e){if(!e||typeof e!="object")return"";const t=typeof generateSafeConnectorSummary=="function"?generateSafeConnectorSummary:typeof sL=="function"?sL:null;if(!t)return"";try{const r=t(e);return typeof r=="string"?r:""}catch{return""}}function yg(e){e&&(e.deviceSummary&&(e.deviceSummary.innerHTML="",e.deviceSummary.hidden=!0,e.deviceSummary.setAttribute("hidden","")),e.deviceCategory&&(e.deviceCategory.textContent="",e.deviceCategory.hidden=!0,e.deviceCategory.setAttribute("hidden","")),e.deviceEmpty&&(e.deviceEmpty.hidden=!0,e.deviceEmpty.setAttribute("hidden","")),e.deviceButton&&(e.deviceButton.disabled=!0,e.deviceButton.setAttribute("aria-disabled","true")),e.deviceSection&&(e.deviceSection.hidden=!0,e.deviceSection.setAttribute("hidden","")),e.deviceEditData=null)}function QG(e,t={}){if(!e||!e.deviceSection)return;const r=Bn(),o=typeof t.name=="string"?t.name:null,n=typeof t.fallbackName=="string"?t.fallbackName:"",a=o&&o.trim()?o.trim():n.trim();if(!a){yg(e);return}const i=XH(a);if(!i||!i.info){yg(e);return}const s=ZH(i.info);if(e.deviceSummary&&(e.deviceSummary.innerHTML=s||"",s?(e.deviceSummary.hidden=!1,e.deviceSummary.removeAttribute("hidden")):(e.deviceSummary.hidden=!0,e.deviceSummary.setAttribute("hidden",""))),e.deviceCategory){const u=QH(i.categoryPath||[]);if(u){const l=r.deviceCategoryLabel,d=l.includes("%s")?l.replace("%s",u):`${l} ${u}`.trim();e.deviceCategory.textContent=d,e.deviceCategory.hidden=!1,e.deviceCategory.removeAttribute("hidden")}else e.deviceCategory.textContent="",e.deviceCategory.hidden=!0,e.deviceCategory.setAttribute("hidden","")}if(e.deviceEmpty){const u=r.deviceEmpty;s?(e.deviceEmpty.textContent=u,e.deviceEmpty.hidden=!0,e.deviceEmpty.setAttribute("hidden","")):(e.deviceEmpty.textContent=u,e.deviceEmpty.hidden=!1,e.deviceEmpty.removeAttribute("hidden"))}e.deviceButton&&(e.deviceButton.disabled=!1,e.deviceButton.setAttribute("aria-disabled","false")),e.deviceSection&&(e.deviceSection.hidden=!1,e.deviceSection.removeAttribute("hidden")),e.deviceEditData={name:a,categoryKey:i.categoryKey,subcategory:i.subcategory||""}}function JH(e){if(!e||!e.name||!e.categoryKey)return;try{typeof showDeviceManagerSection=="function"?showDeviceManagerSection():typeof toggleDeviceManagerSection=="function"&&toggleDeviceManagerSection()}catch{}try{typeof refreshDeviceLists=="function"&&refreshDeviceLists()}catch{}const t=4;let r=0;const o=()=>{r+=1;let n=`#device-manager .edit-btn[data-category="${qb(e.categoryKey)}"][data-name="${qb(e.name)}"]`;e.subcategory?n+=`[data-subcategory="${qb(e.subcategory)}"]`:n+=":not([data-subcategory])";let a=null;try{a=document.querySelector(n)}catch{a=null}if(a){try{a.scrollIntoView&&a.scrollIntoView({block:"center",behavior:"smooth"}),a.focus({preventScroll:!0})}catch{}try{a.click()}catch{}return}r<t?setTimeout(o,120*r):typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Could not locate device edit button for gear item",e)};setTimeout(o,60)}function ej(e){e&&e.preventDefault();const t=zo();if(!(!t||!t.deviceEditData)){if(t.dialog)try{typeof t.dialog.close=="function"?t.dialog.close("device-edit"):t.dialog.removeAttribute("open")}catch{}JH(t.deviceEditData)}}function VE(e,t){if(!e)return;const r=!!t;e.extraPeriodContainer&&(r?(e.extraPeriodContainer.hidden=!1,e.extraPeriodContainer.removeAttribute("hidden")):(e.extraPeriodContainer.hidden=!0,e.extraPeriodContainer.setAttribute("hidden",""))),e.extraStartInput&&(e.extraStartInput.disabled=!r,r?e.extraStartInput.removeAttribute("aria-disabled"):e.extraStartInput.setAttribute("aria-disabled","true")),e.extraEndInput&&(e.extraEndInput.disabled=!r,r?e.extraEndInput.removeAttribute("aria-disabled"):e.extraEndInput.setAttribute("aria-disabled","true"))}function XG(e){if(!e||!e.resetButton)return;const t=e.resetDefaults||{name:"",attributes:""},r=bo&&bo.element,o=!!(r&&r.hasAttribute("data-gear-original-name")),n=typeof t.name=="string"?t.name.trim():"",a=typeof t.attributes=="string"?t.attributes.trim():"",i=e.nameInput?e.nameInput.value.trim():"",s=e.attributesInput?e.attributesInput.value.trim():typeof e.currentAttributes=="string"?e.currentAttributes.trim():"",d=!(o||!!(n||a||s))||i===n&&s===a;e.resetButton.disabled=d,e.resetButton.setAttribute("aria-disabled",d?"true":"false")}function ZG(e,t,r){if(!e)return;const o=!!t,n=!!r;e.rentalCheckbox&&(e.rentalCheckbox.checked=o,e.rentalCheckbox.disabled=!n,n?e.rentalCheckbox.removeAttribute("aria-disabled"):e.rentalCheckbox.setAttribute("aria-disabled","true")),e.rentalSection&&(e.rentalSection.hidden=!n),e.rentalDescription&&(e.rentalDescription.hidden=!e.rentalDescription.textContent)}function Ls(){const e=zo();if(!e)return;e.extraCheckbox&&VE(e,e.extraCheckbox.checked);const t=YG(e),r=Bn();if(e.title&&(e.title.textContent=t?`${r.dialogTitle} — ${t}`:r.dialogTitle),e.ownedCheckbox){const a=!!(e.nameInput&&e.nameInput.value.trim());e.ownedCheckbox.disabled=!a,e.ownedCheckbox.disabled?(e.ownedCheckbox.setAttribute("aria-disabled","true"),e.ownedCheckbox.checked=!1):e.ownedCheckbox.removeAttribute("aria-disabled")}XG(e);const o=e.resetDefaults&&typeof e.resetDefaults.name=="string"?e.resetDefaults.name:"",n=e.nameInput?e.nameInput.value:"";QG(e,{name:n,fallbackName:o})}function tj(){const e=zo();if(!e)return;const t=e.rentalCheckbox?!e.rentalCheckbox.disabled:!0,r=e.rentalCheckbox?e.rentalCheckbox.checked:!1;ZG(e,r,t)}function rj(){const e=zo();if(!e||!e.ownedCheckbox)return;if(!!!(e.nameInput&&e.nameInput.value.trim())){e.ownedCheckbox.checked=!1,e.ownedCheckbox.disabled=!0,e.ownedCheckbox.setAttribute("aria-disabled","true");return}e.ownedCheckbox.disabled=!1,e.ownedCheckbox.removeAttribute("aria-disabled"),e.providerSelect&&(e.ownedCheckbox.checked?(!e.providerSelect.value||e.providerSelect.value==="rental-house")&&(e.providerSelect.value="user"):e.providerSelect.value==="user"&&(e.providerSelect.value="rental-house"))}function oj(){const e=zo();!e||!e.extraCheckbox||(VE(e,e.extraCheckbox.checked),Ls())}function nj(e){e&&e.preventDefault();const t=zo();if(!t||!t.resetButton||t.resetButton.disabled)return;const r=t.resetDefaults||{name:"",attributes:""};if(t.nameInput&&(t.nameInput.value=r.name||""),t.attributesInput?t.attributesInput.value=r.attributes||"":t.currentAttributes=typeof r.attributes=="string"?r.attributes:"",Ls(),t.nameInput&&typeof t.nameInput.focus=="function")try{t.nameInput.focus({preventScroll:!0})}catch{}}function Vb(e){if(!e)return;const t=zo();!t||!t.dialog||e.target===t.dialog&&(e.preventDefault(),e.stopPropagation(),JG(e))}let hL=!1,bo=null;function JG(e){e.preventDefault();const t=zo();if(!t||!t.dialog)return;const r=bo&&bo.element,o=bo&&bo.options,n=!o||o.allowRentalToggle!==!1;if(!r||!r.isConnected){t.dialog.close("cancel"),bo=null;return}const a={quantity:t.quantityInput?t.quantityInput.value:"",name:t.nameInput?t.nameInput.value:"",attributes:t.attributesInput?t.attributesInput.value:typeof t.currentAttributes=="string"?t.currentAttributes:"",note:t.noteInput?t.noteInput.value:"",rentalExcluded:n&&t.rentalCheckbox?t.rentalCheckbox.checked:r.getAttribute("data-rental-excluded")==="true",providedBy:t.providerSelect?t.providerSelect.value:"",providerLabel:t.providerSelect&&t.providerSelect.selectedOptions&&t.providerSelect.selectedOptions.length?oL(t.providerSelect.selectedOptions[0]):"",extra:t.extraCheckbox?t.extraCheckbox.checked:r.getAttribute("data-gear-extra")==="true",extraStart:t.extraStartInput?t.extraStartInput.value:r.getAttribute("data-gear-extra-start")||"",extraEnd:t.extraEndInput?t.extraEndInput.value:r.getAttribute("data-gear-extra-end")||"",cameraLink:"",cameraLinkLabel:""};if(a.extra){const A=WG(a.extraStart,a.extraEnd);a.extraStart=A.start,a.extraEnd=A.end}else a.extraStart="",a.extraEnd="";const i=!!(a.name&&a.name.trim()),s=!!(t.ownedCheckbox&&t.ownedCheckbox.checked&&i);if(s&&(!a.providedBy||a.providedBy==="rental-house"))if(t.providerSelect){t.providerSelect.value="user";const A=t.providerSelect.selectedOptions&&t.providerSelect.selectedOptions[0];a.providedBy=t.providerSelect.value,a.providerLabel=A?oL(A):a.providerLabel}else a.providedBy="user";const u=!!t.isCameraItem;let l="",d="";if(t.cameraLinkSelect){l=t.cameraLinkSelect.value||"";const A=t.cameraLinkSelect.selectedOptions&&t.cameraLinkSelect.selectedOptions[0];if(A&&(d=A.getAttribute("data-camera-label")||(A.dataset?A.dataset.cameraLabel:"")||"",!d)){const m=A.textContent||"";m&&(d=m.replace(/\s*\([^)]*\)\s*$/,"").trim())}}const p=On(u&&!l?"A":l);!!p?(a.cameraLink=p,a.cameraLinkLabel=d||a.name&&a.name.trim()||qy()||""):(a.cameraLink="",a.cameraLinkLabel=""),t.currentCameraLinkValue=a.cameraLink,Tc(r,a),Xn();const h=s||t.currentOwnedEntryId?qN(r,a,{wantsOwned:s,existingId:t.currentOwnedEntryId||r.getAttribute("data-gear-own-gear-id")||""}):{id:"",changed:!1};h&&Object.prototype.hasOwnProperty.call(h,"id")&&(h.id?r.setAttribute("data-gear-own-gear-id",h.id):r.removeAttribute("data-gear-own-gear-id"),t.currentOwnedEntryId=h.id||"",h.changed&&(fi=null)),t.currentAttributes=typeof a.attributes=="string"?a.attributes:"",r.classList&&r.classList.contains("gear-custom-item")?Wy():(typeof Go=="function"&&Go(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged()),t.dialog.close("save")}function SL(e){e&&e.preventDefault();const t=zo();t&&t.dialog&&t.dialog.close("cancel")}function aj(){const e=zo(),t=bo&&bo.element;if(e&&e.dialog&&e.dialog.returnValue,e&&yg(e),e&&e.form)try{e.form.reset()}catch{}if(e&&e.nameInput&&e.nameInput.removeAttribute("list"),e&&e.preview&&(e.preview.textContent="",e.preview.hidden=!0),e&&(e.resetDefaults=null,e.currentAttributes="",e.currentOwnedEntryId="",e.currentCameraLinkValue="",e.isCameraItem=!1,e.resetButton&&(e.resetButton.disabled=!1,e.resetButton.setAttribute("aria-disabled","false")),e.ownedCheckbox&&(e.ownedCheckbox.checked=!1,e.ownedCheckbox.disabled=!1,e.ownedCheckbox.removeAttribute("aria-disabled"),e.ownedCheckbox.removeAttribute("aria-describedby")),e.cameraLinkSelect&&(e.cameraLinkSelect.disabled=!1,e.cameraLinkSelect.value="",e.cameraLinkSelect.removeAttribute("aria-disabled"))),bo=null,t&&t.isConnected){const r=t.querySelector("[data-gear-edit]");if(r&&typeof r.focus=="function")try{r.focus({preventScroll:!0})}catch{}}}function vL(){const e=zo();if(!e||!e.dialog||!e.providerSelect||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=bo&&bo.element,o=r?Wn(r):{};CG(e,o)}function AL(){const e=zo();if(!e||!e.dialog||!e.cameraLinkSelect||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=bo&&bo.element,o=r?Wn(r):{};wG(e,o);const n=!!(e.isCameraItem||r&&sl(r));if(e.cameraLinkLabel||e.cameraLinkHelp){const i=Bn();if(e.cameraLinkLabel){const s=n?i.cameraAssignmentLabel:i.cameraLinkLabel;e.cameraLinkLabel.textContent=s;const u=n?i.cameraAssignmentHelp:i.cameraLinkHelp;u?e.cameraLinkLabel.setAttribute("data-help",u):e.cameraLinkLabel.removeAttribute("data-help")}if(e.cameraLinkHelp){const s=n?i.cameraAssignmentHelp:i.cameraLinkHelp;e.cameraLinkHelp.textContent=s||"",s?(e.cameraLinkHelp.hidden=!1,e.cameraLinkHelp.removeAttribute("hidden")):(e.cameraLinkHelp.hidden=!0,e.cameraLinkHelp.setAttribute("hidden",""))}}const a=n?On(o.cameraLink)||"A":On(o.cameraLink);e.cameraLinkSelect.value=a||"",e.cameraLinkSelect.disabled=!1,e.cameraLinkSelect.removeAttribute("aria-disabled")}function ij(){const e=zo();if(!e||!e.dialog||!e.ownedCheckbox||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=bo&&bo.element;if(!r||!r.isConnected)return;const o=e.nameInput?e.nameInput.value.trim():"",n=Wn(r),a=o||n.name||"",i=e.currentOwnedEntryId||r.getAttribute("data-gear-own-gear-id")||"",s=_E(),{record:u}=FE(s,i,a),l=!!a;e.ownedCheckbox.disabled=!l,e.ownedCheckbox.disabled?(e.ownedCheckbox.setAttribute("aria-disabled","true"),e.ownedCheckbox.checked=!1):(e.ownedCheckbox.removeAttribute("aria-disabled"),e.ownedCheckbox.checked=!!u),u?(e.currentOwnedEntryId=u.id,r.setAttribute("data-gear-own-gear-id",u.id)):(e.currentOwnedEntryId="",r.removeAttribute("data-gear-own-gear-id"))}function sj(e){if(hL||!e||!e.dialog)return;KG(e),e.form&&e.form.addEventListener("submit",JG),e.cancelButton&&e.cancelButton.addEventListener("click",SL),e.resetButton&&e.resetButton.addEventListener("click",nj),e.dialog.addEventListener("cancel",SL),e.dialog.addEventListener("close",aj),"onpointerdown"in e.dialog?e.dialog.addEventListener("pointerdown",Vb):(e.dialog.addEventListener("mousedown",Vb),e.dialog.addEventListener("touchstart",Vb)),[e.quantityInput,e.nameInput,e.attributesInput].forEach(r=>{r&&(r.addEventListener("input",Ls),r.addEventListener("change",Ls))}),e.rentalCheckbox&&e.rentalCheckbox.addEventListener("change",tj),e.ownedCheckbox&&e.ownedCheckbox.addEventListener("change",rj),e.extraCheckbox&&e.extraCheckbox.addEventListener("change",oj),[e.extraStartInput,e.extraEndInput].forEach(r=>{r&&(r.addEventListener("input",Ls),r.addEventListener("change",Ls))}),e.cameraLinkSelect&&e.cameraLinkSelect.addEventListener("change",Ls),e.deviceButton&&e.deviceButton.addEventListener("click",ej),hL=!0}function ek(e,t={}){if(!e)return!1;const r=zo();if(!r||!r.dialog)return!1;if(sj(r),qH(e),e.classList&&e.classList.contains("gear-custom-item")){const S=e.closest(".gear-custom-items[data-gear-custom-list]");if(S){const E=S.getAttribute("data-gear-custom-list")||"",I=S.getAttribute("data-gear-custom-category")||"";$E(e,E,I)}}const o=Wn(e),n=(()=>{const S=o&&Object.prototype.hasOwnProperty.call(o,"id")?o.id:"",E=typeof S=="string"?S:S==null?"":String(S),I=o&&Object.prototype.hasOwnProperty.call(o,"name")?o.name:"",L=typeof I=="string"?I.slice(0,120):"",R=e&&e.dataset?e.dataset:{},G=typeof R.category=="string"?R.category:"",j=!!(e&&e.classList&&e.classList.contains("gear-custom-item")),$={allowRentalToggle:t&&Object.prototype.hasOwnProperty.call(t,"allowRentalToggle")?!!t.allowRentalToggle:void 0,focusField:t&&typeof t.focusField=="string"?t.focusField.slice(0,60):void 0};return{id:E,name:L,category:G,custom:j,options:$}})();bo={element:e,options:t||{}},r.resetDefaults=$v(e),r.currentAttributes=typeof o.attributes=="string"?o.attributes:String(o.attributes??""),r.resetButton&&(r.resetButton.disabled=!1,r.resetButton.setAttribute("aria-disabled","false")),KG(r);const a=e.getAttribute("data-gear-own-gear-id")||"",i=VN(e,{name:o.name||"",existingId:a||r.currentOwnedEntryId||""});r.currentOwnedEntryId=i?i.id:"";const s=!!(o.name&&o.name.trim());r.ownedCheckbox&&(r.ownedCheckbox.checked=!!i&&s,r.ownedCheckbox.disabled=!s,r.ownedCheckbox.disabled?r.ownedCheckbox.setAttribute("aria-disabled","true"):r.ownedCheckbox.removeAttribute("aria-disabled")),r.ownedContainer&&(r.ownedContainer.hidden=!1),i&&e?e.setAttribute("data-gear-own-gear-id",i.id):a&&e.removeAttribute("data-gear-own-gear-id");const u=!(t&&t.allowRentalToggle===!1);if(r.quantityInput&&(r.quantityInput.value=o.quantity||""),r.nameInput){r.nameInput.value=o.name||"";const S=e.getAttribute("data-gear-suggestions")||"";S?r.nameInput.setAttribute("list",S):r.nameInput.removeAttribute("list")}if(r.attributesInput&&(r.attributesInput.value=o.attributes||""),r.noteInput&&(r.noteInput.value=o.note||""),r.extraCheckbox){const S=!!o.extra;r.extraCheckbox.checked=S,VE(r,S)}r.extraStartInput&&(r.extraStartInput.value=o.extraStart||""),r.extraEndInput&&(r.extraEndInput.value=o.extraEnd||""),r.extraPeriodContainer&&!r.extraCheckbox&&(r.extraPeriodContainer.hidden=!0,r.extraPeriodContainer.setAttribute("hidden","")),r.providerSelect&&CG(r,o);const l=On(o.cameraLink),d=sl(e);r.isCameraItem=d,r.cameraLinkContainer&&(r.cameraLinkContainer.hidden=!1,r.cameraLinkContainer.removeAttribute("hidden"));const p=Bn();if(r.cameraLinkLabel){const S=d?p.cameraAssignmentLabel:p.cameraLinkLabel;r.cameraLinkLabel.textContent=S;const E=d?p.cameraAssignmentHelp:p.cameraLinkHelp;E?r.cameraLinkLabel.setAttribute("data-help",E):r.cameraLinkLabel.removeAttribute("data-help")}if(r.cameraLinkHelp){const S=d?p.cameraAssignmentHelp:p.cameraLinkHelp;r.cameraLinkHelp.textContent=S||"",S?(r.cameraLinkHelp.hidden=!1,r.cameraLinkHelp.removeAttribute("hidden")):(r.cameraLinkHelp.hidden=!0,r.cameraLinkHelp.setAttribute("hidden",""))}if(r.cameraLinkSelect){wG(r,o);const S=d?l||"A":l||"";r.cameraLinkSelect.value=S,r.cameraLinkSelect.disabled=!1,r.cameraLinkSelect.removeAttribute("aria-disabled")}r.currentCameraLinkValue=l||(d?"A":""),ZG(r,!!o.rentalExcluded,u);const g=(()=>{const S=e.querySelector(".gear-item-text");return S&&S.textContent?S.textContent.trim():o.name||""})(),A=YG(r)||g;r.preview&&A&&(r.preview.textContent=A,r.preview.hidden=!1),r.title&&(r.title.textContent=A?`${p.dialogTitle} — ${A}`:p.dialogTitle),XG(r);const m=typeof o.name=="string"?o.name:"",y=r.nameInput?r.nameInput.value:m;QG(r,{name:y,fallbackName:m});try{typeof r.dialog.showModal=="function"?r.dialog.showModal():r.dialog.hidden=!1}catch(S){return console.warn("Failed to open gear item edit dialog",S,n),bo=null,!1}if(t.focusField==="name"&&r.nameInput)try{r.nameInput.focus({preventScroll:!0})}catch{}else if(r.quantityInput)try{r.quantityInput.focus({preventScroll:!0})}catch{}return!0}function tk(e,t,r){const o=gearListOutput&&gearListOutput.ownerDocument||(typeof document<"u"?document:null);if(!o)return null;const n=o.createElement("template"),a=r&&Object.prototype.hasOwnProperty.call(r,"quantity")?r.quantity:"1",i=r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:"",s=r&&Object.prototype.hasOwnProperty.call(r,"attributes")?r.attributes:"",u=r&&Object.prototype.hasOwnProperty.call(r,"note")?r.note:"",l=r&&Object.prototype.hasOwnProperty.call(r,"extra")?r.extra:!1,d=r&&Object.prototype.hasOwnProperty.call(r,"extraStart")?r.extraStart:"",p=r&&Object.prototype.hasOwnProperty.call(r,"extraEnd")?r.extraEnd:"",g=typeof a=="string"?a:String(a??""),h=typeof i=="string"?i:String(i??""),A=typeof s=="string"?s:String(s??""),m=typeof u=="string"?u:String(u??""),y=l===!0||l==="true"||l===1||l==="1",S=typeof d=="string"?d:String(d??""),E=typeof p=="string"?p:String(p??""),I=Rn("gearListRemoveCustomItem","Remove"),L=Rn("gearListRemoveCustomItemFromCategory","Remove custom item from {category}",{category:t}),R=Rn("gearListEditCustomItem","Edit custom item"),G=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS,j=G&&(ICON_GLYPHS.sliders||ICON_GLYPHS.gears||ICON_GLYPHS.gearList||ICON_GLYPHS.settingsGeneral||ICON_GLYPHS.note)||null,$=typeof iconMarkup=="function"&&G?iconMarkup(ICON_GLYPHS.minus,{className:"btn-icon"}):"",z=typeof iconMarkup=="function"&&j?iconMarkup(j,{className:"btn-icon"}):"",te=Vc(),oe=te.noteLabel&&te.noteLabel.trim()?te.noteLabel:"";n.innerHTML=`
    <div class="gear-custom-item" data-gear-custom-entry="${Te(e)}">
      <div class="gear-custom-item-summary">
        <span class="gear-custom-item-preview" aria-hidden="true"></span>
        <span class="gear-item-note" hidden></span>
      </div>
      <div class="gear-custom-item-actions">
        <button
          type="button"
          class="gear-item-edit-btn"
          data-gear-edit
          aria-label="${Te(R)}"
        >
          ${z||`<span class="gear-item-edit-fallback">${Te(R)}</span>`}
        </button>
        <button
          type="button"
          class="gear-custom-remove-btn"
          data-gear-custom-remove="${Te(e)}"
          data-gear-custom-category="${Te(t)}"
          aria-label="${Te(L)}"
        >
          ${$}<span>${Te(I)}</span>
        </button>
      </div>
    </div>
  `.trim();const k=n.content.firstElementChild;return k?(oe&&k.setAttribute("data-rental-note",oe),k.setAttribute("data-gear-quantity",g),k.setAttribute("data-gear-label",h),A?k.setAttribute("data-gear-attributes",A):k.removeAttribute("data-gear-attributes"),m?k.setAttribute("data-gear-note",m):k.removeAttribute("data-gear-note"),Tc(k,{quantity:g,name:h,attributes:A,note:m,rentalExcluded:r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"),providedBy:r&&(r.providedBy||r.provider)?r.providedBy||r.provider:"",providerLabel:r&&r.providerLabel?r.providerLabel:"",extra:y,extraStart:S,extraEnd:E}),k):null}function Wy(){Xn(),typeof Go=="function"&&Go(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged()}function bg(e,t,r={},o={}){const n=UE(e);if(!n)return null;const a=tk(e,t,r);if(!a)return null;n.appendChild(a),$E(a,e,t);const i=r&&(r.extra===!0||r.extra==="true"||r.extra===1||r.extra==="1"),s=r&&Object.prototype.hasOwnProperty.call(r,"extraStart")?r.extraStart:"",u=r&&Object.prototype.hasOwnProperty.call(r,"extraEnd")?r.extraEnd:"";Tc(a,{quantity:r&&Object.prototype.hasOwnProperty.call(r,"quantity")?r.quantity:"",name:r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:"",attributes:r&&Object.prototype.hasOwnProperty.call(r,"attributes")?r.attributes:"",note:r&&Object.prototype.hasOwnProperty.call(r,"note")?r.note:"",rentalExcluded:r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"),providedBy:r&&(r.providedBy||r.provider)?r.providedBy||r.provider:"",providerLabel:r&&r.providerLabel?r.providerLabel:"",extra:i,extraStart:s,extraEnd:u,cameraLink:r&&Object.prototype.hasOwnProperty.call(r,"cameraLink")?r.cameraLink:"",cameraLinkLabel:r&&Object.prototype.hasOwnProperty.call(r,"cameraLinkLabel")?r.cameraLinkLabel:""},{skipPreview:!1});const l=!!(r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"));if(Ef(a,l),!o.skipFocus){const d=a.querySelector("[data-gear-edit]");d&&d.focus()}return!o.skipEditDialog&&typeof requestAnimationFrame=="function"&&requestAnimationFrame(()=>{try{ek(a,{focusField:"name",allowRentalToggle:!0})}catch(d){console.warn("Failed to open gear item editor for new custom item",d)}}),o.skipPersist||Wy(),a}function rk(e={}){const t=VH();if(!t)return null;const r=VG(),o=t.getAttribute("data-gear-custom-category")||r.categoryLabel;return bg(ws,o,{quantity:e&&Object.prototype.hasOwnProperty.call(e,"quantity")?e.quantity:"1",name:e&&Object.prototype.hasOwnProperty.call(e,"name")?e.name:"",attributes:e&&Object.prototype.hasOwnProperty.call(e,"attributes")?e.attributes:"",note:e&&Object.prototype.hasOwnProperty.call(e,"note")?e.note:"",extra:!0,extraStart:e&&Object.prototype.hasOwnProperty.call(e,"extraStart")?e.extraStart:"",extraEnd:e&&Object.prototype.hasOwnProperty.call(e,"extraEnd")?e.extraEnd:""},{skipFocus:!!(e&&e.skipFocus),skipPersist:!!(e&&e.skipPersist),skipEditDialog:!!(e&&e.skipEditDialog)})}function lj(e){if(!e)return;const t=e.getAttribute("data-gear-custom-add")||"";if(!t)return;const r=e.getAttribute("data-gear-custom-category")||"";if(e.hasAttribute("data-extra-gear")||t===ws){rk({skipFocus:!1,skipPersist:!1,skipEditDialog:!1});return}bg(t,r,{quantity:"1",name:""})}function cj(e){if(!e)return;const t=e.closest(".gear-custom-item");if(!t)return;const r=e.getAttribute("data-gear-custom-remove")||t.getAttribute("data-gear-custom-entry")||"";if(t.remove(),Wy(),r){const o=gearListOutput?.querySelector(`[data-gear-custom-add="${r}"]`);o&&o.focus()}}function uj(){if(!gearListOutput)return{};const e={};return gearListOutput.querySelectorAll(".gear-custom-items[data-gear-custom-list]").forEach(r=>{const o=r.getAttribute("data-gear-custom-list");if(!o)return;const n=[];r.querySelectorAll(".gear-custom-item").forEach(a=>{const i=String(a.getAttribute("data-gear-quantity")||""),s=String(a.getAttribute("data-gear-label")||a.getAttribute("data-gear-name")||""),u=String(a.getAttribute("data-gear-attributes")||""),l=String(a.getAttribute("data-gear-note")||""),d=a.getAttribute("data-rental-excluded")==="true",p=String(a.getAttribute("data-gear-provider")||""),g=String(a.getAttribute("data-gear-provider-label")||""),h=a.getAttribute("data-gear-extra")==="true",A=String(a.getAttribute("data-gear-extra-start")||""),m=String(a.getAttribute("data-gear-extra-end")||""),y=String(a.getAttribute("data-gear-camera-link")||""),S=String(a.getAttribute("data-gear-camera-link-label")||"");n.push({quantity:i,name:s,attributes:u,note:l,rentalExcluded:d,providedBy:p,providerLabel:g,extra:h,extraStart:A,extraEnd:m,cameraLink:y,cameraLinkLabel:S})}),n.length&&(e[o]=n)}),e}function qv(e={}){const t=(C,M)=>M||(typeof document<"u"?document.getElementById(C):null),r=t("cameraSelect",typeof cameraSelect<"u"?cameraSelect:null),o=t("monitorSelect",typeof monitorSelect<"u"?monitorSelect:null),n=t("videoSelect",typeof videoSelect<"u"?videoSelect:null),a=t("distanceSelect",typeof distanceSelect<"u"?distanceSelect:null),i=t("cageSelect",typeof cageSelect<"u"?cageSelect:null),s=t("batterySelect",typeof batterySelect<"u"?batterySelect:null),u=C=>{if(!C||!C.options||typeof C.selectedIndex!="number"||C.selectedIndex<0)return"";const M=C.options[C.selectedIndex];return M?(typeof M.text=="string"?M.text:typeof M.textContent=="string"?M.textContent:"").trim():""},l={camera:r&&typeof r.value<"u"&&r.value&&r.value!=="None"?u(r):"",monitor:o&&typeof o.value<"u"&&o.value&&o.value!=="None"?u(o):"",video:n&&typeof n.value<"u"&&n.value&&n.value!=="None"?u(n):"",motors:(typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[]).map(C=>C&&typeof C.value<"u"&&C.value&&C.value!=="None"?u(C):"").filter(Boolean),controllers:(typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[]).map(C=>C&&typeof C.value<"u"&&C.value&&C.value!=="None"?u(C):"").filter(Boolean),distance:a&&typeof a.value<"u"&&a.value&&a.value!=="None"?u(a):"",cage:i&&typeof i.value<"u"&&i.value&&i.value!=="None"?u(i):"",battery:s&&typeof s.value<"u"&&s.value&&s.value!=="None"?u(s):""},g=Bn().cameraLinkDefaultLabel.replace("%s","A"),h=typeof l.camera=="string"&&l.camera.trim()||g,A=!!h,m=new Set,y=C=>{if(!A||typeof C!="string")return;const M=normalizeGearNameForComparison(C);M&&m.add(M)},S=C=>{if(!C||typeof C!="string")return;const M=C.trim();if(!M)return;y(M);const B=Ar(M);B&&B!==M&&y(B)},E=C=>{!C||!A||(C.cameraLink=!0,h&&!C.cameraLinkLabel&&(C.cameraLinkLabel=h))},I=({base:C,entry:M})=>{if(A)try{const B=normalizeGearNameForComparison(C);B&&m.has(B)&&E(M)}catch{}},L=C=>{if(!A)return"";const M=typeof C=="string"&&C.trim()?C.trim():h,B=['data-gear-camera-link="camera"'];return M&&B.push(`data-gear-camera-link-label="${Te(M)}"`),B.join(" ")},R=l.motors.length>0,G=e.videoDistribution?e.videoDistribution.split(",").map(C=>C.trim()).filter(Boolean):[],j=G.map(C=>{const M=C.match(/^(Director|Gaffer|DoP) Monitor (?:(\d+)" )?handheld$/);return M?{role:M[1],size:M[2]?parseFloat(M[2]):void 0}:null}).filter(Boolean),$=G.map(C=>{const M=C.match(/^(Director|Combo|DoP) Monitor 15-21"$/);return M?{role:M[1]}:null}).filter(Boolean);["Arri Alexa Mini","Arri Amira"].includes(l.camera)?l.viewfinder="ARRI K2.75004.0 MVF-1 Viewfinder":l.viewfinder="";const{cameraSupport:z,chargers:te,fizCables:oe,misc:k,monitoringSupport:Z,rigging:ue}=JN({hasMotor:R,videoDistPrefs:G}),H=devices.accessories?.cages||{},Y=[];if(cameraSelect&&cameraSelect.value&&cameraSelect.value!=="None")for(const[C,M]of Object.entries(H))(!M.compatible||M.compatible.includes(cameraSelect.value))&&Y.push(C);const N=z.filter(C=>!Y.includes(C));if(l.viewfinder){const C=new Set(N.map(B=>normalizeGearNameForComparison(B))),M=normalizeGearNameForComparison(l.viewfinder);C.has(M)||N.push(l.viewfinder)}const ae=e.requiredScenarios?e.requiredScenarios.split(",").map(C=>C.trim()).filter(Boolean):[],de=hasSeededAutoGearDefaults(),Q=autoGearRules.length===0&&!de,ne=C=>Q&&ae.includes(C),V=C=>Q&&C.some(M=>ae.includes(M)),fe=ne("Gimbal");if(V(["Trinity","Steadicam"])){for(let C=0;C<2;C++)ue.push("D-Tap Splitter");ue.push("D-Tap Extension 50 cm (Steadicam/Trinity)"),ue.push("D-Tap Extension 50 cm (Spare)")}const J=e.cameraHandle?e.cameraHandle.split(",").map(C=>C.trim()).filter(Boolean):[],Ae=e.viewfinderExtension?e.viewfinderExtension.split(",").map(C=>C.trim()).filter(Boolean):[],Le=[...e.viewfinderSettings?e.viewfinderSettings.split(",").map(C=>C.trim()):[],...e.frameGuides?e.frameGuides.split(",").map(C=>C.trim()):[],...e.aspectMaskOpacity?e.aspectMaskOpacity.split(",").map(C=>C.trim()):[],...e.monitoringSettings?e.monitoringSettings.split(",").map(C=>C.trim()):[]].filter(Boolean),_e=Bd(e.lenses),Je=_e.reduce((C,M)=>{const B=devices.lenses&&devices.lenses[M];return Math.max(C,B&&B.frontDiameterMm||0)},0),xe=parseFilterTokens(e.filter),Ve=xe.map(C=>C.type).some(C=>C==="ND Grad HE"||C==="ND Grad SE"),Dt=buildFilterGearEntries(xe);let We=collectFilterAccessories(xe);if(Dt.length&&We.length){const C=new Set(Dt.map(M=>normalizeGearNameForComparison(M.gearName)));We=We.filter(M=>!C.has(normalizeGearNameForComparison(M)))}const ft=buildFilterSelectHtml(xe,Dt);if(e.mattebox){const C=e.mattebox.trim();C==="Swing Away"?(We.push("ARRI LMB 4x5 Pro Set"),We.push("ARRI LMB 19mm Studio Rod Adapter"),We.push("ARRI LMB 4x5 / LMB-6 Tray Catcher")):C==="Rod based"?(We.push("ARRI LMB 4x5 15mm LWS Set 3-Stage"),We.push("ARRI LMB 19mm Studio Rod Adapter"),We.push("ARRI LMB 4x5 / LMB-6 Tray Catcher"),We.push("ARRI LMB 4x5 Side Flags"),We.push("ARRI LMB Flag Holders"),We.push("ARRI LMB 4x5 Set of Mattes spherical"),We.push("ARRI LMB Accessory Adapter"),We.push("ARRI Anti-Reflection Frame 4x5.65")):C==="Clamp On"&&(We.push("ARRI LMB 4x5 Clamp-On (3-Stage)"),We.push("ARRI LMB 4x5 / LMB-6 Tray Catcher"),We.push("ARRI LMB 4x5 Side Flags"),We.push("ARRI LMB Flag Holders"),We.push("ARRI LMB 4x5 Set of Mattes spherical"),We.push("ARRI LMB Accessory Adapter"),We.push("ARRI Anti-Reflection Frame 4x5.65"),We.push("ARRI LMB 4x5 Clamp Adapter Set Pro"))}e.mattebox&&!Ve&&e.mattebox.toLowerCase().includes("clamp")&&[...new Set(_e.map(B=>devices.lenses&&devices.lenses[B]&&devices.lenses[B].frontDiameterMm).filter(Boolean))].forEach(B=>We.push(`ARRI LMB 4x5 Clamp Adapter ${B}mm`)),Ae.forEach(C=>N.push(C)),V(["Rain Machine","Extreme rain"])&&(We.push("Schulz Sprayoff Micro"),We.push("Spare Disc (Schulz Sprayoff Micro)"),ue.push("Fischer RS to D-Tap cable 0,5m"),ue.push("Fischer RS to D-Tap cable 0,5m"));let D=[],q="";if(fe){const C=e.gimbal?e.gimbal.split(",").map(B=>B.trim()).filter(Boolean):[],M=Je>95;if(C.length)D=C.map(B=>/Ronin RS4 Pro/i.test(B)&&M?"DJI Ronin 2":B),D.length===1&&(q=D[0]);else{const B=devices&&devices.cameras&&devices.cameras[l.camera],ee=B&&B.weight_g,re=ee!=null?ee<2e3:/(FX3|FX6|R5)/i.test(l.camera);q=M?"DJI Ronin 2":re?"DJI Ronin RS4 Pro Combo":"DJI Ronin 2",D=[q]}/Ronin RS4 Pro/i.test(q)&&Je<=95?(We.push("Tilta Mirage VND Kit"),We.push("Tilta 95 mm Polarizer Filter für Tilta Mirage"),We.push("Vaxis 95 mm IRND Filter 0.3 + 0.6 + 0.9 + 1.2 Filter"),We.push("Vaxis 95mm Black Mist 1/4 + 1/8 Filter")):We.push("Arri KK.0038066 Flexible Sunshade Side Flag Holders Set")}const we=[];j.forEach(C=>we.push(`${C.role} handheld`)),$.forEach(C=>we.push(`${C.role} 15-21"`)),R&&we.push("Focus");const ve=we.length;if(l.video){Z.push("Antenna 5,8GHz 5dBi Long (spare)");const C=l.video.replace(/ TX\b/," RX");if(devices&&devices.wirelessReceivers&&devices.wirelessReceivers[C]){const M=ve||1;for(let B=0;B<M;B++)Z.push("Antenna 5,8GHz 5dBi Long (spare)")}}const Se=C=>{Z.push(`D-Tap to Lemo-2-pin Cable 0,3m (${C})`,`D-Tap to Lemo-2-pin Cable 0,3m (${C})`,`Ultraslim BNC Cable 0.3 m (${C})`,`Ultraslim BNC Cable 0.3 m (${C})`)};j.forEach(C=>Se(`${C.role} handheld`));const he=C=>{Z.push(`D-Tap to Lemo-2-pin Cable 0,5m (${C})`,`D-Tap to Lemo-2-pin Cable 0,5m (${C})`,`Ultraslim BNC Cable 0.5 m (${C})`,`Ultraslim BNC Cable 0.5 m (${C})`)};$.forEach(C=>he(`${C.role} 15-21"`));const ge='SHAPE Telescopic Handle ARRI Rosette Kit 12"',pe=()=>{N.includes(ge)||N.push(ge)};ne("Handheld")&&ne("Easyrig")&&pe(),J.includes("Hand Grips")&&pe(),J.includes("Handle Extension")&&N.push("ARRI K2.0019797 HEX-3"),J.includes("L-Handle")&&N.push("ARRI KK.0037820 Handle Extension Set");const ze={...e},ke=texts[currentLang]?.projectForm||texts.en?.projectForm||{},nt=texts[currentLang]?.projectFields||texts.en?.projectFields||{},Ct=AN(e&&e.rentalHouse?e.rentalHouse:"");if(Ct){const C=[],M=[],B=Ct.phone?String(Ct.phone).trim():"";if(B){const ie=mL(B),Ie=Te(B);M.push(B),ie?C.push(`<a href="tel:${ie}" class="req-contact-link">${Ie}</a>`):C.push(Ie)}const ee=Ct.email?String(Ct.email).trim():"";if(ee){const ie=gL(ee),Ie=Te(ee);M.push(ee),ie?C.push(`<a href="mailto:${ie}" class="req-contact-link">${Ie}</a>`):C.push(Ie)}C.length&&(ze.rentalHouseContact={__html:C.join("<br>"),text:M.join(`
`)});const re=Ct.address?String(Ct.address).trim():"";re&&(ze.rentalHouseAddress=re)}let Ot=jw(ze,e,nt);Ot||PRODUCTION_COMPANY_FIELD_ORDER.some(M=>{const B=ze[M];return typeof B=="string"?B.trim().length>0:B!=null})&&(Ot=jw(ze,ze,nt));const xt=ke.storageSummaryFallback||ke.storageTypeLabel||"Media",or=texts[currentLang]?.crewRoles||texts.en?.crewRoles||{};if(Array.isArray(e.people)){const C=[],M=[];e.people.filter(B=>B&&typeof B.name=="string"&&B.name.trim()).forEach(B=>{const ee=or[B.role]||B.role||"",re=Te(ee),ie=typeof B.name=="string"?B.name.trim():B.name?String(B.name).trim():"";if(!ie)return;const Ie=Te(ie),Ce=[],Ge=[],lt=typeof B.phone=="string"?B.phone.trim():B.phone?String(B.phone).trim():"";if(lt){const Yt=mL(lt),Nt=Te(lt);Ge.push(lt),Yt?Ce.push(`<a href="tel:${Yt}" class="req-contact-link">${Nt}</a>`):Ce.push(Nt)}const He=typeof B.email=="string"?B.email.trim():B.email?String(B.email).trim():"";if(He){const Yt=gL(He),Nt=Te(He);Ge.push(He),Yt?Ce.push(`<a href="mailto:${Yt}" class="req-contact-link">${Nt}</a>`):Ce.push(Nt)}const ht=Ce.length?` (${Ce.join(", ")})`:"",Vt=Ge.length?` (${Ge.join(", ")})`:"",nr=ee?`${re}: `:"",Zt=ee?`${ee}: `:"";C.push(`<span class="crew-entry">${nr}${Ie}${ht}</span>`),M.push(`${Zt}${ie}${Vt}`)}),C.length&&(ze.crew={__html:C.join("<br>"),text:M.join(`
`)})}if(delete ze.people,Array.isArray(e.storageRequirements)){const C=[],M=[];e.storageRequirements.forEach(B=>{if(!B||typeof B!="object")return;const ee=Number.isFinite(B.quantity)&&B.quantity>0?B.quantity:null,re=typeof B.type=="string"?B.type.trim():"",ie=typeof B.variant=="string"?B.variant.trim():"",Ie=typeof B.notes=="string"?B.notes.trim():"";if(!ee&&!re&&!ie&&!Ie)return;let Ce=ie||re||"";ie&&re&&!ie.toLowerCase().includes(re.toLowerCase())?Ce=`${ie} (${re})`:!Ce&&re&&(Ce=re),Ie&&(Ce=Ce?`${Ce} – ${Ie}`:Ie);const Ge=Ce||xt,He=`${ee?`${ee}x `:""}${Ge}`.trim();M.push(He),C.push(`<span class="storage-entry">${Te(He)}</span>`)}),C.length&&(ze.storageRequirements={__html:C.join("<br>"),text:M.join(`
`)})}if(Array.isArray(e.prepDays)&&(ze.prepDays=e.prepDays.join(`
`)),Array.isArray(e.shootingDays)&&(ze.shootingDays=e.shootingDays.join(`
`)),Array.isArray(e.returnDays)&&(ze.returnDays=e.returnDays.join(`
`)),Le.length&&(ze.monitoringSupport=Le.join(", ")),delete ze.monitoringSettings,delete ze.viewfinderSettings,delete ze.frameGuides,delete ze.aspectMaskOpacity,e.filter){const C=parseFilterTokens(e.filter);if(C.length){const M=C.map(B=>{const ee=B.size&&B.size!=="4x5.65"?` (${Te(B.size)})`:"",re=B.values&&B.values.length?`: ${Te(B.values.join(", "))}`:"";return`<span class="filter-req-token">${Te(B.type)}${ee}${re}</span>`});ze.filter={__html:M.join("<br>"),text:C.map(B=>{const ee=B.size&&B.size!=="4x5.65"?` (${B.size})`:"",re=B.values&&B.values.length?`: ${B.values.join(", ")}`:"";return`${B.type}${ee}${re}`}).join(`
`)}}}const er=$c(e.projectName||"")||e.projectName||"",wr=Te(er),Pt=new Set(["filter","cameraHandle","viewfinderExtension","mattebox","videoDistribution","monitoringConfiguration","focusMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","sliderBowl","easyrig","lenses","viewfinderSettings","frameGuides","aspectMaskOpacity","viewfinderEyeLeatherColor","directorMonitor","dopMonitor","gafferMonitor","directorMonitor15","comboMonitor15","dopMonitor15","proGaffColor1","proGaffWidth1","proGaffColor2","proGaffWidth2","storageRequirements","monitorBatteries","lensSelections"]),Pr=Object.entries(ze).filter(([C,M])=>M&&C!=="projectName"&&!Pt.has(C)&&!C.endsWith("Manual")&&!(Ot&&PRODUCTION_COMPANY_FIELD_ORDER.includes(C))),Wt=Pr.length?'<div class="requirements-grid">'+Pr.map(([C,M])=>{const B=IH(M),ee=nt[C]||C,re=iconMarkup(projectFieldIcons[C],{className:"req-icon",size:"var(--req-icon-size)"}),ie=[];C==="productionCompany"&&Ot&&ie.push('data-has-address="true"');const Ie=ie.length?` ${ie.join(" ")}`:"";return`<div class="requirement-box" data-field="${C}"${Ie}>${re}<span class="req-label">${Te(ee)}</span><span class="req-value">${B}</span></div>`}).join("")+"</div>":"",_t=ke.heading||"Project Requirements",_r=Pr.length?`<h3>${Te(_t)}</h3>${Wt}`:"",Oe=Vc({rentalHouse:e&&e.rentalHouse}),ct=Oe.noteLabel&&Oe.noteLabel.trim()?` data-rental-note="${Te(Oe.noteLabel)}"`:"",Gt=(C,M={})=>{const B={},ee=Ge=>{const lt=Ge.trim();if(!lt)return{base:"",ctx:""};if(lt.charAt(lt.length-1)!==")")return{base:lt,ctx:""};const He=lt.lastIndexOf(" (");if(He===-1)return{base:lt,ctx:""};const ht=lt.slice(0,He).trim(),Vt=lt.slice(He+2,-1).trim();return!ht||!Vt||Vt.indexOf("(")!==-1||Vt.indexOf(")")!==-1?{base:lt,ctx:""}:{base:ht,ctx:Vt}};C.filter(Boolean).forEach(Ge=>{let lt=Ge;try{if(typeof Ar=="function"){const lr=Ar(Ge);typeof lr=="string"&&lr.trim()&&(lt=lr)}}catch{}const He=lt.trim();if(!He)return;const ht=He.match(/^(\d+)x\s+(.*)$/),Vt=ht?parseInt(ht[1],10):NaN,nr=Number.isFinite(Vt)&&Vt>0?Vt:1,Zt=ht?ht[2]:He,{base:Yt,ctx:Nt}=ee(Zt);if(!Yt)return;B[Yt]||(B[Yt]={total:0,ctxCounts:{},cameraLink:!1,cameraLinkLabel:""});const Nr=B[Yt];if(Nr.total+=nr,Nr.ctxCounts[Nt]=(Nr.ctxCounts[Nt]||0)+nr,typeof M.onItem=="function")try{M.onItem({rawItem:He,base:Yt,context:Nt,quantity:nr,entry:Nr})}catch(lr){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("formatItems onItem callback failed",lr)}});const re=Oe,ie=re.noteLabel&&re.noteLabel.trim()?` data-rental-note="${Te(re.noteLabel)}"`:"",Ie=Object.entries(B),Ce=typeof M.sorter=="function"?M.sorter:(Ge,lt)=>sa(Ge[0],lt[0]);return Ie.sort((Ge,lt)=>{try{return Ce(Ge,lt)}catch(He){return typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("formatItems sorter failed, falling back to default",He),sa(Ge[0],lt[0])}}),Ie.map(([Ge,lt])=>{const He=lt.total,ht=lt.ctxCounts,nr=Object.keys(ht).some(Qe=>Qe);let Zt=[];if(nr)if(Ge==="sand bag"){const Qe=Object.entries(ht).filter(([vr])=>vr&&vr.toLowerCase()!=="spare").sort(([vr],[Tt])=>sa(vr,Tt)),qr=Qe.reduce((vr,[,Tt])=>vr+Tt,0),po=He-qr;Zt=Qe.map(([vr,Tt])=>`${Tt}x ${vr}`),po>0&&Zt.push(`${po}x Spare`)}else if(Ge.startsWith("Bebob ")){const Qe=Object.entries(ht).filter(([vr])=>vr&&vr.toLowerCase()!=="spare").map(([vr,Tt])=>{const cn=vr.match(/^(\d+)x\s+(.*)$/i);if(cn){const[,mo,cb]=cn,Qc=parseInt(mo,10);if(Number.isFinite(Qc)&&Qc>0)return[cb.trim(),Tt*Qc]}return[vr,Tt]}).sort(([vr],[Tt])=>sa(vr,Tt)),qr=Qe.reduce((vr,[,Tt])=>vr+Tt,0),po=He-qr;Zt=Qe.map(([vr,Tt])=>`${Tt}x ${vr}`),po>0&&Zt.push(`${po}x Spare`)}else{const Qe=Object.entries(ht).filter(([Tt])=>Tt&&Tt.toLowerCase()!=="spare").sort(([Tt],[cn])=>sa(Tt,cn)),qr=Qe.reduce((Tt,[,cn])=>Tt+cn,0),po=Object.entries(ht).filter(([Tt])=>Tt&&Tt.toLowerCase()==="spare").reduce((Tt,[,cn])=>Tt+cn,0);if(Qe.length>0&&Qe.every(([,Tt])=>Tt===Qe[0][1])&&po===0?Zt=Qe.map(([Tt])=>Tt):Zt=Qe.map(([Tt,cn])=>`${cn}x ${Tt}`),po>0)Zt.push(`${po}x Spare`);else if(Ge==="D-Tap Extension 50 cm"){const Tt=He-qr;Tt>0&&Zt.push(`${Tt}x Spare`)}}const Yt=Zt.length?` (${Zt.join(", ")})`:"",Nt=gearItemTranslations[currentLang]?.[Ge]||Ge,Nr=`${Nt}${Yt}`,lr=`${Ge}${Yt}`,Mn=` data-gear-quantity="${Te(String(He))}"`,cr=` data-gear-label="${Te(Nt)}"`,Lo=Zt.length?` data-gear-attributes="${Te(Zt.join(", "))}"`:"",ri=Te(lr),Pa=`${He}x ${Nr}`,hr=[];if(lt.cameraLink){const Qe=L(lt.cameraLinkLabel);Qe&&hr.push(Qe)}const Sr=hr.length?` ${hr.join(" ")}`:"";return`<span class="gear-item" data-gear-name="${ri}"${Mn}${cr}${Lo}${ie}${Sr}><span class="gear-item-text">${Te(Pa)}</span><span class="gear-item-note" hidden></span></span>`}).join("")},kt=(C,M={})=>{if(!C)return"";const{name:B="",quantity:ee="",label:re="",attributes:ie="",rentalNote:Ie=ct,extraAttributes:Ce=""}=M,Ge=B?` data-gear-name="${Te(String(B))}"`:"",lt=ee?` data-gear-quantity="${Te(String(ee))}"`:"",He=re?` data-gear-label="${Te(String(re))}"`:"",ht=ie?` data-gear-attributes="${Te(String(ie))}"`:"",Vt=typeof Ie=="string"?Ie:"",nr=Ce?` ${Ce.trim()}`:"";return`<span class="gear-item"${Ge}${lt}${He}${ht}${Vt}${nr}><span class="gear-item-text">${C}</span><span class="gear-item-note" hidden></span></span>`},O=(C,M)=>{if(typeof registerDevice!="function")return;const B={};C.filter(Boolean).forEach(ee=>{const re=ee.trim().match(/^(.*?)(?: \(([^()]+)\))?$/),ie=re?re[1].trim():ee.trim();B[ie]=B[ie]||{}}),Object.keys(B).length&&registerDevice(M,B)},U=[],F=(C,M)=>{if(!M||!String(M).trim())return;const ee=(typeof C=="string"?C:String(C??"")).trim()||String(C??""),re=gg(ee),ie=Te(ee),Ie=Rn("gearListAddCustomItem","Add custom item"),Ce=Rn("gearListAddCustomItemToCategory","Add custom item to {category}",{category:ee}),Ge=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?ICON_GLYPHS.add||ICON_GLYPHS.plus:null,He=(typeof iconMarkup=="function"&&Ge?iconMarkup(Ge,{className:"btn-icon"}):"")||Te("+"),ht=`<button type="button" class="gear-custom-add-btn" data-gear-custom-add="${Te(re)}" data-gear-custom-category="${ie}" aria-label="${Te(Ce)}" title="${Te(Ie)}">${He}</button>`,Vt=`<div class="gear-standard-items">${M}</div>`,nr=`<div class="gear-custom-section" data-gear-custom-key="${Te(re)}" data-gear-custom-category="${ie}"><div class="gear-custom-items" data-gear-custom-list="${Te(re)}" data-gear-custom-category="${ie}" aria-live="polite"></div></div>`,Zt=`${Vt}${nr}`;U.push(`<tbody class="category-group" data-gear-table-category="${ie}" data-gear-custom-key="${Te(re)}"><tr class="category-row"><td data-gear-category-label="${ie}"><div class="gear-category-header"><span class="gear-category-label">${ie}</span>${ht}</div></td></tr><tr><td>${Zt}</td></tr></tbody>`)};F("Camera",Gt([l.camera])),N.forEach(C=>{const M=aN(C);M&&S(M)});const W=Gt(N,{onItem:I});let se="";if(Y.length){const C=Y.map(Ce=>`<option value="${Te(Ce)}"${Ce===l.cage?" selected":""}>${Te(Ar(Ce))}</option>`).join(""),M=typeof Ei=="function"?Ei("category_cages"):"",B=M&&M.trim()?M.trim():"Camera Cage",ee=B?` aria-label="${Te(B)}"`:"";B&&`${Te(B)}`;const re=`<span class="cage-select-wrapper"><span>1x</span><select id="gearListCage"${ee}>${C}</select></span>`;l.cage&&l.cage.trim();const ie=B,Ie=l.cage&&A?L(l.cage):"";se=kt(re,{name:ie,quantity:1,label:B,attributes:"",extraAttributes:Ie})}F("Camera Support",[W,se].filter(Boolean).join(""));const me=Array.isArray(e.storageRequirements)?e.storageRequirements.map(C=>{if(!C||typeof C!="object")return"";const M=Number.isFinite(C.quantity)&&C.quantity>0?C.quantity:null,B=typeof C.type=="string"?C.type.trim():"",ee=typeof C.variant=="string"?C.variant.trim():"",re=typeof C.notes=="string"?C.notes.trim():"";if(!M&&!B&&!ee&&!re)return"";const ie=[],Ie=B.toLowerCase();let Ce=ee||"";if(Ce){const He=Ce.toLowerCase();Ie&&!He.includes(Ie)&&B&&ie.push(B)}else B&&(Ce=B);Ce||(Ce=xt),re&&ie.push(re);const Ge=ie.length?` (${ie.join(", ")})`:"";return`${M?`${M}x `:""}${Ce}${Ge}`.trim()}).filter(Boolean):[],Re=devices&&devices.cameras&&l.camera?devices.cameras[l.camera]:null;let De="";if(me.length)De=Gt(me);else if(Re&&Array.isArray(Re.recordingMedia)&&Re.recordingMedia.length){const C={"CFexpress Type A":"320GB","CFast 2.0":"512GB","CFexpress Type B":"512GB","Codex Compact Drive":"1TB","AXS Memory A-Series slot":"1TB",SD:"128GB","SD Card":"128GB",SDXC:"128GB","XQD Card":"120GB","RED MINI-MAG":"512GB",'REDMAG 1.8" SSD':"512GB","Blackmagic Media Module":"8TB","DJI PROSSD":"1TB","USB-C 3.1 Gen 1 expansion port for external media":"1TB","USB-C 3.1 Gen 2 expansion port for external media":"1TB","USB-C to external SSD/HDD":"1TB"};De=Re.recordingMedia.slice(0,1).map(M=>{const B=M&&M.type?M.type:"";if(!B)return"";const ee=M&&M.brand?M.brand.trim():"";let re="";if(M.notes){const Ce=M.notes.match(/(\d+(?:\.\d+)?\s*(?:TB|GB))/i);Ce&&(re=Ce[1].toUpperCase())}return re||(re=C[B]||"512GB"),`4x ${`${ee?`${Te(ee)} `:""}${Te(re)} ${Te(B)}`}<br>2x ${Te(B)} reader with USB-C`}).filter(Boolean).join("<br>")}F("Media",De);const ot=(()=>{if(!Re)return null;const C=Re.requiredImageCircleMm??Re.requiredImageCircle,M=Number(C);return Number.isFinite(M)?M:null})(),at=Rn("gearListLensCoverageWarning","This lens may not cover the full sensor of this camera!"),vt=C=>{if(typeof C!="string")return"";const M=C.trim().toLowerCase();return M==="imperial"||M==="metric"?M:""},Qt=(()=>{const C=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,B=(C&&typeof C.focusScalePreference=="string"?C.focusScalePreference:null)||(typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";return vt(B)||"metric"})(),yr=C=>!C||typeof C!="object"?Qt:vt(C.focusScale)||Qt,tr=typeof currentLang=="string"&&currentLang.trim()?currentLang:"en",rr=(C,M={})=>{const B=typeof C=="string"?Number(C):C;if(!Number.isFinite(B))return"";const ee=typeof M.maximumFractionDigits=="number"?M.maximumFractionDigits:0,re=typeof M.minimumFractionDigits=="number"?M.minimumFractionDigits:Math.min(0,ee);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{return new Intl.NumberFormat(tr,{maximumFractionDigits:ee,minimumFractionDigits:re}).format(B)}catch{}const ie=Math.max(re,Math.min(20,ee));try{return B.toFixed(ie)}catch{}return String(B)},bn=(C,M=Qt)=>{const B=typeof C=="string"?Number(C):C;if(!Number.isFinite(B))return"";if(M==="imperial"){const ie=B/453.59237,Ie=ie>=10?1:2,Ce=rr(ie,{maximumFractionDigits:Ie,minimumFractionDigits:0});return Ce?`${Ce} lb`:""}const re=rr(B,{maximumFractionDigits:0,minimumFractionDigits:0});return re?`${re} g`:""},io=(C,M=Qt)=>{const B=typeof C=="string"?Number(C):C;if(!Number.isFinite(B))return"";if(M==="imperial"){const ie=B/25.4,Ie=ie>=10?1:2,Ce=rr(ie,{maximumFractionDigits:Ie,minimumFractionDigits:0});return Ce?`${Ce} in`:""}const re=rr(B,{maximumFractionDigits:1,minimumFractionDigits:0});return re?`${re} mm`:""},$o=(C,M=Qt)=>{const B=typeof C=="string"?Number(C):C;if(!Number.isFinite(B))return"";if(M==="imperial"){const Ie=B*3.280839895,Ce=Ie<10?2:1,Ge=rr(Ie,{maximumFractionDigits:Ce,minimumFractionDigits:Ce});return Ge?`${Ge} ft`:""}const re=B<1?2:1,ie=rr(B,{maximumFractionDigits:re,minimumFractionDigits:re});return ie?`${ie} m`:""},hn=(C,M=Qt)=>{const B=typeof C=="string"?Number(C):C;if(!Number.isFinite(B))return"";if(M==="imperial"){const ie=B/2.54,Ie=ie>=10?1:2,Ce=rr(ie,{maximumFractionDigits:Ie,minimumFractionDigits:0});return Ce?`${Ce} in`:""}const re=rr(B,{maximumFractionDigits:1,minimumFractionDigits:0});return re?`${re} cm`:""},Sn=new Map,ei=_e.map(C=>{const M=devices.lenses&&devices.lenses[C],B=Ar(C),ee=sG(C,M);if(Sn.set(B,{manufacturer:ee.manufacturer,series:ee.series,focalLabel:ee.focalLabel,focalSortKey:ee.focalSortKey}),!M)return B;const re=yr(M),ie=[],Ie=bn(M.weight_g,re);if(Ie&&ie.push(Ie),M.clampOn)if(M.frontDiameterMm){const He=io(M.frontDiameterMm,re);ie.push(He?`${He} clamp-on`:"clamp-on")}else ie.push("clamp-on");else M.clampOn===!1&&ie.push("no clamp-on");const Ce=M.minFocusMeters??M.minFocus??(M.minFocusCm?M.minFocusCm/100:null);if(Number.isFinite(Ce)&&Ce>0){const He=$o(Ce,re);He&&ie.push(`${He} min focus`)}const Ge=Number(M.imageCircleMm??M.imageCircle);return Number.isFinite(ot)&&Number.isFinite(Ge)&&Ge+.5<ot&&at&&ie.push(at),ie.length?`${B} (${ie.join(", ")})`:B});F("Lens",Gt(ei,{sorter:([C],[M])=>{const B=Sn.get(C),ee=Sn.get(M);if(B&&ee){const re=sa(B.manufacturer,ee.manufacturer);if(re!==0)return re;const ie=sa(B.series,ee.series);if(ie!==0)return ie;const Ie=Number.isFinite(B.focalSortKey),Ce=Number.isFinite(ee.focalSortKey);if(Ie&&Ce&&B.focalSortKey!==ee.focalSortKey)return B.focalSortKey-ee.focalSortKey;if(Ie!==Ce)return Ie?-1:1;const Ge=sa(B.focalLabel,ee.focalLabel);if(Ge!==0)return Ge}else{if(B&&!ee)return-1;if(!B&&ee)return 1}return sa(C,M)}}));const ti=C=>{if(!C&&C!==0)return[];const M=Array.isArray(C)?C:[C],B=new Set;return M.forEach(re=>{const ie=(re??"").toString().toLowerCase();ie&&(/\b15\s*mm\b/.test(ie)&&B.add("15mm"),/\b19\s*mm\b/.test(ie)&&B.add("19mm"))}),["15mm","19mm"].filter(re=>B.has(re))},br=[],Wr=new Set;_e.forEach(C=>{const M=devices.lenses&&devices.lenses[C];if(!M)return;const B=ti(M.rodStandard),ee=B[0]||(M.rodStandard?M.rodStandard:"15mm"),re=B[0]||(ee==="19mm"?"19mm":"15mm"),ie=M.rodLengthCm||(re==="19mm"?45:30),Ie=`${re}-${ie}`;if(!Wr.has(Ie)){const Ge=hn(ie,yr(M))||`${ie}cm`;br.push(`${re} rods ${Ge}`),Wr.add(Ie)}M.needsLensSupport&&br.push(`${re} lens support`)}),F("Lens Support",Gt(br)),F("Matte box + filter",[ft,Gt(We)].filter(Boolean).join(""));const kr=[],wo={clm3:!1,clm4:!1,clm5:!1};l.motors.forEach(C=>{const M=(C||"").toLowerCase();let B="";/cforce\s*mini\s*rf|cforce\s*rf/.test(M)?(B="ARRI KK.0040345 CFORCE MINI RF Basic Set 2",kr.push(B)):/cforce\s*mini/.test(M)&&!/rf/.test(M)?(B="ARRI KK.0040344 Cforce Mini Basic Set 2",kr.push(B)):/cforce\s*plus/.test(M)?(B="Arri KK.0008824 cforce plus Basic Set",kr.push(B),kr.push("ARRI K2.0009335 Cforce Plus Gear M0.8/32p, 60t")):/clm-3/.test(M)?(B="Arri KK.0005854 Controlled Lens Motor CLM-3 Basic Set",kr.push(B),wo.clm3||(kr.push("Arri K2.65145.0, Cable CLM-3 (7p) - CLM/FIZ (12p) (0,8m/2.6ft) (spare)"),wo.clm3=!0)):/clm-4/.test(M)?(B="ARRI Controlled Lens Motor CLM-4, Basic Kit (KK.0005855)",kr.push(B),wo.clm4||(kr.push("Arri K2.72099.0 CLM-4 Motor Cable (spare)"),wo.clm4=!0)):/clm-5/.test(M)&&(B="Arri K2.0006361 Controlled Lens Motor CLM-5 Basic Set",kr.push(B),wo.clm5||(kr.push("Arri K2.0006361 Controlled Lens Motor CLM-5 Basic Set (spare)"),wo.clm5=!0)),!B&&C&&(B=C,kr.push(C)),B&&S(B)}),l.controllers.forEach(S);const so=[],Ga=l.distance;if(Ga)if(Ga.toLowerCase()==="udm-1 + lcube"){const M="Arri KK.0005853 Ultrasonic Distance Measure UDM-1 Basic Set";so.push(M),S(M);const B=l.controllers.some(re=>/ria-1/i.test(re)),ee=/alexa 35/i.test(l.camera||"");if(!B&&!ee){const re="Arri KK.0009001 LCUBE CUB-1 Basic Set";so.push(re),S(re)}}else so.push(Ga),S(Ga);F("LDS (FIZ)",Gt([...kr,...l.controllers,...so,...oe],{onItem:I}));let Po="";if(l.battery){S(l.battery);let C=batteryCountElem?parseInt(batteryCountElem.textContent,10):NaN;(!C||isNaN(C))&&(C=1);const M=[`${C}x ${l.battery}`],B=hotswapSelect&&hotswapSelect.value&&hotswapSelect.value!=="None"?u(hotswapSelect):"";B&&(M.push(`1x ${B}`),S(B)),Po=Gt(M,{onItem:I})}F("Camera Batteries",Po);let Lr="";const xo=[];if(l.monitor){const C="Onboard Monitor",M=devices?.monitors||{},B=Sr=>{if(typeof Sr!="string")return"";const Qe=Sr.trim();if(!Qe)return"";const qr=Qe.toLowerCase(),po=["linked","to","camera"],vr=" ",Tt=En=>En===" "||En==="	"||En===`
`||En==="\r"||En==="\f"||En==="\v"||En===vr,cn=En=>{let Oi=En;for(;Oi<qr.length&&Tt(qr[Oi]);)Oi+=1;return Oi};let mo=0;for(let En=0;En<po.length;En+=1){mo=cn(mo);const Oi=po[En];if(qr.slice(mo,mo+Oi.length)!==Oi)return Qe;mo+=Oi.length}const cb=mo;mo=cn(mo);const Qc=mo>cb;if(mo>=Qe.length)return Qe;const KP=new Set(["—","–","-",":"]);let _C=!1;return KP.has(Qe[mo])&&(mo+=1,_C=!0),mo=cn(mo),!Qc&&!_C||mo>=Qe.length?Qe:Qe.slice(mo).trim()},ee=Sr=>{if(typeof Sr!="string")return"";const Qe=Sr.trim();if(!Qe)return"";const qr=Tt=>Tt==='"'||Tt==="'"||Tt==="“"||Tt==="”"||Tt==="‚"||Tt==="‘"||Tt==="’";let po=0,vr=Qe.length;for(;po<vr&&qr(Qe[po]);)po+=1;for(;vr>po&&qr(Qe[vr-1]);)vr-=1;return Qe.slice(po,vr).trim()},re=Sr=>ee(B(Sr)),ie=typeof monitorSelect<"u"&&monitorSelect&&monitorSelect.value&&monitorSelect.value!=="None"?monitorSelect.value:"",Ie=typeof e.monitorSelection=="string"?e.monitorSelection.trim():"",Ce=[],Ge=Sr=>{const Qe=typeof Sr=="string"?Sr.trim():"";if(!Qe)return;Ce.includes(Qe)||Ce.push(Qe);const qr=re(Qe);qr&&!Ce.includes(qr)&&Ce.push(qr)};Ge(ie),Ge(Ie),Ge(l.monitor);let lt="",He=null;Ce.some(Sr=>Object.prototype.hasOwnProperty.call(M,Sr)?(lt=Sr,He=M[Sr],!0):!1);let ht=He&&typeof He.screenSizeInches<"u"?Number(He.screenSizeInches):NaN;if(!Number.isFinite(ht)){const Sr=parseFloat(String(He?.screenSizeInches??""));ht=Number.isFinite(Sr)?Sr:NaN}Number.isFinite(ht)||(ht=NaN),Number.isFinite(ht)&&xo.push(ht);const nr=(Sr=>{if(!Number.isFinite(Sr))return"";const Qe=Number(Sr.toFixed(2));return Number.isInteger(Qe)?String(Qe):String(Qe).replace(/\.0+$/,"")})(ht),Zt=nr?`${Te(nr)}&quot;`:"",Yt=re(l.monitor)||lt||re(Ie)||re(ie),Nt=Yt?Ar(Yt):"",Nr=Nt?`&quot;${Te(Nt)}&quot;`:"",lr=[`1x <strong>${C}</strong>`];Zt&&lr.push(Zt),Nr&&lr.push(Nr),lr.push("incl. Sunhood");const Mn=lr.join(" - "),cr=[];nr&&cr.push(`${nr}"`),Nt&&cr.push(Nt),cr.push("incl. Sunhood");const Lo=cr.filter(Boolean).join(" - "),ri=Lo?`${C} (${Lo})`:C,Pa=Nt||re(l.monitor)||re(Ie)||re(ie)||"",hr=A?L(Pa||void 0):"";Lr+=(Lr?"<br>":"")+kt(Mn,{name:ri,quantity:1,label:C,attributes:Lo,extraAttributes:hr})}if(j.forEach(({role:C,size:M})=>{const B=devices&&devices.monitors?devices.monitors:{},ee=Object.keys(B).filter(Qe=>!B[Qe].wirelessTx||B[Qe].wirelessRX).sort(localeSort),re=C==="DoP"?"dopMonitor":`${C.toLowerCase()}Monitor`,ie=!!e[`${re}Manual`],Ie=typeof e[re]=="string"?e[re].trim():"",Ce=getAutoGearMonitorDefault("handheld7");let Ge="";ie&&Ie?Ge=Ie:Ce?Ge=Ce:Ie&&(Ge=Ie);const lt=ee.map(Qe=>Qe.toLowerCase());let He="";if(Ge){const Qe=lt.indexOf(Ge.toLowerCase());Qe>=0&&(He=ee[Qe])}if(!He){if(!ie&&M){const Qe=ee.find(qr=>B[qr].screenSizeInches===M);M===7&&ee.includes("SmallHD Ultra 7")?He="SmallHD Ultra 7":Qe&&(He=Qe)}He||(!ie&&!Ge&&ee.includes("SmallHD Ultra 7")?He="SmallHD Ultra 7":ee.length?He=ee[0]:Ge&&(He=Ge))}const ht=ee.slice();Ge&&!lt.includes(Ge.toLowerCase())&&ht.unshift(Ge),He&&!ht.some(Qe=>Qe.toLowerCase()===He.toLowerCase())&&ht.unshift(He);const Vt=new Set,nr=ht.filter(Boolean).filter(Qe=>{const qr=Qe.toLowerCase();return Vt.has(qr)?!1:(Vt.add(qr),!0)}).map(Qe=>{const qr=Qe.toLowerCase()===(He||"").toLowerCase();return`<option value="${Te(Qe)}"${qr?" selected":""}>${Te(Ar(Qe))}</option>`}).join(""),Zt=C==="DoP"?"Dop":C,Yt=C.replace(/s$/,""),Nt=Array.from(Vt.values()).find(Qe=>Qe===(He||"").toLowerCase())?ht.find(Qe=>Qe&&Qe.toLowerCase()===(He||"").toLowerCase()):He,lr=(Nt&&B[Nt]?B[Nt]:B[He]||B[Ge]||null)?.screenSizeInches||"",Mn=`${Yt} Handheld Monitor`,cr=`<span id="monitorSize${Zt}">(${Te(lr?String(lr):"")}&quot;)</span>`,Lo=`<select id="gearList${Zt}Monitor" data-auto-gear-manual="${ie?"true":"false"}">${nr}</select>`,ri=`1x <strong>${Te(Mn)}</strong> - ${cr} - ${Lo} incl. Directors cage, shoulder strap, sunhood, rigging for teradeks`,Pa=[];lr&&Pa.push(`${lr}"`),Nt&&Pa.push(Ar(Nt)),Pa.push("incl. Directors cage, shoulder strap, sunhood, rigging for teradeks");const hr=Pa.filter(Boolean).join(" - "),Sr=hr?`${Mn} (${hr})`:Mn;Lr+=(Lr?"<br>":"")+kt(ri,{name:Sr,quantity:1,label:Mn,attributes:hr}),lr&&xo.push(lr)}),$.forEach(({role:C})=>{const M=devices&&devices.directorMonitors?devices.directorMonitors:{},B=Object.keys(M).filter(hr=>hr!=="None").sort(localeSort),ee=C==="DoP"?"dopMonitor15":C==="Combo"?"comboMonitor15":"directorMonitor15",re=!!e[`${ee}Manual`],ie=typeof e[ee]=="string"?e[ee].trim():"",Ie=C==="Combo"?"combo15":"director15",Ce=getAutoGearMonitorDefault(Ie);let Ge="";re&&ie?Ge=ie:Ce?Ge=Ce:ie&&(Ge=ie);const lt=B.map(hr=>hr.toLowerCase());let He="";if(Ge){const hr=lt.indexOf(Ge.toLowerCase());hr>=0&&(He=B[hr])}He||(B.includes('SmallHD Cine 24" 4K High-Bright Monitor')?He='SmallHD Cine 24" 4K High-Bright Monitor':B.length?He=B[0]:Ge&&(He=Ge));const ht=B.slice();Ge&&!lt.includes(Ge.toLowerCase())&&ht.unshift(Ge),He&&!ht.some(hr=>hr.toLowerCase()===He.toLowerCase())&&ht.unshift(He);const Vt=new Set,nr=ht.filter(Boolean).filter(hr=>{const Sr=hr.toLowerCase();return Vt.has(Sr)?!1:(Vt.add(Sr),!0)}).map(hr=>{const Sr=hr.toLowerCase()===(He||"").toLowerCase();return`<option value="${Te(hr)}"${Sr?" selected":""}>${Te(Ar(hr))}</option>`}).join(""),Zt=C==="DoP"?"Dop":C,Yt=Array.from(Vt.values()).find(hr=>hr===(He||"").toLowerCase())?ht.find(hr=>hr&&hr.toLowerCase()===(He||"").toLowerCase()):He,Nt=Yt&&M[Yt]?.screenSizeInches?M[Yt].screenSizeInches:M[He]?.screenSizeInches||M[Ge]?.screenSizeInches||"",Nr=`${C} Monitor`,lr=`<span id="monitorSize${Zt}15">(${Te(Nt?String(Nt):"")}&quot;)</span>`,Mn=`<select id="gearList${Zt}Monitor15" data-auto-gear-manual="${re?"true":"false"}">${nr}</select>`,cr=`1x <strong>${Te(Nr)}</strong> - ${lr} - ${Mn} incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)`,Lo=[];Nt&&Lo.push(`${Nt}"`),Yt&&Lo.push(Ar(Yt)),Lo.push("incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)");const ri=Lo.filter(Boolean).join(" - "),Pa=ri?`${Nr} (${ri})`:Nr;Lr+=(Lr?"<br>":"")+kt(cr,{name:Pa,quantity:1,label:Nr,attributes:ri}),Nt&&xo.push(Nt)}),R){const C=devices&&devices.monitors?devices.monitors:{},M=Object.keys(C).filter(cr=>!C[cr].wirelessTx||C[cr].wirelessRX).sort(localeSort),B=!!e.focusMonitorManual,ee=typeof e.focusMonitor=="string"?e.focusMonitor.trim():"",re=getAutoGearMonitorDefault("focus");let ie="";B&&ee?ie=ee:re?ie=re:ee&&(ie=ee);const Ie=M.map(cr=>cr.toLowerCase());let Ce="";if(ie){const cr=Ie.indexOf(ie.toLowerCase());cr>=0&&(Ce=M[cr])}Ce||(M.includes("TV Logic F7HS")?Ce="TV Logic F7HS":M.length?Ce=M[0]:ie&&(Ce=ie));const Ge=M.slice();ie&&!Ie.includes(ie.toLowerCase())&&Ge.unshift(ie),Ce&&!Ge.some(cr=>cr.toLowerCase()===Ce.toLowerCase())&&Ge.unshift(Ce);const lt=new Set,He=Ge.filter(Boolean).filter(cr=>{const Lo=cr.toLowerCase();return lt.has(Lo)?!1:(lt.add(Lo),!0)}).map(cr=>{const Lo=cr.toLowerCase()===(Ce||"").toLowerCase();return`<option value="${Te(cr)}"${Lo?" selected":""}>${Te(Ar(cr))}</option>`}).join(""),ht=Array.from(lt.values()).find(cr=>cr===(Ce||"").toLowerCase())?Ge.find(cr=>cr&&cr.toLowerCase()===(Ce||"").toLowerCase()):Ce,Vt=ht&&C[ht]?C[ht].screenSizeInches:C[Ce]?.screenSizeInches||C[ie]?.screenSizeInches||"",nr="Focus Monitor",Zt=`<span id="monitorSizeFocus">(${Te(Vt?String(Vt):"")}&quot;)</span>`,Yt=`<select id="gearListFocusMonitor" data-auto-gear-manual="${B?"true":"false"}">${He}</select>`,Nt=`1x <strong>${Te(nr)}</strong> - ${Zt} - ${Yt} incl Directors cage, shoulder strap, sunhood, rigging for teradeks`,Nr=[];Vt&&Nr.push(`${Vt}"`),ht&&Nr.push(Ar(ht)),Nr.push("incl Directors cage, shoulder strap, sunhood, rigging for teradeks");const lr=Nr.filter(Boolean).join(" - "),Mn=lr?`${nr} (${lr})`:nr;Lr+=(Lr?"<br>":"")+kt(Nt,{name:Mn,quantity:1,label:nr,attributes:lr}),Vt&&xo.push(Vt)}const ln=[],Pn=xo.includes(5)?5:null;if(l.video){const C=Pn?`${Pn}&quot; - `:"",M=`Wireless Transmitter - ${C}${Ar(l.video)}`;ln.push(M),S(M);const B=l.video.replace(/ TX\b/," RX");devices&&devices.wirelessReceivers&&devices.wirelessReceivers[B]&&we.forEach(ee=>{const re=`Wireless Receiver - ${C}${Ar(B)} (${ee})`;ln.push(re),S(re)})}if(ln.length){const C=Gt(ln,{onItem:I}).replace(/>(\d+x )Wireless Transmitter/g,">$1<strong>Wireless Transmitter</strong>").replace(/>(\d+x )Wireless Receiver/g,">$1<strong>Wireless Receiver</strong>").replace(/&amp;quot;/g,"&quot;");Lr+=(Lr?"<br>":"")+C}const Mo=(()=>{const C=e.monitorBatteries;if(!C||typeof C!="object"||Array.isArray(C))return{};const M={};return Object.entries(C).forEach(([B,ee])=>{if(typeof B!="string"||typeof ee!="string")return;const re=ee.trim();re&&(M[B]=re)}),M})(),Jn=devices&&devices.batteries?devices.batteries:{},ea=Object.keys(Jn).filter(C=>C&&C!=="None").sort(localeSort),xn=C=>{const M=typeof C=="string"?C.trim():"",B=ea.slice();M&&!B.some(re=>re.toLowerCase()===M.toLowerCase())&&B.unshift(M);const ee=new Set;return B.filter(Boolean).filter(re=>{const ie=re.toLowerCase();return ee.has(ie)?!1:(ee.add(ie),!0)}).map(re=>{const ie=M&&re.toLowerCase()===M.toLowerCase();return`<option value="${Te(re)}"${ie?" selected":""}>${Te(Ar(re))}</option>`}).join("")},vn=[],ta=Object.keys(Jn).find(C=>/V98micro/i.test(C))||"Bebob V98micro";j.forEach((C,M)=>{const ee=(typeof C.role=="string"?C.role:"").trim(),re=`${ee||"Monitor"} handheld`,ie=`handheld:${ee}:${M}`,Ie=Mo[ie],Ce=typeof Ie=="string"&&Ie.trim()||ta,Ge=(ee||"Monitor").replace(/[^A-Za-z0-9]/g,"")||"Monitor",lt=`gearListMonitorBatteryHandheld${M}${Ge}`,He=xn(Ce),ht=`<select id="${lt}" data-monitor-battery-key="${Te(ie)}" data-monitor-battery-type="handheld" data-monitor-battery-role="${Te(ee)}">${He}</select>`,Vt=`Monitoring Battery ${re}`,nr=' data-gear-quantity="3"',Zt=' data-gear-label="Monitoring Battery"',Yt=re?` data-gear-attributes="${Te(re)}"`:"",Nt=`3x ${ht} (${Te(re)})`;vn.push(`<span class="gear-item" data-gear-name="${Te(Vt)}"${nr}${Zt}${Yt}${ct}><span class="gear-item-text">${Nt}</span><span class="gear-item-note" hidden></span></span>`)});const ka=Object.keys(Jn).find(C=>/V290RM-Cine/i.test(C))||"Bebob V290RM-Cine";$.forEach((C,M)=>{const ee=(typeof C.role=="string"?C.role:"").trim(),re=`${ee||"Monitor"} 15-21"`,ie=`large:${ee}:${M}`,Ie=Mo[ie],Ce=typeof Ie=="string"&&Ie.trim()||ka,Ge=(ee||"Monitor").replace(/[^A-Za-z0-9]/g,"")||"Monitor",lt=`gearListMonitorBatteryLarge${M}${Ge}`,He=xn(Ce),ht=`<select id="${lt}" data-monitor-battery-key="${Te(ie)}" data-monitor-battery-type="large" data-monitor-battery-role="${Te(ee)}">${He}</select>`,Vt=`Monitoring Battery ${re}`,nr=' data-gear-quantity="2"',Zt=' data-gear-label="Monitoring Battery"',Yt=re?` data-gear-attributes="${Te(re)}"`:"",Nt=`2x ${ht} (${Te(re)})`;vn.push(`<span class="gear-item" data-gear-name="${Te(Vt)}"${nr}${Zt}${Yt}${ct}><span class="gear-item-text">${Nt}</span><span class="gear-item-note" hidden></span></span>`)}),F("Monitoring Batteries",vn.length?vn.join(""):""),F("Chargers",Gt(te)),F("Monitoring",Lr),O(Z,"accessories.monitoringSupport");const Ba=Gt(Z.filter(C=>typeof C!="string"?!0:!(C.startsWith("Monitoring Battery ")||C.endsWith("Monitor"))));F("Monitoring support",Ba);const ra=devices&&typeof devices=="object"&&devices.carts&&typeof devices.carts=="object"?devices.carts:{},qo=Object.keys(ra).filter(C=>C&&C!=="None").sort(localeSort),Me=qo.includes('Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)')?'Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)':qo[0]||"",b=[{pattern:/magliner\s+senior/,value:'Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)'},{pattern:/magliner\s+junior/,value:'Backstage Magliner Junior 24" Film Cart (8" Conversion Kit)'},{pattern:/voyager\s*30/,value:"Inovativ Voyager 30 EVO X"},{pattern:/voyager\s*36/,value:"Inovativ Voyager 36 EVO X"},{pattern:/voyager\s*42/,value:"Inovativ Voyager 42 EVO X"},{pattern:/apollo\s*40/,value:"Inovativ Apollo 40 EVO"},{pattern:/apollo\s*52/,value:"Inovativ Apollo 52 EVO"},{pattern:/echo\s*36/,value:"Inovativ Echo 36 Workstation Cart"},{pattern:/echo\s*48/,value:"Inovativ Echo 48 Workstation Cart"},{pattern:/adicam\s+mini/,value:"Adicam MINI Camera Cart"},{pattern:/adicam\s+standard\+/,value:"Adicam STANDARD+ Camera Cart"},{pattern:/adicam\s+standard/,value:"Adicam STANDARD Camera Cart"},{pattern:/adicam\s+max/,value:"Adicam MAX Camera Cart"},{pattern:/tilta\s+boulder/,value:'Tilta Boulder 36" Camera Cart'},{pattern:/smallrig/,value:'SmallRig MD4573 36" Lightweight Video Production Camera Cart'}];function v(C){return C?C.replace(/["'”“]/g,"").replace(/\(.*?\)/g,"").replace(/[^a-z0-9]+/gi," ").trim().toLowerCase():""}function T(C){if(!qo.length)return"";const M=typeof C=="string"?C.trim():"";if(M&&Object.prototype.hasOwnProperty.call(ra,M))return M;const B=v(M);if(B){const ee=qo.find(ie=>v(ie)===B);if(ee)return ee;const re=b.find(ie=>ie.pattern.test(B)&&qo.includes(ie.value));if(re)return re.value}return""}function P(C){return C?C.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/\b\w/g,M=>M.toUpperCase()):""}function x(C,M){if(!C||typeof C!="object")return"";const B=[];M&&B.push(M),typeof C.diameterIn<"u"?B.push(`${C.diameterIn}"`):typeof C.diameterMainMm<"u"&&B.push(`${C.diameterMainMm} mm`),C.tireType&&B.push(C.tireType);const ee=B.filter(Boolean).join(" ");return C.notes?ee?`${ee} (${C.notes})`:C.notes:C.name&&ee?`${C.name} - ${ee}`:C.name||ee}function _(C){if(!C||typeof C!="object")return[];const M=[],B=new Set,ee=(ie,Ie,Ce,Ge)=>{if(!ie||!Ie||B.has(ie))return;const lt=Ar(Ie)||Ie;M.push({value:ie,label:lt,selected:!!Ce,title:Ge}),B.add(ie)};C.config&&typeof C.config=="object"&&Object.entries(C.config).forEach(([ie,Ie])=>{if(!Ie)return;const Ce=P(ie);Ce&&ee(`feature:${ie}`,Ce,!0)});const re=C.wheelConfig&&typeof C.wheelConfig=="object"?C.wheelConfig:null;if(re&&re.standard){const ie=x(re.standard,"Standard wheel")||"Standard wheel";ee("wheel:standard",ie,!0,re.standard.notes)}return re&&Array.isArray(re.options)&&re.options.forEach((ie,Ie)=>{const Ce=x(ie,ie&&ie.name?ie.name:"Wheel option")||`Wheel option ${Ie+1}`;ee(`wheel:option:${Ie}`,Ce,!1,ie&&ie.notes)}),Array.isArray(C.kits)&&C.kits.forEach((ie,Ie)=>{const Ce=ie&&ie.name?ie.name:`Kit ${Ie+1}`;ee(`kit:${Ie}`,Ce,!1,ie&&ie.notes)}),M}function ce(C){if(!C||typeof C!="object")return[];const M=[],B=new Set,ee=(re,ie,Ie,Ce)=>{if(!re||!ie||B.has(re))return;const Ge=Ar(ie)||ie;M.push({value:re,label:Ge,selected:!!Ie,title:Ce}),B.add(re)};return Array.isArray(C.accessories)&&C.accessories.forEach((re,ie)=>{re&&ee(`accessory:${ie}`,re,!0)}),Array.isArray(C.brandAccessories)&&C.brandAccessories.forEach((re,ie)=>{if(!re||!re.name)return;const Ie=re.accessoryKind?P(re.accessoryKind):"",Ce=Ie?`[${Ie}] ${re.name}`:re.name;ee(`brand:${ie}`,Ce,!0,re.notes)}),M}function X(C,M,B){if(!B.length)return"";const ee=M||"Options",re=Math.min(6,Math.max(2,B.length)),ie=B.map(Ie=>{const Ce=[`value="${Te(Ie.value)}"`];return Ie.selected&&Ce.push("selected"),Ie.title&&Ce.push(`title="${Te(Ie.title)}"`),`<option ${Ce.join(" ")}>${Te(Ie.label)}</option>`}).join("");return`
        <span class="gear-cart-option">
          <span class="gear-cart-option-label">${Te(ee)}</span>
          <select id="${Te(C)}" multiple size="${re}" aria-label="${Te(ee)}">
            ${ie}
          </select>
        </span>
      `.replace(/\s+/g," ").trim()}function ye(C,M){if(!qo.length)return"";const B=T(C)||Me||"";if(!B&&!C)return"";const ee=B||C,re=qo.length?qo.map(lr=>`<option value="${Te(lr)}"${lr===B?" selected":""}>${Te(Ar(lr)||lr)}</option>`).join(""):`<option value="${Te(ee)}" selected>${Te(Ar(ee)||ee)}</option>`,ie=`gearListCartSelect${M}`,Ie=Rn("gearListCartSelectorLabel","Camera cart"),Ce=`<select id="${ie}" aria-label="${Te(Ie)}">${re}</select>`,Ge=ra[B]||ra[ee]||null,lt=_(Ge),He=ce(Ge),ht=lt.length?X(`gearListCartConfig${M}`,Rn("gearListCartConfigurationLabel","Cart configuration"),lt):"",Vt=He.length?X(`gearListCartAccessories${M}`,Rn("gearListCartAccessoriesLabel","Cart accessories"),He):"",nr=[ht,Vt].filter(Boolean).join(""),Zt=nr?`<div class="gear-cart-detail">${nr}</div>`:"",Yt=Ie||"Camera cart",Nt=`1x <strong>${Te(Yt)}</strong> - ${Ce}${Zt}`,Nr=ee?Ar(ee)||ee:"";return kt(Nt,{name:Nr?`${Yt} (${Nr})`:Yt,label:Yt,attributes:Nr,extraAttributes:' data-gear-cart-entry="true"'})}function Be(C){return!Array.isArray(C)||!C.length?"":C.map((B,ee)=>ye(B,ee)).filter(Boolean).join("")}const Ue=[];O(Ue,"accessories.carts");const be=[];let Fe=!1,bt="",it="";if(j.forEach(C=>{be.push(`Avenger C-Stand Sliding Leg 20" (${C.role} handheld)`),be.push(`Steelfingers Wheel C-Stand 3er Set (${C.role} handheld)`),be.push(`Lite-Tite Swivel Aluminium Umbrella Adapter (${C.role} handheld)`),ue.push(`Spigot with male 3/8" and 1/4" (${C.role} handheld)`)}),$.forEach(C=>{be.push(`Matthews Monitor Stand II (249562) (${C.role} 15-21")`),be.push(`Avenger C590 Conka Bonka Stativ-Verlängerungen Set (${C.role} 15-21")`),be.push(`Impact Baby to Junior Receiver Adapter (${C.role} 15-21")`),be.push(`Matthews BIG F'ING Monitor Wheel Set (3 pieces) (${C.role} 15-21")`),ue.push(`ULCS Bracket with 1/4" to 1/4" (${C.role} 15-21")`),be.push(`Manfrotto 635 Quick-Action Super Clamp (${C.role} 15-21")`),ue.push(`Spigot with male 3/8" and 1/4" (${C.role} 15-21")`),ue.push(`Cine Quick Release (${C.role} 15-21")`),ue.push(`D-Tap Splitter (${C.role} 15-21")`),ue.push(`D-Tap Splitter (${C.role} 15-21")`)}),ne("Easyrig")){const C=devices&&devices.accessories&&devices.accessories.cameraStabiliser&&devices.accessories.cameraStabiliser["Easyrig 5 Vario"];it=`1x Easyrig 5 Vario <select id="gearListEasyrig">${["no further stabilisation",...C&&Array.isArray(C.options)?C.options:[]].map(re=>`<option value="${Te(re)}">${Te(Ar(re))}</option>`).join("")}</select>`}fe&&be.push(...D);const Kt=fe?2:1;be.push(...Array(Kt).fill("Manfrotto 244N Friktion Arm")),fe&&(be.push("Avenger D200B Grip Head"),be.push('Spigot with male 3/8" and 1/4"')),ne("Cine Saddle")&&be.push("Cinekinetic Cinesaddle"),ne("Steadybag")&&be.push("Steadybag"),ne("Jib")&&(be.push("Pro Sup EJIb-Arm"),be.push("Jib counter weights"),Fe=!0),ne("Slider")&&(bt=`1x Prosup Tango Roller <select id="gearListSliderBowl">${["","75er bowl","100er bowl","150er bowl","Mitchell Mount"].map(M=>`<option value="${Te(M)}"${M===e.sliderBowl?" selected":""}>${Te(Ar(M))}</option>`).join("")}</select>`,be.push("Avenger Combo Stand 10 A1010CS 64-100 cm black"),be.push("Avenger Combo Stand 10 A1010CS 64-100 cm black"),be.push("Avenger Combo Stand 20 A1020B 110-198 cm black"),be.push("Avenger Combo Stand 20 A1020B 110-198 cm black"),be.push("Apple Box Set / Bühnenkisten Set"),be.push("Apple Box Set / Bühnenkisten Set"),be.push("Paganini set"),be.push("Sand bag (Slider)"),be.push("Sand bag (Slider)"),be.push("Cable mat"),be.push("Cable mat"),be.push("Cable mat")),ne("Slider")&&ne("Undersling mode")&&be.push("Tango Beam"),ne("Outdoor")&&ue.push('Spigot with male 3/8" and 1/4" (Focus Umbrella)'),V(["Extreme heat","Extreme rain","Rain Machine"])&&(be.push("Large Umbrella"),be.push("Avenger A5036CS Roller 36 Low Base with Umbrella Mounting"));const Mt=e.tripodTypes?e.tripodTypes.split(",").map(C=>C.trim()).filter(Boolean):[],xr=e.tripodBowl,Xr=e.tripodSpreader,zr=e.tripodHeadBrand,Ur={OConnor:{"100mm bowl":"O'Connor Ultimate 1040 Fluid-Head","150mm bowl":"O'Connor Ultimate 2560 Fluid-Head","Mitchell Mount":"O'Connor Ultimate 2560 Fluid-Head"},Sachtler:{"75mm bowl":"Sachtler aktiv8T S2068T","100mm bowl":"Sachtler aktiv18T S2088T","150mm bowl":"Sachtler Cine 30 3007"}},Ft=Ur[zr]&&Ur[zr][xr];if(Ft){const C=`${Ft} ${xr}`;be.push(C),S(C)}Mt.forEach(C=>{const M=C==="Hi-Head"?"Hi-Head":`${C} Tripod`,B=xr?`${xr} ${M}`:M,ee=[];C==="Hi-Head"?ee.push(B):Xr?ee.push(`${B} + ${Xr}`):ee.push(B),C==="Short"&&ee.push("Sand bag (Short Tripod)"),C==="Hi-Head"&&ee.push("Sand bag (Hi-Head)"),ee.forEach(re=>{be.push(re),S(re)})}),Fe&&!be.some(C=>/Long Tripod/.test(C))&&be.push("Long Tripod");const Zr=be.filter(C=>/\bstand\b/i.test(C)&&!/wheel/i.test(C)).length;Zr&&be.push(...Array(Zr*3).fill("Tennis ball"));const Rr=Ue.filter(C=>/Magliner/i.test(C)).length;Rr&&be.push(...Array(Rr*2).fill("Wooden wedge")),O(ue,"accessories.rigging"),O(be,"accessories.grip");const fo=Gt(ue);F("Rigging",fo);const lo=[];ne("Studio")&&lo.push("Camera Power Supply"),O(lo,"accessories.power"),F("Power",Gt(lo));const Mr=Gt(be,{onItem:I});F("Grip",[bt,Mr,it].filter(Boolean).join(""));const co=Be(Ue);F("Carts and Transportation",co||Gt(Ue));const $r=new Set(["D-Tap to LEMO 2-pin","HDMI Cable","BNC SDI Cable","Ultraslim BNC Cable 0.5 m"]),et=[...k].filter(C=>!$r.has(C)),pt=[],dt=Array.isArray(Re?.viewfinder)&&Re.viewfinder.length>0;let Br=e.viewfinderEyeLeatherColor||"red";const Do=[{id:1,color:e.proGaffColor1||"red",width:e.proGaffWidth1||"24mm"},{id:2,color:e.proGaffColor2||"blue",width:e.proGaffWidth2||"24mm"}],Vo=[{name:"Kimtech Wipes",count:1},{name:'Sprigs Red 1/4"',count:1,noScale:!0},{name:"Clapper Stick",count:2,klappen:!0}];let Fr=dt?2:0,to=0,Wo=!1;const Yc=Array.isArray(e.shootingDays)?e.shootingDays:e.shootingDays?[e.shootingDays]:[],dr=new Set([9,10,11,0,1,2,3,4]);Yc.forEach(C=>{const M=C.split(" to ");if(M.length===2){const B=new Date(M[0]),ee=new Date(M[1]);if(!isNaN(B)&&!isNaN(ee)&&(to+=Math.floor((ee-B)/(1e3*60*60*24))+1,!Wo)){const re=new Date(B);for(re.setHours(0,0,0,0);re<=ee;){if(dr.has(re.getMonth())){Wo=!0;break}re.setMonth(re.getMonth()+1)}}}});let jt=1;to>21?jt=4:to>14?jt=3:to>7&&(jt=2);const f=jt%2===0?jt:Math.max(1,jt-1);for(const C of Vo){let M=C.count;C.noScale||(C.klappen?M*=f:M*=jt);for(let B=0;B<M;B++)pt.push(C.name)}Fr&&(Fr*=jt);const w=V(["Outdoor","Extreme rain","Rain Machine"]);if(w&&l.camera&&et.push(`Rain Cover ${Ar(l.camera)}`),(w||ne("Extreme heat"))&&(et.includes("Umbrella for Focus Monitor")||et.push("Umbrella for Focus Monitor"),et.includes("Umbrella Magliner incl Mounting to Magliner")||et.push("Umbrella Magliner incl Mounting to Magliner")),w){const C=[];if(monitorSelect&&monitorSelect.value){const ee=devices.monitors[monitorSelect.value];ee&&ee.screenSizeInches&&C.push(ee.screenSizeInches)}const M=C.filter(ee=>ee>10).length,B=C.filter(ee=>ee<=10).length;for(let ee=0;ee<M+2;ee++)pt.push("CapIt Large");for(let ee=0;ee<B+3;ee++)pt.push("CapIt Medium");for(let ee=0;ee<3;ee++)pt.push("CapIt Small");for(let ee=0;ee<10;ee++)pt.push("Shower Cap");pt.push("Magliner Rain Cover Transparent")}const Pe=Wo&&ne("Outdoor")||ne("Extreme cold (snow)"),st=ne("Extreme cold (snow)");if(Pe&&(et.push("Hair Dryer"),["Sony Venice 2","Sony Venice"].includes(l.camera)?et.push("Denz C0100072 Shut-Eye Heater für Sony"):["Arri Alexa Mini","Arri Amira"].includes(l.camera)&&et.push("Arri K2.0003898 Heated Eyecup HE-7 for the MVF-1")),st){const C=Math.max(to,1)*2;for(let M=0;M<C;M++)et.push("Hand Warmers");for(let M=0;M<C;M++)et.push("Feet Warmers")}const At=[["red","Red"],["blue","Blue"],["green","Green"],["yellow","Yellow"],["black","Black"],["pink","Pink"],["orange","Orange"],["violette","Violette"],["white","White"]],qt=["6mm","12mm","19mm","24mm","48mm"],Xt=jt,Ne=Do.map(({id:C,color:M,width:B})=>{const ee=At.map(([Ge,lt])=>`<option value="${Ge}"${Ge===M?" selected":""}>${lt}</option>`).join(""),re=qt.map(Ge=>`<option value="${Ge}"${Ge===B?" selected":""}>${Ge}</option>`).join(""),ie=` data-gear-quantity="${Te(String(Xt))}"`,Ie=' data-gear-label="Pro Gaff Tape"',Ce=`${Te(String(Xt))}x Pro Gaff Tape <select id="gearListProGaffColor${C}">${ee}</select> <select id="gearListProGaffWidth${C}">${re}</select>`;return`<span class="gear-item" data-gear-name="Pro Gaff Tape"${ie}${Ie}${ct}><span class="gear-item-text">${Ce}</span><span class="gear-item-note" hidden></span></span>`}).join("");let uo="";if(Fr){const M=[["red","Red"],["blue","Blue"],["natural","Natural"],["green","Green"],["purple","Purple"],["orange","Orange"],["gray","Gray"],["yellow","Yellow"],["jaguar","Jaguar"],["killer bee","Killer Bee"],["green rabbit","Green Rabbit"],["black","Black"]].map(([ie,Ie])=>`<option value="${ie}"${ie===Br?" selected":""}>${Ie}</option>`).join(""),B=` data-gear-quantity="${Te(String(Fr))}"`,ee=' data-gear-label="Bluestar eye leather made of microfiber oval, large"',re=`${Te(String(Fr))}x Bluestar eye leather made of microfiber oval, large <select id="gearListEyeLeatherColor">${M}</select>`;uo=`<span class="gear-item" data-gear-name="Bluestar eye leather made of microfiber oval, large"${B}${ee}${ct}><span class="gear-item-text">${re}</span><span class="gear-item-note" hidden></span></span>`}F("Miscellaneous",Gt(et)),F("Consumables",[uo,Ne,Gt(pt)].filter(Boolean).join(""));let Kr=`<h2>${wr}</h2>`;_r&&(Kr+=_r);const Ye='<table class="gear-table">'+U.join("")+"</table>",mt={...e,cameraSelection:l.camera,monitorSelection:l.monitor,wirelessSelection:l.video,motorSelections:l.motors.slice(),controllerSelections:l.controllers.slice(),distanceSelection:l.distance},An=RH(Ye,mt);return Kr+="<h3>Gear List</h3>"+An,Kr}function hg(e={}){const t=e.forPersistence===!0||e.isForPersistence===!0,r=Gn(),o=r&&typeof r.__cineLastGearListHtml=="string"?r.__cineLastGearListHtml:"";if(!gearListOutput&&!projectRequirementsOutput)return o;const n=projectRequirementsOutput&&typeof projectRequirementsOutput.cloneNode!="function",a=gearListOutput&&typeof gearListOutput.cloneNode!="function";if(n||a)return o;let i="";if(projectRequirementsOutput){const p=projectRequirementsOutput.cloneNode(!0),g=p.querySelector("#editProjectBtn");g&&g.remove();const h=p.querySelector("h2");h&&h.remove(),i=p.innerHTML.trim()}let s="";if(gearListOutput){const p=gearListOutput.cloneNode(!0),g=typeof gearListOutput.querySelector=="function"?gearListOutput:null,h=p.querySelector("#gearListActions");h&&h.remove();const A=p.querySelector("#editProjectBtn");A&&A.remove(),["Director","Dop","Gaffer","Focus"].forEach(R=>{const G=p.querySelector(`#gearList${R}Monitor`);if(G&&G.options){const j=g?g.querySelector(`#gearList${R}Monitor`):null,$=j?j.value:G.value;Array.from(G.options).forEach(z=>{z.value===$?z.setAttribute("selected",""):z.removeAttribute("selected")})}}),["Director","Combo","Dop"].forEach(R=>{const G=p.querySelector(`#gearList${R}Monitor15`);if(G&&G.options){const j=g?g.querySelector(`#gearList${R}Monitor15`):null,$=j?j.value:G.value;Array.from(G.options).forEach(z=>{z.value===$?z.setAttribute("selected",""):z.removeAttribute("selected")})}});const m=p.querySelector("#gearListCage");if(m&&m.options){const R=g?g.querySelector("#gearListCage"):null,G=R?R.value:m.value;Array.from(m.options).forEach(j=>{j.value===G?j.setAttribute("selected",""):j.removeAttribute("selected")})}const y=p.querySelector("#gearListEasyrig");if(y&&y.options){const R=g?g.querySelector("#gearListEasyrig"):null,G=R?R.value:y.value;Array.from(y.options).forEach(j=>{j.value===G?j.setAttribute("selected",""):j.removeAttribute("selected")})}const S=p.querySelector("#gearListSliderBowl");if(S&&S.options){const R=g?g.querySelector("#gearListSliderBowl"):null,G=R?R.value:S.value;Array.from(S.options).forEach(j=>{j.value===G?j.setAttribute("selected",""):j.removeAttribute("selected")})}p.querySelectorAll("select[data-monitor-battery-key]").forEach(R=>{if(!R.id||!R.options)return;const G=g?g.querySelector(`#${R.id}`):null,j=G?G.value:R.value;Array.from(R.options).forEach($=>{$.value===j?$.setAttribute("selected",""):$.removeAttribute("selected")})});const I=p.querySelector("#gearListEyeLeatherColor");if(I&&I.options){const R=g?g.querySelector("#gearListEyeLeatherColor"):null,G=R?R.value:I.value;Array.from(I.options).forEach(j=>{j.value===G?j.setAttribute("selected",""):j.removeAttribute("selected")})}[1,2].forEach(R=>{const G=p.querySelector(`#gearListProGaffColor${R}`);if(G&&G.options){const $=g?g.querySelector(`#gearListProGaffColor${R}`):null,z=$?$.value:G.value;Array.from(G.options).forEach(te=>{te.value===z?te.setAttribute("selected",""):te.removeAttribute("selected")})}const j=p.querySelector(`#gearListProGaffWidth${R}`);if(j&&j.options){const $=g?g.querySelector(`#gearListProGaffWidth${R}`):null,z=$?$.value:j.value;Array.from(j.options).forEach(te=>{te.value===z?te.setAttribute("selected",""):te.removeAttribute("selected")})}}),p.querySelectorAll('input[type="checkbox"]').forEach(R=>{R.checked?R.setAttribute("checked",""):R.removeAttribute("checked")}),p.querySelectorAll("[data-gear-custom-input]").forEach(R=>{R&&typeof R.getAttribute=="function"&&R.setAttribute("value",R.value)}),t||dj(p);const L=p.querySelector(".gear-table");s=L?"<h3>Gear List</h3>"+L.outerHTML:""}if(!i&&!s)return o;const u=$c(),d=`${u?`<h2>${u}</h2>`:""}${i}${s}`.trim();return d&&r&&(r.__cineLastGearListHtml=d),d||o}function ok(){const e={},t=a=>{if(!(!a||!a.id))if(a.multiple){const i=a.selectedOptions&&typeof a.selectedOptions.length=="number"?Array.from(a.selectedOptions):Array.from(a.options||[]).filter(s=>s.selected);e[a.id]=i.map(s=>s.value)}else e[a.id]=a.value},r=(function(){if(gearListOutput&&typeof gearListOutput.querySelectorAll=="function")return gearListOutput;if(typeof document<"u"&&document){const i=document.getElementById("gearListOutput");if(i&&typeof i.querySelectorAll=="function")return i}return null})();r&&r.querySelectorAll("select[id]").forEach(a=>{t(a)});const o=typeof filterDetailsStorage<"u"?filterDetailsStorage:null;o&&typeof o.querySelectorAll=="function"&&o.querySelectorAll("select[id]").forEach(a=>{!a||!a.id||Object.prototype.hasOwnProperty.call(e,a.id)||t(a)});const n=uj();if(n&&Object.keys(n).length&&(e.__customItems=n),r){const a={};r.querySelectorAll(".gear-item[data-gear-name]").forEach(i=>{const s=qc(i)||i.getAttribute("data-gear-name");if(!s)return;const u={};let l=!1;const d=(p,g,h=!1)=>{const A=i.getAttribute(p);A!=null&&A!==""&&(u[g]=h?A==="true":A,l=!0)};d("data-gear-quantity","quantity"),d("data-gear-label","name"),d("data-gear-attributes","attributes"),d("data-gear-note","note"),d("data-rental-excluded","rentalExcluded",!0),d("data-gear-provider","providedBy"),d("data-gear-provider-label","providerLabel"),d("data-gear-extra","extra",!0),d("data-gear-extra-start","extraStart"),d("data-gear-extra-end","extraEnd"),d("data-gear-camera-link","cameraLink"),d("data-gear-camera-link-label","cameraLinkLabel"),l&&(a[s]=u)}),Object.keys(a).length>0&&(e.__gearItemOverrides=a)}return e}function nk(e){if(!e||typeof e!="object")return{};const t=o=>{if(Array.isArray(o))return o.map(n=>t(n));if(o&&typeof o=="object"){const n={};return Object.entries(o).forEach(([a,i])=>{n[a]=t(i)}),n}return o==null?"":typeof o=="string"?o:String(o)},r={};return Object.entries(e).forEach(([o,n])=>{!o||typeof o!="string"||(r[o]=t(n))}),r}function dj(e){if(!e)return;const t=e.ownerDocument||(typeof document<"u"?document:null);if(!t||(typeof e.isConnected=="boolean"?e.isConnected:typeof t.contains=="function"&&t.contains(e)))return;e.querySelectorAll(".gear-custom-section").forEach(n=>{const a=n.querySelector(".gear-custom-items"),i=n.parentElement;if(!a||!i){n.remove();return}n.querySelectorAll(".gear-rental-toggle").forEach(d=>d.remove());const u=Array.from(a.querySelectorAll(".gear-custom-item-preview")).map(d=>({preview:d,value:(d.textContent||"").replace(/\s+/g," ").trim()})).filter(d=>d.value);let l=n.previousElementSibling;(!l||!l.classList.contains("gear-standard-items"))&&(l=t.createElement("div"),l.className="gear-standard-items",i.insertBefore(l,n)),u.length&&u.forEach(({value:d,preview:p})=>{if(l.childNodes.length){const A=l.lastChild;A&&A.nodeType===1&&A.tagName==="BR"||l.appendChild(t.createElement("br"))}const g=t.createElement("span");g.className="gear-item",g.textContent=d,g.setAttribute("data-gear-name",d),g.setAttribute("data-gear-custom-output","true");const h=p.closest(".gear-custom-item");if(h){const A=h.getAttribute("data-rental-note");A&&g.setAttribute("data-rental-note",A),h.getAttribute("data-rental-excluded")==="true"&&(g.setAttribute("data-rental-excluded","true"),g.classList.add("gear-item-rental-excluded"))}l.appendChild(g)}),n.remove()}),e.querySelectorAll(".gear-custom-add-btn").forEach(n=>n.remove()),e.querySelectorAll(".gear-rental-toggle").forEach(n=>n.remove()),e.querySelectorAll(".gear-item-edit-btn").forEach(n=>n.remove()),e.querySelectorAll(".gear-custom-item-actions").forEach(n=>n.remove())}function Ro(e){if(e==null)return null;if(typeof e!="object")return e;if(typeof Ww=="function")try{return Ww(e)}catch(r){console.warn("Failed to clone project info for storage",r)}if(Array.isArray(e))return e.map(r=>Ro(r));const t={};return Object.keys(e).forEach(r=>{t[r]=Ro(e[r])}),t}function Sg(e){return e==null?!1:typeof e=="string"?e.trim().length>0:typeof e=="number"?!Number.isNaN(e):typeof e=="boolean"?e:Array.isArray(e)?e.some(t=>Sg(t)):typeof e=="object"?Object.values(e).some(t=>Sg(t)):!1}function ak(e,t){const r=Sg(e);if(!Sg(t))return Ro(r?e:t);if(!r)return Ro(t);if(Array.isArray(e)&&Array.isArray(t))return Ro(t.length?t:e);if(typeof e=="object"&&typeof t=="object"){const n=Ro(e);return Object.keys(t).forEach(a=>{n[a]=ak(n[a],t[a])}),n}return Ro(t)}function ik(e){if(!e)return"";const t=typeof Node>"u"?3:Node.TEXT_NODE,r=typeof Node>"u"?1:Node.ELEMENT_NODE;return e.nodeType===t?e.textContent||"":e.nodeType===r?(e.tagName?e.tagName.toLowerCase():"")==="br"?`
`:Array.from(e.childNodes||[]).map(ik).join(""):""}function fj(){if(!projectRequirementsOutput)return null;const e=projectRequirementsOutput&&typeof projectRequirementsOutput.querySelectorAll=="function"?Array.from(projectRequirementsOutput.querySelectorAll(".requirement-box")):[];if(!e.length)return null;const t={},r=texts[currentLang]?.projectFields||texts.en?.projectFields||{};return e.forEach(o=>{if(!o||typeof o.getAttribute!="function")return;const n=o.getAttribute("data-field");if(!n)return;const a=o.querySelector(".req-value");if(!a)return;const s=Array.from(a.childNodes||[]).map(ik).join("").replace(/\r\n?/g,`
`).split(`
`).map(l=>l.replace(/\s+/g," ").trim()).filter(l=>l);if(!s.length)return;const u=s.join(`
`);if(Object.prototype.hasOwnProperty.call(t,n)||(t[n]=u),n==="productionCompany"){let l=null;const d=Array.from(a.querySelectorAll(".req-sub-line"));if(d.length){const g=d.map(h=>{if(!h||typeof h.textContent!="string")return null;const A=h.textContent.replace(/\s+/g," ").trim();if(!A)return null;const y=(typeof h.getAttribute=="function"&&(h.getAttribute("data-fields")||h.getAttribute("data-field"))||"").split(/\s+/).map(S=>S.trim()).filter(S=>S);return{text:A,fields:y}}).filter(h=>h);g.length&&(l={lines:g})}const p=iN(u,r,l);p&&typeof p=="object"&&Object.entries(p).forEach(([g,h])=>{if(g==="productionCompany"){t.productionCompany=h;return}Object.prototype.hasOwnProperty.call(t,g)||(t[g]=h)})}}),Object.keys(t).length?t:null}function Oc(e){return typeof e!="string"?"":e.trim().toLowerCase()}let pi=null;function Wb(e){if(!pi)return;if(!e){pi=null;return}const t=Oc(e);(!t||pi.base===t)&&(pi=null)}function pj(e){if(!pi)return null;const t=Oc(e);return t&&pi.base===t?pi.resolved:null}function mj(e,t){const r=Oc(e),o=Oc(t);if(!r||!o){pi=null;return}pi={base:r,resolved:t,resolvedNormalized:o}}function sk(e){const t=typeof e=="string"?e.trim():"";if(console.log("DEBUG: resolveProjectStorageNameCollision ENTERED with:",t),!t)return{name:t,changed:!1};if(typeof loadProject!="function")return{name:t,changed:!1};let r;try{r=loadProject()}catch(g){console.warn("Unable to inspect existing projects while resolving name collision",g),r=null}if(!r||typeof r!="object")return{name:t,changed:!1};const o=new Set(Object.keys(r).map(g=>typeof g=="string"?g.trim().toLowerCase():"").filter(g=>g)),n=t.toLowerCase();if(!o.has(n))return{name:t,changed:!1};let a=t,i=1;const s=t.match(/^(.*)\s+\((\d+)\)$/);if(s){a=s[1];const g=parseInt(s[2],10);isNaN(g)||(i=g)}let u=i+1,l=`${a} (${u})`,d=l.trim().toLowerCase();console.log("DEBUG: resolveProjectStorageNameCollision starting loop for:",l);let p=0;for(;o.has(d);){if(p++,console.log("DEBUG: resolveProjectStorageNameCollision iteration:",p,"Candidate:",d),p>100){console.error("DEBUG: resolveProjectStorageNameCollision INFINITE LOOP DETECTED for:",a);const g=()=>globalThis.crypto&&typeof globalThis.crypto.randomUUID=="function"?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;do{const h=g();l=`${a} (${h})`,d=l.trim().toLowerCase(),p++}while(o.has(d));break}u+=1,l=`${a} (${u})`,d=l.trim().toLowerCase()}for(;o.has(d);){const g=globalThis.crypto&&typeof globalThis.crypto.randomUUID=="function"?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`;l=`${a} (${g})`,d=l.trim().toLowerCase()}return console.log("DEBUG: resolveProjectStorageNameCollision returning:",l),{name:l,changed:!0}}function lk(e){if(typeof loadProject!="function")return!1;const t=Oc(e);if(!t)return!1;let r=null;try{r=loadProject()}catch(o){return console.warn("Unable to inspect project names while deferring collision resolution",o),!1}return!r||typeof r!="object"?!1:Object.keys(r).some(o=>Oc(o)===t)}const EL=new Set;let Kb=null;function Go(){Kb&&clearTimeout(Kb),Kb=setTimeout(()=>{gj()},300)}let Yb=!1;function gj(){if(!Yb&&!factoryResetInProgress&&!(typeof restoringSession<"u"&&restoringSession)){Yb=!0;try{const e=hg({forPersistence:!0}),t=typeof e=="string"?e.trim():"",r=!!t,o=projectForm?Af():{};o.sliderBowl=Rc("getSliderBowlValue"),o.easyrig=Rc("getEasyrigValue");const n=currentProjectInfo&&typeof currentProjectInfo=="object"?currentProjectInfo:null,a=!!(projectRequirementsOutput&&typeof projectRequirementsOutput.querySelector=="function"&&projectRequirementsOutput.querySelector(".requirement-box"));let i=Pv(o);const s=yG(),u=ok(),l=nk(u),d=Object.keys(l).length>0;let p=typeof getSetupNameState=="function"?getSetupNameState():null;if(typeof getProjectAutoSaveOverrides=="function"){const xe=getProjectAutoSaveOverrides();if(xe&&typeof xe=="object"&&xe.setupNameState&&typeof xe.setupNameState=="object"){const Ze=q=>typeof q=="string"?q.trim():"",Ve=xe.setupNameState,Dt=Ze(Ve.typedName),We=Ze(Ve.selectedName),ft=Ze(typeof Ve.storageKey=="string"?Ve.storageKey:We||Dt),D=typeof Ve.renameInProgress=="boolean"?Ve.renameInProgress:!!(We&&Dt&&Dt!==We);p={typedName:Dt,selectedName:We,storageKey:ft,renameInProgress:D,typedNameHasTrailingWhitespace:!!(Dt&&Ve&&typeof Ve.typedNameHasTrailingWhitespace=="boolean"&&Ve.typedNameHasTrailingWhitespace)}}}const g=xe=>typeof xe!="string"?"":xe.trim(),h=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",A=!!(h&&h.trim()&&/\s$/.test(h));let m=p?p.selectedName:g(setupSelect&&typeof setupSelect.value=="string"?setupSelect.value:""),y=p?p.typedName:g(setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:""),S=p?p.storageKey:m||y;const E=p?p.renameInProgress:!!(m&&y&&m!==y),I=p&&typeof p=="object"?!!(p.typedNameHasTrailingWhitespace&&p.typedName):A;let L=E&&m||S;if(!!(I&&!E&&!m&&typeof L=="string"&&L&&lk(L))){Wb(L);return}if(!E&&!m&&typeof L=="string"&&L){const xe=pj(L);if(xe&&xe!==L)L=xe;else if(!xe){let Ze=!1;EL.has(L)&&(Ze=!0);const Ve=Ze?{changed:!1,name:L}:sk(L);Ve.changed&&Ve.name&&Ve.name!==L?(mj(L,Ve.name),L=Ve.name):Ve.changed||Wb(L)}}else Wb();if(!i&&a){if(n&&Object.keys(n).length)i=n;else if(typeof loadProject=="function"){const xe=typeof L=="string"?L:typeof S=="string"&&S?S:typeof m=="string"?m:"";if(typeof xe=="string"){const Ze=loadProject(xe);Ze&&Ze.projectInfo&&Object.keys(Ze.projectInfo).length&&(i=Ro(Ze.projectInfo))}}if(!i){const xe=fj();xe&&(i=Pv(xe)||xe)}}currentProjectInfo=i;const G=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(currentProjectInfo,{projectNameOverride:E?m||S:void 0}):currentProjectInfo,j=Ro(G),$=j?stableStringify(j):"",z=j?Ro(j):null,te=getProjectScopedAutoGearRules(),oe=te&&te.length?Ro(te):null,k=oe?Ro(oe):null;let Z=null,ue=null;if(typeof getDiagramManualPositions=="function"){const xe=getDiagramManualPositions();xe&&Object.keys(xe).length&&(Z=Ro(xe),ue=Ro(Z))}if(typeof saveProject=="function"&&typeof L=="string"){typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(L);const xe={projectInfo:j,gearListAndProjectRequirementsGenerated:r};s&&(xe.powerSelection=s),d&&(xe.gearSelectors=l),Z&&(xe.diagramPositions=Z),oe&&oe.length&&(xe.autoGearRules=oe),saveProject(L,xe,{skipOverwriteBackup:!0}),EL.add(L)}const H=m||L;if(!H)return;const Y=Md(),N=Y[H];if(!N&&!e&&!currentProjectInfo&&!(oe&&oe.length)&&!Z)return;const ae=N||{};let de=!1;if(ae.gearListAndProjectRequirementsGenerated!==r&&(ae.gearListAndProjectRequirementsGenerated=r,de=!0),ae.gearList!==t&&(ae.gearList=t,de=!0),$){const xe=ae.projectInfo;(xe?stableStringify(xe):"")!==$&&(ae.projectInfo=z,de=!0)}else j===null?ae.projectInfo!==null&&(ae.projectInfo=null,de=!0):Object.prototype.hasOwnProperty.call(ae,"projectInfo")&&(delete ae.projectInfo,de=!0);if(ue){const xe=ae.diagramPositions?stableStringify(ae.diagramPositions):"",Ze=stableStringify(ue);xe!==Ze&&(ae.diagramPositions=ue,de=!0)}else Object.prototype.hasOwnProperty.call(ae,"diagramPositions")&&(delete ae.diagramPositions,de=!0);const Q=ae.autoGearRules,ne=Q&&Q.length?stableStringify(Q):"",V=oe&&oe.length?stableStringify(oe):"";V?ne!==V&&(ae.autoGearRules=k,de=!0):Object.prototype.hasOwnProperty.call(ae,"autoGearRules")&&(delete ae.autoGearRules,de=!0);const fe=ae.gearSelectors,J=fe?stableStringify(fe):"",Ae=d?stableStringify(l):"";Ae?J!==Ae&&(ae.gearSelectors=l,de=!0):Object.prototype.hasOwnProperty.call(ae,"gearSelectors")&&(delete ae.gearSelectors,de=!0);const Le=ae.powerSelection?stableStringify(ae.powerSelection):"",_e=s?stableStringify(s):"";_e?Le!==_e&&(ae.powerSelection=s,de=!0):Object.prototype.hasOwnProperty.call(ae,"powerSelection")&&(delete ae.powerSelection,de=!0);const Je=m||L;return Je&&(N?de&&(Y[Je]=ae,storeSetups(Y)):(Y[Je]=ae,storeSetups(Y))),de}finally{Yb=!1}}}function vg(){const e=(()=>{const n=typeof getLanguageTexts=="function"?getLanguageTexts(currentLang):null,a=typeof getLanguageTexts=="function"?getLanguageTexts("en"):null;return i=>{const s=n&&typeof n[i]=="string"?n[i]:null;return s||(a&&typeof a[i]=="string"?a[i]:null)||""}})(),t=typeof getCurrentProjectStorageKey=="function"?getCurrentProjectStorageKey():"",r=typeof t=="string"?t.trim():"";if(!r)return typeof window<"u"&&typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:e("alertNoSetupSelectedTitle"),message:e("alertNoSetupSelected")}):alert(e("alertNoSetupSelected")),!1;const o=()=>{const n=ensureAutoBackupBeforeDeletion("delete gear list");if(!n)return!1;typeof deleteProject=="function"?deleteProject(r):typeof saveProject=="function"&&saveProject(r,{projectInfo:null,gearListAndProjectRequirementsGenerated:!1},{skipOverwriteBackup:!0});const a=Md();if(a&&typeof a=="object"){const i=a[r];if(i&&typeof i=="object"){let s=!1;Object.prototype.hasOwnProperty.call(i,"gearList")&&(delete i.gearList,s=!0),["projectInfo","autoGearRules","diagramPositions","powerSelection","gearSelectors","gearListAndProjectRequirementsGenerated"].forEach(u=>{Object.prototype.hasOwnProperty.call(i,u)&&(delete i[u],s=!0)}),s&&storeSetups(a)}}if(gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList.add("hidden"),WE()),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList.add("hidden")),typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml=""),currentProjectInfo=null,projectForm&&Uy({}),storeSession({setupName:setupNameInput?setupNameInput.value:"",setupSelect:setupSelect?setupSelect.value:"",camera:cameraSelect?cameraSelect.value:"",monitor:monitorSelect?monitorSelect.value:"",video:videoSelect?videoSelect.value:"",cage:cageSelect?cageSelect.value:"",motors:motorSelects.map(i=>i?i.value:""),controllers:controllerSelects.map(i=>i?i.value:""),distance:distanceSelect?distanceSelect.value:"",batteryPlate:normalizeBatteryPlateValue(batteryPlateSelect?batteryPlateSelect.value:"",batterySelect?batterySelect.value:""),battery:batterySelect?batterySelect.value:"",batteryHotswap:hotswapSelect?hotswapSelect.value:"",sliderBowl:Rc("getSliderBowlValue"),easyrig:Rc("getEasyrigValue"),projectInfo:null}),typeof autoSaveCurrentSetup=="function"&&(autoSaveCurrentSetup(),r)){const i=Md(),s=i&&i[r];if(s&&typeof s=="object"){let u=!1;Object.prototype.hasOwnProperty.call(s,"gearList")&&(delete s.gearList,u=!0),["projectInfo","gearListAndProjectRequirementsGenerated","gearSelectors"].forEach(l=>{Object.prototype.hasOwnProperty.call(s,l)&&(delete s[l],u=!0)}),u&&storeSetups(i)}}if(currentProjectInfo=null,updateGearListButtonVisibility(),typeof document<"u"&&typeof document.dispatchEvent=="function"){const i={projectName:r,backupName:n,source:"deleteCurrentGearList"};try{document.dispatchEvent(new CustomEvent("gearlist:deleted",{detail:i}))}catch(s){if(typeof document.createEvent=="function"){const u=document.createEvent("CustomEvent");u.initCustomEvent("gearlist:deleted",!1,!1,i),document.dispatchEvent(u)}else console.warn("Unable to dispatch gearlist:deleted event",s)}}return!0};if(typeof window.cineShowConfirmDialog=="function")window.cineShowConfirmDialog({title:e("deleteGearListDialogTitle"),message:e("confirmDeleteGearList"),confirmLabel:e("deleteGearListConfirmLabel"),danger:!0,onConfirm:()=>{setTimeout(()=>{window.cineShowConfirmDialog({title:e("deleteGearListConfirmAgainTitle"),message:e("confirmDeleteGearListAgain"),confirmLabel:e("deleteGearListConfirmAgainLabel"),danger:!0,onConfirm:()=>o()})},150)}});else return!confirm(e("confirmDeleteGearList"))||!confirm(e("confirmDeleteGearListAgain"))?!1:o()}const ck="show-auto-gear-highlight",yj="auto-gear-highlight-context",Vv='ULCS Arm mit 3/8" und 1/4" double',bj="autoGearMonitorRiggingItem",hj="autoGearMonitorRiggingHighlight",Qb="",Sj="Highlight automatic gear",vj="Toggle a temporary color overlay for gear added by automatic rules. Useful while debugging gear rule behavior.",Aj="On",Ej="Off",Cj="Rule: %s",wj="Automatic rule",ou=Object.freeze([{bg:"rgba(255, 210, 64, 0.35)",border:"rgba(255, 181, 0, 0.7)"},{bg:"rgba(88, 200, 255, 0.32)",border:"rgba(0, 146, 214, 0.65)"},{bg:"rgba(146, 232, 129, 0.32)",border:"rgba(70, 180, 80, 0.65)"},{bg:"rgba(255, 186, 222, 0.32)",border:"rgba(230, 112, 190, 0.65)"},{bg:"rgba(255, 214, 153, 0.32)",border:"rgba(230, 156, 64, 0.65)"},{bg:"rgba(201, 186, 255, 0.32)",border:"rgba(146, 118, 230, 0.65)"},{bg:"rgba(152, 219, 217, 0.32)",border:"rgba(72, 182, 178, 0.65)"}]);function Lj(e,t){if(e&&typeof e=="object"){const r=typeof e.id=="string"?e.id.trim():"";if(r)return`id:${r.toLowerCase()}`;const o=jE(e);if(o)return`label:${o.toLowerCase()}`}if(t&&typeof t=="object"){const r=typeof t.autoGearRuleId=="string"?t.autoGearRuleId.trim():"";if(r)return`id:${r.toLowerCase()}`;const o=typeof t.autoGearRuleLabel=="string"?t.autoGearRuleLabel.trim():"";if(o)return`label:${o.toLowerCase()}`}return""}function Rj(e,t){if(!ou.length)return null;const r=Lj(e,t);if(!r)return{...ou[0],index:0};let o=0;for(let i=0;i<r.length;i+=1)o=o*31+r.charCodeAt(i)&2147483647;const n=Math.abs(o)%ou.length;return{...ou[n]||ou[0],index:n}}function Ky(e,t){if(!e||!e.style)return;const r=e.dataset||{},o=Rj(t,r);if(!o){e.style.removeProperty("--auto-gear-rule-bg"),e.style.removeProperty("--auto-gear-rule-border"),e.style.removeProperty("--auto-gear-rule-text"),r&&Object.prototype.hasOwnProperty.call(r,"autoGearRuleColor")&&delete r.autoGearRuleColor;return}const{bg:n,border:a,text:i,index:s}=o;if(n?e.style.setProperty("--auto-gear-rule-bg",n):e.style.removeProperty("--auto-gear-rule-bg"),a?e.style.setProperty("--auto-gear-rule-border",a):e.style.removeProperty("--auto-gear-rule-border"),i?e.style.setProperty("--auto-gear-rule-text",i):e.style.removeProperty("--auto-gear-rule-text"),r)try{e.dataset.autoGearRuleColor=String(s)}catch(u){console.warn("Failed to annotate automatic gear color index",u)}}function Ij(){const e=texts[currentLang]||texts.en||{},t=e.autoGearRuleBadgeNamed||texts.en?.autoGearRuleBadgeNamed||Cj,r=e.autoGearRuleBadgeUnnamed||texts.en?.autoGearRuleBadgeUnnamed||wj;return{named:t,unnamed:r}}function Tj(e,t){const{named:r,unnamed:o}=Ij(),n=typeof e=="string"?e.trim():"";if(n)return r.replace("%s",n);const a=typeof t=="string"?t.trim():"";return a?r.replace("%s",a):o}function Yy(e){if(!e||!e.classList||!e.classList.contains("auto-gear-item"))return;const t=xd(e);$y(e,t),Ky(e);const r=t.map(a=>Tj(a.label,a.id)).filter(Boolean),o=Array.from(e.querySelectorAll(".auto-gear-rule-badge"));if(!r.length){o.forEach(i=>i.remove()),e.dataset&&Object.prototype.hasOwnProperty.call(e.dataset,"autoGearRuleBadge")&&delete e.dataset.autoGearRuleBadge;const a=mg(t);a?e.title=a:e.removeAttribute("title");return}if(r.forEach((a,i)=>{let s=o[i];s||(s=document.createElement("span"),s.className="auto-gear-rule-badge",e.appendChild(s)),s.textContent=a}),o.length>r.length&&o.slice(r.length).forEach(a=>a.remove()),e.dataset)try{e.dataset.autoGearRuleBadge=JSON.stringify(r)}catch(a){console.warn("Failed to serialize automatic gear rule badge labels",a)}const n=mg(t);n?e.title=n:e.removeAttribute("title")}function uk(e){const t=e||gearListOutput;if(!t||typeof t.querySelectorAll!="function")return;t.querySelectorAll(".auto-gear-item").forEach(o=>Yy(o))}function Oj(){const e=typeof getLocalizedText=="function"?getLocalizedText("autoGearHighlightToggle"):"";return typeof e=="string"&&e.trim()?e.trim():Sj}function Gj(){const e=typeof getLocalizedText=="function"?getLocalizedText("autoGearHighlightToggleHelp"):"";return typeof e=="string"&&e.trim()?e.trim():vj}function dk(){return!!(gearListOutput&&gearListOutput.classList&&gearListOutput.classList.contains(ck))}function kj(){return!gearListOutput||!gearListOutput.classList?!1:!gearListOutput.classList.contains("hidden")}function Bj(e){if(!e)return null;e.classList.add("auto-gear-highlight-toggle","gear-list-action-btn");const t="auto-gear-highlight-icon";let r=e.querySelector(`.${t}`);r?(r.classList.contains("btn-icon")||r.classList.add("btn-icon"),r.classList.contains("icon-glyph")||r.classList.add("icon-glyph"),r.classList.contains(t)||r.classList.add(t),r.setAttribute("aria-hidden","true"),r.setAttribute("data-icon-font","uicons"),r.textContent!==Qb&&(r.textContent=Qb)):(r=document.createElement("span"),r.className=`btn-icon icon-glyph ${t}`,r.setAttribute("aria-hidden","true"),r.setAttribute("data-icon-font","uicons"),r.textContent=Qb,e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r));let o=e.querySelector(".auto-gear-highlight-label");o||(o=document.createElement("span"),o.className="auto-gear-highlight-label",e.appendChild(o));let n=e.querySelector(".auto-gear-highlight-state");return n||(n=document.createElement("span"),n.className="auto-gear-highlight-state",typeof o.after=="function"?o.after(n):e.appendChild(n)),n&&(n.setAttribute("aria-live","polite"),n.setAttribute("aria-atomic","true")),Array.from(e.childNodes||[]).filter(i=>i&&i.nodeType===3&&i.textContent&&i.textContent.trim().length).forEach(i=>{e.removeChild(i)}),n&&typeof o<"u"&&o&&n.previousElementSibling!==o&&typeof o.after=="function"&&o.after(n),{label:o,state:n}}function Pj(e){const t=e?"autoGearHighlightToggleStateOn":"autoGearHighlightToggleStateOff",r=e?Aj:Ej,o=typeof getLocalizedText=="function"?getLocalizedText(t):"";return typeof o=="string"&&o.trim()?o.trim():r}function xj(e){if(typeof document>"u")return;const t=!!e;[document.documentElement,document.body,document.getElementById("autoGearDraftImpact")].forEach(o=>{o&&o.classList&&o.classList.toggle(yj,t)})}function Mj(e){const t=!!e;gearListOutput&&gearListOutput.classList&&gearListOutput.classList.toggle(ck,t),WE()}function WE(){const e=document.getElementById("autoGearHighlightToggle");if(!e)return;const t=Oj(),r=Gj(),o=Bj(e),n=o&&o.label,a=o&&o.state;n?n.textContent=t:typeof e.textContent=="string"?e.textContent=t:e.innerHTML=Te(t),e.setAttribute("title",r),e.setAttribute("data-help",r),e.setAttribute("aria-label",r);const i=dk();xj(i);const s=Pj(i);a&&(a.textContent=s,a.setAttribute("data-state",i?"on":"off")),e.setAttribute("data-state",i?"on":"off"),e.setAttribute("data-state-label",s),e.setAttribute("aria-pressed",i?"true":"false"),e.classList.toggle("is-active",i);const u=kj();e.disabled=!u,u?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true"),uk(gearListOutput)}function Dj(){if(!gearListOutput)return{items:{},customItems:[]};const e={items:{},customItems:[]};try{gearListOutput.querySelectorAll(".gear-custom-item").forEach(o=>{const n=o.getAttribute("data-gear-custom-entry"),a=o.closest(".gear-custom-section"),i=a?a.getAttribute("data-gear-custom-category"):"";if(typeof Wn=="function"){const s=Wn(o);e.customItems.push({categoryKey:n,categoryLabel:i,data:s})}}),gearListOutput.querySelectorAll(".gear-item:not(.gear-custom-item)").forEach(o=>{if(typeof Wn=="function"&&typeof $v=="function"){const n=Wn(o),a=$v(o),i=a.name;if(!i)return;(n.quantity!==a.quantity||n.name!==a.name||n.attributes!==a.attributes||n.note||n.rentalExcluded||n.providedBy&&n.providedBy!==(typeof fg=="function"?fg(n.name):"")||n.cameraLink&&n.cameraLink!=="A"&&!sl(o))&&(e.items[i]=n)}})}catch(t){typeof console<"u"&&console.warn&&console.warn("Failed to collect current gear list modifications",t)}return e}function _j(e){if(!(!gearListOutput||!e))try{Array.isArray(e.customItems)&&e.customItems.forEach(t=>{typeof bg=="function"&&bg(t.categoryKey,t.categoryLabel,t.data,{skipPersist:!0,skipEditDialog:!0,skipFocus:!0})}),e.items&&Object.keys(e.items).length&&gearListOutput.querySelectorAll(".gear-item:not(.gear-custom-item)").forEach(r=>{const o=typeof Wn=="function"?Wn(r):null,n=o?o.name:null;if(n&&e.items[n]){const a=e.items[n];typeof Tc=="function"&&Tc(r,a,{skipPreview:!1})}})}catch(t){typeof console<"u"&&console.warn&&console.warn("Failed to apply gear list modifications",t)}}function Fj(){if(!gearListOutput)return;let e=document.getElementById("gearListActions");e||(e=document.createElement("div"),e.id="gearListActions",gearListOutput.appendChild(e));const t=e.querySelector("#deleteGearListBtn");t&&(t.removeEventListener("click",vg),t.remove());let r=document.getElementById("gearListAutosaveNote");r?e.contains(r)||e.appendChild(r):(r=document.createElement("p"),r.id="gearListAutosaveNote",r.className="gear-list-autosave-note",e.appendChild(r));const o=texts[currentLang]&&texts[currentLang].gearListAutosaveNote||"",n=typeof o=="string"?o.trim():"";n.length>0?(r.hidden=!1,r.removeAttribute("hidden"),r.textContent=n,r.setAttribute("title",n),r.setAttribute("data-help",n)):(r.textContent="",r.setAttribute("title",""),r.setAttribute("data-help",""),r.hidden=!0);const i=texts[currentLang]&&texts[currentLang].deleteGearListBtn||texts.en&&texts.en.deleteGearListBtn||"Delete Gear List",s=texts[currentLang]&&(texts[currentLang].deleteGearListBtnHelp||texts[currentLang].deleteGearListBtn)||texts.en&&(texts.en.deleteGearListBtnHelp||texts.en.deleteGearListBtn)||i,u=document.createElement("button");if(u.id="deleteGearListBtn",u.type="button",u.className="gear-list-action-btn danger",typeof pn=="function"&&typeof ICON_GLYPHS=="object")pn(u,i,ICON_GLYPHS.trash);else{const p=typeof iconMarkup=="function"&&typeof ICON_GLYPHS=="object"?iconMarkup(ICON_GLYPHS.trash,"btn-icon"):"";u.innerHTML=`${p}${Te(i)}`}u.setAttribute("title",s),u.setAttribute("data-help",s),u.setAttribute("aria-label",s),u.setAttribute("data-feature-search","true"),u.setAttribute("data-feature-search-keywords","delete remove clear gear list project"),u.addEventListener("click",vg),!gearListOutput||gearListOutput.classList.contains("hidden")||gearListOutput.innerHTML.trim()===""?(u.hidden=!0,u.setAttribute("hidden","")):(u.hidden=!1,u.removeAttribute("hidden")),r&&r.parentElement===e?e.insertBefore(u,r):e.appendChild(u);const d=document.getElementById("autoGearHighlightToggle");d&&!d.dataset.gearListHighlightBound&&(d.addEventListener("click",()=>{const p=!dk();Mj(p),typeof saveCurrentSession=="function"&&saveCurrentSession({skipGearList:!0})}),d.dataset.gearListHighlightBound="true"),WE(),uk(e.closest("#gearListOutput")||gearListOutput),gearListOutput._filterListenerBound||(gearListOutput.addEventListener("change",p=>{const g=p.target;g&&g.matches("select")&&adjustGearListSelectWidth(g);let h=!1;if(g.matches('.filter-values-container input[type="checkbox"]')){const A=g.closest(".filter-values-container"),m=A&&A.getAttribute("data-storage-values"),y=A&&A.querySelector("select");if(g.checked?g.setAttribute("checked",""):g.removeAttribute("checked"),m)syncGearListFilterValue(m,g.value,g.checked);else if(y&&y.options){const S=Array.from(y.options).find(E=>E.value===g.value);S&&(S.selected=g.checked),y.dispatchEvent(new Event("change"))}h=!0}else if(g.matches("select[data-storage-id]")){const A=g.getAttribute("data-storage-id");A&&syncGearListFilterSize(A,g.value),h=!0}else(g.id&&g.id.startsWith("filter-size-")||g.id&&g.id.startsWith("filter-values-")||g.matches("input, select, textarea")&&!g.closest("#gearListActions"))&&(h=!0);h&&(Go(),saveCurrentSession(),checkSetupChanged())}),gearListOutput._filterListenerBound=!0),gearListOutput._inputListenerBound||(gearListOutput.addEventListener("input",p=>{const g=p.target;g&&(g.closest("#gearListActions")||(g.closest(".gear-custom-item")&&NG(g.closest(".gear-custom-item")),g.matches("input, textarea")&&(Go(),saveCurrentSession(),checkSetupChanged())))}),gearListOutput._inputListenerBound=!0),gearListOutput._customClickListenerBound||(gearListOutput.addEventListener("click",p=>{const g=p.target&&p.target.closest("[data-gear-edit]");if(g){p.preventDefault();const y=g.closest(".gear-item, .gear-custom-item");y&&ek(y,{allowRentalToggle:!0});return}const h=p.target&&p.target.closest(".gear-rental-toggle");if(h){p.preventDefault();const y=h.closest(".gear-item, .gear-custom-item");if(!y)return;const S=h.getAttribute("aria-pressed")!=="true";Ef(y,S),y.classList&&y.classList.contains("gear-custom-item")?Wy():(typeof Go=="function"&&Go(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged());return}const A=p.target&&p.target.closest("[data-gear-custom-add]");if(A){p.preventDefault(),lj(A);return}const m=p.target&&p.target.closest("[data-gear-custom-remove]");m&&(p.preventDefault(),cj(m))}),gearListOutput._customClickListenerBound=!0)}let CL=!1;if(typeof document<"u"&&typeof document.addEventListener=="function"&&!CL){const e=()=>{try{vg()}catch(t){console.warn("Failed to handle gear list deletion request",t)}};document.addEventListener("gearlist:delete-requested",e),CL=!0}function Nj(){const e=typeof Ei=="function"?Ei("category_cages"):"";return(typeof e=="string"?e.trim():"")||"Camera Cage"}function wL(e){if(!e)return;const t=e.closest(".gear-item");if(!t)return;const r=e.options&&e.selectedIndex>=0?e.options[e.selectedIndex]:null,o=r&&typeof r.text=="string"?r.text.trim():r&&r.textContent?r.textContent.trim():"",n=Nj();t.setAttribute("data-gear-quantity","1"),t.setAttribute("data-gear-label",n),t.setAttribute("data-gear-name",n),o?t.setAttribute("data-gear-attributes",o):t.removeAttribute("data-gear-attributes")}function KE(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListCage");e&&(e.addEventListener("change",t=>{typeof restoringSession<"u"&&restoringSession||(cageSelect&&(cageSelect.value=t.target.value,cageSelect.dispatchEvent(new Event("change"))),wL(e),Xn(),Go())}),wL(e))}function YE(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListEasyrig");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Xn(),Go(),saveCurrentSession(),checkSetupChanged())})}function QE(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListSliderBowl");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Xn(),Go(),saveCurrentSession(),checkSetupChanged())})}function XE(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListEyeLeatherColor");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Xn(),Go())})}function ZE(){gearListOutput&&[1,2].forEach(e=>{const t=gearListOutput.querySelector(`#gearListProGaffColor${e}`),r=gearListOutput.querySelector(`#gearListProGaffWidth${e}`);[t,r].forEach(o=>{o&&o.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Xn(),Go())})})})}function LL(e){if(e==null||e==="")return"";if(typeof e=="number"&&Number.isFinite(e))return String(e);const t=parseFloat(String(e));return Number.isFinite(t)?String(t):""}function RL(e,t={}){if(!e)return;const r=e.closest(".gear-item");if(!r)return;const o=t.label||r.getAttribute("data-gear-label")||"";o&&r.setAttribute("data-gear-label",o);const n=[];t.size&&n.push(`${t.size}"`),t.name&&n.push(Ar(t.name)),t.suffix&&n.push(t.suffix);const a=n.filter(Boolean).join(" - ");if(a?r.setAttribute("data-gear-attributes",a):r.removeAttribute("data-gear-attributes"),o){const i=a?`${o} (${a})`:o;r.setAttribute("data-gear-name",i)}}function JE(){if(!gearListOutput)return;const e="incl. Directors cage, shoulder strap, sunhood, rigging for teradeks",t="incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)";["Director","Dop","Gaffer","Focus"].forEach(r=>{const o=gearListOutput.querySelector(`#gearList${r}Monitor`);o&&o.addEventListener("change",()=>{if(typeof restoringSession<"u"&&restoringSession)return;const n=devices&&devices.monitors&&devices.monitors[o.value],a=gearListOutput.querySelector(`#monitorSize${r}`),i=LL(n?.screenSizeInches);a&&(a.textContent=`(${i}")`);const u=r==="Focus"?"Focus Monitor":`${r==="Dop"?"DoP":r} Handheld Monitor`;RL(o,{label:u,name:o.value||"",size:i,suffix:e}),o.dataset.autoGearManual="true",Xn(),Go(),saveCurrentSession(),checkSetupChanged()})}),["Director","Combo","Dop"].forEach(r=>{const o=gearListOutput.querySelector(`#gearList${r}Monitor15`);o&&o.addEventListener("change",()=>{if(typeof restoringSession<"u"&&restoringSession)return;const n=devices&&devices.directorMonitors&&devices.directorMonitors[o.value],a=gearListOutput.querySelector(`#monitorSize${r}15`),i=LL(n?.screenSizeInches);a&&(a.textContent=`(${i}")`),RL(o,{label:`${r==="Dop"?"DoP":r} Monitor`,name:o.value||"",size:i,suffix:t}),o.dataset.autoGearManual="true",Xn(),Go(),saveCurrentSession(),checkSetupChanged()})})}typeof document<"u"&&(document.addEventListener("gearlist:add-extra-gear",()=>{try{rk()}catch(e){console.warn("Failed to add extra gear item from request",e)}}),document.addEventListener("gear-provider-data-changed",()=>{nL(),vL()}),document.addEventListener("own-gear-data-changed",()=>{fi=null,nL(),vL(),ij()}),document.addEventListener("camera-selection-changed",()=>{AL(),yL()}),document.addEventListener("camera-colors-changed",()=>{gm=null,yL(),AL()}));typeof globalThis<"u"&&(globalThis.saveCurrentGearList=Go,globalThis.doesProjectNameExist=lk,globalThis.resolveProjectStorageNameCollision=sk,globalThis.collectProjectFormData=Af,globalThis.populateProjectForm=Uy);console.log("app-setups.js: Execution complete");function Md(){return{}}typeof globalThis<"u"&&(globalThis.getSetups=Md,globalThis.bindGearListCageListener=KE,globalThis.bindGearListEasyrigListener=YE,globalThis.bindGearListSliderBowlListener=QE,globalThis.bindGearListEyeLeatherListener=XE,globalThis.bindGearListProGaffTapeListener=ZE,globalThis.bindGearListDirectorMonitorListener=JE);window.getSetups=Md;window.normalizeBatteryPlateValue=normalizeBatteryPlateValue;window.bindGearListCageListener=KE;window.bindGearListEasyrigListener=YE;window.bindGearListSliderBowlListener=QE;window.bindGearListEyeLeatherListener=XE;window.bindGearListProGaffTapeListener=ZE;window.bindGearListDirectorMonitorListener=JE;typeof window<"u"&&(window.deriveProjectInfo=Pv,window.generateConnectorSummary=iG,window.addArriKNumber=nG,window.suggestArriFizCables=aG,window.suggestChargerCounts=oG,window.safeGetCurrentProjectName=$c);function Hj(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const yt=Hj();function jj(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const Qn=jj(yt),IL=Qn&&typeof Qn.freezeDeep=="function"?Qn.freezeDeep:function(t){if(!t||typeof t=="function"||typeof t!="object"&&typeof t!="function")return t;const r=new WeakSet;function o(n){if(!n||typeof n!="object"&&typeof n!="function")return n;const a=typeof n=="function";if(r.has(n))return n;if(r.add(n),a){try{Object.freeze(n)}catch{}return n}try{const i=Object.getOwnPropertyNames(n);for(let s=0;s<i.length;s+=1){const u=i[s];let l;try{l=n[u]}catch(d){l=void 0}!l||typeof l=="function"||typeof l!="object"&&typeof l!="function"||o(l)}Object.freeze(n)}catch{}return n}return o(t)},zj=Qn&&typeof Qn.exposeGlobal=="function"?function(t,r,o){return Qn.exposeGlobal(t,r,yt,o||{})}:function(t,r){try{return yt[t]=r,!0}catch{return!1}},Uj=Qn&&typeof Qn.getModuleRegistry=="function"?Qn.getModuleRegistry(yt):null,$j=Qn&&typeof Qn.registerOrQueueModule=="function"?function(t,r,o,n){return Qn.registerOrQueueModule(t,r,o,n,yt,Uj)}:function(){return!1},Dd="auto-backup-",_d="auto-backup-before-delete-",ca=["cameraPowerPlanner_","cinePowerPlanner_"],qj=Object.freeze({autoGearRules:ca.map(e=>`${e}autoGearRules`),autoGearBackups:ca.map(e=>`${e}autoGearBackups`),autoGearPresets:ca.map(e=>`${e}autoGearPresets`),autoGearMonitorDefaults:ca.map(e=>`${e}autoGearMonitorDefaults`),autoGearActivePresetId:ca.map(e=>`${e}autoGearActivePreset`),autoGearAutoPresetId:ca.map(e=>`${e}autoGearAutoPreset`),autoGearBackupRetention:ca.map(e=>`${e}autoGearBackupRetention`),autoGearShowBackups:ca.map(e=>`${e}autoGearShowBackups`)});function Vj(){return yt&&yt.cineAutoGearPersistence?yt.cineAutoGearPersistence:yt&&yt.cineModules&&typeof yt.cineModules.get=="function"&&yt.cineModules.get("cineAutoGearPersistence")||null}function Wj(){const e=Vj();if(!e)return null;const t=typeof e.getCacheSnapshot=="function"?e.getCacheSnapshot():null,r=(o,n,a)=>{if(t&&Object.prototype.hasOwnProperty.call(t,o))return t[o];if(a&&typeof e[a]=="function")try{return e[a]()}catch(i){console.warn(`Failed to read ${o} from Auto-Gear persistence cache`,i)}return n};return{autoGearRules:r("autoGearRules",[],"readAutoGearRules"),autoGearBackups:r("autoGearBackups",[],"readAutoGearBackups"),autoGearPresets:r("autoGearPresets",[],"readAutoGearPresets"),autoGearMonitorDefaults:r("autoGearMonitorDefaults",{},"readAutoGearMonitorDefaults"),autoGearActivePresetId:r("autoGearActivePresetId","","readActivePresetId"),autoGearAutoPresetId:r("autoGearAutoPresetId","","readAutoPresetId"),autoGearBackupRetention:r("autoGearBackupRetention",null,"readBackupRetention"),autoGearShowBackups:r("autoGearShowBackups",!1,"readBackupVisibility")}}function Kj(e){if(!e)return null;const t={};return Object.entries(qj).forEach(([r,o])=>{if(!Object.prototype.hasOwnProperty.call(e,r))return;const n=e[r];o.forEach(a=>{t[a]=n})}),t}const fk="cinePowerPlannerBackupVault",Ag="queuedBackups",Yj=1,Eg="cineBackupVaultFallbackRecords";let ci=null;const Fd=new Map;let ym=!1,xl=null,ku="none",Un=0,Ya=0,td=!1,Cg={storageType:"indexeddb"};function Qj(e,t){const r=t&&typeof t=="object"?t:{},o=typeof r.storageType=="string"?r.storageType:e?Ya>0?"memory":"fallback":"indexeddb",n=o!=="memory",a=td!==!!e||Cg.storageType!==o;td=!!e,Cg={storageType:o,durable:n},a&&Lg("cineBackupVault:fallbackChanged",{active:td,storageType:o,durable:n})}function Io(e){const t=Ya>0||Un>0,r=e&&typeof e=="object"?{...e}:{};t?Ya>0?r.storageType="memory":Un>0?r.storageType="fallback":typeof r.storageType!="string"&&(r.storageType="indexeddb"):r.storageType="indexeddb",Qj(t,r)}function pk(){return{active:td,storageType:Cg.storageType,durable:Cg.durable}}function mk(){return td}function Xj(){let e=[];return{save(t){return e=e.filter(r=>r&&r.id!==t.id),e.push({...t}),e.sort((r,o)=>{const n=typeof r.createdAtMs=="number"?r.createdAtMs:0,a=typeof o.createdAtMs=="number"?o.createdAtMs:0;return n-a}),Ya=e.length,Io({storageType:"memory"}),Promise.resolve({id:t.id,persisted:!0,durable:!1,storageType:"memory"})},list(){return Promise.resolve(e.map(t=>({...t})))},remove(t){return e=e.filter(r=>r&&r.id!==t),Ya=e.length,Io(Ya>0?{storageType:"memory"}:null),Promise.resolve(!0)}}}const Nd=Xj();function gk(){ym=!1,xl=null,ku="none"}function wg(e){return!e||typeof e!="object"?!1:typeof e.getItem=="function"&&typeof e.setItem=="function"}function yk(){if(ym&&wg(xl))return{storage:xl,type:ku};const e=[()=>{if(typeof getSafeLocalStorage=="function")try{return getSafeLocalStorage()}catch(t){console.warn("getSafeLocalStorage threw while resolving backup vault fallback storage",t)}return null},()=>typeof SAFE_LOCAL_STORAGE<"u"&&SAFE_LOCAL_STORAGE?SAFE_LOCAL_STORAGE:null,()=>yt&&yt.sessionStorage?yt.sessionStorage:null,()=>typeof sessionStorage<"u"?sessionStorage:null,()=>yt&&yt.localStorage?yt.localStorage:null,()=>typeof localStorage<"u"?localStorage:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r!="function")continue;let o=null;try{o=r()}catch(n){console.warn("Backup vault fallback storage resolver failed",n),o=null}if(wg(o))return ym=!0,xl=o,ku=t<=1?"safe-local-storage":t<=3?"session-storage":"local-storage",{storage:xl,type:ku}}return ym=!0,xl=null,ku="none",{storage:null,type:"none"}}function eC(){const{storage:e}=yk();if(!wg(e))return Un=0,Io(),[];let t=null;try{t=e.getItem(Eg)}catch(n){return console.warn("Failed to read fallback backup vault storage contents",n),gk(),Un=0,Io(Ya>0?{storageType:"memory"}:null),[]}if(typeof t!="string"||!t)return Un=0,Io(),[];let r;try{r=JSON.parse(t)}catch(n){return console.warn("Failed to parse fallback backup vault entries",n),Un=0,Io(Ya>0?{storageType:"memory"}:null),[]}if(!Array.isArray(r))return Un=0,Io(),[];const o=[];for(let n=0;n<r.length;n+=1){const a=r[n];!a||typeof a!="object"||typeof a.id!="string"||o.push({...a})}return Un=o.length,Io(o.length>0?{storageType:"fallback"}:null),o}function tC(e){const{storage:t}=yk();if(!wg(t))return Un=0,Io(Ya>0?{storageType:"memory"}:null),!1;const r=Array.isArray(e)?e:[];if(r.length===0)try{return t.removeItem(Eg),Un=0,Io(null),!0}catch(n){return console.warn("Failed to remove fallback backup vault entries",n),!1}let o="[]";try{o=JSON.stringify(r)}catch(n){return console.warn("Failed to serialize fallback backup vault entries",n),!1}try{return t.setItem(Eg,o),Un=r.length,Io(r.length>0?{storageType:"fallback"}:null),!0}catch(n){return console.warn("Failed to persist fallback backup vault entries",n),gk(),Io(Ya>0?{storageType:"memory"}:null),!1}}function Xb(e){const t=eC(),r=new Map;t.forEach(n=>{!n||typeof n!="object"||typeof n.id!="string"||r.set(n.id,{...n})}),r.set(e.id,{...e});const o=Array.from(r.values());return o.sort((n,a)=>{const i=typeof n.createdAtMs=="number"?n.createdAtMs:0,s=typeof a.createdAtMs=="number"?a.createdAtMs:0;return i-s}),tC(o)?Promise.resolve({id:e.id,persisted:!0,durable:!0,storageType:"fallback"}):Nd.save(e)}function Zj(e){if(!e)return Promise.resolve(!1);const t=eC();if(!t.length)return Promise.resolve(!1);const r=t.filter(n=>n&&n.id!==e);if(r.length===t.length)return Un=t.length,Io(t.length>0?{storageType:"fallback"}:null),Promise.resolve(!1);const o=tC(r);return Promise.resolve(!!o)}function Jj(e,t,r){const o=new Map,n=(i,s)=>{Array.isArray(i)&&i.forEach(u=>{if(!u||typeof u!="object"||typeof u.id!="string")return;const l={...u,storageType:s};s!=="memory"?l.durable=!0:l.durable=!1;const d=o.get(l.id);if(!d){o.set(l.id,l);return}const p=typeof d.createdAtMs=="number"?d.createdAtMs:0;(typeof l.createdAtMs=="number"?l.createdAtMs:0)>=p&&o.set(l.id,l)})};n(e,"indexeddb"),n(t,"fallback"),n(r,"memory");const a=Array.from(o.values());return a.sort((i,s)=>{const u=typeof i.createdAtMs=="number"?i.createdAtMs:0,l=typeof s.createdAtMs=="number"?s.createdAtMs:0;return u-l}),a}function bk(){return typeof indexedDB<"u"&&indexedDB!==null}function ez(){return bk()?ci||(ci=new Promise(e=>{let t=!1;try{const r=indexedDB.open(fk,Yj);r.addEventListener("upgradeneeded",o=>{const n=o.target.result;n.objectStoreNames.contains(Ag)||n.createObjectStore(Ag,{keyPath:"id"}).createIndex("createdAtMs","createdAtMs",{unique:!1})}),r.addEventListener("success",()=>{const o=r.result;t=!0,o.onversionchange=()=>{o.close(),ci&&(ci=null)},e(o)}),r.addEventListener("error",()=>{t||console.warn("Failed to open backup vault IndexedDB database",r.error),e(null)})}catch(r){console.warn("Unable to open backup vault IndexedDB database",r),e(null)}}),ci):Promise.resolve(null)}function Hd(e,t){return ez().then(r=>r?new Promise((o,n)=>{let a=!1;try{const i=r.transaction(Ag,e),s=i.objectStore(Ag),u=t(s,i);i.addEventListener("complete",()=>{a||(a=!0,o(u))}),i.addEventListener("error",()=>{a||(a=!0,n(i.error))})}catch(i){n(i)}}).catch(o=>(console.warn("Backup vault IndexedDB transaction failed",o),t(null))):t(null))}function tz(e){const t=e&&typeof e.source=="string"&&e.source?e.source:"automatic",r=e&&typeof e.reason=="string"&&e.reason?e.reason:"unknown",o=e&&typeof e.permissionState=="string"&&e.permissionState?e.permissionState:"unknown",n=e&&typeof e.createdAt=="string"&&e.createdAt?e.createdAt:new Date().toISOString(),a=e&&typeof e.createdAtMs=="number"&&Number.isFinite(e.createdAtMs)?e.createdAtMs:Date.now();return{source:t,reason:r,permissionState:o,createdAt:n,createdAtMs:a}}function rz(e,t,r={}){const o=typeof e=="string"&&e?e:"cine-power-planner-backup.json",n=tz(r);return{id:r&&typeof r.id=="string"&&r.id?r.id:`queued-${n.createdAtMs}-${Math.random().toString(16).slice(2,10)}`,fileName:o,payload:t,createdAt:n.createdAt,createdAtMs:n.createdAtMs,metadata:{source:n.source,reason:n.reason,permissionState:n.permissionState}}}function oz(e){return!e||typeof e!="object"||!e.id?Promise.resolve(null):Hd("readwrite",t=>t?new Promise((r,o)=>{try{const n=t.put(e);n.addEventListener("success",()=>{Io({storageType:"indexeddb"}),r({id:e.id,persisted:!0,durable:!0,storageType:"indexeddb"})}),n.addEventListener("error",()=>{o(n.error)})}catch(n){o(n)}}).catch(r=>(console.warn("Failed to persist backup vault record to IndexedDB",r),Xb(e))):Xb(e)).catch(t=>(console.warn("Backup vault persistence failed",t),Xb(e)))}function nz(){const e=Hd("readonly",o=>o?new Promise((n,a)=>{try{const i=o.getAll();i.addEventListener("success",()=>{n(Array.isArray(i.result)?i.result:[])}),i.addEventListener("error",()=>{a(i.error)})}catch(i){a(i)}}).catch(n=>(console.warn("Failed to read backup vault records from IndexedDB",n),[])):[]).catch(o=>(console.warn("Backup vault record enumeration failed",o),[])),t=Promise.resolve().then(()=>eC()).catch(o=>(console.warn("Failed to enumerate fallback backup vault records",o),[])),r=Nd.list().catch(()=>[]);return Promise.all([e,t,r]).then(o=>{const[n,a,i]=o;return Jj(n,a,i)})}function hk(e){if(!e)return Promise.resolve(!1);Fd.delete(e);const t=Hd("readwrite",r=>r?new Promise((o,n)=>{try{const a=r.delete(e);a.addEventListener("success",()=>{Io(),o(!0)}),a.addEventListener("error",()=>{n(a.error)})}catch(a){n(a)}}).catch(o=>(console.warn("Failed to remove backup vault record from IndexedDB",o),!1)):!1).catch(r=>(console.warn("Backup vault record removal failed",r),!1));return Promise.all([Promise.resolve(t),Zj(e),Nd.remove(e)]).then(r=>{const o=r.some(n=>!!n);return o||Io(),o})}function az(){const e=(async()=>{try{if(ci){const t=await ci;if(t&&typeof t.close=="function")try{t.close()}catch(r){console.warn("Failed to close backup vault DB before deletion",r)}}}catch(t){console.warn("Failed to await backup vault DB cleanup",t)}return ci=null,new Promise((t,r)=>{if(!bk()){t(!0);return}try{const o=indexedDB.deleteDatabase(fk);o.addEventListener("success",()=>{t(!0)}),o.addEventListener("error",()=>{console.warn("Failed to delete backup vault database",o.error),Hd("readwrite",n=>n?new Promise((a,i)=>{const s=n.clear();s.onsuccess=()=>a(!0),s.onerror=()=>i(s.error)}):!1).then(t).catch(r)}),o.addEventListener("blocked",()=>{console.warn("Backup vault database deletion blocked"),Hd("readwrite",n=>n?new Promise((a,i)=>{const s=n.clear();s.onsuccess=()=>a(!0),s.onerror=()=>i(s.error)}):!1).then(()=>{t(!0)}).catch(n=>{console.warn("Failed to clear backup vault store after blocked deletion",n),Lg("cineBackupVault:clearBlocked",{reason:"blocked",error:n?String(n):"unknown"}),t(!0)})})}catch(o){r(o)}})})();return Promise.allSettled([e,tC([]),Nd.list().then(t=>Promise.all(t.map(r=>Nd.remove(r.id))))]).then(t=>{const r=t.filter(o=>o.status==="rejected");return r.length&&(console.warn("clearBackupVault encountered errors",r.map(o=>o.reason)),Lg("cineBackupVault:clearFailed",{reason:"partial",failedCount:r.length})),Io(),Fd.clear(),!0})}function Lg(e,t){if(!e)return;const r=[];yt&&typeof yt.dispatchEvent=="function"&&r.push(yt),yt&&yt.document&&typeof yt.document.dispatchEvent=="function"&&r.push(yt.document),yt&&yt.window&&typeof yt.window.dispatchEvent=="function"&&r.push(yt.window);const o=typeof CustomEvent=="function"?CustomEvent:null;r.forEach(n=>{if(!(!n||typeof n.dispatchEvent!="function"))try{if(o)n.dispatchEvent(new CustomEvent(e,{detail:t}));else if(typeof Event=="function"){const a=new Event(e);a.detail=t,n.dispatchEvent(a)}}catch(a){console.warn("Failed to dispatch backup vault event",a)}})}function rC(){return nz().then(e=>{const t=new Map;Array.isArray(e)&&e.forEach(o=>{!o||!o.id||t.has(o.id)||t.set(o.id,{...o})}),Fd.forEach((o,n)=>{if(!t.has(n)){const a={...o};typeof a.storageType!="string"&&(a.storageType="transient"),typeof a.durable!="boolean"&&(a.durable=!1),t.set(n,a)}});const r=Array.from(t.values());return r.sort((o,n)=>{const a=typeof o.createdAtMs=="number"?o.createdAtMs:0,i=typeof n.createdAtMs=="number"?n.createdAtMs:0;return a-i}),r})}function oC(e,t,r){const o=rz(e,t,r||{});Fd.set(o.id,{...o});try{oz(o).then(n=>{Fd.delete(o.id),n&&n.durable===!1&&console.warn("Backup vault record stored using non-durable fallback storage.",n)}).catch(n=>{console.warn("Failed to persist queued backup payload. Using in-memory vault fallback.",n)})}catch(n){console.warn("Queued backup persistence threw unexpectedly",n)}return Lg("cineBackupVault:queued",{id:o.id,fileName:o.fileName,createdAt:o.createdAt,metadata:o.metadata}),o}function Ha(){const e=yt&&typeof yt.texts=="object"?yt.texts:null,t=yt&&typeof yt.currentLang=="string"?yt.currentLang:yt&&typeof yt.appLanguage=="string"?yt.appLanguage:"en",r=t&&typeof t=="string"?t:"en",o=e&&e[r]?e[r]:null,n=e&&e.en?e.en:null;return{langTexts:o,fallbackTexts:n}}function nC(e){const{langTexts:t,fallbackTexts:r}=Ha();return(t&&t.queuedBackupDownloadDeferred||r&&r.queuedBackupDownloadDeferred||"Automatic downloads were blocked. The backup was saved to the local vault.").replace("{fileName}",e||"cine-power-planner-backup.json")}function TL(){const{langTexts:e,fallbackTexts:t}=Ha();return e&&e.queuedBackupVaultEmpty||t&&t.queuedBackupVaultEmpty||"No queued backups are stored in the local vault."}function Zb(){const{langTexts:e,fallbackTexts:t}=Ha();return e&&e.queuedBackupVaultTitle||t&&t.queuedBackupVaultTitle||"Local backup vault"}function iz(){const{langTexts:e,fallbackTexts:t}=Ha();return e&&e.queuedBackupVaultIntro||t&&t.queuedBackupVaultIntro||"Automatic downloads were blocked. Use the actions below to export or copy each backup while offline."}function Sk(){return rC().then(e=>{if(!e||!e.length){const p=TL();if(typeof yt.showNotification=="function")try{return yt.showNotification("info",p),!1}catch{}if(typeof yt.cineShowAlertDialog=="function")yt.cineShowAlertDialog({title:Zb(),message:p});else if(typeof alert=="function")try{alert(p)}catch{}return!1}if(typeof window>"u"||typeof document>"u")return console.warn("Cannot open queued backup vault window outside of a browser context"),!1;let t=null;try{t=window.open("","cineBackupVault","noopener,noreferrer,width=780,height=720")}catch(p){console.warn("Failed to open local backup vault window",p),t=null}if(!t){const p=Ha().fallbackTexts&&Ha().fallbackTexts.queuedBackupVaultPopupBlocked?Ha().fallbackTexts.queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.";if(typeof yt.showNotification=="function")try{return yt.showNotification("error",p),!1}catch{}if(typeof yt.cineShowAlertDialog=="function")yt.cineShowAlertDialog({title:Zb(),message:p});else if(typeof alert=="function")try{alert(p)}catch{}return!1}const r=Zb(),o=iz(),a=JSON.stringify(e.map(p=>({id:p.id,fileName:p.fileName,createdAt:p.createdAt,createdAtMs:p.createdAtMs,metadata:p.metadata,payload:p.payload}))).replace(/</g,"\\u003c"),i=TL(),s=`(() => {
  'use strict';
  try {
    var source = document.getElementById('queued-backups');
    var records = [];
    if (source) {
      var text = source.textContent || '';
      var parsed = JSON.parse(text);
      if (Array.isArray(parsed)) {
        records = parsed;
      }
    }
    var container = document.getElementById('vault');
    if (!container) {
      return;
    }
    if (!records.length) {
      var empty = document.createElement('p');
      empty.className = 'empty';
      empty.textContent = ${JSON.stringify(i)};
      container.appendChild(empty);
      return;
    }
    records.forEach(function (record) {
      var entry = document.createElement('section');
      entry.className = 'backup-entry';
      var header = document.createElement('header');
      var heading = document.createElement('h2');
      heading.textContent = String(record.fileName || 'cine-power-planner-backup.json') + ' — ' + String(record.createdAt || '');
      header.appendChild(heading);
      var downloadButton = document.createElement('button');
      downloadButton.type = 'button';
      downloadButton.textContent = 'Download JSON';
      downloadButton.addEventListener('click', function () {
        try {
          var blob = new Blob([record.payload], { type: 'application/json' });
          var url = URL.createObjectURL(blob);
          var link = document.createElement('a');
          link.href = url;
          link.download = record.fileName || 'cine-power-planner-backup.json';
          link.click();
          setTimeout(function () { URL.revokeObjectURL(url); }, 60000);
        } catch (error) {
          if (typeof window.opener.cineShowAlertDialog === 'function') {
            window.opener.cineShowAlertDialog('Download blocked — copy the JSON below instead.');
          } else {
            alert('Download blocked — copy the JSON below instead.');
          }
        }
      });
      header.appendChild(downloadButton);
      entry.appendChild(header);
      var textArea = document.createElement('textarea');
      textArea.readOnly = true;
      textArea.value = record.payload;
      entry.appendChild(textArea);
      container.appendChild(entry);
    });
  } catch (error) {
    console.error('Failed to bootstrap queued backup vault', error);
  }
})();`,u=`data:text/javascript;charset=utf-8,${encodeURIComponent(s)}`,l=Ha().fallbackTexts&&Ha().fallbackTexts.queuedBackupVaultPopupBlocked?Ha().fallbackTexts.queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.",d=t.document;try{d.open(),d.write(`<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" />
<title>${r}</title>
<style>
:root { color-scheme: light dark; font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif; }
body { margin: 0; padding: 1.5rem; background: #0f1624; color: #f5f7fb; }
h1 { margin-top: 0; font-size: 1.5rem; }
p { line-height: 1.6; max-width: 38rem; }
.backup-entry { background: rgba(15, 22, 36, 0.65); border: 1px solid rgba(111, 120, 141, 0.35); border-radius: 1rem; padding: 1rem; margin-top: 1rem; }
.backup-entry header { display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: baseline; justify-content: space-between; }
.backup-entry h2 { font-size: 1rem; margin: 0; }
.backup-entry button { background: #ffbf3c; border: none; border-radius: 999px; padding: 0.5rem 1.25rem; font-weight: 600; cursor: pointer; color: #11131a; }
.backup-entry button:focus { outline: 2px solid #ffffff; outline-offset: 2px; }
.backup-entry textarea { width: 100%; min-height: 10rem; margin-top: 0.75rem; border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.12); padding: 0.75rem; background: rgba(6, 10, 18, 0.92); color: #f5f7fb; font-family: 'Fira Code', 'SFMono-Regular', 'Consolas', 'Menlo', monospace; }
.empty { margin-top: 2rem; font-style: italic; color: rgba(245, 247, 251, 0.7); }
.banner { margin-bottom: 1.5rem; padding: 1rem 1.25rem; border-radius: 1rem; background: rgba(255, 191, 60, 0.18); border: 1px solid rgba(255, 191, 60, 0.4); color: #ffe3a4; }
.banner strong { display: block; font-size: 1.1rem; margin-bottom: 0.35rem; }
</style>
</head><body>
<div class="banner"><strong>${r}</strong><p>${o}</p></div>
<main id="vault"></main>
<script type="application/json" id="queued-backups">${a}<\/script>
<script src="${u}"><\/script>
</body></html>`),d.close()}catch(p){console.warn("Failed to render queued backup vault window",p);try{d.close()}catch{}if(t.close(),typeof yt.showNotification=="function")try{yt.showNotification("error",l)}catch{}return!1}return!0})}const ts=new Set(["darkMode","pinkMode","highContrast","showAutoBackups","accentColor","fontSize","fontFamily","customLogo","cineRentalPrintSections","language"]);typeof IOS_PWA_HELP_STORAGE_KEY=="string"&&IOS_PWA_HELP_STORAGE_KEY?ts.add(IOS_PWA_HELP_STORAGE_KEY):yt&&typeof yt.IOS_PWA_HELP_STORAGE_KEY=="string"&&yt.IOS_PWA_HELP_STORAGE_KEY?ts.add(yt.IOS_PWA_HELP_STORAGE_KEY):ts.add("iosPwaHelpShown");const vk=new Set(["settings","storage","localStorage","values","entries","sessionStorage","sessionState","sessionEntries","payload","plannerData","allData","generatedAt","version","appVersion","applicationVersion"]),aC=["devices","setups","session","feedback","project","projects","gearList","favorites","documentationTracker","ownGear","autoGearRules","autoGearSeeded","autoGearBackups","autoGearPresets","autoGearMonitorDefaults","autoGearActivePresetId","autoGearAutoPresetId","autoGearShowBackups","autoGearBackupRetention","customLogo","customFonts","contacts","userProfile","preferences","schemaCache","fullBackupHistory","fullBackups","documentationTracker"],Ak=new Set(["devices","setups","session","sessions","feedback","project","projects","gearList","favorites","documentationTracker","ownGear","autoGearRules","autoGearBackups","autoGearPresets","autoGearMonitorDefaults","contacts","userProfile","preferences","fullBackupHistory","fullBackups","customFonts","documentationTracker"]),OL=(()=>{const e=new Set;return ts&&typeof ts.forEach=="function"&&ts.forEach(t=>{typeof t=="string"&&t&&e.add(t)}),ca.forEach(t=>{typeof t!="string"||!t||aC.forEach(r=>{typeof r!="string"||!r||e.add(`${t}${r}`)})}),e})();function gn(e){if(e===null||typeof e!="object"||Array.isArray(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;let r;try{r=Object.getPrototypeOf(e)}catch{return!1}return r===null||r===Object.prototype}function ll(e){if(!e||typeof e!="object")return!1;if(Object.prototype.toString.call(e)==="[object Map]")return!0;if(typeof Map<"u")try{if(e instanceof Map)return!0}catch{}return typeof e.size=="number"&&typeof e.entries=="function"&&typeof e.forEach=="function"&&typeof e.get=="function"&&typeof e.set=="function"}function sz(e){if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"||typeof e=="bigint")return String(e);if(typeof e=="symbol")return e.description||e.toString();if(e&&typeof e=="object")try{const t=JSON.stringify(e);if(t&&t!=="{}")return t}catch{}try{return String(e)}catch{}return null}function Wc(e){if(!ll(e))return null;const t=Object.create(null),r=(n,a)=>{const i=sz(n);i!=null&&(Object.prototype.hasOwnProperty.call(t,i)||(t[i]=a))};let o=!1;if(typeof e.entries=="function")try{const n=e.entries();if(n&&typeof n.next=="function"){for(let a=n.next();!a.done;a=n.next()){const i=a&&a.value;Array.isArray(i)&&i.length>=2&&r(i[0],i[1])}o=!0}}catch(n){console.warn("Unable to iterate map-like backup value entries",n)}if(!o&&typeof e.forEach=="function")try{e.forEach((n,a)=>{r(a,n)}),o=!0}catch(n){console.warn("Unable to iterate map-like backup value via forEach",n)}return!Object.keys(t).length&&!o?null:t}function Ek(e){const t=e instanceof Date&&!Number.isNaN(e.valueOf())?e:new Date,r=h=>String(h).padStart(2,"0"),o=t.getFullYear(),n=r(t.getMonth()+1),a=r(t.getDate()),i=r(t.getHours()),s=r(t.getMinutes()),u=r(t.getSeconds()),l=t.getTimezoneOffset();let d="Z";if(l!==0){const h=l>0?"-":"+",A=Math.abs(l),m=r(Math.floor(A/60)),y=r(A%60);d=`${h}${m}:${y}`}const p=`${o}-${n}-${a}T${i}:${s}:${u}${d}`,g=p.replace(/[:]/g,"-");return{iso:p,fileName:`cine_power_planner_backup_${g}.json`}}function Ck(){if(typeof getSafeLocalStorage=="function")try{const e=getSafeLocalStorage();if(e)return e}catch(e){console.warn("Unable to obtain safe local storage reference",e)}return typeof SAFE_LOCAL_STORAGE<"u"?SAFE_LOCAL_STORAGE:typeof localStorage<"u"?localStorage:null}function wk(e){const t=Object.create(null);if(!e)return t;const r=Wj(),o=Kj(r),n=(l,d)=>{if(!(typeof l!="string"||!l)&&!Object.prototype.hasOwnProperty.call(t,l)){if(o&&Object.prototype.hasOwnProperty.call(o,l)){t[l]=o[l];return}try{const p=typeof d=="function"?d():d;t[l]=p}catch(p){console.warn("Failed to read storage entry for backup",l,p)}}},a=()=>{if(typeof e.key!="function"||typeof e.length!="number")return!1;let l=0;try{l=Number(e.length)||0}catch(d){return console.warn("Failed to inspect storage length for backup snapshot",d),!0}for(let d=0;d<l;d+=1){let p;try{p=e.key(d)}catch(g){console.warn("Failed to access storage key for backup snapshot",g);continue}n(p,()=>e.getItem(p))}return!0},i=()=>{if(typeof e.keys!="function")return!1;let l;try{l=e.keys()}catch(p){return console.warn("Failed to enumerate storage keys for backup snapshot",p),!0}return l&&(p=>{if(p){if(typeof p.forEach=="function")p.forEach(g=>n(g,()=>e.getItem(g)));else if(typeof p[Symbol.iterator]=="function")for(const g of p)n(g,()=>e.getItem(g))}})(l),!0},s=()=>{if(typeof e.forEach!="function")return!1;try{e.forEach((l,d)=>{n(d,l)})}catch(l){console.warn("Failed to iterate storage for backup snapshot",l)}return!0};let u=!1;try{u=a()}catch(l){console.warn("Failed to snapshot storage via index enumeration",l)}if(!Object.keys(t).length)try{u=i()||u}catch(l){console.warn("Failed to snapshot storage via key enumeration",l)}if(!Object.keys(t).length&&!u)try{s()}catch(l){console.warn("Failed to snapshot storage via iteration",l)}else Object.keys(t).length||s();return typeof e.getItem=="function"&&OL.size&&OL.forEach(l=>{n(l,()=>e.getItem(l))}),o&&Object.entries(o).forEach(([l,d])=>{Object.prototype.hasOwnProperty.call(t,l)||(t[l]=d)}),t}function Lk(e,t){if(!e||typeof e.getItem!="function")return()=>null;const r=typeof t=="string"&&t?t:"Failed to read storage key";return o=>{if(typeof o!="string")return null;try{return e.getItem(o)}catch(n){return console.warn(`${r}`,o,n),null}}}function Rk(e){if(typeof sessionStorage>"u"||!sessionStorage)return;const t=e&&typeof e=="object"?Object.entries(e):[],r=new Set(t.map(([n])=>n)),o=[];try{const{length:n}=sessionStorage;for(let a=0;a<n;a+=1){const i=sessionStorage.key(a);typeof i=="string"&&(r.has(i)||o.push(i))}}catch(n){console.warn("Failed to inspect sessionStorage during restore rollback",n)}o.forEach(n=>{try{sessionStorage.removeItem(n)}catch(a){console.warn("Failed to remove sessionStorage key during restore rollback",n,a)}}),t.forEach(([n,a])=>{if(typeof n=="string")try{sessionStorage.setItem(n,typeof a=="string"?a:String(a))}catch(i){console.warn("Failed to reapply sessionStorage key during restore rollback",n,i)}})}function Ik(e){if(typeof e=="string")return e;if(e==null)return"";if(typeof e=="object")try{return JSON.stringify(e)}catch(t){return console.warn("Failed to serialize stored value for backup compatibility",t),""}try{return String(e)}catch(t){return console.warn("Failed to normalize stored value for backup compatibility",t),""}}function lz(e){if(!e)return null;let t=e;if(ll(t)){const n=Wc(t);n&&(t=n)}if(typeof t=="string"){let n=null;try{n=JSON.parse(t)}catch{n=null}if(n&&(Array.isArray(n)||gn(n)))t=n;else return null}const r=Object.create(null),o=(n,a)=>{typeof n!="string"||!n||(r[n]=Ik(a))};if(Array.isArray(t))t.forEach(n=>{if(n){if(Array.isArray(n)){o(n[0],n[1]);return}if(typeof n=="object"){if(typeof n.key=="string"){o(n.key,n.value??n.val??n.data??n.content??n.string);return}if(typeof n.name=="string"){o(n.name,n.value??n.val??n.data??n.content??n.string);return}Array.isArray(n.entry)&&o(n.entry[0],n.entry[1])}}});else if(gn(t))Object.entries(t).forEach(([n,a])=>{o(n,a)});else return null;return Object.keys(r).length?r:null}function GL(e,t){let r=e;if(!gn(r))if(ll(r)){const o=Wc(r);if(o&&gn(o))r=o;else return{snapshot:null,keyUsed:null}}else return{snapshot:null,keyUsed:null};for(let o=0;o<t.length;o+=1){const n=t[o];if(!Object.prototype.hasOwnProperty.call(r,n))continue;const a=lz(r[n]);if(a)return{snapshot:a,keyUsed:n}}return{snapshot:null,keyUsed:null}}function Tk(e){return ts.has(e)?!0:ca.some(t=>e.startsWith(t))}function Ok(e,t){if(!e||typeof e.setItem!="function")return;const r=t&&typeof t=="object"?Object.entries(t):[],o=new Set(r.map(([a])=>a)),n=[];try{const{length:a}=e;for(let i=0;i<a;i+=1){const s=e.key(i);typeof s=="string"&&!o.has(s)&&Tk(s)&&n.push(s)}}catch(a){console.warn("Failed to inspect storage during restore rollback",a)}n.forEach(a=>{try{e.removeItem(a)}catch(i){console.warn("Failed to remove storage key during restore rollback",a,i)}}),r.forEach(([a,i])=>{if(typeof a=="string")try{i==null?e.removeItem(a):e.setItem(a,typeof i=="string"?i:String(i))}catch(s){console.warn("Failed to reapply storage key during restore rollback",a,s)}})}function cz(e,t){let r=e;if(ll(r)){const n=Wc(r);n&&(r=n)}if(!gn(r))return null;const o=Object.create(null);return Object.entries(r).forEach(([n,a])=>{t.has(n)||Tk(n)&&(o[n]=Ik(a))}),Object.keys(o).length?o:null}function Gk(e){if(ll(e)){const a=Wc(e);if(a)return a}if(!Array.isArray(e))return null;const t=Object.create(null),r=(a,i)=>{typeof a!="string"||!a||Object.prototype.hasOwnProperty.call(t,a)||(t[a]=i)},o=["key","name","section","type"],n=["value","data","content","payload","entries","items","record","snapshot","state","values","settings","sectionData","body"];return e.forEach(a=>{if(!a)return;if(Array.isArray(a)){r(a[0],a[1]);return}if(!gn(a))return;if(Array.isArray(a.entry)){r(a.entry[0],a.entry[1]);return}const i=o.find(u=>{const l=a[u];return typeof l=="string"&&l});if(!i)return;let s;for(let u=0;u<n.length;u+=1){const l=n[u];if(Object.prototype.hasOwnProperty.call(a,l)){s=a[l];break}}s===void 0&&(s=a.value??a.data??a.content??a.payload??a.entries??a.items??a.snapshot??a.state??a.values??a.settings),s!==void 0&&r(a[i],s)}),Object.keys(t).length?t:null}function Gc(e){if(ll(e)){const t=Wc(e);if(t)return Gc(t)}if(gn(e))return e;if(Array.isArray(e)){const t=Gk(e);if(t)return t}if(typeof e=="string"){const t=sC(e);if(t)return t}if(e&&typeof e=="object"&&typeof e.toJSON=="function")try{const t=e.toJSON();if(gn(t)||Array.isArray(t))return Gc(t)}catch(t){console.warn("Failed to convert backup data via toJSON",t)}return null}function Qy(e,t){if(typeof e=="string"&&Ak.has(e)){const r=Gc(t);if(r)return r}return t}function Rg(e,t){if(!gn(t)||!Object.keys(t).length)return e?{...e}:null;const r=e?{...e}:{};return Object.entries(t).forEach(([o,n])=>{typeof o=="string"&&(Object.prototype.hasOwnProperty.call(r,o)||(r[o]=Qy(o,n)))}),r}const uz=new RegExp("[\0-]","g");function iC(e){if(e==null)return"";const t=o=>{if(typeof o!="object"||o===null)return null;const n=typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(o),a=Object.prototype.toString.call(o),i=typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||a==="[object ArrayBuffer]"||a==="[object SharedArrayBuffer]"),s=typeof ArrayBuffer>"u"?!1:typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(o)?!0:!!(o&&typeof o=="object"&&typeof o.buffer=="object"&&typeof o.byteLength=="number"&&typeof o.BYTES_PER_ELEMENT=="number");if(!n&&!i&&!s)return null;const u=()=>{if(n)return new Uint8Array(o.buffer,o.byteOffset,o.byteLength);if(i)return new Uint8Array(o);if(typeof o.buffer=="object"&&typeof o.byteLength=="number"){const h=typeof o.byteOffset=="number"?o.byteOffset:0;return new Uint8Array(o.buffer,h,o.byteLength)}throw new TypeError("Unsupported binary payload type")},l=h=>{if(typeof TextDecoder!="function")return null;try{return new TextDecoder("utf-8",{fatal:!1}).decode(h)}catch(A){return console.warn("Failed to decode backup payload with TextDecoder",A),null}},d=()=>{if(!n)return null;try{return o.toString("utf8")}catch(h){return console.warn("Failed to decode backup payload with Buffer",h),null}},p=h=>{try{let A="";for(let y=0;y<h.length;y+=32768){const S=h.subarray(y,y+32768);A+=String.fromCharCode.apply(null,S)}return A}catch(A){return console.warn("Failed to manually decode backup payload",A),null}},g=u();return l(g)||d()||p(g)};let r;if(typeof e=="string")r=e;else{const o=t(e);if(typeof o=="string")r=o;else try{r=String(e)}catch(n){console.warn("Failed to coerce backup payload to string",n),r=""}}if(typeof r!="string")return"";if(!r.includes("\0"))return r;try{return r.replace(uz,"")}catch(o){return console.warn("Failed to strip control characters from backup payload",o),r}}function sC(e){if(typeof e!="string")return null;const t=iC(e);if(!t)return null;const r=t.trim();if(!r)return null;try{const o=JSON.parse(r);if(gn(o))return o;if(Array.isArray(o))return Gk(o)}catch(o){console.warn("Failed to parse backup data string",o)}return null}function kk(e){let t;if(gn(e))t=e;else if(ll(e)){const p=Wc(e);t=gn(p)?p:{}}else t={};const r=typeof t.version=="string"?t.version:typeof t.appVersion=="string"?t.appVersion:typeof t.applicationVersion=="string"?t.applicationVersion:void 0,o=GL(t,["settings","localStorage","storage","storedSettings","values","entries"]),n=GL(t,["sessionStorage","session","sessions","sessionState","sessionEntries"]),a=new Set(vk);o.keyUsed&&a.add(o.keyUsed),n.keyUsed&&a.add(n.keyUsed);const i=o.snapshot||cz(t,a),s=n.snapshot;let u=null;const l=["data","payload","plannerData","allData"];for(let p=0;p<l.length;p+=1){const g=l[p];if(!Object.prototype.hasOwnProperty.call(t,g))continue;const h=Gc(t[g]);h&&(u=Rg(u,h))}const d={};return aC.forEach(p=>{a.has(p)||Object.prototype.hasOwnProperty.call(t,p)&&(d[p]=Qy(p,t[p]))}),Object.keys(d).length&&(u=Rg(u,d)),{fileVersion:r,settings:i,sessionStorage:s,data:gn(u)?u:null}}function Jb(e){if(!e)return!1;const t=typeof e.name=="string"?e.name:"";if(t==="TypeError"||t==="NotSupportedError"||typeof DOMException<"u"&&e instanceof DOMException&&e.code===DOMException.NOT_SUPPORTED_ERR)return!0;if(typeof e.message=="string"){const r=e.message.toLowerCase();if(r.includes("automatic-download")&&r.includes("not a valid enum")||r.includes("downloads")&&r.includes("not a valid enum"))return!0}return!1}function dz(){if(typeof navigator>"u"||!navigator.permissions||typeof navigator.permissions.query!="function")return null;const e=["automatic-downloads","downloads"];let t=null,r=null;for(let a=0;a<e.length;a+=1){const i=e[a];try{const s=navigator.permissions.query({name:i});if(!s||typeof s.then!="function")continue;t=s,r=i;break}catch(s){if(Jb(s))continue;return console.warn(`Failed to query automatic download permission (${i})`,s),null}}if(!t||typeof t.then!="function")return null;let o=null;const n={state:"unknown",name:r,supported:!0,initial:t.then(a=>(o=a,!a||typeof a.state!="string"?(n.state="unknown",n.state):(n.state=a.state,n.state))).catch(a=>Jb(a)?(n.supported=!1,n.state="unknown",n.state):(console.warn(`Failed to query automatic download permission (${r||"unknown"})`,a),n.state="unknown",n.state)),ready:null};return n.ready=n.initial.then(a=>!o||typeof o.state!="string"?n.state:a==="prompt"?new Promise(i=>{const s=()=>{try{o.removeEventListener("change",s)}catch{}n.state=typeof o.state=="string"?o.state:"unknown",i(n.state)};try{o.addEventListener("change",s)}catch(u){console.warn("Failed to observe automatic download permission changes",u),i("unknown")}}):a).catch(a=>(Jb(a)||console.warn("Failed to observe automatic download permission changes",a),n.state="unknown",n.state)),n}function Ig(e,t){if(typeof document>"u")return!1;const r=document.createElement("a");r.href=e,r.download=t,r.style.display="none",document.body.appendChild(r);let o=!1;try{r.click(),o=!0}catch(n){console.warn("Failed to trigger backup download",n),o=!1}return setTimeout(()=>{try{r.remove()}catch{}},1500),o}function lC(e){if(typeof e!="string")return null;try{return`data:application/json;charset=utf-8,${encodeURIComponent(e)}`}catch(t){return console.warn("Failed to encode backup payload as data URL",t),null}}function cC(e,t){if(typeof window>"u"||typeof document>"u")return!1;let r=null;try{r=window.open("","_blank","noopener")}catch(o){console.warn("Failed to open fallback backup window",o),r=null}if(!r)return!1;try{const o=r.document;if(!o)return!1;const n=document&&document.documentElement&&document.documentElement.getAttribute?document.documentElement.getAttribute("lang"):"en";o.open(),o.write(`<!DOCTYPE html><html lang="${n||"en"}"><head><meta charset="utf-8"><title>Manual download</title></head><body></body></html>`),o.close();try{o.title=t||"backup.json"}catch(p){}const a=o.body;if(!a)return!1;a.style.margin="0",a.style.padding="1.5rem",a.style.background="#f8f9fb",a.style.color="#0f172a",a.style.fontFamily="system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif";const i=o.createElement("div");i.style.maxWidth="960px",i.style.margin="0 auto",i.style.display="flex",i.style.flexDirection="column",i.style.gap="1rem";const s=o.createElement("h1");s.textContent=t||"Manual backup",s.style.margin="0",s.style.fontSize="1.5rem",s.style.fontWeight="400";const u=o.createElement("p");typeof getManualDownloadFallbackMessage=="function"?u.textContent=getManualDownloadFallbackMessage():u.textContent="Copy the text below and save it to a file ending with .json to keep your data safe.",u.style.margin="0",u.style.lineHeight="1.5";const l=o.createElement("p");typeof getManualDownloadCopyHint=="function"?l.textContent=getManualDownloadCopyHint():l.textContent="Select the text, copy it and paste into your preferred notes app or text editor.",l.style.margin="0",l.style.lineHeight="1.5";const d=o.createElement("textarea");d.value=e,d.readOnly=!0,d.spellcheck=!1,d.style.width="100%",d.style.height="70vh",d.style.resize="vertical",d.style.padding="1rem",d.style.borderRadius="1rem",d.style.border="1px solid rgba(15, 23, 42, 0.15)",d.style.background="#ffffff",d.style.fontFamily="'SFMono-Regular', 'Roboto Mono', 'Menlo', 'Courier New', monospace",d.style.fontSize="0.875rem",d.style.lineHeight="1.5",d.style.boxShadow="0 0.75rem 2.5rem rgba(15, 23, 42, 0.16)",i.appendChild(s),i.appendChild(u),i.appendChild(l),i.appendChild(d),a.appendChild(i);try{d.focus(),d.select()}catch(p){}try{r.focus()}catch(p){}return!0}catch(o){return console.warn("Failed to render manual backup window",o),!1}}function Bk(e,t,r={}){const o=dz(),n=typeof r=="object"&&r!==null?r:{},a=n.skipQueue===!0,i={success:!1,method:null,permission:o,queued:!1,queueMessage:nC(t)};let s=typeof t=="string"&&t.trim()?t.trim():"";if(s||(s=`${new Date().toISOString().replace(/[:.]/g,"-")}-backup.json`),s.toLowerCase().endsWith(".json")||(s+=".json"),typeof e!="string"||e.length<2)return i;try{JSON.parse(e)}catch(p){return console.error("Corruption Detected: Generated backup payload is not valid JSON",p),typeof showNotification=="function"&&showNotification("error","Backup failed: Data corruption detected during export."),i}let u=null;if(typeof Blob<"u")try{u=new Blob([e],{type:"application/json;charset=utf-8"})}catch(p){console.warn("Failed to create backup blob",p),u=null}if(u){if(typeof navigator<"u"&&typeof navigator.msSaveOrOpenBlob=="function")try{if(navigator.msSaveOrOpenBlob(u,s)===!1)console.warn("Saving backup via msSaveOrOpenBlob was cancelled or declined");else return{success:!0,method:"ms-save",permission:o}}catch(p){console.warn("Failed to save backup via msSaveOrOpenBlob",p)}if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){let p=null;try{p=URL.createObjectURL(u)}catch(g){console.warn("Failed to create object URL for backup blob",g),p=null}if(p){const g=Ig(p,s);if(typeof URL.revokeObjectURL=="function"&&setTimeout(()=>{try{URL.revokeObjectURL(p)}catch{}},6e4),g)return{success:!0,method:"blob-url",permission:o}}}}const l=lC(e);if(l&&Ig(l,s))return{success:!0,method:"data-url",permission:o};if(cC(e,s))return{success:!0,method:"manual",permission:o};if(!a){const p=n.queueMetadata&&typeof n.queueMetadata=="object"?n.queueMetadata:{},g=oC(s,e,{reason:p.reason||n.reason||"download-blocked",permissionState:p.permissionState||(o&&typeof o.state=="string"?o.state:"unknown"),source:p.source||n.source||"automatic",createdAt:p.createdAt||null,createdAtMs:p.createdAtMs||null});i.queued=!0,i.queueEntryId=g&&typeof g.id=="string"?g.id:null}return i}function Pk(e){return typeof e=="string"&&(e.startsWith(Dd)||e.startsWith(_d))}function xk(e){if(typeof e!="string")return null;const t=e.startsWith(_d)?{prefixLength:_d.length,type:"auto-backup-before-delete",secondsOptional:!0}:e.startsWith(Dd)?{prefixLength:Dd.length,type:"auto-backup",secondsOptional:!0}:null;if(!t)return null;const o=e.slice(t.prefixLength).split("-");if(o.length<5)return null;const n=o.slice(0,5).map(m=>Number(m));if(n.some(m=>Number.isNaN(m)))return null;const[a,i,s,u,l]=n;let d=!1,p=0,g=5;if(o.length>g){const m=o[g];if(/^\d{1,2}$/u.test(m))d=!0,p=Number(m),g+=1;else if(!t.secondsOptional)return null}else if(!t.secondsOptional)return null;const h=o.slice(g).join("-").trim(),A=new Date(a,i-1,s,u,l,d?p:0,0);return{type:t.type,date:Number.isNaN(A.valueOf())?null:A,label:h,includeSeconds:d}}const Mk=IL({formatFullBackupFilename:Ek,resolveSafeLocalStorage:Ck,captureStorageSnapshot:wk,createSafeStorageReader:Lk,restoreSessionStorageSnapshot:Rk,restoreLocalStorageSnapshot:Ok,sanitizeBackupPayload:iC,parseBackupDataString:sC,normalizeBackupDataSection:Gc,normalizeBackupDataValue:Qy,mergeBackupDataSections:Rg,extractBackupSections:kk,triggerBackupDownload:Ig,encodeBackupDataUrl:lC,openBackupFallbackWindow:cC,downloadBackupPayload:Bk,queueBackupPayloadForVault:oC,getQueuedBackupPayloads:rC,removeBackupVaultRecord:hk,openQueuedBackupVaultWindow:Sk,resolveQueuedBackupMessage:nC,isBackupVaultFallbackActive:mk,getBackupVaultFallbackState:pk,isAutoBackupName:Pk,parseAutoBackupName:xk,isPlainObject:gn,constants:IL({SESSION_AUTO_BACKUP_NAME_PREFIX:Dd,SESSION_AUTO_BACKUP_DELETION_PREFIX:_d,BACKUP_STORAGE_KEY_PREFIXES:ca.slice(),BACKUP_STORAGE_KNOWN_KEYS:Array.from(ts),BACKUP_METADATA_BASE_KEYS:Array.from(vk),BACKUP_DATA_KEYS:aC.slice(),BACKUP_DATA_COMPLEX_KEYS:Array.from(Ak),BACKUP_VAULT_FALLBACK_STORAGE_KEY:Eg})});$j("cineFeatureBackup",Mk,{category:"feature",description:"Backup and restore helpers for snapshots, payload normalization, downloads and diff metadata.",replace:!0,connections:["cineModuleBase","cineModuleContext","cinePersistence"]},e=>{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to register cineFeatureBackup module.",e)});const fz=[["cineFeatureBackup",Mk],["formatFullBackupFilename",Ek],["resolveSafeLocalStorage",Ck],["captureStorageSnapshot",wk],["createSafeStorageReader",Lk],["restoreSessionStorageSnapshot",Rk],["restoreLocalStorageSnapshot",Ok],["sanitizeBackupPayload",iC],["parseBackupDataString",sC],["normalizeBackupDataSection",Gc],["normalizeBackupDataValue",Qy],["mergeBackupDataSections",Rg],["extractBackupSections",kk],["triggerBackupDownload",Ig],["encodeBackupDataUrl",lC],["openBackupFallbackWindow",cC],["downloadBackupPayload",Bk],["queueBackupPayloadForVault",oC],["getQueuedBackupPayloads",rC],["removeBackupVaultRecord",hk],["openQueuedBackupVaultWindow",Sk],["resolveQueuedBackupMessage",nC],["isBackupVaultFallbackActive",mk],["getBackupVaultFallbackState",pk],["isAutoBackupName",Pk],["parseAutoBackupName",xk],["clearBackupVault",az],["SESSION_AUTO_BACKUP_NAME_PREFIX",Dd],["SESSION_AUTO_BACKUP_DELETION_PREFIX",_d]];fz.forEach(([e,t])=>{zj(e,t,{configurable:!0,writable:!0})});function Ee(e,t,r){const o=t||e,n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};try{Object.defineProperty(n,e,{get:function(){return r&&r[o]||(r&&typeof r.getElement=="function"?r.getElement(o):null)},configurable:!0,enumerable:!0})}catch{try{n[e]=null}catch{}}}function pz(e){e&&(Ee("toggleDeviceBtn","toggleDeviceManager",e),Ee("deviceManagerSection","device-manager",e),Ee("saveSetupBtn",null,e),Ee("setupNameInput","setupName",e),Ee("deleteSetupBtn",null,e),Ee("addDeviceBtn",null,e),Ee("cancelEditBtn",null,e),Ee("languageSelect",null,e),Ee("skipLink",null,e),Ee("importDataBtn",null,e),Ee("importFileInput",null,e),Ee("exportBtn","exportDataBtn",e),Ee("generateGearListBtn",null,e),Ee("deleteGearListProjectBtn",null,e),Ee("gearItemEditExtra",null,e),Ee("newSubcategorySelect","newSubcategory",e),Ee("newCategorySelect","newCategory",e),Ee("subcategoryFieldDiv","subcategoryField",e),Ee("lensFocusScaleSelect","lensFocusScaleUnit",e),Ee("newNameInput","newName",e),Ee("newWattInput","newWatt",e),Ee("newCapacityInput","newCapacity",e),Ee("newPinAInput","newPinA",e),Ee("newDtapAInput","newDtapA",e),Ee("menuToggle",null,e),Ee("darkModeToggle",null,e),Ee("pinkModeToggle",null,e),Ee("settingsButton",null,e),Ee("settingsDialog",null,e),Ee("settingsSave",null,e),Ee("settingsCancel",null,e),Ee("settingsLanguage",null,e),Ee("settingsDarkMode",null,e),Ee("settingsPinkMode",null,e),Ee("settingsHighContrast",null,e),Ee("settingsReduceMotion",null,e),Ee("settingsRelaxedSpacing",null,e),Ee("settingsShowAutoBackups",null,e),Ee("settingsTemperatureUnit",null,e),Ee("settingsFontSize",null,e),Ee("settingsFontFamily",null,e),Ee("settingsLogo",null,e),Ee("settingsLogoPreview",null,e),Ee("accentColorInput",null,e),Ee("helpButton",null,e),Ee("reloadButton",null,e),Ee("closeMenuButton",null,e),Ee("openContactsBtn",null,e),Ee("shareSetupBtn",null,e),Ee("applySharedLinkBtn",null,e),Ee("generateOverviewBtn",null,e),Ee("runtimeFeedbackBtn",null,e),Ee("zoomOut",null,e),Ee("zoomIn",null,e),Ee("resetView",null,e),Ee("gridSnapToggle",null,e),Ee("accentColorReset",null,e),Ee("resolvedLocalFontsButton","localFontsButton",e),Ee("documentationTrackerAddRelease",null,e),Ee("mountVoltageReset",null,e),Ee("autoGearSavePreset",null,e),Ee("autoGearDeletePreset",null,e),Ee("autoGearBackupRestore",null,e),Ee("autoGearAddRule",null,e),Ee("autoGearResetFactory",null,e),Ee("autoGearHighlightToggle",null,e),Ee("closePrintPreviewBtn",null,e),Ee("printPreviewExportBtn",null,e),Ee("printPreviewPrintBtn",null,e),Ee("projectForm",null,e),Ee("wattFieldDiv","wattField",e),Ee("dtapRow",null,e),Ee("cameraFieldsDiv","cameraFields",e),Ee("monitorFieldsDiv","monitorFields",e),Ee("viewfinderFieldsDiv","viewfinderFields",e),Ee("batteryFieldsDiv","batteryFields",e),Ee("lensFieldsDiv","lensFields",e),Ee("videoFieldsDiv","videoFields",e),Ee("motorFieldsDiv","motorFields",e),Ee("controllerFieldsDiv","controllerFields",e),Ee("distanceFieldsDiv","distanceFields",e),Ee("cameraWattInput","cameraWatt",e),Ee("cameraVoltageInput","cameraVoltage",e),Ee("cameraPortTypeInput","cameraPortType",e),Ee("monitorScreenSizeInput","monitorScreenSize",e),Ee("monitorBrightnessInput","monitorBrightness",e),Ee("monitorWattInput","monitorWatt",e),Ee("monitorVoltageInput","monitorVoltage",e),Ee("monitorPortTypeInput","monitorPortType",e),Ee("monitorWirelessTxInput","monitorWirelessTx",e),Ee("monitorLatencyInput","monitorLatency",e),Ee("monitorAudioOutputInput","monitorAudioOutput",e),Ee("viewfinderScreenSizeInput","viewfinderScreenSize",e),Ee("viewfinderBrightnessInput","viewfinderBrightness",e),Ee("viewfinderWattInput","viewfinderWatt",e),Ee("viewfinderVoltageInput","viewfinderVoltage",e),Ee("viewfinderPortTypeInput","viewfinderPortType",e),Ee("viewfinderWirelessTxInput","viewfinderWirelessTx",e),Ee("viewfinderLatencyInput","viewfinderLatency",e),Ee("videoFrequencyInput",null,e),Ee("videoLatencyInput",null,e),Ee("motorConnectorInput",null,e),Ee("motorInternalInput",null,e),Ee("motorTorqueInput",null,e),Ee("motorGearInput",null,e),Ee("motorNotesInput",null,e),Ee("controllerConnectorInput",null,e),Ee("controllerPowerInput",null,e),Ee("controllerBatteryInput",null,e),Ee("controllerConnectivityInput",null,e),Ee("controllerNotesInput",null,e),Ee("distanceConnectionInput",null,e),Ee("distanceMethodInput",null,e),Ee("distanceRangeInput",null,e),Ee("distanceAccuracyInput",null,e),Ee("distanceOutputInput",null,e),Ee("distanceNotesInput",null,e),Ee("dynamicFieldsDiv","dynamicFields",e))}const eh=tG||{};function Bo(e,t,r,o){if(e&&typeof e.addEventListener=="function"){e.addEventListener(t,r,o);return}const n=a=>{let i=document.getElementById(a);if(!i)try{i=document.querySelector(a)}catch{}return i};if(typeof e=="string"){const a=n(e);if(a){a.addEventListener(t,r,o);return}if(eh&&typeof eh.whenElementAvailable=="function"){eh.whenElementAvailable(e,i=>{i&&typeof i.addEventListener=="function"&&i.addEventListener(t,r,o)});return}}typeof document<"u"&&document.addEventListener("DOMContentLoaded",()=>{let a=null;typeof e=="string"?a=n(e):e&&e.id&&(a=document.getElementById(e.id)),a&&typeof a.addEventListener=="function"&&a.addEventListener(t,r,o)})}function mz(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof e!="function")return;try{const o=t.cineUi&&typeof t.cineUi=="object"?t.cineUi:null;if(o){e(o);return}}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("cineUi registration callback failed",o);return}const r="__cineUiReadyQueue";Array.isArray(t[r])||(t[r]=[]),t[r].push(e)}console.log("DEBUG: app-events.js START");let ua="";const Tg=tG||{};pz(zl);const gz=rx,Dk=tx,mi=(function(){if(typeof Tg.setButtonLabelWithIcon=="function")return Tg.setButtonLabelWithIcon;const t=[];try{typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE.setButtonLabelWithIcon=="function"&&t.push(CORE_GLOBAL_SCOPE.setButtonLabelWithIcon)}catch{}return typeof globalThis<"u"&&globalThis&&typeof globalThis.setButtonLabelWithIcon=="function"&&t.push(globalThis.setButtonLabelWithIcon),typeof window<"u"&&window&&typeof window.setButtonLabelWithIcon=="function"&&t.push(window.setButtonLabelWithIcon),typeof self<"u"&&self&&typeof self.setButtonLabelWithIcon=="function"&&t.push(self.setButtonLabelWithIcon),typeof global<"u"&&global&&typeof global.setButtonLabelWithIcon=="function"&&t.push(global.setButtonLabelWithIcon),t.length>0?t[0]:function(o,n){if(o)try{o.textContent=typeof n=="string"?n:""}catch{}}})(),yn=(function(){if(typeof require=="function")try{const r=require("./modules/features/backup.js");if(r&&typeof r=="object")return r}catch{}const t=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&t.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&t.push(globalThis),typeof window<"u"&&window&&t.push(window),typeof self<"u"&&self&&t.push(self),typeof global<"u"&&global&&t.push(global);for(let r=0;r<t.length;r+=1){const o=t[r];if(o)try{const n=o.cineFeatureBackup;if(n&&typeof n=="object")return n}catch{}}return{}})(),kL=typeof yn.queueBackupPayloadForVault=="function"?yn.queueBackupPayloadForVault:null,jd=typeof yn.getQueuedBackupPayloads=="function"?yn.getQueuedBackupPayloads:null,BL=typeof yn.removeBackupVaultRecord=="function"?yn.removeBackupVaultRecord:null,PL=typeof yn.openQueuedBackupVaultWindow=="function"?yn.openQueuedBackupVaultWindow:null,Og=typeof yn.resolveQueuedBackupMessage=="function"?yn.resolveQueuedBackupMessage:null,Wv=typeof yn.downloadBackupPayload=="function"?yn.downloadBackupPayload:null,xL=typeof yn.isBackupVaultFallbackActive=="function"?yn.isBackupVaultFallbackActive:null,ML=(function(){if(typeof buildSettingsBackupPackage=="function")return buildSettingsBackupPackage;const t=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&t.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&t.push(globalThis),typeof window<"u"&&window&&t.push(window),typeof self<"u"&&self&&t.push(self),typeof global<"u"&&global&&t.push(global);for(let r=0;r<t.length;r+=1){const o=t[r];if(o&&typeof o.buildSettingsBackupPackage=="function")return o.buildSettingsBackupPackage}return null})();function _k(){const e=[],t=cl();return t&&e.indexOf(t)===-1&&e.push(t),typeof globalThis<"u"&&globalThis&&e.indexOf(globalThis)===-1&&e.push(globalThis),typeof window<"u"&&window&&e.indexOf(window)===-1&&e.push(window),typeof self<"u"&&self&&e.indexOf(self)===-1&&e.push(self),typeof global<"u"&&global&&e.indexOf(global)===-1&&e.push(global),e}function yz(){if(typeof require=="function")try{const t=require("./modules/logging-resolver.js");if(t&&typeof t.resolveLogger=="function")return t}catch{}const e=_k();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const o=r.cineLoggingResolver;if(o&&typeof o.resolveLogger=="function")return o}catch{}}return null}function bz(){const e=_k();for(let t=0;t<e.length;t+=1){const r=e[t];if(!r||typeof r!="object"&&typeof r!="function")continue;let o=null;try{o=r.cineLogging||null}catch{o=null}if(o&&typeof o.createLogger=="function")try{return o.createLogger("events",{meta:{source:"app-events"}})}catch(n){try{typeof o.error=="function"&&o.error("Failed to create events logger",n,{namespace:"events-bootstrap"})}catch{}}}return null}const Ht=(function(){const t=yz();if(t&&typeof t.resolveLogger=="function")try{const r=t.resolveLogger("events",{meta:{source:"app-events"}});if(r)return r}catch{}return bz()})(),DL=typeof globalThis<"u"&&globalThis.__CINE_AUTO_BACKUP_RENAMED_FLAG?globalThis.__CINE_AUTO_BACKUP_RENAMED_FLAG:"__cineAutoBackupRenamed",oc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};(!oc.viewfinderTypeOptions||!Array.isArray(oc.viewfinderTypeOptions))&&(oc.viewfinderTypeOptions=[]);(!oc.viewfinderConnectorOptions||!Array.isArray(oc.viewfinderConnectorOptions))&&(oc.viewfinderConnectorOptions=[]);function cl(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}const _L={categorySelect:null};function uC(){const e=_L.categorySelect;if(e&&typeof e=="object"){if(typeof e.isConnected=="boolean"){if(e.isConnected)return e}else if(e.ownerDocument)return e}let t=null;if(typeof newCategorySelect<"u"&&newCategorySelect?t=newCategorySelect:typeof document<"u"&&document&&typeof document.getElementById=="function"&&(t=document.getElementById("newCategory"),t||console.warn("Debug: resolveNewCategorySelect found nothing for ID newCategory")),t){_L.categorySelect=t;const r=cl();if(r&&typeof r=="object")try{r.newCategorySelect=r.newCategorySelect||t}catch{}}return t}const Ki=50,Bu=600*1e3,hz=600*1e3,Sz=["interval","project-switch","import","export","export-revert","before-reload","change-threshold"],vz=new Set(["import"]),Az=new Set(["import","export","export-revert","before-reload","project-switch"]),Ez={feature:"auto-backup"},FL={feature:"device-import",source:"app-events"},Cz=10;function NL(e){if(!e)return null;if(typeof e=="string")return{message:e};if(typeof e!="object")try{return{message:String(e)}}catch{return{message:"Unknown error"}}const t={};if(typeof e.name=="string"&&e.name&&(t.name=e.name),typeof e.message=="string"&&e.message&&(t.message=e.message),(typeof e.code=="string"||typeof e.code=="number")&&(t.code=e.code),typeof e.lineNumber=="number"&&(t.lineNumber=e.lineNumber),typeof e.columnNumber=="number"&&(t.columnNumber=e.columnNumber),Object.keys(t).length>0)return t;try{return{message:String(e)}}catch{return{message:"Unknown error"}}}function wz(e){if(!Array.isArray(e)||e.length===0)return[];const t=[];for(let r=0;r<e.length&&t.length<Cz;r+=1){const o=e[r];if(typeof o=="string")t.push(o);else if(o&&typeof o=="object"){const n={};if(typeof o.message=="string"&&o.message&&(n.message=o.message),(typeof o.code=="string"||typeof o.code=="number")&&(n.code=o.code),Object.keys(n).length>0)t.push(n);else try{t.push(String(o))}catch{}}else try{t.push(String(o))}catch{}}return t}function HL(e){if(typeof countDeviceDatabaseEntries!="function")return null;if(!e||typeof e!="object")return e===null?0:null;try{return countDeviceDatabaseEntries(e)}catch{}return null}function jL(e,t){const r={},o=HL(e);typeof o=="number"&&(r.existing=o);const n=HL(t);return typeof n=="number"&&(r.imported=n),Object.keys(r).length>0?r:null}function th(e,t,r,o){if(!Ht||typeof Ht[e]!="function")return;const n=o&&typeof o=="object"?{...FL,...o}:FL;try{Ht[e](t,r||{},n)}catch{}}function Lz(e){if(typeof e!="string")return"log";const t=e.toLowerCase();return t==="warn"||t==="error"||t==="info"||t==="debug"?t==="debug"&&typeof console<"u"&&console&&typeof console.debug!="function"?"log":t:"log"}function Rz(){if(typeof require=="function")try{return require("./app-core-auto-backup.js")}catch{}const e=[cl(),typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{if(r.CORE_AUTO_BACKUP&&typeof r.CORE_AUTO_BACKUP=="object")return r.CORE_AUTO_BACKUP}catch{}}return null}const rh=Rz(),zL=rh&&typeof rh.logAutoBackupEvent=="function"?rh.logAutoBackupEvent:null;function Gg(e,t,r,o){const n=typeof e=="string"&&e?e:"info",a=typeof t=="string"&&t?t:"Auto backup event",i=Ez;let s=!1;if(zL)try{zL(n,a,r,i),s=!0}catch(l){if(s=!1,typeof console<"u"&&typeof console.warn=="function")try{console.warn("Auto backup delegate logging failed",l)}catch{}}let u=!1;if(Ht&&typeof Ht[n]=="function")try{Ht[n](a,r,i),u=!0}catch(l){if(Ht&&typeof Ht.warn=="function")try{Ht.warn("Auto backup logger invocation failed",l,{...i,originalLevel:n,originalMessage:a})}catch{}}if(!(u||s)&&typeof console<"u"&&console){const l=Lz(n),d=typeof console[l]=="function"?console[l]:console.log;if(typeof d=="function")try{typeof r<"u"?d.call(console,`[auto-backup] ${a}`,r):d.call(console,`[auto-backup] ${a}`)}catch{}}}function UL(e){if(!e||typeof e!="object")return{hasContent:!1};const t={hasContent:!1,projectInfoKeys:0,gearListLength:0,gearListAndProjectRequirementsGenerated:!!e.gearListAndProjectRequirementsGenerated,powerSelectionKeys:0,gearSelectorGroups:0,diagramPositionCount:0,autoGearRuleCount:0},r=e.projectInfo&&typeof e.projectInfo=="object"?e.projectInfo:null;if(r)try{t.projectInfoKeys=Object.keys(r).length}catch{t.projectInfoKeys=0}typeof e.gearList=="string"&&(t.gearListLength=e.gearList.length);const o=e.powerSelection&&typeof e.powerSelection=="object"?e.powerSelection:null;if(o)try{t.powerSelectionKeys=Object.keys(o).length}catch{t.powerSelectionKeys=0}const n=e.gearSelectors&&typeof e.gearSelectors=="object"?e.gearSelectors:null;if(n)try{t.gearSelectorGroups=Object.keys(n).length}catch{t.gearSelectorGroups=0}const a=e.diagramPositions&&typeof e.diagramPositions=="object"?e.diagramPositions:null;if(a)try{t.diagramPositionCount=Object.keys(a).length}catch{t.diagramPositionCount=0}return Array.isArray(e.autoGearRules)&&(t.autoGearRuleCount=e.autoGearRules.length),t.hasContent=!!(t.projectInfoKeys||t.gearListLength||t.gearListAndProjectRequirementsGenerated||t.powerSelectionKeys||t.gearSelectorGroups||t.diagramPositionCount||t.autoGearRuleCount),t}function Iz(e,t){const r=typeof e=="string"?e:"",o=typeof t=="string"?t:"";return r==="error"?"error":r==="success"?"info":r==="skipped"?o==="disallowed"||o==="auto-backup-selected"?"warn":"info":"debug"}function Tz(e,t){const r=typeof e=="string"?e:"",o=typeof t=="string"?t:"";return r==="success"?"Auto backup completed successfully":r==="error"?o?`Auto backup failed (${o})`:"Auto backup failed":r==="skipped"?o?`Auto backup skipped (${o})`:"Auto backup skipped":"Auto backup run recorded"}function Oz(e){if(!e||typeof e!="object")return{status:"unknown"};const t={status:typeof e.status=="string"?e.status:"unknown"};if(typeof e.reason=="string"&&e.reason&&(t.reason=e.reason),typeof e.context=="string"&&e.context&&(t.context=e.context),typeof e.elapsedSinceLastAutoBackupMs=="number"&&Number.isFinite(e.elapsedSinceLastAutoBackupMs)&&(t.elapsedSinceLastAutoBackupMs=Math.max(0,e.elapsedSinceLastAutoBackupMs)),typeof e.remainingIntervalMs=="number"&&Number.isFinite(e.remainingIntervalMs)&&(t.remainingIntervalMs=Math.max(0,e.remainingIntervalMs)),typeof e.changesSinceSnapshot=="number"&&Number.isFinite(e.changesSinceSnapshot)&&(t.changesSinceSnapshot=Math.max(0,e.changesSinceSnapshot)),typeof e.requiredChangeThreshold=="number"&&Number.isFinite(e.requiredChangeThreshold)&&(t.requiredChangeThreshold=Math.max(0,e.requiredChangeThreshold)),typeof e.remainingChanges=="number"&&Number.isFinite(e.remainingChanges)&&(t.remainingChanges=Math.max(0,e.remainingChanges)),typeof e.requiredIntervalMs=="number"&&Number.isFinite(e.requiredIntervalMs)&&(t.requiredIntervalMs=Math.max(0,e.requiredIntervalMs)),typeof e.name=="string"){const r=e.name.trim();t.hasName=r.length>0,t.nameLength=r.length,t.nameWasAutoGenerated=r.startsWith("auto-backup-")}return typeof e.createdAt=="string"&&e.createdAt&&(t.createdAt=e.createdAt),t}const Gz=120*1e3,oh=new Map,kz=800;let $n=0,bm=!1,nu=!1,kg=0,Bi=0;function Kv(){$n=0}function na(e,t){if(bm=!1,!e||typeof e!="object"){Gg("warn","Auto backup run recorded without result metadata",{status:"unknown"});return}const r=typeof e.status=="string"?e.status:null,o=typeof e.reason=="string"?e.reason:null,n=t&&typeof t=="object"?{...t}:Oz(e),a=Iz(r,o),i=Tz(r,o);if(Gg(a,i,n),r==="skipped"){o==="unchanged"&&Kv();return}r&&r!=="error"&&(Kv(),r==="success"&&(kg=Date.now()))}function Bz(e){return typeof e!="string"||!e?!1:Sz.includes(e)}function Pz(){const e=cl(),t=e&&typeof e.__cineShowAutoBackupIndicator=="function"?e.__cineShowAutoBackupIndicator:null;if(!t)return()=>{};try{const r=tU(),o=t(r);return typeof o=="function"?o:()=>{}}catch(r){return console.warn("Failed to show auto backup indicator",r),()=>{}}}function $L(e){if(bm)return;bm=!0;const t=()=>{try{Za({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"change-threshold"})}catch(o){console.warn("Failed to run auto backup after change threshold",o),bm=!1,Gg("error","Auto backup change-threshold execution failed",{status:"error",reason:"change-threshold-run",errorName:o&&typeof o.name=="string"?o.name:null,errorMessage:o&&typeof o.message=="string"?o.message:null})}};if(typeof queueMicrotask=="function")try{queueMicrotask(t);return}catch(o){console.warn("Failed to queue auto backup microtask",o),Gg("warn","Auto backup microtask scheduling failed",{status:"skipped",reason:"microtask-scheduling",errorName:o&&typeof o.name=="string"?o.name:null,errorMessage:o&&typeof o.message=="string"?o.message:null})}const r=setTimeout(t,0);r&&typeof r.unref=="function"&&r.unref()}function Fk(e={}){if(e&&e.reset===!0){Kv(),nu=!1,Bi=0;return}const t=!!(e&&e.pending===!0),r=!!(e&&e.commit===!0),o=e&&typeof e.context=="object"&&e.context!==null?e.context:null;if(t){nu=!0;return}if(!(r&&!nu&&e.force!==!0)){if(r||nu){if(nu=!1,!!(o&&o.immediate===!0)){let a=null;if(o&&typeof o.completedAt=="number"&&Number.isFinite(o.completedAt)?a=o.completedAt:o&&typeof o.requestedAt=="number"&&Number.isFinite(o.requestedAt)&&(a=o.requestedAt),Number.isFinite(a)||(a=Date.now()),e.force!==!0&&Bi>0&&a>=Bi&&a-Bi<kz){Bi=a;return}(a>=Bi||Bi<=0)&&(Bi=a)}$n=Math.min(Ki,$n+1),$n>=Ki&&$L();return}$n=Math.min(Ki,$n+1),$n>=Ki&&$L()}}try{const e=cl();e&&(e.__cineNoteAutoBackupChange=Fk)}catch(e){console.warn("Failed to expose auto backup change tracker",e)}function qL(e){if(!e||typeof e!="object")return;try{e[DL]=!0}catch{}const t=e.projectInfo;if(t&&typeof t=="object")try{t[DL]=!0}catch{}}function ir(e,t=[],r={}){if(typeof callCoreFunctionIfAvailable=="function")return callCoreFunctionIfAvailable(e,t,r);const o=(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null)||null,n=typeof e=="string"?o&&o[e]:e;if(typeof n=="function"){try{return n.apply(o,t)}catch(a){if(Ht&&typeof Ht.error=="function"){const i={functionName:e,deferred:!!(r&&r.defer),argumentsSnapshot:Array.isArray(t)?t.slice(0,5):null};try{Ht.error(`Failed to invoke ${e}`,a,i)}catch{}}typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,a)}return}if(r&&r.defer===!0){const a=o&&Array.isArray(o.CORE_BOOT_QUEUE)?o.CORE_BOOT_QUEUE:null;a&&a.push(()=>{ir(e,t,{...r,defer:!1})})}return r&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}const VL=Object.freeze({missing:!0}),WL=(function(){if(typeof require=="function")try{const t=require("./modules/video-power-inputs.js");if(t&&typeof t=="object")return t}catch{}return{}})();function fs(e,t=[]){const r=ir(e,t,{defaultValue:VL});if(r===VL){const o=new ReferenceError(`Missing core function: ${e}`);if(Ht&&typeof Ht.error=="function")try{Ht.error(`Missing core function: ${e}`,o)}catch{}throw o}return r}function nh(e){let t;try{t=ir("firstPowerInputType",[e])}catch(r){if(Ht&&typeof Ht.warn=="function")try{Ht.warn("Failed to resolve firstPowerInputType from core",r,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to resolve firstPowerInputType from core",r)}if(typeof t=="string")return t;if(Array.isArray(t)&&t.length)return typeof t[0]=="string"?t[0]:"";if(t&&typeof t=="object"){const r=t.type||t.portType;if(typeof r=="string")return r}return""}function xz(e,t=[]){const r=Array.isArray(t)?t.slice():[];try{const o=ir(e);if(Array.isArray(o))return o.slice()}catch(o){if(Ht&&typeof Ht.warn=="function")try{Ht.warn(`Failed to resolve ${e}`,o)}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Failed to resolve ${e}`,o)}return r}function Mz(e){const t=cl();if(!t||!e)return[];const r=t[e];return Array.isArray(r)?r.slice():[]}function Dz(e,t){const r=cl();if(!(!r||!e)){if(!Array.isArray(t)){delete r[e];return}try{r[e]=t.slice()}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Failed to persist ${e} options on the global scope`,o)}}}function is(e,t,r=[]){const o=[],n=new Set,a=u=>{if(Array.isArray(u))for(let l=0;l<u.length;l+=1){const d=u[l];typeof d=="string"&&(n.has(d)||(n.add(d),o.push(d)))}};a(r),a(Mz(e));const i=xz(t,o),s=Array.isArray(i)?i:o;return Dz(e,s),s}const _z=typeof viewfinderTypeOptions<"u"&&Array.isArray(viewfinderTypeOptions)?viewfinderTypeOptions:[];viewfinderTypeOptions=is("viewfinderTypeOptions","getAllViewfinderTypes",_z);const Fz=typeof viewfinderConnectorOptions<"u"&&Array.isArray(viewfinderConnectorOptions)?viewfinderConnectorOptions:[];viewfinderConnectorOptions=is("viewfinderConnectorOptions","getAllViewfinderConnectors",Fz);function Nz(){return typeof globalThis<"u"&&typeof globalThis.hasAnyDeviceSelection=="function"?globalThis.hasAnyDeviceSelection:typeof window<"u"&&typeof window.hasAnyDeviceSelection=="function"?window.hasAnyDeviceSelection:typeof self<"u"&&typeof self.hasAnyDeviceSelection=="function"?self.hasAnyDeviceSelection:typeof global<"u"&&typeof global.hasAnyDeviceSelection=="function"?global.hasAnyDeviceSelection:null}function Xy(){if(typeof refreshDeviceLists=="function")try{refreshDeviceLists();return}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("refreshDeviceLists failed, retrying via core bridge.",e)}if(typeof ir=="function")try{ir("refreshDeviceLists")}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not refresh device lists via core bridge.",e)}}function Nk(e){const t=Nz();if(t)try{return t(e)}catch(n){if(Ht&&typeof Ht.warn=="function"){const a=e&&typeof e=="object"?Object.keys(e).slice(0,10):null;try{Ht.warn("Failed to evaluate device selections via core helper",n,{statePreview:a})}catch{}}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to evaluate device selections via core helper",n)}if(!e||typeof e!="object")return!1;const r=n=>{if(Array.isArray(n))return n.some(i=>r(i));if(n==null)return!1;const a=typeof n=="string"?n.trim():n;if(!a)return!1;if(typeof a=="string"){const i=a.toLowerCase();if(i==="none"||i==="--"||i==="—"||i==="n/a"||i==="tbd"||i==="pending"||i.startsWith("-- ")||i.startsWith("— ")||i.startsWith("select ")||i.startsWith("choose ")||i.startsWith("pick ")||i.startsWith("add "))return!1}return!0};return!!([e.camera,e.monitor,e.video,e.cage,e.batteryPlate,e.battery,e.batteryHotswap].some(n=>r(n))||r(e.motors)||r(e.controllers)||r(e.distance))}function KL(e,t={}){const r=Object.prototype.hasOwnProperty.call(t,"defaultValue")?t.defaultValue:"",o=ir(e,[],{defaultValue:r});if(typeof o=="string")return o;if(o==null)return r;try{return String(o)}catch{return r}}function Zy(e){ir("storeLoadedSetupState",[e],{defaultValue:void 0})}function Hz(){const e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof self<"u"&&e.push(self),typeof global<"u"&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"))try{if(r.cineUi&&typeof r.cineUi=="object")return r.cineUi}catch{}}return null}function Kc(){if(typeof setupSelect<"u"&&setupSelect)return setupSelect;if(typeof document<"u"&&document){const e=document.getElementById("setupSelect");if(e)return e}return null}mz(tB);Bo("languageSelect","change",e=>{const t=()=>{if(typeof populateUserButtonDropdowns=="function")try{populateUserButtonDropdowns()}catch(r){console.warn("Failed to refresh user button selectors after manual language change",r)}};try{const r=setLanguage(e.target.value);if(r&&typeof r.then=="function"){r.then(t).catch(o=>{console.warn("Language selection update failed",o)});return}}catch(r){console.warn("Language selection handler threw",r)}t()});Bo("skipLink","click",()=>{const e=document.getElementById("mainContent");e&&e.focus()});function YL(e){const t=e&&e.silent===!0,r=texts[currentLang]||{},o=texts.en||{};if(typeof applyPendingProjectNameCollisionResolution=="function")try{applyPendingProjectNameCollisionResolution()}catch(L){console.warn("Failed to finalize pending project name collision before saving setup",L)}const n=setupNameInput.value.trim();if(!n){t||(typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupNameTitle||o.alertSetupNameTitle||"Project Name Required",message:texts[currentLang].alertSetupName}):alert(texts[currentLang].alertSetupName));return}const a={...getCurrentSetupState()},i=Nk(a),s=getCurrentGearListHtml();s&&(a.gearList=s);const u=Kc(),l=u&&typeof u.value=="string"?u.value:"",d=!!(l&&n&&l!==n),p=d&&typeof l=="string"&&l.startsWith("auto-backup-");let g=getSetups();const h=d?JSON.parse(JSON.stringify(g||{})):null;let A=n,m=null,y=!d,S=!1;if(d){if(typeof loadProject=="function")try{m=loadProject(l)}catch(L){console.warn("Failed to load project data while renaming setup",L)}if(typeof renameSetup=="function"){try{const L=renameSetup(l,n);typeof L=="string"&&L&&(A=L)}catch(L){console.warn("Failed to rename setup in storage",L)}g=getSetups()}else Object.prototype.hasOwnProperty.call(g,l)&&(g[n]=g[l],delete g[l],A=n)}const E=typeof A=="string"&&A.startsWith("auto-backup-");if(p&&E&&qL(a),g[A]=a,storeSetups(g),d&&m&&typeof saveProject=="function"){S=!0;try{p&&E&&qL(m),saveProject(A,m,{skipOverwriteBackup:!0,renamedFrom:l}),y=!0}catch(L){y=!1,console.warn("Failed to preserve project data during setup rename",L)}if(y&&typeof loadProject=="function")try{const L=loadProject(A);y=!!(L&&typeof L=="object")}catch(L){y=!1,console.warn("Failed to confirm project data after setup rename",L)}}else d&&m&&(S=!0,y=!1);if(d&&S&&!y){h&&(storeSetups(h),g=h),A=l;const L=r.alertSetupRenameSaveFailed||o.alertSetupRenameSaveFailed;if(typeof L=="string"&&L)if(typeof showNotification=="function")try{showNotification("warning",L)}catch{}else typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupRenameSaveFailedTitle||"Rename Failed",message:L}):alert(L)}if(kc(),t||(setupNameInput.value=A),u&&(u.value=A),ua=A,saveCurrentSession(),Zy(getCurrentSetupState()),checkSetupChanged(),saveCurrentGearList(),d&&l&&l!==A&&y){if(typeof deleteProject=="function")try{deleteProject(l)}catch(L){console.warn("Failed to remove old project entry during setup rename",L)}else if(typeof saveProject=="function")try{saveProject(l,{projectInfo:null,gearList:""},{skipOverwriteBackup:!0})}catch(L){console.warn("Failed to clear legacy project entry during setup rename",L)}}saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim());const I=i?r.alertSetupSaved||o.alertSetupSaved:r.alertSetupSavedNoDevices||o.alertSetupSavedNoDevices||r.alertSetupSaved||o.alertSetupSaved;if(!t&&typeof I=="string"&&I){const L=I.replace("{name}",A);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupSavedTitle||o.alertSetupSavedTitle||"Project Saved",message:L}):alert(L)}}function dC(e){typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Saving Project..."),typeof setTimeout=="function"?setTimeout(function(){try{YL(e)}catch(t){console.error("Save failed:",t),alert("Save failed: "+t.message)}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},50):(YL(e),typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading())}Bo("saveSetupBtn","click",dC);setupNameInput&&(Bo("setupName","input",function(){if(saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim()),typeof checkSetupChanged=="function")try{checkSetupChanged()}catch(e){console.warn("Failed to evaluate setup change status after name update",e)}}),Bo("setupName","keydown",function(e){e.isComposing||e.key==="Enter"&&(e.preventDefault(),dC(e))}));function jz(){const e=Kc(),t=e&&typeof e.value=="string"?e.value:"";if(!t){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertNoSetupSelectedTitle||"No Project Selected",message:texts[currentLang].alertNoSetupSelected}):alert(texts[currentLang].alertNoSetupSelected);return}const r=()=>{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Deleting Project..."),setTimeout(()=>{try{if(!Kz("delete setup"))return;let n=getSetups();delete n[t],storeSetups(n),typeof deleteProject=="function"&&deleteProject(t),kc(),setupNameInput.value="";let a=!1;if(e&&typeof e.dispatchEvent=="function"&&(ua="",e.value="",e.dispatchEvent(new Event("change")),a=!0),!a){gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList.add("hidden")),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList.add("hidden")),currentProjectInfo=null,projectForm&&populateProjectForm({}),Zy(null),updateBatteryPlateVisibility(),updateBatteryOptions(),clearProjectAutoGearRules(),renderAutoGearRulesList(),updateAutoGearCatalogOptions(),[cameraSelect,monitorSelect,videoSelect,cageSelect,distanceSelect,batterySelect,hotswapSelect].forEach(u=>{Array.from(u.options).find(d=>d.value==="None")?u.value="None":u.selectedIndex=0}),typeof updateCageSelectOptions=="function"&&updateCageSelectOptions("None");const s=getSliderBowlSelect();s&&(s.value=""),motorSelects.forEach(u=>{u.options.length&&(u.value="None")}),controllerSelects.forEach(u=>{u.options.length&&(u.value="None")}),updateCalculations()}const i=texts[currentLang].alertSetupDeleted.replace("{name}",t);typeof window.cineShowAlertDialog=="function"&&(window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].deleteSetupTitle||"Project Deleted",message:i}),alert(i))}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},50)};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].deleteSetupTitle||"Delete Project",message:texts[currentLang].confirmDeleteSetup.replace("{name}",t),confirmLabel:"Delete",danger:!0,onConfirm:()=>{setTimeout(()=>{window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].areYouSure||"Are you sure?",message:texts[currentLang].confirmDeleteSetupAgain,confirmLabel:"Confirm Delete",danger:!0,onConfirm:()=>r()})},150)}}):confirm(texts[currentLang].confirmDeleteSetup.replace("{name}",t))&&confirm(texts[currentLang].confirmDeleteSetupAgain)&&r()}function Hk(){jz()}Bo("deleteSetupBtn","click",Hk);function zz(e={}){const t=typeof suspendProjectPersistence=="function"&&typeof resumeProjectPersistence=="function";if(t)try{suspendProjectPersistence()}catch(n){console.warn("Failed to suspend project persistence during setup reset",n)}const o=!!(typeof e=="object"&&e!==null?e:{}).preserveSetupNameInput;try{!o&&setupNameInput&&(setupNameInput.value="");const n=i=>{if(!i||typeof i!="object")return;const s=i===cameraSelect;Array.from(i.options||[]).find(l=>l.value==="None")?i.value="None":i.options&&i.options.length?i.selectedIndex=0:i.value="",s&&ir("updateRecordingMediaOptions")};if([cameraSelect,monitorSelect,videoSelect,cageSelect,distanceSelect,batterySelect,hotswapSelect].forEach(n),typeof updateCageSelectOptions=="function")try{updateCageSelectOptions("None")}catch(i){console.warn("Failed to reset cage options while preparing setup switch",i)}const a=typeof getSliderBowlSelect=="function"?getSliderBowlSelect():null;if(a&&(a.value=""),Array.isArray(motorSelects)&&motorSelects.forEach(n),Array.isArray(controllerSelects)&&controllerSelects.forEach(n),typeof updateBatteryPlateVisibility=="function")try{updateBatteryPlateVisibility()}catch(i){console.warn("Failed to reset battery plate visibility while preparing setup switch",i)}if(typeof updateBatteryOptions=="function")try{updateBatteryOptions()}catch(i){console.warn("Failed to reset battery options while preparing setup switch",i)}if(typeof displayGearAndRequirements=="function")try{displayGearAndRequirements("")}catch(i){console.warn("Failed to reset gear and requirements display while preparing setup switch",i)}if(gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList&&gearListOutput.classList.add("hidden")),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList&&projectRequirementsOutput.classList.add("hidden")),currentProjectInfo=null,projectForm)try{populateProjectForm({})}catch(i){console.warn("Failed to reset project form while preparing setup switch",i)}if(typeof clearProjectAutoGearRules=="function")try{clearProjectAutoGearRules()}catch(i){console.warn("Failed to clear project auto gear rules while preparing setup switch",i)}if(typeof setManualDiagramPositions=="function")try{setManualDiagramPositions({},{render:!1})}catch(i){console.warn("Failed to reset manual diagram positions while preparing setup switch",i)}try{Zy(null)}catch(i){console.warn("Failed to reset stored setup state while preparing setup switch",i)}typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml="")}finally{if(t)try{resumeProjectPersistence()}catch(n){console.warn("Failed to resume project persistence after setup reset",n)}}}function QL(e){if(typeof renderAutoGearRulesList=="function")try{renderAutoGearRulesList()}catch(t){console.warn("Failed to render auto gear rules list after setup switch",t)}if(typeof updateAutoGearCatalogOptions=="function")try{updateAutoGearCatalogOptions()}catch(t){console.warn("Failed to update auto gear catalog options after setup switch",t)}if(saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim()),typeof updateCalculations=="function")try{updateCalculations()}catch(t){console.warn("Failed to update calculations after setup switch",t)}if(typeof checkSetupChanged=="function")try{checkSetupChanged()}catch(t){console.warn("Failed to evaluate setup changes after setup switch",t)}typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(e),ua=e}Kc();Bo("setupSelect","change",e=>{const t=e.target.value,r=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",o=r.trim(),n=(ua&&typeof ua=="string"?ua:"")||o||"";typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(n);const a=l=>typeof l=="string"?l.replace(/\s+/g," ").trim():"",i=a(ua),s=a(t);let u=!1;if(typeof scheduleProjectAutoSave=="function")try{const l=typeof normalizeSetupName=="function"?normalizeSetupName:(h=>typeof h=="string"?h.trim():""),d=l(typeof ua=="string"?ua:""),p=l(n),g={setupNameState:{typedName:o,selectedName:d,storageKey:p,renameInProgress:!!(d&&o&&o!==d),typedNameHasTrailingWhitespace:!!(o&&typeof r=="string"&&/\s$/.test(r))}};scheduleProjectAutoSave({immediate:!0,overrides:g}),u=!0}catch(l){console.warn("Failed to flush project autosave before switching setups",l)}if(!u)try{typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof saveCurrentGearList=="function"&&saveCurrentGearList()}catch(l){console.warn("Failed to persist project state before switching setups",l)}if(typeof saveProject=="function"){const l=projectForm?collectProjectFormData():{};l&&(l.sliderBowl=KL("getSliderBowlValue"),l.easyrig=KL("getEasyrigValue"));const d=deriveProjectInfo(l);currentProjectInfo=d;const p=typeof normalizeSetupName=="function"?normalizeSetupName:(I=>typeof I=="string"?I.trim():""),g=p(n),h=p(o),A=!!(g&&h&&h!==g),m=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(d,{projectNameOverride:A?g:void 0}):d,y=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null,S={projectInfo:m,gearList:getCurrentGearListHtml()};if(y&&(S.powerSelection=y),typeof getDiagramManualPositions=="function"){const I=getDiagramManualPositions();I&&Object.keys(I).length&&(S.diagramPositions=I)}const E=getProjectScopedAutoGearRules();E&&E.length&&(S.autoGearRules=E),saveProject(n,S,{skipOverwriteBackup:!0})}if(typeof Za=="function"&&s!==i)try{Za({suppressSuccess:!0,projectNameOverride:a(n),triggerAutoSaveNotification:!0,reason:"project-switch"})}catch(l){console.warn("Failed to auto backup project before loading a different setup",l)}if(zz(),t===""){QL(t);return}{const d=getSetups()[t];if(d){setupNameInput.value=t,cameraSelect.value=d.camera||"None",ir("updateRecordingMediaOptions"),updateBatteryPlateVisibility(),batteryPlateSelect.value=d.batteryPlate||batteryPlateSelect.value,applyBatteryPlateSelectionFromBattery(d.battery||"",batteryPlateSelect.value),monitorSelect.value=d.monitor||"None",videoSelect.value=d.video||"None",typeof updateCageSelectOptions=="function"?updateCageSelectOptions(d.cage||"None"):cageSelect&&(cageSelect.value=d.cage||"None"),(d.motors||[]).forEach((S,E)=>{motorSelects[E]&&(motorSelects[E].value=S)}),(d.controllers||[]).forEach((S,E)=>{controllerSelects[E]&&(controllerSelects[E].value=S)}),distanceSelect.value=d.distance||"None",batterySelect.value=d.battery||"None",applyBatteryPlateSelectionFromBattery(d.battery||"",batteryPlateSelect?batteryPlateSelect.value:""),hotswapSelect.value=d.batteryHotswap||"None",setSliderBowlValue(d.sliderBowl||""),setEasyrigValue(d.easyrig||"");let p=!1;d.powerSelection&&typeof applyStoredPowerSelection=="function"&&(p=applyStoredPowerSelection(d.powerSelection,{preferExisting:!1}));const g=typeof loadProject=="function"?loadProject(t):null;!p&&g&&typeof applyStoredPowerSelection=="function"&&g.powerSelection&&(p=applyStoredPowerSelection(g.powerSelection,{preferExisting:!1})),updateBatteryOptions(),!p&&g&&typeof applyStoredPowerSelection=="function"&&g.powerSelection&&(p=applyStoredPowerSelection(g.powerSelection,{preferExisting:!1}),p&&updateBatteryOptions());const h=typeof d.gearList=="string"&&d.gearList?d.gearList:typeof g?.gearList=="string"?g.gearList:"";currentProjectInfo=d.projectInfo||g?.projectInfo||null;const A=S=>ir("generateGearListHtml",[S||{}],{defaultValue:""})||"";let m=h;if(m||(m=A(currentProjectInfo||{})),m&&typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml=m),typeof setManualDiagramPositions=="function"){let S={};if(typeof normalizeDiagramPositionsInput=="function"){S=normalizeDiagramPositionsInput(g?.diagramPositions);const E=normalizeDiagramPositionsInput(d.diagramPositions);Object.keys(E).length&&(S={...S,...E})}setManualDiagramPositions(S,{render:!1})}const y=Array.isArray(d.autoGearRules)&&d.autoGearRules.length?d.autoGearRules:Array.isArray(g?.autoGearRules)&&g.autoGearRules.length?g.autoGearRules:null;if(y?useProjectAutoGearRules(y):clearProjectAutoGearRules(),gearListOutput&&(displayGearAndRequirements(m),populateProjectForm(currentProjectInfo||{}),m&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener()),typeof saveProject=="function")){const S={projectInfo:currentProjectInfo,gearListAndProjectRequirementsGenerated:!!m},E=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null;if(E&&(S.powerSelection=E),typeof getDiagramManualPositions=="function"){const L=getDiagramManualPositions();L&&Object.keys(L).length&&(S.diagramPositions=L)}const I=getProjectScopedAutoGearRules();I&&I.length&&(S.autoGearRules=I),d.gearSelectors&&Object.keys(d.gearSelectors).length?S.gearSelectors=d.gearSelectors:g?.gearSelectors&&Object.keys(g.gearSelectors).length&&(S.gearSelectors=g.gearSelectors),saveProject(t,S,{skipOverwriteBackup:!0})}}else{const p=typeof loadProject=="function"?loadProject(t):null;if(p&&typeof applyStoredPowerSelection=="function"&&p.powerSelection?applyStoredPowerSelection(p.powerSelection,{preferExisting:!1})&&updateBatteryOptions():updateBatteryOptions(),currentProjectInfo=p?.projectInfo||null,projectForm&&populateProjectForm(currentProjectInfo||{}),gearListOutput){const g=m=>ir("generateGearListHtml",[m||{}],{defaultValue:""})||"",A=(typeof p?.gearList=="string"?p.gearList:"")||g(currentProjectInfo||{});displayGearAndRequirements(A),A&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener())}else displayGearAndRequirements("");if(clearProjectAutoGearRules(),typeof setManualDiagramPositions=="function"){const g=p?.diagramPositions&&typeof normalizeDiagramPositionsInput=="function"?normalizeDiagramPositionsInput(p.diagramPositions):{};setManualDiagramPositions(g||{},{render:!1})}}Zy(getCurrentSetupState())}QL(t)});function kc(){const e=typeof getSetups=="function"?getSetups:null,t=Kc();if(!t){console.warn("populateSetupSelect: setup select element unavailable, aborting populate");return}const r=typeof texts=="object"&&texts?texts[currentLang]||texts.en||{}:{},o=typeof r.newSetupOption=="string"&&r.newSetupOption.trim()?r.newSetupOption:"New setup";e||console.warn("populateSetupSelect: getSetups is unavailable, using empty setup list");const n=e?e()||{}:{};t.innerHTML=`<option value="">${o}</option>`;let a=!1;if(typeof loadAutoGearBackupVisibility=="function")a=loadAutoGearBackupVisibility();else if(typeof showAutoBackups=="boolean")a=showAutoBackups;else if(typeof localStorage<"u")try{a=localStorage.getItem("showAutoBackups")==="true"}catch(s){console.warn("Could not read auto backup visibility preference",s)}if(a&&typeof ensureAutoBackupsFromProjects=="function")try{ensureAutoBackupsFromProjects()}catch(s){console.warn("Failed to prepare auto backups before populating selector",s)}const i=Object.keys(n).filter(s=>a||!s.startsWith("auto-backup-")).sort((s,u)=>{const l=s.startsWith("auto-backup-"),d=u.startsWith("auto-backup-");return l!==d?l?1:-1:localeSort(s,u)});for(const s of i){const u=document.createElement("option");u.value=s,u.textContent=s,t.appendChild(u)}if(typeof document<"u"&&document.dispatchEvent&&typeof CustomEvent=="function")try{document.dispatchEvent(new CustomEvent("cine:setupselect:populated",{detail:{count:i.length,timestamp:Date.now()}}))}catch{}}typeof Tg.whenElementAvailable=="function"?Tg.whenElementAvailable("setupSelect",()=>{kc(),typeof checkSetupChanged=="function"&&checkSetupChanged()}):(kc(),typeof checkSetupChanged=="function"&&checkSetupChanged());function Uz(e,t,r){if(typeof e!="string")return;const o=e.trim();if(!o)return;const n="success";if(typeof showNotification=="function")try{showNotification(n,o)}catch(a){console.warn("Failed to display auto save notification after auto backup",a)}if(typeof document<"u"&&typeof CustomEvent=="function"&&document&&typeof document.dispatchEvent=="function")try{document.dispatchEvent(new CustomEvent("cine:auto-save-notification",{detail:{message:o,source:"auto-backup",backupName:t||null,severity:n,timestamp:new Date().toISOString()}}))}catch(a){console.warn("Failed to dispatch auto save notification event after auto backup",a)}}const $z=30;let Bs=null,Pu=null,xu=null;function Bg(e){if(e===null)return"null";if(e===void 0)return"undefined";if(Array.isArray(e)){let r="[";for(let o=0;o<e.length;o+=1)o>0&&(r+=","),r+=Bg(e[o]);return r+="]",r}if(e instanceof Date){const r=e.getTime();return Number.isNaN(r)?"date:invalid":`date:${r}`}const t=typeof e;if(t==="number")return Number.isNaN(e)?"number:NaN":Number.isFinite(e)?`number:${e}`:e>0?"number:Infinity":"number:-Infinity";if(t==="bigint")return`bigint:${e.toString()}`;if(t==="boolean")return e?"boolean:true":"boolean:false";if(t==="string")return`string:${e}`;if(t==="symbol")return`symbol:${String(e)}`;if(t==="function")return`function:${e.name||"anonymous"}`;if(t==="object"){const r=Object.keys(e).sort();let o="{";for(let n=0;n<r.length;n+=1){const a=r[n];n>0&&(o+=","),o+=`${JSON.stringify(a)}:${Bg(e[a])}`}return o+="}",o}return`${t}:${String(e)}`}function jk(e,t,r){return Bg({setup:e||null,gearSelectors:t||null,gearListGenerated:!!r})}function qz(e,t,r){const o=Nk(e),n=!!(e&&typeof e=="object"&&e.projectInfo),a=Array.isArray(e&&e.autoGearRules)&&e.autoGearRules.length>0,i=!!(e&&e.diagramPositions&&typeof e.diagramPositions=="object"&&Object.keys(e.diagramPositions).length>0),s=!!(t&&typeof t=="object"&&Object.keys(t).length>0),u=!!(e&&e.powerSelection&&typeof e.powerSelection=="object"&&Object.keys(e.powerSelection).length>0);return o||n||a||i||s||u||!!r}function zk(e){return!e||typeof e!="object"?[]:Object.keys(e).filter(t=>typeof t=="string"&&t.startsWith("auto-backup-")).sort()}function Uk(e){const t=zk(e);if(!t.length)return{name:null,entry:null};const r=t[t.length-1],o=e&&typeof e=="object"?e[r]:null;return{name:r,entry:o}}function $k(e,t){if(!t||typeof t!="object")return Bg(null);let r=null;t.gearSelectors&&typeof t.gearSelectors=="object"&&(r=t.gearSelectors);let o=!1;if(typeof loadProject=="function"&&e)try{const n=loadProject(e);n&&typeof n=="object"&&(!r&&n.gearSelectors&&typeof n.gearSelectors=="object"&&(r=n.gearSelectors),typeof n.gearListAndProjectRequirementsGenerated=="boolean"&&(o=n.gearListAndProjectRequirementsGenerated))}catch(n){console.warn("Failed to inspect stored project payload for auto backup signature",n)}return jk(t,r,o)}function Vz(e){if(Bs||!e||typeof e!="object")return;const{name:t,entry:r}=Uk(e);if(!(!t||!r||typeof r!="object"))try{Bs=$k(t,r),Pu=t;const o=fC(r);if(o&&typeof o.createdAt=="string"){xu=o.createdAt;const n=Date.parse(o.createdAt);Number.isNaN(n)||(kg=n)}}catch(o){Bs=null,console.warn("Failed to prime automatic backup signature cache",o)}}function fC(e){if(!e||typeof e!="object")return null;const t=e.__cineAutoBackupMetadata;return!t||typeof t!="object"?null:t}function XL(e,t){if(!e||typeof e!="object")return;const r=t&&typeof t=="object"?{version:typeof t.version=="number"?t.version:1,snapshotType:t.snapshotType==="delta"?"delta":"full",base:typeof t.base=="string"?t.base:null,sequence:typeof t.sequence=="number"?t.sequence:0,createdAt:typeof t.createdAt=="string"?t.createdAt:null,changedKeys:Array.isArray(t.changedKeys)?t.changedKeys.slice():[],removedKeys:Array.isArray(t.removedKeys)?t.removedKeys.slice():[]}:null;try{Object.defineProperty(e,"__cineAutoBackupMetadata",{configurable:!0,enumerable:!1,writable:!0,value:r})}catch{try{e.__cineAutoBackupMetadata=r}catch{}}}function Wz(e){if(!e||typeof e!="object")return{snapshotType:"full",base:null,sequence:0};const t=zk(e);if(!t.length)return{snapshotType:"full",base:null,sequence:0};const r=t[t.length-1],o=e[r],n=fC(o);if(!o||!n)return{snapshotType:"full",base:null,sequence:0};const a=typeof n.sequence=="number"?n.sequence:0;return a>=$z?{snapshotType:"full",base:null,sequence:0}:{snapshotType:"delta",base:r,sequence:a+1}}function Za(e={}){const t=Kc();if(!t)return null;const r=typeof e=="object"&&e!==null?e:{},o=!!r.suppressSuccess,n=!!r.suppressError,a=r.force===!0,i=typeof r.reason=="string"&&r.reason?r.reason:"unspecified",s=typeof r.successMessage=="string"&&r.successMessage?r.successMessage:"Auto backup saved",u=typeof r.errorMessage=="string"&&r.errorMessage?r.errorMessage:"Auto backup failed",l=!!r.triggerAutoSaveNotification,d=typeof r.autoSaveNotificationMessage=="string"&&r.autoSaveNotificationMessage.trim()?r.autoSaveNotificationMessage.trim():s,p=oe=>typeof oe=="string"?oe.replace(/\s+/g," ").trim():"",h=Object.prototype.hasOwnProperty.call(r,"projectNameOverride")?p(r.projectNameOverride):null,A=typeof t.value=="string"?t.value:"",m=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",y=p(A),S=p(m),E=oe=>typeof oe=="string"&&oe.startsWith("auto-backup-"),R=Date.now()-(kg||0),G=R>=Bu,j=$n>=Ki;if(!a&&!Az.has(i)&&!G&&!j){const oe=Math.max(0,Bu-R),k={status:"skipped",reason:"cadence",context:i,elapsedSinceLastAutoBackupMs:R,changesSinceSnapshot:$n,requiredIntervalMs:Bu,requiredChangeThreshold:Ki,remainingIntervalMs:oe,remainingChanges:Math.max(0,Ki-$n)};return typeof console<"u"&&typeof console.debug=="function"&&console.debug("Skipping auto backup because cadence requirements are not met.",k),na(k),k}if(!a&&!Bz(i)){const oe={status:"skipped",reason:"disallowed",context:i||null};return typeof console<"u"&&typeof console.debug=="function"&&console.debug("Skipping auto backup run because the trigger is not permitted.",{trigger:i}),na(oe),oe}if(!a&&vz.has(i)){const ue=Date.now()-(kg||0)>=Bu,H=$n>=Ki;if(!ue&&!H){const Y={status:"skipped",reason:"rate-limited",context:i};return na(Y),Y}}let z="";if(h!=null){if(h&&E(h)){const oe={status:"skipped",reason:"auto-backup-selected",context:i};return na(oe),oe}z=h}else if(y&&E(y))if(S&&!E(S)&&S!==y)z=S;else{const oe={status:"skipped",reason:"auto-backup-selected",context:i};return na(oe),oe}else y?z=y:S&&(z=S);let te=null;try{te=Pz()}catch(oe){console.warn("Failed to prepare auto backup indicator",oe),te=null}try{const oe=ft=>String(ft).padStart(2,"0"),k=new Date,Z=`auto-backup-${k.getFullYear()}-${oe(k.getMonth()+1)}-${oe(k.getDate())}-${oe(k.getHours())}-${oe(k.getMinutes())}-${oe(k.getSeconds())}`,ue=z||"",H={...getCurrentSetupState()},Y=getSetups();let N=ue?`${Z}-${ue}`:Z;if(Y&&typeof Y=="object"){let ft=1;for(;Object.prototype.hasOwnProperty.call(Y,N);){const D=`copy-${ft}`,q=`${Z}-${D}`;N=ue?`${q}-${ue}`:q,ft+=1}}Vz(Y);const ae=Wz(Y);let de=ae;if(ae.snapshotType==="delta"){const ft=ae.base&&Y?Y[ae.base]:null;(!ft||typeof ft!="object")&&(de={snapshotType:"full",base:null,sequence:0})}const Q=getCurrentGearListHtml(),ne=!!Q;let V=null;H.gearListAndProjectRequirementsGenerated=ne;const fe=ir("getGearListSelectors",[],{defaultValue:{}})||{},J=ir("cloneGearListSelectors",[fe],{defaultValue:{}})||{};if(!qz(H,J,ne)){const ft={status:"skipped",reason:"empty",context:i};return na(ft),ft}J&&Object.keys(J).length&&(H.gearSelectors=J);const Ae=jk(H,J,ne),{name:Le,entry:_e}=Uk(Y);if(!a&&Le&&_e)try{if($k(Le,_e)===Ae){const D=fC(_e),q=D&&typeof D.createdAt=="string"?D.createdAt:null;return Bs=Ae,Pu=Le,xu=q,na({status:"skipped",reason:"unchanged",name:Le,createdAt:q,context:i}),oh.set(i,{timestamp:k.valueOf(),signature:Ae}),{status:"skipped",reason:"unchanged",name:Le,createdAt:q,context:i}}}catch(ft){console.warn("Failed to compare current auto backup against latest snapshot before saving",ft)}if(!a){const ft=oh.get(i);if(ft&&k.valueOf()-ft.timestamp<Gz&&ft.signature===Ae){const q={status:"skipped",reason:"duplicate-reason",name:Pu||null,createdAt:xu||null,context:i};return na(q),q}}if(!a&&Bs&&Ae===Bs){const ft={status:"skipped",reason:"unchanged",name:Pu||null,createdAt:xu||null,context:i};return na(ft),ft}const Je=k.toISOString(),xe={version:1,snapshotType:de.snapshotType,base:de.base,sequence:de.sequence,createdAt:Je,changedKeys:[],removedKeys:[]};XL(H,xe);const Ze=Y;if(Ze[N]=H,storeSetups(Ze),typeof saveProject=="function"){const ft=typeof Q=="string"?Q:"";let D=H.projectInfo||null;if(D&&typeof createProjectInfoSnapshotForStorage=="function")try{D=createProjectInfoSnapshotForStorage(D)||D}catch(he){console.warn("Failed to normalize project info for auto backup payload",he)}if(D&&typeof ir=="function")try{const he=ir("cloneProjectInfoForStorage",[D],{defaultValue:D});he&&(D=he)}catch(he){console.warn("Failed to clone project info for auto backup payload",he)}const q={projectInfo:D,gearListAndProjectRequirementsGenerated:!!ft};ft&&(q.gearList=ft);const we=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null;if(we&&typeof we=="object"&&Object.keys(we).length&&(q.powerSelection=we),J&&Object.keys(J).length&&(q.gearSelectors=J),typeof getDiagramManualPositions=="function")try{const he=getDiagramManualPositions();he&&typeof he=="object"&&Object.keys(he).length&&(q.diagramPositions=he)}catch(he){console.warn("Failed to capture diagram positions for auto backup payload",he)}const ve=getProjectScopedAutoGearRules();if(ve&&ve.length){let he=ve;if(typeof ir=="function")try{he=ir("cloneProjectInfoForStorage",[ve],{defaultValue:ve})||ve}catch(ge){console.warn("Failed to clone auto gear rules for auto backup payload",ge)}q.autoGearRules=he}(q.projectInfo&&typeof q.projectInfo=="object"&&Object.keys(q.projectInfo).length||q.gearList||q.gearListAndProjectRequirementsGenerated||q.powerSelection&&Object.keys(q.powerSelection).length||q.gearSelectors&&Object.keys(q.gearSelectors).length||q.diagramPositions&&Object.keys(q.diagramPositions).length||q.autoGearRules&&q.autoGearRules.length)&&(XL(q,xe),saveProject(N,q)),V=UL(q)}const Ve=t.value,Dt=setupNameInput?setupNameInput.value:"";kc(),t.value=Ve,setupNameInput&&(setupNameInput.value=Dt),!o&&typeof showNotification=="function"&&showNotification("success",s),l&&Uz(d,N),Bs=Ae,Pu=N,xu=Je;const We={status:"success",reason:i,context:i,snapshotType:de.snapshotType,hasPlanBase:!!de.base,sequence:de.sequence,appendedProjectName:!!z,backupNameLength:typeof N=="string"?N.length:0,changesSinceSnapshot:$n,elapsedSinceLastAutoBackupMs:R,force:a,gearListGenerated:ne,payloadSummary:V||null};return na({status:"success",name:N,createdAt:Je,context:i},We),oh.set(i,{timestamp:k.valueOf(),signature:Ae}),N}catch(oe){console.warn("Auto backup failed",oe),!n&&typeof showNotification=="function"&&showNotification("error",u);const k={status:"error",reason:"exception",context:i,errorName:oe&&typeof oe.name=="string"?oe.name:null,errorMessage:oe&&typeof oe.message=="string"?oe.message:null};if(oe&&typeof oe.stack=="string"&&oe.stack){const Z=oe.stack.split(`
`).slice(0,5).join(`
`);k.errorStackPreview=Z}return na({status:"error",reason:"exception",context:i},k),null}finally{if(typeof te=="function")try{te()}catch(oe){console.warn("Failed to hide auto backup indicator",oe)}}}function Kz(e,t={}){const r=typeof t=="object"&&t!==null?t:{},o=texts[currentLang]||{},n=texts.en||{},a=r.successMessage||o.preDeleteBackupSuccess||n.preDeleteBackupSuccess||"Automatic backup saved. Restore it anytime from Saved Projects.",i=r.failureMessage||o.preDeleteBackupFailed||n.preDeleteBackupFailed||"Automatic backup failed. The action was cancelled.",s=Kc(),u=y=>typeof y=="string"?y.replace(/\s+/g," ").trim():"",l=s&&typeof s.value=="string"?u(s.value):"",d=setupNameInput&&typeof setupNameInput.value=="string"?u(setupNameInput.value):"",p=u(typeof ua=="string"?ua:""),g=y=>typeof y=="string"&&y.startsWith("auto-backup-"),A=[l,d,p].find(y=>y&&!g(y))||"";if(!A)return r.notifyFailure!==!1&&showNotification("error",i),null;if(typeof scheduleProjectAutoSave=="function")try{scheduleProjectAutoSave(!0)}catch(y){console.warn("Failed to flush project autosave before deletion backup",y)}let m={status:"unsupported"};if(typeof createProjectDeletionBackup=="function")try{m=createProjectDeletionBackup(A)}catch(y){console.error(`Automatic backup before ${e} failed`,y),m={status:"failed"}}return m.status==="created"||m.status==="skipped"?(m.status==="created"&&Fk({reset:!0}),r.notifySuccess!==!1&&showNotification("success",a),typeof m.backupName=="string"&&m.backupName?m.backupName:A):(typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Automatic backup before ${e} failed.`,m),r.notifyFailure!==!1&&showNotification("error",i),null)}const Pg=["pointerdown","keydown","touchstart"];let nc=null,xg=null,Mg=null,Dg=!1,ah=!1,ih=!1,pl=null,ml=null,gl=null;function Yz(){const e=typeof texts=="object"&&texts&&texts[currentLang]||{},t=typeof texts=="object"&&texts&&texts.en||{};return{singular:e.queuedBackupBannerMessageOne||t.queuedBackupBannerMessageOne||"1 backup saved in the local vault.",plural:e.queuedBackupBannerMessageOther||t.queuedBackupBannerMessageOther||"{count} backups saved in the local vault.",gesture:e.queuedBackupBannerGesture||t.queuedBackupBannerGesture||"Interact with the planner to export them safely.",action:e.queuedBackupBannerAction||t.queuedBackupBannerAction||"Open local backup vault",fallbackHint:e.queuedBackupFallbackHint||t.queuedBackupFallbackHint||"Emergency fallback storage active. Export queued backups immediately."}}function Qz(){if(typeof document>"u")return null;if(nc&&xg&&Mg)return nc;const e=document.createElement("section");e.id="cineQueuedBackupBanner",e.style.position="fixed",e.style.right="1.5rem",e.style.left="1.5rem",e.style.bottom="1.5rem",e.style.maxWidth="28rem",e.style.marginLeft="auto",e.style.padding="1rem 1.25rem",e.style.borderRadius="1.25rem",e.style.background="rgba(15, 22, 36, 0.92)",e.style.color="#f5f7fb",e.style.boxShadow="0 1.5rem 3.5rem rgba(5, 8, 17, 0.28)",e.style.zIndex="9999",e.style.display="none",e.style.flexDirection="column",e.style.gap="0.75rem",e.setAttribute("role","status"),e.setAttribute("aria-live","assertive"),e.setAttribute("aria-hidden","true");const t=document.createElement("p");t.style.margin="0",t.style.lineHeight="1.5",t.style.fontSize="0.95rem";const r=document.createElement("button");r.type="button",r.style.alignSelf="flex-start",r.style.background="#ffbf3c",r.style.color="#11131a",r.style.border="none",r.style.borderRadius="999px",r.style.padding="0.55rem 1.5rem",r.style.fontWeight="600",r.style.cursor="pointer",r.addEventListener("click",o=>{try{o.preventDefault()}catch{}typeof PL=="function"&&Promise.resolve().then(()=>PL()).catch(n=>{console.warn("Failed to open queued backup vault window",n)})}),e.appendChild(t),e.appendChild(r);try{(document.body||document.documentElement).appendChild(e)}catch(o){console.warn("Failed to attach queued backup banner to document",o)}return nc=e,xg=t,Mg=r,e}function Xz(e,t){const r=Qz();if(!r||!xg||!Mg)return;const o=Yz(),n=typeof e=="number"&&Number.isFinite(e)?e:1,i=(n===1?o.singular:o.plural).replace("{count}",String(n)),s=o.gesture.replace("{count}",String(n)),u=[`${i} ${s}`.trim()];t&&u.push(o.fallbackHint),xg.textContent=u.join(" ").trim(),Mg.textContent=o.action,r.style.display="flex",r.setAttribute("aria-hidden","false"),qk()}function hm(){nc&&(nc.style.display="none",nc.setAttribute("aria-hidden","true"))}function qk(){if(Dg||typeof document>"u")return;const e=Vk;for(let t=0;t<Pg.length;t+=1){const r=Pg[t];try{document.addEventListener(r,e,{passive:!0})}catch{document.addEventListener(r,e)}}Dg=!0}function Sm(){if(!Dg||typeof document>"u")return;const e=Vk;for(let t=0;t<Pg.length;t+=1){const r=Pg[t];try{document.removeEventListener(r,e,{passive:!0})}catch{document.removeEventListener(r,e)}}Dg=!1}function Vk(){Zz("gesture")}function Zz(e){ah||typeof jd!="function"||typeof Wv!="function"||(ah=!0,Promise.resolve().then(()=>{ah=!1,Jz(e)}))}function Cf(){return typeof jd!="function"?(hm(),Sm(),Promise.resolve(0)):Promise.resolve(jd()).then(e=>{const t=Array.isArray(e)?e.length:0,r=typeof xL=="function"?!!xL():!1;return t>0?Xz(t,r):(hm(),Sm()),t}).catch(e=>(console.warn("Failed to update queued backup banner from vault",e),hm(),Sm(),0))}async function Jz(e){if(!ih&&!(typeof jd!="function"||typeof Wv!="function")){ih=!0;try{const t=await Promise.resolve(jd()).then(r=>Array.isArray(r)?r:[]).catch(r=>(console.warn("Failed to read queued backups for deferred download",r),[]));if(!t.length){hm(),Sm();return}for(let r=0;r<t.length;r+=1){const o=t[r];let n=null;try{n=Wv(o.payload,o.fileName,{skipQueue:!0,source:o&&o.metadata&&o.metadata.source?o.metadata.source:"automatic",reason:e||"gesture-flush",queueMetadata:o&&o.metadata?o.metadata:{}})}catch(a){console.warn("Deferred backup download attempt threw an error",a),n=null}if(n&&n.success){if(typeof BL=="function")try{await BL(o.id)}catch(a){console.warn("Failed to remove queued backup after export",a)}}else{const a=n&&n.queueMessage?n.queueMessage:Og?Og(o.fileName):"Automatic downloads are still blocked. Keep working offline and try again after interacting with the planner.";if(typeof showNotification=="function")try{showNotification("warning",a)}catch(i){}break}}}finally{ih=!1,Cf()}}}function Wk(){Cf(),qk()}function Kk(){Cf()}function Yk(){if(pl)try{clearTimeout(pl)}catch{}pl=setTimeout(()=>{try{Za({reason:"interval"})}catch(e){console.warn("Scheduled auto backup run failed",e)}Yk()},Bu),pl&&typeof pl.unref=="function"&&pl.unref()}function Qk(){if(ml)try{clearTimeout(ml)}catch{}ml=setTimeout(()=>{try{globalThis.autoGearRulesDirtySinceBackup&&createAutoGearBackup()}catch(e){console.warn("Scheduled auto gear backup failed",e)}Qk()},hz),ml&&typeof ml.unref=="function"&&ml.unref()}async function eU(){if(!(typeof kL!="function"||typeof ML!="function"))try{const e=await ML(new Date);if(!e||typeof e.payload!="string")return;if(kL(e.fileName,e.payload,{source:"hourly-scheduler",reason:"hourly-auto",createdAt:e.iso}),Og)try{const t=Og(e.fileName);t&&typeof showNotification=="function"&&showNotification("info",t)}catch(t){}Cf()}catch(e){console.warn("Failed to queue scheduled full backup payload",e)}}function Xk(){if(gl)try{clearTimeout(gl)}catch{}gl=setTimeout(()=>{eU(),Xk()},3600*1e3),gl&&typeof gl.unref=="function"&&gl.unref()}typeof window<"u"&&typeof window.addEventListener=="function"&&(window.addEventListener("cineBackupVault:queued",Wk),window.addEventListener("cineBackupVault:fallbackChanged",Kk));typeof document<"u"&&typeof document.addEventListener=="function"&&(document.addEventListener("cineBackupVault:queued",Wk),document.addEventListener("cineBackupVault:fallbackChanged",Kk));typeof setTimeout=="function"&&(Yk(),Qk(),Xk());Cf();function Zk(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");if(!e||!t||!e.classList.contains("hidden"))return;e.classList.remove("hidden"),document.body.classList.add("device-manager-active");const{langTexts:r,fallbackTexts:o}=tl(),n=r.hideDeviceManager||o.hideDeviceManager||"Close Device Data",a=r.hideDeviceManagerHelp||o.hideDeviceManagerHelp||"Close defaults library editor";mi(t,n,ICON_GLYPHS.minus),t.setAttribute("title",n),t.setAttribute("data-help",a),t.setAttribute("aria-expanded","true"),Xy(),updateCalculations()}function Jk(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");if(!e||!t||e.classList.contains("hidden"))return;e.classList.add("hidden"),document.body.classList.remove("device-manager-active");const{langTexts:r,fallbackTexts:o}=tl(),n=r.toggleDeviceManager||o.toggleDeviceManager||"Edit Device Data…",a=r.toggleDeviceManagerHelp||o.toggleDeviceManagerHelp||"Manage available batteries, cameras, lenses...";mi(t,n,ICON_GLYPHS.gears),t.setAttribute("title",n),t.setAttribute("data-help",a),t.setAttribute("aria-expanded","false")}function eB(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");!e||!t||(e.classList.contains("hidden")?Zk():Jk())}function Yv(){Yv.bound||(Yv.bound=!0,typeof document<"u"&&document&&typeof document.addEventListener=="function"&&document.addEventListener("click",e=>{if(!e)return;const t=e.target;!t||typeof t.closest!="function"||!t.closest("#toggleDeviceManager")||eB()}))}Yv();function tl(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=typeof texts<"u"&&texts||(e&&typeof e.texts=="object"?e.texts:null),r=typeof currentLang=="string"&&t&&typeof t[currentLang]=="object"?currentLang:"en",o=t&&typeof t[r]=="object"&&t[r]||{},n=t&&typeof t.en=="object"&&t.en||{};return{langTexts:o,fallbackTexts:n}}function tU(){const{langTexts:e,fallbackTexts:t}=tl();return e&&e.autoBackupInProgressNotice||t&&t.autoBackupInProgressNotice||"Auto backup in progress. Performance may pause briefly."}function tB(e){if(!(!e||eventsCineUiRegistered)){eventsCineUiRegistered=!0;try{e.controllers&&typeof e.controllers.register=="function"&&e.controllers.register("deviceManagerSection",{show:Zk,hide:Jk,toggle:eB})}catch(t){console.warn("cineUi controller registration failed",t)}try{e.interactions&&typeof e.interactions.register=="function"&&(e.interactions.register("saveSetup",dC),e.interactions.register("deleteSetup",Hk))}catch(t){console.warn("cineUi interaction registration failed",t)}try{e.help&&typeof e.help.register=="function"&&(e.help.register("saveSetup",()=>{const{langTexts:t,fallbackTexts:r}=tl();return t.saveSetupHelp||r.saveSetupHelp||"Capture the current project—including devices, requirements and notes—so it can be restored instantly. The autosave status dot beside Project Name glows while changes are secured. Press Enter or Ctrl+S to save quickly; the Save button stays disabled until a name is entered."}),e.help.register("autoBackupBeforeDeletion",()=>{const{langTexts:t,fallbackTexts:r}=tl();return t.preDeleteBackupSuccess||r.preDeleteBackupSuccess||"Automatic safety copy stored before deletion. Find the matching auto-backup entry under Saved Projects and rename it if you plan to keep it permanently."}))}catch(t){console.warn("cineUi help registration failed",t)}}}function rU(){const e=Hz();return e?(tB(e),!0):!1}rU();function rB(e){const t=e.closest("li");if(!t)return;const r=t.querySelector(".device-details");if(!r)return;if(e.getAttribute("aria-expanded")==="true"){r.style.display="none";const{langTexts:n,fallbackTexts:a}=tl(),i=n.showDetails||a.showDetails||"Show Details";e.textContent=i,e.setAttribute("aria-expanded","false"),e.setAttribute("data-help",i)}else{r.style.display="block";const{langTexts:n,fallbackTexts:a}=tl(),i=n.hideDetails||a.hideDetails||"Hide Details";if(e.textContent=i,e.setAttribute("aria-expanded","true"),e.setAttribute("data-help",i),typeof document<"u"&&typeof document.dispatchEvent=="function"){const s=typeof e.dataset.name=="string"?e.dataset.name:"",u=typeof e.dataset.category=="string"?e.dataset.category:"",l=typeof e.dataset.subcategory=="string"?e.dataset.subcategory:"",d={name:s.trim(),category:u.trim(),subcategory:l.trim()||null};try{document.dispatchEvent(new CustomEvent("device-library:show-details",{detail:d}))}catch(p){console.warn("Failed to dispatch device-library:show-details event",p)}}}}function Qv(e,t){return e==="batteries"||e.endsWith(".batteries")||t.capacity!==void 0?"batteries":e==="cameras"||t.recordingMedia||t.lensMount||t.power?.batteryPlateSupport?"cameras":e==="lenses"||t.mountOptions||t.focusScale?"lenses":e==="monitors"||t.screenSizeInches!==void 0&&!e.includes("viewfinder")?"monitors":e==="viewfinders"||e.includes("viewfinder")?"viewfinders":e==="video"||e==="wirelessReceivers"||e==="iosVideo"||t.videoInputs||t.videoOutputs||t.frequency!==void 0?"video":e==="fiz.motors"||t.torqueNm!==void 0||t.gearTypes?"fiz.motors":e==="fiz.controllers"||t.powerSource||t.batteryType||t.connectivity?"fiz.controllers":e==="fiz.distance"||t.measurementMethod||t.connectionCompatibility||t.measurementRange||t.accuracy?"distances":e==="accessories.cables"||typeof e=="string"&&e.startsWith("accessories.cables")?"accessories.cables":"generic"}function oB(){const e=devices&&devices.cameras?devices.cameras:null;if(!e||typeof e!="object")return"";const t=n=>{if(!n||typeof n!="object"||!Array.isArray(n.lensMount))return"";const a=n.lensMount.find(s=>s&&typeof s.type=="string"&&typeof s.mount=="string"&&s.mount.toLowerCase()==="native");if(a&&a.type)return a.type;const i=n.lensMount.find(s=>s&&typeof s.type=="string"&&s.type.trim());return i?i.type:""},r=typeof cameraSelect?.value=="string"?cameraSelect.value:"";if(r&&e[r]){const n=t(e[r]);if(n)return n}const o=Object.values(e).find(n=>n&&typeof n=="object");if(o){const n=t(o);if(n)return n}return""}function nB(e){if(typeof normalizeFocusScale=="function")try{const r=normalizeFocusScale(e);if(r==="imperial"||r==="metric")return r}catch{}const t=typeof e=="string"?e.trim().toLowerCase():"";return t==="imperial"||t==="metric"?t:""}function oU(e){const t=Array.isArray(e)?e.map(o=>!o||typeof o=="string"?o:typeof o=="object"&&typeof o.type=="string"?{...o}:o):[];let r=!1;if(typeof setFizConnectors=="function")try{setFizConnectors(t),r=!0}catch(o){if(Ht&&typeof Ht.warn=="function")try{Ht.warn("Direct setFizConnectors invocation failed",o,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Direct setFizConnectors invocation failed",o)}if(!r)try{ir("setFizConnectors",[t],{defer:!0}),r=!0}catch(o){if(Ht&&typeof Ht.error=="function")try{Ht.error("Failed to schedule setFizConnectors",o,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to schedule setFizConnectors",o)}return r}function nU(e){const t=Array.isArray(e)?e.map(o=>{if(!o)return o;if(typeof o=="string"){const n=o.trim();return n?{type:n,notes:""}:o}if(typeof o=="object"){const n={...o};if(typeof n.type!="string"||!n.type){const a=typeof n.format=="string"&&n.format||typeof n.name=="string"&&n.name||"";a&&(n.type=a)}return typeof n.notes!="string"&&(typeof n.comment=="string"?n.notes=n.comment:n.notes==null&&(n.notes="")),n}return o}):[];let r=!1;if(typeof setTimecodes=="function")try{setTimecodes(t),r=!0}catch(o){if(Ht&&typeof Ht.warn=="function")try{Ht.warn("Direct setTimecodes invocation failed",o,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Direct setTimecodes invocation failed",o)}if(!r)try{ir("setTimecodes",[t],{defer:!0}),r=!0}catch(o){if(Ht&&typeof Ht.error=="function")try{Ht.error("Failed to schedule setTimecodes",o,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to schedule setTimecodes",o)}return r}function aU(e,t,r){const o=(y,S)=>y||(typeof document<"u"?document.getElementById(S):null),n=o(typeof wattFieldDiv<"u"?wattFieldDiv:null,"wattField"),a=o(typeof batteryFieldsDiv<"u"?batteryFieldsDiv:null,"batteryFields"),i=o(typeof cameraFieldsDiv<"u"?cameraFieldsDiv:null,"cameraFields"),s=o(typeof monitorFieldsDiv<"u"?monitorFieldsDiv:null,"monitorFields"),u=o(typeof viewfinderFieldsDiv<"u"?viewfinderFieldsDiv:null,"viewfinderFields"),l=o(typeof videoFieldsDiv<"u"?videoFieldsDiv:null,"videoFields"),d=o(typeof motorFieldsDiv<"u"?motorFieldsDiv:null,"motorFields"),p=o(typeof controllerFieldsDiv<"u"?controllerFieldsDiv:null,"controllerFields"),g=o(typeof distanceFieldsDiv<"u"?distanceFieldsDiv:null,"distanceFields"),h=o(typeof lensFieldsDiv<"u"?lensFieldsDiv:null,"lensFields"),A=o(typeof subcategoryFieldDiv<"u"?subcategoryFieldDiv:null,"subcategoryField");o(typeof dynamicFieldsDiv<"u"?dynamicFieldsDiv:null,"dynamicFields"),placeWattField(e,t);const m=Qv(e,t);if(n&&(n.style.display=""),hideFormSection(a),hideFormSection(i),hideFormSection(s),hideFormSection(u),hideFormSection(l),hideFormSection(d),hideFormSection(p),hideFormSection(g),hideFormSection(h),clearDynamicFields(),m==="batteries")n&&(n.style.display="none"),showFormSection(a),newCapacityInput.value=t.capacity??"",newPinAInput.value=t.pinA??"",dtapRow&&(dtapRow.style.display=e==="batteryHotswaps"?"none":""),newDtapAInput.value=e==="batteryHotswaps"?"":t.dtapA??"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="cameras"){n&&(n.style.display="none"),showFormSection(i);const y=nh(t);cameraWattInput.value=t.powerDrawWatts||"",cameraVoltageInput.value=t.power?.input?.voltageRange||"",cameraPortTypeInput.value=y||"",setBatteryPlates(t.power?.batteryPlateSupport||[]),setRecordingMedia(t.recordingMedia||[]),ir("setLensMounts",[Array.isArray(t.lensMount)?t.lensMount:[]]),ir("setPowerDistribution",[t.power?.powerDistributionOutputs||[]],{defer:!0}),setVideoOutputs(t.videoOutputs||[]),oU(t.fizConnectors||[]),setViewfinders(t.viewfinder||[]),nU(t.timecode||[]),buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="lenses"){n&&(n.style.display="none"),showFormSection(h);const y=oB();let S=[];if(Array.isArray(t?.mountOptions)?S=t.mountOptions:Array.isArray(t?.lensMount)?S=t.lensMount:typeof t?.mount=="string"&&t.mount.trim()&&(S=[{type:t.mount.trim(),mount:"native"}]),setLensDeviceMountOptions(S,y),lensFocusScaleSelect){updateLensFocusScaleSelectOptions();const E=nB(t&&t.focusScale);lensFocusScaleSelect.value=E||""}buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="monitors"){n&&(n.style.display="none"),showFormSection(s),monitorScreenSizeInput.value=t.screenSizeInches||"",monitorBrightnessInput.value=t.brightnessNits||"",monitorWattInput.value=t.powerDrawWatts||"",monitorVoltageInput.value=t.power?.input?.voltageRange||"";const y=nh(t);monitorPortTypeInput.value=y||"",setMonitorVideoInputs(t.videoInputs||t.video?.inputs||[]),setMonitorVideoOutputs(t.videoOutputs||t.video?.outputs||[]),monitorWirelessTxInput.checked=!!t.wirelessTx,monitorLatencyInput.value=t.latencyMs??"",monitorAudioOutputInput.value=t.audioOutput?.portType||t.audioOutput?.type||t.audioOutput||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="viewfinders"){n&&(n.style.display="none"),showFormSection(u),viewfinderScreenSizeInput.value=t.screenSizeInches||"",viewfinderBrightnessInput.value=t.brightnessNits||"",viewfinderWattInput.value=t.powerDrawWatts||"",viewfinderVoltageInput.value=t.power?.input?.voltageRange||"";const y=nh(t);viewfinderPortTypeInput.value=y||"",setViewfinderVideoInputs(t.videoInputs||t.video?.inputs||[]),setViewfinderVideoOutputs(t.videoOutputs||t.video?.outputs||[]),viewfinderWirelessTxInput.checked=!!t.wirelessTx,viewfinderLatencyInput.value=t.latencyMs??"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="video")showFormSection(l),newWattInput.value=t.powerDrawWatts||"",ir("setVideoPowerInputs",[t.power?.input||t.powerInput||null]),setVideoInputs(t.videoInputs||t.video?.inputs||[]),setVideoOutputsIO(t.videoOutputs||t.video?.outputs||[]),videoFrequencyInput.value=t.frequency||"",videoLatencyInput.value=t.latencyMs??"",motorConnectorInput.value="",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="fiz.motors")showFormSection(d),newWattInput.value=t.powerDrawWatts||"",motorConnectorInput.value=t.fizConnector||"",motorInternalInput.checked=!!t.internalController,motorTorqueInput.value=t.torqueNm||"",motorGearInput.value=Array.isArray(t.gearTypes)?t.gearTypes.join(", "):"",motorNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="fiz.controllers"){showFormSection(p),newWattInput.value=t.powerDrawWatts||"";const y=Array.isArray(t.fizConnectors)?t.fizConnectors.map(S=>S.type).join(", "):t.fizConnector||"";controllerConnectorInput.value=y,controllerPowerInput.value=t.powerSource||"",controllerBatteryInput.value=t.batteryType||"",controllerConnectivityInput.value=t.connectivity||"",controllerNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="distances")showFormSection(g),newWattInput.value=t.powerDrawWatts||"",distanceConnectionInput.value=t.connectionCompatibility||"",distanceMethodInput.value=t.measurementMethod||"",distanceRangeInput.value=t.measurementRange||"",distanceAccuracyInput.value=t.accuracy||"",distanceOutputInput.value=t.outputDisplay||"",distanceNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="accessories.cables"){n&&(n.style.display="none"),A&&(A.hidden=!1);const y=Dk(r?[r]:[]);if(newSubcategorySelect){newSubcategorySelect.innerHTML="";for(let E=0;E<y.length;E+=1){const I=y[E],L=document.createElement("option");L.value=I,L.textContent=I.charAt(0).toUpperCase()+I.slice(1),newSubcategorySelect.appendChild(L)}}const S=r&&y.includes(r)?r:newSubcategorySelect&&newSubcategorySelect.options.length>0?newSubcategorySelect.options[0].value:"";newSubcategorySelect&&(newSubcategorySelect.value=S||"",newSubcategorySelect.disabled=!1),S&&buildDynamicFields(`accessories.cables.${S}`,t,categoryExcludedAttrs[`accessories.cables.${S}`]||[])}else{const y=typeof t=="object"?t.powerDrawWatts:t;newWattInput&&(newWattInput.value=y||"");const S=typeof getSchemaAttributesForCategory=="function"?getSchemaAttributesForCategory(e):[],E=S.includes("powerDrawWatts")||t&&t.powerDrawWatts!==void 0;wattFieldDiv&&(wattFieldDiv.style.display=E?"":"none");const I=S.includes("dtapA")||S.includes("pinA")||t&&(t.dtapA!==void 0||t.pinA!==void 0);dtapRow&&(dtapRow.style.display=I?"":"none"),buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}}Bo("device-manager","click",e=>{if(!e||!e.target)return;let t=null;try{typeof e.target.closest=="function"?t=e.target.closest("button"):e.target.parentElement&&typeof e.target.parentElement.closest=="function"&&(t=e.target.parentElement.closest("button"))}catch{}if(t){try{if(e.currentTarget&&typeof e.currentTarget.contains=="function"&&!e.currentTarget.contains(t))return}catch{}if(t.classList.contains("detail-toggle"))rB(t);else if(t.classList.contains("edit-btn")){const r=t.dataset.name,o=t.dataset.category,n=t.dataset.subcategory,a=uC();if(!a){console.warn("Cannot edit device: category select is unavailable");return}if(!Array.from(a.options).some(d=>d.value===o)){const d=document.createElement("option");d.value=o,d.textContent=categoryNames[currentLang]?.[o]||o,a.appendChild(d)}const i=addDeviceBtn;i&&(i.dataset.mode="edit",i.dataset.originalName=r,i.dataset.originalCategory=o,o==="accessories.cables"&&n?i.dataset.originalSubcategory=n:delete i.dataset.originalSubcategory),a.value=o,newNameInput.value=r,a.dispatchEvent(new Event("change"));let s;if(o==="accessories.cables")s=devices.accessories.cables[n][r];else if(o.includes(".")){const[d,p]=o.split("."),g=p&&p.trim();s=devices[d][g][r]}else s=devices[o][r];aU(o,s,n);const u=addDeviceBtn;u&&(mi(u,texts[currentLang].updateDeviceBtn,ICON_GLYPHS.save),u.setAttribute("data-help",texts[currentLang].updateDeviceBtnHelp));const l=cancelEditBtn;l&&(mi(l,texts[currentLang].cancelEditBtn,ICON_GLYPHS.circleX),l.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),showFormSection(l)),document.getElementById("addDeviceHeading").scrollIntoView({behavior:"smooth",block:"start"})}else if(t.classList.contains("delete-btn")){const r=t.dataset.name,o=t.dataset.category,n=t.dataset.subcategory,a=()=>{if(o==="accessories.cables")delete devices.accessories.cables[n][r];else if(o.includes(".")){const[h,A]=o.split("."),m=A&&A.trim();delete devices[h][m][r]}else delete devices[o][r];typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),storeDevices(devices),viewfinderTypeOptions=is("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=is("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),Xy(),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0});const i=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,s=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,u=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,l=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(i,devices.cameras,!0),populateMonitorSelect(),populateSelect(s,devices.video,!0);const d=devices.fiz||{},p=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],g=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];p.forEach(h=>populateSelect(h,d.motors,!0)),g.forEach(h=>populateSelect(h,d.controllers,!0)),populateSelect(u,d.distance,!0),populateSelect(l,devices.batteries,!0),updateFizConnectorOptions(),updateMotorConnectorOptions(),updateControllerConnectorOptions(),updateControllerPowerOptions(),updateControllerBatteryOptions(),updateControllerConnectivityOptions(),updatePowerDistTypeOptions(),updatePowerDistVoltageOptions(),updatePowerDistCurrentOptions(),updateTimecodeTypeOptions(),updateDistanceConnectionOptions(),updateDistanceMethodOptions(),updateDistanceDisplayOptions(),applyFilters(),updateCalculations()};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].deleteDeviceTitle||"Delete Device",message:texts[currentLang].confirmDeleteDevice.replace("{name}",r),confirmLabel:"Delete",danger:!0,onConfirm:()=>a()}):confirm(texts[currentLang].confirmDeleteDevice.replace("{name}",r))&&a()}}});function iU(){return deviceManagerSection||document.getElementById("device-manager")}Bo("device-manager","keydown",e=>{iU()&&e.target.classList.contains("detail-toggle")&&(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),rB(e.target))});Bo("newCategory","change",()=>{console.log("[newCategory change] Category change event fired");const e=addDeviceBtn?.dataset.mode==="edit",t=newNameInput?newNameInput.value:"",r=document.getElementById("newCategory"),o=(r?r.value:"").trim(),n=typeof Qv=="function"?Qv(o,{}):"generic";console.log("[newCategory change] Inferred type:",n,"for value:",`"${o}"`),placeWattField(o),clearDynamicFields(),subcategoryFieldDiv&&(subcategoryFieldDiv.hidden=!0);const a=newSubcategorySelect?newSubcategorySelect.value:"";if(newSubcategorySelect&&(newSubcategorySelect.innerHTML="",newSubcategorySelect.disabled=!1),dtapRow&&(dtapRow.style.display=""),wattFieldDiv&&(wattFieldDiv.style.display=""),hideFormSection(batteryFieldsDiv),hideFormSection(cameraFieldsDiv),hideFormSection(monitorFieldsDiv),hideFormSection(viewfinderFieldsDiv),hideFormSection(videoFieldsDiv),hideFormSection(motorFieldsDiv),hideFormSection(controllerFieldsDiv),hideFormSection(distanceFieldsDiv),hideFormSection(lensFieldsDiv),n==="batteries")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(batteryFieldsDiv),dtapRow&&(dtapRow.style.display=o==="batteryHotswaps"||o==="accessories.batteryHotswaps"?"none":""),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="cameras")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(cameraFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="lenses")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(lensFieldsDiv),setLensDeviceMountOptions([],oB()),lensFocusScaleSelect&&(updateLensFocusScaleSelectOptions(),lensFocusScaleSelect.value=""),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="monitors")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(monitorFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="viewfinders")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(viewfinderFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="video")showFormSection(videoFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="fiz.motors")showFormSection(motorFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="fiz.controllers")showFormSection(controllerFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="distances")showFormSection(distanceFieldsDiv),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]);else if(n==="accessories.cables"){wattFieldDiv&&(wattFieldDiv.style.display="none"),subcategoryFieldDiv&&(subcategoryFieldDiv.hidden=!1);const s=Dk(a?[a]:[]);for(let l=0;l<s.length;l+=1){const d=s[l],p=document.createElement("option");p.value=d,p.textContent=d.charAt(0).toUpperCase()+d.slice(1),newSubcategorySelect.appendChild(p)}const u=a&&s.includes(a)?a:newSubcategorySelect.options.length>0?newSubcategorySelect.options[0].value:"";newSubcategorySelect.value=newSubcategorySelect&&u||"",u&&buildDynamicFields(`accessories.cables.${u}`,{},categoryExcludedAttrs[`accessories.cables.${u}`]||[])}else{const s=typeof getSchemaAttributesForCategory=="function"?getSchemaAttributesForCategory(o):[],u=s.includes("powerDrawWatts");wattFieldDiv&&(wattFieldDiv.style.display=u?"":"none");const l=s.includes("dtapA")||s.includes("pinA");dtapRow&&(dtapRow.style.display=l?"":"none"),buildDynamicFields(o,{},categoryExcludedAttrs[o]||[])}newWattInput&&(newWattInput.value=""),newCapacityInput&&(newCapacityInput.value=""),newPinAInput&&(newPinAInput.value=""),newDtapAInput&&(newDtapAInput.value=""),cameraWattInput&&(cameraWattInput.value=""),cameraVoltageInput&&(cameraVoltageInput.value=""),cameraPortTypeInput&&(cameraPortTypeInput.value=""),monitorScreenSizeInput&&(monitorScreenSizeInput.value=""),monitorBrightnessInput&&(monitorBrightnessInput.value=""),monitorWattInput&&(monitorWattInput.value=""),monitorVoltageInput&&(monitorVoltageInput.value=""),monitorPortTypeInput&&(monitorPortTypeInput.value=""),monitorWirelessTxInput&&(monitorWirelessTxInput.checked=!1),monitorLatencyInput&&(monitorLatencyInput.value=""),monitorAudioOutputInput&&(monitorAudioOutputInput.value=""),typeof clearMonitorVideoInputs=="function"?clearMonitorVideoInputs():typeof window<"u"&&typeof window.clearMonitorVideoInputs=="function"&&window.clearMonitorVideoInputs(),typeof clearMonitorVideoOutputs=="function"?clearMonitorVideoOutputs():typeof window<"u"&&typeof window.clearMonitorVideoOutputs=="function"&&window.clearMonitorVideoOutputs(),viewfinderScreenSizeInput&&(viewfinderScreenSizeInput.value=""),viewfinderBrightnessInput&&(viewfinderBrightnessInput.value=""),viewfinderWattInput&&(viewfinderWattInput.value=""),viewfinderVoltageInput&&(viewfinderVoltageInput.value=""),viewfinderPortTypeInput&&(viewfinderPortTypeInput.value=""),viewfinderWirelessTxInput&&(viewfinderWirelessTxInput.checked=!1),viewfinderLatencyInput&&(viewfinderLatencyInput.value=""),typeof clearViewfinderVideoInputs=="function"&&clearViewfinderVideoInputs(),typeof clearViewfinderVideoOutputs=="function"&&clearViewfinderVideoOutputs(),clearBatteryPlates(),typeof clearRecordingMedia=="function"&&clearRecordingMedia(),clearLensMounts(),clearLensDeviceMountOptions(),lensFocusScaleSelect&&(lensFocusScaleSelect.value=""),ir("clearPowerDistribution",[],{defer:!0}),clearVideoOutputs(),clearFizConnectors(),clearViewfinders(),clearTimecodes(),ir("clearVideoPowerInputs"),clearVideoInputs(),clearVideoOutputsIO(),videoFrequencyInput&&(videoFrequencyInput.value=""),videoLatencyInput&&(videoLatencyInput.value=""),motorConnectorInput&&(motorConnectorInput.value=""),motorInternalInput&&(motorInternalInput.checked=!1),motorTorqueInput&&(motorTorqueInput.value=""),motorGearInput&&(motorGearInput.value=""),motorNotesInput&&(motorNotesInput.value=""),controllerConnectorInput&&(controllerConnectorInput.value=""),controllerPowerInput&&(controllerPowerInput.value=""),controllerBatteryInput&&(controllerBatteryInput.value=""),controllerConnectivityInput&&(controllerConnectivityInput.value=""),controllerNotesInput&&(controllerNotesInput.value=""),distanceConnectionInput&&(distanceConnectionInput.value=""),distanceMethodInput&&(distanceMethodInput.value=""),distanceRangeInput&&(distanceRangeInput.value=""),distanceAccuracyInput&&(distanceAccuracyInput.value=""),distanceOutputInput&&(distanceOutputInput.value=""),distanceNotesInput&&(distanceNotesInput.value=""),o!=="accessories.cables"&&buildDynamicFields(o,{},categoryExcludedAttrs[o]||[]),newNameInput&&(e?newNameInput.value=t:newNameInput.value="");const i=texts[currentLang].cancelEditBtn;if(e){const s=addDeviceBtn;s&&(mi(s,texts[currentLang].updateDeviceBtn,ICON_GLYPHS.save),s.setAttribute("data-help",texts[currentLang].updateDeviceBtnHelp));const u=cancelEditBtn;u&&(mi(u,i,ICON_GLYPHS.circleX),u.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),showFormSection(u))}else{const s=addDeviceBtn;s&&(mi(s,texts[currentLang].addDeviceBtn,ICON_GLYPHS.add),s.setAttribute("data-help",texts[currentLang].addDeviceBtnHelp),s.dataset.mode="add",delete s.dataset.originalName,delete s.dataset.originalSubcategory,delete s.dataset.originalCategory);const u=cancelEditBtn;u&&(mi(u,i,ICON_GLYPHS.circleX),u.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),hideFormSection(u))}});Bo("newSubcategory","change",()=>{const e=document.getElementById("newCategory");e&&e.value==="accessories.cables"&&buildDynamicFields(`accessories.cables.${newSubcategorySelect.value}`,{},categoryExcludedAttrs[`accessories.cables.${newSubcategorySelect.value}`]||[])});function aB(){const e=addDeviceBtn;e&&(e.dataset.mode="add",delete e.dataset.originalName,delete e.dataset.originalSubcategory,delete e.dataset.originalCategory);const t=cancelEditBtn;t&&(hideFormSection(t),mi(t,texts[currentLang].cancelEditBtn,ICON_GLYPHS.circleX),t.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp));const r=uC();if(r&&r.isConnected)try{r.dispatchEvent(new Event("change"))}catch(o){console.warn("resetDeviceForm dispatch failed",o)}}function sU(e,t){if(!e||typeof document>"u"||!document)return;const r=String(e),o=document.querySelector(`input.list-filter[data-category-key="${r}"]`)||document.getElementById(`${r.replace(/[^a-z0-9]+/gi,"_")}ListFilter`);if(!o)return;const a=(typeof o.value=="string"?o.value:"").trim();if(!a)return;const i=a.toLowerCase(),s=typeof t=="string"&&t?t.trim().toLowerCase():"";if(!(s&&s.includes(i))){o.value="";try{o.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{o.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}}function aa(e,t,r,o){if(!e||typeof e!="object"||!t){applyDynamicFieldValues(void 0,r,o);return}const n=e[t],a=applyDynamicFieldValues(n,r,o);a&&a!==n&&(e[t]=a)}Bo("addDeviceBtn","click",e=>{if(e&&typeof e.preventDefault=="function")try{e.preventDefault()}catch{}const t=newNameInput.value.trim(),r=uC(),o=r?r.value:"",n=addDeviceBtn.dataset.mode==="edit",a=addDeviceBtn.dataset.originalName,i=addDeviceBtn.dataset.originalCategory,s=o==="accessories.cables"?newSubcategorySelect.value:null,u=addDeviceBtn.dataset.originalSubcategory;if(!t){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceNameTitle||"Name Required",message:texts[currentLang].alertDeviceName}):alert(texts[currentLang].alertDeviceName);return}if(o==="accessories.cables"&&!s){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const l=getCategoryContainer(o,s,{create:!0});if(!l){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const d=i||o,p=u||null,g=n?getCategoryContainer(d,d==="accessories.cables"?p:null,{create:!1}):null,h=n&&g?g[a]:void 0,m=n&&d===o&&(o!=="accessories.cables"||p===s),y=n&&d!==o,S=n&&(o==="accessories.cables"&&s!==p||d==="accessories.cables"&&p!==s),E=n&&t!==a;if(!n&&l[t]!==void 0||n&&l[t]!==void 0&&(E||y||S)){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceExistsTitle||"Device Exists",message:texts[currentLang].alertDeviceExists}):alert(texts[currentLang].alertDeviceExists);return}if(o==="batteries"||o==="accessories.batteries"||o==="batteryHotswaps"){const k=parseFloat(newCapacityInput.value),Z=parseFloat(newPinAInput.value),ue=o==="batteryHotswaps"?void 0:parseFloat(newDtapAInput.value);if(isNaN(k)||isNaN(Z)||k<0||Z<0||o!=="batteryHotswaps"&&(isNaN(ue)||ue<0)){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const H=m&&h?{...h}:{};o==="batteryHotswaps"?l[t]={...H,capacity:k,pinA:Z}:l[t]={...H,capacity:k,pinA:Z,dtapA:ue},aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="accessories.cables"){const k=n&&h?{...h}:{};l[t]={...k},aa(l,t,`accessories.cables.${s}`,categoryExcludedAttrs[`accessories.cables.${s}`]||[])}else if(o==="cameras"){const k=parseFloat(cameraWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}let Z,ue,H,Y,N,ae;try{Z=fs("getPowerDistribution"),ue=fs("getVideoOutputs"),H=fs("getFizConnectors"),Y=fs("getViewfinders"),N=fs("getTimecodes"),ae=fs("getBatteryPlates")}catch(de){console.error("Invalid camera JSON input:",de),alert(texts[currentLang].alertInvalidCameraJSON);return}l[t]={powerDrawWatts:k,power:{input:{voltageRange:cameraVoltageInput.value,type:cameraPortTypeInput.value},batteryPlateSupport:ae,powerDistributionOutputs:Z},videoOutputs:ue,fizConnectors:H,recordingMedia:getRecordingMedia(),viewfinder:Y,lensMount:getLensMounts(),timecode:N},aa(l,t,o,categoryExcludedAttrs[o]||[]),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0})}else if(o==="lenses"){const k=m&&h?{...h}:{},Z=getLensDeviceMountOptions();if(Z.length?(k.mountOptions=Z,k.mount=Z[0].type||""):(delete k.mountOptions,delete k.mount),lensFocusScaleSelect){const ue=nB(lensFocusScaleSelect.value);ue?k.focusScale=ue:delete k.focusScale}l[t]=k,aa(l,t,o,categoryExcludedAttrs[o]||[]),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0})}else if(o==="monitors"||o==="directorMonitors"){const k=parseFloat(monitorWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}const Z=parseFloat(monitorScreenSizeInput.value),ue=parseFloat(monitorBrightnessInput.value),H=typeof monitorLatencyInput.value=="string"?monitorLatencyInput.value.trim():"",Y=H!==""?H:void 0,N={screenSizeInches:isNaN(Z)?void 0:Z,brightnessNits:isNaN(ue)?void 0:ue,powerDrawWatts:k,power:{input:{voltageRange:monitorVoltageInput.value,type:monitorPortTypeInput.value},output:null},video:{inputs:getMonitorVideoInputs(),outputs:getMonitorVideoOutputs()},wirelessTx:monitorWirelessTxInput.checked,audioOutput:monitorAudioOutputInput.value?{portType:monitorAudioOutputInput.value}:void 0};typeof Y<"u"&&(N.latencyMs=Y),l[t]=N,aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="viewfinders"){const k=parseFloat(viewfinderWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}const Z=parseFloat(viewfinderScreenSizeInput.value),ue=parseFloat(viewfinderBrightnessInput.value),H=typeof viewfinderLatencyInput.value=="string"?viewfinderLatencyInput.value.trim():"",Y=H!==""?H:void 0,N={screenSizeInches:isNaN(Z)?void 0:Z,brightnessNits:isNaN(ue)?void 0:ue,powerDrawWatts:k,power:{input:{voltageRange:viewfinderVoltageInput.value,type:viewfinderPortTypeInput.value},output:null},video:{inputs:getViewfinderVideoInputs(),outputs:getViewfinderVideoOutputs()},wirelessTx:viewfinderWirelessTxInput.checked};typeof Y<"u"&&(N.latencyMs=Y),l[t]=N,aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="video"||o==="wirelessReceivers"||o==="iosVideo"){const k=parseFloat(newWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}const Z=typeof videoLatencyInput.value=="string"?videoLatencyInput.value.trim():"",ue=Z!==""?Z:void 0;let H;try{H=fs("getVideoPowerInputs",[])}catch(ne){if(Ht&&typeof Ht.error=="function")try{Ht.error("Failed to collect video power inputs",ne,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to collect video power inputs",ne),H=void 0}const Y=n&&h&&typeof h=="object"?(()=>{try{return JSON.parse(JSON.stringify(h))}catch{return{...h}}})():{},N=Y&&typeof Y=="object"?Y:{};N.powerDrawWatts=k;const ae=getVideoInputs();Array.isArray(ae)&&ae.length?N.videoInputs=ae:delete N.videoInputs;const de=getVideoOutputsIO();Array.isArray(de)&&de.length?N.videoOutputs=de:delete N.videoOutputs;const Q=typeof videoFrequencyInput.value=="string"?videoFrequencyInput.value.trim():"";if(Q?N.frequency=Q:delete N.frequency,typeof H<"u"){const V=(typeof WL.mergePowerInput=="function"?WL.mergePowerInput:(fe,J)=>{const Ae=fe&&typeof fe=="object"?{...fe}:{};return Ae.input=J,Ae})(N.power,H);V&&Object.keys(V).length?N.power=V:delete N.power}else delete N.power;typeof ue<"u"?N.latencyMs=ue:delete N.latencyMs,l[t]=N,aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="fiz.motors"){const k=parseFloat(newWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}l[t]={powerDrawWatts:k,fizConnector:motorConnectorInput.value,internalController:motorInternalInput.checked,torqueNm:motorTorqueInput.value?parseFloat(motorTorqueInput.value):null,gearTypes:motorGearInput.value?motorGearInput.value.split(",").map(Z=>Z.trim()).filter(Boolean):[],notes:motorNotesInput.value},aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="fiz.controllers"){const k=parseFloat(newWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}l[t]={powerDrawWatts:k,fizConnector:controllerConnectorInput.value,powerSource:controllerPowerInput.value,batteryType:controllerBatteryInput.value,connectivity:controllerConnectivityInput.value,notes:controllerNotesInput.value},aa(l,t,o,categoryExcludedAttrs[o]||[])}else if(o==="fiz.distance"){const k=parseFloat(newWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}l[t]={powerDrawWatts:k,connectionCompatibility:distanceConnectionInput.value,measurementMethod:distanceMethodInput.value,measurementRange:distanceRangeInput.value,accuracy:distanceAccuracyInput.value,outputDisplay:distanceOutputInput.value,notes:distanceNotesInput.value},aa(l,t,o,categoryExcludedAttrs[o]||[])}else{const k=parseFloat(newWattInput.value);if(isNaN(k)||k<=0){alert(texts[currentLang].alertDeviceWatt);return}const Z=m&&h?{...h}:{};l[t]={...Z,powerDrawWatts:k},aa(l,t,o,categoryExcludedAttrs[o]||[])}n&&(removeOriginalDeviceEntry(d,p,a,o,s,t),addDeviceBtn.dataset.originalCategory=o,o==="accessories.cables"&&s?addDeviceBtn.dataset.originalSubcategory=s:delete addDeviceBtn.dataset.originalSubcategory,addDeviceBtn.dataset.originalName=t),sU(o,t),aB(),typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),storeDevices(devices),viewfinderTypeOptions=is("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=is("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),ir("updatePlateTypeOptions"),ir("updatePowerPortOptions"),ir("updatePowerDistTypeOptions"),ir("updatePowerDistVoltageOptions"),ir("updatePowerDistCurrentOptions"),ir("updateRecordingMediaOptions"),ir("updateTimecodeTypeOptions"),Xy();const I=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,L=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,R=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,G=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(I,devices.cameras,!0),populateMonitorSelect(),populateSelect(L,devices.video,!0);const j=devices.fiz||{},$=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],z=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];if($.forEach(k=>populateSelect(k,j.motors,!0)),z.forEach(k=>populateSelect(k,j.controllers,!0)),populateSelect(R,j.distance,!0),populateSelect(G,devices.batteries,!0),updateFizConnectorOptions(),applyFilters(),updateCalculations(),typeof document<"u"&&typeof document.dispatchEvent=="function"){const k=o==="accessories.cables"&&s&&s.trim()||null,Z={name:t,category:o,subcategory:k};n&&(Z.original={name:a||"",category:d||"",subcategory:d==="accessories.cables"&&p||null});try{document.dispatchEvent(new CustomEvent(n?"device-library:update":"device-library:add",{detail:Z}))}catch(ue){console.warn("Failed to dispatch device library mutation event",ue)}}let te=o.replace(".","_"),oe=texts[currentLang]["category_"+te]||o;if(n){const k=texts[currentLang].alertDeviceUpdated.replace("{name}",t).replace("{category}",oe);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceUpdatedTitle||"Device Updated",message:k}):alert(k)}else{const k=texts[currentLang].alertDeviceAdded.replace("{name}",t).replace("{category}",oe);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceAddedTitle||"Device Added",message:k}):alert(k)}});Bo("cancelEditBtn","click",()=>{aB()});function Xv(e="cine_power_planner_export"){const t=new Date,r=t.getFullYear(),o=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${e}_${r}-${o}-${n}_${a}-${i}-${s}.json`}Bo("exportDataBtn","click",()=>{if(typeof Za=="function")try{Za({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"export"})}catch(t){console.warn("Failed to auto backup before export",t)}if(!devices||typeof devices!="object"){alert(texts[currentLang].alertExportError||"Export failed: No valid device data found.");return}let e;try{e=JSON.stringify(devices,null,2)}catch(t){console.error("Failed to stringify devices for export",t),typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Export Failed",message:"Unable to serialize device data. Please check for corrupted entries."}):alert("Export failed: Unable to serialize data.");return}if(exportOutput.style.display="block",exportOutput.value=e,typeof downloadBackupPayload=="function")downloadBackupPayload(e,Xv());else{const t=new Blob([e],{type:"application/json;charset=utf-8"}),r=URL.createObjectURL(t),o=document.createElement("a");o.href=r,o.download=Xv(),document.body.appendChild(o),o.click(),setTimeout(()=>{document.body.removeChild(o),URL.revokeObjectURL(r)},1500)}});const lU=document.getElementById("exportAndRevertBtn");lU&&Bo("exportAndRevertBtn","click",()=>{const e=()=>{if(typeof Za=="function")try{Za({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"export-revert"})}catch(n){console.warn("Failed to auto backup before export and revert",n)}const t=JSON.stringify(devices,null,2),r=Xv("cine_power_planner_backup_before_revert");if(typeof downloadBackupPayload=="function")downloadBackupPayload(t,r);else{const n=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=r,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(a)},1500)}const o=setTimeout(()=>{if(!gz())try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to confirm device storage reset during export & revert")}catch{}typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertExportAndRevertSuccessTitle||"Database Reset",message:texts[currentLang].alertExportAndRevertSuccess}):alert(texts[currentLang].alertExportAndRevertSuccess),location.reload()},500);typeof o.unref=="function"&&o.unref()};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].exportAndRevertTitle||"Export and Revert",message:texts[currentLang].confirmExportAndRevert,confirmLabel:"Export & Revert",danger:!0,onConfirm:()=>e()}):confirm(texts[currentLang].confirmExportAndRevert)&&e()});Bo("importDataBtn","click",()=>{importFileInput.click()});Bo("importFileInput","change",e=>{const t=e.target.files[0];t&&(typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Importing Data..."),setTimeout(()=>{const r=new FileReader,o=typeof t.name=="string"&&t.name?t.name:null;r.onload=n=>{try{const a=JSON.parse(n.target.result),i=parseDeviceDatabaseImport(a),s=jL(devices,i.devices);if(!i.devices){const E=formatDeviceImportErrors(i.errors);th("warn","Device import validation failed",{fileName:o,deviceCounts:s,validationErrors:wz(i.errors),errorCount:Array.isArray(i.errors)?i.errors.length:0},{action:"validate"}),console.error("Device import validation failed:",i.errors);const I=E?`${texts[currentLang].alertImportError}
${E}`:texts[currentLang].alertImportError;typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportErrorTitle||"Import Error",message:I}):alert(I);return}if(typeof Za=="function")try{Za({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"import"})}catch(E){th("warn","Auto backup before device import failed",{fileName:o,deviceCounts:s,error:NL(E)},{action:"auto-backup"}),console.warn("Failed to auto backup before import",E)}devices=i.devices,typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),unifyDevices(devices,{force:!0}),storeDevices(devices),viewfinderTypeOptions=is("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=is("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),Xy();const u=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,l=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,d=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,p=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(u,devices.cameras,!0),populateMonitorSelect(),populateSelect(l,devices.video,!0);const g=devices.fiz||{},h=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],A=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];h.forEach(E=>populateSelect(E,devices.fiz.motors,!0)),A.forEach(E=>populateSelect(E,devices.fiz.controllers,!0)),populateSelect(d,devices.fiz.distance,!0),populateSelect(p,devices.batteries,!0),updateFizConnectorOptions(),updateMotorConnectorOptions(),updateControllerConnectorOptions(),updateControllerPowerOptions(),updateControllerBatteryOptions(),updateControllerConnectivityOptions(),updateDistanceConnectionOptions(),updateDistanceMethodOptions(),updateDistanceDisplayOptions(),applyFilters(),updateCalculations();const m=countDeviceDatabaseEntries(devices),y=texts[currentLang].alertImportSuccess.replace("{num_devices}",m);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportSuccessTitle||"Import Successful",message:y}):alert(y);const S=typeof exportOutput<"u"?exportOutput:typeof document<"u"?document.getElementById("exportOutput"):null;S&&(S.style.display="block",S.value=JSON.stringify(devices,null,2))}catch(a){th("error","Failed to import device data",{fileName:o,deviceCounts:jL(devices,null),error:NL(a)},{action:"parse"}),console.error("Error parsing or importing data:",a);const i=a&&a.message?a.message:String(a),s=formatDeviceImportErrors([i]),u=s?`${texts[currentLang].alertImportError}
${s}`:texts[currentLang].alertImportError;typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportErrorTitle||"Import Error",message:u}):alert(u)}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},r.onerror=()=>{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()},r.readAsText(t)},50),e.target.value="")});function au(){const e=document.getElementById("cameraSelect"),t=document.getElementById("sensorMode");document.getElementById("recordingResolution");const r=document.getElementById("recordingFrameRateHint");if(!r||!e||!t)return;const o=e.value,n=t.value;let a=200;const s=(globalThis.devices&&globalThis.devices.cameras?globalThis.devices.cameras:{})[o];s&&s.sensorModeMaxFps&&s.sensorModeMaxFps[n]&&(a=s.sensorModeMaxFps[n]);let u=r.getAttribute("data-range-template");u||(typeof texts<"u"&&texts[currentLang]&&texts[currentLang].recordingFrameRateRangeHint?u=texts[currentLang].recordingFrameRateRangeHint:u="Enter a recording frame rate from 1 to {max} fps.");const l=u.replace("{max}",a);r.textContent=l}(function(){const t=document.getElementById("cameraSelect"),r=document.getElementById("sensorMode"),o=document.getElementById("recordingResolution");t&&t.addEventListener("change",()=>{setTimeout(au,100)}),r&&r.addEventListener("change",au),o&&o.addEventListener("change",au),setTimeout(au,500),setTimeout(au,500)})();typeof window<"u"&&(window.populateSetupSelect=kc);const $e=Eo(),iB=Eo(),cU=function(e){return cs(iB,e)};$e&&(typeof $e.collectRuntimeScopeCandidates>"u"&&($e.collectRuntimeScopeCandidates=cU),typeof $e.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE>"u"&&($e.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE=iB));console.log("DEBUG: app-core-new-1.js STARTING");typeof window<"u"&&(window.__APP_CORE_STARTED=!0);function sh(e){return{count:0}}(function(){typeof window<"u"&&(window.ensureSvgHasAriaHidden||(window.ensureSvgHasAriaHidden=function(e){return e}))})();const kn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};var ho=kn;typeof kn.CORE_PART1_RUNTIME_SCOPE>"u"&&(kn.CORE_PART1_RUNTIME_SCOPE=ho);var uU=kn;typeof kn.CORE_PART2_RUNTIME_SCOPE>"u"&&(kn.CORE_PART2_RUNTIME_SCOPE=uU);var Ps=kn;typeof kn.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE>"u"&&(kn.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE=Ps);var sB=kn.AppCore||{};kn.AppCore=sB;var dU=kn.localization||{};kn.localization=dU;let Et=typeof window<"u"?window.devices:void 0,c=typeof window<"u"?window.texts:void 0;const lB=Sf;function zd(e){if(typeof window<"u"&&typeof window[e]=="function")return window[e];const t=typeof globalThis<"u"&&globalThis.AUTO_GEAR_UI_HELPERS||typeof window<"u"&&window.AUTO_GEAR_UI_HELPERS||null;if(t&&typeof t[e]=="function")return t[e]}function Zn(e){if(typeof window<"u"&&typeof window[e]=="function")return window[e];const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||{};if(typeof t[e]=="function")return t[e];const r=t.AUTO_GEAR_NORMALIZER_EXPORTS;if(r&&typeof r[e]=="function")return r[e]}function Li(e){if(typeof window<"u"&&typeof window[e]=="function")return window[e];const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||{};if(typeof t[e]=="function")return t[e];const r=cB();if(r){const n=pU[e]||e;if(typeof r[n]=="function")return r[n].bind(r)}const o=t.AUTO_GEAR_STORAGE_EXPORTS;if(o&&typeof o[e]=="function")return o[e]}const fU="cineAutoGearPersistence",pU={readAutoGearRulesFromStorage:"readAutoGearRules",readAutoGearBackupsFromStorage:"readAutoGearBackups",readAutoGearPresetsFromStorage:"readAutoGearPresets",readAutoGearMonitorDefaultsFromStorage:"readAutoGearMonitorDefaults",readActiveAutoGearPresetIdFromStorage:"readActivePresetId",readAutoGearAutoPresetIdFromStorage:"readAutoPresetId",readAutoGearBackupVisibilityFromStorage:"readBackupVisibility",readAutoGearBackupRetentionFromStorage:"readBackupRetention",persistAutoGearPresets:"persistAutoGearPresets",persistAutoGearMonitorDefaults:"persistAutoGearMonitorDefaults",persistActiveAutoGearPresetId:"persistActivePresetId",persistAutoGearAutoPresetId:"persistAutoPresetId",persistAutoGearBackupVisibility:"persistBackupVisibility",persistAutoGearBackupRetention:"persistBackupRetention",persistAutoGearBackups:"persistAutoGearBackups"};function cB(){const e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof self<"u"&&e.push(self),typeof global<"u"&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!r||typeof r!="object"&&typeof r!="function")continue;if(r.cineAutoGearPersistence)return r.cineAutoGearPersistence;const o=r.cineModules;if(o&&typeof o.get=="function"){const n=o.get(fU);if(n)return n}}return null}function mU(e){return function(t){if(typeof gt=="function")return gt(e,[t],{defer:!0})}}let jn=zd("createDeferredAutoGearRefresher")||mU,uB=zd("focusAutoGearConditionPicker")||function(){},pC=zd("configureAutoGearConditionButtons")||function(){},dB=typeof window<"u"&&window.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS||typeof globalThis<"u"&&globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS||{},rl=typeof window<"u"&&window.AUTO_GEAR_MONITOR_DEFAULT_TYPES||typeof globalThis<"u"&&globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES||{"on-camera":"On-Camera",director:"Director","video-village":"Video Village",wireless:"Wireless"};function Vr(e,t,r){const o=(...n)=>{const a=t(e);return a&&a!==o&&typeof a=="function"?a(...n):r(...n)};return o}const fB=Vr("normalizeAutoGearTriggerValue",Zn,e=>typeof e=="string"?e.trim():""),gU=Vr("normalizeAutoGearScenarioLogic",Zn,e=>e==="any"||e==="multiplier"?e:"all"),yU=Vr("normalizeAutoGearScenarioPrimary",Zn,e=>typeof e=="string"?e.trim():""),bU=Vr("normalizeAutoGearScenarioMultiplier",Zn,e=>{const t=Number(e);return Number.isFinite(t)&&t>0?t:1}),Ud=Vr("normalizeAutoGearSelectorType",Zn,e=>typeof e=="string"?e.trim():"none"),mC=Vr("normalizeAutoGearSelectorDefault",Zn,(e,t)=>typeof t=="string"?t.trim():""),gC=Vr("normalizeAutoGearMonitorDefaults",Zn,e=>({focus:"",handheld7:"",combo15:"",director15:""})),pB=Vr("normalizeAutoGearRule",Zn,e=>e),hU=Vr("normalizeAutoGearPreset",Zn,e=>e),SU=Vr("normalizeAutoGearItem",Zn,e=>e),mB=Vr("normalizeAutoGearConditionLogic",Zn,e=>e),gB=Vr("normalizeAutoGearShootingDaysCondition",Zn,e=>e),$d=Vr("readAutoGearRulesFromStorage",Li,()=>[]),qd=Vr("readAutoGearBackupRetentionFromStorage",Li,()=>0),Vd=Vr("readAutoGearBackupsFromStorage",Li,e=>[]),Wd=Vr("readAutoGearPresetsFromStorage",Li,()=>[]),Kd=Vr("readActiveAutoGearPresetIdFromStorage",Li,()=>null),Yd=Vr("readAutoGearAutoPresetIdFromStorage",Li,()=>""),Qd=Vr("readAutoGearBackupVisibilityFromStorage",Li,()=>!1),Xd=Vr("readAutoGearMonitorDefaultsFromStorage",Li,()=>({})),Zv=Vr("persistAutoGearBackupRetention",Li,e=>{});typeof globalThis<"u"&&(globalThis.createDeferredAutoGearRefresher=jn,globalThis.focusAutoGearConditionPicker=uB,globalThis.configureAutoGearConditionButtons=pC,globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS=dB,globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES=rl,globalThis.normalizeAutoGearTriggerValue=fB,globalThis.normalizeAutoGearScenarioLogic=gU,globalThis.normalizeAutoGearScenarioPrimary=yU,globalThis.normalizeAutoGearScenarioMultiplier=bU,globalThis.normalizeAutoGearSelectorType=Ud,globalThis.normalizeAutoGearSelectorDefault=mC,globalThis.normalizeAutoGearMonitorDefaults=gC,globalThis.normalizeAutoGearRule=pB,globalThis.normalizeAutoGearPreset=hU,globalThis.normalizeAutoGearItem=SU,globalThis.normalizeAutoGearConditionLogic=mB,globalThis.normalizeAutoGearShootingDaysCondition=gB,globalThis.readAutoGearRulesFromStorage=$d,globalThis.readAutoGearBackupRetentionFromStorage=qd,globalThis.readAutoGearBackupsFromStorage=Vd,globalThis.readAutoGearPresetsFromStorage=Wd,globalThis.readActiveAutoGearPresetIdFromStorage=Kd,globalThis.readAutoGearAutoPresetIdFromStorage=Yd,globalThis.readAutoGearBackupVisibilityFromStorage=Qd,globalThis.readAutoGearMonitorDefaultsFromStorage=Xd,globalThis.persistAutoGearBackupRetention=Zv,globalThis.ensureGearListActions=Vr("ensureGearListActions",zd,()=>{}),globalThis.setInstallBannerOffset=Vr("setInstallBannerOffset",zd,()=>{}));var yB=typeof cineLocale<"u"&&cineLocale&&typeof cineLocale.resolveDocumentDirection=="function"?cineLocale.resolveDocumentDirection:function(t){return"ltr"};const zn=typeof cineLocale<"u"&&cineLocale&&typeof cineLocale.applyLocaleMetadata=="function"?cineLocale.applyLocaleMetadata:function(t,r,o){},vU=(function(){if(typeof require=="function")try{const o=require("./runtime/bootstrap.js");if(o&&typeof o=="object")return o}catch{}const t=[];function r(o){!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)}r(typeof $e=="object"&&$e?$e:null),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global);for(let o=0;o<t.length;o+=1){const n=t[o];try{const a=n&&n.cineRuntimeBootstrapExports;if(a&&typeof a=="object")return a}catch{}}return null})(),AU=[],{fallbackResolveRuntimeModuleLoader:EU=function(){return null},fallbackRequireCoreRuntimeModule:Jv=function(){return null},exposeCoreRuntimeConstant:St=function(t,r){typeof window<"u"&&(window[t]=r),typeof globalThis<"u"&&(globalThis[t]=r)},exposeCoreRuntimeConstants:CU=function(){},CORE_BOOT_QUEUE_KEY:wU="__coreRuntimeBootQueue",CORE_BOOT_QUEUE:LU=AU,enqueueCoreBootTask:ZL,getGridSnapState:bB=function(){return"normal"},setGridSnapState:FW,applyLegacyGridSnapValue:JL}=vU||{},eA=LU,Fi=typeof ZL=="function"?ZL:function(t){if(typeof t=="function")try{eA.push(t)}catch{try{t()}catch{}}return eA.length},RU=typeof JL=="function"?JL:function(t){return typeof t>"u"?bB():t},Jy=[typeof $e=="object"&&$e,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null].filter(e=>e&&(typeof e=="object"||typeof e=="function")),eR=Object.freeze({fahrenheit:"fahrenheit",celsius:"celsius"}),{normalizeVideoType:NW,normalizeFizConnectorType:HW,normalizeViewfinderType:jW,normalizePowerPortType:zW,fixPowerInput:UW,applyFixPowerInput:$W,ensureList:qW,markDevicesNormalized:IU,hasNormalizedDevicesMarker:VW,unifyDevices:hB,normalizeDevicesForPersistence:SB}=typeof cineDeviceNormalization<"u"?cineDeviceNormalization:typeof globalThis<"u"&&globalThis.cineDeviceNormalization||{};typeof window<"u"&&(window.normalizeDevicesForPersistence=SB);const TU="__cineTemperatureNote",OU="__cineFocusScale",oo=(function(){const t=Jy;for(let r=0;r<t.length;r+=1){const o=t[r];try{const n=o.TEMPERATURE_UNITS;if(n&&typeof n=="object"&&typeof n.fahrenheit=="string"&&typeof n.celsius=="string")return n}catch{}}return t.forEach(r=>{try{r.TEMPERATURE_UNITS||(r.TEMPERATURE_UNITS=eR)}catch{}}),eR})();var GU=(function(){const t=Jy;for(let r=0;r<t.length;r+=1){const o=t[r];try{if(Array.isArray(o.TEMPERATURE_SCENARIOS))return o.TEMPERATURE_SCENARIOS}catch{}}return t.forEach(r=>{try{Array.isArray(r.TEMPERATURE_SCENARIOS)||(r.TEMPERATURE_SCENARIOS=[])}catch{}}),[]})();const tR=Object.freeze(["metric","imperial"]),kU=(function(){const t=Jy;for(let r=0;r<t.length;r+=1){const o=t[r];try{if(Array.isArray(o.FOCUS_SCALE_VALUES)&&o.FOCUS_SCALE_VALUES.length)return o.FOCUS_SCALE_VALUES}catch{}}return t.forEach(r=>{try{(!Array.isArray(r.FOCUS_SCALE_VALUES)||!r.FOCUS_SCALE_VALUES.length)&&(r.FOCUS_SCALE_VALUES=tR)}catch{}}),tR})();function vB(e,t){const r=Jy;for(let o=0;o<r.length;o+=1){const n=r[o];try{const a=n&&n[e];if(typeof a=="number"&&Number.isFinite(a))return a}catch{}}return r.forEach(o=>{try{const n=o&&o[e];(typeof n!="number"||!Number.isFinite(n))&&(o[e]=t)}catch{}}),t}globalThis.FEEDBACK_TEMPERATURE_MIN_VALUE=vB("FEEDBACK_TEMPERATURE_MIN",-20);globalThis.FEEDBACK_TEMPERATURE_MAX_VALUE=vB("FEEDBACK_TEMPERATURE_MAX_LIMIT",50);globalThis.INSTALL_BANNER_DISMISSED_KEY="cine_install_banner_dismissed";globalThis.AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE=1;const ac=(function(){const t=[];try{typeof CORE_RUNTIME_SUPPORT_EXPORTS=="object"&&CORE_RUNTIME_SUPPORT_EXPORTS&&t.push(CORE_RUNTIME_SUPPORT_EXPORTS)}catch{}try{typeof cineCoreRuntimeSupportExports<"u"&&cineCoreRuntimeSupportExports&&typeof cineCoreRuntimeSupportExports=="object"&&t.push(cineCoreRuntimeSupportExports)}catch{}for(let r=0;r<t.length;r+=1){const o=t[r];if(o&&typeof o=="object")return o}return null})(),BU=ac&&typeof ac.resolveRuntimeModuleLoader=="function"?function(){return ac.resolveRuntimeModuleLoader()}:EU,PU=typeof globalThis=="object"&&globalThis&&typeof globalThis.resolveRuntimeModuleLoader=="function"?globalThis.resolveRuntimeModuleLoader:BU;typeof globalThis=="object"&&globalThis&&typeof globalThis.resolveRuntimeModuleLoader!="function"&&(globalThis.resolveRuntimeModuleLoader=PU);const xU=ac&&typeof ac.requireCoreRuntimeModule=="function"?function(t,r){return ac.requireCoreRuntimeModule(t,r)}:Jv,eb=typeof globalThis=="object"&&globalThis&&typeof globalThis.requireCoreRuntimeModule=="function"?globalThis.requireCoreRuntimeModule:xU;typeof globalThis=="object"&&globalThis&&typeof globalThis.requireCoreRuntimeModule!="function"&&(globalThis.requireCoreRuntimeModule=eb);typeof resolveCoreSupportModule>"u"&&(window.resolveCoreSupportModule=function(e,t){if(typeof require=="function")try{return require(t)}catch{return null}return null});let tA=typeof localizationBootstrapWiring<"u"?localizationBootstrapWiring:null;if(!tA&&typeof require=="function")try{tA=require("./app-core-bootstrap.js").localizationBootstrapWiring}catch{}const{localizationSupport:WW,localizationRuntimeEnvironment:KW,localizationBridge:MU,localizationFallbacks:DU,inlineLocalizationFallbacks:_U,localizationFallbackSupport:FU,createBasicLocalizationFallbackResolvers:YW,localizationFallbackRegistry:NU,localizationFallbackResolvers:HU,localizationFallbackNamespace:jU,fallbackResolveLocaleModule:zU,createLocaleFallbacks:UU}=tA||{};resolveCoreSupportModule("cineCoreRuntimeTools","./modules/core/runtime-tools.js");const lh=resolveCoreSupportModule("cineCoreRuntimeToolFallbacks","./modules/core/runtime-tool-fallbacks.js");resolveCoreSupportModule("cineCoreAppRuntimeToolInlineFallbacks","./modules/app-core/runtime.js");const ch=resolveCoreSupportModule("cineCoreAppSettingsDocumentationTracker","./modules/app-core/settings-documentation-tracker.js");let $a=typeof PINK_MODE_SUPPORT_API<"u"?PINK_MODE_SUPPORT_API:null;$a||(typeof cineCorePinkModeSupport<"u"?$a=cineCorePinkModeSupport:typeof window<"u"&&window.cineCorePinkModeSupport?$a=window.cineCorePinkModeSupport:typeof globalThis<"u"&&globalThis.cineCorePinkModeSupport&&($a=globalThis.cineCorePinkModeSupport));if(!$a&&typeof require=="function")try{$a=require("./app-core-pink-mode.js").PINK_MODE_SUPPORT_API}catch{}const{pinkModeIcons:$U,setPinkModeIconSequence:AB,loadPinkModeIconsFromFiles:qU,ensurePinkModeLottieRuntime:VU,resolvePinkModeLottieRuntime:rA,startPinkModeAnimatedIcons:WU,stopPinkModeAnimatedIcons:KU,triggerPinkModeIconRain:YU,getPinkModeIconRotationTimer:rR,setPinkModeIconRotationTimer:oR,getPinkModeIconIndex:nR,setPinkModeIconIndex:aR,PINK_MODE_ICON_INTERVAL_MS:QW,PINK_MODE_ICON_ANIMATION_CLASS:XW,PINK_MODE_ICON_ANIMATION_RESET_DELAY:ZW,PINK_MODE_ICON_FALLBACK_MARKUP:QU}=$a||{};let _g=function(e){return e||""};$a&&typeof $a.ensureSvgHasAriaHidden=="function"?_g=$a.ensureSvgHasAriaHidden:typeof window<"u"&&typeof window.ensureSvgHasAriaHidden=="function"&&(_g=window.ensureSvgHasAriaHidden);function wa(e,t="info-icon",r=null){if(!e)return"";let o={},n="info-icon";typeof t=="string"||t===null?(n=t||"",r&&typeof r=="object"&&(o=r)):t&&typeof t=="object"&&(o=t,n=t.className||"info-icon"),typeof o.className=="string"&&(n=o.className);const a=[];typeof o.size=="string"&&o.size.trim()&&a.push(`--icon - size: ${o.size.trim()} `),typeof o.scale=="string"&&o.scale.trim()&&a.push(`--icon - scale: ${o.scale.trim()} `),typeof o.style=="string"&&o.style.trim()&&a.push(o.style.trim());const i=a.length?` style = "${a.join(";")}"`:"",s=resolveIconGlyph(e),u=["icon-glyph"];if(n&&u.unshift(n),s.markup){s.className&&s.className.split(/\s+/).filter(Boolean).forEach(p=>u.push(p));const d=_g(s.markup);return`<span class="${u.join(" ")}"${i} aria-hidden="true">${d}</span>`}const l=s.char||"";return l?`<span class="${u.join(" ")}"${i} data-icon-font="${s.font}" aria-hidden="true">${l}</span>`:""}const XU=Ir("",ICON_FONT_KEYS.UICONS),ZU=Ir("",ICON_FONT_KEYS.UICONS),iR=Ir("",ICON_FONT_KEYS.UICONS),JU=Ir("",ICON_FONT_KEYS.UICONS),e0=Ir("",ICON_FONT_KEYS.UICONS);St("iconGlyph",Ir);St("resolveIconGlyph",resolveIconGlyph);St("applyIconGlyph",applyIconGlyph);St("formatSvgCoordinate",formatSvgCoordinate);St("positionSvgMarkup",positionSvgMarkup);St("iconMarkup",wa);St("ICON_GLYPHS",ICON_GLYPHS);St("pinkModeIcons",$U);St("setPinkModeIconSequence",AB);St("ensureSvgHasAriaHidden",_g);St("ensurePinkModeLottieRuntime",VU);St("resolvePinkModeLottieRuntime",rA);St("startPinkModeAnimatedIcons",WU);St("stopPinkModeAnimatedIcons",KU);St("triggerPinkModeIconRain",YU);const ic=(function(){let t=null;if(typeof resolveCoreSupportModule=="function")try{t=resolveCoreSupportModule("cineCoreRuntimeState","./modules/core/runtime-state.js")}catch{t=null}if(!t){const o=eb("modules/core/runtime-state.js");o&&typeof o=="object"&&(t=o)}if(t)return t;const r=lB(typeof $e=="object"?$e:null);for(let o=0;o<r.length;o+=1){const n=r[o];if(!(!n||typeof n!="object"))try{const a=n.cineCoreRuntimeState;if(a&&typeof a=="object")return a}catch{}}return null})(),uh=(function(){if(typeof resolveCoreSupportModule=="function")try{const o=resolveCoreSupportModule("cineCoreRuntimeLocalization","./modules/core/runtime-localization.js");if(o&&typeof o=="object")return o}catch{}const t=[ho&&typeof ho=="object"?ho:null,typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&window&&typeof window=="object"?window:null,typeof self<"u"&&self&&typeof self=="object"?self:null,typeof global<"u"&&global&&typeof global=="object"?global:null];for(let o=0;o<t.length;o+=1){const n=t[o];if(!(!n||typeof n!="object"))try{const a=n.cineCoreRuntimeLocalization;if(a&&typeof a=="object")return a}catch{}}const r=eb("modules/core/runtime-localization.js",{primaryScope:ho});return r&&typeof r=="object"?r:null})();uh&&typeof uh.createLocalizationRuntime=="function"&&uh.createLocalizationRuntime({runtimeScope:ho,coreGlobalScope:ho,localizationBridge:MU,localizationFallbacks:DU,inlineLocalizationFallbacks:_U,localizationFallbackNamespace:jU,localizationFallbackSupport:FU,localizationFallbackRegistry:NU,localizationFallbackResolvers:HU,fallbackResolveLocaleModule:zU,createLocaleFallbacks:UU,translationsRequirePath:"./translations.js"});if(ho&&ho.__cineCorePart1Initialized)typeof console<"u"&&typeof console.warn=="function"&&console.warn("Cine Power Planner core runtime (part 1) already initialized. Skipping duplicate load.");else if(ho)try{Object.defineProperty(ho,"__cineCorePart1Initialized",{configurable:!0,writable:!0,value:!0})}catch{ho.__cineCorePart1Initialized=!0}var Lt={},sR=lh&&typeof lh.createRuntimeToolFallbacks=="function"?lh.createRuntimeToolFallbacks:null;if(!sR){const e=eb("modules/core/runtime-tool-fallbacks.js",{primaryScope:ho});e&&typeof e.createRuntimeToolFallbacks=="function"&&(sR=e.createRuntimeToolFallbacks)}(function(){const t={queueKey:Gd,renderName:Ny};if(ic&&typeof ic.resolveTemperatureKeyDefaults=="function")try{const r=ic.resolveTemperatureKeyDefaults();r&&typeof r=="object"&&(typeof r.queueKey=="string"&&r.queueKey&&(t.queueKey=r.queueKey),typeof r.renderName=="string"&&r.renderName&&(t.renderName=r.renderName))}catch{}return(typeof t.queueKey!="string"||!t.queueKey)&&(t.queueKey="__cinePendingTemperatureNote"),(typeof t.renderName!="string"||!t.renderName)&&(t.renderName="renderTemperatureNote"),t})();const ss=(function(){const t=[];if(typeof require=="function")try{const o=require("./app-core-runtime-ui.js");o&&typeof o=="object"&&t.push(o)}catch{}const r=[];try{typeof $e<"u"&&$e&&r.push($e)}catch{}typeof globalThis<"u"&&globalThis&&r.push(globalThis),typeof window<"u"&&window&&r.push(window),typeof self<"u"&&self&&r.push(self),typeof global<"u"&&global&&r.push(global);for(let o=0;o<r.length;o+=1){const n=r[o];if(n)try{const a=n.cineCoreRuntimeUiBridge;a&&typeof a=="object"&&t.push(a)}catch{}}for(let o=0;o<t.length;o+=1){const n=t[o];if(n&&typeof n=="object")return n}return{}})();var t0=typeof ss.escapeHtml=="function"?ss.escapeHtml:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};const r0=typeof ss.escapeButtonLabelSafely=="function"?ss.escapeButtonLabelSafely:function(t){return typeof t!="string"||t===""?"":t0(t)},o0=typeof ss.resolveButtonIconMarkup=="function"?ss.resolveButtonIconMarkup:function(){return""},je=gy("setButtonLabelWithIcon",function(){return typeof ss.setButtonLabelWithIcon=="function"?ss.setButtonLabelWithIcon:function(r,o,n){if(!r)return;let a=n;if(typeof a>"u")try{typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.save&&(a=ICON_GLYPHS.save)}catch{}const i=o0(a),s=r0(typeof o=="string"?o:"");try{r.innerHTML=`${i}${s} `}catch{}}});if($e&&typeof $e=="object")try{$e.setButtonLabelWithIcon=je}catch{$e.setButtonLabelWithIcon=je}function dh(e){const t=Ja();let r=null;if(!r&&hi&&typeof hi.getAssignedTemperatureRenderer=="function")try{r=hi.getAssignedTemperatureRenderer()}catch{}try{typeof renderTemperatureNote=="function"&&(r=renderTemperatureNote)}catch(n){if(!(n&&(n.name==="ReferenceError"||/is not defined|Cannot access uninitialized/i.test(String(n&&n.message)))))throw n}if(!r&&t&&typeof t=="object")try{const n=t[Ny];typeof n=="function"&&(r=n)}catch{}if(typeof r=="function"){try{r(e)}catch(n){typeof console<"u"&&typeof console.error=="function"&&console.error("Temperature note renderer failed",n)}return}if(!t||typeof t!="object")return;let o=t[Gd];(!o||typeof o!="object")&&(o={}),o.latestHours=e;try{o.updatedAt=Date.now?Date.now():new Date().getTime()}catch{o.updatedAt=0}t[Gd]=o}function n0(e){if(!e||typeof e!="object")return;const t=$e&&typeof $e=="object"?$e:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;!t||typeof t!="object"||Object.entries(e).forEach(([r,o])=>{if(typeof r!="string"||!r)return;const n=o&&typeof o.get=="function"?o.get:null,a=o&&typeof o.set=="function"?o.set:null;if(n){try{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:n,set:a||void 0});return}catch{}try{t[r]=n()}catch{}}})}function lR(e){if(typeof e!="function")return!1;const t=$e&&typeof $e=="object"?$e:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;try{return e.call(t||this),!0}catch(r){typeof console<"u"&&typeof console.error=="function"&&console.error("Cine Power Planner core runtime segment failed to evaluate.",r)}return!1}if($e&&typeof $e=="object")try{Object.defineProperty($e,"__cineCorePart1Runner",{configurable:!0,enumerable:!1,writable:!0,value:lR})}catch{$e.__cineCorePart1Runner=lR}function a0(){const e=[];if(typeof CORE_PART2_RUNTIME_HELPERS<"u"&&CORE_PART2_RUNTIME_HELPERS&&e.push(CORE_PART2_RUNTIME_HELPERS),Bt&&typeof Bt.cineCoreRuntimeHelpers=="object"&&e.push(Bt.cineCoreRuntimeHelpers),typeof $e<"u"&&$e&&typeof $e.cineCoreRuntimeHelpers=="object"&&e.push($e.cineCoreRuntimeHelpers),typeof CORE_SHARED_SCOPE_PART2<"u"&&CORE_SHARED_SCOPE_PART2&&typeof CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers=="object"&&e.push(CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers),typeof globalThis<"u"&&globalThis&&typeof globalThis.cineCoreRuntimeHelpers=="object"&&e.push(globalThis.cineCoreRuntimeHelpers),typeof window<"u"&&window&&typeof window.cineCoreRuntimeHelpers=="object"&&e.push(window.cineCoreRuntimeHelpers),typeof self<"u"&&self&&typeof self.cineCoreRuntimeHelpers=="object"&&e.push(self.cineCoreRuntimeHelpers),typeof global<"u"&&global&&typeof global.cineCoreRuntimeHelpers=="object"&&e.push(global.cineCoreRuntimeHelpers),typeof require=="function")try{const t=require("./app-core-runtime-helpers.js");t&&typeof t=="object"&&e.push(t)}catch{}for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r=="object")return r}return null}const fh=a0(),Uo=fh&&typeof fh=="object"?fh:{};function i0(e){const t=[],r=typeof Set=="function"?new Set:null;function o(m){if(!(!m||typeof m!="object"&&typeof m!="function")){if(r){if(r.has(m))return;r.add(m),t.push(m);return}t.indexOf(m)===-1&&t.push(m)}}if(Array.isArray(e))for(let m=0;m<e.length;m+=1)try{o(e[m])}catch{}function n(m){if(typeof m=="function")for(let y=0;y<t.length;y+=1)try{m(t[y],y)}catch{}}function a(){return t.slice()}function i(){return t.length>0?t[0]:null}function s(m,y){const S=typeof y=="function"?y:function(){return y};if(typeof m!="string"||!m)try{return S()}catch{return}for(let E=0;E<t.length;E+=1){const I=t[E];if(!(!I||typeof I!="object"&&typeof I!="function"))try{return typeof I[m]>"u"&&(I[m]=S()),I[m]}catch{}}try{return S()}catch{return}}function u(m,y,S){const E=typeof S=="function"?S:function(){return S},I=typeof y=="function"?y:function(){return!0};n(L=>{try{I(L[m])||(L[m]=E())}catch(R){}})}function l(m){for(let y=0;y<t.length;y+=1){const S=t[y];if(!(!S||typeof S!="object"&&typeof S!="function"))try{if(m in S)return S[m]}catch{}}}let d=null;function p(m){typeof m=="function"&&(d=m,n(y=>{if(!(!y||typeof y!="object"&&typeof y!="function"))try{y[Ny]=m;const S=y[Gd];if(S&&typeof S=="object"){if(Object.prototype.hasOwnProperty.call(S,"latestHours")){const E=S.latestHours;if(typeof E<"u")try{m(E)}catch(I){typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to apply pending temperature note render",I)}}try{delete S.latestHours}catch(E){S.latestHours=void 0}}}catch(S){}}))}function g(){return d}const h={isReferenceError(){return!1},repair(){}};function A(m){!m||typeof m!="object"||(typeof m.isReferenceError=="function"&&(h.isReferenceError=m.isReferenceError),typeof m.repair=="function"&&(h.repair=m.repair))}return{registerScope:o,withEachScope:n,getScopes:a,getPrimaryScope:i,ensureValue:s,normaliseValue:u,readValue:l,assignTemperatureRenderer:p,getAssignedTemperatureRenderer:g,autoGearGuards:h,setAutoGearGuards:A}}function oA(e){if(ic&&typeof ic.createLocalRuntimeState=="function")try{return ic.createLocalRuntimeState(e,{temperatureQueueKey:Gd,temperatureRenderName:Ny})}catch{}return i0(e)}var hi=gy("__cineRuntimeState",()=>{const e=ig.length?ig:lB(typeof $e=="object"?$e:null);return oA(e)});if($e&&typeof $e=="object")try{Object.defineProperty($e,"__cineCreateRuntimeState",{configurable:!0,enumerable:!1,writable:!0,value:oA})}catch{try{$e.__cineCreateRuntimeState=oA}catch{}}function s0(e){if(!hi||!hi.autoGearGuards)return!1;const t=hi.autoGearGuards.isReferenceError;if(typeof t!="function")return!1;try{return t(e)===!0}catch{}return!1}function l0(e){if(!hi||!hi.autoGearGuards)return;const t=hi.autoGearGuards.repair;if(typeof t=="function")try{t(e)}catch{}}function gt(e,t=[],r={}){const o=$e||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null),n=typeof e=="string"?o&&o[e]:e;if(typeof n=="function"){if(n.__cineSessionProxy__===!0){const i=r&&typeof r=="object"?r:{},s=typeof i.attempts=="number"&&Number.isFinite(i.attempts)?i.attempts:0;if(typeof Fi=="function"&&s<3){const u={...i,defer:!1,attempts:s+1};Fi(()=>{gt(e,t,u)})}return Object.prototype.hasOwnProperty.call(i,"defaultValue")?i.defaultValue:void 0}if(n.__cineDeferredPlaceholder__===!0){const i=r&&typeof r=="object"?r:{},s=typeof i.attempts=="number"&&Number.isFinite(i.attempts)?i.attempts:0;if(typeof Fi=="function"&&s<3){const u={...i,defer:!1,attempts:s+1};Fi(()=>{gt(e,t,u)})}return}let a=0;for(;a<2;)try{return n.apply(o,t)}catch(i){if(a===0&&s0(i)){l0(o),a+=1;continue}typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e} `,i);break}return}return r&&r.defer===!0&&Fi(()=>{gt(e,t,{...r,defer:!1})}),typeof r<"u"&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}St("applyLegacyGridSnapValue",RU);function c0(e,t={}){if(typeof formatAutoGearItemSummary=="function")try{return formatAutoGearItemSummary(e,t)}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to format automatic gear item summary via direct formatter.",o)}const r=gt("formatAutoGearItemSummary",[e,t],{defaultValue:""});if(typeof r=="string")return r;if(r===null||typeof r>"u")return"";try{return String(r)}catch{return""}}function u0(e,...t){if(typeof formatWithPlaceholders=="function")try{return formatWithPlaceholders(e,...t)}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to format placeholder template via direct formatter.",n)}const r=gt("formatWithPlaceholders",[e,...t],{defaultValue:null});if(typeof r=="string"&&r)return r;let o=typeof e=="string"?e:String(e||"");for(let n=0;n<t.length;n+=1){const a=t[n];o=o.replace("%s",a)}return o}(function(){const t=(typeof $e<"u"?$e:null)||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null);if(typeof window<"u")try{window.populateSelect=void 0}catch{}if(!t||typeof t!="object")return;if(typeof t.populateSelect!="function"){const o=function(a,i={},s=!0){if(!a)return;const u=i&&typeof i=="object"?i:{};try{if(a.innerHTML="",s){const l=document.createElement("option");l.value="None";const d={de:"Keine Auswahl",es:"Ninguno",fr:"Aucun"},p=typeof rt=="string"?rt:"en";l.textContent=d[p]||"None",a.appendChild(l)}Object.keys(u).filter(l=>l!=="None").sort(typeof localeSort=="function"?localeSort:void 0).forEach(l=>{const d=document.createElement("option");d.value=l,d.textContent=l,a.appendChild(d)})}catch(l){typeof console<"u"&&typeof console.warn=="function"&&console.warn("populateSelect placeholder failed to render options immediately",l)}Fi(()=>{const l=t&&typeof t.populateSelect=="function"&&t.populateSelect!==o?t.populateSelect:null;l&&l(a,i,s)})};o.__cineDeferredPlaceholder__=!0;try{t.populateSelect=o,typeof window<"u"&&(window.populateSelect=o)}catch(n){console.warn("Failed to assign populateSelect",n)}}const r=o=>{if(typeof o!="string"||!o||typeof t[o]=="function")return;const n=function(...i){return gt(o,i,{defer:!0,attempts:0})};n.__cineDeferredPlaceholder__=!0;try{t[o]=n}catch{}};if(r("checkSetupChanged"),r("updateCalculations"),typeof t.feedbackCancelBtn>"u")try{t.feedbackCancelBtn=null}catch{}})();var d0=typeof Bt.stableStringify=="function"?Bt.stableStringify:typeof Bt.fallbackStableStringify=="function"?Bt.fallbackStableStringify:typeof Uo.fallbackStableStringify=="function"?Uo.fallbackStableStringify:function(t){try{return JSON.stringify(t)}catch{}return String(t)};const f0=typeof Bt.humanizeKey=="function"?Bt.humanizeKey:typeof Bt.fallbackHumanizeKey=="function"?Bt.fallbackHumanizeKey:typeof Uo.fallbackHumanizeKey=="function"?Uo.fallbackHumanizeKey:function(t){const r=typeof t=="string"?t:String(t||"");return r.charAt(0).toUpperCase()+r.slice(1)};function p0(){const e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof global<"u"&&e.push(global),typeof self<"u"&&e.push(self);for(const t of e)if(t&&typeof t.generateConnectorSummary=="function")return t.generateConnectorSummary;return null}const m0=typeof Bt.resolveConnectorSummaryGenerator=="function"?Bt.resolveConnectorSummaryGenerator:p0;let cR=typeof Bt.safeGenerateConnectorSummary=="function"?Bt.safeGenerateConnectorSummary:function(t){if(!t)return"";const r=m0();if(typeof r!="function")return"";try{return r(t)||""}catch(o){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to generate connector summary",o),""}};const g0=typeof Bt.normalizeAutoGearWeightOperator=="function"?Bt.normalizeAutoGearWeightOperator:typeof Uo.fallbackNormalizeAutoGearWeightOperator=="function"?Uo.fallbackNormalizeAutoGearWeightOperator:function(){return"greater"};typeof Bt.normalizeAutoGearWeightValue=="function"?Bt.normalizeAutoGearWeightValue:typeof Uo.fallbackNormalizeAutoGearWeightValue=="function"&&Uo.fallbackNormalizeAutoGearWeightValue;const y0=typeof Bt.normalizeAutoGearCameraWeightCondition=="function"?Bt.normalizeAutoGearCameraWeightCondition:typeof Uo.fallbackNormalizeAutoGearCameraWeightCondition=="function"?Uo.fallbackNormalizeAutoGearCameraWeightCondition:function(){return null},b0=typeof Bt.formatAutoGearWeight=="function"?Bt.formatAutoGearWeight:typeof Uo.fallbackFormatAutoGearWeight=="function"?Uo.fallbackFormatAutoGearWeight:function(t){return Number.isFinite(t)?String(t):""},h0=typeof Uo.fallbackGetAutoGearCameraWeightOperatorLabel=="function"?Uo.fallbackGetAutoGearCameraWeightOperatorLabel:function(t,r){const o=r||{},n=g0(t);return n==="less"?o.autoGearCameraWeightOperatorLess||"Lighter than":n==="equal"?o.autoGearCameraWeightOperatorEqual||"Exactly":o.autoGearCameraWeightOperatorGreater||"Heavier than"},S0=typeof Bt.getAutoGearCameraWeightOperatorLabel=="function"?Bt.getAutoGearCameraWeightOperatorLabel:h0,v0=typeof Uo.fallbackFormatAutoGearCameraWeight=="function"?Uo.fallbackFormatAutoGearCameraWeight:function(t,r){if(!t||!Number.isFinite(t.value))return"";const o=S0(t.operator,r),n=b0(t.value);return o?`${o} ${n} g`:`${n} g`},A0=typeof Bt.formatAutoGearCameraWeight=="function"?Bt.formatAutoGearCameraWeight:v0;var Fg=Bt.LZString;!Fg&&typeof Bt.getLZString=="function"&&(Fg=Bt.getLZString());Fg||(Fg={compressToEncodedURIComponent:e=>e,decompressFromEncodedURIComponent:e=>e});var E0;try{({generatePrintableOverview:E0}=require("./overview.js"))}catch{}function C0(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}function w0(e){return e?typeof e=="string"?e:typeof e.APP_VERSION=="string"?e.APP_VERSION:typeof e.default=="string"?e.default:typeof e.version=="string"?e.version:null:null}function L0(){if(typeof Bt.APP_VERSION=="string"&&Bt.APP_VERSION)return Bt.APP_VERSION;const e=C0();if(e&&typeof e.CPP_APP_VERSION=="string"&&e.CPP_APP_VERSION)return e.CPP_APP_VERSION;if(e&&typeof e.APP_VERSION=="string"&&e.APP_VERSION)return e.APP_VERSION;if(typeof require=="function")try{const t=require("../../app-version.js"),r=w0(t);if(r)return r}catch{}return"0.0.0"}var R0=L0();typeof rA=="function"?rA():typeof window.resolvePinkModeLottieRuntime=="function"&&window.resolvePinkModeLottieRuntime();var I0="iosPwaHelpShown";const yC="installPromptDismissed";function T0(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}const pa=T0();pa&&typeof pa.installBannerDismissedInSession!="boolean"&&(pa.installBannerDismissedInSession=!1);const ph="__cineResolvedHelpModule";function O0(){return{resolveIosPwaHelpStorageKey(e){return typeof e=="string"&&e?e:I0},isIosDevice(){return!1},isAndroidDevice(){return!1},isStandaloneDisplayMode(){return!1},hasDismissedIosPwaHelp(){return!1},markIosPwaHelpDismissed(){},shouldShowIosPwaHelp(){return!1}}}function G0(){const e=Ja();if(e&&e[ph])return e[ph];const t=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);function r(s,u){if(t&&typeof t.safeWarn=="function")try{t.safeWarn(s,u);return}catch{}if(typeof console<"u"&&console&&typeof console.warn=="function")try{typeof u>"u"?console.warn(s):console.warn(s,u)}catch{}}const o=[];if(t&&typeof t.getModuleRegistry=="function"){let s=null;try{s=t.getModuleRegistry(e)}catch(u){r("Unable to resolve cine.features.help module registry.",u)}if(s&&typeof s.get=="function")try{const u=s.get("cine.features.help");u&&o.indexOf(u)===-1&&o.push(u)}catch(u){r("Unable to read cine.features.help module.",u)}}const n=[];e&&n.indexOf(e)===-1&&n.push(e),typeof globalThis<"u"&&n.indexOf(globalThis)===-1&&n.push(globalThis),typeof window<"u"&&n.indexOf(window)===-1&&n.push(window),typeof self<"u"&&n.indexOf(self)===-1&&n.push(self),typeof global<"u"&&n.indexOf(global)===-1&&n.push(global);for(let s=0;s<n.length;s+=1){const u=n[s];if(!(!u||typeof u!="object"&&typeof u!="function")){try{const l=u.cineFeaturesHelp;l&&o.indexOf(l)===-1&&o.push(l)}catch{}try{const l=u.cineHelpModule;l&&typeof l=="object"&&l&&typeof l.help=="object"&&o.indexOf(l.help)===-1&&o.push(l.help)}catch{}if(typeof u.__cineCreateHelpModule=="function")try{const l=u.__cineCreateHelpModule();l&&typeof l=="object"&&(typeof l.help=="object"&&o.indexOf(l.help)===-1?o.push(l.help):o.indexOf(l)===-1&&o.push(l))}catch(l){r("Unable to instantiate cine.features.help module.",l)}}}let a=null;for(let s=0;s<o.length;s+=1){const u=o[s];if(u&&typeof u=="object"&&typeof u.isIosDevice=="function"){a=u;break}if(u&&typeof u=="object"&&typeof u.help=="object"&&typeof u.help.isIosDevice=="function"){a=u.help;break}}const i=a||O0();if(e)try{e[ph]=i}catch{}return i}const mh="__cineContactsModuleCache__",gh="__cineOwnGearModuleCache__",yh="__cineContactsOwnGearModuleCache__";function bC(e,t,r){try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r});return}catch{}try{e[t]=r}catch{}}function EB(){const e=Ja();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,yh))return e[yh];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.contactsOwnGear");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const o=[];o.indexOf(e)===-1&&o.push(e),typeof globalThis<"u"&&o.indexOf(globalThis)===-1&&o.push(globalThis),typeof window<"u"&&o.indexOf(window)===-1&&o.push(window),typeof self<"u"&&o.indexOf(self)===-1&&o.push(self),typeof global<"u"&&o.indexOf(global)===-1&&o.push(global);for(let a=0;a<o.length;a+=1){const i=o[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesContactsOwnGear;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const n=t.find(a=>a&&typeof a=="object")||null;return bC(e,yh,n),n}function tb(){const e=Ja();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,mh))return e[mh];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.contacts");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const o=[];o.indexOf(e)===-1&&o.push(e),typeof globalThis<"u"&&o.indexOf(globalThis)===-1&&o.push(globalThis),typeof window<"u"&&o.indexOf(window)===-1&&o.push(window),typeof self<"u"&&o.indexOf(self)===-1&&o.push(self),typeof global<"u"&&o.indexOf(global)===-1&&o.push(global);for(let a=0;a<o.length;a+=1){const i=o[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesContacts;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const n=t.find(a=>a&&typeof a=="object")||EB()||null;return bC(e,mh,n),n}function rb(){const e=Ja();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,gh))return e[gh];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.ownGear");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const o=[];o.indexOf(e)===-1&&o.push(e),typeof globalThis<"u"&&o.indexOf(globalThis)===-1&&o.push(globalThis),typeof window<"u"&&o.indexOf(window)===-1&&o.push(window),typeof self<"u"&&o.indexOf(self)===-1&&o.push(self),typeof global<"u"&&o.indexOf(global)===-1&&o.push(global);for(let a=0;a<o.length;a+=1){const i=o[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesOwnGear;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const n=t.find(a=>a&&typeof a=="object")||EB()||null;return bC(e,gh,n),n}var jo=G0();globalThis.helpModuleApi=jo;var Hr=null;function k0(){const e=[];typeof $e<"u"&&$e&&typeof $e=="object"&&e.push($e),typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"&&e.push(globalThis),typeof window<"u"&&window&&typeof window=="object"&&e.push(window),typeof self<"u"&&self&&typeof self=="object"&&e.push(self),typeof global<"u"&&global&&typeof global=="object"&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object")){if(r.CORE_DEVICE_SCHEMA&&typeof r.CORE_DEVICE_SCHEMA=="object")return r.CORE_DEVICE_SCHEMA;if(r.cineCoreDeviceSchema&&typeof r.cineCoreDeviceSchema=="object")return r.cineCoreDeviceSchema}}return null}const ao=(function(){const t=k0();if(t&&typeof t.createDeviceSchemaManager=="function")try{return t.createDeviceSchemaManager({onSchemaChange:r=>{Hr=r},populateCategoryOptions:()=>{try{EP()}catch(r){console.error("populateCategoryOptions failed during scheduled execution",r)}}})}catch(r){console.warn("Failed to initialize device schema manager from core module",r)}return null})(),uR=ao&&ao.DEVICE_SCHEMA_PATH||"src/data/schema.json",B0=ao&&typeof ao.loadDeviceSchemaFromCacheStorage=="function"?ao.loadDeviceSchemaFromCacheStorage:async()=>null,iu=ao&&typeof ao.finalizeDeviceSchemaLoad=="function"?ao.finalizeDeviceSchemaLoad:()=>{},CB=ao&&typeof ao.isValidDeviceSchema=="function"?ao.isValidDeviceSchema:e=>e&&typeof e=="object"&&!Array.isArray(e),dR=ao&&typeof ao.getCachedDeviceSchema=="function"?ao.getCachedDeviceSchema():null;if(ao&&typeof ao.getDeviceSchema=="function"){const e=ao.getDeviceSchema();e&&(Hr=e)}const fR=ao&&typeof ao.setDeviceSchema=="function"?e=>ao.setDeviceSchema(e):e=>(CB(e)?Hr=e:Hr||(Hr={}),Hr);let vm=null,Zd=null,Jd=null;const P0="CINE_CONTACTS_PROFILE_MODULE",x0="CINE_CONTACTS_LIST_MODULE",M0=typeof require=="function";if(M0){try{vm=require("../data/schema.json")}catch{}try{Zd=require("./contacts/profile.js")}catch(e){console.warn("Failed to load contacts profile module",e)}try{Jd=require("./contacts/list.js")}catch(e){console.warn("Failed to load contacts list module",e)}}const pR=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof window<"u"&&window||typeof global<"u"&&global||null,wB=e=>{if(!pR||!e)return null;try{return pR[e]||null}catch(t){return console.warn("Failed to read contacts module from global scope",t),null}};Zd||(Zd=wB(P0));Jd||(Jd=wB(x0));(!Zd||!Jd)&&console.warn("Module loader is not available in this environment. Contacts features limited.");const Ss=e=>typeof e=="string"?e.trim():"",D0=e=>({id:Ss(e&&e.id)||`contact - ${Date.now().toString(36)} `,name:Ss(e&&e.name),role:Ss(e&&e.role),phone:Ss(e&&e.phone),email:Ss(e&&e.email),website:Ss(e&&e.website),avatar:typeof e?.avatar=="string"?e.avatar:"",createdAt:Number.isFinite(e?.createdAt)?e.createdAt:Date.now(),updatedAt:Number.isFinite(e?.updatedAt)?e.updatedAt:Date.now()});function _0(){const e={name:"",role:"",avatar:"",phone:"",email:""},t=new Set,r=()=>({...e}),o=()=>{const n=r();return t.forEach(a=>{try{a(n)}catch(i){console.warn("Profile listener failed in fallback controller",i)}}),n};return{assignUserProfileState(n={}){return Object.assign(e,n),o()},getUserProfileSnapshot:r,handleFieldInput(n,a){return n?(e[n]=typeof a=="string"?a:"",o(),!0):!1},handleFieldBlur(){},load(n){return n&&typeof n=="object"&&Object.assign(e,n),o()},setAvatar(n){e.avatar=typeof n=="string"?n:"",o()},clearAvatar(){return e.avatar?(e.avatar="",o(),!0):!1},onChange(n){return typeof n!="function"?()=>{}:(t.add(n),()=>t.delete(n))},schedulePersist(){},markDirty(){},setPendingAnnouncement(){}}}const{CONTACT_AVATAR_MAX_BYTES:JW=300*1024,CONTACT_AVATAR_MAX_SOURCE_BYTES:eK=6*1024*1024,CONTACT_AVATAR_MAX_DIMENSION:tK=256,CONTACT_AVATAR_JPEG_QUALITY:rK=.85,CONTACT_AVATAR_JPEG_MIN_QUALITY:oK=.55,createProfileController:mR,estimateDataUrlSize:nK,optimiseAvatarDataUrl:aK,readAvatarFile:gR,isSafeImageUrl:yR}=Zd||{},{sanitizeContactValue:bR,normalizeContactEntry:hR,sortContacts:SR,parseVCard:vR,mergeImportedContacts:AR,createCrewRowSync:ER}=Jd||{},F0=typeof mR=="function"?mR:_0,wf=typeof gR=="function"?gR:typeof readAvatarFile=="function"?readAvatarFile:typeof window<"u"&&typeof window.readAvatarFile=="function"?window.readAvatarFile:(e,t,r)=>{if(e)try{const o=new FileReader;o.onload=()=>{typeof t=="function"&&t(o.result)},o.onerror=()=>{typeof r=="function"&&r("readError")},o.readAsDataURL(e)}catch{typeof r=="function"&&r("readError")}},N0=typeof yR=="function"?yR:e=>typeof e!="string"?!1:e.startsWith("data:image/"),H0=typeof bR=="function"?bR:Ss,j0=typeof hR=="function"?hR:D0,LB=typeof SR=="function"?SR:e=>Array.isArray(e)?e.slice():[],z0=typeof vR=="function"?vR:()=>[],U0=typeof AR=="function"?AR:e=>({contacts:LB([...e?.existing||[],...e?.imported||[]]),added:Array.isArray(e?.imported)?e.imported.length:0,updated:0}),CR=typeof ER=="function"?ER:(e={},t={})=>({...e,...t});try{if(console.log("[deviceSchema] Attempting to apply bundledSchema:",vm?"exists":"null"),vm){const e=fR(vm);e&&(Hr=e,console.log("[deviceSchema] Successfully applied bundledSchema"))}if(!Hr||!Object.keys(Hr).length){if(console.log("[deviceSchema] bundledSchema not available, attempting fetch from:",uR),!Hr&&dR){const e=fR(dR);e&&(Hr=e,console.log("[deviceSchema] Applied cached schema as fallback"))}typeof fetch=="function"?fetch(uR).then(e=>{if(!e||!e.ok)throw new Error(`Unexpected response when loading schema.json: ${e?e.status:"no response"} `);return e.json()}).then(e=>{console.log("[deviceSchema] Successfully fetched schema.json, applying..."),iu(e),e&&typeof e=="object"&&(Hr=e,console.log("[deviceSchema] deviceSchema updated from fetch. Categories:",Object.keys(Hr)))}).catch(e=>{console.warn("Failed to fetch schema.json",e),B0().then(t=>{CB(t)?iu(t):iu(Hr)}).catch(t=>{console.warn("Failed to load schema.json from cache storage",t),iu(Hr)})}):iu(Hr)}}catch(e){console.error("[deviceSchema] Error in schema loading:",e)}const wR={de:{imprint:"legal/impressum.html",privacy:"legal/datenschutz.html"},en:{imprint:"legal/impressum-en.html",privacy:"legal/datenschutz-en.html"},es:{imprint:"legal/impressum-es.html",privacy:"legal/datenschutz-es.html"},fr:{imprint:"legal/impressum-fr.html",privacy:"legal/datenschutz-fr.html"},it:{imprint:"legal/impressum-it.html",privacy:"legal/datenschutz-it.html"}};function Ri(e,t){const r=Ng(e);return typeof r=="string"&&r?r:t}const $0=Ri("AUTO_GEAR_RULES_STORAGE_KEY","cameraPowerPlanner_autoGearRules"),RB="__any__";typeof globalThis<"u"&&(globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN=RB);const q0=Ri("AUTO_GEAR_SEEDED_STORAGE_KEY","cameraPowerPlanner_autoGearSeeded"),V0=36,LR=1,RR=50,W0=50;function Ng(e){const t=[ho&&typeof ho=="object"?ho:null,Ps&&(typeof Ps=="object"||typeof Ps=="function")?Ps:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o!="object"&&typeof o!="function"))try{const n=o[e];if(typeof n<"u")return n}catch{}}}function IB(){const e=[],t=Ng("AUTO_GEAR_BACKUP_RETENTION_MIN");typeof t<"u"&&e.push(t);for(let r=0;r<e.length;r+=1){const o=Number(e[r]);if(!Number.isFinite(o))continue;const n=Math.round(o);if(n>=LR)return n}return LR}function K0(){const e=IB(),t=typeof $e<"u"&&$e?$e:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null,r=t&&typeof t.AUTO_GEAR_BACKUP_RETENTION_MAX<"u"?t.AUTO_GEAR_BACKUP_RETENTION_MAX:void 0,o=typeof r<"u"?r:Ng("AUTO_GEAR_BACKUP_RETENTION_MAX"),n=Number(o),a=Number.isFinite(n)&&n>=e?Math.min(Math.round(n),RR):RR,i=p=>{const g=Number(p);if(!Number.isFinite(g))return null;const h=Math.round(g);return h<e?e:h>a?a:h},s=[],u=t&&typeof t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT<"u"?t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT:void 0;typeof u<"u"&&s.push(u);const l=Ng("AUTO_GEAR_BACKUP_RETENTION_DEFAULT");if(typeof l<"u"&&s.push(l),typeof getAutoGearBackupRetentionDefault=="function")try{s.push(getAutoGearBackupRetentionDefault())}catch{}for(let p=0;p<s.length;p+=1){const g=i(s[p]);if(g!==null)return g}const d=i(V0);return d===null?e:d}Ri("AUTO_GEAR_BACKUPS_STORAGE_KEY","cameraPowerPlanner_autoGearBackups");Ri("AUTO_GEAR_PRESETS_STORAGE_KEY","cameraPowerPlanner_autoGearPresets");Ri("AUTO_GEAR_ACTIVE_PRESET_STORAGE_KEY","cameraPowerPlanner_autoGearActivePreset");Ri("AUTO_GEAR_AUTO_PRESET_STORAGE_KEY","cameraPowerPlanner_autoGearAutoPreset");Ri("AUTO_GEAR_BACKUP_VISIBILITY_STORAGE_KEY","cameraPowerPlanner_autoGearShowBackups");Ri("AUTO_GEAR_BACKUP_RETENTION_STORAGE_KEY","cameraPowerPlanner_autoGearBackupRetention");Ri("AUTO_GEAR_MONITOR_DEFAULTS_STORAGE_KEY","cameraPowerPlanner_autoGearMonitorDefaults");const Y0=IB(),TB=K0(),Q0=1;var X0="";const hC=["Camera","Camera Support","Media","Lens","Lens Support","Matte box + filter","LDS (FIZ)","Camera Batteries","Monitoring Batteries","Chargers","Monitoring","Monitoring support","Rigging","Power","Grip","Carts and Transportation","Miscellaneous","Consumables"],Z0=["none","monitor","directorMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","fizHandUnit"],OB=Z0.reduce((e,t)=>(e[t.toLowerCase()]=t,e),Object.create(null)),J0=new Set(Object.keys(OB)),e1=["SmallHD Ultra 7","SmallHD Focus","SmallHD Cine 7"],SC=new Set(["tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader"]),t1={tripodHeadBrand:"tripodHeadBrand",tripodBowl:"tripodBowl",tripodTypes:"tripodTypes",tripodSpreader:"tripodSpreader"};St("AUTO_GEAR_SELECTOR_TYPE_MAP",OB);St("AUTO_GEAR_SELECTOR_TYPE_SET",J0);St("AUTO_GEAR_TRIPOD_SELECTOR_TYPES",SC);St("AUTO_GEAR_TRIPOD_FIELD_IDS",t1);St("AUTO_GEAR_CUSTOM_CATEGORY",X0);St("GEAR_LIST_CATEGORIES",hC);const r1=Object.freeze([{key:"tilta-nucleus-m",label:"Tilta Nucleus ecosystem (M / M II)",motors:Object.freeze(["Tilta Nucleus M","Tilta Nucleus M II"]),options:Object.freeze(["Tilta Nucleus-M FIZ Hand Unit","Tilta Nucleus-M II FIZ Hand Unit","Tilta Nucleus Nano II Hand Controller"]),defaultOption:"Tilta Nucleus-M FIZ Hand Unit"},{key:"tilta-nucleus-nano",label:"Tilta Nucleus Nano ecosystem",motors:Object.freeze(["Tilta Nucleus Nano (Original)","Tilta Nucleus Nano II"]),options:Object.freeze(["Tilta Nucleus Nano Hand Wheel Controller","Tilta Nucleus Nano II Hand Controller"]),defaultOption:"Tilta Nucleus Nano Hand Wheel Controller"},{key:"arri-lbus",label:"ARRI / cmotion LBUS ecosystem",motors:Object.freeze(["Arri Cforce Mini","Arri Cforce Plus","Arri CLM-3","Arri CLM-4 (K2.72114.0)","Arri CLM-5 (K2.0006361)","Arri cforce mini RF (KK.0040345)","Cmotion cPRO"]),options:Object.freeze(["Arri Hi-5","Arri WCU-4","Arri SXU-1","cmotion cPRO hand unit"]),defaultOption:"Arri Hi-5"},{key:"teradek-rt",label:"Teradek RT ecosystem",motors:Object.freeze(["Teradek RT Motion FIZ (MOTR.S)"]),options:Object.freeze(["Teradek RT CTRL.3"]),defaultOption:"Teradek RT CTRL.3"},{key:"preston",label:"Preston ecosystem",motors:Object.freeze(["Preston DM1X","Preston DM2","Preston DM2X","Preston DM-A","Preston DM-C"]),options:Object.freeze(["Preston Hand Unit 4 (HU4)"]),defaultOption:"Preston Hand Unit 4 (HU4)"},{key:"chrosziel",label:"Chrosziel MagNum ecosystem",motors:Object.freeze(["Chrosziel CDM-100 Digital","Chrosziel CDM-M (Universal Zoom Servo Drive)"]),options:Object.freeze(["Chrosziel MagNum Hand Unit (MN-100R)"]),defaultOption:"Chrosziel MagNum Hand Unit (MN-100R)"},{key:"dji-focus",label:"DJI Focus ecosystem",motors:Object.freeze(["DJI Focus (Original)"]),options:Object.freeze(["DJI Focus Hand Unit"]),defaultOption:"DJI Focus Hand Unit"},{key:"dji-focus-pro",label:"DJI Focus Pro ecosystem",motors:Object.freeze(["DJI RS Focus (2022)","DJI Focus Pro Motor"]),options:Object.freeze(["DJI RS Focus Wheel (2022)","DJI Focus Pro Hand Unit"]),defaultOption:"DJI Focus Pro Hand Unit"},{key:"smallrig-magicfiz",label:"SmallRig MagicFIZ ecosystem",motors:Object.freeze(["SmallRig Wireless Follow Focus"]),options:Object.freeze(["SmallRig MagicFIZ Wireless Handgrip"]),defaultOption:"SmallRig MagicFIZ Wireless Handgrip"},{key:"redrock-microremote",label:"Redrock microRemote ecosystem",motors:Object.freeze(["Redrock MicroRemote Torque"]),options:Object.freeze(["Redrock microRemote Hand Controller"]),defaultOption:"Redrock microRemote Hand Controller"}]),GB=(()=>{const e=Object.create(null);return r1.forEach(t=>{if(!t||!t.key||!Array.isArray(t.options)||!t.options.length)return;const r=t.key,o=Array.from(new Set(t.options.filter(Boolean)));o.length&&(e[r]=Object.freeze({key:r,label:t.label||"",motors:t.motors||[],options:Object.freeze(o),defaultOption:o.includes(t.defaultOption)?t.defaultOption:o[0]}))}),Object.freeze(e)})(),o1=(()=>{const e=Object.create(null);return Object.values(GB).forEach(t=>{!t||!Array.isArray(t.motors)||t.motors.forEach(r=>{const o=fB(r);!o||Object.prototype.hasOwnProperty.call(e,o)||(e[o]=t.key)})}),Object.freeze(e)})();typeof globalThis<"u"&&(globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=GB,globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=o1);const sc=cB();sc&&typeof sc.hydrateCache=="function"&&sc.hydrateCache().catch(e=>{console.warn("Failed to hydrate Auto-Gear persistence cache",e)});var va=typeof $d=="function"?$d():[],Si=va.slice(),Yi=null,Hg=typeof qd=="function"?qd():TB,xs=typeof Vd=="function"?Vd(Hg):[];typeof Wd=="function"&&Wd();typeof Kd=="function"&&Kd();var Am=typeof Yd=="function"?Yd():"";typeof Qd=="function"&&Qd();var qa=typeof Xd=="function"?Xd():{};typeof Zv=="function"&&Zv(Hg);var _i=null,n1=null,la="all";function Nf(e){const t=e==="remove"?"remove":"add",r=t==="remove"?UP:zP;if(!r)return;const o=getLanguageTexts(rt),n=getLanguageTexts(Qr),a=n1?.listType===t,i=t==="remove"?"autoGearRemoveItemButton":"autoGearAddItemButton",s=o[i]||n[i]||r.textContent||"",u=o.autoGearUpdateItemButton||n.autoGearUpdateItemButton||s,l=a?u:s,d=a?ICON_GLYPHS.save:t==="remove"?ICON_GLYPHS.minus:ICON_GLYPHS.add;je(r,l,d),r.setAttribute("data-help",l)}function lc(e=Si,t=qa){return d0({rules:Array.isArray(e)?e:[],monitorDefaults:gC(t)})}const a1=lc(va,qa);xs.length&&lc(xs[0].rules,xs[0].monitorDefaults);Fi(()=>{gt("reconcileAutoGearAutoPresetState",[{persist:!0,skipRender:!0}],{defer:!0}),gt("alignActiveAutoGearPreset",[{skipRender:!0}],{defer:!0})});function jg(e){return va=Array.isArray(e)?e.map(pB).filter(Boolean):[],va}function vC(){lc()}function i1(){if(sc&&typeof sc.persistAutoGearRules=="function"){const e=sc.persistAutoGearRules(va);e&&typeof e.catch=="function"&&e.catch(t=>{console.warn("Failed to save automatic gear rules",t)});return}if(typeof saveAutoGearRules<"u"&&typeof saveAutoGearRules=="function")try{saveAutoGearRules(va);return}catch(e){console.warn("Failed to save automatic gear rules",e)}if(!(typeof localStorage>"u"))try{localStorage.setItem($0,JSON.stringify(va))}catch(e){console.warn("Failed to save automatic gear rules",e)}}function s1(e){return Object.prototype.hasOwnProperty.call(rl,e)?mC(rl[e],qa[e]):""}function l1(e,{skipRender:t=!1,skipRefresh:r=!1}={}){const o=gC(e);let n=!1;return Object.keys(rl).forEach(a=>{const i=qa[a]||"",s=o[a]||"";i!==s&&(n=!0)}),n?(qa=persistAutoGearMonitorDefaults(o),vC(),t||(gt("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),gt("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),!r&&typeof refreshGearListIfVisible=="function"&&refreshGearListIfVisible(),qa):(t||(gt("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),gt("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),qa)}function c1(e,t,r={}){if(!Object.prototype.hasOwnProperty.call(rl,e))return s1(e);const o=qa[e]||"",n=mC(rl[e],t);if(o===n)return r.skipRender||(gt("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),gt("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),n;const a={...qa,[e]:n};return l1(a,r),n}function kB(e){const t=jg(e);Si=t.slice(),Yi=null,i1(),vC(),gt("alignActiveAutoGearPreset",[{skipRender:!0}],{defer:!0}),gt("syncAutoGearAutoPreset",[t],{defer:!0}),gt("renderAutoGearPresetsControls",[],{defer:!0})}function AC(){return va.slice()}function u1(e){Array.isArray(e)?kB(e):(Si=typeof $d=="function"?$d():[],Yi=null,jg(Si),vC()),Hg=typeof qd=="function"?qd():TB,xs=typeof Vd=="function"?Vd(Hg):[],typeof Wd=="function"&&Wd(),typeof Kd=="function"&&Kd(),Am=typeof Yd=="function"?Yd():"",typeof Qd=="function"&&Qd(),qa=typeof Xd=="function"?Xd():{},xs.length?lc(xs[0].rules,xs[0].monitorDefaults):lc(),lc(),gt("reconcileAutoGearAutoPresetState",[{persist:!0,skipRender:!0}],{defer:!0}),gt("syncAutoGearAutoPreset",[Si],{defer:!0}),gt("alignActiveAutoGearPreset",[{skipRender:!0}],{defer:!0}),gt("renderAutoGearBackupControls",[],{defer:!0}),gt("renderAutoGearPresetsControls",[],{defer:!0}),gt("closeAutoGearEditor",[],{defer:!0}),gt("renderAutoGearRulesList",[],{defer:!0}),gt("updateAutoGearCatalogOptions",[],{defer:!0}),gt("renderAutoGearMonitorDefaultsControls",[],{defer:!0})}function d1(){if(!Yi||!Yi.length){Yi=null,jg(Si);return}Yi=null,jg(Si)}function f1(){return Yi?Yi.slice():null}typeof window<"u"&&(window.getProjectScopedAutoGearRules=f1,window.getAutoGearRules=AC,window.setAutoGearRules=kB,window.collectAutoGearCatalogNames=m1,window.GEAR_LIST_CATEGORIES=hC,window.collectAutoGearMonitorNames=b1,window.collectAutoGearTripodNames=S1,window.collectDeviceManagerCategories=vP,window.hasSeededAutoGearDefaults=p1,window.activateSettingsTab=hd,window.clearAllAutoGearConditions=hW,window.callCoreFunctionIfAvailable=gt,typeof window.autoGearScenarioFilter>"u"&&Object.defineProperty(window,"autoGearScenarioFilter",{configurable:!0,get:()=>la,set:e=>{la=e}}));function BB(e){return typeof e=="string"&&e!=="None"&&(/[A-Z]/.test(e)||/\d/.test(e)||e.includes(" "))}function p1(){if(typeof loadAutoGearSeedFlag<"u"&&typeof loadAutoGearSeedFlag=="function")try{return!!loadAutoGearSeedFlag()}catch(e){return console.warn("Failed to read automatic gear seed flag",e),!1}if(typeof localStorage>"u")return!1;try{return localStorage.getItem(q0)==="1"}catch(e){return console.warn("Failed to read automatic gear seed flag",e),!1}}function m1(){const e=new Set,t=n=>{BB(n)&&e.add(n)},r=typeof WeakSet=="function"?new WeakSet:null,o=n=>{if(!(!n||typeof n!="object")){if(r){if(r.has(n))return;r.add(n)}Object.entries(n).forEach(([a,i])=>{!i||typeof i!="object"||Array.isArray(i)||(t(a),o(i))})}};return typeof Et=="object"&&Et&&o(Et),T1().forEach(n=>{n&&typeof n.name=="string"&&t(n.name)}),va.forEach(n=>{[...n.add,...n.remove].forEach(a=>t(a.name))}),Array.from(e).sort((n,a)=>n.localeCompare(a,void 0,{sensitivity:"base"}))}function g1(e){const t=Ud(e);return t==="monitor"||t==="directorMonitor"||SC.has(t)?t:"none"}var y1="none",nA=null,aA=null;function b1(e=y1){const t=g1(e);if(t==="none")return[];const r=t==="monitor",o=t==="directorMonitor",n=new Set;r&&n.add("monitor"),o&&n.add("directorMonitor");const a=new Set,i=s=>{if(typeof s=="string"){const u=s.trim();u&&a.add(u)}};if(r){const s=Et&&Et.monitors?Et.monitors:null;s&&typeof s=="object"&&Object.keys(s).forEach(i)}if(o){const s=Et&&Et.directorMonitors?Et.directorMonitors:null;s&&typeof s=="object"&&Object.keys(s).filter(u=>u&&u!=="None").forEach(i)}return va.forEach(s=>{const u=l=>{if(!l||typeof l!="object")return;const d=l.selectorDefault;if(!d)return;const p=Ud(l.selectorType);n.has(p)&&i(d)};(s.add||[]).forEach(u),(s.remove||[]).forEach(u)}),e1.forEach(i),Array.from(a).sort(localeSort)}function h1(e){const t=Ud(e);if(t==="none")return[];const r=new Set,o=n=>{if(typeof n!="string")return;const a=n.trim();a&&r.add(a)};return va.forEach(n=>{const a=i=>{!i||typeof i!="object"||Ud(i.selectorType)===t&&o(i.selectorDefault)};(n.add||[]).forEach(a),(n.remove||[]).forEach(a)}),Array.from(r)}function S1(e){if(!SC.has(e))return[];const t=collectTripodPreferenceOptions(e),r=new Set,o=[];return t.forEach(a=>{if(!a||!a.value)return;const i=a.value.trim().toLowerCase();r.has(i)||(r.add(i),o.push({value:a.value.trim(),label:a.label||a.value.trim()}))}),h1(e).map(a=>a.trim()).filter(Boolean).sort(localeSort).forEach(a=>{const i=a.toLowerCase();r.has(i)||(r.add(i),o.push({value:a,label:a}))}),o}var v1=(e,t="")=>{if(typeof document>"u")return t;const r=document.documentElement;if(!r)return t;const o=typeof window<"u"&&typeof window.getComputedStyle=="function"?window.getComputedStyle(r).getPropertyValue(e).trim():"";return o||r.style.getPropertyValue(e).trim()||t};typeof window<"u"&&"serviceWorker"in navigator&&window.addEventListener("load",()=>{const e=typeof globalThis<"u"&&globalThis&&globalThis.cineOffline||typeof window<"u"&&window&&window.cineOffline||null;if(e&&typeof e.registerServiceWorker=="function"){e.registerServiceWorker("service-worker.js",{immediate:!0,window,navigator});return}try{navigator.serviceWorker.register("service-worker.js")}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Service worker registration failed via fallback path.",t)}});function IR(e){if(!e)return 0;const t=typeof e.getBoundingClientRect=="function"?e.getBoundingClientRect():null;return t&&typeof t.height=="number"&&t.height>0?t.height:e.offsetHeight||0}function iA(e){if(typeof document>"u")return;const t=document.documentElement;t&&(e>0?t.style.setProperty("--install-banner-offset",`${Math.ceil(e)} px`):t.style.removeProperty("--install-banner-offset"))}let bh=!1;const su="Force reload requires an internet connection. Try again once you are back online.";function A1(){if(bh||typeof window>"u")return;const e=typeof window.requestAnimationFrame=="function"&&window.requestAnimationFrame.bind(window)||typeof window.setTimeout=="function"&&(t=>window.setTimeout(t,0));e&&(bh=!0,e(()=>{bh=!1,rs()}))}function rs(){if(typeof document>"u")return;const e=document.getElementById("installPromptBanner");if(!e){iA(0);return}const t=document.getElementById("offlineIndicator"),o=!!(t&&!t.hasAttribute("hidden"))?IR(t):0;o>0?e.style.top=`${o} px`:e.style.removeProperty("top");const n=!e.hasAttribute("hidden"),a=n?IR(e):0,i=o+a;iA(i),n&&!a&&A1()}function E1(){if(typeof document>"u"||typeof document.getElementById!="function"||typeof navigator>"u")return;const e=document.getElementById("offlineIndicator");if(!e)return;const t=document.getElementById("reloadButton"),r=e.dataset||{},o=typeof e.textContent=="string"&&e.textContent.trim()?e.textContent.trim():"Offline";if(e.dataset){(!r.baseLabel||!r.baseLabel.trim())&&(e.dataset.baseLabel=o);const k=typeof e.getAttribute=="function"?e.getAttribute("data-help"):null;(!e.dataset.baseHelp||!e.dataset.baseHelp.trim())&&(typeof k=="string"&&k.trim()?e.dataset.baseHelp=k.trim():e.dataset.baseHelp=e.dataset.baseLabel||o),(!e.dataset.forceReloadNotice||!e.dataset.forceReloadNotice.trim())&&(e.dataset.forceReloadNotice=su),(!e.dataset.degradedLabel||!e.dataset.degradedLabel.trim())&&(e.dataset.degradedLabel=e.dataset.forceReloadNotice||su),(!e.dataset.degradedHelp||!e.dataset.degradedHelp.trim())&&(e.dataset.degradedHelp=e.dataset.baseHelp||o),(!e.dataset.reasonCacheFallback||!e.dataset.reasonCacheFallback.trim())&&(e.dataset.reasonCacheFallback=e.dataset.forceReloadNotice||su),(!e.dataset.reasonGetFailed||!e.dataset.reasonGetFailed.trim())&&(e.dataset.reasonGetFailed=e.dataset.reasonCacheFallback),(!e.dataset.reasonTimeout||!e.dataset.reasonTimeout.trim())&&(e.dataset.reasonTimeout=e.dataset.reasonCacheFallback),(!e.dataset.reasonUnreachable||!e.dataset.reasonUnreachable.trim())&&(e.dataset.reasonUnreachable=e.dataset.reasonCacheFallback),(!e.dataset.reasonReloadBlocked||!e.dataset.reasonReloadBlocked.trim())&&(e.dataset.reasonReloadBlocked=e.dataset.forceReloadNotice||su),(!e.dataset.reasonUnknown||!e.dataset.reasonUnknown.trim())&&(e.dataset.reasonUnknown=e.dataset.degradedHelp||o)}const n="cine-sw:connectivity-status",a="cine-sw-logs";let i=null,s=null,u=!1,l=null;const d=()=>{const k=e.dataset?.forceReloadNotice;if(typeof k=="string"&&k.trim())return k.trim();const Z=t?.dataset?.offlineNotice;return typeof Z=="string"&&Z.trim()?Z.trim():su},p=()=>typeof navigator.onLine=="boolean"?navigator.onLine!==!1:!0,g=()=>e.dataset?.baseLabel&&e.dataset.baseLabel.trim()?e.dataset.baseLabel.trim():o,h=()=>e.dataset?.baseHelp&&e.dataset.baseHelp.trim()?e.dataset.baseHelp.trim():g(),A=()=>e.dataset?.degradedLabel&&e.dataset.degradedLabel.trim()?e.dataset.degradedLabel.trim():d(),m=()=>e.dataset?.degradedHelp&&e.dataset.degradedHelp.trim()?e.dataset.degradedHelp.trim():A(),y={"cache-fallback":"reasonCacheFallback","get-failed":"reasonGetFailed",timeout:"reasonTimeout",unreachable:"reasonUnreachable","reload-blocked":"reasonReloadBlocked",offline:"forceReloadNotice"},S=k=>{if(!k){const H=e.dataset?.reasonUnknown;return typeof H=="string"&&H.trim()?H.trim():""}if(k==="navigator-offline")return d();const Z=y[k]||"reasonUnknown",ue=e.dataset?.[Z];if(typeof ue=="string"&&ue.trim())return ue.trim();if(Z!=="reasonUnknown"){const H=e.dataset?.reasonUnknown;if(typeof H=="string"&&H.trim())return H.trim()}return""},E=k=>{if(!k)return"";if(typeof k=="string")return k.trim();if(typeof k!="object")return"";const Z=[];if(typeof k.status=="number"&&Number.isFinite(k.status)&&Z.push(`HTTP ${k.status} `),typeof k.statusText=="string"&&k.statusText.trim()&&Z.push(k.statusText.trim()),typeof k.message=="string"&&k.message.trim()&&Z.push(k.message.trim()),typeof k.error=="string"&&k.error.trim()&&Z.push(k.error.trim()),!Z.length&&k.error&&typeof k.error=="object"){const ue=E(k.error);ue&&Z.push(ue)}return!Z.length&&k.reason&&typeof k.reason=="string"&&Z.push(k.reason.trim()),Z.join(" ").trim()},I=(k,Z)=>{if(!t)return;const ue=typeof Z=="string"&&Z.trim()?Z.trim():d();if(t.dataset){if(!t.dataset.onlineTitle||!t.dataset.onlineTitle.trim()){const H=t.getAttribute("title");typeof H=="string"&&H.trim()?t.dataset.onlineTitle=H.trim():t.dataset.onlineTitle="Force reload"}if(!t.dataset.onlineHelp||!t.dataset.onlineHelp.trim()){const H=t.getAttribute("data-help");typeof H=="string"&&H.trim()?t.dataset.onlineHelp=H.trim():t.dataset.onlineHelp=t.dataset.onlineTitle}if(!t.dataset.onlineAriaLabel||!t.dataset.onlineAriaLabel.trim()){const H=t.getAttribute("aria-label");typeof H=="string"&&H.trim()?t.dataset.onlineAriaLabel=H.trim():t.dataset.onlineAriaLabel=t.dataset.onlineTitle}(!t.dataset.offlineNotice||!t.dataset.offlineNotice.trim())&&(t.dataset.offlineNotice=ue)}if(k==="online"){t.removeAttribute("disabled"),t.removeAttribute("aria-disabled");const H=t.dataset?.onlineTitle||"Force reload",Y=t.dataset?.onlineHelp||H;t.setAttribute("title",H),t.setAttribute("data-help",Y);const N=t.dataset?.onlineAriaLabel||H;t.setAttribute("aria-label",N)}else t.setAttribute("disabled","disabled"),t.setAttribute("aria-disabled","true"),t.setAttribute("title",ue),t.setAttribute("data-help",ue),t.setAttribute("aria-label",ue),t.dataset&&(t.dataset.offlineNotice=ue,t.dataset.degradedNotice=ue)},L=k=>{if(!k||typeof k!="object")return null;const Z=typeof k.status=="string"&&k.status?k.status:"unknown",ue=typeof k.reason=="string"&&k.reason?k.reason:null,H=typeof k.timestamp=="number"&&Number.isFinite(k.timestamp)?k.timestamp:Date.now();let Y=null;return k.detail&&typeof k.detail=="object"?Y=k.detail:typeof k.detail=="string"&&k.detail.trim()&&(Y=k.detail.trim()),{status:Z,reason:ue,detail:Y,timestamp:H}},R=()=>{const k=p();let Z=k?"online":"offline",ue=k?null:"navigator-offline",H=null,Y=null;if(i){const N=i.status;N==="offline"?(Z="offline",ue=i.reason||ue||"offline",H=i.detail||null,Y=i.timestamp||null):N==="degraded"&&Z!=="offline"?(Z="degraded",ue=i.reason||"unknown",H=i.detail||null,Y=i.timestamp||null):N==="online"&&k&&(Z="online",ue=i.reason||null,H=i.detail||null,Y=i.timestamp||null)}if(e.dataset&&(e.dataset.connectivityStatus=Z,ue?e.dataset.connectivityReason=ue:e.dataset.connectivityReason&&delete e.dataset.connectivityReason,Y?e.dataset.connectivityTimestamp=String(Y):e.dataset.connectivityTimestamp&&delete e.dataset.connectivityTimestamp),Z==="online"){const N=g(),ae=h();(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=N),e.setAttribute("data-help",ae),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),I("online",d())}else if(Z==="offline"){const N=d();e.dataset&&(e.dataset.forceReloadNotice=N,e.dataset.reloadNotice=N),(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=N),e.setAttribute("data-help",N),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.removeAttribute("hidden"),I("offline",N)}else{const N=A(),ae=S(ue),de=E(H),Q=[];ae&&Q.push(ae),de&&de!==ae&&Q.push(de);const ne=Q.join(" ").trim(),V=ne?`${N} — ${ne} `:N,fe=m(),J=[];ne&&J.push(ne),fe&&(!ne||fe.indexOf(ne)===-1)&&J.push(fe);const Ae=J.join(" ").trim()||fe||V;e.dataset&&(e.dataset.forceReloadNotice=V,e.dataset.reloadNotice=V),(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=V),e.setAttribute("data-help",Ae),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.removeAttribute("hidden"),I("degraded",V)}typeof rs=="function"&&rs()},G=k=>{const Z=L(k);Z&&(i&&i.status===Z.status&&i.reason===Z.reason&&i.timestamp===Z.timestamp||(i=Z,R(),typeof gt=="function"&&gt("updateStorageSummary",[],{defer:!0})))},j=k=>{if(!k)return;let Z=null;try{Z=k.data||null}catch{Z=null}if(!(!Z||typeof Z!="object")&&Z.type===n){const ue=Z.state&&typeof Z.state=="object"?Z.state:null;ue&&G(ue)}},$=()=>{if(!(s||u)){if(typeof BroadcastChannel!="function"){u=!0;return}try{s=new BroadcastChannel(a),s.addEventListener("message",j)}catch(k){u=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn("setupOfflineIndicator: Unable to listen for connectivity updates",k)}}},te=(()=>{try{if(typeof cineOffline<"u"&&cineOffline)return cineOffline}catch{}const k=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let Z=0;Z<k.length;Z+=1){const ue=k[Z];if(ue&&typeof ue.cineOffline=="object")return ue.cineOffline}return null})();if(te&&typeof te.subscribeConnectivityStatus=="function")try{l=te.subscribeConnectivityStatus(G)}catch{l=null}const oe=te&&typeof te.getConnectivityState=="function"?te.getConnectivityState():typeof window<"u"&&window&&typeof window.cineConnectivityStatus=="object"?window.cineConnectivityStatus:null;return oe&&G(oe),$(),typeof window<"u"&&typeof window.addEventListener=="function"&&(window.addEventListener("online",R),window.addEventListener("offline",R)),R(),l}typeof window<"u"&&E1();function vs(){const e=document.getElementById("sideMenu"),t=document.getElementById("menuOverlay"),r=document.getElementById("menuToggle"),o=typeof document<"u"?document.body:null;!e||!t||!r||(e.classList.remove("open"),e.setAttribute("hidden",""),r.setAttribute("aria-expanded","false"),o&&o.classList.remove("menu-open"),r.focus())}typeof window<"u"&&(window.closeSideMenu=vs);function EC(){const e=document.getElementById("sideMenu"),t=document.getElementById("menuOverlay"),r=document.getElementById("menuToggle"),o=document.getElementById("closeMenuButton"),n=typeof document<"u"?document.body:null;if(!e||!t||!r||e.classList.contains("open"))return;e.classList.add("open"),e.removeAttribute("hidden"),r.setAttribute("aria-expanded","true");const a=r.dataset?.closeLabel||o?.getAttribute("aria-label")||"Close menu",i=r.dataset?.closeHelp||o?.getAttribute("data-help")||a;r.setAttribute("aria-label",a),r.setAttribute("data-help",i),n?.classList.add("menu-open")}typeof window<"u"&&(window.openSideMenu=EC);function CC(){const e=document.getElementById("menuToggle"),t=document.getElementById("sideMenu"),r=document.getElementById("menuOverlay"),o=document.getElementById("closeMenuButton");if(!e||!t||!r){document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",CC);return}if(e.dataset.menuInitialized)return;e.dataset.menuInitialized="true",r.style.display,e.addEventListener("click",()=>{t.classList.contains("open")?vs():EC()}),r.addEventListener("click",vs),o?.addEventListener("click",()=>{vs(),e.focus()}),typeof window<"u"&&typeof window.matchMedia=="function"&&window.matchMedia("(max-width: 768px)").addEventListener("change",i=>{!i.matches&&t.classList.contains("open")&&vs()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&t.classList.contains("open")&&(vs(),e.focus())}),t.querySelectorAll("a").forEach(a=>{a.addEventListener("click",i=>{const s=a.getAttribute("href");s&&s.startsWith("#")&&(i.preventDefault(),document.querySelector(s)?.scrollIntoView(),history.replaceState(null,"",window.location.pathname+window.location.search)),vs()})});const n=a=>{a&&(a==="open-settings"?document.getElementById("settingsButton")?.click():a==="open-help"?document.getElementById("helpButton")?.click():a==="open-own-gear"?typeof zg=="function"&&zg():a==="open-contacts"&&(aP(),Lf(wn)))};t.querySelectorAll("[data-sidebar-action]").forEach(a=>{a.addEventListener("click",i=>{i.preventDefault(),n(a.dataset.sidebarAction)})})}typeof window<"u"&&(window.setupSideMenu=CC);function wC(){const e=document.getElementById("topBar"),t=e?.querySelector(".feature-search"),r=e?.querySelector(".controls"),o=document.querySelector("#sideMenu .sidebar-controls");if(!e||!t||!r||!o||typeof window.matchMedia!="function"){document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",wC);return}if(e.dataset.responsiveInitialized)return;e.dataset.responsiveInitialized="true";const n=window.matchMedia("(max-width: 768px)"),a=()=>{n.matches?(o.appendChild(t),o.appendChild(r)):(e.appendChild(t),e.appendChild(r))};n.addEventListener("change",a),a()}typeof window<"u"&&(window.setupResponsiveControls=wC);let Pi=null,Hf=null,xi=null,jf=null,Ms={items:[],map:new Map};function ob(){return typeof $e=="object"&&$e?$e:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function C1(){if(Pi)return Pi;if(typeof require=="function")try{const t=require("./own-gear/store.js");if(t&&typeof t.createOwnGearStore=="function")return Pi=t,Pi}catch{}const e=ob();return e&&typeof e.cineOwnGearStore=="object"&&e.cineOwnGearStore?(Pi=e.cineOwnGearStore,Pi):typeof cineOwnGearStore=="object"&&cineOwnGearStore?(Pi=cineOwnGearStore,Pi):null}function ds(){if(Hf)return Hf;const e=C1();if(e&&typeof e.createOwnGearStore=="function")try{return Hf=e.createOwnGearStore(),Hf}catch{}return null}function w1(){if(xi)return xi;if(typeof require=="function")try{const t=require("./own-gear/view.js");if(t&&typeof t.createOwnGearView=="function")return xi=t,xi}catch{}const e=ob();return e&&typeof e.cineOwnGearView=="object"&&e.cineOwnGearView?(xi=e.cineOwnGearView,xi):typeof cineOwnGearView=="object"&&cineOwnGearView?(xi=cineOwnGearView,xi):null}function L1(){return{scope:ob()||{},document:typeof document<"u"?document:null,getLanguageTexts,defaultLanguage:Qr,getCurrentLanguage:()=>rt,formatWithPlaceholders:u0,setButtonLabelWithIconBinding:je,iconMarkup:wa,iconGlyphs:ICON_GLYPHS,openDialog:Lf,closeDialog:gi,formatQuantityText:B1,devices:Et,gearItemTranslations:Cm,looksLikeGearName:BB}}function LC(){if(jf)return jf;const e=w1(),t=ds();if(!e||typeof e.createOwnGearView!="function"||!t)return null;try{return jf=e.createOwnGearView(t,L1()),jf}catch{}return null}function R1(){const e=ds();if(e&&typeof e.invalidateCache=="function")try{e.invalidateCache();return}catch{}Ms={items:[],map:new Map}}function I1(){const e=ds();if(e&&typeof e.refreshCache=="function")try{const a=e.refreshCache();return{items:Array.isArray(a.items)?a.items.slice():[],map:a.map instanceof Map?a.map:new Map}}catch{}const t=rb();let r=[];if(t&&typeof t.loadStoredOwnGearItems=="function")try{r=t.loadStoredOwnGearItems()}catch(a){console.warn("Unable to load own gear items for automatic gear rules via module.",a)}(!Array.isArray(r)||!r.length)&&(r=k1());const o=Array.isArray(r)?r.map(xB).filter(Boolean):[],n=new Map;return o.forEach(a=>{!a||!a.id||n.set(a.id,a)}),Ms={items:o,map:n},Ms}function PB(){const e=ds();if(e&&typeof e.getCacheSnapshot=="function")try{const t=e.getCacheSnapshot();return{items:Array.isArray(t.items)?t.items.slice():[],map:t.map instanceof Map?t.map:new Map}}catch{}return Ms&&Array.isArray(Ms.items)&&Ms.items.length?Ms:I1()}function T1(){return PB().items.slice()}function O1(e){if(!e)return null;const t=ds();if(t&&typeof t.findCachedById=="function")try{return t.findCachedById(e)}catch{}return PB().map.get(e)||null}function G1(){const e=ds();if(e&&typeof e.generateOwnGearId=="function")try{return e.generateOwnGearId()}catch{}const t=rb();if(t&&typeof t.generateOwnGearId=="function")try{return t.generateOwnGearId()}catch(n){console.warn("Unable to generate own gear id via module.",n)}if(typeof crypto<"u"&&crypto&&typeof crypto.randomUUID=="function")try{return crypto.randomUUID()}catch{}const r=Date.now().toString(36),o=Math.floor(Math.random()*1e8).toString(36);return`own - ${r} -${o} `}function xB(e){const t=ds();if(t&&typeof t.normalizeOwnGearRecord=="function")try{return t.normalizeOwnGearRecord(e)}catch{}const r=rb();if(r&&typeof r.normalizeOwnGearRecord=="function")try{return r.normalizeOwnGearRecord(e)}catch(a){console.warn("Unable to normalize own gear entry via module.",a)}if(!e||typeof e!="object")return null;const o=typeof e.name=="string"?e.name.trim():"";if(!o)return null;const n={id:typeof e.id=="string"&&e.id.trim()?e.id.trim():G1(),name:o};return typeof e.quantity=="string"&&e.quantity.trim()?n.quantity=e.quantity.trim():typeof e.quantity=="number"&&Number.isFinite(e.quantity)&&(n.quantity=String(e.quantity)),typeof e.notes=="string"&&e.notes.trim()&&(n.notes=e.notes.trim()),typeof e.source=="string"&&e.source.trim()&&(n.source=e.source.trim()),n}function k1(){const e=ds();if(e&&typeof e.loadStoredOwnGearItems=="function")try{return e.loadStoredOwnGearItems()}catch{}const t=rb();if(t&&typeof t.loadStoredOwnGearItems=="function")try{return t.loadStoredOwnGearItems()}catch(r){console.warn("Unable to load own gear items via module.",r)}if(typeof loadOwnGear!="function")return[];try{const r=loadOwnGear();if(!Array.isArray(r))return[];const o=new Set;return r.map(xB).filter(n=>!n||o.has(n.id)?!1:(o.add(n.id),!0))}catch(r){return console.warn("Failed to load own gear items from storage",r),[]}}function B1(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=Number(t.replace(",","."));if(!Number.isNaN(r)&&Number.isFinite(r)){const o=Math.round(r*1e3)/1e3;return String(o).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1")}return t}function zg(){const e=LC();if(e&&typeof e.openDialog=="function")try{e.openDialog()}catch{}}function P1(e){const t=LC();if(t&&typeof t.applyLocalization=="function")try{t.applyLocalization(e)}catch{}}function Em(){CC(),wC()}function x1(){const e=LC();if(e){try{e.initialize()}catch{}try{St("openOwnGearDialog",zg)}catch{const r=ob();r&&(r.openOwnGearDialog=zg)}}}if(typeof window<"u"&&typeof document<"u")var TR=()=>{Em(),x1(),aP()},WP=()=>{const t=()=>{typeof window<"u"&&typeof window.setTimeout=="function"?window.setTimeout(TR,0):TR()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()};const an=(()=>{if(typeof require=="function")try{return require("./app-core-auto-backup.js")}catch{}let e=null;if(typeof Jv=="function")e=Jv("./app-core-auto-backup.js");else if(typeof cineRuntimeBootstrapExports=="object"&&cineRuntimeBootstrapExports&&typeof cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule=="function")e=cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule("./app-core-auto-backup.js");else{const r=(typeof $e<"u"?$e:null)||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null);r&&typeof r.fallbackRequireCoreRuntimeModule=="function"&&(e=r.fallbackRequireCoreRuntimeModule("./app-core-auto-backup.js"))}if(e&&typeof e=="object")return e;const t=[typeof $e<"u"?$e:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const o=t[r];if(!(!o||typeof o!="object"&&typeof o!="function"))try{if(o.CORE_AUTO_BACKUP&&typeof o.CORE_AUTO_BACKUP=="object")return o.CORE_AUTO_BACKUP}catch{}}return null})(),M1=an&&typeof an.AUTO_BACKUP_NAME_PREFIX=="string"?an.AUTO_BACKUP_NAME_PREFIX:"auto-backup-",D1=an&&typeof an.AUTO_BACKUP_DELETION_PREFIX=="string"?an.AUTO_BACKUP_DELETION_PREFIX:"auto-backup-before-delete-";var ef=an&&typeof an.logAutoBackupEvent=="function"?an.logAutoBackupEvent:function(t,r,o,n){const a=typeof t=="string"&&t?t.toLowerCase():"info",i=typeof r=="string"&&r?r:"Auto backup event";if(typeof console>"u"||!console)return;let s=null;if(a==="error"&&typeof console.error=="function"?s=console.error:a==="warn"&&typeof console.warn=="function"?s=console.warn:a==="info"&&typeof console.info=="function"?s=console.info:a==="debug"&&typeof console.debug=="function"?s=console.debug:typeof console.log=="function"&&(s=console.log),typeof s=="function")try{s.call(console,`[auto - backup] ${i} `,o||null,n||null)}catch{}};const OR=an&&typeof an.cloneProjectEntryForSetup=="function"?an.cloneProjectEntryForSetup:null,GR=an&&typeof an.ensureAutoBackupsFromProjects=="function"?an.ensureAutoBackupsFromProjects:null;var MB=!1;try{typeof localStorage<"u"&&(MB=localStorage.getItem("showAutoBackups")==="true")}catch(e){ef("warn","Could not load auto backup visibility preference",e)}function _1(e){if(OR)return OR(e,{deepClone:vc,log:ef});if(!e||typeof e!="object")return{};try{return vc(e)}catch(t){ef("warn","Fallback auto backup project clone failed",t);const r={};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(r[o]=e[o]);return r}}function F1(){return GR?GR({loadProject:typeof loadProject=="function"?loadProject:null,getSetups:DB,storeSetups:_B,log:ef,cloneProjectEntry:e=>_1(e),autoBackupNamePrefix:M1,autoBackupDeletionPrefix:D1}):!1}if(MB)try{F1()}catch(e){ef("warn","Failed to prepare auto backups from project storage",e)}function DB(){return loadSetups()}St("getSetups",DB);function _B(e){saveSetups(e)}St("storeSetups",_B);function N1(){return typeof loadSessionState=="function"?loadSessionState():null}St("loadSession",N1);function H1(e){typeof saveSessionState=="function"&&saveSessionState(e)}St("storeSession",H1);function FB(e,t){e&&(t?typeof e.showModal=="function"?e.showModal():e.setAttribute("open",""):typeof e.close=="function"?e.close():e.removeAttribute("open"))}function Lf(e){FB(e,!0)}function gi(e){FB(e,!1)}function ul(e){return e?typeof e.open=="boolean"?!!(e.open||typeof e.hasAttribute=="function"&&e.hasAttribute("open")):typeof e.hasAttribute=="function"&&e.hasAttribute("open"):!1}St("normalizeDevicesForPersistence",SB);function j1(){let e=null;try{e=typeof updateGlobalDevicesReference=="function"?updateGlobalDevicesReference:null}catch{e=null}if(e)return e;const t=[],r=o=>{!o||typeof o!="object"&&typeof o!="function"||t.indexOf(o)===-1&&t.push(o)};try{r(typeof ho<"u"?ho:null)}catch{}try{r(typeof $e<"u"?$e:null)}catch{}try{r(typeof DEVICE_GLOBAL_SCOPE<"u"?DEVICE_GLOBAL_SCOPE:null)}catch{}try{r(typeof Ps<"u"?Ps:null)}catch{}r(typeof globalThis<"u"?globalThis:null),r(typeof window<"u"?window:null),r(typeof self<"u"?self:null),r(typeof global<"u"?global:null);for(let o=0;o<t.length;o+=1){const n=t[o];try{const a=n&&n.updateGlobalDevicesReference;if(typeof a=="function")return a}catch{}}return null}window.defaultDevices===void 0&&(window.defaultDevices=vc(window.devices),IU(window.defaultDevices),hB(window.defaultDevices));let kR=loadDeviceData();if(kR){const e=vc(window.defaultDevices);for(const[r,o]of Object.entries(kR))if(r==="fiz"&&o&&typeof o=="object"){e.fiz=e.fiz||{};for(const[n,a]of Object.entries(o))e.fiz[n]={...e.fiz[n]||{},...a||{}}}else e[r]&&typeof e[r]=="object"?e[r]={...e[r],...o||{}}:e[r]=o;window.devices=Et=e;const t=j1();if(typeof t=="function")try{t(Et)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to update global devices reference during initialization",r)}}hB(Et,{force:!0});function NB(e){const t=Et.cameras&&Et.cameras[e];return!t||!t.power||!Array.isArray(t.power.batteryPlateSupport)?[]:t.power.batteryPlateSupport.filter(Boolean).map(r=>!r||typeof r!="object"?r:r.type==="Gold Mount"?{...r,type:"Gold-Mount"}:r)}function z1(e){return NB(e).map(t=>t.type).filter(Boolean)}function BR(e){const t=NB(e);if(!t.length)return[];const r=new Set(t.filter(o=>o.mount==="native"&&o.type).map(o=>o.type));return r.size===1&&r.has("B-Mount")?["B-Mount"]:[...new Set(z1(e))]}var rd;function U1(){if(typeof document>"u"){typeof rd>"u"&&(rd=null);return}document.getElementById("batteryPlateRow"),rd=document.getElementById("batteryPlateSelect")}function $1(){U1();const e=typeof ol?.value=="string"?ol.value:"",t=typeof BR=="function"?BR(e):[];if(!Array.isArray(t)||!t.length)return null;const r=typeof rd?.value=="string"?rd.value:"";return r||(t.includes("V-Mount")?"V-Mount":t[0])}function q1(){const e=document.getElementById("batteryLabel");if(!e)return;const t=getLanguageTexts(rt),r=getLanguageTexts(Qr),o=resolveTextEntryInternal(t,r,"batterySelectHelp","");o?e.setAttribute("data-help",o):e.removeAttribute("data-help"),$1()==="B-Mount"?e.textContent=resolveTextEntryInternal(t,r,"batteryBMountLabel","B-Mount Battery:"):e.textContent=resolveTextEntryInternal(t,r,"batteryLabel","Battery:")}const V1={info:"status-message--info",success:"status-message--success",note:"status-message--note",warning:"status-message--warning",danger:"status-message--danger"};function W1(e,t){if(!e)return;const r=Object.values(V1);if(e.classList)r.forEach(o=>e.classList.remove(o));else if(typeof e.className=="string"){const o=e.className.split(/\s+/).filter(Boolean).filter(n=>!r.includes(n));e.className=o.join(" ")}e.dataset&&"statusLevel"in e.dataset?delete e.dataset.statusLevel:e.removeAttribute&&e.removeAttribute("data-status-level")}var Cm={};function K1(){var e=[];function t(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}try{e.push(typeof $e<"u"?$e:null)}catch{}e.push(t());for(var r=0;r<e.length;r+=1){var o=e[r];if(!(!o||typeof o!="object"))try{var n=o.translations;if(n&&typeof n.loadLanguage=="function")return n}catch{}}return typeof fn<"u"&&fn&&typeof fn.loadLanguage=="function"?fn:null}var Er=K1();if(typeof c>"u"){var fn=null,un=(function(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null})();Er&&Er.texts&&Er.categoryNames&&Er.gearItems?fn={texts:Er.texts,categoryNames:Er.categoryNames,gearItems:Er.gearItems}:un&&un.texts&&un.categoryNames&&un.gearItems&&(fn={texts:un.texts,categoryNames:un.categoryNames,gearItems:un.gearItems}),fn?(un&&(!un.texts&&fn.texts&&(un.texts=fn.texts),!un.categoryNames&&fn.categoryNames&&(un.categoryNames=fn.categoryNames),!un.gearItems&&fn.gearItems&&(un.gearItems=fn.gearItems)),Cm=fn.gearItems||{}):Cm={}}else Cm=typeof gearItems<"u"?gearItems:{};var wm=null,sA=null,Lm=null,Rm=null,PR=null,xR=null,MR=null,DR=null,_R=null,FR=null,NR=null,HR=null,lA=[],Ml=null,Mu=null,Du=null,ja=null,Dl=null,cA=null,_u=null,Im=null,_l=null,Fl=null,Qi=null,As=null,yl=null,Fu=null,Fo=null,Ni=null,Nu=null,Tm=null,RC={},HB={};const K=(function(){if(typeof resolveCoreSupportModule=="function")try{const t=resolveCoreSupportModule("cineCoreAutoGearUi","./app-core-auto-gear-ui.js");if(t&&typeof t=="object")return t}catch{}try{if(typeof cineCoreAutoGearUi=="object"&&cineCoreAutoGearUi)return cineCoreAutoGearUi}catch{}try{const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(t&&typeof t.cineCoreAutoGearUi=="object"&&t.cineCoreAutoGearUi)return t.cineCoreAutoGearUi}catch{}return{}})();var hh=K.autoGearRuleNameInput!==void 0?K.autoGearRuleNameInput:null,zf=K.autoGearRuleNameLabel!==void 0?K.autoGearRuleNameLabel:null,Hu=K.autoGearScenariosSelect!==void 0?K.autoGearScenariosSelect:null,Uf=K.autoGearScenariosLabel!==void 0?K.autoGearScenariosLabel:null,$f=K.autoGearScenarioModeLabel!==void 0?K.autoGearScenarioModeLabel:null;K.autoGearScenarioMultiplierContainer!==void 0&&K.autoGearScenarioMultiplierContainer;var Sh=K.autoGearScenarioBaseSelect!==void 0?K.autoGearScenarioBaseSelect:null,qf=K.autoGearScenarioBaseLabel!==void 0?K.autoGearScenarioBaseLabel:null,vh=K.autoGearScenarioFactorInput!==void 0?K.autoGearScenarioFactorInput:null,Vf=K.autoGearScenarioFactorLabel!==void 0?K.autoGearScenarioFactorLabel:null,ga=K.autoGearShootingDaysMode!==void 0?K.autoGearShootingDaysMode:null,ya=K.autoGearShootingDaysInput!==void 0?K.autoGearShootingDaysInput:null,Wf=K.autoGearShootingDaysLabel!==void 0?K.autoGearShootingDaysLabel:null,Ah=K.autoGearShootingDaysHelp!==void 0?K.autoGearShootingDaysHelp:null,Eh=K.autoGearShootingDaysValueLabel!==void 0?K.autoGearShootingDaysValueLabel:null,ju=K.autoGearMatteboxSelect!==void 0?K.autoGearMatteboxSelect:null,Kf=K.autoGearMatteboxLabel!==void 0?K.autoGearMatteboxLabel:null;K.autoGearMatteboxModeLabel!==void 0&&K.autoGearMatteboxModeLabel;K.autoGearMatteboxModeSelect!==void 0&&K.autoGearMatteboxModeSelect;var zu=K.autoGearCameraHandleSelect!==void 0?K.autoGearCameraHandleSelect:null,Yf=K.autoGearCameraHandleLabel!==void 0?K.autoGearCameraHandleLabel:null;K.autoGearCameraHandleModeLabel!==void 0&&K.autoGearCameraHandleModeLabel;K.autoGearCameraHandleModeSelect!==void 0&&K.autoGearCameraHandleModeSelect;var Uu=K.autoGearViewfinderExtensionSelect!==void 0?K.autoGearViewfinderExtensionSelect:null,Qf=K.autoGearViewfinderExtensionLabel!==void 0?K.autoGearViewfinderExtensionLabel:null;K.autoGearViewfinderExtensionModeLabel!==void 0&&K.autoGearViewfinderExtensionModeLabel;K.autoGearViewfinderExtensionModeSelect!==void 0&&K.autoGearViewfinderExtensionModeSelect;var Xf=K.autoGearDeliveryResolutionSelect!==void 0?K.autoGearDeliveryResolutionSelect:null,Zf=K.autoGearDeliveryResolutionLabel!==void 0?K.autoGearDeliveryResolutionLabel:null;K.autoGearDeliveryResolutionModeLabel!==void 0&&K.autoGearDeliveryResolutionModeLabel;K.autoGearDeliveryResolutionModeSelect!==void 0&&K.autoGearDeliveryResolutionModeSelect;var $u=K.autoGearVideoDistributionSelect!==void 0?K.autoGearVideoDistributionSelect:null,Jf=K.autoGearVideoDistributionLabel!==void 0?K.autoGearVideoDistributionLabel:null;K.autoGearVideoDistributionModeLabel!==void 0&&K.autoGearVideoDistributionModeLabel;K.autoGearVideoDistributionModeSelect!==void 0&&K.autoGearVideoDistributionModeSelect;var Om=K.autoGearCameraSelect!==void 0?K.autoGearCameraSelect:null,ep=K.autoGearCameraLabel!==void 0?K.autoGearCameraLabel:null;K.autoGearCameraModeLabel!==void 0&&K.autoGearCameraModeLabel;K.autoGearCameraModeSelect!==void 0&&K.autoGearCameraModeSelect;var tp=K.autoGearOwnGearLabel!==void 0?K.autoGearOwnGearLabel:null;K.autoGearOwnGearModeLabel!==void 0&&K.autoGearOwnGearModeLabel;K.autoGearOwnGearModeSelect!==void 0&&K.autoGearOwnGearModeSelect;var Gm=K.autoGearOwnGearSelect!==void 0?K.autoGearOwnGearSelect:null,rp=K.autoGearCameraWeightLabel!==void 0?K.autoGearCameraWeightLabel:null,ba=K.autoGearCameraWeightOperator!==void 0?K.autoGearCameraWeightOperator:null,op=K.autoGearCameraWeightOperatorLabel!==void 0?K.autoGearCameraWeightOperatorLabel:null,ha=K.autoGearCameraWeightValueInput!==void 0?K.autoGearCameraWeightValueInput:null,np=K.autoGearCameraWeightValueLabel!==void 0?K.autoGearCameraWeightValueLabel:null,ap=K.autoGearCameraWeightHelp!==void 0?K.autoGearCameraWeightHelp:null,km=K.autoGearMonitorSelect!==void 0?K.autoGearMonitorSelect:null,ip=K.autoGearMonitorLabel!==void 0?K.autoGearMonitorLabel:null;K.autoGearMonitorModeLabel!==void 0&&K.autoGearMonitorModeLabel;K.autoGearMonitorModeSelect!==void 0&&K.autoGearMonitorModeSelect;var Ch=K.autoGearTripodHeadBrandSelect!==void 0?K.autoGearTripodHeadBrandSelect:null,sp=K.autoGearTripodHeadBrandLabel!==void 0?K.autoGearTripodHeadBrandLabel:null;K.autoGearTripodHeadBrandModeLabel!==void 0&&K.autoGearTripodHeadBrandModeLabel;K.autoGearTripodHeadBrandModeSelect!==void 0&&K.autoGearTripodHeadBrandModeSelect;var wh=K.autoGearTripodBowlSelect!==void 0?K.autoGearTripodBowlSelect:null,lp=K.autoGearTripodBowlLabel!==void 0?K.autoGearTripodBowlLabel:null;K.autoGearTripodBowlModeLabel!==void 0&&K.autoGearTripodBowlModeLabel;K.autoGearTripodBowlModeSelect!==void 0&&K.autoGearTripodBowlModeSelect;var Lh=K.autoGearTripodTypesSelect!==void 0?K.autoGearTripodTypesSelect:null,cp=K.autoGearTripodTypesLabel!==void 0?K.autoGearTripodTypesLabel:null;K.autoGearTripodTypesModeLabel!==void 0&&K.autoGearTripodTypesModeLabel;K.autoGearTripodTypesModeSelect!==void 0&&K.autoGearTripodTypesModeSelect;var Rh=K.autoGearTripodSpreaderSelect!==void 0?K.autoGearTripodSpreaderSelect:null,up=K.autoGearTripodSpreaderLabel!==void 0?K.autoGearTripodSpreaderLabel:null;K.autoGearTripodSpreaderModeLabel!==void 0&&K.autoGearTripodSpreaderModeLabel;K.autoGearTripodSpreaderModeSelect!==void 0&&K.autoGearTripodSpreaderModeSelect;var od=K.autoGearCrewPresentSelect!==void 0?K.autoGearCrewPresentSelect:null,dp=K.autoGearCrewPresentLabel!==void 0?K.autoGearCrewPresentLabel:null;K.autoGearCrewPresentModeLabel!==void 0&&K.autoGearCrewPresentModeLabel;K.autoGearCrewPresentModeSelect!==void 0&&K.autoGearCrewPresentModeSelect;var nd=K.autoGearCrewAbsentSelect!==void 0?K.autoGearCrewAbsentSelect:null,fp=K.autoGearCrewAbsentLabel!==void 0?K.autoGearCrewAbsentLabel:null;K.autoGearCrewAbsentModeLabel!==void 0&&K.autoGearCrewAbsentModeLabel;K.autoGearCrewAbsentModeSelect!==void 0&&K.autoGearCrewAbsentModeSelect;var Bm=K.autoGearWirelessSelect!==void 0?K.autoGearWirelessSelect:null,pp=K.autoGearWirelessLabel!==void 0?K.autoGearWirelessLabel:null;K.autoGearWirelessModeLabel!==void 0&&K.autoGearWirelessModeLabel;K.autoGearWirelessModeSelect!==void 0&&K.autoGearWirelessModeSelect;var Pm=K.autoGearMotorsSelect!==void 0?K.autoGearMotorsSelect:null,mp=K.autoGearMotorsLabel!==void 0?K.autoGearMotorsLabel:null;K.autoGearMotorsModeLabel!==void 0&&K.autoGearMotorsModeLabel;K.autoGearMotorsModeSelect!==void 0&&K.autoGearMotorsModeSelect;var xm=K.autoGearControllersSelect!==void 0?K.autoGearControllersSelect:null,gp=K.autoGearControllersLabel!==void 0?K.autoGearControllersLabel:null;K.autoGearControllersModeLabel!==void 0&&K.autoGearControllersModeLabel;K.autoGearControllersModeSelect!==void 0&&K.autoGearControllersModeSelect;var Mm=K.autoGearDistanceSelect!==void 0?K.autoGearDistanceSelect:null,yp=K.autoGearDistanceLabel!==void 0?K.autoGearDistanceLabel:null;K.autoGearDistanceModeLabel!==void 0&&K.autoGearDistanceModeLabel;K.autoGearDistanceModeSelect!==void 0&&K.autoGearDistanceModeSelect;var Y1=K.autoGearConditionLabels!==void 0?K.autoGearConditionLabels:{},Q1=K.autoGearConditionSelects!==void 0?K.autoGearConditionSelects:{},jB=K.autoGearConditionLogicLabels!==void 0?K.autoGearConditionLogicLabels:{},IC=K.autoGearConditionLogicSelects!==void 0?K.autoGearConditionLogicSelects:{};const X1=typeof K.getAutoGearScenarioModeSelectElement=="function"?K.getAutoGearScenarioModeSelectElement:()=>K.autoGearScenarioModeSelectElement||null,zB=typeof K.setAutoGearScenarioModeSelectElement=="function"?K.setAutoGearScenarioModeSelectElement:e=>{K.autoGearScenarioModeSelectElement=e||null};let qs=X1();zB(qs);var tf=Array.isArray(K.AUTO_GEAR_CONDITION_KEYS)?K.AUTO_GEAR_CONDITION_KEYS:["always","scenarios","shootingDays","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","cameraWeight","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"];const UB=K.AUTO_GEAR_REPEATABLE_CONDITIONS instanceof Set?K.AUTO_GEAR_REPEATABLE_CONDITIONS:new Set(["scenarios","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"]);var Z1=K.AUTO_GEAR_CONDITION_FALLBACK_LABELS||{always:"Always include",scenarios:"Required scenarios",shootingDays:"Shooting days condition",mattebox:"Mattebox options",cameraHandle:"Camera handles",viewfinderExtension:"Viewfinder extension",deliveryResolution:"Delivery resolution",videoDistribution:"Video distribution",camera:"Camera",ownGear:"Own gear items",cameraWeight:"Camera weight",monitor:"Onboard monitor",tripodHeadBrand:"Tripod head brand",tripodBowl:"Tripod bowl size",tripodTypes:"Tripod types",tripodSpreader:"Tripod spreader",crewPresent:"Crew present",crewAbsent:"Crew absent",wireless:"Wireless transmitter",motors:"FIZ motors",controllers:"FIZ controllers",distance:"FIZ distance devices"};function J1(){if(typeof hA=="function")try{const e=hA();if(e==="imperial"||e==="metric")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="imperial"||t==="metric")return t}}catch(e){console.warn("resolveGlobalFocusScalePreference helper threw an error while resolving a focus scale label",e)}if(typeof focusScalePreference=="string"){const e=focusScalePreference.trim().toLowerCase();if(e==="imperial"||e==="metric")return e}return""}function e$(e){const t=o=>{if(typeof normalizeFocusScale=="function")try{const n=normalizeFocusScale(o);if(n==="imperial"||n==="metric")return n;if(n===""||n===null)return""}catch(n){console.warn("normalizeFocusScale helper threw an error while resolving a focus scale label",n)}if(typeof o=="string"){const n=o.trim().toLowerCase();if(n==="imperial")return"imperial";if(n==="metric")return"metric";if(!n)return""}return""},r=t(e);if(r===""&&(typeof e>"u"||e===null||typeof e=="string"&&!e.trim())){const o=J1(),n=t(o);if(n==="imperial"||n==="metric")return n}return r}function t$(e=rt,t){const r=e$(t),o=getLanguageTexts(e)||{},n=getLanguageTexts("en")||{},a=o.focusScaleMetric||n.focusScaleMetric||o.focusScaleSetting||n.focusScaleSetting||"Metric",i=o.focusScaleImperial||n.focusScaleImperial||o.focusScaleSetting||n.focusScaleSetting||"Imperial";if(r==="imperial")return i;if(r==="metric")return a;if(typeof t=="string"){const s=t.trim();if(s)return s}return o.focusScaleSetting||o.lensFocusScaleLabel||n.focusScaleSetting||n.lensFocusScaleLabel||a}const Qr=(function(){const t=[function(){try{if(typeof DEFAULT_LANGUAGE=="string"&&DEFAULT_LANGUAGE)return DEFAULT_LANGUAGE}catch{}return null},function(){try{if(typeof LOCALE_MODULE=="object"&&LOCALE_MODULE&&typeof LOCALE_MODULE.DEFAULT_LANGUAGE=="string"&&LOCALE_MODULE.DEFAULT_LANGUAGE)return LOCALE_MODULE.DEFAULT_LANGUAGE}catch{}return null},function(){try{if(typeof ACTIVE_LOCALIZATION_ACCESSORS=="object"&&ACTIVE_LOCALIZATION_ACCESSORS&&typeof ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage=="string"&&ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage)return ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage}catch{}return null},function(){try{const o=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(o&&typeof o.DEFAULT_LANGUAGE=="string"&&o.DEFAULT_LANGUAGE)return o.DEFAULT_LANGUAGE;if(o&&typeof o.CPP_DEFAULT_LANGUAGE_SAFE=="string"&&o.CPP_DEFAULT_LANGUAGE_SAFE)return o.CPP_DEFAULT_LANGUAGE_SAFE}catch{}return null}];for(let r=0;r<t.length;r+=1){const o=t[r]();if(typeof o=="string"&&o)return o}return"en"})();if(Er&&typeof Er.loadLanguage=="function")try{var Ih=Er.loadLanguage(Qr);Ih&&typeof Ih.then=="function"&&Ih.catch(function(t){console.warn("Failed to eagerly load default translations",t)})}catch(e){console.warn("Failed to trigger default translation load",e)}const jR=(()=>{const e=new Set,t=r=>{if(typeof r!="string")return;const o=r.trim().toLowerCase();if(!o)return;e.add(o);const n=o.slice(0,2);n&&n!==o&&e.add(n)};if(typeof c=="object"&&c!==null&&Object.keys(c).forEach(t),Er&&typeof Er=="object"&&(Er.texts&&typeof Er.texts=="object"&&Object.keys(Er.texts).forEach(t),typeof Er.getAvailableLanguages=="function"))try{const r=Er.getAvailableLanguages();Array.isArray(r)&&r.forEach(t)}catch(r){console.warn("Failed to read available languages from translations runtime",r)}return t(Qr),Array.from(e)})();function $B(e){if(!e)return{language:Qr,matched:!1};const t=String(e).toLowerCase();if(jR.includes(t))return{language:t,matched:!0};const r=t.slice(0,2);return jR.includes(r)?{language:r,matched:!0}:{language:Qr,matched:!1}}try{const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;e&&typeof e=="object"&&((typeof e.CPP_DEFAULT_LANGUAGE_SAFE!="string"||!e.CPP_DEFAULT_LANGUAGE_SAFE)&&(e.CPP_DEFAULT_LANGUAGE_SAFE=Qr),(typeof e.DEFAULT_LANGUAGE!="string"||!e.DEFAULT_LANGUAGE)&&(e.DEFAULT_LANGUAGE=Qr))}catch{}var rt=Qr;let Th=null;try{const e=localStorage.getItem("language"),t=$B(e);e&&t.matched&&(rt=t.language)}catch(e){console.warn("Could not load language from localStorage",e)}try{typeof document<"u"&&document&&document.documentElement&&(document.documentElement.lang=rt)}catch{}const uA=()=>{try{if(typeof document<"u"&&document){const e=document.getElementById("languageSelect");e&&(e.value=rt);const t=document.getElementById("settingsLanguage");t&&(t.value=rt)}}catch(e){console.warn("Could not synchronize language selectors with initial language",e)}};uA();typeof document<"u"&&document&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",uA,{once:!0}):uA());async function r$(e,t={}){const r=typeof e=="string"?e:"",o=$B(r);let n=o.language;if(Er&&typeof Er.resolveLocaleKey=="function")try{n=Er.resolveLocaleKey(n)}catch(f){console.warn("Failed to normalize language via runtime",f)}if(Er&&typeof Er.loadLanguage=="function")try{typeof Er.showLoadingState=="function"&&Er.showLoadingState(n);const f=Er.loadLanguage(n);f&&typeof f.then=="function"&&await f}catch(f){console.warn(`Failed to load translations for "${n}"`,f)}finally{typeof Er.clearLoadingState=="function"&&Er.clearLoadingState()}const a=typeof c=="object"&&c||Er&&Er.texts||{};a[n]||(console.warn(`Missing translation bundle for "${n}".Falling back to ${Qr}.`),n=Qr),r&&n===Qr&&!o.matched&&r.slice(0,2).toLowerCase()!==Qr&&console.warn(`Unsupported language preference "${r}".Falling back to ${Qr}.`),e=n,!a[e]&&a[Qr]&&(a[e]=a[Qr]);const i=rt;rt=e,Ii();const s=i!==e,u=()=>{if(typeof window<"u"&&typeof window.dispatchEvent=="function"&&typeof Event=="function")try{window.dispatchEvent(new Event("languagechange"))}catch(f){console.warn("Failed to dispatch languagechange event",f)}};s&&(typeof queueMicrotask=="function"?queueMicrotask(u):typeof setTimeout=="function"?setTimeout(u,0):u());try{localStorage.setItem("language",e)}catch(f){console.warn("Could not save language to localStorage",f)}SI&&(SI.value=e),yu&&(yu.value=e),document.documentElement.lang=e,document.title=a[e].appTitle,document.getElementById("mainTitle")&&(document.getElementById("mainTitle").textContent=a[e].appTitle),document.getElementById("tagline")&&(document.getElementById("tagline").textContent=a[e].tagline);const l=typeof document<"u"?document:null,d=Ja(),p=()=>{let f=null;if(typeof refreshDeviceLists=="function"?f=refreshDeviceLists:d&&typeof d.refreshDeviceLists=="function"&&(f=d.refreshDeviceLists.bind(d)),typeof f!="function")return!1;try{f()}catch(w){console.warn("setLanguage: refreshDeviceLists execution failed",w)}return!0};if(!p()){const f=()=>{p()};typeof queueMicrotask=="function"?queueMicrotask(f):typeof setTimeout=="function"&&setTimeout(f,0)}const g=a[Qr]||{},h=f=>{if(typeof _c=="function")try{return _c(f)}catch(w){console.warn("normalizeTemperatureUnit helper threw an error; falling back to safe normalization",w)}if(typeof f=="string"){const w=f.trim().toLowerCase();if(w===oo?.fahrenheit||w==="fahrenheit"||w==="f")return oo?.fahrenheit||"fahrenheit";if(w===oo?.celsius||w==="celsius"||w==="c")return oo?.celsius||"celsius"}return oo?.celsius||"celsius"},A=f=>{if(typeof f=="string"){const w=f.trim().toLowerCase();if(w==="imperial"||w==="feet"||w==="ft")return"imperial";if(w==="metric"||w==="metre"||w==="meter"||w==="m")return"metric"}return"metric"};(()=>{if(typeof normalizeFocusScale=="function")return normalizeFocusScale;const f=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;if(f&&typeof f.normalizeFocusScale=="function")return f.normalizeFocusScale;if(f)try{Object.defineProperty(f,"normalizeFocusScale",{value:A,writable:!0,configurable:!0})}catch{f.normalizeFocusScale=A}return A})();const y=f=>{if(typeof normalizeFocusScale=="function")try{const w=normalizeFocusScale(f);if(w==="imperial"||w==="metric")return w}catch(w){console.warn("normalizeFocusScale helper threw an error; falling back to safe normalization",w)}return A(f)},S=()=>{const f=le=>typeof le=="string"&&le?y(le):null,w=[()=>typeof focusScalePreference<"u"?focusScalePreference:null,()=>typeof sessionFocusScale<"u"?sessionFocusScale:null,()=>{try{const le=d&&d.preferences&&typeof d.preferences.getFocusScale=="function"?d.preferences.getFocusScale:null;if(le)return le()}catch(le){console.warn("Failed to resolve focus scale preference from runtime scope; using fallback",le)}return null}];for(const le of w){const Pe=f(le());if(Pe)return Pe}return"metric"},E=f=>{if(!f)return"";const w=c[e],le=w&&typeof w[f]=="string"?w[f]:null;return le&&le.trim()?le:typeof g[f]=="string"?g[f]:""},I=(f,w,le="")=>{if(!f)return;const Pe=E(w)||le;f.textContent=Pe},L=(f,w,{target:le,highlight:Pe,isButton:st=!0}={})=>{if(!l)return null;const At=l.createElement("a");return At.className=st?"help-link button-link":"help-link",At.href=f,le&&At.setAttribute("data-help-target",le),Pe&&At.setAttribute("data-help-highlight",Pe),At.textContent=w,At},R=(f,w,le=[])=>{if(!f||!l)return;const Pe=E(w);if(f.innerHTML="",!Pe){f.setAttribute("hidden","");return}f.removeAttribute("hidden");const st=l.createDocumentFragment(),At=/%(?:(\d+)\$)?s/g;let qt=0,Xt=0,Ne;for(;(Ne=At.exec(Pe))!==null;){const uo=Ne.index;uo>qt&&st.appendChild(l.createTextNode(Pe.slice(qt,uo)));const Kr=typeof Ne[1]=="string"?Math.max(parseInt(Ne[1],10)-1,0):Xt++,Ye=le[Kr];if(typeof Ye=="function"){const mt=Ye();mt&&st.appendChild(mt)}qt=At.lastIndex}qt<Pe.length&&st.appendChild(l.createTextNode(Pe.slice(qt))),f.appendChild(st)},G=(f,w)=>{if(!f)return;const le=E(w);f.textContent=le,le?f.removeAttribute("hidden"):f.setAttribute("hidden","")},j=f=>{if(f){if(d&&typeof d=="object")try{if(f in d)return d[f]}catch{}if(typeof globalThis<"u"&&globalThis!==d)try{if(f in globalThis)return globalThis[f]}catch{}}},$=(f,w)=>{if(!f||!w)return w;try{St(f,w)}catch{}return w},z=(f,w)=>{let le=null;try{le=j(f)}catch(Pe){console.warn(`Failed to resolve runtime value for "${f}"`,Pe),le=null}if(le&&typeof le=="object")return le;if(l&&typeof l.getElementById=="function"&&w)try{const Pe=l.getElementById(w);return $(f,Pe)}catch(Pe){return console.warn(`Failed to resolve document element "${w}"`,Pe),null}return null},te=z("settingsShowAutoBackups","settingsShowAutoBackups"),oe=z("backupSettings","backupSettings"),k=z("backupDiffToggleButton","backupDiffToggleButton"),Z=z("backupDiffHeading","backupDiffHeading"),ue=z("backupDiffIntro","backupDiffIntro"),H=z("backupDiffPrimaryLabel","backupDiffPrimaryLabel"),Y=z("backupDiffPrimarySelect","backupDiffPrimary"),N=z("backupDiffSecondaryLabel","backupDiffSecondaryLabel"),ae=z("backupDiffSecondarySelect","backupDiffSecondary"),de=z("backupDiffEmptyState","backupDiffEmptyState"),Q=z("backupDiffNotesLabel","backupDiffNotesLabel"),ne=z("backupDiffNotes","backupDiffNotes"),V=z("backupDiffExportButton","backupDiffExport"),fe=z("backupDiffCloseButton","backupDiffClose"),J=z("restoreRehearsalButton","restoreRehearsalButton"),Ae=z("restoreRehearsalHeading","restoreRehearsalHeading"),Le=z("restoreRehearsalIntro","restoreRehearsalIntro"),_e=z("restoreRehearsalModeLabel","restoreRehearsalModeLabel"),Je=z("restoreRehearsalModeBackupText","restoreRehearsalModeBackupText"),xe=z("restoreRehearsalModeProjectText","restoreRehearsalModeProjectText"),Ze=z("restoreRehearsalFileLabel","restoreRehearsalFileLabel"),Ve=z("restoreRehearsalBrowse","restoreRehearsalBrowse"),Dt=z("restoreRehearsalFileName","restoreRehearsalFileName"),We=z("restoreRehearsalStatus","restoreRehearsalStatus"),ft=z("restoreRehearsalRuleHeading","restoreRehearsalRuleHeading"),D=z("restoreRehearsalRuleIntro","restoreRehearsalRuleIntro"),q=z("restoreRehearsalRuleEmpty","restoreRehearsalRuleEmpty"),we=z("restoreRehearsalTableCaption","restoreRehearsalTableCaption"),ve=z("restoreRehearsalMetricHeader","restoreRehearsalMetricHeader"),Se=z("restoreRehearsalLiveHeader","restoreRehearsalLiveHeader"),he=z("restoreRehearsalSandboxHeader","restoreRehearsalSandboxHeader"),ge=z("restoreRehearsalDifferenceHeader","restoreRehearsalDifferenceHeader"),pe=z("restoreRehearsalCloseButton","restoreRehearsalClose"),ze=z("restoreRehearsalProceedButton","restoreRehearsalProceed"),ke=z("restoreRehearsalAbortButton","restoreRehearsalAbort");hI&&(hI.textContent=c[e].skipToContent);const nt=document.getElementById("offlineIndicator");if(nt){const f=c[e].offlineIndicator,w=c[e].reloadAppOfflineNotice||f,le=c[e].offlineIndicatorHelp||w,Pe=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?navigator.onLine===!1:!1;nt.dataset&&(nt.dataset.baseLabel=f,nt.dataset.baseHelp=le,nt.dataset.forceReloadNotice=w,nt.dataset.degradedLabel=c[e].offlineIndicatorDegraded||w,nt.dataset.degradedHelp=c[e].offlineIndicatorDegradedHelp||le,nt.dataset.reasonCacheFallback=c[e].offlineIndicatorReasonCacheFallback||w,nt.dataset.reasonGetFailed=c[e].offlineIndicatorReasonGetFailed||w,nt.dataset.reasonTimeout=c[e].offlineIndicatorReasonTimeout||w,nt.dataset.reasonUnreachable=c[e].offlineIndicatorReasonUnreachable||w,nt.dataset.reasonReloadBlocked=c[e].offlineIndicatorReasonReloadBlocked||w,nt.dataset.reasonUnknown=c[e].offlineIndicatorReasonUnknown||le),Pe?(nt.textContent=w,nt.setAttribute("data-help",w),nt.removeAttribute("hidden")):(nt.textContent=f,nt.setAttribute("data-help",le))}vA(e);const Ct=wR[e]||wR.en,Ot=document.getElementById("impressumLink");Ot&&(Ot.textContent=c[e].impressum,Ct?.imprint&&Ot.setAttribute("href",Ct.imprint));const xt=document.getElementById("privacyLink");xt&&(xt.textContent=c[e].privacy,Ct?.privacy&&xt.setAttribute("href",Ct.privacy));const or=document.getElementById("setupManageHeading");or&&(or.textContent=c[e].setupManageHeading,or.setAttribute("data-help",c[e].setupManageHeadingHelp));const er=document.getElementById("deviceSelectionHeading");er&&(er.textContent=c[e].deviceSelectionHeading,er.setAttribute("data-help",c[e].deviceSelectionHeadingHelp));const wr=document.getElementById("resultsHeading");wr&&(wr.textContent=c[e].resultsHeading,wr.setAttribute("data-help",c[e].resultsHeadingHelp));const Pt=document.getElementById("deviceManagerHeading");Pt&&(Pt.textContent=c[e].deviceManagerHeading,Pt.setAttribute("data-help",c[e].deviceManagerHeadingHelp));const Pr=document.getElementById("batteryComparisonHeading"),Wt=document.getElementById("batteryComparisonDescription"),_t=document.getElementById("batteryTable"),_r=document.getElementById("setupDiagramHeading");_r&&(_r.textContent=c[e].setupDiagramHeading,_r.setAttribute("data-help",c[e].setupDiagramHeadingHelp)),document.querySelectorAll("#sideMenu [data-nav-key]").forEach(f=>{if(!f||!f.dataset)return;const w=f.dataset.navKey;if(!w)return;const le=c[e][w];le&&(w==="contactsNav"&&typeof je=="function"&&f?.tagName==="BUTTON"?je(f,le,typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.contacts?ICON_GLYPHS.contacts:Ir("\\uF404",ICON_FONT_KEYS.UICONS)):f.textContent=le,f.setAttribute("aria-label",le));const Pe=`${w}Help`,st=c[e][Pe];if(st)f.setAttribute("title",st),f.setAttribute("data-help",st);else{if(w==="projectRequirementsNav"){const At=`${w}Help`;c[e]&&!c[e][At]&&console.warn(`[Cine Power Planner] Missing help text for ${w} in lang ${e} `)}f.removeAttribute("title"),f.removeAttribute("data-help")}}),P1(e);const ct=document.getElementById("savedSetupsLabel");ct&&(ct.textContent=c[e].savedSetupsLabel,ct.setAttribute("data-help",c[e].setupSelectHelp));const Gt=document.getElementById("setupNameLabel");Gt&&(Gt.textContent=c[e].setupNameLabel,Gt.setAttribute("data-help",c[e].setupNameHelp)),typeof Ip<"u"&&Ip&&je(Ip,c[e].deleteSetupBtn,ICON_GLYPHS.trash);const kt=document.getElementById("sharedLinkLabel");kt&&(kt.textContent=c[e].sharedLinkLabel,kt.setAttribute("data-help",c[e].sharedLinkHelp)),typeof wl<"u"&&wl&&je(wl,c[e].loadSharedLinkBtn,ICON_GLYPHS.fileImport);const O=typeof za<"u"?za:document.getElementById("setupSelect");O&&O.setAttribute("data-help",c[e].setupSelectHelp);const U=typeof zi<"u"?zi:document.getElementById("setupNameInput");U&&U.setAttribute("data-help",c[e].setupNameHelp);const F=Ip;F&&typeof F.setAttribute=="function"&&(F.setAttribute("title",c[e].deleteSetupHelp),F.setAttribute("aria-label",c[e].deleteSetupHelp),F.setAttribute("data-help",c[e].deleteSetupHelp));const W=lV;W&&(W.setAttribute("title",c[e].saveSetupHelp),W.setAttribute("aria-label",c[e].saveSetupHelp),W.setAttribute("data-help",c[e].saveSetupHelp));const se=generateOverviewBtn;se&&(se.setAttribute("title",c[e].generateOverviewBtn),se.setAttribute("data-help",c[e].generateOverviewHelp));const me=generateGearListBtn;me&&(me.setAttribute("title",c[e].generateGearListBtn),me.setAttribute("data-help",c[e].generateGearListHelp));try{const f=c[e].deleteGearListBtnHelp||c[e].deleteGearListBtn,w=deleteGearListProjectBtn;w&&typeof w.setAttribute=="function"&&(je(w,c[e].deleteGearListBtn,ICON_GLYPHS.trash),w.setAttribute("title",f),w.setAttribute("data-help",f),w.setAttribute("aria-label",f))}catch(f){console.warn("Error setting deleteGearListProjectBtn attributes",f)}const Re=document.getElementById("editProjectBtn");Re&&typeof Re.setAttribute=="function"&&(Re.textContent=c[e].editProjectBtn,Re.setAttribute("title",c[e].editProjectBtn),Re.setAttribute("data-help",c[e].editProjectBtn));const De=document.getElementById("addExtraGearBtn");if(De&&typeof De.setAttribute=="function"){const f=c[e].addExtraGearBtn||c.en?.addExtraGearBtn||"Add temporary extra gear";De.textContent=f,De.setAttribute("title",f),De.setAttribute("data-help",f)}if(xh&&(xh.setAttribute("title",c[e].shareSetupBtn),xh.setAttribute("data-help",c[e].shareSetupHelp)),Mh){const f=c[e].shareDialogTitle||c.en?.shareDialogTitle||Mh.textContent;Mh.textContent=f}if(Dh){const f=c[e].shareFilenameLabel||c.en?.shareFilenameLabel||Dh.textContent;Dh.textContent=f}if(vl){const f=c[e].shareDialogConfirm||c.en?.shareDialogConfirm||vl.textContent;je(vl,f,ICON_GLYPHS.fileExport),vl.setAttribute("title",f),vl.setAttribute("aria-label",f),vl.setAttribute("data-help",c[e].shareSetupHelp)}if(uu){const f=c[e].shareDialogCancel||c.en?.shareDialogCancel||uu.textContent;je(uu,f,ICON_GLYPHS.circleX),uu.setAttribute("title",f),uu.setAttribute("aria-label",f)}if(_h){const f=c[e].shareIncludeAutoGearLabel||c.en?.shareIncludeAutoGearLabel||_h.textContent;_h.textContent=f;const w=c[e].shareIncludeAutoGearHelp||c.en?.shareIncludeAutoGearHelp||f;Fh&&typeof Fh.setAttribute=="function"&&Fh.setAttribute("data-help",w),cI&&cI.setAttribute("aria-label",f)}if(Nh){const f=c[e].shareIncludeOwnedGearLabel||c.en?.shareIncludeOwnedGearLabel||Nh.textContent;Nh.textContent=f;const w=c[e].shareIncludeOwnedGearHelp||c.en?.shareIncludeOwnedGearHelp||f;Hh&&typeof Hh.setAttribute=="function"&&Hh.setAttribute("data-help",w),uI&&uI.setAttribute("aria-label",f)}let ot=fu?fu.textContent:"";if(jh){const f=c[e].sharedImportDialogTitle||c.en?.sharedImportDialogTitle||jh.textContent;jh.textContent=f}if(Op){const f=c[e].sharedImportDialogMessage||c.en?.sharedImportDialogMessage||Op.textContent;Op.textContent=f,Op.setAttribute("data-help",f)}if(Gp){const f=c[e].sharedImportDialogConfirm||c.en?.sharedImportDialogConfirm||Gp.textContent;je(Gp,f,ICON_GLYPHS.check),Gp.setAttribute("data-help",f)}if(kp){const f=c[e].sharedImportDialogCancel||c.en?.sharedImportDialogCancel||kp.textContent;je(kp,f,ICON_GLYPHS.circleX),kp.setAttribute("data-help",f)}if(fu){const f=c[e].sharedImportAutoGearLabel||c.en?.sharedImportAutoGearLabel||fu.textContent;fu.textContent=f,ot=f,fI&&fI.setAttribute("data-help",f)}if(Ks&&ot&&(Ks.setAttribute("aria-label",ot),Ks.setAttribute("data-help",ot)),Al){const f=c[e].sharedImportAutoGearNone||c.en?.sharedImportAutoGearNone||Al.textContent;Al.textContent=f;const w=c[e].sharedImportAutoGearNoneHelp||c.en?.sharedImportAutoGearNoneHelp||f;Al.setAttribute("data-help",w),Al.setAttribute("title",w),Al.setAttribute("aria-label",f)}if(El){const f=c[e].sharedImportAutoGearProject||c.en?.sharedImportAutoGearProject||El.textContent;El.textContent=f;const w=c[e].sharedImportAutoGearProjectHelp||c.en?.sharedImportAutoGearProjectHelp||f;El.setAttribute("data-help",w),El.setAttribute("title",w),El.setAttribute("aria-label",f)}if(Cl){const f=c[e].sharedImportAutoGearGlobal||c.en?.sharedImportAutoGearGlobal||Cl.textContent;Cl.textContent=f;const w=c[e].sharedImportAutoGearGlobalHelp||c.en?.sharedImportAutoGearGlobalHelp||f;Cl.setAttribute("data-help",w),Cl.setAttribute("title",w),Cl.setAttribute("aria-label",f)}wl&&(wl.setAttribute("title",c[e].loadSharedLinkBtn),wl.setAttribute("data-help",c[e].applySharedLinkHelp)),runtimeFeedbackBtn&&(runtimeFeedbackBtn.setAttribute("title",c[e].runtimeFeedbackBtn),runtimeFeedbackBtn.setAttribute("data-help",c[e].runtimeFeedbackBtnHelp),je(runtimeFeedbackBtn,c[e].runtimeFeedbackBtn,ICON_GLYPHS.feedback)),za&&za.options&&za.options.length>0&&(za.options[0].textContent=c[e].newSetupOption),checkSetupChanged();const at=document.getElementById("cameraLabel");at&&(at.textContent=c[e].cameraLabel,at.setAttribute("data-help",c[e].cameraSelectHelp));const vt=document.getElementById("monitorLabel");vt&&(vt.textContent=c[e].monitorLabel,vt.setAttribute("data-help",c[e].monitorSelectHelp));const wt=document.getElementById("videoLabel");wt&&(wt.textContent=c[e].videoLabel,wt.setAttribute("data-help",c[e].videoSelectHelp));const Qt=document.getElementById("cageLabel");Qt&&(Qt.textContent=c[e].cageLabel,Qt.setAttribute("data-help",c[e].cageSelectHelp));const yr=document.getElementById("distanceLabel");yr&&(yr.textContent=c[e].distanceLabel,yr.setAttribute("data-help",c[e].distanceSelectHelp));const tr=document.getElementById("batteryPlateLabel");tr&&(tr.textContent=c[e].batteryPlateLabel,tr.setAttribute("data-help",c[e].batteryPlateSelectHelp));const rr=document.getElementById("batteryHotswapLabel");rr&&(rr.textContent=c[e].batteryHotswapLabel,rr.setAttribute("data-help",c[e].batteryHotswapSelectHelp)),q1();const bn=document.getElementById("fizLegend");bn&&(bn.textContent=c[e].fizLegend,bn.setAttribute("data-help",c[e].fizLegendHelp));const io=document.getElementById("fizMotorsLabel");io&&(io.textContent=c[e].fizMotorsLabel,io.setAttribute("data-help",c[e].fizMotorsHelp));const $o=document.getElementById("fizControllersLabel");$o&&($o.textContent=c[e].fizControllersLabel,$o.setAttribute("data-help",c[e].fizControllersHelp)),document.querySelectorAll("#motorNotesLabel,#controllerNotesLabel,#distanceNotesLabel").forEach(f=>{f.textContent=c[e].notesLabel});var hn=typeof cineResults=="object"?cineResults:null,Sn=!1;if(hn&&typeof hn.localizeResultsSection=="function")try{Sn=hn.localizeResultsSection({lang:e,langTexts:c[e]||{},fallbackTexts:c.en||{},document,breakdownListElem:typeof breakdownListElem<"u"&&breakdownListElem?breakdownListElem:null,elements:{totalPowerLabel:document.getElementById("totalPowerLabel"),batteryCountLabel:document.getElementById("batteryCountLabel"),pinWarning:typeof Ap<"u"?Ap:null,dtapWarning:typeof Ep<"u"?Ep:null,hotswapWarning:typeof Cp<"u"?Cp:null,powerWarningTitle:typeof wp<"u"?wp:null,powerWarningLimitsHeading:typeof Lp<"u"?Lp:null,powerWarningAdvice:typeof Rp<"u"?Rp:null,powerWarningCloseBtn:typeof Kl<"u"?Kl:null,batteryLifeUnit:document.getElementById("batteryLifeUnit"),batteryLifeLabel:typeof lu<"u"?lu:document.getElementById("batteryLifeLabel"),runtimeAverageNote:typeof vp<"u"?vp:document.getElementById("runtimeAverageNote"),tempNote:document.getElementById("temperatureNote")},refreshTotalCurrentLabels:typeof refreshTotalCurrentLabels=="function"?refreshTotalCurrentLabels:null,updateMountVoltageSettingLabels:typeof updateMountVoltageSettingLabels=="function"?updateMountVoltageSettingLabels:null,getCurrentSetupKey:typeof getCurrentSetupKey=="function"?getCurrentSetupKey:null,renderFeedbackTable:typeof sh=="function"?sh:null,dispatchTemperatureNoteRender:typeof dh=="function"?dh:null,refreshFeedbackTemperatureLabel:typeof Vu=="function"?Vu:null,updateFeedbackTemperatureOptions:typeof Dm=="function"?Dm:null,lastRuntimeHours:typeof Th<"u"?Th:null,temperatureUnit:typeof temperatureUnit<"u"?temperatureUnit:null,setButtonLabelWithIcon:typeof je=="function"?je:null,iconGlyphs:typeof ICON_GLYPHS<"u"?ICON_GLYPHS:null})}catch(f){console.warn("cineResults.localizeResultsSection failed",f),Sn=!1}var ei=!1;if(hn&&typeof hn.localizeBatteryComparisonSection=="function")try{ei=hn.localizeBatteryComparisonSection({lang:e,langTexts:c[e]||{},fallbackTexts:c.en||{},document,batteryComparisonHeading:Pr,batteryComparisonDescription:Wt,batteryComparisonTable:_t})}catch(f){console.warn("cineResults.localizeBatteryComparisonSection failed",f),ei=!1}if(ei||(Pr&&(Pr.textContent=c[e].batteryComparisonHeading,Pr.setAttribute("data-help",c[e].batteryComparisonHeadingHelp)),Wt&&(Wt.textContent=c[e].batteryComparisonDescription,c[e].batteryComparisonDescriptionHelp?Wt.setAttribute("data-help",c[e].batteryComparisonDescriptionHelp):Wt.removeAttribute("data-help")),_t&&(c[e].batteryComparisonTableHelp?_t.setAttribute("data-help",c[e].batteryComparisonTableHelp):_t.removeAttribute("data-help"))),!Sn){const f=document.getElementById("resultsPlainSummary");f&&f.setAttribute("data-help",c[e].resultsPlainSummaryHelp);const w=document.getElementById("resultsPlainSummaryTitle");w&&(w.textContent=c[e].resultsPlainSummaryTitle);const le=document.getElementById("resultsPlainSummaryText");le&&(le.textContent=c[e].resultsPlainSummaryPrompt);const Pe=document.getElementById("resultsPlainSummaryNote");Pe&&(Pe.textContent=c[e].resultsPlainSummaryNote);const st=typeof breakdownListElem<"u"&&breakdownListElem?breakdownListElem:document.getElementById("breakdownList");st&&st.setAttribute("data-help",c[e].breakdownListHelp);const At=document.getElementById("totalPowerLabel");At&&c[e]&&(At.textContent=c[e].totalPowerLabel,At.setAttribute("data-help",c[e].totalPowerHelp)),typeof refreshTotalCurrentLabels=="function"&&refreshTotalCurrentLabels(e),updateMountVoltageSettingLabels(e);const qt=document.getElementById("batteryCountLabel");qt&&(qt.textContent=c[e].batteryCountLabel,qt.setAttribute("data-help",c[e].batteryCountHelp)),Ap&&Ap.setAttribute("data-help",c[e].pinWarningHelp),Ep&&Ep.setAttribute("data-help",c[e].dtapWarningHelp),Cp&&Cp.setAttribute("data-help",c[e].hotswapWarningHelp),wp&&(wp.textContent=c[e].powerWarningTitle),Lp&&(Lp.textContent=c[e].powerWarningLimitsHeading),Rp&&(Rp.textContent=c[e].powerWarningAdvice),Kl&&je(Kl,c[e].powerWarningClose,ICON_GLYPHS.check);const Xt=document.getElementById("batteryLifeUnit");Xt&&(Xt.textContent=c[e].batteryLifeUnit);const Ne=sh(getCurrentSetupKey());if(lu){let Kr=c[e].batteryLifeLabel;if(Ne){const Ye=c[e].runtimeUserCountNote.replace("{count}",Ne.count),mt=Kr.indexOf(")");mt!==-1&&(Kr=`${Kr.slice(0,mt)}, ${Ye}${Kr.slice(mt)} `)}lu.textContent=Kr,lu.setAttribute("data-help",c[e].batteryLifeHelp)}vp&&(vp.textContent=Ne&&Ne.count>4?c[e].runtimeAverageNote:""),dh(Th),typeof Vu=="function"&&Vu(e,temperatureUnit),Dm(e,temperatureUnit);const uo=document.getElementById("temperatureNote");uo&&uo.setAttribute("data-help",c[e].temperatureNoteHelp)}const Xe=(f,w)=>{const le=document.getElementById(f);return le&&w!==void 0&&(le.textContent=w),le},ti=(f,w,le)=>{const Pe=document.getElementById(f);return Pe&&w&&le!==void 0&&Pe.setAttribute(w,le),Pe};if(Xe("addDeviceHeading",c[e].addDeviceHeading),Xe("categoryLabel",c[e].categoryLabel),Xe("subcategoryLabel",c[e].subcategoryLabel),Xe("deviceNameLabel",c[e].deviceNameLabel),Xe("consumptionLabel",c[e].consumptionLabel),Xe("capacityLabel",c[e].capacityLabel),Xe("pinLabel",c[e].pinLabel),Xe("dtapLabel",c[e].dtapLabel),Xe("cameraWattLabel",c[e].cameraWattLabel),Xe("cameraVoltageLabel",c[e].cameraVoltageLabel),Xe("cameraPortTypeLabel",c[e].cameraPortTypeLabel),Xe("cameraPlatesLabel",c[e].cameraPlatesLabel),Xe("cameraMediaLabel",c[e].cameraMediaLabel),Xe("cameraLensMountLabel",c[e].cameraLensMountLabel),Xe("cameraPowerDistLabel",c[e].powerDistributionLabel),Xe("cameraVideoOutputsLabel",c[e].videoOutputsLabel),Xe("cameraFIZConnectorLabel",c[e].fizConnectorLabel),Xe("cameraViewfinderLabel",c[e].viewfinderLabel),Xe("cameraTimecodeLabel",c[e].timecodeLabel),Xe("powerInputsHeading",c[e].powerInputsHeading),Xe("powerDistributionHeading",c[e].powerDistributionHeading),Xe("videoOutputsHeading",c[e].videoOutputsHeading),Xe("fizConnectorHeading",c[e].fizConnectorHeading),Xe("mediaHeading",c[e].mediaHeading),Xe("viewfinderHeading",c[e].viewfinderHeading),Xe("lensMountHeading",c[e].lensMountHeading),Xe("lensDeviceMountHeading",c[e].lensDeviceMountHeading),Xe("lensDeviceMountLabel",c[e].lensDeviceMountLabel)&&ti("lensDeviceMountLabel","data-help",c[e].lensDeviceMountHelp),Xe("lensFocusScaleUnitLabel",c[e].lensFocusScaleLabel||c[e].focusScaleSetting)){const f=c[e].lensFocusScaleLabel||c[e].focusScaleSetting,w=c[e].lensFocusScaleHelp||c[e].lensFocusScaleLabel||c[e].focusScaleSettingHelp||f;ti("lensFocusScaleUnitLabel","data-help",w),Ui&&(Ui.setAttribute("data-help",w),Ui.setAttribute("aria-label",f))}TV(e),Xe("timecodeHeading",c[e].timecodeHeading),Xe("monitorScreenSizeLabel",c[e].monitorScreenSizeLabel),Xe("monitorBrightnessLabel",c[e].monitorBrightnessLabel),Xe("monitorWattLabel",c[e].monitorWattLabel),Xe("monitorVoltageLabel",c[e].monitorVoltageLabel),Xe("monitorPortTypeLabel",c[e].monitorPortTypeLabel),Xe("monitorVideoInputsHeading",c[e].monitorVideoInputsHeading),Xe("monitorVideoOutputsHeading",c[e].monitorVideoOutputsHeading),Xe("monitorVideoInputsLabel",c[e].monitorVideoInputsLabel),Xe("monitorVideoOutputsLabel",c[e].monitorVideoOutputsLabel),Xe("monitorWirelessTxLabel",c[e].monitorWirelessTxLabel);const kr=Xe("monitorLatencyLabel",c[e].monitorLatencyLabel);if(kr){const f=c[e].monitorLatencyHelp;f?(kr.setAttribute("data-help",f),kr.setAttribute("title",f),Ll&&(Ll.setAttribute("data-help",f),Ll.setAttribute("title",f))):(kr.removeAttribute("data-help"),kr.removeAttribute("title"),Ll&&(Ll.removeAttribute("data-help"),Ll.removeAttribute("title")))}Xe("monitorAudioOutputLabel",c[e].monitorAudioOutputLabel),Xe("viewfinderDetailsHeading",c[e].viewfinderDetailsHeading),Xe("viewfinderScreenSizeLabel",c[e].viewfinderScreenSizeLabel),Xe("viewfinderBrightnessLabel",c[e].viewfinderBrightnessLabel),Xe("viewfinderWattLabel",c[e].viewfinderWattLabel),Xe("viewfinderVoltageLabel",c[e].viewfinderVoltageLabel),Xe("viewfinderPortTypeLabel",c[e].viewfinderPortTypeLabel),Xe("viewfinderVideoInputsHeading",c[e].viewfinderVideoInputsHeading),Xe("viewfinderVideoOutputsHeading",c[e].viewfinderVideoOutputsHeading),Xe("viewfinderVideoInputsLabel",c[e].viewfinderVideoInputsLabel),Xe("viewfinderVideoOutputsLabel",c[e].viewfinderVideoOutputsLabel),Xe("viewfinderWirelessTxLabel",c[e].viewfinderWirelessTxLabel);const wo=Xe("viewfinderLatencyLabel",c[e].viewfinderLatencyLabel);if(wo){wo.textContent=c[e].viewfinderLatencyLabel;const f=c[e].viewfinderLatencyHelp;f?(wo.setAttribute("data-help",f),wo.setAttribute("title",f),Rl&&(Rl.setAttribute("data-help",f),Rl.setAttribute("title",f))):(wo.removeAttribute("data-help"),wo.removeAttribute("title"),Rl&&(Rl.removeAttribute("data-help"),Rl.removeAttribute("title")))}Xe("videoPowerInputsHeading",c[e].videoPowerInputsHeading||c[e].powerInputsHeading||"Power Inputs");const so=document.getElementById("videoPowerInputLabel");if(so){so.textContent=c[e].videoPowerInputLabel||c[e].powerInputsHeading;const f=c[e].videoPowerInputHelp||"";f?(so.setAttribute("data-help",f),so.setAttribute("title",f)):(so.removeAttribute("data-help"),so.removeAttribute("title"))}Xe("videoVideoInputsHeading",c[e].videoVideoInputsHeading),Xe("videoVideoInputsLabel",c[e].videoVideoInputsLabel),Xe("videoVideoOutputsHeading",c[e].videoVideoOutputsHeading),Xe("videoVideoOutputsLabel",c[e].videoVideoOutputsLabel),Xe("monitorDetailsHeading",c[e].monitorDetailsHeading),Xe("monitorPowerHeading",c[e].monitorPowerHeading);const Ga=c[e]&&c[e].addDeviceBtn||"Add",Po=c[e]&&c[e].updateDeviceBtn||"Update",Lr=document.getElementById("addDeviceBtn");Lr&&(Lr.dataset&&Lr.dataset.mode==="edit"?(je(Lr,Po,ICON_GLYPHS.save),Lr.setAttribute("data-help",c[e]&&c[e].updateDeviceBtnHelp||"")):(je(Lr,Ga,ICON_GLYPHS.add),Lr.setAttribute("data-help",c[e]&&c[e].addDeviceBtnHelp||"")));const xo=document.getElementById("cancelEditBtn");xo&&(je(xo,c[e].cancelEditBtn,ICON_GLYPHS.circleX),xo.setAttribute("data-help",c[e].cancelEditBtnHelp));const ln=document.getElementById("exportDataBtn");ln&&(je(ln,c[e].exportDataBtn,ICON_GLYPHS.fileExport),ln.setAttribute("data-help",c[e].exportDataHelp));const Pn=document.getElementById("importDataBtn");Pn&&(je(Pn,c[e].importDataBtn,ICON_GLYPHS.fileImport),Pn.setAttribute("data-help",c[e].importDataHelp)),typeof zi<"u"&&zi&&(zi.placeholder=(c[e].setupNameLabel||"").replace(":","")),typeof Vh<"u"&&Vh&&(Vh.placeholder=c[e].placeholder_deviceName),typeof Wh<"u"&&Wh&&(Wh.placeholder=c[e].placeholder_watt),typeof Qh<"u"&&Qh&&(Qh.placeholder=c[e].placeholder_capacity),typeof Xh<"u"&&Xh&&(Xh.placeholder=c[e].placeholder_pin),typeof cd<"u"&&cd&&(cd.placeholder=c[e].placeholder_dtap),typeof Kh<"u"&&Kh&&(Kh.placeholder=c[e].placeholder_voltage),typeof Yh<"u"&&Yh&&(Yh.placeholder=c[e].placeholder_voltage),AP(e);const Mo=document.getElementById("toggleDeviceManager"),Jn=document.getElementById("device-manager");Jn&&Mo&&(Jn.classList.contains("hidden")?(je(Mo,c[e].toggleDeviceManager,ICON_GLYPHS.gears),Mo.setAttribute("title",c[e].toggleDeviceManager),Mo.setAttribute("data-help",c[e].toggleDeviceManagerHelp),Mo.setAttribute("aria-expanded","false")):(je(Mo,c[e].hideDeviceManager,ICON_GLYPHS.minus),Mo.setAttribute("title",c[e].hideDeviceManager),Mo.setAttribute("data-help",c[e].hideDeviceManagerHelp),Mo.setAttribute("aria-expanded","true")));const ea=document.getElementById("newCategory");ea&&ea.options&&Array.from(ea.options).forEach(f=>{f.textContent=ld(f.value,e)});const xn={de:"Keine Auswahl",es:"Ninguno",fr:"Aucun"};document.querySelectorAll('select option[value="None"]').forEach(f=>{f.textContent=xn[e]||"None"});try{localStorage.setItem("language",e)}catch(f){console.warn("Could not save language to localStorage",f)}typeof refreshDeviceLists=="function"?refreshDeviceLists():typeof window<"u"&&typeof window.refreshDeviceLists=="function"&&window.refreshDeviceLists(),yV(),t?.skipUpdateCalculations||updateCalculations();const vn=typeof document<"u"?document.getElementById("existingDevicesHeading"):null;vn&&(vn.textContent=c[e].existingDevicesHeading);const ta=document.getElementById("themeVariantSelect"),ka=document.querySelector('label[for="themeVariantSelect"]');if(ka&&(ka.textContent=c[e].themeVariantLabel||"Theme"),ta){const f=c[e].themeVariantLabel||"Theme";ta.setAttribute("title",c[e].themeVariantHelp||f),ta.setAttribute("aria-label",f),ta.setAttribute("data-help",c[e].themeVariantHelp||f);const w={light:c[e].themeVariantLight,dark:c[e].themeVariantDark,"pink-light":c[e].themeVariantPinkLight,"pink-dark":c[e].themeVariantPinkDark};ta.querySelectorAll("option[data-theme-option]").forEach(le=>{const Pe=le.dataset.themeOption,st=w[Pe];st&&(le.textContent=st)})}Pp&&(Pp.setAttribute("title",c[e].darkModeLabel),Pp.setAttribute("aria-label",c[e].darkModeLabel),Pp.setAttribute("data-help",c[e].darkModeHelp||c[e].darkModeLabel)),Bp&&(Bp.setAttribute("title",c[e].pinkModeLabel),Bp.setAttribute("aria-label",c[e].pinkModeLabel),Bp.setAttribute("data-help",c[e].pinkModeHelp||c[e].pinkModeLabel)),Fs&&(Fs.setAttribute("title",c[e].settingsButton),Fs.setAttribute("aria-label",c[e].settingsButton),Fs.setAttribute("data-help",c[e].settingsButtonHelp||c[e].settingsButton));const Ti=document.getElementById("settingsTitle");Ti&&(Ti.textContent=c[e].settingsHeading,Ti.setAttribute("data-help",c[e].settingsHeadingHelp||c[e].settingsHeading));const Ba=document.getElementById("settingsTablist");if(Ba){const f=c[e].settingsSectionsLabel||c.en?.settingsSectionsLabel||Ba.getAttribute("aria-label")||c[e].settingsHeading||"Settings sections";Ba.setAttribute("aria-label",f)}const ra=f=>{if(!f||typeof f!="object")return"";const w=f.querySelector?.(".settings-tab-label");if(w&&typeof w.textContent=="string"){const le=w.textContent.trim();if(le)return le}return typeof f.textContent=="string"?f.textContent.trim():""},qo=f=>{if(typeof f!="string")return"";const w=f.trim();if(!w)return"";const le=w.match(/^[^.!?。！？]*[.!?。！？]/u);if(le&&le[0]){const qt=le[0].trim();if(qt.length>=24||w.length<=90)return qt}if(w.length<=90)return w;const Pe=w.slice(0,90);let st=Pe.length;for(;st>0&&Pe[st-1]&&Pe[st-1].trim()!=="";)st-=1;return`${(st>0?Pe.slice(0,st).trimEnd():"")||Pe.trim()}…`},Me=(f,w,le)=>{if(!f)return;const Pe=(w||ra(f)||"").trim(),st=f.querySelector?.(".settings-tab-label");st?st.textContent=Pe:f.textContent=Pe,Pe?f.setAttribute("aria-label",Pe):f.removeAttribute("aria-label");const At=(le||Pe||"").trim();At?(f.setAttribute("data-help",At),f.setAttribute("title",At)):(f.removeAttribute("data-help"),f.removeAttribute("title"));const qt=qo(At);qt?f.setAttribute("data-summary",qt):f.removeAttribute("data-summary");const Xt=f.querySelector?.(".settings-tab-caption");if(Xt){const Ne=qt||Pe;Xt.textContent=Ne,Ne?Xt.removeAttribute("hidden"):Xt.setAttribute("hidden","")}};if(_m){const f=c[e].settingsTabGeneral||c.en?.settingsTabGeneral||ra(_m)||"General",w=c[e].settingsTabGeneralHelp||c.en?.settingsTabGeneralHelp||c[e].settingsHeadingHelp||f;if(Me(_m,f,w),aS&&(aS.textContent=f,aS.setAttribute("data-help",w)),iS){const le=c[e].generalSectionLanguageHeading||c.en?.generalSectionLanguageHeading||iS.textContent;iS.textContent=le}if(sS){const le=c[e].generalSectionAppearanceHeading||c.en?.generalSectionAppearanceHeading||sS.textContent;sS.textContent=le}if(lS){const le=c[e].generalSectionTypographyHeading||c.en?.generalSectionTypographyHeading||lS.textContent;lS.textContent=le}if(cS){const le=c[e].generalSectionBrandingHeading||c.en?.generalSectionBrandingHeading||cS.textContent;cS.textContent=le}Fm.updateLocalization({language:e,texts:c[e]||{},fallbackTexts:c[Qr]||c.en||{}}),Fm.isInitialized()&&Fm.render()}Me(GP,c[e].settingsTabAutoGear||c.en?.settingsTabAutoGear||c[e].autoGearHeading||c.en?.autoGearHeading,c[e].settingsTabAutoGearHelp||c.en?.settingsTabAutoGearHelp||c[e].autoGearHeadingHelp||c.en?.autoGearHeadingHelp),Me(kP,c[e].settingsTabAccessibility||c.en?.settingsTabAccessibility||c[e].accessibilityHeading||c.en?.accessibilityHeading,c[e].settingsTabAccessibilityHelp||c.en?.settingsTabAccessibilityHelp||c[e].accessibilityHeadingHelp||c.en?.accessibilityHeadingHelp),Me(BP,c[e].settingsTabBackup||c.en?.settingsTabBackup||c[e].backupHeading||c.en?.backupHeading,c[e].settingsTabBackupHelp||c.en?.settingsTabBackupHelp||c[e].backupHeadingHelp||c.en?.backupHeadingHelp),Me(PP,c[e].settingsTabData||c.en?.settingsTabData||c[e].dataHeading||c.en?.dataHeading,c[e].settingsTabDataHelp||c.en?.settingsTabDataHelp||c[e].dataHeadingHelp||c.en?.dataHeadingHelp),Me(xP,c[e].settingsTabAbout||c.en?.settingsTabAbout||c[e].aboutHeading||c.en?.aboutHeading,c[e].settingsTabAboutHelp||c.en?.settingsTabAboutHelp||c[e].aboutHeadingHelp||c.en?.aboutHeadingHelp);const b=document.getElementById("settingsLanguageLabel");if(b){b.textContent=c[e].languageSetting;const f=c[e].settingsLanguageHelp||c[e].languageSetting;b.setAttribute("data-help",f),yu&&(yu.setAttribute("data-help",f),yu.setAttribute("aria-label",c[e].languageSetting))}const v=document.getElementById("settingsDarkModeLabel");if(v){v.textContent=c[e].darkModeSetting;const f=c[e].settingsDarkModeHelp||c[e].darkModeSetting;v.setAttribute("data-help",f),dS&&(dS.setAttribute("data-help",f),dS.setAttribute("aria-label",c[e].darkModeSetting))}const T=document.getElementById("settingsPinkModeLabel");if(T){T.textContent=c[e].pinkModeSetting;const f=c[e].settingsPinkModeHelp||c[e].pinkModeSetting;T.setAttribute("data-help",f),fS&&(fS.setAttribute("data-help",f),fS.setAttribute("aria-label",c[e].pinkModeSetting))}const P=document.getElementById("accentColorLabel"),x=c[e].accentColorHelp||c[e].accentColorSetting;if(P&&(P.textContent=c[e].accentColorSetting,P.setAttribute("data-help",x)),pS&&(pS.setAttribute("data-help",x),pS.setAttribute("aria-label",c[e].accentColorSetting)),uS){const f=c[e].cameraColorSettingDescription||c.en?.cameraColorSettingDescription||uS.textContent;uS.textContent=f}const _=c[e].cameraColorInputHelp||c.en?.cameraColorInputHelp||"";if([["A",aW,uW],["B",iW,dW],["C",sW,fW],["D",lW,pW],["E",cW,mW]].forEach(([f,w,le])=>{if(!w)return;const Pe=`cameraColor${f} Label`,st=c[e][Pe]||c.en?.[Pe]||w.textContent;w.textContent=st;const At=_?_.replace("%s",f):"";At?w.setAttribute("data-help",At):w.removeAttribute("data-help"),le&&(At?(le.setAttribute("data-help",At),le.setAttribute("aria-label",At)):(le.removeAttribute("data-help"),le.setAttribute("aria-label",st)))}),Tl){const f=c[e]&&c[e].accentColorReset||c.en&&c.en.accentColorReset||Tl.textContent||"Reset to default",w=c[e]&&c[e].accentColorResetHelp||x;Tl.textContent=f,Tl.setAttribute("data-help",w),Tl.setAttribute("aria-label",w),Tl.setAttribute("title",w)}const X=document.getElementById("settingsTemperatureUnitLabel");if(X){X.textContent=c[e].temperatureUnitSetting;const f=c[e].temperatureUnitSettingHelp||c[e].temperatureUnitSetting;X.setAttribute("data-help",f),typeof Ol<"u"&&Ol&&(Ol.setAttribute("data-help",f),Ol.setAttribute("aria-label",c[e].temperatureUnitSetting),Array.from(Ol.options||[]).forEach(w=>{if(!w)return;const le=h(w.value);w.textContent=RV(e,le)}),Ol.value=temperatureUnit)}const ye=document.getElementById("settingsFocusScaleLabel");if(ye){ye.textContent=c[e].focusScaleSetting;const f=c[e].focusScaleSettingHelp||c[e].focusScaleSetting;ye.setAttribute("data-help",f),typeof Gl<"u"&&Gl&&(Gl.setAttribute("data-help",f),Gl.setAttribute("aria-label",c[e].focusScaleSetting),Array.from(Gl.options||[]).forEach(w=>{if(!w)return;const le=y(w.value);w.textContent=t$(e,le)}),Gl.value=S())}const Be=document.getElementById("settingsFontSizeLabel");if(Be){Be.textContent=c[e].fontSizeSetting;const f=c[e].fontSizeSettingHelp||c[e].fontSizeSetting;Be.setAttribute("data-help",f),mS&&(mS.setAttribute("data-help",f),mS.setAttribute("aria-label",c[e].fontSizeSetting))}const Ue=document.getElementById("settingsFontFamilyLabel");if(Ue){Ue.textContent=c[e].fontFamilySetting;const f=c[e].fontFamilySettingHelp||c[e].fontFamilySetting;Ue.setAttribute("data-help",f),gS&&(gS.setAttribute("data-help",f),gS.setAttribute("aria-label",c[e].fontFamilySetting))}if(xa){const f=c[e].localFontsButtonHelp||xa.textContent;xa.setAttribute("data-help",f),xa.setAttribute("title",f),xa.setAttribute("aria-label",f)}if(bS){const f=c[e]&&c[e].bundledFontsGroup||c.en&&c.en.bundledFontsGroup||bS.label;f&&(bS.label=f)}if(yS){const f=c[e]&&c[e].localFontsGroup||c.en&&c.en.localFontsGroup||yS.label;f&&(yS.label=f)}if(xa){const f=c[e]&&c[e].localFontsButton||c.en&&c.en.localFontsButton||xa.textContent;f&&(je(xa,f,ICON_GLYPHS.add),xa.setAttribute("aria-label",f),xa.setAttribute("title",f))}if(bu&&bu.dataset.statusKey){const f=bu.dataset.statusKey,w=bu.dataset.statusArg;let le=c[e]&&c[e][f]||c.en&&c.en[f]||"";le&&w!==void 0&&w!==null?le=le.replace("%s",w):!le&&w!==void 0&&w!==null&&(le=w),bu.textContent=le}const be=document.getElementById("settingsLogoLabel");if(be){be.textContent=c[e].logoSetting;const f=c[e].logoSettingHelp||c[e].logoSetting;be.setAttribute("data-help",f),hS&&(hS.setAttribute("data-help",f),hS.setAttribute("aria-label",c[e].logoSetting))}if(wm){wm.textContent=c[e].autoGearHeading||c.en?.autoGearHeading||"Automatic Gear Rules";const f=c[e].autoGearHeadingHelp||c.en?.autoGearHeadingHelp;f&&wm.setAttribute("data-help",f)}if(sA&&(sA.textContent=c[e].autoGearDescription||c.en?.autoGearDescription||""),Lm){const f=c[e].autoGearMonitorDefaultsHeading||c.en?.autoGearMonitorDefaultsHeading||Lm.textContent;Lm.textContent=f}if(Rm){const f=c[e].autoGearMonitorDefaultsDescription||c.en?.autoGearMonitorDefaultsDescription||Rm.textContent;Rm.textContent=f}if(lA.forEach(f=>{if(!f)return;const w=dB[f.key],le=w&&(c[e][w]||c.en?.[w])||f.label?.textContent;f.label&&le&&(f.label.textContent=le,f.label.setAttribute("data-help",le)),f.select&&le&&(f.select.setAttribute("aria-label",le),f.select.setAttribute("data-help",le))}),gt("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),gt("renderAutoGearMonitorDefaultsControls",[],{defer:!0}),cA&&(cA.textContent=c[e].autoGearPresetDescription||c.en?.autoGearPresetDescription||""),_u){const f=c[e].autoGearPresetLabel||c.en?.autoGearPresetLabel||_u.textContent,w=c[e].autoGearPresetDescription||c.en?.autoGearPresetDescription||f;_u.textContent=f,_u.setAttribute("data-help",w),Im&&(Im.setAttribute("aria-label",f),Im.setAttribute("data-help",w))}if(_l){const f=c[e].autoGearSavePresetButton||c.en?.autoGearSavePresetButton||_l.textContent;je(_l,f,ICON_GLYPHS.save),_l.setAttribute("data-help",f),_l.setAttribute("aria-label",f)}if(Fl){const f=c[e].autoGearDeletePresetButton||c.en?.autoGearDeletePresetButton||Fl.textContent;je(Fl,f,ICON_GLYPHS.trash),Fl.setAttribute("data-help",f),Fl.setAttribute("aria-label",f)}if(Qi){const f=c[e].autoGearAddRule||c.en?.autoGearAddRule||Qi.textContent;je(Qi,f,ICON_GLYPHS.add);const w=c[e].autoGearHeadingHelp||c.en?.autoGearHeadingHelp||f;Qi.setAttribute("data-help",w)}if(As){const f=c[e].autoGearResetFactoryButton||c.en?.autoGearResetFactoryButton||As.textContent,w=c[e].autoGearResetFactoryHelp||c.en?.autoGearResetFactoryHelp||f;je(As,f,ICON_GLYPHS.reload),As.setAttribute("data-help",w),As.setAttribute("title",w),As.setAttribute("aria-label",f)}if(kl){const f=c[e].autoGearExportButton||c.en?.autoGearExportButton||kl.textContent,w=c[e].autoGearExportHelp||c.en?.autoGearExportHelp||f;je(kl,f,ICON_GLYPHS.fileExport),kl.setAttribute("data-help",w),kl.setAttribute("title",w),kl.setAttribute("aria-label",f)}if(Bl){const f=c[e].autoGearImportButton||c.en?.autoGearImportButton||Bl.textContent,w=c[e].autoGearImportHelp||c.en?.autoGearImportHelp||f;je(Bl,f,ICON_GLYPHS.fileImport),Bl.setAttribute("data-help",w),Bl.setAttribute("title",w),Bl.setAttribute("aria-label",f)}if(Mu){const f=c[e].autoGearSearchLabel||c.en?.autoGearSearchLabel||Mu.textContent,w=c[e].autoGearSearchHelp||c.en?.autoGearSearchHelp||f;if(Mu.textContent=f,Mu.setAttribute("data-help",w),Ml){const le=c[e].autoGearSearchPlaceholder||c.en?.autoGearSearchPlaceholder||Ml.getAttribute("placeholder")||"";Ml.setAttribute("placeholder",le),Ml.setAttribute("aria-label",f),Ml.setAttribute("data-help",w)}}if(Du){const f=c[e].autoGearFilterScenarioLabel||c.en?.autoGearFilterScenarioLabel||Du.textContent,w=c[e].autoGearFilterScenarioHelp||c.en?.autoGearFilterScenarioHelp||f;Du.textContent=f,Du.setAttribute("data-help",w),ja&&(ja.setAttribute("aria-label",f),ja.setAttribute("data-help",w))}if(Dl){const f=c[e].autoGearFilterClear||c.en?.autoGearFilterClear||Dl.textContent;je(Dl,f,ICON_GLYPHS.circleX),Dl.setAttribute("data-help",f),Dl.setAttribute("aria-label",f)}if(qP(AC()),OS&&(OS.textContent=c[e].autoGearBackupsHeading||c.en?.autoGearBackupsHeading||OS.textContent),GS){const f=c[e].autoGearBackupsDescription||c.en?.autoGearBackupsDescription||"";GS.textContent=f,f&&GS.setAttribute("data-help",f)}if(Vp){const f=c[e].autoGearShowBackupsLabel||c.en?.autoGearShowBackupsLabel||Vp.textContent,w=c[e].autoGearShowBackupsHelp||c.en?.autoGearShowBackupsHelp||f;Vp.textContent=f,Vp.setAttribute("data-help",w),PS&&(PS.setAttribute("aria-label",f),PS.setAttribute("data-help",w))}if(xS){const f=c[e].autoGearBackupsHidden||c.en?.autoGearBackupsHidden||xS.textContent;xS.textContent=f}if(qp){const f=c[e].autoGearBackupRetentionLabel||c.en?.autoGearBackupRetentionLabel||qp.textContent,w=c[e].autoGearBackupRetentionHelp||c.en?.autoGearBackupRetentionHelp||f;qp.textContent=f,qp.setAttribute("data-help",w),Ns&&(Ns.setAttribute("aria-label",f),Ns.setAttribute("title",f))}if(RW&&gt("renderAutoGearBackupRetentionControls",[],{defer:!0}),kS){const f=c[e].autoGearBackupSelectLabel||c.en?.autoGearBackupSelectLabel||kS.textContent;kS.textContent=f,$p&&($p.setAttribute("aria-label",f),$p.setAttribute("title",f))}if(Cu){const f=c[e].autoGearBackupRestore||c.en?.autoGearBackupRestore||Cu.textContent;je(Cu,f,ICON_GLYPHS.fileImport),Cu.setAttribute("aria-label",f),Cu.setAttribute("title",f)}if(BS){const f=c[e].autoGearBackupEmpty||c.en?.autoGearBackupEmpty||BS.textContent;BS.textContent=f}if($p&&gt("renderAutoGearBackupControls",[],{defer:!0}),zf){const f=c[e].autoGearRuleNameLabel||c.en?.autoGearRuleNameLabel||zf.textContent;zf.textContent=f;const w=c[e].autoGearRuleNameHelp||c.en?.autoGearRuleNameHelp||f;zf.setAttribute("data-help",w),hh&&(hh.setAttribute("data-help",w),hh.setAttribute("aria-label",f))}if(Fu){const f=c[e].autoGearConditionSelectLabel||c.en?.autoGearConditionSelectLabel||Fu.textContent||"Add a condition",w=c[e].autoGearConditionSelectHelp||c.en?.autoGearConditionSelectHelp||f;Fu.textContent=f,Fu.setAttribute("data-help",w),Fo&&(Fo.setAttribute("aria-label",f),Fo.setAttribute("data-help",w))}if(Ni){const f=c[e].autoGearAddCondition||c.en?.autoGearAddCondition||Ni.textContent||"Add condition";je(Ni,f,ICON_GLYPHS.add),Ni.setAttribute("aria-label",f),Ni.setAttribute("data-help",f)}if(Nu){const f=c[e].autoGearAlwaysLabel||c.en?.autoGearAlwaysLabel||Nu.textContent||"Always include",w=c[e].autoGearAlwaysHelp||c.en?.autoGearAlwaysHelp||f;Nu.textContent=f,Nu.setAttribute("data-help",w),Tm&&(Tm.textContent=w,Tm.setAttribute("data-help",w))}if(pC(),sb(),lb(),Uf){const f=c[e].autoGearScenariosLabel||c.en?.autoGearScenariosLabel||Uf.textContent;Uf.textContent=f;const w=c[e].autoGearScenariosHelp||c.en?.autoGearScenariosHelp||f;if(Uf.setAttribute("data-help",w),Hu&&(Hu.setAttribute("data-help",w),Hu.setAttribute("aria-label",f)),$f){const le=c[e].autoGearScenarioModeLabel||c.en?.autoGearScenarioModeLabel||$f.textContent||"Scenario matching",Pe=c[e].autoGearScenarioModeHelp||c.en?.autoGearScenarioModeHelp||le;$f.textContent=le,$f.setAttribute("data-help",Pe),qs&&(qs.setAttribute("data-help",Pe),qs.setAttribute("aria-label",le))}if(qf){const le=c[e].autoGearScenarioBaseLabel||c.en?.autoGearScenarioBaseLabel||qf.textContent||"Base scenario",Pe=c[e].autoGearScenarioBaseHelp||c.en?.autoGearScenarioBaseHelp||le;qf.textContent=le,qf.setAttribute("data-help",Pe),Sh&&(Sh.setAttribute("data-help",Pe),Sh.setAttribute("aria-label",le))}if(Vf){const le=c[e].autoGearScenarioFactorLabel||c.en?.autoGearScenarioFactorLabel||Vf.textContent||"Multiplier factor",Pe=c[e].autoGearScenarioFactorHelp||c.en?.autoGearScenarioFactorHelp||le;Vf.textContent=le,Vf.setAttribute("data-help",Pe),vh&&(vh.setAttribute("data-help",Pe),vh.setAttribute("aria-label",le))}}if(Wf){const f=c[e].autoGearShootingDaysLabel||c.en?.autoGearShootingDaysLabel||Wf.textContent||"Shooting days condition",w=c[e].autoGearShootingDaysHelp||c.en?.autoGearShootingDaysHelp||f,le=c[e].autoGearShootingDaysModeMinimum||c.en?.autoGearShootingDaysModeMinimum||"Minimum",Pe=c[e].autoGearShootingDaysModeMaximum||c.en?.autoGearShootingDaysModeMaximum||"Maximum",st=c[e].autoGearShootingDaysModeEvery||c.en?.autoGearShootingDaysModeEvery||"Every",At=c[e].autoGearShootingDaysValueLabel||c.en?.autoGearShootingDaysValueLabel||"Shooting days value";Wf.textContent=f,Wf.setAttribute("data-help",w),ga&&(ga.setAttribute("data-help",w),ga.setAttribute("aria-label",f),Array.from(ga.options||[]).forEach(qt=>{!qt||typeof qt.value!="string"||(qt.value==="minimum"?qt.textContent=le:qt.value==="maximum"?qt.textContent=Pe:qt.value==="every"&&(qt.textContent=st))})),Eh&&(Eh.textContent=At,Eh.setAttribute("data-help",w)),ya&&(ya.setAttribute("data-help",w),ya.setAttribute("aria-label",At)),Ah&&(Ah.textContent=w,Ah.setAttribute("data-help",w))}if(Kf){const f=c[e].autoGearMatteboxLabel||c.en?.autoGearMatteboxLabel||Kf.textContent;Kf.textContent=f;const w=c[e].autoGearMatteboxHelp||c.en?.autoGearMatteboxHelp||f;Kf.setAttribute("data-help",w),ju&&(ju.setAttribute("data-help",w),ju.setAttribute("aria-label",f))}if(Yf){const f=c[e].autoGearCameraHandleLabel||c.en?.autoGearCameraHandleLabel||Yf.textContent;Yf.textContent=f;const w=c[e].autoGearCameraHandleHelp||c.en?.autoGearCameraHandleHelp||f;Yf.setAttribute("data-help",w),zu&&(zu.setAttribute("data-help",w),zu.setAttribute("aria-label",f))}if(Qf){const f=c[e].autoGearViewfinderExtensionLabel||c.en?.autoGearViewfinderExtensionLabel||Qf.textContent;Qf.textContent=f;const w=c[e].autoGearViewfinderExtensionHelp||c.en?.autoGearViewfinderExtensionHelp||f;Qf.setAttribute("data-help",w),Uu&&(Uu.setAttribute("data-help",w),Uu.setAttribute("aria-label",f))}if(Zf){const f=c[e].autoGearDeliveryResolutionLabel||c.en?.autoGearDeliveryResolutionLabel||Zf.textContent;Zf.textContent=f;const w=c[e].autoGearDeliveryResolutionHelp||c.en?.autoGearDeliveryResolutionHelp||f;Zf.setAttribute("data-help",w),Xf&&(Xf.setAttribute("data-help",w),Xf.setAttribute("aria-label",f))}if(Jf){const f=c[e].autoGearVideoDistributionLabel||c.en?.autoGearVideoDistributionLabel||Jf.textContent;Jf.textContent=f;const w=c[e].autoGearVideoDistributionHelp||c.en?.autoGearVideoDistributionHelp||f;Jf.setAttribute("data-help",w),$u&&($u.setAttribute("data-help",w),$u.setAttribute("aria-label",f))}if(ep){const f=c[e].autoGearCameraLabel||c.en?.autoGearCameraLabel||ep.textContent;ep.textContent=f;const w=c[e].autoGearCameraHelp||c.en?.autoGearCameraHelp||f;ep.setAttribute("data-help",w),Om&&(Om.setAttribute("data-help",w),Om.setAttribute("aria-label",f))}if(tp){const f=c[e].autoGearConditionOwnGearLabel||c[e].autoGearOwnGearLabel||c.en?.autoGearConditionOwnGearLabel||c.en?.autoGearOwnGearLabel||tp.textContent,w=c[e].autoGearConditionOwnGearHelp||c.en?.autoGearConditionOwnGearHelp||c[e].autoGearOwnGearHelp||c.en?.autoGearOwnGearHelp||f;tp.textContent=f,tp.setAttribute("data-help",w),Gm&&(Gm.setAttribute("data-help",w),Gm.setAttribute("aria-label",f))}if(rp){const f=c[e].autoGearCameraWeightLabel||c.en?.autoGearCameraWeightLabel||rp.textContent||"Camera weight",w=c[e].autoGearCameraWeightHelp||c.en?.autoGearCameraWeightHelp||f;rp.textContent=f,rp.setAttribute("data-help",w)}if(op){const f=c[e].autoGearCameraWeightOperatorLabel||c.en?.autoGearCameraWeightOperatorLabel||op.textContent||"Weight comparison";if(op.textContent=f,op.setAttribute("data-help",f),ba){ba.setAttribute("data-help",f),ba.setAttribute("aria-label",f);const w=c[e].autoGearCameraWeightOperatorGreater||c.en?.autoGearCameraWeightOperatorGreater||"Heavier than",le=c[e].autoGearCameraWeightOperatorLess||c.en?.autoGearCameraWeightOperatorLess||"Lighter than",Pe=c[e].autoGearCameraWeightOperatorEqual||c.en?.autoGearCameraWeightOperatorEqual||"Exactly";Array.from(ba.options||[]).forEach(st=>{st&&(st.value==="greater"?st.textContent=w:st.value==="less"?st.textContent=le:st.value==="equal"&&(st.textContent=Pe))})}}if(np){const f=c[e].autoGearCameraWeightValueLabel||c.en?.autoGearCameraWeightValueLabel||np.textContent||"Weight threshold (grams)",w=c[e].autoGearCameraWeightHelp||c.en?.autoGearCameraWeightHelp||f;np.textContent=f,np.setAttribute("data-help",w),ha&&(ha.setAttribute("data-help",w),ha.setAttribute("aria-label",f))}if(ap){const f=c[e].autoGearCameraWeightHelp||c.en?.autoGearCameraWeightHelp||ap.textContent||"";ap.textContent=f,f&&ap.setAttribute("data-help",f)}if(ip){const f=c[e].autoGearMonitorLabel||c.en?.autoGearMonitorLabel||ip.textContent;ip.textContent=f;const w=c[e].autoGearMonitorHelp||c.en?.autoGearMonitorHelp||f;ip.setAttribute("data-help",w),km&&(km.setAttribute("data-help",w),km.setAttribute("aria-label",f))}if(sp){const f=c[e].autoGearTripodHeadBrandLabel||c.en?.autoGearTripodHeadBrandLabel||sp.textContent;sp.textContent=f;const w=c[e].autoGearTripodHeadBrandHelp||c.en?.autoGearTripodHeadBrandHelp||f;sp.setAttribute("data-help",w),Ch&&(Ch.setAttribute("data-help",w),Ch.setAttribute("aria-label",f))}if(lp){const f=c[e].autoGearTripodBowlLabel||c.en?.autoGearTripodBowlLabel||lp.textContent;lp.textContent=f;const w=c[e].autoGearTripodBowlHelp||c.en?.autoGearTripodBowlHelp||f;lp.setAttribute("data-help",w),wh&&(wh.setAttribute("data-help",w),wh.setAttribute("aria-label",f))}if(cp){const f=c[e].autoGearTripodTypesLabel||c.en?.autoGearTripodTypesLabel||cp.textContent;cp.textContent=f;const w=c[e].autoGearTripodTypesHelp||c.en?.autoGearTripodTypesHelp||f;cp.setAttribute("data-help",w),Lh&&(Lh.setAttribute("data-help",w),Lh.setAttribute("aria-label",f))}if(up){const f=c[e].autoGearTripodSpreaderLabel||c.en?.autoGearTripodSpreaderLabel||up.textContent;up.textContent=f;const w=c[e].autoGearTripodSpreaderHelp||c.en?.autoGearTripodSpreaderHelp||f;up.setAttribute("data-help",w),Rh&&(Rh.setAttribute("data-help",w),Rh.setAttribute("aria-label",f))}if(dp){const f=c[e].autoGearCrewPresentLabel||c.en?.autoGearCrewPresentLabel||dp.textContent;dp.textContent=f;const w=c[e].autoGearCrewPresentHelp||c.en?.autoGearCrewPresentHelp||f;dp.setAttribute("data-help",w),od&&(od.setAttribute("data-help",w),od.setAttribute("aria-label",f))}if(fp){const f=c[e].autoGearCrewAbsentLabel||c.en?.autoGearCrewAbsentLabel||fp.textContent;fp.textContent=f;const w=c[e].autoGearCrewAbsentHelp||c.en?.autoGearCrewAbsentHelp||f;fp.setAttribute("data-help",w),nd&&(nd.setAttribute("data-help",w),nd.setAttribute("aria-label",f))}if(pp){const f=c[e].autoGearWirelessLabel||c.en?.autoGearWirelessLabel||pp.textContent;pp.textContent=f;const w=c[e].autoGearWirelessHelp||c.en?.autoGearWirelessHelp||f;pp.setAttribute("data-help",w),Bm&&(Bm.setAttribute("data-help",w),Bm.setAttribute("aria-label",f))}if(mp){const f=c[e].autoGearMotorsLabel||c.en?.autoGearMotorsLabel||mp.textContent;mp.textContent=f;const w=c[e].autoGearMotorsHelp||c.en?.autoGearMotorsHelp||f;mp.setAttribute("data-help",w),Pm&&(Pm.setAttribute("data-help",w),Pm.setAttribute("aria-label",f))}if(gp){const f=c[e].autoGearControllersLabel||c.en?.autoGearControllersLabel||gp.textContent;gp.textContent=f;const w=c[e].autoGearControllersHelp||c.en?.autoGearControllersHelp||f;gp.setAttribute("data-help",w),xm&&(xm.setAttribute("data-help",w),xm.setAttribute("aria-label",f))}if(yp){const f=c[e].autoGearDistanceLabel||c.en?.autoGearDistanceLabel||yp.textContent;yp.textContent=f;const w=c[e].autoGearDistanceHelp||c.en?.autoGearDistanceHelp||f;yp.setAttribute("data-help",w),Mm&&(Mm.setAttribute("data-help",w),Mm.setAttribute("aria-label",f))}const Fe=c[e].autoGearConditionLogicLabel||c.en?.autoGearConditionLogicLabel||"Match behavior",bt=c[e].autoGearConditionLogicHelp||c.en?.autoGearConditionLogicHelp||Fe,it={all:c[e]?.autoGearConditionLogicAll||c.en?.autoGearConditionLogicAll||"Require every selected value",any:c[e]?.autoGearConditionLogicAny||c.en?.autoGearConditionLogicAny||"Match any selected value",none:c[e]?.autoGearConditionLogicNone||c.en?.autoGearConditionLogicNone||"Require none of the selected values",multiplier:c[e]?.autoGearConditionLogicMultiplier||c.en?.autoGearConditionLogicMultiplier||"Multiply by matched values"};if(Object.entries(IC).forEach(([f,w])=>{const le=jB[f];le&&(le.textContent=Fe,le.setAttribute("data-help",bt)),w&&(w.setAttribute("aria-label",Fe),w.setAttribute("data-help",bt),w.setAttribute("title",bt),Array.from(w.options||[]).forEach(Pe=>{if(!Pe)return;const st=it[Pe.value];st&&(Pe.textContent=st)}))}),SS&&(SS.textContent=c[e].autoGearAddItemsHeading||c.en?.autoGearAddItemsHeading||SS.textContent),Fp){const f=c[e].autoGearOwnGearLabel||c.en?.autoGearOwnGearLabel||Fp.textContent,w=c[e].autoGearOwnGearHelp||c.en?.autoGearOwnGearHelp||f,le=c[e].autoGearOwnGearPlaceholder||c.en?.autoGearOwnGearPlaceholder||"";Fp.textContent=f,Fp.setAttribute("data-help",w),hu&&(hu.setAttribute("aria-label",f),hu.setAttribute("data-help",w),le?hu.setAttribute("data-placeholder",le):hu.removeAttribute("data-placeholder"))}if(Np){const f=c[e].autoGearAddItemLabel||c.en?.autoGearAddItemLabel||Np.textContent,w=c[e].autoGearAddMultipleHint||c.en?.autoGearAddMultipleHint||"",le=w?`${f} – ${w} `:f;Np.textContent=f,Np.setAttribute("data-help",le),Su&&(Su.setAttribute("aria-label",f),Su.setAttribute("data-help",le),w?Su.setAttribute("placeholder",w):Su.removeAttribute("placeholder"))}if(vS){const f=c[e].autoGearAddCategoryLabel||c.en?.autoGearAddCategoryLabel||vS.textContent;vS.textContent=f,Nl&&Nl.setAttribute("aria-label",f)}if(AS){const f=c[e].autoGearAddQuantityLabel||c.en?.autoGearAddQuantityLabel||AS.textContent;AS.textContent=f,BI&&BI.setAttribute("aria-label",f)}if(Nm){const f=c[e].autoGearAddScreenSizeLabel||c.en?.autoGearAddScreenSizeLabel||Nm.textContent;Nm.textContent=f,fy&&fy.setAttribute("aria-label",f)}if(Hm){const f=c[e].autoGearAddSelectorTypeLabel||c.en?.autoGearAddSelectorTypeLabel||Hm.textContent;if(Hm.textContent=f,hc){hc.setAttribute("aria-label",f);const w=c[e].autoGearSelectorNoneOption||c.en?.autoGearSelectorNoneOption||"No selector",le=c[e].autoGearSelectorMonitorOption||c.en?.autoGearSelectorMonitorOption||"Monitor selector",Pe=c[e].autoGearSelectorDirectorOption||c.en?.autoGearSelectorDirectorOption||"Director monitor selector",st=c[e].autoGearSelectorTripodHeadOption||c.en?.autoGearSelectorTripodHeadOption||"Tripod head selector",At=c[e].autoGearSelectorTripodBowlOption||c.en?.autoGearSelectorTripodBowlOption||"Tripod bowl selector",qt=c[e].autoGearSelectorTripodTypesOption||c.en?.autoGearSelectorTripodTypesOption||"Tripod type selector",Xt=c[e].autoGearSelectorTripodSpreaderOption||c.en?.autoGearSelectorTripodSpreaderOption||"Tripod spreader selector",Ne=new Map([["none",w],["monitor",le],["directorMonitor",Pe],["tripodHeadBrand",st],["tripodBowl",At],["tripodTypes",qt],["tripodSpreader",Xt]]);Array.from(hc.options||[]).forEach(uo=>{const Kr=Ne.get(uo.value);Kr&&(uo.textContent=Kr)})}}if(jm){const f=c[e].autoGearAddSelectorDefaultLabel||c.en?.autoGearAddSelectorDefaultLabel||jm.textContent;jm.textContent=f,cf&&cf.setAttribute("aria-label",f)}if(ES){const f=c[e].autoGearAddNotesLabel||c.en?.autoGearAddNotesLabel||ES.textContent;ES.textContent=f,PI&&PI.setAttribute("aria-label",f)}if(zP&&typeof Nf=="function"&&Nf("add"),CS&&(CS.textContent=c[e].autoGearRemoveItemsHeading||c.en?.autoGearRemoveItemsHeading||CS.textContent),Hp){const f=c[e].autoGearOwnGearLabel||c.en?.autoGearOwnGearLabel||Hp.textContent,w=c[e].autoGearOwnGearHelp||c.en?.autoGearOwnGearHelp||f,le=c[e].autoGearOwnGearPlaceholder||c.en?.autoGearOwnGearPlaceholder||"";Hp.textContent=f,Hp.setAttribute("data-help",w),vu&&(vu.setAttribute("aria-label",f),vu.setAttribute("data-help",w),le?vu.setAttribute("data-placeholder",le):vu.removeAttribute("data-placeholder"))}if(jp){const f=c[e].autoGearRemoveItemLabel||c.en?.autoGearRemoveItemLabel||jp.textContent,w=c[e].autoGearRemoveMultipleHint||c.en?.autoGearRemoveMultipleHint||"",le=w?`${f} – ${w} `:f;jp.textContent=f,jp.setAttribute("data-help",le),Au&&(Au.setAttribute("aria-label",f),Au.setAttribute("data-help",le),w?Au.setAttribute("placeholder",w):Au.removeAttribute("placeholder"))}if(wS){const f=c[e].autoGearRemoveCategoryLabel||c.en?.autoGearRemoveCategoryLabel||wS.textContent;wS.textContent=f,Hl&&Hl.setAttribute("aria-label",f)}if(LS){const f=c[e].autoGearRemoveQuantityLabel||c.en?.autoGearRemoveQuantityLabel||LS.textContent;LS.textContent=f,xI&&xI.setAttribute("aria-label",f)}if(zm){const f=c[e].autoGearRemoveScreenSizeLabel||c.en?.autoGearRemoveScreenSizeLabel||zm.textContent;zm.textContent=f,py&&py.setAttribute("aria-label",f)}if(Um){const f=c[e].autoGearRemoveSelectorTypeLabel||c.en?.autoGearRemoveSelectorTypeLabel||Um.textContent;if(Um.textContent=f,Sc){Sc.setAttribute("aria-label",f);const w=c[e].autoGearSelectorNoneOption||c.en?.autoGearSelectorNoneOption||"No selector",le=c[e].autoGearSelectorMonitorOption||c.en?.autoGearSelectorMonitorOption||"Monitor selector",Pe=c[e].autoGearSelectorDirectorOption||c.en?.autoGearSelectorDirectorOption||"Director monitor selector",st=c[e].autoGearSelectorTripodHeadOption||c.en?.autoGearSelectorTripodHeadOption||"Tripod head selector",At=c[e].autoGearSelectorTripodBowlOption||c.en?.autoGearSelectorTripodBowlOption||"Tripod bowl selector",qt=c[e].autoGearSelectorTripodTypesOption||c.en?.autoGearSelectorTripodTypesOption||"Tripod type selector",Xt=c[e].autoGearSelectorTripodSpreaderOption||c.en?.autoGearSelectorTripodSpreaderOption||"Tripod spreader selector",Ne=new Map([["none",w],["monitor",le],["directorMonitor",Pe],["tripodHeadBrand",st],["tripodBowl",At],["tripodTypes",qt],["tripodSpreader",Xt]]);Array.from(Sc.options||[]).forEach(uo=>{const Kr=Ne.get(uo.value);Kr&&(uo.textContent=Kr)})}}if($m){const f=c[e].autoGearRemoveSelectorDefaultLabel||c.en?.autoGearRemoveSelectorDefaultLabel||$m.textContent;$m.textContent=f,uf&&uf.setAttribute("aria-label",f)}if(RS){const f=c[e].autoGearRemoveNotesLabel||c.en?.autoGearRemoveNotesLabel||RS.textContent;RS.textContent=f,MI&&MI.setAttribute("aria-label",f)}if(updateAutoGearOwnGearOptions(),Eu){const f=c[e].autoGearDraftImpactHeading||c.en?.autoGearDraftImpactHeading||Eu.textContent;Eu.textContent=f}if(IS){const f=c[e].autoGearDraftImpactDescription||c.en?.autoGearDraftImpactDescription||IS.textContent;IS.textContent=f,Eu&&Eu.setAttribute("data-help",f),DI&&DI.setAttribute("data-help",f)}if(TS){const f=c[e].autoGearDraftWarningHeading||c.en?.autoGearDraftWarningHeading||TS.textContent;TS.textContent=f}if(UP&&typeof Nf=="function"&&Nf("remove"),zp){const f=c[e].autoGearSaveRule||c.en?.autoGearSaveRule||zp.textContent;je(zp,f),zp.setAttribute("data-help",f)}if(Up){const f=c[e].autoGearCancelEdit||c.en?.autoGearCancelEdit||Up.textContent;je(Up,f,ICON_GLYPHS.circleX),Up.setAttribute("data-help",f)}Nl&&populateAutoGearCategorySelect(Nl,Nl.value),Hl&&populateAutoGearCategorySelect(Hl,Hl.value),$P(),Hu&&MP(_i?.scenarios),ju&&DP(_i?.mattebox),zu&&_P(_i?.cameraHandle),Uu&&FP(_i?.viewfinderExtension),Xf&&NP(_i?.deliveryResolution),$u&&HP(_i?.videoDistribution),gt("seedAutoGearRulesFromCurrentProject",[],{defer:!0}),gt("renderAutoGearRulesList",[],{defer:!0}),gt("renderAutoGearDraftLists",[],{defer:!0}),gt("updateAutoGearCatalogOptions",[],{defer:!0}),gt("renderAutoGearPresetsControls",[],{defer:!0}),gt("applyAutoGearBackupVisibility",[],{defer:!0});const Kt=document.getElementById("settingsHighContrastLabel");if(Kt){Kt.textContent=c[e].highContrastSetting;const f=c[e].highContrastSettingHelp||c[e].highContrastSetting;Kt.setAttribute("data-help",f),settingsHighContrast&&(settingsHighContrast.setAttribute("data-help",f),settingsHighContrast.setAttribute("aria-label",c[e].highContrastSetting))}const Mt=document.getElementById("accessibilityHeading");Mt&&(Mt.textContent=c[e].accessibilityHeading,Mt.setAttribute("data-help",c[e].accessibilityHeadingHelp||c[e].accessibilityHeading));const xr=document.getElementById("backupHeading");xr&&(xr.textContent=c[e].backupHeading,xr.setAttribute("data-help",c[e].backupHeadingHelp||c[e].backupHeading));const Xr=typeof document<"u"?document.getElementById("projectBackupsHeading"):null;if(Xr){const f=c[e].projectBackupsHeading||"Project Backups";Xr.textContent=f;const w=c[e].projectBackupsDescription||"";w?Xr.setAttribute("data-help",w):Xr.removeAttribute("data-help")}const zr=typeof document<"u"?document.getElementById("projectBackupsDescription"):null;if(zr){const f=c[e].projectBackupsDescription||"";f?(zr.textContent=f,zr.hidden=!1):(zr.textContent="",zr.hidden=!0)}if(MS){MS.textContent=c[e].dataHeading;const f=c[e].dataHeadingHelp||c[e].dataHeading;MS.setAttribute("data-help",f)}if(_I&&(_I.textContent=c[e].storageSummaryIntro),NI&&(NI.textContent=c[e].storageSummaryFootnote),FI&&(FI.textContent=c[e].storageSummaryEmpty),Wp){const f=c[e].storagePersistenceHeading||c.en?.storagePersistenceHeading||Wp.textContent;Wp.textContent=f;const w=c[e].storagePersistenceHeadingHelp||c.en?.storagePersistenceHeadingHelp||f;Wp.setAttribute("data-help",w)}if(DS&&(DS.textContent=c[e].storagePersistenceIntro||c.en?.storagePersistenceIntro||DS.textContent),gs){const f=c[e].storagePersistenceRequest||c.en?.storagePersistenceRequest||gs.textContent;je(gs,f,ICON_GLYPHS.save),gs.dataset.defaultLabel=f;const w=c[e].storagePersistenceRequestHelp||c.en?.storagePersistenceRequestHelp||f;gs.setAttribute("data-help",w),gs.setAttribute("title",w),gs.setAttribute("aria-label",w)}if(Kp){const f=c[e].storagePersistenceStatusIdle||c.en?.storagePersistenceStatusIdle||Kp.textContent;Kp.textContent=f,Kp.setAttribute("data-help",f)}if(gt("renderStoragePersistenceStatus",[],{defer:!0}),Yp){const f=c[e].storageActionsHeading||c.en?.storageActionsHeading||Yp.textContent;Yp.textContent=f;const w=c[e].storageActionsHeadingHelp||c.en?.storageActionsHeadingHelp||f;Yp.setAttribute("data-help",w)}if(_S&&(_S.textContent=c[e].storageActionsIntro||c.en?.storageActionsIntro||_S.textContent),wu){const f=c[e].storageBackupNow||c.en?.storageBackupNow||wu.textContent;je(wu,f,ICON_GLYPHS.fileExport);const w=c[e].storageBackupNowHelp||c.en?.storageBackupNowHelp||f;wu.setAttribute("data-help",w),wu.setAttribute("title",w)}if(ks){const f=c[e].storageOpenBackupTab||c.en?.storageOpenBackupTab||ks.textContent;je(ks,f,ICON_GLYPHS.settingsBackup);const w=c[e].storageOpenBackupTabHelp||c.en?.storageOpenBackupTabHelp||f;ks.setAttribute("data-help",w),ks.setAttribute("title",w)}if(Qp){const f=c[e].storageStatusHeading||c.en?.storageStatusHeading||Qp.textContent;Qp.textContent=f;const w=c[e].storageStatusHeadingHelp||c.en?.storageStatusHeadingHelp||f;Qp.setAttribute("data-help",w)}FS&&(FS.textContent=c[e].storageStatusLastProjectLabel||c.en?.storageStatusLastProjectLabel||FS.textContent),NS&&(NS.textContent=c[e].storageStatusLastAutoBackupLabel||c.en?.storageStatusLastAutoBackupLabel||NS.textContent),HS&&(HS.textContent=c[e].storageStatusLastFullBackupLabel||c.en?.storageStatusLastFullBackupLabel||HS.textContent);const Ur=c[e].storageStatusNever||c.en?.storageStatusNever||(Xp?Xp.textContent:"");if(Xp&&(Xp.textContent=Ur),HI&&(HI.textContent=Ur),jI&&(jI.textContent=Ur),Lu&&(Lu.textContent="",Lu.setAttribute("hidden",""),Lu.classList.remove("storage-status-reminder--warning","storage-status-reminder--ok"),Lu.removeAttribute("data-help")),jS){const f=c[e].loggingSectionHelp||c[e].loggingHeadingHelp||c.en?.loggingHeadingHelp||"";f?jS.setAttribute("data-help",f):jS.removeAttribute("data-help")}if(Zp){const f=c[e].loggingHeading||c.en?.loggingHeading||Zp.textContent||"Diagnostics log";Zp.textContent=f;const w=c[e].loggingHeadingHelp||c.en?.loggingHeadingHelp||f;Zp.setAttribute("data-help",w)}if(zS&&(zS.textContent=c[e].loggingIntro||c.en?.loggingIntro||zS.textContent),Jp){const f=c[e].loggingLevelFilterLabel||c.en?.loggingLevelFilterLabel||Jp.textContent;Jp.textContent=f,Jp.setAttribute("data-help",f)}if(em){const f={all:c[e].loggingLevelFilterAll||c.en?.loggingLevelFilterAll||"All levels",info:c[e].loggingLevelFilterInfo||c.en?.loggingLevelFilterInfo||"Info and above",warn:c[e].loggingLevelFilterWarn||c.en?.loggingLevelFilterWarn||"Warnings and errors",error:c[e].loggingLevelFilterError||c.en?.loggingLevelFilterError||"Errors only"};Array.from(em.options||[]).forEach(le=>{if(!le||typeof le.value!="string")return;const Pe=le.value;Object.prototype.hasOwnProperty.call(f,Pe)&&(le.textContent=f[Pe])});const w=c[e].loggingLevelFilterHelp||c.en?.loggingLevelFilterHelp||"";w?em.setAttribute("data-help",w):em.removeAttribute("data-help")}if(Ru){const f=c[e].loggingNamespaceFilterLabel||c.en?.loggingNamespaceFilterLabel||Ru.textContent;Ru.textContent=f}if(US){const f=c[e].loggingNamespaceFilterPlaceholder||c.en?.loggingNamespaceFilterPlaceholder||"";f&&US.setAttribute("placeholder",f);const w=c[e].loggingNamespaceFilterHelp||c.en?.loggingNamespaceFilterHelp||f;w&&(US.setAttribute("data-help",w),Ru&&Ru.setAttribute("data-help",w)),tm&&(tm.textContent=w,w?tm.removeAttribute("hidden"):tm.setAttribute("hidden",""))}if($S){const f=c[e].loggingHistoryLimitLabel||c.en?.loggingHistoryLimitLabel||$S.textContent;$S.textContent=f}if(qS){const f=c[e].loggingHistoryLimitHelp||c.en?.loggingHistoryLimitHelp||qS.textContent;qS.textContent=f}if(rm){const f=c[e].loggingHistoryLimitHelp||c.en?.loggingHistoryLimitHelp||"";f?rm.setAttribute("data-help",f):rm.removeAttribute("data-help");const w=c[e].loggingHistoryLimitAria||c.en?.loggingHistoryLimitAria||"";w&&rm.setAttribute("aria-label",w)}if(VS){const f=c[e].loggingConsoleOutputLabel||c.en?.loggingConsoleOutputLabel||VS.textContent;VS.textContent=f}if(WS){const f=c[e].loggingConsoleOutputHelp||c.en?.loggingConsoleOutputHelp||WS.textContent;WS.textContent=f}if(KS){const f=c[e].loggingCaptureConsoleLabel||c.en?.loggingCaptureConsoleLabel||KS.textContent;KS.textContent=f}if(YS){const f=c[e].loggingCaptureConsoleHelp||c.en?.loggingCaptureConsoleHelp||YS.textContent;YS.textContent=f}if(QS){const f=c[e].loggingCaptureErrorsLabel||c.en?.loggingCaptureErrorsLabel||QS.textContent;QS.textContent=f}if(XS){const f=c[e].loggingCaptureErrorsHelp||c.en?.loggingCaptureErrorsHelp||XS.textContent;XS.textContent=f}if(ZS){const f=c[e].loggingPersistSessionLabel||c.en?.loggingPersistSessionLabel||ZS.textContent;ZS.textContent=f}if(JS){const f=c[e].loggingPersistSessionHelp||c.en?.loggingPersistSessionHelp||JS.textContent;JS.textContent=f}if(Pl){const f=c[e].loggingExportButton||c.en?.loggingExportButton||Pl.textContent;je(Pl,f,ICON_GLYPHS.fileExport),Pl.setAttribute("data-help",f),Pl.setAttribute("title",f),Pl.setAttribute("aria-label",f)}if(om){const f=c[e].loggingExportHelp||c.en?.loggingExportHelp||om.textContent;om.textContent=f,om.setAttribute("data-help",f)}if(ev){const f=c[e].loggingStatusIdle||c.en?.loggingStatusIdle||"";ev.textContent=f,f&&ev.setAttribute("data-help",f)}if(nm){const f=c[e].loggingEmptyState||c.en?.loggingEmptyState||nm.textContent;nm.textContent=f,f&&nm.setAttribute("data-help",f)}tv&&(tv.textContent=c[e].loggingUnavailable||c.en?.loggingUnavailable||tv.textContent);const Ft=document.getElementById("settingsShowAutoBackupsLabel");if(Ft){Ft.textContent=c[e].showAutoBackupsSetting;const f=c[e].showAutoBackupsHelp||c[e].showAutoBackupsSetting;Ft.setAttribute("data-help",f),te&&(te.setAttribute("data-help",f),te.setAttribute("aria-label",c[e].showAutoBackupsSetting))}if(k){const f=c[e].versionCompareButton||"Compare versions";je(k,f,ICON_GLYPHS.note);const w=c[e].versionCompareButtonHelp||f;k.setAttribute("data-help",w),k.setAttribute("title",w)}if(Z&&(Z.textContent=c[e].versionCompareHeading||"Version comparison"),ue&&(ue.textContent=c[e].versionCompareIntro||""),H){const f=c[e].versionComparePrimaryLabel||"Baseline version";H.textContent=f,Y&&Y.setAttribute("aria-label",f)}if(N){const f=c[e].versionCompareSecondaryLabel||"Comparison version";N.textContent=f,ae&&ae.setAttribute("aria-label",f)}if(de&&(de.textContent=c[e].versionCompareEmpty||"Save a project or wait for auto-backups to start comparing versions."),Q&&(Q.textContent=c[e].versionCompareNotesLabel||"Incident notes"),ne){const f=c[e].versionCompareNotesPlaceholder||"Record context, on-set observations, or required follow-up.";ne.placeholder=f}if(V){const f=c[e].versionCompareExport||"Export log";je(V,f,ICON_GLYPHS.fileExport);const w=c[e].versionCompareExportHelp||f;V.setAttribute("data-help",w),V.setAttribute("title",w)}if(fe){const f=c[e].versionCompareClose||c[e].cancelSettings||"Close";je(fe,f,ICON_GLYPHS.circleX)}if(oe){const f=c[e].backupSettings;je(oe,f,ICON_GLYPHS.fileExport);const w=c[e].backupSettingsHelp||f;oe.setAttribute("data-help",w),oe.setAttribute("title",w),oe.setAttribute("aria-label",w)}if(restoreSettings){const f=c[e].restoreSettings;je(restoreSettings,f,ICON_GLYPHS.fileImport);const w=c[e].restoreSettingsHelp||f;restoreSettings.setAttribute("data-help",w),restoreSettings.setAttribute("title",w),restoreSettings.setAttribute("aria-label",w)}if(J){const f=c[e].restoreRehearsalButton||"Restore rehearsal";je(J,f,ICON_GLYPHS.load);const w=c[e].restoreRehearsalButtonHelp||f;J.setAttribute("data-help",w),J.setAttribute("title",w),J.setAttribute("aria-label",w)}if(Ae&&(Ae.textContent=c[e].restoreRehearsalHeading||Ae.textContent),Le&&(Le.textContent=c[e].restoreRehearsalIntro||Le.textContent),_e&&(_e.textContent=c[e].restoreRehearsalModeLabel||_e.textContent),Je&&(Je.textContent=c[e].restoreRehearsalModeBackup||Je.textContent),xe&&(xe.textContent=c[e].restoreRehearsalModeProject||xe.textContent),Ze&&(Ze.textContent=c[e].restoreRehearsalFileLabel||Ze.textContent),Ve){const f=c[e].restoreRehearsalFileButton||"Choose file";je(Ve,f,ICON_GLYPHS.fileImport),Ve.setAttribute("data-help",f),Ve.setAttribute("title",f),Ve.setAttribute("aria-label",f)}Dt&&(Dt.textContent=c[e].restoreRehearsalNoFile||Dt.textContent),We&&(We.textContent=c[e].restoreRehearsalReady||""),ft&&(ft.textContent=c[e].restoreRehearsalRuleHeading||c.en?.restoreRehearsalRuleHeading||ft.textContent),D&&(D.textContent=c[e].restoreRehearsalRuleIntro||c.en?.restoreRehearsalRuleIntro||D.textContent),q&&(q.textContent=c[e].restoreRehearsalRuleEmpty||c.en?.restoreRehearsalRuleEmpty||q.textContent),we&&(we.textContent=c[e].restoreRehearsalTableCaption||we.textContent),ve&&(ve.textContent=c[e].restoreRehearsalMetricColumn||ve.textContent),Se&&(Se.textContent=c[e].restoreRehearsalLiveColumn||Se.textContent),he&&(he.textContent=c[e].restoreRehearsalSandboxColumn||he.textContent),ge&&(ge.textContent=c[e].restoreRehearsalDifferenceColumn||ge.textContent);const Zr=typeof pe<"u"?pe:z("restoreRehearsalCloseButton","restoreRehearsalClose");if(Zr){const f=c[e].restoreRehearsalClose||c[e].cancelSettings||"Close";je(Zr,f,ICON_GLYPHS.circleX),Zr.setAttribute("title",f),Zr.setAttribute("aria-label",f)}if(ze){const f=c[e].restoreRehearsalProceed||c.en?.restoreRehearsalProceed||"Resume restore rehearsal",w=c[e].restoreRehearsalProceedHelp||c.en?.restoreRehearsalProceedHelp||f;je(ze,f,ICON_GLYPHS.check),ze.setAttribute("data-help",w),ze.setAttribute("title",w),ze.setAttribute("aria-label",w)}if(ke){const f=c[e].restoreRehearsalAbort||c.en?.restoreRehearsalAbort||"Abort rehearsal",w=c[e].restoreRehearsalAbortHelp||c.en?.restoreRehearsalAbortHelp||f;je(ke,f,ICON_GLYPHS.circleX),ke.setAttribute("data-help",w),ke.setAttribute("title",w),ke.setAttribute("aria-label",w)}if(factoryResetButton){const f=c[e].factoryResetButton||"Factory reset",w=c[e].factoryResetButtonHelp||f;je(factoryResetButton,f,ICON_GLYPHS.reload),factoryResetButton.setAttribute("data-help",w),factoryResetButton.setAttribute("title",w),factoryResetButton.setAttribute("aria-label",w)}const Rr=document.getElementById("aboutHeading");Rr&&(Rr.textContent=c[e].aboutHeading,Rr.setAttribute("data-help",c[e].aboutHeadingHelp||c[e].aboutHeading));const fo=typeof document<"u"?document.getElementById("aboutVersion"):null;fo&&(fo.textContent=`${c[e].versionLabel} ${R0} `);const lo=[{id:"supportLink",textKey:"supportLink",helpKey:"supportLinkHelp"},{id:"reportBugLink",textKey:"reportBugLink",helpKey:"reportBugLinkHelp"},{id:"suggestFeatureLink",textKey:"suggestFeatureLink",helpKey:"suggestFeatureLinkHelp"}],Mr=c&&c[e]||{},co=c&&c.en||{};if(lo.forEach(f=>{const w=typeof document<"u"?document.getElementById(f.id):null;if(!w)return;const le=typeof Mr[f.textKey]=="string"&&Mr[f.textKey]||typeof co[f.textKey]=="string"&&co[f.textKey]||w.textContent;w.textContent=le;const Pe=typeof Mr[f.helpKey]=="string"&&Mr[f.helpKey]||typeof co[f.helpKey]=="string"&&co[f.helpKey]||le;w.setAttribute("data-help",Pe),w.setAttribute("title",Pe),w.setAttribute("aria-label",Pe)}),settingsSave){const f=c[e].saveSettings||c.en?.saveSettings||settingsSave.textContent;je(settingsSave,f);const w=c[e].saveSettingsHelp||c[e].saveSettings||f;settingsSave.setAttribute("data-help",w),settingsSave.setAttribute("title",w),settingsSave.setAttribute("aria-label",w)}if(settingsCancel){const f=c[e].cancelSettings||c.en?.cancelSettings||settingsCancel.textContent;je(settingsCancel,f,ICON_GLYPHS.circleX);const w=c[e].cancelSettingsHelp||c[e].cancelSettings||f;settingsCancel.setAttribute("data-help",w),settingsCancel.setAttribute("title",w),settingsCancel.setAttribute("aria-label",w)}const $r=document.getElementById("menuToggle");if($r){const f=c[e].menuToggleLabel||c.en?.menuToggleLabel||$r.getAttribute("aria-label")||"Menu",w=c[e].sideMenuClose||c.en?.sideMenuClose||$r.dataset.closeLabel||"Close menu",le=c[e].sideMenuCloseHelp||w;$r.setAttribute("title",f),$r.setAttribute("aria-label",f);const Pe=c[e].menuToggleHelp||f;$r.setAttribute("data-help",Pe),$r.dataset.menuLabel=f,$r.dataset.menuHelp=Pe,$r.dataset.closeLabel=w,$r.dataset.closeHelp=le}const et=document.getElementById("sideMenu");if(et){const f=c[e].sideMenuHelp;f?et.setAttribute("data-help",f):et.removeAttribute("data-help")}const pt=document.getElementById("sideMenuTitle");if(pt){const f=c[e].sideMenuTitle||c.en?.sideMenuTitle||pt.textContent;pt.textContent=f;const w=c[e].sideMenuTitleHelp||c[e].sideMenuHelp||f;pt.setAttribute("data-help",w)}const dt=document.getElementById("closeMenuButton"),Br=document.getElementById("closeMenuLabel");if(dt){const f=c[e].sideMenuClose||c.en?.sideMenuClose||dt.getAttribute("aria-label")||"Close menu",w=c[e].sideMenuCloseHelp||f;dt.setAttribute("aria-label",f),dt.setAttribute("title",w),dt.setAttribute("data-help",w),Br&&(Br.textContent=f)}if(typeof window<"u"&&(window.openSideMenu=EC),ia){const f=c[e].reloadAppLabel,w=c[e].reloadAppHelp||f,le=c[e].reloadAppOfflineNotice||f;ia.setAttribute("title",f),ia.setAttribute("aria-label",f),ia.setAttribute("data-help",w),ia.dataset&&(ia.dataset.onlineTitle=f,ia.dataset.onlineHelp=w,ia.dataset.offlineNotice=le),ia.hasAttribute("aria-disabled")&&(ia.setAttribute("title",le),ia.setAttribute("data-help",le))}if(featureSearch&&(featureSearch.setAttribute("placeholder",c[e].featureSearchPlaceholder),featureSearch.setAttribute("aria-label",c[e].featureSearchLabel),featureSearch.setAttribute("data-help",c[e].featureSearchHelp||c[e].featureSearchLabel)),Mi){Mi.setAttribute("title",c[e].helpButtonTitle||c[e].helpButtonLabel),Mi.setAttribute("aria-label",c[e].helpButtonLabel),Mi.setAttribute("data-help",c[e].helpButtonHelp||c[e].helpButtonTitle||c[e].helpButtonLabel);const f=c[e].helpButtonShortcuts;typeof f=="string"&&f.trim()?Mi.setAttribute("data-shortcuts",f):Mi.removeAttribute("data-shortcuts");const w=c[e].helpButtonAriaShortcuts||"F1 Control+Slash Meta+Slash Shift+Slash KeyH";typeof w=="string"&&w.trim()?Mi.setAttribute("aria-keyshortcuts",w):Mi.removeAttribute("aria-keyshortcuts"),Dp&&(je(Dp,c[e].hoverHelpButtonLabel,ICON_GLYPHS.note),Dp.setAttribute("aria-label",c[e].hoverHelpButtonLabel),Dp.setAttribute("data-help",c[e].hoverHelpButtonHelp||c[e].hoverHelpButtonLabel)),xp&&(xp.setAttribute("placeholder",c[e].helpSearchPlaceholder),xp.setAttribute("aria-label",c[e].helpSearchLabel),xp.setAttribute("data-help",c[e].helpSearchHelp||c[e].helpSearchLabel)),Mp&&(Mp.setAttribute("title",c[e].helpSearchClear),Mp.setAttribute("aria-label",c[e].helpSearchClear),Mp.setAttribute("data-help",c[e].helpSearchClearHelp||c[e].helpSearchClear)),pu&&(je(pu,c[e].helpClose,ICON_GLYPHS.circleX),pu.setAttribute("title",c[e].helpClose),pu.setAttribute("aria-label",c[e].helpClose),pu.setAttribute("data-help",c[e].helpCloseHelp||c[e].helpClose)),document.getElementById("helpTitle")&&(document.getElementById("helpTitle").textContent=c[e].helpTitle),vI&&I(vI,"helpNoResults","No help topics match your search. Try shorter keywords, synonyms or clear the field to browse everything."),AI&&I(AI,"helpNoResultsSuggestionsHeading","Need a different result?"),EI&&I(EI,"helpNoResultsSuggestionsIntro","Try these steps to get back on track while keeping your data safe:");const le=l&&l.querySelector?l.querySelector("#helpQuickStartGuide h4"):null;if(le){const Xt=le.textContent||"Quick start checklist";I(le,"helpQuickStartChecklistTitle",Xt)}const Pe=l?l.getElementById("helpOnboardingTutorialCopy"):null;if(Pe){const Xt=Pe.textContent||"to walk through every workflow before configuring your first project.";I(Pe,"helpOnboardingTutorialCopy",Xt)}const st=l&&l.querySelector?l.querySelector("#helpDataSafety h4"):null;if(st){const Xt=st.textContent||"Protect your work";I(st,"helpDataSafetyTitle",Xt)}const At=l?l.getElementById("helpRestoreDrillHeading"):null;if(At){const Xt=At.textContent||"Restore rehearsal drill";I(At,"helpRestoreDrillTitle",Xt)}const qt=l?l.getElementById("helpRestoreDrillNote"):null;if(qt){const Xt=qt.textContent||"Record the filename, timestamp and verification results in your backup log before closing the rehearsal so every drill leaves behind a documented recovery point.";I(qt,"helpRestoreDrillNote",Xt)}if(Zh){const Xt=Zh.textContent||"Monthly data health check";I(Zh,"helpDataAuditTitle",Xt)}if(R(PV,"helpDataAuditStep1",[()=>L("#settingsButton",E("settingsButton")||"Settings",{target:"#settingsButton"}),()=>L("#dataHeading",E("dataHeading")||"Data & Storage",{target:"#dataHeading",highlight:"#settingsDialog"}),()=>L("#storageBackupNow",E("storageBackupNow")||"Download full backup",{target:"#storageBackupNow",highlight:"#storageActions"}),()=>L("#storageActionsHeading",E("storageActionsHeading")||"Quick safeguards",{target:"#storageActionsHeading",highlight:"#storageActions",isButton:!1})]),R(xV,"helpDataAuditStep2",[()=>L("#shareSetupBtn",E("shareSetupBtn")||"Export Project",{target:"#shareSetupBtn",highlight:"#setup-manager"})]),R(MV,"helpDataAuditStep3",[()=>L("#reloadButton",E("reloadAppLabel")||"Force reload",{target:"#reloadButton"}),()=>L("#offlineIndicator",E("offlineIndicator")||"Offline",{target:"#offlineIndicator"}),()=>L("#applySharedLinkBtn",E("loadSharedLinkBtn")||"Import Project",{target:"#applySharedLinkBtn",highlight:"#setup-manager"})]),R(DV,"helpDataAuditStep4",[()=>L("#restoreRehearsalButton",E("restoreRehearsalButton")||"Restore rehearsal",{target:"#restoreRehearsalButton",highlight:"#restoreRehearsalSection"}),()=>{const Xt=l.createElement("code");return Xt.textContent="window.cineRuntime.verifyCriticalFlows({ warnOnFailure: true })",Xt}]),Jh){const Xt=Jh.textContent||"Log the results in your backup rotation checklist so you always know which copies were verified offline.";I(Jh,"helpDataAuditNote",Xt)}R(OV,"helpNoResultsSuggestionClear",[()=>L("#helpSearchClear",E("helpSearchClear")||"Clear search",{target:"#helpSearchClear",highlight:"#helpSearchContainer"})]),G(GV,"helpNoResultsSuggestionSynonyms"),R(kV,"helpNoResultsSuggestionQuickStart",[()=>L("#helpQuickStartGuide",E("helpQuickStartChecklistTitle")||"Quick start checklist",{target:"#helpQuickStartGuide",highlight:"#helpQuickStartGuide"})]),R(BV,"helpNoResultsSuggestionBackup",[()=>L("#helpDataSafety",E("helpDataSafetyTitle")||"Protect your work",{target:"#helpDataSafety",highlight:"#helpDataSafety"}),()=>L("#helpRestoreDrillHeading",E("helpRestoreDrillTitle")||"Restore rehearsal drill",{target:"#helpRestoreDrillHeading",highlight:"#helpDataSafety",isButton:!1})])}je(document.getElementById("generateOverviewBtn"),c[e].generateOverviewBtn,ICON_GLYPHS.overview),je(document.getElementById("generateGearListBtn"),c[e].generateGearListBtn,ICON_GLYPHS.gearList),je(document.getElementById("shareSetupBtn"),c[e].shareSetupBtn,ICON_GLYPHS.fileExport);const Do=document.getElementById("exportAndRevertBtn");Do&&(je(Do,c[e].exportAndRevertBtn,ICON_GLYPHS.reload),Do.setAttribute("data-help",c[e].exportAndRevertBtnHelp));const Vo=typeof downloadDiagramBtn<"u"&&downloadDiagramBtn||(typeof document<"u"&&document&&typeof document.getElementById=="function"?document.getElementById("downloadDiagram"):null);if(Vo&&(Vo.textContent=c[e].downloadDiagramBtn,Vo.setAttribute("title",c[e].downloadDiagramBtn),Vo.setAttribute("aria-label",c[e].downloadDiagramBtn),Vo.setAttribute("data-help",c[e].downloadDiagramHelp)),gridSnapToggleBtn){je(gridSnapToggleBtn,c[e].gridSnapToggle,ICON_GLYPHS.magnet),gridSnapToggleBtn.setAttribute("title",c[e].gridSnapToggle),gridSnapToggleBtn.setAttribute("aria-label",c[e].gridSnapToggle),gridSnapToggleBtn.setAttribute("data-help",c[e].gridSnapToggleHelp);let f=!1;try{f=!!bB()}catch{try{f=!!gridSnap}catch{}}gridSnapToggleBtn.setAttribute("aria-pressed",f?"true":"false")}const Fr=typeof document<"u"?document.getElementById("resetView"):null;Fr&&(je(Fr,c[e].resetViewBtn,ICON_GLYPHS.resetView),Fr.setAttribute("title",c[e].resetViewBtn),Fr.setAttribute("aria-label",c[e].resetViewBtn),Fr.setAttribute("data-help",c[e].resetViewHelp));const to=typeof document<"u"?document.getElementById("zoomIn"):null;to&&(je(to,"",ICON_GLYPHS.add),to.setAttribute("title",c[e].zoomInLabel),to.setAttribute("aria-label",c[e].zoomInLabel),to.setAttribute("data-help",c[e].zoomInHelp));const Wo=typeof document<"u"?document.getElementById("zoomOut"):null;Wo&&(je(Wo,"",ICON_GLYPHS.minus),Wo.setAttribute("title",c[e].zoomOutLabel),Wo.setAttribute("aria-label",c[e].zoomOutLabel),Wo.setAttribute("data-help",c[e].zoomOutHelp));const Yc=typeof document<"u"?document.getElementById("diagramHint"):null;Yc&&(Yc.textContent=c[e].diagramMoveHint);const dr=c.en&&c.en.projectForm?c.en.projectForm:{},jt=c[e].projectForm||dr;if(jt){Ia();const f=(Ye,mt)=>{if(!Ye)return;const An=jt[mt]||dr[mt];An&&(Ye.textContent=An)},w=(Ye,mt)=>{if(!Ye)return;const An=jt[mt]||dr[mt];An&&Ye.setAttribute("placeholder",An)},le=(Ye,mt)=>{if(!Ye)return;const An=jt[mt]||dr[mt];An&&(Ye.textContent=An)};if(f(y$,"heading"),f(b$,"projectName"),f(h$,"productionCompany"),f(S$,"productionCompanyAddress"),f(v$,"productionCompanyStreet"),f(A$,"productionCompanyStreet2"),f(E$,"productionCompanyCity"),f(C$,"productionCompanyRegion"),f(w$,"productionCompanyPostalCode"),f(L$,"productionCompanyCountry"),w(R$,"productionCompanyStreetPlaceholder"),w(I$,"productionCompanyStreet2Placeholder"),w(T$,"productionCompanyCityPlaceholder"),w(O$,"productionCompanyRegionPlaceholder"),w(G$,"productionCompanyPostalCodePlaceholder"),w(k$,"productionCompanyCountryPlaceholder"),f(B$,"rentalHouse"),f(P$,"crewHeading"),UR){const Ye=jt.crewHeading||dr.crewHeading;Ye&&(UR.textContent=`${Ye}: `)}if(f(x$,"prepLabel"),f(M$,"shootLabel"),f(D$,"returnLabel"),f(_$,"deliveryResolution"),f(F$,"recordingResolution"),f(q$,"sensorMode"),f(V$,"aspectRatio"),f(W$,"codec"),f(K$,"baseFrameRate"),f(N$,"recordingFrameRate"),ii){const Ye=jt.recordingFrameRateRangeHint||dr.recordingFrameRateRangeHint||"",mt=jt.recordingFrameRateDefaultHint||dr.recordingFrameRateDefaultHint||"";Ye?ii.setAttribute("data-range-template",Ye):ii.removeAttribute("data-range-template"),mt?(ii.setAttribute("data-default-message",mt),ii.textContent=mt,ii.hidden=!1):(ii.removeAttribute("data-default-message"),ii.textContent="",ii.hidden=!0)}if($R){const Ye=jt.slowMotionHeading||dr.slowMotionHeading;Ye&&($R.textContent=Ye)}if(f(H$,"slowMotionRecordingResolution"),f(j$,"slowMotionSensorMode"),f(z$,"slowMotionAspectRatio"),f(U$,"slowMotionBaseFrameRate"),f($$,"slowMotionRecordingFrameRate"),si){const Ye=jt.slowMotionRecordingFrameRateRangeHint||dr.slowMotionRecordingFrameRateRangeHint||"",mt=jt.slowMotionRecordingFrameRateDefaultHint||dr.slowMotionRecordingFrameRateDefaultHint||"";Ye?si.setAttribute("data-range-template",Ye):si.removeAttribute("data-range-template"),mt?(si.setAttribute("data-default-message",mt),si.textContent=mt,si.hidden=!1):(si.removeAttribute("data-default-message"),si.textContent="",si.hidden=!0)}if(f(J$,"lensesHeading"),f(Y$,"lensManufacturerStep"),f(X$,"lensSeriesStep"),f(eq,"lensesLabel"),f(tq,"lensSelectionsLabel"),f(rq,"lensSelectionsHint"),le(Q$,"lensManufacturerPlaceholder"),le(Z$,"lensSeriesPlaceholder"),qR){const Ye=jt.lensSeriesEmpty||dr.lensSeriesEmpty;Ye&&(qR.textContent=Ye)}if(VR){const Ye=jt.lensOptionsEmpty||dr.lensOptionsEmpty;Ye&&(VR.textContent=Ye)}if(Oh){const Ye=jt.lensRemoveLabel||dr.lensRemoveLabel,mt=jt.lensMountLabel||dr.lensMountLabel;Ye&&Oh.setAttribute("data-remove-template",Ye),mt&&Oh.setAttribute("data-mount-label",mt)}if(lensSelectionManager&&typeof lensSelectionManager.refreshCatalog=="function")try{lensSelectionManager.refreshCatalog({preserveSelections:!0,skipEvent:!0,skipDirty:!0})}catch{}if(f(oq,"riggingHeading"),f(nq,"requiredScenarios"),oV(e),f(aq,"cameraHandle"),f(iq,"viewfinderExtension"),f(sq,"matteboxFilterHeading"),f(lq,"mattebox"),f(cq,"filter"),f(dA,"storageHeading"),f(fA,"storageNeedsLabel"),nV(jt,dr),ly(),f(uq,"monitoringHeading"),f(dq,"monitoringConfiguration"),f(fq,"viewfinderSettings"),f(pq,"frameGuides"),f(mq,"aspectMaskOpacity"),f(gq,"videoDistribution"),f(yq,"monitorUserButtons"),f(bq,"cameraUserButtons"),f(hq,"viewfinderUserButtons"),f(p$,"tripodPreferencesHeading"),f(Sq,"tripodHeadBrand"),f(vq,"tripodBowl"),f(Aq,"tripodTypes"),f(Eq,"tripodSpreader"),bp&&bp.options.length>=2){const Ye=jt.viewfinderExtensionNone||dr.viewfinderExtensionNone,mt=jt.viewfinderExtensionYes||dr.viewfinderExtensionYes;Ye&&(bp.options[0].textContent=Ye),mt&&(bp.options[1].textContent=mt)}const Pe=typeof document<"u"?document.getElementById("projectCancel"):null,st=jt.cancel||dr.cancel||(Pe?Pe.textContent:bl?.getAttribute("aria-label"))||"Cancel";if(Pe&&je(Pe,st,ICON_GLYPHS.circleX),bl&&(bl.innerHTML=wa(ICON_GLYPHS.circleX,"btn-icon"),bl.setAttribute("aria-label",st),bl.setAttribute("title",st),bl.setAttribute("data-help",st)),Gh){const Ye=jt.submit||dr.submit;Ye&&(je(Gh,Ye,ICON_GLYPHS.check),Gh.setAttribute("aria-label",Ye))}const At={name:jt.crewNamePlaceholder||dr.crewNamePlaceholder,phone:jt.crewPhonePlaceholder||dr.crewPhonePlaceholder,email:jt.crewEmailPlaceholder||dr.crewEmailPlaceholder,website:jt.crewWebsitePlaceholder||dr.crewWebsitePlaceholder},qt=c[e].crewRoles||c.en&&c.en.crewRoles||{},Xt=c.en?.contacts||{},Ne=c[e]?.contacts||Xt;if(Ug&&Ne.heading&&(Ug.textContent=Ne.heading),$g&&Ne.description&&($g.textContent=Ne.description),qg&&Ne.addContactButton&&(qg.textContent=Ne.addContactButton),Vs&&Ne.addContactButton&&(Vs.setAttribute("aria-label",Ne.addContactButton),Vs.setAttribute("data-help",Ne.addContactButton)),Vg&&Ne.importButton&&(Vg.textContent=Ne.importButton),Ws&&Ne.importButton&&(Ws.setAttribute("aria-label",Ne.importButton),Ws.setAttribute("data-help",Ne.importButton)),Wg&&Ne.importHint&&(Wg.textContent=Ne.importHint),Xi&&Ne.emptyState&&(Xi.textContent=Ne.emptyState),Yg&&Ne.userProfileHeading&&(Yg.textContent=Ne.userProfileHeading),Qg&&Ne.userProfileDescription&&(Qg.textContent=Ne.userProfileDescription),Xg&&Ne.userProfileNameLabel&&(Xg.textContent=Ne.userProfileNameLabel),no&&Ne.userProfileNamePlaceholder&&no.setAttribute("placeholder",Ne.userProfileNamePlaceholder),Zg&&Ne.userProfileRoleLabel&&(Zg.textContent=Ne.userProfileRoleLabel),Tr){const Ye=ur?.getUserProfileSnapshot?ur.getUserProfileSnapshot():{role:""};VB({selected:Ye.role||""})}Jg&&Ne.userProfilePhoneLabel&&(Jg.textContent=Ne.userProfilePhoneLabel),go&&Ne.userProfilePhonePlaceholder&&go.setAttribute("placeholder",Ne.userProfilePhonePlaceholder),ey&&Ne.userProfileEmailLabel&&(ey.textContent=Ne.userProfileEmailLabel),yo&&Ne.userProfileEmailPlaceholder&&yo.setAttribute("placeholder",Ne.userProfileEmailPlaceholder),ty&&Ne.userProfileHint&&(ty.textContent=Ne.userProfileHint),ry&&Ne.userProfileAvatarButton&&(ry.textContent=Ne.userProfileAvatarButton),ma&&Ne.userProfileAvatarButton&&(ma.setAttribute("aria-label",Ne.userProfileAvatarButton),ma.removeAttribute("data-help"),ma.removeAttribute("title")),Qa&&Ne.userProfileAvatarRemove&&(Qa.textContent=Ne.userProfileAvatarRemove,Qa.setAttribute("aria-label",Ne.userProfileAvatarRemove)),oy&&Ne.avatarOptionsTitle&&(oy.textContent=Ne.avatarOptionsTitle),ny&&Ne.avatarOptionsDescription&&(ny.textContent=Ne.avatarOptionsDescription),ay&&Ne.avatarOptionsClose&&(ay.textContent=Ne.avatarOptionsClose),Ds&&Ne.avatarOptionsClose&&(Ds.setAttribute("aria-label",Ne.avatarOptionsClose),Ds.setAttribute("title",Ne.avatarOptionsClose),Ds.setAttribute("data-help",Ne.avatarOptionsClose)),Ts&&Ne.avatarDelete&&(je(Ts,Ne.avatarDelete,ICON_GLYPHS.trash),Ts.setAttribute("aria-label",Ne.avatarDelete),Ts.setAttribute("title",Ne.avatarDelete),Ts.setAttribute("data-help",Ne.avatarDelete)),iy&&Ne.avatarEditZoomLabel&&(iy.textContent=Ne.avatarEditZoomLabel),rf&&Ne.close&&(rf.textContent=Ne.close),ls(),document.querySelectorAll("#crewContainer .person-row").forEach(Ye=>{const mt=Ye.querySelector("select");if(mt){const Ie=mt.value;Array.from(mt.options).forEach(Ce=>{const Ge=Ce.value;Ce.textContent=qt[Ge]||Ge}),mt.value=Ie}const An=Ye.querySelector(".person-name");An&&At.name&&(An.placeholder=At.name);const C=Ye.querySelector(".person-phone");C&&At.phone&&(C.placeholder=At.phone);const M=Ye.querySelector(".person-email");M&&At.email&&(M.placeholder=At.email);const B=Ye.querySelector(".person-website");B&&At.website&&(B.placeholder=At.website);const ee=Ye.querySelector(".person-contact-select");ee&&nb(ee,ee.value);const re=Ye.querySelector(".person-save-contact");re&&je(re,Ke("saveContact","Save to contacts"),ICON_GLYPHS.save);const ie=Ye.querySelector(".person-manage-contacts");ie&&je(ie,Ke("openManager","Open contacts"),ICON_GLYPHS.gears),ib(Ye)});const uo=Ye=>typeof Ye=="string"?Ye.replace(/[\s\u00a0]*[:：]\s*$/,""):Ye,Kr=jt.addEntry||dr.addEntry||"Add";if(Ul){const Ye=uo(jt.crewHeading||dr.crewHeading||"Crew"),mt=`${Kr} ${Ye} `.trim();je(Ul,mt,ICON_GLYPHS.add),Ul.setAttribute("aria-label",mt),Ul.setAttribute("data-help",mt)}if($l){const Ye=uo(jt.prepLabel||dr.prepLabel||"Prep"),mt=`${Kr} ${Ye} `.trim();je($l,mt,ICON_GLYPHS.add),$l.setAttribute("aria-label",mt),$l.setAttribute("data-help",mt)}if(ql){const Ye=uo(jt.shootLabel||dr.shootLabel||"Shoot"),mt=`${Kr} ${Ye} `.trim();je(ql,mt,ICON_GLYPHS.add),ql.setAttribute("aria-label",mt),ql.setAttribute("data-help",mt)}if(Vl){const Ye=uo(jt.returnLabel||dr.returnLabel||"Return Day"),mt=`${Kr} ${Ye} `.trim();je(Vl,mt,ICON_GLYPHS.add),Vl.setAttribute("aria-label",mt),Vl.setAttribute("data-help",mt)}}if(gd&&(gd.textContent=c[e].iosPwaHelpTitle),yd&&(yd.textContent=c[e].iosPwaHelpIntro),bd&&(bd.textContent=c[e].iosPwaHelpStep1),wI&&(wI.textContent=c[e].iosPwaHelpStep2),LI&&(LI.textContent=c[e].iosPwaHelpStep3),RI&&(RI.textContent=c[e].iosPwaHelpStep4),II&&(II.textContent=c[e].iosPwaHelpNote),yc){const f=c[e].iosPwaHelpClose;je(yc,f,ICON_GLYPHS.check),yc.setAttribute("aria-label",f)}document.querySelectorAll(".favorite-toggle").forEach(f=>{f.setAttribute("aria-label",c[e].favoriteToggleLabel),f.setAttribute("title",c[e].favoriteToggleLabel),f.setAttribute("data-help",c[e].favoriteToggleHelp||c[e].favoriteToggleLabel)}),ensureGearListActions(),updateDiagramLegend(),updateStorageSummary(),gt("populateFeatureSearch",[],{defer:!0})}var ol=document.getElementById("cameraSelect");typeof window<"u"&&(window.cameraSelect=ol);var o$=document.getElementById("monitorSelect");typeof window<"u"&&(window.monitorSelect=o$);var n$=document.getElementById("videoSelect");typeof window<"u"&&(window.videoSelect=n$);var a$=document.getElementById("videoDistribution");typeof window<"u"&&(window.videoDistributionSelect=a$);var i$=document.getElementById("cageSelect");typeof window<"u"&&(window.cageSelect=i$);var s$=[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")];typeof window<"u"&&(window.motorSelects=s$);var l$=[document.getElementById("controller1Select"),document.getElementById("controller2Select"),document.getElementById("controller3Select"),document.getElementById("controller4Select")];typeof window<"u"&&(window.controllerSelects=l$);var c$=document.getElementById("distanceSelect");typeof window<"u"&&(window.distanceSelect=c$);var qu=document.getElementById("batterySelect");typeof window<"u"&&(window.batterySelect=qu);var u$=document.getElementById("batteryHotswapSelect");typeof window<"u"&&(window.hotswapSelect=u$);var d$=document.getElementById("lenses");typeof window<"u"&&(window.lensSelect=d$);var zR=document.getElementById("requiredScenarios");document.getElementById("requiredScenariosSummary");var f$=zR?zR.querySelector('option[value="Remote Head"]'):null;typeof window<"u"&&(window.remoteHeadOption=f$);document.getElementById("tripodPreferencesSection");document.getElementById("tripodPreferencesRow");var p$=document.getElementById("tripodPreferencesHeading"),Da=document.getElementById("tripodHeadBrand");typeof window<"u"&&(window.tripodHeadBrandSelect=Da);var _a=document.getElementById("tripodBowl");typeof window<"u"&&(window.tripodBowlSelect=_a);var m$=document.getElementById("tripodTypes");typeof window<"u"&&(window.tripodTypesSelect=m$);var g$=document.getElementById("tripodSpreader");typeof window<"u"&&(window.tripodSpreaderSelect=g$);document.getElementById("monitoringConfiguration");document.getElementById("viewfinderSettingsRow");document.getElementById("viewfinderExtensionRow");const y$=document.getElementById("projectDialogHeading");var bl=document.getElementById("projectDialogClose");const b$=document.getElementById("projectNameLabel"),h$=document.getElementById("productionCompanyLabel"),S$=document.getElementById("productionCompanyAddressLabel"),v$=document.getElementById("productionCompanyStreetLabel"),A$=document.getElementById("productionCompanyStreet2Label"),E$=document.getElementById("productionCompanyCityLabel"),C$=document.getElementById("productionCompanyRegionLabel"),w$=document.getElementById("productionCompanyPostalCodeLabel"),L$=document.getElementById("productionCompanyCountryLabel"),R$=document.getElementById("productionCompanyStreet"),I$=document.getElementById("productionCompanyStreet2"),T$=document.getElementById("productionCompanyCity"),O$=document.getElementById("productionCompanyRegion"),G$=document.getElementById("productionCompanyPostalCode"),k$=document.getElementById("productionCompanyCountry"),B$=document.getElementById("rentalHouseLabel"),P$=document.getElementById("crewHeading"),UR=document.getElementById("crewLabel"),x$=document.getElementById("prepLabel"),M$=document.getElementById("shootLabel"),D$=document.getElementById("returnLabel"),_$=document.getElementById("deliveryResolutionLabel");document.getElementById("deliveryResolution");const F$=document.getElementById("recordingResolutionLabel"),N$=document.getElementById("recordingFrameRateLabel"),ii=document.getElementById("recordingFrameRateHint"),$R=document.getElementById("slowMotionFrameRateLegend"),H$=document.getElementById("slowMotionRecordingResolutionLabel"),j$=document.getElementById("slowMotionSensorModeLabel"),z$=document.getElementById("slowMotionAspectRatioLabel"),U$=document.getElementById("slowMotionBaseFrameRateLabel"),$$=document.getElementById("slowMotionRecordingFrameRateLabel"),si=document.getElementById("slowMotionRecordingFrameRateHint"),q$=document.getElementById("sensorModeLabel"),V$=document.getElementById("aspectRatioLabel"),W$=document.getElementById("codecLabel"),K$=document.getElementById("baseFrameRateLabel"),Y$=document.getElementById("lensManufacturerLabel"),Q$=document.getElementById("lensManufacturerPlaceholder"),X$=document.getElementById("lensSeriesLabel"),Z$=document.getElementById("lensSeriesPlaceholder"),qR=document.getElementById("lensSeriesEmpty"),VR=document.getElementById("lensOptionsEmpty"),J$=document.getElementById("lensesHeading"),eq=document.getElementById("lensesLabel"),tq=document.getElementById("lensSelectionsLabel"),rq=document.getElementById("lensSelectionsHint"),Oh=document.getElementById("lensSelectionChips"),oq=document.getElementById("riggingHeading"),nq=document.getElementById("requiredScenariosLabel"),aq=document.getElementById("cameraHandleLabel"),iq=document.getElementById("viewfinderExtensionLabel"),bp=document.getElementById("viewfinderExtension"),sq=document.getElementById("matteboxFilterHeading"),lq=document.getElementById("matteboxLabel"),cq=document.getElementById("filterLabel"),dA=document.getElementById("storageHeading"),fA=document.getElementById("storageNeedsLabel"),uq=document.getElementById("monitoringHeading"),dq=document.getElementById("monitoringConfigurationLabel"),fq=document.getElementById("viewfinderSettingsLabel"),pq=document.getElementById("frameGuidesLabel"),mq=document.getElementById("aspectMaskOpacityLabel"),gq=document.getElementById("videoDistributionLabel"),yq=document.getElementById("monitorUserButtonsLabel"),bq=document.getElementById("cameraUserButtonsLabel"),hq=document.getElementById("viewfinderUserButtonsLabel"),Sq=document.getElementById("tripodHeadBrandLabel"),vq=document.getElementById("tripodBowlLabel"),Aq=document.getElementById("tripodTypesLabel"),Eq=document.getElementById("tripodSpreaderLabel"),Gh=document.getElementById("projectSubmit");var Va=document.getElementById("crewContainer");const Ul=document.getElementById("addPersonBtn");var WR=document.getElementById("prepContainer");const $l=document.getElementById("addPrepBtn");var KR=document.getElementById("shootContainer");const ql=document.getElementById("addShootBtn");var YR=document.getElementById("returnContainer");const Vl=document.getElementById("addReturnBtn");var Rs=document.getElementById("storageNeedsContainer"),wn=null,pA=null,Ug=null,$g=null,Vs=null,qg=null,Ws=null,Vg=null,Is=null,Wg=null,di=null,Xi=null,rf=null,Kg=null,mA=null,QR=null,Yg=null,Qg=null,no=null,Xg=null,Tr=null,Zg=null,go=null,Jg=null,yo=null,ey=null,ty=null,Bc=null,ma=null,ry=null,In=null,Qa=null,So=null,cc=null,oy=null,ny=null,Ds=null,ay=null,Ts=null,Rt=null,Wa=null,XR=null,Pc=null,xc=null,iy=null,Jo=null,qe=null,kh=0,ad=null,gA=null,yA=null;function Ia(){typeof document>"u"||(wn=wn||document.getElementById("contactsDialog"),pA=pA||document.getElementById("contactsForm"),Ug=Ug||document.getElementById("contactsDialogHeading"),$g=$g||document.getElementById("contactsDialogDescription"),Vs=Vs||document.getElementById("contactsAddButton"),qg=qg||document.getElementById("contactsAddButtonLabel"),Ws=Ws||document.getElementById("contactsImportButton"),Vg=Vg||document.getElementById("contactsImportButtonLabel"),Is=Is||document.getElementById("contactsImportInput"),Wg=Wg||document.getElementById("contactsImportHint"),di=di||document.getElementById("contactsList"),Xi=Xi||document.getElementById("contactsEmptyState"),rf=rf||document.getElementById("contactsCloseButton"),Kg=Kg||document.getElementById("contactsAnnouncement"),mA=mA||document.getElementById("openContactsBtn"),QR=QR||document.getElementById("contactsUserProfile"),Yg=Yg||document.getElementById("contactsUserProfileHeading"),Qg=Qg||document.getElementById("contactsUserProfileDescription"),no=no||document.getElementById("userProfileName"),Xg=Xg||document.getElementById("userProfileNameLabel"),Tr=Tr||document.getElementById("userProfileRole"),Zg=Zg||document.getElementById("userProfileRoleLabel"),go=go||document.getElementById("userProfilePhone"),Jg=Jg||document.getElementById("userProfilePhoneLabel"),yo=yo||document.getElementById("userProfileEmail"),ey=ey||document.getElementById("userProfileEmailLabel"),ty=ty||document.getElementById("userProfileHint"),Bc=Bc||document.getElementById("userProfileAvatar"),ma=ma||document.getElementById("userProfileAvatarButton"),ry=ry||document.getElementById("userProfileAvatarButtonLabel"),In=In||document.getElementById("userProfileAvatarInput"),Qa=Qa||document.getElementById("userProfileAvatarClear"),So=So||document.getElementById("avatarOptionsDialog"),cc=cc||document.getElementById("avatarOptionsForm"),oy=oy||document.getElementById("avatarOptionsTitle"),ny=ny||document.getElementById("avatarOptionsDescription"),Ds=Ds||document.getElementById("avatarOptionsClose"),ay=ay||document.getElementById("avatarOptionsCloseLabel"),Rt=Rt||document.getElementById("avatarEditViewport"),Wa=Wa||document.getElementById("avatarEditImage"),XR=XR||document.getElementById("avatarPlaceholder"),Pc=Pc||document.getElementById("avatarControls"),xc=xc||document.getElementById("avatarEditZoom"),iy=iy||document.getElementById("avatarEditZoomLabel"),ad=ad||document.getElementById("avatarUploadInput"),Ts=Ts||document.getElementById("avatarDeleteButton"),gA=gA||document.getElementById("avatarSaveButton"),yA=yA||document.getElementById("avatarCancelButton"))}var Mc=["DoP","Steadicam Operator","Camera Operator","B-Camera Operator","Drone Operator","DIT","1st AC","2nd AC","Video Operator","Key Grip","Dolly Grip","Best Boy Grip","Rigging Grip","Grip","Key Gaffer","Gaffer","Rigging Gaffer","Best Boy Electric","Electrician","Director","Assistant Director","Producer","Production Manager","Production Assistant"];function qB(){return c?.[typeof rt=="string"?rt:"en"]?.crewRoles||c?.en?.crewRoles||{}}function VB(e={}){if(Ia(),!Tr)return;const t=Tr.ownerDocument||(typeof document<"u"?document:null);if(!t)return;const r=qB(),o=Ke("rolePlaceholder","Select role"),n=Ke("userProfileRolePlaceholder",o)||o,a=e&&typeof e.selected=="string"?e.selected:ur?.getUserProfileSnapshot?ur.getUserProfileSnapshot().role:"",i=Tr.scrollTop;Tr.textContent="";const s=t.createElement("option");s.value="",s.textContent=n,Tr.appendChild(s),Mc.forEach(l=>{const d=t.createElement("option");d.value=l,d.textContent=r[l]||l,Tr.appendChild(d)});const u=typeof a=="string"?a.trim():"";if(u&&!Mc.includes(u)){const l=t.createElement("option");l.value=u,l.textContent=r[u]||u,Tr.appendChild(l)}Tr.value=u||"",Tr.scrollTop=i}function WB(e){if(Ia(),!Tr)return;const t=typeof e=="string"?e.trim():"";if(!t||Array.from(Tr.options||[]).some(i=>i.value===t))return;const o=Tr.ownerDocument||(typeof document<"u"?document:null);if(!o)return;const n=qB(),a=o.createElement("option");a.value=t,a.textContent=n[t]||t,Tr.appendChild(a)}var Cq={productionCompany:XU,productionCompanyAddress:ICON_GLYPHS.pin,rentalHouse:ZU,rentalHouseContact:ICON_GLYPHS.contacts,rentalHouseAddress:ICON_GLYPHS.pin,crew:Ir("",ICON_FONT_KEYS.UICONS),prepDays:Ir("",ICON_FONT_KEYS.UICONS),returnDays:Ir("",ICON_FONT_KEYS.UICONS),shootingDays:Ir("",ICON_FONT_KEYS.UICONS),deliveryResolution:Ir("",ICON_FONT_KEYS.UICONS),recordingResolution:ICON_GLYPHS.camera,recordingFrameRate:Ir("",ICON_FONT_KEYS.UICONS),slowMotionRecordingResolution:ICON_GLYPHS.camera,slowMotionRecordingFrameRate:Ir("",ICON_FONT_KEYS.UICONS),aspectRatio:iR,codec:ICON_GLYPHS.codec,baseFrameRate:Ir("",ICON_FONT_KEYS.UICONS),slowMotionBaseFrameRate:Ir("",ICON_FONT_KEYS.UICONS),sensorMode:ICON_GLYPHS.sensor,slowMotionSensorMode:ICON_GLYPHS.sensor,slowMotionAspectRatio:iR,requiredScenarios:JU,lenses:Ir("",ICON_FONT_KEYS.UICONS),cameraHandle:Ir("",ICON_FONT_KEYS.UICONS),viewfinderExtension:Ir("",ICON_FONT_KEYS.UICONS),gimbal:Ir("",ICON_FONT_KEYS.UICONS),monitoringSupport:e0,monitoringConfiguration:Ir("",ICON_FONT_KEYS.UICONS),monitorUserButtons:Ir("",ICON_FONT_KEYS.UICONS),cameraUserButtons:Ir("",ICON_FONT_KEYS.UICONS),viewfinderUserButtons:Ir("",ICON_FONT_KEYS.UICONS),storageRequirements:ICON_GLYPHS.save};function KB(e){if(!e)return;const t=e.multiple?Array.from(e.selectedOptions||[]):[],r=e.multiple?t.some(i=>typeof i.value=="string"?i.value.trim()!=="":!!i.value):typeof e.value=="string"?e.value.trim()!=="":e.value!==null&&e.value!==void 0&&String(e.value).trim()!=="";if(e.classList.toggle("select-placeholder",!r),e.id==="requiredScenarios")return;const o=e.parentNode;if(!o||typeof o.querySelector!="function")return;let n=o.querySelector(".icon-box-summary");n||(n=document.createElement("div"),n.className="icon-box-summary",o.insertBefore(n,e.nextSibling)),n.innerHTML="",(e.multiple?t:r&&e.selectedIndex>=0?[e.options[e.selectedIndex]]:[]).forEach(i=>{const s=document.createElement("span");s.className="icon-box";const u=document.createElement("span");u.className="icon icon-glyph";let l=Cq[e.name]||ICON_GLYPHS.pin;i.dataset.icon&&(l=Ir(i.dataset.icon,i.dataset.iconFont||ICON_FONT_KEYS.UICONS)),applyIconGlyph(u,l),s.appendChild(u),s.appendChild(document.createTextNode(i.value)),n.appendChild(s)})}try{typeof globalThis<"u"&&typeof globalThis.updateSelectIconBoxes!="function"&&(globalThis.updateSelectIconBoxes=KB)}catch(e){console.warn("Failed to expose updateSelectIconBoxes globally",e)}function ZR(e,t=""){if(!e)return t;const r=Array.isArray(e)?e:typeof e=="string"?[e]:[];if(!r.length)return t;const o=c&&c[rt]||{},n=c&&c.en||{},a=u=>r.reduce((l,d)=>{if(l&&Object.prototype.hasOwnProperty.call(l,d))return l[d]},u),i=a(o);if(i!=null&&i!=="")return String(i);const s=a(n);return s!=null&&s!==""?String(s):t}function Wl(e,t,r={}){if(!e)return;const{contextPaths:o=[],fallbackContext:n="",actionKey:a="addEntry"}=r||{};je(e,"",t||ICON_GLYPHS.add);const i=ZR(["projectForm",a],a==="removeEntry"?"Remove":"Add"),s=Array.isArray(o)?o:[o];let u="";for(const p of s){if(!p)continue;const g=ZR(p,"");if(g){u=g;break}}!u&&typeof n=="string"&&(u=n);const l=u?u.replace(/[:：]\s*$/,"").trim():"",d=[i,l].filter(Boolean).join(" ").trim();d&&(e.setAttribute("aria-label",d),e.setAttribute("title",d))}St("configureIconOnlyButton",Wl);let JR=0;function wq(e,t="field"){return e==null?t:String(e).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")||t}function To(e,t="field"){if(!e)return"";if(e.id)return e.id;const r=wq(t,"field");let o="";do JR+=1,o=`${r} -${JR} `;while(document.getElementById(o));return e.id=o,o}function da(e,t){const r=document.createElement("label");return r.className="visually-hidden",r.setAttribute("for",e),r.textContent=typeof t=="string"?t:"",r}try{typeof globalThis<"u"&&(typeof globalThis.ensureElementId!="function"&&(globalThis.ensureElementId=To),typeof globalThis.createHiddenLabel!="function"&&(globalThis.createHiddenLabel=da))}catch(e){console.warn("Failed to expose accessibility helpers globally",e)}function Fa(e,t=""){const r=c?.en?.projectForm||{},o=c?.[rt]?.projectForm||r,n=o&&typeof o[e]=="string"?o[e].trim():"";return n||(r&&typeof r[e]=="string"?r[e].trim():"")||t}const Lq="cameraPowerPlanner_contacts";function YB(){try{const e=tb();if(e&&typeof e.CONTACTS_STORAGE_KEY=="string"&&e.CONTACTS_STORAGE_KEY)return e.CONTACTS_STORAGE_KEY}catch(e){console.warn("Failed to resolve contacts storage key via module.",e)}return Lq}var Or=[],eI=!1;const ur=F0({loadProfile:()=>{try{return typeof loadUserProfile=="function"?loadUserProfile():null}catch(e){return console.warn("Failed to resolve stored user profile",e),null}},saveProfile:e=>{if(typeof saveUserProfile=="function")try{saveUserProfile(e)}catch(t){console.warn("Failed to persist user profile",t)}},announce:e=>Ut(e),getText:Ke,dispatchChange:()=>eP("user-profile")});function Ke(e,t=""){const r=c?.en?.contacts||{},o=c?.[rt]?.contacts||r,n=o&&typeof o[e]=="string"?o[e].trim():"";return n||(r&&typeof r[e]=="string"?r[e].trim():"")||t}function TC(){const e=tb();if(e&&typeof e.generateContactId=="function")try{return e.generateContactId()}catch(t){console.warn("Unable to generate contact id via module.",t)}return`contact - ${Date.now().toString(36)} -${Math.random().toString(36).slice(2,8)} `}function Ln(e){return H0(e)}function QB(e){return j0(e)}function of(e){return LB(e)}function Rq(){const e=tb();if(e&&typeof e.loadStoredContacts=="function")try{return e.loadStoredContacts()}catch(t){console.warn("Unable to load contacts via module.",t)}if(typeof localStorage>"u")return[];try{const t=YB(),r=localStorage.getItem(t);if(!r)return[];const o=JSON.parse(r);return Array.isArray(o)?of(o):[]}catch(t){return console.warn("Failed to load contacts from storage",t),[]}}function Dc(e){const t=tb();if(t&&typeof t.saveContactsToStorage=="function")try{t.saveContactsToStorage(e);return}catch(r){console.warn("Unable to save contacts via module.",r)}if(!(typeof localStorage>"u"))try{const r=YB();localStorage.setItem(r,JSON.stringify(e))}catch(r){console.warn("Failed to save contacts to storage",r)}}function OC(e){return e&&Or.find(t=>t.id===e)||null}function Iq(e){if(!e)return"";const t=c?.[rt]?.crewRoles||c?.en?.crewRoles||{},r=e.name||e.email||e.phone||e.website||e.role||e.id,o=e.role?t[e.role]||e.role:"";return r&&o&&o!==r?`${r} — ${o} `:r||o||e.id}typeof window<"u"&&(window.updateTripodOptions=fP);function nb(e,t){if(!e)return;const r=typeof t=="string"?t:e.value;let o=e.lang;!o&&typeof document<"u"&&document&&document.documentElement&&(o=document.documentElement.lang||""),o||(o=rt||Qr);const n=e.dir||yB(o||rt||Qr);for(;e.firstChild;)e.removeChild(e.firstChild);const a=document.createElement("option");if(a.value="",a.textContent=Ke("selectPlaceholder","Select contact"),zn(a,o,n),e.appendChild(a),Or.forEach(i=>{const s=document.createElement("option");s.value=i.id,s.textContent=Iq(i),zn(s,o,n),i.id===r&&(s.selected=!0),e.appendChild(s)}),r&&!Or.some(i=>i.id===r)){const i=document.createElement("option");i.value=r,i.textContent=Ke("missingContactFallback","Saved contact"),i.selected=!0,zn(i,o,n),e.appendChild(i)}}function nl(){if(!Va)return;Va.querySelectorAll(".person-contact-select").forEach(t=>nb(t)),eP("contacts")}function Tq(e){if(typeof e=="string"){const t=e.trim();if(t)return t.charAt(0).toUpperCase()}return"•"}function Hi(e,t,r,o){if(!e)return;const n=e.querySelector(".person-avatar-visual, .contact-card-avatar-visual");if(n){for(;n.firstChild;)n.removeChild(n.firstChild);if(t&&N0(t)){const a=document.createElement("img");a.src=t,a.alt="",n.appendChild(a)}else{const a=document.createElement("span");a.className=o,a.textContent=Tq(r),n.appendChild(a)}}}function id(e,t,r={}){if(!e)return;const o=e.querySelector(".person-avatar-data");o&&(o.value=t||"");const n=e.querySelector(".person-name"),a=r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:n?.value,i=e.querySelector(".person-avatar");Hi(i,t,a,"person-avatar-initial")}function Oq(e){if(typeof e!="string"||!e.startsWith("data:"))return"";const t=e.indexOf(";");return t===-1?"":e.slice(5,t).trim()}function nf(e,t){Ia()}function af(e={}){const{restoreFocus:t=!1}=e||{};if(Pc&&Pc.classList.add("hidden"),Rt){try{Rt.releasePointerCapture(qe?.pointerId??-1)}catch{}t&&Rt.blur()}Wa&&Wa.removeAttribute("style"),qe=null,typeof Jo?.getAvatar=="function"&&Jo.getAvatar(),typeof Jo?.getName=="function"&&Jo.getName(),nf(),nf()}function Kn(){So&&(af(),Jo=null,gi(So))}function Gq(){af(),Jo=null}function GC(e=null){console.log("openAvatarOptionsDialog called",e),Ia(),console.log("avatarOptionsDialog ref:",So),So&&(Jo=e||null,typeof e?.getAvatar=="function"&&e.getAvatar(),typeof e?.getName=="function"&&e.getName(),nf(),af(),af(),Lf(So))}function ab(e){if(!e)return;const t=Math.min(0,e.viewportSize-e.displayWidth),r=Math.min(0,e.viewportSize-e.displayHeight);e.offsetX=Math.max(t,Math.min(0,e.offsetX)),e.offsetY=Math.max(r,Math.min(0,e.offsetY))}function sf(e){if(!e||!e.image)return;const t=e.image.naturalWidth||e.image.width||0,r=e.image.naturalHeight||e.image.height||0,o=t*e.baseScale*e.zoom,n=r*e.baseScale*e.zoom;e.displayWidth=o,e.displayHeight=n,ab(e),Wa&&(Wa.style.width=`${o} px`,Wa.style.height=`${n} px`,Wa.style.transform=`translate(${e.offsetX}px, ${e.offsetY}px)`)}function kq(){if(Ia(),!Rt)return 0;let e=!1,t="",r="";Rt&&Rt.classList.contains("hidden")&&(e=!0,t=Rt.style.visibility||"",r=Rt.style.pointerEvents||"",Rt.style.visibility="hidden",Rt.style.pointerEvents="none",Rt.classList.remove("hidden"));let o=0;try{const n=Rt.getBoundingClientRect();o=Math.round(Math.max(Rt.offsetWidth||0,n.width||0,n.height||0))}finally{e&&Rt&&(Rt.classList.add("hidden"),Rt.style.visibility=t,Rt.style.pointerEvents=r)}return!o&&kh?kh:(o&&(kh=o),o)}function Bq(e){if(Ia(),!Rt||!Wa)return;if(!e){Ut(Ke("avatarMissingImage","Add a photo before editing."));return}const t=kq();if(!t){Ut(Ke("avatarEditUnavailable","Photo editor unavailable."));return}const r=new Image;r.decoding="async";const o=Oq(e);r.onload=()=>{if(!r.naturalWidth||!r.naturalHeight){Ut(Ke("avatarReadError","Could not read the selected image."));return}const n=Math.max(t/r.naturalWidth,t/r.naturalHeight);qe={active:!0,dataUrl:e,image:r,mime:o,viewportSize:t,baseScale:n,zoom:1,offsetX:(t-r.naturalWidth*n)/2,offsetY:(t-r.naturalHeight*n)/2,pointerId:null,pointerStartX:0,pointerStartY:0,offsetStartX:0,offsetStartY:0,displayWidth:0,displayHeight:0},Wa.src=e,Rt&&Rt.classList.add("has-image"),Pc&&Pc.classList.remove("hidden"),xc&&(xc.value="100"),sf(qe);try{Rt.focus()}catch{}},r.onerror=()=>{Ut(Ke("avatarReadError","Could not read the selected image."))},r.src=e}function tI(e){if(!qe||!qe.active)return;const t=Number(e?.target?.value)||100,r=Math.max(50,t)/100,o=qe.displayWidth||1,n=qe.displayHeight||1,a=-qe.offsetX+qe.viewportSize/2,i=-qe.offsetY+qe.viewportSize/2,s=a/o,u=i/n;qe.zoom=r,sf(qe);const l=qe.displayWidth*s,d=qe.displayHeight*u;qe.offsetX=-(l-qe.viewportSize/2),qe.offsetY=-(d-qe.viewportSize/2),ab(qe),sf(qe)}function Pq(e){if(!(!qe||!qe.active||!Rt)&&qe.pointerId===null){qe.pointerId=e.pointerId,qe.pointerStartX=e.clientX,qe.pointerStartY=e.clientY,qe.offsetStartX=qe.offsetX,qe.offsetStartY=qe.offsetY;try{Rt.setPointerCapture(e.pointerId)}catch{}e.preventDefault()}}function xq(e){if(!qe||!qe.active||qe.pointerId!==e.pointerId)return;const t=e.clientX-qe.pointerStartX,r=e.clientY-qe.pointerStartY;qe.offsetX=qe.offsetStartX+t,qe.offsetY=qe.offsetStartY+r,ab(qe),sf(qe),e.preventDefault()}function XB(){qe&&(qe.pointerId=null)}function Mq(e){if(!(!qe||!qe.active)&&qe.pointerId===e.pointerId){if(XB(),Rt)try{Rt.releasePointerCapture(e.pointerId)}catch{}e.preventDefault()}}function Dq(e){if(!(!qe||!qe.active)&&qe.pointerId===e.pointerId&&(XB(),Rt))try{Rt.releasePointerCapture(e.pointerId)}catch{}}function _q(e){if(!qe||!qe.active)return;const t=e.shiftKey?10:2;let r=!1;switch(e.key){case"ArrowUp":qe.offsetY-=t,r=!0;break;case"ArrowDown":qe.offsetY+=t,r=!0;break;case"ArrowLeft":qe.offsetX-=t,r=!0;break;case"ArrowRight":qe.offsetX+=t,r=!0;break}r&&(ab(qe),sf(qe),e.preventDefault())}function ZB(){if(!qe||!qe.image)return"";const e=qe.baseScale*qe.zoom;if(!e)return"";const t=qe.viewportSize/e,r=Math.max(0,Math.min(qe.image.naturalWidth-t,-qe.offsetX/e)),o=Math.max(0,Math.min(qe.image.naturalHeight-t,-qe.offsetY/e)),n=document.createElement("canvas");n.width=CONTACT_AVATAR_MAX_DIMENSION,n.height=CONTACT_AVATAR_MAX_DIMENSION;const a=n.getContext("2d");if(!a)return"";a.clearRect(0,0,n.width,n.height),a.drawImage(qe.image,r,o,t,t,0,0,n.width,n.height);const i=qe.mime&&qe.mime.startsWith("image/")?qe.mime:"image/png";try{return n.toDataURL(i)}catch{try{return n.toDataURL("image/png")}catch{return""}}}function Fq(){if(!qe||!qe.active)return;const e=ZB();if(!e){Ut(Ke("avatarEditFailed","Could not update the photo framing."));return}typeof Jo?.onEditSave=="function"&&Jo.onEditSave(e),typeof Jo?.getName=="function"&&Jo.getName(),nf(),af({restoreFocus:!0}),Kn()}function Nq(e){if(!e)return;e.preventDefault(),e.stopPropagation(),Rt&&Rt.classList.remove("drag-over");const t=e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0];t&&JB(t)}function rI(e){e&&(e.preventDefault(),e.stopPropagation(),Rt&&Rt.classList.add("drag-over"))}function Hq(e){e&&(e.preventDefault(),e.stopPropagation(),Rt&&Rt.classList.remove("drag-over"))}function jq(e){const t=e.target&&e.target.files&&e.target.files[0];t&&JB(t),e.target&&(e.target.value="")}function JB(e){wf(e,t=>{const r=typeof Jo?.getName=="function"?Jo.getName():"";nf(t,r),Bq(t)},t=>{Ut(Ke("avatarReadError","Could not read image."))})}function zq(){if(qe&&qe.active){const e=ZB();e&&typeof Jo?.onEditSave=="function"&&Jo.onEditSave(e)}Kn()}function oI(e){if(!So||!ul(So)||e&&typeof e.button=="number"&&e.button!==0)return;const t=e?.target||null,r=typeof Element<"u"&&t instanceof Element?t:null,o=typeof e?.composedPath=="function"?e.composedPath():null;if(!(cc&&(r&&cc.contains(r)||Array.isArray(o)&&o.includes(cc)))){if(qe&&qe.active){Fq();return}Kn()}}function eP(e){if(!(typeof document>"u"))try{document.dispatchEvent(new CustomEvent("gear-provider-data-changed",{detail:{reason:e}}))}catch{}}function Ta(e={}){!ur||typeof ur.assignUserProfileState!="function"||ur.assignUserProfileState(e)}function Yn(){return!ur||typeof ur.getUserProfileSnapshot!="function"?{name:"",role:"",avatar:"",phone:"",email:""}:ur.getUserProfileSnapshot()}function sy(e={}){Ia();const t=Yn(),r=e&&e.preserveSelectionTarget?e.preserveSelectionTarget:e&&e.preserveSelection?document.activeElement:null;if(no)if(r===no){const o=no.selectionStart,n=no.selectionEnd;no.value=t.name;try{no.setSelectionRange(o,n)}catch{}}else no.value=t.name;if(Tr&&(WB(t.role),r!==Tr&&(Tr.value=t.role||"")),go)if(r===go){const o=go.selectionStart,n=go.selectionEnd;go.value=t.phone;try{go.setSelectionRange(o,n)}catch{}}else go.value=t.phone;if(yo)if(r===yo){const o=yo.selectionStart,n=yo.selectionEnd;yo.value=t.email;try{yo.setSelectionRange(o,n)}catch{}}else yo.value=t.email;if(Bc&&Hi(Bc,t.avatar||"",t.name,"contact-card-avatar-initial"),Qa){const o=!!t.avatar;Qa.disabled=!o,Qa.setAttribute("aria-disabled",o?"false":"true")}}function Uq(){if(!ur||typeof ur.load!="function"){sy();return}ur.load(),sy()}function $q(e){Ta({avatar:typeof e=="string"?e:""}),Oa()}function qq(){Ta({avatar:""}),Oa()}typeof window<"u"&&(typeof window.setAvatar!="function"&&(window.setAvatar=$q),typeof window.clearAvatar!="function"&&(window.clearAvatar=qq),typeof window.assignUserProfileState!="function"&&(window.assignUserProfileState=Ta),typeof window.persistUserProfileState!="function"&&(window.persistUserProfileState=Oa));function Oa(e={}){if(!ur||typeof ur.schedulePersist!="function")return;const t=typeof document<"u"?document.activeElement:null,r=t===no||t===Tr||t===go||t===yo?t:null;ur.schedulePersist({announce:!!(e&&e.announce)}),sy({preserveSelectionTarget:r})}function Vq(){if(!no)return;const e=typeof no.value=="string"?no.value:"",t=Yn();e.trim()!==t.name.trim()&&(ur&&typeof ur.handleFieldInput=="function"?ur.handleFieldInput("name",e):Ta({name:e}),Oa())}function nI(){if(!Tr)return;const t=(typeof Tr.value=="string"?Tr.value:"").trim(),r=Yn();t!==r.role.trim()&&(WB(t),ur&&typeof ur.handleFieldInput=="function"?ur.handleFieldInput("role",t):Ta({role:t}),Oa())}function Wq(){if(!go)return;const e=typeof go.value=="string"?go.value:"",t=Yn();e.trim()!==t.phone.trim()&&(ur&&typeof ur.handleFieldInput=="function"?ur.handleFieldInput("phone",e):Ta({phone:e}),Oa())}function Kq(){if(!yo)return;const e=typeof yo.value=="string"?yo.value:"",t=Yn();e.trim()!==t.email.trim()&&(ur&&typeof ur.handleFieldInput=="function"?ur.handleFieldInput("email",e):Ta({email:e}),Oa())}function hp(){ur&&typeof ur.handleFieldBlur=="function"&&ur.handleFieldBlur()}function tP(){Yn().avatar&&(Ta({avatar:""}),Oa(),Ut(Ke("avatarCleared","Profile photo removed.")),ul(So)&&Kn())}function Yq(){const e=Yn(),t=!!(e&&e.avatar);if(console.log("handleUserProfileAvatarButtonClick",{hasAvatar:t,profile:e}),!t&&In&&typeof In.click=="function")try{In.click();return}catch{}GC({getAvatar:()=>Yn().avatar||"",getName:()=>Yn().name||no?.value||"",onDelete:()=>{tP()},onChange:()=>{if(In&&typeof In.click=="function")try{In.click()}catch{}},onEditSave:r=>{r&&(Ta({name:Yn().name||no?.value||"",avatar:r}),Oa(),Ut(Ke("avatarUpdated","Profile photo updated.")),Kn())}})}function Qq(){if(!In)return;const[e]=In.files||[];e&&(wf(e,t=>{const r=Yn();Ta({name:r.name||"",avatar:t}),Oa(),Ut(Ke("avatarUpdated","Profile photo updated.")),ul(So)&&Kn()},t=>{Ut(t==="tooLarge"?Ke("avatarTooLarge","Choose an image under 300 KB."):Ke("avatarReadError","Could not read the selected image."))}),In.value="")}function rP(e){if(!e)return;const t=e.querySelector(".person-avatar-data");if(t&&t.value)return;const r=e.querySelector(".person-name"),o=e.querySelector(".person-avatar");Hi(o,"",r?r.value:"","person-avatar-initial")}function uc(e,t={}){if(!e)return;const{preserveSelect:r=!1}=t||{};if(delete e.dataset.contactId,!r){const o=e.querySelector(".person-contact-select");o&&(o.value="")}ib(e)}function ib(e){if(!e)return;const t=e.querySelector(".person-linked-badge");if(!t)return;const r=e.dataset.contactId,o=e.dataset.userProfileLinked==="1";if(r){const n=OC(r),a=Ke("linkedBadge","Linked to contact");n&&n.name?t.textContent=`${a}: ${n.name} `:t.textContent=a,t.hidden=!1;return}if(o){t.textContent=Ke("linkedProfileBadge","Linked to user profile"),t.hidden=!1;return}t.textContent=Ke("linkedBadge","Linked to contact"),t.hidden=!0}function Sp(e,t=!1){if(typeof window<"u"&&window.cineSuppressAutosave||!e||e.dataset.syncingContact==="1")return;e.dataset.contactId&&(uc(e),Ut(Ke("contactDetached","Crew row disconnected from saved contact."))),rP(e),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave(t)}function aI(e,t){wf(t,r=>{id(e,r),e.dataset.contactId&&uc(e),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave(!0),Ut(Ke("avatarUpdated","Profile photo updated.")),ul(So)&&Kn()},r=>{Ut(r==="tooLarge"?Ke("avatarTooLarge","Choose an image under 300 KB."):Ke("avatarReadError","Could not read the selected image."))})}function Ut(e){Ia(),Kg&&(Kg.textContent=e||"")}function kC(e,t,r={}){if(!e||!t)return;const{skipDirty:o=!1,skipAnnouncement:n=!1}=r||{},a=oP(e)||{},i=typeof CR=="function"?CR(a,t):{role:t.role||"",name:t.name||"",phone:t.phone||"",email:t.email||"",website:t.website||"",avatar:t.avatar||"",contactId:t.id||""};e.dataset.syncingContact="1";try{const s=e.querySelector('select[name="crewRole"]');if(s){if(i.role&&!Array.from(s.options).some(h=>h.value===i.role)){const h=document.createElement("option");h.value=i.role;const A=c?.[rt]?.crewRoles||c?.en?.crewRoles||{};h.textContent=A[i.role]||i.role,s.appendChild(h)}i.role&&(s.value=i.role)}const u=e.querySelector(".person-name");u&&(u.value=i.name||"");const l=e.querySelector(".person-phone");l&&(l.value=i.phone||"");const d=e.querySelector(".person-email");d&&(d.value=i.email||"");const p=e.querySelector(".person-website");p&&(p.value=i.website||""),id(e,i.avatar||"",{name:i.name}),e.dataset.contactId=i.contactId||t.id;const g=e.querySelector(".person-contact-select");g&&nb(g,i.contactId||t.id)}finally{delete e.dataset.syncingContact}ib(e),!o&&typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),o||scheduleProjectAutoSave(!0),n||Ut(Ke("contactApplied","Crew row updated from contact."))}function BC(e){if(!Va||!e)return;Va.querySelectorAll(".person-row").forEach(r=>{r.dataset.contactId===e.id&&kC(r,e,{skipAnnouncement:!0})})}function oP(e){if(!e)return null;const t=e.querySelector('select[name="crewRole"]'),r=e.querySelector(".person-name"),o=e.querySelector(".person-phone"),n=e.querySelector(".person-email"),a=e.querySelector(".person-website"),i=e.querySelector(".person-avatar-data");return{role:Ln(t?.value||""),name:Ln(r?.value||""),phone:Ln(o?.value||""),email:Ln(n?.value||""),website:Ln(a?.value||""),avatar:Ln(i?.value||""),contactId:Ln(e.dataset.contactId||"")}}function Xq(e){if(!e)return;const t=Or.findIndex(r=>r.id===e);t!==-1&&(Or.splice(t,1),Or=of(Or),Dc(Or),ls(),nl(),Va&&Va.querySelectorAll(".person-row").forEach(o=>{o.dataset.contactId===e&&uc(o)}),Ut(Ke("contactDeleted","Contact removed. Project rows keep their details.")))}function Zq(e){const t=oP(e);if(!t)return;if(!t.name&&!t.email&&!t.phone&&!t.website){Ut(Ke("contactMissingDetails","Enter a name, email, phone number or website before saving this contact."));return}const r=Date.now();if(t.contactId){const n=OC(t.contactId);if(n){n.name=t.name||n.name,n.role=t.role||n.role,n.phone=t.phone||n.phone,n.email=t.email||n.email,n.website=t.website||n.website,t.avatar?n.avatar=t.avatar:n.avatar||delete n.avatar,n.updatedAt=r,Or=of(Or),Dc(Or),ls({focusContactId:n.id}),nl(),BC(n),Ut(Ke("contactUpdated","Contact updated."));return}}const o=QB({id:t.contactId||TC(),name:t.name,role:t.role,phone:t.phone,email:t.email,website:t.website,avatar:t.avatar,createdAt:r,updatedAt:r});Or.push(o),Or=of(Or),Dc(Or),ls({focusContactId:o.id}),nl(),kC(e,o,{skipAnnouncement:!0}),Ut(Ke("contactSaved","Contact saved for future projects."))}function Jq(e){return z0(e,{sanitize:Ln})}function eV(e){if(!Array.isArray(e)||!e.length)return Ut(Ke("importNone","No new contacts found in the file.")),{added:0,updated:0};const t=U0({existing:Or,imported:e,now:()=>Date.now(),generateContactId:TC}),{contacts:r,added:o=0,updated:n=0}=t;if(Or=Array.isArray(r)?r:Or,Dc(Or),ls(),nl(),Array.isArray(r)&&r.forEach(a=>BC(a)),o||n){const a=Ke("importSummary","{added} added, {updated} updated.");Ut(a.replace("{added}",o).replace("{updated}",n))}else Ut(Ke("importNone","No new contacts found in the file."));return{added:o,updated:n}}function tV(e){const t=document.createElement("article");t.className="contact-card",t.setAttribute("role","listitem"),t.dataset.contactId=e.id;const r=document.createElement("div");r.className="contact-card-header";const o=document.createElement("div");o.className="contact-card-avatar";const n=document.createElement("div");n.className="contact-card-avatar-visual",o.appendChild(n),Hi(o,e.avatar||"",e.name,"contact-card-avatar-initial");const a=document.createElement("button");a.type="button";const i=Ke("avatarChange","Change photo");a.setAttribute("aria-label",i),a.removeAttribute("title"),a.removeAttribute("data-help"),a.innerHTML="",o.appendChild(a);const s=document.createElement("input");s.type="file",s.accept="image/*",s.className="visually-hidden",s.tabIndex=-1,o.appendChild(s),r.appendChild(o);const u=document.createElement("strong");u.textContent=e.name||Ke("contactFallbackName","Crew contact"),r.appendChild(u),t.appendChild(r);const l=document.createElement("div");l.className="contact-card-fields";const d=c?.[rt]?.crewRoles||c?.en?.crewRoles||{},p=document.createElement("input");p.type="text",p.value=e.name||"";const g=To(p,`${e.id} -name`),h=document.createElement("label");h.setAttribute("for",g),h.textContent=Ke("nameLabel","Name");const A=document.createElement("div");A.className="contact-field",A.append(h,p),l.appendChild(A);const m=document.createElement("select"),y=To(m,`${e.id} -role`),S=document.createElement("option");if(S.value="",S.textContent=Ke("rolePlaceholder","Select role"),m.appendChild(S),Mc.forEach(Q=>{const ne=document.createElement("option");ne.value=Q,ne.textContent=d[Q]||Q,m.appendChild(ne)}),e.role&&!Mc.includes(e.role)){const Q=document.createElement("option");Q.value=e.role,Q.textContent=d[e.role]||e.role,m.appendChild(Q)}m.value=e.role||"";const E=document.createElement("label");E.setAttribute("for",y),E.textContent=Ke("roleLabel","Crew role");const I=document.createElement("div");I.className="contact-field",I.append(E,m),l.appendChild(I);const L=document.createElement("input");L.type="tel",L.value=e.phone||"";const R=To(L,`${e.id} -phone`),G=document.createElement("label");G.setAttribute("for",R),G.textContent=Ke("phoneLabel","Phone");const j=document.createElement("div");j.className="contact-field",j.append(G,L),l.appendChild(j);const $=document.createElement("input");$.type="email",$.value=e.email||"";const z=To($,`${e.id} -email`),te=document.createElement("label");te.setAttribute("for",z),te.textContent=Ke("emailLabel","Email");const oe=document.createElement("div");oe.className="contact-field",oe.append(te,$),l.appendChild(oe);const k=document.createElement("input");k.type="url",k.inputMode="url",k.autocomplete="url",k.value=e.website||"",k.placeholder=Ke("websitePlaceholder","https://example.com");const Z=To(k,`${e.id} -website`),ue=document.createElement("label");ue.setAttribute("for",Z),ue.textContent=Ke("websiteLabel","Website");const H=document.createElement("div");H.className="contact-field",H.append(ue,k),l.appendChild(H),t.appendChild(l);const Y=document.createElement("div");Y.className="contact-card-actions";const N=document.createElement("button");N.type="button",je(N,Ke("useInProject","Add to project crew"),ICON_GLYPHS.add),N.addEventListener("click",()=>{PC({...e,contactId:e.id}),gi(wn),Ut(Ke("contactAddedToProject","Contact added to the current project."))}),Y.appendChild(N);const ae=document.createElement("button");ae.type="button",je(ae,Ke("deleteContact","Delete contact"),ICON_GLYPHS.trash),ae.addEventListener("click",()=>{const Q=Ke("deleteConfirm","Remove this contact? Project rows will keep their details."),ne=()=>Xq(e.id);if(typeof window.cineShowConfirmDialog=="function"){window.cineShowConfirmDialog({title:Ke("deleteContact","Delete contact"),message:Q,confirmLabel:Ke("deleteButton","Delete")||"Delete",cancelLabel:Ke("cancel","Cancel")||"Cancel",danger:!0,onConfirm:ne});return}console.warn("Missing window.cineShowConfirmDialog for delete contact")}),Y.appendChild(ae),t.appendChild(Y);const de=(Q=!1)=>{e.updatedAt=Date.now(),Dc(Or),nl(),BC(e),Q&&(Or=of(Or),ls({focusContactId:e.id}))};return p.addEventListener("input",()=>{e.name=Ln(p.value),u.textContent=e.name||Ke("contactFallbackName","Crew contact"),Hi(o,e.avatar||"",e.name,"contact-card-avatar-initial"),de()}),p.addEventListener("blur",Q=>{const ne=Q?.relatedTarget||(typeof document<"u"?document.activeElement:null);if(ne&&ne!==p&&t.contains(ne)){de();return}de(!0)}),m.addEventListener("change",()=>{e.role=Ln(m.value),de()}),L.addEventListener("input",()=>{e.phone=Ln(L.value),de()}),$.addEventListener("input",()=>{e.email=Ln($.value),de()}),k.addEventListener("input",()=>{e.website=Ln(k.value),de()}),a.addEventListener("click",()=>{if(!e.avatar&&s&&typeof s.click=="function")try{s.click();return}catch{}GC({getAvatar:()=>e.avatar||"",getName:()=>e.name||"",onDelete:()=>{e.avatar&&(e.avatar="",Hi(o,"",e.name,"contact-card-avatar-initial"),de(),Ut(Ke("avatarCleared","Profile photo removed.")))},onChange:()=>{if(s&&typeof s.click=="function")try{s.click()}catch{}},onEditSave:Q=>{Q&&(e.avatar=Q,Hi(o,Q,e.name,"contact-card-avatar-initial"),de(),Ut(Ke("avatarUpdated","Profile photo updated.")))}})}),s.addEventListener("change",()=>{const[Q]=s.files||[];Q&&(wf(Q,ne=>{e.avatar=ne,Hi(o,ne,e.name,"contact-card-avatar-initial"),de(),Ut(Ke("avatarUpdated","Profile photo updated.")),ul(So)&&Kn()},ne=>{Ut(ne==="tooLarge"?Ke("avatarTooLarge","Choose an image under 300 KB."):Ke("avatarReadError","Could not read the selected image."))}),s.value="")}),{card:t,focusTarget:p}}function ls(e={}){if(Ia(),!di)return;const{focusContactId:t=null}=e||{};for(;di.firstChild;)di.removeChild(di.firstChild);if(!Or.length){Xi&&(Xi.hidden=!1);return}Xi&&(Xi.hidden=!0);let r=null;Or.forEach(o=>{const{card:n,focusTarget:a}=tV(o);di.appendChild(n),t&&o.id===t&&(r=a)}),r&&requestAnimationFrame(()=>r.focus())}function nP(e,t){if(!e)return;const r=a=>{a.preventDefault(),a.stopPropagation(),e.classList.add("avatar-drag-over")},o=a=>{a.preventDefault(),a.stopPropagation(),e.classList.remove("avatar-drag-over")},n=a=>{a.preventDefault(),a.stopPropagation(),e.classList.remove("avatar-drag-over");const i=a.dataTransfer&&a.dataTransfer.files&&a.dataTransfer.files[0];i&&t(i)};e.addEventListener("dragenter",r),e.addEventListener("dragover",r),e.addEventListener("dragleave",o),e.addEventListener("drop",n)}function aP(){console.log("initializeContactsModule called"),Ia(),!(eI&&di&&ma)&&(console.log("initializeContactsModule running (re-init or first run)"),Or=Rq(),Uq(),VB(),ls(),nl(),sy(),console.log("userProfileAvatarButton found (first-run):",!!ma),no&&(no.addEventListener("input",Vq),no.addEventListener("blur",hp)),Tr&&(Tr.addEventListener("input",nI),Tr.addEventListener("change",nI),Tr.addEventListener("blur",hp)),go&&(go.addEventListener("input",Wq),go.addEventListener("blur",hp)),yo&&(yo.addEventListener("input",Kq),yo.addEventListener("blur",hp)),ma&&ma.addEventListener("click",Yq),Qa&&Qa.addEventListener("click",tP),In&&In.addEventListener("change",Qq),Bc&&nP(Bc,e=>{wf(e,t=>{const r=Yn();Ta({name:r.name||"",avatar:t}),Oa(),Ut(Ke("avatarUpdated","Profile photo updated.")),ul(So)&&Kn()},t=>{Ut(t==="tooLarge"?Ke("avatarTooLarge","Choose an image under 300 KB."):Ke("avatarReadError","Could not read the selected image."))})}),Vs&&Vs.addEventListener("click",()=>{const e=QB({id:TC(),name:"",role:"",phone:"",email:"",avatar:"",createdAt:Date.now(),updatedAt:Date.now()});Or.push(e),ls({focusContactId:e.id}),Dc(Or),nl(),Ut(Ke("contactDraftCreated","New contact ready. Fill in the details."))}),Ws&&Is&&(Ws.addEventListener("click",()=>Is.click()),Is.addEventListener("change",()=>{const[e]=Is.files||[];e&&e.text().then(t=>eV(Jq(t))).catch(()=>{Ut(Ke("importError","Could not import the selected file."))}).finally(()=>{Is.value=""})})),Ds?.addEventListener("click",()=>Kn()),cc?.addEventListener("submit",e=>e.preventDefault()),So?.addEventListener("cancel",e=>{e.preventDefault(),Kn()}),So?.addEventListener("close",Gq),So?.addEventListener("pointerdown",oI),So?.addEventListener("pointerdown",oI),Rt&&(Rt.addEventListener("dragenter",rI),Rt.addEventListener("dragover",rI),Rt.addEventListener("dragleave",Hq),Rt.addEventListener("drop",Nq),Rt.addEventListener("click",()=>ad&&ad.click()),Rt.addEventListener("pointerdown",Pq),Rt.addEventListener("pointermove",xq),Rt.addEventListener("pointerup",Mq),Rt.addEventListener("pointercancel",Dq),Rt.addEventListener("keydown",_q)),ad?.addEventListener("change",jq),gA?.addEventListener("click",zq),yA?.addEventListener("click",()=>Kn()),xc?.addEventListener("input",tI),xc?.addEventListener("change",tI),rf?.addEventListener("click",()=>gi(wn)),pA?.addEventListener("submit",e=>{e.preventDefault(),gi(wn)}),wn?.addEventListener("cancel",e=>{e.preventDefault(),gi(wn)}),wn?.addEventListener("click",e=>{e.target===wn&&gi(wn)}),mA?.addEventListener("click",e=>{e.preventDefault(),Lf(wn)}),di&&ma&&(eI=!0))}function PC(e={}){if(Va||typeof document<"u"&&(Va=document.getElementById("crewContainer")),!Va)return;const t=document.createElement("div");t.className="person-row",e.userProfileLinked&&(t.dataset.userProfileLinked="1");let r="";typeof document<"u"&&document&&document.documentElement&&(r=document.documentElement.lang||"");const o=r||rt||Qr,n=yB(o);zn(t,o,n);const a=typeof c<"u"&&c?.en?.projectForm||{},i=typeof c<"u"&&c?.[rt]?.projectForm||a,s=typeof c<"u"&&(c?.[rt]?.crewRoles||c?.en?.crewRoles)||{},u=i.crewRoleLabel||a.crewRoleLabel||"Crew role",l=i.crewNameLabel||a.crewNameLabel||"Crew member name",d=i.crewPhoneLabel||a.crewPhoneLabel||"Crew member phone",p=i.crewEmailLabel||a.crewEmailLabel||"Crew member email",g=i.crewWebsiteLabel||a.crewWebsiteLabel||"Crew member website",h=Ke("selectLabel","Saved contacts"),A=Ke("avatarChange","Change photo"),m=document.createElement("input");m.type="hidden",m.className="person-avatar-data",m.value=typeof e.avatar=="string"?e.avatar:"",t.appendChild(m);const y=document.createElement("div");y.className="person-avatar";const S=document.createElement("div");S.className="person-avatar-visual",y.appendChild(S);const E=document.createElement("button");E.type="button",E.setAttribute("aria-label",A),E.removeAttribute("title"),E.removeAttribute("data-help"),E.innerHTML="",y.appendChild(E);const I=document.createElement("input");I.type="file",I.accept="image/*",I.className="visually-hidden",I.tabIndex=-1,y.appendChild(I),nP(y,J=>{aI(t,J)});const L=document.createElement("select");if(L.name="crewRole",L.className="person-role-select",zn(L,o,n),Mc.forEach(J=>{const Ae=document.createElement("option");Ae.value=J,Ae.textContent=s[J]||J,zn(Ae,o,n),L.appendChild(Ae)}),e.role&&!Mc.includes(e.role)){const J=document.createElement("option");J.value=e.role,J.textContent=s[e.role]||e.role,zn(J,o,n),L.appendChild(J)}e.role?L.value=e.role:L.options.length>0&&(L.selectedIndex=0);const R=document.createElement("input");R.type="text",R.name="crewName",R.className="person-name",R.placeholder=i.crewNamePlaceholder||a.crewNamePlaceholder||"Name",R.value=e.name||"",zn(R,o,n);const G=document.createElement("input");G.type="tel",G.name="crewPhone",G.className="person-phone",G.placeholder=i.crewPhonePlaceholder||a.crewPhonePlaceholder||"Phone",G.value=e.phone||"",zn(G,o,n);const j=document.createElement("input");j.type="email",j.name="crewEmail",j.className="person-email",j.placeholder=i.crewEmailPlaceholder||a.crewEmailPlaceholder||"Email",j.value=e.email||"",zn(j,o,n);const $=document.createElement("input");$.type="text",$.inputMode="url",$.autocomplete="url",$.name="crewWebsite",$.className="person-website",$.placeholder=i.crewWebsitePlaceholder||a.crewWebsitePlaceholder||"Website",$.value=e.website||"",zn($,o,n);const z=document.createElement("select");z.className="person-contact-select",zn(z,o,n),nb(z,e.contactId);const te=da(To(L,u),u),oe=da(To(R,l),l),k=da(To(G,d),d),Z=da(To(j,p),p),ue=da(To($,g),g),H=da(To(z,h),h),Y=document.createElement("span");Y.className="person-linked-badge",e.userProfileLinked?(Y.textContent=Ke("linkedProfileBadge","Linked to user profile"),Y.hidden=!1):(Y.textContent=Ke("linkedBadge","Linked to contact"),Y.hidden=!0);const N=document.createElement("button");N.type="button",N.className="person-save-contact",je(N,Ke("saveContact","Save to contacts"),ICON_GLYPHS.save),N.addEventListener("click",()=>Zq(t));const ae=document.createElement("button");ae.type="button",ae.className="person-manage-contacts",je(ae,Ke("openManager","Open contacts"),ICON_GLYPHS.gears),ae.addEventListener("click",()=>Lf(wn));const de=document.createElement("button");de.type="button",de.className="person-remove-btn";const Q=c[rt]?.projectForm?.removeEntry||c.en?.projectForm?.removeEntry||"Remove",ne=c[rt]?.projectForm?.crewHeading||c.en?.projectForm?.crewHeading||"Crew",V=`${Q} ${ne} `.trim();de.innerHTML=wa(ICON_GLYPHS.minus,"btn-icon"),de.setAttribute("aria-label",V),de.setAttribute("title",V),de.setAttribute("data-help",V),de.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()});const fe=document.createElement("div");fe.className="person-actions",fe.append(N,ae,de),[te,oe,k,Z,ue,H].forEach(J=>t.appendChild(J)),t.appendChild(y),t.appendChild(z),t.appendChild(Y),t.appendChild(L),t.appendChild(R),t.appendChild(G),t.appendChild(j),t.appendChild($),t.appendChild(fe),e.contactId&&(t.dataset.contactId=e.contactId),id(t,m.value,{name:e.name}),ib(t),E.addEventListener("click",()=>{if(!m.value&&I&&typeof I.click=="function")try{I.click();return}catch{}GC({getAvatar:()=>m.value||"",getName:()=>R.value||"",onDelete:()=>{m.value&&(id(t,""),Sp(t),Ut(Ke("avatarCleared","Profile photo removed.")))},onChange:()=>{if(I&&typeof I.click=="function")try{I.click()}catch{}},onEditSave:J=>{J&&(id(t,J,{name:R.value}),t.dataset.contactId&&uc(t),Sp(t),Ut(Ke("avatarUpdated","Profile photo updated.")))}})}),I.addEventListener("change",()=>{const[J]=I.files||[];J&&aI(t,J),I.value=""}),L.addEventListener("change",()=>Sp(t,!1)),R.addEventListener("input",()=>{rP(t)}),z.addEventListener("change",()=>{const J=z.value;if(!J){uc(t,{preserveSelect:!0}),Sp(t);return}const Ae=OC(J);Ae?kC(t,Ae):(Ut(Ke("contactMissingDetails","Saved contact not available.")),uc(t,{preserveSelect:!0}))}),Va.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}typeof window<"u"&&(window.createCrewRow=PC,window.createPrepRow=iP,window.createShootRow=sP,window.createReturnRow=lP);function iP(e={}){if(!WR)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="prepStart",r.className="prep-start",r.value=e.start||"",r.setAttribute("aria-labelledby","prepLabel");const o=document.createElement("span");o.textContent="to";const n=document.createElement("input");n.type="date",n.name="prepEnd",n.className="prep-end",n.value=e.end||"",n.setAttribute("aria-labelledby","prepLabel");const a=document.createElement("button");a.type="button";const i=c[rt]?.projectForm?.removeEntry||c.en?.projectForm?.removeEntry||"Remove",s=c[rt]?.projectForm?.prepLabel||c.en?.projectForm?.prepLabel||"Prep",u=`${i} ${s} `.trim();a.innerHTML=wa(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",u),a.setAttribute("title",u),a.setAttribute("data-help",u),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,o,n,a),WR.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function sP(e={}){if(!KR)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="shootStart",r.className="shoot-start",r.value=e.start||"",r.setAttribute("aria-labelledby","shootLabel");const o=document.createElement("span");o.textContent="to";const n=document.createElement("input");n.type="date",n.name="shootEnd",n.className="shoot-end",n.value=e.end||"",n.setAttribute("aria-labelledby","shootLabel");const a=document.createElement("button");a.type="button";const i=c[rt]?.projectForm?.removeEntry||c.en?.projectForm?.removeEntry||"Remove",s=c[rt]?.projectForm?.shootLabel||c.en?.projectForm?.shootLabel||"Shoot",u=`${i} ${s} `.trim();a.innerHTML=wa(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",u),a.setAttribute("title",u),a.setAttribute("data-help",u),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,o,n,a),KR.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function lP(e={}){if(!YR)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="returnStart",r.className="return-start",r.value=e.start||"",r.setAttribute("aria-labelledby","returnLabel");const o=document.createElement("span");o.textContent="to";const n=document.createElement("input");n.type="date",n.name="returnEnd",n.className="return-end",n.value=e.end||"",n.setAttribute("aria-labelledby","returnLabel");const a=document.createElement("button");a.type="button";const i=c[rt]?.projectForm?.removeEntry||c.en?.projectForm?.removeEntry||"Remove",s=c[rt]?.projectForm?.returnLabel||c.en?.projectForm?.returnLabel||"Return Day",u=`${i} ${s} `.trim();a.innerHTML=wa(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",u),a.setAttribute("title",u),a.setAttribute("data-help",u),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,o,n,a),YR.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function Bh(e,t){const r=Number(e);return!Number.isFinite(r)||r<=0?"":`${Number.isInteger(r)?String(r):r.toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:0})} ${t} `}function rV(e){const t=[];if(!e)return t;const r=Et?.cameras||{},o=typeof ol?.value=="string"?ol.value:"",n=a=>{!a||!Array.isArray(a.recordingMedia)||a.recordingMedia.forEach(i=>{i&&i.type===e&&t.push(i)})};return o&&r[o]&&n(r[o]),Object.keys(r).forEach(a=>{a!==o&&n(r[a])}),t}function cP(){const e=Et?.cameras||{},t=Et?.gearList?.media||{},r=[],o=new Set,n=u=>{if(!u||typeof u!="string")return;const l=u.trim();if(!l)return;const d=l.toLowerCase();o.has(d)||(o.add(d),r.push(l))},a=typeof ol?.value=="string"?ol.value:"";if(a&&e[a])return(e[a].recordingMedia||[]).forEach(l=>{l&&l.type&&n(l.type)}),r;const i=u=>{u&&(u.recordingMedia||[]).forEach(l=>{l&&l.type&&n(l.type)})};Object.values(e).forEach(u=>i(u));const s=u=>{Object.values(u).forEach(l=>{if(l)if(l.brand||l.model||l.type||l.capacityGB||l.capacity){l.type&&n(l.type);const d=typeof l.interface=="string"?l.interface.trim():"";d&&n(d),Array.isArray(l.supportedMedia)&&l.supportedMedia.forEach(p=>n(p))}else typeof l=="object"&&s(l)})};return s(t),r.sort(localeSort)}function uP(e){const t=[];if(!e)return t;const r=e.toLowerCase(),o=[],n=Et?.gearList?.media||{},a=l=>{Object.entries(l).forEach(([d,p])=>{p&&(p.brand||p.model||p.type||p.capacityGB||p.capacity?o.push({id:d,...p}):typeof p=="object"&&a(p))})};a(n);const i=new Set,s=(l,d)=>{if(!l||i.has(l))return;const p=(d||l).toLowerCase();p.includes("dual slots")||p.includes("slot 1")||p==="adapter"||p.includes("via adapter")||p==="red pro"||/\d/.test(p)&&(t.push({value:l,label:d||l}),i.add(l))};o.forEach(l=>{let d=!1;if(l.type&&(d=l.type.toLowerCase()===r),d||(d=[l.id,l.model,l.interface].some(S=>typeof S=="string"&&S.toLowerCase().includes(r))),!d)return;const p=[];l.brand&&p.push(l.brand);const g=l.model||"";g&&(!l.brand||g.toLowerCase()!==l.brand.toLowerCase())&&p.push(g);const h=Number(l.capacityGB||l.capacity),A=Number(l.capacityTb);let m="";Number.isFinite(h)&&h>0?h>=1e3?m=Bh(h/1e3,"TB"):m=Bh(h,"GB"):Number.isFinite(A)&&A>0&&(m=Bh(A,"TB")),m&&p.push(m),s(l.id,p.length?p.join(" • "):l.id)});const u=new Set;return rV(e).forEach(l=>{const d=typeof l?.notes=="string"?l.notes:"";d&&d.split(/[,;/]/).forEach(p=>{const g=p.trim();g&&u.add(g)})}),u.forEach(l=>{const d=`${e} ${l} `.trim();s(d,l)}),t.length||s(e,e),t.sort((l,d)=>localeSort(l.label,d.label))}function dP(e,t,r){if(!e)return;const o=uP(t),n=Fa("storageVariantPlaceholder","Select brand & size"),a=r!==void 0?r:e.value;e.innerHTML="";const i=document.createElement("option");if(i.value="",i.textContent=n,e.appendChild(i),o.forEach(s=>{const u=document.createElement("option");u.value=s.value,u.textContent=s.label,e.appendChild(u)}),a){if(!(e.options&&Array.from(e.options).some(u=>u.value===a))){const u=document.createElement("option");u.value=a,u.textContent=a,u.dataset.extraOption="true",e.appendChild(u)}e.value=a}else e.value=""}function ly(){if(!Rs)return;const e=cP(),t=Fa("storageTypePlaceholder","Select media type");Array.from(Rs.querySelectorAll(".storage-row")).forEach(r=>{const o=r.querySelector(".storage-type"),n=r.querySelector(".storage-variant");if(!o)return;const a=o.value,i=n?n.value:"";o.innerHTML="";const s=document.createElement("option");if(s.value="",s.textContent=t,o.appendChild(s),e.forEach(u=>{const l=document.createElement("option");l.value=u,l.textContent=u,o.appendChild(l)}),a){if(!e.includes(a)){const l=document.createElement("option");l.value=a,l.textContent=a,l.dataset.extraOption="true",o.appendChild(l)}o.value=a}else o.value="";dP(n,o.value,i)})}typeof window<"u"&&(window.getAvailableStorageMediaTypes=cP,window.getStorageVariantOptions=uP,window.updateStorageRequirementTypeOptions=ly,window.createStorageRequirementRow=bA);function bA(e={}){if(!Rs)return null;const t=document.createElement("div");t.className="storage-row form-row";const r=document.createElement("input");r.type="number",r.min="1",r.step="1",r.name="storageQuantity",r.className="storage-quantity";const o=Number(e.quantity);Number.isFinite(o)&&o>0&&(r.value=o);const n=Fa("storageQuantityLabel","Quantity"),a=To(r,n),i=document.createElement("label");i.className="form-row-label storage-quantity-label",i.setAttribute("for",a),i.textContent=n,i.dataset.storageLabelKey="storageQuantityLabel";const s=document.createElement("select");s.name="storageMediaType",s.className="storage-type",s.value=typeof e.type=="string"?e.type:"";const u=Fa("storageTypeLabel","Media type"),l=da(To(s,u),u);l.dataset.storageLabelKey="storageTypeLabel";const d=document.createElement("select");d.name="storageMediaVariant",d.className="storage-variant",d.value=typeof e.variant=="string"?e.variant:"";const p=Fa("storageVariantLabel","Brand & capacity"),g=da(To(d,p),p);g.dataset.storageLabelKey="storageVariantLabel";const h=document.createElement("input");h.type="text",h.name="storageMediaNotes",h.className="storage-notes",h.value=typeof e.notes=="string"?e.notes:"",h.placeholder=Fa("storageNotesPlaceholder","");const A=Fa("storageNotesLabel","Notes"),m=da(To(h,A),A);m.dataset.storageLabelKey="storageNotesLabel",s.addEventListener("change",()=>{dP(d,s.value),scheduleProjectAutoSave()});const y=document.createElement("button");y.type="button";const S=Fa("removeEntry","Remove"),E=Fa("storageNeedsLabel","Recording media needs"),I=`${S} ${E} `.trim();y.innerHTML=wa(ICON_GLYPHS.minus,"btn-icon"),y.setAttribute("aria-label",I),y.setAttribute("title",I),y.setAttribute("data-help",I),y.dataset.storageActionKey="storageRemoveEntry",y.addEventListener("click",()=>{t.remove(),Rs.querySelector(".storage-row")?ly():bA(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()});const L=document.createElement("button");L.type="button",L.className="storage-duplicate-btn",L.innerHTML=wa(ICON_GLYPHS.add,"btn-icon"),L.dataset.storageActionKey="storageDuplicateEntry";const R=Fa("storageDuplicateEntry","Duplicate media row");L.setAttribute("aria-label",R),L.setAttribute("title",R),L.setAttribute("data-help",R),L.addEventListener("click",()=>{const j={quantity:r?r.value:"",type:s?s.value:"",variant:d?d.value:"",notes:h?h.value:""},$=bA(j);if($&&typeof Rs?.insertBefore=="function"){Rs.insertBefore($,t.nextSibling);const z=$.querySelector(".storage-quantity");z&&(z.focus(),typeof z.select=="function"&&z.select())}scheduleProjectAutoSave()});const G=document.createElement("div");return G.className="storage-row-actions",G.append(L,y),t.append(i,r,l,s,g,d,m,h,G),Rs.appendChild(t),ly(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),t}function oV(e){const t=document.getElementById("requiredScenarios");if(!t)return;const o=(c[e]||{}).scenarios||{},n=c.en&&c.en.scenarios?c.en.scenarios:{};t.options&&Array.from(t.options).forEach(a=>{const i=a.value,s=o[i]||n[i]||a.value;a.textContent=s})}function nV(e,t){const r=e.storageHeading||t.storageHeading||"Storage & Media";dA&&(dA.textContent=r);const o=e.storageNeedsLabel||t.storageNeedsLabel||"Recording media needs:";fA&&(fA.textContent=o);const n=p=>{const g=e[p]||t[p];g&&document.querySelectorAll(`#storageNeedsContainer [data-storage-label-key="${p}"]`).forEach(h=>{h.textContent=g})};["storageQuantityLabel","storageTypeLabel","storageVariantLabel","storageNotesLabel"].forEach(n);const a=e.storageTypePlaceholder||t.storageTypePlaceholder||"Select media type",i=e.storageVariantPlaceholder||t.storageVariantPlaceholder||"Select brand & size",s=e.storageNotesPlaceholder||t.storageNotesPlaceholder||"",u=e.storageDuplicateEntry||t.storageDuplicateEntry||"Duplicate media row",l=e.removeEntry||t.removeEntry||"Remove";document.querySelectorAll("#storageNeedsContainer .storage-type").forEach(p=>{if(!p.options)return;const g=p.options[0];g&&(g.textContent=a)}),document.querySelectorAll("#storageNeedsContainer .storage-variant").forEach(p=>{if(!p.options)return;const g=p.options[0];g&&(g.textContent=i)}),document.querySelectorAll("#storageNeedsContainer .storage-notes").forEach(p=>{p.placeholder=s}),document.querySelectorAll('#storageNeedsContainer [data-storage-action-key="storageDuplicateEntry"]').forEach(p=>{p.setAttribute("aria-label",u),p.setAttribute("title",u),p.setAttribute("data-help",u)});const d=`${l} ${o} `.trim();document.querySelectorAll('#storageNeedsContainer [data-storage-action-key="storageRemoveEntry"]').forEach(p=>{p.setAttribute("aria-label",d),p.setAttribute("title",d),p.setAttribute("data-help",d)})}Ul&&Ul.addEventListener("click",()=>{PC()});$l&&$l.addEventListener("click",()=>iP());ql&&ql.addEventListener("click",()=>sP());Vl&&Vl.addEventListener("click",()=>lP());function fP(){const e=Da?Da.value:"",t=_a?_a.value:"",r=Da&&Da.options?Array.from(Da.options):[],o=_a&&_a.options?Array.from(_a.options):[];if(r.forEach(n=>{n.hidden=!1}),o.forEach(n=>{n.hidden=!1}),e==="OConnor"){const n=o.find(a=>a.value==="75mm bowl");n&&(n.hidden=!0),_a.value==="75mm bowl"&&(_a.value="")}if(e==="Sachtler"){const n=o.find(a=>a.value==="Mitchell Mount");n&&(n.hidden=!0),_a.value==="Mitchell Mount"&&(_a.value="")}if(t==="75mm bowl"){const n=r.find(a=>a.value==="OConnor");n&&(n.hidden=!0),Da.value==="OConnor"&&(Da.value="")}if(t==="Mitchell Mount"){const n=r.find(a=>a.value==="Sachtler");n&&(n.hidden=!0),Da.value==="Sachtler"&&(Da.value="")}}typeof window<"u"&&(window.updateTripodOptions=fP);document.getElementById("totalPower")||document.getElementById("heroTotalDraw");document.getElementById("totalCurrent144")||document.getElementById("heroCurrent144");document.getElementById("totalCurrent12")||document.getElementById("heroCurrent12");document.getElementById("batteryLife")||document.getElementById("heroRuntime");var lu=document.getElementById("batteryLifeLabel"),vp=document.getElementById("runtimeAverageNote");document.getElementById("batteryCount")||document.getElementById("heroBatteryCount");var Ap=document.getElementById("pinWarning"),Ep=document.getElementById("dtapWarning"),Cp=document.getElementById("hotswapWarning"),ji=document.getElementById("powerWarningDialog"),wp=document.getElementById("powerWarningTitle");document.getElementById("powerWarningMessage");var Lp=document.getElementById("powerWarningLimitsHeading");document.getElementById("powerWarningPinsDetail");document.getElementById("powerWarningDtapDetail");var Rp=document.getElementById("powerWarningAdvice"),Kl=document.getElementById("powerWarningCloseBtn"),Ph=document.getElementById("heroCard"),ps=document.getElementById("heroTotalDraw"),iI=document.getElementById("heroAvailablePower"),sI=document.getElementById("heroBatteryLabel");document.getElementById("heroRuntime");document.getElementById("heroCurrent144");document.getElementById("heroCurrent12");document.getElementById("heroBatteryCount");var hl=document.getElementById("powerDiagram"),ms=document.getElementById("powerDiagramBar"),cu=document.getElementById("maxPowerText"),Sl=document.getElementById("powerDiagramLegend");function aV(){}function iV(e={}){ji&&(ul(ji)?gi(ji):ji.removeAttribute&&ji.removeAttribute("open"),e.keepDismissed)}function pP(){ji&&iV({keepDismissed:!0})}Kl&&Kl.addEventListener("click",pP);ji&&ji.addEventListener("cancel",e=>{e.preventDefault(),pP()});function sV(e,t,r){const o=(t||[]).reduce((a,i)=>a+i.power,0);if(ps&&(ps.textContent=`${o.toFixed(0)} W`),!Ph)return;if(!e||e<=0){Ph.classList.add("hidden"),hl&&hl.classList.add("hidden"),ms&&(ms.innerHTML=""),Sl&&(Sl.innerHTML=""),cu&&(cu.textContent="",W1(cu));return}Ph.classList.remove("hidden"),hl&&hl.classList.remove("hidden"),ms&&(ms.innerHTML=""),Sl&&(Sl.innerHTML="");const n=o/e;if(ps&&(ps.classList.remove("glow-safe","glow-warning","glow-danger"),n>1?ps.classList.add("glow-danger"):n>=.8?ps.classList.add("glow-warning"):ps.classList.add("glow-safe")),iI&&(iI.textContent=`${e.toFixed(0)} W`),sI&&qu&&qu.options){const a=qu.options[qu.selectedIndex],i=a?a.text:"";sI.textContent=`Camera Setup draws ${o.toFixed(0)}W from the ${e.toFixed(0)}W available on the ${i} `}if(ms&&Sl){const a=100/Math.max(e,o),i=e*a,s=document.createElement("div");if(s.className="power-bar-inner",ms.appendChild(s),t.forEach(l=>{const d=l.power*a;if(d<=0)return;const p=document.createElement("div");p.className=`segment ${l.className} `,p.style.width=`${d}% `,p.setAttribute("title",`${l.label} ${l.power.toFixed(1)} W`),s.appendChild(p);const g=document.createElement("span"),h=document.createElement("span");h.className=`swatch ${l.className} `,g.appendChild(h),g.appendChild(document.createTextNode(l.label.replace(/:$/,""))),Sl.appendChild(g)}),o>e){const l=document.createElement("div");l.className="over-usage",l.style.left=`${i}% `,l.style.right="0",s.appendChild(l)}const u=document.createElement("div");if(u.className="limit-line",u.style.left=`${i}% `,typeof r=="number"&&r>0){const l=document.createElement("span");l.className="limit-label",l.textContent=`${c[rt].pinLabel} ${r} A`,u.appendChild(l)}ms.appendChild(u),hl&&hl.classList.toggle("over",o>e)}cu&&(cu.textContent="")}var za=document.getElementById("setupSelect"),zi=document.getElementById("setupName"),lV=document.getElementById("saveSetupBtn"),Ip=document.getElementById("deleteSetupBtn"),xh=document.getElementById("shareSetupBtn");document.getElementById("sharedLinkRow");var Tp=document.getElementById("sharedLinkInput");document.getElementById("shareLinkMessage");document.getElementById("shareDialog");document.getElementById("shareForm");const Mh=document.getElementById("shareDialogHeading");var lI=document.getElementById("shareFilename");const Dh=document.getElementById("shareFilenameLabel");var cV=document.getElementById("shareFilenameMessage"),uu=document.getElementById("shareCancelBtn");const vl=document.getElementById("shareConfirmBtn"),_h=document.getElementById("shareIncludeAutoGearText");var Fh=document.getElementById("shareIncludeAutoGearLabel");const Nh=document.getElementById("shareIncludeOwnedGearText");var Hh=document.getElementById("shareIncludeOwnedGearLabel"),cI=document.getElementById("shareIncludeAutoGear"),uI=document.getElementById("shareIncludeOwnedGear");lI&&cV&&lI.setAttribute("aria-describedby","shareFilenameMessage");var dI=document.getElementById("sharedImportDialog");document.getElementById("sharedImportForm");const jh=document.getElementById("sharedImportDialogHeading"),Op=document.getElementById("sharedImportDialogMessage"),du=document.getElementById("sharedImportMetadata"),fI=document.getElementById("sharedImportOptions"),fu=document.getElementById("sharedImportLegend");var Ks=document.getElementById("sharedImportModeSelect");const Al=document.getElementById("sharedImportModeNoneOption"),El=document.getElementById("sharedImportModeProjectOption"),Cl=document.getElementById("sharedImportModeGlobalOption"),Gp=document.getElementById("sharedImportConfirmBtn");var kp=document.getElementById("sharedImportCancelBtn");Ks&&Array.from(Ks.options||[]).forEach(e=>{e.value!=="none"&&(e.disabled=!0)});var zh=null;za&&za.value;var wl=document.getElementById("applySharedLinkBtn");const sd={setupName:"s",camera:"c",monitor:"m",video:"v",cage:"g",motors:"o",controllers:"r",distance:"d",batteryPlate:"p",battery:"b",batteryHotswap:"h",powerSelection:"w",projectInfo:"i",projectHtml:"q",gearSelectors:"e",gearList:"l",ownedGearMarkers:"u",changedDevices:"x",feedback:"f",autoGearRules:"a",autoGearCoverage:"z",diagramPositions:"y",metadata:"t",contacts:"n"},Yl=Object.keys(sd),Uh=Object.prototype.hasOwnProperty;function uV(e){return""}function dV(e){if(!du)return;const t=uV();t?(du.textContent=t,du.classList.remove("hidden")):(du.textContent="",du.classList.add("hidden"))}function fV(){dV()}function pV(){fV(),dI&&gi(dI),typeof pI=="function"&&pI([]),Tp&&(zh&&typeof Tp.removeEventListener=="function"&&Tp.removeEventListener("change",zh),Tp.value=""),zh=null}function pI(e){if(!Ks)return Array.isArray(e)&&e.length>0;const t=Array.isArray(e)&&e.length>0;return Array.from(Ks.options||[]).forEach(o=>{o.value==="none"?(o.disabled=!1,o.selected=!t):(o.disabled=!t,o.selected=t&&o.value==="project")}),t}function mP(e){if(!e||typeof e!="object")return{};const t={};for(let r=0;r<Yl.length;r+=1){const o=Yl[r];if(o==="gearList"||o==="projectHtml")continue;const n=e[o];n!=null&&(t[sd[o]]=n)}return t}function gP(e){if(!e||typeof e!="object")return{};let t=!1,r=!1;const o=[];for(let a=0;a<Yl.length;a+=1){const i=Yl[a],s=sd[i],u=Uh.call(e,i),l=Uh.call(e,s);u&&(t=!0),l&&(r=!0,!u&&e[s]!=null&&o.push(i))}if(!t&&!r)return{};if(!t){const a={};for(let i=0;i<Yl.length;i+=1){const s=Yl[i],u=sd[s],l=e[u];l!=null&&(a[s]=l)}return a}if(!o.length)return e;const n={...e};for(let a=0;a<o.length;a+=1){const i=o[a];if(!Uh.call(n,i)){const s=sd[i],u=e[s];u!=null&&(n[i]=u)}}return n}var $h=typeof $h<"u"&&$h?$h:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("device-manager"):null,qh=typeof qh<"u"&&qh?qh:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("toggleDeviceManager"):null,mI=null;function yP(){const e=document.getElementById("deviceListContainer");return e?(mI=e,e):mI}const Vn=(()=>{const e=typeof $e<"u"&&$e?$e:typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null;if(e&&e.deviceManagerLists&&e.deviceManagerLists instanceof Map)return e.deviceManagerLists;const t=new Map;if(e&&typeof e=="object")try{e.deviceManagerLists=t}catch{e.deviceManagerLists=t}return t})();var Ys=typeof $e<"u"&&$e?$e:typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null;function mV(e,t){if(!e||typeof e!="object")return;const r=(t||"").toLowerCase();Array.from(e.options||[]).forEach(o=>{if(!o||typeof o!="object")return;const n=o.value==="None"||r===""||(o.textContent||"").toLowerCase().includes(r);o.hidden=!n,o.disabled=!n})}function bP(e,t){if(!e||typeof e!="object")return;const r=(t||"").toLowerCase();Array.from(e.querySelectorAll?e.querySelectorAll("li"):[]).forEach(o=>{if(!o||typeof o!="object")return;const n=o.querySelector?o.querySelector(".device-summary span"):null,a=n&&typeof n.textContent=="string"?n.textContent.toLowerCase():"";o.style.display=r===""||a.includes(r)?"":"none"})}function hP(e,t){if(!e||typeof e!="object"||typeof e.insertAdjacentElement!="function")return;const r=typeof c=="object"&&c||typeof window<"u"&&typeof window.texts=="object"&&window.texts||null,o=r&&r[rt]&&r[rt].clearFilter||"Clear filter",n=document.createElement("button");n.type="button",n.className="clear-input-btn",n.innerHTML=wa(ICON_GLYPHS.circleX,"clear-icon"),n.setAttribute("aria-label",o),n.title=o,n.hidden=!0,n.addEventListener("click",()=>{e.value="",typeof t=="function"&&t(),typeof e.focus=="function"&&e.focus()}),e.insertAdjacentElement("afterend",n);const a=()=>{n.hidden=!e.value};e.addEventListener("input",a),a()}function gV(e,t){if(!e||typeof e!="object")return;const r=typeof t=="function"?t:()=>{};e.addEventListener("input",r),e.addEventListener("keydown",o=>{o&&o.key==="Escape"&&(e.value="",r())}),hP(e,r)}function SP(){const e=Ys&&typeof Ys=="object"?Ys:{},t=(r,o)=>{if(typeof e[r]!="function")try{e[r]=o}catch{try{Object.defineProperty(e,r,{configurable:!0,writable:!0,value:o})}catch{}}};return t("filterSelect",mV),t("filterDeviceList",bP),t("bindFilterInput",gV),t("addInputClearButton",hP),e}SP();function yV(){const e=SP(),t=typeof e.filterDeviceList=="function"?e.filterDeviceList:bP;Vn instanceof Map&&Vn.forEach(r=>{if(!r||typeof r!="object")return;const{list:o,filterInput:n}=r;if(!o||typeof o!="object")return;const a=n&&typeof n.value=="string"?n.value:"";try{t(o,a)}catch(i){console.warn("Failed to apply device manager filters",i)}})}const bV=Object.freeze(["cameras","viewfinders","monitors","video","wirelessReceivers","directorMonitors","iosVideo","lenses","fiz.motors","fiz.controllers","fiz.handUnits","fiz.distance","batteries","batteryHotswaps","accessories.batteries","accessories.powerPlates","accessories.cables","accessories.cages","accessories.cameraSupport","accessories.cameraStabiliser","accessories.chargers","accessories.videoAssist","accessories.media","accessories.cardReaders","accessories.filters","accessories.matteboxes","accessories.rigging","accessories.grip","accessories.sliders","accessories.tripodHeads","accessories.tripods","accessories.carts"]);function hV(){const e=Ys,t=e&&Array.isArray(e.deviceManagerPreferredOrder)?e.deviceManagerPreferredOrder:null;return t&&t.every(r=>typeof r=="string"&&r)?t:bV}function SV(e){return!e||e==="accessories"||e==="fiz"||e==="filterOptions"?null:e.startsWith("accessories.cables.")?"accessories.cables":e==="videoAssist"&&Et?.accessories?.videoAssist?"accessories.videoAssist":e==="media"&&Et?.accessories?.media?"accessories.media":e==="cardReaders"&&Et?.accessories?.cardReaders?"accessories.cardReaders":e}function ld(e,t=rt){if(!e)return"";const r=typeof categoryNames=="object"&&categoryNames&&categoryNames[t]||{};if(r[e])return r[e];const o=typeof categoryNames=="object"&&categoryNames&&categoryNames.en||{};return o[e]?o[e]:e==="batteries"||e==="accessories.batteries"?t==="en"?"Battery":t==="de"?"Akku":"Battery":e.split(".").map(a=>f0(a)).join(" ")}function vP(){const e=new Set,t=s=>{const u=SV(s);u&&e.add(u)},r=(s,u=[])=>{if(!(u.length>20)&&!(!s||typeof s!="object")){if(Array.isArray(s.attributes)){const l=u.length,d=u[0];(l===1||l>1&&(d==="accessories"||d==="fiz"))&&t(u.join("."))}Object.entries(s).forEach(([l,d])=>{l!=="attributes"&&d&&typeof d=="object"&&r(d,u.concat(l))})}};Hr&&r(Hr,[]),(s=>{!s||typeof s!="object"||Array.isArray(s)||Object.entries(s).forEach(([u,l])=>{u==="accessories"?l&&typeof l=="object"&&Object.entries(l).forEach(([d,p])=>{p&&typeof p=="object"&&!Array.isArray(p)&&t(`accessories.${d} `)}):u==="fiz"?l&&typeof l=="object"&&Object.entries(l).forEach(([d,p])=>{p&&typeof p=="object"&&!Array.isArray(p)&&t(`fiz.${d} `)}):l&&typeof l=="object"&&!Array.isArray(l)&&t(u)})})(Et);const n=Array.from(e),a=hV(),i=new Map(a.map((s,u)=>[s,u]));return n.sort((s,u)=>{const l=i.has(s)?i.get(s):a.length,d=i.has(u)?i.get(u):a.length;return l!==d?l-d:s.localeCompare(u)}),n}function vV(e){const t=yP();if(!t||Vn.has(e))return Vn.get(e)||null;const r=document.createElement("div");r.className="device-category";const o=e.replace(/[^a-z0-9]+/gi,"_"),n=document.createElement("h4");n.id=`category_${o} `,n.dataset.categoryKey=e,r.appendChild(n);const a=document.createElement("input");a.type="search",a.className="list-filter",a.id=`${o} ListFilter`,a.dataset.categoryKey=e;const i=da(To(a,`${o} -list - filter`),`Filter ${e} `);r.appendChild(i),r.appendChild(a);const s=document.createElement("ul");s.className="device-ul";const u=o==="cameras"?"cameraList":`${o} List`;s.id=u,o==="cameras"&&s.setAttribute("data-current-id","camerasList"),r.appendChild(s),t.appendChild(r);const l=()=>typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null,d=()=>{const g=l(),h=g&&g.bindFilterInput,A=g&&g.filterDeviceList;return typeof h!="function"||typeof A!="function"?!1:(h(a,()=>A(s,a.value)),!0)};d()||Fi(()=>{d()});const p={section:r,heading:n,filterInput:a,filterLabel:i,list:s,sanitizedId:o};return Vn.set(e,p),p}function AP(e=rt){if(!Vn.size)return;const t=c[e]&&c[e].placeholder_filter||"Filter {item}...",r=c[e]&&c[e].clearFilter||"Clear filter",o=document.getElementById("deviceLibrarySearch"),n=document.getElementById("deviceLibrarySearchLabel"),a=c[e]&&c[e].deviceLibrarySearchHelp||"Filter all categories and press Enter to jump to the best match.",i=c[e]&&c[e].deviceLibrarySearchPlaceholder||"Search all device categories…",s=c[e]&&c[e].deviceLibrarySearchLabel||"Search entire library";n&&(n.textContent=s),o&&(o.placeholder=i,o.setAttribute("aria-label",i),o.setAttribute("data-help",a),o.setAttribute("autocomplete","off"),o.setAttribute("autocorrect","off"),o.setAttribute("autocapitalize","off"),o.setAttribute("spellcheck","false")),Vn.forEach((l,d)=>{const p=ld(d,e);if(l.heading&&(l.heading.textContent=p),l.filterInput){const g=t.replace("{item}",p.toLowerCase());if(l.filterInput.placeholder=g,l.filterInput.setAttribute("aria-label",g),l.filterInput.setAttribute("autocomplete","off"),l.filterInput.setAttribute("autocorrect","off"),l.filterInput.setAttribute("autocapitalize","off"),l.filterInput.setAttribute("spellcheck","false"),l.filterInput.setAttribute("inputmode","search"),l.filterLabel){const A=g.replace(/\s*(?:\.{3}|\u2026)$/,"");l.filterLabel.textContent=A}const h=l.filterInput.nextElementSibling;h&&h.classList.contains("clear-input-btn")&&(h.setAttribute("aria-label",r),h.title=r)}});const u=Ys&&typeof Ys.updateDeviceLibrarySearchLocalization=="function"?Ys.updateDeviceLibrarySearchLocalization:null;u&&u()}function AV(){const e=yP();if(!e)return;const t=vP(),r=new Set(t),o=Array.from(Vn.keys());t.forEach(n=>{Vn.has(n)||vV(n)}),o.forEach(n=>{if(!r.has(n)){const a=Vn.get(n);a&&a.section&&a.section.parentNode&&a.section.parentNode.removeChild(a.section),Vn.delete(n)}}),t.forEach(n=>{const a=Vn.get(n);a&&a.section&&e.appendChild(a.section)}),AP(rt)}St("syncDeviceManagerCategories",AV);function EV(){const e=(zi&&typeof zi.value=="string"?zi.value.trim():"")||"";return e||za&&za.value||""}St("getCurrentProjectName",EV);var Nn=document.getElementById("newCategory");document.getElementById("newSubcategory");document.getElementById("subcategoryField");var Vh=document.getElementById("newName"),Wh=document.getElementById("newWatt"),gI=document.getElementById("wattField");document.getElementById("dynamicFields");document.getElementById("cameraFields");document.getElementById("cameraWatt");var Kh=document.getElementById("cameraVoltage");document.getElementById("cameraPortType");document.getElementById("monitorFields");document.getElementById("monitorScreenSize");document.getElementById("monitorBrightness");document.getElementById("monitorWatt");var Yh=document.getElementById("monitorVoltage");document.getElementById("monitorPortType");document.getElementById("monitorVideoInputsContainer");document.getElementById("lensFields");document.getElementById("lensMountOptionsContainer");function EP(){if(!Nn&&typeof document<"u"&&(Nn=document.getElementById("newCategory")),!Nn)return;Nn.options?Nn.options.length=0:Nn.innerHTML="";const e=t=>{const r=document.createElement("option");r.value=t,r.textContent=ld(t,rt),Nn.appendChild(r)};if(Hr){const t=new Set;if(Hr.accessories)for(const[o,n]of Object.entries(Hr.accessories))o==="cables"?t.add("accessories.cables"):n&&n.attributes&&t.add(`accessories.${o}`);for(const[o,n]of Object.entries(Hr))o==="accessories"||o==="fiz"||n&&n.attributes&&t.add(o);const r=Array.from(t).sort((o,n)=>{const a=ld(o,rt),i=ld(n,rt);return a.localeCompare(i,rt)});for(const o of r)e(o);if(Hr.fiz)for(const[o,n]of Object.entries(Hr.fiz))n&&n.attributes&&e(`fiz.${o}`);if(Nn&&typeof Nn.dispatchEvent=="function")try{Nn.dispatchEvent(new Event("change",{bubbles:!0}))}catch(o){console.warn("Failed to dispatch change event in populateCategoryOptions",o)}}if(typeof Et=="object"){const t=new Set(Nn.options?Array.from(Nn.options).map(o=>o.value):[]),r=o=>{t.has(o)||(e(o),t.add(o))};for(const[o,n]of Object.entries(Et))if(o==="accessories")for(const a of Object.keys(n||{}))r(`accessories.${a}`);else if(o==="fiz")for(const a of Object.keys(n||{}))r(`fiz.${a}`);else n&&typeof n=="object"&&!Array.isArray(n)&&r(o)}}EP();function CP(e,t,{create:r=!1}={}){if(!e)return null;if(e==="accessories.cables"){if(!t)return null;if(!Et.accessories){if(!r)return null;Et.accessories={}}if(!Et.accessories.cables){if(!r)return null;Et.accessories.cables={}}if(!Et.accessories.cables[t]){if(!r)return null;Et.accessories.cables[t]={}}return Et.accessories.cables[t]}if(e.includes(".")){const[o,n]=e.split("."),a=n&&n.trim();if(!Et[o]){if(!r)return null;Et[o]={}}if(!Et[o][a]){if(!r)return null;Et[o][a]={}}return Et[o][a]}if(!Et[e]){if(!r)return null;Et[e]={}}return Et[e]}function CV(e,t,r,o,n,a){if(!e||!r||!(e!==o)&&!(e==="accessories.cables"&&t!==n)&&!(r!==a))return;const l=CP(e,e==="accessories.cables"?t:null,{create:!1});if(!(!l||!Object.prototype.hasOwnProperty.call(l,r))&&(delete l[r],e==="accessories.cables"&&t&&Et.accessories?.cables)){const d=Et.accessories.cables[t];(!d||typeof d!="object")&&(Et.accessories.cables[t]={})}}document.getElementById("monitorVideoOutputsContainer");St("getCategoryContainer",CP);St("removeOriginalDeviceEntry",CV);document.getElementById("monitorWirelessTx");var Ll=document.getElementById("monitorLatency");document.getElementById("monitorAudioOutput");document.getElementById("viewfinderFields");document.getElementById("viewfinderScreenSize");document.getElementById("viewfinderBrightness");document.getElementById("viewfinderWatt");document.getElementById("viewfinderVoltage");document.getElementById("viewfinderPortType");document.getElementById("viewfinderVideoInputsContainer");document.getElementById("viewfinderVideoOutputsContainer");document.getElementById("viewfinderWirelessTx");var Rl=document.getElementById("viewfinderLatency");document.getElementById("videoFields");document.getElementById("videoPowerInputsContainer");document.getElementById("videoVideoInputsContainer");document.getElementById("videoVideoOutputsContainer");document.getElementById("videoFrequency");document.getElementById("videoLatency");function wV(){return{min:typeof FEEDBACK_TEMPERATURE_MIN_VALUE=="number"?FEEDBACK_TEMPERATURE_MIN_VALUE:typeof FEEDBACK_TEMPERATURE_MIN=="number"?FEEDBACK_TEMPERATURE_MIN:-20,max:typeof FEEDBACK_TEMPERATURE_MAX_VALUE=="number"?FEEDBACK_TEMPERATURE_MAX_VALUE:typeof FEEDBACK_TEMPERATURE_MAX_LIMIT=="number"?FEEDBACK_TEMPERATURE_MAX_LIMIT:50}}function wP(e){if(!e)return;const{min:t,max:r}=wV(),o=r-t+2,n=e.getAttribute("data-temp-min"),a=e.getAttribute("data-temp-max");if(e.options.length===o&&n===String(t)&&a===String(r))return;const i=e.value;e.innerHTML="";const s=document.createElement("option");s.value="",s.textContent="",e.appendChild(s);for(let u=t;u<=r;u+=1){const l=document.createElement("option");l.value=String(u),l.textContent=String(u),e.appendChild(l)}e.setAttribute("data-temp-min",String(t)),e.setAttribute("data-temp-max",String(r)),i&&Array.from(e.options).find(l=>l.value===i)&&(e.value=i)}function Vu(e=rt,t){const r=IV(e,typeof t>"u"?dl():t),o=document.getElementById("fbTemperatureLabelText");o&&(o.textContent=`${r}:`),document.querySelectorAll('a.help-link[href="#fbTemperature"]').forEach(a=>{a&&(a.textContent=r)})}function Dm(e=rt,t){const r=document.getElementById("fbTemperature");if(!r)return;wP(r);const o=typeof e=="string"?e:rt,n=typeof t>"u"?dl():t,a=xC(o,n);Array.from(r.options).forEach(i=>{if(!i)return;if(i.value===""){i.textContent="";return}const s=Number(i.value);if(!Number.isFinite(s)){i.textContent=i.value;return}const u=typeof yI=="function"?yI(s,{unit:n,lang:o,includeSign:!1}):"";i.textContent=u||`${s} ${a}`.trim()})}typeof window<"u"&&(window.ensureFeedbackTemperatureOptions=wP,window.refreshFeedbackTemperatureLabel=Vu,window.updateFeedbackTemperatureOptions=Dm);function _c(e){if(typeof e=="string"){const t=e.trim().toLowerCase();if(t===oo.fahrenheit)return oo.fahrenheit;if(t===oo.celsius)return oo.celsius}return e===oo.fahrenheit?oo.fahrenheit:oo.celsius}function dl(){const e=[];typeof temperatureUnit<"u"&&e.push(temperatureUnit),typeof $e<"u"&&$e&&typeof $e=="object"&&e.push($e.temperatureUnit),typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"&&e.push(globalThis.temperatureUnit),typeof window<"u"&&window&&typeof window=="object"&&e.push(window.temperatureUnit),typeof self<"u"&&self&&typeof self=="object"&&e.push(self.temperatureUnit),typeof global<"u"&&global&&typeof global=="object"&&e.push(global.temperatureUnit);for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r=="string"&&r)return r}return oo.celsius}function LV(e,t){const r=Number(e);return Number.isFinite(r)?_c(typeof t>"u"?dl():t)===oo.fahrenheit?r*9/5+32:r:Number.NaN}function xC(e=rt,t){const r=_c(typeof t>"u"?dl():t),o=getLanguageTexts(e),n=getLanguageTexts("en"),a=r===oo.fahrenheit?"temperatureUnitSymbolFahrenheit":"temperatureUnitSymbolCelsius";return o[a]||n[a]||(r===oo.fahrenheit?"°F":"°C")}function RV(e=rt,t){const r=_c(typeof t>"u"?dl():t),o=getLanguageTexts(e),n=getLanguageTexts("en"),a=r===oo.fahrenheit?"temperatureUnitFahrenheit":"temperatureUnitCelsius";return o[a]||n[a]||(r===oo.fahrenheit?"Fahrenheit (°F)":"Celsius (°C)")}function IV(e=rt,t){const r=getLanguageTexts(e),o=getLanguageTexts("en"),n=r.temperatureLabel||o.temperatureLabel||"Temperature",a=xC(e,typeof t>"u"?dl():t);return`${n} (${a})`}function yI(e,t={}){const{unit:r,lang:o=rt,includeSign:n=!0}=t||{},a=_c(typeof r>"u"?dl():r);let i=LV(e,a);if(!Number.isFinite(i))return"";const s=getLanguageTexts(o),u=getLanguageTexts("en"),l=a===oo.fahrenheit?s.temperatureFormatterFahrenheit||u.temperatureFormatterFahrenheit:s.temperatureFormatterCelsius||u.temperatureFormatterCelsius;if(typeof l=="function")return l(i,{includeSign:n});const d=Math.round(i*10)/10,p=n&&d>0?`+ ${d} `:String(d),g=xC(o,a);return`${p} ${g} `.trim()}(function(){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{},r=typeof document<"u"&&!!document&&typeof document.createElement=="function",o=(Q,ne)=>{if(typeof t[Q]=="function")return t[Q];const V=typeof ne=="function"?ne():ne;if(typeof V=="function")try{t[Q]=V}catch{}return V},n=(Q,ne)=>{if(Array.isArray(t[Q]))return t[Q];const V=Array.isArray(ne)?ne.slice():[];try{t[Q]=V}catch{t[Q]=V}return t[Q]},a=["3G-SDI","6G-SDI","12G-SDI","Mini BNC","HDMI","Mini HDMI","Micro HDMI"],i=["Electronic Viewfinder","Optical Viewfinder","LCD Monitor","OLED Viewfinder"],s=["BNC","Mini BNC","HDMI","Mini HDMI","Micro HDMI"],u=typeof localeSort=="function"?localeSort:(Q,ne)=>String(Q||"").localeCompare(String(ne||""),void 0,{sensitivity:"base"}),l=()=>typeof Et<"u"&&Et&&typeof Et=="object"?Et:{},d=(Q,ne)=>{const V=new Set((Q||[]).filter(Boolean));try{ne(V)}catch{}return Array.from(V).filter(Boolean).sort(u)},p=()=>{const Q=d(i,ne=>{const V=l();Object.values(V.cameras||{}).forEach(fe=>{if(!fe)return;(Array.isArray(fe.viewfinder)?fe.viewfinder:[]).forEach(Ae=>{const Le=typeof Ae?.type=="string"?Ae.type.trim():"";Le&&ne.add(Le)})})});return n("viewfinderTypeOptions",Q),Q},g=()=>{const Q=d(s,ne=>{const V=l();Object.values(V.cameras||{}).forEach(fe=>{if(!fe)return;(Array.isArray(fe.viewfinder)?fe.viewfinder:[]).forEach(Ae=>{const Le=typeof Ae?.connector=="string"?Ae.connector.trim():"";Le&&ne.add(Le)})})});return n("viewfinderConnectorOptions",Q),Q},h=()=>d(a,ne=>{const V=l(),fe=J=>{Array.isArray(J)&&J.forEach(Ae=>{if(typeof Ae=="string"){const Je=Ae.trim();Je&&ne.add(Je);return}const Le=typeof Ae?.type=="string"?Ae.type.trim():"";Le&&ne.add(Le);const _e=typeof Ae?.portType=="string"?Ae.portType.trim():"";_e&&ne.add(_e)})};Object.values(V.cameras||{}).forEach(J=>{J&&(fe(J.videoInputs),fe(J.videoOutputs))}),Object.values(V.monitors||{}).forEach(J=>{J&&(fe(J.videoInputs),fe(J.videoOutputs))})});if(o("getAllViewfinderTypes",()=>p),o("getAllViewfinderConnectors",()=>g),!r){o("setViewfinders",()=>function(){}),o("getViewfinders",()=>function(){return[]}),o("clearViewfinders",()=>function(){}),o("setViewfinderVideoInputs",()=>function(){}),o("getViewfinderVideoInputs",()=>function(){return[]}),o("clearViewfinderVideoInputs",()=>function(){}),o("setViewfinderVideoOutputs",()=>function(){}),o("getViewfinderVideoOutputs",()=>function(){return[]}),o("clearViewfinderVideoOutputs",()=>function(){});return}const A=Q=>{if(!r||typeof document?.getElementById!="function")return null;try{return document.getElementById(Q)}catch{return null}},m=A("viewfinderContainer"),y=A("viewfinderVideoInputsContainer"),S=A("viewfinderVideoOutputsContainer");if([["setViewfinders",m],["getViewfinders",m],["clearViewfinders",m]].some(([Q,ne])=>ne?!1:(o(Q,()=>Q==="getViewfinders"?()=>[]:()=>{}),!0)))return;let L=0;const R=(Q,ne)=>{if(!Q)return"";if(Q.id)return Q.id;const V=typeof ne=="string"&&ne?ne:"field";L+=1;const fe=`${V.toLowerCase().replace(/[^a-z0-9]+/g,"-")||"field"} -${L} `;try{Q.id=fe}catch{}return Q.id||fe},G=(Q,ne)=>{const V=document.createElement("label");return V.className="visually-hidden",Q&&V.setAttribute("for",Q),V.textContent=typeof ne=="string"?ne:"",V},j=(Q,ne)=>{const V=document.createElement("div");V.className="field-with-label",V.dataset.label=ne;const fe=R(Q,ne);return V.appendChild(G(fe,ne)),V.appendChild(Q),V},$=(Q,ne,V)=>{if(!Q)return;const fe=new Set;Q.innerHTML="";const J=(Ae,Le)=>{if(fe.has(Ae))return;const _e=document.createElement("option");_e.value=Ae,_e.textContent=typeof Le=="string"?Le:Ae,Q.appendChild(_e),fe.add(Ae)};J("",""),ne.forEach(Ae=>{if(typeof Ae!="string")return;const Le=Ae.trim();Le&&J(Le,Le)}),typeof V=="string"&&V&&!fe.has(V)&&J(V,V),Q.value=typeof V=="string"?V:""},z=(Q="",ne="",V="",fe="")=>{const J=document.createElement("div");J.className="form-row";const Ae=document.createElement("select");Ae.className="viewfinder-type-select",Ae.name="viewfinderType",$(Ae,p(),typeof Q=="string"?Q.trim():""),J.appendChild(j(Ae,"Type"));const Le=document.createElement("input");Le.type="text",Le.name="viewfinderResolution",Le.placeholder="Resolution",Le.value=typeof ne=="string"?ne:"",J.appendChild(j(Le,"Resolution"));const _e=document.createElement("select");_e.className="viewfinder-connector-select",_e.name="viewfinderConnector",$(_e,g(),typeof V=="string"?V.trim():""),J.appendChild(j(_e,"Connector"));const Je=document.createElement("input");Je.type="text",Je.name="viewfinderNotes",Je.placeholder="Notes",Je.value=typeof fe=="string"?fe:"",J.appendChild(j(Je,"Notes"));const xe=document.createElement("button");xe.type="button",Wl(xe,ICON_GLYPHS.add,{contextPaths:["viewfinderHeading",["cameraViewfinderLabel"]],fallbackContext:"Viewfinder",actionKey:"addEntry"}),xe.addEventListener("click",()=>{J.after(z())}),J.appendChild(xe);const Ze=document.createElement("button");return Ze.type="button",Wl(Ze,ICON_GLYPHS.minus,{contextPaths:["viewfinderHeading",["cameraViewfinderLabel"]],fallbackContext:"Viewfinder",actionKey:"removeEntry"}),Ze.addEventListener("click",()=>{m&&m.children.length>1?J.remove():Array.from(J.querySelectorAll("select, input")).forEach(Ve=>{Ve&&(Ve.value="")})}),J.appendChild(Ze),J},te=(Q,ne,V,fe,J,Ae="")=>{if(!Q)return null;const Le=document.createElement("div");Le.className="form-row";const _e=document.createElement("select");_e.name=ne,_e.className=`${ne} -select`,$(_e,h(),typeof Ae=="string"?Ae.trim():""),Le.appendChild(j(_e,"Type"));const Je=document.createElement("button");Je.type="button",Wl(Je,ICON_GLYPHS.add,{contextPaths:[V,[fe]],fallbackContext:J,actionKey:"addEntry"}),Je.addEventListener("click",()=>{Le.after(te(Q,ne,V,fe,J))}),Le.appendChild(Je);const xe=document.createElement("button");return xe.type="button",Wl(xe,ICON_GLYPHS.minus,{contextPaths:[V,[fe]],fallbackContext:J,actionKey:"removeEntry"}),xe.addEventListener("click",()=>{Q.children.length>1?Le.remove():_e.value=""}),Le.appendChild(xe),Le},oe=Q=>{if(!m)return;m.innerHTML="";const ne=Array.isArray(Q)?Q:[];if(!ne.length){m.appendChild(z());return}ne.forEach(V=>{const fe=typeof V?.type=="string"?V.type:"",J=typeof V?.resolution=="string"?V.resolution:"",Ae=typeof V?.connector=="string"?V.connector:"",Le=typeof V?.notes=="string"?V.notes:"";m.appendChild(z(fe,J,Ae,Le))})},k=()=>m?Array.from(m.querySelectorAll(".form-row")).map(Q=>{const[ne,V,fe,J]=Q.querySelectorAll("select, input");return{type:ne?ne.value:"",resolution:V?V.value:"",connector:fe?fe.value:"",notes:J?J.value:""}}).filter(Q=>Q.type):[],Z=()=>{oe([])},ue=Q=>{if(!y)return;y.innerHTML="";const ne=Array.isArray(Q)?Q:[];if(!ne.length){const V=te(y,"viewfinderVideoInput","viewfinderVideoInputsHeading","viewfinderVideoInputsLabel","Video Inputs");V&&y.appendChild(V);return}ne.forEach(V=>{const fe=typeof V=="string"?V:typeof V?.type=="string"?V.type:"",J=te(y,"viewfinderVideoInput","viewfinderVideoInputsHeading","viewfinderVideoInputsLabel","Video Inputs",fe);J&&y.appendChild(J)})},H=()=>y?Array.from(y.querySelectorAll("select")).map(Q=>({type:Q.value})).filter(Q=>Q.type):[],Y=()=>{ue([])},N=Q=>{if(!S)return;S.innerHTML="";const ne=Array.isArray(Q)?Q:[];if(!ne.length){const V=te(S,"viewfinderVideoOutput","viewfinderVideoOutputsHeading","viewfinderVideoOutputsLabel","Video Outputs");V&&S.appendChild(V);return}ne.forEach(V=>{const fe=typeof V=="string"?V:typeof V?.type=="string"?V.type:"",J=te(S,"viewfinderVideoOutput","viewfinderVideoOutputsHeading","viewfinderVideoOutputsLabel","Video Outputs",fe);J&&S.appendChild(J)})},ae=()=>S?Array.from(S.querySelectorAll("select")).map(Q=>({type:Q.value})).filter(Q=>Q.type):[],de=()=>{N([])};o("setViewfinders",()=>oe),o("getViewfinders",()=>k),o("clearViewfinders",()=>Z),o("setViewfinderVideoInputs",()=>ue),o("getViewfinderVideoInputs",()=>H),o("clearViewfinderVideoInputs",()=>Y),o("setViewfinderVideoOutputs",()=>N),o("getViewfinderVideoOutputs",()=>ae),o("clearViewfinderVideoOutputs",()=>de),m&&!m.children.length&&oe([]),y&&!y.children.length&&ue([]),S&&!S.children.length&&N([])})();gI&&gI.parentNode;function bI(e,t){const r=document.getElementById("addDeviceForm"),o=document.getElementById("wattField"),n=document.getElementById("videoFields"),a=document.getElementById("cameraFields");if(!o||!r)return;const i=e==="video"||e==="wirelessReceivers"||e==="iosVideo";try{i&&n&&n.parentNode===r?r.insertBefore(o,n):a&&a.parentNode===r?r.insertBefore(o,a):r.appendChild(o)}catch(s){console.warn("placeWattField failed to insert element safely",s)}}try{St("placeWattField",bI)}catch{typeof window<"u"&&(window.placeWattField=bI)}document.getElementById("motorFields");document.getElementById("motorConnector");document.getElementById("motorInternal");document.getElementById("motorTorque");document.getElementById("motorGearTypes");document.getElementById("motorNotes");document.getElementById("controllerFields");document.getElementById("controllerConnector");document.getElementById("controllerPower");document.getElementById("controllerBattery");document.getElementById("controllerConnectivity");document.getElementById("controllerNotes");document.getElementById("distanceFields");document.getElementById("distanceConnection");document.getElementById("distanceMethod");document.getElementById("distanceRange");document.getElementById("distanceAccuracy");document.getElementById("distanceOutput");document.getElementById("distanceNotes");document.getElementById("batteryPlatesContainer");document.getElementById("cameraMediaContainer");document.getElementById("lensMountContainer");var Ui=document.getElementById("lensFocusScaleUnit");document.getElementById("powerDistContainer");document.getElementById("videoOutputsContainer");document.getElementById("fizConnectorContainer");document.getElementById("viewfinderContainer");document.getElementById("timecodeContainer");document.getElementById("batteryFields");var Qh=document.getElementById("newCapacity"),Xh=document.getElementById("newPinA"),cd=document.getElementById("newDtapA");cd&&cd.parentElement;document.getElementById("addDeviceBtn");document.getElementById("cancelEditBtn");document.getElementById("exportDataBtn");document.getElementById("exportOutput");document.getElementById("importFileInput");document.getElementById("importDataBtn");var hI=document.getElementById("skipLink");function hA(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,r=(e&&typeof e.focusScalePreference=="string"?e.focusScalePreference:null)||(typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";if(typeof normalizeFocusScale=="function")try{const n=normalizeFocusScale(r);if(n==="imperial"||n==="metric")return n}catch{}return(typeof r=="string"?r.trim().toLowerCase():"")==="imperial"?"imperial":"metric"}function TV(e=rt,{preserveValue:t=!0}={}){if(!Ui)return;const r=t?Ui.value:"",o=typeof e=="string"?e:rt,n=c&&o&&c[o]?c[o]:c?.en||{},a=n.lensFocusScaleDefault||n.focusScaleSetting||"Use global focus scale",i=n.focusScaleMetric||"Metric",s=n.focusScaleImperial||"Imperial",l=hA()==="imperial"?`${a} (${s})`:`${a} (${i})`,d=r&&(r==="metric"||r==="imperial")?r:"";Ui.innerHTML="";const p=(g,h)=>{const A=document.createElement("option");A.value=g,A.textContent=h,Ui.appendChild(A)};p("",l),p("metric",i),p("imperial",s),Ui.value=d}var SI=document.getElementById("languageSelect"),ar=document.getElementById("settingsTablist"),Bp=document.getElementById("pinkModeToggle");document.getElementById("pinkModeHelpIcon");var Pp=document.getElementById("darkModeToggle"),Mi=document.getElementById("helpButton"),ia=document.getElementById("reloadButton");document.getElementById("helpDialog");var pu=document.getElementById("closeHelp"),xp=document.getElementById("helpSearch"),vI=document.getElementById("helpNoResults");document.getElementById("helpNoResultsSuggestions");var AI=document.getElementById("helpNoResultsSuggestionsHeading"),EI=document.getElementById("helpNoResultsSuggestionsIntro"),OV=document.getElementById("helpNoResultsSuggestionClear"),GV=document.getElementById("helpNoResultsSuggestionSynonyms"),kV=document.getElementById("helpNoResultsSuggestionQuickStart"),BV=document.getElementById("helpNoResultsSuggestionBackup"),Zh=document.getElementById("helpDataAuditHeading"),PV=document.getElementById("helpDataAuditStep1"),xV=document.getElementById("helpDataAuditStep2"),MV=document.getElementById("helpDataAuditStep3"),DV=document.getElementById("helpDataAuditStep4"),Jh=document.getElementById("helpDataAuditNote");document.getElementById("helpResultsSummary");document.getElementById("helpResultsAssist");var Mp=document.getElementById("helpSearchClear");document.getElementById("helpSections");document.getElementById("helpQuickLinks");document.getElementById("helpQuickLinksHeading");document.getElementById("helpQuickLinksList");var vo,ud,Ua,dd,Ko,ko,fd,pd,dc,md,fc,pc,mc,_s,gc,qn,Aa=document.getElementById("iosPwaHelpDialog"),gd,yd,bd,eS=!1;function Ii(){if(!(eS&&vo)){if(typeof document>"u"){eS=!0,vo=vo||null,ud=ud||null,Ua=Ua||null,dd=dd||null,Ko=Ko||null,ko=ko||null,fd=fd||null,pd=pd||null,dc=dc||null,md=md||null,fc=fc||null,pc=pc||null,mc=mc||null,_s=_s||null,gc=gc||null,qn=qn||null,gd=gd||null,yd=yd||null,bd=bd||null;return}vo=document.getElementById("installPromptBanner"),ud=document.getElementById("installPromptBannerText"),Ua=document.getElementById("installPromptBannerAction"),dd=document.getElementById("installPromptBannerIcon"),Ko=document.getElementById("installPromptBannerDismiss"),ko=document.getElementById("installGuideDialog"),fd=document.getElementById("installGuideTitle"),pd=document.getElementById("installGuideIntro"),dc=document.getElementById("installGuideSteps"),md=document.getElementById("installGuideNote"),fc=document.getElementById("installGuideMigration"),pc=document.getElementById("installGuideMigrationTitle"),mc=document.getElementById("installGuideMigrationIntro"),_s=document.getElementById("installGuideMigrationSteps"),gc=document.getElementById("installGuideMigrationNote"),qn=document.getElementById("installGuideClose"),gd=document.getElementById("iosPwaHelpTitle"),yd=document.getElementById("iosPwaHelpIntro"),bd=document.getElementById("iosPwaHelpStep1"),eS=!0}}const _V=(typeof globalThis<"u"&&globalThis&&typeof globalThis.syncMountVoltageResetButtonGlobal=="function"?globalThis.syncMountVoltageResetButtonGlobal:null)||(typeof syncMountVoltageResetButtonGlobal=="function"?syncMountVoltageResetButtonGlobal:function(){}),FV=document.getElementById("mountVoltageSettings"),NV=document.getElementById("mountVoltageHeading"),HV=document.getElementById("mountVoltageDescription"),jV=document.getElementById("mountVoltageNote"),LP=document.getElementById("mountVoltageReset");_V(LP);const zV={V:document.getElementById("mountVoltageVTitle"),Gold:document.getElementById("mountVoltageGoldTitle"),B:document.getElementById("mountVoltageBTitle")},CI={"V-Mount":{high:document.getElementById("mountVoltageVHigh"),low:document.getElementById("mountVoltageVLow"),highLabel:document.getElementById("mountVoltageVHighLabel"),lowLabel:document.getElementById("mountVoltageVLowLabel")},"Gold-Mount":{high:document.getElementById("mountVoltageGoldHigh"),low:document.getElementById("mountVoltageGoldLow"),highLabel:document.getElementById("mountVoltageGoldHighLabel"),lowLabel:document.getElementById("mountVoltageGoldLowLabel")},"B-Mount":{high:document.getElementById("mountVoltageBHigh"),low:document.getElementById("mountVoltageBLow"),highLabel:document.getElementById("mountVoltageBHighLabel"),lowLabel:document.getElementById("mountVoltageBLowLabel")}},tS=typeof setMountVoltageDomReferences=="function"?{setDomReferences:setMountVoltageDomReferences}:$e&&typeof $e=="object"&&$e.cineCoreMountVoltage&&typeof $e.cineCoreMountVoltage.setMountVoltageDomReferences=="function"?{setDomReferences:$e.cineCoreMountVoltage.setMountVoltageDomReferences}:null;if(tS&&typeof tS.setDomReferences=="function")tS.setDomReferences({section:FV,heading:NV,description:HV,note:jV,resetButton:LP,titles:zV,inputs:CI});else if($e&&typeof $e=="object")try{$e.mountVoltageInputs=CI}catch{}typeof updateMountVoltageInputsFromState=="function"&&updateMountVoltageInputsFromState();typeof updateMountVoltageSettingLabels=="function"&&updateMountVoltageSettingLabels(rt);const wI=document.getElementById("iosPwaHelpStep2"),LI=document.getElementById("iosPwaHelpStep3");AB(QU);typeof window<"u"&&typeof document<"u"&&qU().catch(()=>{});const RI=document.getElementById("iosPwaHelpStep4"),II=document.getElementById("iosPwaHelpNote");var yc=document.getElementById("iosPwaHelpClose"),TI=!1,cy=null,Wu=null,Ku=null;function rS(e){if(typeof e=="number"&&Number.isFinite(e))return Math.max(0,Math.min(255,Math.round(e)));if(typeof e!="string")return null;const t=e.trim();if(!t)return null;if(t.endsWith("%")){const o=Number.parseFloat(t.slice(0,-1));return Number.isNaN(o)?null:Math.max(0,Math.min(255,Math.round(o/100*255)))}const r=Number.parseFloat(t);return Number.isNaN(r)?null:Math.max(0,Math.min(255,Math.round(r)))}function UV(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const r=t.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);if(r){const n=r[1];return n.length===3?{r:Number.parseInt(n[0]+n[0],16),g:Number.parseInt(n[1]+n[1],16),b:Number.parseInt(n[2]+n[2],16)}:{r:Number.parseInt(n.slice(0,2),16),g:Number.parseInt(n.slice(2,4),16),b:Number.parseInt(n.slice(4,6),16)}}const o=t.match(/^rgba?\(([^)]+)\)$/i);if(o){const n=o[1].split(",");if(n.length<3)return null;const[a,i,s]=n,u=rS(a),l=rS(i),d=rS(s);return[u,l,d].some(p=>p===null)?null:{r:u,g:l,b:d}}return null}function $V(e){if(!e||typeof e!="object")return 0;const t=i=>{const s=Number(i);return Number.isFinite(s)?Math.min(1,Math.max(0,s/255)):0},r=i=>i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),o=r(t(e.r)),n=r(t(e.g)),a=r(t(e.b));return .2126*o+.7152*n+.0722*a}function RP(){try{if(jo&&typeof jo.isIosDevice=="function")return!!jo.isIosDevice()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isIosDevice() failed",e)}return!1}function qV(){try{if(jo&&typeof jo.isAndroidDevice=="function")return!!jo.isAndroidDevice()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isAndroidDevice() failed",e)}return!1}function VV(){try{if(jo&&typeof jo.isStandaloneDisplayMode=="function")return!!jo.isStandaloneDisplayMode()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isStandaloneDisplayMode() failed",e)}return!1}function WV(){try{jo&&typeof jo.markIosPwaHelpDismissed=="function"&&jo.markIosPwaHelpDismissed()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("markIosPwaHelpDismissed() failed",e)}}function OI(){return!pa||typeof pa!="object"?!1:typeof pa.installBannerDismissedInSession!="boolean"?(pa.installBannerDismissedInSession=!1,!1):pa.installBannerDismissedInSession}function IP(e){!pa||typeof pa!="object"||(pa.installBannerDismissedInSession=!!e)}function KV(){if(OI())return!0;if(typeof localStorage>"u")return!1;try{const t=localStorage.getItem(yC)==="1";return t&&IP(!0),t}catch(e){return console.warn("Could not read install banner dismissal flag",e),OI()}}function YV(){if(IP(!0),!(typeof localStorage>"u"))try{localStorage.setItem(yC,"1")}catch(e){console.warn("Could not store install banner dismissal",e)}}function QV(){return Ii(),!vo||VV()||KV()?!1:RP()||qV()}function mu(){if(Ii(),!vo)return;const e=QV(),t=typeof document<"u"?document.documentElement:null;t&&typeof t.classList<"u"&&t.classList.toggle("install-banner-visible",e),e?(vo.removeAttribute("hidden"),uy(),rs()):(vo.setAttribute("hidden",""),iA(0),vo.style.removeProperty("top"))}function uy(){if(Ii(),!!vo&&!(typeof window>"u"||typeof window.getComputedStyle!="function"))try{const e=document.documentElement;if(!e)return;const r=window.getComputedStyle(e).getPropertyValue("--accent-color").trim();if(!r){vo.style.removeProperty("--install-banner-text-color");return}const o=UV(r);if(!o)return;const a=$V(o)>.55?"#000000":"#ffffff";vo.style.setProperty("--install-banner-text-color",a)}catch(e){console.warn("Unable to update install banner colors",e)}}function TP(e,t=rt){if(Ii(),!ko)return;const r=c.en||{},o=c[t]||r,n=e==="ios",a=n?"installHelpTitleIos":"installHelpTitleAndroid",i=n?"installHelpIntroIos":"installHelpIntroAndroid",s=n?"installHelpStepsIos":"installHelpStepsAndroid",u=n?"installHelpNoteIos":"installHelpNoteAndroid",l=o[a]||r[a]||"";fd&&(fd.textContent=l);const d=o[i]||r[i]||"";pd&&(pd.textContent=d);const p=o[s],g=r[s],h=E=>E?Array.isArray(E)?E:[E]:[],A=h(p),m=h(g),y=A.length?A:m;dc&&(dc.textContent="",y.forEach(E=>{if(!E)return;const I=document.createElement("li");I.textContent=E,dc.appendChild(I)}));const S=o[u]||r[u]||"";if(md&&(md.textContent=S),ko.setAttribute("data-platform",e),!(!fc||!pc||!mc||!_s||!gc))if(n){fc.removeAttribute("hidden");const E=o.installHelpMigrationTitle||r.installHelpMigrationTitle||"";pc.textContent=E;const I=o.iosPwaHelpIntro||r.iosPwaHelpIntro||"";mc.textContent=I;const L=[o.iosPwaHelpStep1||r.iosPwaHelpStep1,o.iosPwaHelpStep2||r.iosPwaHelpStep2,o.iosPwaHelpStep3||r.iosPwaHelpStep3,o.iosPwaHelpStep4||r.iosPwaHelpStep4].filter(Boolean);_s.textContent="",L.forEach(G=>{const j=document.createElement("li");j.textContent=G,_s.appendChild(j)});const R=o.iosPwaHelpNote||r.iosPwaHelpNote||"";gc.textContent=R}else fc.setAttribute("hidden",""),pc.textContent="",mc.textContent="",_s.textContent="",gc.textContent=""}function XV(e){if(Ii(),!ko)return;cy=e,Wu=document.activeElement,TP(e),ko.removeAttribute("hidden");const t=qn||ko.querySelector('button, [href], [tabindex]:not([tabindex="-1"])');if(t&&typeof t.focus=="function")try{t.focus()}catch{t.focus()}}function SA(){if(Ii(),!!ko&&(ko.setAttribute("hidden",""),cy=null,Wu&&typeof Wu.focus=="function"))try{Wu.focus()}catch{Wu.focus()}}function ZV(){if(Ii(),!vo)return!1;if(TI)return vA(rt),uy(),mu(),rs(),!0;if(TI=!0,dd&&typeof applyIconGlyph=="function"&&applyIconGlyph(dd,ICON_GLYPHS.installApp),Ua&&Ua.addEventListener("click",e=>{e.preventDefault();const t=RP()?"ios":"android";XV(t)}),Ko&&Ko.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),YV(),mu()}),qn&&qn.addEventListener("click",()=>{SA()}),ko&&ko.addEventListener("click",e=>{e.target===ko&&SA()}),vA(rt),uy(),mu(),rs(),typeof window<"u"&&(window.addEventListener("resize",rs),window.addEventListener("appinstalled",mu),typeof window.matchMedia=="function"))try{const e=window.matchMedia("(display-mode: standalone)"),t=()=>mu();typeof e.addEventListener=="function"?e.addEventListener("change",t):typeof e.addListener=="function"&&e.addListener(t)}catch(e){console.warn("matchMedia display-mode listener failed",e)}return!0}function vA(e){Ii();const t=c.en||{},r=c[e]||t,o=r.installBannerText||t.installBannerText||"";ud&&o&&(ud.textContent=o),vo&&(o?(vo.setAttribute("aria-label",o),vo.setAttribute("title",o)):(vo.removeAttribute("aria-label"),vo.removeAttribute("title"))),Ua&&(o?(Ua.setAttribute("aria-label",o),Ua.setAttribute("title",o)):(Ua.removeAttribute("aria-label"),Ua.removeAttribute("title")));const n=r.installHelpClose||t.installHelpClose||"",a=r.installBannerDismiss||t.installBannerDismiss||n||"";if(Ko){const i=a||"";if(typeof je=="function"&&je(Ko,"",ICON_GLYPHS.circleX),Array.from(Ko.querySelectorAll(".visually-hidden")).forEach(s=>{s&&s.parentNode===Ko&&Ko.removeChild(s)}),i){Ko.setAttribute("aria-label",i),Ko.setAttribute("title",i);const s=document.createElement("span");s.className="visually-hidden",s.textContent=i,Ko.appendChild(s)}else Ko.removeAttribute("aria-label"),Ko.removeAttribute("title")}qn&&(n&&typeof je=="function"?(je(qn,n,ICON_GLYPHS.circleX),qn.setAttribute("aria-label",n),qn.setAttribute("title",n)):n||(qn.removeAttribute("aria-label"),qn.removeAttribute("title"))),ko&&!ko.hasAttribute("hidden")&&cy&&TP(cy,e),rs(),uy()}function JV(){try{if(jo&&typeof jo.shouldShowIosPwaHelp=="function")return!!jo.shouldShowIosPwaHelp(()=>Aa)}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("shouldShowIosPwaHelp() failed",e)}return!1}function eW(){if(!Aa||!JV())return;Ku=document.activeElement,Aa.removeAttribute("hidden");const e=yc||Aa.querySelector('button, [href], [tabindex]:not([tabindex="-1"])');if(e&&typeof e.focus=="function")try{e.focus()}catch{e.focus()}}function MC(e=!1){if(Aa&&(Aa.setAttribute("hidden",""),e&&WV(),Ku&&typeof Ku.focus=="function"))try{Ku.focus()}catch{Ku.focus()}}function tW(){eW()}yc&&yc.addEventListener("click",()=>MC(!0));Aa&&Aa.addEventListener("click",e=>{e.target===Aa&&MC(!0)});document.addEventListener("keydown",e=>{if(e.key!=="Escape"&&e.key!=="Esc")return;let t=!1;Aa&&!Aa.hasAttribute("hidden")&&(MC(!0),t=!0),ko&&!ko.hasAttribute("hidden")&&(SA(),t=!0),t&&e.preventDefault()});var Dp=document.getElementById("hoverHelpButton"),Fs=document.getElementById("settingsButton");const oS=Fs?.querySelector?.(".settings-button-icon");var dy=document.getElementById("settingsDialog");Fs&&Fs.setAttribute("data-allow-hover-help","");oS&&(applyIconGlyph(oS,ICON_GLYPHS.gears),oS.setAttribute("aria-hidden","true"));dy&&dy.setAttribute("data-allow-hover-help","");const No=ar?Array.from(ar.querySelectorAll('[role="tab"]')):[],_p=ar?ar.closest(".settings-tabs-container")||ar:null,Os=document.getElementById("settingsTabsScrollPrev"),Gs=document.getElementById("settingsTabsScrollNext");let gu=0;const rW="(max-width: 720px)",Il=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia(rW):null;function nS(e){ar&&(ar.setAttribute("aria-orientation",e?"vertical":"horizontal"),lf())}if(Il)try{nS(Il.matches);const e=t=>{nS(t.matches)};typeof Il.addEventListener=="function"?Il.addEventListener("change",e):typeof Il.addListener=="function"&&Il.addListener(e)}catch{nS(!1)}else ar&&ar.setAttribute("aria-orientation","horizontal");function GI(){if(!ar||!_p){Os&&(Os.hidden=!0),Gs&&(Gs.hidden=!0);return}const e=typeof ar.scrollWidth=="number"?ar.scrollWidth:0,t=typeof ar.clientWidth=="number"?ar.clientWidth:0,r=typeof ar.scrollLeft=="number"?ar.scrollLeft:Number(ar.scrollLeft)||0,o=Math.max(0,e-t),n=Math.min(o,Math.max(0,r)),a=e>t+4,i=!a||n<=1,s=!a||Math.abs(e-t-n)<=1;_p.classList.toggle("is-scrollable",a),_p.classList.toggle("is-at-start",i),_p.classList.toggle("is-at-end",s),Os&&(Os.hidden=!a,Os.disabled=i),Gs&&(Gs.hidden=!a,Gs.disabled=s)}function lf(){ar&&(typeof window<"u"&&typeof window.requestAnimationFrame=="function"?(gu&&(typeof window.cancelAnimationFrame=="function"&&window.cancelAnimationFrame(gu),gu=0),gu=window.requestAnimationFrame(()=>{gu=0,GI()})):GI())}function OP(e){if(!ar)return;const t=ar.clientWidth?ar.clientWidth*.75:200,r=e*t;if(typeof ar.scrollBy=="function")try{ar.scrollBy({left:r,behavior:"smooth"})}catch{ar.scrollLeft+=r}else ar.scrollLeft+=r;lf()}Os&&Os.addEventListener("click",()=>{OP(-1)});Gs&&Gs.addEventListener("click",()=>{OP(1)});if(ar){let e=!1;if(typeof window<"u"&&typeof window.addEventListener=="function")try{const t=()=>{},r=Object.defineProperty({},"passive",{get(){return e={passive:!0},!1}});window.addEventListener("testPassive",t,r),window.removeEventListener("testPassive",t,r)}catch{e=!1}ar.addEventListener("scroll",()=>{lf()},e),typeof window<"u"&&typeof window.addEventListener=="function"&&window.addEventListener("resize",lf,e)}var oW=dy?Array.from(dy.querySelectorAll(".settings-panel")):[],_m=document.getElementById("settingsTab-general"),GP=document.getElementById("settingsTab-autoGear"),kP=document.getElementById("settingsTab-accessibility"),BP=document.getElementById("settingsTab-backup"),PP=document.getElementById("settingsTab-data"),xP=document.getElementById("settingsTab-about"),nW=[[_m,ICON_GLYPHS.settingsGeneral],[GP,ICON_GLYPHS.settingsAutoGear],[kP,ICON_GLYPHS.settingsAccessibility],[BP,ICON_GLYPHS.settingsBackup],[PP,ICON_GLYPHS.settingsData],[xP,ICON_GLYPHS.settingsAbout]];nW.forEach(([e,t])=>{if(!e||!t)return;const r=e.querySelector?.(".settings-tab-icon");r&&(applyIconGlyph(r,t),r.setAttribute("aria-hidden","true"))});const aS=document.getElementById("generalSettingsHeading"),iS=document.getElementById("generalLanguageHeading"),sS=document.getElementById("generalAppearanceHeading"),lS=document.getElementById("generalTypographyHeading"),cS=document.getElementById("generalBrandingHeading");document.getElementById("generalCameraColorsHeading");const uS=document.getElementById("cameraColorsDescription"),aW=document.getElementById("cameraColorALabel"),iW=document.getElementById("cameraColorBLabel"),sW=document.getElementById("cameraColorCLabel"),lW=document.getElementById("cameraColorDLabel"),cW=document.getElementById("cameraColorELabel");var uW=document.getElementById("cameraColorA"),dW=document.getElementById("cameraColorB"),fW=document.getElementById("cameraColorC"),pW=document.getElementById("cameraColorD"),mW=document.getElementById("cameraColorE"),yu=document.getElementById("settingsLanguage"),dS=document.getElementById("settingsDarkMode"),fS=document.getElementById("settingsPinkMode"),pS=document.getElementById("accentColorInput"),Tl=document.getElementById("accentColorReset"),Ol=document.getElementById("settingsTemperatureUnit"),Gl=document.getElementById("settingsFocusScale"),mS=document.getElementById("settingsFontSize"),gS=document.getElementById("settingsFontFamily"),xa=document.getElementById("localFontsButton");document.getElementById("localFontsInput");var bu=document.getElementById("localFontsStatus"),yS=document.getElementById("localFontsGroup");const bS=document.getElementById("bundledFontOptions");var hS=document.getElementById("settingsLogo");document.getElementById("settingsLogoPreview");const Fm=(()=>{const e=ch&&typeof ch.createDocumentationTrackerManager=="function"?(()=>{try{return ch.createDocumentationTrackerManager({document:typeof document<"u"?document:null})}catch(r){return console.warn("Failed to create documentation tracker manager",r),null}})():null;if(e)return{initialize(){try{e.initialize()}catch(r){console.warn("Failed to initialise documentation tracker",r)}},updateLocalization(r){try{e.updateLocalization(r)}catch(o){console.warn("Failed to update documentation tracker localisation",o)}},render(){try{e.render()}catch(r){console.warn("Failed to render documentation tracker",r)}},isInitialized(){try{return typeof e.isInitialized=="function"?e.isInitialized()===!0:!1}catch{}return!1}};const t=()=>{};return{initialize:t,updateLocalization:t,render:t,isInitialized(){return!1}}})();var bc="";if(No.length){bc=No.find(t=>t.getAttribute("aria-selected")==="true")?.id||No[0].id;try{const t=localStorage.getItem("settingsActiveTab");t&&No.some(r=>r.id===t)&&(bc=t)}catch(t){console.warn("Could not load settings tab preference",t)}}function hd(e,t={}){if(!No.length)return;const{focusTab:r=!1}=t||{};let o=No.find(n=>n.id===e);if(o||(o=No[0]),!!o){if(No.forEach(n=>{const a=n===o;if(n.setAttribute("aria-selected",a?"true":"false"),n.tabIndex=a?0:-1,a&&r)try{n.focus({preventScroll:!0})}catch{n.focus()}n.classList.toggle("active",a)}),oW.forEach(n=>{if(!n)return;(n.getAttribute("aria-labelledby")||"").split(/\s+/).map(s=>s.trim()).filter(Boolean).includes(o.id)?n.removeAttribute("hidden"):n.setAttribute("hidden","")}),ar&&typeof ar.scrollWidth=="number"&&typeof ar.clientWidth=="number"&&ar.scrollWidth>ar.clientWidth+4&&typeof o.scrollIntoView=="function")try{o.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"})}catch{o.scrollIntoView()}lf(),bc=o.id;try{typeof safeSetLocalStorage=="function"?safeSetLocalStorage("settingsActiveTab",bc):localStorage.setItem("settingsActiveTab",bc)}catch(n){console.warn("Could not save settings tab preference",n)}}}Fm.initialize();No.length&&(hd(bc),No.forEach(e=>{e.addEventListener("click",()=>{hd(e.id)}),e.addEventListener("keydown",t=>{const{key:r}=t;if(!r||!["ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Home","End"].includes(r))return;t.preventDefault();const o=No.indexOf(e);if(o===-1)return;let n=o;r==="ArrowLeft"||r==="ArrowUp"?n=(o-1+No.length)%No.length:r==="ArrowRight"||r==="ArrowDown"?n=(o+1)%No.length:r==="Home"?n=0:r==="End"&&(n=No.length-1);const a=No[n];a&&hd(a.id,{focusTab:!0})})}));ks&&ks.addEventListener("click",()=>{hd("settingsTab-backup",{focusTab:!0});const e=document.getElementById("backupSettings");if(e&&typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}});var kI=tf.reduce((e,t)=>{const r=Lt[t]||null;return e[t]={key:t,section:r,label:Y1[t]||null,select:Q1[t]||null,addShortcut:RC[t]||null,removeButton:HB[t]||null,logicLabel:jB[t]||null,logicSelect:IC[t]||null},r&&r.setAttribute("aria-hidden",r.hidden?"true":"false"),e},{});const Co=typeof K<"u"?K:globalThis.AUTO_GEAR_UI_EXPORTS||{},gW=typeof Co.refreshAutoGearShootingDaysValue=="function"?Co.refreshAutoGearShootingDaysValue:function(){},MP=typeof Co.refreshAutoGearScenarioOptions=="function"?Co.refreshAutoGearScenarioOptions:function(){};typeof Co.refreshAutoGearScenarioBaseSelect=="function"&&Co.refreshAutoGearScenarioBaseSelect;const DP=typeof Co.refreshAutoGearMatteboxOptions=="function"?Co.refreshAutoGearMatteboxOptions:function(){},_P=typeof Co.refreshAutoGearCameraHandleOptions=="function"?Co.refreshAutoGearCameraHandleOptions:function(){},FP=typeof Co.refreshAutoGearViewfinderExtensionOptions=="function"?Co.refreshAutoGearViewfinderExtensionOptions:function(){},NP=typeof Co.refreshAutoGearDeliveryResolutionOptions=="function"?Co.refreshAutoGearDeliveryResolutionOptions:function(){},HP=typeof Co.refreshAutoGearVideoDistributionOptions=="function"?Co.refreshAutoGearVideoDistributionOptions:function(){};typeof Co.collectAutoGearSelectedValues=="function"&&Co.collectAutoGearSelectedValues;var jP={always:null,scenarios:MP,shootingDays:gW,mattebox:DP,cameraHandle:_P,viewfinderExtension:FP,deliveryResolution:NP,videoDistribution:HP,camera:jn("refreshAutoGearCameraOptions"),ownGear:refreshAutoGearOwnGearConditionOptions,cameraWeight:jn("refreshAutoGearCameraWeightCondition"),monitor:jn("refreshAutoGearMonitorOptions"),tripodHeadBrand:jn("refreshAutoGearTripodHeadOptions"),tripodBowl:jn("refreshAutoGearTripodBowlOptions"),tripodTypes:jn("refreshAutoGearTripodTypesOptions"),tripodSpreader:jn("refreshAutoGearTripodSpreaderOptions"),crewPresent:e=>gt("refreshAutoGearCrewOptions",[od,e,"crewPresent"],{defer:!0}),crewAbsent:e=>gt("refreshAutoGearCrewOptions",[nd,e,"crewAbsent"],{defer:!0}),wireless:jn("refreshAutoGearWirelessOptions"),motors:jn("refreshAutoGearMotorsOptions"),controllers:jn("refreshAutoGearControllersOptions"),distance:jn("refreshAutoGearDistanceOptions")},os=typeof window<"u"&&window.autoGearActiveConditions||new Set;typeof window<"u"&&!window.autoGearActiveConditions&&(window.autoGearActiveConditions=os);function DC(e){return e&&Object.prototype.hasOwnProperty.call(kI,e)?kI[e]:null}function yW(e){const t=DC(e);if(t&&t.label&&typeof t.label.textContent=="string"){const o=t.label.textContent.trim();if(o)return o}const r=Z1[e];return typeof r=="string"&&r?r:typeof e=="string"&&e?e.replace(/([A-Z])/g," $1").replace(/^./,o=>o.toUpperCase()):""}function sb(){if(!Fo)return;const e=Fo.value||"",t=c[rt]?.autoGearConditionPlaceholder||c.en?.autoGearConditionPlaceholder||"Choose a condition";Fo.innerHTML="";const r=document.createElement("option");r.value="",r.textContent=t,Fo.appendChild(r);const o=tf.filter(n=>os.has(n)?UB.has(n):!0);o.forEach(n=>{const a=document.createElement("option");a.value=n,a.textContent=yW(n),Fo.appendChild(a)}),e&&o.includes(e)?Fo.value=e:Fo.value="",Fo.disabled=o.length===0}function lb(){const e=Fo&&Fo.value,t=Fo?Fo.disabled:!0;Ni&&(Ni.disabled=!e||t);const r=tf.some(o=>os.has(o)?UB.has(o):!0);tf.forEach(o=>{const n=RC[o];n&&(n.disabled=!r)})}function bW(e,t={}){const r=DC(e);if(!r||!os.has(e))return!1;os.delete(e),r.section&&(r.section.hidden=!0,r.section.setAttribute("aria-hidden","true")),r.logicSelect&&(r.logicSelect.value="all",r.logicSelect.disabled=!0),t.preserveDraft,r.select&&(Array.from(r.select.options||[]).forEach(n=>{n.selected=!1}),r.select.value=""),e==="cameraWeight"&&(ba&&(ba.value="greater"),ha&&(ha.value="")),e==="shootingDays"&&(ga&&(ga.value="minimum"),ya&&(ya.value=""));const o=jP[e];return typeof o=="function"&&o(e==="shootingDays"?null:[]),sb(),lb(),t.focusPicker&&uB(),!0}function hW(e={}){const{preserveDraft:t=!1}=e||{};Array.from(os).forEach(r=>{bW(r,{preserveDraft:t,focusPicker:!1})}),tf.forEach(r=>{if(os.has(r))return;const o=DC(r);if(!o)return;o.section&&(o.section.hidden=!0,o.section.setAttribute("aria-hidden","true")),o.select&&(Array.from(o.select.options||[]).forEach(a=>{a.selected=!1}),o.select.value=""),o.logicSelect&&(o.logicSelect.value="all",o.logicSelect.disabled=!0),r==="cameraWeight"&&(ba&&(ba.value="greater"),ha&&(ha.value="")),r==="shootingDays"&&(ga&&(ga.value="minimum"),ya&&(ya.value=""));const n=jP[r];typeof n=="function"&&n(r==="shootingDays"?null:t?_i?.[r]:[])}),os.clear(),sb(),lb()}sb();lb();pC();if(ga){const e=()=>{updateAutoGearShootingDaysDraft(),gt("renderAutoGearDraftImpact",[],{defer:!0})};ga.addEventListener("input",e),ga.addEventListener("change",e)}if(ya){const e=()=>{updateAutoGearShootingDaysDraft(),gt("renderAutoGearDraftImpact",[],{defer:!0})};ya.addEventListener("input",e),ya.addEventListener("change",e),ya.addEventListener("blur",e)}Object.entries(IC).forEach(([e,t])=>{if(!t)return;AUTO_GEAR_CONDITION_LOGIC_FIELDS[e];const r=()=>{const o=mB(t.value);t.value=o,gt("renderAutoGearDraftImpact",[],{defer:!0})};t.addEventListener("input",r),t.addEventListener("change",r)});if(ba){const e=()=>{updateAutoGearCameraWeightDraft(),gt("renderAutoGearDraftImpact",[],{defer:!0})};ba.addEventListener("input",e),ba.addEventListener("change",e)}if(ha){const e=()=>{updateAutoGearCameraWeightDraft(),gt("renderAutoGearDraftImpact",[],{defer:!0})};ha.addEventListener("input",e),ha.addEventListener("change",e),ha.addEventListener("blur",e)}var SS=document.getElementById("autoGearAddItemsHeading"),Fp=document.getElementById("autoGearAddOwnGearLabel"),Np=document.getElementById("autoGearAddItemLabel"),vS=document.getElementById("autoGearAddCategoryLabel"),AS=document.getElementById("autoGearAddQuantityLabel"),Nm=document.getElementById("autoGearAddScreenSizeLabel"),Hm=document.getElementById("autoGearAddSelectorTypeLabel"),jm=document.getElementById("autoGearAddSelectorDefaultLabel"),ES=document.getElementById("autoGearAddNotesLabel"),hu=document.getElementById("autoGearAddOwnGear"),Su=document.getElementById("autoGearAddName"),Nl=document.getElementById("autoGearAddCategory"),BI=document.getElementById("autoGearAddQuantity"),fy=document.getElementById("autoGearAddScreenSize"),hc=document.getElementById("autoGearAddSelectorType"),cf=document.getElementById("autoGearAddSelectorDefault"),PI=document.getElementById("autoGearAddNotes"),zP=document.getElementById("autoGearAddItemButton");document.getElementById("autoGearAddList");var CS=document.getElementById("autoGearRemoveItemsHeading"),Hp=document.getElementById("autoGearRemoveOwnGearLabel"),jp=document.getElementById("autoGearRemoveItemLabel"),wS=document.getElementById("autoGearRemoveCategoryLabel"),LS=document.getElementById("autoGearRemoveQuantityLabel"),zm=document.getElementById("autoGearRemoveScreenSizeLabel"),Um=document.getElementById("autoGearRemoveSelectorTypeLabel"),$m=document.getElementById("autoGearRemoveSelectorDefaultLabel"),RS=document.getElementById("autoGearRemoveNotesLabel"),vu=document.getElementById("autoGearRemoveOwnGear"),Au=document.getElementById("autoGearRemoveName"),Hl=document.getElementById("autoGearRemoveCategory"),xI=document.getElementById("autoGearRemoveQuantity"),py=document.getElementById("autoGearRemoveScreenSize"),Sc=document.getElementById("autoGearRemoveSelectorType"),uf=document.getElementById("autoGearRemoveSelectorDefault"),MI=document.getElementById("autoGearRemoveNotes"),UP=document.getElementById("autoGearRemoveItemButton");document.getElementById("autoGearRemoveList");var DI=document.getElementById("autoGearDraftImpact"),Eu=document.getElementById("autoGearDraftImpactHeading"),IS=document.getElementById("autoGearDraftImpactDescription");document.getElementById("autoGearDraftImpactList");document.getElementById("autoGearDraftWarningContainer");var TS=document.getElementById("autoGearDraftWarningHeading");document.getElementById("autoGearDraftWarningList");var zp=document.getElementById("autoGearSaveRule"),Up=document.getElementById("autoGearCancelEdit");document.getElementById("autoGearItemCatalog");updateAutoGearOwnGearOptions();typeof document<"u"&&document&&document.addEventListener("own-gear-data-changed",()=>{R1(),updateAutoGearOwnGearOptions(),updateAutoGearCatalogOptions()});function SW(e){if(!e||!e.multiple)return;const t=r=>{if(!e.multiple||r.defaultPrevented||typeof PointerEvent<"u"&&r instanceof PointerEvent&&r.pointerType&&r.pointerType!=="mouse"||typeof r.button=="number"&&r.button!==0||r.ctrlKey||r.metaKey||r.shiftKey||r.altKey)return;const n=r.target instanceof HTMLOptionElement?r.target:null;if(!n||n.disabled)return;r.preventDefault(),n.selected=!n.selected;const a=i=>{try{const s=new Event(i,{bubbles:!0});e.dispatchEvent(s)}catch{const s=document.createEvent("Event");s.initEvent(i,!0,!0),e.dispatchEvent(s)}};if(a("input"),a("change"),typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}};typeof window<"u"&&typeof window.PointerEvent<"u"?e.addEventListener("pointerdown",t):e.addEventListener("mousedown",t)}[Hu,ju,zu,Uu,$u,Om,Gm,km,od,nd,Bm,Pm,xm,Mm].forEach(SW);var vW=fy?.closest(".auto-gear-field")||Nm?.closest(".auto-gear-field")||null,AW=hc?.closest(".auto-gear-field")||Hm?.closest(".auto-gear-field")||null,EW=cf?.closest(".auto-gear-field")||jm?.closest(".auto-gear-field")||null,CW=py?.closest(".auto-gear-field")||zm?.closest(".auto-gear-field")||null,wW=Sc?.closest(".auto-gear-field")||Um?.closest(".auto-gear-field")||null,LW=uf?.closest(".auto-gear-field")||$m?.closest(".auto-gear-field")||null;nA={select:Nl,screenSizeField:vW,screenSizeInput:fy,selectorTypeField:AW,selectorTypeSelect:hc,selectorDefaultField:EW,selectorDefaultInput:cf};aA={select:Hl,screenSizeField:CW,screenSizeInput:py,selectorTypeField:wW,selectorTypeSelect:Sc,selectorDefaultField:LW,selectorDefaultInput:uf};[{selectorTypeSelect:hc,selectorDefaultInput:cf},{selectorTypeSelect:Sc,selectorDefaultInput:uf}].filter(e=>e.selectorDefaultInput);function $P(){const e=typeof window<"u"&&window.updateAutoGearMonitorFieldGroup;typeof e=="function"&&(nA&&e(nA),aA&&e(aA))}St("syncAutoGearMonitorFieldVisibility",$P);var kl=document.getElementById("autoGearExport"),Bl=document.getElementById("autoGearImport");document.getElementById("autoGearImportInput");document.getElementById("autoGearBackupsSection");var OS=document.getElementById("autoGearBackupsHeading"),GS=document.getElementById("autoGearBackupsDescription"),kS=document.getElementById("autoGearBackupSelectLabel"),$p=document.getElementById("autoGearBackupSelect"),Cu=document.getElementById("autoGearBackupRestore");document.getElementById("autoGearBackupControls");var BS=document.getElementById("autoGearBackupEmpty"),qp=document.getElementById("autoGearBackupRetentionLabel"),Ns=document.getElementById("autoGearBackupRetention"),RW=document.getElementById("autoGearBackupRetentionSummary");document.getElementById("autoGearBackupRetentionWarning");var PS=document.getElementById("autoGearShowBackups"),Vp=document.getElementById("autoGearShowBackupsLabel"),xS=document.getElementById("autoGearBackupsHidden");const MS=document.getElementById("dataHeading"),_I=document.getElementById("storageSummaryIntro"),IW=document.getElementById("storageSummaryList");typeof globalThis<"u"&&(globalThis.storageSummaryList=IW);const FI=document.getElementById("storageSummaryEmpty"),NI=document.getElementById("storageSummaryFootnote");document.getElementById("storagePersistence");const Wp=document.getElementById("storagePersistenceHeading"),DS=document.getElementById("storagePersistenceIntro"),gs=document.getElementById("storagePersistenceRequest"),Kp=document.getElementById("storagePersistenceStatus");var Yp=document.getElementById("storageActionsHeading"),_S=document.getElementById("storageActionsIntro"),wu=document.getElementById("storageBackupNow"),ks=document.getElementById("storageOpenBackupTab"),Qp=document.getElementById("storageStatusHeading"),FS=document.getElementById("storageStatusLastProjectLabel"),Xp=document.getElementById("storageStatusLastProjectValue"),NS=document.getElementById("storageStatusLastAutoBackupLabel"),HI=document.getElementById("storageStatusLastAutoBackupValue"),HS=document.getElementById("storageStatusLastFullBackupLabel"),jI=document.getElementById("storageStatusLastFullBackupValue"),Lu=document.getElementById("storageStatusReminder");const jS=document.getElementById("loggingSection"),Zp=document.getElementById("loggingHeading"),zS=document.getElementById("loggingIntro"),Jp=document.getElementById("loggingLevelFilterLabel"),em=document.getElementById("loggingLevelFilter"),Ru=document.getElementById("loggingNamespaceFilterLabel"),US=document.getElementById("loggingNamespaceFilter"),tm=document.getElementById("loggingNamespaceFilterHelp"),$S=document.getElementById("loggingHistoryLimitLabel"),rm=document.getElementById("loggingHistoryLimit"),qS=document.getElementById("loggingHistoryLimitHelp"),VS=document.getElementById("loggingConsoleOutputLabel"),WS=document.getElementById("loggingConsoleOutputHelp"),KS=document.getElementById("loggingCaptureConsoleLabel"),YS=document.getElementById("loggingCaptureConsoleHelp"),QS=document.getElementById("loggingCaptureErrorsLabel"),XS=document.getElementById("loggingCaptureErrorsHelp"),ZS=document.getElementById("loggingPersistSessionLabel"),JS=document.getElementById("loggingPersistSessionHelp"),Pl=document.getElementById("loggingExportBtn"),om=document.getElementById("loggingExportHelp"),ev=document.getElementById("loggingStatus"),nm=document.getElementById("loggingEmpty"),tv=document.getElementById("loggingUnavailable");if(Ns){const e=t=>{gt(t,[],{defer:!0})};Ns.addEventListener("input",()=>{e("handleAutoGearBackupRetentionInput")}),Ns.addEventListener("blur",()=>{e("handleAutoGearBackupRetentionBlur")}),Ns.addEventListener("change",()=>{e("handleAutoGearBackupRetentionChange")})}function TW(e,t){return!t||t==="all"?!0:!e||!Array.isArray(e.scenarios)?!1:e.scenarios.some(r=>r===t)}function OW(e,t){const r=typeof t=="string"?t.trim().toLowerCase():"";if(!r)return!0;const o=[],n=s=>{Array.isArray(s)&&s.forEach(u=>{typeof u=="string"&&u&&o.push(u)})};if(e&&typeof e.label=="string"&&o.push(e.label),e&&e.always){o.push("always");const s=c[rt]?.autoGearAlwaysMeta||c.en?.autoGearAlwaysMeta||"Always active";o.push(s)}n(e?.scenarios),n(e?.mattebox),n(e?.cameraHandle),n(e?.viewfinderExtension),n(e?.deliveryResolution),n(e?.videoDistribution),n(e?.camera),n(e?.monitor),n(e?.crewPresent),n(e?.crewAbsent),n(e?.wireless),n(e?.motors),n(e?.controllers),n(e?.distance);const a=gB(e?.shootingDays);if(a){const s=c[rt]?.autoGearShootingDaysLabel||c.en?.autoGearShootingDaysLabel||"Shooting days condition",u=c[rt]?.autoGearShootingDaysModeMinimum||c.en?.autoGearShootingDaysModeMinimum||"Minimum",l=c[rt]?.autoGearShootingDaysModeMaximum||c.en?.autoGearShootingDaysModeMaximum||"Maximum",d=c[rt]?.autoGearShootingDaysModeEvery||c.en?.autoGearShootingDaysModeEvery||"Every";o.push(s),o.push(String(a.value)),a.mode==="minimum"?o.push(u):a.mode==="maximum"?o.push(l):a.mode==="every"&&o.push(d)}const i=s=>{Array.isArray(s)&&s.forEach(u=>{!u||typeof u!="object"||(typeof u.name=="string"&&u.name&&o.push(u.name),typeof u.notes=="string"&&u.notes&&o.push(u.notes),typeof u.category=="string"&&u.category&&o.push(u.category),typeof u.screenSize=="string"&&u.screenSize&&o.push(u.screenSize),u.selector&&typeof u.selector=="object"&&(typeof u.selector.type=="string"&&u.selector.type&&o.push(u.selector.type),typeof u.selector.default=="string"&&u.selector.default&&o.push(u.selector.default)),o.push(c0(u)))})};return i(e?.add),i(e?.remove),o.some(s=>typeof s=="string"&&s.toLowerCase().includes(r))}const GW=Object.freeze(["Indoor","Outdoor","Studio","Tripod","Handheld","Easyrig","Cine Saddle","Steadybag","Dolly","Slider","Steadicam","Gimbal","Trinity","Rollcage","Car Mount","Jib","Undersling mode","Crane","Remote Head","Extreme cold (snow)","Extreme rain","Extreme heat","Rain Machine","Slow Motion","Battery Belt"]);function kW(){const e=n=>{if(!n||typeof n!="object")return null;const{value:a,label:i}=n;if(typeof a!="string")return null;const s=a.trim();if(!s)return null;const u=typeof i=="string"&&i.trim()?i.trim():s;return{value:s,label:u}},t=()=>{const n=gt("getRequiredScenarioOptionEntries",[],{defaultValue:null});if(Array.isArray(n)&&n.length){const a=n.map(e).filter(Boolean);if(a.length)return a}return null},r=()=>{const n=Ja(),a=n&&n.scenarioIcons;if(!a||typeof a!="object")return null;const i=Object.keys(a).filter(s=>typeof s=="string").map(s=>s.trim()).filter(Boolean).map(s=>({value:s,label:s}));return i.length?i:null},o=()=>GW.map(n=>({value:n,label:n}));return(t()||r()||o()).sort((n,a)=>localeSort(n.label,a.label))}function BW(e){const t=new Map,r=document.getElementById("requiredScenarios");return r&&Array.from(r.options||[]).forEach(o=>{const n=typeof o.value=="string"?o.value.trim():"";if(!n)return;const a=o.textContent||n;t.has(n)||t.set(n,a)}),Array.isArray(e)&&e.forEach(o=>{!o||!Array.isArray(o.scenarios)||o.scenarios.forEach(n=>{if(typeof n!="string")return;const a=n.trim();a&&(t.has(a)||t.set(a,a))})}),t.size||kW().forEach(({value:o,label:n})=>{t.has(o)||t.set(o,n)}),Array.from(t.entries()).map(([o,n])=>({value:o,label:n})).sort((o,n)=>localeSort(o.label,n.label))}function qP(e){if(!ja)return la;const t=BW(e),r=c[rt]?.autoGearFilterScenarioAny||c.en?.autoGearFilterScenarioAny||"All scenarios";ja.innerHTML="";const o=document.createElement("option");o.value="all",o.textContent=r,ja.appendChild(o),t.forEach(({value:a,label:i})=>{const s=document.createElement("option");s.value=a,s.textContent=i,a===la&&(s.selected=!0),ja.appendChild(s)});const n=t.length>0;return ja.disabled=!n,(!n&&la!=="all"||la!=="all"&&!t.some(a=>a.value===la))&&(la="all"),ja.value=la,la}St("setupInstallBanner",ZV);St("maybeShowIosPwaHelp",tW);St("updateSelectIconBoxes",KB);St("updateGlobalDevicesReference",updateGlobalDevicesReference);St("setLanguage",r$);St("configureIconOnlyButton",Wl);St("encodeSharedSetup",mP);St("decodeSharedSetup",gP);St("iconMarkup",wa);St("ICON_GLYPHS",ICON_GLYPHS);St("iconGlyph",Ir);St("resolveIconGlyph",resolveIconGlyph);St("applyIconGlyph",applyIconGlyph);St("positionSvgMarkup",positionSvgMarkup);St("formatSvgCoordinate",formatSvgCoordinate);const VP={CORE_GLOBAL_SCOPE:$e,CORE_BOOT_QUEUE_KEY:wU,CORE_BOOT_QUEUE:eA,CORE_SHARED:Bt,INSTALL_BANNER_DISMISSED_KEY:yC,AUTO_GEAR_ANY_MOTOR_TOKEN:RB,AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE:Y0,AUTO_GEAR_BACKUP_RETENTION_MAX:W0,AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS:Q0,AUTO_GEAR_MONITOR_DEFAULT_TYPES:rl,GEAR_LIST_CATEGORIES:hC,TEMPERATURE_STORAGE_KEY:TU,TEMPERATURE_UNITS:oo,TEMPERATURE_SCENARIOS:GU,FOCUS_SCALE_STORAGE_KEY:OU,FOCUS_SCALE_VALUES:kU,FEEDBACK_TEMPERATURE_MIN:globalThis.FEEDBACK_TEMPERATURE_MIN_VALUE,FEEDBACK_TEMPERATURE_MAX:globalThis.FEEDBACK_TEMPERATURE_MAX_VALUE};Object.assign(VP,MOUNT_VOLTAGE_RUNTIME_EXPORTS);CU(VP);n0({updatePowerSummary:{get:()=>aV},drawPowerDiagram:{get:()=>sV},safeGenerateConnectorSummary:{get:()=>cR,set:e=>{typeof e=="function"&&(cR=e)}},baseAutoGearRules:{get:()=>Si,set:e=>{Array.isArray(e)&&(Si=e)}},autoGearAutoPresetId:{get:()=>Am,set:e=>{typeof e=="string"?Am=e:(e===null||typeof e>"u")&&(Am="")}},autoGearScenarioModeSelect:{get:()=>qs,set:e=>{qs=e||null,zB(qs)}},pinkModeIconRotationTimer:{get:()=>typeof rR=="function"?rR():null,set:e=>{typeof oR=="function"&&oR(e)}},pinkModeIconIndex:{get:()=>typeof nR=="function"?nR():0,set:e=>{typeof aR=="function"&&aR(e)}}});var WP=function(){typeof Em=="function"&&(typeof requestAnimationFrame=="function"?requestAnimationFrame(Em):setTimeout(Em,0))};WP();typeof globalThis<"u"&&(globalThis.encodeSharedSetup=mP,globalThis.decodeSharedSetup=gP);function my(){my.done||(my.done=!0,!(typeof document>"u")&&(Lt={always:document.getElementById("autoGearCondition-always"),scenarios:document.getElementById("autoGearCondition-scenarios"),shootingDays:document.getElementById("autoGearCondition-shootingDays"),mattebox:document.getElementById("autoGearCondition-mattebox"),cameraHandle:document.getElementById("autoGearCondition-cameraHandle"),viewfinderExtension:document.getElementById("autoGearCondition-viewfinderExtension"),deliveryResolution:document.getElementById("autoGearCondition-deliveryResolution"),videoDistribution:document.getElementById("autoGearCondition-videoDistribution"),camera:document.getElementById("autoGearCondition-camera"),ownGear:document.getElementById("autoGearCondition-ownGear"),cameraWeight:document.getElementById("autoGearCondition-cameraWeight"),monitor:document.getElementById("autoGearCondition-monitor"),tripodHeadBrand:document.getElementById("autoGearCondition-tripodHeadBrand"),tripodBowl:document.getElementById("autoGearCondition-tripodBowl"),tripodTypes:document.getElementById("autoGearCondition-tripodTypes"),tripodSpreader:document.getElementById("autoGearCondition-tripodSpreader"),crewPresent:document.getElementById("autoGearCondition-crewPresent"),crewAbsent:document.getElementById("autoGearCondition-crewAbsent"),wireless:document.getElementById("autoGearCondition-wireless"),motors:document.getElementById("autoGearCondition-motors"),controllers:document.getElementById("autoGearCondition-controllers"),distance:document.getElementById("autoGearCondition-distance")},wm=document.getElementById("autoGearHeading"),sA=document.getElementById("autoGearDescription"),document.getElementById("autoGearMonitorDefaultsSection"),Lm=document.getElementById("autoGearMonitorDefaultsHeading"),Rm=document.getElementById("autoGearMonitorDefaultsDescription"),PR=document.getElementById("autoGearDefaultFocusMonitor"),xR=document.getElementById("autoGearDefaultHandheldMonitor"),MR=document.getElementById("autoGearDefaultComboMonitor"),DR=document.getElementById("autoGearDefaultDirectorMonitor"),_R=document.getElementById("autoGearDefaultFocusMonitorLabel"),FR=document.getElementById("autoGearDefaultHandheldMonitorLabel"),NR=document.getElementById("autoGearDefaultComboMonitorLabel"),HR=document.getElementById("autoGearDefaultDirectorMonitorLabel"),Ml=document.getElementById("autoGearSearch"),Mu=document.getElementById("autoGearSearchLabel"),Du=document.getElementById("autoGearFilterScenarioLabel"),ja=document.getElementById("autoGearFilterScenario"),Dl=document.getElementById("autoGearFilterClear"),document.getElementById("autoGearSummary"),document.getElementById("autoGearSummaryHeading"),document.getElementById("autoGearSummaryDescription"),document.getElementById("autoGearSummaryCards"),document.getElementById("autoGearSummaryDetails"),document.getElementById("autoGearRulesList"),cA=document.getElementById("autoGearPresetDescription"),_u=document.getElementById("autoGearPresetLabel"),Im=document.getElementById("autoGearPresetSelect"),_l=document.getElementById("autoGearSavePreset"),Fl=document.getElementById("autoGearDeletePreset"),Qi=document.getElementById("autoGearAddRule"),As=document.getElementById("autoGearResetFactory"),yl=document.getElementById("autoGearEditor"),document.getElementById("autoGearConditionControls"),Fu=document.getElementById("autoGearConditionSelectLabel"),Fo=document.getElementById("autoGearConditionSelect"),Ni=document.getElementById("autoGearConditionAdd"),document.getElementById("autoGearConditionList"),Nu=document.getElementById("autoGearAlwaysLabel"),Tm=document.getElementById("autoGearAlwaysHelp"),document.getElementById("autoGearCondition-cameraWeight"),lA=[{key:"focus",select:PR,label:_R},{key:"handheld7",select:xR,label:FR},{key:"combo15",select:MR,label:NR},{key:"director15",select:DR,label:HR}],lA.forEach(e=>{!e||!e.select||e.select.addEventListener("change",t=>{c1(e.key,t.target.value)})}),RC={always:Lt.always?.querySelector(".auto-gear-condition-add")||null,scenarios:Lt.scenarios?.querySelector(".auto-gear-condition-add")||null,shootingDays:Lt.shootingDays?.querySelector(".auto-gear-condition-add")||null,mattebox:Lt.mattebox?.querySelector(".auto-gear-condition-add")||null,cameraHandle:Lt.cameraHandle?.querySelector(".auto-gear-condition-add")||null,viewfinderExtension:Lt.viewfinderExtension?.querySelector(".auto-gear-condition-add")||null,deliveryResolution:Lt.deliveryResolution?.querySelector(".auto-gear-condition-add")||null,videoDistribution:Lt.videoDistribution?.querySelector(".auto-gear-condition-add")||null,camera:Lt.camera?.querySelector(".auto-gear-condition-add")||null,ownGear:Lt.ownGear?.querySelector(".auto-gear-condition-add")||null,cameraWeight:Lt.cameraWeight?.querySelector(".auto-gear-condition-add")||null,monitor:Lt.monitor?.querySelector(".auto-gear-condition-add")||null,tripodHeadBrand:Lt.tripodHeadBrand?.querySelector(".auto-gear-condition-add")||null,tripodBowl:Lt.tripodBowl?.querySelector(".auto-gear-condition-add")||null,tripodTypes:Lt.tripodTypes?.querySelector(".auto-gear-condition-add")||null,tripodSpreader:Lt.tripodSpreader?.querySelector(".auto-gear-condition-add")||null,crewPresent:Lt.crewPresent?.querySelector(".auto-gear-condition-add")||null,crewAbsent:Lt.crewAbsent?.querySelector(".auto-gear-condition-add")||null,wireless:Lt.wireless?.querySelector(".auto-gear-condition-add")||null,motors:Lt.motors?.querySelector(".auto-gear-condition-add")||null,controllers:Lt.controllers?.querySelector(".auto-gear-condition-add")||null,distance:Lt.distance?.querySelector(".auto-gear-condition-add")||null},HB={always:Lt.always?.querySelector(".auto-gear-condition-remove")||null,scenarios:Lt.scenarios?.querySelector(".auto-gear-condition-remove")||null,shootingDays:Lt.shootingDays?.querySelector(".auto-gear-condition-remove")||null,mattebox:Lt.mattebox?.querySelector(".auto-gear-condition-remove")||null,cameraHandle:Lt.cameraHandle?.querySelector(".auto-gear-condition-remove")||null,viewfinderExtension:Lt.viewfinderExtension?.querySelector(".auto-gear-condition-remove")||null,deliveryResolution:Lt.deliveryResolution?.querySelector(".auto-gear-condition-remove")||null,videoDistribution:Lt.videoDistribution?.querySelector(".auto-gear-condition-remove")||null,camera:Lt.camera?.querySelector(".auto-gear-condition-remove")||null,ownGear:Lt.ownGear?.querySelector(".auto-gear-condition-remove")||null,cameraWeight:Lt.cameraWeight?.querySelector(".auto-gear-condition-remove")||null,monitor:Lt.monitor?.querySelector(".auto-gear-condition-remove")||null,tripodHeadBrand:Lt.tripodHeadBrand?.querySelector(".auto-gear-condition-remove")||null,tripodBowl:Lt.tripodBowl?.querySelector(".auto-gear-condition-remove")||null,tripodTypes:Lt.tripodTypes?.querySelector(".auto-gear-condition-remove")||null,tripodSpreader:Lt.tripodSpreader?.querySelector(".auto-gear-condition-remove")||null,crewPresent:Lt.crewPresent?.querySelector(".auto-gear-condition-remove")||null,crewAbsent:Lt.crewAbsent?.querySelector(".auto-gear-condition-remove")||null,wireless:Lt.wireless?.querySelector(".auto-gear-condition-remove")||null,motors:Lt.motors?.querySelector(".auto-gear-condition-remove")||null,controllers:Lt.controllers?.querySelector(".auto-gear-condition-remove")||null,distance:Lt.distance?.querySelector(".auto-gear-condition-remove")||null},Qi&&(Qi.setAttribute("aria-controls","autoGearEditor"),Qi.setAttribute("aria-expanded",yl&&!yl.hidden?"true":"false")),yl&&yl.setAttribute("aria-hidden",yl.hidden?"true":"false")))}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",my):my());typeof window<"u"&&(window.AppCore=sB);typeof window<"u"&&(window.syncAutoGearRulesFromStorage=u1,window.clearProjectAutoGearRules=d1,window.resetSharedImportStateForFactoryReset=pV,window.getCssVariableValue=v1,window.autoGearRuleMatchesScenario=TW,window.autoGearRuleMatchesSearch=OW,window.getAutoGearRules=AC,window.refreshAutoGearScenarioFilterOptions=qP,window.normalizeAutoGearCameraWeightCondition=y0,window.formatAutoGearCameraWeight=A0,window.findAutoGearOwnGearById=O1);console.log("DEBUG: app-core-new-1.js FINISHED");console.log("DEBUG: main.js parsing started");console.log("DEBUG: main.js imports START");typeof window<"u"&&(window.rentalHouses=nx,window.devices=ax,window.cineDevices=ix);typeof window<"u"&&(Object.assign(window,PM),Object.assign(window,pM));console.log("✅ Vite entry point (main.js) loaded");window.__viteMainLoaded=!0;console.log("[Vite] Entry point loaded successfully");console.log("Main: importing dynamic-form-helpers...");console.log("Main: importing app-setups...");console.log("Main: importing app-events...");console.log("Main: importing app-core-new-1 (SKIPPED)...");export{_W as i};
//# sourceMappingURL=main-fJuxqfW_.js.map
