var w=(s,n)=>()=>(n||s((n={exports:{}}).exports,n),n.exports);var g=w((G,u)=>{(function(){function s(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const n=s(),o=typeof cineModuleBase=="object"&&cineModuleBase||(n&&typeof n.cineModuleBase=="object"?n.cineModuleBase:null),a=o&&typeof o.safeWarn=="function"?o.safeWarn:function(r,t){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof t>"u"?console.warn(r):console.warn(r,t)}catch{}};function d(e){const r=e||n;if(!r||typeof r.document>"u")return;const{document:t}=r;if(t)try{typeof t.dispatchEvent=="function"&&typeof r.CustomEvent=="function"&&t.dispatchEvent(new r.CustomEvent("own-gear-data-changed"))}catch(i){a("cine.features.ownGear could not dispatch own gear change event.",i)}}function f(){try{if(typeof n.crypto=="object"&&n.crypto&&typeof n.crypto.randomUUID=="function")return n.crypto.randomUUID()}catch(t){a("cine.features.ownGear could not use crypto.randomUUID.",t)}const e=Date.now().toString(36),r=Math.floor(Math.random()*1e8).toString(36);return`own-${e}-${r}`}function l(e){if(!e||typeof e!="object")return null;const r=typeof e.name=="string"?e.name.trim():"";if(!r)return null;const t={id:typeof e.id=="string"&&e.id.trim()?e.id.trim():f(),name:r};return typeof e.quantity=="string"&&e.quantity.trim()?t.quantity=e.quantity.trim():typeof e.quantity=="number"&&Number.isFinite(e.quantity)&&(t.quantity=String(e.quantity)),typeof e.notes=="string"&&e.notes.trim()&&(t.notes=e.notes.trim()),typeof e.source=="string"&&e.source.trim()&&(t.source=e.source.trim()),t}function p(){if(typeof n.loadOwnGear!="function")return[];try{const e=n.loadOwnGear();if(!Array.isArray(e))return[];const r=new Set;return e.map(l).filter(t=>!t||r.has(t.id)?!1:(r.add(t.id),!0))}catch(e){return a("cine.features.ownGear could not load own gear items.",e),[]}}function y(e){if(typeof n.saveOwnGear!="function")return!1;const r=Array.isArray(e)?e.filter(t=>t&&typeof t=="object").map(t=>{const i={id:t.id,name:t.name};return t.quantity&&(i.quantity=t.quantity),t.notes&&(i.notes=t.notes),t.source&&(i.source=t.source),i}):[];try{return n.saveOwnGear(r),d(n),!0}catch(t){return a("cine.features.ownGear could not persist own gear items.",t),!1}}const c=Object.freeze({generateOwnGearId:f,normalizeOwnGearRecord:l,loadStoredOwnGearItems:p,persistOwnGearItems:y});if(o&&typeof o.registerOrQueueModule=="function")try{o.registerOrQueueModule("cine.features.ownGear",c,{category:"features",description:"Shared helpers for personal gear persistence.",replace:!0,connections:["cineModuleBase","cineModuleGlobals","cinePersistence"]},e=>a("Unable to register cine.features.ownGear module.",e),n,o.getModuleRegistry&&o.getModuleRegistry(n))}catch(e){a("cine.features.ownGear registration failed.",e)}if(o&&typeof o.exposeGlobal=="function")try{o.exposeGlobal("cineFeaturesOwnGear",c,n,{configurable:!0,enumerable:!1,writable:!1});return}catch(e){a("cine.features.ownGear could not expose global api.",e)}try{n.cineFeaturesOwnGear=c}catch(e){a("cine.features.ownGear could not assign global api.",e)}typeof u<"u"&&u&&u.exports&&(u.exports=c)})()});export default g();
//# sourceMappingURL=own-gear-CSm93DJ1.js.map
