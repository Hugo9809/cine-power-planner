import{a as X5,t as J5}from"./vendor-Dzz8Pluk.js";import{a as Z5,b as Rn,r as ei,c as DR,e as NR,_ as BS,f as e3,g as t3}from"./core-modules-CvxJ6PMl.js";import{r as r3}from"./data-B26rSgVw.js";import"./v2-ui-BwEyNXHr.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();const Bge=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));function n3(){return typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object"?cineCoreRuntimeModuleLoader:typeof globalThis<"u"&&globalThis&&typeof globalThis.cineCoreRuntimeModuleLoader=="object"?globalThis.cineCoreRuntimeModuleLoader:typeof window<"u"&&window&&typeof window.cineCoreRuntimeModuleLoader=="object"?window.cineCoreRuntimeModuleLoader:typeof self<"u"&&self&&typeof self.cineCoreRuntimeModuleLoader=="object"?self.cineCoreRuntimeModuleLoader:typeof global<"u"&&global&&typeof global.cineCoreRuntimeModuleLoader=="object"?global.cineCoreRuntimeModuleLoader:null}function o3(e,t){const r=n3();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{return r.resolveCoreRuntimeModule(e,t)}catch{}return null}const sm=(function(){const t="cineCoreRuntimeScopeTools";function r(a){if(!a||typeof a!="object"&&typeof a!="function")return null;try{const i=a[t];return i&&typeof i=="object"?i:null}catch{}return null}const n=[(function(){try{return typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null}catch{}return null})(),typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let a=0;a<n.length;a+=1){const i=r(n[a]);if(i)return i}const o=o3("modules/core/runtime-scope-tools.js");if(o&&typeof o=="object")return o;for(let a=0;a<n.length;a+=1){const i=r(n[a]);if(i)return i}return null})();function fz(){try{if(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE)return CORE_GLOBAL_SCOPE}catch{}try{if(typeof globalThis<"u"&&globalThis&&typeof globalThis.CORE_GLOBAL_SCOPE=="object"&&globalThis.CORE_GLOBAL_SCOPE)return globalThis.CORE_GLOBAL_SCOPE}catch{}return null}var Kc=sm&&typeof sm.getPrimaryScopeCandidate=="function"?sm.getPrimaryScopeCandidate():fz(),Mo=sm&&typeof sm.getScopeCandidates=="function"?function(t=[]){return sm.getScopeCandidates({primaryCandidate:Kc,extraCandidates:t})}:function(t=[]){const r=[Kc,fz(),typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],n=Array.isArray(t)?t:[t];for(let a=0;a<n.length;a+=1)r.push(n[a]);const o=[];for(let a=0;a<r.length;a+=1){const i=r[a];if(!i||typeof i!="object"&&typeof i!="function")continue;let s=!1;for(let l=0;l<o.length;l+=1)if(o[l]===i){s=!0;break}s||o.push(i)}return o};typeof window<"u"&&(window.collectRuntimeScopeCandidates=Mo);function a3(){if(typeof Mo!="function")return null;const e=Mo();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){try{if(r.CORE_DEVICE_SCHEMA&&typeof r.CORE_DEVICE_SCHEMA=="object")return r.CORE_DEVICE_SCHEMA}catch{}try{if(r.cineCoreDeviceSchema&&typeof r.cineCoreDeviceSchema=="object")return r.cineCoreDeviceSchema}catch{}}}return null}a3();function dz(){function e(r){if(!r||typeof r!="object"&&typeof r!="function")return null;try{const n=r.cineCoreRuntimeModuleLoader;return n&&typeof n=="object"?n:null}catch{}return null}if(typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object")return cineCoreRuntimeModuleLoader;if(typeof Mo!="function")return null;const t=Mo();for(let r=0;r<t.length;r+=1){const n=e(t[r]);if(n)return n}for(let r=0;r<t.length;r+=1){const n=e(t[r]);if(n)return n}return null}function i3(e,t){const r=dz();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{const n=r.resolveCoreRuntimeModule(e,t);return n}catch{}return null}const lm=(function(){const t="cineCoreRuntimeSupportBootstrap";function r(o){if(!o||typeof o!="object"&&typeof o!="function")return null;try{const a=o[t];return a&&typeof a=="object"?a:null}catch{}return null}if(typeof Mo!="function")return[];const n=Mo();for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}return null})(),FR=(function(){const t="cineCoreRuntimeSupportResolution";function r(o){if(!o||typeof o!="object"&&typeof o!="function")return null;try{const a=o[t];return a&&typeof a=="object"?a:null}catch{}return null}const n=typeof Mo=="function"?Mo():[];for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}return null})(),Wl=(function(){const t="cineCoreTextEntries";if(typeof cineCoreTextEntries<"u"&&cineCoreTextEntries&&typeof cineCoreTextEntries=="object")return cineCoreTextEntries;const r=typeof Mo=="function"?Mo():[];for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{const a=o[t];if(a&&typeof a=="object")return a}catch{}}return null})(),dB=Wl&&typeof Wl.TEXT_ENTRY_SEPARATOR=="string"&&Wl.TEXT_ENTRY_SEPARATOR?Wl.TEXT_ENTRY_SEPARATOR:`
`;function WA(e){if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"){try{return String(e)}catch{}return""}if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r+=1){const n=WA(e[r]);n&&t.push(n)}return t.join(dB)}if(e&&typeof e=="object"){if(typeof e.text=="string")return e.text;if(Array.isArray(e.text))return WA(e.text);if(typeof e.label=="string")return e.label;try{const t=String(e);if(t&&t!=="[object Object]")return t}catch{}}return""}function s3(e,t,r,n=""){const o=typeof n=="string"?n:"",a=[];e&&(typeof e=="object"||typeof e=="function")&&a.push(e),t&&t!==e&&(typeof t=="object"||typeof t=="function")&&a.push(t);for(let i=0;i<a.length;i+=1){const s=a[i];let l;try{l=s[r]}catch{l=void 0}if(typeof l>"u"||l===null)continue;const c=WA(l);if(typeof c=="string")return c}return o}Wl&&Wl.normaliseTextEntryValue;const l3=Wl&&typeof Wl.resolveTextEntry=="function"?function(t,r,n,o=""){return Wl.resolveTextEntry(t,r,n,o,dB)}:s3;(function(t){const r=[Kc,typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{if(typeof o.resolveTextEntry=="function")return o.resolveTextEntry}catch{}}try{if(typeof resolveTextEntry=="function")return resolveTextEntry}catch{}for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{if(o.resolveTextEntry=t,typeof o.resolveTextEntry=="function")return o.resolveTextEntry}catch{}}return t})(l3);const c3="cameraPowerPlanner_temperatureUnit";function u3(){const e=typeof Mo=="function"?Mo():[];for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(typeof r.TEMPERATURE_STORAGE_KEY=="string"&&r.TEMPERATURE_STORAGE_KEY)return r.TEMPERATURE_STORAGE_KEY;if(typeof r.TEMPERATURE_UNIT_STORAGE_KEY=="string"&&r.TEMPERATURE_UNIT_STORAGE_KEY)return r.TEMPERATURE_UNIT_STORAGE_KEY;if(r.CORE_SHARED&&typeof r.CORE_SHARED=="object"&&typeof r.CORE_SHARED.TEMPERATURE_STORAGE_KEY=="string"&&r.CORE_SHARED.TEMPERATURE_STORAGE_KEY)return r.CORE_SHARED.TEMPERATURE_STORAGE_KEY;if(r.__cineStorageApi&&typeof r.__cineStorageApi=="object"){const n=r.__cineStorageApi;if(typeof n.TEMPERATURE_STORAGE_KEY=="string"&&n.TEMPERATURE_STORAGE_KEY)return n.TEMPERATURE_STORAGE_KEY;if(typeof n.getTemperaturePreferenceStorageKey=="function")try{const o=n.getTemperaturePreferenceStorageKey();if(typeof o=="string"&&o)return o}catch{}}if(typeof r.resolveTemperatureStorageKey=="function")try{const n=r.resolveTemperatureStorageKey();if(typeof n=="string"&&n)return n}catch{}}}return c3}const f3=typeof TEMPERATURE_STORAGE_KEY=="string"&&TEMPERATURE_STORAGE_KEY?TEMPERATURE_STORAGE_KEY:null,d3=f3||u3();(function(t){const r=[Kc,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null];for(let o=0;o<r.length;o+=1){const a=r[o];if(!(!a||typeof a!="object"&&typeof a!="function")&&!(typeof a.TEMPERATURE_STORAGE_KEY=="string"&&a.TEMPERATURE_STORAGE_KEY))try{a.TEMPERATURE_STORAGE_KEY=t}catch{}}const n=r.map(o=>{if(!o||typeof o!="object"&&typeof o!="function")return null;try{return o.CORE_SHARED&&typeof o.CORE_SHARED=="object"?o.CORE_SHARED:null}catch{}return null}).filter(o=>o);for(let o=0;o<n.length;o+=1){const a=n[o];if(!(!a||typeof a!="object")&&!(typeof a.TEMPERATURE_STORAGE_KEY=="string"&&a.TEMPERATURE_STORAGE_KEY))try{a.TEMPERATURE_STORAGE_KEY=t}catch{}}})(d3);const $g=(function(){const t="cineCoreRuntimeSupportDefaults";function r(o){if(!o||typeof o!="object"&&typeof o!="function")return null;try{const a=o[t];return a&&typeof a=="object"?a:null}catch{}return null}const n=typeof Mo=="function"?Mo():[];for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}for(let o=0;o<n.length;o+=1){const a=r(n[o]);if(a)return a}return null})();function p3(){function e(r){if(r&&(typeof r=="object"||typeof r=="function"))return r;const n=typeof Mo=="function"?Mo():[];for(let o=0;o<n.length;o+=1){const a=n[o];if(a&&(typeof a=="object"||typeof a=="function"))return a}return null}function t(r,n,o){if(typeof r!="string"||!r)return null;const a=e(o);if(a&&a[r]&&typeof a[r]=="object")return a[r];if(typeof require=="function"&&typeof n=="string"&&n)try{const i=require(n);if(i&&typeof i=="object")return i}catch{}return null}return{fallbackDetectRuntimeScope:e,fallbackResolveCoreSupportModule:t,readRuntimeSupportResolver:function(){return Object.freeze({detectRuntimeScope:e,resolveCoreSupportModule:t})}}}const pB=$g&&typeof $g.fallbackDetectRuntimeScope=="function"&&typeof $g.fallbackResolveCoreSupportModule=="function"&&typeof $g.readRuntimeSupportResolver=="function"?$g:p3(),cm=(function(){if(FR&&typeof FR.readRuntimeSupportResolver=="function")try{return FR.readRuntimeSupportResolver(Kc)}catch{}try{return pB.readRuntimeSupportResolver(Kc)}catch{}return null})(),Pa=lm&&typeof lm.resolveBootstrap=="function"?lm.resolveBootstrap(Kc):null,um=!Pa&&lm&&typeof lm.readRuntimeSupportTools=="function"?lm.readRuntimeSupportTools(Kc):null,m3=Pa&&typeof Pa.fallbackDetectRuntimeScope=="function"&&Pa.fallbackDetectRuntimeScope||um&&typeof um.fallbackDetectRuntimeScope=="function"&&um.fallbackDetectRuntimeScope||cm&&typeof cm.detectRuntimeScope=="function"&&cm.detectRuntimeScope||pB.fallbackDetectRuntimeScope,g3=Pa&&typeof Pa.detectRuntimeScope=="function"&&Pa.detectRuntimeScope||m3,y3=Pa&&typeof Pa.fallbackResolveCoreSupportModule=="function"&&Pa.fallbackResolveCoreSupportModule||um&&typeof um.fallbackResolveCoreSupportModule=="function"&&um.fallbackResolveCoreSupportModule||cm&&typeof cm.resolveCoreSupportModule=="function"&&cm.resolveCoreSupportModule||pB.fallbackResolveCoreSupportModule;var V_=Pa&&Pa.runtimeScope?Pa.runtimeScope:g3(Kc);const ac=Pa&&typeof Pa.resolveCoreSupportModule=="function"?function(t,r){return Pa.resolveCoreSupportModule(t,r,V_)}:function(t,r){return y3(t,r,V_)};(function(){const t="cineCoreRuntimeSupportExports";function r(i){if(!i||typeof i!="object"&&typeof i!="function")return null;try{const s=i[t];return s&&typeof s=="object"?s:null}catch{}return null}const n=typeof Mo=="function"?Mo([typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null]):[typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null];let o=null;for(let i=0;i<n.length;i+=1){const s=r(n[i]);if(s){o=s;break}}if(!o||typeof o!="object")o={};else{const i=typeof Object.isExtensible=="function"?Object.isExtensible(o):!0,s=typeof Object.isSealed=="function"&&Object.isSealed(o);(!i||s)&&(o=Object.assign({},o))}function a(i,s,l){if(!(!i||typeof i!="object")){try{if(i[s]=l,i[s]===l)return}catch{}try{Object.defineProperty(i,s,{configurable:!0,writable:!0,value:l})}catch{}}}a(o,"resolveRuntimeModuleLoader",dz),a(o,"requireCoreRuntimeModule",i3);for(let i=0;i<n.length;i+=1){const s=n[i];if(!(!s||typeof s!="object"&&typeof s!="function"))try{s[t]=o}catch{}}if(typeof module=="object"&&module&&typeof module.exports=="object")try{module.exports=o}catch{}return o})();function Ce(e){return!!e&&(typeof e=="object"||typeof e=="function")}function Ps(e){return typeof e=="function"?e:typeof require=="function"?require:null}function ts(e){return Array.isArray(e)?e.slice():[]}function us(e,t){!t||!Ce(t)||Array.isArray(e)&&e.indexOf(t)===-1&&e.push(t)}function Wi(e,t){if(typeof e!="function")return null;try{const r=e(t);return r&&typeof r=="object"?r:null}catch{}return null}function ic(e,t){const r=arguments.length>1,n=r?e:null,o=r?t:e,a={};if(n&&Ce(n)&&!Array.isArray(n)){const s=Object.keys(n);for(let l=0;l<s.length;l+=1){const c=s[l];a[c]=n[c]}}a.resolveCoreSupportModule=typeof a.resolveCoreSupportModule=="function"?a.resolveCoreSupportModule:null,a.requireFn=Ps(a.requireFn),a.runtimeScope=a.runtimeScope&&Ce(a.runtimeScope)?a.runtimeScope:null,a.coreGlobalScope=a.coreGlobalScope&&Ce(a.coreGlobalScope)?a.coreGlobalScope:null,a.fallbackScopes=ts(a.fallbackScopes);function i(s){if(!s)return;if(Array.isArray(s)){a.fallbackScopes=s.slice();return}if(!Ce(s))return;Array.isArray(s.fallbackScopes)?a.fallbackScopes=s.fallbackScopes.slice():s.fallbackScopes&&(a.fallbackScopes=[s.fallbackScopes]),s.runtimeScope&&Ce(s.runtimeScope)&&(a.runtimeScope=s.runtimeScope),s.coreGlobalScope&&Ce(s.coreGlobalScope)&&(a.coreGlobalScope=s.coreGlobalScope),typeof s.requireFn=="function"?a.requireFn=s.requireFn:Object.prototype.hasOwnProperty.call(s,"requireFn")&&(a.requireFn=Ps(s.requireFn)),typeof s.resolveCoreSupportModule=="function"?a.resolveCoreSupportModule=s.resolveCoreSupportModule:Object.prototype.hasOwnProperty.call(s,"resolveCoreSupportModule")&&(a.resolveCoreSupportModule=null);const l=Object.keys(s);for(let c=0;c<l.length;c+=1){const u=l[c];u==="fallbackScopes"||u==="runtimeScope"||u==="coreGlobalScope"||u==="requireFn"||u==="resolveCoreSupportModule"||(a[u]=s[u])}}return i(o),a.requireFn=Ps(a.requireFn),a.fallbackScopes=ts(a.fallbackScopes),a}function Yd(e){const t=ic(e),r=t.runtimeScope,n=t.coreGlobalScope,o=ts(t.fallbackScopes),a=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||mB(t),i=t.bootstrapResultsTools||gB(t);if(i&&typeof i.collectBootstrapFallbackScopes=="function"){const s=a&&typeof a.collectFallbackScopes=="function"?function(c){try{const u=a.collectFallbackScopes({fallbackScopes:Array.isArray(c)?c:ts(c),runtimeScope:r,coreGlobalScope:n});if(Array.isArray(u))return u}catch{}if(Array.isArray(c))try{const u=a.collectFallbackScopes(c);if(Array.isArray(u))return u}catch{}return null}:null;try{const l=i.collectBootstrapFallbackScopes({fallbackScopes:o,runtimeScope:r,coreGlobalScope:n,collectFallbackScopes:s});if(Array.isArray(l))return l}catch{}}if(a&&typeof a.collectFallbackScopes=="function"){try{const s=a.collectFallbackScopes({fallbackScopes:o,runtimeScope:r,coreGlobalScope:n});if(Array.isArray(s))return s}catch{}if(Array.isArray(o))try{const s=a.collectFallbackScopes(o);if(Array.isArray(s))return s}catch{}}return Zb(o,r,n)}function mB(e){return e&&Ce(e.bootstrapEnvironmentTools)?e.bootstrapEnvironmentTools:e&&Ce(e.bootstrapEnvironment)?e.bootstrapEnvironment:Xh(e)}function gB(e){return e&&Ce(e.bootstrapResultsTools)?e.bootstrapResultsTools:e&&Ce(e.resultsTools)?e.resultsTools:Jh(e)}function pz(e){return e&&Ce(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:e&&Ce(e.fallbackTools)?e.fallbackTools:Qh(e)}function mz(e){return e&&Ce(e.bootstrapResolverTools)&&Cf(e.bootstrapResolverTools)?e.bootstrapResolverTools:tS(e)}function Zb(e,t,r){if(!Array.isArray(e))return[];const n=e.slice();t&&Ce(t)&&n.indexOf(t)===-1&&n.push(t),r&&Ce(r)&&n.indexOf(r)===-1&&n.push(r);const o=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let a=0;a<o.length;a+=1){const i=o[a];!i||!Ce(i)||n.indexOf(i)===-1&&n.push(i)}return n}function eS(e,t,r){const n=r&&Ce(r.directNamespace)?r.directNamespace:null;if(n)return n;const o=r&&typeof r.resolveCoreSupportModule=="function"?r.resolveCoreSupportModule:null;if(o)try{const s=o(e,t);if(s&&Ce(s))return s}catch{}const a=Ps(r&&r.requireFn);if(typeof a=="function"&&t)try{const s=a(t);if(s&&Ce(s))return s}catch{}const i=Yd(r);for(let s=0;s<i.length;s+=1){const l=i[s];if(!(!l||!Ce(l)))try{const c=l[e];if(c&&Ce(c))return c}catch{}}return null}function YA(e){return eS("cineCoreAppCoreBootstrap","./modules/app-core/bootstrap.js",e)}function Qh(e){return eS("cineCoreAppCoreBootstrapFallbacks","./modules/app-core/bootstrap.js",e)}function Up(e,t){const r=e&&typeof e=="object"&&!Array.isArray(e)?Object.assign({},e):{};return!r.directNamespace&&t&&Ce(t)&&(r.directNamespace=t),r}function Xh(e){const t=Up(e,e&&Ce(e.directBootstrapEnvironmentNamespace)?e.directBootstrapEnvironmentNamespace:null);return eS("cineCoreAppCoreBootstrapEnvironment","./modules/app-core/bootstrap.js",t)}function Jh(e){const t=Up(e,e&&Ce(e.directBootstrapResultsNamespace)?e.directBootstrapResultsNamespace:null);return eS("cineCoreAppCoreBootstrapResults","./modules/app-core/bootstrap.js",t)}function eg(e){const t=e&&Ce(e.runtimeScope)?e.runtimeScope:null,r=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null;return Zb(ts(e&&e.fallbackScopes),t,r)}function Cf(e){return!!e&&typeof e=="object"&&typeof e.resolveBootstrapTools=="function"&&typeof e.resolveBootstrapFallbackTools=="function"&&typeof e.createInlineLocalizationFallback=="function"&&typeof e.createInlineRuntimeSharedFallback=="function"}function tS(e){const t=e&&Ce(e.directResolverNamespace)?e.directResolverNamespace:null;if(Cf(t))return t;const r={resolveCoreSupportModule:e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,requireFn:Ps(e&&e.requireFn),runtimeScope:e&&Ce(e.runtimeScope)?e.runtimeScope:null,coreGlobalScope:e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,fallbackScopes:ts(e&&e.fallbackScopes)},n=eS("cineCoreAppCoreBootstrapResolver","./modules/app-core/bootstrap.js",Object.assign({},r,{directNamespace:t}));if(Cf(n))return n;if(n&&Ce(n.cineCoreAppCoreBootstrapResolver)&&Cf(n.cineCoreAppCoreBootstrapResolver))return n.cineCoreAppCoreBootstrapResolver;if(n&&Ce(n.cineCoreAppCoreBootstrap)&&Cf(n.cineCoreAppCoreBootstrap))return n.cineCoreAppCoreBootstrap;const o=Yd(r);for(let a=0;a<o.length;a+=1){const i=o[a];if(!(!i||!Ce(i)))try{const s=i.cineCoreAppCoreBootstrapResolver;if(Cf(s))return s;const l=i.cineCoreAppCoreBootstrap;if(Cf(l))return l}catch{}}return null}function gz(e){const t=e&&Ce(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.resolveBootstrapTools=="function")try{const i=t.resolveBootstrapTools(e);if(i&&Ce(i))return i}catch{}const r=e&&Ce(e.directBootstrapNamespace)?e.directBootstrapNamespace:null;if(r&&Ce(r))return r;const n=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null;if(n)try{const i=n("cineCoreAppCoreBootstrap","./modules/app-core/bootstrap.js");if(i&&Ce(i))return i}catch{}const o=Ps(e&&e.requireFn);if(typeof o=="function")try{const i=o("./modules/app-core/bootstrap.js");if(i&&Ce(i))return i}catch{}const a=eg(e);for(let i=0;i<a.length;i+=1){const s=a[i];if(!(!s||!Ce(s)))try{const l=s.cineCoreAppCoreBootstrap;if(l&&Ce(l))return l}catch{}}return null}function yz(e){const t=e&&Ce(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.resolveBootstrapFallbackTools=="function")try{const i=t.resolveBootstrapFallbackTools(e);if(i&&Ce(i))return i}catch{}const r=e&&Ce(e.directBootstrapFallbackNamespace)?e.directBootstrapFallbackNamespace:null;if(r&&Ce(r))return r;const n=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null;if(n)try{const i=n("cineCoreAppCoreBootstrapFallbacks","./modules/app-core/bootstrap.js");if(i&&Ce(i))return i}catch{}const o=Ps(e&&e.requireFn);if(typeof o=="function")try{const i=o("./modules/app-core/bootstrap.js");if(i&&Ce(i.cineCoreAppCoreBootstrapFallbacks))return i.cineCoreAppCoreBootstrapFallbacks;if(i&&Ce(i))return i}catch{}const a=eg(e);for(let i=0;i<a.length;i+=1){const s=a[i];if(!(!s||!Ce(s)))try{const l=s.cineCoreAppCoreBootstrapFallbacks;if(l&&Ce(l))return l}catch{}}return null}function hz(e){const t=e&&Ce(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.createInlineLocalizationFallback=="function")try{const n=t.createInlineLocalizationFallback(e);if(n&&Ce(n))return n}catch{}const r=e&&Ce(e.fallbackTools)?e.fallbackTools:null;if(r&&typeof r.createLocalizationBootstrapFallback=="function")try{const n=r.createLocalizationBootstrapFallback(e);if(n&&Ce(n))return n}catch{}return xg()}function bz(e){const t=e&&Ce(e.bootstrapResolverTools)?e.bootstrapResolverTools:null;if(t&&typeof t.createInlineRuntimeSharedFallback=="function")try{const i=t.createInlineRuntimeSharedFallback(e);if(i&&Ce(i))return i}catch{}const r=e&&Ce(e.fallbackTools)?e.fallbackTools:null;if(r&&typeof r.createRuntimeSharedBootstrapFallback=="function")try{const i=r.createRuntimeSharedBootstrapFallback(e);if(i&&Ce(i))return i}catch{}const n=eg(e);function o(){for(let i=0;i<n.length;i+=1){const s=n[i];if(!(!s||!Ce(s)))try{const l=s.cineCoreRuntimeShared;if(l&&Ce(l))return l}catch{}}return null}let a=e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null;if(a||(a=o()),!a||typeof a!="object")try{a=Object.create(null)}catch{a={}}return{runtimeSharedNamespace:null,runtimeSharedResolver:null,existingRuntimeShared:a,runtimeShared:a,fallbackResolveRuntimeSharedFromGlobal:o}}function Sz(e){const t=Ps(e&&e.requireFn),r=e&&Ce(e.runtimeScope)?e.runtimeScope:null,n=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,o=eg({runtimeScope:r,coreGlobalScope:n,fallbackScopes:e&&e.fallbackScopes}),a=tS({directResolverNamespace:e&&e.directResolverNamespace,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:n,fallbackScopes:o}),i=gz({directBootstrapNamespace:e&&e.directBootstrapNamespace,bootstrapResolverTools:a,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:n,fallbackScopes:o}),s=yz({directBootstrapFallbackNamespace:e&&e.directBootstrapFallbackNamespace,bootstrapResolverTools:a,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:n,fallbackScopes:o});function l(){return hz({bootstrapResolverTools:a,fallbackTools:s,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:n,fallbackScopes:o})}function c(f){const d=f&&f.fallbackScopes?f.fallbackScopes:o;return bz({bootstrapResolverTools:a,fallbackTools:s,resolveCoreSupportModule:e&&e.resolveCoreSupportModule,requireFn:t,runtimeScope:r,coreGlobalScope:n,fallbackScopes:d,currentRuntimeShared:f&&Ce(f.currentRuntimeShared)?f.currentRuntimeShared:null})}function u(f){return eg({runtimeScope:r,coreGlobalScope:n,fallbackScopes:f})}return{fallbackScopes:o,bootstrapResolverTools:a,bootstrapTools:i,bootstrapFallbackTools:s,createInlineLocalizationFallback:l,createInlineRuntimeSharedFallback:c,collectFallbackScopes:u}}function AL(e){const t=e&&Ce(e.runtimeScope)?e.runtimeScope:null,r=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,n=e?e.fallbackScopes:null;if(e&&typeof e.collectFallbackScopes=="function")try{const a=e.collectFallbackScopes(n);if(Array.isArray(a)){const i=ts(a);return us(i,t),us(i,r),us(i,typeof globalThis<"u"?globalThis:null),us(i,typeof window<"u"?window:null),us(i,typeof self<"u"?self:null),us(i,typeof global<"u"?global:null),i}}catch{}const o=ts(n);return us(o,t),us(o,r),us(o,typeof globalThis<"u"?globalThis:null),us(o,typeof window<"u"?window:null),us(o,typeof self<"u"?self:null),us(o,typeof global<"u"?global:null),o}function vz(){return{localizationSupport:null,localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function yB(e){const t=AL(e||null),r=e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null;function n(){for(let a=0;a<t.length;a+=1){const i=t[a];if(Ce(i))try{const s=i.cineCoreRuntimeShared;if(s&&typeof s=="object")return s}catch{}}return null}let o=r;if((!o||typeof o!="object")&&(o=n()),!o||typeof o!="object")try{o=Object.create(null)}catch{o={}}return{runtimeSharedNamespace:null,runtimeSharedResolver:null,existingRuntimeShared:o,runtimeShared:o,fallbackResolveRuntimeSharedFromGlobal:n}}function h3(e){const t=e&&Ce(e.runtimeScope)?e.runtimeScope:null,r=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,n=AL({runtimeScope:t,coreGlobalScope:r,fallbackScopes:e&&e.fallbackScopes,collectFallbackScopes:e&&e.collectFallbackScopes}),o=Ps(e&&e.requireFn),a=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,i={localizationSupportTools:e&&Ce(e.localizationSupportTools)?e.localizationSupportTools:null,localizationBootstrapTools:e&&Ce(e.localizationBootstrapTools)?e.localizationBootstrapTools:null,localizationRuntimeTools:e&&Ce(e.localizationRuntimeTools)?e.localizationRuntimeTools:null,resolveCoreSupportModule:a,requireFn:o,runtimeScope:t,coreGlobalScope:r,fallbackScopes:n,currentLocalization:e&&Ce(e.currentLocalization)?e.currentLocalization:null},s=e&&Ce(e.bootstrapTools)?e.bootstrapTools:null;let l=Wi(s&&s.createLocalizationBootstrapResult,i);if(l||(l=Wi(s&&s.createLocalizationBootstrapFallback,i)),!l){const c=e&&typeof e.createInlineLocalizationFallback=="function"?e.createInlineLocalizationFallback:null;l=Wi(c,{fallbackTools:e&&Ce(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:null,resolveCoreSupportModule:a,requireFn:o,runtimeScope:t,coreGlobalScope:r,fallbackScopes:n,localizationFallbackOptions:e&&e.localizationFallbackOptions?e.localizationFallbackOptions:null})}return l||(l=vz()),l}function b3(e){const t=e&&Ce(e.runtimeScope)?e.runtimeScope:null,r=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,n=AL({runtimeScope:t,coreGlobalScope:r,fallbackScopes:e&&e.fallbackScopes,collectFallbackScopes:e&&e.collectFallbackScopes}),o=Ps(e&&e.requireFn),a=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,i={runtimeSharedBootstrapResolverTools:e&&Ce(e.runtimeSharedBootstrapResolverTools)?e.runtimeSharedBootstrapResolverTools:null,runtimeSharedBootstrapTools:e&&Ce(e.runtimeSharedBootstrapTools)?e.runtimeSharedBootstrapTools:null,runtimeSharedNamespaceTools:e&&Ce(e.runtimeSharedNamespaceTools)?e.runtimeSharedNamespaceTools:null,runtimeSharedBootstrapInlineTools:e&&Ce(e.runtimeSharedBootstrapInlineTools)?e.runtimeSharedBootstrapInlineTools:null,runtimeSharedBootstrapResultTools:e&&Ce(e.runtimeSharedBootstrapResultTools)?e.runtimeSharedBootstrapResultTools:null,runtimeSharedBootstrapLoaderTools:e&&Ce(e.runtimeSharedBootstrapLoaderTools)?e.runtimeSharedBootstrapLoaderTools:null,runtimeSharedBootstrapManagerTools:e&&Ce(e.runtimeSharedBootstrapManagerTools)?e.runtimeSharedBootstrapManagerTools:null,resolveCoreSupportModule:a,requireFn:o,runtimeScope:t,coreGlobalScope:r,currentRuntimeShared:e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null,fallbackScopes:n,runtimeSharedBootstrapInlineRequirePath:e&&e.runtimeSharedBootstrapInlineRequirePath?e.runtimeSharedBootstrapInlineRequirePath:null,runtimeSharedBootstrapResultRequirePath:e&&e.runtimeSharedBootstrapResultRequirePath?e.runtimeSharedBootstrapResultRequirePath:null},s=e&&Ce(e.bootstrapTools)?e.bootstrapTools:null;let l=Wi(s&&s.createRuntimeSharedBootstrapResult,i);if(l||(l=Wi(s&&s.createRuntimeSharedBootstrapFallback,i)),!l){const c=e&&typeof e.createInlineRuntimeSharedFallback=="function"?e.createInlineRuntimeSharedFallback:null;l=Wi(c,{fallbackTools:e&&Ce(e.bootstrapFallbackTools)?e.bootstrapFallbackTools:null,resolveCoreSupportModule:a,requireFn:o,runtimeScope:t,coreGlobalScope:r,fallbackScopes:n,currentRuntimeShared:e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null})}return l||(l=yB({runtimeScope:t,coreGlobalScope:r,fallbackScopes:n,currentRuntimeShared:e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null})),l}function xg(){return{localizationSupport:null,localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function Ez(e){const t=e&&Ce(e.localizationSupportTools)?e.localizationSupportTools:null,r=e&&Ce(e.localizationBootstrapTools)?e.localizationBootstrapTools:null,n=e&&Ce(e.localizationRuntimeTools)?e.localizationRuntimeTools:null,o=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,a=Ps(e&&e.requireFn),i=e&&Ce(e.runtimeScope)?e.runtimeScope:null,s=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,l=Zb(ts(e&&e.fallbackScopes),i,s),c={localizationSupportTools:t,resolveCoreSupportModule:o,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:l};let u=Wi(r&&r.createLocalizationBootstrapResult,c);return u||(u=Wi(n&&n.resolveRuntimeLocalization,{currentLocalization:e&&e.currentLocalization,resolveCoreSupportModule:o,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:l})),u||(u=Wi(n&&n.createFallbackLocalizationRuntimeSetup,{currentLocalization:e&&e.currentLocalization,resolveCoreSupportModule:o,requireFn:a,runtimeScope:i,coreGlobalScope:s,fallbackScopes:l})),u||(u=xg()),u}function QA(e){const t=ic(e),r=t.runtimeScope,n=t.coreGlobalScope,o=t.requireFn,a=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||mB(t),i=t.bootstrapResultsTools||gB(t),s=t.localizationFallbackOptions||null,l=ic(t,{bootstrapEnvironmentTools:a,bootstrapEnvironment:a,bootstrapResultsTools:i,fallbackScopes:t.fallbackScopes}),c=Yd(l);l.fallbackScopes=c;const u=t.bootstrapResolverTools||mz(l),f=t.bootstrapFallbackTools||t.fallbackTools||pz(l),d=t.bootstrapSuite&&Ce(t.bootstrapSuite)?t.bootstrapSuite:null;if(u&&typeof u.createInlineLocalizationFallback=="function")try{const p=u.createInlineLocalizationFallback({fallbackTools:f,resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:o,runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,localizationFallbackOptions:s});if(p&&Ce(p))return p}catch{}if(d&&typeof d.createLocalizationBootstrapFallback=="function")try{const p=d.createLocalizationBootstrapFallback({fallbackScopes:c,runtimeScope:r,coreGlobalScope:n,localizationFallbackOptions:s});if(p&&Ce(p))return p}catch{}if(f&&typeof f.createLocalizationBootstrapFallback=="function")try{const p=f.createLocalizationBootstrapFallback({resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:o,runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,localizationFallbackOptions:s});if(p&&Ce(p))return p}catch{}if(i&&typeof i.createLocalizationFallbackSkeleton=="function")try{const p=i.createLocalizationFallbackSkeleton();if(p&&Ce(p))return p}catch{}return xg()}function CL(e){const t=e&&Ce(e.runtimeScope)?e.runtimeScope:null,r=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,n=Zb(ts(e&&e.fallbackScopes),t,r),o=e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null;function a(){for(let s=0;s<n.length;s+=1){const l=n[s];if(!(!l||!Ce(l)))try{const c=l.cineCoreRuntimeShared;if(c&&typeof c=="object")return c}catch{}}return null}let i=o;if((!i||typeof i!="object")&&(i=a()),!i||typeof i!="object")try{i=Object.create(null)}catch{i={}}return{runtimeSharedNamespace:null,runtimeSharedResolver:null,existingRuntimeShared:i,runtimeShared:i,fallbackResolveRuntimeSharedFromGlobal:a}}function XA(e){const t=ic(e),r=t.runtimeScope,n=t.coreGlobalScope,o=t.requireFn,a=t.bootstrapEnvironmentTools||t.bootstrapEnvironment||mB(t),i=t.bootstrapResultsTools||gB(t),s=t.currentRuntimeShared&&Ce(t.currentRuntimeShared)?t.currentRuntimeShared:null,l=ic(t,{bootstrapEnvironmentTools:a,bootstrapEnvironment:a,bootstrapResultsTools:i,fallbackScopes:t.fallbackScopes,currentRuntimeShared:s}),c=Yd(l);l.fallbackScopes=c,l.currentRuntimeShared=s;const u=t.bootstrapResolverTools||mz(l),f=t.bootstrapFallbackTools||t.fallbackTools||pz(l),d=t.bootstrapSuite&&Ce(t.bootstrapSuite)?t.bootstrapSuite:null;if(u&&typeof u.createInlineRuntimeSharedFallback=="function")try{const p=u.createInlineRuntimeSharedFallback({fallbackTools:f,resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:o,runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,currentRuntimeShared:s});if(p&&Ce(p))return p}catch{}if(d&&typeof d.createRuntimeSharedBootstrapFallback=="function")try{const p=d.createRuntimeSharedBootstrapFallback({fallbackScopes:c,runtimeScope:r,coreGlobalScope:n,currentRuntimeShared:s});if(p&&Ce(p))return p}catch{}if(f&&typeof f.createRuntimeSharedBootstrapFallback=="function")try{const p=f.createRuntimeSharedBootstrapFallback({resolveCoreSupportModule:t.resolveCoreSupportModule,requireFn:o,runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,currentRuntimeShared:s});if(p&&Ce(p))return p}catch{}if(i&&typeof i.createRuntimeSharedFallbackSkeleton=="function")try{const p=i.createRuntimeSharedFallbackSkeleton({runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,currentRuntimeShared:s});if(p&&Ce(p))return p}catch{}return yB({runtimeScope:r,coreGlobalScope:n,fallbackScopes:c,currentRuntimeShared:s})}function Az(e){const t=e&&Ce(e.runtimeSharedBootstrapResolverTools)?e.runtimeSharedBootstrapResolverTools:null,r=e&&Ce(e.runtimeSharedBootstrapTools)?e.runtimeSharedBootstrapTools:null,n=e&&Ce(e.runtimeSharedNamespaceTools)?e.runtimeSharedNamespaceTools:null,o=e&&Ce(e.runtimeSharedBootstrapInlineTools)?e.runtimeSharedBootstrapInlineTools:null,a=e&&Ce(e.runtimeSharedBootstrapResultTools)?e.runtimeSharedBootstrapResultTools:null,i=e&&Ce(e.runtimeSharedBootstrapLoaderTools)?e.runtimeSharedBootstrapLoaderTools:null,s=e&&Ce(e.runtimeSharedBootstrapManagerTools)?e.runtimeSharedBootstrapManagerTools:null,l=e&&typeof e.resolveCoreSupportModule=="function"?e.resolveCoreSupportModule:null,c=Ps(e&&e.requireFn),u=e&&Ce(e.runtimeScope)?e.runtimeScope:null,f=e&&Ce(e.coreGlobalScope)?e.coreGlobalScope:null,d=Zb(ts(e&&e.fallbackScopes),u,f),p=e&&Ce(e.currentRuntimeShared)?e.currentRuntimeShared:null,h={runtimeSharedBootstrapTools:r,runtimeSharedNamespaceTools:n,runtimeSharedBootstrapInlineTools:o,runtimeSharedBootstrapResultTools:a,runtimeSharedBootstrapLoaderTools:i,runtimeSharedBootstrapManagerTools:s,resolveCoreSupportModule:l,requireFn:c,runtimeScope:u,coreGlobalScope:f,currentRuntimeShared:p,fallbackScopes:d};let m=Wi(t&&t.createRuntimeSharedBootstrapResult,h);return m||(m=Wi(i&&i.resolveRuntimeSharedBootstrapResult,{bootstrapOptions:h,runtimeSharedBootstrapInlineTools:o,resultTools:a,requireFn:c,inlineRequirePath:e&&e.runtimeSharedBootstrapInlineRequirePath,resultModulePath:e&&e.runtimeSharedBootstrapResultRequirePath})),m||(m=Wi(a&&a.createRuntimeSharedBootstrapResult,{bootstrapOptions:{runtimeSharedBootstrapTools:r,runtimeSharedNamespaceTools:n,resolveCoreSupportModule:l,requireFn:c,runtimeScope:u,coreGlobalScope:f,currentRuntimeShared:p,fallbackScopes:d},runtimeSharedBootstrapInlineTools:o,requireFn:c,inlineRequirePath:e&&e.runtimeSharedBootstrapInlineRequirePath})),!m&&a&&(m=Wi(a.createRuntimeSharedBootstrapInlineFallback,{runtimeScope:u,coreGlobalScope:f,fallbackScopes:d,currentRuntimeShared:p})),m||(m=CL({runtimeScope:u,coreGlobalScope:f,fallbackScopes:d,currentRuntimeShared:p})),m}function Cz(e){const t=ic(e),r=t.requireFn,n=YA(Up(t,t.directBootstrapNamespace||null))||null,o=Qh(Up(t,t.directBootstrapFallbackNamespace||null))||null,a=Xh(Up(t,t.directBootstrapEnvironmentNamespace||null))||null,i=Jh(Up(t,t.directBootstrapResultsNamespace||null))||null;function s(S){const y={resolveCoreSupportModule:t&&typeof t.resolveCoreSupportModule=="function"?t.resolveCoreSupportModule:null,requireFn:r,runtimeScope:t&&Ce(t.runtimeScope)?t.runtimeScope:null,coreGlobalScope:t&&Ce(t.coreGlobalScope)?t.coreGlobalScope:null},E=[];if(Array.isArray(t.fallbackScopes))for(let L=0;L<t.fallbackScopes.length;L+=1)E.push(t.fallbackScopes[L]);if(S&&typeof S=="object"){const L=Object.keys(S);for(let v=0;v<L.length;v+=1){const A=L[v];if(A==="fallbackScopes"){const R=S[A];if(Array.isArray(R))for(let I=0;I<R.length;I+=1)E.push(R[I]);else R&&Ce(R)&&E.push(R);continue}y[A]=S[A]}}return y.fallbackScopes=E,ic(y)}function l(S){const y=s(S),E=ts(y.fallbackScopes),L=y.runtimeScope,v=y.coreGlobalScope;if(i&&typeof i.collectBootstrapFallbackScopes=="function"){const A=a&&typeof a.collectFallbackScopes=="function"?function(I){return a.collectFallbackScopes({fallbackScopes:Array.isArray(I)?I:ts(I),runtimeScope:L,coreGlobalScope:v})}:null;try{const R=i.collectBootstrapFallbackScopes({fallbackScopes:E,runtimeScope:L,coreGlobalScope:v,collectFallbackScopes:A});if(Array.isArray(R))return R}catch{}}return Yd({runtimeScope:L,coreGlobalScope:v,fallbackScopes:E})}function c(S){if(a&&typeof a.createBootstrapEnvironment=="function"){const y=s(S);!y.directResolverNamespace&&t.directResolverNamespace&&(y.directResolverNamespace=t.directResolverNamespace),!y.directBootstrapNamespace&&n&&(y.directBootstrapNamespace=n),!y.directBootstrapFallbackNamespace&&o&&(y.directBootstrapFallbackNamespace=o);try{return a.createBootstrapEnvironment(y)}catch{}}return null}function u(S){const y=s(S);if(y.fallbackScopes=l(S),!y.bootstrapTools&&n&&(y.bootstrapTools=n),!y.bootstrapFallbackTools&&o&&(y.bootstrapFallbackTools=o),y.createInlineLocalizationFallback||(y.createInlineLocalizationFallback=(a&&typeof a.createInlineLocalizationFallback=="function"?a.createInlineLocalizationFallback:null)||(n&&typeof n.createInlineLocalizationFallback=="function"?n.createInlineLocalizationFallback:QA)),i&&typeof i.resolveLocalizationBootstrapResult=="function")try{const E=i.resolveLocalizationBootstrapResult(y);if(E&&Ce(E))return E}catch{}return Ez(y)}function f(S){const y=s(S);if(y.fallbackScopes=l(S),!y.fallbackTools&&o&&(y.fallbackTools=o),i&&typeof i.createLocalizationFallbackSkeleton=="function")try{const E=i.createLocalizationFallbackSkeleton(y);if(E&&Ce(E))return E}catch{}if(o&&typeof o.createLocalizationBootstrapFallback=="function")try{const E=o.createLocalizationBootstrapFallback(y.localizationFallbackOptions||null);if(E&&Ce(E))return E}catch{}return xg()}function d(S){const y=s(S);if(y.fallbackScopes=l(S),!y.bootstrapTools&&n&&(y.bootstrapTools=n),!y.bootstrapFallbackTools&&o&&(y.bootstrapFallbackTools=o),y.createInlineRuntimeSharedFallback||(y.createInlineRuntimeSharedFallback=(a&&typeof a.createInlineRuntimeSharedFallback=="function"?a.createInlineRuntimeSharedFallback:null)||(n&&typeof n.createInlineRuntimeSharedFallback=="function"?n.createInlineRuntimeSharedFallback:XA)),i&&typeof i.resolveRuntimeSharedBootstrapResult=="function")try{const E=i.resolveRuntimeSharedBootstrapResult(y);if(E&&Ce(E))return E}catch{}return Az(y)}function p(S){const y=s(S);if(y.fallbackScopes=l(S),i&&typeof i.createRuntimeSharedFallbackSkeleton=="function")try{const E=i.createRuntimeSharedFallbackSkeleton(y);if(E&&Ce(E))return E}catch{}if(o&&typeof o.createRuntimeSharedBootstrapFallback=="function")try{const E=o.createRuntimeSharedBootstrapFallback(y);if(E&&Ce(E))return E}catch{}return CL(y)}function h(S){const y=s(S);return y.fallbackScopes=l(S),!y.fallbackTools&&o&&(y.fallbackTools=o),QA(y)}function m(S){const y=s(S);return y.fallbackScopes=l(S),!y.fallbackTools&&o&&(y.fallbackTools=o),XA(y)}const g={bootstrapTools:n,bootstrapFallbackTools:o,bootstrapEnvironmentTools:a,bootstrapResultsTools:i,collectBootstrapFallbackScopes:l,createBootstrapEnvironment:c,createLocalizationBootstrapResult:u,createLocalizationBootstrapFallback:f,createRuntimeSharedBootstrapResult:d,createRuntimeSharedBootstrapFallback:p,createInlineLocalizationFallback:h,createInlineRuntimeSharedFallback:m,resolveBootstrapTools:YA,resolveBootstrapFallbackTools:Qh,resolveBootstrapEnvironmentTools:Xh,resolveBootstrapResultsTools:Jh};try{g.bootstrapEnvironment=c(t.bootstrapEnvironmentOptions||null)}catch{g.bootstrapEnvironment=null}return g}const wz={createLocalizationBootstrapResult:Ez,createLocalizationBootstrapFallback:xg,createRuntimeSharedBootstrapResult:Az,createRuntimeSharedBootstrapFallback:CL,normalizeBootstrapInvocationOptions:ic,collectBootstrapFallbackScopes:Yd,resolveBootstrapTools:YA,resolveBootstrapFallbackTools:Qh,resolveBootstrapEnvironmentTools:Xh,resolveBootstrapResultsTools:Jh,createInlineLocalizationFallback:QA,createInlineRuntimeSharedFallback:XA,createBootstrapSuite:Cz,resolveBootstrapResolverTools:tS,createBootstrapEnvironment:Sz},S3=wz,mo=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{},Lz={createLocalizationBootstrapFallback:xg,createRuntimeSharedBootstrapFallback:CL},Rz=Lz,Tz={createBootstrapEnvironment:Sz,resolveBootstrapResolverTools:tS,resolveBootstrapTools:gz,resolveBootstrapFallbackTools:yz,createInlineLocalizationFallback:hz,createInlineRuntimeSharedFallback:bz,collectFallbackScopes:eg,normalizeBootstrapInvocationOptions:ic},Oz=Tz,xz={resolveLocalizationBootstrapResult:h3,resolveRuntimeSharedBootstrapResult:b3,collectBootstrapFallbackScopes(e){return AL(e||null)},createLocalizationFallbackSkeleton:vz,createRuntimeSharedFallbackSkeleton:yB},kz=xz,Gk="cineCoreAppCoreBootstrap",wa=Ce(mo)&&Ce(mo[Gk])?mo[Gk]:{};Object.assign(wa,S3);const Mk="cineCoreAppCoreBootstrapFallbacks",hB=Ce(mo)&&Ce(mo[Mk])?mo[Mk]:{};Object.assign(hB,Rz);const _k="cineCoreAppCoreBootstrapEnvironment",bB=Ce(mo)&&Ce(mo[_k])?mo[_k]:{};Object.assign(bB,Oz);const Dk="cineCoreAppCoreBootstrapResults",SB=Ce(mo)&&Ce(mo[Dk])?mo[Dk]:{};Object.assign(SB,kz);const Iz={resolveBootstrapTools:YA,resolveBootstrapFallbackTools:Qh,resolveBootstrapEnvironmentTools:Xh,resolveBootstrapResultsTools:Jh,resolveBootstrapResolverTools:tS,createInlineLocalizationFallback:QA,createInlineRuntimeSharedFallback:XA,createBootstrapSuite:Cz,normalizeBootstrapInvocationOptions:ic,collectBootstrapFallbackScopes:Yd},Pz=Iz,Nk="cineCoreAppCoreBootstrapResolver",vB=Ce(mo)&&Ce(mo[Nk])?mo[Nk]:wa;Object.assign(vB,Pz);Ce(wa)&&(wa.fallbacks=Ce(wa.fallbacks)?Object.assign(wa.fallbacks,Rz):hB,wa.environment=Ce(wa.environment)?Object.assign(wa.environment,Oz):bB,wa.results=Ce(wa.results)?Object.assign(wa.results,kz):SB,wa.resolver=Ce(wa.resolver)?Object.assign(wa.resolver,Pz):vB);if(Ce(mo)){try{mo[Gk]=wa}catch{}try{mo[Nk]=vB}catch{}try{mo[Mk]=hB}catch{}try{mo[_k]=bB}catch{}try{mo[Dk]=SB}catch{}}const vl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};vl.cineCoreAppLocalizationSupport=vl.cineCoreAppLocalizationSupport||{};vl.cineCoreAppLocalizationBootstrap=vl.cineCoreAppLocalizationBootstrap||{};vl.cineCoreAppRuntimeLocalization=vl.cineCoreAppRuntimeLocalization||{};vl.cineCoreAppLocalizationAccessors=vl.cineCoreAppLocalizationAccessors||{};const v3=vl.cineCoreAppLocalizationSupport,E3=vl.cineCoreAppLocalizationBootstrap,A3=vl.cineCoreAppRuntimeLocalization;(function(){function e(u){return!!u&&(typeof u=="object"||typeof u=="function")}function t(u){return e(u)?u:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(u){return typeof u=="function"?u:typeof require=="function"?require:null}function n(u,f,d){if(typeof u=="function")return u;const p=t(d);if(e(p)&&typeof p.resolveCoreSupportModule=="function")try{return p.resolveCoreSupportModule.bind(p)}catch{}if(e(p)&&p.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof p.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return p.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(p.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof f=="function"?function(m,g){if(typeof m!="string"||!m||typeof g!="string"||!g)return null;try{const S=f(g);return e(S)?S:null}catch{}return null}:function(){return null}}function o(u,f){return e(u)?u:t(f)}function a(u){const f=r(u&&u.requireFn),d=o(u&&u.runtimeScope),p=o(u&&u.coreGlobalScope,d),h=n(u&&u.resolveCoreSupportModule,f,d||p),m=h("cineCoreLocalizationRuntimeEnvironment","../core/localization-runtime-environment.js"),g=m&&typeof m.createLocalizationRuntimeEnvironment=="function"?m.createLocalizationRuntimeEnvironment({resolveCoreSupportModule:h,requireFn:f,runtimeScope:d,coreGlobalScope:p}):null,S=g&&e(g.coreLocalizationBridge)?g.coreLocalizationBridge:null,y=g&&e(g.coreLocalizationFallbacks)?g.coreLocalizationFallbacks:null,E=g&&e(g.coreInlineLocalizationFallbacks)?g.coreInlineLocalizationFallbacks:null,L=g&&typeof g.localizationFallbackSupport<"u"?g.localizationFallbackSupport:null,v=g&&typeof g.createBasicLocalizationFallbackResolvers=="function"?g.createBasicLocalizationFallbackResolvers:function(){return null},A=g&&e(g.localizationFallbackRegistry)?g.localizationFallbackRegistry:{createFallbackResolvers(_){return v(_)}},R=g&&e(g.localizationFallbackResolvers)?g.localizationFallbackResolvers:A&&typeof A.createFallbackResolvers=="function"?A.createFallbackResolvers({directNamespace:y,inlineNamespace:E}):v({directNamespace:y,inlineNamespace:E}),I=g&&typeof g.localizationFallbackNamespace<"u"?g.localizationFallbackNamespace:null,C=g&&typeof g.fallbackResolveLocaleModule=="function"?g.fallbackResolveLocaleModule:function(){return null},k=g&&typeof g.createLocaleFallbacks=="function"?g.createLocaleFallbacks:function(){return null};return{localizationRuntimeEnvironment:g,localizationBridge:S,localizationFallbacks:y,inlineLocalizationFallbacks:E,localizationFallbackSupport:L,createBasicLocalizationFallbackResolvers:v,localizationFallbackRegistry:A,localizationFallbackResolvers:R,localizationFallbackNamespace:I,fallbackResolveLocaleModule:C,createLocaleFallbacks:k}}const i={createAppLocalizationSupport:a},s=t(),l="cineCoreAppLocalizationSupport",c=e(s)&&e(s[l])?s[l]:{};for(const u of Object.keys(i))c[u]=i[u];if(e(s))try{s[l]=c}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=c)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return e(m)?m:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(m){return typeof m=="function"?m:typeof require=="function"?require:null}function n(m,g){return e(m)?m:t(g)}function o(m,g,S){if(typeof m=="function")return m;const y=n(S);if(y&&typeof y.resolveCoreSupportModule=="function")try{return y.resolveCoreSupportModule.bind(y)}catch{}if(y&&y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof g=="function"?function(L,v){if(typeof L!="string"||!L||typeof v!="string"||!v)return null;try{const A=g(v);return e(A)?A:null}catch{}return null}:function(){return null}}function a(m,g){e(g)&&m.indexOf(g)===-1&&m.push(g)}function i(m,g,S){const y=Array.isArray(m)?m.slice():[];return a(y,g),a(y,S),a(y,typeof globalThis<"u"?globalThis:null),a(y,typeof window<"u"?window:null),a(y,typeof self<"u"?self:null),a(y,typeof global<"u"?global:null),y}function s(m){if(m&&e(m.localizationSupportTools))return m.localizationSupportTools;const g=m&&typeof m.resolveCoreSupportModule=="function"?m.resolveCoreSupportModule:null;if(g)try{const E=g("cineCoreAppLocalizationSupport","./modules/app-core/localization-fixed.js");if(e(E))return E}catch{}const S=r(m&&m.requireFn);if(typeof S=="function")try{const E=S("./modules/app-core/localization-fixed.js");if(e(E))return E}catch{}const y=i(m&&m.fallbackScopes,m&&m.runtimeScope,m&&m.coreGlobalScope);for(let E=0;E<y.length;E+=1){const L=y[E];try{const v=L&&L.cineCoreAppLocalizationSupport;if(e(v))return v}catch{}}return null}function l(m){const g=s(m);if(g&&typeof g.createAppLocalizationSupport=="function")try{return g.createAppLocalizationSupport({resolveCoreSupportModule:m&&m.resolveCoreSupportModule,requireFn:m&&m.requireFn,runtimeScope:m&&m.runtimeScope,coreGlobalScope:m&&m.coreGlobalScope})}catch{}return null}function c(m){const g=r(m&&m.requireFn),S=n(m&&m.runtimeScope),y=n(m&&m.coreGlobalScope,S),E=o(m&&m.resolveCoreSupportModule,g,S||y),L=i(m&&m.fallbackScopes,S,y),v=l({localizationSupportTools:m&&m.localizationSupportTools,resolveCoreSupportModule:E,requireFn:g,runtimeScope:S,coreGlobalScope:y,fallbackScopes:L}),A=v&&v.localizationRuntimeEnvironment?v.localizationRuntimeEnvironment:null,R=v&&v.localizationBridge?v.localizationBridge:null,I=v&&v.localizationFallbacks?v.localizationFallbacks:null,C=v&&v.inlineLocalizationFallbacks?v.inlineLocalizationFallbacks:null,k=v&&typeof v.localizationFallbackSupport<"u"?v.localizationFallbackSupport:null,_=v&&typeof v.createBasicLocalizationFallbackResolvers=="function"?v.createBasicLocalizationFallbackResolvers:function(){return null},w=v&&v.localizationFallbackRegistry?v.localizationFallbackRegistry:{createFallbackResolvers(N){return _(N)}},x=v&&v.localizationFallbackResolvers?v.localizationFallbackResolvers:w&&typeof w.createFallbackResolvers=="function"?w.createFallbackResolvers({directNamespace:I,inlineNamespace:C}):_({directNamespace:I,inlineNamespace:C}),G=v&&typeof v.localizationFallbackNamespace<"u"?v.localizationFallbackNamespace:null,T=v&&typeof v.fallbackResolveLocaleModule=="function"?v.fallbackResolveLocaleModule:function(){return null},P=v&&typeof v.createLocaleFallbacks=="function"?v.createLocaleFallbacks:function(){return null};return{localizationSupport:v,localizationRuntimeEnvironment:A,localizationBridge:R,localizationFallbacks:I,inlineLocalizationFallbacks:C,localizationFallbackSupport:k,createBasicLocalizationFallbackResolvers:_,localizationFallbackRegistry:w,localizationFallbackResolvers:x,localizationFallbackNamespace:G,fallbackResolveLocaleModule:T,createLocaleFallbacks:P}}function u(m){const g=m&&e(m.localizationBootstrapResult)?m.localizationBootstrapResult:null,S=g&&e(g.localizationSupport)?g.localizationSupport:null,y=g&&e(g.localizationRuntimeEnvironment)?g.localizationRuntimeEnvironment:null,E=g&&e(g.localizationBridge)?g.localizationBridge:null,L=g&&e(g.localizationFallbacks)?g.localizationFallbacks:null,v=g&&e(g.inlineLocalizationFallbacks)?g.inlineLocalizationFallbacks:null,A=g&&typeof g.localizationFallbackSupport<"u"?g.localizationFallbackSupport:null,R=g&&typeof g.createBasicLocalizationFallbackResolvers=="function"?g.createBasicLocalizationFallbackResolvers:function(){return null},I=g&&e(g.localizationFallbackRegistry)?g.localizationFallbackRegistry:{createFallbackResolvers(x){return R(x)}},C=g&&e(g.localizationFallbackResolvers)?g.localizationFallbackResolvers:I&&typeof I.createFallbackResolvers=="function"?I.createFallbackResolvers({directNamespace:L,inlineNamespace:v}):R({directNamespace:L,inlineNamespace:v}),k=g&&typeof g.localizationFallbackNamespace<"u"?g.localizationFallbackNamespace:null,_=g&&typeof g.fallbackResolveLocaleModule=="function"?g.fallbackResolveLocaleModule:function(){return null},w=g&&typeof g.createLocaleFallbacks=="function"?g.createLocaleFallbacks:function(){return null};return{localizationBootstrapResult:g,localizationSupport:S,localizationRuntimeEnvironment:y,localizationBridge:E,localizationFallbacks:L,inlineLocalizationFallbacks:v,localizationFallbackSupport:A,createBasicLocalizationFallbackResolvers:R,localizationFallbackRegistry:I,localizationFallbackResolvers:C,localizationFallbackNamespace:k,fallbackResolveLocaleModule:_,createLocaleFallbacks:w}}const f={createLocalizationBootstrapResult:c,createLocalizationBootstrapWiring:u},d=t(),p="cineCoreAppLocalizationBootstrap",h=e(d)&&e(d[p])?d[p]:{};if(Object.assign(h,f),e(d))try{d[p]=h}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=h)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return typeof m=="function"?m:typeof require=="function"?require:null}function r(m,g,S){const y=[],E=typeof Set=="function"?new Set:null;function L(v){if(e(v)){if(E){if(E.has(v))return;E.add(v),y.push(v);return}y.indexOf(v)===-1&&y.push(v)}}if(L(m),L(g),Array.isArray(S))for(let v=0;v<S.length;v+=1)L(S[v]);return L(typeof globalThis<"u"?globalThis:null),L(typeof window<"u"?window:null),L(typeof self<"u"?self:null),L(typeof global<"u"?global:null),y}function n(m){const g=typeof m=="string"&&m?m:"en";return function(y){if(!y)return g;try{return String(y).trim().toLowerCase()||g}catch{}return g}}function o(m,g){const S=Array.isArray(m)&&m.length?m:["ar","fa","he","ur"];return function(E){const v=g(E).split("-")[0];return S.indexOf(v)!==-1}}function a(m,g){return function(y){if(typeof document<"u"&&document&&document.documentElement)try{const E=document.documentElement.getAttribute("dir");if(E)return E}catch{}return g(y)?"rtl":"ltr"}}function i(m,g,S){if(m){if(g)try{m.lang=g}catch{}if(S)try{m.dir=S}catch{}}}function s(m,g,S){return function(){for(let E=0;E<m.length;E+=1){const L=m[E];if(!e(L))continue;const v=L.texts;if(e(v))return v}if(typeof g=="function")try{const E=g(S);if(e(E)&&e(E.texts))return E.texts}catch{}return{}}}function l(m,g){const S=typeof g=="string"&&g?g:"en";return function(E){const L=m();let v=null;if(typeof E=="string"&&E)try{v=String(E).trim().toLowerCase()}catch{v=null}let A=v&&Object.prototype.hasOwnProperty.call(L,v)?v:"";if(!A&&v){const C=v.split("-")[0];C&&Object.prototype.hasOwnProperty.call(L,C)&&(A=C)}A||(A=S);const R=L&&A&&e(L[A])?L[A]:null;if(R)return R;if(A!==S){const C=L&&e(L[S])?L[S]:null;if(C)return C}if(L&&e(L.en))return L.en;const I=L?Object.keys(L):[];if(I.length){const C=I[0],k=L[C];if(e(k))return k}return{}}}function c(m,g){return function(y){if(m&&typeof m.ensureGlobalGetLanguageTextsAvailability=="function")try{m.ensureGlobalGetLanguageTextsAvailability();return}catch{}const E=typeof y=="function"?y:function(){return{}};for(let L=0;L<g.length;L+=1){const v=g[L];if(e(v)&&typeof v.getLanguageTexts!="function")try{v.getLanguageTexts=E}catch{}}}}function u(m){const g=e(m&&m.coreLocalizationRuntime)?m.coreLocalizationRuntime:null,S=e(m&&m.coreLocalizationBridge)?m.coreLocalizationBridge:null,y=m&&m.corePartRuntimeScope,E=m&&m.coreGlobalScope,L=m&&m.additionalLocalizationScopes,v=m&&typeof m.fallbackResolveLocaleModule=="function"?m.fallbackResolveLocaleModule:null,A=t(m&&m.requireFn),R=m&&typeof m.translationsRequirePath=="string"&&m.translationsRequirePath?m.translationsRequirePath:"./translations.js",I=r(y,E,L),C=g&&g.localeModule||(v?v(y):null),k=g&&g.defaultLanguage||(C&&typeof C.DEFAULT_LANGUAGE=="string"?C.DEFAULT_LANGUAGE:"en"),_=g&&g.rtlLanguageCodes||(C&&Array.isArray(C.RTL_LANGUAGE_CODES)&&C.RTL_LANGUAGE_CODES.length>0?C.RTL_LANGUAGE_CODES:["ar","fa","he","ur"]),w=n(k),x=g&&typeof g.normalizeLanguageCode=="function"?function(re){try{return g.normalizeLanguageCode(re)}catch{}return w(re)}:S&&typeof S.normalizeLanguageCode=="function"?function(re){try{return S.normalizeLanguageCode(re,y)}catch{}return w(re)}:w,G=o(_,x),T=g&&typeof g.isRtlLanguage=="function"?function(re){try{return g.isRtlLanguage(re)}catch{}return G(re)}:S&&typeof S.isRtlLanguage=="function"?function(re){try{return S.isRtlLanguage(re,y)}catch{}return G(re)}:G,P=a(x,T),N=g&&typeof g.resolveDocumentDirection=="function"?function(re){try{return g.resolveDocumentDirection(re)}catch{}return P(re)}:S&&typeof S.resolveDocumentDirection=="function"?function(re){try{return S.resolveDocumentDirection(re,y)}catch{}return P(re)}:P,q=g&&typeof g.applyLocaleMetadata=="function"?function(re,fe,Oe){try{return g.applyLocaleMetadata(re,fe,Oe)}catch{}return i(re,fe,Oe)}:S&&typeof S.applyLocaleMetadata=="function"?function(re,fe,Oe){try{return S.applyLocaleMetadata(re,fe,Oe,y)}catch{}return i(re,fe,Oe)}:i,Z=s(I,A,R),U=l(Z,k),K=g&&typeof g.getLanguageTexts=="function"?function(re){try{return g.getLanguageTexts(re)}catch{}return U(re)}:U,H=c(g,I);return{localeModule:e(C)?C:null,defaultLanguage:typeof k=="string"&&k?k:"en",rtlLanguageCodes:Array.isArray(_)&&_.length?_:["ar","fa","he","ur"],normalizeLanguageCode:x,isRtlLanguage:T,resolveDocumentDirection:N,applyLocaleMetadata:q,getLanguageTexts:K,ensureGlobalGetLanguageTextsAvailability:H,fallbackResolveTranslationDataset:Z}}const f={createLocalizationAccessors:u},d=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,p="cineCoreAppLocalizationAccessors",h=e(d)&&e(d[p])?d[p]:{};if(Object.assign(h,f),e(d))try{d[p]=h}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=h)})();(function(){function e(h){return!!h&&(typeof h=="object"||typeof h=="function")}function t(h){return e(h)?h:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(h,m){return e(h)?h:t(m)}function n(h){return typeof h=="function"?h:typeof require=="function"?require:null}function o(h,m,g){if(typeof h=="function")return h;const S=t(g);if(S&&typeof S.resolveCoreSupportModule=="function")try{return S.resolveCoreSupportModule.bind(S)}catch{}if(S&&S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(S.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof m=="function"?function(E,L){if(typeof E!="string"||!E||typeof L!="string"||!L)return null;try{const v=m(L);return e(v)?v:null}catch{}return null}:function(){return null}}function a(h,m){const g=[];e(h)&&g.indexOf(h)===-1&&g.push(h),e(m)&&g.indexOf(m)===-1&&g.push(m);const S=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let y=0;y<S.length;y+=1){const E=S[y];e(E)&&g.indexOf(E)===-1&&g.push(E)}return g}function i(h){const m=h&&h.resolveCoreSupportModule,g=h&&h.requireFn,S=h&&h.runtimeScope,y=h&&h.coreGlobalScope;let E=null;if(typeof m=="function")try{E=m("cineCoreAppLocalizationSupport","../app-core/localization-fixed.js")}catch{E=null}if(!e(E)&&typeof g=="function")try{const v=g("../app-core/localization-fixed.js");e(v)&&(E=v)}catch{}if(e(E))return E;const L=a(S,y);for(let v=0;v<L.length;v+=1){const A=L[v];try{const R=A&&A.cineCoreAppLocalizationSupport;if(e(R))return R}catch{}}return null}function s(){function h(){return null}const m={createFallbackResolvers(y){return h()}};function g(){return null}function S(){return null}return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers:h,localizationFallbackRegistry:m,localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule:g,createLocaleFallbacks:S}}function l(h,m){if(e(h)&&typeof h.createAppLocalizationSupport=="function")try{return h.createAppLocalizationSupport(m)}catch{}return null}function c(h){const m=n(h&&h.requireFn),g=r(h&&h.runtimeScope),S=r(h&&h.coreGlobalScope,g),y=o(h&&h.resolveCoreSupportModule,m,g||S),E=i({resolveCoreSupportModule:y,requireFn:m,runtimeScope:g,coreGlobalScope:S}),L=l(E,{resolveCoreSupportModule:y,requireFn:m,runtimeScope:g,coreGlobalScope:S});return e(L)?L:s()}const u={createLocalizationRuntimeBridge:c},f="cineCoreAppLocalizationRuntimeBridge",d=t(),p=e(d)&&e(d[f])?d[f]:{};for(const h of Object.keys(u))p[h]=u[h];if(e(d))try{d[f]=p}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=p)})();(function(){function e(m){return!!m&&(typeof m=="object"||typeof m=="function")}function t(m){return e(m)?m:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(m,g){return e(m)?m:t(g)}function n(m){return typeof m=="function"?m:typeof require=="function"?require:null}function o(m,g,S){if(typeof m=="function")return m;const y=t(S);if(y&&typeof y.resolveCoreSupportModule=="function")try{return y.resolveCoreSupportModule.bind(y)}catch{}if(y&&y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(y.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof g=="function"?function(L,v){if(typeof L!="string"||!L||typeof v!="string"||!v)return null;try{const A=g(v);return e(A)?A:null}catch{}return null}:function(){return null}}function a(m,g){const S=[];e(m)&&S.indexOf(m)===-1&&S.push(m),e(g)&&S.indexOf(g)===-1&&S.push(g);const y=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let E=0;E<y.length;E+=1){const L=y[E];e(L)&&S.indexOf(L)===-1&&S.push(L)}return S}function i(m){const g=m&&m.resolveCoreSupportModule,S=m&&m.requireFn,y=m&&m.runtimeScope,E=m&&m.coreGlobalScope;let L=null;if(typeof g=="function")try{L=g("cineCoreAppLocalizationRuntimeBridge","./modules/app-core/localization-fixed.js")}catch{L=null}if(!e(L)&&typeof S=="function")try{const A=S("./modules/app-core/localization-fixed.js");e(A)&&(L=A)}catch{}if(e(L))return L;const v=a(y,E);for(let A=0;A<v.length;A+=1){const R=v[A];try{const I=R&&R.cineCoreAppLocalizationRuntimeBridge;if(e(I))return I}catch{}}return null}function s(){function m(){return null}const g={createFallbackResolvers(E){return m()}};function S(){return null}function y(){return null}return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers:m,localizationFallbackRegistry:g,localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule:S,createLocaleFallbacks:y}}function l(m){const g=m&&m.requireFn,S=m&&m.runtimeScope,y=m&&m.coreGlobalScope,E=i(m);if(e(E)&&typeof E.createLocalizationRuntimeBridge=="function")return E.createLocalizationRuntimeBridge;if(typeof g=="function")try{const v=g("./modules/app-core/localization-fixed.js");if(e(v)&&typeof v.createLocalizationRuntimeBridge=="function")return v.createLocalizationRuntimeBridge}catch{}const L=a(S,y);for(let v=0;v<L.length;v+=1){const A=L[v];try{const R=A&&A.cineCoreAppLocalizationRuntimeBridge;if(e(R)&&typeof R.createLocalizationRuntimeBridge=="function")return R.createLocalizationRuntimeBridge}catch{}}return function(){return s()}}function c(m){const g=e(m)?m:s(),S=e(g.localizationRuntimeEnvironment)?g.localizationRuntimeEnvironment:null,y=e(g.localizationBridge)?g.localizationBridge:null,E=e(g.localizationFallbacks)?g.localizationFallbacks:null,L=e(g.inlineLocalizationFallbacks)?g.inlineLocalizationFallbacks:null,v=typeof g.localizationFallbackSupport<"u"?g.localizationFallbackSupport:null,A=typeof g.createBasicLocalizationFallbackResolvers=="function"?g.createBasicLocalizationFallbackResolvers:function(){return null},R=e(g.localizationFallbackRegistry)?g.localizationFallbackRegistry:{createFallbackResolvers(w){return A(w)}},I=typeof g.fallbackResolveLocaleModule=="function"?g.fallbackResolveLocaleModule:function(){return null},C=typeof g.createLocaleFallbacks=="function"?g.createLocaleFallbacks:function(){return null},k=typeof g.localizationFallbackNamespace<"u"?g.localizationFallbackNamespace:null,_=g.localizationFallbackResolvers?g.localizationFallbackResolvers:R&&typeof R.createFallbackResolvers=="function"?R.createFallbackResolvers({directNamespace:E,inlineNamespace:L}):A({directNamespace:E,inlineNamespace:L});return{localizationRuntimeEnvironment:S,localizationBridge:y,localizationFallbacks:E,inlineLocalizationFallbacks:L,localizationFallbackSupport:v,createBasicLocalizationFallbackResolvers:A,localizationFallbackRegistry:R,localizationFallbackResolvers:_,localizationFallbackNamespace:k,fallbackResolveLocaleModule:I,createLocaleFallbacks:C}}function u(m){const g=n(m&&m.requireFn),S=r(m&&m.runtimeScope),y=r(m&&m.coreGlobalScope,S),E=o(m&&m.resolveCoreSupportModule,g,S||y),v=l({resolveCoreSupportModule:E,requireFn:g,runtimeScope:S,coreGlobalScope:y})({resolveCoreSupportModule:E,requireFn:g,runtimeScope:S,coreGlobalScope:y});return c(v)}const f={createLocalizationRuntimeSetup:u},d="cineCoreAppLocalizationRuntimeSetup",p=t(),h=e(p)&&e(p[d])?p[d]:{};for(const m of Object.keys(f))h[m]=f[m];if(e(p))try{p[d]=h}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=h)})();(function(){function e(g){return!!g&&(typeof g=="object"||typeof g=="function")}function t(g){return e(g)?g:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(g,S){return e(g)?g:t(S)}function n(g){return typeof g=="function"?g:typeof require=="function"?require:null}function o(g,S,y){if(typeof g=="function")return g;const E=r(y);if(E&&typeof E.resolveCoreSupportModule=="function")try{return E.resolveCoreSupportModule.bind(E)}catch{}if(E&&E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof S=="function"?function(v,A){if(typeof v!="string"||!v||typeof A!="string"||!A)return null;try{const R=S(A);return e(R)?R:null}catch{}return null}:null}function a(g,S){e(S)&&g.indexOf(S)===-1&&g.push(S)}function i(g,S){const y=[];return a(y,g),a(y,S),a(y,typeof globalThis<"u"?globalThis:null),a(y,typeof window<"u"?window:null),a(y,typeof self<"u"?self:null),a(y,typeof global<"u"?global:null),y}function s(){return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function l(g){let S=!1,y=null;return function(){if(S||(S=!0,typeof g!="function"))return y;try{const L=g("./modules/app-core/localization-fixed.js");e(L)&&(y=L)}catch{}return y}}function c(g,S,y){let E=null;if(typeof g=="function")try{E=g("cineCoreAppRuntimeLocalization","./modules/app-core/localization-fixed.js")}catch{E=null}if(e(E)||(E=y()),e(E))return E;for(let L=0;L<S.length;L+=1){const v=S[L];try{const A=v&&v.cineCoreAppRuntimeLocalization;if(e(A))return A}catch{}}return null}function u(g,S,y,E){if(e(S)&&typeof S[g]=="function")return S[g];const L=E();if(e(L)&&typeof L[g]=="function")return L[g];for(let v=0;v<y.length;v+=1){const A=y[v];try{const R=A&&A.cineCoreAppRuntimeLocalization;if(e(R)&&typeof R[g]=="function")return R[g]}catch{}}return null}function f(g){const S=n(g&&g.requireFn),y=r(g&&g.runtimeScope),E=r(g&&g.coreGlobalScope,y),L=o(g&&g.resolveCoreSupportModule,S,y||E),v=i(y,E),A=l(S),R=c(L,v,A),I=u("resolveRuntimeLocalization",R,v,A),C=u("createFallbackLocalizationRuntimeSetup",R,v,A)||s;return(typeof I=="function"?I({resolveCoreSupportModule:L,requireFn:S,runtimeScope:y,coreGlobalScope:E}):null)||(typeof C=="function"?C():s())||s()}const d={resolveLocalizationRuntimeSetup:f,createInlineFallbackLocalizationRuntimeSetup:s},p=t(),h="cineCoreAppRuntimeLocalizationResolver",m=e(p)&&e(p[h])?p[h]:{};if(Object.assign(m,d),e(p))try{p[h]=m}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=m)})();(function(){function e(g){return!!g&&(typeof g=="object"||typeof g=="function")}function t(g){return e(g)?g:typeof globalThis<"u"&&e(globalThis)?globalThis:typeof window<"u"&&e(window)?window:typeof self<"u"&&e(self)?self:typeof global<"u"&&e(global)?global:null}function r(g,S){return e(g)?g:t(S)}function n(g){return typeof g=="function"?g:typeof require=="function"?require:null}function o(g,S,y){if(typeof g=="function")return g;const E=t(y);if(E&&typeof E.resolveCoreSupportModule=="function")try{return E.resolveCoreSupportModule.bind(E)}catch{}if(E&&E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS&&typeof E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule=="function")try{return E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(E.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS)}catch{}return typeof S=="function"?function(v,A){if(typeof v!="string"||!v||typeof A!="string"||!A)return null;try{const R=S(A);return e(R)?R:null}catch{}return null}:function(){return null}}function a(g,S){e(S)&&g.indexOf(S)===-1&&g.push(S)}function i(g,S){const y=[];return a(y,g),a(y,S),a(y,typeof globalThis<"u"?globalThis:null),a(y,typeof window<"u"?window:null),a(y,typeof self<"u"?self:null),a(y,typeof global<"u"?global:null),y}function s(){return{localizationRuntimeEnvironment:null,localizationBridge:null,localizationFallbacks:null,inlineLocalizationFallbacks:null,localizationFallbackSupport:null,createBasicLocalizationFallbackResolvers(){return null},localizationFallbackRegistry:{createFallbackResolvers(){return null}},localizationFallbackResolvers:null,localizationFallbackNamespace:null,fallbackResolveLocaleModule(){return null},createLocaleFallbacks(){return null}}}function l(g){const S=g&&g.resolveCoreSupportModule,y=g&&g.requireFn,E=g&&g.runtimeScope,L=g&&g.coreGlobalScope;let v=null;if(typeof S=="function")try{v=S("cineCoreAppLocalizationRuntimeSetup","./modules/app-core/localization-fixed.js")}catch{v=null}if(!e(v)&&typeof y=="function")try{const A=y("./modules/app-core/localization-fixed.js");e(A)&&(v=A)}catch{}if(!e(v)){const A=i(E,L);for(let R=0;R<A.length;R+=1){const I=A[R];if(e(I))try{const C=I.cineCoreAppLocalizationRuntimeSetup;if(e(C)){v=C;break}}catch{}}}return e(v)&&typeof v.createLocalizationRuntimeSetup=="function"?v.createLocalizationRuntimeSetup:null}function c(g,S){return typeof g=="function"?g:S}function u(g){const S=s(),y=e(g)?g:{},E=e(y.localizationRuntimeEnvironment)?y.localizationRuntimeEnvironment:S.localizationRuntimeEnvironment,L=e(y.localizationBridge)?y.localizationBridge:S.localizationBridge,v=e(y.localizationFallbacks)?y.localizationFallbacks:S.localizationFallbacks,A=e(y.inlineLocalizationFallbacks)?y.inlineLocalizationFallbacks:S.inlineLocalizationFallbacks,R=Object.prototype.hasOwnProperty.call(y,"localizationFallbackSupport")?y.localizationFallbackSupport:S.localizationFallbackSupport,I=c(y.createBasicLocalizationFallbackResolvers,S.createBasicLocalizationFallbackResolvers),C=e(y.localizationFallbackRegistry)?y.localizationFallbackRegistry:{createFallbackResolvers(G){return I(G)}};let k=y.localizationFallbackResolvers;if(!k&&C){const G=c(C.createFallbackResolvers,null);if(G)try{k=G({directNamespace:v,inlineNamespace:A})}catch{k=null}}if(!k&&typeof I=="function")try{k=I({directNamespace:v,inlineNamespace:A})}catch{k=null}k||(k=S.localizationFallbackResolvers);const _=Object.prototype.hasOwnProperty.call(y,"localizationFallbackNamespace")?y.localizationFallbackNamespace:S.localizationFallbackNamespace,w=c(y.fallbackResolveLocaleModule,S.fallbackResolveLocaleModule),x=c(y.createLocaleFallbacks,S.createLocaleFallbacks);return{localizationRuntimeEnvironment:E,localizationBridge:L,localizationFallbacks:v,inlineLocalizationFallbacks:A,localizationFallbackSupport:R,createBasicLocalizationFallbackResolvers:I,localizationFallbackRegistry:C,localizationFallbackResolvers:k,localizationFallbackNamespace:_,fallbackResolveLocaleModule:w,createLocaleFallbacks:x}}function f(g){const S=g&&g.currentLocalization;if(e(S))return u(S);const y=n(g&&g.requireFn),E=r(g&&g.runtimeScope),L=r(g&&g.coreGlobalScope,E),v=o(g&&g.resolveCoreSupportModule,y,E||L),A=l({resolveCoreSupportModule:v,requireFn:y,runtimeScope:E,coreGlobalScope:L});if(typeof A=="function")try{const R=A({resolveCoreSupportModule:v,requireFn:y,runtimeScope:E,coreGlobalScope:L});return u(R)}catch{}return s()}const d={resolveRuntimeLocalization:f,createFallbackLocalizationRuntimeSetup:s},p="cineCoreAppRuntimeLocalization",h=t(),m=e(h)&&e(h[p])?h[p]:{};for(const g of Object.keys(d))m[g]=d[g];if(e(h))try{h[p]=m}catch{}typeof module=="object"&&module&&module.exports&&(module.exports=m)})();const My=wz,C3=A3,w3=v3,VE=E3,Bz=Iz,Gz=Lz,Mz=Tz,_z=xz;function Dz(){return typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE?CORE_PART1_RUNTIME_SCOPE:null}function Nz(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null}const wi=My&&typeof My.createBootstrapSuite=="function"?My.createBootstrapSuite({directResolverNamespace:Bz,directBootstrapNamespace:My,directBootstrapFallbackNamespace:Gz,directBootstrapEnvironmentNamespace:Mz,directBootstrapResultsNamespace:_z,resolveCoreSupportModule:ac,requireFn:typeof require=="function"?require:null,runtimeScope:Dz(),coreGlobalScope:Nz()}):null;wi&&wi.bootstrapEnvironmentTools;wi&&wi.bootstrapResultsTools;const JA=wi&&wi.bootstrapEnvironment||null;wi&&wi.bootstrapEnvironment&&wi.bootstrapEnvironment.bootstrapResolverTools||JA&&JA.bootstrapResolverTools;const L3=wi&&wi.bootstrapFallbackTools||JA&&JA.bootstrapFallbackTools||Gz||null,R3=(function(){if(wi&&typeof wi.createLocalizationBootstrapResult=="function"){const t={bootstrapTools:My,bootstrapFallbackTools:L3,localizationSupportTools:w3,localizationBootstrapTools:VE,localizationRuntimeTools:C3,resolveCoreSupportModule:ac,requireFn:typeof require=="function"?require:null,runtimeScope:Dz(),coreGlobalScope:Nz(),fallbackScopes:[]};return wi.createLocalizationBootstrapResult(t)}return null})(),GS=VE&&typeof VE.createLocalizationBootstrapWiring=="function"&&VE.createLocalizationBootstrapWiring({localizationBootstrapResult:R3})||null;typeof globalThis<"u"?globalThis.localizationBootstrapWiring=GS:typeof window<"u"?window.localizationBootstrapWiring=GS:typeof self<"u"?self.localizationBootstrapWiring=GS:typeof global<"u"&&(global.localizationBootstrapWiring=GS);const ZA=Z5(),sc=Rn,T3=typeof sc.getModuleRegistry=="function"?sc.getModuleRegistry(ZA):null,Fz=typeof sc.freezeDeep=="function"?function(t){try{return sc.freezeDeep(t)}catch{}return t}:function(t){return t},O3=typeof sc.exposeGlobal=="function"?function(t,r,n){return sc.exposeGlobal(t,r,ZA,n||{})}:function(t,r){try{return ZA[t]=r,!0}catch{}return!1},x3=typeof sc.registerOrQueueModule=="function"?function(t,r,n,o){return sc.registerOrQueueModule(t,r,n,o,ZA,T3)}:function(){return!1},k3=typeof sc.safeWarn=="function"?function(t,r){try{sc.safeWarn(t,r)}catch{}}:function(t,r){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof r>"u"?console.warn(t):console.warn(t,r)}catch{}},Fk="en",jz=["ar","fa","he","ur"];function Hz(e){if(!e)return Fk;try{return String(e).trim().toLowerCase()}catch{}return Fk}function Uz(e){const r=Hz(e).split("-")[0];return jz.indexOf(r)!==-1}function I3(e,t){const r=t||(typeof document<"u"?document:null);if(r&&r.documentElement)try{const n=r.documentElement.getAttribute("dir");if(n==="rtl"||n==="ltr")return n}catch{}return Uz(e)?"rtl":"ltr"}function P3(e,t,r){if(e){if(t)try{e.lang=t}catch{}if(r)try{e.dir=r}catch{}}}const EB={DEFAULT_LANGUAGE:Fk,RTL_LANGUAGE_CODES:Fz([].concat(jz)),normalizeLanguageCode:Hz,isRtlLanguage:Uz,resolveDocumentDirection:I3,applyLocaleMetadata:P3};Fz(EB);x3("cineLocale",EB,{category:"localisation",description:"Language helpers shared between the runtime core and UI modules.",replace:!0},function(e){k3("Unable to register cineLocale module.",e)});O3("cineLocale",EB,{configurable:!0,enumerable:!1,writable:!1});function zz(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const $z=zz();function B3(e){const t=e||$z;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}const ti=B3($z),G3=ti&&typeof ti.detectGlobalScope=="function"?ti.detectGlobalScope:zz,Dc=G3();function M3(e){const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}const Vz=ti&&typeof ti.collectCandidateScopes=="function"?function(e){return ti.collectCandidateScopes(e||Dc)}:function(e){return M3(e||Dc)},_3=ti&&typeof ti.tryRequire=="function"?ti.tryRequire:function(e){return null};let q_,K_=!1;function D3(){if(Rn&&typeof Rn=="object")return Rn;const e=Vz(Dc);if(ti&&typeof ti.resolveFromScopes=="function"){const t=ti.resolveFromScopes("cineModuleBase",{scopes:e});if(t&&typeof t=="object")return t}for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r.cineModuleBase=="object")return r.cineModuleBase}return null}function Cl(){return K_||(q_=D3(),K_=!0),q_}let MS,W_=!1;function Qa(){if(!W_){const e=Cl();if(e&&typeof e.getGlobalScope=="function")try{MS=e.getGlobalScope()||Dc}catch{MS=Dc}else MS=Dc;W_=!0}return MS}function AB(e){const t=Cl();if(t&&typeof t.collectCandidateScopes=="function")try{const r=t.collectCandidateScopes(e||Qa());if(Array.isArray(r))return r}catch{}return Vz(e||Qa())}function qz(){const e=Cl();return e&&typeof e.tryRequire=="function"?e.tryRequire:_3}function jk(e){const t=Cl(),r=e||Qa();if(t&&typeof t.resolveModuleRegistry=="function")try{return t.resolveModuleRegistry(r)}catch{}if(ei&&typeof ei=="object")return ei;const n=AB(r);if(ti&&typeof ti.resolveFromScopes=="function"){const o=ti.resolveFromScopes("cineModules",{scopes:n});if(o&&typeof o=="object")return o}for(let o=0;o<n.length;o+=1){const a=n[o];if(a&&typeof a.cineModules=="object")return a.cineModules}return null}let Y_,Q_=!1;function wL(e){return e&&e!==Qa()?jk(e):(Q_||(Y_=jk(Qa()),Q_=!0),Y_)}function CB(){const e=Cl();return e&&typeof e.PENDING_QUEUE_KEY=="string"?e.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"}function N3(e){if(!e||typeof e!="object")return null;const t=CB();let r=e[t];if(Array.isArray(r))return r;try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t]}catch{try{Array.isArray(e[t])||(e[t]=[]),r=e[t]}catch{return null}}return r}function wB(e,t,r,n){const o=Cl(),a=e||Qa();if(o&&typeof o.queueModuleRegistration=="function")try{return o.queueModuleRegistration(t,r,n,a)}catch{}const i=N3(a);if(!i)return!1;const s=Object.freeze({name:t,api:r,options:Object.freeze({...n||{}})});try{i.push(s)}catch{i[i.length]=s}return!0}function LB(e,t,r,n,o,a){const i=Cl(),s=e||Qa(),l=t||wL(s);if(i&&typeof i.registerOrQueueModule=="function")try{return i.registerOrQueueModule(r,n,o,a,s,l)}catch{}if(l&&typeof l.register=="function")try{return l.register(r,n,o),!0}catch(c){typeof a=="function"&&a(c)}return wB(s,r,n,o),!1}function Hk(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(F3(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{let t=null;try{typeof console<"u"&&console&&(t=console)}catch(r){}if(t){if(e===t)return!0;try{if(e.__cameraPowerPlannerOriginal&&e.__cameraPowerPlannerOriginal===t)return!0}catch(r){}}try{if(typeof e.log=="function"&&typeof e.warn=="function"&&typeof e.error=="function"){const r=e.constructor&&e.constructor.name;if(r&&/Console/i.test(r))return!0;if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const n=e[Symbol.toStringTag];if(typeof n=="string"&&/Console/i.test(n))return!0}}}catch(r){}}catch{return!1}return!1}function Uk(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;try{if(typeof e.require=="function"&&typeof e.loaded=="boolean"&&((Array.isArray?Array.isArray(e.children):Object.prototype.toString.call(e.children)==="[object Array]")||typeof e.paths<"u"))return!0}catch{}return!1}function zk(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(Dc&&typeof Dc=="object")try{if(e===Dc.ethereum)return!0}catch{return!0}try{if(e.isMetaMask===!0)return!0}catch(t){if(t&&typeof t.message=="string"&&/metamask/i.test(t.message))return!0}try{if(typeof e.request=="function"&&typeof e.on=="function"){if(typeof e.removeListener=="function"||typeof e.removeEventListener=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Ethereum|MetaMask|Provider/i.test(t))return!0}}catch{return!0}return!1}function F3(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function $k(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const t=e[Symbol.toStringTag];if(typeof t=="string"&&/Stream|Port/i.test(t))return!0}}catch{}return!1}function j3(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function Kz(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||$k(e)||zk(e)||Hk(e)||Uk(e))return e;const r=j3(t);if(r.has(e))return e;r.add(e);const n=Object.getOwnPropertyNames(e);for(let o=0;o<n.length;o+=1){const a=n[o];let i;try{i=Object.getOwnPropertyDescriptor(e,a)}catch{i=null}if(i&&(typeof i.get=="function"||typeof i.set=="function"))continue;let s;try{s=e[a]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||$k(s)||zk(s)||Hk(s)||Uk(s)||Kz(s,r)}try{return Object.freeze(e)}catch{return e}}function eC(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||$k(e)||zk(e)||Hk(e)||Uk(e))return e;const r=Cl();return(r&&typeof r.freezeDeep=="function"?r.freezeDeep:Kz)(e,t)}function H3(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function RB(e,t){const r=Cl();(r&&typeof r.safeWarn=="function"?r.safeWarn:H3)(e,t)}function U3(e,t,r,n={}){if(!r||typeof r!="object")return!1;const o={configurable:n.configurable!==!1,enumerable:!!n.enumerable,value:t,writable:n.writable===!0};try{return Object.defineProperty(r,e,o),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function TB(e,t,r,n){const o=r||Qa(),a=Cl();return a&&typeof a.exposeGlobal=="function"?a.exposeGlobal(e,t,o,n):U3(e,t,o,n)}function z3(e={}){const t=e&&typeof e.scope=="object"?e.scope:Qa(),r=e&&e.registry?e.registry:wL(t),n={tryRequire(o){return qz()(o)},queueModuleRegistration(o,a,i){return wB(t,o,a,i)},registerOrQueueModule(o,a,i,s){return LB(t,r,o,a,i,s)},freezeDeep:eC,safeWarn:RB,exposeGlobal(o,a,i){return TB(o,a,t,i)},collectCandidateScopes(){return Object.freeze(AB(t).slice())},PENDING_QUEUE_KEY:CB()};return Object.defineProperties(n,{scope:{configurable:!1,enumerable:!0,get(){return t}},registry:{configurable:!1,enumerable:!0,get(){return r}}}),eC(n)}const OB=eC({getModuleBase:Cl,getGlobalScope:Qa,getModuleRegistry:wL,resolveModuleRegistry:jk,collectCandidateScopes:AB,tryRequire(e){return qz()(e)},queueModuleRegistration(e,t,r,n){return wB(n||Qa(),e,t,r)},registerOrQueueModule(e,t,r,n,o,a){return LB(o||Qa(),a,e,t,r,n)},freezeDeep:eC,safeWarn:RB,exposeGlobal(e,t,r,n){return TB(e,t,r||Qa(),n)},PENDING_QUEUE_KEY:CB(),createScopedEnvironment:z3});LB(Qa(),wL(),"cineModuleEnvironment",OB,{category:"infrastructure",description:"Shared environment bootstrap that harmonizes module communication across bundles.",replace:!0,connections:["cineModuleBase","cineModuleGlobals","cineEnvironmentBridge"]},e=>{RB("Unable to register cineModuleEnvironment.",e)});TB("cineModuleEnvironment",OB,Qa(),{configurable:!0,enumerable:!1,writable:!1});const fm=OB;var X_={};function $3(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}var ju=$3();function tC(e){var t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function Wz(e){return null}function V3(e){if(fm&&typeof fm=="object")return fm;for(var t=tC(e||ju),r=0;r<t.length;r+=1){var n=t[r];if(n&&typeof n.cineModuleEnvironment=="object")return n.cineModuleEnvironment}return null}function q3(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function K3(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(q3(e)||Yz(e))return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;var t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){var r=e[Symbol.toStringTag];if(typeof r=="string"&&/Stream|Port/i.test(r))return!0}}catch{}return!1}function Yz(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(ju&&typeof ju=="object")try{if(e===ju.ethereum)return!0}catch{return!0}try{if(e.isMetaMask===!0)return!0}catch(r){if(r&&typeof r.message=="string"&&/metamask/i.test(r.message))return!0}try{if(typeof e.request=="function"&&typeof e.on=="function"){if(typeof e.removeListener=="function"||typeof e.removeEventListener=="function")return!0;var t=e.constructor&&e.constructor.name;if(t&&/Ethereum|MetaMask|Provider/i.test(t))return!0}}catch{return!0}return!1}function Qz(e,t){var r=t;if(!r)if(typeof WeakSet=="function")r=new WeakSet;else{var n=[];r={add:function(a){n.push(a)},has:function(a){return n.indexOf(a)!==-1}}}if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||K3(e))return e;if(typeof process<"u"&&process&&X_&&X_.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}if(Yz(e)||typeof r.has=="function"&&r.has(e))return e;typeof r.add=="function"&&r.add(e);try{Object.freeze(e)}catch{}return e}function Xz(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function Jz(e,t,r,n){if(!r||typeof r!="object")return!1;var o={configurable:!n||n.configurable!==!1,enumerable:!!(n&&n.enumerable),value:t,writable:!!(n&&n.writable===!0)};try{return Object.defineProperty(r,e,o),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function W3(e,t){if(!e||typeof e!="object")return null;var r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r))return r;try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t]}catch{try{Array.isArray(e[t])||(e[t]=[]),r=e[t]}catch{return null}}return r}function Y3(e){if(!e||typeof e!="object")return{};var t={},r=[];try{r=Object.keys(e)}catch{r=[]}for(var n=0;n<r.length;n+=1){var o=r[n];try{t[o]=e[o]}catch{}}return t}function xB(e){var t=e||ju,r="__cinePendingModuleRegistrations__",n=null,o=!1;function a(u){if(ei&&typeof ei=="object")return ei;for(var f=tC(u),d=0;d<f.length;d+=1){var p=f[d];if(p&&typeof p.cineModules=="object")return p.cineModules}return null}function i(){return o||(n=a(t),o=!0),n}function s(u,f,d){var p=W3(t,r);if(!p)return!1;var h=Object.freeze(Y3(d)),m=Object.freeze({name:u,api:f,options:h});try{p.push(m)}catch{p[p.length]=m}return!0}function l(u,f,d,p){var h=i();if(h&&typeof h.register=="function")try{return h.register(u,f,d||{}),!0}catch(m){if(typeof p=="function")try{p(m)}catch{}}return s(u,f,d)}function c(){var u=tC(t);return u.slice()}return{scope:t,registry:i(),tryRequire:function(f){return Wz()},queueModuleRegistration:function(f,d,p){return s(f,d,p)},registerOrQueueModule:function(f,d,p,h){return l(f,d,p,h)},freezeDeep:function(f,d){return Qz(f,d)},safeWarn:function(f,d){Xz(f,d)},exposeGlobal:function(f,d,p){return Jz(f,d,t,p||{})},collectCandidateScopes:function(){return Object.freeze(c())},PENDING_QUEUE_KEY:r}}function kB(e){var t=e||ju,r=V3(t);if(r&&typeof r.createScopedEnvironment=="function")try{var n=r.createScopedEnvironment({scope:t});if(n&&typeof n=="object")return{scope:n.scope||t,moduleEnv:r,environment:n}}catch{}var o=xB(t);return{scope:o.scope||t,moduleEnv:r||null,environment:o}}var ch=null;function LL(){return ch||(ch=kB(ju)),ch}function Q3(e){var t=e&&e.scope?e.scope:ju;return ch=kB(t),ch}function Wc(e,t){try{return e()}catch{return t}}function Nc(){return LL().scope}function lf(){return LL().environment}function RL(){return LL().moduleEnv}function Zz(e){if(e&&e!==Nc()){var t=RL();if(t&&typeof t.getModuleRegistry=="function")return Wc(function(){return t.getModuleRegistry(e)},null);var r=kB(e);return r.environment&&r.environment.registry?r.environment.registry:null}var n=LL();if(n.environment&&n.environment.registry)return n.environment.registry;var o=n.moduleEnv;return o&&typeof o.getModuleRegistry=="function"?Wc(function(){return o.getModuleRegistry(n.scope)},null):null}function X3(e){var t=lf();if(t&&typeof t.tryRequire=="function"){var r=Wc(function(){return t.tryRequire(e)},void 0);if(typeof r<"u")return r}var n=RL();if(n&&typeof n.tryRequire=="function"){var o=Wc(function(){return n.tryRequire(e)},void 0);if(typeof o<"u")return o}return Wz()}function e$(e,t,r){var n=lf();if(n&&typeof n.queueModuleRegistration=="function")return Wc(function(){return n.queueModuleRegistration(e,t,r)},!1);var o=xB(Nc());return o.queueModuleRegistration(e,t,r)}function J3(e,t,r,n,o){var a=lf();if(a&&typeof a.registerOrQueueModule=="function")return Wc(function(){return a.registerOrQueueModule(e,t,r,n)},!1);var i=o||Nc(),s=xB(i);return s.registerOrQueueModule(e,t,r,n)}function Z3(e,t){return Qz(e,t)}function t$(e,t){var r=lf();if(r&&typeof r.safeWarn=="function"){Wc(function(){r.safeWarn(e,t)},void 0);return}Xz(e,t)}function J_(e,t,r,n){var o=lf();return o&&typeof o.exposeGlobal=="function"?Wc(function(){return o.exposeGlobal(e,t,n)},!1):Jz(e,t,r||Nc(),n||{})}function e4(e){var t=lf();if(t&&typeof t.collectCandidateScopes=="function"){var r=Wc(function(){return t.collectCandidateScopes(e)},[]);if(Array.isArray(r))return r.slice()}return tC(e||Nc())}function t4(){var e=lf();if(e&&typeof e.PENDING_QUEUE_KEY=="string")return e.PENDING_QUEUE_KEY;var t=RL();return t&&typeof t.PENDING_QUEUE_KEY=="string"?t.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"}var Zh=Object.freeze({getGlobalScope:Nc,getEnvironment:lf,getModuleEnvironment:RL,getModuleRegistry:Zz,tryRequire:X3,queueModuleRegistration:e$,registerOrQueueModule:J3,freezeDeep:Z3,safeWarn:t$,exposeGlobal:function(t,r,n){return J_(t,r,Nc(),n||{})},exposeGlobalScoped:function(t,r,n,o){return J_(t,r,n||Nc(),o||{})},collectCandidateScopes:function(t){return Object.freeze(e4(t))},getPendingQueueKey:t4,refresh:function(t){return Object.freeze(Q3(t||{}))}}),_S=Nc();if(_S&&typeof _S=="object")try{Object.defineProperty(_S,"cineEnvironmentBridge",{configurable:!0,enumerable:!1,writable:!1,value:Zh})}catch{try{_S.cineEnvironmentBridge=Zh}catch{}}var jR=Zz();if(jR&&typeof jR.register=="function")try{jR.register("cineEnvironmentBridge",Zh,{category:"infrastructure",description:"Provides consistent global environment access between Cine modules.",replace:!0,connections:["cineModuleEnvironment","cineModuleGlobals"]})}catch(e){t$("Unable to register cineEnvironmentBridge.",e)}else e$("cineEnvironmentBridge",Zh,{category:"infrastructure",description:"Provides consistent global environment access between Cine modules.",replace:!0,connections:["cineModuleEnvironment","cineModuleGlobals"]});const HR=Zh;var Z_={};function r4(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}var IB=r4();function TL(e){var t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function eD(e){return null}function PB(e){for(var t=TL(IB),r=0;r<t.length;r+=1){var n=t[r];if(n&&typeof n[e]=="object")return n[e]}return null}var rn=(function(){return Rn&&typeof Rn=="object"?Rn:PB("cineModuleBase")})(),nn=(function(){return fm&&typeof fm=="object"?fm:PB("cineModuleEnvironment")})(),Yr=(function(){return HR&&typeof HR=="object"?HR:PB("cineEnvironmentBridge")})(),go=(Yr&&typeof Yr.getGlobalScope=="function"?Yr.getGlobalScope():null)||(nn&&typeof nn.getGlobalScope=="function"?nn.getGlobalScope():null)||(rn&&typeof rn.getGlobalScope=="function"?rn.getGlobalScope():null)||IB,wf=(function(){if(Yr&&typeof Yr.getPendingQueueKey=="function")try{var t=Yr.getPendingQueueKey();if(typeof t=="string"&&t)return t}catch{}return nn&&typeof nn.PENDING_QUEUE_KEY=="string"&&nn.PENDING_QUEUE_KEY?nn.PENDING_QUEUE_KEY:rn&&typeof rn.PENDING_QUEUE_KEY=="string"&&rn.PENDING_QUEUE_KEY?rn.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function r$(e){var t=e||go;if(!t||typeof t!="object")return null;var r=null;try{r=t[wf]}catch{r=null}if(Array.isArray(r))return r;try{Object.defineProperty(t,wf,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=t[wf]}catch{try{Array.isArray(t[wf])||(t[wf]=[]),r=t[wf]}catch{return null}}return r}function n4(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function o4(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(n4(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;var t="";try{t=e.constructor&&e.constructor.name}catch(n){}if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){var r=e[Symbol.toStringTag];if(typeof r=="string"&&/Stream|Port/i.test(r))return!0}}catch{}return!1}function tD(e,t){var r=t;if(!r)if(typeof WeakSet=="function")r=new WeakSet;else{var n=[];r={add:function(a){n.push(a)},has:function(a){return n.indexOf(a)!==-1}}}if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||o4(e))return e;if(typeof process<"u"&&process&&Z_&&Z_.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}if(e===IB||typeof globalThis<"u"&&e===globalThis||typeof window<"u"&&e===window||typeof self<"u"&&e===self||typeof global<"u"&&e===global)return e;try{if(typeof r.has=="function"&&r.has(e))return e}catch{}try{typeof r.add=="function"&&r.add(e)}catch{}try{Object.freeze(e)}catch{}return e}var n$=(function(){return Yr&&typeof Yr.freezeDeep=="function"?function(r,n){try{return Yr.freezeDeep(r,n)}catch{return tD(r,n)}}:nn&&typeof nn.freezeDeep=="function"?nn.freezeDeep:rn&&typeof rn.freezeDeep=="function"?rn.freezeDeep:tD})();function rD(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}var BB=(function(){return Yr&&typeof Yr.safeWarn=="function"?function(r,n){try{Yr.safeWarn(r,n)}catch{rD(r,n)}}:nn&&typeof nn.safeWarn=="function"?nn.safeWarn:rn&&typeof rn.safeWarn=="function"?rn.safeWarn:rD})();function a4(e,t,r,n){if(!r||typeof r!="object")return!1;var o={configurable:!n||n.configurable!==!1,enumerable:!!(n&&n.enumerable),value:t,writable:!!(n&&n.writable===!0)};try{return Object.defineProperty(r,e,o),!0}catch{try{return r[e]=t,!0}catch{return!1}}}function Vk(e,t,r,n){var o=r||go;if(Yr&&typeof Yr.exposeGlobalScoped=="function")try{var a=Yr.exposeGlobalScoped(e,t,o,n||{});if(typeof a<"u")return a}catch{}if(Yr&&typeof Yr.exposeGlobal=="function")try{return Yr.exposeGlobal(e,t,n||{})}catch{}if(nn&&typeof nn.exposeGlobal=="function")try{return nn.exposeGlobal(e,t,o,n||{})}catch{}if(rn&&typeof rn.exposeGlobal=="function")try{return rn.exposeGlobal(e,t,o,n||{})}catch{}return a4(e,t,o,n)}var i4=(function(){return Yr&&typeof Yr.tryRequire=="function"?function(r){var n=Yr.tryRequire(r);return typeof n>"u"?eD():n}:nn&&typeof nn.tryRequire=="function"?nn.tryRequire:rn&&typeof rn.tryRequire=="function"?rn.tryRequire:eD})();function qk(e){var t=e||go;if(Yr&&typeof Yr.getModuleRegistry=="function")try{var r=Yr.getModuleRegistry(t);if(r)return r}catch{}if(nn&&typeof nn.getModuleRegistry=="function")try{var n=nn.getModuleRegistry(t);if(n)return n}catch{}if(rn&&typeof rn.getModuleRegistry=="function")try{var o=rn.getModuleRegistry(t);if(o)return o}catch{}if(ei&&typeof ei=="object")return ei;for(var a=TL(t),i=0;i<a.length;i+=1){var s=a[i];if(s&&typeof s.cineModules=="object")return s.cineModules}return null}var nD=null,oD=!1;function rS(e){return e&&e!==go?qk(e):(oD||(nD=qk(go),oD=!0),nD)}function s4(e){if(!e||typeof e!="object")return{};var t={},r=[];try{r=Object.keys(e)}catch{r=[]}for(var n=0;n<r.length;n+=1){var o=r[n];try{t[o]=e[o]}catch{}}return t}function GB(e,t,r,n){if(Yr&&typeof Yr.queueModuleRegistration=="function")try{var o=Yr.queueModuleRegistration(e,t,r);if(typeof o<"u")return o}catch{}if(nn&&typeof nn.queueModuleRegistration=="function")try{return nn.queueModuleRegistration(e,t,r,n||go)}catch{}if(rn&&typeof rn.queueModuleRegistration=="function")try{return rn.queueModuleRegistration(e,t,r,n||go)}catch{}var a=r$(n||go);if(!a)return!1;var i=Object.freeze({name:e,api:t,options:Object.freeze(s4(r))});try{a.push(i)}catch{a[a.length]=i}return!0}function o$(e,t,r,n,o,a){var i=o||go,s=a||rS(i);if(rn&&typeof rn.registerOrQueueModule=="function")try{var l=rn.registerOrQueueModule(e,t,r,n,i,s);if(l)return Lc(e,t),!0}catch{}if(Yr&&typeof Yr.registerOrQueueModule=="function")try{var c=Yr.registerOrQueueModule(e,t,r,n,i,s);if(c)return Lc(e,t),!0}catch{}if(nn&&typeof nn.registerOrQueueModule=="function")try{var u=nn.registerOrQueueModule(e,t,r,n,i,s);if(u)return Lc(e,t),!0}catch{}if(s&&typeof s.register=="function")try{return s.register(e,t,r||{}),Lc(e,t),!0}catch(d){if(typeof n=="function")try{n(d)}catch{}}var f=GB(e,t,r,i);return f&&Lc(e,t),f}var eb=Object.create(null),dm=Object.create(null);function l4(e,t){if(dm[e]){var r=dm[e].slice();dm[e].length=0;for(var n=0;n<r.length;n+=1){var o=r[n];try{o(t)}catch{}}}}function Lc(e,t){return typeof e!="string"||!e||!t?!1:(eb[e]=t,l4(e,t),!0)}function a$(e,t){if(typeof e!="string"||!e)return null;if(Object.prototype.hasOwnProperty.call(eb,e))return eb[e];var r=t&&t.scope?t.scope:go;try{if(r&&typeof r=="object"&&typeof r[e]<"u")return r[e]}catch{}var n=rS(r);if(n&&typeof n.get=="function")try{var o=n.get(e);if(o)return o}catch{}return null}function c4(e,t){if(typeof e!="string"||!e||typeof t!="function")return!1;var r=a$(e);if(r){try{t(r)}catch{}return!0}return dm[e]||(dm[e]=[]),dm[e].push(t),!0}function u4(){return Object.freeze(Object.keys(eb))}function f4(){for(var e=[{name:"cineModuleBase",value:rn},{name:"cineModuleEnvironment",value:nn},{name:"cineEnvironmentBridge",value:Yr},{name:"cineModules",value:rS(go)}],t=0;t<e.length;t+=1){var r=e[t];r.value&&Lc(r.name,r.value)}}f4();var qE={scope:go,moduleBase:rn,moduleEnvironment:nn,environmentBridge:Yr,getModuleRegistry:rS,resolveModuleRegistry:qk,queueModuleRegistration:GB,registerOrQueueModule:o$,freezeDeep:n$,safeWarn:BB,exposeGlobal:function(t,r,n){return Vk(t,r,go,n||{})},exposeGlobalScoped:function(t,r,n,o){return Vk(t,r,n||go,o||{})},tryRequire:i4,collectCandidateScopes:function(t){var r=TL(t||go);return Object.freeze(r.slice())},getPendingQueueKey:function(){return wf},ensureQueue:function(t){return r$(t||go)},recordModule:Lc,getModule:a$,whenModuleAvailable:c4,listRecordedModules:u4},Sc=null,aD=TL(go);for(var UR=0;UR<aD.length;UR+=1){var zR=aD[UR];if(zR&&typeof zR.cineModuleGlobals=="object"){Sc=zR.cineModuleGlobals;break}}if(Sc&&Sc!==qE){try{for(var iD=Object.getOwnPropertyNames(Sc),$R=0;$R<iD.length;$R+=1){var VR=iD[$R];typeof qE[VR]>"u"&&(qE[VR]=Sc[VR])}}catch{}if(typeof Sc.listRecordedModules=="function")try{var qR=Sc.listRecordedModules();if(Array.isArray(qR))for(var KR=0;KR<qR.length;KR+=1){var WR=qR[KR];if(!eb[WR]&&typeof Sc.getModule=="function"){var sD=Sc.getModule(WR);sD&&Lc(WR,sD)}}}catch{}}var OL=n$(qE);Lc("cineModuleGlobals",OL);var d4=o$("cineModuleGlobals",OL,{category:"infrastructure",description:"Shared module globals for cross-script coordination.",replace:!0,connections:["cineModuleBase","cineModuleEnvironment","cineEnvironmentBridge"]},function(e){BB("Unable to register cineModuleGlobals module.",e)},go,rS(go));d4||GB("cineModuleGlobals",OL,{category:"infrastructure",description:"Shared module globals for cross-script coordination.",replace:!0,connections:["cineModuleBase","cineModuleEnvironment","cineEnvironmentBridge"]},go);var p4=Vk("cineModuleGlobals",OL,go,{configurable:!0,enumerable:!1,writable:!1});p4||BB("Unable to expose cineModuleGlobals globally.");var lD={};const rC="__cinePendingModuleRegistrations__";function tb(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function nC(e,t){const r=[];function n(o){!o||typeof o!="object"&&typeof o!="function"||r.indexOf(o)===-1&&r.push(o)}return n(e||t),typeof globalThis<"u"&&n(globalThis),typeof window<"u"&&n(window),typeof self<"u"&&n(self),typeof global<"u"&&n(global),r}function i$(e){return null}function MB(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function _B(e,t,r){const n=e||r,o=typeof t=="string"&&t?t:rC;if(!n||typeof n!="object")return null;let a=n[o];return Array.isArray(a)?a:!MB(n,o,[])||(a=n[o],!Array.isArray(a))?null:a}function m4(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function g4(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(m4(e)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const t=e[Symbol.toStringTag];if(typeof t=="string"&&/Stream|Port/i.test(t))return!0}}catch{}return!1}function y4(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function DB(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function"||g4(e))return e;if(typeof process<"u"&&process&&lD&&lD.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}const r=y4(t);if(r.has(e))return e;r.add(e);const n=Object.getOwnPropertyNames(e);for(let o=0;o<n.length;o+=1){const a=n[o];let i;try{i=e[a]}catch{i=void 0}!i||typeof i=="function"||typeof i!="object"&&typeof i!="function"||DB(i,r)}try{return Object.freeze(e)}catch{return e}}function s$(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function l$(e,t,r){const n=t||{},o=typeof n.predicate=="function"?n.predicate:null,a=Array.isArray(n.scopes)?n.scopes.slice():nC(n.primaryScope||r,r);for(let i=0;i<a.length;i+=1){const s=a[i];if(!s||typeof s!="object"&&typeof s!="function")continue;if(o){try{if(o(s,e))return s}catch{}continue}const l=s[e];if(typeof l<"u")return l}return null}function h4(e,t,r,n,o,a){const s=_B(e||o,a,o);if(!s)return!1;const l=Object.freeze({name:t,api:r,options:Object.freeze({...n||{}})});try{return s.push(l),!0}catch{}try{return s[s.length]=l,!0}catch{}return!1}function b4(e){const t=e||tb();return{detectGlobalScope:tb,getGlobalScope(){return t},collectCandidateScopes(r){return nC(r||t,t)},tryRequire:i$,defineHiddenProperty:MB,ensureQueue(r,n){return _B(r||t,n,t)},freezeDeep:DB,safeWarn:s$,resolveFromScopes(r,n){return l$(r,n,t)},queueModuleRegistration(r,n,o,a){return h4(r||t,n,o,a,t,rC)},getPendingQueueKey(){return rC},resolveModuleRegistry(r){const o=nC(r||t,t);for(let a=0;a<o.length;a+=1){const i=o[a];if(i&&typeof i.cineModules=="object")return i.cineModules}return null}}}function S4(e){const t=e||tb();return t&&typeof t.cineModuleArchitectureKernel=="object"?t.cineModuleArchitectureKernel:null}const c$=tb(),v4=S4(c$),Lr=v4||b4(c$);function Kk(){if(Lr&&typeof Lr.detectGlobalScope=="function")try{const e=Lr.detectGlobalScope();if(e)return e}catch{}return tb()}const Tn=Lr&&typeof Lr.getGlobalScope=="function"?(function(){try{const t=Lr.getGlobalScope();if(t)return t}catch{}return Kk()})():Kk();let rb=Lr&&typeof Lr.getPendingQueueKey=="function"?Lr.getPendingQueueKey():rC;function E4(e){if(Lr&&typeof Lr.collectCandidateScopes=="function")try{const t=Lr.collectCandidateScopes(e||Tn);if(Array.isArray(t)&&t.length>0)return t}catch{}return nC(e||Tn,Tn)}function nS(e){const t=E4(e||Tn);return Array.isArray(t)?t:[]}function A4(e){if(Lr&&typeof Lr.tryRequire=="function")try{const t=Lr.tryRequire(e);if(typeof t<"u")return t}catch{}return i$()}function u$(e,t,r){if(Lr&&typeof Lr.defineHiddenProperty=="function")try{if(Lr.defineHiddenProperty(e,t,r))return!0}catch{}return MB(e,t,r)}function C4(e){if(Lr&&typeof Lr.freezeDeep=="function")try{return Lr.freezeDeep(e)}catch{}return DB(e)}function Xa(e,t){if(Lr&&typeof Lr.safeWarn=="function")try{Lr.safeWarn(e,t);return}catch{}s$(e,t)}function xL(e,t){const r=t?{...t}:{};if(r.primaryScope||(r.primaryScope=Tn),r.scopes||(r.scopes=nS(r.primaryScope)),Lr&&typeof Lr.resolveFromScopes=="function")try{const n=Lr.resolveFromScopes(e,r);if(n)return n}catch(n){Xa(`cineModuleSystem: resolveFromScopes failed for "${e}".`,n)}return l$(e,r,Tn)}let cD=null,uD=!1;function fD(e){e&&typeof e.PENDING_QUEUE_KEY=="string"&&e.PENDING_QUEUE_KEY&&(rb=e.PENDING_QUEUE_KEY)}function dD(e){const t=e||Tn;if(Rn&&typeof Rn=="object")return fD(Rn),Rn;const r=xL("cineModuleBase",{primaryScope:t,scopes:nS(t)});return r&&typeof r=="object"?(fD(r),r):null}function kL(e){return e&&e!==Tn?dD(e):(uD||(cD=dD(Tn),uD=!0),cD)}function w4(e){const t=e||Tn;if(ei&&typeof ei=="object")return ei;const r=xL("cineModules",{primaryScope:t,scopes:nS(t)});return r&&typeof r=="object"?r:null}let pD=null,mD=!1;function gD(e){const t=e||Tn;if(Lr&&typeof Lr.resolveModuleRegistry=="function")try{const n=Lr.resolveModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Xa("cineModuleSystem: Kernel resolveModuleRegistry failed.",n)}const r=kL(t);if(r&&typeof r.resolveModuleRegistry=="function")try{const n=r.resolveModuleRegistry(t);if(n&&typeof n=="object")return n}catch(n){Xa("cineModuleSystem: Base resolveModuleRegistry failed.",n)}return w4(t)}function NB(e){return e&&e!==Tn?gD(e):(mD||(pD=gD(Tn),mD=!0),pD)}function L4(e,t,r,n={}){const o=r||Tn;if(!o||typeof o!="object")return!1;const a={configurable:n.configurable!==!1,enumerable:!!n.enumerable,value:t,writable:n.writable===!0};try{return Object.defineProperty(o,e,a),!0}catch{}try{return o[e]=t,!0}catch{}return!1}function f$(e,t,r,n){const o=r||Tn,a=kL(o);if(a&&typeof a.exposeGlobal=="function")try{return a.exposeGlobal(e,t,o,n||{})}catch(i){Xa(`cineModuleSystem: Failed to expose "${e}" through module base.`,i)}return L4(e,t,o,n||{})}function d$(e){const t=e||Tn;if(Lr&&typeof Lr.ensureQueue=="function")try{const r=Lr.ensureQueue(t,rb);if(Array.isArray(r))return r}catch(r){Xa("cineModuleSystem: ensureQueue failed via kernel.",r)}return _B(t,rb,Tn)}function p$(e){if(typeof e=="string"&&e.trim())return e.trim();if(typeof e=="number"&&Number.isFinite(e))return String(e);throw new TypeError("cineModuleSystem expected module name to be a non-empty string.")}function m$(e,t,r,n){const o=n||Tn;if(Lr&&typeof Lr.queueModuleRegistration=="function")try{if(Lr.queueModuleRegistration(o,e,t,r))return!0}catch(l){Xa("cineModuleSystem: queueModuleRegistration failed via kernel.",l)}const a=d$(o);if(!a)return Xa("cineModuleSystem: Unable to queue module registration.",{name:e}),!1;let i;try{i=p$(e)}catch(l){return Xa("cineModuleSystem: Ignoring registration with invalid name.",l),!1}const s=Object.freeze({name:i,api:t,options:Object.freeze({...r||{}})});try{a.push(s)}catch{try{a[a.length]=s}catch(c){return Xa("cineModuleSystem: Failed to record pending module registration.",c),!1}}return!0}function g$(e,t,r,n,o){const a=n||Tn,i=NB(a);if(i&&typeof i.register=="function")try{return i.register(e,t,r||{}),!0}catch(s){if(typeof o=="function")try{o(s)}catch(l){Xa("cineModuleSystem: Error handler threw while processing registration failure.",l)}else Xa(`cineModuleSystem: Unable to register module "${e}".`,s)}return m$(e,t,r,a),!1}function R4(e){const t=e||Tn,r=kL(t);if(r&&typeof r.getGlobalScope=="function")try{const n=r.getGlobalScope();if(n)return n}catch(n){Xa("cineModuleSystem: Unable to obtain global scope from module base.",n)}return t}function T4(e,t={}){const r=p$(e),n=t.scope||Tn,o=NB(n);if(o&&typeof o.get=="function")try{const l=o.get(r);if(l)return l}catch(l){Xa("cineModuleSystem: Registry lookup failed.",l)}const a=t.propertyName||r,i=Array.isArray(t.scopes)&&t.scopes.length>0?t.scopes:nS(n),s=xL(a,{primaryScope:n,scopes:i,predicate:t.predicate});if(s)return s;if(typeof t.fallback=="function")try{return t.fallback()}catch(l){Xa("cineModuleSystem: Fallback resolver threw while resolving module.",l)}return null}function O4(e,t,r,n,o){const a=n||Tn;return g$(e,t,r,a)?f$(e,t,a,o||{}):!1}function x4(e){return d$(e||Tn)}const y$={getArchitecture(){return Lr&&Lr.architecture||null},detectGlobalScope:Kk,getGlobalScope:R4,collectCandidateScopes:nS,tryRequire:A4,resolveFromScopes:xL,getModuleBase:kL,getModuleRegistry:NB,queueModuleRegistration:m$,registerModule:g$,registerAndExpose:O4,resolveModule:T4,exposeGlobal:f$,defineHiddenProperty:u$,freezeDeep:C4,safeWarn:Xa,getPendingQueue:x4,getPendingQueueKey(){return rb}};Object.defineProperty(y$,"PENDING_QUEUE_KEY",{configurable:!1,enumerable:!0,get(){return rb}});const h$=Object.freeze(y$);Tn&&typeof Tn=="object"&&!Tn.cineModuleSystem&&u$(Tn,"cineModuleSystem",h$);const YR=h$,k4="__cinePendingModuleRegistrations__";function oC(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function aC(e){const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function I4(e){return null}function P4(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function B4(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function b$(e,t){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return e;const r=B4(t);if(r.has(e))return e;r.add(e);let n=[];try{n=Object.getOwnPropertyNames(e)}catch{}for(let o=0;o<n.length;o+=1){const a=n[o];let i;try{i=e[a]}catch{i=void 0}!i||typeof i=="function"||typeof i!="object"&&typeof i!="function"||b$(i,r)}try{try{return Object.freeze(e)}catch(o){return e}}catch{return e}}function G4(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function M4(e,t){const r=t||{},n=typeof r.predicate=="function"?r.predicate:null,o=Array.isArray(r.scopes)?r.scopes.slice():aC(r.primaryScope);for(let a=0;a<o.length;a+=1){const i=o[a];if(!i||typeof i!="object"&&typeof i!="function")continue;if(n){try{if(n(i,e))return i}catch{}continue}const s=i[e];if(typeof s<"u")return s}return null}function _4(e,t){if(!e||typeof e!="object")return null;let r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r))return r;try{if(Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:[]}),r=e[t],Array.isArray(r))return r}catch{}try{e[t]=[],r=e[t]}catch{return null}return Array.isArray(r)?r:null}const kg=oC();function D4(e){const t=e||kg;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}function N4(e){const t=e||kg;return t&&typeof t.cineModuleArchitectureHelpers=="object"?t.cineModuleArchitectureHelpers:null}function F4(e){const t=e||kg;return YR&&typeof YR=="object"?YR:t&&typeof t.cineModuleSystem=="object"?t.cineModuleSystem:null}const on=N4(kg);let uh=on&&typeof on.pendingQueueKey=="string"?on.pendingQueueKey:k4;function KE(e){if(!(!e||typeof e!="object"&&typeof e!="function")){try{if(typeof e.getPendingQueueKey=="function"){const t=e.getPendingQueueKey();if(typeof t=="string"&&t){uh=t;return}}}catch{}typeof e.PENDING_QUEUE_KEY=="string"&&e.PENDING_QUEUE_KEY&&(uh=e.PENDING_QUEUE_KEY)}}const Wt=F4(kg);Wt&&KE(Wt);const Dr=(Wt&&typeof Wt.getArchitecture=="function"?Wt.getArchitecture():null)||D4(kg);function yD(){if(Wt&&typeof Wt.detectGlobalScope=="function"){try{const e=Wt.detectGlobalScope();if(e)return e}catch{}if(Dr&&typeof Dr.detectGlobalScope=="function")try{const e=Dr.detectGlobalScope();if(e)return e}catch{}return oC()}if(Dr&&typeof Dr.detectGlobalScope=="function")try{const e=Dr.detectGlobalScope();if(e)return e}catch{}return oC()}const S$=on&&typeof on.detectGlobalScope=="function"?function(){try{const t=on.detectGlobalScope();if(t)return t}catch{}return yD()}:yD,ri=S$();function hD(e){const t=e||ri;if(Wt&&typeof Wt.collectCandidateScopes=="function"){try{const r=Wt.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}if(Dr&&typeof Dr.collectCandidateScopes=="function")try{const r=Dr.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return aC(t)}if(Dr&&typeof Dr.collectCandidateScopes=="function")try{const r=Dr.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return aC(t)}const Gd=on&&typeof on.collectCandidateScopes=="function"?function(t){const r=t||ri;try{const n=on.collectCandidateScopes(r);if(Array.isArray(n)&&n.length>0)return n}catch{}return hD(r)}:hD;function bD(e){if(Wt&&typeof Wt.tryRequire=="function")try{const t=Wt.tryRequire(e);if(typeof t<"u")return t}catch{}if(Dr&&typeof Dr.tryRequire=="function")try{const t=Dr.tryRequire(e);if(typeof t<"u")return t}catch{}return I4()}const v$=on&&typeof on.tryRequire=="function"?function(t){const r=on.tryRequire(t);return typeof r>"u"?bD(t):r}:bD;function SD(e,t,r){if(Wt&&typeof Wt.defineHiddenProperty=="function")try{if(Wt.defineHiddenProperty(e,t,r))return!0}catch{}if(Dr&&typeof Dr.defineHiddenProperty=="function")try{if(Dr.defineHiddenProperty(e,t,r))return!0}catch{}return P4(e,t,r)}const E$=on&&typeof on.defineHiddenProperty=="function"?function(t,r,n){try{if(on.defineHiddenProperty(t,r,n))return!0}catch{}return SD(t,r,n)}:SD;function vD(e){if(Wt&&typeof Wt.freezeDeep=="function")try{return Wt.freezeDeep(e)}catch{}if(Dr&&typeof Dr.freezeDeep=="function")try{return Dr.freezeDeep(e)}catch{}return b$(e)}const Wk=on&&typeof on.freezeDeep=="function"?function(t){try{return on.freezeDeep(t)}catch{}return vD(t)}:vD;function ED(e,t){if(Wt&&typeof Wt.safeWarn=="function")try{Wt.safeWarn(e,t);return}catch{}if(Dr&&typeof Dr.safeWarn=="function")try{Dr.safeWarn(e,t);return}catch{}G4(e,t)}const Xo=on&&typeof on.safeWarn=="function"?function(t,r){try{on.safeWarn(t,r);return}catch{}ED(t,r)}:ED,IL=Wt&&typeof Wt.resolveFromScopes=="function"?function(t,r){const n={...r||{}};return n.primaryScope||(n.primaryScope=ri),n.scopes||(n.scopes=Gd(n.primaryScope)),Wt.resolveFromScopes(t,n)}:Dr&&typeof Dr.resolveFromScopes=="function"?function(t,r){const n={...r||{}};return n.primaryScope||(n.primaryScope=ri),n.scopes||(n.scopes=Gd(n.primaryScope)),Dr.resolveFromScopes(t,n)}:function(t,r){const n={...r||{}};return n.primaryScope||(n.primaryScope=ri),n.scopes||(n.scopes=aC(n.primaryScope)),M4(t,n)};function PL(e){const t=e||ri;if(Wt&&typeof Wt.getModuleBase=="function")try{const n=Wt.getModuleBase(t);if(n&&typeof n=="object")return KE(n),n}catch(n){Xo("cineModuleContext: Unable to resolve module base through module system.",n)}if(Rn&&typeof Rn=="object")return KE(Rn),Rn;const r=IL("cineModuleBase",{primaryScope:t,scopes:Gd(t)});return r&&typeof r=="object"?(KE(r),r):null}function FB(e){const t=e||ri;if(on&&typeof on.ensureQueue=="function")try{const r=on.ensureQueue(t,uh);if(Array.isArray(r))return r}catch(r){Xo("cineModuleContext: Unable to access pending queue via architecture helpers.",r)}if(Wt&&typeof Wt.getPendingQueue=="function")try{const r=Wt.getPendingQueue(t);if(Array.isArray(r))return r}catch(r){Xo("cineModuleContext: Unable to access pending queue via module system.",r)}if(Dr&&typeof Dr.ensureQueue=="function")try{const r=Dr.ensureQueue(t,uh);if(Array.isArray(r))return r}catch(r){Xo("cineModuleContext: Unable to access pending queue via architecture.",r)}return _4(t,uh)}function jB(e,t,r,n){const o=n||ri;if(on&&typeof on.queueModuleRegistration=="function")try{if(on.queueModuleRegistration(o,e,t,r))return!0}catch(s){Xo("cineModuleContext: Architecture helpers queueModuleRegistration failed.",s)}const a=FB(o);if(!a)return!1;const i=Object.freeze({name:e,api:t,options:Object.freeze({...r||{}})});try{a.push(i)}catch{a[a.length]=i}return!0}function HB(e){const t=e||ri;if(on&&typeof on.resolveModuleRegistry=="function")try{const o=on.resolveModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Xo("cineModuleContext: Architecture helpers resolveModuleRegistry failed.",o)}if(Wt&&typeof Wt.getModuleRegistry=="function")try{const o=Wt.getModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Xo("cineModuleContext: Unable to resolve module registry via module system.",o)}const r=PL(t);if(r&&typeof r=="object"){if(typeof r.getModuleRegistry=="function")try{const o=r.getModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Xo("cineModuleContext: Module base getModuleRegistry failed.",o)}if(typeof r.resolveModuleRegistry=="function")try{const o=r.resolveModuleRegistry(t);if(o&&typeof o=="object")return o}catch(o){Xo("cineModuleContext: Module base resolveModuleRegistry failed.",o)}}if(ei&&typeof ei=="object")return ei;const n=IL("cineModules",{primaryScope:t,scopes:Gd(t)});return n&&typeof n=="object"?n:null}function UB(e,t,r,n){const o=n||ri;if(Wt&&typeof Wt.registerModule=="function")try{if(Wt.registerModule(e,t,r||{},o))return!0}catch(s){Xo("cineModuleContext: Module system failed to register module.",s)}const a=HB(o),i=PL(o);if(i&&typeof i.registerOrQueueModule=="function")try{if(i.registerOrQueueModule(e,t,r||{},l=>{Xo("cineModuleContext: Module base failed to register module.",l)},o,a))return!0}catch(s){Xo("cineModuleContext: Module base threw while registering module.",s)}if(a&&typeof a.register=="function")try{return a.register(e,t,r||{}),!0}catch(s){Xo("cineModuleContext: Registry registration failed.",s)}return jB(e,t,r,o)}function zB(e,t,r,n={}){const o=r||ri;if(!o||typeof o!="object")return!1;if(Wt&&typeof Wt.exposeGlobal=="function")try{return Wt.exposeGlobal(e,t,o,n||{})}catch(i){Xo("cineModuleContext: Module system failed to expose global.",i)}const a={configurable:n.configurable!==!1,enumerable:!!n.enumerable,value:t,writable:n.writable===!0};try{return Object.defineProperty(o,e,a),!0}catch{}try{return o[e]=t,!0}catch{}return!1}function j4(e={}){const t=e.scope||ri,r=PL(t),n=HB(t);return Object.freeze({getArchitecture(){return Dr||null},getSystem(){return Wt||null},getScope(){return t},detectGlobalScope(a){const i=a||t;try{if(Wt&&typeof Wt.detectGlobalScope=="function"){const s=Wt.detectGlobalScope(i);if(s)return s}}catch(s){Xo("cineModuleContext: detectGlobalScope via system failed.",s)}if(Dr&&typeof Dr.detectGlobalScope=="function")try{const s=Dr.detectGlobalScope(i);if(s)return s}catch(s){Xo("cineModuleContext: detectGlobalScope via architecture failed.",s)}return oC()},collectCandidateScopes(a){return Gd(a||t)},tryRequire(a){return v$(a)},resolveFromScopes(a,i){const s={...i||{}};return s.primaryScope||(s.primaryScope=t),s.scopes||(s.scopes=Gd(s.primaryScope)),IL(a,s)},defineHiddenProperty(a,i,s){return E$(a,i,s)},freezeDeep(a){return Wk(a)},safeWarn(a,i){Xo(a,i)},ensureQueue(a){return FB(a||t)},getModuleBase(){return r},getModuleRegistry(){return n},queueModuleRegistration(a,i,s,l){return jB(a,i,s,l||t)},registerModule(a,i,s,l){return UB(a,i,s,l||t)},exposeGlobal(a,i,s,l){return zB(a,i,s||t,l||{})}})}const A$=Wk({getArchitecture(){return Dr},getModuleSystem(){return Wt},detectGlobalScope:S$,collectCandidateScopes:Gd,tryRequire:v$,resolveFromScopes:IL,defineHiddenProperty:E$,freezeDeep:Wk,safeWarn:Xo,ensureQueue:FB,resolveModuleBase:PL,resolveModuleRegistry:HB,queueModuleRegistration:jB,registerOrQueue:UB,exposeGlobal:zB,createModuleContext:j4,getPrimaryScope(){return ri}});UB("cineModuleContext",A$,{category:"infrastructure",description:"Shared context helpers that unify architecture, system and registry lookups.",freeze:!1,connections:["cineModuleBase","cineModuleGlobals","cineModuleEnvironment","cineModuleArchitectureKernel"]},ri);zB("cineModuleContext",A$,ri,{configurable:!0,enumerable:!1,writable:!1});const BL="__cinePendingModuleRegistrations__";function $B(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const oS=$B();function H4(e){const t=[],r=e||oS;r&&typeof r=="object"&&t.push(r),typeof globalThis<"u"&&t.indexOf(globalThis)===-1&&t.push(globalThis),typeof window<"u"&&t.indexOf(window)===-1&&t.push(window),typeof self<"u"&&t.indexOf(self)===-1&&t.push(self),typeof global<"u"&&t.indexOf(global)===-1&&t.push(global);for(let n=0;n<t.length;n+=1){const o=t[n];if(o&&typeof o.cineModuleArchitectureCore=="object")return o.cineModuleArchitectureCore}return null}function U4(e){const t=e||oS;return t&&typeof t.cineModuleArchitecture=="object"?t.cineModuleArchitecture:null}const Gn=U4(oS),WE=H4(oS),Un=WE&&typeof WE.createCore=="function"?WE.createCore({primaryScope:oS,pendingQueueKey:BL}):null;function C$(e){const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function AD(){if(Un&&typeof Un.detectGlobalScope=="function")try{const e=Un.detectGlobalScope();if(e)return e}catch{}if(Gn&&typeof Gn.detectGlobalScope=="function")try{const e=Gn.detectGlobalScope();if(e)return e}catch{}return $B()}const w$=Gn&&typeof Gn.detectGlobalScope=="function"?function(){try{const t=Gn.detectGlobalScope();if(t)return t}catch{}return AD()}:AD,ka=w$();function z4(e){const t=e||ka;if(Un&&typeof Un.collectCandidateScopes=="function")try{const r=Un.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}if(Gn&&typeof Gn.collectCandidateScopes=="function")try{const r=Gn.collectCandidateScopes(t);if(Array.isArray(r)&&r.length>0)return r}catch{}return C$(t)}const VB=function(t){const r=t||ka,n=z4(r);return Array.isArray(n)&&n.length>0?n:C$(r)};function $4(e){return null}function qB(e){if(Un&&typeof Un.tryRequire=="function")try{const t=Un.tryRequire(e);if(typeof t<"u")return t}catch{}if(Gn&&typeof Gn.tryRequire=="function")try{const t=Gn.tryRequire(e);if(typeof t<"u")return t}catch{}return $4()}function L$(e){const t=e||ka;if(Un&&typeof Un.resolveImmutability=="function")try{const o=Un.resolveImmutability(t);if(o&&typeof o=="object")return o}catch{}if(Gn&&typeof Gn.tryRequire=="function")try{const o=Gn.tryRequire("./immutability.js");if(o&&typeof o=="object")return o}catch{}const r=qB("./immutability.js");if(r&&typeof r=="object")return r;const n=VB(t);for(let o=0;o<n.length;o+=1){const a=n[o];if(a&&typeof a.cineModuleImmutability=="object")return a.cineModuleImmutability}return null}function V4(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function KB(e,t,r){if(Un&&typeof Un.defineHiddenProperty=="function")try{if(Un.defineHiddenProperty(e,t,r))return!0}catch{}if(Gn&&typeof Gn.defineHiddenProperty=="function")try{if(Gn.defineHiddenProperty(e,t,r))return!0}catch{}return V4(e,t,r)}function q4(e,t){if(!e||typeof e!="object")return null;let r=null;try{r=e[t]}catch{r=null}if(Array.isArray(r)||KB(e,t,[])&&(r=e[t],Array.isArray(r)))return r;try{e[t]=[],r=e[t]}catch{return null}return Array.isArray(r)?r:null}function R$(e,t){const r=typeof t=="string"&&t?t:BL,n=e||ka;if(Un&&typeof Un.ensureQueue=="function")try{const o=Un.ensureQueue(n,r);if(Array.isArray(o))return o}catch{}if(Gn&&typeof Gn.ensureQueue=="function")try{const o=Gn.ensureQueue(n,r);if(Array.isArray(o))return o}catch{}return q4(n,r)}function K4(){function e(r){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return!1;try{if(typeof r.pipe=="function"&&typeof r.unpipe=="function")return!0;if(typeof r.on=="function"&&typeof r.emit=="function"){if(typeof r.write=="function"||typeof r.read=="function")return!0;const n=r.constructor&&r.constructor.name;if(n&&/Stream|Emitter|Port/i.test(n))return!0}if(typeof Symbol<"u"&&r[Symbol.toStringTag]){const n=r[Symbol.toStringTag];if(typeof n=="string"&&/Stream|Port/i.test(n))return!0}}catch{}return!1}function t(r,n=new WeakSet){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function"||e(r)||n.has(r))return r;n.add(r);const o=Object.getOwnPropertyNames(r);for(let a=0;a<o.length;a+=1){const i=o[a];let s;try{s=r[i]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||t(s,n)}try{return Object.freeze(r)}catch(a){return console.warn("fallbackCreateImmutability (helpers): Object.freeze failed",a),r}}return{shouldBypassDeepFreeze:e,freezeDeep:t}}const WB=K4();let Vg=L$(ka)||WB;function W4(){if(Vg!==WB)return Vg;const e=L$(ka);return e&&e!==Vg&&(Vg=e),Vg}function Yk(e){if(Un&&typeof Un.freezeDeep=="function")try{return Un.freezeDeep(e)}catch{}const t=W4();try{return t.freezeDeep(e)}catch{}return WB.freezeDeep(e)}function Y4(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function T$(e,t){if(Un&&typeof Un.safeWarn=="function")try{Un.safeWarn(e,t);return}catch{}if(Gn&&typeof Gn.safeWarn=="function")try{Gn.safeWarn(e,t);return}catch{}Y4(e,t)}function O$(e){const t=e||ka,r=qB("./registry.js");if(r&&typeof r=="object")return r;const n=VB(t);for(let o=0;o<n.length;o+=1){const a=n[o];if(a&&typeof a.cineModules=="object")return a.cineModules}return null}function Qk(e,t,r,n){const a=R$(e||ka,BL);if(!a)return!1;const i=Yk({name:t,api:r,options:Object.freeze({...n||{}})});try{a.push(i)}catch{a[a.length]=i}return!0}const YE=Yk({architecture:Gn,architectureCore:WE,detectGlobalScope:w$,getPrimaryScope(){return ka},collectCandidateScopes:VB,tryRequire:qB,defineHiddenProperty:KB,ensureQueue:R$,freezeDeep:Yk,safeWarn:T$,resolveModuleRegistry:O$,queueModuleRegistration:Qk,pendingQueueKey:BL,fallbackDetectGlobalScope:$B}),QR=O$(ka),XR={category:"infrastructure",description:"Shared architecture helpers for scope detection, registry resolution and queue management.",replace:!0,connections:["cineModuleArchitectureKernel","cineModuleArchitectureCore"]};if(QR&&typeof QR.register=="function")try{QR.register("cineModuleArchitectureHelpers",YE,XR)}catch(e){T$("cineModuleArchitectureHelpers: immediate registry registration failed.",e),Qk(ka,"cineModuleArchitectureHelpers",YE,XR)}else Qk(ka,"cineModuleArchitectureHelpers",YE,XR);ka&&typeof ka=="object"&&!ka.cineModuleArchitectureHelpers&&KB(ka,"cineModuleArchitectureHelpers",YE);const YB="__cinePendingModuleRegistrations__";function Md(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function Q4(e){return null}function X4(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r}),!0}catch{}try{return e[t]=r,!0}catch{}return!1}function x$(e,t,r){const n=typeof r=="function"?r:Md,o=Array.isArray(t)?t:null,a=I$(n,o);if(a)return a(e);const i=[];function s(l){!l||typeof l!="object"&&typeof l!="function"||i.indexOf(l)===-1&&i.push(l)}e&&s(e);try{s(n())}catch{}if(Array.isArray(o))for(let l=0;l<o.length;l+=1)s(o[l]);return typeof globalThis<"u"&&s(globalThis),typeof window<"u"&&s(window),typeof self<"u"&&s(self),typeof global<"u"&&s(global),s(Md()),i}function J4(e,t){const r=t||{},n=typeof r.predicate=="function"?r.predicate:null,o=Array.isArray(r.scopes)?r.scopes.slice():[],a=typeof r.detect=="function"?r.detect:Md,i=Array.isArray(r.additionalScopes)?r.additionalScopes:void 0,s=r.primaryScope,l=x$(s,i,a);for(let c=0;c<l.length;c+=1)o.indexOf(l[c])===-1&&o.push(l[c]);for(let c=0;c<o.length;c+=1){const u=o[c];if(!(!u||typeof u!="object"&&typeof u!="function")){if(n)try{if(n(u,e))return u}catch{}try{if(e in u)return u}catch{}}}return null}const GL=Md();function Z4(e){const t=e||GL;if(DR&&typeof DR=="object")return DR;const r=[];function n(o){!o||typeof o!="object"&&typeof o!="function"||r.indexOf(o)===-1&&r.push(o)}n(t),typeof globalThis<"u"&&n(globalThis),typeof window<"u"&&n(window),typeof self<"u"&&n(self),typeof global<"u"&&n(global);for(let o=0;o<r.length;o+=1){const a=r[o];try{const i=a&&a.cineScopeUtils;if(i&&typeof i=="object")return i}catch{}}return null}const ni=Z4(GL),Ig=ni&&typeof ni.detectGlobalScope=="function"?function(){try{return ni.detectGlobalScope()}catch{}return Md()}:Md,Xk=ni&&typeof ni.tryRequire=="function"?ni.tryRequire:Q4,QB=ni&&typeof ni.defineHiddenProperty=="function"?ni.defineHiddenProperty:X4,XB=ni&&typeof ni.collectCandidateScopes=="function"?function(t,r,n){const o=typeof n=="function"?n:Ig;return ni.collectCandidateScopes(t,r,o)}:x$,k$=ni&&typeof ni.resolveFromScopes=="function"?function(t,r){const n=r?JB(r):{};return n.primaryScope||(n.primaryScope=GL),n.detect||(n.detect=Ig),ni.resolveFromScopes(t,n)||null}:J4;function eQ(){if(NR&&typeof NR=="function")return{createCollector:NR};const e=XB(GL,null,Ig);for(let t=0;t<e.length;t+=1){const r=e[t];try{const n=r&&r.__cineScopeCollector;if(n&&typeof n.createCollector=="function")return n}catch{}}return null}const JR=eQ(),CD=JR&&typeof JR.createCollector=="function"?JR.createCollector:null,tQ={key:"defaultExtras"},ZR=[];function I$(e,t){if(!CD)return null;const r=Array.isArray(t)?t:tQ;for(let o=0;o<ZR.length;o+=1){const a=ZR[o];if(a.detect===e&&a.extras===r)return a.collector}const n=CD({detectGlobalScope:e,additionalScopes:Array.isArray(t)?t:void 0});return n?(ZR.push({detect:e,extras:r,collector:n}),n):null}function JB(e){if(!e||typeof e!="object")return{};const t={},r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];t[o]=e[o]}return t}function rQ(){function e(r){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return!1;try{if(typeof r.pipe=="function"&&typeof r.unpipe=="function")return!0;if(typeof r.on=="function"&&typeof r.emit=="function"){if(typeof r.write=="function"||typeof r.read=="function")return!0;const n=r.constructor&&r.constructor.name;if(n&&/Stream|Emitter|Port/i.test(n))return!0}if(typeof Symbol<"u"&&r[Symbol.toStringTag]){const n=r[Symbol.toStringTag];if(typeof n=="string"&&/Stream|Port/i.test(n))return!0}}catch{}return!1}function t(r,n=new WeakSet){if(!r||typeof r=="function"||typeof r!="object"&&typeof r!="function")return r;if(e(r))return process.stdout.write(`architecture.js bypassed freeze for value: ${typeof r}
`),r;if(n.has(r))return r;n.add(r);const o=Object.getOwnPropertyNames(r);for(let a=0;a<o.length;a+=1){const i=o[a];let s;try{s=r[i]}catch{s=void 0}!s||typeof s=="function"||typeof s!="object"&&typeof s!="function"||t(s,n)}try{return Object.freeze(r)}catch{return r}}return{shouldBypassDeepFreeze:e,freezeDeep:t}}const QE=rQ();function P$(e,t){if(!e||typeof e!="object")return null;const r=typeof t=="string"&&t?t:YB;let n=e[r];if(Array.isArray(n)||QB(e,r,[])&&(n=e[r],Array.isArray(n)))return n;try{if(e[r]=[],n=e[r],Array.isArray(n))return n}catch{}return null}function ZB(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}function nQ(e){const t=XB(e,null,Ig);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.cineModuleArchitectureCore=="object")return n.cineModuleArchitectureCore}return null}function B$(e){const t=e||{},r=t&&(t.primaryScope||t.scope)&&(typeof t.primaryScope=="object"||typeof t.primaryScope=="function"?t.primaryScope:typeof t.scope=="object"||typeof t.scope=="function"?t.scope:null),n=typeof t.detectGlobalScope=="function"?t.detectGlobalScope:null,o=typeof t.resolveFromScopes=="function"?t.resolveFromScopes:null,a=typeof t.freezeDeep=="function"?t.freezeDeep:null,i=typeof t.safeWarn=="function"?t.safeWarn:null,s=typeof t.tryRequire=="function"?t.tryRequire:null,l=Array.isArray(t.additionalScopes)?t.additionalScopes.filter(function(R){return R&&(typeof R=="object"||typeof R=="function")}):[],c=typeof t.pendingQueueKey=="string"&&t.pendingQueueKey?t.pendingQueueKey:YB;let u=null;function f(){try{if(n){const R=n();if(R)return u=R,R}}catch{}if(u)return u;const A=r||Ig();return u=A,A}function d(){return f()}function p(A){const R=A||r,I=I$(f,l);if(I)return I(R);const C=[];function k(_){!_||typeof _!="object"&&typeof _!="function"||C.indexOf(_)===-1&&C.push(_)}k(R),k(f()),typeof globalThis<"u"&&k(globalThis),typeof window<"u"&&k(window),typeof self<"u"&&k(self),typeof global<"u"&&k(global);for(let _=0;_<l.length;_+=1)k(l[_]);return C}const h=s?function(R){try{return s(R)}catch{}return Xk(R)}:Xk;let m=null;function g(A){try{const I=h("./immutability.js");if(I&&typeof I=="object")return m=I,I}catch{}const R=p(A);for(let I=0;I<R.length;I+=1){const C=R[I];if(C&&typeof C.cineModuleImmutability=="object")return m=C.cineModuleImmutability,m}return null}function S(A){if(m&&m!==QE)return m;const R=g(d());return R&&R!==m?(m=R,R):(m=QE,m)}function y(A,R){if(a)try{return a(A,R)}catch{}const I=S();try{return I.freezeDeep(A,R)}catch{}return QE.freezeDeep(A,R)}function E(A,R){const I=typeof R=="string"&&R?R:c;return P$(A||d(),I)}function L(A,R){if(o)try{return o(A,R)}catch{}const I=JB(R);return I.scopes||(I.scopes=p(I.primaryScope)),k$(A,I)}function v(A,R){if(i)try{i(A,R);return}catch{}ZB(A,R)}return Object.freeze({detectGlobalScope:f,getPrimaryScope:d,collectCandidateScopes:p,tryRequire:h,resolveFromScopes:L,defineHiddenProperty:QB,ensureQueue:E,freezeDeep:y,safeWarn:v})}const eT=nQ(Ig()),tT=eT&&typeof eT.createCore=="function"?eT.createCore:B$;function oQ(e){const t=B$(e);if(!tT||typeof tT!="function")return{primary:t,fallback:t};try{const r=tT(e||{});if(r&&typeof r=="object")return{primary:r,fallback:t}}catch(r){ZB("cineModuleArchitecture: core factory failed; using fallback core.",r)}return{primary:t,fallback:t}}function wD(e,t,r,n,o){const a=e&&typeof e[r]=="function"?e[r]:null,i=t&&typeof t[r]=="function"?t[r]:null,s=typeof n=="function"?n:null,l=c=>!c||typeof c.message!="string"?!1:!!(c.message.includes("trap returned extra keys but proxy target is non-extensible")||c.message.includes("Cannot freeze"));return function(){const u=arguments;if(a)try{return a.apply(e,u)}catch(f){if(typeof o=="function")try{l(f)||o("cineModuleArchitecture."+r+": primary implementation failed, using fallback.",f)}catch{}}if(i)return i.apply(t,u);if(s)return s.apply(null,u)}}function G$(e){const t=oQ(e||{}),r=t.primary,n=t.fallback,o=wD(r,n,"safeWarn",ZB,null);function a(h,m){return wD(r,n,h,m,o)}const i=a("detectGlobalScope",Md),s=a("getPrimaryScope",function(){return i()}),l=a("collectCandidateScopes",function(m){const g=m||s();return XB(g)}),c=a("tryRequire",Xk),u=a("resolveFromScopes",function(m,g){const S=JB(g);return S.scopes||(S.scopes=l(S.primaryScope)),k$(m,S)}),f=a("defineHiddenProperty",QB),d=a("ensureQueue",function(m,g){const S=m||s();return P$(S,g)}),p=a("freezeDeep",function(m,g){return QE.freezeDeep(m,g)});return Object.freeze({detectGlobalScope:i,getPrimaryScope:s,collectCandidateScopes:l,tryRequire:c,resolveFromScopes:u,defineHiddenProperty:f,ensureQueue:d,freezeDeep:p,safeWarn:o})}const qa=G$({}),eG=Object.freeze({detectGlobalScope:qa.detectGlobalScope,collectCandidateScopes:qa.collectCandidateScopes,tryRequire:qa.tryRequire,resolveFromScopes:qa.resolveFromScopes,defineHiddenProperty:qa.defineHiddenProperty,ensureQueue:qa.ensureQueue,freezeDeep:qa.freezeDeep,safeWarn:qa.safeWarn});function M$(e){const t=e||{},r=t&&(t.primaryScope||t.scope)&&(typeof t.primaryScope=="object"||typeof t.primaryScope=="function"?t.primaryScope:typeof t.scope=="object"||typeof t.scope=="function"?t.scope:null),n=typeof t.detectGlobalScope=="function"?t.detectGlobalScope:function(){return r||qa.detectGlobalScope()},o=Array.isArray(t.additionalScopes)?t.additionalScopes.filter(function(d){return d&&(typeof d=="object"||typeof d=="function")}):[],a=typeof t.tryRequire=="function"?t.tryRequire:qa.tryRequire,i=typeof t.resolveFromScopes=="function"?t.resolveFromScopes:null,s=typeof t.pendingQueueKey=="string"&&t.pendingQueueKey?t.pendingQueueKey:YB,l=typeof t.freezeDeep=="function"?t.freezeDeep:qa.freezeDeep,c=typeof t.safeWarn=="function"?t.safeWarn:qa.safeWarn,u=G$({primaryScope:r,detectGlobalScope:n,additionalScopes:o,tryRequire:a,resolveFromScopes:i,pendingQueueKey:s,freezeDeep:l,safeWarn:c});return Object.freeze({detectGlobalScope:u.detectGlobalScope,collectCandidateScopes:u.collectCandidateScopes,tryRequire:u.tryRequire,resolveFromScopes:u.resolveFromScopes,defineHiddenProperty:u.defineHiddenProperty,ensureQueue:u.ensureQueue,freezeDeep:u.freezeDeep,safeWarn:u.safeWarn})}const aQ=Object.freeze({...eG,createModuleArchitecture:M$}),Ou=qa.getPrimaryScope?qa.getPrimaryScope():qa.detectGlobalScope();Ou&&typeof Ou=="object"&&!Ou.cineModuleArchitecture&&eG.defineHiddenProperty(Ou,"cineModuleArchitecture",aQ);Ou&&typeof Ou=="object"&&!Ou.cineModuleArchitectureFactory&&eG.defineHiddenProperty(Ou,"cineModuleArchitectureFactory",Object.freeze({createModuleArchitecture:M$}));var LD={};(function(){const e=typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};function t(){return typeof e<"u"?e:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function r(){if(typeof require=="function")try{const z=require("./runtime-environment-helpers.js");if(z&&typeof z=="object")return z}catch{}const O=[];function D(z){!z||typeof z!="object"&&typeof z!="function"||O.indexOf(z)===-1&&O.push(z)}const F=t();D(F),typeof e<"u"&&D(e),typeof window<"u"&&D(window),typeof self<"u"&&D(self),typeof global<"u"&&D(global);for(let z=0;z<O.length;z+=1){const J=O[z];try{const Q=J&&J.cineRuntimeEnvironmentHelpers;if(Q&&typeof Q=="object")return Q}catch{}}return null}const n=r();function o(O,D,F){if(n&&O&&typeof n[O]=="function")try{const z=n[O].apply(n,Array.isArray(D)?D:[]);if(typeof z<"u")return z}catch{}if(typeof F=="function")return F()}function a(){if(n&&typeof n.fallbackDetectGlobalScope=="function")try{const O=n.fallbackDetectGlobalScope();if(O)return O}catch{}return typeof e<"u"?e:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function i(O){if(n&&typeof n.fallbackCollectCandidateScopes=="function")try{const z=n.fallbackCollectCandidateScopes(O);if(Array.isArray(z))return z}catch{}const D=[];function F(z){!z||typeof z!="object"&&typeof z!="function"||D.indexOf(z)===-1&&D.push(z)}return F(O),typeof e<"u"&&F(e),typeof window<"u"&&F(window),typeof self<"u"&&F(self),typeof global<"u"&&F(global),D}function s(O){return o("fallbackLoadModuleEnvironment",[O],function(){const F=u("./environment.js");if(F&&typeof F=="object")return F;const z=i(O);for(let J=0;J<z.length;J+=1){const Q=z[J];if(Q&&typeof Q.cineModuleEnvironment=="object")return Q.cineModuleEnvironment}return null})}function l(O){return o("fallbackLoadEnvironmentBridge",[O],function(){const F=u("./environment-bridge.js");if(F&&typeof F=="object")return F;const z=i(O);for(let J=0;J<z.length;J+=1){const Q=z[J];if(Q&&typeof Q.cineEnvironmentBridge=="object")return Q.cineEnvironmentBridge}return null})}function c(O){return o("fallbackResolveModuleGlobals",[O],function(){const F=u("./globals.js");if(F&&typeof F=="object")return F;const z=i(O);for(let J=0;J<z.length;J+=1){const Q=z[J];if(Q&&typeof Q.cineModuleGlobals=="object")return Q.cineModuleGlobals}return null})}function u(O){return o("fallbackTryRequire",[O],function(){if(typeof require!="function")return null;try{return require(O)}catch{return null}})}function f(O){return o("resolveModuleLinker",[O],function(){const F=u("./helpers/module-linker.js");if(F&&typeof F=="object")return F;const z=i(O);for(let J=0;J<z.length;J+=1){const Q=z[J];try{const le=Q&&Q.cineModuleLinker;if(le&&typeof le=="object")return le}catch{}}return null})}const d=a(),p=f(d);function h(O){return o("resolveModuleSystem",[O],function(){const F=O||d,z=u("./system.js");return z&&typeof z=="object"?z:F&&typeof F.cineModuleSystem=="object"?F.cineModuleSystem:null})}const m=h(d);function g(O){return o("resolveEnvironmentContext",[O||d],function(){const F=O||d,z=u("./environment-context.js");return z&&typeof z=="object"?z:F&&typeof F.cineModuleEnvironmentContext=="object"?F.cineModuleEnvironmentContext:null})}const S=g(d);function y(){if(S&&typeof S.detectGlobalScope=="function")try{const O=S.detectGlobalScope();if(O)return O}catch{}return a()}const E=m&&typeof m.detectGlobalScope=="function"?function(){try{const D=m.detectGlobalScope();if(D)return D}catch{}return y()}:y,L=(S&&typeof S.getPrimaryScope=="function"?S.getPrimaryScope():null)||E(),v=(function(){if(m&&typeof m.getGlobalScope=="function")try{const D=m.getGlobalScope(L);if(D)return D}catch{}if(S&&typeof S.getGlobalScope=="function")try{const D=S.getGlobalScope(L);if(D)return D}catch{}return L})(),A=typeof WeakMap=="function"?new WeakMap:null;function R(O){const D=O||v,F=!!A&&D&&(typeof D=="object"||typeof D=="function");if(F)try{const Q=A.get(D);if(Q&&Array.isArray(Q)&&Q.length>0)return Q.slice()}catch{}if(m&&typeof m.collectCandidateScopes=="function")try{const Q=m.collectCandidateScopes(D);if(Array.isArray(Q)&&Q.length>0){const le=Q.slice();if(F)try{const Ee=typeof Object.freeze=="function"?Object.freeze(le.slice()):le.slice();A.set(D,Ee)}catch(Ee){}return le}}catch{}if(S&&typeof S.collectCandidateScopes=="function")try{const Q=S.collectCandidateScopes(D);if(Array.isArray(Q)&&Q.length>0){const le=Q.slice();if(F)try{const Ee=typeof Object.freeze=="function"?Object.freeze(le.slice()):le.slice();A.set(D,Ee)}catch(Ee){}return le}}catch{}const z=i(D),J=Array.isArray(z)?z.slice():[];if(F&&J.length>0)try{const Q=typeof Object.freeze=="function"?Object.freeze(J.slice()):J.slice();A.set(D,Q)}catch{}return J}const I=(p&&typeof p.getModuleEnvironment=="function"?p.getModuleEnvironment():null)||(S&&typeof S.resolveModuleEnvironment=="function"?S.resolveModuleEnvironment(v):null)||s(v),C=(p&&typeof p.getEnvironmentBridge=="function"?p.getEnvironmentBridge():null)||(S&&typeof S.resolveEnvironmentBridge=="function"?S.resolveEnvironmentBridge(v):null)||l(v),k=(p&&typeof p.getModuleGlobals=="function"?p.getModuleGlobals():null)||(S&&typeof S.resolveModuleGlobals=="function"?S.resolveModuleGlobals(v):null)||c(v);function _(O,D){if(p&&typeof p.recordModule=="function"&&p.recordModule(O,D),!(!k||typeof k.recordModule!="function"))try{k.recordModule(O,D)}catch{}}const w=(function(){return p&&typeof p.tryRequire=="function"?p.tryRequire:m&&typeof m.tryRequire=="function"?function(F){const z=m.tryRequire(F);return typeof z>"u"?u(F):z}:S&&typeof S.tryRequire=="function"?function(F){const z=S.tryRequire(F);return typeof z>"u"?u(F):z}:k&&typeof k.tryRequire=="function"?k.tryRequire:C&&typeof C.tryRequire=="function"?function(F){const z=C.tryRequire(F);return typeof z>"u"?u(F):z}:I&&typeof I.tryRequire=="function"?I.tryRequire:u})();function x(O){const D=O||v;if(p&&typeof p.getModuleRegistry=="function"){const J=p.getModuleRegistry(D);if(J)return J}if(k&&typeof k.resolveModuleRegistry=="function")try{const J=k.resolveModuleRegistry(D);if(J)return J}catch{}if(C&&typeof C.getModuleRegistry=="function")try{const J=C.getModuleRegistry(D);if(J)return J}catch{}if(I&&typeof I.resolveModuleRegistry=="function")try{return I.resolveModuleRegistry(D)}catch{}const F=w("./registry.js");if(F&&typeof F=="object")return F;const z=R(D);for(let J=0;J<z.length;J+=1){const Q=z[J];if(Q&&typeof Q.cineModules=="object")return Q.cineModules}return null}function G(O){const D=v;if(m&&typeof m.getModuleRegistry=="function")try{const F=m.getModuleRegistry(D);if(F)return F}catch{}if(S&&typeof S.resolveModuleRegistry=="function")try{const F=S.resolveModuleRegistry(D);if(F)return F}catch{}return x(D)}const T=(function(){if(p&&typeof p.getModuleRegistry=="function"){const O=p.getModuleRegistry(v);if(O)return O}if(m&&typeof m.getModuleRegistry=="function")try{const O=m.getModuleRegistry(v);if(O)return O}catch{}if(k&&typeof k.getModuleRegistry=="function")try{const O=k.getModuleRegistry(v);if(O)return O}catch{}if(C&&typeof C.getModuleRegistry=="function")try{const O=C.getModuleRegistry(v);if(O)return O}catch{}if(I&&typeof I.getModuleRegistry=="function")try{const O=I.getModuleRegistry(v);if(O)return O}catch{}return G()})(),P=(function(){if(p&&typeof p.getPendingQueueKey=="function"){const D=p.getPendingQueueKey();if(typeof D=="string"&&D)return D}if(m&&typeof m.getPendingQueueKey=="function")try{const D=m.getPendingQueueKey();if(typeof D=="string"&&D)return D}catch{}if(k&&typeof k.getPendingQueueKey=="function")try{const D=k.getPendingQueueKey();if(typeof D=="string"&&D)return D}catch{}if(C&&typeof C.getPendingQueueKey=="function")try{const D=C.getPendingQueueKey();if(typeof D=="string"&&D)return D}catch{}return I&&typeof I.PENDING_QUEUE_KEY=="string"?I.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function N(O){if(!O||typeof O!="object")return{};const D={},F=Object.keys(O);for(let z=0;z<F.length;z+=1){const J=F[z];D[J]=O[J]}return D}function q(O){return typeof O=="string"?O:""}function Z(O,D){if(!Array.isArray(O)||!D)return;let F=0;for(let z=0;z<O.length;z+=1){const J=O[z];(J&&typeof J.name=="string"?J.name:"")!==D&&(O[F]=J,F+=1)}F<O.length&&(O.length=F)}function U(O,D,F){const z=q(O);if(m&&typeof m.queueModuleRegistration=="function")try{if(m.queueModuleRegistration(z||O,D,F,v))return!0}catch{}if(k&&typeof k.queueModuleRegistration=="function")try{if(k.queueModuleRegistration(z||O,D,F,v))return!0}catch{}if(C&&typeof C.queueModuleRegistration=="function")try{if(C.queueModuleRegistration(z||O,D,F))return!0}catch{}if(I&&typeof I.queueModuleRegistration=="function")return I.queueModuleRegistration(z||O,D,F,v);if(!v||typeof v!="object"||!z)return!1;const J=Object.freeze({name:z,api:D,options:Object.freeze(N(F))});let Q=v[P];if(!Array.isArray(Q))try{Object.defineProperty(v,P,{configurable:!0,enumerable:!1,writable:!0,value:[]}),Q=v[P]}catch{try{Array.isArray(v[P])||(v[P]=[]),Q=v[P]}catch{return!1}}Z(Q,z);try{Q.push(J)}catch{Q[Q.length]=J}return!0}function K(O,D,F){if(!T||typeof T.register!="function")return{ok:!1,error:null,reason:"missing-registry"};const z=typeof O=="string"?O:"";if(!z)return{ok:!1,error:new TypeError("cineRuntime expected a module name."),reason:"invalid-name"};if(typeof T.has=="function")try{if(T.has(z)){if(typeof T.get=="function")try{const J=T.get(z);J&&_(z,J)}catch(J){}return{ok:!0,alreadyRegistered:!0}}}catch(J){return{ok:!1,error:J,reason:"registry-check-failed"}}try{const J=T.register(z,D,F);return _(z,J||D),{ok:!0,registered:!0}}catch(J){return{ok:!1,error:J,reason:"register-failed"}}}function H(O,D,F,z){if(m&&typeof m.registerModule=="function")return m.registerModule(O,D,F,v,z)?(_(O,D),!0):!1;let J=null;const Q=K(O,D,F);if(Q.ok)return!0;J=Q.error||null;const le=ve({warn:!1});if(le&&(le.flushed&&le.flushed.processed>0||le.ok)){const Ee=K(O,D,F);if(Ee.ok)return!0;Ee.error&&(J=Ee.error)}if(J&&typeof z=="function")try{z(J)}catch{}return U(O,D,F),!1}const te=(function(){return m&&typeof m.registerModule=="function"?function(F,z,J,Q){return m.registerModule(F,z,J,v,Q)?(_(F,z),!0):!1}:k&&typeof k.registerOrQueueModule=="function"?function(F,z,J,Q){try{if(k.registerOrQueueModule(F,z,J,Q,v,T))return!0}catch{}return H(F,z,J,Q)}:C&&typeof C.registerOrQueueModule=="function"?function(F,z,J,Q){try{if(C.registerOrQueueModule(F,z,J,Q,v,T))return!0}catch{}return H(F,z,J,Q)}:I&&typeof I.registerOrQueueModule=="function"?function(F,z,J,Q){return I.registerOrQueueModule(F,z,J,Q,v,T)}:H})();function re(O){if(!O||typeof process>"u"||!process)return!1;if(O===process)return!0;if(typeof O=="object"){try{if(O.constructor&&O.constructor.name==="process")return!0}catch{}if(typeof O.pid=="number"&&typeof O.nextTick=="function"&&typeof O.emit=="function"&&typeof O.binding=="function")return!0}if(typeof O=="function"){if(O===process.binding||O===process._linkedBinding||O===process.dlopen)return!0;try{const D=O.name||"";if(D&&(D==="binding"||D==="dlopen")){const F=Function.prototype.toString.call(O);if(F&&F.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function fe(O){if(!O||typeof O=="function"||typeof O!="object"&&typeof O!="function")return!1;if(re(O)||typeof process<"u"&&process&&process.release&&process.release.name==="node")return!0;try{if(typeof module<"u"&&module&&typeof module.constructor=="function"&&O instanceof module.constructor)return!0}catch{}try{if(typeof O.pipe=="function"&&typeof O.unpipe=="function")return!0;if(typeof O.on=="function"&&typeof O.emit=="function"){if(typeof O.write=="function"||typeof O.read=="function")return!0;const D=O.constructor&&O.constructor.name;if(D&&/Stream|Emitter|Port/i.test(D))return!0}if(typeof Symbol<"u"&&O[Symbol.toStringTag]){const D=O[Symbol.toStringTag];if(typeof D=="string"&&/Stream|Port/i.test(D))return!0}}catch{}return!1}const Oe=typeof WeakSet=="function"?new WeakSet:null;function Te(O){if(O&&typeof O.has=="function"&&typeof O.add=="function")return O;if(Array.isArray(O))return{has(F){return O.indexOf(F)!==-1},add(F){O.indexOf(F)===-1&&O.push(F)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const D=[];return{has(F){return D.indexOf(F)!==-1},add(F){D.indexOf(F)===-1&&D.push(F)}}}function Ne(O,D){if(!O||typeof O!="object"||fe(O))return O;if(typeof process<"u"&&process&&LD&&LD.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(O)}catch{}return O}if(Oe&&Oe.has(O))return O;const F=Te(D);if(F.has(O))return O;F.add(O);let z=!1;if(typeof Object.isFrozen=="function")try{z=Object.isFrozen(O)}catch{z=!1}let J=[];try{J=Object.getOwnPropertyNames(O)}catch{if(typeof Reflect<"u"&&typeof Reflect.ownKeys=="function")try{J=Reflect.ownKeys(O).filter(function(Ee){return typeof Ee=="string"})}catch{J=[]}}for(let Q=0;Q<J.length;Q+=1){const le=J[Q];if(le==="web3"&&O===v)continue;let Ee=!0;try{Ee=Object.prototype.hasOwnProperty.call(O,le)}catch{Ee=!0}if(!Ee)continue;let pe;try{pe=O[le]}catch{pe=void 0}if(!(!pe||typeof pe=="function"||typeof pe!="object"&&typeof pe!="function"))try{Ne(pe,F)}catch{}}if(z){if(Oe)try{Oe.add(O)}catch{}return O}try{const Q=Object.freeze(O);if(Oe)try{Oe.add(Q||O)}catch(le){}return Q}catch{return O}}const Ie=(function(){return m&&typeof m.freezeDeep=="function"?m.freezeDeep:k&&typeof k.freezeDeep=="function"?k.freezeDeep:C&&typeof C.freezeDeep=="function"?function(F,z){try{return C.freezeDeep(F,z)}catch{return Ne(F,z)}}:I&&typeof I.freezeDeep=="function"?I.freezeDeep:Ne})();function et(O){if(!O||typeof O!="object"&&typeof O!="function")return O;try{typeof Object.preventExtensions=="function"&&Object.preventExtensions(O)}catch{}try{typeof Object.seal=="function"&&Object.seal(O)}catch{}const D=[];try{const F=Object.getOwnPropertyNames(O);for(let z=0;z<F.length;z+=1)D.push(F[z])}catch{}if(typeof Object.getOwnPropertySymbols=="function")try{const F=Object.getOwnPropertySymbols(O);for(let z=0;z<F.length;z+=1)D.push(F[z])}catch{}for(let F=0;F<D.length;F+=1){const z=D[F];let J;try{J=Object.getOwnPropertyDescriptor(O,z)}catch{J=null}if(!J||!(J.configurable===!0||"writable"in J&&J.writable===!0))continue;const le={configurable:!1,enumerable:!!J.enumerable};Object.prototype.hasOwnProperty.call(J,"value")?(le.value=J.value,le.writable=!1):(le.get=J.get,le.set=J.set);try{Object.defineProperty(O,z,le)}catch{}}return O}function Ze(O){const D=Ie(O);if(Object.isFrozen(D))return D;try{const F=Object.freeze(D);if(Object.isFrozen(F))return F}catch{}return et(D),D}function Ft(O,D){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof D>"u"?console.warn(O):console.warn(O,D)}catch{}}const Ye=(function(){return m&&typeof m.safeWarn=="function"?m.safeWarn:k&&typeof k.safeWarn=="function"?k.safeWarn:C&&typeof C.safeWarn=="function"?function(F,z){try{C.safeWarn(F,z)}catch{Ft(F,z)}}:I&&typeof I.safeWarn=="function"?I.safeWarn:Ft})();function ct(O,D){if(!O||typeof O!="object"&&typeof O!="function")return{ok:!1,reason:"invalid-scope"};const F=D||T;if(!F)return{ok:!1,reason:"missing-registry"};try{return O.cineModules===F?{ok:!0,already:!0}:(Object.defineProperty(O,"cineModules",{configurable:!0,enumerable:!1,value:F,writable:!1}),{ok:!0,updated:!0})}catch(z){try{if(O.cineModules=F,O.cineModules===F)return{ok:!0,updated:!0}}catch(J){return{ok:!1,reason:"expose-failed",error:J||z}}}return{ok:!0,updated:!0}}function Y(O,D){if(!O||typeof O!="object"&&typeof O!="function")return null;try{const F=O[D];return Array.isArray(F)?F:null}catch{return null}}function ee(O,D){if(!Array.isArray(O))return;const F=D&&typeof D.name=="string"?D.name:"";F&&Z(O,F);try{O.push(D)}catch{O[O.length]=D}}function Ae(O={}){const D=O.registry||T,F=typeof O.queueKey=="string"&&O.queueKey?O.queueKey:P;if(!D||typeof D.register!="function")return Ze({ok:!1,processed:0,requeued:0,scopes:0,queueKey:F,failures:Ze([{reason:"missing-registry"}])});const z=Array.isArray(O.scopes)&&O.scopes.length>0?O.scopes.slice():R(O.scope||v);let J=0,Q=0,le=0;const Ee=[];for(let pe=0;pe<z.length;pe+=1){const ne=z[pe],Se=Y(ne,F);if(!Se||Se.length===0)continue;le+=1;const Le=Se.slice();Se.length=0;for(let ke=0;ke<Le.length;ke+=1){const We=Le[ke];if(!We||typeof We!="object")continue;const nt=typeof We.name=="string"?We.name:"";if(!nt)continue;const it=We.api,Et=N(We.options);if(typeof D.has=="function"){let yr=!1;try{yr=D.has(nt)}catch(hr){Ee.push({name:nt,message:hr&&typeof hr.message=="string"?hr.message:null,reason:"has-check-failed",scopeIndex:pe})}if(yr){J+=1;continue}}try{const yr=D.register(nt,it,Et);_(nt,yr||it),J+=1}catch(yr){Q+=1,ee(Se,We),Ee.push({name:nt,message:yr&&typeof yr.message=="string"?yr.message:null,reason:"register-failed",scopeIndex:pe})}}}return Ee.length>0&&O.warn&&Ye("cineRuntime.flushPendingModuleQueues() encountered issues while replaying module registrations.",Ee),Ze({ok:Ee.length===0,processed:J,requeued:Q,scopes:le,queueKey:F,failures:Ee.length>0?Ze(Ee):Ze([])})}function ve(O={}){const D=O.registry||T,F=typeof O.queueKey=="string"&&O.queueKey?O.queueKey:P,z=Array.isArray(O.scopes)&&O.scopes.length>0?O.scopes.slice():R(O.scope||v),J=[],Q=[];for(let ne=0;ne<z.length;ne+=1){const Se=z[ne],Le=ct(Se,D);J.push({scopeIndex:ne,ok:!!Le.ok,updated:!!Le.updated,already:!!Le.already,reason:typeof Le.reason=="string"?Le.reason:null}),!Le.ok&&Le.reason!=="missing-registry"&&Q.push({scopeIndex:ne,reason:Le.reason||"expose-failed",message:Le.error&&typeof Le.error.message=="string"?Le.error.message:null})}Q.length>0&&O.warn!==!1&&Ye("cineRuntime.synchronizeModuleLinks() could not expose cineModules on every scope.",Q);const le=Ae({registry:D,queueKey:F,scopes:z,warn:O.warn!==!1}),Ee=[];if(Array.isArray(le.failures))for(let ne=0;ne<le.failures.length;ne+=1)Ee.push(le.failures[ne]);if(Q.length>0)for(let ne=0;ne<Q.length;ne+=1)Ee.push(Q[ne]);const pe={ok:le.ok&&Q.length===0,queueKey:F,exposures:J,flushed:le,failures:Ee};return Ze(pe)}const se=ve({warn:!1});function de(O={}){const D=O.registry||T;if(!D||typeof D.list!="function"||typeof D.describe!="function")return Ze({ok:!1,reason:"missing-registry",modules:[],missingConnections:[],errors:[]});let F;try{F=D.list()}catch(pe){return Ze({ok:!1,reason:"list-failed",modules:[],missingConnections:[],errors:Ze([{type:"list",message:pe&&typeof pe.message=="string"?pe.message:null}])})}const z=Array.isArray(F)?F.slice():[],J=[],Q=[],le=[],Ee=typeof D.has=="function"?function(ne){try{return D.has(ne)}catch(Se){return le.push({type:"has",module:ne,message:Se&&typeof Se.message=="string"?Se.message:null}),z.indexOf(ne)!==-1}}:function(ne){return z.indexOf(ne)!==-1};for(let pe=0;pe<z.length;pe+=1){const ne=z[pe];let Se=null;try{Se=D.describe(ne)}catch(nt){le.push({type:"describe",module:ne,message:nt&&typeof nt.message=="string"?nt.message:null})}const Le=new Set,ke=[],We=[];if(Se&&Se.connections&&typeof Se.connections[Symbol.iterator]=="function")for(const nt of Se.connections){if(typeof nt!="string")continue;const it=nt.trim();!it||Le.has(it)||(Le.add(it),ke.push(it),Ee(it)||(We.push(it),Q.push({from:ne,to:it})))}J.push(Ze({name:ne,connections:ke,missing:We,ok:We.length===0}))}return Ze({ok:Q.length===0,modules:J,missingConnections:Q,errors:le})}function be(O,D){if(!v||typeof v!="object")return!1;try{return Object.defineProperty(v,O,{configurable:!0,enumerable:!1,value:D,writable:!1}),!0}catch{try{return v[O]=D,!0}catch{return!1}}}const ye=(function(){return m&&typeof m.exposeGlobal=="function"?function(F,z,J){try{return m.exposeGlobal(F,z,v,J)}catch{return be(F,z)}}:k&&typeof k.exposeGlobal=="function"?function(F,z,J){try{return k.exposeGlobal(F,z,J)}catch{return be(F,z)}}:C&&typeof C.exposeGlobal=="function"?function(F,z,J){try{return C.exposeGlobal(F,z,J)}catch{return be(F,z)}}:I&&typeof I.exposeGlobal=="function"?function(F,z,J){return I.exposeGlobal(F,z,v,J)}:be})(),$e=["cinePersistence","cineOffline","cineUi"],xe=["storage.loadDeviceData","storage.saveDeviceData","storage.loadSetups","storage.saveSetups","storage.saveSetup","storage.loadSetup","storage.deleteSetup","storage.renameSetup","storage.loadSessionState","storage.saveSessionState","storage.saveProject","storage.loadProject","storage.deleteProject","storage.exportAllData","storage.importAllData","storage.clearAllData","storage.loadFavorites","storage.saveFavorites","storage.loadFeedback","storage.saveFeedback","storage.loadAutoGearRules","storage.saveAutoGearRules","storage.loadAutoGearBackups","storage.saveAutoGearBackups","storage.loadAutoGearSeedFlag","storage.saveAutoGearSeedFlag","storage.loadAutoGearBackupRetention","storage.saveAutoGearBackupRetention","storage.getAutoGearBackupRetentionDefault","storage.loadAutoGearPresets","storage.saveAutoGearPresets","storage.loadAutoGearActivePresetId","storage.saveAutoGearActivePresetId","storage.loadAutoGearAutoPresetId","storage.saveAutoGearAutoPresetId","storage.loadAutoGearMonitorDefaults","storage.saveAutoGearMonitorDefaults","storage.loadAutoGearBackupVisibility","storage.saveAutoGearBackupVisibility","storage.loadFullBackupHistory","storage.saveFullBackupHistory","storage.recordFullBackupHistoryEntry","storage.requestPersistentStorage","storage.clearUiCacheStorageEntries","storage.ensureCriticalStorageBackups","storage.getLastCriticalStorageGuardResult","autosave.saveSession","autosave.autoSaveSetup","autosave.saveGearList","autosave.restoreSessionState","backups.collectFullBackupData","backups.createSettingsBackup","backups.captureStorageSnapshot","backups.sanitizeBackupPayload","backups.autoBackup","backups.formatFullBackupFilename","backups.downloadPayload","backups.recordFullBackupHistoryEntry","restore.proceed","restore.abort","share.downloadProject","share.encodeSharedSetup","share.decodeSharedSetup","share.applySharedSetup","share.applySharedSetupFromUrl"],St=["registerServiceWorker","reloadApp"],Tt=[{name:"deviceManagerSection",actions:["show","hide","toggle"]},{name:"shareDialog",actions:["open","submit","cancel","dismiss"]},{name:"sharedImportDialog",actions:["submit","cancel","dismiss","changeMode"]},{name:"backupSettings",actions:["execute"]},{name:"restoreSettings",actions:["openPicker","processFile"]}],xt=["saveSetup","deleteSetup","shareOpen","shareSubmit","shareCancel","shareApplyFile","shareInputChange","sharedImportSubmit","sharedImportCancel","performBackup","openRestorePicker","applyRestoreFile"],ut=["saveSetup","autoBackupBeforeDeletion","shareProject","sharedImport","backupSettings","restoreSettings"];function Er(O){if(!O||!$e.includes(O))throw new TypeError(`cineRuntime cannot resolve unknown module "${O}".`);if(T&&typeof T.get=="function")try{const D=T.get(O);if(D)return D}catch{}if(v&&typeof v=="object")try{const D=v[O];if(D)return D}catch{}switch(O){case"cinePersistence":return w("./persistence.js");case"cineOffline":return w("./offline.js");case"cineUi":return w("./ui.js");default:return null}}function zt(O,D={}){const F=Er(O);if(!F&&D.optional)return null;if(!F)throw new Error(`cineRuntime could not locate ${O}.`);return F}function dr(O){if(Array.isArray(O))return O.slice();if(typeof O=="string"&&O.trim())return O.split(".");throw new TypeError("cineRuntime expected check paths to be strings or arrays.")}function Jt(O,D,F,z,J){const Q=dr(D);let le=O,Ee=`${J}`;for(let Se=0;Se<Q.length;Se+=1){const Le=Q[Se];if(Ee=Ee?`${Ee}.${Le}`:Le,!le||typeof le!="object"&&typeof le!="function"){F.push(Ee),z[Ee]=!1;return}le=le[Le]}const pe=`${J}.${Q.join(".")}`,ne=typeof le=="function";ne||F.push(pe),z[pe]=ne}function rr(O,D,F){if(!O||typeof O!="object")return;for(let Q=0;Q<xe.length;Q+=1)Jt(O,xe[Q],D,F,"cinePersistence");const z=O.__internal,J=z&&typeof z.inspectBinding=="function"?z.inspectBinding.bind(z):null;if(!J){const Q="cinePersistence.__internal.inspectBinding";D.push(Q),F[Q]=!1;return}for(let Q=0;Q<xe.length;Q+=1){const le=xe[Q],Ee=dr(le),pe=Ee[Ee.length-1],ne=`cinePersistence.bindings.${pe}`;let Se=null;try{Se=J(pe,{refresh:!0})}catch{Se=null}const Le=!!(Se&&Se.available);Le||D.push(ne),F[ne]=Le,Se&&(F[`${ne}.provider`]=Se.providerName||null)}}function Jn(O,D,F){for(let z=0;z<St.length;z+=1){const J=St[z],Q=O?O[J]:null,le=`cineOffline.${J}`,Ee=typeof Q=="function";Ee||D.push(le),F[le]=Ee}}function nr(O,D,F){const z=O&&O.controllers,J=z&&typeof z.get=="function"?z.get.bind(z):null;for(let Q=0;Q<Tt.length;Q+=1){const le=Tt[Q],Ee=`cineUi.controllers.${le.name}`;if(!J){D.push(Ee),F[Ee]=!1;continue}let pe=null;try{pe=J(le.name)}catch{pe=null}if(!(!!pe&&typeof pe=="object")){D.push(Ee),F[Ee]=!1;continue}F[Ee]=!0;for(let Se=0;Se<le.actions.length;Se+=1){const Le=le.actions[Se],ke=`${Ee}.${Le}`,nt=typeof pe[Le]=="function";nt||D.push(ke),F[ke]=nt}}}function $n(O,D,F){const z=O&&O.interactions,J=z&&typeof z.get=="function"?z.get.bind(z):null;for(let Q=0;Q<xt.length;Q+=1){const le=xt[Q],Ee=`cineUi.interactions.${le}`;if(!J){D.push(Ee),F[Ee]=!1;continue}let pe=null;try{pe=J(le)}catch{pe=null}const ne=typeof pe=="function";ne||D.push(Ee),F[Ee]=ne}}function De(O,D,F){const z=O&&O.help,J=z&&typeof z.resolve=="function"?z.resolve.bind(z):null;for(let Q=0;Q<ut.length;Q+=1){const le=ut[Q],Ee=`cineUi.help.${le}`;if(!J){D.push(Ee),F[Ee]=!1;continue}let pe=null;try{pe=J(le)}catch{pe=null}const ne=typeof pe=="string"&&!!pe.trim();ne||D.push(Ee),F[Ee]=ne}}function vt(){return Ze({cinePersistence:xe.slice(),cineOffline:St.slice(),cineUi:{controllers:Tt.map(O=>({name:O.name,actions:O.actions.slice()})),interactions:xt.slice(),help:ut.slice()}})}function Yt(O={}){const D=ve({warn:O.warnOnFailure}),F=[],z={};D&&typeof D=="object"&&(z["synchronization.ok"]=!!D.ok,Array.isArray(D.failures)&&D.failures.length>0&&(z["synchronization.failures"]=D.failures),D.ok||F.push("cineRuntime synchronization"));let J=null;if(T&&typeof T.assertRegistered=="function")try{J=T.assertRegistered($e)}catch(Le){Ye("cineRuntime.verifyCriticalFlows() could not inspect cineModules registry.",Le)}const Q=Er("cinePersistence"),le=Er("cineOffline"),Ee=Er("cineUi"),pe={cinePersistence:!!Q,cineOffline:!!le,cineUi:!!Ee};if(J&&J.detail){const Le={},ke=Object.keys(J.detail);for(let We=0;We<ke.length;We+=1){const nt=ke[We],it=!!J.detail[nt];Le[nt]=it,z[`${nt}.registered`]=it,it||F.push(`${nt} (not registered)`)}pe.registry=Le}Q?(z.cinePersistence=!0,Object.isFrozen(Q)?z["cinePersistence.frozen"]=!0:(F.push("cinePersistence (not frozen)"),z["cinePersistence.frozen"]=!1),rr(Q,F,z)):(F.push("cinePersistence"),z.cinePersistence=!1),le?(z.cineOffline=!0,Object.isFrozen(le)?z["cineOffline.frozen"]=!0:(F.push("cineOffline (not frozen)"),z["cineOffline.frozen"]=!1),Jn(le,F,z)):(F.push("cineOffline"),z.cineOffline=!1),Ee?(z.cineUi=!0,Object.isFrozen(Ee)?z["cineUi.frozen"]=!0:(F.push("cineUi (not frozen)"),z["cineUi.frozen"]=!1),nr(Ee,F,z),$n(Ee,F,z),De(Ee,F,z)):(F.push("cineUi"),z.cineUi=!1);const ne=F.length===0,Se=Ze({ok:ne,missing:F.slice(),modules:Ze(pe),details:Ze(z),registry:J?Ze(J):null,checks:vt(),synchronization:D});if(!ne&&(O.warnOnFailure&&Ye("cineRuntime.verifyCriticalFlows() detected missing safeguards.",F),O.throwOnFailure)){const Le=new Error("cineRuntime integrity verification failed.");throw Le.details=Se,Le}return Se}const j=Ze({getPersistence(O){return zt("cinePersistence",O)},getOffline(O){return zt("cineOffline",O)},getUi(O){return zt("cineUi",O)},getModuleRegistry(){return T||null},synchronizeModules(O){return ve(O||{})},inspectModuleConnections(O){return de(O||{})},listCriticalChecks:vt,verifyCriticalFlows:Yt,__internal:Ze({resolveModule:Er,ensureModule:zt,listCriticalChecks:vt,moduleRegistry:T||null,synchronizeModuleLinks:ve,flushPendingModuleQueues:Ae,initialSynchronization:se,inspectModuleConnections:de})});if(_("cineRuntime",j),te("cineRuntime",j,{category:"runtime",description:"Runtime orchestrator ensuring persistence, offline, and UI safeguards stay intact.",replace:!0,connections:["cinePersistence","cineOffline","cineUi","cineModuleGlobals","cineModuleContext"]},O=>{Ye("Unable to register cineRuntime module.",O)}),v&&typeof v=="object"){let O=null;try{O=v.cineRuntime||null}catch{O=null}O!==j&&(ye("cineRuntime",j,{configurable:!0,enumerable:!1,writable:!1})||Ye("Unable to expose cineRuntime globally."))}if(typeof module<"u"&&module&&module.exports)if(module.exports&&module.exports!==j&&typeof module.exports=="object"&&Object.keys(module.exports).length>0)try{module.exports.cineRuntime!==j&&Object.defineProperty(module.exports,"cineRuntime",{configurable:!0,enumerable:!1,value:j,writable:!1})}catch(O){Ye("Unable to attach cineRuntime to existing module.exports.",O)}else module.exports=j;return j})();function nb(e){return typeof Array<"u"&&typeof Array.isArray=="function"?Array.isArray(e):Object.prototype.toString.call(e)==="[object Array]"}function RD(e){if(typeof e=="string")return e;if(e===null||typeof e>"u")return"";try{return String(e)}catch{return""}}function iQ(e,t){var r=RD(e),n=RD(t);try{if(typeof r.localeCompare=="function")return r.localeCompare(n,void 0,{sensitivity:"accent",numeric:!0})}catch{}return r<n?-1:r>n?1:0}function iC(e){if(e===null||typeof e>"u")return null;var t=Number(e);if(!Number.isFinite(t))return null;var r=Math.round(t);return Number.isFinite(r)?r:null}function sQ(e){var t=_$(e),r=null,n=[];e&&Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_MAX")&&n.push(e.AUTO_GEAR_BACKUP_RETENTION_MAX),e&&Object.prototype.hasOwnProperty.call(e,"MAX_AUTO_BACKUPS")&&n.push(e.MAX_AUTO_BACKUPS),e&&e.__cineStorageApi&&Object.prototype.hasOwnProperty.call(e.__cineStorageApi,"AUTO_GEAR_BACKUP_RETENTION_MAX")&&n.push(e.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MAX);for(var o=0;o<n.length;o+=1){var a=iC(n[o]);typeof a=="number"&&(a<t&&(a=t),(r===null||a>r)&&(r=a))}return r===null&&(r=Math.max(t,120)),{min:t,max:r}}function _$(e){var t=[];e&&Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_MIN")&&t.push(e.AUTO_GEAR_BACKUP_RETENTION_MIN),e&&e.__cineStorageApi&&Object.prototype.hasOwnProperty.call(e.__cineStorageApi,"AUTO_GEAR_BACKUP_RETENTION_MIN")&&t.push(e.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MIN);for(var r=0;r<t.length;r+=1){var n=iC(t[r]);if(typeof n=="number"&&n>=1)return n<1?1:n}return 1}function lQ(e){var t=sQ(e),r=t.min,n=t.max,o=[];e&&typeof e.getAutoGearBackupRetentionDefault=="function"&&o.push(function(){return e.getAutoGearBackupRetentionDefault()}),e&&e.__cineStorageApi&&typeof e.__cineStorageApi.getAutoGearBackupRetentionDefault=="function"&&o.push(function(){return e.__cineStorageApi.getAutoGearBackupRetentionDefault()}),o.push(function(){return e&&Object.prototype.hasOwnProperty.call(e,"AUTO_GEAR_BACKUP_RETENTION_DEFAULT")?e.AUTO_GEAR_BACKUP_RETENTION_DEFAULT:null});for(var a=0;a<o.length;a+=1)try{var i=o[a](),s=iC(i);if(typeof s=="number")return s<r?s=r:s>n&&(s=n),s}catch{}var l=iC(36);return typeof l!="number"&&(l=r),l<r&&(l=r),l>n&&(l=n),l}(function(){var t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof t!="object"&&typeof t!="function")return;function r(s,l){var c;try{c=t[s]}catch{c=void 0}typeof c!="string"&&(c=l);try{t[s]=c}catch{}return c}function n(s){var l;try{l=t[s]}catch{l=void 0}nb(l)||(l=[]);try{t[s]=l}catch{}return l}function o(s,l){var c;try{c=t[s]}catch{c=void 0}typeof c!="function"&&(c=l);try{t[s]=c}catch{}return c}function a(s){var l;try{l=t[s]}catch{l=void 0}typeof l>"u"&&(l=null);try{t[s]=l}catch{}return l}function i(s){if(!s||typeof s!="object")return"";var l;try{l=Object.keys(s)}catch{return""}if(!l||!l.length)return"";var c=l[0],u=s[c],f=typeof c=="string"?c.replace(/_/g," "):"connector";return u?f+": "+u:f}r("autoGearAutoPresetId",""),n("baseAutoGearRules"),a("autoGearScenarioModeSelect"),a("autoGearRuleNameInput"),r("autoGearSummaryFocus","all"),n("autoGearMonitorDefaultControls"),a("iosPwaHelpDialog"),a("iosPwaHelpClose"),a("totalPowerElem"),o("safeGenerateConnectorSummary",i),a("CORE_RUNTIME_SHARED"),a("CORE_GLOBAL_SCOPE"),a("autoGearAddOwnGearSelect"),a("autoGearRemoveOwnGearSelect"),a("newSubcategorySelect"),o("syncAutoGearMonitorFieldVisibility",function(){}),r("currentLang","en"),o("localeSort",iQ),o("resolveAutoGearBackupRetentionMin",function(){var s=_$(t);if(t&&(typeof t.AUTO_GEAR_BACKUP_RETENTION_MIN!="number"||!Number.isFinite(t.AUTO_GEAR_BACKUP_RETENTION_MIN)))try{t.AUTO_GEAR_BACKUP_RETENTION_MIN=s}catch{}return s}),o("resolveAutoGearBackupRetentionDefault",function(){var s=lQ(t);if(t&&(typeof t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT!="number"||!Number.isFinite(t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT)))try{t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT=s}catch{}return s})})();function Ga(e,t){var r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!r||typeof r!="object"&&typeof r!="function")return t;var n;try{n=r[e]}catch{n=void 0}return typeof n>"u"?t:n}function Nr(e,t){var r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!r||typeof r!="object"&&typeof r!="function")return t;try{r[e]=t}catch{}return t}function D$(e,t){var r=t;try{var n=Ga(e,t);typeof n=="number"&&Number.isFinite(n)&&(r=n)}catch{r=t}try{Nr(e,r)}catch{}try{typeof Function=="function"&&Function("value","try { if (typeof "+e+" === 'undefined') { "+e+" = value; } } catch (e) { void e; } return value;")(r)}catch{}return r}var rT=typeof rT<"u"&&typeof rT=="string"?rT:(function(){var t=Ga("autoGearAutoPresetId",""),r=typeof t=="string"?t:"";return Nr("autoGearAutoPresetId",r)})(),nT=typeof nT<"u"&&nb(nT)?nT:(function(){var t=Ga("baseAutoGearRules",[]),r=nb(t)?t:[];return Nr("baseAutoGearRules",r)})(),DS=typeof DS<"u"&&(DS===null||typeof DS=="object")?DS:(function(){var t=Ga("autoGearScenarioModeSelect",null),r=typeof t>"u"||t===null||typeof t=="object"?t:null;return Nr("autoGearScenarioModeSelect",r)})(),NS=typeof NS<"u"&&(NS===null||typeof NS=="object")?NS:(function(){var t=Ga("autoGearRuleNameInput",null),r=typeof t>"u"||t===null||typeof t=="object"?t:null;return Nr("autoGearRuleNameInput",r)})(),oT=typeof oT<"u"&&typeof oT=="string"?oT:(function(){var t=Ga("autoGearSummaryFocus","all"),r=typeof t=="string"?t:"all";return Nr("autoGearSummaryFocus",r)})(),aT=typeof aT<"u"&&nb(aT)?aT:(function(){var t=Ga("autoGearMonitorDefaultControls",[]),r=nb(t)?t:[];return Nr("autoGearMonitorDefaultControls",r)})(),iT=typeof iT<"u"&&typeof iT=="function"?iT:(function(){var t=Ga("safeGenerateConnectorSummary",null),r=typeof t=="function"?t:function(o){if(!o||typeof o!="object")return"";var a;try{a=Object.keys(o)}catch{return""}if(!a||!a.length)return"";var i=a[0],s=o[i],l=typeof i=="string"?i.replace(/_/g," "):"connector";return s?l+": "+s:l};return Nr("safeGenerateConnectorSummary",r)})(),TD=typeof TD=="function"?TD:(function(){var t=null;if(typeof Intl<"u"&&Intl&&typeof Intl.Collator=="function")try{t=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0})}catch{t=null}var r=t?function(o,a){return t.compare(o==null?"":String(o),a==null?"":String(a))}:function(o,a){var i=o==null?"":String(o),s=a==null?"":String(a);return i===s?0:i<s?-1:1};return Nr("localeSort",r)})(),Jk=typeof Jk=="function"?Jk:(function(){var t=1;function r(o){var a=Number(o);if(!Number.isFinite(a)||a<=0)return t;var i=Math.round(a);return i>0?i:t}function n(){var o=Ga("AUTO_GEAR_BACKUP_RETENTION_MIN",void 0),a=r(o);return Nr("AUTO_GEAR_BACKUP_RETENTION_MIN",a),a}return Nr("resolveAutoGearBackupRetentionMin",n)})(),OD=typeof OD=="function"?OD:(function(){function t(n){var o=Jk(),a=Ga("AUTO_GEAR_BACKUP_RETENTION_MAX",void 0),i=Number.isFinite(Number(a)),s=i?Math.max(Math.round(Number(a)),o):null,l=Number(n);if(!Number.isFinite(l))return o;var c=Math.round(l);return c<o?o:i&&s!==null&&c>s?s:c}function r(){var n=Ga("AUTO_GEAR_BACKUP_RETENTION_DEFAULT",void 0),o=t(n);return Nr("AUTO_GEAR_BACKUP_RETENTION_DEFAULT",o),o}return Nr("resolveAutoGearBackupRetentionDefault",r)})(),xD=typeof xD<"u"?xD:Nr("CORE_RUNTIME_SHARED",null),kD=typeof kD<"u"?kD:Nr("CORE_GLOBAL_SCOPE",null),ID=typeof ID<"u"?ID:Nr("autoGearAddOwnGearSelect",null),PD=typeof PD<"u"?PD:Nr("autoGearRemoveOwnGearSelect",null),sT=typeof sT<"u"&&typeof sT=="string"?sT:Nr("currentLang","en"),BD=typeof BD=="function"?BD:(function(){function t(a){if(typeof a=="string"&&a)try{return a.trim().toLowerCase()}catch{}return""}function r(){var a=Ga("DEFAULT_LANGUAGE",null);return typeof a=="string"&&a?a:"en"}function n(){var a=Ga("texts",null);return a&&typeof a=="object"?a:{}}function o(a){var i=n();if(!i||typeof i!="object")return{};var s=t(a),l=r(),c=t(l);if(s&&Object.prototype.hasOwnProperty.call(i,s)){var u=i[s];if(u&&typeof u=="object")return u}if(s&&s.length>2){var f=s.slice(0,2);if(Object.prototype.hasOwnProperty.call(i,f)){var d=i[f];if(d&&typeof d=="object")return d}}if(c&&Object.prototype.hasOwnProperty.call(i,c)){var p=i[c];if(p&&typeof p=="object")return p}if(Object.prototype.hasOwnProperty.call(i,"en")){var h=i.en;if(h&&typeof h=="object")return h}var m=null;try{for(var g in i)if(Object.prototype.hasOwnProperty.call(i,g)){m=g;break}}catch{}if(m){var S=i[m];if(S&&typeof S=="object")return S}return{}}return Nr("getLanguageTexts",o)})(),GD=typeof GD=="function"?GD:(function(){function t(n){if(typeof n=="string"){try{const o=n.trim();if(o)return o}catch{}return""}if(typeof n=="number"&&Number.isFinite(n))return String(n);if(Array.isArray(n)){const o=n.map(a=>typeof a=="string"?a.trim():typeof a=="number"&&Number.isFinite(a)?String(a):"").filter(Boolean);if(o.length)return o.join(", ")}return""}function r(n,o,a,i){const s=[];n&&typeof n=="object"&&s.push(n),o&&typeof o=="object"&&o!==n&&s.push(o);for(let l=0;l<s.length;l+=1){const c=s[l];if(!c||typeof c!="object")continue;let u;try{u=c[a]}catch{u=void 0}const f=t(u);if(f)return f}return typeof i=="string"?i:typeof i=="number"&&Number.isFinite(i)?String(i):""}return Nr("resolveTextEntry",r)})(),XE=typeof XE=="string"&&XE?XE:Nr("TEMPERATURE_STORAGE_KEY","cameraPowerPlanner_temperatureUnit"),MD=typeof MD=="function"?MD:Nr("resolveTemperatureStorageKey",function(){return XE});function _D(e){const t={};return e&&typeof e=="object"&&(typeof e.celsius=="string"&&e.celsius.trim()&&(t.celsius=e.celsius.trim().toLowerCase()),typeof e.fahrenheit=="string"&&e.fahrenheit.trim()&&(t.fahrenheit=e.fahrenheit.trim().toLowerCase())),t.celsius||(t.celsius="celsius"),t.fahrenheit||(t.fahrenheit="fahrenheit"),t}(function(){var t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,r=null;try{r=t&&typeof t.TEMPERATURE_UNITS=="object"?t.TEMPERATURE_UNITS:null}catch{r=null}var n=_D(r||{celsius:"celsius",fahrenheit:"fahrenheit"});try{Nr("TEMPERATURE_UNITS",n)}catch{}try{typeof Function=="function"&&Function("value","try { TEMPERATURE_UNITS = value; } catch (error) { try { this.TEMPERATURE_UNITS = value; } catch (assignError) { void assignError; } } return (typeof TEMPERATURE_UNITS !== 'undefined' ? TEMPERATURE_UNITS : this && this.TEMPERATURE_UNITS);").call(t||null,n)}catch{}})();function cQ(e){if(!Array.isArray(e))return[];const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];if(!n||typeof n!="object")continue;const o={};typeof n.id=="string"&&n.id.trim()&&(o.id=n.id.trim()),typeof n.key=="string"&&n.key.trim()&&(o.key=n.key.trim()),typeof n.label=="string"&&n.label.trim()&&(o.label=n.label.trim()),Object.keys(o).length&&t.push(o)}return t}(function(){var t=[];try{var r=Ga("TEMPERATURE_SCENARIOS",[]);Array.isArray(r)&&(t=cQ(r))}catch{}try{Nr("TEMPERATURE_SCENARIOS",t)}catch{}try{typeof Function=="function"&&Function("value","try { this.TEMPERATURE_SCENARIOS = value; } catch (assignError) { void assignError; } return this && this.TEMPERATURE_SCENARIOS;").call(typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t)}catch{}})();D$("FEEDBACK_TEMPERATURE_MIN",-20);D$("FEEDBACK_TEMPERATURE_MAX_LIMIT",50);var lT=typeof lT=="string"&&lT?lT:Nr("FOCUS_SCALE_STORAGE_KEY","cameraPowerPlanner_focusScale"),cT=typeof cT<"u"&&Array.isArray(cT)?Nr("FOCUS_SCALE_VALUES",cT.slice()):Nr("FOCUS_SCALE_VALUES",["metric","imperial"]),fh=typeof fh<"u"&&Array.isArray(fh)?Nr("SUPPORTED_MOUNT_VOLTAGE_TYPES",fh.slice()):Nr("SUPPORTED_MOUNT_VOLTAGE_TYPES",["V-Mount","Gold-Mount","B-Mount"]);function DD(e){const t={},r=Array.isArray(fh)?fh:["V-Mount","Gold-Mount","B-Mount"];for(let n=0;n<r.length;n+=1){const o=r[n],a=e&&e[o]?e[o]:null,i=a&&typeof a.high=="number"&&Number.isFinite(a.high)?a.high:o==="B-Mount"?33.6:14.4,s=a&&typeof a.low=="number"&&Number.isFinite(a.low)?a.low:o==="B-Mount"?21.6:12;t[o]={high:i,low:s}}return t}var FS=typeof FS<"u"&&FS&&typeof FS=="object"?Nr("DEFAULT_MOUNT_VOLTAGES",DD(FS)):Nr("DEFAULT_MOUNT_VOLTAGES",DD({})),jS=typeof jS<"u"&&jS&&typeof jS=="object"?Nr("MOUNT_VOLTAGE_RUNTIME_EXPORTS",jS):Nr("MOUNT_VOLTAGE_RUNTIME_EXPORTS",{});(function(){var t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof t!="object"&&typeof t!="function")return;var r="cameraPowerPlanner_mountVoltages",n="__cineMountVoltageSessionState",o="__cineMountVoltageSyncTimer";function a(){var w=null;try{w=t.MOUNT_VOLTAGE_RUNTIME_EXPORTS}catch{w=null}return w&&typeof w=="object"?w:null}function i(w){var x=a();return x&&typeof x[w]=="function"?x[w]:null}function s(w,x){if(typeof x=="function"&&typeof t[w]!="function"){try{t[w]=x;return}catch{}try{Object.defineProperty(t,w,{configurable:!0,writable:!0,value:x})}catch{}}}function l(){var w;try{w=t.SUPPORTED_MOUNT_VOLTAGE_TYPES}catch{w=null}return Array.isArray(w)&&w.length?w.slice():["V-Mount","Gold-Mount","B-Mount"]}function c(){var w;try{w=t.DEFAULT_MOUNT_VOLTAGES}catch{w=null}if(w&&typeof w=="object")return w;for(var x={},G=l(),T=0;T<G.length;T+=1){var P=G[T];P==="B-Mount"?x[P]={high:33.6,low:21.6}:x[P]={high:14.4,low:12}}return x}function u(w){if(!Number.isFinite(w))return 0;var x=Math.min(1e3,Math.max(.1,w));return Math.round(x*100)/100}function f(w,x){if(typeof w=="number")return u(w);if(typeof w=="string"){var G=w.replace(",","."),T=Number.parseFloat(G);if(Number.isFinite(T))return u(T)}if(typeof x=="number")return u(x);if(typeof x=="string"){var P=Number.parseFloat(x.replace(",","."));if(Number.isFinite(P))return u(P)}return 0}function d(w){for(var x=c(),G=l(),T={},P=0;P<G.length;P+=1){var N=G[P],q=w&&w[N]?w[N]:x[N],Z=x[N]||{high:0,low:0};T[N]={high:f(q&&q.high,Z.high),low:f(q&&q.low,Z.low)}}return T}function p(w){return d(!w||typeof w!="object"?null:w)}function h(){var w="",x="";try{w=typeof t.getMountVoltageStorageKeyName=="function"&&t.getMountVoltageStorageKeyName()||typeof t.MOUNT_VOLTAGE_STORAGE_KEY=="string"&&t.MOUNT_VOLTAGE_STORAGE_KEY||typeof t.MOUNT_VOLTAGE_STORAGE_KEY_RESOLVED=="string"&&t.MOUNT_VOLTAGE_STORAGE_KEY_RESOLVED||r}catch{w=r}try{x=typeof t.getMountVoltageStorageBackupKeyName=="function"&&t.getMountVoltageStorageBackupKeyName()||typeof t.MOUNT_VOLTAGE_STORAGE_BACKUP_KEY=="string"&&t.MOUNT_VOLTAGE_STORAGE_BACKUP_KEY||typeof t.MOUNT_VOLTAGE_STORAGE_BACKUP_KEY_RESOLVED=="string"&&t.MOUNT_VOLTAGE_STORAGE_BACKUP_KEY_RESOLVED||(w?w+"__backup":r+"__backup")}catch{x=w?w+"__backup":r+"__backup"}return w||(w=r),x||(x=w+"__backup"),{primary:w,backup:x}}function m(w){var x=null;try{x=t.localStorage}catch{x=null}if(!x||typeof x.setItem!="function")return!1;var G;try{G=JSON.stringify(w)}catch(P){return t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage fallback: unable to serialize preferences.",P),!1}var T=h();try{x.setItem(T.primary,G)}catch(P){t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage fallback: unable to persist primary preferences.",P)}try{x.setItem(T.backup,G)}catch(P){t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage fallback: unable to persist backup preferences.",P)}return!0}function g(w){if(!w)return null;try{if(typeof w=="string"){var x=JSON.parse(w);return p(x)}if(typeof w=="object")return p(w)}catch(G){t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage fallback: unable to parse stored voltages.",G)}return null}function S(){var w=null;try{w=t[n]}catch{w=null}!w||typeof w!="object"?w={preferences:d(null),pendingPersist:!1,pendingUpdate:!1}:!w.preferences||typeof w.preferences!="object"?w.preferences=d(null):w.preferences=d(w.preferences);try{t[n]=w}catch{}return w}var y=S();function E(){if(!(!y.pendingPersist&&!y.pendingUpdate)){var w=null;try{w=t.setTimeout}catch{w=null}if(typeof w!="function")try{w=setTimeout}catch{w=null}if(typeof w=="function"){var x=null;try{x=t[o]}catch{x=null}if(!x){var G=function(){try{t[o]=null}catch{}var P=a(),N=P&&typeof P.applyMountVoltagePreferences=="function"?P.applyMountVoltagePreferences:null,q=P&&typeof P.cloneMountVoltageMap=="function"?P.cloneMountVoltageMap:null;if(!N||!q){E();return}var Z=y.preferences;try{Z=q(y.preferences)}catch{}try{N(Z,{persist:y.pendingPersist,triggerUpdate:y.pendingUpdate}),y.pendingPersist=!1,y.pendingUpdate=!1}catch(U){t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage fallback: runtime sync failed.",U),E()}},T=w(G,50);try{t[o]=T}catch{}}}}}function L(w,x){var G=function(){var T=i(w);if(T){try{t[w]===G&&(t[w]=T)}catch{}var P=a()||t;try{return T.apply(P,arguments)}catch(N){t.console&&typeof t.console.warn=="function"&&t.console.warn("Mount voltage delegate: runtime helper invocation failed.",N)}}return x.apply(this,arguments)};return G}var v=function(w){var x=i("cloneMountVoltageMap");return x?x(w):d(w)},A=function(){var w=i("getMountVoltagePreferencesClone");if(w)return w();var x=d(y.preferences);return y.preferences=d(x),d(x)},R=function(w,x){var G=i("applyMountVoltagePreferences");if(G)return G(w,x);var T=p(w);y.preferences=d(T);var P=!x||x.persist!==!1,N=!x||x.triggerUpdate!==!1;return P&&(m(y.preferences),y.pendingPersist=!0),N&&(y.pendingUpdate=!0),E(),T},I=function(w){var x=i("parseStoredMountVoltages");return x?x(w):g(w)},C=function(w){return R(c(),w)},k=function(){var w=i("updateMountVoltageInputsFromState");if(w)return w();y.pendingUpdate=!0,E()},_=function(w){var x=i("persistMountVoltagePreferences");if(x)return x(w);var G=p(w);return y.preferences=d(G),y.pendingPersist=!0,E(),m(y.preferences)};if(s("parseVoltageValue",L("parseVoltageValue",f)),s("cloneMountVoltageMap",L("cloneMountVoltageMap",v)),s("getMountVoltagePreferencesClone",L("getMountVoltagePreferencesClone",A)),s("applyMountVoltagePreferences",L("applyMountVoltagePreferences",R)),s("parseStoredMountVoltages",L("parseStoredMountVoltages",I)),s("resetMountVoltagePreferences",L("resetMountVoltagePreferences",C)),s("updateMountVoltageInputsFromState",L("updateMountVoltageInputsFromState",k)),s("persistMountVoltagePreferences",L("persistMountVoltagePreferences",_)),typeof t.mountVoltageInputs>"u")try{t.mountVoltageInputs=null}catch{}})();var ND=typeof ND=="function"?ND:(function(){function t(){for(var o=[Ga("CORE_GLOBAL_SCOPE",null),typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],a=0;a<o.length;a+=1){var i=o[a];if(i&&(typeof i=="object"||typeof i=="function"))return i}return null}function r(o,a){if(o){var i=o.cineCoreMountVoltage;if(i&&typeof i.syncMountVoltageResetButtonGlobal=="function")try{i.syncMountVoltageResetButtonGlobal(a);return}catch{}try{o.mountVoltageResetButton=a}catch{}}}function n(o){var a=t();return r(a,o),o}return Nr("syncMountVoltageResetButtonGlobal",n)})(),HS=typeof HS<"u"&&(HS===null||typeof HS=="object")?HS:(function(){var t=Ga("totalPowerElem",null),r=typeof t>"u"||t===null||typeof t=="object"?t:null;return Nr("totalPowerElem",r)})();function N$(){const e=[];return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&e.push(CORE_GLOBAL_SCOPE),typeof globalThis<"u"&&globalThis&&e.push(globalThis),typeof window<"u"&&window&&e.push(window),typeof self<"u"&&self&&e.push(self),typeof global<"u"&&global&&e.push(global),e}function Qd(){const e=N$();for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r=="object")return r}return null}function F$(){const e=Qd();return e&&typeof e.cineCoreRuntimeModuleLoader=="object"&&e.cineCoreRuntimeModuleLoader?e.cineCoreRuntimeModuleLoader:typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object"?cineCoreRuntimeModuleLoader:null}function Zk(e,t){const r=F$();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{return r.resolveCoreRuntimeModule(e,t)}catch{}return null}function sC(e,t){if(typeof e!="string"||!e)return;const r=Qd();if(!r||typeof r!="object")return;let n=null;try{n=Object.getOwnPropertyDescriptor(r,e)}catch{n=null}if(!(n&&n.configurable===!1&&n.writable===!1)){try{r[e]=t;return}catch{}try{Object.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Unable to expose ${e} globally`,o)}}}function uQ(e){!e||typeof e!="object"||Object.keys(e).forEach(t=>{sC(t,e[t])})}const JE=(function(t){const r="__coreRuntimeBootQueue",n=t&&typeof t=="object"?t:Qd();if(n){const o=n.__cineCoreBootQueueKey,a=n.CORE_BOOT_QUEUE_KEY;if(typeof a=="string"&&a){try{n.__cineCoreBootQueueKey=a}catch{n.__cineCoreBootQueueKey=a}return a}if(typeof o=="string"&&o){if(typeof n.CORE_BOOT_QUEUE_KEY!="string"||!n.CORE_BOOT_QUEUE_KEY)try{n.CORE_BOOT_QUEUE_KEY=o}catch{n.CORE_BOOT_QUEUE_KEY=o}return o}}if(n){try{n.__cineCoreBootQueueKey=r}catch{n.__cineCoreBootQueueKey=r}try{n.CORE_BOOT_QUEUE_KEY=r}catch{n.CORE_BOOT_QUEUE_KEY=r}}return r})(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null),lC=(function(t){if(Array.isArray(t))return t;const r=typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:Qd();if(r&&typeof r=="object"){const n=r.cineCoreShared;if(n&&typeof n=="object"){const o=n[JE];if(Array.isArray(o))return o;if(Object.isExtensible(n))return n[JE]=[],n[JE]}return Array.isArray(r.CORE_BOOT_QUEUE)||(r.CORE_BOOT_QUEUE=[]),r.CORE_BOOT_QUEUE}return[]})(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE:null);typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE!==lC&&(CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE=lC);function fQ(e){if(typeof e=="function")try{lC.push(e)}catch{try{e()}catch(r){console.error("Failed to run fallback core boot task",r)}}}const _d="__cineGridSnapState";function tG(){const e=[],t=typeof CORE_RUNTIME_STATE<"u"&&CORE_RUNTIME_STATE&&typeof CORE_RUNTIME_STATE=="object"?CORE_RUNTIME_STATE:null;if(t&&typeof t.getScopes=="function")try{const n=t.getScopes();if(Array.isArray(n))for(let o=0;o<n.length;o+=1){const a=n[o];a&&e.indexOf(a)===-1&&e.push(a)}}catch{}const r=N$();for(let n=0;n<r.length;n+=1){const o=r[n];o&&e.indexOf(o)===-1&&e.push(o)}return e}function Wu(e,t=!1){if(e===!0||e===!1)return e===!0;if(typeof e=="string"){const r=e.trim().toLowerCase();return r?["true","1","yes","on","enabled","enable"].includes(r)?!0:["false","0","no","off","disabled","disable"].includes(r)?!1:t:t}if(typeof e=="number")return Number.isFinite(e)?e>0:t;if(e&&typeof e=="object"){if(Object.prototype.hasOwnProperty.call(e,"enabled"))return Wu(e.enabled,t);if(Object.prototype.hasOwnProperty.call(e,"value"))return Wu(e.value,t)}return t}function j$(){const e=tG();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object")){try{if(Object.prototype.hasOwnProperty.call(r,_d)){const n=r[_d],o=Wu(n,void 0);if(typeof o=="boolean")return o}}catch{}try{if(Object.prototype.hasOwnProperty.call(r,"gridSnap")){const n=r.gridSnap,o=Wu(n,void 0);if(typeof o=="boolean")return o}}catch{}}}}let Hu=Wu(j$(),!1);function dQ(e,t){if(!(!e||typeof e!="object")){try{e[_d]=t}catch{try{Object.defineProperty(e,_d,{configurable:!0,writable:!0,value:t})}catch{}}try{e.gridSnap=t}catch{try{Object.defineProperty(e,"gridSnap",{configurable:!0,writable:!0,value:t})}catch{}}}}function ML(e,t=null,r={}){const n=tG(),o=r&&r.persist!==!1;for(let i=0;i<n.length;i+=1){const s=n[i];if(!(!s||typeof s!="object")){if(o!==!1)try{s[_d]=e}catch{try{Object.defineProperty(s,_d,{configurable:!0,writable:!0,value:e})}catch{}}if(t!==s)try{s.gridSnap=e}catch{try{Object.defineProperty(s,"gridSnap",{configurable:!0,writable:!0,value:e})}catch{}}}}const a=Qd();return a&&typeof a=="object"&&o!==!1&&dQ(a,e),e}function pQ(){return Hu}function mQ(e){const t=Wu(e,Hu);return Hu=t,ML(t),Hu}function gQ(e){const t=Wu(e,Hu);return Hu=t,ML(t,null,{persist:!1}),Hu}ML(Hu);function yQ(e){if(!e||typeof e!="object")return;const t=Qd();if(!t||typeof t!="object")return;const r=t.cineRuntimeBootstrapExports;if(r&&typeof r=="object"){Object.keys(e).forEach(n=>{r[n]=e[n]});return}try{t.cineRuntimeBootstrapExports=e}catch{}}const eI={fallbackResolveRuntimeModuleLoader:F$,fallbackRequireCoreRuntimeModule:Zk,exposeCoreRuntimeConstant:sC,exposeCoreRuntimeConstants:uQ,CORE_BOOT_QUEUE_KEY:JE,CORE_BOOT_QUEUE:lC,enqueueCoreBootTask:fQ,GRID_SNAP_STATE_STORAGE_KEY:_d,getGridSnapStateScopes:tG,normaliseGridSnapPreference:Wu,readInitialGridSnapPreference:j$,syncGridSnapStateToScopes:ML,getGridSnapState:pQ,setGridSnapState:mQ,applyLegacyGridSnapValue:gQ};if(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE)CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule||(CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule=Zk),CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant||(CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant=sC);else{const e=Qd();e&&(e.fallbackRequireCoreRuntimeModule||(e.fallbackRequireCoreRuntimeModule=Zk),e.exposeCoreRuntimeConstant||(e.exposeCoreRuntimeConstant=sC))}if(typeof module<"u"&&module)try{module.exports=eI}catch{}else if(typeof exports<"u"&&exports)try{exports.runtimeBootstrapExports=eI}catch{}yQ(eI);const H$=(function(){function t(s){return s&&(typeof s=="object"||typeof s=="function")?s:typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE&&typeof CORE_PART1_RUNTIME_SCOPE=="object"?CORE_PART1_RUNTIME_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}function r(s,l,c){const u=typeof l=="function"?l:function(){return l},f=t(c);if(!f||typeof s!="string"||!s)try{return u()}catch{return}try{if(typeof f[s]<"u")return f[s]}catch{}const d=u();try{return f[s]=d,f[s]}catch{}try{return Object.defineProperty(f,s,{configurable:!0,writable:!0,value:d}),f[s]}catch{}return d}function n(s){if(s===null||typeof s!="object")return s;try{return JSON.parse(JSON.stringify(s))}catch{}return s}function o(s){if(typeof structuredClone=="function")return structuredClone;const l=t(s);if(l&&typeof l.structuredClone=="function")try{return l.structuredClone.bind(l)}catch{}return null}function a(s){const l=o(s);return l?function(u){if(u===null||typeof u!="object")return u;try{return l(u)}catch{}return n(u)}:n}function i(s){const l=t(s);if(l&&typeof l.__cineDeepClone=="function")return l.__cineDeepClone;const c=a(l);if(l&&typeof l=="object"){try{Object.defineProperty(l,"__cineDeepClone",{configurable:!0,writable:!0,value:c})}catch{}try{typeof l.__cineDeepClone!="function"&&(l.__cineDeepClone=c)}catch{}}return c}return function(l){const c=t(l);return{getCoreGlobalObject(){return t(c)},ensureCoreGlobalValue(u,f){return r(u,f,c)},jsonDeepClone:n,resolveStructuredClone(u){return o(u||c)},createResilientDeepClone(u){return a(u||c)},ensureDeepClone(u){return i(u||c)}}}})(),U$=(()=>{try{if(typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE)return CORE_PART1_RUNTIME_SCOPE}catch{}return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null})();let Go=typeof CORE_RUNTIME_TOOL_FALLBACK_FACTORY=="function"?CORE_RUNTIME_TOOL_FALLBACK_FACTORY(U$):null;(!Go||typeof Go!="object")&&(Go=H$(U$));function tg(){if(Go&&typeof Go.getCoreGlobalObject=="function")try{const e=Go.getCoreGlobalObject();if(e)return e}catch{}return typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE&&typeof CORE_PART1_RUNTIME_SCOPE=="object"?CORE_PART1_RUNTIME_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}function z$(e,t){if(Go&&typeof Go.ensureCoreGlobalValue=="function")try{return Go.ensureCoreGlobalValue(e,t)}catch{}const r=typeof t=="function"?t:function(){return t};if(typeof e!="string"||!e)try{return r()}catch{return}const n=tg();if(!n||typeof n!="object")return r();let o;try{o=n[e]}catch{o=void 0}if(typeof o<"u")return o;const a=r();try{return n[e]=a,n[e]}catch{}try{return Object.defineProperty(n,e,{configurable:!0,writable:!0,value:a}),n[e]}catch{}return a}function cC(e){if(Go&&typeof Go.jsonDeepClone=="function")try{return Go.jsonDeepClone(e)}catch{}if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function uC(e){if(Go&&typeof Go.createResilientDeepClone=="function")try{return Go.createResilientDeepClone(e)}catch{}return function(r){return cC(r)}}function $$(e){if(Go&&typeof Go.ensureDeepClone=="function")try{return Go.ensureDeepClone(e)}catch{}const t=e||tg(),r=uC(t);if(t&&typeof t=="object")try{Object.defineProperty(t,"__cineDeepClone",{configurable:!0,writable:!0,value:r})}catch{try{t.__cineDeepClone=r}catch{}}return r}var Yi=tg();const oi=(function(){var t=[];typeof globalThis<"u"&&t.push(globalThis),typeof window<"u"&&t.push(window),typeof self<"u"&&t.push(self),typeof global<"u"&&t.push(global);for(var r=0;r<t.length;r+=1){var n=t[r];if(!(!n||typeof n!="object"))try{if(n.CORE_RUNTIME_TOOLS)return n.CORE_RUNTIME_TOOLS}catch{}}return null})(),hQ=oi&&typeof oi.detectScope=="function"?function(){try{return oi.detectScope(Yi)}catch{}return tg()}:tg,bQ=oi&&typeof oi.ensureGlobalValue=="function"?function(t,r){return oi.ensureGlobalValue(t,r,Yi)}:z$,SQ=oi&&typeof oi.jsonDeepClone=="function"?function(t){try{return oi.jsonDeepClone(t)}catch{}return cC(t)}:cC,vQ=oi&&typeof oi.createResilientDeepClone=="function"?function(t){try{return oi.createResilientDeepClone(t||Yi)}catch{}return uC(t||Yi)}:uC,V$=oi&&typeof oi.ensureDeepClone=="function"?oi.ensureDeepClone(Yi):$$(Yi);if(Yi&&typeof Yi.__cineDeepClone!="function")try{Yi.__cineDeepClone=V$}catch{}(function(){const t={};function r(o,a){try{Object.defineProperty(t,o,{configurable:!0,enumerable:!0,get(){return a}})}catch{t[o]=a}}r("createInlineRuntimeToolFallbacks",H$),r("CORE_RUNTIME_TOOL_FALLBACKS",Go),r("fallbackGetCoreGlobalObject",tg),r("fallbackEnsureCoreGlobalValue",z$),r("fallbackJsonDeepClone",cC),r("fallbackCreateResilientDeepClone",uC),r("fallbackEnsureDeepClone",$$),r("CORE_GLOBAL_SCOPE",Yi),r("getCoreGlobalObject",hQ),r("ensureCoreGlobalValue",bQ),r("coreJsonDeepClone",SQ),r("coreCreateResilientDeepClone",vQ),r("CORE_DEEP_CLONE",V$);const n=[];try{Yi&&typeof Yi=="object"&&n.push(Yi)}catch{}typeof globalThis<"u"&&globalThis&&n.push(globalThis),typeof window<"u"&&window&&n.push(window),typeof self<"u"&&self&&n.push(self),typeof global<"u"&&global&&n.push(global);for(let o=0;o<n.length;o+=1){const a=n[o];if(!(!a||typeof a!="object"&&typeof a!="function"))try{a.cineCoreRuntimeGlobalTools||(a.cineCoreRuntimeGlobalTools=t),a.ensureCoreGlobalValue||(a.ensureCoreGlobalValue=t.ensureCoreGlobalValue),a.getCoreGlobalObject||(a.getCoreGlobalObject=t.getCoreGlobalObject)}catch{}}return t})();const aS=typeof ac=="function"?ac:()=>null,tI=typeof CORE_RUNTIME_SHARED<"u"?CORE_RUNTIME_SHARED:null,rI=typeof CORE_ENVIRONMENT_HELPERS<"u"?CORE_ENVIRONMENT_HELPERS:null,EQ=aS("cineCoreRuntimeCandidateScopes","./modules/core/runtime-candidate-scopes.js"),pm=aS("cineCoreAppRuntimeCandidateScopeSupport","./modules/app-core/runtime.js"),FD=(pm&&typeof pm.resolveRuntimeCandidateScopeSupport=="function"?pm.resolveRuntimeCandidateScopeSupport:null)||(function(){const t=[typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"))try{const o=n.cineCoreAppRuntimeCandidateScopeSupport;if(o&&typeof o.resolveRuntimeCandidateScopeSupport=="function")return o.resolveRuntimeCandidateScopeSupport}catch{}}return null})(),jD=(pm&&typeof pm.createFallbackRuntimeCandidateScopeSupport=="function"?pm.createFallbackRuntimeCandidateScopeSupport:null)||(function(){const t=[typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"))try{const o=n.cineCoreAppRuntimeCandidateScopeSupport;if(o&&typeof o.createFallbackRuntimeCandidateScopeSupport=="function")return o.createFallbackRuntimeCandidateScopeSupport}catch{}}return null})(),uT=aS("cineCoreAppRuntimeCandidateScopeFallback","./modules/app-core/runtime.js"),AQ=uT&&typeof uT.createRuntimeCandidateScopeSupportFallback=="function"?uT.createRuntimeCandidateScopeSupportFallback:(function(){return function(r){const n={collectCandidateScopes(){return[]},collectCandidateScopesWithFallback(){return[]},resolveCandidateScopes(o){return(o&&Array.isArray(o.currentCandidateScopes)?o.currentCandidateScopes:null)||[]},syncCandidateScopes(o,a){const i=Array.isArray(o)?o:[],s=a&&typeof a.assignCurrentCandidateScopes=="function"?a.assignCurrentCandidateScopes:r&&typeof r.assignCurrentCandidateScopes=="function"?r.assignCurrentCandidateScopes:null;if(s)try{s(i)}catch{}return i},ensureCandidateScopes(o){const a=o||{},i=n.resolveCandidateScopes(a);return n.syncCandidateScopes(i,a)}};return n}})(),nI=typeof jD=="function"?jD({runtimeShared:tI,environmentHelpers:rI}):AQ({runtimeShared:tI,environmentHelpers:rI,candidateScopeBridge:EQ,corePartRuntimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,assignCurrentCandidateScopes(e){try{CORE_RUNTIME_CANDIDATE_SCOPES=e}catch{}}}),HD=(typeof FD=="function"?FD({resolveCoreSupportModule:aS,requireFn:typeof require=="function"?require:null,runtimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,runtimeShared:tI,environmentHelpers:rI}):null)||nI,fT=aS("cineCoreAppRuntimeCandidateScopeResolvers","./modules/app-core/runtime.js"),UD=fT&&typeof fT.createRuntimeCandidateScopeResolvers=="function"?fT.createRuntimeCandidateScopeResolvers:(function(){return null})();function CQ(e){const t=e&&e.runtimeCandidateScopeSupport?e.runtimeCandidateScopeSupport:null,r=e&&e.fallbackRuntimeCandidateScopeSupport?e.fallbackRuntimeCandidateScopeSupport:null;function n(s,l){if(!s||typeof s.collectCandidateScopes!="function")return null;try{const c=s.collectCandidateScopes(l);return Array.isArray(c)?c:null}catch{}return null}function o(s,l){if(!s||typeof s.ensureCandidateScopes!="function")return null;try{const c=s.ensureCandidateScopes(l);return Array.isArray(c)?c:null}catch{}return null}function a(s){const l=n(t,s);if(l)return l;const c=n(r,s);return c||[]}function i(s){const l=s&&typeof s=="object"?s:{},c=o(t,l);if(c&&c.length)return c;const u=o(r,l);return u&&u.length?u:a(l.primaryScope)}return{collectCoreRuntimeCandidateScopes:a,ensureCoreRuntimeCandidateScopes:i}}const mm=(typeof UD=="function"?UD({runtimeCandidateScopeSupport:HD,fallbackRuntimeCandidateScopeSupport:nI}):null)||CQ({runtimeCandidateScopeSupport:HD,fallbackRuntimeCandidateScopeSupport:nI}),Uu=typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE||typeof globalThis<"u"&&typeof globalThis=="object"&&globalThis||typeof window<"u"&&typeof window=="object"&&window||typeof self<"u"&&typeof self=="object"&&self||typeof global<"u"&&typeof global=="object"&&global||null,wQ=mm&&typeof mm.collectCoreRuntimeCandidateScopes=="function"?mm.collectCoreRuntimeCandidateScopes:inlineCollectCoreRuntimeCandidateScopes,LQ=Uu&&typeof Uu.collectCoreRuntimeCandidateScopes=="function"?Uu.collectCoreRuntimeCandidateScopes:null,rG=LQ||wQ;Uu&&typeof Uu.collectCoreRuntimeCandidateScopes!="function"&&(Uu.collectCoreRuntimeCandidateScopes=rG);Uu&&(Uu.resolvedCollectCoreRuntimeCandidateScopes=rG);(function(){const t=typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,r=mm&&typeof mm.ensureCoreRuntimeCandidateScopes=="function"?mm.ensureCoreRuntimeCandidateScopes:null,n={primaryScope:t,currentCandidateScopes:typeof CORE_RUNTIME_CANDIDATE_SCOPES<"u"&&CORE_RUNTIME_CANDIDATE_SCOPES&&typeof CORE_RUNTIME_CANDIDATE_SCOPES.length=="number"?CORE_RUNTIME_CANDIDATE_SCOPES:null,globalScope:typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,assignCurrentCandidateScopes(o){try{CORE_RUNTIME_CANDIDATE_SCOPES=o}catch{}}};if(typeof r=="function")try{const o=r(n);if(Array.isArray(o))return o}catch{}return rG(t)})();const zD={powerDrawWatts:"Power (W)",capacity:"Capacity (Wh)",pinA:"Pin A",dtapA:"D-Tap A",mount_type:"Mount",screenSizeInches:"Screen Size (in)",brightnessNits:"Brightness (nits)",torqueNm:"Torque (Nm)",internalController:"Internal Controller",powerSource:"Power Source",batteryType:"Battery Type",connectivity:"Connectivity"};function oI(e){if(e===null)return"null";if(typeof e>"u")return"undefined";if(Array.isArray(e)){let t="[";for(let r=0;r<e.length;r+=1)r>0&&(t+=","),t+=oI(e[r]);return t+="]",t}if(typeof e=="object"&&e){const t=Object.keys(e).sort();let r="{";for(let n=0;n<t.length;n+=1){const o=t[n];n>0&&(r+=","),r+=`${JSON.stringify(o)}:${oI(e[o])}`}return r+="}",r}return JSON.stringify(e)}function RQ(e){return e&&Object.prototype.hasOwnProperty.call(zD,e)?zD[e]:(typeof e=="string"?e:String(e||"")).replace(/_/g," ").replace(/([A-Z])/g," $1").replace(/^./,r=>r.toUpperCase())}function nG(e,t,r){const n=[];e&&(typeof e=="object"||typeof e=="function")&&n.push(e),t&&(typeof t=="object"||typeof t=="function")&&n.push(t),r&&(typeof r=="object"||typeof r=="function")&&n.push(r),n.push(typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null);const o=[];for(let a=0;a<n.length;a+=1){const i=n[a];if(!i||typeof i!="object"&&typeof i!="function")continue;let s=!1;for(let l=0;l<o.length;l+=1)if(o[l]===i){s=!0;break}s||o.push(i)}return o}function aI(e){return e&&typeof e=="object"&&e.texts&&typeof e.texts=="object"&&e.texts.en&&typeof e.texts.en=="object"?e.texts.en:{}}function gm(e){if(typeof e!="string")return"greater";const t=e.trim().toLowerCase();return!t||t===">"||t==="gt"||t==="greaterthan"||t==="above"||t==="over"?"greater":t==="<"||t==="lt"||t==="lessthan"||t==="below"||t==="under"?"less":t==="="||t==="=="||t==="equal"||t==="equals"||t==="exactly"||t==="match"||t==="matches"?"equal":"greater"}function iI(e){if(typeof e=="number"&&Number.isFinite(e)){const t=Math.round(e);return t>=0?t:null}if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=t.replace(/[^0-9.,-]/g,"").replace(/,/g,".");if(!r)return null;const n=Number.parseFloat(r);if(!Number.isFinite(n))return null;const o=Math.round(n);return o>=0?o:null}return null}function fC(e){if(!Number.isFinite(e))return"";try{if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")return new Intl.NumberFormat().format(e)}catch{}return String(e)}function sI(e,t){return function(n,o){const a=o||{},i=t(),s=e(n);return s==="less"?a.autoGearCameraWeightOperatorLess||i.autoGearCameraWeightOperatorLess||"Lighter than":s==="equal"?a.autoGearCameraWeightOperatorEqual||i.autoGearCameraWeightOperatorEqual||"Exactly":a.autoGearCameraWeightOperatorGreater||i.autoGearCameraWeightOperatorGreater||"Heavier than"}}function q$(e,t){return function(n,o){if(!n||!Number.isFinite(n.value))return"";const a=t(n.operator,o),i=e(n.value);return a?`${a} ${i} g`:`${i} g`}}function K$(e,t,r){return typeof collectRuntimeScopeCandidates=="function"?collectRuntimeScopeCandidates([e,t,r]):nG(e,t,r)}function oG(e,t){if(!(typeof e!="string"||!e)&&!(!Array.isArray(t)||t.length===0))for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"&&typeof n!="function"))try{if(e in n){const o=n[e];if(typeof o<"u")return o}}catch{}}}function aG(e,t,r){if(typeof e!="string"||!e||!Array.isArray(r)||r.length===0)return!1;for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function")){try{return o[e]=t,!0}catch{}try{return Object.defineProperty(o,e,{configurable:!0,writable:!0,value:t}),!0}catch{}}}return!1}function W$(e,t,r){const n=oG(e,r);if(typeof n<"u")return n;const o=typeof t=="function"?t():t;return aG(e,o,r),o}function TQ(e){const t=e||{},r=t.coreShared&&typeof t.coreShared=="object"?t.coreShared:null,n=t.globalScope&&typeof t.globalScope=="object"?t.globalScope:null,o=function(){return aI(n||(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null))},a=r&&typeof r.normalizeAutoGearWeightOperator=="function"?function(h){try{return r.normalizeAutoGearWeightOperator(h)||gm(h)}catch{}return gm(h)}:gm,i=r&&typeof r.normalizeAutoGearWeightValue=="function"?function(h){try{const m=r.normalizeAutoGearWeightValue(h);if(typeof m=="number"||m===null)return m}catch{}return iI(h)}:iI,s=r&&typeof r.normalizeAutoGearCameraWeightCondition=="function"?function(h){try{return r.normalizeAutoGearCameraWeightCondition(h)||null}catch{}return null}:function(){return null},l=r&&typeof r.formatAutoGearWeight=="function"?function(h){try{const m=r.formatAutoGearWeight(h);if(typeof m=="string")return m}catch{}return fC(h)}:fC,c=sI(a,o),u=r&&typeof r.getAutoGearCameraWeightOperatorLabel=="function"?function(h,m){try{const g=r.getAutoGearCameraWeightOperatorLabel(h,m);if(typeof g=="string"&&g)return g}catch{}return c(h,m)}:c,f=q$(l,u),d=r&&typeof r.formatAutoGearCameraWeight=="function"?function(h,m){try{const g=r.formatAutoGearCameraWeight(h,m);if(typeof g=="string")return g}catch{}return f(h,m)}:f;return{normalizeAutoGearWeightOperator:a,normalizeAutoGearWeightValue:i,normalizeAutoGearCameraWeightCondition:s,formatAutoGearWeight:l,getAutoGearCameraWeightOperatorLabel:u,formatAutoGearCameraWeight:d,fallbackGetAutoGearCameraWeightOperatorLabel:c,fallbackFormatAutoGearCameraWeight:f,fallbackNormalizeAutoGearCameraWeightCondition:function(h){return null}}}function OQ(e){const t=e||{},r=typeof t.runtimeScope<"u"?t.runtimeScope:typeof CORE_PART2_RUNTIME_SCOPE<"u"?CORE_PART2_RUNTIME_SCOPE:null,n=typeof t.sharedScope<"u"?t.sharedScope:typeof CORE_SHARED_SCOPE_PART2<"u"?CORE_SHARED_SCOPE_PART2:null,o=typeof t.globalScope<"u"?t.globalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null;let a=K$(r,n,o);const i=typeof t.resolveSupportModule=="function"?t.resolveSupportModule:typeof resolveCoreSupportModule=="function"?resolveCoreSupportModule:null;let s=null;if(i)try{const f=i("cineCoreAppRuntimeScopeBridge","./modules/app-core/runtime.js");f&&typeof f=="object"&&typeof f.createRuntimeScopeBridge=="function"&&(s=f.createRuntimeScopeBridge({primaryScope:r,additionalScopes:[n,o]}))}catch{}s&&typeof s=="object"&&Array.isArray(s.candidates)&&s.candidates.length>0&&(a=s.candidates);function l(f){return oG(f,a)}function c(f,d){return aG(f,d,a)}function u(f,d){return W$(f,d,a)}return{runtimeScopeBridge:s,runtimeScopeCandidates:a,readCoreScopeValue:s&&typeof s.readValue=="function"?s.readValue:l,writeCoreScopeValue:s&&typeof s.writeValue=="function"?s.writeValue:c,declareCoreFallbackBinding:s&&typeof s.declareFallbackBinding=="function"?s.declareFallbackBinding:u,fallbackReadCoreScopeValue:l,fallbackWriteCoreScopeValue:c,fallbackDeclareCoreFallbackBinding:u}}var Y$=(function(){let t=null;if(typeof resolveCoreSupportModule=="function")try{const r=resolveCoreSupportModule("cineCorePart2RuntimeHelpers","./modules/app-core/runtime.js");r&&typeof r=="object"&&(t=r)}catch{}return t&&typeof t=="object"?t:{resolveAutoGearWeightHelpers:TQ,resolveRuntimeScopeTools:OQ,fallbackStableStringify:oI,fallbackHumanizeKey:RQ,fallbackNormalizeAutoGearWeightOperator:gm,fallbackNormalizeAutoGearWeightValue:iI,fallbackFormatAutoGearWeight:fC,fallbackNormalizeAutoGearCameraWeightCondition:function(n){return null},fallbackGetAutoGearCameraWeightOperatorLabel:sI(gm,function(){return aI(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)}),fallbackFormatAutoGearCameraWeight:q$(fC,sI(gm,function(){return aI(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)})),fallbackCreateRuntimeScopeCandidates:K$,fallbackReadCoreScopeValue:oG,fallbackWriteCoreScopeValue:aG,fallbackDeclareCoreFallbackBinding:W$}})();(function(t){if(!t||typeof t!="object")return;const r=nG(typeof CORE_PART2_RUNTIME_SCOPE<"u"?CORE_PART2_RUNTIME_SCOPE:null,typeof CORE_SHARED_SCOPE_PART2<"u"?CORE_SHARED_SCOPE_PART2:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null);for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{const a=o.cineCorePart2RuntimeHelpers;if(a&&typeof a=="object"){if(typeof Object.assign=="function")Object.assign(a,t);else for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);continue}o.cineCorePart2RuntimeHelpers=t}catch{}}})(Y$);(function(t){if(!t||typeof t!="object")return;const r=nG(typeof CORE_PART2_RUNTIME_SCOPE<"u"?CORE_PART2_RUNTIME_SCOPE:null,typeof CORE_SHARED_SCOPE_PART2<"u"?CORE_SHARED_SCOPE_PART2:null,typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null);for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{if(o.cineCoreShared&&typeof o.cineCoreShared=="object"){const a=o.cineCoreShared.cineCoreRuntimeHelpers;if(!a||typeof a!="object")o.cineCoreShared.cineCoreRuntimeHelpers=t;else if(typeof Object.assign=="function")Object.assign(a,t);else for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i])}}catch{}}})(Y$);function xQ(){return typeof cineCoreRuntimeModuleLoader<"u"&&cineCoreRuntimeModuleLoader&&typeof cineCoreRuntimeModuleLoader=="object"?cineCoreRuntimeModuleLoader:typeof globalThis<"u"&&globalThis&&typeof globalThis.cineCoreRuntimeModuleLoader=="object"?globalThis.cineCoreRuntimeModuleLoader:typeof window<"u"&&window&&typeof window.cineCoreRuntimeModuleLoader=="object"?window.cineCoreRuntimeModuleLoader:typeof self<"u"&&self&&typeof self.cineCoreRuntimeModuleLoader=="object"?self.cineCoreRuntimeModuleLoader:typeof global<"u"&&global&&typeof global.cineCoreRuntimeModuleLoader=="object"?global.cineCoreRuntimeModuleLoader:null}function kQ(e,t){const r=xQ();if(r&&typeof r.resolveCoreRuntimeModule=="function")try{return r.resolveCoreRuntimeModule(e,t)}catch{}return null}if(typeof CORE_TEMPERATURE_QUEUE_KEY>"u")try{CORE_TEMPERATURE_QUEUE_KEY="__cinePendingTemperatureNote"}catch{typeof globalThis<"u"?globalThis.CORE_TEMPERATURE_QUEUE_KEY="__cinePendingTemperatureNote":typeof window<"u"&&(window.CORE_TEMPERATURE_QUEUE_KEY="__cinePendingTemperatureNote")}if(typeof CORE_TEMPERATURE_RENDER_NAME>"u")try{CORE_TEMPERATURE_RENDER_NAME="renderTemperatureNote"}catch{typeof globalThis<"u"?globalThis.CORE_TEMPERATURE_RENDER_NAME="renderTemperatureNote":typeof window<"u"&&(window.CORE_TEMPERATURE_RENDER_NAME="renderTemperatureNote")}(function(){const t=[typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null];let r=null;for(let o=0;o<t.length;o+=1){const a=t[o];if(a)try{if(a.ICON_GLYPHS&&typeof a.ICON_GLYPHS=="object"){r=a.ICON_GLYPHS;break}}catch{}}r||(r={});for(let o=0;o<t.length;o+=1){const a=t[o];if(a)try{typeof a.ICON_GLYPHS>"u"&&(a.ICON_GLYPHS=r)}catch{}}let n=!1;try{n=typeof ICON_GLYPHS<"u"}catch{n=!1}if(!n)try{ICON_GLYPHS=r}catch{}})();var vc=(function(){var t=null;if(typeof ac=="function"&&(t=ac("cineRuntimeEnvironmentHelpers","./modules/runtime-environment-helpers.js")),t)return t;for(var r=[typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null],n=0;n<r.length;n+=1){var o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{var a=o.cineRuntimeEnvironmentHelpers;if(a&&typeof a=="object"){t=a;break}}catch{}}return t})(),Ln=typeof Ln<"u"&&Ln?Ln:(function(){var t=null;if(typeof ac=="function"&&(t=ac("cineCoreRuntimeShared","./modules/core/runtime-shared.js")),!t){var r=null;r&&typeof r=="object"&&(t=r)}if(t)return t;for(var n=[typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null],o=0;o<n.length;o+=1){var a=n[o];if(!(!a||typeof a!="object"))try{var i=a.cineCoreRuntimeShared;if(i&&typeof i=="object")return i}catch{}}return null})();function IQ(e){if(Ln&&typeof Ln.collectCandidateScopes=="function")try{var t=Ln.collectCandidateScopes(e,vc);if(Array.isArray(t))return t}catch{}var r=[];function n(s){!s||typeof s!="object"&&typeof s!="function"||r.indexOf(s)===-1&&r.push(s)}if(vc&&typeof vc.fallbackCollectCandidateScopes=="function")try{var o=vc.fallbackCollectCandidateScopes(e);if(Array.isArray(o))for(var a=0;a<o.length;a+=1)n(o[a])}catch{}n(e),n(typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null),n(typeof window<"u"&&typeof window=="object"?window:null),n(typeof self<"u"&&typeof self=="object"?self:null),n(typeof global<"u"&&typeof global=="object"?global:null);var i=null;if(vc&&typeof vc.fallbackDetectGlobalScope=="function")try{i=vc.fallbackDetectGlobalScope()}catch{i=null}else typeof globalThis<"u"&&typeof globalThis=="object"?i=globalThis:typeof window<"u"&&typeof window=="object"?i=window:typeof self<"u"&&typeof self=="object"?i=self:typeof global<"u"&&typeof global=="object"&&(i=global);return n(i),r}var ao=(function(){if(typeof ao<"u"&&ao&&typeof ao.length=="number")return ao;var t=null;if(Ln&&typeof Ln.resolveCandidateScopes=="function")try{t=Ln.resolveCandidateScopes(typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,vc)}catch{t=null}if(t||(t=IQ(typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null)),Ln&&typeof Ln.syncCandidateScopes=="function")try{Ln.syncCandidateScopes(t,typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,vc)}catch{}else{var r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(r&&(!r.CORE_RUNTIME_CANDIDATE_SCOPES||r.CORE_RUNTIME_CANDIDATE_SCOPES!==t))try{r.CORE_RUNTIME_CANDIDATE_SCOPES=t}catch{}}return t})(),hs=(function(){function t(){var l=[];if(typeof globalThis<"u"&&l.push(globalThis),typeof window<"u"&&l.push(window),typeof self<"u"&&l.push(self),typeof global<"u"&&l.push(global),Array.isArray(ao))for(var c=0;c<ao.length;c+=1)l.push(ao[c]);for(var u=0;u<l.length;u+=1){var f=l[u];if(!(!f||typeof f!="object"))try{if(f.CORE_RUNTIME_STATE_SUPPORT)return f.CORE_RUNTIME_STATE_SUPPORT;if(f.cineCoreRuntimeState)return f.cineCoreRuntimeState}catch{}}return null}var r=t();if(r)return r;var n=null;if(typeof ac=="function"&&(n=ac("cineCoreRuntimeState","./modules/core/runtime-state.js")),!n){var o=kQ("modules/core/runtime-state.js");o&&typeof o=="object"&&(n=o)}if(n){if(!t()&&typeof globalThis<"u")try{globalThis.CORE_RUNTIME_STATE_SUPPORT=n}catch{}return n}for(var a=0;a<ao.length;a+=1){var i=ao[a];if(!(!i||typeof i!="object"))try{var s=i.cineCoreRuntimeState;if(s&&typeof s=="object"){if(!t()&&typeof globalThis<"u")try{globalThis.CORE_RUNTIME_STATE_SUPPORT=s}catch(l){}return s}}catch{}}return null})(),Q$=(function(){var t={queueKey:CORE_TEMPERATURE_QUEUE_KEY,renderName:CORE_TEMPERATURE_RENDER_NAME};if(hs&&typeof hs.resolveTemperatureKeyDefaults=="function")try{var r=hs.resolveTemperatureKeyDefaults();r&&typeof r=="object"&&(typeof r.queueKey=="string"&&r.queueKey&&(t.queueKey=r.queueKey),typeof r.renderName=="string"&&r.renderName&&(t.renderName=r.renderName))}catch{}return(typeof t.queueKey!="string"||!t.queueKey)&&(t.queueKey="__cinePendingTemperatureNote"),(typeof t.renderName!="string"||!t.renderName)&&(t.renderName="renderTemperatureNote"),t})();CORE_TEMPERATURE_QUEUE_KEY=Q$.queueKey;CORE_TEMPERATURE_RENDER_NAME=Q$.renderName;(function(){if(hs&&typeof hs.ensureSafeFreezeRegistry=="function")try{return hs.ensureSafeFreezeRegistry()}catch{}if(hs&&typeof hs.createSafeFreezeRegistry=="function")try{return hs.createSafeFreezeRegistry()}catch{}return typeof WeakSet=="function"?new WeakSet:[]})();function PQ(e){var t=[],r=typeof Set=="function"?new Set:null;function n(g){if(!(!g||typeof g!="object"&&typeof g!="function")){if(r){if(r.has(g))return;r.add(g),t.push(g);return}t.indexOf(g)===-1&&t.push(g)}}if(Array.isArray(e))for(var o=0;o<e.length;o+=1)try{n(e[o])}catch{}function a(g){if(typeof g=="function")for(var S=0;S<t.length;S+=1)try{g(t[S],S)}catch{}}function i(){return t.slice()}function s(){return t.length>0?t[0]:null}function l(g,S){var y=typeof S=="function"?S:function(){return S};if(typeof g!="string"||!g)try{return y()}catch{return}for(var E=0;E<t.length;E+=1){var L=t[E];if(!(!L||typeof L!="object"&&typeof L!="function"))try{return typeof L[g]>"u"&&(L[g]=y()),L[g]}catch{}}try{return y()}catch{return}}function c(g,S,y){var E=typeof y=="function"?y:function(){return y},L=typeof S=="function"?S:function(){return!0};a(function(A){try{L(A[g])||(A[g]=E())}catch(R){}})}function u(g){for(var S=0;S<t.length;S+=1){var y=t[S];if(!(!y||typeof y!="object"&&typeof y!="function"))try{if(g in y)return y[g]}catch{}}}var f=null;function d(g){typeof g=="function"&&(f=g,a(function(y){if(!(!y||typeof y!="object"&&typeof y!="function"))try{y[CORE_TEMPERATURE_RENDER_NAME]=g;var E=y[CORE_TEMPERATURE_QUEUE_KEY];if(E&&typeof E=="object"){if(Object.prototype.hasOwnProperty.call(E,"latestHours")){var L=E.latestHours;if(typeof L<"u")try{g(L)}catch(v){typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to apply pending temperature note render",v)}}try{delete E.latestHours}catch(v){E.latestHours=void 0}}}catch(v){}}))}function p(){return f}var h={isReferenceError:function(){return!1},repair:function(){}};function m(g){!g||typeof g!="object"||(typeof g.isReferenceError=="function"&&(h.isReferenceError=g.isReferenceError),typeof g.repair=="function"&&(h.repair=g.repair))}return{registerScope:n,withEachScope:a,getScopes:i,getPrimaryScope:s,ensureValue:l,normaliseValue:c,readValue:u,assignTemperatureRenderer:d,getAssignedTemperatureRenderer:p,autoGearGuards:h,setAutoGearGuards:m}}function BQ(e){if(hs&&typeof hs.createLocalRuntimeState=="function")try{return hs.createLocalRuntimeState(e,{temperatureQueueKey:CORE_TEMPERATURE_QUEUE_KEY,temperatureRenderName:CORE_TEMPERATURE_RENDER_NAME})}catch{}return PQ(e)}var Xn=(function(){for(var t=null,r=0;r<ao.length;r+=1){var n=ao[r];if(n&&typeof n.__cineRuntimeState=="object"){t=n.__cineRuntimeState;break}}if(!t)for(var o=0;o<ao.length;o+=1){var a=ao[o],i=a&&typeof a.__cineCreateRuntimeState=="function"?a.__cineCreateRuntimeState:null;if(typeof i=="function"){try{t=i(ao)}catch{t=null}if(t)break}}t||(t=BQ(ao));var s=ao.length?ao[0]:null;if(s&&t)try{Object.defineProperty(s,"__cineRuntimeState",{configurable:!0,enumerable:!1,writable:!0,value:t})}catch{try{s.__cineRuntimeState=t}catch{}}return t})();function GQ(e){if(Ln&&typeof Ln.registerScope=="function")try{Ln.registerScope(Xn,e);return}catch{}if(!(!Xn||typeof Xn.registerScope!="function"))try{Xn.registerScope(e)}catch{}}for(var dT=0;dT<ao.length;dT+=1)GQ(ao[dT]);function ob(){if(Ln&&typeof Ln.getScopesSnapshot=="function")try{var e=Ln.getScopesSnapshot(Xn,ao);if(Array.isArray(e))return e}catch{}if(Xn&&typeof Xn.getScopes=="function")try{return Xn.getScopes()}catch{}return ao.slice()}var yl=Ln&&typeof Ln.ensurePrimaryScope=="function"?(function(){try{return Ln.ensurePrimaryScope(Xn,ao)}catch{}return null})():null;if(!yl&&Xn&&typeof Xn.getPrimaryScope=="function")try{yl=Xn.getPrimaryScope()}catch{yl=null}if(!yl){var $D=ob();yl=$D.length?$D[0]:null}function ai(e,t){if(Ln&&typeof Ln.ensureValue=="function")try{return Ln.ensureValue(Xn,e,t,ob())}catch{}if(Xn&&typeof Xn.ensureValue=="function")return Xn.ensureValue(e,t);for(var r=typeof t=="function"?t:function(){return t},n=ob(),o=0;o<n.length;o+=1){var a=n[o];try{return typeof a[e]>"u"&&(a[e]=r()),a[e]}catch{}}try{return r()}catch{return}}function X$(e,t,r){if(Ln&&typeof Ln.normaliseValue=="function")try{Ln.normaliseValue(Xn,e,t,r,ob());return}catch{}if(Xn&&typeof Xn.normaliseValue=="function"){Xn.normaliseValue(e,t,r);return}for(var n=typeof r=="function"?r:function(){return r},o=ob(),a=0;a<o.length;a+=1){var i=o[a];try{t(i[e])||(i[e]=n())}catch{}}}var J$={autoGearAutoPresetId:function(){return""},baseAutoGearRules:function(){return[]},autoGearScenarioModeSelect:function(){return null},autoGearRuleNameInput:function(){return null},autoGearSummaryFocus:function(){return"all"},autoGearMonitorDefaultControls:function(){return[]},safeGenerateConnectorSummary:function(){return _L()},totalPowerElem:function(){return null}},lI=Object.keys(J$);function MQ(e){if(!e||typeof e!="object")return!1;var t=typeof e.message=="string"?e.message:"";return e.name==="ReferenceError"&&lI.some(function(n){return t.indexOf(n)!==-1})}function _Q(e,t){var r=J$[t];if(typeof r=="function"){var n=r();if(typeof e[t]>"u")try{e[t]=n}catch{try{Object.defineProperty(e,t,{configurable:!0,writable:!0,enumerable:!1,value:n})}catch{}}try{var o=e&&e.Function||Function;if(typeof o=="function"){var a=o("value","if (typeof "+t+" === 'undefined') { var "+t+" = value; } else { "+t+` = value; }
           return `+t+";"),i=typeof e[t]>"u"?n:e[t];a(i)}}catch{}}}function DQ(e){if(!(!e||typeof e!="object"&&typeof e!="function"))for(var t=0;t<lI.length;t+=1){var r=lI[t];try{_Q(e,r)}catch{}}}if(Xn&&typeof Xn.setAutoGearGuards=="function")try{Xn.setAutoGearGuards({isReferenceError:MQ,repair:DQ})}catch{}ai("autoGearAutoPresetId","");ai("baseAutoGearRules",function(){return[]});ai("autoGearScenarioModeSelect",null);function _L(){return function(t){if(!t||typeof t!="object")return"";if(typeof generateConnectorSummary=="function")try{return generateConnectorSummary(t)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("generateConnectorSummary failed, using fallback",r)}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Using fallback connector summary generator. Core bindings may have failed to initialise.");try{const r=Object.keys(t);if(!r.length)return"";const n=r[0],o=t[n],a=typeof n=="string"?n.replace(/_/g," "):"connector";return o?`${a}: ${o}`:a}catch{return""}}}ai("safeGenerateConnectorSummary",function(){return _L()});X$("baseAutoGearRules",function(t){return Array.isArray(t)},function(){return[]});X$("safeGenerateConnectorSummary",function(t){return typeof t=="function"},function(){return _L()});function iG(){return Object.freeze({ESSENTIAL:"essential",FILM:"film",GADGET:"gadget",UICONS:"uicons",TEXT:"text"})}ai("ICON_FONT_KEYS",function(){return iG()});ai("iconGlyph",function(){const e=ai("ICON_FONT_KEYS",function(){return iG()}),t=e&&typeof e.UICONS=="string"?e.UICONS:"uicons";return function(n,o){const a=typeof n=="string"?n:"",i=o&&typeof o=="string"?o:t;try{return Object.freeze({char:a,font:i})}catch{return{char:a,font:i}}}});ai("resolveIconGlyph",function(){const e=ai("ICON_FONT_KEYS",function(){return iG()}),t=new Set(Object.values(e||{}).filter(a=>typeof a=="string"&&a)),r=e&&e.UICONS?e.UICONS:"uicons";function n(a,i){const s=parseInt(a,i);if(!Number.isFinite(s)||s<0)return null;try{if(typeof String.fromCodePoint=="function")return String.fromCodePoint(s)}catch{}return s<=65535?String.fromCharCode(s):null}function o(a){if(typeof a!="string")return"";const i=a.trim();if(!i)return"";const s=i.match(/^(?:\\)+u([0-9A-Fa-f]{4})$/);if(s){const f=n(s[1],16);if(f)return f}const l=i.match(/^(?:\\)+u\{([0-9A-Fa-f]+)\}$/);if(l){const f=n(l[1],16);if(f)return f}const c=i.match(/^&#x([0-9A-Fa-f]+);$/i);if(c){const f=n(c[1],16);if(f)return f}const u=i.match(/^&#(\d+);$/);if(u){const f=n(u[1],10);if(f)return f}return i}return function(i){if(!i)return{char:"",font:r,className:""};if(i.markup){const s=Number.isFinite(i.size)?i.size:void 0;return{markup:i.markup,className:i.className||"",font:r,size:s}}if(typeof i=="string")return{char:o(i),font:r,className:""};if(typeof i=="object"){const s=typeof i.char=="string"?o(i.char):"",l=i.font&&t.has(i.font)?i.font:r,c=typeof i.className=="string"?i.className:"",u=Number.isFinite(i.size)?i.size:void 0;return i.markup?{markup:i.markup,className:c,font:l,size:u}:{char:s,font:l,className:c,size:u}}return{char:"",font:r,className:""}}});ai("formatSvgCoordinate",function(){return function(t){if(!Number.isFinite(t))return"0";const r=Math.round(t*100)/100;return Number.isInteger(r)?String(r):r.toFixed(2).replace(/0+$/,"").replace(/\.$/,"")}});ai("positionSvgMarkup",function(){const e=ai("formatSvgCoordinate",function(){return function(r){if(!Number.isFinite(r))return"0";const n=Math.round(r*100)/100;return Number.isInteger(n)?String(n):n.toFixed(2).replace(/0+$/,"").replace(/\.$/,"")}});return function(r,n,o,a=24){if(typeof r!="string")return{markup:"",x:"0",y:"0"};const i=r.trim();if(!i)return{markup:"",x:"0",y:"0"};const s=a/2,l=e(n),c=e(o),u=e(a),f=e(a);return{markup:i.replace(/<svg\b([^>]*)>/i,(p,h="")=>{let m=h.replace(/\s+x\s*=\s*"[^"]*"/gi,"").replace(/\s+y\s*=\s*"[^"]*"/gi,"").trim();const g=[],S=/(?:^|\s)width\s*=/i.test(m),y=/(?:^|\s)height\s*=/i.test(m);return S||g.push(`width="${u}"`),y||g.push(`height="${f}"`),g.push(`x="-${e(s)}"`),g.push(`y="-${e(s)}"`),m=[m].concat(g).filter(Boolean).join(" ").trim(),m?`<svg ${m}>`:"<svg>"}),x:l,y:c}}});ai("applyIconGlyph",function(){const e=ai("resolveIconGlyph",function(){return function(n){return n&&typeof n=="object"?n:{char:typeof n=="string"?n:"",font:"uicons"}}}),t=ai("ensureSvgHasAriaHidden",function(){return function(n){return n}});return function(n,o){if(!n)return;const a=e(o);if(a&&a.markup){n.innerHTML=t(a.markup),n.setAttribute("aria-hidden","true"),a.className&&n.classList&&a.className.split(/\s+/).filter(Boolean).forEach(s=>n.classList.add(s)),n.removeAttribute("data-icon-font");return}const i=a&&a.char||"";n.textContent=i,i?n.setAttribute("data-icon-font",a.font||"uicons"):n.removeAttribute("data-icon-font")}});function DL(e,t){for(var r=[yl&&typeof yl=="object"?yl:null,typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null].filter(Boolean),n=typeof t=="function"?t:function(){return t},o=0;o<r.length;o+=1){var a=r[o];try{return typeof a[e]>"u"&&(a[e]=n()),a[e]}catch{}}return n()}DL("autoGearAutoPresetId","");DL("baseAutoGearRules",function(){return[]});DL("autoGearScenarioModeSelect",null);DL("safeGenerateConnectorSummary",function(){return _L()});function NL(e){const t=[yl&&typeof yl=="object"?yl:null,typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null].filter(Boolean);for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"))try{if(e in n){const o=n[e];if(typeof o<"u")return o}}catch{}}}NL("autoGearAutoPresetId");NL("baseAutoGearRules");NL("autoGearScenarioModeSelect");NL("safeGenerateConnectorSummary");const zp={_cache:{},getElement:function(e){if(this._cache[e])return this._cache[e];if(typeof document<"u"){const t=document.getElementById(e);if(t)return this._cache[e]=t,t}return null},clear:function(){this._cache={}}},NQ=["toggleDeviceManager","device-manager","saveSetupBtn","setupName","deleteSetupBtn","addDeviceBtn","cancelEditBtn","languageSelect","skipLink","importDataBtn","importFileInput","exportDataBtn","generateGearListBtn","deleteGearListProjectBtn","gearItemEditExtra","newSubcategory","newCategory","subcategoryField","lensFocusScaleUnit","newName","newWatt","newCapacity","newPinA","newDtapA","menuToggle","darkModeToggle","pinkModeToggle","settingsButton","helpButton","reloadButton","closeMenuButton","openContactsBtn","shareSetupBtn","applySharedLinkBtn","generateOverviewBtn","runtimeFeedbackBtn","zoomOut","zoomIn","resetView","gridSnapToggle","accentColorReset","localFontsButton","documentationTrackerAddRelease","mountVoltageReset","autoGearSavePreset","autoGearDeletePreset","autoGearBackupRestore","autoGearAddRule","autoGearResetFactory","autoGearHighlightToggle","closePrintPreviewBtn","printPreviewExportBtn","printPreviewPrintBtn","cameraWatt","monitorWatt","viewfinderWatt","cameraVoltage","cameraPortType","monitorScreenSize","monitorBrightness","monitorVoltage","monitorPortType","monitorLatency","monitorAudioOutput","viewfinderScreenSize","viewfinderBrightness","viewfinderVoltage","viewfinderPortType","viewfinderLatency","batteryFields","cameraFields","monitorFields","viewfinderFields","videoFields","motorFields","controllerFields","distanceFields","lensFields","wattField","dynamicFields"];NQ.forEach(function(e){Object.defineProperty(zp,e,{get:function(){return this.getElement(e)},enumerable:!0,configurable:!0})});typeof globalThis<"u"?globalThis.cineUiCache=zp:typeof window<"u"?window.cineUiCache=zp:typeof self<"u"?self.cineUiCache=zp:typeof global<"u"&&(global.cineUiCache=zp);function FQ(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const Cs=FQ();function sG(){return Cs&&Cs.document&&typeof Cs.document=="object"?Cs.document:typeof document<"u"&&document&&typeof document=="object"?document:null}let qg=null;function FL(e){if(!qg){const t=sG();t&&(qg=t.createElement("div"))}return qg?(qg.textContent=e,qg.innerHTML):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function rg(e){if(typeof e!="string"||e==="")return"";try{return FL(e)}catch{}return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function jQ(){try{if(typeof iconMarkup=="function")return iconMarkup}catch(e){if(!(e&&e.name==="ReferenceError"))throw e}return Cs&&typeof Cs.iconMarkup=="function"?Cs.iconMarkup:null}function cI(e){return typeof e!="number"?!1:typeof Number.isFinite=="function"?Number.isFinite(e):isFinite(e)}function US(e,t){const r=parseInt(e,t);if(!cI(r)||r<0)return"";try{if(typeof String.fromCodePoint=="function")return String.fromCodePoint(r)}catch{}return r<=65535?String.fromCharCode(r):""}function VD(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.match(/^(?:\\)+u([0-9A-Fa-f]{4})$/);if(r){const i=US(r[1],16);if(i)return i}const n=t.match(/^(?:\\)+u\{([0-9A-Fa-f]+)\}$/);if(n){const i=US(n[1],16);if(i)return i}const o=t.match(/^&#x([0-9A-Fa-f]+);$/i);if(o){const i=US(o[1],16);if(i)return i}const a=t.match(/^&#(\d+);$/);if(a){const i=US(a[1],10);if(i)return i}return t}function HQ(e){if(typeof e=="string")return rg(e);if(e===null||typeof e>"u")return"";try{return rg(String(e))}catch{}return""}function UQ(e){if(!e)return null;if(typeof e=="string"){const c=VD(e);return c?{char:c,font:"uicons",className:""}:null}if(typeof e!="object")return null;const t=typeof e.markup=="string"?e.markup.trim():"",r=typeof e.className=="string"?e.className:"",n=typeof e.style=="string"?e.style:"",o=e.size,a=e.scale;if(t)return{markup:t,className:r,style:n,size:o,scale:a};const i=typeof e.char=="string"&&e.char?e.char:typeof e.character=="string"&&e.character?e.character:typeof e.glyph=="string"&&e.glyph?e.glyph:typeof e.unicode=="string"&&e.unicode?e.unicode:"",s=VD(i);if(!s)return null;const l=typeof e.font=="string"&&e.font.trim()?e.font.trim():"uicons";return{char:s,font:l,className:r,style:n,size:o,scale:a}}function qD(e,t){const r=UQ(e);if(!r)return"";const n=["icon-glyph"];n.unshift(t),r.className&&r.className.split(/\s+/).filter(Boolean).forEach(c=>{n.indexOf(c)===-1&&n.push(c)});const o=[];cI(r.size)&&r.size>0?o.push(`--icon-size: ${r.size}px`):typeof r.size=="string"&&r.size.trim()&&o.push(`--icon-size: ${r.size.trim()}`),cI(r.scale)&&r.scale>0?o.push(`--icon-scale: ${r.scale}`):typeof r.scale=="string"&&r.scale.trim()&&o.push(`--icon-scale: ${r.scale.trim()}`),typeof r.style=="string"&&r.style.trim()&&o.push(r.style.trim());const a=o.length?` style="${o.join(";")}"`:"";if(r.markup)return`<span class="${n.join(" ")}"${a} aria-hidden="true">${r.markup}</span>`;const i=typeof r.char=="string"?r.char:"";if(!i)return"";const s=typeof r.font=="string"?r.font:"uicons",l=s?` data-icon-font="${HQ(s)}"`:"";return`<span class="${n.join(" ")}"${a}${l} aria-hidden="true">${FL(i)}</span>`}function lG(e){if(!e)return"";const t=jQ();if(!t)return qD(e,"btn-icon");try{return t(e,"btn-icon")}catch{}return qD(e,"btn-icon")}function zQ(e){if(typeof e<"u")return e;try{if(typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.save)return ICON_GLYPHS.save}catch{}return e}function Z$(e,t,r){if(!e)return;const n=sG(),o=zQ(r),a=lG(o),i=typeof t=="string"?t:"";if(e.firstChild)for(;e.firstChild;)e.removeChild(e.firstChild);if(n&&a){const s=n.createElement("span");for(s.innerHTML=a;s.firstChild;)e.appendChild(s.firstChild)}else if(!n&&a&&typeof e.innerHTML=="string"){e.innerHTML=`${a}${rg(i)}`;return}n?e.appendChild(n.createTextNode(i)):typeof e.textContent=="string"?e.textContent=i:typeof e.innerHTML=="string"&&(e.innerHTML=rg(i))}function eV(e,t,r={}){if(!e||typeof t!="function")return!1;const n=sG();if(!n)return!1;const o=u=>{let f=n.getElementById(u);if(!f)try{f=n.querySelector(u)}catch{}return f},a=o(e);if(a){try{t(a)}catch(u){typeof console<"u"&&console&&typeof console.error=="function"&&console.error(`whenElementAvailable: handler for ${e} failed`,u)}return!0}const i=typeof r.maxAttempts=="number"?r.maxAttempts:150,s=typeof r.interval=="number"&&r.interval>0?r.interval:100;let l=0;const c=()=>{l+=1;const u=o(e);if(u){try{t(u)}catch(f){typeof console<"u"&&console&&typeof console.error=="function"&&console.error(`whenElementAvailable: polled handler for ${e} failed`,f)}return}if(l<i)setTimeout(c,s);else if(typeof r.onTimeout=="function")try{r.onTimeout()}catch{}};return setTimeout(c,s),!0}const $Q={escapeHtml:FL,escapeButtonLabelSafely:rg,resolveButtonIconMarkup:lG,setButtonLabelWithIcon:Z$,whenElementAvailable:eV};if(Cs){const e=Cs.cineCoreUiHelpers&&typeof Cs.cineCoreUiHelpers=="object"?Cs.cineCoreUiHelpers:{};e.escapeHtml=FL,e.escapeButtonLabelSafely=rg,e.resolveButtonIconMarkup=lG,e.setButtonLabelWithIcon=Z$,e.whenElementAvailable=eV;try{Cs.cineCoreUiHelpers=e}catch{}}const Gr=$Q,dC=`
`;function pC(e,t=dC){const r=typeof t=="string"&&t?t:dC;if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"){try{return String(e)}catch{}return""}if(Array.isArray(e)){const n=[];for(let o=0;o<e.length;o+=1){const a=pC(e[o],r);a&&n.push(a)}return n.join(r)}if(e&&typeof e=="object"){if(typeof e.text=="string")return e.text;if(Array.isArray(e.text))return pC(e.text,r);if(typeof e.label=="string")return e.label;try{const n=String(e);if(n&&n!=="[object Object]")return n}catch{}}return""}function VQ(e,t,r,n="",o=dC){const a=typeof n=="string"?n:"",i=[];e&&(typeof e=="object"||typeof e=="function")&&i.push(e),t&&t!==e&&(typeof t=="object"||typeof t=="function")&&i.push(t);for(let s=0;s<i.length;s+=1){const l=i[s];let c;try{c=l[r]}catch{c=void 0}if(typeof c>"u"||c===null)continue;const u=pC(c,o);if(typeof u=="string")return u}return a}function qQ(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const Kg=qQ();if(Kg){const e=Kg.cineCoreTextEntries&&typeof Kg.cineCoreTextEntries=="object"?Kg.cineCoreTextEntries:{};e.TEXT_ENTRY_SEPARATOR=dC,e.normaliseTextEntryValue=pC,e.resolveTextEntry=VQ;try{Kg.cineCoreTextEntries=e}catch{}}(function(){typeof window<"u"&&(window.ensureSvgHasAriaHidden||(window.ensureSvgHasAriaHidden=function(e){return e}))})();const pd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};var ua=pd,$p=pd;pd.AppCore;pd.localization;function KQ(e){return typeof e!="string"?"":e.trim()}function tV(e,t){if(typeof pd[e]<"u")return pd[e];const r=typeof t=="function"?t():t;return pd[e]=r,r}var rV=typeof cineLocale<"u"&&cineLocale&&typeof cineLocale.resolveDocumentDirection=="function"?cineLocale.resolveDocumentDirection:function(t){return"ltr"};const gs=typeof cineLocale<"u"&&cineLocale&&typeof cineLocale.applyLocaleMetadata=="function"?cineLocale.applyLocaleMetadata:function(t,r,n){},WQ=(function(){if(typeof require=="function")try{const n=require("./runtime/bootstrap.js");if(n&&typeof n=="object")return n}catch{}const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}r(typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global);for(let n=0;n<t.length;n+=1){const o=t[n];try{const a=o&&o.cineRuntimeBootstrapExports;if(a&&typeof a=="object")return a}catch{}}return null})(),YQ=[],{fallbackResolveRuntimeModuleLoader:QQ=function(){return null},fallbackRequireCoreRuntimeModule:uI=function(){return null},exposeCoreRuntimeConstant:Ut=function(t,r){typeof window<"u"&&(window[t]=r),typeof globalThis<"u"&&(globalThis[t]=r)},exposeCoreRuntimeConstants:XQ=function(){},CORE_BOOT_QUEUE_KEY:JQ="__coreRuntimeBootQueue",CORE_BOOT_QUEUE:ZQ=YQ,enqueueCoreBootTask:KD,getGridSnapState:nV=function(){return"normal"},setGridSnapState:Gge,applyLegacyGridSnapValue:WD,collectCoreRuntimeCandidateScopes:oV=function(t){return t?[t]:[]}}=WQ||{},fI=ZQ,Pf=typeof KD=="function"?KD:function(t){if(typeof t=="function")try{fI.push(t)}catch{try{t()}catch{}}return fI.length},e6=typeof WD=="function"?WD:function(t){return typeof t>"u"?nV():t},jL=[typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null].filter(e=>e&&(typeof e=="object"||typeof e=="function")),YD=Object.freeze({fahrenheit:"fahrenheit",celsius:"celsius"}),{normalizeVideoType:Mge,normalizeFizConnectorType:_ge,normalizeViewfinderType:Dge,normalizePowerPortType:Nge,fixPowerInput:Fge,applyFixPowerInput:jge,ensureList:Hge,markDevicesNormalized:t6,hasNormalizedDevicesMarker:Uge,unifyDevices:aV,normalizeDevicesForPersistence:iV}=typeof cineDeviceNormalization<"u"?cineDeviceNormalization:typeof globalThis<"u"&&globalThis.cineDeviceNormalization||{};typeof window<"u"&&(window.normalizeDevicesForPersistence=iV);const Oa=(function(){const t=jL;for(let r=0;r<t.length;r+=1){const n=t[r];try{const o=n.TEMPERATURE_UNITS;if(o&&typeof o=="object"&&typeof o.fahrenheit=="string"&&typeof o.celsius=="string")return o}catch{}}return t.forEach(r=>{try{r.TEMPERATURE_UNITS||(r.TEMPERATURE_UNITS=YD)}catch{}}),YD})();var r6=(function(){const t=jL;for(let r=0;r<t.length;r+=1){const n=t[r];try{if(Array.isArray(n.TEMPERATURE_SCENARIOS))return n.TEMPERATURE_SCENARIOS}catch{}}return t.forEach(r=>{try{Array.isArray(r.TEMPERATURE_SCENARIOS)||(r.TEMPERATURE_SCENARIOS=[])}catch{}}),[]})();const QD=Object.freeze(["metric","imperial"]),n6=(function(){const t=jL;for(let r=0;r<t.length;r+=1){const n=t[r];try{if(Array.isArray(n.FOCUS_SCALE_VALUES)&&n.FOCUS_SCALE_VALUES.length)return n.FOCUS_SCALE_VALUES}catch{}}return t.forEach(r=>{try{(!Array.isArray(r.FOCUS_SCALE_VALUES)||!r.FOCUS_SCALE_VALUES.length)&&(r.FOCUS_SCALE_VALUES=QD)}catch{}}),QD})();function sV(e,t){const r=jL;for(let n=0;n<r.length;n+=1){const o=r[n];try{const a=o&&o[e];if(typeof a=="number"&&Number.isFinite(a))return a}catch{}}return r.forEach(n=>{try{const o=n&&n[e];(typeof o!="number"||!Number.isFinite(o))&&(n[e]=t)}catch{}}),t}globalThis.FEEDBACK_TEMPERATURE_MIN_VALUE=sV("FEEDBACK_TEMPERATURE_MIN",-20);globalThis.FEEDBACK_TEMPERATURE_MAX_VALUE=sV("FEEDBACK_TEMPERATURE_MAX_LIMIT",50);globalThis.INSTALL_BANNER_DISMISSED_KEY="cine_install_banner_dismissed";globalThis.AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE=1;const ym=(function(){const t=[];try{typeof CORE_RUNTIME_SUPPORT_EXPORTS=="object"&&CORE_RUNTIME_SUPPORT_EXPORTS&&t.push(CORE_RUNTIME_SUPPORT_EXPORTS)}catch{}try{typeof cineCoreRuntimeSupportExports<"u"&&cineCoreRuntimeSupportExports&&typeof cineCoreRuntimeSupportExports=="object"&&t.push(cineCoreRuntimeSupportExports)}catch{}for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n=="object")return n}return null})(),o6=ym&&typeof ym.resolveRuntimeModuleLoader=="function"?function(){return ym.resolveRuntimeModuleLoader()}:QQ,a6=typeof globalThis=="object"&&globalThis&&typeof globalThis.resolveRuntimeModuleLoader=="function"?globalThis.resolveRuntimeModuleLoader:o6;typeof globalThis=="object"&&globalThis&&typeof globalThis.resolveRuntimeModuleLoader!="function"&&(globalThis.resolveRuntimeModuleLoader=a6);const i6=ym&&typeof ym.requireCoreRuntimeModule=="function"?function(t,r){return ym.requireCoreRuntimeModule(t,r)}:uI,HL=typeof globalThis=="object"&&globalThis&&typeof globalThis.requireCoreRuntimeModule=="function"?globalThis.requireCoreRuntimeModule:i6;typeof globalThis=="object"&&globalThis&&typeof globalThis.requireCoreRuntimeModule!="function"&&(globalThis.requireCoreRuntimeModule=HL);typeof resolveCoreSupportModule>"u"&&(window.resolveCoreSupportModule=function(e,t){if(typeof require=="function")try{return require(t)}catch{return null}return null});let dI=typeof localizationBootstrapWiring<"u"?localizationBootstrapWiring:null;if(!dI&&typeof require=="function")try{dI=require("./app-core-bootstrap.js").localizationBootstrapWiring}catch{}const{localizationSupport:zge,localizationRuntimeEnvironment:$ge,localizationBridge:s6,localizationFallbacks:l6,inlineLocalizationFallbacks:c6,localizationFallbackSupport:u6,createBasicLocalizationFallbackResolvers:Vge,localizationFallbackRegistry:f6,localizationFallbackResolvers:d6,localizationFallbackNamespace:p6,fallbackResolveLocaleModule:m6,createLocaleFallbacks:g6}=dI||{};resolveCoreSupportModule("cineCoreRuntimeTools","./modules/core/runtime-tools.js");const pT=resolveCoreSupportModule("cineCoreRuntimeToolFallbacks","./modules/core/runtime-tool-fallbacks.js");resolveCoreSupportModule("cineCoreAppRuntimeToolInlineFallbacks","./modules/app-core/runtime.js");const mT=resolveCoreSupportModule("cineCoreAppSettingsDocumentationTracker","./modules/app-core/settings-documentation-tracker.js");let Yl=typeof PINK_MODE_SUPPORT_API<"u"?PINK_MODE_SUPPORT_API:null;Yl||(typeof cineCorePinkModeSupport<"u"?Yl=cineCorePinkModeSupport:typeof window<"u"&&window.cineCorePinkModeSupport?Yl=window.cineCorePinkModeSupport:typeof globalThis<"u"&&globalThis.cineCorePinkModeSupport&&(Yl=globalThis.cineCorePinkModeSupport));if(!Yl&&typeof require=="function")try{Yl=require("./app-core-pink-mode.js").PINK_MODE_SUPPORT_API}catch{}const{pinkModeIcons:y6,setPinkModeIconSequence:lV,loadPinkModeIconsFromFiles:h6,ensurePinkModeLottieRuntime:b6,resolvePinkModeLottieRuntime:pI,startPinkModeAnimatedIcons:S6,stopPinkModeAnimatedIcons:v6,triggerPinkModeIconRain:E6,getPinkModeIconRotationTimer:XD,setPinkModeIconRotationTimer:JD,getPinkModeIconIndex:ZD,setPinkModeIconIndex:eN,PINK_MODE_ICON_INTERVAL_MS:qge,PINK_MODE_ICON_ANIMATION_CLASS:Kge,PINK_MODE_ICON_ANIMATION_RESET_DELAY:Wge,PINK_MODE_ICON_FALLBACK_MARKUP:A6}=Yl||{};let mC=function(e){return e||""};Yl&&typeof Yl.ensureSvgHasAriaHidden=="function"?mC=Yl.ensureSvgHasAriaHidden:typeof window<"u"&&typeof window.ensureSvgHasAriaHidden=="function"&&(mC=window.ensureSvgHasAriaHidden);function Jc(e,t="info-icon",r=null){if(!e)return"";let n={},o="info-icon";typeof t=="string"||t===null?(o=t||"",r&&typeof r=="object"&&(n=r)):t&&typeof t=="object"&&(n=t,o=t.className||"info-icon"),typeof n.className=="string"&&(o=n.className);const a=[];typeof n.size=="string"&&n.size.trim()&&a.push(`--icon-size: ${n.size.trim()}`),typeof n.scale=="string"&&n.scale.trim()&&a.push(`--icon-scale: ${n.scale.trim()}`),typeof n.style=="string"&&n.style.trim()&&a.push(n.style.trim());const i=a.length?` style="${a.join(";")}"`:"",s=resolveIconGlyph(e),l=["icon-glyph"];if(o&&l.unshift(o),s.markup){s.className&&s.className.split(/\s+/).filter(Boolean).forEach(f=>l.push(f));const u=mC(s.markup);return`<span class="${l.join(" ")}"${i} aria-hidden="true">${u}</span>`}const c=s.char||"";return c?`<span class="${l.join(" ")}"${i} data-icon-font="${s.font}" aria-hidden="true">${c}</span>`:""}const C6=iconGlyph("",ICON_FONT_KEYS.UICONS),w6=iconGlyph("",ICON_FONT_KEYS.UICONS),tN=iconGlyph("",ICON_FONT_KEYS.UICONS),L6=iconGlyph("",ICON_FONT_KEYS.UICONS),R6=iconGlyph("",ICON_FONT_KEYS.UICONS);Ut("iconGlyph",iconGlyph);Ut("resolveIconGlyph",resolveIconGlyph);Ut("applyIconGlyph",applyIconGlyph);Ut("formatSvgCoordinate",formatSvgCoordinate);Ut("positionSvgMarkup",positionSvgMarkup);Ut("iconMarkup",Jc);Ut("ICON_GLYPHS",ICON_GLYPHS);Ut("pinkModeIcons",y6);Ut("setPinkModeIconSequence",lV);Ut("ensureSvgHasAriaHidden",mC);Ut("ensurePinkModeLottieRuntime",b6);Ut("resolvePinkModeLottieRuntime",pI);Ut("startPinkModeAnimatedIcons",S6);Ut("stopPinkModeAnimatedIcons",v6);Ut("triggerPinkModeIconRain",E6);const hm=(function(){let t=null;if(typeof resolveCoreSupportModule=="function")try{t=resolveCoreSupportModule("cineCoreRuntimeState","./modules/core/runtime-state.js")}catch{t=null}if(!t){const n=HL("modules/core/runtime-state.js");n&&typeof n=="object"&&(t=n)}if(t)return t;const r=oV(typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null);for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object"))try{const a=o.cineCoreRuntimeState;if(a&&typeof a=="object")return a}catch{}}return null})(),gT=(function(){if(typeof resolveCoreSupportModule=="function")try{const n=resolveCoreSupportModule("cineCoreRuntimeLocalization","./modules/core/runtime-localization.js");if(n&&typeof n=="object")return n}catch{}const t=[ua&&typeof ua=="object"?ua:null,typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&window&&typeof window=="object"?window:null,typeof self<"u"&&self&&typeof self=="object"?self:null,typeof global<"u"&&global&&typeof global=="object"?global:null];for(let n=0;n<t.length;n+=1){const o=t[n];if(!(!o||typeof o!="object"))try{const a=o.cineCoreRuntimeLocalization;if(a&&typeof a=="object")return a}catch{}}const r=HL("modules/core/runtime-localization.js",{primaryScope:ua});return r&&typeof r=="object"?r:null})();gT&&typeof gT.createLocalizationRuntime=="function"&&gT.createLocalizationRuntime({runtimeScope:ua,coreGlobalScope:ua,localizationBridge:s6,localizationFallbacks:l6,inlineLocalizationFallbacks:c6,localizationFallbackNamespace:p6,localizationFallbackSupport:u6,localizationFallbackRegistry:f6,localizationFallbackResolvers:d6,fallbackResolveLocaleModule:m6,createLocaleFallbacks:g6,translationsRequirePath:"./translations.js"});if(ua&&ua.__cineCorePart1Initialized)typeof console<"u"&&typeof console.warn=="function"&&console.warn("Cine Power Planner core runtime (part 1) already initialized. Skipping duplicate load.");else if(ua)try{Object.defineProperty(ua,"__cineCorePart1Initialized",{configurable:!0,writable:!0,value:!0})}catch{ua.__cineCorePart1Initialized=!0}var Vt={},rN=pT&&typeof pT.createRuntimeToolFallbacks=="function"?pT.createRuntimeToolFallbacks:null;if(!rN){const e=HL("modules/core/runtime-tool-fallbacks.js",{primaryScope:ua});e&&typeof e.createRuntimeToolFallbacks=="function"&&(rN=e.createRuntimeToolFallbacks)}const zS=typeof CORE_RUNTIME_GLOBAL_TOOLS=="object"&&CORE_RUNTIME_GLOBAL_TOOLS||typeof cineCoreRuntimeGlobalTools=="object"&&cineCoreRuntimeGlobalTools||null;zS&&zS.CORE_RUNTIME_TOOL_FALLBACKS&&typeof CORE_RUNTIME_TOOL_FALLBACKS<"u"&&zS.CORE_RUNTIME_TOOL_FALLBACKS!==CORE_RUNTIME_TOOL_FALLBACKS&&(CORE_RUNTIME_TOOL_FALLBACKS=zS.CORE_RUNTIME_TOOL_FALLBACKS);var ng="__cinePendingTemperatureNote",iS="renderTemperatureNote",cV=(function(){const t={queueKey:ng,renderName:iS};if(hm&&typeof hm.resolveTemperatureKeyDefaults=="function")try{const r=hm.resolveTemperatureKeyDefaults();r&&typeof r=="object"&&(typeof r.queueKey=="string"&&r.queueKey&&(t.queueKey=r.queueKey),typeof r.renderName=="string"&&r.renderName&&(t.renderName=r.renderName))}catch{}return(typeof t.queueKey!="string"||!t.queueKey)&&(t.queueKey="__cinePendingTemperatureNote"),(typeof t.renderName!="string"||!t.renderName)&&(t.renderName="renderTemperatureNote"),t})();ng=cV.queueKey;iS=cV.renderName;const Yu=(function(){const t=[];if(typeof require=="function")try{const n=require("./app-core-runtime-ui.js");n&&typeof n=="object"&&t.push(n)}catch{}const r=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&r.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&r.push(globalThis),typeof window<"u"&&window&&r.push(window),typeof self<"u"&&self&&r.push(self),typeof global<"u"&&global&&r.push(global);for(let n=0;n<r.length;n+=1){const o=r[n];if(o)try{const a=o.cineCoreRuntimeUiBridge;a&&typeof a=="object"&&t.push(a)}catch{}}for(let n=0;n<t.length;n+=1){const o=t[n];if(o&&typeof o=="object")return o}return{}})();var T6=typeof Yu.escapeHtml=="function"?Yu.escapeHtml:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};const O6=typeof Yu.escapeButtonLabelSafely=="function"?Yu.escapeButtonLabelSafely:function(t){return typeof t!="string"||t===""?"":T6(t)},x6=typeof Yu.resolveButtonIconMarkup=="function"?Yu.resolveButtonIconMarkup:function(){return""},rt=tV("setButtonLabelWithIcon",function(){return typeof Yu.setButtonLabelWithIcon=="function"?Yu.setButtonLabelWithIcon:function(r,n,o){if(!r)return;let a=o;if(typeof a>"u")try{typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.save&&(a=ICON_GLYPHS.save)}catch{}const i=x6(a),s=O6(typeof n=="string"?n:"");try{r.innerHTML=`${i}${s}`}catch{}}});if(CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object")try{CORE_GLOBAL_SCOPE.setButtonLabelWithIcon=rt}catch{CORE_GLOBAL_SCOPE.setButtonLabelWithIcon=rt}function yT(e){const t=getCoreGlobalObject();let r=null;if(!r&&Fc&&typeof Fc.getAssignedTemperatureRenderer=="function")try{r=Fc.getAssignedTemperatureRenderer()}catch{}try{typeof renderTemperatureNote=="function"&&(r=renderTemperatureNote)}catch(o){if(!(o&&(o.name==="ReferenceError"||/is not defined|Cannot access uninitialized/i.test(String(o&&o.message)))))throw o}if(!r&&t&&typeof t=="object")try{const o=t[iS];typeof o=="function"&&(r=o)}catch{}if(typeof r=="function"){try{r(e)}catch(o){typeof console<"u"&&typeof console.error=="function"&&console.error("Temperature note renderer failed",o)}return}if(!t||typeof t!="object")return;let n=t[ng];(!n||typeof n!="object")&&(n={}),n.latestHours=e;try{n.updatedAt=Date.now?Date.now():new Date().getTime()}catch{n.updatedAt=0}t[ng]=n}function k6(e){if(!e||typeof e!="object")return;const t=CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;!t||typeof t!="object"||Object.entries(e).forEach(([r,n])=>{if(typeof r!="string"||!r)return;const o=n&&typeof n.get=="function"?n.get:null,a=n&&typeof n.set=="function"?n.set:null;if(o){try{Object.defineProperty(t,r,{configurable:!0,enumerable:!1,get:o,set:a||void 0});return}catch{}try{t[r]=o()}catch{}}})}function nN(e){if(typeof e!="function")return!1;const t=CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;try{return e.call(t||this),!0}catch(r){typeof console<"u"&&typeof console.error=="function"&&console.error("Cine Power Planner core runtime segment failed to evaluate.",r)}return!1}if(CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object")try{Object.defineProperty(CORE_GLOBAL_SCOPE,"__cineCorePart1Runner",{configurable:!0,enumerable:!1,writable:!0,value:nN})}catch{CORE_GLOBAL_SCOPE.__cineCorePart1Runner=nN}function I6(){if(CORE_GLOBAL_SCOPE&&CORE_GLOBAL_SCOPE.cineCoreShared)return CORE_GLOBAL_SCOPE.cineCoreShared;if(typeof require=="function")try{return require("./modules/core-shared.js")}catch{}return null}const Ur=I6()||{};function P6(){const e=[];if(typeof CORE_PART2_RUNTIME_HELPERS<"u"&&CORE_PART2_RUNTIME_HELPERS&&e.push(CORE_PART2_RUNTIME_HELPERS),Ur&&typeof Ur.cineCoreRuntimeHelpers=="object"&&e.push(Ur.cineCoreRuntimeHelpers),typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE.cineCoreRuntimeHelpers=="object"&&e.push(CORE_GLOBAL_SCOPE.cineCoreRuntimeHelpers),typeof CORE_SHARED_SCOPE_PART2<"u"&&CORE_SHARED_SCOPE_PART2&&typeof CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers=="object"&&e.push(CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers),typeof globalThis<"u"&&globalThis&&typeof globalThis.cineCoreRuntimeHelpers=="object"&&e.push(globalThis.cineCoreRuntimeHelpers),typeof window<"u"&&window&&typeof window.cineCoreRuntimeHelpers=="object"&&e.push(window.cineCoreRuntimeHelpers),typeof self<"u"&&self&&typeof self.cineCoreRuntimeHelpers=="object"&&e.push(self.cineCoreRuntimeHelpers),typeof global<"u"&&global&&typeof global.cineCoreRuntimeHelpers=="object"&&e.push(global.cineCoreRuntimeHelpers),typeof require=="function")try{const t=require("./app-core-runtime-helpers.js");t&&typeof t=="object"&&e.push(t)}catch{}for(let t=0;t<e.length;t+=1){const r=e[t];if(r&&typeof r=="object")return r}return null}const hT=P6(),Ma=hT&&typeof hT=="object"?hT:{};function B6(e){const t=[],r=typeof Set=="function"?new Set:null;function n(m){if(!(!m||typeof m!="object"&&typeof m!="function")){if(r){if(r.has(m))return;r.add(m),t.push(m);return}t.indexOf(m)===-1&&t.push(m)}}if(Array.isArray(e))for(let m=0;m<e.length;m+=1)try{n(e[m])}catch{}function o(m){if(typeof m=="function")for(let g=0;g<t.length;g+=1)try{m(t[g],g)}catch{}}function a(){return t.slice()}function i(){return t.length>0?t[0]:null}function s(m,g){const S=typeof g=="function"?g:function(){return g};if(typeof m!="string"||!m)try{return S()}catch{return}for(let y=0;y<t.length;y+=1){const E=t[y];if(!(!E||typeof E!="object"&&typeof E!="function"))try{return typeof E[m]>"u"&&(E[m]=S()),E[m]}catch{}}try{return S()}catch{return}}function l(m,g,S){const y=typeof S=="function"?S:function(){return S},E=typeof g=="function"?g:function(){return!0};o(L=>{try{E(L[m])||(L[m]=y())}catch(v){}})}function c(m){for(let g=0;g<t.length;g+=1){const S=t[g];if(!(!S||typeof S!="object"&&typeof S!="function"))try{if(m in S)return S[m]}catch{}}}let u=null;function f(m){typeof m=="function"&&(u=m,o(g=>{if(!(!g||typeof g!="object"&&typeof g!="function"))try{g[iS]=m;const S=g[ng];if(S&&typeof S=="object"){if(Object.prototype.hasOwnProperty.call(S,"latestHours")){const y=S.latestHours;if(typeof y<"u")try{m(y)}catch(E){typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to apply pending temperature note render",E)}}try{delete S.latestHours}catch(y){S.latestHours=void 0}}}catch(S){}}))}function d(){return u}const p={isReferenceError(){return!1},repair(){}};function h(m){!m||typeof m!="object"||(typeof m.isReferenceError=="function"&&(p.isReferenceError=m.isReferenceError),typeof m.repair=="function"&&(p.repair=m.repair))}return{registerScope:n,withEachScope:o,getScopes:a,getPrimaryScope:i,ensureValue:s,normaliseValue:l,readValue:c,assignTemperatureRenderer:f,getAssignedTemperatureRenderer:d,autoGearGuards:p,setAutoGearGuards:h}}function mI(e){if(hm&&typeof hm.createLocalRuntimeState=="function")try{return hm.createLocalRuntimeState(e,{temperatureQueueKey:ng,temperatureRenderName:iS})}catch{}return B6(e)}var Fc=tV("__cineRuntimeState",()=>{const e=CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED.length?CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED:oV(typeof CORE_GLOBAL_SCOPE=="object"?CORE_GLOBAL_SCOPE:null);return mI(e)});if(CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object")try{Object.defineProperty(CORE_GLOBAL_SCOPE,"__cineCreateRuntimeState",{configurable:!0,enumerable:!1,writable:!0,value:mI})}catch{try{CORE_GLOBAL_SCOPE.__cineCreateRuntimeState=mI}catch{}}function G6(e){if(!Fc||!Fc.autoGearGuards)return!1;const t=Fc.autoGearGuards.isReferenceError;if(typeof t!="function")return!1;try{return t(e)===!0}catch{}return!1}function M6(e){if(!Fc||!Fc.autoGearGuards)return;const t=Fc.autoGearGuards.repair;if(typeof t=="function")try{t(e)}catch{}}function kr(e,t=[],r={}){const n=CORE_GLOBAL_SCOPE||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null),o=typeof e=="string"?n&&n[e]:e;if(typeof o=="function"){if(o.__cineSessionProxy__===!0){const i=r&&typeof r=="object"?r:{},s=typeof i.attempts=="number"&&Number.isFinite(i.attempts)?i.attempts:0;if(typeof Pf=="function"&&s<3){const l={...i,defer:!1,attempts:s+1};Pf(()=>{kr(e,t,l)})}return Object.prototype.hasOwnProperty.call(i,"defaultValue")?i.defaultValue:void 0}if(o.__cineDeferredPlaceholder__===!0){const i=r&&typeof r=="object"?r:{},s=typeof i.attempts=="number"&&Number.isFinite(i.attempts)?i.attempts:0;if(typeof Pf=="function"&&s<3){const l={...i,defer:!1,attempts:s+1};Pf(()=>{kr(e,t,l)})}return}let a=0;for(;a<2;)try{return o.apply(n,t)}catch(i){if(a===0&&G6(i)){M6(n),a+=1;continue}typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,i);break}return}return r&&r.defer===!0&&Pf(()=>{kr(e,t,{...r,defer:!1})}),typeof r<"u"&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}Ut("applyLegacyGridSnapValue",e6);function _6(e,...t){if(typeof formatWithPlaceholders=="function")try{return formatWithPlaceholders(e,...t)}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to format placeholder template via direct formatter.",o)}const r=kr("formatWithPlaceholders",[e,...t],{defaultValue:null});if(typeof r=="string"&&r)return r;let n=typeof e=="string"?e:String(e||"");for(let o=0;o<t.length;o+=1){const a=t[o];n=n.replace("%s",a)}return n}(function(){const t=CORE_GLOBAL_SCOPE||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null);if(!t||typeof t!="object")return;if(typeof t.populateSelect!="function"){const n=function(a,i={},s=!0){if(!a)return;const l=i&&typeof i=="object"?i:{};try{if(a.innerHTML="",s){const c=document.createElement("option");c.value="None";const u={de:"Keine Auswahl",es:"Ninguno",fr:"Aucun"},f=typeof jt=="string"?jt:"en";c.textContent=u[f]||"None",a.appendChild(c)}Object.keys(l).filter(c=>c!=="None").sort(typeof localeSort=="function"?localeSort:void 0).forEach(c=>{const u=document.createElement("option");u.value=c,u.textContent=c,a.appendChild(u)})}catch(c){typeof console<"u"&&typeof console.warn=="function"&&console.warn("populateSelect placeholder failed to render options immediately",c)}Pf(()=>{const c=t&&typeof t.populateSelect=="function"&&t.populateSelect!==n?t.populateSelect:null;c&&c(a,i,s)})};n.__cineDeferredPlaceholder__=!0;try{t.populateSelect=n}catch{}}const r=n=>{if(typeof n!="string"||!n||typeof t[n]=="function")return;const o=function(...i){return kr(n,i,{defer:!0,attempts:0})};o.__cineDeferredPlaceholder__=!0;try{t[n]=o}catch{}};if(r("checkSetupChanged"),r("updateCalculations"),typeof t.feedbackCancelBtn>"u")try{t.feedbackCancelBtn=null}catch{}})();var D6=typeof Ur.stableStringify=="function"?Ur.stableStringify:typeof Ur.fallbackStableStringify=="function"?Ur.fallbackStableStringify:typeof Ma.fallbackStableStringify=="function"?Ma.fallbackStableStringify:function(t){try{return JSON.stringify(t)}catch{}return String(t)};const N6=typeof Ur.humanizeKey=="function"?Ur.humanizeKey:typeof Ur.fallbackHumanizeKey=="function"?Ur.fallbackHumanizeKey:typeof Ma.fallbackHumanizeKey=="function"?Ma.fallbackHumanizeKey:function(t){const r=typeof t=="string"?t:String(t||"");return r.charAt(0).toUpperCase()+r.slice(1)};function F6(){const e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof global<"u"&&e.push(global),typeof self<"u"&&e.push(self);for(const t of e)if(t&&typeof t.generateConnectorSummary=="function")return t.generateConnectorSummary;return null}const j6=typeof Ur.resolveConnectorSummaryGenerator=="function"?Ur.resolveConnectorSummaryGenerator:F6;let oN=typeof Ur.safeGenerateConnectorSummary=="function"?Ur.safeGenerateConnectorSummary:function(t){if(!t)return"";const r=j6();if(typeof r!="function")return"";try{return r(t)||""}catch(n){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to generate connector summary",n),""}};const H6=typeof Ur.normalizeAutoGearWeightOperator=="function"?Ur.normalizeAutoGearWeightOperator:typeof Ma.fallbackNormalizeAutoGearWeightOperator=="function"?Ma.fallbackNormalizeAutoGearWeightOperator:function(){return"greater"};typeof Ur.normalizeAutoGearWeightValue=="function"?Ur.normalizeAutoGearWeightValue:typeof Ma.fallbackNormalizeAutoGearWeightValue=="function"&&Ma.fallbackNormalizeAutoGearWeightValue;typeof Ur.normalizeAutoGearCameraWeightCondition=="function"?Ur.normalizeAutoGearCameraWeightCondition:typeof Ma.fallbackNormalizeAutoGearCameraWeightCondition=="function"&&Ma.fallbackNormalizeAutoGearCameraWeightCondition;const U6=typeof Ur.formatAutoGearWeight=="function"?Ur.formatAutoGearWeight:typeof Ma.fallbackFormatAutoGearWeight=="function"?Ma.fallbackFormatAutoGearWeight:function(t){return Number.isFinite(t)?String(t):""},z6=typeof Ma.fallbackGetAutoGearCameraWeightOperatorLabel=="function"?Ma.fallbackGetAutoGearCameraWeightOperatorLabel:function(t,r){const n=r||{},o=H6(t);return o==="less"?n.autoGearCameraWeightOperatorLess||"Lighter than":o==="equal"?n.autoGearCameraWeightOperatorEqual||"Exactly":n.autoGearCameraWeightOperatorGreater||"Heavier than"},$6=typeof Ur.getAutoGearCameraWeightOperatorLabel=="function"?Ur.getAutoGearCameraWeightOperatorLabel:z6,V6=typeof Ma.fallbackFormatAutoGearCameraWeight=="function"?Ma.fallbackFormatAutoGearCameraWeight:function(t,r){if(!t||!Number.isFinite(t.value))return"";const n=$6(t.operator,r),o=U6(t.value);return n?`${n} ${o} g`:`${o} g`};typeof Ur.formatAutoGearCameraWeight=="function"&&Ur.formatAutoGearCameraWeight;var gC=Ur.LZString;!gC&&typeof Ur.getLZString=="function"&&(gC=Ur.getLZString());gC||(gC={compressToEncodedURIComponent:e=>e,decompressFromEncodedURIComponent:e=>e});var q6;try{({generatePrintableOverview:q6}=require("./overview.js"))}catch{}function K6(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}function W6(e){return e?typeof e=="string"?e:typeof e.APP_VERSION=="string"?e.APP_VERSION:typeof e.default=="string"?e.default:typeof e.version=="string"?e.version:null:null}function Y6(){if(typeof Ur.APP_VERSION=="string"&&Ur.APP_VERSION)return Ur.APP_VERSION;const e=K6();if(e&&typeof e.CPP_APP_VERSION=="string"&&e.CPP_APP_VERSION)return e.CPP_APP_VERSION;if(e&&typeof e.APP_VERSION=="string"&&e.APP_VERSION)return e.APP_VERSION;if(typeof require=="function")try{const t=require("../../app-version.js"),r=W6(t);if(r)return r}catch{}return"0.0.0"}var Q6=Y6();typeof pI=="function"?pI():typeof window.resolvePinkModeLottieRuntime=="function"&&window.resolvePinkModeLottieRuntime();var X6="iosPwaHelpShown";const cG="installPromptDismissed";function J6(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}const nl=J6();nl&&typeof nl.installBannerDismissedInSession!="boolean"&&(nl.installBannerDismissedInSession=!1);const bT="__cineResolvedHelpModule";function Z6(){return{resolveIosPwaHelpStorageKey(e){return typeof e=="string"&&e?e:X6},isIosDevice(){return!1},isAndroidDevice(){return!1},isStandaloneDisplayMode(){return!1},hasDismissedIosPwaHelp(){return!1},markIosPwaHelpDismissed(){},shouldShowIosPwaHelp(){return!1}}}function e8(){const e=getCoreGlobalObject();if(e&&e[bT])return e[bT];const t=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);function r(s,l){if(t&&typeof t.safeWarn=="function")try{t.safeWarn(s,l);return}catch{}if(typeof console<"u"&&console&&typeof console.warn=="function")try{typeof l>"u"?console.warn(s):console.warn(s,l)}catch{}}const n=[];if(t&&typeof t.getModuleRegistry=="function"){let s=null;try{s=t.getModuleRegistry(e)}catch(l){r("Unable to resolve cine.features.help module registry.",l)}if(s&&typeof s.get=="function")try{const l=s.get("cine.features.help");l&&n.indexOf(l)===-1&&n.push(l)}catch(l){r("Unable to read cine.features.help module.",l)}}const o=[];e&&o.indexOf(e)===-1&&o.push(e),typeof globalThis<"u"&&o.indexOf(globalThis)===-1&&o.push(globalThis),typeof window<"u"&&o.indexOf(window)===-1&&o.push(window),typeof self<"u"&&o.indexOf(self)===-1&&o.push(self),typeof global<"u"&&o.indexOf(global)===-1&&o.push(global);for(let s=0;s<o.length;s+=1){const l=o[s];if(!(!l||typeof l!="object"&&typeof l!="function")){try{const c=l.cineFeaturesHelp;c&&n.indexOf(c)===-1&&n.push(c)}catch{}try{const c=l.cineHelpModule;c&&typeof c=="object"&&c&&typeof c.help=="object"&&n.indexOf(c.help)===-1&&n.push(c.help)}catch{}if(typeof l.__cineCreateHelpModule=="function")try{const c=l.__cineCreateHelpModule();c&&typeof c=="object"&&(typeof c.help=="object"&&n.indexOf(c.help)===-1?n.push(c.help):n.indexOf(c)===-1&&n.push(c))}catch(c){r("Unable to instantiate cine.features.help module.",c)}}}let a=null;for(let s=0;s<n.length;s+=1){const l=n[s];if(l&&typeof l=="object"&&typeof l.isIosDevice=="function"){a=l;break}if(l&&typeof l=="object"&&typeof l.help=="object"&&typeof l.help.isIosDevice=="function"){a=l.help;break}}const i=a||Z6();if(e)try{e[bT]=i}catch{}return i}const ST="__cineContactsModuleCache__",vT="__cineOwnGearModuleCache__",ET="__cineContactsOwnGearModuleCache__";function uG(e,t,r){try{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:r});return}catch{}try{e[t]=r}catch{}}function uV(){const e=getCoreGlobalObject();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,ET))return e[ET];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.contactsOwnGear");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const n=[];n.indexOf(e)===-1&&n.push(e),typeof globalThis<"u"&&n.indexOf(globalThis)===-1&&n.push(globalThis),typeof window<"u"&&n.indexOf(window)===-1&&n.push(window),typeof self<"u"&&n.indexOf(self)===-1&&n.push(self),typeof global<"u"&&n.indexOf(global)===-1&&n.push(global);for(let a=0;a<n.length;a+=1){const i=n[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesContactsOwnGear;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const o=t.find(a=>a&&typeof a=="object")||null;return uG(e,ET,o),o}function UL(){const e=getCoreGlobalObject();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,ST))return e[ST];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.contacts");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const n=[];n.indexOf(e)===-1&&n.push(e),typeof globalThis<"u"&&n.indexOf(globalThis)===-1&&n.push(globalThis),typeof window<"u"&&n.indexOf(window)===-1&&n.push(window),typeof self<"u"&&n.indexOf(self)===-1&&n.push(self),typeof global<"u"&&n.indexOf(global)===-1&&n.push(global);for(let a=0;a<n.length;a+=1){const i=n[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesContacts;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const o=t.find(a=>a&&typeof a=="object")||uV()||null;return uG(e,ST,o),o}function zL(){const e=getCoreGlobalObject();if(!e||typeof e!="object"&&typeof e!="function")return null;if(Object.prototype.hasOwnProperty.call(e,vT))return e[vT];const t=[],r=typeof cineModuleBase=="object"&&cineModuleBase||(e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null);if(r&&typeof r.getModuleRegistry=="function")try{const a=r.getModuleRegistry(e);if(a&&typeof a.get=="function"){const i=a.get("cine.features.ownGear");i&&t.indexOf(i)===-1&&t.push(i)}}catch{}const n=[];n.indexOf(e)===-1&&n.push(e),typeof globalThis<"u"&&n.indexOf(globalThis)===-1&&n.push(globalThis),typeof window<"u"&&n.indexOf(window)===-1&&n.push(window),typeof self<"u"&&n.indexOf(self)===-1&&n.push(self),typeof global<"u"&&n.indexOf(global)===-1&&n.push(global);for(let a=0;a<n.length;a+=1){const i=n[a];if(!(!i||typeof i!="object"&&typeof i!="function"))try{const s=i.cineFeaturesOwnGear;s&&typeof s=="object"&&t.indexOf(s)===-1&&t.push(s)}catch{}}const o=t.find(a=>a&&typeof a=="object")||uV()||null;return uG(e,vT,o),o}var Ba=e8();globalThis.helpModuleApi=Ba;var Hn=null;function t8(){const e=[];typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"&&e.push(CORE_GLOBAL_SCOPE),typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"&&e.push(globalThis),typeof window<"u"&&window&&typeof window=="object"&&e.push(window),typeof self<"u"&&self&&typeof self=="object"&&e.push(self),typeof global<"u"&&global&&typeof global=="object"&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object")){if(r.CORE_DEVICE_SCHEMA&&typeof r.CORE_DEVICE_SCHEMA=="object")return r.CORE_DEVICE_SCHEMA;if(r.cineCoreDeviceSchema&&typeof r.cineCoreDeviceSchema=="object")return r.cineCoreDeviceSchema}}return null}const Co=(function(){const t=t8();if(t&&typeof t.createDeviceSchemaManager=="function")try{return t.createDeviceSchemaManager({onSchemaChange:r=>{Hn=r},populateCategoryOptions:()=>{try{iq()}catch(r){console.error("populateCategoryOptions failed during scheduled execution",r)}}})}catch(r){console.warn("Failed to initialize device schema manager from core module",r)}return null})(),aN=Co&&Co.DEVICE_SCHEMA_PATH||"src/data/schema.json",r8=Co&&typeof Co.loadDeviceSchemaFromCacheStorage=="function"?Co.loadDeviceSchemaFromCacheStorage:async()=>null,Wg=Co&&typeof Co.finalizeDeviceSchemaLoad=="function"?Co.finalizeDeviceSchemaLoad:()=>{},fV=Co&&typeof Co.isValidDeviceSchema=="function"?Co.isValidDeviceSchema:e=>e&&typeof e=="object"&&!Array.isArray(e),iN=Co&&typeof Co.getCachedDeviceSchema=="function"?Co.getCachedDeviceSchema():null;if(Co&&typeof Co.getDeviceSchema=="function"){const e=Co.getDeviceSchema();e&&(Hn=e)}const sN=Co&&typeof Co.setDeviceSchema=="function"?e=>Co.setDeviceSchema(e):e=>(fV(e)?Hn=e:Hn||(Hn={}),Hn);let ZE=null,ab=null,ib=null;const n8="CINE_CONTACTS_PROFILE_MODULE",o8="CINE_CONTACTS_LIST_MODULE",a8=typeof require=="function";if(a8){try{ZE=require("../data/schema.json")}catch{}try{ab=require("./contacts/profile.js")}catch(e){console.warn("Failed to load contacts profile module",e)}try{ib=require("./contacts/list.js")}catch(e){console.warn("Failed to load contacts list module",e)}}const lN=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof window<"u"&&window||typeof global<"u"&&global||null,dV=e=>{if(!lN||!e)return null;try{return lN[e]||null}catch(t){return console.warn("Failed to read contacts module from global scope",t),null}};ab||(ab=dV(n8));ib||(ib=dV(o8));(!ab||!ib)&&console.warn("Module loader is not available in this environment. Contacts features limited.");const Lf=e=>typeof e=="string"?e.trim():"",i8=e=>({id:Lf(e&&e.id)||`contact-${Date.now().toString(36)}`,name:Lf(e&&e.name),role:Lf(e&&e.role),phone:Lf(e&&e.phone),email:Lf(e&&e.email),website:Lf(e&&e.website),avatar:typeof e?.avatar=="string"?e.avatar:"",createdAt:Number.isFinite(e?.createdAt)?e.createdAt:Date.now(),updatedAt:Number.isFinite(e?.updatedAt)?e.updatedAt:Date.now()});function s8(){const e={name:"",role:"",avatar:"",phone:"",email:""},t=new Set,r=()=>({...e}),n=()=>{const o=r();return t.forEach(a=>{try{a(o)}catch(i){console.warn("Profile listener failed in fallback controller",i)}}),o};return{assignUserProfileState(o={}){return Object.assign(e,o),n()},getUserProfileSnapshot:r,handleFieldInput(o,a){return o?(e[o]=typeof a=="string"?a:"",n(),!0):!1},handleFieldBlur(){},load(o){return o&&typeof o=="object"&&Object.assign(e,o),n()},setAvatar(o){e.avatar=typeof o=="string"?o:"",n()},clearAvatar(){return e.avatar?(e.avatar="",n(),!0):!1},onChange(o){return typeof o!="function"?()=>{}:(t.add(o),()=>t.delete(o))},schedulePersist(){},markDirty(){},setPendingAnnouncement(){}}}const{CONTACT_AVATAR_MAX_BYTES:Yge=300*1024,CONTACT_AVATAR_MAX_SOURCE_BYTES:Qge=6*1024*1024,CONTACT_AVATAR_MAX_DIMENSION:Xge=256,CONTACT_AVATAR_JPEG_QUALITY:Jge=.85,CONTACT_AVATAR_JPEG_MIN_QUALITY:Zge=.55,createProfileController:cN,estimateDataUrlSize:eye,optimiseAvatarDataUrl:tye,readAvatarFile:uN,isSafeImageUrl:fN}=ab||{},{sanitizeContactValue:dN,normalizeContactEntry:pN,sortContacts:mN,parseVCard:gN,mergeImportedContacts:yN,createCrewRowSync:hN}=ib||{},l8=typeof cN=="function"?cN:s8,sS=typeof uN=="function"?uN:typeof readAvatarFile=="function"?readAvatarFile:typeof window<"u"&&typeof window.readAvatarFile=="function"?window.readAvatarFile:(e,t,r)=>{if(e)try{const n=new FileReader;n.onload=()=>{typeof t=="function"&&t(n.result)},n.onerror=()=>{typeof r=="function"&&r("readError")},n.readAsDataURL(e)}catch{typeof r=="function"&&r("readError")}},c8=typeof fN=="function"?fN:e=>typeof e!="string"?!1:e.startsWith("data:image/"),u8=typeof dN=="function"?dN:Lf,f8=typeof pN=="function"?pN:i8,pV=typeof mN=="function"?mN:e=>Array.isArray(e)?e.slice():[],d8=typeof gN=="function"?gN:()=>[],p8=typeof yN=="function"?yN:e=>({contacts:pV([...e?.existing||[],...e?.imported||[]]),added:Array.isArray(e?.imported)?e.imported.length:0,updated:0}),bN=typeof hN=="function"?hN:(e={},t={})=>({...e,...t});try{if(console.log("[deviceSchema] Attempting to apply bundledSchema:",ZE?"exists":"null"),ZE){const e=sN(ZE);e&&(Hn=e,console.log("[deviceSchema] Successfully applied bundledSchema"))}if(!Hn||!Object.keys(Hn).length){if(console.log("[deviceSchema] bundledSchema not available, attempting fetch from:",aN),!Hn&&iN){const e=sN(iN);e&&(Hn=e,console.log("[deviceSchema] Applied cached schema as fallback"))}typeof fetch=="function"?fetch(aN).then(e=>{if(!e||!e.ok)throw new Error(`Unexpected response when loading schema.json: ${e?e.status:"no response"}`);return e.json()}).then(e=>{console.log("[deviceSchema] Successfully fetched schema.json, applying..."),Wg(e),e&&typeof e=="object"&&(Hn=e,console.log("[deviceSchema] deviceSchema updated from fetch. Categories:",Object.keys(Hn)))}).catch(e=>{console.warn("Failed to fetch schema.json",e),r8().then(t=>{fV(t)?Wg(t):Wg(Hn)}).catch(t=>{console.warn("Failed to load schema.json from cache storage",t),Wg(Hn)})}):Wg(Hn)}}catch(e){console.error("[deviceSchema] Error in schema loading:",e)}const SN={de:{imprint:"legal/impressum.html",privacy:"legal/datenschutz.html"},en:{imprint:"legal/impressum-en.html",privacy:"legal/datenschutz-en.html"},es:{imprint:"legal/impressum-es.html",privacy:"legal/datenschutz-es.html"},fr:{imprint:"legal/impressum-fr.html",privacy:"legal/datenschutz-fr.html"},it:{imprint:"legal/impressum-it.html",privacy:"legal/datenschutz-it.html"}};function Zc(e,t){const r=yC(e);return typeof r=="string"&&r?r:t}const m8=Zc("AUTO_GEAR_RULES_STORAGE_KEY","cameraPowerPlanner_autoGearRules"),mV="__any__";typeof globalThis<"u"&&(globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN=mV);Zc("AUTO_GEAR_SEEDED_STORAGE_KEY","cameraPowerPlanner_autoGearSeeded");const g8=36,vN=1,EN=50,y8=50;function yC(e){const t=[ua&&typeof ua=="object"?ua:null,$p&&(typeof $p=="object"||typeof $p=="function")?$p:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"&&typeof n!="function"))try{const o=n[e];if(typeof o<"u")return o}catch{}}}function gV(){const e=[],t=yC("AUTO_GEAR_BACKUP_RETENTION_MIN");typeof t<"u"&&e.push(t);for(let r=0;r<e.length;r+=1){const n=Number(e[r]);if(!Number.isFinite(n))continue;const o=Math.round(n);if(o>=vN)return o}return vN}function h8(){const e=gV(),t=typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null,r=t&&typeof t.AUTO_GEAR_BACKUP_RETENTION_MAX<"u"?t.AUTO_GEAR_BACKUP_RETENTION_MAX:void 0,n=typeof r<"u"?r:yC("AUTO_GEAR_BACKUP_RETENTION_MAX"),o=Number(n),a=Number.isFinite(o)&&o>=e?Math.min(Math.round(o),EN):EN,i=f=>{const d=Number(f);if(!Number.isFinite(d))return null;const p=Math.round(d);return p<e?e:p>a?a:p},s=[],l=t&&typeof t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT<"u"?t.AUTO_GEAR_BACKUP_RETENTION_DEFAULT:void 0;typeof l<"u"&&s.push(l);const c=yC("AUTO_GEAR_BACKUP_RETENTION_DEFAULT");if(typeof c<"u"&&s.push(c),typeof getAutoGearBackupRetentionDefault=="function")try{s.push(getAutoGearBackupRetentionDefault())}catch{}for(let f=0;f<s.length;f+=1){const d=i(s[f]);if(d!==null)return d}const u=i(g8);return u===null?e:u}Zc("AUTO_GEAR_BACKUPS_STORAGE_KEY","cameraPowerPlanner_autoGearBackups");Zc("AUTO_GEAR_PRESETS_STORAGE_KEY","cameraPowerPlanner_autoGearPresets");Zc("AUTO_GEAR_ACTIVE_PRESET_STORAGE_KEY","cameraPowerPlanner_autoGearActivePreset");Zc("AUTO_GEAR_AUTO_PRESET_STORAGE_KEY","cameraPowerPlanner_autoGearAutoPreset");Zc("AUTO_GEAR_BACKUP_VISIBILITY_STORAGE_KEY","cameraPowerPlanner_autoGearShowBackups");Zc("AUTO_GEAR_BACKUP_RETENTION_STORAGE_KEY","cameraPowerPlanner_autoGearBackupRetention");Zc("AUTO_GEAR_MONITOR_DEFAULTS_STORAGE_KEY","cameraPowerPlanner_autoGearMonitorDefaults");const b8=gV();h8();const S8=1;var v8="";const fG=["Camera","Camera Support","Media","Lens","Lens Support","Matte box + filter","LDS (FIZ)","Camera Batteries","Monitoring Batteries","Chargers","Monitoring","Monitoring support","Rigging","Power","Grip","Carts and Transportation","Miscellaneous","Consumables"],E8=["none","monitor","directorMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","fizHandUnit"],yV=E8.reduce((e,t)=>(e[t.toLowerCase()]=t,e),Object.create(null)),A8=new Set(Object.keys(yV)),C8=["SmallHD Ultra 7","SmallHD Focus","SmallHD Cine 7"],dG=new Set(["tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader"]),w8={tripodHeadBrand:"tripodHeadBrand",tripodBowl:"tripodBowl",tripodTypes:"tripodTypes",tripodSpreader:"tripodSpreader"};Ut("AUTO_GEAR_SELECTOR_TYPE_MAP",yV);Ut("AUTO_GEAR_SELECTOR_TYPE_SET",A8);Ut("AUTO_GEAR_TRIPOD_SELECTOR_TYPES",dG);Ut("AUTO_GEAR_TRIPOD_FIELD_IDS",w8);Ut("AUTO_GEAR_CUSTOM_CATEGORY",v8);Ut("GEAR_LIST_CATEGORIES",fG);const L8=Object.freeze([{key:"tilta-nucleus-m",label:"Tilta Nucleus ecosystem (M / M II)",motors:Object.freeze(["Tilta Nucleus M","Tilta Nucleus M II"]),options:Object.freeze(["Tilta Nucleus-M FIZ Hand Unit","Tilta Nucleus-M II FIZ Hand Unit","Tilta Nucleus Nano II Hand Controller"]),defaultOption:"Tilta Nucleus-M FIZ Hand Unit"},{key:"tilta-nucleus-nano",label:"Tilta Nucleus Nano ecosystem",motors:Object.freeze(["Tilta Nucleus Nano (Original)","Tilta Nucleus Nano II"]),options:Object.freeze(["Tilta Nucleus Nano Hand Wheel Controller","Tilta Nucleus Nano II Hand Controller"]),defaultOption:"Tilta Nucleus Nano Hand Wheel Controller"},{key:"arri-lbus",label:"ARRI / cmotion LBUS ecosystem",motors:Object.freeze(["Arri Cforce Mini","Arri Cforce Plus","Arri CLM-3","Arri CLM-4 (K2.72114.0)","Arri CLM-5 (K2.0006361)","Arri cforce mini RF (KK.0040345)","Cmotion cPRO"]),options:Object.freeze(["Arri Hi-5","Arri WCU-4","Arri SXU-1","cmotion cPRO hand unit"]),defaultOption:"Arri Hi-5"},{key:"teradek-rt",label:"Teradek RT ecosystem",motors:Object.freeze(["Teradek RT Motion FIZ (MOTR.S)"]),options:Object.freeze(["Teradek RT CTRL.3"]),defaultOption:"Teradek RT CTRL.3"},{key:"preston",label:"Preston ecosystem",motors:Object.freeze(["Preston DM1X","Preston DM2","Preston DM2X","Preston DM-A","Preston DM-C"]),options:Object.freeze(["Preston Hand Unit 4 (HU4)"]),defaultOption:"Preston Hand Unit 4 (HU4)"},{key:"chrosziel",label:"Chrosziel MagNum ecosystem",motors:Object.freeze(["Chrosziel CDM-100 Digital","Chrosziel CDM-M (Universal Zoom Servo Drive)"]),options:Object.freeze(["Chrosziel MagNum Hand Unit (MN-100R)"]),defaultOption:"Chrosziel MagNum Hand Unit (MN-100R)"},{key:"dji-focus",label:"DJI Focus ecosystem",motors:Object.freeze(["DJI Focus (Original)"]),options:Object.freeze(["DJI Focus Hand Unit"]),defaultOption:"DJI Focus Hand Unit"},{key:"dji-focus-pro",label:"DJI Focus Pro ecosystem",motors:Object.freeze(["DJI RS Focus (2022)","DJI Focus Pro Motor"]),options:Object.freeze(["DJI RS Focus Wheel (2022)","DJI Focus Pro Hand Unit"]),defaultOption:"DJI Focus Pro Hand Unit"},{key:"smallrig-magicfiz",label:"SmallRig MagicFIZ ecosystem",motors:Object.freeze(["SmallRig Wireless Follow Focus"]),options:Object.freeze(["SmallRig MagicFIZ Wireless Handgrip"]),defaultOption:"SmallRig MagicFIZ Wireless Handgrip"},{key:"redrock-microremote",label:"Redrock microRemote ecosystem",motors:Object.freeze(["Redrock MicroRemote Torque"]),options:Object.freeze(["Redrock microRemote Hand Controller"]),defaultOption:"Redrock microRemote Hand Controller"}]),hV=(()=>{const e=Object.create(null);return L8.forEach(t=>{if(!t||!t.key||!Array.isArray(t.options)||!t.options.length)return;const r=t.key,n=Array.from(new Set(t.options.filter(Boolean)));n.length&&(e[r]=Object.freeze({key:r,label:t.label||"",motors:t.motors||[],options:Object.freeze(n),defaultOption:n.includes(t.defaultOption)?t.defaultOption:n[0]}))}),Object.freeze(e)})(),R8=(()=>{const e=Object.create(null);return Object.values(hV).forEach(t=>{!t||!Array.isArray(t.motors)||t.motors.forEach(r=>{const n=KQ(r);!n||Object.prototype.hasOwnProperty.call(e,n)||(e[n]=t.key)})}),Object.freeze(e)})();typeof globalThis<"u"&&(globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=hV,globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=R8);var lc=readAutoGearRulesFromStorage(),hC=lc.slice(),gI=null,bV=readAutoGearBackupRetentionFromStorage(),AT=readAutoGearBackupsFromStorage(bV);readAutoGearPresetsFromStorage();readActiveAutoGearPresetIdFromStorage();var CT=readAutoGearAutoPresetIdFromStorage();readAutoGearBackupVisibilityFromStorage();var Ic=readAutoGearMonitorDefaultsFromStorage();persistAutoGearBackupRetention(bV);var sp=null,T8=null,$S="all";function VS(e){const t=e==="remove"?"remove":"add",r=t==="remove"?vq:Sq;if(!r)return;const n=getLanguageTexts(jt),o=getLanguageTexts(oo),a=T8?.listType===t,i=t==="remove"?"autoGearRemoveItemButton":"autoGearAddItemButton",s=n[i]||o[i]||r.textContent||"",l=n.autoGearUpdateItemButton||o.autoGearUpdateItemButton||s,c=a?l:s,u=a?ICON_GLYPHS.save:t==="remove"?ICON_GLYPHS.minus:ICON_GLYPHS.add;rt(r,c,u),r.setAttribute("data-help",c)}function pG(e=hC,t=Ic){return D6({rules:Array.isArray(e)?e:[],monitorDefaults:normalizeAutoGearMonitorDefaults(t)})}const O8=pG(lc,Ic);AT.length&&pG(AT[0].rules,AT[0].monitorDefaults);Pf(()=>{kr("reconcileAutoGearAutoPresetState",[{persist:!0,skipRender:!0}],{defer:!0}),kr("alignActiveAutoGearPreset",[{skipRender:!0}],{defer:!0})});function x8(e){return lc=Array.isArray(e)?e.map(normalizeAutoGearRule).filter(Boolean):[],lc}function SV(){pG()}function k8(){if(typeof saveAutoGearRules<"u"&&typeof saveAutoGearRules=="function")try{saveAutoGearRules(lc);return}catch(e){console.warn("Failed to save automatic gear rules",e)}if(!(typeof localStorage>"u"))try{localStorage.setItem(m8,JSON.stringify(lc))}catch(e){console.warn("Failed to save automatic gear rules",e)}}function I8(e){return Object.prototype.hasOwnProperty.call(AUTO_GEAR_MONITOR_DEFAULT_TYPES,e)?normalizeAutoGearSelectorDefault(AUTO_GEAR_MONITOR_DEFAULT_TYPES[e],Ic[e]):""}function P8(e,{skipRender:t=!1,skipRefresh:r=!1}={}){const n=normalizeAutoGearMonitorDefaults(e);let o=!1;return Object.keys(AUTO_GEAR_MONITOR_DEFAULT_TYPES).forEach(a=>{const i=Ic[a]||"",s=n[a]||"";i!==s&&(o=!0)}),o?(Ic=persistAutoGearMonitorDefaults(n),SV(),t||(kr("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),kr("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),!r&&typeof refreshGearListIfVisible=="function"&&refreshGearListIfVisible(),Ic):(t||(kr("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),kr("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),Ic)}function B8(e,t,r={}){if(!Object.prototype.hasOwnProperty.call(AUTO_GEAR_MONITOR_DEFAULT_TYPES,e))return I8(e);const n=Ic[e]||"",o=normalizeAutoGearSelectorDefault(AUTO_GEAR_MONITOR_DEFAULT_TYPES[e],t);if(n===o)return r.skipRender||(kr("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),kr("renderAutoGearMonitorDefaultsControls",[],{defer:!0})),o;const a={...Ic,[e]:o};return P8(a,r),o}function G8(e){const t=x8(e);hC=t.slice(),gI=null,k8(),SV(),kr("alignActiveAutoGearPreset",[{skipRender:!0}],{defer:!0}),kr("syncAutoGearAutoPreset",[t],{defer:!0}),kr("renderAutoGearPresetsControls",[],{defer:!0})}function vV(){return lc.slice()}function M8(){return gI?gI.slice():null}typeof window<"u"&&(window.getProjectScopedAutoGearRules=M8,window.getAutoGearRules=vV,window.setAutoGearRules=G8,window.collectAutoGearCatalogNames=_8,window.GEAR_LIST_CATEGORIES=fG,window.collectAutoGearMonitorNames=F8,window.collectAutoGearTripodNames=H8,window.collectDeviceManagerCategories=F7);function EV(e){return typeof e=="string"&&e!=="None"&&(/[A-Z]/.test(e)||/\d/.test(e)||e.includes(" "))}function _8(){const e=new Set,t=o=>{EV(o)&&e.add(o)},r=typeof WeakSet=="function"?new WeakSet:null,n=o=>{if(!(!o||typeof o!="object")){if(r){if(r.has(o))return;r.add(o)}Object.entries(o).forEach(([a,i])=>{!i||typeof i!="object"||Array.isArray(i)||(t(a),n(i))})}};return typeof devices=="object"&&devices&&n(devices),X8().forEach(o=>{o&&typeof o.name=="string"&&t(o.name)}),lc.forEach(o=>{[...o.add,...o.remove].forEach(a=>t(a.name))}),Array.from(e).sort((o,a)=>o.localeCompare(a,void 0,{sensitivity:"base"}))}function D8(e){const t=normalizeAutoGearSelectorType(e);return t==="monitor"||t==="directorMonitor"||dG.has(t)?t:"none"}var N8="none",yI=null,hI=null;function F8(e=N8){const t=D8(e);if(t==="none")return[];const r=t==="monitor",n=t==="directorMonitor",o=new Set;r&&o.add("monitor"),n&&o.add("directorMonitor");const a=new Set,i=s=>{if(typeof s=="string"){const l=s.trim();l&&a.add(l)}};if(r){const s=devices&&devices.monitors?devices.monitors:null;s&&typeof s=="object"&&Object.keys(s).forEach(i)}if(n){const s=devices&&devices.directorMonitors?devices.directorMonitors:null;s&&typeof s=="object"&&Object.keys(s).filter(l=>l&&l!=="None").forEach(i)}return lc.forEach(s=>{const l=c=>{if(!c||typeof c!="object")return;const u=c.selectorDefault;if(!u)return;const f=normalizeAutoGearSelectorType(c.selectorType);o.has(f)&&i(u)};(s.add||[]).forEach(l),(s.remove||[]).forEach(l)}),C8.forEach(i),Array.from(a).sort(localeSort)}function j8(e){const t=normalizeAutoGearSelectorType(e);if(t==="none")return[];const r=new Set,n=o=>{if(typeof o!="string")return;const a=o.trim();a&&r.add(a)};return lc.forEach(o=>{const a=i=>{!i||typeof i!="object"||normalizeAutoGearSelectorType(i.selectorType)===t&&n(i.selectorDefault)};(o.add||[]).forEach(a),(o.remove||[]).forEach(a)}),Array.from(r)}function H8(e){if(!dG.has(e))return[];const t=collectTripodPreferenceOptions(e),r=new Set,n=[];return t.forEach(a=>{if(!a||!a.value)return;const i=a.value.trim().toLowerCase();r.has(i)||(r.add(i),n.push({value:a.value.trim(),label:a.label||a.value.trim()}))}),j8(e).map(a=>a.trim()).filter(Boolean).sort(localeSort).forEach(a=>{const i=a.toLowerCase();r.has(i)||(r.add(i),n.push({value:a,label:a}))}),n}typeof window<"u"&&"serviceWorker"in navigator&&window.addEventListener("load",()=>{const e=typeof globalThis<"u"&&globalThis&&globalThis.cineOffline||typeof window<"u"&&window&&window.cineOffline||null;if(e&&typeof e.registerServiceWorker=="function"){e.registerServiceWorker("service-worker.js",{immediate:!0,window,navigator});return}try{navigator.serviceWorker.register("service-worker.js")}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Service worker registration failed via fallback path.",t)}});function AN(e){if(!e)return 0;const t=typeof e.getBoundingClientRect=="function"?e.getBoundingClientRect():null;return t&&typeof t.height=="number"&&t.height>0?t.height:e.offsetHeight||0}function bI(e){if(typeof document>"u")return;const t=document.documentElement;t&&(e>0?t.style.setProperty("--install-banner-offset",`${Math.ceil(e)}px`):t.style.removeProperty("--install-banner-offset"))}let wT=!1;const Yg="Force reload requires an internet connection. Try again once you are back online.";function U8(){if(wT||typeof window>"u")return;const e=typeof window.requestAnimationFrame=="function"&&window.requestAnimationFrame.bind(window)||typeof window.setTimeout=="function"&&(t=>window.setTimeout(t,0));e&&(wT=!0,e(()=>{wT=!1,zu()}))}function zu(){if(typeof document>"u")return;const e=document.getElementById("installPromptBanner");if(!e){bI(0);return}const t=document.getElementById("offlineIndicator"),n=!!(t&&!t.hasAttribute("hidden"))?AN(t):0;n>0?e.style.top=`${n}px`:e.style.removeProperty("top");const o=!e.hasAttribute("hidden"),a=o?AN(e):0,i=n+a;bI(i),o&&!a&&U8()}function z8(){if(typeof document>"u"||typeof document.getElementById!="function"||typeof navigator>"u")return;const e=document.getElementById("offlineIndicator");if(!e)return;const t=document.getElementById("reloadButton"),r=e.dataset||{},n=typeof e.textContent=="string"&&e.textContent.trim()?e.textContent.trim():"Offline";if(e.dataset){(!r.baseLabel||!r.baseLabel.trim())&&(e.dataset.baseLabel=n);const w=typeof e.getAttribute=="function"?e.getAttribute("data-help"):null;(!e.dataset.baseHelp||!e.dataset.baseHelp.trim())&&(typeof w=="string"&&w.trim()?e.dataset.baseHelp=w.trim():e.dataset.baseHelp=e.dataset.baseLabel||n),(!e.dataset.forceReloadNotice||!e.dataset.forceReloadNotice.trim())&&(e.dataset.forceReloadNotice=Yg),(!e.dataset.degradedLabel||!e.dataset.degradedLabel.trim())&&(e.dataset.degradedLabel=e.dataset.forceReloadNotice||Yg),(!e.dataset.degradedHelp||!e.dataset.degradedHelp.trim())&&(e.dataset.degradedHelp=e.dataset.baseHelp||n),(!e.dataset.reasonCacheFallback||!e.dataset.reasonCacheFallback.trim())&&(e.dataset.reasonCacheFallback=e.dataset.forceReloadNotice||Yg),(!e.dataset.reasonGetFailed||!e.dataset.reasonGetFailed.trim())&&(e.dataset.reasonGetFailed=e.dataset.reasonCacheFallback),(!e.dataset.reasonTimeout||!e.dataset.reasonTimeout.trim())&&(e.dataset.reasonTimeout=e.dataset.reasonCacheFallback),(!e.dataset.reasonUnreachable||!e.dataset.reasonUnreachable.trim())&&(e.dataset.reasonUnreachable=e.dataset.reasonCacheFallback),(!e.dataset.reasonReloadBlocked||!e.dataset.reasonReloadBlocked.trim())&&(e.dataset.reasonReloadBlocked=e.dataset.forceReloadNotice||Yg),(!e.dataset.reasonUnknown||!e.dataset.reasonUnknown.trim())&&(e.dataset.reasonUnknown=e.dataset.degradedHelp||n)}const o="cine-sw:connectivity-status",a="cine-sw-logs";let i=null,s=null,l=!1,c=null;const u=()=>{const w=e.dataset?.forceReloadNotice;if(typeof w=="string"&&w.trim())return w.trim();const x=t?.dataset?.offlineNotice;return typeof x=="string"&&x.trim()?x.trim():Yg},f=()=>typeof navigator.onLine=="boolean"?navigator.onLine!==!1:!0,d=()=>e.dataset?.baseLabel&&e.dataset.baseLabel.trim()?e.dataset.baseLabel.trim():n,p=()=>e.dataset?.baseHelp&&e.dataset.baseHelp.trim()?e.dataset.baseHelp.trim():d(),h=()=>e.dataset?.degradedLabel&&e.dataset.degradedLabel.trim()?e.dataset.degradedLabel.trim():u(),m=()=>e.dataset?.degradedHelp&&e.dataset.degradedHelp.trim()?e.dataset.degradedHelp.trim():h(),g={"cache-fallback":"reasonCacheFallback","get-failed":"reasonGetFailed",timeout:"reasonTimeout",unreachable:"reasonUnreachable","reload-blocked":"reasonReloadBlocked",offline:"forceReloadNotice"},S=w=>{if(!w){const T=e.dataset?.reasonUnknown;return typeof T=="string"&&T.trim()?T.trim():""}if(w==="navigator-offline")return u();const x=g[w]||"reasonUnknown",G=e.dataset?.[x];if(typeof G=="string"&&G.trim())return G.trim();if(x!=="reasonUnknown"){const T=e.dataset?.reasonUnknown;if(typeof T=="string"&&T.trim())return T.trim()}return""},y=w=>{if(!w)return"";if(typeof w=="string")return w.trim();if(typeof w!="object")return"";const x=[];if(typeof w.status=="number"&&Number.isFinite(w.status)&&x.push(`HTTP ${w.status}`),typeof w.statusText=="string"&&w.statusText.trim()&&x.push(w.statusText.trim()),typeof w.message=="string"&&w.message.trim()&&x.push(w.message.trim()),typeof w.error=="string"&&w.error.trim()&&x.push(w.error.trim()),!x.length&&w.error&&typeof w.error=="object"){const G=y(w.error);G&&x.push(G)}return!x.length&&w.reason&&typeof w.reason=="string"&&x.push(w.reason.trim()),x.join(" ").trim()},E=(w,x)=>{if(!t)return;const G=typeof x=="string"&&x.trim()?x.trim():u();if(t.dataset){if(!t.dataset.onlineTitle||!t.dataset.onlineTitle.trim()){const T=t.getAttribute("title");typeof T=="string"&&T.trim()?t.dataset.onlineTitle=T.trim():t.dataset.onlineTitle="Force reload"}if(!t.dataset.onlineHelp||!t.dataset.onlineHelp.trim()){const T=t.getAttribute("data-help");typeof T=="string"&&T.trim()?t.dataset.onlineHelp=T.trim():t.dataset.onlineHelp=t.dataset.onlineTitle}if(!t.dataset.onlineAriaLabel||!t.dataset.onlineAriaLabel.trim()){const T=t.getAttribute("aria-label");typeof T=="string"&&T.trim()?t.dataset.onlineAriaLabel=T.trim():t.dataset.onlineAriaLabel=t.dataset.onlineTitle}(!t.dataset.offlineNotice||!t.dataset.offlineNotice.trim())&&(t.dataset.offlineNotice=G)}if(w==="online"){t.removeAttribute("disabled"),t.removeAttribute("aria-disabled");const T=t.dataset?.onlineTitle||"Force reload",P=t.dataset?.onlineHelp||T;t.setAttribute("title",T),t.setAttribute("data-help",P);const N=t.dataset?.onlineAriaLabel||T;t.setAttribute("aria-label",N)}else t.setAttribute("disabled","disabled"),t.setAttribute("aria-disabled","true"),t.setAttribute("title",G),t.setAttribute("data-help",G),t.setAttribute("aria-label",G),t.dataset&&(t.dataset.offlineNotice=G,t.dataset.degradedNotice=G)},L=w=>{if(!w||typeof w!="object")return null;const x=typeof w.status=="string"&&w.status?w.status:"unknown",G=typeof w.reason=="string"&&w.reason?w.reason:null,T=typeof w.timestamp=="number"&&Number.isFinite(w.timestamp)?w.timestamp:Date.now();let P=null;return w.detail&&typeof w.detail=="object"?P=w.detail:typeof w.detail=="string"&&w.detail.trim()&&(P=w.detail.trim()),{status:x,reason:G,detail:P,timestamp:T}},v=()=>{const w=f();let x=w?"online":"offline",G=w?null:"navigator-offline",T=null,P=null;if(i){const N=i.status;N==="offline"?(x="offline",G=i.reason||G||"offline",T=i.detail||null,P=i.timestamp||null):N==="degraded"&&x!=="offline"?(x="degraded",G=i.reason||"unknown",T=i.detail||null,P=i.timestamp||null):N==="online"&&w&&(x="online",G=i.reason||null,T=i.detail||null,P=i.timestamp||null)}if(e.dataset&&(e.dataset.connectivityStatus=x,G?e.dataset.connectivityReason=G:e.dataset.connectivityReason&&delete e.dataset.connectivityReason,P?e.dataset.connectivityTimestamp=String(P):e.dataset.connectivityTimestamp&&delete e.dataset.connectivityTimestamp),x==="online"){const N=d(),q=p();(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=N),e.setAttribute("data-help",q),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.hasAttribute("hidden")||e.setAttribute("hidden",""),E("online",u())}else if(x==="offline"){const N=u();e.dataset&&(e.dataset.forceReloadNotice=N,e.dataset.reloadNotice=N),(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=N),e.setAttribute("data-help",N),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.removeAttribute("hidden"),E("offline",N)}else{const N=h(),q=S(G),Z=y(T),U=[];q&&U.push(q),Z&&Z!==q&&U.push(Z);const K=U.join(" ").trim(),H=K?`${N}  ${K}`:N,te=m(),re=[];K&&re.push(K),te&&(!K||te.indexOf(K)===-1)&&re.push(te);const fe=re.join(" ").trim()||te||H;e.dataset&&(e.dataset.forceReloadNotice=H,e.dataset.reloadNotice=H),(typeof e.textContent=="string"||typeof e.textContent=="object")&&(e.textContent=H),e.setAttribute("data-help",fe),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.removeAttribute("hidden"),E("degraded",H)}typeof zu=="function"&&zu()},A=w=>{const x=L(w);x&&(i&&i.status===x.status&&i.reason===x.reason&&i.timestamp===x.timestamp||(i=x,v(),typeof kr=="function"&&kr("updateStorageSummary",[],{defer:!0})))},R=w=>{if(!w)return;let x=null;try{x=w.data||null}catch{x=null}if(!(!x||typeof x!="object")&&x.type===o){const G=x.state&&typeof x.state=="object"?x.state:null;G&&A(G)}},I=()=>{if(!(s||l)){if(typeof BroadcastChannel!="function"){l=!0;return}try{s=new BroadcastChannel(a),s.addEventListener("message",R)}catch(w){l=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn("setupOfflineIndicator: Unable to listen for connectivity updates",w)}}},k=(()=>{try{if(typeof cineOffline<"u"&&cineOffline)return cineOffline}catch{}const w=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let x=0;x<w.length;x+=1){const G=w[x];if(G&&typeof G.cineOffline=="object")return G.cineOffline}return null})();if(k&&typeof k.subscribeConnectivityStatus=="function")try{c=k.subscribeConnectivityStatus(A)}catch{c=null}const _=k&&typeof k.getConnectivityState=="function"?k.getConnectivityState():typeof window<"u"&&window&&typeof window.cineConnectivityStatus=="object"?window.cineConnectivityStatus:null;return _&&A(_),I(),typeof window<"u"&&typeof window.addEventListener=="function"&&(window.addEventListener("online",v),window.addEventListener("offline",v)),v(),c}typeof window<"u"&&z8();function mf(){const e=document.getElementById("sideMenu"),t=document.getElementById("menuOverlay"),r=document.getElementById("menuToggle"),n=typeof document<"u"?document.body:null;if(!e||!t||!r)return;e.classList.remove("open"),e.scrollTop=0,e.setAttribute("hidden","");const o=r.dataset?.menuLabel||"Menu",a=r.dataset?.menuHelp||o;r.setAttribute("aria-expanded","false"),r.setAttribute("aria-label",o),r.setAttribute("title",o),r.setAttribute("data-help",a),n?.classList.remove("menu-open")}function $8(){const e=document.getElementById("sideMenu"),t=document.getElementById("menuOverlay"),r=document.getElementById("menuToggle"),n=document.getElementById("closeMenuButton"),o=typeof document<"u"?document.body:null;if(!e||!t||!r||e.classList.contains("open"))return;e.classList.add("open"),e.removeAttribute("hidden"),r.setAttribute("aria-expanded","true");const a=r.dataset?.closeLabel||n?.getAttribute("aria-label")||"Close menu",i=r.dataset?.closeHelp||n?.getAttribute("data-help")||a;r.setAttribute("aria-label",a),r.setAttribute("title",a),r.setAttribute("data-help",i),o?.classList.add("menu-open")}function AV(){const e=document.getElementById("menuToggle"),t=document.getElementById("sideMenu"),r=document.getElementById("menuOverlay"),n=document.getElementById("closeMenuButton");if(!e||!t||!r){document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",AV);return}if(e.dataset.menuInitialized)return;e.dataset.menuInitialized="true",r.style.display,e.addEventListener("click",()=>{t.classList.contains("open")?mf():$8()}),r.addEventListener("click",mf),n?.addEventListener("click",()=>{mf(),e.focus()}),typeof window<"u"&&typeof window.matchMedia=="function"&&window.matchMedia("(max-width: 768px)").addEventListener("change",i=>{!i.matches&&t.classList.contains("open")&&mf()}),document.addEventListener("keydown",a=>{a.key==="Escape"&&t.classList.contains("open")&&(mf(),e.focus())}),t.querySelectorAll("a").forEach(a=>{a.addEventListener("click",i=>{const s=a.getAttribute("href");s&&s.startsWith("#")&&(i.preventDefault(),document.querySelector(s)?.scrollIntoView(),history.replaceState(null,"",window.location.pathname+window.location.search)),mf()})});const o=a=>{a&&(a==="open-settings"?document.getElementById("settingsButton")?.click():a==="open-help"?document.getElementById("helpButton")?.click():a==="open-own-gear"?typeof bC=="function"&&bC():a==="open-contacts"&&(QV(),lS(ji)))};t.querySelectorAll("[data-sidebar-action]").forEach(a=>{a.addEventListener("click",i=>{i.preventDefault(),o(a.dataset.sidebarAction),mf()})})}function CV(){const e=document.getElementById("topBar"),t=e?.querySelector(".feature-search"),r=e?.querySelector(".controls"),n=document.querySelector("#sideMenu .sidebar-controls");if(!e||!t||!r||!n||typeof window.matchMedia!="function"){document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",CV);return}if(e.dataset.responsiveInitialized)return;e.dataset.responsiveInitialized="true";const o=window.matchMedia("(max-width: 768px)"),a=()=>{o.matches?(n.appendChild(t),n.appendChild(r)):(e.appendChild(t),e.appendChild(r))};o.addEventListener("change",a),a()}let au=null,qS=null,iu=null,KS=null,Vf={items:[],map:new Map};function $L(){return typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function V8(){if(au)return au;if(typeof require=="function")try{const t=require("./own-gear/store.js");if(t&&typeof t.createOwnGearStore=="function")return au=t,au}catch{}const e=$L();return e&&typeof e.cineOwnGearStore=="object"&&e.cineOwnGearStore?(au=e.cineOwnGearStore,au):typeof cineOwnGearStore=="object"&&cineOwnGearStore?(au=cineOwnGearStore,au):null}function Xd(){if(qS)return qS;const e=V8();if(e&&typeof e.createOwnGearStore=="function")try{return qS=e.createOwnGearStore(),qS}catch{}return null}function q8(){if(iu)return iu;if(typeof require=="function")try{const t=require("./own-gear/view.js");if(t&&typeof t.createOwnGearView=="function")return iu=t,iu}catch{}const e=$L();return e&&typeof e.cineOwnGearView=="object"&&e.cineOwnGearView?(iu=e.cineOwnGearView,iu):typeof cineOwnGearView=="object"&&cineOwnGearView?(iu=cineOwnGearView,iu):null}function K8(){return{scope:$L()||{},document:typeof document<"u"?document:null,getLanguageTexts,defaultLanguage:oo,getCurrentLanguage:()=>jt,formatWithPlaceholders:_6,setButtonLabelWithIconBinding:rt,iconMarkup:Jc,iconGlyphs:ICON_GLYPHS,openDialog:lS,closeDialog:xu,formatQuantityText:e9,devices,gearItemTranslations:tA,looksLikeGearName:EV}}function mG(){if(KS)return KS;const e=q8(),t=Xd();if(!e||typeof e.createOwnGearView!="function"||!t)return null;try{return KS=e.createOwnGearView(t,K8()),KS}catch{}return null}function W8(){const e=Xd();if(e&&typeof e.invalidateCache=="function")try{e.invalidateCache();return}catch{}Vf={items:[],map:new Map}}function Y8(){const e=Xd();if(e&&typeof e.refreshCache=="function")try{const a=e.refreshCache();return{items:Array.isArray(a.items)?a.items.slice():[],map:a.map instanceof Map?a.map:new Map}}catch{}const t=zL();let r=[];if(t&&typeof t.loadStoredOwnGearItems=="function")try{r=t.loadStoredOwnGearItems()}catch(a){console.warn("Unable to load own gear items for automatic gear rules via module.",a)}(!Array.isArray(r)||!r.length)&&(r=Z8());const n=Array.isArray(r)?r.map(wV).filter(Boolean):[],o=new Map;return n.forEach(a=>{!a||!a.id||o.set(a.id,a)}),Vf={items:n,map:o},Vf}function Q8(){const e=Xd();if(e&&typeof e.getCacheSnapshot=="function")try{const t=e.getCacheSnapshot();return{items:Array.isArray(t.items)?t.items.slice():[],map:t.map instanceof Map?t.map:new Map}}catch{}return Vf&&Array.isArray(Vf.items)&&Vf.items.length?Vf:Y8()}function X8(){return Q8().items.slice()}function J8(){const e=Xd();if(e&&typeof e.generateOwnGearId=="function")try{return e.generateOwnGearId()}catch{}const t=zL();if(t&&typeof t.generateOwnGearId=="function")try{return t.generateOwnGearId()}catch(o){console.warn("Unable to generate own gear id via module.",o)}if(typeof crypto<"u"&&crypto&&typeof crypto.randomUUID=="function")try{return crypto.randomUUID()}catch{}const r=Date.now().toString(36),n=Math.floor(Math.random()*1e8).toString(36);return`own-${r}-${n}`}function wV(e){const t=Xd();if(t&&typeof t.normalizeOwnGearRecord=="function")try{return t.normalizeOwnGearRecord(e)}catch{}const r=zL();if(r&&typeof r.normalizeOwnGearRecord=="function")try{return r.normalizeOwnGearRecord(e)}catch(a){console.warn("Unable to normalize own gear entry via module.",a)}if(!e||typeof e!="object")return null;const n=typeof e.name=="string"?e.name.trim():"";if(!n)return null;const o={id:typeof e.id=="string"&&e.id.trim()?e.id.trim():J8(),name:n};return typeof e.quantity=="string"&&e.quantity.trim()?o.quantity=e.quantity.trim():typeof e.quantity=="number"&&Number.isFinite(e.quantity)&&(o.quantity=String(e.quantity)),typeof e.notes=="string"&&e.notes.trim()&&(o.notes=e.notes.trim()),typeof e.source=="string"&&e.source.trim()&&(o.source=e.source.trim()),o}function Z8(){const e=Xd();if(e&&typeof e.loadStoredOwnGearItems=="function")try{return e.loadStoredOwnGearItems()}catch{}const t=zL();if(t&&typeof t.loadStoredOwnGearItems=="function")try{return t.loadStoredOwnGearItems()}catch(r){console.warn("Unable to load own gear items via module.",r)}if(typeof loadOwnGear!="function")return[];try{const r=loadOwnGear();if(!Array.isArray(r))return[];const n=new Set;return r.map(wV).filter(o=>!o||n.has(o.id)?!1:(n.add(o.id),!0))}catch(r){return console.warn("Failed to load own gear items from storage",r),[]}}function e9(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=Number(t.replace(",","."));if(!Number.isNaN(r)&&Number.isFinite(r)){const n=Math.round(r*1e3)/1e3;return String(n).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1")}return t}function bC(){const e=mG();if(e&&typeof e.openDialog=="function")try{e.openDialog()}catch{}}function t9(e){const t=mG();if(t&&typeof t.applyLocalization=="function")try{t.applyLocalization(e)}catch{}}function eA(){AV(),CV()}function r9(){const e=mG();if(e){try{e.initialize()}catch{}try{Ut("openOwnGearDialog",bC)}catch{const r=$L();r&&(r.openOwnGearDialog=bC)}}}if(typeof window<"u"&&typeof document<"u")var CN=()=>{eA(),r9(),QV()},Cq=()=>{const t=()=>{typeof window<"u"&&typeof window.setTimeout=="function"?window.setTimeout(CN,0):CN()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()};const ii=(()=>{if(typeof require=="function")try{return require("./app-core-auto-backup.js")}catch{}let e=null;if(typeof uI=="function")e=uI("./app-core-auto-backup.js");else if(typeof cineRuntimeBootstrapExports=="object"&&cineRuntimeBootstrapExports&&typeof cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule=="function")e=cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule("./app-core-auto-backup.js");else{const r=(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null);r&&typeof r.fallbackRequireCoreRuntimeModule=="function"&&(e=r.fallbackRequireCoreRuntimeModule("./app-core-auto-backup.js"))}if(e&&typeof e=="object")return e;const t=[typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"&&typeof n!="function"))try{if(n.CORE_AUTO_BACKUP&&typeof n.CORE_AUTO_BACKUP=="object")return n.CORE_AUTO_BACKUP}catch{}}return null})(),n9=ii&&typeof ii.AUTO_BACKUP_NAME_PREFIX=="string"?ii.AUTO_BACKUP_NAME_PREFIX:"auto-backup-",o9=ii&&typeof ii.AUTO_BACKUP_DELETION_PREFIX=="string"?ii.AUTO_BACKUP_DELETION_PREFIX:"auto-backup-before-delete-";var sb=ii&&typeof ii.logAutoBackupEvent=="function"?ii.logAutoBackupEvent:function(t,r,n,o){const a=typeof t=="string"&&t?t.toLowerCase():"info",i=typeof r=="string"&&r?r:"Auto backup event";if(typeof console>"u"||!console)return;let s=null;if(a==="error"&&typeof console.error=="function"?s=console.error:a==="warn"&&typeof console.warn=="function"?s=console.warn:a==="info"&&typeof console.info=="function"?s=console.info:a==="debug"&&typeof console.debug=="function"?s=console.debug:typeof console.log=="function"&&(s=console.log),typeof s=="function")try{s.call(console,`[auto-backup] ${i}`,n||null,o||null)}catch{}};const wN=ii&&typeof ii.cloneProjectEntryForSetup=="function"?ii.cloneProjectEntryForSetup:null,LN=ii&&typeof ii.ensureAutoBackupsFromProjects=="function"?ii.ensureAutoBackupsFromProjects:null;var LV=!1;try{typeof localStorage<"u"&&(LV=localStorage.getItem("showAutoBackups")==="true")}catch(e){sb("warn","Could not load auto backup visibility preference",e)}function a9(e){if(wN)return wN(e,{deepClone:CORE_DEEP_CLONE,log:sb});if(!e||typeof e!="object")return{};try{return CORE_DEEP_CLONE(e)}catch(t){sb("warn","Fallback auto backup project clone failed",t);const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}}function i9(){return LN?LN({loadProject:typeof loadProject=="function"?loadProject:null,getSetups:RV,storeSetups:TV,log:sb,cloneProjectEntry:e=>a9(e),autoBackupNamePrefix:n9,autoBackupDeletionPrefix:o9}):!1}if(LV)try{i9()}catch(e){sb("warn","Failed to prepare auto backups from project storage",e)}function RV(){return loadSetups()}Ut("getSetups",RV);function TV(e){saveSetups(e)}Ut("storeSetups",TV);function s9(){return typeof loadSessionState=="function"?loadSessionState():null}Ut("loadSession",s9);function l9(e){typeof saveSessionState=="function"&&saveSessionState(e)}Ut("storeSession",l9);function OV(e,t){e&&(t?typeof e.showModal=="function"?e.showModal():e.setAttribute("open",""):typeof e.close=="function"?e.close():e.removeAttribute("open"))}function lS(e){OV(e,!0)}function xu(e){OV(e,!1)}function Jd(e){return e?typeof e.open=="boolean"?!!(e.open||typeof e.hasAttribute=="function"&&e.hasAttribute("open")):typeof e.hasAttribute=="function"&&e.hasAttribute("open"):!1}Ut("normalizeDevicesForPersistence",iV);function c9(){let e=null;try{e=typeof updateGlobalDevicesReference=="function"?updateGlobalDevicesReference:null}catch{e=null}if(e)return e;const t=[],r=n=>{!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)};try{r(typeof ua<"u"?ua:null)}catch{}try{r(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)}catch{}try{r(typeof DEVICE_GLOBAL_SCOPE<"u"?DEVICE_GLOBAL_SCOPE:null)}catch{}try{r(typeof $p<"u"?$p:null)}catch{}r(typeof globalThis<"u"?globalThis:null),r(typeof window<"u"?window:null),r(typeof self<"u"?self:null),r(typeof global<"u"?global:null);for(let n=0;n<t.length;n+=1){const o=t[n];try{const a=o&&o.updateGlobalDevicesReference;if(typeof a=="function")return a}catch{}}return null}window.defaultDevices===void 0&&(window.defaultDevices=CORE_DEEP_CLONE(devices),t6(window.defaultDevices),aV(window.defaultDevices));let RN=loadDeviceData();if(RN){const e=CORE_DEEP_CLONE(window.defaultDevices);for(const[r,n]of Object.entries(RN))if(r==="fiz"&&n&&typeof n=="object"){e.fiz=e.fiz||{};for(const[o,a]of Object.entries(n))e.fiz[o]={...e.fiz[o]||{},...a||{}}}else e[r]&&typeof e[r]=="object"?e[r]={...e[r],...n||{}}:e[r]=n;devices=e;const t=c9();if(typeof t=="function")try{t(devices)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to update global devices reference during initialization",r)}}aV(devices,{force:!0});function xV(e){const t=devices.cameras&&devices.cameras[e];return!t||!t.power||!Array.isArray(t.power.batteryPlateSupport)?[]:t.power.batteryPlateSupport.filter(Boolean).map(r=>!r||typeof r!="object"?r:r.type==="Gold Mount"?{...r,type:"Gold-Mount"}:r)}function u9(e){return xV(e).map(t=>t.type).filter(Boolean)}function TN(e){const t=xV(e);if(!t.length)return[];const r=new Set(t.filter(n=>n.mount==="native"&&n.type).map(n=>n.type));return r.size===1&&r.has("B-Mount")?["B-Mount"]:[...new Set(u9(e))]}var dh;function f9(){if(typeof document>"u"){typeof dh>"u"&&(dh=null);return}document.getElementById("batteryPlateRow"),dh=document.getElementById("batteryPlateSelect")}function d9(){f9();const e=typeof Dd?.value=="string"?Dd.value:"",t=typeof TN=="function"?TN(e):[];if(!Array.isArray(t)||!t.length)return null;const r=typeof dh?.value=="string"?dh.value:"";return r||(t.includes("V-Mount")?"V-Mount":t[0])}function p9(){const e=document.getElementById("batteryLabel");if(!e)return;const t=getLanguageTexts(jt),r=getLanguageTexts(oo),n=resolveTextEntryInternal(t,r,"batterySelectHelp","");n?e.setAttribute("data-help",n):e.removeAttribute("data-help"),d9()==="B-Mount"?e.textContent=resolveTextEntryInternal(t,r,"batteryBMountLabel","B-Mount Battery:"):e.textContent=resolveTextEntryInternal(t,r,"batteryLabel","Battery:")}const m9={info:"status-message--info",success:"status-message--success",note:"status-message--note",warning:"status-message--warning",danger:"status-message--danger"};function g9(e,t){if(!e)return;const r=Object.values(m9);if(e.classList)r.forEach(n=>e.classList.remove(n));else if(typeof e.className=="string"){const n=e.className.split(/\s+/).filter(Boolean).filter(o=>!r.includes(o));e.className=n.join(" ")}e.dataset&&"statusLevel"in e.dataset?delete e.dataset.statusLevel:e.removeAttribute&&e.removeAttribute("data-status-level")}var tA={};function y9(){var e=[];function t(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}try{e.push(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)}catch{}e.push(t());for(var r=0;r<e.length;r+=1){var n=e[r];if(!(!n||typeof n!="object"))try{var o=n.translations;if(o&&typeof o.loadLanguage=="function")return o}catch{}}return typeof mi<"u"&&mi&&typeof mi.loadLanguage=="function"?mi:null}var dn=y9();if(typeof texts>"u"){var mi=null,di=(function(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null})();dn&&dn.texts&&dn.categoryNames&&dn.gearItems?mi={texts:dn.texts,categoryNames:dn.categoryNames,gearItems:dn.gearItems}:di&&di.texts&&di.categoryNames&&di.gearItems&&(mi={texts:di.texts,categoryNames:di.categoryNames,gearItems:di.gearItems}),mi?(di&&(!di.texts&&mi.texts&&(di.texts=mi.texts),!di.categoryNames&&mi.categoryNames&&(di.categoryNames=mi.categoryNames),!di.gearItems&&mi.gearItems&&(di.gearItems=mi.gearItems)),tA=mi.gearItems||{}):tA={}}else tA=typeof gearItems<"u"?gearItems:{};var rA=null,SI=null,nA=null,oA=null,ON=null,xN=null,kN=null,IN=null,PN=null,BN=null,GN=null,MN=null,vI=[],Pp=null,_y=null,Dy=null,Fl=null,Bp=null,EI=null,Ny=null,aA=null,Gp=null,Mp=null,ku=null,Rf=null,lp=null,Fy=null,Ra=null,vu=null,jy=null,iA=null,gG={},kV={};const oe=(function(){if(typeof resolveCoreSupportModule=="function")try{const t=resolveCoreSupportModule("cineCoreAutoGearUi","./app-core-auto-gear-ui.js");if(t&&typeof t=="object")return t}catch{}try{if(typeof cineCoreAutoGearUi=="object"&&cineCoreAutoGearUi)return cineCoreAutoGearUi}catch{}try{const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(t&&typeof t.cineCoreAutoGearUi=="object"&&t.cineCoreAutoGearUi)return t.cineCoreAutoGearUi}catch{}return{}})();var LT=oe.autoGearRuleNameInput!==void 0?oe.autoGearRuleNameInput:null,WS=oe.autoGearRuleNameLabel!==void 0?oe.autoGearRuleNameLabel:null,Hy=oe.autoGearScenariosSelect!==void 0?oe.autoGearScenariosSelect:null,YS=oe.autoGearScenariosLabel!==void 0?oe.autoGearScenariosLabel:null,QS=oe.autoGearScenarioModeLabel!==void 0?oe.autoGearScenarioModeLabel:null;oe.autoGearScenarioMultiplierContainer!==void 0&&oe.autoGearScenarioMultiplierContainer;var RT=oe.autoGearScenarioBaseSelect!==void 0?oe.autoGearScenarioBaseSelect:null,XS=oe.autoGearScenarioBaseLabel!==void 0?oe.autoGearScenarioBaseLabel:null,TT=oe.autoGearScenarioFactorInput!==void 0?oe.autoGearScenarioFactorInput:null,JS=oe.autoGearScenarioFactorLabel!==void 0?oe.autoGearScenarioFactorLabel:null,qf=oe.autoGearShootingDaysMode!==void 0?oe.autoGearShootingDaysMode:null,Kf=oe.autoGearShootingDaysInput!==void 0?oe.autoGearShootingDaysInput:null,ZS=oe.autoGearShootingDaysLabel!==void 0?oe.autoGearShootingDaysLabel:null,OT=oe.autoGearShootingDaysHelp!==void 0?oe.autoGearShootingDaysHelp:null,xT=oe.autoGearShootingDaysValueLabel!==void 0?oe.autoGearShootingDaysValueLabel:null,Uy=oe.autoGearMatteboxSelect!==void 0?oe.autoGearMatteboxSelect:null,ev=oe.autoGearMatteboxLabel!==void 0?oe.autoGearMatteboxLabel:null;oe.autoGearMatteboxModeLabel!==void 0&&oe.autoGearMatteboxModeLabel;oe.autoGearMatteboxModeSelect!==void 0&&oe.autoGearMatteboxModeSelect;var zy=oe.autoGearCameraHandleSelect!==void 0?oe.autoGearCameraHandleSelect:null,tv=oe.autoGearCameraHandleLabel!==void 0?oe.autoGearCameraHandleLabel:null;oe.autoGearCameraHandleModeLabel!==void 0&&oe.autoGearCameraHandleModeLabel;oe.autoGearCameraHandleModeSelect!==void 0&&oe.autoGearCameraHandleModeSelect;var $y=oe.autoGearViewfinderExtensionSelect!==void 0?oe.autoGearViewfinderExtensionSelect:null,rv=oe.autoGearViewfinderExtensionLabel!==void 0?oe.autoGearViewfinderExtensionLabel:null;oe.autoGearViewfinderExtensionModeLabel!==void 0&&oe.autoGearViewfinderExtensionModeLabel;oe.autoGearViewfinderExtensionModeSelect!==void 0&&oe.autoGearViewfinderExtensionModeSelect;var nv=oe.autoGearDeliveryResolutionSelect!==void 0?oe.autoGearDeliveryResolutionSelect:null,ov=oe.autoGearDeliveryResolutionLabel!==void 0?oe.autoGearDeliveryResolutionLabel:null;oe.autoGearDeliveryResolutionModeLabel!==void 0&&oe.autoGearDeliveryResolutionModeLabel;oe.autoGearDeliveryResolutionModeSelect!==void 0&&oe.autoGearDeliveryResolutionModeSelect;var Vy=oe.autoGearVideoDistributionSelect!==void 0?oe.autoGearVideoDistributionSelect:null,av=oe.autoGearVideoDistributionLabel!==void 0?oe.autoGearVideoDistributionLabel:null;oe.autoGearVideoDistributionModeLabel!==void 0&&oe.autoGearVideoDistributionModeLabel;oe.autoGearVideoDistributionModeSelect!==void 0&&oe.autoGearVideoDistributionModeSelect;var sA=oe.autoGearCameraSelect!==void 0?oe.autoGearCameraSelect:null,iv=oe.autoGearCameraLabel!==void 0?oe.autoGearCameraLabel:null;oe.autoGearCameraModeLabel!==void 0&&oe.autoGearCameraModeLabel;oe.autoGearCameraModeSelect!==void 0&&oe.autoGearCameraModeSelect;var sv=oe.autoGearOwnGearLabel!==void 0?oe.autoGearOwnGearLabel:null;oe.autoGearOwnGearModeLabel!==void 0&&oe.autoGearOwnGearModeLabel;oe.autoGearOwnGearModeSelect!==void 0&&oe.autoGearOwnGearModeSelect;var lA=oe.autoGearOwnGearSelect!==void 0?oe.autoGearOwnGearSelect:null,lv=oe.autoGearCameraWeightLabel!==void 0?oe.autoGearCameraWeightLabel:null,Wf=oe.autoGearCameraWeightOperator!==void 0?oe.autoGearCameraWeightOperator:null,cv=oe.autoGearCameraWeightOperatorLabel!==void 0?oe.autoGearCameraWeightOperatorLabel:null,Yf=oe.autoGearCameraWeightValueInput!==void 0?oe.autoGearCameraWeightValueInput:null,uv=oe.autoGearCameraWeightValueLabel!==void 0?oe.autoGearCameraWeightValueLabel:null,fv=oe.autoGearCameraWeightHelp!==void 0?oe.autoGearCameraWeightHelp:null,cA=oe.autoGearMonitorSelect!==void 0?oe.autoGearMonitorSelect:null,dv=oe.autoGearMonitorLabel!==void 0?oe.autoGearMonitorLabel:null;oe.autoGearMonitorModeLabel!==void 0&&oe.autoGearMonitorModeLabel;oe.autoGearMonitorModeSelect!==void 0&&oe.autoGearMonitorModeSelect;var kT=oe.autoGearTripodHeadBrandSelect!==void 0?oe.autoGearTripodHeadBrandSelect:null,pv=oe.autoGearTripodHeadBrandLabel!==void 0?oe.autoGearTripodHeadBrandLabel:null;oe.autoGearTripodHeadBrandModeLabel!==void 0&&oe.autoGearTripodHeadBrandModeLabel;oe.autoGearTripodHeadBrandModeSelect!==void 0&&oe.autoGearTripodHeadBrandModeSelect;var IT=oe.autoGearTripodBowlSelect!==void 0?oe.autoGearTripodBowlSelect:null,mv=oe.autoGearTripodBowlLabel!==void 0?oe.autoGearTripodBowlLabel:null;oe.autoGearTripodBowlModeLabel!==void 0&&oe.autoGearTripodBowlModeLabel;oe.autoGearTripodBowlModeSelect!==void 0&&oe.autoGearTripodBowlModeSelect;var PT=oe.autoGearTripodTypesSelect!==void 0?oe.autoGearTripodTypesSelect:null,gv=oe.autoGearTripodTypesLabel!==void 0?oe.autoGearTripodTypesLabel:null;oe.autoGearTripodTypesModeLabel!==void 0&&oe.autoGearTripodTypesModeLabel;oe.autoGearTripodTypesModeSelect!==void 0&&oe.autoGearTripodTypesModeSelect;var BT=oe.autoGearTripodSpreaderSelect!==void 0?oe.autoGearTripodSpreaderSelect:null,yv=oe.autoGearTripodSpreaderLabel!==void 0?oe.autoGearTripodSpreaderLabel:null;oe.autoGearTripodSpreaderModeLabel!==void 0&&oe.autoGearTripodSpreaderModeLabel;oe.autoGearTripodSpreaderModeSelect!==void 0&&oe.autoGearTripodSpreaderModeSelect;var uA=oe.autoGearCrewPresentSelect!==void 0?oe.autoGearCrewPresentSelect:null,hv=oe.autoGearCrewPresentLabel!==void 0?oe.autoGearCrewPresentLabel:null;oe.autoGearCrewPresentModeLabel!==void 0&&oe.autoGearCrewPresentModeLabel;oe.autoGearCrewPresentModeSelect!==void 0&&oe.autoGearCrewPresentModeSelect;var fA=oe.autoGearCrewAbsentSelect!==void 0?oe.autoGearCrewAbsentSelect:null,bv=oe.autoGearCrewAbsentLabel!==void 0?oe.autoGearCrewAbsentLabel:null;oe.autoGearCrewAbsentModeLabel!==void 0&&oe.autoGearCrewAbsentModeLabel;oe.autoGearCrewAbsentModeSelect!==void 0&&oe.autoGearCrewAbsentModeSelect;var dA=oe.autoGearWirelessSelect!==void 0?oe.autoGearWirelessSelect:null,Sv=oe.autoGearWirelessLabel!==void 0?oe.autoGearWirelessLabel:null;oe.autoGearWirelessModeLabel!==void 0&&oe.autoGearWirelessModeLabel;oe.autoGearWirelessModeSelect!==void 0&&oe.autoGearWirelessModeSelect;var pA=oe.autoGearMotorsSelect!==void 0?oe.autoGearMotorsSelect:null,vv=oe.autoGearMotorsLabel!==void 0?oe.autoGearMotorsLabel:null;oe.autoGearMotorsModeLabel!==void 0&&oe.autoGearMotorsModeLabel;oe.autoGearMotorsModeSelect!==void 0&&oe.autoGearMotorsModeSelect;var mA=oe.autoGearControllersSelect!==void 0?oe.autoGearControllersSelect:null,Ev=oe.autoGearControllersLabel!==void 0?oe.autoGearControllersLabel:null;oe.autoGearControllersModeLabel!==void 0&&oe.autoGearControllersModeLabel;oe.autoGearControllersModeSelect!==void 0&&oe.autoGearControllersModeSelect;var gA=oe.autoGearDistanceSelect!==void 0?oe.autoGearDistanceSelect:null,Av=oe.autoGearDistanceLabel!==void 0?oe.autoGearDistanceLabel:null;oe.autoGearDistanceModeLabel!==void 0&&oe.autoGearDistanceModeLabel;oe.autoGearDistanceModeSelect!==void 0&&oe.autoGearDistanceModeSelect;var h9=oe.autoGearConditionLabels!==void 0?oe.autoGearConditionLabels:{},b9=oe.autoGearConditionSelects!==void 0?oe.autoGearConditionSelects:{},IV=oe.autoGearConditionLogicLabels!==void 0?oe.autoGearConditionLogicLabels:{},yG=oe.autoGearConditionLogicSelects!==void 0?oe.autoGearConditionLogicSelects:{};const S9=typeof oe.getAutoGearScenarioModeSelectElement=="function"?oe.getAutoGearScenarioModeSelectElement:()=>oe.autoGearScenarioModeSelectElement||null,PV=typeof oe.setAutoGearScenarioModeSelectElement=="function"?oe.setAutoGearScenarioModeSelectElement:e=>{oe.autoGearScenarioModeSelectElement=e||null};let md=S9();PV(md);var SC=Array.isArray(oe.AUTO_GEAR_CONDITION_KEYS)?oe.AUTO_GEAR_CONDITION_KEYS:["always","scenarios","shootingDays","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","cameraWeight","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"];const BV=oe.AUTO_GEAR_REPEATABLE_CONDITIONS instanceof Set?oe.AUTO_GEAR_REPEATABLE_CONDITIONS:new Set(["scenarios","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"]);var v9=oe.AUTO_GEAR_CONDITION_FALLBACK_LABELS||{always:"Always include",scenarios:"Required scenarios",shootingDays:"Shooting days condition",mattebox:"Mattebox options",cameraHandle:"Camera handles",viewfinderExtension:"Viewfinder extension",deliveryResolution:"Delivery resolution",videoDistribution:"Video distribution",camera:"Camera",ownGear:"Own gear items",cameraWeight:"Camera weight",monitor:"Onboard monitor",tripodHeadBrand:"Tripod head brand",tripodBowl:"Tripod bowl size",tripodTypes:"Tripod types",tripodSpreader:"Tripod spreader",crewPresent:"Crew present",crewAbsent:"Crew absent",wireless:"Wireless transmitter",motors:"FIZ motors",controllers:"FIZ controllers",distance:"FIZ distance devices"};function E9(){if(typeof kI=="function")try{const e=kI();if(e==="imperial"||e==="metric")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="imperial"||t==="metric")return t}}catch(e){console.warn("resolveGlobalFocusScalePreference helper threw an error while resolving a focus scale label",e)}if(typeof focusScalePreference=="string"){const e=focusScalePreference.trim().toLowerCase();if(e==="imperial"||e==="metric")return e}return""}function A9(e){const t=n=>{if(typeof normalizeFocusScale=="function")try{const o=normalizeFocusScale(n);if(o==="imperial"||o==="metric")return o;if(o===""||o===null)return""}catch(o){console.warn("normalizeFocusScale helper threw an error while resolving a focus scale label",o)}if(typeof n=="string"){const o=n.trim().toLowerCase();if(o==="imperial")return"imperial";if(o==="metric")return"metric";if(!o)return""}return""},r=t(e);if(r===""&&(typeof e>"u"||e===null||typeof e=="string"&&!e.trim())){const n=E9(),o=t(n);if(o==="imperial"||o==="metric")return o}return r}function C9(e=jt,t){const r=A9(t),n=getLanguageTexts(e)||{},o=getLanguageTexts("en")||{},a=n.focusScaleMetric||o.focusScaleMetric||n.focusScaleSetting||o.focusScaleSetting||"Metric",i=n.focusScaleImperial||o.focusScaleImperial||n.focusScaleSetting||o.focusScaleSetting||"Imperial";if(r==="imperial")return i;if(r==="metric")return a;if(typeof t=="string"){const s=t.trim();if(s)return s}return n.focusScaleSetting||n.lensFocusScaleLabel||o.focusScaleSetting||o.lensFocusScaleLabel||a}const oo=(function(){const t=[function(){try{if(typeof DEFAULT_LANGUAGE=="string"&&DEFAULT_LANGUAGE)return DEFAULT_LANGUAGE}catch{}return null},function(){try{if(typeof LOCALE_MODULE=="object"&&LOCALE_MODULE&&typeof LOCALE_MODULE.DEFAULT_LANGUAGE=="string"&&LOCALE_MODULE.DEFAULT_LANGUAGE)return LOCALE_MODULE.DEFAULT_LANGUAGE}catch{}return null},function(){try{if(typeof ACTIVE_LOCALIZATION_ACCESSORS=="object"&&ACTIVE_LOCALIZATION_ACCESSORS&&typeof ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage=="string"&&ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage)return ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage}catch{}return null},function(){try{const n=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(n&&typeof n.DEFAULT_LANGUAGE=="string"&&n.DEFAULT_LANGUAGE)return n.DEFAULT_LANGUAGE;if(n&&typeof n.CPP_DEFAULT_LANGUAGE_SAFE=="string"&&n.CPP_DEFAULT_LANGUAGE_SAFE)return n.CPP_DEFAULT_LANGUAGE_SAFE}catch{}return null}];for(let r=0;r<t.length;r+=1){const n=t[r]();if(typeof n=="string"&&n)return n}return"en"})();if(dn&&typeof dn.loadLanguage=="function")try{var GT=dn.loadLanguage(oo);GT&&typeof GT.then=="function"&&GT.catch(function(t){console.warn("Failed to eagerly load default translations",t)})}catch(e){console.warn("Failed to trigger default translation load",e)}const _N=(()=>{const e=new Set,t=r=>{if(typeof r!="string")return;const n=r.trim().toLowerCase();if(!n)return;e.add(n);const o=n.slice(0,2);o&&o!==n&&e.add(o)};if(typeof texts=="object"&&texts!==null&&Object.keys(texts).forEach(t),dn&&typeof dn=="object"&&(dn.texts&&typeof dn.texts=="object"&&Object.keys(dn.texts).forEach(t),typeof dn.getAvailableLanguages=="function"))try{const r=dn.getAvailableLanguages();Array.isArray(r)&&r.forEach(t)}catch(r){console.warn("Failed to read available languages from translations runtime",r)}return t(oo),Array.from(e)})();function GV(e){if(!e)return{language:oo,matched:!1};const t=String(e).toLowerCase();if(_N.includes(t))return{language:t,matched:!0};const r=t.slice(0,2);return _N.includes(r)?{language:r,matched:!0}:{language:oo,matched:!1}}try{const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;e&&typeof e=="object"&&((typeof e.CPP_DEFAULT_LANGUAGE_SAFE!="string"||!e.CPP_DEFAULT_LANGUAGE_SAFE)&&(e.CPP_DEFAULT_LANGUAGE_SAFE=oo),(typeof e.DEFAULT_LANGUAGE!="string"||!e.DEFAULT_LANGUAGE)&&(e.DEFAULT_LANGUAGE=oo))}catch{}var jt=oo;let MT=null;try{const e=localStorage.getItem("language"),t=GV(e);e&&t.matched&&(jt=t.language)}catch(e){console.warn("Could not load language from localStorage",e)}try{typeof document<"u"&&document&&document.documentElement&&(document.documentElement.lang=jt)}catch{}const AI=()=>{try{if(typeof document<"u"&&document){const e=document.getElementById("languageSelect");e&&(e.value=jt);const t=document.getElementById("settingsLanguage");t&&(t.value=jt)}}catch(e){console.warn("Could not synchronize language selectors with initial language",e)}};AI();typeof document<"u"&&document&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",AI,{once:!0}):AI());async function w9(e){const t=typeof e=="string"?e:"",r=GV(t);let n=r.language;if(dn&&typeof dn.resolveLocaleKey=="function")try{n=dn.resolveLocaleKey(n)}catch(b){console.warn("Failed to normalize language via runtime",b)}if(dn&&typeof dn.loadLanguage=="function")try{typeof dn.showLoadingState=="function"&&dn.showLoadingState(n);const b=dn.loadLanguage(n);b&&typeof b.then=="function"&&await b}catch(b){console.warn(`Failed to load translations for "${n}"`,b)}finally{typeof dn.clearLoadingState=="function"&&dn.clearLoadingState()}const o=typeof texts=="object"&&texts||dn&&dn.texts||{};o[n]||(console.warn(`Missing translation bundle for "${n}". Falling back to ${oo}.`),n=oo),t&&n===oo&&!r.matched&&t.slice(0,2).toLowerCase()!==oo&&console.warn(`Unsupported language preference "${t}". Falling back to ${oo}.`),e=n,!o[e]&&o[oo]&&(o[e]=o[oo]);const a=jt;jt=e,eu();const i=a!==e,s=()=>{if(typeof window<"u"&&typeof window.dispatchEvent=="function"&&typeof Event=="function")try{window.dispatchEvent(new Event("languagechange"))}catch(b){console.warn("Failed to dispatch languagechange event",b)}};i&&(typeof queueMicrotask=="function"?queueMicrotask(s):typeof setTimeout=="function"?setTimeout(s,0):s());try{localStorage.setItem("language",e)}catch(b){console.warn("Could not save language to localStorage",b)}fF&&(fF.value=e),ny&&(ny.value=e),document.documentElement.lang=e,document.title=o[e].appTitle,document.getElementById("mainTitle")&&(document.getElementById("mainTitle").textContent=o[e].appTitle),document.getElementById("tagline")&&(document.getElementById("tagline").textContent=o[e].tagline);const l=typeof document<"u"?document:null,c=getCoreGlobalObject(),u=()=>{let b=null;if(typeof refreshDeviceLists=="function"?b=refreshDeviceLists:c&&typeof c.refreshDeviceLists=="function"&&(b=c.refreshDeviceLists.bind(c)),typeof b!="function")return!1;try{b()}catch(M){console.warn("setLanguage: refreshDeviceLists execution failed",M)}return!0};if(!u()){const b=()=>{u()};typeof queueMicrotask=="function"?queueMicrotask(b):typeof setTimeout=="function"&&setTimeout(b,0)}const f=o[oo]||{},d=b=>{if(typeof xI=="function")try{return xI(b)}catch(M){console.warn("normalizeTemperatureUnit helper threw an error; falling back to safe normalization",M)}if(typeof b=="string"){const M=b.trim().toLowerCase();if(M===Oa?.fahrenheit||M==="fahrenheit"||M==="f")return Oa?.fahrenheit||"fahrenheit";if(M===Oa?.celsius||M==="celsius"||M==="c")return Oa?.celsius||"celsius"}return Oa?.celsius||"celsius"},p=b=>{if(typeof b=="string"){const M=b.trim().toLowerCase();if(M==="imperial"||M==="feet"||M==="ft")return"imperial";if(M==="metric"||M==="metre"||M==="meter"||M==="m")return"metric"}return"metric"};(()=>{if(typeof normalizeFocusScale=="function")return normalizeFocusScale;const b=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null;if(b&&typeof b.normalizeFocusScale=="function")return b.normalizeFocusScale;if(b)try{Object.defineProperty(b,"normalizeFocusScale",{value:p,writable:!0,configurable:!0})}catch{b.normalizeFocusScale=p}return p})();const m=b=>{if(typeof normalizeFocusScale=="function")try{const M=normalizeFocusScale(b);if(M==="imperial"||M==="metric")return M}catch(M){console.warn("normalizeFocusScale helper threw an error; falling back to safe normalization",M)}return p(b)},g=()=>{const b=me=>typeof me=="string"&&me?m(me):null,M=[()=>typeof focusScalePreference<"u"?focusScalePreference:null,()=>typeof sessionFocusScale<"u"?sessionFocusScale:null,()=>{try{const me=c&&c.preferences&&typeof c.preferences.getFocusScale=="function"?c.preferences.getFocusScale:null;if(me)return me()}catch(me){console.warn("Failed to resolve focus scale preference from runtime scope; using fallback",me)}return null}];for(const me of M){const ze=b(me());if(ze)return ze}return"metric"},S=b=>{if(!b)return"";const M=texts[e],me=M&&typeof M[b]=="string"?M[b]:null;return me&&me.trim()?me:typeof f[b]=="string"?f[b]:""},y=(b,M,me="")=>{if(!b)return;const ze=S(M)||me;b.textContent=ze},E=(b,M,{target:me,highlight:ze,isButton:Lt=!0}={})=>{if(!l)return null;const ft=l.createElement("a");return ft.className=Lt?"help-link button-link":"help-link",ft.href=b,me&&ft.setAttribute("data-help-target",me),ze&&ft.setAttribute("data-help-highlight",ze),ft.textContent=M,ft},L=(b,M,me=[])=>{if(!b||!l)return;const ze=S(M);if(b.innerHTML="",!ze){b.setAttribute("hidden","");return}b.removeAttribute("hidden");const Lt=l.createDocumentFragment(),ft=/%(?:(\d+)\$)?s/g;let sr=0,pr=0,Xe;for(;(Xe=ft.exec(ze))!==null;){const Yn=Xe.index;Yn>sr&&Lt.appendChild(l.createTextNode(ze.slice(sr,Yn)));const cn=typeof Xe[1]=="string"?Math.max(parseInt(Xe[1],10)-1,0):pr++,lt=me[cn];if(typeof lt=="function"){const It=lt();It&&Lt.appendChild(It)}sr=ft.lastIndex}sr<ze.length&&Lt.appendChild(l.createTextNode(ze.slice(sr))),b.appendChild(Lt)},v=(b,M)=>{if(!b)return;const me=S(M);b.textContent=me,me?b.removeAttribute("hidden"):b.setAttribute("hidden","")},A=b=>{if(b){if(c&&typeof c=="object")try{if(b in c)return c[b]}catch{}if(typeof globalThis<"u"&&globalThis!==c)try{if(b in globalThis)return globalThis[b]}catch{}}},R=(b,M)=>{if(!b||!M)return M;try{Ut(b,M)}catch{}return M},I=(b,M)=>{let me=null;try{me=A(b)}catch(ze){console.warn(`Failed to resolve runtime value for "${b}"`,ze),me=null}if(me&&typeof me=="object")return me;if(l&&typeof l.getElementById=="function"&&M)try{const ze=l.getElementById(M);return R(b,ze)}catch(ze){return console.warn(`Failed to resolve document element "${M}"`,ze),null}return null},C=I("settingsShowAutoBackups","settingsShowAutoBackups"),k=I("backupSettings","backupSettings"),_=I("backupDiffToggleButton","backupDiffToggleButton"),w=I("backupDiffHeading","backupDiffHeading"),x=I("backupDiffIntro","backupDiffIntro"),G=I("backupDiffPrimaryLabel","backupDiffPrimaryLabel"),T=I("backupDiffPrimarySelect","backupDiffPrimary"),P=I("backupDiffSecondaryLabel","backupDiffSecondaryLabel"),N=I("backupDiffSecondarySelect","backupDiffSecondary"),q=I("backupDiffEmptyState","backupDiffEmptyState"),Z=I("backupDiffNotesLabel","backupDiffNotesLabel"),U=I("backupDiffNotes","backupDiffNotes"),K=I("backupDiffExportButton","backupDiffExport"),H=I("backupDiffCloseButton","backupDiffClose"),te=I("restoreRehearsalButton","restoreRehearsalButton"),re=I("restoreRehearsalHeading","restoreRehearsalHeading"),fe=I("restoreRehearsalIntro","restoreRehearsalIntro"),Oe=I("restoreRehearsalModeLabel","restoreRehearsalModeLabel"),Te=I("restoreRehearsalModeBackupText","restoreRehearsalModeBackupText"),Ne=I("restoreRehearsalModeProjectText","restoreRehearsalModeProjectText"),Ie=I("restoreRehearsalFileLabel","restoreRehearsalFileLabel"),et=I("restoreRehearsalBrowse","restoreRehearsalBrowse"),Ze=I("restoreRehearsalFileName","restoreRehearsalFileName"),Ft=I("restoreRehearsalStatus","restoreRehearsalStatus"),Ye=I("restoreRehearsalRuleHeading","restoreRehearsalRuleHeading"),ct=I("restoreRehearsalRuleIntro","restoreRehearsalRuleIntro"),Y=I("restoreRehearsalRuleEmpty","restoreRehearsalRuleEmpty"),ee=I("restoreRehearsalTableCaption","restoreRehearsalTableCaption"),Ae=I("restoreRehearsalMetricHeader","restoreRehearsalMetricHeader"),ve=I("restoreRehearsalLiveHeader","restoreRehearsalLiveHeader"),se=I("restoreRehearsalSandboxHeader","restoreRehearsalSandboxHeader"),de=I("restoreRehearsalDifferenceHeader","restoreRehearsalDifferenceHeader"),be=I("restoreRehearsalCloseButton","restoreRehearsalClose"),ye=I("restoreRehearsalProceedButton","restoreRehearsalProceed"),$e=I("restoreRehearsalAbortButton","restoreRehearsalAbort");uF&&(uF.textContent=texts[e].skipToContent);const xe=document.getElementById("offlineIndicator");if(xe){const b=texts[e].offlineIndicator,M=texts[e].reloadAppOfflineNotice||b,me=texts[e].offlineIndicatorHelp||M,ze=typeof navigator<"u"&&typeof navigator.onLine=="boolean"?navigator.onLine===!1:!1;xe.dataset&&(xe.dataset.baseLabel=b,xe.dataset.baseHelp=me,xe.dataset.forceReloadNotice=M,xe.dataset.degradedLabel=texts[e].offlineIndicatorDegraded||M,xe.dataset.degradedHelp=texts[e].offlineIndicatorDegradedHelp||me,xe.dataset.reasonCacheFallback=texts[e].offlineIndicatorReasonCacheFallback||M,xe.dataset.reasonGetFailed=texts[e].offlineIndicatorReasonGetFailed||M,xe.dataset.reasonTimeout=texts[e].offlineIndicatorReasonTimeout||M,xe.dataset.reasonUnreachable=texts[e].offlineIndicatorReasonUnreachable||M,xe.dataset.reasonReloadBlocked=texts[e].offlineIndicatorReasonReloadBlocked||M,xe.dataset.reasonUnknown=texts[e].offlineIndicatorReasonUnknown||me),ze?(xe.textContent=M,xe.setAttribute("data-help",M),xe.removeAttribute("hidden")):(xe.textContent=b,xe.setAttribute("data-help",me))}PI(e);const St=SN[e]||SN.en,Tt=document.getElementById("impressumLink");Tt&&(Tt.textContent=texts[e].impressum,St?.imprint&&Tt.setAttribute("href",St.imprint));const xt=document.getElementById("privacyLink");xt&&(xt.textContent=texts[e].privacy,St?.privacy&&xt.setAttribute("href",St.privacy));const ut=document.getElementById("setupManageHeading");ut&&(ut.textContent=texts[e].setupManageHeading,ut.setAttribute("data-help",texts[e].setupManageHeadingHelp));const Er=document.getElementById("deviceSelectionHeading");Er&&(Er.textContent=texts[e].deviceSelectionHeading,Er.setAttribute("data-help",texts[e].deviceSelectionHeadingHelp));const zt=document.getElementById("resultsHeading");zt&&(zt.textContent=texts[e].resultsHeading,zt.setAttribute("data-help",texts[e].resultsHeadingHelp));const dr=document.getElementById("deviceManagerHeading");dr&&(dr.textContent=texts[e].deviceManagerHeading,dr.setAttribute("data-help",texts[e].deviceManagerHeadingHelp));const Jt=document.getElementById("batteryComparisonHeading"),rr=document.getElementById("batteryComparisonDescription"),Jn=document.getElementById("batteryTable"),nr=document.getElementById("setupDiagramHeading");nr&&(nr.textContent=texts[e].setupDiagramHeading,nr.setAttribute("data-help",texts[e].setupDiagramHeadingHelp)),document.querySelectorAll("#sideMenu [data-nav-key]").forEach(b=>{if(!b||!b.dataset)return;const M=b.dataset.navKey;if(!M)return;const me=texts[e][M];me&&(M==="contactsNav"&&typeof rt=="function"&&b?.tagName==="BUTTON"?rt(b,me,typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.contacts?ICON_GLYPHS.contacts:iconGlyph("\\uF404",ICON_FONT_KEYS.UICONS)):b.textContent=me,b.setAttribute("aria-label",me));const ze=`${M}Help`,Lt=texts[e][ze];Lt?(b.setAttribute("title",Lt),b.setAttribute("data-help",Lt)):(M==="projectRequirementsNav"&&console.warn(`[Cine Power Planner] Missing help text for ${M} in lang ${e}`),b.removeAttribute("title"),b.removeAttribute("data-help"))}),t9(e);const De=document.getElementById("savedSetupsLabel");De&&(De.textContent=texts[e].savedSetupsLabel,De.setAttribute("data-help",texts[e].setupSelectHelp));const vt=document.getElementById("setupNameLabel");vt&&(vt.textContent=texts[e].setupNameLabel,vt.setAttribute("data-help",texts[e].setupNameHelp)),typeof Bv<"u"&&Bv&&rt(Bv,texts[e].deleteSetupBtn,ICON_GLYPHS.trash);const Yt=document.getElementById("sharedLinkLabel");Yt&&(Yt.textContent=texts[e].sharedLinkLabel,Yt.setAttribute("data-help",texts[e].sharedLinkHelp)),typeof yp<"u"&&yp&&rt(yp,texts[e].loadSharedLinkBtn,ICON_GLYPHS.fileImport);const j=typeof jl<"u"?jl:document.getElementById("setupSelect");j&&j.setAttribute("data-help",texts[e].setupSelectHelp);const O=typeof Cu<"u"?Cu:document.getElementById("setupNameInput");O&&O.setAttribute("data-help",texts[e].setupNameHelp);const D=Bv;D&&typeof D.setAttribute=="function"&&(D.setAttribute("title",texts[e].deleteSetupHelp),D.setAttribute("aria-label",texts[e].deleteSetupHelp),D.setAttribute("data-help",texts[e].deleteSetupHelp));const F=I7;F&&(F.setAttribute("title",texts[e].saveSetupHelp),F.setAttribute("aria-label",texts[e].saveSetupHelp),F.setAttribute("data-help",texts[e].saveSetupHelp));const z=generateOverviewBtn;z&&(z.setAttribute("title",texts[e].generateOverviewBtn),z.setAttribute("data-help",texts[e].generateOverviewHelp));const J=generateGearListBtn;J&&(J.setAttribute("title",texts[e].generateGearListBtn),J.setAttribute("data-help",texts[e].generateGearListHelp));try{const b=texts[e].deleteGearListBtnHelp||texts[e].deleteGearListBtn,M=deleteGearListProjectBtn;M&&typeof M.setAttribute=="function"&&(rt(M,texts[e].deleteGearListBtn,ICON_GLYPHS.trash),M.setAttribute("title",b),M.setAttribute("data-help",b),M.setAttribute("aria-label",b))}catch(b){console.warn("Error setting deleteGearListProjectBtn attributes",b)}const Q=document.getElementById("editProjectBtn");Q&&typeof Q.setAttribute=="function"&&(Q.textContent=texts[e].editProjectBtn,Q.setAttribute("title",texts[e].editProjectBtn),Q.setAttribute("data-help",texts[e].editProjectBtn));const le=document.getElementById("addExtraGearBtn");if(le&&typeof le.setAttribute=="function"){const b=texts[e].addExtraGearBtn||texts.en?.addExtraGearBtn||"Add temporary extra gear";le.textContent=b,le.setAttribute("title",b),le.setAttribute("data-help",b)}if(HT&&(HT.setAttribute("title",texts[e].shareSetupBtn),HT.setAttribute("data-help",texts[e].shareSetupHelp)),UT){const b=texts[e].shareDialogTitle||texts.en?.shareDialogTitle||UT.textContent;UT.textContent=b}if(zT){const b=texts[e].shareFilenameLabel||texts.en?.shareFilenameLabel||zT.textContent;zT.textContent=b}if(dp){const b=texts[e].shareDialogConfirm||texts.en?.shareDialogConfirm||dp.textContent;rt(dp,b,ICON_GLYPHS.fileExport),dp.setAttribute("title",b),dp.setAttribute("aria-label",b),dp.setAttribute("data-help",texts[e].shareSetupHelp)}if(Jg){const b=texts[e].shareDialogCancel||texts.en?.shareDialogCancel||Jg.textContent;rt(Jg,b,ICON_GLYPHS.circleX),Jg.setAttribute("title",b),Jg.setAttribute("aria-label",b)}if($T){const b=texts[e].shareIncludeAutoGearLabel||texts.en?.shareIncludeAutoGearLabel||$T.textContent;$T.textContent=b;const M=texts[e].shareIncludeAutoGearHelp||texts.en?.shareIncludeAutoGearHelp||b;VT&&typeof VT.setAttribute=="function"&&VT.setAttribute("data-help",M),aF&&aF.setAttribute("aria-label",b)}if(qT){const b=texts[e].shareIncludeOwnedGearLabel||texts.en?.shareIncludeOwnedGearLabel||qT.textContent;qT.textContent=b;const M=texts[e].shareIncludeOwnedGearHelp||texts.en?.shareIncludeOwnedGearHelp||b;KT&&typeof KT.setAttribute=="function"&&KT.setAttribute("data-help",M),iF&&iF.setAttribute("aria-label",b)}let Ee=Zg?Zg.textContent:"";if(WT){const b=texts[e].sharedImportDialogTitle||texts.en?.sharedImportDialogTitle||WT.textContent;WT.textContent=b}if(Gv){const b=texts[e].sharedImportDialogMessage||texts.en?.sharedImportDialogMessage||Gv.textContent;Gv.textContent=b,Gv.setAttribute("data-help",b)}if(Mv){const b=texts[e].sharedImportDialogConfirm||texts.en?.sharedImportDialogConfirm||Mv.textContent;rt(Mv,b,ICON_GLYPHS.check),Mv.setAttribute("data-help",b)}if(_v){const b=texts[e].sharedImportDialogCancel||texts.en?.sharedImportDialogCancel||_v.textContent;rt(_v,b,ICON_GLYPHS.circleX),_v.setAttribute("data-help",b)}if(Zg){const b=texts[e].sharedImportAutoGearLabel||texts.en?.sharedImportAutoGearLabel||Zg.textContent;Zg.textContent=b,Ee=b,sF&&sF.setAttribute("data-help",b)}if(gh&&Ee&&(gh.setAttribute("aria-label",Ee),gh.setAttribute("data-help",Ee)),pp){const b=texts[e].sharedImportAutoGearNone||texts.en?.sharedImportAutoGearNone||pp.textContent;pp.textContent=b;const M=texts[e].sharedImportAutoGearNoneHelp||texts.en?.sharedImportAutoGearNoneHelp||b;pp.setAttribute("data-help",M),pp.setAttribute("title",M),pp.setAttribute("aria-label",b)}if(mp){const b=texts[e].sharedImportAutoGearProject||texts.en?.sharedImportAutoGearProject||mp.textContent;mp.textContent=b;const M=texts[e].sharedImportAutoGearProjectHelp||texts.en?.sharedImportAutoGearProjectHelp||b;mp.setAttribute("data-help",M),mp.setAttribute("title",M),mp.setAttribute("aria-label",b)}if(gp){const b=texts[e].sharedImportAutoGearGlobal||texts.en?.sharedImportAutoGearGlobal||gp.textContent;gp.textContent=b;const M=texts[e].sharedImportAutoGearGlobalHelp||texts.en?.sharedImportAutoGearGlobalHelp||b;gp.setAttribute("data-help",M),gp.setAttribute("title",M),gp.setAttribute("aria-label",b)}yp&&(yp.setAttribute("title",texts[e].loadSharedLinkBtn),yp.setAttribute("data-help",texts[e].applySharedLinkHelp)),runtimeFeedbackBtn&&(runtimeFeedbackBtn.setAttribute("title",texts[e].runtimeFeedbackBtn),runtimeFeedbackBtn.setAttribute("data-help",texts[e].runtimeFeedbackBtnHelp),rt(runtimeFeedbackBtn,texts[e].runtimeFeedbackBtn,ICON_GLYPHS.feedback)),jl&&jl.options&&jl.options.length>0&&(jl.options[0].textContent=texts[e].newSetupOption),checkSetupChanged();const pe=document.getElementById("cameraLabel");pe&&(pe.textContent=texts[e].cameraLabel,pe.setAttribute("data-help",texts[e].cameraSelectHelp));const ne=document.getElementById("monitorLabel");ne&&(ne.textContent=texts[e].monitorLabel,ne.setAttribute("data-help",texts[e].monitorSelectHelp));const Se=document.getElementById("videoLabel");Se&&(Se.textContent=texts[e].videoLabel,Se.setAttribute("data-help",texts[e].videoSelectHelp));const Le=document.getElementById("cageLabel");Le&&(Le.textContent=texts[e].cageLabel,Le.setAttribute("data-help",texts[e].cageSelectHelp));const ke=document.getElementById("distanceLabel");ke&&(ke.textContent=texts[e].distanceLabel,ke.setAttribute("data-help",texts[e].distanceSelectHelp));const We=document.getElementById("batteryPlateLabel");We&&(We.textContent=texts[e].batteryPlateLabel,We.setAttribute("data-help",texts[e].batteryPlateSelectHelp));const nt=document.getElementById("batteryHotswapLabel");nt&&(nt.textContent=texts[e].batteryHotswapLabel,nt.setAttribute("data-help",texts[e].batteryHotswapSelectHelp)),p9();const it=document.getElementById("fizLegend");it&&(it.textContent=texts[e].fizLegend,it.setAttribute("data-help",texts[e].fizLegendHelp));const Et=document.getElementById("fizMotorsLabel");Et&&(Et.textContent=texts[e].fizMotorsLabel,Et.setAttribute("data-help",texts[e].fizMotorsHelp));const yr=document.getElementById("fizControllersLabel");yr&&(yr.textContent=texts[e].fizControllersLabel,yr.setAttribute("data-help",texts[e].fizControllersHelp)),document.querySelectorAll("#motorNotesLabel,#controllerNotesLabel,#distanceNotesLabel").forEach(b=>{b.textContent=texts[e].notesLabel});var hr=typeof cineResults=="object"?cineResults:null,Vr=!1;if(hr&&typeof hr.localizeResultsSection=="function")try{Vr=hr.localizeResultsSection({lang:e,langTexts:texts[e]||{},fallbackTexts:texts.en||{},document,breakdownListElem:typeof breakdownListElem<"u"&&breakdownListElem?breakdownListElem:null,elements:{totalPowerLabel:document.getElementById("totalPowerLabel"),batteryCountLabel:document.getElementById("batteryCountLabel"),pinWarning:typeof Tv<"u"?Tv:null,dtapWarning:typeof Ov<"u"?Ov:null,hotswapWarning:typeof xv<"u"?xv:null,powerWarningTitle:typeof kv<"u"?kv:null,powerWarningLimitsHeading:typeof Iv<"u"?Iv:null,powerWarningAdvice:typeof Pv<"u"?Pv:null,powerWarningCloseBtn:typeof Qp<"u"?Qp:null,batteryLifeUnit:document.getElementById("batteryLifeUnit"),batteryLifeLabel:typeof Qg<"u"?Qg:document.getElementById("batteryLifeLabel"),runtimeAverageNote:typeof Rv<"u"?Rv:document.getElementById("runtimeAverageNote"),tempNote:document.getElementById("temperatureNote")},refreshTotalCurrentLabels:typeof refreshTotalCurrentLabels=="function"?refreshTotalCurrentLabels:null,updateMountVoltageSettingLabels:typeof updateMountVoltageSettingLabels=="function"?updateMountVoltageSettingLabels:null,getCurrentSetupKey:typeof getCurrentSetupKey=="function"?getCurrentSetupKey:null,renderFeedbackTable:typeof renderFeedbackTable=="function"?renderFeedbackTable:null,dispatchTemperatureNoteRender:typeof yT=="function"?yT:null,refreshFeedbackTemperatureLabel:typeof refreshFeedbackTemperatureLabel=="function"?refreshFeedbackTemperatureLabel:null,updateFeedbackTemperatureOptions:typeof updateFeedbackTemperatureOptions=="function"?updateFeedbackTemperatureOptions:null,lastRuntimeHours:typeof MT<"u"?MT:null,temperatureUnit:typeof temperatureUnit<"u"?temperatureUnit:null,setButtonLabelWithIcon:typeof rt=="function"?rt:null,iconGlyphs:typeof ICON_GLYPHS<"u"?ICON_GLYPHS:null})}catch(b){console.warn("cineResults.localizeResultsSection failed",b),Vr=!1}var Rr=!1;if(hr&&typeof hr.localizeBatteryComparisonSection=="function")try{Rr=hr.localizeBatteryComparisonSection({lang:e,langTexts:texts[e]||{},fallbackTexts:texts.en||{},document,batteryComparisonHeading:Jt,batteryComparisonDescription:rr,batteryComparisonTable:Jn})}catch(b){console.warn("cineResults.localizeBatteryComparisonSection failed",b),Rr=!1}if(Rr||(Jt&&(Jt.textContent=texts[e].batteryComparisonHeading,Jt.setAttribute("data-help",texts[e].batteryComparisonHeadingHelp)),rr&&(rr.textContent=texts[e].batteryComparisonDescription,texts[e].batteryComparisonDescriptionHelp?rr.setAttribute("data-help",texts[e].batteryComparisonDescriptionHelp):rr.removeAttribute("data-help")),Jn&&(texts[e].batteryComparisonTableHelp?Jn.setAttribute("data-help",texts[e].batteryComparisonTableHelp):Jn.removeAttribute("data-help"))),!Vr){const b=document.getElementById("resultsPlainSummary");b&&b.setAttribute("data-help",texts[e].resultsPlainSummaryHelp);const M=document.getElementById("resultsPlainSummaryTitle");M&&(M.textContent=texts[e].resultsPlainSummaryTitle);const me=document.getElementById("resultsPlainSummaryText");me&&(me.textContent=texts[e].resultsPlainSummaryPrompt);const ze=document.getElementById("resultsPlainSummaryNote");ze&&(ze.textContent=texts[e].resultsPlainSummaryNote);const Lt=typeof breakdownListElem<"u"&&breakdownListElem?breakdownListElem:document.getElementById("breakdownList");Lt&&Lt.setAttribute("data-help",texts[e].breakdownListHelp);const ft=document.getElementById("totalPowerLabel");ft&&texts[e]&&(ft.textContent=texts[e].totalPowerLabel,ft.setAttribute("data-help",texts[e].totalPowerHelp)),typeof refreshTotalCurrentLabels=="function"&&refreshTotalCurrentLabels(e),updateMountVoltageSettingLabels(e);const sr=document.getElementById("batteryCountLabel");sr&&(sr.textContent=texts[e].batteryCountLabel,sr.setAttribute("data-help",texts[e].batteryCountHelp)),Tv&&Tv.setAttribute("data-help",texts[e].pinWarningHelp),Ov&&Ov.setAttribute("data-help",texts[e].dtapWarningHelp),xv&&xv.setAttribute("data-help",texts[e].hotswapWarningHelp),kv&&(kv.textContent=texts[e].powerWarningTitle),Iv&&(Iv.textContent=texts[e].powerWarningLimitsHeading),Pv&&(Pv.textContent=texts[e].powerWarningAdvice),Qp&&rt(Qp,texts[e].powerWarningClose,ICON_GLYPHS.check);const pr=document.getElementById("batteryLifeUnit");pr&&(pr.textContent=texts[e].batteryLifeUnit);const Xe=renderFeedbackTable(getCurrentSetupKey());if(Qg){let cn=texts[e].batteryLifeLabel;if(Xe){const lt=texts[e].runtimeUserCountNote.replace("{count}",Xe.count),It=cn.indexOf(")");It!==-1&&(cn=`${cn.slice(0,It)}, ${lt}${cn.slice(It)}`)}Qg.textContent=cn,Qg.setAttribute("data-help",texts[e].batteryLifeHelp)}Rv&&(Rv.textContent=Xe&&Xe.count>4?texts[e].runtimeAverageNote:""),yT(MT),typeof refreshFeedbackTemperatureLabel=="function"&&refreshFeedbackTemperatureLabel(e,temperatureUnit),updateFeedbackTemperatureOptions(e,temperatureUnit);const Yn=document.getElementById("temperatureNote");Yn&&Yn.setAttribute("data-help",texts[e].temperatureNoteHelp)}const Qe=(b,M)=>{const me=document.getElementById(b);return me&&M!==void 0&&(me.textContent=M),me},Vn=(b,M,me)=>{const ze=document.getElementById(b);return ze&&M&&me!==void 0&&ze.setAttribute(M,me),ze};if(Qe("addDeviceHeading",texts[e].addDeviceHeading),Qe("categoryLabel",texts[e].categoryLabel),Qe("subcategoryLabel",texts[e].subcategoryLabel),Qe("deviceNameLabel",texts[e].deviceNameLabel),Qe("consumptionLabel",texts[e].consumptionLabel),Qe("capacityLabel",texts[e].capacityLabel),Qe("pinLabel",texts[e].pinLabel),Qe("dtapLabel",texts[e].dtapLabel),Qe("cameraWattLabel",texts[e].cameraWattLabel),Qe("cameraVoltageLabel",texts[e].cameraVoltageLabel),Qe("cameraPortTypeLabel",texts[e].cameraPortTypeLabel),Qe("cameraPlatesLabel",texts[e].cameraPlatesLabel),Qe("cameraMediaLabel",texts[e].cameraMediaLabel),Qe("cameraLensMountLabel",texts[e].cameraLensMountLabel),Qe("cameraPowerDistLabel",texts[e].powerDistributionLabel),Qe("cameraVideoOutputsLabel",texts[e].videoOutputsLabel),Qe("cameraFIZConnectorLabel",texts[e].fizConnectorLabel),Qe("cameraViewfinderLabel",texts[e].viewfinderLabel),Qe("cameraTimecodeLabel",texts[e].timecodeLabel),Qe("powerInputsHeading",texts[e].powerInputsHeading),Qe("powerDistributionHeading",texts[e].powerDistributionHeading),Qe("videoOutputsHeading",texts[e].videoOutputsHeading),Qe("fizConnectorHeading",texts[e].fizConnectorHeading),Qe("mediaHeading",texts[e].mediaHeading),Qe("viewfinderHeading",texts[e].viewfinderHeading),Qe("lensMountHeading",texts[e].lensMountHeading),Qe("lensDeviceMountHeading",texts[e].lensDeviceMountHeading),Qe("lensDeviceMountLabel",texts[e].lensDeviceMountLabel)&&Vn("lensDeviceMountLabel","data-help",texts[e].lensDeviceMountHelp),Qe("lensFocusScaleUnitLabel",texts[e].lensFocusScaleLabel||texts[e].focusScaleSetting)){const b=texts[e].lensFocusScaleLabel||texts[e].focusScaleSetting,M=texts[e].lensFocusScaleHelp||texts[e].lensFocusScaleLabel||texts[e].focusScaleSettingHelp||b;Vn("lensFocusScaleUnitLabel","data-help",M),wu&&(wu.setAttribute("data-help",M),wu.setAttribute("aria-label",b))}$7(e),Qe("timecodeHeading",texts[e].timecodeHeading),Qe("monitorScreenSizeLabel",texts[e].monitorScreenSizeLabel),Qe("monitorBrightnessLabel",texts[e].monitorBrightnessLabel),Qe("monitorWattLabel",texts[e].monitorWattLabel),Qe("monitorVoltageLabel",texts[e].monitorVoltageLabel),Qe("monitorPortTypeLabel",texts[e].monitorPortTypeLabel),Qe("monitorVideoInputsHeading",texts[e].monitorVideoInputsHeading),Qe("monitorVideoOutputsHeading",texts[e].monitorVideoOutputsHeading),Qe("monitorVideoInputsLabel",texts[e].monitorVideoInputsLabel),Qe("monitorVideoOutputsLabel",texts[e].monitorVideoOutputsLabel),Qe("monitorWirelessTxLabel",texts[e].monitorWirelessTxLabel);const sn=Qe("monitorLatencyLabel",texts[e].monitorLatencyLabel);if(sn){const b=texts[e].monitorLatencyHelp;b?(sn.setAttribute("data-help",b),sn.setAttribute("title",b),hp&&(hp.setAttribute("data-help",b),hp.setAttribute("title",b))):(sn.removeAttribute("data-help"),sn.removeAttribute("title"),hp&&(hp.removeAttribute("data-help"),hp.removeAttribute("title")))}Qe("monitorAudioOutputLabel",texts[e].monitorAudioOutputLabel),Qe("viewfinderDetailsHeading",texts[e].viewfinderDetailsHeading),Qe("viewfinderScreenSizeLabel",texts[e].viewfinderScreenSizeLabel),Qe("viewfinderBrightnessLabel",texts[e].viewfinderBrightnessLabel),Qe("viewfinderWattLabel",texts[e].viewfinderWattLabel),Qe("viewfinderVoltageLabel",texts[e].viewfinderVoltageLabel),Qe("viewfinderPortTypeLabel",texts[e].viewfinderPortTypeLabel),Qe("viewfinderVideoInputsHeading",texts[e].viewfinderVideoInputsHeading),Qe("viewfinderVideoOutputsHeading",texts[e].viewfinderVideoOutputsHeading),Qe("viewfinderVideoInputsLabel",texts[e].viewfinderVideoInputsLabel),Qe("viewfinderVideoOutputsLabel",texts[e].viewfinderVideoOutputsLabel),Qe("viewfinderWirelessTxLabel",texts[e].viewfinderWirelessTxLabel);const hn=Qe("viewfinderLatencyLabel",texts[e].viewfinderLatencyLabel);if(hn){hn.textContent=texts[e].viewfinderLatencyLabel;const b=texts[e].viewfinderLatencyHelp;b?(hn.setAttribute("data-help",b),hn.setAttribute("title",b),bp&&(bp.setAttribute("data-help",b),bp.setAttribute("title",b))):(hn.removeAttribute("data-help"),hn.removeAttribute("title"),bp&&(bp.removeAttribute("data-help"),bp.removeAttribute("title")))}Qe("videoPowerInputsHeading",texts[e].videoPowerInputsHeading||texts[e].powerInputsHeading||"Power Inputs");const ln=document.getElementById("videoPowerInputLabel");if(ln){ln.textContent=texts[e].videoPowerInputLabel||texts[e].powerInputsHeading;const b=texts[e].videoPowerInputHelp||"";b?(ln.setAttribute("data-help",b),ln.setAttribute("title",b)):(ln.removeAttribute("data-help"),ln.removeAttribute("title"))}Qe("videoVideoInputsHeading",texts[e].videoVideoInputsHeading),Qe("videoVideoInputsLabel",texts[e].videoVideoInputsLabel),Qe("videoVideoOutputsHeading",texts[e].videoVideoOutputsHeading),Qe("videoVideoOutputsLabel",texts[e].videoVideoOutputsLabel),Qe("monitorDetailsHeading",texts[e].monitorDetailsHeading),Qe("monitorPowerHeading",texts[e].monitorPowerHeading);const Zo=texts[e]&&texts[e].addDeviceBtn||"Add",kn=texts[e]&&texts[e].updateDeviceBtn||"Update",ea=document.getElementById("addDeviceBtn");ea&&(ea.dataset&&ea.dataset.mode==="edit"?(rt(ea,kn,ICON_GLYPHS.save),ea.setAttribute("data-help",texts[e]&&texts[e].updateDeviceBtnHelp||"")):(rt(ea,Zo,ICON_GLYPHS.add),ea.setAttribute("data-help",texts[e]&&texts[e].addDeviceBtnHelp||"")));const Fr=document.getElementById("cancelEditBtn");Fr&&(rt(Fr,texts[e].cancelEditBtn,ICON_GLYPHS.circleX),Fr.setAttribute("data-help",texts[e].cancelEditBtnHelp));const yo=document.getElementById("exportDataBtn");yo&&(rt(yo,texts[e].exportDataBtn,ICON_GLYPHS.fileExport),yo.setAttribute("data-help",texts[e].exportDataHelp));const br=document.getElementById("importDataBtn");br&&(rt(br,texts[e].importDataBtn,ICON_GLYPHS.fileImport),br.setAttribute("data-help",texts[e].importDataHelp)),typeof Cu<"u"&&Cu&&(Cu.placeholder=(texts[e].setupNameLabel||"").replace(":","")),typeof JT<"u"&&JT&&(JT.placeholder=texts[e].placeholder_deviceName),typeof ZT<"u"&&ZT&&(ZT.placeholder=texts[e].placeholder_watt),typeof rO<"u"&&rO&&(rO.placeholder=texts[e].placeholder_capacity),typeof nO<"u"&&nO&&(nO.placeholder=texts[e].placeholder_pin),typeof bh<"u"&&bh&&(bh.placeholder=texts[e].placeholder_dtap),typeof eO<"u"&&eO&&(eO.placeholder=texts[e].placeholder_voltage),typeof tO<"u"&&tO&&(tO.placeholder=texts[e].placeholder_voltage),j7(e);const _t=document.getElementById("toggleDeviceManager"),kt=document.getElementById("device-manager");kt&&_t&&(kt.classList.contains("hidden")?(rt(_t,texts[e].toggleDeviceManager,ICON_GLYPHS.gears),_t.setAttribute("title",texts[e].toggleDeviceManager),_t.setAttribute("data-help",texts[e].toggleDeviceManagerHelp),_t.setAttribute("aria-expanded","false")):(rt(_t,texts[e].hideDeviceManager,ICON_GLYPHS.minus),_t.setAttribute("title",texts[e].hideDeviceManager),_t.setAttribute("data-help",texts[e].hideDeviceManagerHelp),_t.setAttribute("aria-expanded","true")));const Mr=document.getElementById("newCategory");Mr&&Mr.options&&Array.from(Mr.options).forEach(b=>{b.textContent=hh(b.value,e)});const In={de:"Keine Auswahl",es:"Ninguno",fr:"Aucun"};document.querySelectorAll('select option[value="None"]').forEach(b=>{b.textContent=In[e]||"None"});try{localStorage.setItem("language",e)}catch(b){console.warn("Could not save language to localStorage",b)}typeof refreshDeviceLists=="function"?refreshDeviceLists():typeof window<"u"&&typeof window.refreshDeviceLists=="function"&&window.refreshDeviceLists(),M7(),updateCalculations();const Do=typeof document<"u"?document.getElementById("existingDevicesHeading"):null;Do&&(Do.textContent=texts[e].existingDevicesHeading),Nv&&(Nv.setAttribute("title",texts[e].darkModeLabel),Nv.setAttribute("aria-label",texts[e].darkModeLabel),Nv.setAttribute("data-help",texts[e].darkModeHelp||texts[e].darkModeLabel)),Dv&&(Dv.setAttribute("title",texts[e].pinkModeLabel),Dv.setAttribute("aria-label",texts[e].pinkModeLabel),Dv.setAttribute("data-help",texts[e].pinkModeHelp||texts[e].pinkModeLabel)),Jf&&(Jf.setAttribute("title",texts[e].settingsButton),Jf.setAttribute("aria-label",texts[e].settingsButton),Jf.setAttribute("data-help",texts[e].settingsButtonHelp||texts[e].settingsButton));const ho=document.getElementById("settingsTitle");ho&&(ho.textContent=texts[e].settingsHeading,ho.setAttribute("data-help",texts[e].settingsHeadingHelp||texts[e].settingsHeading));const is=document.getElementById("settingsTablist");if(is){const b=texts[e].settingsSectionsLabel||texts.en?.settingsSectionsLabel||is.getAttribute("aria-label")||texts[e].settingsHeading||"Settings sections";is.setAttribute("aria-label",b)}const nu=b=>{if(!b||typeof b!="object")return"";const M=b.querySelector?.(".settings-tab-label");if(M&&typeof M.textContent=="string"){const me=M.textContent.trim();if(me)return me}return typeof b.textContent=="string"?b.textContent.trim():""},ou=b=>{if(typeof b!="string")return"";const M=b.trim();if(!M)return"";const me=M.match(/^[^.!?]*[.!?]/u);if(me&&me[0]){const sr=me[0].trim();if(sr.length>=24||M.length<=90)return sr}if(M.length<=90)return M;const ze=M.slice(0,90);let Lt=ze.length;for(;Lt>0&&ze[Lt-1]&&ze[Lt-1].trim()!=="";)Lt-=1;return`${(Lt>0?ze.slice(0,Lt).trimEnd():"")||ze.trim()}`},si=(b,M,me)=>{if(!b)return;const ze=(M||nu(b)||"").trim(),Lt=b.querySelector?.(".settings-tab-label");Lt?Lt.textContent=ze:b.textContent=ze,ze?b.setAttribute("aria-label",ze):b.removeAttribute("aria-label");const ft=(me||ze||"").trim();ft?(b.setAttribute("data-help",ft),b.setAttribute("title",ft)):(b.removeAttribute("data-help"),b.removeAttribute("title"));const sr=ou(ft);sr?b.setAttribute("data-summary",sr):b.removeAttribute("data-summary");const pr=b.querySelector?.(".settings-tab-caption");if(pr){const Xe=sr||ze;pr.textContent=Xe,Xe?pr.removeAttribute("hidden"):pr.setAttribute("hidden","")}};if(yA){const b=texts[e].settingsTabGeneral||texts.en?.settingsTabGeneral||nu(yA)||"General",M=texts[e].settingsTabGeneralHelp||texts.en?.settingsTabGeneralHelp||texts[e].settingsHeadingHelp||b;if(si(yA,b,M),fO&&(fO.textContent=b,fO.setAttribute("data-help",M)),dO){const me=texts[e].generalSectionLanguageHeading||texts.en?.generalSectionLanguageHeading||dO.textContent;dO.textContent=me}if(pO){const me=texts[e].generalSectionAppearanceHeading||texts.en?.generalSectionAppearanceHeading||pO.textContent;pO.textContent=me}if(mO){const me=texts[e].generalSectionTypographyHeading||texts.en?.generalSectionTypographyHeading||mO.textContent;mO.textContent=me}if(gO){const me=texts[e].generalSectionBrandingHeading||texts.en?.generalSectionBrandingHeading||gO.textContent;gO.textContent=me}hA.updateLocalization({language:e,texts:texts[e]||{},fallbackTexts:texts[oo]||texts.en||{}}),hA.isInitialized()&&hA.render()}si(dq,texts[e].settingsTabAutoGear||texts.en?.settingsTabAutoGear||texts[e].autoGearHeading||texts.en?.autoGearHeading,texts[e].settingsTabAutoGearHelp||texts.en?.settingsTabAutoGearHelp||texts[e].autoGearHeadingHelp||texts.en?.autoGearHeadingHelp),si(pq,texts[e].settingsTabAccessibility||texts.en?.settingsTabAccessibility||texts[e].accessibilityHeading||texts.en?.accessibilityHeading,texts[e].settingsTabAccessibilityHelp||texts.en?.settingsTabAccessibilityHelp||texts[e].accessibilityHeadingHelp||texts.en?.accessibilityHeadingHelp),si(mq,texts[e].settingsTabBackup||texts.en?.settingsTabBackup||texts[e].backupHeading||texts.en?.backupHeading,texts[e].settingsTabBackupHelp||texts.en?.settingsTabBackupHelp||texts[e].backupHeadingHelp||texts.en?.backupHeadingHelp),si(gq,texts[e].settingsTabData||texts.en?.settingsTabData||texts[e].dataHeading||texts.en?.dataHeading,texts[e].settingsTabDataHelp||texts.en?.settingsTabDataHelp||texts[e].dataHeadingHelp||texts.en?.dataHeadingHelp),si(yq,texts[e].settingsTabAbout||texts.en?.settingsTabAbout||texts[e].aboutHeading||texts.en?.aboutHeading,texts[e].settingsTabAboutHelp||texts.en?.settingsTabAboutHelp||texts[e].aboutHeadingHelp||texts.en?.aboutHeadingHelp);const bo=document.getElementById("settingsLanguageLabel");if(bo){bo.textContent=texts[e].languageSetting;const b=texts[e].settingsLanguageHelp||texts[e].languageSetting;bo.setAttribute("data-help",b),ny&&(ny.setAttribute("data-help",b),ny.setAttribute("aria-label",texts[e].languageSetting))}const Mn=document.getElementById("settingsDarkModeLabel");if(Mn){Mn.textContent=texts[e].darkModeSetting;const b=texts[e].settingsDarkModeHelp||texts[e].darkModeSetting;Mn.setAttribute("data-help",b),hO&&(hO.setAttribute("data-help",b),hO.setAttribute("aria-label",texts[e].darkModeSetting))}const xi=document.getElementById("settingsPinkModeLabel");if(xi){xi.textContent=texts[e].pinkModeSetting;const b=texts[e].settingsPinkModeHelp||texts[e].pinkModeSetting;xi.setAttribute("data-help",b),bO&&(bO.setAttribute("data-help",b),bO.setAttribute("aria-label",texts[e].pinkModeSetting))}const Da=document.getElementById("accentColorLabel"),li=texts[e].accentColorHelp||texts[e].accentColorSetting;if(Da&&(Da.textContent=texts[e].accentColorSetting,Da.setAttribute("data-help",li)),SO&&(SO.setAttribute("data-help",li),SO.setAttribute("aria-label",texts[e].accentColorSetting)),yO){const b=texts[e].cameraColorSettingDescription||texts.en?.cameraColorSettingDescription||yO.textContent;yO.textContent=b}const ta=texts[e].cameraColorInputHelp||texts.en?.cameraColorInputHelp||"";if([["A",EJ,RJ],["B",AJ,TJ],["C",CJ,OJ],["D",wJ,xJ],["E",LJ,kJ]].forEach(([b,M,me])=>{if(!M)return;const ze=`cameraColor${b}Label`,Lt=texts[e][ze]||texts.en?.[ze]||M.textContent;M.textContent=Lt;const ft=ta?ta.replace("%s",b):"";ft?M.setAttribute("data-help",ft):M.removeAttribute("data-help"),me&&(ft?(me.setAttribute("data-help",ft),me.setAttribute("aria-label",ft)):(me.removeAttribute("data-help"),me.setAttribute("aria-label",Lt)))}),vp){const b=texts[e]&&texts[e].accentColorReset||texts.en&&texts.en.accentColorReset||vp.textContent||"Reset to default",M=texts[e]&&texts[e].accentColorResetHelp||li;vp.textContent=b,vp.setAttribute("data-help",M),vp.setAttribute("aria-label",M),vp.setAttribute("title",M)}const ra=document.getElementById("settingsTemperatureUnitLabel");if(ra){ra.textContent=texts[e].temperatureUnitSetting;const b=texts[e].temperatureUnitSettingHelp||texts[e].temperatureUnitSetting;ra.setAttribute("data-help",b),typeof Ep<"u"&&Ep&&(Ep.setAttribute("data-help",b),Ep.setAttribute("aria-label",texts[e].temperatureUnitSetting),Array.from(Ep.options||[]).forEach(M=>{if(!M)return;const me=d(M.value);M.textContent=z7(e,me)}),Ep.value=temperatureUnit)}const _n=document.getElementById("settingsFocusScaleLabel");if(_n){_n.textContent=texts[e].focusScaleSetting;const b=texts[e].focusScaleSettingHelp||texts[e].focusScaleSetting;_n.setAttribute("data-help",b),typeof Ap<"u"&&Ap&&(Ap.setAttribute("data-help",b),Ap.setAttribute("aria-label",texts[e].focusScaleSetting),Array.from(Ap.options||[]).forEach(M=>{if(!M)return;const me=m(M.value);M.textContent=C9(e,me)}),Ap.value=g())}const ki=document.getElementById("settingsFontSizeLabel");if(ki){ki.textContent=texts[e].fontSizeSetting;const b=texts[e].fontSizeSettingHelp||texts[e].fontSizeSetting;ki.setAttribute("data-help",b),vO&&(vO.setAttribute("data-help",b),vO.setAttribute("aria-label",texts[e].fontSizeSetting))}const Ii=document.getElementById("settingsFontFamilyLabel");if(Ii){Ii.textContent=texts[e].fontFamilySetting;const b=texts[e].fontFamilySettingHelp||texts[e].fontFamilySetting;Ii.setAttribute("data-help",b),EO&&(EO.setAttribute("data-help",b),EO.setAttribute("aria-label",texts[e].fontFamilySetting))}if(Bl){const b=texts[e].localFontsButtonHelp||Bl.textContent;Bl.setAttribute("data-help",b),Bl.setAttribute("title",b),Bl.setAttribute("aria-label",b)}if(CO){const b=texts[e]&&texts[e].bundledFontsGroup||texts.en&&texts.en.bundledFontsGroup||CO.label;b&&(CO.label=b)}if(AO){const b=texts[e]&&texts[e].localFontsGroup||texts.en&&texts.en.localFontsGroup||AO.label;b&&(AO.label=b)}if(Bl){const b=texts[e]&&texts[e].localFontsButton||texts.en&&texts.en.localFontsButton||Bl.textContent;b&&(rt(Bl,b,ICON_GLYPHS.add),Bl.setAttribute("aria-label",b),Bl.setAttribute("title",b))}if(oy&&oy.dataset.statusKey){const b=oy.dataset.statusKey,M=oy.dataset.statusArg;let me=texts[e]&&texts[e][b]||texts.en&&texts.en[b]||"";me&&M!==void 0&&M!==null?me=me.replace("%s",M):!me&&M!==void 0&&M!==null&&(me=M),oy.textContent=me}const Na=document.getElementById("settingsLogoLabel");if(Na){Na.textContent=texts[e].logoSetting;const b=texts[e].logoSettingHelp||texts[e].logoSetting;Na.setAttribute("data-help",b),wO&&(wO.setAttribute("data-help",b),wO.setAttribute("aria-label",texts[e].logoSetting))}if(rA){rA.textContent=texts[e].autoGearHeading||texts.en?.autoGearHeading||"Automatic Gear Rules";const b=texts[e].autoGearHeadingHelp||texts.en?.autoGearHeadingHelp;b&&rA.setAttribute("data-help",b)}if(SI&&(SI.textContent=texts[e].autoGearDescription||texts.en?.autoGearDescription||""),nA){const b=texts[e].autoGearMonitorDefaultsHeading||texts.en?.autoGearMonitorDefaultsHeading||nA.textContent;nA.textContent=b}if(oA){const b=texts[e].autoGearMonitorDefaultsDescription||texts.en?.autoGearMonitorDefaultsDescription||oA.textContent;oA.textContent=b}if(vI.forEach(b=>{if(!b)return;const M=AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS[b.key],me=M&&(texts[e][M]||texts.en?.[M])||b.label?.textContent;b.label&&me&&(b.label.textContent=me,b.label.setAttribute("data-help",me)),b.select&&me&&(b.select.setAttribute("aria-label",me),b.select.setAttribute("data-help",me))}),kr("updateAutoGearMonitorDefaultOptions",[],{defer:!0}),kr("renderAutoGearMonitorDefaultsControls",[],{defer:!0}),EI&&(EI.textContent=texts[e].autoGearPresetDescription||texts.en?.autoGearPresetDescription||""),Ny){const b=texts[e].autoGearPresetLabel||texts.en?.autoGearPresetLabel||Ny.textContent,M=texts[e].autoGearPresetDescription||texts.en?.autoGearPresetDescription||b;Ny.textContent=b,Ny.setAttribute("data-help",M),aA&&(aA.setAttribute("aria-label",b),aA.setAttribute("data-help",M))}if(Gp){const b=texts[e].autoGearSavePresetButton||texts.en?.autoGearSavePresetButton||Gp.textContent;rt(Gp,b,ICON_GLYPHS.save),Gp.setAttribute("data-help",b),Gp.setAttribute("aria-label",b)}if(Mp){const b=texts[e].autoGearDeletePresetButton||texts.en?.autoGearDeletePresetButton||Mp.textContent;rt(Mp,b,ICON_GLYPHS.trash),Mp.setAttribute("data-help",b),Mp.setAttribute("aria-label",b)}if(ku){const b=texts[e].autoGearAddRule||texts.en?.autoGearAddRule||ku.textContent;rt(ku,b,ICON_GLYPHS.add);const M=texts[e].autoGearHeadingHelp||texts.en?.autoGearHeadingHelp||b;ku.setAttribute("data-help",M)}if(Rf){const b=texts[e].autoGearResetFactoryButton||texts.en?.autoGearResetFactoryButton||Rf.textContent,M=texts[e].autoGearResetFactoryHelp||texts.en?.autoGearResetFactoryHelp||b;rt(Rf,b,ICON_GLYPHS.reload),Rf.setAttribute("data-help",M),Rf.setAttribute("title",M),Rf.setAttribute("aria-label",b)}if(Cp){const b=texts[e].autoGearExportButton||texts.en?.autoGearExportButton||Cp.textContent,M=texts[e].autoGearExportHelp||texts.en?.autoGearExportHelp||b;rt(Cp,b,ICON_GLYPHS.fileExport),Cp.setAttribute("data-help",M),Cp.setAttribute("title",M),Cp.setAttribute("aria-label",b)}if(wp){const b=texts[e].autoGearImportButton||texts.en?.autoGearImportButton||wp.textContent,M=texts[e].autoGearImportHelp||texts.en?.autoGearImportHelp||b;rt(wp,b,ICON_GLYPHS.fileImport),wp.setAttribute("data-help",M),wp.setAttribute("title",M),wp.setAttribute("aria-label",b)}if(_y){const b=texts[e].autoGearSearchLabel||texts.en?.autoGearSearchLabel||_y.textContent,M=texts[e].autoGearSearchHelp||texts.en?.autoGearSearchHelp||b;if(_y.textContent=b,_y.setAttribute("data-help",M),Pp){const me=texts[e].autoGearSearchPlaceholder||texts.en?.autoGearSearchPlaceholder||Pp.getAttribute("placeholder")||"";Pp.setAttribute("placeholder",me),Pp.setAttribute("aria-label",b),Pp.setAttribute("data-help",M)}}if(Dy){const b=texts[e].autoGearFilterScenarioLabel||texts.en?.autoGearFilterScenarioLabel||Dy.textContent,M=texts[e].autoGearFilterScenarioHelp||texts.en?.autoGearFilterScenarioHelp||b;Dy.textContent=b,Dy.setAttribute("data-help",M),Fl&&(Fl.setAttribute("aria-label",b),Fl.setAttribute("data-help",M))}if(Bp){const b=texts[e].autoGearFilterClear||texts.en?.autoGearFilterClear||Bp.textContent;rt(Bp,b,ICON_GLYPHS.circleX),Bp.setAttribute("data-help",b),Bp.setAttribute("aria-label",b)}if(XJ(vV()),MO&&(MO.textContent=texts[e].autoGearBackupsHeading||texts.en?.autoGearBackupsHeading||MO.textContent),_O){const b=texts[e].autoGearBackupsDescription||texts.en?.autoGearBackupsDescription||"";_O.textContent=b,b&&_O.setAttribute("data-help",b)}if(Xv){const b=texts[e].autoGearShowBackupsLabel||texts.en?.autoGearShowBackupsLabel||Xv.textContent,M=texts[e].autoGearShowBackupsHelp||texts.en?.autoGearShowBackupsHelp||b;Xv.textContent=b,Xv.setAttribute("data-help",M),FO&&(FO.setAttribute("aria-label",b),FO.setAttribute("data-help",M))}if(jO){const b=texts[e].autoGearBackupsHidden||texts.en?.autoGearBackupsHidden||jO.textContent;jO.textContent=b}if(Qv){const b=texts[e].autoGearBackupRetentionLabel||texts.en?.autoGearBackupRetentionLabel||Qv.textContent,M=texts[e].autoGearBackupRetentionHelp||texts.en?.autoGearBackupRetentionHelp||b;Qv.textContent=b,Qv.setAttribute("data-help",M),Zf&&(Zf.setAttribute("aria-label",b),Zf.setAttribute("title",b))}if(qJ&&kr("renderAutoGearBackupRetentionControls",[],{defer:!0}),DO){const b=texts[e].autoGearBackupSelectLabel||texts.en?.autoGearBackupSelectLabel||DO.textContent;DO.textContent=b,Yv&&(Yv.setAttribute("aria-label",b),Yv.setAttribute("title",b))}if(uy){const b=texts[e].autoGearBackupRestore||texts.en?.autoGearBackupRestore||uy.textContent;rt(uy,b,ICON_GLYPHS.fileImport),uy.setAttribute("aria-label",b),uy.setAttribute("title",b)}if(NO){const b=texts[e].autoGearBackupEmpty||texts.en?.autoGearBackupEmpty||NO.textContent;NO.textContent=b}if(Yv&&kr("renderAutoGearBackupControls",[],{defer:!0}),WS){const b=texts[e].autoGearRuleNameLabel||texts.en?.autoGearRuleNameLabel||WS.textContent;WS.textContent=b;const M=texts[e].autoGearRuleNameHelp||texts.en?.autoGearRuleNameHelp||b;WS.setAttribute("data-help",M),LT&&(LT.setAttribute("data-help",M),LT.setAttribute("aria-label",b))}if(Fy){const b=texts[e].autoGearConditionSelectLabel||texts.en?.autoGearConditionSelectLabel||Fy.textContent||"Add a condition",M=texts[e].autoGearConditionSelectHelp||texts.en?.autoGearConditionSelectHelp||b;Fy.textContent=b,Fy.setAttribute("data-help",M),Ra&&(Ra.setAttribute("aria-label",b),Ra.setAttribute("data-help",M))}if(vu){const b=texts[e].autoGearAddCondition||texts.en?.autoGearAddCondition||vu.textContent||"Add condition";rt(vu,b,ICON_GLYPHS.add),vu.setAttribute("aria-label",b),vu.setAttribute("data-help",b)}if(jy){const b=texts[e].autoGearAlwaysLabel||texts.en?.autoGearAlwaysLabel||jy.textContent||"Always include",M=texts[e].autoGearAlwaysHelp||texts.en?.autoGearAlwaysHelp||b;jy.textContent=b,jy.setAttribute("data-help",M),iA&&(iA.textContent=M,iA.setAttribute("data-help",M))}if(configureAutoGearConditionButtons(),hq(),bq(),YS){const b=texts[e].autoGearScenariosLabel||texts.en?.autoGearScenariosLabel||YS.textContent;YS.textContent=b;const M=texts[e].autoGearScenariosHelp||texts.en?.autoGearScenariosHelp||b;if(YS.setAttribute("data-help",M),Hy&&(Hy.setAttribute("data-help",M),Hy.setAttribute("aria-label",b)),QS){const me=texts[e].autoGearScenarioModeLabel||texts.en?.autoGearScenarioModeLabel||QS.textContent||"Scenario matching",ze=texts[e].autoGearScenarioModeHelp||texts.en?.autoGearScenarioModeHelp||me;QS.textContent=me,QS.setAttribute("data-help",ze),md&&(md.setAttribute("data-help",ze),md.setAttribute("aria-label",me))}if(XS){const me=texts[e].autoGearScenarioBaseLabel||texts.en?.autoGearScenarioBaseLabel||XS.textContent||"Base scenario",ze=texts[e].autoGearScenarioBaseHelp||texts.en?.autoGearScenarioBaseHelp||me;XS.textContent=me,XS.setAttribute("data-help",ze),RT&&(RT.setAttribute("data-help",ze),RT.setAttribute("aria-label",me))}if(JS){const me=texts[e].autoGearScenarioFactorLabel||texts.en?.autoGearScenarioFactorLabel||JS.textContent||"Multiplier factor",ze=texts[e].autoGearScenarioFactorHelp||texts.en?.autoGearScenarioFactorHelp||me;JS.textContent=me,JS.setAttribute("data-help",ze),TT&&(TT.setAttribute("data-help",ze),TT.setAttribute("aria-label",me))}}if(ZS){const b=texts[e].autoGearShootingDaysLabel||texts.en?.autoGearShootingDaysLabel||ZS.textContent||"Shooting days condition",M=texts[e].autoGearShootingDaysHelp||texts.en?.autoGearShootingDaysHelp||b,me=texts[e].autoGearShootingDaysModeMinimum||texts.en?.autoGearShootingDaysModeMinimum||"Minimum",ze=texts[e].autoGearShootingDaysModeMaximum||texts.en?.autoGearShootingDaysModeMaximum||"Maximum",Lt=texts[e].autoGearShootingDaysModeEvery||texts.en?.autoGearShootingDaysModeEvery||"Every",ft=texts[e].autoGearShootingDaysValueLabel||texts.en?.autoGearShootingDaysValueLabel||"Shooting days value";ZS.textContent=b,ZS.setAttribute("data-help",M),qf&&(qf.setAttribute("data-help",M),qf.setAttribute("aria-label",b),Array.from(qf.options||[]).forEach(sr=>{!sr||typeof sr.value!="string"||(sr.value==="minimum"?sr.textContent=me:sr.value==="maximum"?sr.textContent=ze:sr.value==="every"&&(sr.textContent=Lt))})),xT&&(xT.textContent=ft,xT.setAttribute("data-help",M)),Kf&&(Kf.setAttribute("data-help",M),Kf.setAttribute("aria-label",ft)),OT&&(OT.textContent=M,OT.setAttribute("data-help",M))}if(ev){const b=texts[e].autoGearMatteboxLabel||texts.en?.autoGearMatteboxLabel||ev.textContent;ev.textContent=b;const M=texts[e].autoGearMatteboxHelp||texts.en?.autoGearMatteboxHelp||b;ev.setAttribute("data-help",M),Uy&&(Uy.setAttribute("data-help",M),Uy.setAttribute("aria-label",b))}if(tv){const b=texts[e].autoGearCameraHandleLabel||texts.en?.autoGearCameraHandleLabel||tv.textContent;tv.textContent=b;const M=texts[e].autoGearCameraHandleHelp||texts.en?.autoGearCameraHandleHelp||b;tv.setAttribute("data-help",M),zy&&(zy.setAttribute("data-help",M),zy.setAttribute("aria-label",b))}if(rv){const b=texts[e].autoGearViewfinderExtensionLabel||texts.en?.autoGearViewfinderExtensionLabel||rv.textContent;rv.textContent=b;const M=texts[e].autoGearViewfinderExtensionHelp||texts.en?.autoGearViewfinderExtensionHelp||b;rv.setAttribute("data-help",M),$y&&($y.setAttribute("data-help",M),$y.setAttribute("aria-label",b))}if(ov){const b=texts[e].autoGearDeliveryResolutionLabel||texts.en?.autoGearDeliveryResolutionLabel||ov.textContent;ov.textContent=b;const M=texts[e].autoGearDeliveryResolutionHelp||texts.en?.autoGearDeliveryResolutionHelp||b;ov.setAttribute("data-help",M),nv&&(nv.setAttribute("data-help",M),nv.setAttribute("aria-label",b))}if(av){const b=texts[e].autoGearVideoDistributionLabel||texts.en?.autoGearVideoDistributionLabel||av.textContent;av.textContent=b;const M=texts[e].autoGearVideoDistributionHelp||texts.en?.autoGearVideoDistributionHelp||b;av.setAttribute("data-help",M),Vy&&(Vy.setAttribute("data-help",M),Vy.setAttribute("aria-label",b))}if(iv){const b=texts[e].autoGearCameraLabel||texts.en?.autoGearCameraLabel||iv.textContent;iv.textContent=b;const M=texts[e].autoGearCameraHelp||texts.en?.autoGearCameraHelp||b;iv.setAttribute("data-help",M),sA&&(sA.setAttribute("data-help",M),sA.setAttribute("aria-label",b))}if(sv){const b=texts[e].autoGearConditionOwnGearLabel||texts[e].autoGearOwnGearLabel||texts.en?.autoGearConditionOwnGearLabel||texts.en?.autoGearOwnGearLabel||sv.textContent,M=texts[e].autoGearConditionOwnGearHelp||texts.en?.autoGearConditionOwnGearHelp||texts[e].autoGearOwnGearHelp||texts.en?.autoGearOwnGearHelp||b;sv.textContent=b,sv.setAttribute("data-help",M),lA&&(lA.setAttribute("data-help",M),lA.setAttribute("aria-label",b))}if(lv){const b=texts[e].autoGearCameraWeightLabel||texts.en?.autoGearCameraWeightLabel||lv.textContent||"Camera weight",M=texts[e].autoGearCameraWeightHelp||texts.en?.autoGearCameraWeightHelp||b;lv.textContent=b,lv.setAttribute("data-help",M)}if(cv){const b=texts[e].autoGearCameraWeightOperatorLabel||texts.en?.autoGearCameraWeightOperatorLabel||cv.textContent||"Weight comparison";if(cv.textContent=b,cv.setAttribute("data-help",b),Wf){Wf.setAttribute("data-help",b),Wf.setAttribute("aria-label",b);const M=texts[e].autoGearCameraWeightOperatorGreater||texts.en?.autoGearCameraWeightOperatorGreater||"Heavier than",me=texts[e].autoGearCameraWeightOperatorLess||texts.en?.autoGearCameraWeightOperatorLess||"Lighter than",ze=texts[e].autoGearCameraWeightOperatorEqual||texts.en?.autoGearCameraWeightOperatorEqual||"Exactly";Array.from(Wf.options||[]).forEach(Lt=>{Lt&&(Lt.value==="greater"?Lt.textContent=M:Lt.value==="less"?Lt.textContent=me:Lt.value==="equal"&&(Lt.textContent=ze))})}}if(uv){const b=texts[e].autoGearCameraWeightValueLabel||texts.en?.autoGearCameraWeightValueLabel||uv.textContent||"Weight threshold (grams)",M=texts[e].autoGearCameraWeightHelp||texts.en?.autoGearCameraWeightHelp||b;uv.textContent=b,uv.setAttribute("data-help",M),Yf&&(Yf.setAttribute("data-help",M),Yf.setAttribute("aria-label",b))}if(fv){const b=texts[e].autoGearCameraWeightHelp||texts.en?.autoGearCameraWeightHelp||fv.textContent||"";fv.textContent=b,b&&fv.setAttribute("data-help",b)}if(dv){const b=texts[e].autoGearMonitorLabel||texts.en?.autoGearMonitorLabel||dv.textContent;dv.textContent=b;const M=texts[e].autoGearMonitorHelp||texts.en?.autoGearMonitorHelp||b;dv.setAttribute("data-help",M),cA&&(cA.setAttribute("data-help",M),cA.setAttribute("aria-label",b))}if(pv){const b=texts[e].autoGearTripodHeadBrandLabel||texts.en?.autoGearTripodHeadBrandLabel||pv.textContent;pv.textContent=b;const M=texts[e].autoGearTripodHeadBrandHelp||texts.en?.autoGearTripodHeadBrandHelp||b;pv.setAttribute("data-help",M),kT&&(kT.setAttribute("data-help",M),kT.setAttribute("aria-label",b))}if(mv){const b=texts[e].autoGearTripodBowlLabel||texts.en?.autoGearTripodBowlLabel||mv.textContent;mv.textContent=b;const M=texts[e].autoGearTripodBowlHelp||texts.en?.autoGearTripodBowlHelp||b;mv.setAttribute("data-help",M),IT&&(IT.setAttribute("data-help",M),IT.setAttribute("aria-label",b))}if(gv){const b=texts[e].autoGearTripodTypesLabel||texts.en?.autoGearTripodTypesLabel||gv.textContent;gv.textContent=b;const M=texts[e].autoGearTripodTypesHelp||texts.en?.autoGearTripodTypesHelp||b;gv.setAttribute("data-help",M),PT&&(PT.setAttribute("data-help",M),PT.setAttribute("aria-label",b))}if(yv){const b=texts[e].autoGearTripodSpreaderLabel||texts.en?.autoGearTripodSpreaderLabel||yv.textContent;yv.textContent=b;const M=texts[e].autoGearTripodSpreaderHelp||texts.en?.autoGearTripodSpreaderHelp||b;yv.setAttribute("data-help",M),BT&&(BT.setAttribute("data-help",M),BT.setAttribute("aria-label",b))}if(hv){const b=texts[e].autoGearCrewPresentLabel||texts.en?.autoGearCrewPresentLabel||hv.textContent;hv.textContent=b;const M=texts[e].autoGearCrewPresentHelp||texts.en?.autoGearCrewPresentHelp||b;hv.setAttribute("data-help",M),uA&&(uA.setAttribute("data-help",M),uA.setAttribute("aria-label",b))}if(bv){const b=texts[e].autoGearCrewAbsentLabel||texts.en?.autoGearCrewAbsentLabel||bv.textContent;bv.textContent=b;const M=texts[e].autoGearCrewAbsentHelp||texts.en?.autoGearCrewAbsentHelp||b;bv.setAttribute("data-help",M),fA&&(fA.setAttribute("data-help",M),fA.setAttribute("aria-label",b))}if(Sv){const b=texts[e].autoGearWirelessLabel||texts.en?.autoGearWirelessLabel||Sv.textContent;Sv.textContent=b;const M=texts[e].autoGearWirelessHelp||texts.en?.autoGearWirelessHelp||b;Sv.setAttribute("data-help",M),dA&&(dA.setAttribute("data-help",M),dA.setAttribute("aria-label",b))}if(vv){const b=texts[e].autoGearMotorsLabel||texts.en?.autoGearMotorsLabel||vv.textContent;vv.textContent=b;const M=texts[e].autoGearMotorsHelp||texts.en?.autoGearMotorsHelp||b;vv.setAttribute("data-help",M),pA&&(pA.setAttribute("data-help",M),pA.setAttribute("aria-label",b))}if(Ev){const b=texts[e].autoGearControllersLabel||texts.en?.autoGearControllersLabel||Ev.textContent;Ev.textContent=b;const M=texts[e].autoGearControllersHelp||texts.en?.autoGearControllersHelp||b;Ev.setAttribute("data-help",M),mA&&(mA.setAttribute("data-help",M),mA.setAttribute("aria-label",b))}if(Av){const b=texts[e].autoGearDistanceLabel||texts.en?.autoGearDistanceLabel||Av.textContent;Av.textContent=b;const M=texts[e].autoGearDistanceHelp||texts.en?.autoGearDistanceHelp||b;Av.setAttribute("data-help",M),gA&&(gA.setAttribute("data-help",M),gA.setAttribute("aria-label",b))}const na=texts[e].autoGearConditionLogicLabel||texts.en?.autoGearConditionLogicLabel||"Match behavior",vo=texts[e].autoGearConditionLogicHelp||texts.en?.autoGearConditionLogicHelp||na,tt={all:texts[e]?.autoGearConditionLogicAll||texts.en?.autoGearConditionLogicAll||"Require every selected value",any:texts[e]?.autoGearConditionLogicAny||texts.en?.autoGearConditionLogicAny||"Match any selected value",none:texts[e]?.autoGearConditionLogicNone||texts.en?.autoGearConditionLogicNone||"Require none of the selected values",multiplier:texts[e]?.autoGearConditionLogicMultiplier||texts.en?.autoGearConditionLogicMultiplier||"Multiply by matched values"};if(Object.entries(yG).forEach(([b,M])=>{const me=IV[b];me&&(me.textContent=na,me.setAttribute("data-help",vo)),M&&(M.setAttribute("aria-label",na),M.setAttribute("data-help",vo),M.setAttribute("title",vo),Array.from(M.options||[]).forEach(ze=>{if(!ze)return;const Lt=tt[ze.value];Lt&&(ze.textContent=Lt)}))}),LO&&(LO.textContent=texts[e].autoGearAddItemsHeading||texts.en?.autoGearAddItemsHeading||LO.textContent),zv){const b=texts[e].autoGearOwnGearLabel||texts.en?.autoGearOwnGearLabel||zv.textContent,M=texts[e].autoGearOwnGearHelp||texts.en?.autoGearOwnGearHelp||b,me=texts[e].autoGearOwnGearPlaceholder||texts.en?.autoGearOwnGearPlaceholder||"";zv.textContent=b,zv.setAttribute("data-help",M),ay&&(ay.setAttribute("aria-label",b),ay.setAttribute("data-help",M),me?ay.setAttribute("data-placeholder",me):ay.removeAttribute("data-placeholder"))}if($v){const b=texts[e].autoGearAddItemLabel||texts.en?.autoGearAddItemLabel||$v.textContent,M=texts[e].autoGearAddMultipleHint||texts.en?.autoGearAddMultipleHint||"",me=M?`${b}  ${M}`:b;$v.textContent=b,$v.setAttribute("data-help",me),iy&&(iy.setAttribute("aria-label",b),iy.setAttribute("data-help",me),M?iy.setAttribute("placeholder",M):iy.removeAttribute("placeholder"))}if(RO){const b=texts[e].autoGearAddCategoryLabel||texts.en?.autoGearAddCategoryLabel||RO.textContent;RO.textContent=b,_p&&_p.setAttribute("aria-label",b)}if(TO){const b=texts[e].autoGearAddQuantityLabel||texts.en?.autoGearAddQuantityLabel||TO.textContent;TO.textContent=b,wF&&wF.setAttribute("aria-label",b)}if(SA){const b=texts[e].autoGearAddScreenSizeLabel||texts.en?.autoGearAddScreenSizeLabel||SA.textContent;SA.textContent=b,zC&&zC.setAttribute("aria-label",b)}if(vA){const b=texts[e].autoGearAddSelectorTypeLabel||texts.en?.autoGearAddSelectorTypeLabel||vA.textContent;if(vA.textContent=b,Rm){Rm.setAttribute("aria-label",b);const M=texts[e].autoGearSelectorNoneOption||texts.en?.autoGearSelectorNoneOption||"No selector",me=texts[e].autoGearSelectorMonitorOption||texts.en?.autoGearSelectorMonitorOption||"Monitor selector",ze=texts[e].autoGearSelectorDirectorOption||texts.en?.autoGearSelectorDirectorOption||"Director monitor selector",Lt=texts[e].autoGearSelectorTripodHeadOption||texts.en?.autoGearSelectorTripodHeadOption||"Tripod head selector",ft=texts[e].autoGearSelectorTripodBowlOption||texts.en?.autoGearSelectorTripodBowlOption||"Tripod bowl selector",sr=texts[e].autoGearSelectorTripodTypesOption||texts.en?.autoGearSelectorTripodTypesOption||"Tripod type selector",pr=texts[e].autoGearSelectorTripodSpreaderOption||texts.en?.autoGearSelectorTripodSpreaderOption||"Tripod spreader selector",Xe=new Map([["none",M],["monitor",me],["directorMonitor",ze],["tripodHeadBrand",Lt],["tripodBowl",ft],["tripodTypes",sr],["tripodSpreader",pr]]);Array.from(Rm.options||[]).forEach(Yn=>{const cn=Xe.get(Yn.value);cn&&(Yn.textContent=cn)})}}if(EA){const b=texts[e].autoGearAddSelectorDefaultLabel||texts.en?.autoGearAddSelectorDefaultLabel||EA.textContent;EA.textContent=b,gb&&gb.setAttribute("aria-label",b)}if(OO){const b=texts[e].autoGearAddNotesLabel||texts.en?.autoGearAddNotesLabel||OO.textContent;OO.textContent=b,LF&&LF.setAttribute("aria-label",b)}if(Sq&&typeof VS=="function"&&VS("add"),xO&&(xO.textContent=texts[e].autoGearRemoveItemsHeading||texts.en?.autoGearRemoveItemsHeading||xO.textContent),Vv){const b=texts[e].autoGearOwnGearLabel||texts.en?.autoGearOwnGearLabel||Vv.textContent,M=texts[e].autoGearOwnGearHelp||texts.en?.autoGearOwnGearHelp||b,me=texts[e].autoGearOwnGearPlaceholder||texts.en?.autoGearOwnGearPlaceholder||"";Vv.textContent=b,Vv.setAttribute("data-help",M),sy&&(sy.setAttribute("aria-label",b),sy.setAttribute("data-help",M),me?sy.setAttribute("data-placeholder",me):sy.removeAttribute("data-placeholder"))}if(qv){const b=texts[e].autoGearRemoveItemLabel||texts.en?.autoGearRemoveItemLabel||qv.textContent,M=texts[e].autoGearRemoveMultipleHint||texts.en?.autoGearRemoveMultipleHint||"",me=M?`${b}  ${M}`:b;qv.textContent=b,qv.setAttribute("data-help",me),ly&&(ly.setAttribute("aria-label",b),ly.setAttribute("data-help",me),M?ly.setAttribute("placeholder",M):ly.removeAttribute("placeholder"))}if(kO){const b=texts[e].autoGearRemoveCategoryLabel||texts.en?.autoGearRemoveCategoryLabel||kO.textContent;kO.textContent=b,Dp&&Dp.setAttribute("aria-label",b)}if(IO){const b=texts[e].autoGearRemoveQuantityLabel||texts.en?.autoGearRemoveQuantityLabel||IO.textContent;IO.textContent=b,RF&&RF.setAttribute("aria-label",b)}if(AA){const b=texts[e].autoGearRemoveScreenSizeLabel||texts.en?.autoGearRemoveScreenSizeLabel||AA.textContent;AA.textContent=b,$C&&$C.setAttribute("aria-label",b)}if(CA){const b=texts[e].autoGearRemoveSelectorTypeLabel||texts.en?.autoGearRemoveSelectorTypeLabel||CA.textContent;if(CA.textContent=b,Tm){Tm.setAttribute("aria-label",b);const M=texts[e].autoGearSelectorNoneOption||texts.en?.autoGearSelectorNoneOption||"No selector",me=texts[e].autoGearSelectorMonitorOption||texts.en?.autoGearSelectorMonitorOption||"Monitor selector",ze=texts[e].autoGearSelectorDirectorOption||texts.en?.autoGearSelectorDirectorOption||"Director monitor selector",Lt=texts[e].autoGearSelectorTripodHeadOption||texts.en?.autoGearSelectorTripodHeadOption||"Tripod head selector",ft=texts[e].autoGearSelectorTripodBowlOption||texts.en?.autoGearSelectorTripodBowlOption||"Tripod bowl selector",sr=texts[e].autoGearSelectorTripodTypesOption||texts.en?.autoGearSelectorTripodTypesOption||"Tripod type selector",pr=texts[e].autoGearSelectorTripodSpreaderOption||texts.en?.autoGearSelectorTripodSpreaderOption||"Tripod spreader selector",Xe=new Map([["none",M],["monitor",me],["directorMonitor",ze],["tripodHeadBrand",Lt],["tripodBowl",ft],["tripodTypes",sr],["tripodSpreader",pr]]);Array.from(Tm.options||[]).forEach(Yn=>{const cn=Xe.get(Yn.value);cn&&(Yn.textContent=cn)})}}if(wA){const b=texts[e].autoGearRemoveSelectorDefaultLabel||texts.en?.autoGearRemoveSelectorDefaultLabel||wA.textContent;wA.textContent=b,yb&&yb.setAttribute("aria-label",b)}if(PO){const b=texts[e].autoGearRemoveNotesLabel||texts.en?.autoGearRemoveNotesLabel||PO.textContent;PO.textContent=b,TF&&TF.setAttribute("aria-label",b)}if(updateAutoGearOwnGearOptions(),cy){const b=texts[e].autoGearDraftImpactHeading||texts.en?.autoGearDraftImpactHeading||cy.textContent;cy.textContent=b}if(BO){const b=texts[e].autoGearDraftImpactDescription||texts.en?.autoGearDraftImpactDescription||BO.textContent;BO.textContent=b,cy&&cy.setAttribute("data-help",b),OF&&OF.setAttribute("data-help",b)}if(GO){const b=texts[e].autoGearDraftWarningHeading||texts.en?.autoGearDraftWarningHeading||GO.textContent;GO.textContent=b}if(vq&&typeof VS=="function"&&VS("remove"),Kv){const b=texts[e].autoGearSaveRule||texts.en?.autoGearSaveRule||Kv.textContent;rt(Kv,b),Kv.setAttribute("data-help",b)}if(Wv){const b=texts[e].autoGearCancelEdit||texts.en?.autoGearCancelEdit||Wv.textContent;rt(Wv,b,ICON_GLYPHS.circleX),Wv.setAttribute("data-help",b)}_p&&populateAutoGearCategorySelect(_p,_p.value),Dp&&populateAutoGearCategorySelect(Dp,Dp.value),Eq(),Hy&&IJ(sp?.scenarios),Uy&&PJ(sp?.mattebox),zy&&BJ(sp?.cameraHandle),$y&&GJ(sp?.viewfinderExtension),nv&&MJ(sp?.deliveryResolution),Vy&&_J(sp?.videoDistribution),kr("seedAutoGearRulesFromCurrentProject",[],{defer:!0}),kr("renderAutoGearRulesList",[],{defer:!0}),kr("renderAutoGearDraftLists",[],{defer:!0}),kr("updateAutoGearCatalogOptions",[],{defer:!0}),kr("renderAutoGearPresetsControls",[],{defer:!0}),kr("applyAutoGearBackupVisibility",[],{defer:!0});const so=document.getElementById("settingsHighContrastLabel");if(so){so.textContent=texts[e].highContrastSetting;const b=texts[e].highContrastSettingHelp||texts[e].highContrastSetting;so.setAttribute("data-help",b),settingsHighContrast&&(settingsHighContrast.setAttribute("data-help",b),settingsHighContrast.setAttribute("aria-label",texts[e].highContrastSetting))}const oa=document.getElementById("accessibilityHeading");oa&&(oa.textContent=texts[e].accessibilityHeading,oa.setAttribute("data-help",texts[e].accessibilityHeadingHelp||texts[e].accessibilityHeading));const ya=document.getElementById("backupHeading");ya&&(ya.textContent=texts[e].backupHeading,ya.setAttribute("data-help",texts[e].backupHeadingHelp||texts[e].backupHeading));const _s=typeof document<"u"?document.getElementById("projectBackupsHeading"):null;if(_s){const b=texts[e].projectBackupsHeading||"Project Backups";_s.textContent=b;const M=texts[e].projectBackupsDescription||"";M?_s.setAttribute("data-help",M):_s.removeAttribute("data-help")}const ss=typeof document<"u"?document.getElementById("projectBackupsDescription"):null;if(ss){const b=texts[e].projectBackupsDescription||"";b?(ss.textContent=b,ss.hidden=!1):(ss.textContent="",ss.hidden=!0)}if(HO){HO.textContent=texts[e].dataHeading;const b=texts[e].dataHeadingHelp||texts[e].dataHeading;HO.setAttribute("data-help",b)}if(xF&&(xF.textContent=texts[e].storageSummaryIntro),IF&&(IF.textContent=texts[e].storageSummaryFootnote),kF&&(kF.textContent=texts[e].storageSummaryEmpty),Jv){const b=texts[e].storagePersistenceHeading||texts.en?.storagePersistenceHeading||Jv.textContent;Jv.textContent=b;const M=texts[e].storagePersistenceHeadingHelp||texts.en?.storagePersistenceHeadingHelp||b;Jv.setAttribute("data-help",M)}if(UO&&(UO.textContent=texts[e].storagePersistenceIntro||texts.en?.storagePersistenceIntro||UO.textContent),hf){const b=texts[e].storagePersistenceRequest||texts.en?.storagePersistenceRequest||hf.textContent;rt(hf,b,ICON_GLYPHS.save),hf.dataset.defaultLabel=b;const M=texts[e].storagePersistenceRequestHelp||texts.en?.storagePersistenceRequestHelp||b;hf.setAttribute("data-help",M),hf.setAttribute("title",M),hf.setAttribute("aria-label",M)}if(Zv){const b=texts[e].storagePersistenceStatusIdle||texts.en?.storagePersistenceStatusIdle||Zv.textContent;Zv.textContent=b,Zv.setAttribute("data-help",b)}if(kr("renderStoragePersistenceStatus",[],{defer:!0}),eE){const b=texts[e].storageActionsHeading||texts.en?.storageActionsHeading||eE.textContent;eE.textContent=b;const M=texts[e].storageActionsHeadingHelp||texts.en?.storageActionsHeadingHelp||b;eE.setAttribute("data-help",M)}if(zO&&(zO.textContent=texts[e].storageActionsIntro||texts.en?.storageActionsIntro||zO.textContent),fy){const b=texts[e].storageBackupNow||texts.en?.storageBackupNow||fy.textContent;rt(fy,b,ICON_GLYPHS.fileExport);const M=texts[e].storageBackupNowHelp||texts.en?.storageBackupNowHelp||b;fy.setAttribute("data-help",M),fy.setAttribute("title",M)}if(Df){const b=texts[e].storageOpenBackupTab||texts.en?.storageOpenBackupTab||Df.textContent;rt(Df,b,ICON_GLYPHS.settingsBackup);const M=texts[e].storageOpenBackupTabHelp||texts.en?.storageOpenBackupTabHelp||b;Df.setAttribute("data-help",M),Df.setAttribute("title",M)}if(tE){const b=texts[e].storageStatusHeading||texts.en?.storageStatusHeading||tE.textContent;tE.textContent=b;const M=texts[e].storageStatusHeadingHelp||texts.en?.storageStatusHeadingHelp||b;tE.setAttribute("data-help",M)}$O&&($O.textContent=texts[e].storageStatusLastProjectLabel||texts.en?.storageStatusLastProjectLabel||$O.textContent),VO&&(VO.textContent=texts[e].storageStatusLastAutoBackupLabel||texts.en?.storageStatusLastAutoBackupLabel||VO.textContent),qO&&(qO.textContent=texts[e].storageStatusLastFullBackupLabel||texts.en?.storageStatusLastFullBackupLabel||qO.textContent);const Kn=texts[e].storageStatusNever||texts.en?.storageStatusNever||(rE?rE.textContent:"");if(rE&&(rE.textContent=Kn),PF&&(PF.textContent=Kn),BF&&(BF.textContent=Kn),dy&&(dy.textContent="",dy.setAttribute("hidden",""),dy.classList.remove("storage-status-reminder--warning","storage-status-reminder--ok"),dy.removeAttribute("data-help")),KO){const b=texts[e].loggingSectionHelp||texts[e].loggingHeadingHelp||texts.en?.loggingHeadingHelp||"";b?KO.setAttribute("data-help",b):KO.removeAttribute("data-help")}if(nE){const b=texts[e].loggingHeading||texts.en?.loggingHeading||nE.textContent||"Diagnostics log";nE.textContent=b;const M=texts[e].loggingHeadingHelp||texts.en?.loggingHeadingHelp||b;nE.setAttribute("data-help",M)}if(WO&&(WO.textContent=texts[e].loggingIntro||texts.en?.loggingIntro||WO.textContent),oE){const b=texts[e].loggingLevelFilterLabel||texts.en?.loggingLevelFilterLabel||oE.textContent;oE.textContent=b,oE.setAttribute("data-help",b)}if(aE){const b={all:texts[e].loggingLevelFilterAll||texts.en?.loggingLevelFilterAll||"All levels",info:texts[e].loggingLevelFilterInfo||texts.en?.loggingLevelFilterInfo||"Info and above",warn:texts[e].loggingLevelFilterWarn||texts.en?.loggingLevelFilterWarn||"Warnings and errors",error:texts[e].loggingLevelFilterError||texts.en?.loggingLevelFilterError||"Errors only"};Array.from(aE.options||[]).forEach(me=>{if(!me||typeof me.value!="string")return;const ze=me.value;Object.prototype.hasOwnProperty.call(b,ze)&&(me.textContent=b[ze])});const M=texts[e].loggingLevelFilterHelp||texts.en?.loggingLevelFilterHelp||"";M?aE.setAttribute("data-help",M):aE.removeAttribute("data-help")}if(py){const b=texts[e].loggingNamespaceFilterLabel||texts.en?.loggingNamespaceFilterLabel||py.textContent;py.textContent=b}if(YO){const b=texts[e].loggingNamespaceFilterPlaceholder||texts.en?.loggingNamespaceFilterPlaceholder||"";b&&YO.setAttribute("placeholder",b);const M=texts[e].loggingNamespaceFilterHelp||texts.en?.loggingNamespaceFilterHelp||b;M&&(YO.setAttribute("data-help",M),py&&py.setAttribute("data-help",M)),iE&&(iE.textContent=M,M?iE.removeAttribute("hidden"):iE.setAttribute("hidden",""))}if(QO){const b=texts[e].loggingHistoryLimitLabel||texts.en?.loggingHistoryLimitLabel||QO.textContent;QO.textContent=b}if(XO){const b=texts[e].loggingHistoryLimitHelp||texts.en?.loggingHistoryLimitHelp||XO.textContent;XO.textContent=b}if(sE){const b=texts[e].loggingHistoryLimitHelp||texts.en?.loggingHistoryLimitHelp||"";b?sE.setAttribute("data-help",b):sE.removeAttribute("data-help");const M=texts[e].loggingHistoryLimitAria||texts.en?.loggingHistoryLimitAria||"";M&&sE.setAttribute("aria-label",M)}if(JO){const b=texts[e].loggingConsoleOutputLabel||texts.en?.loggingConsoleOutputLabel||JO.textContent;JO.textContent=b}if(ZO){const b=texts[e].loggingConsoleOutputHelp||texts.en?.loggingConsoleOutputHelp||ZO.textContent;ZO.textContent=b}if(ex){const b=texts[e].loggingCaptureConsoleLabel||texts.en?.loggingCaptureConsoleLabel||ex.textContent;ex.textContent=b}if(tx){const b=texts[e].loggingCaptureConsoleHelp||texts.en?.loggingCaptureConsoleHelp||tx.textContent;tx.textContent=b}if(rx){const b=texts[e].loggingCaptureErrorsLabel||texts.en?.loggingCaptureErrorsLabel||rx.textContent;rx.textContent=b}if(nx){const b=texts[e].loggingCaptureErrorsHelp||texts.en?.loggingCaptureErrorsHelp||nx.textContent;nx.textContent=b}if(ox){const b=texts[e].loggingPersistSessionLabel||texts.en?.loggingPersistSessionLabel||ox.textContent;ox.textContent=b}if(ax){const b=texts[e].loggingPersistSessionHelp||texts.en?.loggingPersistSessionHelp||ax.textContent;ax.textContent=b}if(Lp){const b=texts[e].loggingExportButton||texts.en?.loggingExportButton||Lp.textContent;rt(Lp,b,ICON_GLYPHS.fileExport),Lp.setAttribute("data-help",b),Lp.setAttribute("title",b),Lp.setAttribute("aria-label",b)}if(lE){const b=texts[e].loggingExportHelp||texts.en?.loggingExportHelp||lE.textContent;lE.textContent=b,lE.setAttribute("data-help",b)}if(ix){const b=texts[e].loggingStatusIdle||texts.en?.loggingStatusIdle||"";ix.textContent=b,b&&ix.setAttribute("data-help",b)}if(cE){const b=texts[e].loggingEmptyState||texts.en?.loggingEmptyState||cE.textContent;cE.textContent=b,b&&cE.setAttribute("data-help",b)}sx&&(sx.textContent=texts[e].loggingUnavailable||texts.en?.loggingUnavailable||sx.textContent);const lo=document.getElementById("settingsShowAutoBackupsLabel");if(lo){lo.textContent=texts[e].showAutoBackupsSetting;const b=texts[e].showAutoBackupsHelp||texts[e].showAutoBackupsSetting;lo.setAttribute("data-help",b),C&&(C.setAttribute("data-help",b),C.setAttribute("aria-label",texts[e].showAutoBackupsSetting))}if(_){const b=texts[e].versionCompareButton||"Compare versions";rt(_,b,ICON_GLYPHS.note);const M=texts[e].versionCompareButtonHelp||b;_.setAttribute("data-help",M),_.setAttribute("title",M)}if(w&&(w.textContent=texts[e].versionCompareHeading||"Version comparison"),x&&(x.textContent=texts[e].versionCompareIntro||""),G){const b=texts[e].versionComparePrimaryLabel||"Baseline version";G.textContent=b,T&&T.setAttribute("aria-label",b)}if(P){const b=texts[e].versionCompareSecondaryLabel||"Comparison version";P.textContent=b,N&&N.setAttribute("aria-label",b)}if(q&&(q.textContent=texts[e].versionCompareEmpty||"Save a project or wait for auto-backups to start comparing versions."),Z&&(Z.textContent=texts[e].versionCompareNotesLabel||"Incident notes"),U){const b=texts[e].versionCompareNotesPlaceholder||"Record context, on-set observations, or required follow-up.";U.placeholder=b}if(K){const b=texts[e].versionCompareExport||"Export log";rt(K,b,ICON_GLYPHS.fileExport);const M=texts[e].versionCompareExportHelp||b;K.setAttribute("data-help",M),K.setAttribute("title",M)}if(H){const b=texts[e].versionCompareClose||texts[e].cancelSettings||"Close";rt(H,b,ICON_GLYPHS.circleX)}if(k){const b=texts[e].backupSettings;rt(k,b,ICON_GLYPHS.fileExport);const M=texts[e].backupSettingsHelp||b;k.setAttribute("data-help",M),k.setAttribute("title",M),k.setAttribute("aria-label",M)}if(restoreSettings){const b=texts[e].restoreSettings;rt(restoreSettings,b,ICON_GLYPHS.fileImport);const M=texts[e].restoreSettingsHelp||b;restoreSettings.setAttribute("data-help",M),restoreSettings.setAttribute("title",M),restoreSettings.setAttribute("aria-label",M)}if(te){const b=texts[e].restoreRehearsalButton||"Restore rehearsal";rt(te,b,ICON_GLYPHS.load);const M=texts[e].restoreRehearsalButtonHelp||b;te.setAttribute("data-help",M),te.setAttribute("title",M),te.setAttribute("aria-label",M)}if(re&&(re.textContent=texts[e].restoreRehearsalHeading||re.textContent),fe&&(fe.textContent=texts[e].restoreRehearsalIntro||fe.textContent),Oe&&(Oe.textContent=texts[e].restoreRehearsalModeLabel||Oe.textContent),Te&&(Te.textContent=texts[e].restoreRehearsalModeBackup||Te.textContent),Ne&&(Ne.textContent=texts[e].restoreRehearsalModeProject||Ne.textContent),Ie&&(Ie.textContent=texts[e].restoreRehearsalFileLabel||Ie.textContent),et){const b=texts[e].restoreRehearsalFileButton||"Choose file";rt(et,b,ICON_GLYPHS.fileImport),et.setAttribute("data-help",b),et.setAttribute("title",b),et.setAttribute("aria-label",b)}Ze&&(Ze.textContent=texts[e].restoreRehearsalNoFile||Ze.textContent),Ft&&(Ft.textContent=texts[e].restoreRehearsalReady||""),Ye&&(Ye.textContent=texts[e].restoreRehearsalRuleHeading||texts.en?.restoreRehearsalRuleHeading||Ye.textContent),ct&&(ct.textContent=texts[e].restoreRehearsalRuleIntro||texts.en?.restoreRehearsalRuleIntro||ct.textContent),Y&&(Y.textContent=texts[e].restoreRehearsalRuleEmpty||texts.en?.restoreRehearsalRuleEmpty||Y.textContent),ee&&(ee.textContent=texts[e].restoreRehearsalTableCaption||ee.textContent),Ae&&(Ae.textContent=texts[e].restoreRehearsalMetricColumn||Ae.textContent),ve&&(ve.textContent=texts[e].restoreRehearsalLiveColumn||ve.textContent),se&&(se.textContent=texts[e].restoreRehearsalSandboxColumn||se.textContent),de&&(de.textContent=texts[e].restoreRehearsalDifferenceColumn||de.textContent);const ha=typeof be<"u"?be:I("restoreRehearsalCloseButton","restoreRehearsalClose");if(ha){const b=texts[e].restoreRehearsalClose||texts[e].cancelSettings||"Close";rt(ha,b,ICON_GLYPHS.circleX),ha.setAttribute("title",b),ha.setAttribute("aria-label",b)}if(ye){const b=texts[e].restoreRehearsalProceed||texts.en?.restoreRehearsalProceed||"Resume restore rehearsal",M=texts[e].restoreRehearsalProceedHelp||texts.en?.restoreRehearsalProceedHelp||b;rt(ye,b,ICON_GLYPHS.check),ye.setAttribute("data-help",M),ye.setAttribute("title",M),ye.setAttribute("aria-label",M)}if($e){const b=texts[e].restoreRehearsalAbort||texts.en?.restoreRehearsalAbort||"Abort rehearsal",M=texts[e].restoreRehearsalAbortHelp||texts.en?.restoreRehearsalAbortHelp||b;rt($e,b,ICON_GLYPHS.circleX),$e.setAttribute("data-help",M),$e.setAttribute("title",M),$e.setAttribute("aria-label",M)}if(factoryResetButton){const b=texts[e].factoryResetButton||"Factory reset",M=texts[e].factoryResetButtonHelp||b;rt(factoryResetButton,b,ICON_GLYPHS.reload),factoryResetButton.setAttribute("data-help",M),factoryResetButton.setAttribute("title",M),factoryResetButton.setAttribute("aria-label",M)}const Wn=document.getElementById("aboutHeading");Wn&&(Wn.textContent=texts[e].aboutHeading,Wn.setAttribute("data-help",texts[e].aboutHeadingHelp||texts[e].aboutHeading));const vn=typeof document<"u"?document.getElementById("aboutVersion"):null;vn&&(vn.textContent=`${texts[e].versionLabel} ${Q6}`);const Pi=[{id:"supportLink",textKey:"supportLink",helpKey:"supportLinkHelp"},{id:"reportBugLink",textKey:"reportBugLink",helpKey:"reportBugLinkHelp"},{id:"suggestFeatureLink",textKey:"suggestFeatureLink",helpKey:"suggestFeatureLinkHelp"}],ba=texts&&texts[e]||{},Bi=texts&&texts.en||{};if(Pi.forEach(b=>{const M=typeof document<"u"?document.getElementById(b.id):null;if(!M)return;const me=typeof ba[b.textKey]=="string"&&ba[b.textKey]||typeof Bi[b.textKey]=="string"&&Bi[b.textKey]||M.textContent;M.textContent=me;const ze=typeof ba[b.helpKey]=="string"&&ba[b.helpKey]||typeof Bi[b.helpKey]=="string"&&Bi[b.helpKey]||me;M.setAttribute("data-help",ze),M.setAttribute("title",ze),M.setAttribute("aria-label",ze)}),settingsSave){const b=texts[e].saveSettings||texts.en?.saveSettings||settingsSave.textContent;rt(settingsSave,b);const M=texts[e].saveSettingsHelp||texts[e].saveSettings||b;settingsSave.setAttribute("data-help",M),settingsSave.setAttribute("title",M),settingsSave.setAttribute("aria-label",M)}if(settingsCancel){const b=texts[e].cancelSettings||texts.en?.cancelSettings||settingsCancel.textContent;rt(settingsCancel,b,ICON_GLYPHS.circleX);const M=texts[e].cancelSettingsHelp||texts[e].cancelSettings||b;settingsCancel.setAttribute("data-help",M),settingsCancel.setAttribute("title",M),settingsCancel.setAttribute("aria-label",M)}const co=document.getElementById("menuToggle");if(co){const b=texts[e].menuToggleLabel||texts.en?.menuToggleLabel||co.getAttribute("aria-label")||"Menu",M=texts[e].sideMenuClose||texts.en?.sideMenuClose||co.dataset.closeLabel||"Close menu",me=texts[e].sideMenuCloseHelp||M;co.setAttribute("title",b),co.setAttribute("aria-label",b);const ze=texts[e].menuToggleHelp||b;co.setAttribute("data-help",ze),co.dataset.menuLabel=b,co.dataset.menuHelp=ze,co.dataset.closeLabel=M,co.dataset.closeHelp=me}const Gi=document.getElementById("sideMenu");if(Gi){const b=texts[e].sideMenuHelp;b?Gi.setAttribute("data-help",b):Gi.removeAttribute("data-help")}const ci=document.getElementById("sideMenuTitle");if(ci){const b=texts[e].sideMenuTitle||texts.en?.sideMenuTitle||ci.textContent;ci.textContent=b;const M=texts[e].sideMenuTitleHelp||texts[e].sideMenuHelp||b;ci.setAttribute("data-help",M)}const Ro=document.getElementById("closeMenuButton"),Dn=document.getElementById("closeMenuLabel");if(Ro){const b=texts[e].sideMenuClose||texts.en?.sideMenuClose||Ro.getAttribute("aria-label")||"Close menu",M=texts[e].sideMenuCloseHelp||b;Ro.setAttribute("aria-label",b),Ro.setAttribute("title",M),Ro.setAttribute("data-help",M),Dn&&(Dn.textContent=b)}if(js){const b=texts[e].reloadAppLabel,M=texts[e].reloadAppHelp||b,me=texts[e].reloadAppOfflineNotice||b;js.setAttribute("title",b),js.setAttribute("aria-label",b),js.setAttribute("data-help",M),js.dataset&&(js.dataset.onlineTitle=b,js.dataset.onlineHelp=M,js.dataset.offlineNotice=me),js.hasAttribute("aria-disabled")&&(js.setAttribute("title",me),js.setAttribute("data-help",me))}if(featureSearch&&(featureSearch.setAttribute("placeholder",texts[e].featureSearchPlaceholder),featureSearch.setAttribute("aria-label",texts[e].featureSearchLabel),featureSearch.setAttribute("data-help",texts[e].featureSearchHelp||texts[e].featureSearchLabel)),su){su.setAttribute("title",texts[e].helpButtonTitle||texts[e].helpButtonLabel),su.setAttribute("aria-label",texts[e].helpButtonLabel),su.setAttribute("data-help",texts[e].helpButtonHelp||texts[e].helpButtonTitle||texts[e].helpButtonLabel);const b=texts[e].helpButtonShortcuts;typeof b=="string"&&b.trim()?su.setAttribute("data-shortcuts",b):su.removeAttribute("data-shortcuts");const M=texts[e].helpButtonAriaShortcuts||"F1 Control+Slash Meta+Slash Shift+Slash KeyH";typeof M=="string"&&M.trim()?su.setAttribute("aria-keyshortcuts",M):su.removeAttribute("aria-keyshortcuts"),Hv&&(rt(Hv,texts[e].hoverHelpButtonLabel,ICON_GLYPHS.note),Hv.setAttribute("aria-label",texts[e].hoverHelpButtonLabel),Hv.setAttribute("data-help",texts[e].hoverHelpButtonHelp||texts[e].hoverHelpButtonLabel)),Fv&&(Fv.setAttribute("placeholder",texts[e].helpSearchPlaceholder),Fv.setAttribute("aria-label",texts[e].helpSearchLabel),Fv.setAttribute("data-help",texts[e].helpSearchHelp||texts[e].helpSearchLabel)),jv&&(jv.setAttribute("title",texts[e].helpSearchClear),jv.setAttribute("aria-label",texts[e].helpSearchClear),jv.setAttribute("data-help",texts[e].helpSearchClearHelp||texts[e].helpSearchClear)),ey&&(rt(ey,texts[e].helpClose,ICON_GLYPHS.circleX),ey.setAttribute("title",texts[e].helpClose),ey.setAttribute("aria-label",texts[e].helpClose),ey.setAttribute("data-help",texts[e].helpCloseHelp||texts[e].helpClose)),document.getElementById("helpTitle")&&(document.getElementById("helpTitle").textContent=texts[e].helpTitle),dF&&y(dF,"helpNoResults","No help topics match your search. Try shorter keywords, synonyms or clear the field to browse everything."),pF&&y(pF,"helpNoResultsSuggestionsHeading","Need a different result?"),mF&&y(mF,"helpNoResultsSuggestionsIntro","Try these steps to get back on track while keeping your data safe:");const me=l&&l.querySelector?l.querySelector("#helpQuickStartGuide h4"):null;if(me){const pr=me.textContent||"Quick start checklist";y(me,"helpQuickStartChecklistTitle",pr)}const ze=l?l.getElementById("helpOnboardingTutorialCopy"):null;if(ze){const pr=ze.textContent||"to walk through every workflow before configuring your first project.";y(ze,"helpOnboardingTutorialCopy",pr)}const Lt=l&&l.querySelector?l.querySelector("#helpDataSafety h4"):null;if(Lt){const pr=Lt.textContent||"Protect your work";y(Lt,"helpDataSafetyTitle",pr)}const ft=l?l.getElementById("helpRestoreDrillHeading"):null;if(ft){const pr=ft.textContent||"Restore rehearsal drill";y(ft,"helpRestoreDrillTitle",pr)}const sr=l?l.getElementById("helpRestoreDrillNote"):null;if(sr){const pr=sr.textContent||"Record the filename, timestamp and verification results in your backup log before closing the rehearsal so every drill leaves behind a documented recovery point.";y(sr,"helpRestoreDrillNote",pr)}if(oO){const pr=oO.textContent||"Monthly data health check";y(oO,"helpDataAuditTitle",pr)}if(L(Y7,"helpDataAuditStep1",[()=>E("#settingsButton",S("settingsButton")||"Settings",{target:"#settingsButton"}),()=>E("#dataHeading",S("dataHeading")||"Data & Storage",{target:"#dataHeading",highlight:"#settingsDialog"}),()=>E("#storageBackupNow",S("storageBackupNow")||"Download full backup",{target:"#storageBackupNow",highlight:"#storageActions"}),()=>E("#storageActionsHeading",S("storageActionsHeading")||"Quick safeguards",{target:"#storageActionsHeading",highlight:"#storageActions",isButton:!1})]),L(Q7,"helpDataAuditStep2",[()=>E("#shareSetupBtn",S("shareSetupBtn")||"Export Project",{target:"#shareSetupBtn",highlight:"#setup-manager"})]),L(X7,"helpDataAuditStep3",[()=>E("#reloadButton",S("reloadAppLabel")||"Force reload",{target:"#reloadButton"}),()=>E("#offlineIndicator",S("offlineIndicator")||"Offline",{target:"#offlineIndicator"}),()=>E("#applySharedLinkBtn",S("loadSharedLinkBtn")||"Import Project",{target:"#applySharedLinkBtn",highlight:"#setup-manager"})]),L(J7,"helpDataAuditStep4",[()=>E("#restoreRehearsalButton",S("restoreRehearsalButton")||"Restore rehearsal",{target:"#restoreRehearsalButton",highlight:"#restoreRehearsalSection"}),()=>{const pr=l.createElement("code");return pr.textContent="window.cineRuntime.verifyCriticalFlows({ warnOnFailure: true })",pr}]),aO){const pr=aO.textContent||"Log the results in your backup rotation checklist so you always know which copies were verified offline.";y(aO,"helpDataAuditNote",pr)}L(V7,"helpNoResultsSuggestionClear",[()=>E("#helpSearchClear",S("helpSearchClear")||"Clear search",{target:"#helpSearchClear",highlight:"#helpSearchContainer"})]),v(q7,"helpNoResultsSuggestionSynonyms"),L(K7,"helpNoResultsSuggestionQuickStart",[()=>E("#helpQuickStartGuide",S("helpQuickStartChecklistTitle")||"Quick start checklist",{target:"#helpQuickStartGuide",highlight:"#helpQuickStartGuide"})]),L(W7,"helpNoResultsSuggestionBackup",[()=>E("#helpDataSafety",S("helpDataSafetyTitle")||"Protect your work",{target:"#helpDataSafety",highlight:"#helpDataSafety"}),()=>E("#helpRestoreDrillHeading",S("helpRestoreDrillTitle")||"Restore rehearsal drill",{target:"#helpRestoreDrillHeading",highlight:"#helpDataSafety",isButton:!1})])}rt(document.getElementById("generateOverviewBtn"),texts[e].generateOverviewBtn,ICON_GLYPHS.overview),rt(document.getElementById("generateGearListBtn"),texts[e].generateGearListBtn,ICON_GLYPHS.gearList),rt(document.getElementById("shareSetupBtn"),texts[e].shareSetupBtn,ICON_GLYPHS.fileExport);const Sa=document.getElementById("exportAndRevertBtn");Sa&&(rt(Sa,texts[e].exportAndRevertBtn,ICON_GLYPHS.reload),Sa.setAttribute("data-help",texts[e].exportAndRevertBtnHelp));const No=typeof downloadDiagramBtn<"u"&&downloadDiagramBtn||(typeof document<"u"&&document&&typeof document.getElementById=="function"?document.getElementById("downloadDiagram"):null);if(No&&(No.textContent=texts[e].downloadDiagramBtn,No.setAttribute("title",texts[e].downloadDiagramBtn),No.setAttribute("aria-label",texts[e].downloadDiagramBtn),No.setAttribute("data-help",texts[e].downloadDiagramHelp)),gridSnapToggleBtn){rt(gridSnapToggleBtn,texts[e].gridSnapToggle,ICON_GLYPHS.magnet),gridSnapToggleBtn.setAttribute("title",texts[e].gridSnapToggle),gridSnapToggleBtn.setAttribute("aria-label",texts[e].gridSnapToggle),gridSnapToggleBtn.setAttribute("data-help",texts[e].gridSnapToggleHelp);let b=!1;try{b=!!nV()}catch{try{b=!!gridSnap}catch{}}gridSnapToggleBtn.setAttribute("aria-pressed",b?"true":"false")}const Fo=typeof document<"u"?document.getElementById("resetView"):null;Fo&&(rt(Fo,texts[e].resetViewBtn,ICON_GLYPHS.resetView),Fo.setAttribute("title",texts[e].resetViewBtn),Fo.setAttribute("aria-label",texts[e].resetViewBtn),Fo.setAttribute("data-help",texts[e].resetViewHelp));const Mi=typeof document<"u"?document.getElementById("zoomIn"):null;Mi&&(rt(Mi,"",ICON_GLYPHS.add),Mi.setAttribute("title",texts[e].zoomInLabel),Mi.setAttribute("aria-label",texts[e].zoomInLabel),Mi.setAttribute("data-help",texts[e].zoomInHelp));const _i=typeof document<"u"?document.getElementById("zoomOut"):null;_i&&(rt(_i,"",ICON_GLYPHS.minus),_i.setAttribute("title",texts[e].zoomOutLabel),_i.setAttribute("aria-label",texts[e].zoomOutLabel),_i.setAttribute("data-help",texts[e].zoomOutHelp));const va=typeof document<"u"?document.getElementById("diagramHint"):null;va&&(va.textContent=texts[e].diagramMoveHint);const Sr=texts.en&&texts.en.projectForm?texts.en.projectForm:{},Ir=texts[e].projectForm||Sr;if(Ir){wl();const b=(lt,It)=>{if(!lt)return;const bn=Ir[It]||Sr[It];bn&&(lt.textContent=bn)},M=(lt,It)=>{if(!lt)return;const bn=Ir[It]||Sr[It];bn&&lt.setAttribute("placeholder",bn)},me=(lt,It)=>{if(!lt)return;const bn=Ir[It]||Sr[It];bn&&(lt.textContent=bn)};if(b(M9,"heading"),b(_9,"projectName"),b(D9,"productionCompany"),b(N9,"productionCompanyAddress"),b(F9,"productionCompanyStreet"),b(j9,"productionCompanyStreet2"),b(H9,"productionCompanyCity"),b(U9,"productionCompanyRegion"),b(z9,"productionCompanyPostalCode"),b($9,"productionCompanyCountry"),M(V9,"productionCompanyStreetPlaceholder"),M(q9,"productionCompanyStreet2Placeholder"),M(K9,"productionCompanyCityPlaceholder"),M(W9,"productionCompanyRegionPlaceholder"),M(Y9,"productionCompanyPostalCodePlaceholder"),M(Q9,"productionCompanyCountryPlaceholder"),b(X9,"rentalHouse"),b(J9,"crewHeading"),NN){const lt=Ir.crewHeading||Sr.crewHeading;lt&&(NN.textContent=`${lt}:`)}if(b(Z9,"prepLabel"),b(eX,"shootLabel"),b(tX,"returnLabel"),b(rX,"deliveryResolution"),b(nX,"recordingResolution"),b(uX,"sensorMode"),b(fX,"aspectRatio"),b(dX,"codec"),b(pX,"baseFrameRate"),b(oX,"recordingFrameRate"),yc){const lt=Ir.recordingFrameRateRangeHint||Sr.recordingFrameRateRangeHint||"",It=Ir.recordingFrameRateDefaultHint||Sr.recordingFrameRateDefaultHint||"";lt?yc.setAttribute("data-range-template",lt):yc.removeAttribute("data-range-template"),It?(yc.setAttribute("data-default-message",It),yc.textContent=It,yc.hidden=!1):(yc.removeAttribute("data-default-message"),yc.textContent="",yc.hidden=!0)}if(FN){const lt=Ir.slowMotionHeading||Sr.slowMotionHeading;lt&&(FN.textContent=lt)}if(b(aX,"slowMotionRecordingResolution"),b(iX,"slowMotionSensorMode"),b(sX,"slowMotionAspectRatio"),b(lX,"slowMotionBaseFrameRate"),b(cX,"slowMotionRecordingFrameRate"),hc){const lt=Ir.slowMotionRecordingFrameRateRangeHint||Sr.slowMotionRecordingFrameRateRangeHint||"",It=Ir.slowMotionRecordingFrameRateDefaultHint||Sr.slowMotionRecordingFrameRateDefaultHint||"";lt?hc.setAttribute("data-range-template",lt):hc.removeAttribute("data-range-template"),It?(hc.setAttribute("data-default-message",It),hc.textContent=It,hc.hidden=!1):(hc.removeAttribute("data-default-message"),hc.textContent="",hc.hidden=!0)}if(b(bX,"lensesHeading"),b(mX,"lensManufacturerStep"),b(yX,"lensSeriesStep"),b(SX,"lensesLabel"),b(vX,"lensSelectionsLabel"),b(EX,"lensSelectionsHint"),me(gX,"lensManufacturerPlaceholder"),me(hX,"lensSeriesPlaceholder"),jN){const lt=Ir.lensSeriesEmpty||Sr.lensSeriesEmpty;lt&&(jN.textContent=lt)}if(HN){const lt=Ir.lensOptionsEmpty||Sr.lensOptionsEmpty;lt&&(HN.textContent=lt)}if(_T){const lt=Ir.lensRemoveLabel||Sr.lensRemoveLabel,It=Ir.lensMountLabel||Sr.lensMountLabel;lt&&_T.setAttribute("data-remove-template",lt),It&&_T.setAttribute("data-mount-label",It)}if(lensSelectionManager&&typeof lensSelectionManager.refreshCatalog=="function")try{lensSelectionManager.refreshCatalog({preserveSelections:!0,skipEvent:!0,skipDirty:!0})}catch{}if(b(AX,"riggingHeading"),b(CX,"requiredScenarios"),R7(e),b(wX,"cameraHandle"),b(LX,"viewfinderExtension"),b(RX,"matteboxFilterHeading"),b(TX,"mattebox"),b(OX,"filter"),b(CI,"storageHeading"),b(wI,"storageNeedsLabel"),T7(Ir,Sr),ZV(),b(xX,"monitoringHeading"),b(kX,"monitoringConfiguration"),b(IX,"viewfinderSettings"),b(PX,"frameGuides"),b(BX,"aspectMaskOpacity"),b(GX,"videoDistribution"),b(MX,"monitorUserButtons"),b(_X,"cameraUserButtons"),b(DX,"viewfinderUserButtons"),b(G9,"tripodPreferencesHeading"),b(NX,"tripodHeadBrand"),b(FX,"tripodBowl"),b(jX,"tripodTypes"),b(HX,"tripodSpreader"),Cv&&Cv.options.length>=2){const lt=Ir.viewfinderExtensionNone||Sr.viewfinderExtensionNone,It=Ir.viewfinderExtensionYes||Sr.viewfinderExtensionYes;lt&&(Cv.options[0].textContent=lt),It&&(Cv.options[1].textContent=It)}const ze=typeof document<"u"?document.getElementById("projectCancel"):null,Lt=Ir.cancel||Sr.cancel||(ze?ze.textContent:cp?.getAttribute("aria-label"))||"Cancel";if(ze&&rt(ze,Lt,ICON_GLYPHS.circleX),cp&&(cp.innerHTML=Jc(ICON_GLYPHS.circleX,"btn-icon"),cp.setAttribute("aria-label",Lt),cp.setAttribute("title",Lt),cp.setAttribute("data-help",Lt)),DT){const lt=Ir.submit||Sr.submit;lt&&(rt(DT,lt,ICON_GLYPHS.check),DT.setAttribute("aria-label",lt))}const ft={name:Ir.crewNamePlaceholder||Sr.crewNamePlaceholder,phone:Ir.crewPhonePlaceholder||Sr.crewPhonePlaceholder,email:Ir.crewEmailPlaceholder||Sr.crewEmailPlaceholder,website:Ir.crewWebsitePlaceholder||Sr.crewWebsitePlaceholder},sr=texts[e].crewRoles||texts.en&&texts.en.crewRoles||{},pr=texts.en?.contacts||{},Xe=texts[e]?.contacts||pr;if(vC&&Xe.heading&&(vC.textContent=Xe.heading),EC&&Xe.description&&(EC.textContent=Xe.description),AC&&Xe.addContactButton&&(AC.textContent=Xe.addContactButton),gd&&Xe.addContactButton&&(gd.setAttribute("aria-label",Xe.addContactButton),gd.setAttribute("data-help",Xe.addContactButton)),CC&&Xe.importButton&&(CC.textContent=Xe.importButton),yd&&Xe.importButton&&(yd.setAttribute("aria-label",Xe.importButton),yd.setAttribute("data-help",Xe.importButton)),wC&&Xe.importHint&&(wC.textContent=Xe.importHint),Iu&&Xe.emptyState&&(Iu.textContent=Xe.emptyState),RC&&Xe.userProfileHeading&&(RC.textContent=Xe.userProfileHeading),TC&&Xe.userProfileDescription&&(TC.textContent=Xe.userProfileDescription),OC&&Xe.userProfileNameLabel&&(OC.textContent=Xe.userProfileNameLabel),Ao&&Xe.userProfileNamePlaceholder&&Ao.setAttribute("placeholder",Xe.userProfileNamePlaceholder),xC&&Xe.userProfileRoleLabel&&(xC.textContent=Xe.userProfileRoleLabel),Cn){const lt=en?.getUserProfileSnapshot?en.getUserProfileSnapshot():{role:""};_V({selected:lt.role||""})}kC&&Xe.userProfilePhoneLabel&&(kC.textContent=Xe.userProfilePhoneLabel),Uo&&Xe.userProfilePhonePlaceholder&&Uo.setAttribute("placeholder",Xe.userProfilePhonePlaceholder),IC&&Xe.userProfileEmailLabel&&(IC.textContent=Xe.userProfileEmailLabel),zo&&Xe.userProfileEmailPlaceholder&&zo.setAttribute("placeholder",Xe.userProfileEmailPlaceholder),PC&&Xe.userProfileHint&&(PC.textContent=Xe.userProfileHint),BC&&Xe.userProfileAvatarButton&&(BC.textContent=Xe.userProfileAvatarButton),ol&&Xe.userProfileAvatarButton&&(ol.setAttribute("aria-label",Xe.userProfileAvatarButton),ol.removeAttribute("data-help"),ol.removeAttribute("title")),Zl&&Xe.userProfileAvatarRemove&&(Zl.textContent=Xe.userProfileAvatarRemove,Zl.setAttribute("aria-label",Xe.userProfileAvatarRemove)),GC&&Xe.avatarOptionsTitle&&(GC.textContent=Xe.avatarOptionsTitle),MC&&Xe.avatarOptionsDescription&&(MC.textContent=Xe.avatarOptionsDescription),_C&&Xe.avatarOptionsClose&&(_C.textContent=Xe.avatarOptionsClose),Qf&&Xe.avatarOptionsClose&&(Qf.setAttribute("aria-label",Xe.avatarOptionsClose),Qf.setAttribute("title",Xe.avatarOptionsClose),Qf.setAttribute("data-help",Xe.avatarOptionsClose)),Gf&&Xe.avatarDelete&&(rt(Gf,Xe.avatarDelete,ICON_GLYPHS.trash),Gf.setAttribute("aria-label",Xe.avatarDelete),Gf.setAttribute("title",Xe.avatarDelete),Gf.setAttribute("data-help",Xe.avatarDelete)),DC&&Xe.avatarEditZoomLabel&&(DC.textContent=Xe.avatarEditZoomLabel),lb&&Xe.close&&(lb.textContent=Xe.close),Qu(),document.querySelectorAll("#crewContainer .person-row").forEach(lt=>{const It=lt.querySelector("select");if(It){const ue=It.value;Array.from(It.options).forEach(ce=>{const ge=ce.value;ce.textContent=sr[ge]||ge}),It.value=ue}const bn=lt.querySelector(".person-name");bn&&ft.name&&(bn.placeholder=ft.name);const ls=lt.querySelector(".person-phone");ls&&ft.phone&&(ls.placeholder=ft.phone);const Di=lt.querySelector(".person-email");Di&&ft.email&&(Di.placeholder=ft.email);const Tl=lt.querySelector(".person-website");Tl&&ft.website&&(Tl.placeholder=ft.website);const B=lt.querySelector(".person-contact-select");B&&VL(B,B.value);const X=lt.querySelector(".person-save-contact");X&&rt(X,pt("saveContact","Save to contacts"),ICON_GLYPHS.save);const $=lt.querySelector(".person-manage-contacts");$&&rt($,pt("openManager","Open contacts"),ICON_GLYPHS.gears),KL(lt)});const Yn=lt=>typeof lt=="string"?lt.replace(/[\s\u00a0]*[:]\s*$/,""):lt,cn=Ir.addEntry||Sr.addEntry||"Add";if(Vp){const lt=Yn(Ir.crewHeading||Sr.crewHeading||"Crew"),It=`${cn} ${lt}`.trim();rt(Vp,It,ICON_GLYPHS.add),Vp.setAttribute("aria-label",It),Vp.setAttribute("data-help",It)}if(qp){const lt=Yn(Ir.prepLabel||Sr.prepLabel||"Prep"),It=`${cn} ${lt}`.trim();rt(qp,It,ICON_GLYPHS.add),qp.setAttribute("aria-label",It),qp.setAttribute("data-help",It)}if(Kp){const lt=Yn(Ir.shootLabel||Sr.shootLabel||"Shoot"),It=`${cn} ${lt}`.trim();rt(Kp,It,ICON_GLYPHS.add),Kp.setAttribute("aria-label",It),Kp.setAttribute("data-help",It)}if(Wp){const lt=Yn(Ir.returnLabel||Sr.returnLabel||"Return Day"),It=`${cn} ${lt}`.trim();rt(Wp,It,ICON_GLYPHS.add),Wp.setAttribute("aria-label",It),Wp.setAttribute("data-help",It)}}if(wh&&(wh.textContent=texts[e].iosPwaHelpTitle),Lh&&(Lh.textContent=texts[e].iosPwaHelpIntro),Rh&&(Rh.textContent=texts[e].iosPwaHelpStep1),yF&&(yF.textContent=texts[e].iosPwaHelpStep2),hF&&(hF.textContent=texts[e].iosPwaHelpStep3),bF&&(bF.textContent=texts[e].iosPwaHelpStep4),SF&&(SF.textContent=texts[e].iosPwaHelpNote),Lm){const b=texts[e].iosPwaHelpClose;rt(Lm,b,ICON_GLYPHS.check),Lm.setAttribute("aria-label",b)}document.querySelectorAll(".favorite-toggle").forEach(b=>{b.setAttribute("aria-label",texts[e].favoriteToggleLabel),b.setAttribute("title",texts[e].favoriteToggleLabel),b.setAttribute("data-help",texts[e].favoriteToggleHelp||texts[e].favoriteToggleLabel)}),ensureGearListActions(),updateDiagramLegend(),updateStorageSummary(),kr("populateFeatureSearch",[],{defer:!0})}var Dd=document.getElementById("cameraSelect");typeof window<"u"&&(window.cameraSelect=Dd);var L9=document.getElementById("monitorSelect");typeof window<"u"&&(window.monitorSelect=L9);var R9=document.getElementById("videoSelect");typeof window<"u"&&(window.videoSelect=R9);var T9=document.getElementById("videoDistribution");typeof window<"u"&&(window.videoDistributionSelect=T9);var O9=document.getElementById("cageSelect");typeof window<"u"&&(window.cageSelect=O9);var x9=[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")];typeof window<"u"&&(window.motorSelects=x9);var k9=[document.getElementById("controller1Select"),document.getElementById("controller2Select"),document.getElementById("controller3Select"),document.getElementById("controller4Select")];typeof window<"u"&&(window.controllerSelects=k9);var I9=document.getElementById("distanceSelect");typeof window<"u"&&(window.distanceSelect=I9);var qy=document.getElementById("batterySelect");typeof window<"u"&&(window.batterySelect=qy);var P9=document.getElementById("batteryHotswapSelect");typeof window<"u"&&(window.hotswapSelect=P9);var B9=document.getElementById("lenses");typeof window<"u"&&(window.lensSelect=B9);var DN=document.getElementById("requiredScenarios");document.getElementById("requiredScenariosSummary");DN&&DN.querySelector('option[value="Remote Head"]');document.getElementById("tripodPreferencesSection");document.getElementById("tripodPreferencesRow");var G9=document.getElementById("tripodPreferencesHeading");document.getElementById("tripodHeadBrand");document.getElementById("tripodBowl");document.getElementById("tripodTypes");document.getElementById("tripodSpreader");document.getElementById("monitoringConfiguration");document.getElementById("viewfinderSettingsRow");document.getElementById("viewfinderExtensionRow");const M9=document.getElementById("projectDialogHeading");var cp=document.getElementById("projectDialogClose");const _9=document.getElementById("projectNameLabel"),D9=document.getElementById("productionCompanyLabel"),N9=document.getElementById("productionCompanyAddressLabel"),F9=document.getElementById("productionCompanyStreetLabel"),j9=document.getElementById("productionCompanyStreet2Label"),H9=document.getElementById("productionCompanyCityLabel"),U9=document.getElementById("productionCompanyRegionLabel"),z9=document.getElementById("productionCompanyPostalCodeLabel"),$9=document.getElementById("productionCompanyCountryLabel"),V9=document.getElementById("productionCompanyStreet"),q9=document.getElementById("productionCompanyStreet2"),K9=document.getElementById("productionCompanyCity"),W9=document.getElementById("productionCompanyRegion"),Y9=document.getElementById("productionCompanyPostalCode"),Q9=document.getElementById("productionCompanyCountry"),X9=document.getElementById("rentalHouseLabel"),J9=document.getElementById("crewHeading"),NN=document.getElementById("crewLabel"),Z9=document.getElementById("prepLabel"),eX=document.getElementById("shootLabel"),tX=document.getElementById("returnLabel"),rX=document.getElementById("deliveryResolutionLabel");document.getElementById("deliveryResolution");const nX=document.getElementById("recordingResolutionLabel"),oX=document.getElementById("recordingFrameRateLabel"),yc=document.getElementById("recordingFrameRateHint"),FN=document.getElementById("slowMotionFrameRateLegend"),aX=document.getElementById("slowMotionRecordingResolutionLabel"),iX=document.getElementById("slowMotionSensorModeLabel"),sX=document.getElementById("slowMotionAspectRatioLabel"),lX=document.getElementById("slowMotionBaseFrameRateLabel"),cX=document.getElementById("slowMotionRecordingFrameRateLabel"),hc=document.getElementById("slowMotionRecordingFrameRateHint"),uX=document.getElementById("sensorModeLabel"),fX=document.getElementById("aspectRatioLabel"),dX=document.getElementById("codecLabel"),pX=document.getElementById("baseFrameRateLabel"),mX=document.getElementById("lensManufacturerLabel"),gX=document.getElementById("lensManufacturerPlaceholder"),yX=document.getElementById("lensSeriesLabel"),hX=document.getElementById("lensSeriesPlaceholder"),jN=document.getElementById("lensSeriesEmpty"),HN=document.getElementById("lensOptionsEmpty"),bX=document.getElementById("lensesHeading"),SX=document.getElementById("lensesLabel"),vX=document.getElementById("lensSelectionsLabel"),EX=document.getElementById("lensSelectionsHint"),_T=document.getElementById("lensSelectionChips"),AX=document.getElementById("riggingHeading"),CX=document.getElementById("requiredScenariosLabel"),wX=document.getElementById("cameraHandleLabel"),LX=document.getElementById("viewfinderExtensionLabel"),Cv=document.getElementById("viewfinderExtension"),RX=document.getElementById("matteboxFilterHeading"),TX=document.getElementById("matteboxLabel"),OX=document.getElementById("filterLabel"),CI=document.getElementById("storageHeading"),wI=document.getElementById("storageNeedsLabel"),xX=document.getElementById("monitoringHeading"),kX=document.getElementById("monitoringConfigurationLabel"),IX=document.getElementById("viewfinderSettingsLabel"),PX=document.getElementById("frameGuidesLabel"),BX=document.getElementById("aspectMaskOpacityLabel"),GX=document.getElementById("videoDistributionLabel"),MX=document.getElementById("monitorUserButtonsLabel"),_X=document.getElementById("cameraUserButtonsLabel"),DX=document.getElementById("viewfinderUserButtonsLabel"),NX=document.getElementById("tripodHeadBrandLabel"),FX=document.getElementById("tripodBowlLabel"),jX=document.getElementById("tripodTypesLabel"),HX=document.getElementById("tripodSpreaderLabel"),DT=document.getElementById("projectSubmit");var Ql=document.getElementById("crewContainer");const Vp=document.getElementById("addPersonBtn");var UN=document.getElementById("prepContainer");const qp=document.getElementById("addPrepBtn");var zN=document.getElementById("shootContainer");const Kp=document.getElementById("addShootBtn");var $N=document.getElementById("returnContainer");const Wp=document.getElementById("addReturnBtn");var VN=document.getElementById("storageNeedsContainer"),ji=null,LI=null,vC=null,EC=null,gd=null,AC=null,yd=null,CC=null,Bf=null,wC=null,Rc=null,Iu=null,lb=null,LC=null,RI=null,qN=null,RC=null,TC=null,Ao=null,OC=null,Cn=null,xC=null,Uo=null,kC=null,zo=null,IC=null,PC=null,og=null,ol=null,BC=null,zi=null,Zl=null,Ko=null,bm=null,GC=null,MC=null,Qf=null,_C=null,Gf=null,qt=null,Xl=null,KN=null,ag=null,ig=null,DC=null,Ja=null,st=null,NT=0,ph=null,TI=null,OI=null;function wl(){typeof document>"u"||(ji=ji||document.getElementById("contactsDialog"),LI=LI||document.getElementById("contactsForm"),vC=vC||document.getElementById("contactsDialogHeading"),EC=EC||document.getElementById("contactsDialogDescription"),gd=gd||document.getElementById("contactsAddButton"),AC=AC||document.getElementById("contactsAddButtonLabel"),yd=yd||document.getElementById("contactsImportButton"),CC=CC||document.getElementById("contactsImportButtonLabel"),Bf=Bf||document.getElementById("contactsImportInput"),wC=wC||document.getElementById("contactsImportHint"),Rc=Rc||document.getElementById("contactsList"),Iu=Iu||document.getElementById("contactsEmptyState"),lb=lb||document.getElementById("contactsCloseButton"),LC=LC||document.getElementById("contactsAnnouncement"),RI=RI||document.getElementById("openContactsBtn"),qN=qN||document.getElementById("contactsUserProfile"),RC=RC||document.getElementById("contactsUserProfileHeading"),TC=TC||document.getElementById("contactsUserProfileDescription"),Ao=Ao||document.getElementById("userProfileName"),OC=OC||document.getElementById("userProfileNameLabel"),Cn=Cn||document.getElementById("userProfileRole"),xC=xC||document.getElementById("userProfileRoleLabel"),Uo=Uo||document.getElementById("userProfilePhone"),kC=kC||document.getElementById("userProfilePhoneLabel"),zo=zo||document.getElementById("userProfileEmail"),IC=IC||document.getElementById("userProfileEmailLabel"),PC=PC||document.getElementById("userProfileHint"),og=og||document.getElementById("userProfileAvatar"),ol=ol||document.getElementById("userProfileAvatarButton"),BC=BC||document.getElementById("userProfileAvatarButtonLabel"),zi=zi||document.getElementById("userProfileAvatarInput"),Zl=Zl||document.getElementById("userProfileAvatarClear"),Ko=Ko||document.getElementById("avatarOptionsDialog"),bm=bm||document.getElementById("avatarOptionsForm"),GC=GC||document.getElementById("avatarOptionsTitle"),MC=MC||document.getElementById("avatarOptionsDescription"),Qf=Qf||document.getElementById("avatarOptionsClose"),_C=_C||document.getElementById("avatarOptionsCloseLabel"),qt=qt||document.getElementById("avatarEditViewport"),Xl=Xl||document.getElementById("avatarEditImage"),KN=KN||document.getElementById("avatarPlaceholder"),ag=ag||document.getElementById("avatarControls"),ig=ig||document.getElementById("avatarEditZoom"),DC=DC||document.getElementById("avatarEditZoomLabel"),ph=ph||document.getElementById("avatarUploadInput"),Gf=Gf||document.getElementById("avatarDeleteButton"),TI=TI||document.getElementById("avatarSaveButton"),OI=OI||document.getElementById("avatarCancelButton"))}var sg=["DoP","Steadicam Operator","Camera Operator","B-Camera Operator","Drone Operator","DIT","1st AC","2nd AC","Video Operator","Key Grip","Dolly Grip","Best Boy Grip","Rigging Grip","Grip","Key Gaffer","Gaffer","Rigging Gaffer","Best Boy Electric","Electrician","Director","Assistant Director","Producer","Production Manager","Production Assistant"];function MV(){const e=typeof jt=="string"?jt:"en";return texts?.[e]?.crewRoles||texts?.en?.crewRoles||{}}function _V(e={}){if(wl(),!Cn)return;const t=Cn.ownerDocument||(typeof document<"u"?document:null);if(!t)return;const r=MV(),n=pt("rolePlaceholder","Select role"),o=pt("userProfileRolePlaceholder",n)||n,a=e&&typeof e.selected=="string"?e.selected:en?.getUserProfileSnapshot?en.getUserProfileSnapshot().role:"",i=Cn.scrollTop;Cn.textContent="";const s=t.createElement("option");s.value="",s.textContent=o,Cn.appendChild(s),sg.forEach(c=>{const u=t.createElement("option");u.value=c,u.textContent=r[c]||c,Cn.appendChild(u)});const l=typeof a=="string"?a.trim():"";if(l&&!sg.includes(l)){const c=t.createElement("option");c.value=l,c.textContent=r[l]||l,Cn.appendChild(c)}Cn.value=l||"",Cn.scrollTop=i}function DV(e){if(wl(),!Cn)return;const t=typeof e=="string"?e.trim():"";if(!t||Array.from(Cn.options||[]).some(i=>i.value===t))return;const n=Cn.ownerDocument||(typeof document<"u"?document:null);if(!n)return;const o=MV(),a=n.createElement("option");a.value=t,a.textContent=o[t]||t,Cn.appendChild(a)}var UX={productionCompany:C6,productionCompanyAddress:ICON_GLYPHS.pin,rentalHouse:w6,rentalHouseContact:ICON_GLYPHS.contacts,rentalHouseAddress:ICON_GLYPHS.pin,crew:iconGlyph("",ICON_FONT_KEYS.UICONS),prepDays:iconGlyph("",ICON_FONT_KEYS.UICONS),returnDays:iconGlyph("",ICON_FONT_KEYS.UICONS),shootingDays:iconGlyph("",ICON_FONT_KEYS.UICONS),deliveryResolution:iconGlyph("",ICON_FONT_KEYS.UICONS),recordingResolution:ICON_GLYPHS.camera,recordingFrameRate:iconGlyph("",ICON_FONT_KEYS.UICONS),slowMotionRecordingResolution:ICON_GLYPHS.camera,slowMotionRecordingFrameRate:iconGlyph("",ICON_FONT_KEYS.UICONS),aspectRatio:tN,codec:ICON_GLYPHS.codec,baseFrameRate:iconGlyph("",ICON_FONT_KEYS.UICONS),slowMotionBaseFrameRate:iconGlyph("",ICON_FONT_KEYS.UICONS),sensorMode:ICON_GLYPHS.sensor,slowMotionSensorMode:ICON_GLYPHS.sensor,slowMotionAspectRatio:tN,requiredScenarios:L6,lenses:iconGlyph("",ICON_FONT_KEYS.UICONS),cameraHandle:iconGlyph("",ICON_FONT_KEYS.UICONS),viewfinderExtension:iconGlyph("",ICON_FONT_KEYS.UICONS),gimbal:iconGlyph("",ICON_FONT_KEYS.UICONS),monitoringSupport:R6,monitoringConfiguration:iconGlyph("",ICON_FONT_KEYS.UICONS),monitorUserButtons:iconGlyph("",ICON_FONT_KEYS.UICONS),cameraUserButtons:iconGlyph("",ICON_FONT_KEYS.UICONS),viewfinderUserButtons:iconGlyph("",ICON_FONT_KEYS.UICONS),storageRequirements:ICON_GLYPHS.save};function NV(e){if(!e)return;const t=e.multiple?Array.from(e.selectedOptions||[]):[],r=e.multiple?t.some(i=>typeof i.value=="string"?i.value.trim()!=="":!!i.value):typeof e.value=="string"?e.value.trim()!=="":e.value!==null&&e.value!==void 0&&String(e.value).trim()!=="";if(e.classList.toggle("select-placeholder",!r),e.id==="requiredScenarios")return;const n=e.parentNode;if(!n||typeof n.querySelector!="function")return;let o=n.querySelector(".icon-box-summary");o||(o=document.createElement("div"),o.className="icon-box-summary",n.insertBefore(o,e.nextSibling)),o.innerHTML="",(e.multiple?t:r&&e.selectedIndex>=0?[e.options[e.selectedIndex]]:[]).forEach(i=>{const s=document.createElement("span");s.className="icon-box";const l=document.createElement("span");l.className="icon icon-glyph";let c=UX[e.name]||ICON_GLYPHS.pin;i.dataset.icon&&(c=iconGlyph(i.dataset.icon,i.dataset.iconFont||ICON_FONT_KEYS.UICONS)),applyIconGlyph(l,c),s.appendChild(l),s.appendChild(document.createTextNode(i.value)),o.appendChild(s)})}try{typeof globalThis<"u"&&typeof globalThis.updateSelectIconBoxes!="function"&&(globalThis.updateSelectIconBoxes=NV)}catch(e){console.warn("Failed to expose updateSelectIconBoxes globally",e)}function WN(e,t=""){if(!e)return t;const r=Array.isArray(e)?e:typeof e=="string"?[e]:[];if(!r.length)return t;const n=texts&&texts[jt]||{},o=texts&&texts.en||{},a=l=>r.reduce((c,u)=>{if(c&&Object.prototype.hasOwnProperty.call(c,u))return c[u]},l),i=a(n);if(i!=null&&i!=="")return String(i);const s=a(o);return s!=null&&s!==""?String(s):t}function Yp(e,t,r={}){if(!e)return;const{contextPaths:n=[],fallbackContext:o="",actionKey:a="addEntry"}=r||{};rt(e,"",t||ICON_GLYPHS.add);const i=WN(["projectForm",a],a==="removeEntry"?"Remove":"Add"),s=Array.isArray(n)?n:[n];let l="";for(const f of s){if(!f)continue;const d=WN(f,"");if(d){l=d;break}}!l&&typeof o=="string"&&(l=o);const c=l?l.replace(/[:]\s*$/,"").trim():"",u=[i,c].filter(Boolean).join(" ").trim();u&&(e.setAttribute("aria-label",u),e.setAttribute("title",u))}Ut("configureIconOnlyButton",Yp);let YN=0;function zX(e,t="field"){return e==null?t:String(e).toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")||t}function bs(e,t="field"){if(!e)return"";if(e.id)return e.id;const r=zX(t,"field");let n="";do YN+=1,n=`${r}-${YN}`;while(document.getElementById(n));return e.id=n,n}function Tf(e,t){const r=document.createElement("label");return r.className="visually-hidden",r.setAttribute("for",e),r.textContent=typeof t=="string"?t:"",r}try{typeof globalThis<"u"&&(typeof globalThis.ensureElementId!="function"&&(globalThis.ensureElementId=bs),typeof globalThis.createHiddenLabel!="function"&&(globalThis.createHiddenLabel=Tf))}catch(e){console.warn("Failed to expose accessibility helpers globally",e)}function FV(e,t=""){const r=texts?.en?.projectForm||{},n=texts?.[jt]?.projectForm||r,o=n&&typeof n[e]=="string"?n[e].trim():"";return o||(r&&typeof r[e]=="string"?r[e].trim():"")||t}const $X="cameraPowerPlanner_contacts";function jV(){try{const e=UL();if(e&&typeof e.CONTACTS_STORAGE_KEY=="string"&&e.CONTACTS_STORAGE_KEY)return e.CONTACTS_STORAGE_KEY}catch(e){console.warn("Failed to resolve contacts storage key via module.",e)}return $X}var wn=[],QN=!1;const en=l8({loadProfile:()=>{try{return typeof loadUserProfile=="function"?loadUserProfile():null}catch(e){return console.warn("Failed to resolve stored user profile",e),null}},saveProfile:e=>{if(typeof saveUserProfile=="function")try{saveUserProfile(e)}catch(t){console.warn("Failed to persist user profile",t)}},announce:e=>Cr(e),getText:pt,dispatchChange:()=>VV("user-profile")});function pt(e,t=""){const r=texts?.en?.contacts||{},n=texts?.[jt]?.contacts||r,o=n&&typeof n[e]=="string"?n[e].trim():"";return o||(r&&typeof r[e]=="string"?r[e].trim():"")||t}function hG(){const e=UL();if(e&&typeof e.generateContactId=="function")try{return e.generateContactId()}catch(t){console.warn("Unable to generate contact id via module.",t)}return`contact-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`}function Hi(e){return u8(e)}function HV(e){return f8(e)}function cb(e){return pV(e)}function VX(){const e=UL();if(e&&typeof e.loadStoredContacts=="function")try{return e.loadStoredContacts()}catch(t){console.warn("Unable to load contacts via module.",t)}if(typeof localStorage>"u")return[];try{const t=jV(),r=localStorage.getItem(t);if(!r)return[];const n=JSON.parse(r);return Array.isArray(n)?cb(n):[]}catch(t){return console.warn("Failed to load contacts from storage",t),[]}}function lg(e){const t=UL();if(t&&typeof t.saveContactsToStorage=="function")try{t.saveContactsToStorage(e);return}catch(r){console.warn("Unable to save contacts via module.",r)}if(!(typeof localStorage>"u"))try{const r=jV();localStorage.setItem(r,JSON.stringify(e))}catch(r){console.warn("Failed to save contacts to storage",r)}}function bG(e){return e&&wn.find(t=>t.id===e)||null}function qX(e){if(!e)return"";const t=texts?.[jt]?.crewRoles||texts?.en?.crewRoles||{},r=e.name||e.email||e.phone||e.website||e.role||e.id,n=e.role?t[e.role]||e.role:"";return r&&n&&n!==r?`${r}  ${n}`:r||n||e.id}function VL(e,t){if(!e)return;const r=typeof t=="string"?t:e.value;let n=e.lang;!n&&typeof document<"u"&&document&&document.documentElement&&(n=document.documentElement.lang||""),n||(n=jt||oo);const o=e.dir||rV(n||jt||oo);for(;e.firstChild;)e.removeChild(e.firstChild);const a=document.createElement("option");if(a.value="",a.textContent=pt("selectPlaceholder","Select contact"),gs(a,n,o),e.appendChild(a),wn.forEach(i=>{const s=document.createElement("option");s.value=i.id,s.textContent=qX(i),gs(s,n,o),i.id===r&&(s.selected=!0),e.appendChild(s)}),r&&!wn.some(i=>i.id===r)){const i=document.createElement("option");i.value=r,i.textContent=pt("missingContactFallback","Saved contact"),i.selected=!0,gs(i,n,o),e.appendChild(i)}}function Nd(){if(!Ql)return;Ql.querySelectorAll(".person-contact-select").forEach(t=>VL(t)),VV("contacts")}function KX(e){if(typeof e=="string"){const t=e.trim();if(t)return t.charAt(0).toUpperCase()}return""}function Eu(e,t,r,n){if(!e)return;const o=e.querySelector(".person-avatar-visual, .contact-card-avatar-visual");if(o){for(;o.firstChild;)o.removeChild(o.firstChild);if(t&&c8(t)){const a=document.createElement("img");a.src=t,a.alt="",o.appendChild(a)}else{const a=document.createElement("span");a.className=n,a.textContent=KX(r),o.appendChild(a)}}}function mh(e,t,r={}){if(!e)return;const n=e.querySelector(".person-avatar-data");n&&(n.value=t||"");const o=e.querySelector(".person-name"),a=r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:o?.value,i=e.querySelector(".person-avatar");Eu(i,t,a,"person-avatar-initial")}function WX(e){if(typeof e!="string"||!e.startsWith("data:"))return"";const t=e.indexOf(";");return t===-1?"":e.slice(5,t).trim()}function ub(e,t){wl()}function fb(e={}){const{restoreFocus:t=!1}=e||{};if(ag&&ag.classList.add("hidden"),qt){try{qt.releasePointerCapture(st?.pointerId??-1)}catch{}t&&qt.blur()}Xl&&Xl.removeAttribute("style"),st=null,typeof Ja?.getAvatar=="function"&&Ja.getAvatar(),typeof Ja?.getName=="function"&&Ja.getName(),ub(),ub()}function Ls(){Ko&&(fb(),Ja=null,xu(Ko))}function YX(){fb(),Ja=null}function SG(e=null){console.log("openAvatarOptionsDialog called",e),wl(),console.log("avatarOptionsDialog ref:",Ko),Ko&&(Ja=e||null,typeof e?.getAvatar=="function"&&e.getAvatar(),typeof e?.getName=="function"&&e.getName(),ub(),fb(),fb(),lS(Ko))}function qL(e){if(!e)return;const t=Math.min(0,e.viewportSize-e.displayWidth),r=Math.min(0,e.viewportSize-e.displayHeight);e.offsetX=Math.max(t,Math.min(0,e.offsetX)),e.offsetY=Math.max(r,Math.min(0,e.offsetY))}function db(e){if(!e||!e.image)return;const t=e.image.naturalWidth||e.image.width||0,r=e.image.naturalHeight||e.image.height||0,n=t*e.baseScale*e.zoom,o=r*e.baseScale*e.zoom;e.displayWidth=n,e.displayHeight=o,qL(e),Xl&&(Xl.style.width=`${n}px`,Xl.style.height=`${o}px`,Xl.style.transform=`translate(${e.offsetX}px, ${e.offsetY}px)`)}function QX(){if(wl(),!qt)return 0;let e=!1,t="",r="";qt&&qt.classList.contains("hidden")&&(e=!0,t=qt.style.visibility||"",r=qt.style.pointerEvents||"",qt.style.visibility="hidden",qt.style.pointerEvents="none",qt.classList.remove("hidden"));let n=0;try{const o=qt.getBoundingClientRect();n=Math.round(Math.max(qt.offsetWidth||0,o.width||0,o.height||0))}finally{e&&qt&&(qt.classList.add("hidden"),qt.style.visibility=t,qt.style.pointerEvents=r)}return!n&&NT?NT:(n&&(NT=n),n)}function XX(e){if(wl(),!qt||!Xl)return;if(!e){Cr(pt("avatarMissingImage","Add a photo before editing."));return}const t=QX();if(!t){Cr(pt("avatarEditUnavailable","Photo editor unavailable."));return}const r=new Image;r.decoding="async";const n=WX(e);r.onload=()=>{if(!r.naturalWidth||!r.naturalHeight){Cr(pt("avatarReadError","Could not read the selected image."));return}const o=Math.max(t/r.naturalWidth,t/r.naturalHeight);st={active:!0,dataUrl:e,image:r,mime:n,viewportSize:t,baseScale:o,zoom:1,offsetX:(t-r.naturalWidth*o)/2,offsetY:(t-r.naturalHeight*o)/2,pointerId:null,pointerStartX:0,pointerStartY:0,offsetStartX:0,offsetStartY:0,displayWidth:0,displayHeight:0},Xl.src=e,qt&&qt.classList.add("has-image"),ag&&ag.classList.remove("hidden"),ig&&(ig.value="100"),db(st);try{qt.focus()}catch{}},r.onerror=()=>{Cr(pt("avatarReadError","Could not read the selected image."))},r.src=e}function XN(e){if(!st||!st.active)return;const t=Number(e?.target?.value)||100,r=Math.max(50,t)/100,n=st.displayWidth||1,o=st.displayHeight||1,a=-st.offsetX+st.viewportSize/2,i=-st.offsetY+st.viewportSize/2,s=a/n,l=i/o;st.zoom=r,db(st);const c=st.displayWidth*s,u=st.displayHeight*l;st.offsetX=-(c-st.viewportSize/2),st.offsetY=-(u-st.viewportSize/2),qL(st),db(st)}function JX(e){if(!(!st||!st.active||!qt)&&st.pointerId===null){st.pointerId=e.pointerId,st.pointerStartX=e.clientX,st.pointerStartY=e.clientY,st.offsetStartX=st.offsetX,st.offsetStartY=st.offsetY;try{qt.setPointerCapture(e.pointerId)}catch{}e.preventDefault()}}function ZX(e){if(!st||!st.active||st.pointerId!==e.pointerId)return;const t=e.clientX-st.pointerStartX,r=e.clientY-st.pointerStartY;st.offsetX=st.offsetStartX+t,st.offsetY=st.offsetStartY+r,qL(st),db(st),e.preventDefault()}function UV(){st&&(st.pointerId=null)}function e7(e){if(!(!st||!st.active)&&st.pointerId===e.pointerId){if(UV(),qt)try{qt.releasePointerCapture(e.pointerId)}catch{}e.preventDefault()}}function t7(e){if(!(!st||!st.active)&&st.pointerId===e.pointerId&&(UV(),qt))try{qt.releasePointerCapture(e.pointerId)}catch{}}function r7(e){if(!st||!st.active)return;const t=e.shiftKey?10:2;let r=!1;switch(e.key){case"ArrowUp":st.offsetY-=t,r=!0;break;case"ArrowDown":st.offsetY+=t,r=!0;break;case"ArrowLeft":st.offsetX-=t,r=!0;break;case"ArrowRight":st.offsetX+=t,r=!0;break}r&&(qL(st),db(st),e.preventDefault())}function zV(){if(!st||!st.image)return"";const e=st.baseScale*st.zoom;if(!e)return"";const t=st.viewportSize/e,r=Math.max(0,Math.min(st.image.naturalWidth-t,-st.offsetX/e)),n=Math.max(0,Math.min(st.image.naturalHeight-t,-st.offsetY/e)),o=document.createElement("canvas");o.width=CONTACT_AVATAR_MAX_DIMENSION,o.height=CONTACT_AVATAR_MAX_DIMENSION;const a=o.getContext("2d");if(!a)return"";a.clearRect(0,0,o.width,o.height),a.drawImage(st.image,r,n,t,t,0,0,o.width,o.height);const i=st.mime&&st.mime.startsWith("image/")?st.mime:"image/png";try{return o.toDataURL(i)}catch{try{return o.toDataURL("image/png")}catch{return""}}}function n7(){if(!st||!st.active)return;const e=zV();if(!e){Cr(pt("avatarEditFailed","Could not update the photo framing."));return}typeof Ja?.onEditSave=="function"&&Ja.onEditSave(e),typeof Ja?.getName=="function"&&Ja.getName(),ub(),fb({restoreFocus:!0}),Ls()}function o7(e){if(!e)return;e.preventDefault(),e.stopPropagation(),qt&&qt.classList.remove("drag-over");const t=e.dataTransfer&&e.dataTransfer.files&&e.dataTransfer.files[0];t&&$V(t)}function JN(e){e&&(e.preventDefault(),e.stopPropagation(),qt&&qt.classList.add("drag-over"))}function a7(e){e&&(e.preventDefault(),e.stopPropagation(),qt&&qt.classList.remove("drag-over"))}function i7(e){const t=e.target&&e.target.files&&e.target.files[0];t&&$V(t),e.target&&(e.target.value="")}function $V(e){sS(e,t=>{const r=typeof Ja?.getName=="function"?Ja.getName():"";ub(t,r),XX(t)},t=>{Cr(pt("avatarReadError","Could not read image."))})}function s7(){if(st&&st.active){const e=zV();e&&typeof Ja?.onEditSave=="function"&&Ja.onEditSave(e)}Ls()}function ZN(e){if(!Ko||!Jd(Ko)||e&&typeof e.button=="number"&&e.button!==0)return;const t=e?.target||null,r=typeof Element<"u"&&t instanceof Element?t:null,n=typeof e?.composedPath=="function"?e.composedPath():null;if(!(bm&&(r&&bm.contains(r)||Array.isArray(n)&&n.includes(bm)))){if(st&&st.active){n7();return}Ls()}}function VV(e){if(!(typeof document>"u"))try{document.dispatchEvent(new CustomEvent("gear-provider-data-changed",{detail:{reason:e}}))}catch{}}function Ll(e={}){!en||typeof en.assignUserProfileState!="function"||en.assignUserProfileState(e)}function Rs(){return!en||typeof en.getUserProfileSnapshot!="function"?{name:"",role:"",avatar:"",phone:"",email:""}:en.getUserProfileSnapshot()}function NC(e={}){wl();const t=Rs(),r=e&&e.preserveSelectionTarget?e.preserveSelectionTarget:e&&e.preserveSelection?document.activeElement:null;if(Ao)if(r===Ao){const n=Ao.selectionStart,o=Ao.selectionEnd;Ao.value=t.name;try{Ao.setSelectionRange(n,o)}catch{}}else Ao.value=t.name;if(Cn&&(DV(t.role),r!==Cn&&(Cn.value=t.role||"")),Uo)if(r===Uo){const n=Uo.selectionStart,o=Uo.selectionEnd;Uo.value=t.phone;try{Uo.setSelectionRange(n,o)}catch{}}else Uo.value=t.phone;if(zo)if(r===zo){const n=zo.selectionStart,o=zo.selectionEnd;zo.value=t.email;try{zo.setSelectionRange(n,o)}catch{}}else zo.value=t.email;if(og&&Eu(og,t.avatar||"",t.name,"contact-card-avatar-initial"),Zl){const n=!!t.avatar;Zl.disabled=!n,Zl.setAttribute("aria-disabled",n?"false":"true")}}function l7(){if(!en||typeof en.load!="function"){NC();return}en.load(),NC()}function c7(e){Ll({avatar:typeof e=="string"?e:""}),Rl()}function u7(){Ll({avatar:""}),Rl()}typeof window<"u"&&(typeof window.setAvatar!="function"&&(window.setAvatar=c7),typeof window.clearAvatar!="function"&&(window.clearAvatar=u7),typeof window.assignUserProfileState!="function"&&(window.assignUserProfileState=Ll),typeof window.persistUserProfileState!="function"&&(window.persistUserProfileState=Rl));function Rl(e={}){if(!en||typeof en.schedulePersist!="function")return;const t=typeof document<"u"?document.activeElement:null,r=t===Ao||t===Cn||t===Uo||t===zo?t:null;en.schedulePersist({announce:!!(e&&e.announce)}),NC({preserveSelectionTarget:r})}function f7(){if(!Ao)return;const e=typeof Ao.value=="string"?Ao.value:"",t=Rs();e.trim()!==t.name.trim()&&(en&&typeof en.handleFieldInput=="function"?en.handleFieldInput("name",e):Ll({name:e}),Rl())}function eF(){if(!Cn)return;const t=(typeof Cn.value=="string"?Cn.value:"").trim(),r=Rs();t!==r.role.trim()&&(DV(t),en&&typeof en.handleFieldInput=="function"?en.handleFieldInput("role",t):Ll({role:t}),Rl())}function d7(){if(!Uo)return;const e=typeof Uo.value=="string"?Uo.value:"",t=Rs();e.trim()!==t.phone.trim()&&(en&&typeof en.handleFieldInput=="function"?en.handleFieldInput("phone",e):Ll({phone:e}),Rl())}function p7(){if(!zo)return;const e=typeof zo.value=="string"?zo.value:"",t=Rs();e.trim()!==t.email.trim()&&(en&&typeof en.handleFieldInput=="function"?en.handleFieldInput("email",e):Ll({email:e}),Rl())}function wv(){en&&typeof en.handleFieldBlur=="function"&&en.handleFieldBlur()}function qV(){Rs().avatar&&(Ll({avatar:""}),Rl(),Cr(pt("avatarCleared","Profile photo removed.")),Jd(Ko)&&Ls())}function m7(){const e=Rs(),t=!!(e&&e.avatar);if(console.log("handleUserProfileAvatarButtonClick",{hasAvatar:t,profile:e}),!t&&zi&&typeof zi.click=="function")try{zi.click();return}catch{}SG({getAvatar:()=>Rs().avatar||"",getName:()=>Rs().name||Ao?.value||"",onDelete:()=>{qV()},onChange:()=>{if(zi&&typeof zi.click=="function")try{zi.click()}catch{}},onEditSave:r=>{r&&(Ll({name:Rs().name||Ao?.value||"",avatar:r}),Rl(),Cr(pt("avatarUpdated","Profile photo updated.")),Ls())}})}function g7(){if(!zi)return;const[e]=zi.files||[];e&&(sS(e,t=>{const r=Rs();Ll({name:r.name||"",avatar:t}),Rl(),Cr(pt("avatarUpdated","Profile photo updated.")),Jd(Ko)&&Ls()},t=>{Cr(t==="tooLarge"?pt("avatarTooLarge","Choose an image under 300 KB."):pt("avatarReadError","Could not read the selected image."))}),zi.value="")}function KV(e){if(!e)return;const t=e.querySelector(".person-avatar-data");if(t&&t.value)return;const r=e.querySelector(".person-name"),n=e.querySelector(".person-avatar");Eu(n,"",r?r.value:"","person-avatar-initial")}function Sm(e,t={}){if(!e)return;const{preserveSelect:r=!1}=t||{};if(delete e.dataset.contactId,!r){const n=e.querySelector(".person-contact-select");n&&(n.value="")}KL(e)}function KL(e){if(!e)return;const t=e.querySelector(".person-linked-badge");if(!t)return;const r=e.dataset.contactId,n=e.dataset.userProfileLinked==="1";if(r){const o=bG(r),a=pt("linkedBadge","Linked to contact");o&&o.name?t.textContent=`${a}: ${o.name}`:t.textContent=a,t.hidden=!1;return}if(n){t.textContent=pt("linkedProfileBadge","Linked to user profile"),t.hidden=!1;return}t.textContent=pt("linkedBadge","Linked to contact"),t.hidden=!0}function Lv(e,t=!1){if(typeof window<"u"&&window.cineSuppressAutosave||!e||e.dataset.syncingContact==="1")return;e.dataset.contactId&&(Sm(e),Cr(pt("contactDetached","Crew row disconnected from saved contact."))),KV(e),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave(t)}function tF(e,t){sS(t,r=>{mh(e,r),e.dataset.contactId&&Sm(e),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave(!0),Cr(pt("avatarUpdated","Profile photo updated.")),Jd(Ko)&&Ls()},r=>{Cr(r==="tooLarge"?pt("avatarTooLarge","Choose an image under 300 KB."):pt("avatarReadError","Could not read the selected image."))})}function Cr(e){wl(),LC&&(LC.textContent=e||"")}function vG(e,t,r={}){if(!e||!t)return;const{skipDirty:n=!1,skipAnnouncement:o=!1}=r||{},a=WV(e)||{},i=typeof bN=="function"?bN(a,t):{role:t.role||"",name:t.name||"",phone:t.phone||"",email:t.email||"",website:t.website||"",avatar:t.avatar||"",contactId:t.id||""};e.dataset.syncingContact="1";try{const s=e.querySelector('select[name="crewRole"]');if(s){if(i.role&&!Array.from(s.options).some(p=>p.value===i.role)){const p=document.createElement("option");p.value=i.role;const h=texts?.[jt]?.crewRoles||texts?.en?.crewRoles||{};p.textContent=h[i.role]||i.role,s.appendChild(p)}i.role&&(s.value=i.role)}const l=e.querySelector(".person-name");l&&(l.value=i.name||"");const c=e.querySelector(".person-phone");c&&(c.value=i.phone||"");const u=e.querySelector(".person-email");u&&(u.value=i.email||"");const f=e.querySelector(".person-website");f&&(f.value=i.website||""),mh(e,i.avatar||"",{name:i.name}),e.dataset.contactId=i.contactId||t.id;const d=e.querySelector(".person-contact-select");d&&VL(d,i.contactId||t.id)}finally{delete e.dataset.syncingContact}KL(e),!n&&typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),n||scheduleProjectAutoSave(!0),o||Cr(pt("contactApplied","Crew row updated from contact."))}function EG(e){if(!Ql||!e)return;Ql.querySelectorAll(".person-row").forEach(r=>{r.dataset.contactId===e.id&&vG(r,e,{skipAnnouncement:!0})})}function WV(e){if(!e)return null;const t=e.querySelector('select[name="crewRole"]'),r=e.querySelector(".person-name"),n=e.querySelector(".person-phone"),o=e.querySelector(".person-email"),a=e.querySelector(".person-website"),i=e.querySelector(".person-avatar-data");return{role:Hi(t?.value||""),name:Hi(r?.value||""),phone:Hi(n?.value||""),email:Hi(o?.value||""),website:Hi(a?.value||""),avatar:Hi(i?.value||""),contactId:Hi(e.dataset.contactId||"")}}function y7(e){if(!e)return;const t=wn.findIndex(r=>r.id===e);t!==-1&&(wn.splice(t,1),wn=cb(wn),lg(wn),Qu(),Nd(),Ql&&Ql.querySelectorAll(".person-row").forEach(n=>{n.dataset.contactId===e&&Sm(n)}),Cr(pt("contactDeleted","Contact removed. Project rows keep their details.")))}function h7(e){const t=WV(e);if(!t)return;if(!t.name&&!t.email&&!t.phone&&!t.website){Cr(pt("contactMissingDetails","Enter a name, email, phone number or website before saving this contact."));return}const r=Date.now();if(t.contactId){const o=bG(t.contactId);if(o){o.name=t.name||o.name,o.role=t.role||o.role,o.phone=t.phone||o.phone,o.email=t.email||o.email,o.website=t.website||o.website,t.avatar?o.avatar=t.avatar:o.avatar||delete o.avatar,o.updatedAt=r,wn=cb(wn),lg(wn),Qu({focusContactId:o.id}),Nd(),EG(o),Cr(pt("contactUpdated","Contact updated."));return}}const n=HV({id:t.contactId||hG(),name:t.name,role:t.role,phone:t.phone,email:t.email,website:t.website,avatar:t.avatar,createdAt:r,updatedAt:r});wn.push(n),wn=cb(wn),lg(wn),Qu({focusContactId:n.id}),Nd(),vG(e,n,{skipAnnouncement:!0}),Cr(pt("contactSaved","Contact saved for future projects."))}function b7(e){return d8(e,{sanitize:Hi})}function S7(e){if(!Array.isArray(e)||!e.length)return Cr(pt("importNone","No new contacts found in the file.")),{added:0,updated:0};const t=p8({existing:wn,imported:e,now:()=>Date.now(),generateContactId:hG}),{contacts:r,added:n=0,updated:o=0}=t;if(wn=Array.isArray(r)?r:wn,lg(wn),Qu(),Nd(),Array.isArray(r)&&r.forEach(a=>EG(a)),n||o){const a=pt("importSummary","{added} added, {updated} updated.");Cr(a.replace("{added}",n).replace("{updated}",o))}else Cr(pt("importNone","No new contacts found in the file."));return{added:n,updated:o}}function v7(e){const t=document.createElement("article");t.className="contact-card",t.setAttribute("role","listitem"),t.dataset.contactId=e.id;const r=document.createElement("div");r.className="contact-card-header";const n=document.createElement("div");n.className="contact-card-avatar";const o=document.createElement("div");o.className="contact-card-avatar-visual",n.appendChild(o),Eu(n,e.avatar||"",e.name,"contact-card-avatar-initial");const a=document.createElement("button");a.type="button";const i=pt("avatarChange","Change photo");a.setAttribute("aria-label",i),a.removeAttribute("title"),a.removeAttribute("data-help"),a.innerHTML="",n.appendChild(a);const s=document.createElement("input");s.type="file",s.accept="image/*",s.className="visually-hidden",s.tabIndex=-1,n.appendChild(s),r.appendChild(n);const l=document.createElement("strong");l.textContent=e.name||pt("contactFallbackName","Crew contact"),r.appendChild(l),t.appendChild(r);const c=document.createElement("div");c.className="contact-card-fields";const u=texts?.[jt]?.crewRoles||texts?.en?.crewRoles||{},f=document.createElement("input");f.type="text",f.value=e.name||"";const d=bs(f,`${e.id}-name`),p=document.createElement("label");p.setAttribute("for",d),p.textContent=pt("nameLabel","Name");const h=document.createElement("div");h.className="contact-field",h.append(p,f),c.appendChild(h);const m=document.createElement("select"),g=bs(m,`${e.id}-role`),S=document.createElement("option");if(S.value="",S.textContent=pt("rolePlaceholder","Select role"),m.appendChild(S),sg.forEach(U=>{const K=document.createElement("option");K.value=U,K.textContent=u[U]||U,m.appendChild(K)}),e.role&&!sg.includes(e.role)){const U=document.createElement("option");U.value=e.role,U.textContent=u[e.role]||e.role,m.appendChild(U)}m.value=e.role||"";const y=document.createElement("label");y.setAttribute("for",g),y.textContent=pt("roleLabel","Crew role");const E=document.createElement("div");E.className="contact-field",E.append(y,m),c.appendChild(E);const L=document.createElement("input");L.type="tel",L.value=e.phone||"";const v=bs(L,`${e.id}-phone`),A=document.createElement("label");A.setAttribute("for",v),A.textContent=pt("phoneLabel","Phone");const R=document.createElement("div");R.className="contact-field",R.append(A,L),c.appendChild(R);const I=document.createElement("input");I.type="email",I.value=e.email||"";const C=bs(I,`${e.id}-email`),k=document.createElement("label");k.setAttribute("for",C),k.textContent=pt("emailLabel","Email");const _=document.createElement("div");_.className="contact-field",_.append(k,I),c.appendChild(_);const w=document.createElement("input");w.type="url",w.inputMode="url",w.autocomplete="url",w.value=e.website||"",w.placeholder=pt("websitePlaceholder","https://example.com");const x=bs(w,`${e.id}-website`),G=document.createElement("label");G.setAttribute("for",x),G.textContent=pt("websiteLabel","Website");const T=document.createElement("div");T.className="contact-field",T.append(G,w),c.appendChild(T),t.appendChild(c);const P=document.createElement("div");P.className="contact-card-actions";const N=document.createElement("button");N.type="button",rt(N,pt("useInProject","Add to project crew"),ICON_GLYPHS.add),N.addEventListener("click",()=>{AG({...e,contactId:e.id}),xu(ji),Cr(pt("contactAddedToProject","Contact added to the current project."))}),P.appendChild(N);const q=document.createElement("button");q.type="button",rt(q,pt("deleteContact","Delete contact"),ICON_GLYPHS.trash),q.addEventListener("click",()=>{const U=pt("deleteConfirm","Remove this contact? Project rows will keep their details."),K=()=>y7(e.id);if(typeof window.cineShowConfirmDialog=="function"){window.cineShowConfirmDialog({title:pt("deleteContact","Delete contact"),message:U,confirmLabel:pt("deleteButton","Delete")||"Delete",cancelLabel:pt("cancel","Cancel")||"Cancel",danger:!0,onConfirm:K});return}console.warn("Missing window.cineShowConfirmDialog for delete contact")}),P.appendChild(q),t.appendChild(P);const Z=(U=!1)=>{e.updatedAt=Date.now(),lg(wn),Nd(),EG(e),U&&(wn=cb(wn),Qu({focusContactId:e.id}))};return f.addEventListener("input",()=>{e.name=Hi(f.value),l.textContent=e.name||pt("contactFallbackName","Crew contact"),Eu(n,e.avatar||"",e.name,"contact-card-avatar-initial"),Z()}),f.addEventListener("blur",U=>{const K=U?.relatedTarget||(typeof document<"u"?document.activeElement:null);if(K&&K!==f&&t.contains(K)){Z();return}Z(!0)}),m.addEventListener("change",()=>{e.role=Hi(m.value),Z()}),L.addEventListener("input",()=>{e.phone=Hi(L.value),Z()}),I.addEventListener("input",()=>{e.email=Hi(I.value),Z()}),w.addEventListener("input",()=>{e.website=Hi(w.value),Z()}),a.addEventListener("click",()=>{if(!e.avatar&&s&&typeof s.click=="function")try{s.click();return}catch{}SG({getAvatar:()=>e.avatar||"",getName:()=>e.name||"",onDelete:()=>{e.avatar&&(e.avatar="",Eu(n,"",e.name,"contact-card-avatar-initial"),Z(),Cr(pt("avatarCleared","Profile photo removed.")))},onChange:()=>{if(s&&typeof s.click=="function")try{s.click()}catch{}},onEditSave:U=>{U&&(e.avatar=U,Eu(n,U,e.name,"contact-card-avatar-initial"),Z(),Cr(pt("avatarUpdated","Profile photo updated.")))}})}),s.addEventListener("change",()=>{const[U]=s.files||[];U&&(sS(U,K=>{e.avatar=K,Eu(n,K,e.name,"contact-card-avatar-initial"),Z(),Cr(pt("avatarUpdated","Profile photo updated.")),Jd(Ko)&&Ls()},K=>{Cr(K==="tooLarge"?pt("avatarTooLarge","Choose an image under 300 KB."):pt("avatarReadError","Could not read the selected image."))}),s.value="")}),{card:t,focusTarget:f}}function Qu(e={}){if(wl(),!Rc)return;const{focusContactId:t=null}=e||{};for(;Rc.firstChild;)Rc.removeChild(Rc.firstChild);if(!wn.length){Iu&&(Iu.hidden=!1);return}Iu&&(Iu.hidden=!0);let r=null;wn.forEach(n=>{const{card:o,focusTarget:a}=v7(n);Rc.appendChild(o),t&&n.id===t&&(r=a)}),r&&requestAnimationFrame(()=>r.focus())}function YV(e,t){if(!e)return;const r=a=>{a.preventDefault(),a.stopPropagation(),e.classList.add("avatar-drag-over")},n=a=>{a.preventDefault(),a.stopPropagation(),e.classList.remove("avatar-drag-over")},o=a=>{a.preventDefault(),a.stopPropagation(),e.classList.remove("avatar-drag-over");const i=a.dataTransfer&&a.dataTransfer.files&&a.dataTransfer.files[0];i&&t(i)};e.addEventListener("dragenter",r),e.addEventListener("dragover",r),e.addEventListener("dragleave",n),e.addEventListener("drop",o)}function QV(){console.log("initializeContactsModule called"),wl(),!(QN&&Rc&&ol)&&(console.log("initializeContactsModule running (re-init or first run)"),wn=VX(),l7(),_V(),Qu(),Nd(),NC(),console.log("userProfileAvatarButton found (first-run):",!!ol),Ao&&(Ao.addEventListener("input",f7),Ao.addEventListener("blur",wv)),Cn&&(Cn.addEventListener("input",eF),Cn.addEventListener("change",eF),Cn.addEventListener("blur",wv)),Uo&&(Uo.addEventListener("input",d7),Uo.addEventListener("blur",wv)),zo&&(zo.addEventListener("input",p7),zo.addEventListener("blur",wv)),ol&&ol.addEventListener("click",m7),Zl&&Zl.addEventListener("click",qV),zi&&zi.addEventListener("change",g7),og&&YV(og,e=>{sS(e,t=>{const r=Rs();Ll({name:r.name||"",avatar:t}),Rl(),Cr(pt("avatarUpdated","Profile photo updated.")),Jd(Ko)&&Ls()},t=>{Cr(t==="tooLarge"?pt("avatarTooLarge","Choose an image under 300 KB."):pt("avatarReadError","Could not read the selected image."))})}),gd&&gd.addEventListener("click",()=>{const e=HV({id:hG(),name:"",role:"",phone:"",email:"",avatar:"",createdAt:Date.now(),updatedAt:Date.now()});wn.push(e),Qu({focusContactId:e.id}),lg(wn),Nd(),Cr(pt("contactDraftCreated","New contact ready. Fill in the details."))}),yd&&Bf&&(yd.addEventListener("click",()=>Bf.click()),Bf.addEventListener("change",()=>{const[e]=Bf.files||[];e&&e.text().then(t=>S7(b7(t))).catch(()=>{Cr(pt("importError","Could not import the selected file."))}).finally(()=>{Bf.value=""})})),Qf?.addEventListener("click",()=>Ls()),bm?.addEventListener("submit",e=>e.preventDefault()),Ko?.addEventListener("cancel",e=>{e.preventDefault(),Ls()}),Ko?.addEventListener("close",YX),Ko?.addEventListener("pointerdown",ZN),Ko?.addEventListener("pointerdown",ZN),qt&&(qt.addEventListener("dragenter",JN),qt.addEventListener("dragover",JN),qt.addEventListener("dragleave",a7),qt.addEventListener("drop",o7),qt.addEventListener("click",()=>ph&&ph.click()),qt.addEventListener("pointerdown",JX),qt.addEventListener("pointermove",ZX),qt.addEventListener("pointerup",e7),qt.addEventListener("pointercancel",t7),qt.addEventListener("keydown",r7)),ph?.addEventListener("change",i7),TI?.addEventListener("click",s7),OI?.addEventListener("click",()=>Ls()),ig?.addEventListener("input",XN),ig?.addEventListener("change",XN),lb?.addEventListener("click",()=>xu(ji)),LI?.addEventListener("submit",e=>{e.preventDefault(),xu(ji)}),ji?.addEventListener("cancel",e=>{e.preventDefault(),xu(ji)}),ji?.addEventListener("click",e=>{e.target===ji&&xu(ji)}),RI?.addEventListener("click",e=>{e.preventDefault(),lS(ji)}),Rc&&ol&&(QN=!0))}function AG(e={}){if(Ql||typeof document<"u"&&(Ql=document.getElementById("crewContainer")),!Ql)return;const t=document.createElement("div");t.className="person-row",e.userProfileLinked&&(t.dataset.userProfileLinked="1");let r="";typeof document<"u"&&document&&document.documentElement&&(r=document.documentElement.lang||"");const n=r||jt||oo,o=rV(n);gs(t,n,o);const a=typeof texts<"u"&&texts?.en?.projectForm||{},i=typeof texts<"u"&&texts?.[jt]?.projectForm||a,s=typeof texts<"u"&&(texts?.[jt]?.crewRoles||texts?.en?.crewRoles)||{},l=i.crewRoleLabel||a.crewRoleLabel||"Crew role",c=i.crewNameLabel||a.crewNameLabel||"Crew member name",u=i.crewPhoneLabel||a.crewPhoneLabel||"Crew member phone",f=i.crewEmailLabel||a.crewEmailLabel||"Crew member email",d=i.crewWebsiteLabel||a.crewWebsiteLabel||"Crew member website",p=pt("selectLabel","Saved contacts"),h=pt("avatarChange","Change photo"),m=document.createElement("input");m.type="hidden",m.className="person-avatar-data",m.value=typeof e.avatar=="string"?e.avatar:"",t.appendChild(m);const g=document.createElement("div");g.className="person-avatar";const S=document.createElement("div");S.className="person-avatar-visual",g.appendChild(S);const y=document.createElement("button");y.type="button",y.setAttribute("aria-label",h),y.removeAttribute("title"),y.removeAttribute("data-help"),y.innerHTML="",g.appendChild(y);const E=document.createElement("input");E.type="file",E.accept="image/*",E.className="visually-hidden",E.tabIndex=-1,g.appendChild(E),YV(g,re=>{tF(t,re)});const L=document.createElement("select");if(L.name="crewRole",L.className="person-role-select",gs(L,n,o),sg.forEach(re=>{const fe=document.createElement("option");fe.value=re,fe.textContent=s[re]||re,gs(fe,n,o),L.appendChild(fe)}),e.role&&!sg.includes(e.role)){const re=document.createElement("option");re.value=e.role,re.textContent=s[e.role]||e.role,gs(re,n,o),L.appendChild(re)}e.role?L.value=e.role:L.options.length>0&&(L.selectedIndex=0);const v=document.createElement("input");v.type="text",v.name="crewName",v.className="person-name",v.placeholder=i.crewNamePlaceholder||a.crewNamePlaceholder||"Name",v.value=e.name||"",gs(v,n,o);const A=document.createElement("input");A.type="tel",A.name="crewPhone",A.className="person-phone",A.placeholder=i.crewPhonePlaceholder||a.crewPhonePlaceholder||"Phone",A.value=e.phone||"",gs(A,n,o);const R=document.createElement("input");R.type="email",R.name="crewEmail",R.className="person-email",R.placeholder=i.crewEmailPlaceholder||a.crewEmailPlaceholder||"Email",R.value=e.email||"",gs(R,n,o);const I=document.createElement("input");I.type="text",I.inputMode="url",I.autocomplete="url",I.name="crewWebsite",I.className="person-website",I.placeholder=i.crewWebsitePlaceholder||a.crewWebsitePlaceholder||"Website",I.value=e.website||"",gs(I,n,o);const C=document.createElement("select");C.className="person-contact-select",gs(C,n,o),VL(C,e.contactId);const k=Tf(bs(L,l),l),_=Tf(bs(v,c),c),w=Tf(bs(A,u),u),x=Tf(bs(R,f),f),G=Tf(bs(I,d),d),T=Tf(bs(C,p),p),P=document.createElement("span");P.className="person-linked-badge",e.userProfileLinked?(P.textContent=pt("linkedProfileBadge","Linked to user profile"),P.hidden=!1):(P.textContent=pt("linkedBadge","Linked to contact"),P.hidden=!0);const N=document.createElement("button");N.type="button",N.className="person-save-contact",rt(N,pt("saveContact","Save to contacts"),ICON_GLYPHS.save),N.addEventListener("click",()=>h7(t));const q=document.createElement("button");q.type="button",q.className="person-manage-contacts",rt(q,pt("openManager","Open contacts"),ICON_GLYPHS.gears),q.addEventListener("click",()=>lS(ji));const Z=document.createElement("button");Z.type="button",Z.className="person-remove-btn";const U=texts[jt]?.projectForm?.removeEntry||texts.en?.projectForm?.removeEntry||"Remove",K=texts[jt]?.projectForm?.crewHeading||texts.en?.projectForm?.crewHeading||"Crew",H=`${U} ${K}`.trim();Z.innerHTML=Jc(ICON_GLYPHS.minus,"btn-icon"),Z.setAttribute("aria-label",H),Z.setAttribute("title",H),Z.setAttribute("data-help",H),Z.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()});const te=document.createElement("div");te.className="person-actions",te.append(N,q,Z),[k,_,w,x,G,T].forEach(re=>t.appendChild(re)),t.appendChild(g),t.appendChild(C),t.appendChild(P),t.appendChild(L),t.appendChild(v),t.appendChild(A),t.appendChild(R),t.appendChild(I),t.appendChild(te),e.contactId&&(t.dataset.contactId=e.contactId),mh(t,m.value,{name:e.name}),KL(t),y.addEventListener("click",()=>{if(!m.value&&E&&typeof E.click=="function")try{E.click();return}catch{}SG({getAvatar:()=>m.value||"",getName:()=>v.value||"",onDelete:()=>{m.value&&(mh(t,""),Lv(t),Cr(pt("avatarCleared","Profile photo removed.")))},onChange:()=>{if(E&&typeof E.click=="function")try{E.click()}catch{}},onEditSave:re=>{re&&(mh(t,re,{name:v.value}),t.dataset.contactId&&Sm(t),Lv(t),Cr(pt("avatarUpdated","Profile photo updated.")))}})}),E.addEventListener("change",()=>{const[re]=E.files||[];re&&tF(t,re),E.value=""}),L.addEventListener("change",()=>Lv(t,!1)),v.addEventListener("input",()=>{KV(t)}),C.addEventListener("change",()=>{const re=C.value;if(!re){Sm(t,{preserveSelect:!0}),Lv(t);return}const fe=bG(re);fe?vG(t,fe):(Cr(pt("contactMissingDetails","Saved contact not available.")),Sm(t,{preserveSelect:!0}))}),Ql.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}typeof window<"u"&&(window.createCrewRow=AG);function E7(e={}){if(!UN)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="prepStart",r.className="prep-start",r.value=e.start||"",r.setAttribute("aria-labelledby","prepLabel");const n=document.createElement("span");n.textContent="to";const o=document.createElement("input");o.type="date",o.name="prepEnd",o.className="prep-end",o.value=e.end||"",o.setAttribute("aria-labelledby","prepLabel");const a=document.createElement("button");a.type="button";const i=texts[jt]?.projectForm?.removeEntry||texts.en?.projectForm?.removeEntry||"Remove",s=texts[jt]?.projectForm?.prepLabel||texts.en?.projectForm?.prepLabel||"Prep",l=`${i} ${s}`.trim();a.innerHTML=Jc(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",l),a.setAttribute("title",l),a.setAttribute("data-help",l),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,n,o,a),UN.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function A7(e={}){if(!zN)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="shootStart",r.className="shoot-start",r.value=e.start||"",r.setAttribute("aria-labelledby","shootLabel");const n=document.createElement("span");n.textContent="to";const o=document.createElement("input");o.type="date",o.name="shootEnd",o.className="shoot-end",o.value=e.end||"",o.setAttribute("aria-labelledby","shootLabel");const a=document.createElement("button");a.type="button";const i=texts[jt]?.projectForm?.removeEntry||texts.en?.projectForm?.removeEntry||"Remove",s=texts[jt]?.projectForm?.shootLabel||texts.en?.projectForm?.shootLabel||"Shoot",l=`${i} ${s}`.trim();a.innerHTML=Jc(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",l),a.setAttribute("title",l),a.setAttribute("data-help",l),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,n,o,a),zN.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function C7(e={}){if(!$N)return;const t=document.createElement("div");t.className="period-row";const r=document.createElement("input");r.type="date",r.name="returnStart",r.className="return-start",r.value=e.start||"",r.setAttribute("aria-labelledby","returnLabel");const n=document.createElement("span");n.textContent="to";const o=document.createElement("input");o.type="date",o.name="returnEnd",o.className="return-end",o.value=e.end||"",o.setAttribute("aria-labelledby","returnLabel");const a=document.createElement("button");a.type="button";const i=texts[jt]?.projectForm?.removeEntry||texts.en?.projectForm?.removeEntry||"Remove",s=texts[jt]?.projectForm?.returnLabel||texts.en?.projectForm?.returnLabel||"Return Day",l=`${i} ${s}`.trim();a.innerHTML=Jc(ICON_GLYPHS.minus,"btn-icon"),a.setAttribute("aria-label",l),a.setAttribute("title",l),a.setAttribute("data-help",l),a.addEventListener("click",()=>{t.remove(),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),scheduleProjectAutoSave()}),t.append(r,n,o,a),$N.appendChild(t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()}function FT(e,t){const r=Number(e);return!Number.isFinite(r)||r<=0?"":`${Number.isInteger(r)?String(r):r.toLocaleString(void 0,{maximumFractionDigits:2,minimumFractionDigits:0})} ${t}`}function w7(e){const t=[];if(!e)return t;const r=devices?.cameras||{},n=typeof Dd?.value=="string"?Dd.value:"",o=a=>{!a||!Array.isArray(a.recordingMedia)||a.recordingMedia.forEach(i=>{i&&i.type===e&&t.push(i)})};return n&&r[n]&&o(r[n]),Object.keys(r).forEach(a=>{a!==n&&o(r[a])}),t}function XV(){const e=devices?.cameras||{},t=devices?.gearList?.media||{},r=[],n=new Set,o=l=>{if(!l||typeof l!="string")return;const c=l.trim();if(!c)return;const u=c.toLowerCase();n.has(u)||(n.add(u),r.push(c))},a=typeof Dd?.value=="string"?Dd.value:"";if(a&&e[a])return(e[a].recordingMedia||[]).forEach(c=>{c&&c.type&&o(c.type)}),r;const i=l=>{l&&(l.recordingMedia||[]).forEach(c=>{c&&c.type&&o(c.type)})};Object.values(e).forEach(l=>i(l));const s=l=>{Object.values(l).forEach(c=>{if(c)if(c.brand||c.model||c.type||c.capacityGB||c.capacity){c.type&&o(c.type);const u=typeof c.interface=="string"?c.interface.trim():"";u&&o(u),Array.isArray(c.supportedMedia)&&c.supportedMedia.forEach(f=>o(f))}else typeof c=="object"&&s(c)})};return s(t),r.sort(localeSort)}function JV(e){const t=[];if(!e)return t;const r=e.toLowerCase(),n=[],o=devices?.gearList?.media||{},a=c=>{Object.entries(c).forEach(([u,f])=>{f&&(f.brand||f.model||f.type||f.capacityGB||f.capacity?n.push({id:u,...f}):typeof f=="object"&&a(f))})};a(o);const i=new Set,s=(c,u)=>{if(!c||i.has(c))return;const f=(u||c).toLowerCase();f.includes("dual slots")||f.includes("slot 1")||f==="adapter"||f.includes("via adapter")||f==="red pro"||/\d/.test(f)&&(t.push({value:c,label:u||c}),i.add(c))};n.forEach(c=>{let u=!1;if(c.type&&(u=c.type.toLowerCase()===r),u||(u=[c.id,c.model,c.interface].some(S=>typeof S=="string"&&S.toLowerCase().includes(r))),!u)return;const f=[];c.brand&&f.push(c.brand);const d=c.model||"";d&&(!c.brand||d.toLowerCase()!==c.brand.toLowerCase())&&f.push(d);const p=Number(c.capacityGB||c.capacity),h=Number(c.capacityTb);let m="";Number.isFinite(p)&&p>0?p>=1e3?m=FT(p/1e3,"TB"):m=FT(p,"GB"):Number.isFinite(h)&&h>0&&(m=FT(h,"TB")),m&&f.push(m),s(c.id,f.length?f.join("  "):c.id)});const l=new Set;return w7(e).forEach(c=>{const u=typeof c?.notes=="string"?c.notes:"";u&&u.split(/[,;/]/).forEach(f=>{const d=f.trim();d&&l.add(d)})}),l.forEach(c=>{const u=`${e} ${c}`.trim();s(u,c)}),t.length||s(e,e),t.sort((c,u)=>localeSort(c.label,u.label))}function L7(e,t,r){if(!e)return;const n=JV(t),o=FV("storageVariantPlaceholder","Select brand & size"),a=r!==void 0?r:e.value;e.innerHTML="";const i=document.createElement("option");if(i.value="",i.textContent=o,e.appendChild(i),n.forEach(s=>{const l=document.createElement("option");l.value=s.value,l.textContent=s.label,e.appendChild(l)}),a){if(!(e.options&&Array.from(e.options).some(l=>l.value===a))){const l=document.createElement("option");l.value=a,l.textContent=a,l.dataset.extraOption="true",e.appendChild(l)}e.value=a}else e.value=""}function ZV(){if(!VN)return;const e=XV(),t=FV("storageTypePlaceholder","Select media type");Array.from(VN.querySelectorAll(".storage-row")).forEach(r=>{const n=r.querySelector(".storage-type"),o=r.querySelector(".storage-variant");if(!n)return;const a=n.value,i=o?o.value:"";n.innerHTML="";const s=document.createElement("option");if(s.value="",s.textContent=t,n.appendChild(s),e.forEach(l=>{const c=document.createElement("option");c.value=l,c.textContent=l,n.appendChild(c)}),a){if(!e.includes(a)){const c=document.createElement("option");c.value=a,c.textContent=a,c.dataset.extraOption="true",n.appendChild(c)}n.value=a}else n.value="";L7(o,n.value,i)})}typeof window<"u"&&(window.getAvailableStorageMediaTypes=XV,window.getStorageVariantOptions=JV,window.updateStorageRequirementTypeOptions=ZV);function R7(e){const t=document.getElementById("requiredScenarios");if(!t)return;const n=(texts[e]||{}).scenarios||{},o=texts.en&&texts.en.scenarios?texts.en.scenarios:{};t.options&&Array.from(t.options).forEach(a=>{const i=a.value,s=n[i]||o[i]||a.value;a.textContent=s})}function T7(e,t){const r=e.storageHeading||t.storageHeading||"Storage & Media";CI&&(CI.textContent=r);const n=e.storageNeedsLabel||t.storageNeedsLabel||"Recording media needs:";wI&&(wI.textContent=n);const o=f=>{const d=e[f]||t[f];d&&document.querySelectorAll(`#storageNeedsContainer [data-storage-label-key="${f}"]`).forEach(p=>{p.textContent=d})};["storageQuantityLabel","storageTypeLabel","storageVariantLabel","storageNotesLabel"].forEach(o);const a=e.storageTypePlaceholder||t.storageTypePlaceholder||"Select media type",i=e.storageVariantPlaceholder||t.storageVariantPlaceholder||"Select brand & size",s=e.storageNotesPlaceholder||t.storageNotesPlaceholder||"",l=e.storageDuplicateEntry||t.storageDuplicateEntry||"Duplicate media row",c=e.removeEntry||t.removeEntry||"Remove";document.querySelectorAll("#storageNeedsContainer .storage-type").forEach(f=>{if(!f.options)return;const d=f.options[0];d&&(d.textContent=a)}),document.querySelectorAll("#storageNeedsContainer .storage-variant").forEach(f=>{if(!f.options)return;const d=f.options[0];d&&(d.textContent=i)}),document.querySelectorAll("#storageNeedsContainer .storage-notes").forEach(f=>{f.placeholder=s}),document.querySelectorAll('#storageNeedsContainer [data-storage-action-key="storageDuplicateEntry"]').forEach(f=>{f.setAttribute("aria-label",l),f.setAttribute("title",l),f.setAttribute("data-help",l)});const u=`${c} ${n}`.trim();document.querySelectorAll('#storageNeedsContainer [data-storage-action-key="storageRemoveEntry"]').forEach(f=>{f.setAttribute("aria-label",u),f.setAttribute("title",u),f.setAttribute("data-help",u)})}Vp&&Vp.addEventListener("click",()=>{AG()});qp&&qp.addEventListener("click",()=>E7());Kp&&Kp.addEventListener("click",()=>A7());Wp&&Wp.addEventListener("click",()=>C7());document.getElementById("totalPower")||document.getElementById("heroTotalDraw");document.getElementById("totalCurrent144")||document.getElementById("heroCurrent144");document.getElementById("totalCurrent12")||document.getElementById("heroCurrent12");document.getElementById("batteryLife")||document.getElementById("heroRuntime");var Qg=document.getElementById("batteryLifeLabel"),Rv=document.getElementById("runtimeAverageNote");document.getElementById("batteryCount")||document.getElementById("heroBatteryCount");var Tv=document.getElementById("pinWarning"),Ov=document.getElementById("dtapWarning"),xv=document.getElementById("hotswapWarning"),Au=document.getElementById("powerWarningDialog"),kv=document.getElementById("powerWarningTitle");document.getElementById("powerWarningMessage");var Iv=document.getElementById("powerWarningLimitsHeading");document.getElementById("powerWarningPinsDetail");document.getElementById("powerWarningDtapDetail");var Pv=document.getElementById("powerWarningAdvice"),Qp=document.getElementById("powerWarningCloseBtn"),jT=document.getElementById("heroCard"),gf=document.getElementById("heroTotalDraw"),rF=document.getElementById("heroAvailablePower"),nF=document.getElementById("heroBatteryLabel");document.getElementById("heroRuntime");document.getElementById("heroCurrent144");document.getElementById("heroCurrent12");document.getElementById("heroBatteryCount");var up=document.getElementById("powerDiagram"),yf=document.getElementById("powerDiagramBar"),Xg=document.getElementById("maxPowerText"),fp=document.getElementById("powerDiagramLegend");function O7(){}function x7(e={}){Au&&(Jd(Au)?xu(Au):Au.removeAttribute&&Au.removeAttribute("open"),e.keepDismissed)}function eq(){Au&&x7({keepDismissed:!0})}Qp&&Qp.addEventListener("click",eq);Au&&Au.addEventListener("cancel",e=>{e.preventDefault(),eq()});function k7(e,t,r){const n=(t||[]).reduce((a,i)=>a+i.power,0);if(gf&&(gf.textContent=`${n.toFixed(0)} W`),!jT)return;if(!e||e<=0){jT.classList.add("hidden"),up&&up.classList.add("hidden"),yf&&(yf.innerHTML=""),fp&&(fp.innerHTML=""),Xg&&(Xg.textContent="",g9(Xg));return}jT.classList.remove("hidden"),up&&up.classList.remove("hidden"),yf&&(yf.innerHTML=""),fp&&(fp.innerHTML="");const o=n/e;if(gf&&(gf.classList.remove("glow-safe","glow-warning","glow-danger"),o>1?gf.classList.add("glow-danger"):o>=.8?gf.classList.add("glow-warning"):gf.classList.add("glow-safe")),rF&&(rF.textContent=`${e.toFixed(0)} W`),nF&&qy&&qy.options){const a=qy.options[qy.selectedIndex],i=a?a.text:"";nF.textContent=`Camera Setup draws ${n.toFixed(0)}W from the ${e.toFixed(0)}W available on the ${i}`}if(yf&&fp){const a=100/Math.max(e,n),i=e*a,s=document.createElement("div");if(s.className="power-bar-inner",yf.appendChild(s),t.forEach(c=>{const u=c.power*a;if(u<=0)return;const f=document.createElement("div");f.className=`segment ${c.className}`,f.style.width=`${u}%`,f.setAttribute("title",`${c.label} ${c.power.toFixed(1)} W`),s.appendChild(f);const d=document.createElement("span"),p=document.createElement("span");p.className=`swatch ${c.className}`,d.appendChild(p),d.appendChild(document.createTextNode(c.label.replace(/:$/,""))),fp.appendChild(d)}),n>e){const c=document.createElement("div");c.className="over-usage",c.style.left=`${i}%`,c.style.right="0",s.appendChild(c)}const l=document.createElement("div");if(l.className="limit-line",l.style.left=`${i}%`,typeof r=="number"&&r>0){const c=document.createElement("span");c.className="limit-label",c.textContent=`${texts[jt].pinLabel} ${r} A`,l.appendChild(c)}yf.appendChild(l),up&&up.classList.toggle("over",n>e)}Xg&&(Xg.textContent="")}var jl=document.getElementById("setupSelect"),Cu=document.getElementById("setupName"),I7=document.getElementById("saveSetupBtn"),Bv=document.getElementById("deleteSetupBtn"),HT=document.getElementById("shareSetupBtn");document.getElementById("sharedLinkRow");document.getElementById("sharedLinkInput");document.getElementById("shareLinkMessage");document.getElementById("shareDialog");document.getElementById("shareForm");const UT=document.getElementById("shareDialogHeading");var oF=document.getElementById("shareFilename");const zT=document.getElementById("shareFilenameLabel");var P7=document.getElementById("shareFilenameMessage"),Jg=document.getElementById("shareCancelBtn");const dp=document.getElementById("shareConfirmBtn"),$T=document.getElementById("shareIncludeAutoGearText");var VT=document.getElementById("shareIncludeAutoGearLabel");const qT=document.getElementById("shareIncludeOwnedGearText");var KT=document.getElementById("shareIncludeOwnedGearLabel"),aF=document.getElementById("shareIncludeAutoGear"),iF=document.getElementById("shareIncludeOwnedGear");oF&&P7&&oF.setAttribute("aria-describedby","shareFilenameMessage");document.getElementById("sharedImportDialog");document.getElementById("sharedImportForm");const WT=document.getElementById("sharedImportDialogHeading"),Gv=document.getElementById("sharedImportDialogMessage");document.getElementById("sharedImportMetadata");const sF=document.getElementById("sharedImportOptions"),Zg=document.getElementById("sharedImportLegend");var gh=document.getElementById("sharedImportModeSelect");const pp=document.getElementById("sharedImportModeNoneOption"),mp=document.getElementById("sharedImportModeProjectOption"),gp=document.getElementById("sharedImportModeGlobalOption"),Mv=document.getElementById("sharedImportConfirmBtn");var _v=document.getElementById("sharedImportCancelBtn");gh&&Array.from(gh.options||[]).forEach(e=>{e.value!=="none"&&(e.disabled=!0)});jl&&jl.value;var yp=document.getElementById("applySharedLinkBtn");const yh={setupName:"s",camera:"c",monitor:"m",video:"v",cage:"g",motors:"o",controllers:"r",distance:"d",batteryPlate:"p",battery:"b",batteryHotswap:"h",powerSelection:"w",projectInfo:"i",projectHtml:"q",gearSelectors:"e",gearList:"l",ownedGearMarkers:"u",changedDevices:"x",feedback:"f",autoGearRules:"a",autoGearCoverage:"z",diagramPositions:"y",metadata:"t",contacts:"n"},Xp=Object.keys(yh),YT=Object.prototype.hasOwnProperty;function tq(e){if(!e||typeof e!="object")return{};const t={};for(let r=0;r<Xp.length;r+=1){const n=Xp[r];if(n==="gearList"||n==="projectHtml")continue;const o=e[n];o!=null&&(t[yh[n]]=o)}return t}function rq(e){if(!e||typeof e!="object")return{};let t=!1,r=!1;const n=[];for(let a=0;a<Xp.length;a+=1){const i=Xp[a],s=yh[i],l=YT.call(e,i),c=YT.call(e,s);l&&(t=!0),c&&(r=!0,!l&&e[s]!=null&&n.push(i))}if(!t&&!r)return{};if(!t){const a={};for(let i=0;i<Xp.length;i+=1){const s=Xp[i],l=yh[s],c=e[l];c!=null&&(a[s]=c)}return a}if(!n.length)return e;const o={...e};for(let a=0;a<n.length;a+=1){const i=n[a];if(!YT.call(o,i)){const s=yh[i],l=e[s];l!=null&&(o[i]=l)}}return o}var QT=typeof QT<"u"&&QT?QT:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("device-manager"):null,XT=typeof XT<"u"&&XT?XT:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("toggleDeviceManager"):null;const FC=(()=>{const e=typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null;if(e&&e.deviceManagerLists&&e.deviceManagerLists instanceof Map)return e.deviceManagerLists;const t=new Map;if(e&&typeof e=="object")try{e.deviceManagerLists=t}catch{e.deviceManagerLists=t}return t})();var hd=typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null;function B7(e,t){if(!e||typeof e!="object")return;const r=(t||"").toLowerCase();Array.from(e.options||[]).forEach(n=>{if(!n||typeof n!="object")return;const o=n.value==="None"||r===""||(n.textContent||"").toLowerCase().includes(r);n.hidden=!o,n.disabled=!o})}function nq(e,t){if(!e||typeof e!="object")return;const r=(t||"").toLowerCase();Array.from(e.querySelectorAll?e.querySelectorAll("li"):[]).forEach(n=>{if(!n||typeof n!="object")return;const o=n.querySelector?n.querySelector(".device-summary span"):null,a=o&&typeof o.textContent=="string"?o.textContent.toLowerCase():"";n.style.display=r===""||a.includes(r)?"":"none"})}function oq(e,t){if(!e||typeof e!="object"||typeof e.insertAdjacentElement!="function")return;const r=typeof texts=="object"&&texts||typeof window<"u"&&typeof window.texts=="object"&&window.texts||null,n=r&&r[jt]&&r[jt].clearFilter||"Clear filter",o=document.createElement("button");o.type="button",o.className="clear-input-btn",o.innerHTML=Jc(ICON_GLYPHS.circleX,"clear-icon"),o.setAttribute("aria-label",n),o.title=n,o.hidden=!0,o.addEventListener("click",()=>{e.value="",typeof t=="function"&&t(),typeof e.focus=="function"&&e.focus()}),e.insertAdjacentElement("afterend",o);const a=()=>{o.hidden=!e.value};e.addEventListener("input",a),a()}function G7(e,t){if(!e||typeof e!="object")return;const r=typeof t=="function"?t:()=>{};e.addEventListener("input",r),e.addEventListener("keydown",n=>{n&&n.key==="Escape"&&(e.value="",r())}),oq(e,r)}function aq(){const e=hd&&typeof hd=="object"?hd:{},t=(r,n)=>{if(typeof e[r]!="function")try{e[r]=n}catch{try{Object.defineProperty(e,r,{configurable:!0,writable:!0,value:n})}catch{}}};return t("filterSelect",B7),t("filterDeviceList",nq),t("bindFilterInput",G7),t("addInputClearButton",oq),e}aq();function M7(){const e=aq(),t=typeof e.filterDeviceList=="function"?e.filterDeviceList:nq;FC instanceof Map&&FC.forEach(r=>{if(!r||typeof r!="object")return;const{list:n,filterInput:o}=r;if(!n||typeof n!="object")return;const a=o&&typeof o.value=="string"?o.value:"";try{t(n,a)}catch(i){console.warn("Failed to apply device manager filters",i)}})}const _7=Object.freeze(["cameras","viewfinders","monitors","video","wirelessReceivers","directorMonitors","iosVideo","lenses","fiz.motors","fiz.controllers","fiz.handUnits","fiz.distance","batteries","batteryHotswaps","accessories.batteries","accessories.powerPlates","accessories.cables","accessories.cages","accessories.cameraSupport","accessories.cameraStabiliser","accessories.chargers","accessories.videoAssist","accessories.media","accessories.cardReaders","accessories.filters","accessories.matteboxes","accessories.rigging","accessories.grip","accessories.sliders","accessories.tripodHeads","accessories.tripods","accessories.carts"]);function D7(){const e=hd,t=e&&Array.isArray(e.deviceManagerPreferredOrder)?e.deviceManagerPreferredOrder:null;return t&&t.every(r=>typeof r=="string"&&r)?t:_7}function N7(e){return!e||e==="accessories"||e==="fiz"||e==="filterOptions"?null:e.startsWith("accessories.cables.")?"accessories.cables":e==="videoAssist"&&devices?.accessories?.videoAssist?"accessories.videoAssist":e==="media"&&devices?.accessories?.media?"accessories.media":e==="cardReaders"&&devices?.accessories?.cardReaders?"accessories.cardReaders":e}function hh(e,t=jt){if(!e)return"";const r=typeof categoryNames=="object"&&categoryNames&&categoryNames[t]||{};if(r[e])return r[e];const n=typeof categoryNames=="object"&&categoryNames&&categoryNames.en||{};return n[e]?n[e]:e==="batteries"||e==="accessories.batteries"?t==="en"?"Battery":t==="de"?"Akku":"Battery":e.split(".").map(a=>N6(a)).join(" ")}function F7(){const e=new Set,t=s=>{const l=N7(s);l&&e.add(l)},r=(s,l=[])=>{if(!(l.length>20)&&!(!s||typeof s!="object")){if(Array.isArray(s.attributes)){const c=l.length,u=l[0];(c===1||c>1&&(u==="accessories"||u==="fiz"))&&t(l.join("."))}Object.entries(s).forEach(([c,u])=>{c!=="attributes"&&u&&typeof u=="object"&&r(u,l.concat(c))})}};Hn&&r(Hn,[]),(s=>{!s||typeof s!="object"||Array.isArray(s)||Object.entries(s).forEach(([l,c])=>{l==="accessories"?c&&typeof c=="object"&&Object.entries(c).forEach(([u,f])=>{f&&typeof f=="object"&&!Array.isArray(f)&&t(`accessories.${u}`)}):l==="fiz"?c&&typeof c=="object"&&Object.entries(c).forEach(([u,f])=>{f&&typeof f=="object"&&!Array.isArray(f)&&t(`fiz.${u}`)}):c&&typeof c=="object"&&!Array.isArray(c)&&t(l)})})(devices);const o=Array.from(e),a=D7(),i=new Map(a.map((s,l)=>[s,l]));return o.sort((s,l)=>{const c=i.has(s)?i.get(s):a.length,u=i.has(l)?i.get(l):a.length;return c!==u?c-u:s.localeCompare(l)}),o}function j7(e=jt){if(!FC.size)return;const t=texts[e]&&texts[e].placeholder_filter||"Filter {item}...",r=texts[e]&&texts[e].clearFilter||"Clear filter",n=document.getElementById("deviceLibrarySearch"),o=document.getElementById("deviceLibrarySearchLabel"),a=texts[e]&&texts[e].deviceLibrarySearchHelp||"Filter all categories and press Enter to jump to the best match.",i=texts[e]&&texts[e].deviceLibrarySearchPlaceholder||"Search all device categories",s=texts[e]&&texts[e].deviceLibrarySearchLabel||"Search entire library";o&&(o.textContent=s),n&&(n.placeholder=i,n.setAttribute("aria-label",i),n.setAttribute("data-help",a),n.setAttribute("autocomplete","off"),n.setAttribute("autocorrect","off"),n.setAttribute("autocapitalize","off"),n.setAttribute("spellcheck","false")),FC.forEach((c,u)=>{const f=hh(u,e);if(c.heading&&(c.heading.textContent=f),c.filterInput){const d=t.replace("{item}",f.toLowerCase());if(c.filterInput.placeholder=d,c.filterInput.setAttribute("aria-label",d),c.filterInput.setAttribute("autocomplete","off"),c.filterInput.setAttribute("autocorrect","off"),c.filterInput.setAttribute("autocapitalize","off"),c.filterInput.setAttribute("spellcheck","false"),c.filterInput.setAttribute("inputmode","search"),c.filterLabel){const h=d.replace(/\s*(?:\.{3}|\u2026)$/,"");c.filterLabel.textContent=h}const p=c.filterInput.nextElementSibling;p&&p.classList.contains("clear-input-btn")&&(p.setAttribute("aria-label",r),p.title=r)}});const l=hd&&typeof hd.updateDeviceLibrarySearchLocalization=="function"?hd.updateDeviceLibrarySearchLocalization:null;l&&l()}function H7(){const e=(Cu&&typeof Cu.value=="string"?Cu.value.trim():"")||"";return e||jl&&jl.value||""}Ut("getCurrentProjectName",H7);var fs=document.getElementById("newCategory");document.getElementById("newSubcategory");document.getElementById("subcategoryField");var JT=document.getElementById("newName"),ZT=document.getElementById("newWatt"),lF=document.getElementById("wattField");document.getElementById("dynamicFields");document.getElementById("cameraFields");document.getElementById("cameraWatt");var eO=document.getElementById("cameraVoltage");document.getElementById("cameraPortType");document.getElementById("monitorFields");document.getElementById("monitorScreenSize");document.getElementById("monitorBrightness");document.getElementById("monitorWatt");var tO=document.getElementById("monitorVoltage");document.getElementById("monitorPortType");document.getElementById("monitorVideoInputsContainer");document.getElementById("lensFields");document.getElementById("lensMountOptionsContainer");function iq(){if(!fs&&typeof document<"u"&&(fs=document.getElementById("newCategory")),!fs)return;fs.options?fs.options.length=0:fs.innerHTML="";const e=t=>{const r=document.createElement("option");r.value=t,r.textContent=hh(t,jt),fs.appendChild(r)};if(Hn){const t=new Set;if(Hn.accessories)for(const[n,o]of Object.entries(Hn.accessories))n==="cables"?t.add("accessories.cables"):o&&o.attributes&&t.add(`accessories.${n}`);for(const[n,o]of Object.entries(Hn))n==="accessories"||n==="fiz"||o&&o.attributes&&t.add(n);const r=Array.from(t).sort((n,o)=>{const a=hh(n,jt),i=hh(o,jt);return a.localeCompare(i,jt)});for(const n of r)e(n);if(Hn.fiz)for(const[n,o]of Object.entries(Hn.fiz))o&&o.attributes&&e(`fiz.${n}`);if(fs&&typeof fs.dispatchEvent=="function")try{fs.dispatchEvent(new Event("change",{bubbles:!0}))}catch(n){console.warn("Failed to dispatch change event in populateCategoryOptions",n)}}if(typeof devices=="object"){const t=new Set(fs.options?Array.from(fs.options).map(n=>n.value):[]),r=n=>{t.has(n)||(e(n),t.add(n))};for(const[n,o]of Object.entries(devices))if(n==="accessories")for(const a of Object.keys(o||{}))r(`accessories.${a}`);else if(n==="fiz")for(const a of Object.keys(o||{}))r(`fiz.${a}`);else o&&typeof o=="object"&&!Array.isArray(o)&&r(n)}}iq();document.getElementById("monitorVideoOutputsContainer");document.getElementById("monitorWirelessTx");var hp=document.getElementById("monitorLatency");document.getElementById("monitorAudioOutput");document.getElementById("viewfinderFields");document.getElementById("viewfinderScreenSize");document.getElementById("viewfinderBrightness");document.getElementById("viewfinderWatt");document.getElementById("viewfinderVoltage");document.getElementById("viewfinderPortType");document.getElementById("viewfinderVideoInputsContainer");document.getElementById("viewfinderVideoOutputsContainer");document.getElementById("viewfinderWirelessTx");var bp=document.getElementById("viewfinderLatency");document.getElementById("videoFields");document.getElementById("videoPowerInputsContainer");document.getElementById("videoVideoInputsContainer");document.getElementById("videoVideoOutputsContainer");document.getElementById("videoFrequency");document.getElementById("videoLatency");function xI(e){if(typeof e=="string"){const t=e.trim().toLowerCase();if(t===Oa.fahrenheit)return Oa.fahrenheit;if(t===Oa.celsius)return Oa.celsius}return e===Oa.fahrenheit?Oa.fahrenheit:Oa.celsius}function U7(){const e=[];typeof temperatureUnit<"u"&&e.push(temperatureUnit),typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"&&e.push(CORE_GLOBAL_SCOPE.temperatureUnit),typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"&&e.push(globalThis.temperatureUnit),typeof window<"u"&&window&&typeof window=="object"&&e.push(window.temperatureUnit),typeof self<"u"&&self&&typeof self=="object"&&e.push(self.temperatureUnit),typeof global<"u"&&global&&typeof global=="object"&&e.push(global.temperatureUnit);for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r=="string"&&r)return r}return Oa.celsius}function z7(e=jt,t){const r=xI(typeof t>"u"?U7():t),n=getLanguageTexts(e),o=getLanguageTexts("en"),a=r===Oa.fahrenheit?"temperatureUnitFahrenheit":"temperatureUnitCelsius";return n[a]||o[a]||(r===Oa.fahrenheit?"Fahrenheit (F)":"Celsius (C)")}(function(){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{},r=typeof document<"u"&&!!document&&typeof document.createElement=="function",n=(U,K)=>{if(typeof t[U]=="function")return t[U];const H=typeof K=="function"?K():K;if(typeof H=="function")try{t[U]=H}catch{}return H},o=(U,K)=>{if(Array.isArray(t[U]))return t[U];const H=Array.isArray(K)?K.slice():[];try{t[U]=H}catch{t[U]=H}return t[U]},a=["3G-SDI","6G-SDI","12G-SDI","Mini BNC","HDMI","Mini HDMI","Micro HDMI"],i=["Electronic Viewfinder","Optical Viewfinder","LCD Monitor","OLED Viewfinder"],s=["BNC","Mini BNC","HDMI","Mini HDMI","Micro HDMI"],l=typeof localeSort=="function"?localeSort:(U,K)=>String(U||"").localeCompare(String(K||""),void 0,{sensitivity:"base"}),c=()=>typeof devices<"u"&&devices&&typeof devices=="object"?devices:{},u=(U,K)=>{const H=new Set((U||[]).filter(Boolean));try{K(H)}catch{}return Array.from(H).filter(Boolean).sort(l)},f=()=>{const U=u(i,K=>{const H=c();Object.values(H.cameras||{}).forEach(te=>{if(!te)return;(Array.isArray(te.viewfinder)?te.viewfinder:[]).forEach(fe=>{const Oe=typeof fe?.type=="string"?fe.type.trim():"";Oe&&K.add(Oe)})})});return o("viewfinderTypeOptions",U),U},d=()=>{const U=u(s,K=>{const H=c();Object.values(H.cameras||{}).forEach(te=>{if(!te)return;(Array.isArray(te.viewfinder)?te.viewfinder:[]).forEach(fe=>{const Oe=typeof fe?.connector=="string"?fe.connector.trim():"";Oe&&K.add(Oe)})})});return o("viewfinderConnectorOptions",U),U},p=()=>u(a,K=>{const H=c(),te=re=>{Array.isArray(re)&&re.forEach(fe=>{if(typeof fe=="string"){const Ne=fe.trim();Ne&&K.add(Ne);return}const Oe=typeof fe?.type=="string"?fe.type.trim():"";Oe&&K.add(Oe);const Te=typeof fe?.portType=="string"?fe.portType.trim():"";Te&&K.add(Te)})};Object.values(H.cameras||{}).forEach(re=>{re&&(te(re.videoInputs),te(re.videoOutputs))}),Object.values(H.monitors||{}).forEach(re=>{re&&(te(re.videoInputs),te(re.videoOutputs))})});if(n("getAllViewfinderTypes",()=>f),n("getAllViewfinderConnectors",()=>d),!r){n("setViewfinders",()=>function(){}),n("getViewfinders",()=>function(){return[]}),n("clearViewfinders",()=>function(){}),n("setViewfinderVideoInputs",()=>function(){}),n("getViewfinderVideoInputs",()=>function(){return[]}),n("clearViewfinderVideoInputs",()=>function(){}),n("setViewfinderVideoOutputs",()=>function(){}),n("getViewfinderVideoOutputs",()=>function(){return[]}),n("clearViewfinderVideoOutputs",()=>function(){});return}const h=U=>{if(!r||typeof document?.getElementById!="function")return null;try{return document.getElementById(U)}catch{return null}},m=h("viewfinderContainer"),g=h("viewfinderVideoInputsContainer"),S=h("viewfinderVideoOutputsContainer");if([["setViewfinders",m],["getViewfinders",m],["clearViewfinders",m]].some(([U,K])=>K?!1:(n(U,()=>U==="getViewfinders"?()=>[]:()=>{}),!0)))return;let L=0;const v=(U,K)=>{if(!U)return"";if(U.id)return U.id;const H=typeof K=="string"&&K?K:"field";L+=1;const te=`${H.toLowerCase().replace(/[^a-z0-9]+/g,"-")||"field"}-${L}`;try{U.id=te}catch{}return U.id||te},A=(U,K)=>{const H=document.createElement("label");return H.className="visually-hidden",U&&H.setAttribute("for",U),H.textContent=typeof K=="string"?K:"",H},R=(U,K)=>{const H=document.createElement("div");H.className="field-with-label",H.dataset.label=K;const te=v(U,K);return H.appendChild(A(te,K)),H.appendChild(U),H},I=(U,K,H)=>{if(!U)return;const te=new Set;U.innerHTML="";const re=(fe,Oe)=>{if(te.has(fe))return;const Te=document.createElement("option");Te.value=fe,Te.textContent=typeof Oe=="string"?Oe:fe,U.appendChild(Te),te.add(fe)};re("",""),K.forEach(fe=>{if(typeof fe!="string")return;const Oe=fe.trim();Oe&&re(Oe,Oe)}),typeof H=="string"&&H&&!te.has(H)&&re(H,H),U.value=typeof H=="string"?H:""},C=(U="",K="",H="",te="")=>{const re=document.createElement("div");re.className="form-row";const fe=document.createElement("select");fe.className="viewfinder-type-select",fe.name="viewfinderType",I(fe,f(),typeof U=="string"?U.trim():""),re.appendChild(R(fe,"Type"));const Oe=document.createElement("input");Oe.type="text",Oe.name="viewfinderResolution",Oe.placeholder="Resolution",Oe.value=typeof K=="string"?K:"",re.appendChild(R(Oe,"Resolution"));const Te=document.createElement("select");Te.className="viewfinder-connector-select",Te.name="viewfinderConnector",I(Te,d(),typeof H=="string"?H.trim():""),re.appendChild(R(Te,"Connector"));const Ne=document.createElement("input");Ne.type="text",Ne.name="viewfinderNotes",Ne.placeholder="Notes",Ne.value=typeof te=="string"?te:"",re.appendChild(R(Ne,"Notes"));const Ie=document.createElement("button");Ie.type="button",Yp(Ie,ICON_GLYPHS.add,{contextPaths:["viewfinderHeading",["cameraViewfinderLabel"]],fallbackContext:"Viewfinder",actionKey:"addEntry"}),Ie.addEventListener("click",()=>{re.after(C())}),re.appendChild(Ie);const et=document.createElement("button");return et.type="button",Yp(et,ICON_GLYPHS.minus,{contextPaths:["viewfinderHeading",["cameraViewfinderLabel"]],fallbackContext:"Viewfinder",actionKey:"removeEntry"}),et.addEventListener("click",()=>{m&&m.children.length>1?re.remove():Array.from(re.querySelectorAll("select, input")).forEach(Ze=>{Ze&&(Ze.value="")})}),re.appendChild(et),re},k=(U,K,H,te,re,fe="")=>{if(!U)return null;const Oe=document.createElement("div");Oe.className="form-row";const Te=document.createElement("select");Te.name=K,Te.className=`${K}-select`,I(Te,p(),typeof fe=="string"?fe.trim():""),Oe.appendChild(R(Te,"Type"));const Ne=document.createElement("button");Ne.type="button",Yp(Ne,ICON_GLYPHS.add,{contextPaths:[H,[te]],fallbackContext:re,actionKey:"addEntry"}),Ne.addEventListener("click",()=>{Oe.after(k(U,K,H,te,re))}),Oe.appendChild(Ne);const Ie=document.createElement("button");return Ie.type="button",Yp(Ie,ICON_GLYPHS.minus,{contextPaths:[H,[te]],fallbackContext:re,actionKey:"removeEntry"}),Ie.addEventListener("click",()=>{U.children.length>1?Oe.remove():Te.value=""}),Oe.appendChild(Ie),Oe},_=U=>{if(!m)return;m.innerHTML="";const K=Array.isArray(U)?U:[];if(!K.length){m.appendChild(C());return}K.forEach(H=>{const te=typeof H?.type=="string"?H.type:"",re=typeof H?.resolution=="string"?H.resolution:"",fe=typeof H?.connector=="string"?H.connector:"",Oe=typeof H?.notes=="string"?H.notes:"";m.appendChild(C(te,re,fe,Oe))})},w=()=>m?Array.from(m.querySelectorAll(".form-row")).map(U=>{const[K,H,te,re]=U.querySelectorAll("select, input");return{type:K?K.value:"",resolution:H?H.value:"",connector:te?te.value:"",notes:re?re.value:""}}).filter(U=>U.type):[],x=()=>{_([])},G=U=>{if(!g)return;g.innerHTML="";const K=Array.isArray(U)?U:[];if(!K.length){const H=k(g,"viewfinderVideoInput","viewfinderVideoInputsHeading","viewfinderVideoInputsLabel","Video Inputs");H&&g.appendChild(H);return}K.forEach(H=>{const te=typeof H=="string"?H:typeof H?.type=="string"?H.type:"",re=k(g,"viewfinderVideoInput","viewfinderVideoInputsHeading","viewfinderVideoInputsLabel","Video Inputs",te);re&&g.appendChild(re)})},T=()=>g?Array.from(g.querySelectorAll("select")).map(U=>({type:U.value})).filter(U=>U.type):[],P=()=>{G([])},N=U=>{if(!S)return;S.innerHTML="";const K=Array.isArray(U)?U:[];if(!K.length){const H=k(S,"viewfinderVideoOutput","viewfinderVideoOutputsHeading","viewfinderVideoOutputsLabel","Video Outputs");H&&S.appendChild(H);return}K.forEach(H=>{const te=typeof H=="string"?H:typeof H?.type=="string"?H.type:"",re=k(S,"viewfinderVideoOutput","viewfinderVideoOutputsHeading","viewfinderVideoOutputsLabel","Video Outputs",te);re&&S.appendChild(re)})},q=()=>S?Array.from(S.querySelectorAll("select")).map(U=>({type:U.value})).filter(U=>U.type):[],Z=()=>{N([])};n("setViewfinders",()=>_),n("getViewfinders",()=>w),n("clearViewfinders",()=>x),n("setViewfinderVideoInputs",()=>G),n("getViewfinderVideoInputs",()=>T),n("clearViewfinderVideoInputs",()=>P),n("setViewfinderVideoOutputs",()=>N),n("getViewfinderVideoOutputs",()=>q),n("clearViewfinderVideoOutputs",()=>Z),m&&!m.children.length&&_([]),g&&!g.children.length&&G([]),S&&!S.children.length&&N([])})();lF&&lF.parentNode;function cF(e,t){const r=document.getElementById("addDeviceForm"),n=document.getElementById("wattField"),o=document.getElementById("videoFields"),a=document.getElementById("cameraFields");if(!n||!r)return;const i=e==="video"||e==="wirelessReceivers"||e==="iosVideo";try{i&&o&&o.parentNode===r?r.insertBefore(n,o):a&&a.parentNode===r?r.insertBefore(n,a):r.appendChild(n)}catch(s){console.warn("placeWattField failed to insert element safely",s)}}try{Ut("placeWattField",cF)}catch{typeof window<"u"&&(window.placeWattField=cF)}document.getElementById("motorFields");document.getElementById("motorConnector");document.getElementById("motorInternal");document.getElementById("motorTorque");document.getElementById("motorGearTypes");document.getElementById("motorNotes");document.getElementById("controllerFields");document.getElementById("controllerConnector");document.getElementById("controllerPower");document.getElementById("controllerBattery");document.getElementById("controllerConnectivity");document.getElementById("controllerNotes");document.getElementById("distanceFields");document.getElementById("distanceConnection");document.getElementById("distanceMethod");document.getElementById("distanceRange");document.getElementById("distanceAccuracy");document.getElementById("distanceOutput");document.getElementById("distanceNotes");document.getElementById("batteryPlatesContainer");document.getElementById("cameraMediaContainer");document.getElementById("lensMountContainer");var wu=document.getElementById("lensFocusScaleUnit");document.getElementById("powerDistContainer");document.getElementById("videoOutputsContainer");document.getElementById("fizConnectorContainer");document.getElementById("viewfinderContainer");document.getElementById("timecodeContainer");document.getElementById("batteryFields");var rO=document.getElementById("newCapacity"),nO=document.getElementById("newPinA"),bh=document.getElementById("newDtapA");bh&&bh.parentElement;document.getElementById("addDeviceBtn");document.getElementById("cancelEditBtn");document.getElementById("exportDataBtn");document.getElementById("exportOutput");document.getElementById("importFileInput");document.getElementById("importDataBtn");var uF=document.getElementById("skipLink");function kI(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,r=(e&&typeof e.focusScalePreference=="string"?e.focusScalePreference:null)||(typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";if(typeof normalizeFocusScale=="function")try{const o=normalizeFocusScale(r);if(o==="imperial"||o==="metric")return o}catch{}return(typeof r=="string"?r.trim().toLowerCase():"")==="imperial"?"imperial":"metric"}function $7(e=jt,{preserveValue:t=!0}={}){if(!wu)return;const r=t?wu.value:"",n=typeof e=="string"?e:jt,o=texts&&n&&texts[n]?texts[n]:texts?.en||{},a=o.lensFocusScaleDefault||o.focusScaleSetting||"Use global focus scale",i=o.focusScaleMetric||"Metric",s=o.focusScaleImperial||"Imperial",c=kI()==="imperial"?`${a} (${s})`:`${a} (${i})`,u=r&&(r==="metric"||r==="imperial")?r:"";wu.innerHTML="";const f=(d,p)=>{const h=document.createElement("option");h.value=d,h.textContent=p,wu.appendChild(h)};f("",c),f("metric",i),f("imperial",s),wu.value=u}var fF=document.getElementById("languageSelect"),Kr=document.getElementById("settingsTablist"),Dv=document.getElementById("pinkModeToggle");document.getElementById("pinkModeHelpIcon");var Nv=document.getElementById("darkModeToggle"),su=document.getElementById("helpButton"),js=document.getElementById("reloadButton");document.getElementById("helpDialog");var ey=document.getElementById("closeHelp"),Fv=document.getElementById("helpSearch"),dF=document.getElementById("helpNoResults");document.getElementById("helpNoResultsSuggestions");var pF=document.getElementById("helpNoResultsSuggestionsHeading"),mF=document.getElementById("helpNoResultsSuggestionsIntro"),V7=document.getElementById("helpNoResultsSuggestionClear"),q7=document.getElementById("helpNoResultsSuggestionSynonyms"),K7=document.getElementById("helpNoResultsSuggestionQuickStart"),W7=document.getElementById("helpNoResultsSuggestionBackup"),oO=document.getElementById("helpDataAuditHeading"),Y7=document.getElementById("helpDataAuditStep1"),Q7=document.getElementById("helpDataAuditStep2"),X7=document.getElementById("helpDataAuditStep3"),J7=document.getElementById("helpDataAuditStep4"),aO=document.getElementById("helpDataAuditNote");document.getElementById("helpResultsSummary");document.getElementById("helpResultsAssist");var jv=document.getElementById("helpSearchClear");document.getElementById("helpSections");document.getElementById("helpQuickLinks");document.getElementById("helpQuickLinksHeading");document.getElementById("helpQuickLinksList");var Wo,Sh,zl,vh,$a,ma,Eh,Ah,vm,Ch,Em,Am,Cm,Xf,wm,Ss,hl=document.getElementById("iosPwaHelpDialog"),wh,Lh,Rh,iO=!1;function eu(){if(!(iO&&Wo)){if(typeof document>"u"){iO=!0,Wo=Wo||null,Sh=Sh||null,zl=zl||null,vh=vh||null,$a=$a||null,ma=ma||null,Eh=Eh||null,Ah=Ah||null,vm=vm||null,Ch=Ch||null,Em=Em||null,Am=Am||null,Cm=Cm||null,Xf=Xf||null,wm=wm||null,Ss=Ss||null,wh=wh||null,Lh=Lh||null,Rh=Rh||null;return}Wo=document.getElementById("installPromptBanner"),Sh=document.getElementById("installPromptBannerText"),zl=document.getElementById("installPromptBannerAction"),vh=document.getElementById("installPromptBannerIcon"),$a=document.getElementById("installPromptBannerDismiss"),ma=document.getElementById("installGuideDialog"),Eh=document.getElementById("installGuideTitle"),Ah=document.getElementById("installGuideIntro"),vm=document.getElementById("installGuideSteps"),Ch=document.getElementById("installGuideNote"),Em=document.getElementById("installGuideMigration"),Am=document.getElementById("installGuideMigrationTitle"),Cm=document.getElementById("installGuideMigrationIntro"),Xf=document.getElementById("installGuideMigrationSteps"),wm=document.getElementById("installGuideMigrationNote"),Ss=document.getElementById("installGuideClose"),wh=document.getElementById("iosPwaHelpTitle"),Lh=document.getElementById("iosPwaHelpIntro"),Rh=document.getElementById("iosPwaHelpStep1"),iO=!0}}const Z7=(typeof globalThis<"u"&&globalThis&&typeof globalThis.syncMountVoltageResetButtonGlobal=="function"?globalThis.syncMountVoltageResetButtonGlobal:null)||(typeof syncMountVoltageResetButtonGlobal=="function"?syncMountVoltageResetButtonGlobal:function(){}),eJ=document.getElementById("mountVoltageSettings"),tJ=document.getElementById("mountVoltageHeading"),rJ=document.getElementById("mountVoltageDescription"),nJ=document.getElementById("mountVoltageNote"),sq=document.getElementById("mountVoltageReset");Z7(sq);const oJ={V:document.getElementById("mountVoltageVTitle"),Gold:document.getElementById("mountVoltageGoldTitle"),B:document.getElementById("mountVoltageBTitle")},gF={"V-Mount":{high:document.getElementById("mountVoltageVHigh"),low:document.getElementById("mountVoltageVLow"),highLabel:document.getElementById("mountVoltageVHighLabel"),lowLabel:document.getElementById("mountVoltageVLowLabel")},"Gold-Mount":{high:document.getElementById("mountVoltageGoldHigh"),low:document.getElementById("mountVoltageGoldLow"),highLabel:document.getElementById("mountVoltageGoldHighLabel"),lowLabel:document.getElementById("mountVoltageGoldLowLabel")},"B-Mount":{high:document.getElementById("mountVoltageBHigh"),low:document.getElementById("mountVoltageBLow"),highLabel:document.getElementById("mountVoltageBHighLabel"),lowLabel:document.getElementById("mountVoltageBLowLabel")}},sO=typeof setMountVoltageDomReferences=="function"?{setDomReferences:setMountVoltageDomReferences}:CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE.cineCoreMountVoltage&&typeof CORE_GLOBAL_SCOPE.cineCoreMountVoltage.setMountVoltageDomReferences=="function"?{setDomReferences:CORE_GLOBAL_SCOPE.cineCoreMountVoltage.setMountVoltageDomReferences}:null;if(sO&&typeof sO.setDomReferences=="function")sO.setDomReferences({section:eJ,heading:tJ,description:rJ,note:nJ,resetButton:sq,titles:oJ,inputs:gF});else if(CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE=="object")try{CORE_GLOBAL_SCOPE.mountVoltageInputs=gF}catch{}typeof updateMountVoltageInputsFromState=="function"&&updateMountVoltageInputsFromState();typeof updateMountVoltageSettingLabels=="function"&&updateMountVoltageSettingLabels(jt);const yF=document.getElementById("iosPwaHelpStep2"),hF=document.getElementById("iosPwaHelpStep3");lV(A6);typeof window<"u"&&typeof document<"u"&&h6().catch(()=>{});const bF=document.getElementById("iosPwaHelpStep4"),SF=document.getElementById("iosPwaHelpNote");var Lm=document.getElementById("iosPwaHelpClose"),vF=!1,jC=null,Ky=null,Wy=null;function lO(e){if(typeof e=="number"&&Number.isFinite(e))return Math.max(0,Math.min(255,Math.round(e)));if(typeof e!="string")return null;const t=e.trim();if(!t)return null;if(t.endsWith("%")){const n=Number.parseFloat(t.slice(0,-1));return Number.isNaN(n)?null:Math.max(0,Math.min(255,Math.round(n/100*255)))}const r=Number.parseFloat(t);return Number.isNaN(r)?null:Math.max(0,Math.min(255,Math.round(r)))}function aJ(e){if(typeof e!="string")return null;const t=e.trim();if(!t)return null;const r=t.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);if(r){const o=r[1];return o.length===3?{r:Number.parseInt(o[0]+o[0],16),g:Number.parseInt(o[1]+o[1],16),b:Number.parseInt(o[2]+o[2],16)}:{r:Number.parseInt(o.slice(0,2),16),g:Number.parseInt(o.slice(2,4),16),b:Number.parseInt(o.slice(4,6),16)}}const n=t.match(/^rgba?\(([^)]+)\)$/i);if(n){const o=n[1].split(",");if(o.length<3)return null;const[a,i,s]=o,l=lO(a),c=lO(i),u=lO(s);return[l,c,u].some(f=>f===null)?null:{r:l,g:c,b:u}}return null}function iJ(e){if(!e||typeof e!="object")return 0;const t=i=>{const s=Number(i);return Number.isFinite(s)?Math.min(1,Math.max(0,s/255)):0},r=i=>i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),n=r(t(e.r)),o=r(t(e.g)),a=r(t(e.b));return .2126*n+.7152*o+.0722*a}function lq(){try{if(Ba&&typeof Ba.isIosDevice=="function")return!!Ba.isIosDevice()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isIosDevice() failed",e)}return!1}function sJ(){try{if(Ba&&typeof Ba.isAndroidDevice=="function")return!!Ba.isAndroidDevice()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isAndroidDevice() failed",e)}return!1}function lJ(){try{if(Ba&&typeof Ba.isStandaloneDisplayMode=="function")return!!Ba.isStandaloneDisplayMode()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("isStandaloneDisplayMode() failed",e)}return!1}function cJ(){try{Ba&&typeof Ba.markIosPwaHelpDismissed=="function"&&Ba.markIosPwaHelpDismissed()}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("markIosPwaHelpDismissed() failed",e)}}function EF(){return!nl||typeof nl!="object"?!1:typeof nl.installBannerDismissedInSession!="boolean"?(nl.installBannerDismissedInSession=!1,!1):nl.installBannerDismissedInSession}function cq(e){!nl||typeof nl!="object"||(nl.installBannerDismissedInSession=!!e)}function uJ(){if(EF())return!0;if(typeof localStorage>"u")return!1;try{const t=localStorage.getItem(cG)==="1";return t&&cq(!0),t}catch(e){return console.warn("Could not read install banner dismissal flag",e),EF()}}function fJ(){if(cq(!0),!(typeof localStorage>"u"))try{localStorage.setItem(cG,"1")}catch(e){console.warn("Could not store install banner dismissal",e)}}function dJ(){return eu(),!Wo||lJ()||uJ()?!1:lq()||sJ()}function ty(){if(eu(),!Wo)return;const e=dJ(),t=typeof document<"u"?document.documentElement:null;t&&typeof t.classList<"u"&&t.classList.toggle("install-banner-visible",e),e?(Wo.removeAttribute("hidden"),HC(),zu()):(Wo.setAttribute("hidden",""),bI(0),Wo.style.removeProperty("top"))}function HC(){if(eu(),!!Wo&&!(typeof window>"u"||typeof window.getComputedStyle!="function"))try{const e=document.documentElement;if(!e)return;const r=window.getComputedStyle(e).getPropertyValue("--accent-color").trim();if(!r){Wo.style.removeProperty("--install-banner-text-color");return}const n=aJ(r);if(!n)return;const a=iJ(n)>.55?"#000000":"#ffffff";Wo.style.setProperty("--install-banner-text-color",a)}catch(e){console.warn("Unable to update install banner colors",e)}}function uq(e,t=jt){if(eu(),!ma)return;const r=texts.en||{},n=texts[t]||r,o=e==="ios",a=o?"installHelpTitleIos":"installHelpTitleAndroid",i=o?"installHelpIntroIos":"installHelpIntroAndroid",s=o?"installHelpStepsIos":"installHelpStepsAndroid",l=o?"installHelpNoteIos":"installHelpNoteAndroid",c=n[a]||r[a]||"";Eh&&(Eh.textContent=c);const u=n[i]||r[i]||"";Ah&&(Ah.textContent=u);const f=n[s],d=r[s],p=y=>y?Array.isArray(y)?y:[y]:[],h=p(f),m=p(d),g=h.length?h:m;vm&&(vm.textContent="",g.forEach(y=>{if(!y)return;const E=document.createElement("li");E.textContent=y,vm.appendChild(E)}));const S=n[l]||r[l]||"";if(Ch&&(Ch.textContent=S),ma.setAttribute("data-platform",e),!(!Em||!Am||!Cm||!Xf||!wm))if(o){Em.removeAttribute("hidden");const y=n.installHelpMigrationTitle||r.installHelpMigrationTitle||"";Am.textContent=y;const E=n.iosPwaHelpIntro||r.iosPwaHelpIntro||"";Cm.textContent=E;const L=[n.iosPwaHelpStep1||r.iosPwaHelpStep1,n.iosPwaHelpStep2||r.iosPwaHelpStep2,n.iosPwaHelpStep3||r.iosPwaHelpStep3,n.iosPwaHelpStep4||r.iosPwaHelpStep4].filter(Boolean);Xf.textContent="",L.forEach(A=>{const R=document.createElement("li");R.textContent=A,Xf.appendChild(R)});const v=n.iosPwaHelpNote||r.iosPwaHelpNote||"";wm.textContent=v}else Em.setAttribute("hidden",""),Am.textContent="",Cm.textContent="",Xf.textContent="",wm.textContent=""}function pJ(e){if(eu(),!ma)return;jC=e,Ky=document.activeElement,uq(e),ma.removeAttribute("hidden");const t=Ss||ma.querySelector('button, [href], [tabindex]:not([tabindex="-1"])');if(t&&typeof t.focus=="function")try{t.focus()}catch{t.focus()}}function II(){if(eu(),!!ma&&(ma.setAttribute("hidden",""),jC=null,Ky&&typeof Ky.focus=="function"))try{Ky.focus()}catch{Ky.focus()}}function mJ(){if(eu(),!Wo)return!1;if(vF)return PI(jt),HC(),ty(),zu(),!0;if(vF=!0,vh&&typeof applyIconGlyph=="function"&&applyIconGlyph(vh,ICON_GLYPHS.installApp),zl&&zl.addEventListener("click",e=>{e.preventDefault();const t=lq()?"ios":"android";pJ(t)}),$a&&$a.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),fJ(),ty()}),Ss&&Ss.addEventListener("click",()=>{II()}),ma&&ma.addEventListener("click",e=>{e.target===ma&&II()}),PI(jt),HC(),ty(),zu(),typeof window<"u"&&(window.addEventListener("resize",zu),window.addEventListener("appinstalled",ty),typeof window.matchMedia=="function"))try{const e=window.matchMedia("(display-mode: standalone)"),t=()=>ty();typeof e.addEventListener=="function"?e.addEventListener("change",t):typeof e.addListener=="function"&&e.addListener(t)}catch(e){console.warn("matchMedia display-mode listener failed",e)}return!0}function PI(e){eu();const t=texts.en||{},r=texts[e]||t,n=r.installBannerText||t.installBannerText||"";Sh&&n&&(Sh.textContent=n),Wo&&(n?(Wo.setAttribute("aria-label",n),Wo.setAttribute("title",n)):(Wo.removeAttribute("aria-label"),Wo.removeAttribute("title"))),zl&&(n?(zl.setAttribute("aria-label",n),zl.setAttribute("title",n)):(zl.removeAttribute("aria-label"),zl.removeAttribute("title")));const o=r.installHelpClose||t.installHelpClose||"",a=r.installBannerDismiss||t.installBannerDismiss||o||"";if($a){const i=a||"";if(typeof rt=="function"&&rt($a,"",ICON_GLYPHS.circleX),Array.from($a.querySelectorAll(".visually-hidden")).forEach(s=>{s&&s.parentNode===$a&&$a.removeChild(s)}),i){$a.setAttribute("aria-label",i),$a.setAttribute("title",i);const s=document.createElement("span");s.className="visually-hidden",s.textContent=i,$a.appendChild(s)}else $a.removeAttribute("aria-label"),$a.removeAttribute("title")}Ss&&(o&&typeof rt=="function"?(rt(Ss,o,ICON_GLYPHS.circleX),Ss.setAttribute("aria-label",o),Ss.setAttribute("title",o)):o||(Ss.removeAttribute("aria-label"),Ss.removeAttribute("title"))),ma&&!ma.hasAttribute("hidden")&&jC&&uq(jC,e),zu(),HC()}function gJ(){try{if(Ba&&typeof Ba.shouldShowIosPwaHelp=="function")return!!Ba.shouldShowIosPwaHelp(()=>hl)}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("shouldShowIosPwaHelp() failed",e)}return!1}function yJ(){if(!hl||!gJ())return;Wy=document.activeElement,hl.removeAttribute("hidden");const e=Lm||hl.querySelector('button, [href], [tabindex]:not([tabindex="-1"])');if(e&&typeof e.focus=="function")try{e.focus()}catch{e.focus()}}function CG(e=!1){if(hl&&(hl.setAttribute("hidden",""),e&&cJ(),Wy&&typeof Wy.focus=="function"))try{Wy.focus()}catch{Wy.focus()}}function hJ(){yJ()}Lm&&Lm.addEventListener("click",()=>CG(!0));hl&&hl.addEventListener("click",e=>{e.target===hl&&CG(!0)});document.addEventListener("keydown",e=>{if(e.key!=="Escape"&&e.key!=="Esc")return;let t=!1;hl&&!hl.hasAttribute("hidden")&&(CG(!0),t=!0),ma&&!ma.hasAttribute("hidden")&&(II(),t=!0),t&&e.preventDefault()});var Hv=document.getElementById("hoverHelpButton"),Jf=document.getElementById("settingsButton");const cO=Jf?.querySelector?.(".settings-button-icon");var UC=document.getElementById("settingsDialog");Jf&&Jf.setAttribute("data-allow-hover-help","");cO&&(applyIconGlyph(cO,ICON_GLYPHS.gears),cO.setAttribute("aria-hidden","true"));UC&&UC.setAttribute("data-allow-hover-help","");const Ta=Kr?Array.from(Kr.querySelectorAll('[role="tab"]')):[],Uv=Kr?Kr.closest(".settings-tabs-container")||Kr:null,Mf=document.getElementById("settingsTabsScrollPrev"),_f=document.getElementById("settingsTabsScrollNext");let ry=0;const bJ="(max-width: 720px)",Sp=typeof window<"u"&&typeof window.matchMedia=="function"?window.matchMedia(bJ):null;function uO(e){Kr&&(Kr.setAttribute("aria-orientation",e?"vertical":"horizontal"),pb())}if(Sp)try{uO(Sp.matches);const e=t=>{uO(t.matches)};typeof Sp.addEventListener=="function"?Sp.addEventListener("change",e):typeof Sp.addListener=="function"&&Sp.addListener(e)}catch{uO(!1)}else Kr&&Kr.setAttribute("aria-orientation","horizontal");function AF(){if(!Kr||!Uv){Mf&&(Mf.hidden=!0),_f&&(_f.hidden=!0);return}const e=typeof Kr.scrollWidth=="number"?Kr.scrollWidth:0,t=typeof Kr.clientWidth=="number"?Kr.clientWidth:0,r=typeof Kr.scrollLeft=="number"?Kr.scrollLeft:Number(Kr.scrollLeft)||0,n=Math.max(0,e-t),o=Math.min(n,Math.max(0,r)),a=e>t+4,i=!a||o<=1,s=!a||Math.abs(e-t-o)<=1;Uv.classList.toggle("is-scrollable",a),Uv.classList.toggle("is-at-start",i),Uv.classList.toggle("is-at-end",s),Mf&&(Mf.hidden=!a,Mf.disabled=i),_f&&(_f.hidden=!a,_f.disabled=s)}function pb(){Kr&&(typeof window<"u"&&typeof window.requestAnimationFrame=="function"?(ry&&(typeof window.cancelAnimationFrame=="function"&&window.cancelAnimationFrame(ry),ry=0),ry=window.requestAnimationFrame(()=>{ry=0,AF()})):AF())}function fq(e){if(!Kr)return;const t=Kr.clientWidth?Kr.clientWidth*.75:200,r=e*t;if(typeof Kr.scrollBy=="function")try{Kr.scrollBy({left:r,behavior:"smooth"})}catch{Kr.scrollLeft+=r}else Kr.scrollLeft+=r;pb()}Mf&&Mf.addEventListener("click",()=>{fq(-1)});_f&&_f.addEventListener("click",()=>{fq(1)});if(Kr){let e=!1;if(typeof window<"u"&&typeof window.addEventListener=="function")try{const t=()=>{},r=Object.defineProperty({},"passive",{get(){return e={passive:!0},!1}});window.addEventListener("testPassive",t,r),window.removeEventListener("testPassive",t,r)}catch{e=!1}Kr.addEventListener("scroll",()=>{pb()},e),typeof window<"u"&&typeof window.addEventListener=="function"&&window.addEventListener("resize",pb,e)}var SJ=UC?Array.from(UC.querySelectorAll(".settings-panel")):[],yA=document.getElementById("settingsTab-general"),dq=document.getElementById("settingsTab-autoGear"),pq=document.getElementById("settingsTab-accessibility"),mq=document.getElementById("settingsTab-backup"),gq=document.getElementById("settingsTab-data"),yq=document.getElementById("settingsTab-about"),vJ=[[yA,ICON_GLYPHS.settingsGeneral],[dq,ICON_GLYPHS.settingsAutoGear],[pq,ICON_GLYPHS.settingsAccessibility],[mq,ICON_GLYPHS.settingsBackup],[gq,ICON_GLYPHS.settingsData],[yq,ICON_GLYPHS.settingsAbout]];vJ.forEach(([e,t])=>{if(!e||!t)return;const r=e.querySelector?.(".settings-tab-icon");r&&(applyIconGlyph(r,t),r.setAttribute("aria-hidden","true"))});const fO=document.getElementById("generalSettingsHeading"),dO=document.getElementById("generalLanguageHeading"),pO=document.getElementById("generalAppearanceHeading"),mO=document.getElementById("generalTypographyHeading"),gO=document.getElementById("generalBrandingHeading");document.getElementById("generalCameraColorsHeading");const yO=document.getElementById("cameraColorsDescription"),EJ=document.getElementById("cameraColorALabel"),AJ=document.getElementById("cameraColorBLabel"),CJ=document.getElementById("cameraColorCLabel"),wJ=document.getElementById("cameraColorDLabel"),LJ=document.getElementById("cameraColorELabel");var RJ=document.getElementById("cameraColorA"),TJ=document.getElementById("cameraColorB"),OJ=document.getElementById("cameraColorC"),xJ=document.getElementById("cameraColorD"),kJ=document.getElementById("cameraColorE"),ny=document.getElementById("settingsLanguage"),hO=document.getElementById("settingsDarkMode"),bO=document.getElementById("settingsPinkMode"),SO=document.getElementById("accentColorInput"),vp=document.getElementById("accentColorReset"),Ep=document.getElementById("settingsTemperatureUnit"),Ap=document.getElementById("settingsFocusScale"),vO=document.getElementById("settingsFontSize"),EO=document.getElementById("settingsFontFamily"),Bl=document.getElementById("localFontsButton");document.getElementById("localFontsInput");var oy=document.getElementById("localFontsStatus"),AO=document.getElementById("localFontsGroup");const CO=document.getElementById("bundledFontOptions");var wO=document.getElementById("settingsLogo");document.getElementById("settingsLogoPreview");const hA=(()=>{const e=mT&&typeof mT.createDocumentationTrackerManager=="function"?(()=>{try{return mT.createDocumentationTrackerManager({document:typeof document<"u"?document:null})}catch(r){return console.warn("Failed to create documentation tracker manager",r),null}})():null;if(e)return{initialize(){try{e.initialize()}catch(r){console.warn("Failed to initialise documentation tracker",r)}},updateLocalization(r){try{e.updateLocalization(r)}catch(n){console.warn("Failed to update documentation tracker localisation",n)}},render(){try{e.render()}catch(r){console.warn("Failed to render documentation tracker",r)}},isInitialized(){try{return typeof e.isInitialized=="function"?e.isInitialized()===!0:!1}catch{}return!1}};const t=()=>{};return{initialize:t,updateLocalization:t,render:t,isInitialized(){return!1}}})();var mb="";if(Ta.length){mb=Ta.find(t=>t.getAttribute("aria-selected")==="true")?.id||Ta[0].id;try{const t=localStorage.getItem("settingsActiveTab");t&&Ta.some(r=>r.id===t)&&(mb=t)}catch(t){console.warn("Could not load settings tab preference",t)}}function bA(e,t={}){if(!Ta.length)return;const{focusTab:r=!1}=t||{};let n=Ta.find(o=>o.id===e);if(n||(n=Ta[0]),!!n){if(Ta.forEach(o=>{const a=o===n;if(o.setAttribute("aria-selected",a?"true":"false"),o.tabIndex=a?0:-1,a&&r)try{o.focus({preventScroll:!0})}catch{o.focus()}o.classList.toggle("active",a)}),SJ.forEach(o=>{if(!o)return;(o.getAttribute("aria-labelledby")||"").split(/\s+/).map(s=>s.trim()).filter(Boolean).includes(n.id)?o.removeAttribute("hidden"):o.setAttribute("hidden","")}),Kr&&typeof Kr.scrollWidth=="number"&&typeof Kr.clientWidth=="number"&&Kr.scrollWidth>Kr.clientWidth+4&&typeof n.scrollIntoView=="function")try{n.scrollIntoView({block:"nearest",inline:"center",behavior:"smooth"})}catch{n.scrollIntoView()}pb(),mb=n.id;try{localStorage.setItem("settingsActiveTab",mb)}catch(o){console.warn("Could not save settings tab preference",o)}}}hA.initialize();Ta.length&&(bA(mb),Ta.forEach(e=>{e.addEventListener("click",()=>{bA(e.id)}),e.addEventListener("keydown",t=>{const{key:r}=t;if(!r||!["ArrowLeft","ArrowUp","ArrowRight","ArrowDown","Home","End"].includes(r))return;t.preventDefault();const n=Ta.indexOf(e);if(n===-1)return;let o=n;r==="ArrowLeft"||r==="ArrowUp"?o=(n-1+Ta.length)%Ta.length:r==="ArrowRight"||r==="ArrowDown"?o=(n+1)%Ta.length:r==="Home"?o=0:r==="End"&&(o=Ta.length-1);const a=Ta[o];a&&bA(a.id,{focusTab:!0})})}));Df&&Df.addEventListener("click",()=>{bA("settingsTab-backup",{focusTab:!0});const e=document.getElementById("backupSettings");if(e&&typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}});var CF=SC.reduce((e,t)=>{const r=Vt[t]||null;return e[t]={key:t,section:r,label:h9[t]||null,select:b9[t]||null,addShortcut:gG[t]||null,removeButton:kV[t]||null,logicLabel:IV[t]||null,logicSelect:yG[t]||null},r&&r.setAttribute("aria-hidden",r.hidden?"true":"false"),e},{});const Jo=typeof oe<"u"?oe:globalThis.AUTO_GEAR_UI_EXPORTS||{};typeof Jo.refreshAutoGearShootingDaysValue=="function"&&Jo.refreshAutoGearShootingDaysValue;const IJ=typeof Jo.refreshAutoGearScenarioOptions=="function"?Jo.refreshAutoGearScenarioOptions:function(){};typeof Jo.refreshAutoGearScenarioBaseSelect=="function"&&Jo.refreshAutoGearScenarioBaseSelect;const PJ=typeof Jo.refreshAutoGearMatteboxOptions=="function"?Jo.refreshAutoGearMatteboxOptions:function(){},BJ=typeof Jo.refreshAutoGearCameraHandleOptions=="function"?Jo.refreshAutoGearCameraHandleOptions:function(){},GJ=typeof Jo.refreshAutoGearViewfinderExtensionOptions=="function"?Jo.refreshAutoGearViewfinderExtensionOptions:function(){},MJ=typeof Jo.refreshAutoGearDeliveryResolutionOptions=="function"?Jo.refreshAutoGearDeliveryResolutionOptions:function(){},_J=typeof Jo.refreshAutoGearVideoDistributionOptions=="function"?Jo.refreshAutoGearVideoDistributionOptions:function(){};typeof Jo.collectAutoGearSelectedValues=="function"&&Jo.collectAutoGearSelectedValues;createDeferredAutoGearRefresher("refreshAutoGearCameraOptions"),refreshAutoGearOwnGearConditionOptions,createDeferredAutoGearRefresher("refreshAutoGearCameraWeightCondition"),createDeferredAutoGearRefresher("refreshAutoGearMonitorOptions"),createDeferredAutoGearRefresher("refreshAutoGearTripodHeadOptions"),createDeferredAutoGearRefresher("refreshAutoGearTripodBowlOptions"),createDeferredAutoGearRefresher("refreshAutoGearTripodTypesOptions"),createDeferredAutoGearRefresher("refreshAutoGearTripodSpreaderOptions"),createDeferredAutoGearRefresher("refreshAutoGearWirelessOptions"),createDeferredAutoGearRefresher("refreshAutoGearMotorsOptions"),createDeferredAutoGearRefresher("refreshAutoGearControllersOptions"),createDeferredAutoGearRefresher("refreshAutoGearDistanceOptions");var wG=typeof window<"u"&&window.autoGearActiveConditions||new Set;typeof window<"u"&&!window.autoGearActiveConditions&&(window.autoGearActiveConditions=wG);function DJ(e){return e&&Object.prototype.hasOwnProperty.call(CF,e)?CF[e]:null}function NJ(e){const t=DJ(e);if(t&&t.label&&typeof t.label.textContent=="string"){const n=t.label.textContent.trim();if(n)return n}const r=v9[e];return typeof r=="string"&&r?r:typeof e=="string"&&e?e.replace(/([A-Z])/g," $1").replace(/^./,n=>n.toUpperCase()):""}function hq(){if(!Ra)return;const e=Ra.value||"",t=texts[jt]?.autoGearConditionPlaceholder||texts.en?.autoGearConditionPlaceholder||"Choose a condition";Ra.innerHTML="";const r=document.createElement("option");r.value="",r.textContent=t,Ra.appendChild(r);const n=SC.filter(o=>wG.has(o)?BV.has(o):!0);n.forEach(o=>{const a=document.createElement("option");a.value=o,a.textContent=NJ(o),Ra.appendChild(a)}),e&&n.includes(e)?Ra.value=e:Ra.value="",Ra.disabled=n.length===0}function bq(){const e=Ra&&Ra.value,t=Ra?Ra.disabled:!0;vu&&(vu.disabled=!e||t);const r=SC.some(n=>wG.has(n)?BV.has(n):!0);SC.forEach(n=>{const o=gG[n];o&&(o.disabled=!r)})}hq();bq();configureAutoGearConditionButtons();if(qf){const e=()=>{updateAutoGearShootingDaysDraft(),kr("renderAutoGearDraftImpact",[],{defer:!0})};qf.addEventListener("input",e),qf.addEventListener("change",e)}if(Kf){const e=()=>{updateAutoGearShootingDaysDraft(),kr("renderAutoGearDraftImpact",[],{defer:!0})};Kf.addEventListener("input",e),Kf.addEventListener("change",e),Kf.addEventListener("blur",e)}Object.entries(yG).forEach(([e,t])=>{if(!t)return;AUTO_GEAR_CONDITION_LOGIC_FIELDS[e];const r=()=>{const n=normalizeAutoGearConditionLogic(t.value);t.value=n,kr("renderAutoGearDraftImpact",[],{defer:!0})};t.addEventListener("input",r),t.addEventListener("change",r)});if(Wf){const e=()=>{updateAutoGearCameraWeightDraft(),kr("renderAutoGearDraftImpact",[],{defer:!0})};Wf.addEventListener("input",e),Wf.addEventListener("change",e)}if(Yf){const e=()=>{updateAutoGearCameraWeightDraft(),kr("renderAutoGearDraftImpact",[],{defer:!0})};Yf.addEventListener("input",e),Yf.addEventListener("change",e),Yf.addEventListener("blur",e)}var LO=document.getElementById("autoGearAddItemsHeading"),zv=document.getElementById("autoGearAddOwnGearLabel"),$v=document.getElementById("autoGearAddItemLabel"),RO=document.getElementById("autoGearAddCategoryLabel"),TO=document.getElementById("autoGearAddQuantityLabel"),SA=document.getElementById("autoGearAddScreenSizeLabel"),vA=document.getElementById("autoGearAddSelectorTypeLabel"),EA=document.getElementById("autoGearAddSelectorDefaultLabel"),OO=document.getElementById("autoGearAddNotesLabel"),ay=document.getElementById("autoGearAddOwnGear"),iy=document.getElementById("autoGearAddName"),_p=document.getElementById("autoGearAddCategory"),wF=document.getElementById("autoGearAddQuantity"),zC=document.getElementById("autoGearAddScreenSize"),Rm=document.getElementById("autoGearAddSelectorType"),gb=document.getElementById("autoGearAddSelectorDefault"),LF=document.getElementById("autoGearAddNotes"),Sq=document.getElementById("autoGearAddItemButton");document.getElementById("autoGearAddList");var xO=document.getElementById("autoGearRemoveItemsHeading"),Vv=document.getElementById("autoGearRemoveOwnGearLabel"),qv=document.getElementById("autoGearRemoveItemLabel"),kO=document.getElementById("autoGearRemoveCategoryLabel"),IO=document.getElementById("autoGearRemoveQuantityLabel"),AA=document.getElementById("autoGearRemoveScreenSizeLabel"),CA=document.getElementById("autoGearRemoveSelectorTypeLabel"),wA=document.getElementById("autoGearRemoveSelectorDefaultLabel"),PO=document.getElementById("autoGearRemoveNotesLabel"),sy=document.getElementById("autoGearRemoveOwnGear"),ly=document.getElementById("autoGearRemoveName"),Dp=document.getElementById("autoGearRemoveCategory"),RF=document.getElementById("autoGearRemoveQuantity"),$C=document.getElementById("autoGearRemoveScreenSize"),Tm=document.getElementById("autoGearRemoveSelectorType"),yb=document.getElementById("autoGearRemoveSelectorDefault"),TF=document.getElementById("autoGearRemoveNotes"),vq=document.getElementById("autoGearRemoveItemButton");document.getElementById("autoGearRemoveList");var OF=document.getElementById("autoGearDraftImpact"),cy=document.getElementById("autoGearDraftImpactHeading"),BO=document.getElementById("autoGearDraftImpactDescription");document.getElementById("autoGearDraftImpactList");document.getElementById("autoGearDraftWarningContainer");var GO=document.getElementById("autoGearDraftWarningHeading");document.getElementById("autoGearDraftWarningList");var Kv=document.getElementById("autoGearSaveRule"),Wv=document.getElementById("autoGearCancelEdit");document.getElementById("autoGearItemCatalog");updateAutoGearOwnGearOptions();typeof document<"u"&&document&&document.addEventListener("own-gear-data-changed",()=>{W8(),updateAutoGearOwnGearOptions(),updateAutoGearCatalogOptions()});function FJ(e){if(!e||!e.multiple)return;const t=r=>{if(!e.multiple||r.defaultPrevented||typeof PointerEvent<"u"&&r instanceof PointerEvent&&r.pointerType&&r.pointerType!=="mouse"||typeof r.button=="number"&&r.button!==0||r.ctrlKey||r.metaKey||r.shiftKey||r.altKey)return;const o=r.target instanceof HTMLOptionElement?r.target:null;if(!o||o.disabled)return;r.preventDefault(),o.selected=!o.selected;const a=i=>{try{const s=new Event(i,{bubbles:!0});e.dispatchEvent(s)}catch{const s=document.createEvent("Event");s.initEvent(i,!0,!0),e.dispatchEvent(s)}};if(a("input"),a("change"),typeof e.focus=="function")try{e.focus({preventScroll:!0})}catch{e.focus()}};typeof window<"u"&&typeof window.PointerEvent<"u"?e.addEventListener("pointerdown",t):e.addEventListener("mousedown",t)}[Hy,Uy,zy,$y,Vy,sA,lA,cA,uA,fA,dA,pA,mA,gA].forEach(FJ);var jJ=zC?.closest(".auto-gear-field")||SA?.closest(".auto-gear-field")||null,HJ=Rm?.closest(".auto-gear-field")||vA?.closest(".auto-gear-field")||null,UJ=gb?.closest(".auto-gear-field")||EA?.closest(".auto-gear-field")||null,zJ=$C?.closest(".auto-gear-field")||AA?.closest(".auto-gear-field")||null,$J=Tm?.closest(".auto-gear-field")||CA?.closest(".auto-gear-field")||null,VJ=yb?.closest(".auto-gear-field")||wA?.closest(".auto-gear-field")||null;yI={select:_p,screenSizeField:jJ,screenSizeInput:zC,selectorTypeField:HJ,selectorTypeSelect:Rm,selectorDefaultField:UJ,selectorDefaultInput:gb};hI={select:Dp,screenSizeField:zJ,screenSizeInput:$C,selectorTypeField:$J,selectorTypeSelect:Tm,selectorDefaultField:VJ,selectorDefaultInput:yb};[{selectorTypeSelect:Rm,selectorDefaultInput:gb},{selectorTypeSelect:Tm,selectorDefaultInput:yb}].filter(e=>e.selectorDefaultInput);function Eq(){yI&&updateAutoGearMonitorFieldGroup(yI),hI&&updateAutoGearMonitorFieldGroup(hI)}Ut("syncAutoGearMonitorFieldVisibility",Eq);var Cp=document.getElementById("autoGearExport"),wp=document.getElementById("autoGearImport");document.getElementById("autoGearImportInput");document.getElementById("autoGearBackupsSection");var MO=document.getElementById("autoGearBackupsHeading"),_O=document.getElementById("autoGearBackupsDescription"),DO=document.getElementById("autoGearBackupSelectLabel"),Yv=document.getElementById("autoGearBackupSelect"),uy=document.getElementById("autoGearBackupRestore");document.getElementById("autoGearBackupControls");var NO=document.getElementById("autoGearBackupEmpty"),Qv=document.getElementById("autoGearBackupRetentionLabel"),Zf=document.getElementById("autoGearBackupRetention"),qJ=document.getElementById("autoGearBackupRetentionSummary");document.getElementById("autoGearBackupRetentionWarning");var FO=document.getElementById("autoGearShowBackups"),Xv=document.getElementById("autoGearShowBackupsLabel"),jO=document.getElementById("autoGearBackupsHidden");const HO=document.getElementById("dataHeading"),xF=document.getElementById("storageSummaryIntro"),KJ=document.getElementById("storageSummaryList");typeof globalThis<"u"&&(globalThis.storageSummaryList=KJ);const kF=document.getElementById("storageSummaryEmpty"),IF=document.getElementById("storageSummaryFootnote");document.getElementById("storagePersistence");const Jv=document.getElementById("storagePersistenceHeading"),UO=document.getElementById("storagePersistenceIntro"),hf=document.getElementById("storagePersistenceRequest"),Zv=document.getElementById("storagePersistenceStatus");var eE=document.getElementById("storageActionsHeading"),zO=document.getElementById("storageActionsIntro"),fy=document.getElementById("storageBackupNow"),Df=document.getElementById("storageOpenBackupTab"),tE=document.getElementById("storageStatusHeading"),$O=document.getElementById("storageStatusLastProjectLabel"),rE=document.getElementById("storageStatusLastProjectValue"),VO=document.getElementById("storageStatusLastAutoBackupLabel"),PF=document.getElementById("storageStatusLastAutoBackupValue"),qO=document.getElementById("storageStatusLastFullBackupLabel"),BF=document.getElementById("storageStatusLastFullBackupValue"),dy=document.getElementById("storageStatusReminder");const KO=document.getElementById("loggingSection"),nE=document.getElementById("loggingHeading"),WO=document.getElementById("loggingIntro"),oE=document.getElementById("loggingLevelFilterLabel"),aE=document.getElementById("loggingLevelFilter"),py=document.getElementById("loggingNamespaceFilterLabel"),YO=document.getElementById("loggingNamespaceFilter"),iE=document.getElementById("loggingNamespaceFilterHelp"),QO=document.getElementById("loggingHistoryLimitLabel"),sE=document.getElementById("loggingHistoryLimit"),XO=document.getElementById("loggingHistoryLimitHelp"),JO=document.getElementById("loggingConsoleOutputLabel"),ZO=document.getElementById("loggingConsoleOutputHelp"),ex=document.getElementById("loggingCaptureConsoleLabel"),tx=document.getElementById("loggingCaptureConsoleHelp"),rx=document.getElementById("loggingCaptureErrorsLabel"),nx=document.getElementById("loggingCaptureErrorsHelp"),ox=document.getElementById("loggingPersistSessionLabel"),ax=document.getElementById("loggingPersistSessionHelp"),Lp=document.getElementById("loggingExportBtn"),lE=document.getElementById("loggingExportHelp"),ix=document.getElementById("loggingStatus"),cE=document.getElementById("loggingEmpty"),sx=document.getElementById("loggingUnavailable");if(Zf){const e=t=>{kr(t,[],{defer:!0})};Zf.addEventListener("input",()=>{e("handleAutoGearBackupRetentionInput")}),Zf.addEventListener("blur",()=>{e("handleAutoGearBackupRetentionBlur")}),Zf.addEventListener("change",()=>{e("handleAutoGearBackupRetentionChange")})}const WJ=Object.freeze(["Indoor","Outdoor","Studio","Tripod","Handheld","Easyrig","Cine Saddle","Steadybag","Dolly","Slider","Steadicam","Gimbal","Trinity","Rollcage","Car Mount","Jib","Undersling mode","Crane","Remote Head","Extreme cold (snow)","Extreme rain","Extreme heat","Rain Machine","Slow Motion","Battery Belt"]);function YJ(){const e=o=>{if(!o||typeof o!="object")return null;const{value:a,label:i}=o;if(typeof a!="string")return null;const s=a.trim();if(!s)return null;const l=typeof i=="string"&&i.trim()?i.trim():s;return{value:s,label:l}},t=()=>{const o=kr("getRequiredScenarioOptionEntries",[],{defaultValue:null});if(Array.isArray(o)&&o.length){const a=o.map(e).filter(Boolean);if(a.length)return a}return null},r=()=>{const o=getCoreGlobalObject(),a=o&&o.scenarioIcons;if(!a||typeof a!="object")return null;const i=Object.keys(a).filter(s=>typeof s=="string").map(s=>s.trim()).filter(Boolean).map(s=>({value:s,label:s}));return i.length?i:null},n=()=>WJ.map(o=>({value:o,label:o}));return(t()||r()||n()).sort((o,a)=>localeSort(o.label,a.label))}function QJ(e){const t=new Map,r=document.getElementById("requiredScenarios");return r&&Array.from(r.options||[]).forEach(n=>{const o=typeof n.value=="string"?n.value.trim():"";if(!o)return;const a=n.textContent||o;t.has(o)||t.set(o,a)}),Array.isArray(e)&&e.forEach(n=>{!n||!Array.isArray(n.scenarios)||n.scenarios.forEach(o=>{if(typeof o!="string")return;const a=o.trim();a&&(t.has(a)||t.set(a,a))})}),t.size||YJ().forEach(({value:n,label:o})=>{t.has(n)||t.set(n,o)}),Array.from(t.entries()).map(([n,o])=>({value:n,label:o})).sort((n,o)=>localeSort(n.label,o.label))}function XJ(e){if(!Fl)return $S;const t=QJ(e),r=texts[jt]?.autoGearFilterScenarioAny||texts.en?.autoGearFilterScenarioAny||"All scenarios";Fl.innerHTML="";const n=document.createElement("option");n.value="all",n.textContent=r,Fl.appendChild(n),t.forEach(({value:a,label:i})=>{const s=document.createElement("option");s.value=a,s.textContent=i,a===$S&&(s.selected=!0),Fl.appendChild(s)});const o=t.length>0;return Fl.disabled=!o,Fl.value=$S,$S}Ut("setupInstallBanner",mJ);Ut("maybeShowIosPwaHelp",hJ);Ut("updateSelectIconBoxes",NV);Ut("updateGlobalDevicesReference",updateGlobalDevicesReference);Ut("setLanguage",w9);Ut("configureIconOnlyButton",Yp);Ut("encodeSharedSetup",tq);Ut("decodeSharedSetup",rq);Ut("iconMarkup",Jc);Ut("ICON_GLYPHS",ICON_GLYPHS);Ut("iconGlyph",iconGlyph);Ut("resolveIconGlyph",resolveIconGlyph);Ut("applyIconGlyph",applyIconGlyph);Ut("positionSvgMarkup",positionSvgMarkup);Ut("formatSvgCoordinate",formatSvgCoordinate);const Aq={CORE_GLOBAL_SCOPE,CORE_BOOT_QUEUE_KEY:JQ,CORE_BOOT_QUEUE:fI,CORE_SHARED:Ur,INSTALL_BANNER_DISMISSED_KEY:cG,AUTO_GEAR_ANY_MOTOR_TOKEN:mV,AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE:b8,AUTO_GEAR_BACKUP_RETENTION_MAX:y8,AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS:S8,AUTO_GEAR_MONITOR_DEFAULT_TYPES,GEAR_LIST_CATEGORIES:fG,TEMPERATURE_STORAGE_KEY:CORE_TEMPERATURE_STORAGE_KEY,TEMPERATURE_UNITS:Oa,TEMPERATURE_SCENARIOS:r6,FOCUS_SCALE_STORAGE_KEY,FOCUS_SCALE_VALUES:n6,FEEDBACK_TEMPERATURE_MIN:globalThis.FEEDBACK_TEMPERATURE_MIN_VALUE,FEEDBACK_TEMPERATURE_MAX:globalThis.FEEDBACK_TEMPERATURE_MAX_VALUE};Object.assign(Aq,MOUNT_VOLTAGE_RUNTIME_EXPORTS);XQ(Aq);k6({updatePowerSummary:{get:()=>O7},drawPowerDiagram:{get:()=>k7},safeGenerateConnectorSummary:{get:()=>oN,set:e=>{typeof e=="function"&&(oN=e)}},baseAutoGearRules:{get:()=>hC,set:e=>{Array.isArray(e)&&(hC=e)}},autoGearAutoPresetId:{get:()=>CT,set:e=>{typeof e=="string"?CT=e:(e===null||typeof e>"u")&&(CT="")}},autoGearScenarioModeSelect:{get:()=>md,set:e=>{md=e||null,PV(md)}},pinkModeIconRotationTimer:{get:()=>typeof XD=="function"?XD():null,set:e=>{typeof JD=="function"&&JD(e)}},pinkModeIconIndex:{get:()=>typeof ZD=="function"?ZD():0,set:e=>{typeof eN=="function"&&eN(e)}}});var Cq=function(){typeof eA=="function"&&(typeof requestAnimationFrame=="function"?requestAnimationFrame(eA):setTimeout(eA,0))};Cq();typeof globalThis<"u"&&(globalThis.encodeSharedSetup=tq,globalThis.decodeSharedSetup=rq);function VC(){VC.done||(VC.done=!0,!(typeof document>"u")&&(Vt={always:document.getElementById("autoGearCondition-always"),scenarios:document.getElementById("autoGearCondition-scenarios"),shootingDays:document.getElementById("autoGearCondition-shootingDays"),mattebox:document.getElementById("autoGearCondition-mattebox"),cameraHandle:document.getElementById("autoGearCondition-cameraHandle"),viewfinderExtension:document.getElementById("autoGearCondition-viewfinderExtension"),deliveryResolution:document.getElementById("autoGearCondition-deliveryResolution"),videoDistribution:document.getElementById("autoGearCondition-videoDistribution"),camera:document.getElementById("autoGearCondition-camera"),ownGear:document.getElementById("autoGearCondition-ownGear"),cameraWeight:document.getElementById("autoGearCondition-cameraWeight"),monitor:document.getElementById("autoGearCondition-monitor"),tripodHeadBrand:document.getElementById("autoGearCondition-tripodHeadBrand"),tripodBowl:document.getElementById("autoGearCondition-tripodBowl"),tripodTypes:document.getElementById("autoGearCondition-tripodTypes"),tripodSpreader:document.getElementById("autoGearCondition-tripodSpreader"),crewPresent:document.getElementById("autoGearCondition-crewPresent"),crewAbsent:document.getElementById("autoGearCondition-crewAbsent"),wireless:document.getElementById("autoGearCondition-wireless"),motors:document.getElementById("autoGearCondition-motors"),controllers:document.getElementById("autoGearCondition-controllers"),distance:document.getElementById("autoGearCondition-distance")},rA=document.getElementById("autoGearHeading"),SI=document.getElementById("autoGearDescription"),document.getElementById("autoGearMonitorDefaultsSection"),nA=document.getElementById("autoGearMonitorDefaultsHeading"),oA=document.getElementById("autoGearMonitorDefaultsDescription"),ON=document.getElementById("autoGearDefaultFocusMonitor"),xN=document.getElementById("autoGearDefaultHandheldMonitor"),kN=document.getElementById("autoGearDefaultComboMonitor"),IN=document.getElementById("autoGearDefaultDirectorMonitor"),PN=document.getElementById("autoGearDefaultFocusMonitorLabel"),BN=document.getElementById("autoGearDefaultHandheldMonitorLabel"),GN=document.getElementById("autoGearDefaultComboMonitorLabel"),MN=document.getElementById("autoGearDefaultDirectorMonitorLabel"),Pp=document.getElementById("autoGearSearch"),_y=document.getElementById("autoGearSearchLabel"),Dy=document.getElementById("autoGearFilterScenarioLabel"),Fl=document.getElementById("autoGearFilterScenario"),Bp=document.getElementById("autoGearFilterClear"),document.getElementById("autoGearSummary"),document.getElementById("autoGearSummaryHeading"),document.getElementById("autoGearSummaryDescription"),document.getElementById("autoGearSummaryCards"),document.getElementById("autoGearSummaryDetails"),document.getElementById("autoGearRulesList"),EI=document.getElementById("autoGearPresetDescription"),Ny=document.getElementById("autoGearPresetLabel"),aA=document.getElementById("autoGearPresetSelect"),Gp=document.getElementById("autoGearSavePreset"),Mp=document.getElementById("autoGearDeletePreset"),ku=document.getElementById("autoGearAddRule"),Rf=document.getElementById("autoGearResetFactory"),lp=document.getElementById("autoGearEditor"),document.getElementById("autoGearConditionControls"),Fy=document.getElementById("autoGearConditionSelectLabel"),Ra=document.getElementById("autoGearConditionSelect"),vu=document.getElementById("autoGearConditionAdd"),document.getElementById("autoGearConditionList"),jy=document.getElementById("autoGearAlwaysLabel"),iA=document.getElementById("autoGearAlwaysHelp"),document.getElementById("autoGearCondition-cameraWeight"),vI=[{key:"focus",select:ON,label:PN},{key:"handheld7",select:xN,label:BN},{key:"combo15",select:kN,label:GN},{key:"director15",select:IN,label:MN}],vI.forEach(e=>{!e||!e.select||e.select.addEventListener("change",t=>{B8(e.key,t.target.value)})}),gG={always:Vt.always?.querySelector(".auto-gear-condition-add")||null,scenarios:Vt.scenarios?.querySelector(".auto-gear-condition-add")||null,shootingDays:Vt.shootingDays?.querySelector(".auto-gear-condition-add")||null,mattebox:Vt.mattebox?.querySelector(".auto-gear-condition-add")||null,cameraHandle:Vt.cameraHandle?.querySelector(".auto-gear-condition-add")||null,viewfinderExtension:Vt.viewfinderExtension?.querySelector(".auto-gear-condition-add")||null,deliveryResolution:Vt.deliveryResolution?.querySelector(".auto-gear-condition-add")||null,videoDistribution:Vt.videoDistribution?.querySelector(".auto-gear-condition-add")||null,camera:Vt.camera?.querySelector(".auto-gear-condition-add")||null,ownGear:Vt.ownGear?.querySelector(".auto-gear-condition-add")||null,cameraWeight:Vt.cameraWeight?.querySelector(".auto-gear-condition-add")||null,monitor:Vt.monitor?.querySelector(".auto-gear-condition-add")||null,tripodHeadBrand:Vt.tripodHeadBrand?.querySelector(".auto-gear-condition-add")||null,tripodBowl:Vt.tripodBowl?.querySelector(".auto-gear-condition-add")||null,tripodTypes:Vt.tripodTypes?.querySelector(".auto-gear-condition-add")||null,tripodSpreader:Vt.tripodSpreader?.querySelector(".auto-gear-condition-add")||null,crewPresent:Vt.crewPresent?.querySelector(".auto-gear-condition-add")||null,crewAbsent:Vt.crewAbsent?.querySelector(".auto-gear-condition-add")||null,wireless:Vt.wireless?.querySelector(".auto-gear-condition-add")||null,motors:Vt.motors?.querySelector(".auto-gear-condition-add")||null,controllers:Vt.controllers?.querySelector(".auto-gear-condition-add")||null,distance:Vt.distance?.querySelector(".auto-gear-condition-add")||null},kV={always:Vt.always?.querySelector(".auto-gear-condition-remove")||null,scenarios:Vt.scenarios?.querySelector(".auto-gear-condition-remove")||null,shootingDays:Vt.shootingDays?.querySelector(".auto-gear-condition-remove")||null,mattebox:Vt.mattebox?.querySelector(".auto-gear-condition-remove")||null,cameraHandle:Vt.cameraHandle?.querySelector(".auto-gear-condition-remove")||null,viewfinderExtension:Vt.viewfinderExtension?.querySelector(".auto-gear-condition-remove")||null,deliveryResolution:Vt.deliveryResolution?.querySelector(".auto-gear-condition-remove")||null,videoDistribution:Vt.videoDistribution?.querySelector(".auto-gear-condition-remove")||null,camera:Vt.camera?.querySelector(".auto-gear-condition-remove")||null,ownGear:Vt.ownGear?.querySelector(".auto-gear-condition-remove")||null,cameraWeight:Vt.cameraWeight?.querySelector(".auto-gear-condition-remove")||null,monitor:Vt.monitor?.querySelector(".auto-gear-condition-remove")||null,tripodHeadBrand:Vt.tripodHeadBrand?.querySelector(".auto-gear-condition-remove")||null,tripodBowl:Vt.tripodBowl?.querySelector(".auto-gear-condition-remove")||null,tripodTypes:Vt.tripodTypes?.querySelector(".auto-gear-condition-remove")||null,tripodSpreader:Vt.tripodSpreader?.querySelector(".auto-gear-condition-remove")||null,crewPresent:Vt.crewPresent?.querySelector(".auto-gear-condition-remove")||null,crewAbsent:Vt.crewAbsent?.querySelector(".auto-gear-condition-remove")||null,wireless:Vt.wireless?.querySelector(".auto-gear-condition-remove")||null,motors:Vt.motors?.querySelector(".auto-gear-condition-remove")||null,controllers:Vt.controllers?.querySelector(".auto-gear-condition-remove")||null,distance:Vt.distance?.querySelector(".auto-gear-condition-remove")||null},ku&&(ku.setAttribute("aria-controls","autoGearEditor"),ku.setAttribute("aria-expanded",lp&&!lp.hidden?"true":"false")),lp&&lp.setAttribute("aria-hidden",lp.hidden?"true":"false")))}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",VC):VC());function BI(e){return!!e&&(typeof e=="object"||typeof e=="function")}function JJ(){if(typeof require!="function")return null;try{const e=require("./runtime.js");if(e&&typeof e=="object")return e}catch{}return null}function ZJ(){if(typeof cineCoreRuntimeModules<"u"&&cineCoreRuntimeModules&&typeof cineCoreRuntimeModules=="object")return cineCoreRuntimeModules;const e=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(BI(r))try{const n=r.cineCoreRuntimeModules;if(n&&typeof n=="object")return n}catch{}}return null}function GF(e){if(!e||typeof e!="object")return null;const t=e["modules/core/runtime-module-loader.js"];return t&&typeof t=="object"?t:null}function eZ(){const e=Object.prototype.hasOwnProperty;function t(i){const s=[];function l(f){BI(f)&&s.indexOf(f)===-1&&s.push(f)}const c=i&&i.primaryScope,u=i&&i.candidateScopes;if(l(c),Array.isArray(u))for(let f=0;f<u.length;f+=1)l(u[f]);return typeof globalThis<"u"&&l(globalThis),typeof window<"u"&&l(window),typeof self<"u"&&l(self),typeof global<"u"&&l(global),s}function r(i){if(!BI(i))return null;try{const s=i.cineCoreRuntimeModules;return s&&typeof s=="object"?s:null}catch{}return null}function n(){if(typeof require!="function")return null;const i=["./runtime.js"];for(let s=0;s<i.length;s+=1){const l=i[s];try{const c=require(l);if(c&&typeof c=="object")return c}catch{}}return null}function o(i){if(typeof cineCoreRuntimeModules<"u"&&cineCoreRuntimeModules&&typeof cineCoreRuntimeModules=="object")return cineCoreRuntimeModules;const s=t(i||{});for(let l=0;l<s.length;l+=1){const c=r(s[l]);if(c)return c}return n()}function a(i,s){if(typeof i!="string"||!i)return null;const l=o(s||{});return!l||typeof l!="object"?null:e.call(l,i)?l[i]:null}return{resolveCoreRuntimeModulesNamespace:o,resolveCoreRuntimeModule:a}}let hb=GF(JJ())||GF(ZJ());try{!hb&&typeof uE<"u"&&uE&&typeof uE=="object"&&(hb=uE)}catch{}hb||(hb=eZ());const uE=hb;function Lu(e){return!!e&&(typeof e=="object"||typeof e=="function")}function tZ(e){return!!e&&typeof e.length=="number"}function my(e,t,r){if(Array.isArray(e)&&Lu(r)){if(t){if(t.has(r))return;t.add(r),e.push(r);return}e.indexOf(r)===-1&&e.push(r)}}function wq(e){return Lu(e)?e:typeof globalThis<"u"&&Lu(globalThis)?globalThis:typeof window<"u"&&Lu(window)?window:typeof self<"u"&&Lu(self)?self:typeof global<"u"&&Lu(global)?global:null}function Lq(e,t,r){if(t&&typeof t.collectCandidateScopes=="function")try{const a=t.collectCandidateScopes(e,r);if(Array.isArray(a))return a}catch{}const n=[],o=typeof Set=="function"?new Set:null;return my(n,o,e),my(n,o,typeof globalThis<"u"?globalThis:null),my(n,o,typeof window<"u"?window:null),my(n,o,typeof self<"u"?self:null),my(n,o,typeof global<"u"?global:null),n}function Rq(e){const t=e&&e.primaryScope,r=e&&e.runtimeShared,n=e&&e.environmentHelpers,o=e&&e.currentCandidateScopes;if(tZ(o))return o;let a=null;if(r&&typeof r.resolveCandidateScopes=="function")try{a=r.resolveCandidateScopes(t,n)}catch{a=null}return a||(a=Lq(t,r,n)),a}function Tq(e,t){const r=t&&t.runtimeShared,n=t&&t.environmentHelpers,o=t&&t.primaryScope,a=t&&t.globalScope||wq(o),i=t&&t.assignCurrentCandidateScopes;if(r&&typeof r.syncCandidateScopes=="function")try{return r.syncCandidateScopes(e,o,n),e}catch{}if(Lu(a)&&(!a.CORE_RUNTIME_CANDIDATE_SCOPES||a.CORE_RUNTIME_CANDIDATE_SCOPES!==e))try{a.CORE_RUNTIME_CANDIDATE_SCOPES=e}catch{}if(typeof i=="function")try{i(e)}catch{}return e}function rZ(e){const t=Rq(e||{});return Tq(t,e||{})}const MF={collectCandidateScopesWithFallback:Lq,resolveCandidateScopes:Rq,syncCandidateScopes:Tq,ensureCandidateScopes:rZ},Th=wq(),GI="cineCoreRuntimeCandidateScopes",nZ=Th&&typeof Th[GI]=="object"?Th[GI]:{},Oq=nZ;for(const e of Object.keys(MF))Oq[e]=MF[e];if(Lu(Th))try{Th[GI]=Oq}catch{}function Ru(e){return!!e&&(typeof e=="object"||typeof e=="function")}function xq(e){return Ru(e)?e:typeof globalThis<"u"&&Ru(globalThis)?globalThis:typeof window<"u"&&Ru(window)?window:typeof self<"u"&&Ru(self)?self:typeof global<"u"&&Ru(global)?global:null}function oZ(e){return e?Array.isArray(e)?e:[e]:[]}function _F(e){if(typeof e=="string"&&e)try{const t=String(e).trim().toLowerCase();if(t)return t}catch{}return""}function aZ(e){const t=e&&typeof e=="object"?e:{},r=t.runtimeScope,n=t.coreGlobalScope,o=xq(n||r),a=t.localizationBridge&&typeof t.localizationBridge=="object"?t.localizationBridge:null,i=typeof t.fallbackResolveLocaleModule=="function"?t.fallbackResolveLocaleModule:function(x){return null},s=typeof t.createLocaleFallbacks=="function"?t.createLocaleFallbacks:function(){return null};function l(){if(a&&typeof a.resolveLocaleModule=="function")try{const w=a.resolveLocaleModule(r);if(w&&typeof w=="object")return w}catch{}try{const w=i(r);if(w&&typeof w=="object")return w}catch{}return t.localeModule&&typeof t.localeModule=="object"?t.localeModule:null}const c=l(),u=(function(){if(a&&typeof a.getDefaultLanguage=="function")try{const x=a.getDefaultLanguage(r);if(typeof x=="string"&&x)return x}catch{}return c&&typeof c.DEFAULT_LANGUAGE=="string"?c.DEFAULT_LANGUAGE:typeof t.defaultLanguage=="string"?t.defaultLanguage:"en"})(),f=(function(){if(a&&typeof a.getRtlLanguageCodes=="function")try{const x=a.getRtlLanguageCodes(r);if(Array.isArray(x)&&x.length>0)return x}catch{}return c&&Array.isArray(c.RTL_LANGUAGE_CODES)&&c.RTL_LANGUAGE_CODES.length>0?c.RTL_LANGUAGE_CODES:Array.isArray(t.defaultRtlCodes)?t.defaultRtlCodes:["ar","fa","he","ur"]})(),d=(function(){try{return s({defaultLanguage:u,rtlLanguageCodes:f,localizationFallbackNamespace:t.localizationFallbackNamespace,localizationFallbackSupport:t.localizationFallbackSupport,localizationFallbacks:t.localizationFallbacks,inlineLocalizationFallbacks:t.inlineLocalizationFallbacks})}catch{}return null})(),p=d&&typeof d.normalizeLanguageCode=="function"?function(x){return d.normalizeLanguageCode(x)}:function(x){return _F(x)||u},h=d&&typeof d.isRtlLanguage=="function"?function(x){return d.isRtlLanguage(x)}:function(x){const T=p(x).split("-")[0];return f.indexOf(T)!==-1},m=d&&typeof d.resolveDocumentDirection=="function"?function(x){return d.resolveDocumentDirection(x)}:function(x){if(typeof document<"u"&&document&&document.documentElement)try{const G=document.documentElement.getAttribute("dir");if(G)return G}catch{}return h(x)?"rtl":"ltr"},g=d&&typeof d.applyLocaleMetadata=="function"?function(x,G,T){return d.applyLocaleMetadata(x,G,T)}:function(x,G,T){if(x){if(G)try{x.lang=G}catch{}if(T)try{x.dir=T}catch{}}},S=a&&typeof a.normalizeLanguageCode=="function"?function(x){try{return a.normalizeLanguageCode(x,r)}catch{}return p(x)}:p,y=a&&typeof a.isRtlLanguage=="function"?function(x){try{return a.isRtlLanguage(x,r)}catch{}return h(x)}:h,E=a&&typeof a.resolveDocumentDirection=="function"?function(x){try{return a.resolveDocumentDirection(x,r)}catch{}return m(x)}:m,L=a&&typeof a.applyLocaleMetadata=="function"?function(x,G,T){try{return a.applyLocaleMetadata(x,G,T,r)}catch{}return g(x,G,T)}:g,v=oZ(t.translationAdditionalScopes).filter(Ru);function A(){const w=[],x=typeof Set=="function"?new Set:null;function G(T){if(Ru(T)){if(x){if(x.has(T))return;x.add(T),w.push(T);return}w.indexOf(T)===-1&&w.push(T)}}G(r),G(o),G(t.localizationFallbackNamespace),G(t.localizationFallbackSupport);for(let T=0;T<v.length;T+=1)G(v[T]);return G(typeof globalThis<"u"?globalThis:null),G(typeof window<"u"?window:null),G(typeof self<"u"?self:null),G(typeof global<"u"?global:null),w}function R(){const w=A();for(let x=0;x<w.length;x+=1){const G=w[x];if(!G||typeof G!="object")continue;const T=G.texts;if(T&&typeof T=="object")return T}return typeof t.translationsRequirePath=="string"&&t.translationsRequirePath&&t.translationsRequirePath,{}}function I(w){const x=R(),G=typeof u=="string"&&u?u:"en",T=_F(w);let P=T&&Object.prototype.hasOwnProperty.call(x,T)?T:"";if(!P&&T){const Z=T.split("-")[0];Z&&Object.prototype.hasOwnProperty.call(x,Z)&&(P=Z)}P||(P=G);const N=x&&P&&typeof x[P]=="object"?x[P]:null;if(N)return N;if(P!==G){const Z=x&&typeof x[G]=="object"?x[G]:null;if(Z)return Z}if(x&&typeof x.en=="object")return x.en;const q=x?Object.keys(x):[];if(q.length){const Z=q[0],U=x[Z];if(U&&typeof U=="object")return U}return{}}function C(){const w=A();for(let x=0;x<w.length;x+=1){const G=w[x];if(!G||typeof G!="object")continue;const T=G.getLanguageTexts;if(typeof T=="function")return T}return null}const k=(function(){const x=C();return x?function(T){try{const P=x.call(null,T);if(P&&typeof P=="object")return P}catch(P){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Existing getLanguageTexts helper failed. Falling back to local resolution.",P)}return I(T)}:function(T){return I(T)}})();function _(){const w=A();for(let x=0;x<w.length;x+=1){const G=w[x];if(!(!G||typeof G!="object")&&typeof G.getLanguageTexts!="function")try{G.getLanguageTexts=k}catch{}}}return _(),{localeModule:c,defaultLanguage:u,rtlLanguageCodes:f,normalizeLanguageCode:S,isRtlLanguage:y,resolveDocumentDirection:E,applyLocaleMetadata:L,getLanguageTexts:k,fallbackNormalizeLanguageCode:p,fallbackIsRtlLanguage:h,fallbackResolveDocumentDirection:m,fallbackApplyLocaleMetadata:g,resolveTranslationDataset:R,ensureGlobalGetLanguageTextsAvailability:_}}const DF={createLocalizationRuntime:aZ},Oh=xq(),MI="cineCoreRuntimeLocalization",iZ=Oh&&typeof Oh[MI]=="object"?Oh[MI]:{},kq=iZ;for(const e of Object.keys(DF))kq[e]=DF[e];if(Ru(Oh))try{Oh[MI]=kq}catch{}function LG(){return typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const lx=typeof globalThis<"u"&&globalThis&&typeof globalThis.CORE_GLOBAL_SCOPE=="object"?globalThis.CORE_GLOBAL_SCOPE:null,$l=lx&&typeof lx=="object"?lx:LG(),sZ="src/data/schema.json",lZ="cameraPowerPlanner_schemaCache",RG=$l&&typeof $l=="object"&&typeof $l.DEVICE_SCHEMA_PATH=="string"&&$l.DEVICE_SCHEMA_PATH?$l.DEVICE_SCHEMA_PATH:sZ,bb=$l&&typeof $l=="object"&&typeof $l.DEVICE_SCHEMA_STORAGE_KEY=="string"&&$l.DEVICE_SCHEMA_STORAGE_KEY?$l.DEVICE_SCHEMA_STORAGE_KEY:lZ,xh=(()=>{if(typeof window>"u")return null;try{if(!("localStorage"in window))return null;const{localStorage:e}=window,t="__schema_cache__";return e.setItem(t,"1"),e.removeItem(t),e}catch(e){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Device schema cache disabled",e),null}})();function _I(){if(!xh)return null;try{const e=xh.getItem(bb);if(!e)return null;const t=JSON.parse(e);return t&&typeof t=="object"&&!Array.isArray(t)?t:null}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to read cached device schema",e);try{xh.removeItem(bb)}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to clear invalid cached device schema",t)}return null}}function DI(e){if(xh)try{xh.setItem(bb,JSON.stringify(e))}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to cache device schema",t)}}function Np(e){return!!e&&typeof e=="object"&&!Array.isArray(e)}async function Iq(e=RG){if(typeof caches>"u"||!caches||typeof caches.match!="function")return null;const t=new Set([e]);if(typeof e=="string"&&!e.startsWith("./")&&t.add(`./${e}`),typeof window<"u"&&window&&window.location)try{t.add(new URL(e,window.location.href).toString())}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to resolve schema.json cache URL",r)}for(const r of t)try{const n=await caches.match(r,{ignoreSearch:!0});if(n)return await n.clone().json()}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to read schema.json from cache entry",r,n)}return null}function cZ(e){return function(){const r=()=>{try{e()}catch(n){typeof console<"u"&&typeof console.error=="function"&&console.error("populateCategoryOptions failed during scheduled execution",n)}};typeof window<"u"&&window&&typeof window.setTimeout=="function"?window.setTimeout(r,0):typeof setTimeout=="function"?setTimeout(r,0):r()}}function uZ(e={}){const t=e&&typeof e.onSchemaChange=="function"?e.onSchemaChange:()=>{},r=e&&typeof e.populateCategoryOptions=="function"?e.populateCategoryOptions:()=>{const l=LG();if(!l)return;let c=null;const u=e&&typeof e.populateCategoryOptionsName=="string"?e.populateCategoryOptionsName:"populateCategoryOptions";if(u&&typeof l[u]=="function"?c=l[u]:typeof l.populateCategoryOptions=="function"&&(c=l.populateCategoryOptions),c)try{c()}catch(f){typeof console<"u"&&typeof console.error=="function"&&console.error("populateCategoryOptions execution failed",f)}};let n=_I(),o=n&&Np(n)?n:null;t(o);const a=cZ(r);function i(l){return Np(l)?(o=l,n=l):o||(o={}),t(o),o}function s(l){Np(l)?(i(l),DI(l)):o||i(n||{}),a()}return{DEVICE_SCHEMA_PATH:RG,DEVICE_SCHEMA_STORAGE_KEY:bb,loadCachedDeviceSchema:_I,persistDeviceSchema:DI,isValidDeviceSchema:Np,loadDeviceSchemaFromCacheStorage:Iq,schedulePopulateCategoryOptions:a,finalizeDeviceSchemaLoad:s,getCachedDeviceSchema:()=>n&&Np(n)?n:null,getDeviceSchema:()=>o,setDeviceSchema:i}}const NF={DEVICE_SCHEMA_PATH:RG,DEVICE_SCHEMA_STORAGE_KEY:bb,loadCachedDeviceSchema:_I,persistDeviceSchema:DI,isValidDeviceSchema:Np,loadDeviceSchemaFromCacheStorage:Iq,createDeviceSchemaManager:uZ},qi=LG(),Pq="cineCoreDeviceSchema",Bq="CORE_DEVICE_SCHEMA";let NI=null;if(qi&&(typeof qi=="object"||typeof qi=="function"))try{const e=qi[Bq];e&&typeof e=="object"&&(NI=e)}catch{NI=null}let Jl=NI;if((!Jl||typeof Jl!="object")&&qi&&(typeof qi=="object"||typeof qi=="function"))try{const e=qi[Pq];e&&typeof e=="object"&&(Jl=e)}catch{Jl=null}(!Jl||typeof Jl!="object")&&(Jl={});for(const e of Object.keys(NF))Jl[e]=NF[e];if(qi&&(typeof qi=="object"||typeof qi=="function")){try{qi[Pq]=Jl}catch{}try{qi[Bq]=Jl}catch{}}const du=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:global,fZ=Object.freeze(["src/animations/unicorn.json","src/animations/pink-mode/dog.json","src/animations/pink-mode/fox-2.json","src/animations/pink-mode/fox-3.json","src/animations/pink-mode/fox.json","src/animations/pink-mode/horse.json","src/animations/pink-mode/mountains.json","src/animations/pink-mode/movie-camera.json","src/animations/pink-mode/pinata.json","src/animations/pink-mode/script.json","src/animations/pink-mode/video-camera.json"]);function dZ(){return du.lottie?Promise.resolve(du.lottie):du.bodymovin?Promise.resolve(du.bodymovin):document.querySelector('script[data-loader="pink-mode-lottie"]')?new Promise(e=>{const t=document.querySelector('script[data-loader="pink-mode-lottie"]');t.dataset.loaded==="true"?e(du.lottie):t.addEventListener("load",()=>e(du.lottie),{once:!0})}):new Promise((e,t)=>{const r=document.createElement("script");r.src="src/vendor/lottie.min.js",r.async=!0,r.setAttribute("data-loader","pink-mode-lottie"),r.onload=()=>{r.dataset.loaded="true",e(du.lottie)},r.onerror=t,document.head.appendChild(r)})}class Gq{constructor(){this.active=!1}activate(){this.active=!0,document.body.classList.add("pink-mode-active")}deactivate(){this.active=!1,document.body.classList.remove("pink-mode-active")}triggerRain(){}}const Mq=new Gq,_q='<svg viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="m1 40c0-8 3-17 3-17a4.84 4.84 0 0 0-1.829-3.064 1 1 0 0 1 .45-1.716 19.438 19.438 0 0 1 4.379-.22c.579-2.317-1.19-3.963-2.782-4.938a1 1 0 0 1 .393-1.85 14.128 14.128 0 0 1 6.389.788c0-.958-1.147-2.145-2.342-3.122a1 1 0 0 1 .708-1.773 40.655 40.655 0 0 1 6.634.895 3.723 3.723 0 0 0-1.049-2.264 1 1 0 0 1 .823-1.652c6.151.378 9.226 1.916 9.226 1.916l10-1s8.472-2.311 15.954.5a1 1 0 0 1-.084 1.9c-1.455.394-2.87 1.143-2.87 2.6 0 0 4.426.738 5.675 4.114a1 1 0 0 1-1.228 1.317c-1.64-.48-4.273-.88-6.447.569Z" fill="#805333" /><path d="m30.18 42.82c1.073 2.7 2.6 9.993 3.357 13.8a2 2 0 0 1-1.964 2.38h-28.573a2 2 0 0 1-2-2v-18c0-2.55 10.03-22.11 23.99-23.87Z" fill="#a56a43" /><path d="m55.67 48.46-6.34 2.97a6 6 0 0 1-7.98-2.88l-.25-.54-.76-1.6a4.956 4.956 0 0 0-4.68-2.87c-.22.01-.44.02-.66.02a16.019 16.019 0 0 1-8.28-29.66c-1.81-2.97-3.45-8.03 2.03-12.49a2.1 2.1 0 0 1 2.5 0c4.23 3.45 4.21 7.25 3.16 10.17a16 16 0 0 1 15.91 11.36l5.31 11.31 2.92 6.22a6.008 6.008 0 0 1-2.88 7.99Z" fill="#cb8252" /><circle cx="42" cy="26" r="3" fill="#2c2f38" /><circle cx="54" cy="43" r="1" fill="#805333" /><path d="m58.55 40.47-2.92-6.22-14.53 13.76.25.54a6 6 0 0 0 7.98 2.88l6.34-2.97a6.008 6.008 0 0 0 2.88-7.99Zm-4.55 3.53a1 1 0 1 1 1-1 1 0 0 1-1 1Z" fill="#cf976a" /><circle cx="41" cy="25" r="1.25" fill="#ecf0f1" /></svg>',pZ='<path d="M44 19 L56 5 L49 22 Z" fill="#ffd700" />',TG=_q.replace("</svg>",pZ+"</svg>"),mZ=TG.replace(/#805333/g,"#d63384").replace(/#a56a43/g,"#e83e8c").replace(/#cb8252/g,"#fd7e14").replace(/#cf976a/g,"#ffc0cb"),gZ=TG.replace(/#805333/g,"#6f42c1").replace(/#a56a43/g,"#d63384").replace(/#cb8252/g,"#e83e8c").replace(/#cf976a/g,"#e0cffc"),yZ=TG.replace(/#805333/g,"#0dcaf0").replace(/#a56a43/g,"#6f42c1").replace(/#cb8252/g,"#d63384").replace(/#cf976a/g,"#9ec5fe"),hZ=[{className:"icon-svg pink-mode-icon",markup:mZ,lottiePath:"src/animations/horn.json"},{className:"icon-svg pink-mode-icon",markup:gZ,lottiePath:"src/animations/unicorn.json"},{className:"icon-svg pink-mode-icon",markup:yZ,lottiePath:"src/animations/rainbow.json"}],bZ={off:{className:"icon-svg pink-mode-icon",markup:_q},onSequence:hZ},Dq=bZ,SZ=e=>e,vZ=()=>{},EZ=()=>Promise.resolve(),AZ=dZ,CZ=()=>du.lottie,wZ=()=>Mq.activate(),LZ=()=>Mq.deactivate(),RZ=()=>{},TZ=()=>{},OZ=3e4,xZ="pink-mode-icon-pop",kZ=450,IZ=[],PZ=Object.freeze(Object.defineProperty({__proto__:null,PINK_MODE_ANIMATED_ICON_FILES:fZ,PINK_MODE_ICON_ANIMATION_CLASS:xZ,PINK_MODE_ICON_ANIMATION_RESET_DELAY:kZ,PINK_MODE_ICON_FALLBACK_MARKUP:IZ,PINK_MODE_ICON_INTERVAL_MS:OZ,PinkModeManager:Gq,ensurePinkModeLottieRuntimeExport:AZ,ensureSvgHasAriaHidden:SZ,loadPinkModeIconsFromFiles:EZ,pinkModeIcons:Dq,resolvePinkModeLottieRuntime:CZ,setPinkModeIconSequence:vZ,startPinkModeAnimatedIcons:wZ,startPinkModeIconPreload:TZ,stopPinkModeAnimatedIcons:LZ,triggerPinkModeIconRain:RZ},Symbol.toStringTag,{value:"Module"}));function BZ(){return typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}function Sb(e){return!!e&&(typeof e=="object"||typeof e=="function")}function Nq(){const e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:global;function t(s){return typeof Promise<"u"&&typeof Promise.resolve=="function"?Promise.resolve(s):{then:l=>t(l?l(s):s),catch:()=>this}}function r(){return e.lottie?t(e.lottie):e.bodymovin?t(e.bodymovin):typeof document>"u"?t(null):document.querySelector('script[data-loader="pink-mode-lottie"]')?new Promise(s=>{const l=document.querySelector('script[data-loader="pink-mode-lottie"]');l.dataset.loaded==="true"?s(e.lottie):l.addEventListener("load",()=>s(e.lottie),{once:!0})}):new Promise(s=>{const l=document.createElement("script");l.src="src/vendor/lottie.min.js",l.async=!0,l.setAttribute("data-loader","pink-mode-lottie"),l.onload=()=>{l.dataset.loaded="true",s(e.lottie)},l.onerror=()=>{s(null)},document.head.appendChild(l)})}class n{constructor(){this.active=!1}activate(){this.active=!0,document.body.classList.add("pink-mode-active")}deactivate(){this.active=!1,document.body.classList.remove("pink-mode-active")}triggerRain(){}}const o=new n,i=Object.freeze({off:Object.freeze({className:"icon-svg pink-mode-icon",markup:'<svg viewBox="0 0 60 60" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><path d="m1 40c0-8 3-17 3-17a4.84 4.84 0 0 0-1.829-3.064 1 1 0 0 1 .45-1.716 19.438 19.438 0 0 1 4.379-.22c.579-2.317-1.19-3.963-2.782-4.938a1 1 0 0 1 .393-1.85 14.128 14.128 0 0 1 6.389.788c0-.958-1.147-2.145-2.342-3.122a1 1 0 0 1 .708-1.773 40.655 40.655 0 0 1 6.634.895 3.723 3.723 0 0 0-1.049-2.264 1 1 0 0 1 .823-1.652c6.151.378 9.226 1.916 9.226 1.916l10-1s8.472-2.311 15.954.5a1 1 0 0 1-.084 1.9c-1.455.394-2.87 1.143-2.87 2.6 0 0 4.426.738 5.675 4.114a1 1 0 0 1-1.228 1.317c-1.64-.48-4.273-.88-6.447.569Z" fill="#805333" /><path d="m30.18 42.82c1.073 2.7 2.6 9.993 3.357 13.8a2 2 0 0 1-1.964 2.38h-28.573a2 2 0 0 1-2-2v-18c0-2.55 10.03-22.11 23.99-23.87Z" fill="#a56a43" /><path d="m55.67 48.46-6.34 2.97a6 6 0 0 1-7.98-2.88l-.25-.54-.76-1.6a4.956 4.956 0 0 0-4.68-2.87c-.22.01-.44.02-.66.02a16.019 16.019 0 0 1-8.28-29.66c-1.81-2.97-3.45-8.03 2.03-12.49a2.1 2.1 0 0 1 2.5 0c4.23 3.45 4.21 7.25 3.16 10.17a16 16 0 0 1 15.91 11.36l5.31 11.31 2.92 6.22a6.008 6.008 0 0 1-2.88 7.99Z" fill="#cb8252" /><circle cx="42" cy="26" r="3" fill="#2c2f38" /><circle cx="54" cy="43" r="1" fill="#805333" /><path d="m58.55 40.47-2.92-6.22-14.53 13.76.25.54a6 6 0 0 0 7.98 2.88l6.34-2.97a6.008 6.008 0 0 0 2.88-7.99Zm-4.55 3.53a1 1 0 1 1 1-1 1 0 0 1-1 1Z" fill="#cf976a" /><circle cx="41" cy="25" r="1.25" fill="#ecf0f1" /></svg>'}),onSequence:Object.freeze(Dq.onSequence)});return{pinkModeIcons:i,ensureSvgHasAriaHidden:s=>typeof s=="string"?s.trim():"",setPinkModeIconSequence:()=>!1,loadPinkModeIconsFromFiles(){return t(i)},ensurePinkModeLottieRuntime:r,resolvePinkModeLottieRuntime(){return r()},startPinkModeAnimatedIcons:()=>o.activate(),stopPinkModeAnimatedIcons:()=>o.deactivate(),triggerPinkModeIconRain:()=>{},startPinkModeIconPreload:()=>{},getPinkModeIconRotationTimer:()=>null,setPinkModeIconRotationTimer:()=>{},getPinkModeIconIndex:()=>0,setPinkModeIconIndex:()=>{},PINK_MODE_ICON_INTERVAL_MS:3e4,PINK_MODE_ICON_ANIMATION_CLASS:"pink-mode-icon-pop",PINK_MODE_ICON_ANIMATION_RESET_DELAY:450,PINK_MODE_ICON_FALLBACK_MARKUP:[]}}function GZ(e){return typeof cineCorePinkModeAnimations<"u"&&Sb(cineCorePinkModeAnimations)?cineCorePinkModeAnimations:e&&Sb(e.cineCorePinkModeAnimations)?e.cineCorePinkModeAnimations:PZ}function MZ(e){const t=Nq(),r=GZ(e);return Sb(r)?{pinkModeIcons:Sb(r.pinkModeIcons)?r.pinkModeIcons:t.pinkModeIcons,ensureSvgHasAriaHidden:typeof r.ensureSvgHasAriaHidden=="function"?r.ensureSvgHasAriaHidden:t.ensureSvgHasAriaHidden,setPinkModeIconSequence:typeof r.setPinkModeIconSequence=="function"?r.setPinkModeIconSequence:t.setPinkModeIconSequence,loadPinkModeIconsFromFiles:typeof r.loadPinkModeIconsFromFiles=="function"?r.loadPinkModeIconsFromFiles:t.loadPinkModeIconsFromFiles,ensurePinkModeLottieRuntime:typeof r.ensurePinkModeLottieRuntime=="function"?r.ensurePinkModeLottieRuntime:t.ensurePinkModeLottieRuntime,resolvePinkModeLottieRuntime:typeof r.resolvePinkModeLottieRuntime=="function"?r.resolvePinkModeLottieRuntime:t.resolvePinkModeLottieRuntime,startPinkModeAnimatedIcons:typeof r.startPinkModeAnimatedIcons=="function"?r.startPinkModeAnimatedIcons:t.startPinkModeAnimatedIcons,stopPinkModeAnimatedIcons:typeof r.stopPinkModeAnimatedIcons=="function"?r.stopPinkModeAnimatedIcons:t.stopPinkModeAnimatedIcons,triggerPinkModeIconRain:typeof r.triggerPinkModeIconRain=="function"?r.triggerPinkModeIconRain:t.triggerPinkModeIconRain,startPinkModeIconPreload:typeof r.startPinkModeIconPreload=="function"?r.startPinkModeIconPreload:t.startPinkModeIconPreload,getPinkModeIconRotationTimer:typeof r.getPinkModeIconRotationTimer=="function"?r.getPinkModeIconRotationTimer:t.getPinkModeIconRotationTimer,setPinkModeIconRotationTimer:typeof r.setPinkModeIconRotationTimer=="function"?r.setPinkModeIconRotationTimer:t.setPinkModeIconRotationTimer,getPinkModeIconIndex:typeof r.getPinkModeIconIndex=="function"?r.getPinkModeIconIndex:t.getPinkModeIconIndex,setPinkModeIconIndex:typeof r.setPinkModeIconIndex=="function"?r.setPinkModeIconIndex:t.setPinkModeIconIndex,PINK_MODE_ICON_INTERVAL_MS:typeof r.PINK_MODE_ICON_INTERVAL_MS=="number"?r.PINK_MODE_ICON_INTERVAL_MS:t.PINK_MODE_ICON_INTERVAL_MS,PINK_MODE_ICON_ANIMATION_CLASS:typeof r.PINK_MODE_ICON_ANIMATION_CLASS=="string"?r.PINK_MODE_ICON_ANIMATION_CLASS:t.PINK_MODE_ICON_ANIMATION_CLASS,PINK_MODE_ICON_ANIMATION_RESET_DELAY:typeof r.PINK_MODE_ICON_ANIMATION_RESET_DELAY=="number"?r.PINK_MODE_ICON_ANIMATION_RESET_DELAY:t.PINK_MODE_ICON_ANIMATION_RESET_DELAY,PINK_MODE_ICON_FALLBACK_MARKUP:Array.isArray(r.PINK_MODE_ICON_FALLBACK_MARKUP)?r.PINK_MODE_ICON_FALLBACK_MARKUP:t.PINK_MODE_ICON_FALLBACK_MARKUP}:t}const LA=BZ(),xo=MZ(LA),_Z={resolvePinkModeSupport(){return xo},createFallbackSupport:Nq,pinkModeIcons:xo.pinkModeIcons,ensureSvgHasAriaHidden:xo.ensureSvgHasAriaHidden,setPinkModeIconSequence:xo.setPinkModeIconSequence,loadPinkModeIconsFromFiles:xo.loadPinkModeIconsFromFiles,ensurePinkModeLottieRuntime:xo.ensurePinkModeLottieRuntime,resolvePinkModeLottieRuntime:xo.resolvePinkModeLottieRuntime,startPinkModeAnimatedIcons:xo.startPinkModeAnimatedIcons,stopPinkModeAnimatedIcons:xo.stopPinkModeAnimatedIcons,triggerPinkModeIconRain:xo.triggerPinkModeIconRain,startPinkModeIconPreload:xo.startPinkModeIconPreload||function(){},getPinkModeIconRotationTimer:xo.getPinkModeIconRotationTimer,setPinkModeIconRotationTimer:xo.setPinkModeIconRotationTimer,getPinkModeIconIndex:xo.getPinkModeIconIndex,setPinkModeIconIndex:xo.setPinkModeIconIndex,PINK_MODE_ICON_INTERVAL_MS:xo.PINK_MODE_ICON_INTERVAL_MS,PINK_MODE_ICON_ANIMATION_CLASS:xo.PINK_MODE_ICON_ANIMATION_CLASS,PINK_MODE_ICON_ANIMATION_RESET_DELAY:xo.PINK_MODE_ICON_ANIMATION_RESET_DELAY,PINK_MODE_ICON_FALLBACK_MARKUP:xo.PINK_MODE_ICON_FALLBACK_MARKUP};LA&&Sb(LA)&&(LA.cineCorePinkModeSupport=_Z);function OG(){return typeof globalThis<"u"&&globalThis&&typeof globalThis=="object"?globalThis:typeof window<"u"&&window&&typeof window=="object"?window:typeof self<"u"&&self&&typeof self=="object"?self:typeof global<"u"&&global&&typeof global=="object"?global:null}const cx=typeof globalThis<"u"&&globalThis&&typeof globalThis.CORE_GLOBAL_SCOPE=="object"?globalThis.CORE_GLOBAL_SCOPE:null,cr=cx&&typeof cx=="object"?cx:OG(),FI="cameraPowerPlanner_mountVoltages";let Yy="",RA="",FF=!1;const fE=e=>{if(!cr||typeof cr!="object")return"";const t=cr[e];return typeof t=="string"&&t?t:""},dE=(e,t)=>{if(!cr||typeof cr!="object"||typeof t!="string"||!t)return;let r=null;try{r=Object.getOwnPropertyDescriptor(cr,e)}catch{r=null}if(!(r&&r.configurable===!1&&r.writable===!1))try{cr[e]=t}catch{}},Fq=()=>{if(FF)return;let e=fE("MOUNT_VOLTAGE_STORAGE_KEY")||fE("MOUNT_VOLTAGE_STORAGE_KEY_RESOLVED");if(!e&&typeof getMountVoltageStorageKeyName=="function")try{const r=getMountVoltageStorageKeyName();typeof r=="string"&&r&&(e=r)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to resolve mount voltage storage key name",r)}!e&&typeof MOUNT_VOLTAGE_STORAGE_KEY_NAME=="string"&&MOUNT_VOLTAGE_STORAGE_KEY_NAME&&(e=MOUNT_VOLTAGE_STORAGE_KEY_NAME),e||(e=FI);let t=fE("MOUNT_VOLTAGE_STORAGE_BACKUP_KEY")||fE("MOUNT_VOLTAGE_STORAGE_BACKUP_KEY_RESOLVED");if(!t&&typeof getMountVoltageStorageBackupKeyName=="function")try{const r=getMountVoltageStorageBackupKeyName();typeof r=="string"&&r&&(t=r)}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to resolve mount voltage storage backup key name",r)}t||(t=`${e}__backup`),Yy=e||FI,RA=t||`${Yy}__backup`,FF=!0,dE("MOUNT_VOLTAGE_STORAGE_KEY",Yy),dE("MOUNT_VOLTAGE_STORAGE_KEY_RESOLVED",Yy),dE("MOUNT_VOLTAGE_STORAGE_BACKUP_KEY",RA),dE("MOUNT_VOLTAGE_STORAGE_BACKUP_KEY_RESOLVED",RA)},WL=()=>(Fq(),Yy||FI),xG=()=>(Fq(),RA||`${WL()}__backup`),Zd=(function(){if(cr&&Array.isArray(cr.SUPPORTED_MOUNT_VOLTAGE_TYPES)&&cr.SUPPORTED_MOUNT_VOLTAGE_TYPES.length>0)return cr.SUPPORTED_MOUNT_VOLTAGE_TYPES;const t=Object.freeze(["V-Mount","Gold-Mount","B-Mount"]);if(cr&&typeof cr=="object")try{cr.SUPPORTED_MOUNT_VOLTAGE_TYPES=t}catch{}return t})(),Za=(function(){if(cr&&cr.DEFAULT_MOUNT_VOLTAGES&&typeof cr.DEFAULT_MOUNT_VOLTAGES=="object")return cr.DEFAULT_MOUNT_VOLTAGES;const t=Object.freeze({"V-Mount":Object.freeze({high:14.4,low:12}),"Gold-Mount":Object.freeze({high:14.4,low:12}),"B-Mount":Object.freeze({high:33.6,low:21.6})});if(cr&&typeof cr=="object")try{cr.DEFAULT_MOUNT_VOLTAGES=t}catch{}return t})(),pE="Total Current (at {voltage}V):",jF="Current draw at the battery's main output ({voltage}V).",HF="Current draw at auxiliary outputs ({voltage}V).";function cg(e,t){let r=Number.NaN;if(typeof e=="number")r=e;else if(typeof e=="string"){const o=e.replace(",",".");r=Number.parseFloat(o)}if(!Number.isFinite(r)||r<=0)return t;const n=Math.min(1e3,Math.max(.1,r));return Math.round(n*100)/100}function ug(e=Za){const t={};return Zd.forEach(r=>{const n=e&&e[r]?e[r]:Za[r],o=cg(n&&n.high,Za[r].high),a=cg(n&&n.low,Za[r].low);t[r]={high:o,low:a}}),t}function jI(e){return ug(!e||typeof e!="object"?Za:e)}function qC(e){if(!e)return null;try{if(typeof e=="string"){const t=JSON.parse(e);return jI(t)}return jI(e)}catch(t){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not parse stored mount voltages",t),null}}function DZ(e){return Zd.includes(e)?e:"V-Mount"}let Fd=ug(Za),Ai=null,UF=null,kh=null,KC=null,WC=null,bd=cr&&cr.mountVoltageResetButton?cr.mountVoltageResetButton:typeof globalThis<"u"&&globalThis&&globalThis.mountVoltageResetButton?globalThis.mountVoltageResetButton:null,Ec=null;function kG(e){const t=cr||OG();if(!(!t||typeof t!="object"))try{t.mountVoltageResetButton=e}catch{t.mountVoltageResetButton=e}}function jq(e){const t=cr||OG();if(!(!t||typeof t!="object"))try{t.mountVoltageInputs=e}catch{t.mountVoltageInputs=e}}kG(bd);jq(Ai);function IG(e){const t=DZ(e),r=Fd[t]||Za[t];return{high:cg(r&&r.high,Za[t].high),low:cg(r&&r.low,Za[t].low)}}function NZ(){const e=typeof getSelectedPlate=="function"?getSelectedPlate():"V-Mount";return IG(e)}function Hq(){return ug(Fd)}function YL(e){if(typeof localStorage>"u")return;let t;try{t=JSON.stringify(e)}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not serialize mount voltage preferences",o);return}const r=WL();try{localStorage.setItem(r,t)}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not save mount voltage preferences",o)}const n=xG();try{localStorage.setItem(n,t)}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not save mount voltage backup copy",o)}}function FZ(e,t){const n=typeof t=="string"?t:typeof currentLang=="string"?currentLang:"en",o=Number(e);if(!Number.isFinite(o))return"";const a={maximumFractionDigits:2,minimumFractionDigits:o%1===0?0:1};if(typeof formatNumberForLang=="function")try{return formatNumberForLang(n,o,a)}catch(i){typeof console<"u"&&typeof console.warn=="function"&&console.warn("formatNumberForLang failed for voltage display",i)}try{return new Intl.NumberFormat(n,a).format(o)}catch{}return`${o}`}function zF(e){return Number.isFinite(e)?String(Math.round(Number(e)*100)/100):""}function PG(){if(!Ai)return;const e=Fd||Za;Zd.forEach(t=>{const r=Ai[t];if(!r)return;const n=e[t]||Za[t];r.high&&(r.high.value=zF(n&&n.high)),r.low&&(r.low.value=zF(n&&n.low))})}function mE(e,t,r){const n=typeof getLanguageTexts=="function"?getLanguageTexts(e):null,o=typeof getLanguageTexts=="function"&&typeof DEFAULT_LANGUAGE<"u"?getLanguageTexts(DEFAULT_LANGUAGE):null;return n&&typeof n[t]=="string"?n[t]:o&&typeof o[t]=="string"?o[t]:r}function gE(e,t,r,n){const o=FZ(t,r),a=typeof e=="string"&&e.includes("{voltage}")?e:n;return typeof a!="string"?o?`${o} V`:"":a.replace("{voltage}",o)}function vb(e,t,r){if(typeof document>"u")return;const o=typeof e=="string"?e:typeof currentLang=="string"?currentLang:"en",a=document.getElementById("totalCurrent144Label"),i=document.getElementById("totalCurrent12Label");if(!a||!i)return;const s=t||(typeof getSelectedPlate=="function"?getSelectedPlate():"V-Mount"),l=r||IG(s),c=mE(o,"totalCurrentHighLabelTemplate",pE),u=mE(o,"totalCurrentLowLabelTemplate",pE),f=mE(o,"totalCurrentHighHelpTemplate",jF),d=mE(o,"totalCurrentLowHelpTemplate",HF);a.textContent=gE(c,l.high,o,pE),i.textContent=gE(u,l.low,o,pE),a.setAttribute("data-help",gE(f,l.high,o,jF)),i.setAttribute("data-help",gE(d,l.low,o,HF))}typeof console<"u"&&console.log("mount-voltage.js: refreshTotalCurrentLabels defined");cr&&typeof cr=="object"&&(cr.refreshTotalCurrentLabels=vb);typeof globalThis<"u"&&globalThis?(globalThis.refreshTotalCurrentLabels=vb,globalThis.updateMountVoltageSettingLabels=HI):typeof window<"u"&&window&&(window.refreshTotalCurrentLabels=vb,window.updateMountVoltageSettingLabels=HI);function HI(e){const t=typeof DEFAULT_LANGUAGE=="string"?DEFAULT_LANGUAGE:"en",r=typeof e=="string"?e:typeof currentLang=="string"?currentLang:"en",n=typeof getLanguageTexts=="function"?getLanguageTexts(r):null,o=typeof getLanguageTexts=="function"?getLanguageTexts(t):null;if(!(!n&&!o)){if(kh){kh.textContent=n&&n.mountVoltageSettingsHeading||o&&o.mountVoltageSettingsHeading||"Battery mount voltages";const a=n&&n.mountVoltageSettingsHelp||o&&o.mountVoltageSettingsHelp||"";a&&kh.setAttribute("data-help",a)}if(KC&&(KC.textContent=n&&n.mountVoltageDescription||o&&o.mountVoltageDescription||""),WC&&(WC.textContent=n&&n.mountVoltageNote||texts&&texts.en&&texts.en.mountVoltageNote||""),bd){bd.textContent=n&&n.mountVoltageReset||texts&&texts.en&&texts.en.mountVoltageReset||"Restore defaults";const a=n&&n.mountVoltageResetHelp||texts&&texts.en&&texts.en.mountVoltageResetHelp||"";a&&bd.setAttribute("data-help",a)}Ec&&(Ec.V&&(Ec.V.textContent=n&&n.mountVoltageCardLabelV||texts&&texts.en&&texts.en.mountVoltageCardLabelV||"V-Mount"),Ec.Gold&&(Ec.Gold.textContent=n&&n.mountVoltageCardLabelGold||texts&&texts.en&&texts.en.mountVoltageCardLabelGold||"Gold Mount"),Ec.B&&(Ec.B.textContent=n&&n.mountVoltageCardLabelB||texts&&texts.en&&texts.en.mountVoltageCardLabelB||"B-Mount")),Ai&&Zd.forEach(a=>{const i=Ai[a];if(i){if(i.highLabel){i.highLabel.textContent=n&&n.mountVoltageHighLabel||texts&&texts.en&&texts.en.mountVoltageHighLabel||"High-voltage output";const s=n&&n.mountVoltageHighHelp||texts&&texts.en&&texts.en.mountVoltageHighHelp||"";s&&(i.highLabel.setAttribute("data-help",s),i.high&&i.high.setAttribute("data-help",s))}if(i.lowLabel){i.lowLabel.textContent=n&&n.mountVoltageLowLabel||texts&&texts.en&&texts.en.mountVoltageLowLabel||"Low-voltage output";const s=n&&n.mountVoltageLowHelp||texts&&texts.en&&texts.en.mountVoltageLowHelp||"";s&&(i.lowLabel.setAttribute("data-help",s),i.low&&i.low.setAttribute("data-help",s))}}})}}function BG(e,t){const{persist:r=!0,triggerUpdate:n=!0}=t||{};if(Fd=jI(e),r&&YL(Fd),n&&(PG(),vb(typeof currentLang=="string"?currentLang:"en"),typeof updateCalculations=="function"))try{updateCalculations()}catch(o){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to refresh calculations after voltage change",o)}}function Uq(e){BG(Za,e)}function jZ(e){const t=e||{};return UF=t.section||null,kh=t.heading||null,KC=t.description||null,WC=t.note||null,bd=t.resetButton||null,Ec=t.titles||null,Ai=t.inputs||null,kG(bd),jq(Ai),{section:UF,heading:kh,description:KC,note:WC,resetButton:bd,titles:Ec,inputs:Ai}}function zq(){if(!(typeof localStorage>"u"))try{const e=localStorage.getItem(WL()),t=qC(e);if(t){Fd=t;return}const r=localStorage.getItem(xG()),n=qC(r);n&&(Fd=n,YL(n))}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not load mount voltage preferences",e)}}zq();const Eb={SUPPORTED_MOUNT_VOLTAGE_TYPES:Zd,DEFAULT_MOUNT_VOLTAGES:Za,parseVoltageValue:cg,cloneMountVoltageMap:ug,getMountVoltagePreferencesClone:Hq,applyMountVoltagePreferences:BG,parseStoredMountVoltages:qC,resetMountVoltagePreferences:Uq,updateMountVoltageInputsFromState:PG,persistMountVoltagePreferences:YL};Object.defineProperty(Eb,"mountVoltageInputs",{enumerable:!0,get:()=>Ai});Object.freeze(Eb);const UI={SUPPORTED_MOUNT_VOLTAGE_TYPES:Zd,DEFAULT_MOUNT_VOLTAGES:Za,parseVoltageValue:cg,cloneMountVoltageMap:ug,getMountVoltagePreferencesClone:Hq,applyMountVoltagePreferences:BG,parseStoredMountVoltages:qC,resetMountVoltagePreferences:Uq,updateMountVoltageInputsFromState:PG,persistMountVoltagePreferences:YL,refreshTotalCurrentLabels:vb,updateMountVoltageSettingLabels:HI,getMountVoltageConfig:IG,getActiveMountVoltageConfig:NZ,syncMountVoltageResetButtonGlobal:kG,setMountVoltageDomReferences:jZ,reloadMountVoltagePreferencesFromStorage:zq,getMountVoltagePrimaryStorageKey:WL,getMountVoltageBackupStorageKey:xG,runtimeExports:Eb};Object.defineProperty(UI,"mountVoltageInputs",{enumerable:!0,get:()=>Ai});if(cr&&typeof cr=="object"){const e="cineCoreMountVoltage",t=cr[e]&&typeof cr[e]=="object"?cr[e]:{};for(const i of Object.keys(UI))t[i]=UI[i];if(!(()=>{if(!t||typeof t!="object"&&typeof t!="function"||typeof Object.isExtensible=="function"&&!Object.isExtensible(t))return!1;try{return Object.defineProperty(t,"mountVoltageInputs",{configurable:!0,enumerable:!0,get:()=>Ai}),!0}catch{}return!1})())try{t.mountVoltageInputs=Ai}catch{}try{cr[e]=t}catch{}if(!cr.SUPPORTED_MOUNT_VOLTAGE_TYPES)try{cr.SUPPORTED_MOUNT_VOLTAGE_TYPES=Zd}catch{}if(!cr.DEFAULT_MOUNT_VOLTAGES)try{cr.DEFAULT_MOUNT_VOLTAGES=Za}catch{}const n="MOUNT_VOLTAGE_RUNTIME_EXPORTS";let o=null;try{o=cr[n]}catch{o=null}(!o||typeof o!="object")&&(o={});for(const i of Object.keys(Eb))o[i]=Eb[i];if(!(()=>{if(!o||typeof o!="object"&&typeof o!="function"||typeof Object.isExtensible=="function"&&!Object.isExtensible(o))return!1;try{return Object.defineProperty(o,"mountVoltageInputs",{configurable:!0,enumerable:!0,get:()=>Ai}),!0}catch{}return!1})())try{o.mountVoltageInputs=Ai}catch{}try{cr[n]=o}catch{}}function HZ(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const jd=HZ();function UZ(e){if(typeof cineModuleBase=="object"&&cineModuleBase)return cineModuleBase;if(typeof require=="function")try{const t=require("../base.js");if(t&&typeof t=="object")return t}catch{}return e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}function zZ(e){if(e&&typeof e.cineModuleGlobals=="object")return e.cineModuleGlobals;if(typeof require=="function")try{const t=require("../globals.js");if(t&&typeof t=="object")return t}catch{}return null}function $q(e,t,r,n){const o=r||jd;if(!o||typeof o!="object"&&typeof o!="function")return!1;const a={configurable:n&&n.configurable!==!1,enumerable:!!(n&&n.enumerable),value:t,writable:!!(n&&n.writable)};try{return Object.defineProperty(o,e,a),!0}catch{}try{return o[e]=t,!0}catch{}return!1}function Vq(){return!1}function TA(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}const $Z={exposeGlobal(e,t,r,n){return $q(e,t,r,n||{})},registerOrQueueModule:Vq,getModuleRegistry(){return null},safeWarn:TA},jc=UZ(jd)||$Z,Om=zZ(jd),VZ=typeof jc.getModuleRegistry=="function"?jc.getModuleRegistry(jd):null,qZ=typeof jc.exposeGlobal=="function"?function(t,r,n){return jc.exposeGlobal(t,r,jd,n||{})}:function(t,r,n){return $q(t,r,jd,n||{})},KZ=typeof jc.registerOrQueueModule=="function"?function(t,r,n,o){return jc.registerOrQueueModule(t,r,n,o,jd,VZ)}:Vq,YC=(function(){return Om&&typeof Om.safeWarn=="function"?function(r,n){try{Om.safeWarn(r,n)}catch(o){TA(r,o)}}:jc&&typeof jc.safeWarn=="function"?function(r,n){try{jc.safeWarn(r,n)}catch(o){TA(r,o)}}:TA})();function WZ(e,t){if(!(!Om||typeof Om.recordModule!="function"))try{Om.recordModule(e,t)}catch{}}const zI=["populateSelect","refreshDeviceLists","hasAnyDeviceSelection","refreshAutoGearCameraOptions","refreshAutoGearCameraWeightCondition","refreshAutoGearMonitorOptions","refreshAutoGearTripodHeadOptions","refreshAutoGearTripodBowlOptions","refreshAutoGearTripodTypesOptions","refreshAutoGearTripodSpreaderOptions","refreshAutoGearWirelessOptions","refreshAutoGearMotorsOptions","refreshAutoGearControllersOptions","refreshAutoGearCrewOptions","refreshAutoGearDistanceOptions","exportAutoGearRules","generatePrintableOverview","generateGearListHtml","displayGearAndRequirements","updateGearListButtonVisibility","overviewSectionIcons","scenarioIcons","populateFeatureSearch","restoreFeatureSearchDefaults","updateFeatureSearchValue","updateFeatureSearchSuggestions","featureSearchEntries","featureSearchDefaultOptions","applyAccentColor","clearAccentColorOverrides","updateAccentColorResetButtonState","refreshDarkModeAccentBoost","isHighContrastActive","accentColor","prevAccentColor","revertAccentColor","DEFAULT_ACCENT_COLOR","HIGH_CONTRAST_ACCENT_COLOR","fontSize","fontFamily","applyDarkMode","applyPinkMode","applyHighContrast","setupInstallBanner","ensureZoomRemoteSetup","generateConnectorSummary","diagramConnectorIcons","DIAGRAM_MONITOR_ICON"],qq=Object.create(null);function YZ(e,t){typeof t>"u"||(qq[e]=t)}function QZ(e){if(!e||typeof e!="object")return YC("cineCoreExperience.install received invalid payload."),!1;let t=!1;for(let r=0;r<zI.length;r+=1){const n=zI[r];Object.prototype.hasOwnProperty.call(e,n)&&(YZ(n,e[n]),t=!0)}return t||YC("cineCoreExperience.install did not receive any recognised exports."),t}function XZ(e,t){const r={};for(let n=0;n<t.length;n+=1){const o=t[n];r[o]={configurable:!1,enumerable:!0,get(){return qq[o]}}}Object.defineProperties(e,r)}const GG={};XZ(GG,zI);Object.defineProperty(GG,"install",{configurable:!1,enumerable:!1,writable:!1,value:QZ});const MG=Object.freeze(GG);WZ("cineCoreExperience",MG);KZ("cineCoreExperience",MG,{category:"experience",description:"Experience helpers for UI orchestration, feature discovery, and presentation.",replace:!0,freeze:!1,connections:["cineModuleBase","cineModuleGlobals","cineUi"]},e=>{YC("Unable to register cineCoreExperience module.",e)});const JZ=qZ("cineCoreExperience",MG,{configurable:!0,enumerable:!1,writable:!1});JZ||YC("Unable to expose cineCoreExperience globally.");function ZZ(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const Hd=ZZ();function eee(e){if(typeof cineModuleBase=="object"&&cineModuleBase)return cineModuleBase;if(typeof require=="function")try{const t=require("../base.js");if(t&&typeof t=="object")return t}catch{}return e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}function tee(e){if(e&&typeof e.cineModuleGlobals=="object")return e.cineModuleGlobals;if(typeof require=="function")try{const t=require("../globals.js");if(t&&typeof t=="object")return t}catch{}return null}function Kq(e,t,r,n){const o=r||Hd;if(!o||typeof o!="object"&&typeof o!="function")return!1;const a={configurable:n&&n.configurable!==!1,enumerable:!!(n&&n.enumerable),value:t,writable:!!(n&&n.writable)};try{return Object.defineProperty(o,e,a),!0}catch{}try{return o[e]=t,!0}catch{}return!1}function Wq(){return!1}function OA(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}const ree={exposeGlobal(e,t,r,n){return Kq(e,t,r,n||{})},registerOrQueueModule:Wq,getModuleRegistry(){return null},safeWarn:OA},Hc=eee(Hd)||ree,xm=tee(Hd),nee=typeof Hc.getModuleRegistry=="function"?Hc.getModuleRegistry(Hd):null,oee=typeof Hc.exposeGlobal=="function"?function(t,r,n){return Hc.exposeGlobal(t,r,Hd,n||{})}:function(t,r,n){return Kq(t,r,Hd,n||{})},aee=typeof Hc.registerOrQueueModule=="function"?function(t,r,n,o){return Hc.registerOrQueueModule(t,r,n,o,Hd,nee)}:Wq,QC=(function(){return xm&&typeof xm.safeWarn=="function"?function(r,n){try{xm.safeWarn(r,n)}catch(o){OA(r,o)}}:Hc&&typeof Hc.safeWarn=="function"?function(r,n){try{Hc.safeWarn(r,n)}catch(o){OA(r,o)}}:OA})();function iee(e,t){if(!(!xm||typeof xm.recordModule!="function"))try{xm.recordModule(e,t)}catch{}}const $I=["ensureDefaultProjectInfoSnapshot","skipNextGearListRefresh","alignActiveAutoGearPreset","reconcileAutoGearAutoPresetState","openAutoGearEditor","closeAutoGearEditor","saveAutoGearRuleFromEditor","handleAutoGearImportSelection","handleAutoGearPresetSelection","handleAutoGearSavePreset","handleAutoGearDeletePreset","applyAutoGearBackupVisibility","renderAutoGearBackupControls","renderAutoGearBackupRetentionControls","renderAutoGearDraftImpact","renderAutoGearDraftLists","renderAutoGearMonitorDefaultsControls","renderAutoGearPresetsControls","renderAutoGearRulesList","updateAutoGearCameraWeightDraft","updateAutoGearShootingDaysDraft","setAutoGearAutoPresetId","syncAutoGearAutoPreset","updateAutoGearCatalogOptions","updateAutoGearItemButtonState","updateAutoGearMonitorDefaultOptions","applyFavoritesToSelect","updateFavoriteButton","toggleFavorite","loadStoredLogoPreview","renderSettingsLogoPreview","loadFeedbackSafe","saveFeedbackSafe","saveCurrentGearList"],Yq=Object.create(null);function see(e,t){typeof t>"u"||(Yq[e]=t)}function lee(e){if(!e||typeof e!="object")return QC("cineCoreGuard.install received invalid payload."),!1;let t=!1;for(let r=0;r<$I.length;r+=1){const n=$I[r];Object.prototype.hasOwnProperty.call(e,n)&&(see(n,e[n]),t=!0)}return t||QC("cineCoreGuard.install did not receive any recognised exports."),t}function cee(e,t){const r={};for(let n=0;n<t.length;n+=1){const o=t[n];r[o]={configurable:!1,enumerable:!0,get(){return Yq[o]}}}Object.defineProperties(e,r)}const _G={};cee(_G,$I);Object.defineProperty(_G,"install",{configurable:!1,enumerable:!1,writable:!1,value:lee});const DG=Object.freeze(_G);iee("cineCoreGuard",DG);aee("cineCoreGuard",DG,{category:"safety",description:"Persistence guards that preserve autosaves, presets, and backup state across workflows.",replace:!0,freeze:!1,connections:["cineModuleBase","cineModuleGlobals","cinePersistence"]},e=>{QC("Unable to register cineCoreGuard module.",e)});const uee=oee("cineCoreGuard",DG,{configurable:!0,enumerable:!1,writable:!1});uee||QC("Unable to expose cineCoreGuard globally.");function fee(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const Ud=fee();function dee(e){if(typeof cineModuleBase=="object"&&cineModuleBase)return cineModuleBase;if(typeof require=="function")try{const t=require("../base.js");if(t&&typeof t=="object")return t}catch{}return e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}function pee(e){if(e&&typeof e.cineModuleGlobals=="object")return e.cineModuleGlobals;if(typeof require=="function")try{const t=require("../globals.js");if(t&&typeof t=="object")return t}catch{}return null}function Qq(e,t,r,n){const o=r||Ud;if(!o||typeof o!="object"&&typeof o!="function")return!1;const a={configurable:n&&n.configurable!==!1,enumerable:!!(n&&n.enumerable),value:t,writable:!!(n&&n.writable)};try{return Object.defineProperty(o,e,a),!0}catch{}try{return o[e]=t,!0}catch{}return!1}function Xq(){return!1}function xA(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}const mee={exposeGlobal(e,t,r,n){return Qq(e,t,r,n||{})},registerOrQueueModule:Xq,getModuleRegistry(){return null},safeWarn:xA},Uc=dee(Ud)||mee,km=pee(Ud),gee=typeof Uc.getModuleRegistry=="function"?Uc.getModuleRegistry(Ud):null,yee=typeof Uc.exposeGlobal=="function"?function(t,r,n){return Uc.exposeGlobal(t,r,Ud,n||{})}:function(t,r,n){return Qq(t,r,Ud,n||{})},hee=typeof Uc.registerOrQueueModule=="function"?function(t,r,n,o){return Uc.registerOrQueueModule(t,r,n,o,Ud,gee)}:Xq,XC=(function(){return km&&typeof km.safeWarn=="function"?function(r,n){try{km.safeWarn(r,n)}catch(o){xA(r,o)}}:Uc&&typeof Uc.safeWarn=="function"?function(r,n){try{Uc.safeWarn(r,n)}catch(o){xA(r,o)}}:xA})();function bee(e,t){if(!(!km||typeof km.recordModule!="function"))try{km.recordModule(e,t)}catch{}}const VI=["deriveProjectInfo","updateCalculations","checkSetupChanged","currentProjectInfo","setCurrentProjectInfo","getCurrentProjectInfo","collectProjectFormData","populateProjectForm","renderFilterDetails","collectFilterSelections","collectFilterTokens","parseFilterTokens","applyFilterSelectionsToGearList","normalizeSpellingVariants","normalizeSearchValue","getPowerSelectionSnapshot","applyStoredPowerSelection","getGearListSelectors","applyGearListSelectors"],Jq=Object.create(null);function See(e,t){typeof t>"u"||(Jq[e]=t)}function vee(e){if(!e||typeof e!="object")return XC("cineCoreProject.install received invalid payload."),!1;let t=!1;for(let r=0;r<VI.length;r+=1){const n=VI[r];Object.prototype.hasOwnProperty.call(e,n)&&(See(n,e[n]),t=!0)}return t||XC("cineCoreProject.install did not receive any recognised exports."),t}function Eee(e,t){const r={};for(let n=0;n<t.length;n+=1){const o=t[n];r[o]={configurable:!1,enumerable:!0,get(){return Jq[o]}}}Object.defineProperties(e,r)}const NG={};Eee(NG,VI);Object.defineProperty(NG,"install",{configurable:!1,enumerable:!1,writable:!1,value:vee});const FG=Object.freeze(NG);bee("cineCoreProject",FG);hee("cineCoreProject",FG,{category:"domain",description:"Project intelligence helpers for derived metadata, selectors, and calculations.",replace:!0,freeze:!1,connections:["cineModuleBase","cineModuleGlobals","cineCoreShared"]},e=>{XC("Unable to register cineCoreProject module.",e)});const Aee=yee("cineCoreProject",FG,{configurable:!0,enumerable:!1,writable:!1});Aee||XC("Unable to expose cineCoreProject globally.");function Cee(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const Xt=Cee();function wee(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const Bs=wee(Xt),$F=Bs&&typeof Bs.freezeDeep=="function"?Bs.freezeDeep:function(t){if(!t||typeof t=="function"||typeof t!="object"&&typeof t!="function")return t;const r=new WeakSet;function n(o){if(!o||typeof o!="object"&&typeof o!="function")return o;const a=typeof o=="function";if(r.has(o))return o;if(r.add(o),a){try{Object.freeze(o)}catch{}return o}try{const i=Object.getOwnPropertyNames(o);for(let s=0;s<i.length;s+=1){const l=i[s];let c;try{c=o[l]}catch(u){c=void 0}!c||typeof c=="function"||typeof c!="object"&&typeof c!="function"||n(c)}Object.freeze(o)}catch{}return o}return n(t)},Lee=Bs&&typeof Bs.exposeGlobal=="function"?function(t,r,n){return Bs.exposeGlobal(t,r,Xt,n||{})}:function(t,r){try{return Xt[t]=r,!0}catch{return!1}},Ree=Bs&&typeof Bs.getModuleRegistry=="function"?Bs.getModuleRegistry(Xt):null,Tee=Bs&&typeof Bs.registerOrQueueModule=="function"?function(t,r,n,o){return Bs.registerOrQueueModule(t,r,n,o,Xt,Ree)}:function(){return!1},Ab="auto-backup-",Cb="auto-backup-before-delete-",jG=["cameraPowerPlanner_","cinePowerPlanner_"],Zq="cinePowerPlannerBackupVault",JC="queuedBackups",Oee=1,ZC="cineBackupVaultFallbackRecords";let Ac=null;const wb=new Map;let kA=!1,Fp=null,Qy="none",vs=0,ec=0,Ih=!1,ew={storageType:"indexeddb"};function xee(e,t){const r=t&&typeof t=="object"?t:{},n=typeof r.storageType=="string"?r.storageType:e?ec>0?"memory":"fallback":"indexeddb",o=n!=="memory",a=Ih!==!!e||ew.storageType!==n;Ih=!!e,ew={storageType:n,durable:o},a&&iK("cineBackupVault:fallbackChanged",{active:Ih,storageType:n,durable:o})}function ca(e){const t=ec>0||vs>0,r=e&&typeof e=="object"?{...e}:{};t?ec>0?r.storageType="memory":vs>0?r.storageType="fallback":typeof r.storageType!="string"&&(r.storageType="indexeddb"):r.storageType="indexeddb",xee(t,r)}function eK(){return{active:Ih,storageType:ew.storageType,durable:ew.durable}}function tK(){return Ih}function kee(){let e=[];return{save(t){return e=e.filter(r=>r&&r.id!==t.id),e.push({...t}),e.sort((r,n)=>{const o=typeof r.createdAtMs=="number"?r.createdAtMs:0,a=typeof n.createdAtMs=="number"?n.createdAtMs:0;return o-a}),ec=e.length,ca({storageType:"memory"}),Promise.resolve({id:t.id,persisted:!0,durable:!1,storageType:"memory"})},list(){return Promise.resolve(e.map(t=>({...t})))},remove(t){return e=e.filter(r=>r&&r.id!==t),ec=e.length,ca(ec>0?{storageType:"memory"}:null),Promise.resolve(!0)}}}const Lb=kee();function rK(){kA=!1,Fp=null,Qy="none"}function tw(e){return!e||typeof e!="object"?!1:typeof e.getItem=="function"&&typeof e.setItem=="function"}function nK(){if(kA&&tw(Fp))return{storage:Fp,type:Qy};const e=[()=>{if(typeof getSafeLocalStorage=="function")try{return getSafeLocalStorage()}catch(t){console.warn("getSafeLocalStorage threw while resolving backup vault fallback storage",t)}return null},()=>typeof SAFE_LOCAL_STORAGE<"u"&&SAFE_LOCAL_STORAGE?SAFE_LOCAL_STORAGE:null,()=>Xt&&Xt.sessionStorage?Xt.sessionStorage:null,()=>typeof sessionStorage<"u"?sessionStorage:null,()=>Xt&&Xt.localStorage?Xt.localStorage:null,()=>typeof localStorage<"u"?localStorage:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r!="function")continue;let n=null;try{n=r()}catch(o){console.warn("Backup vault fallback storage resolver failed",o),n=null}if(tw(n))return kA=!0,Fp=n,Qy=t<=1?"safe-local-storage":t<=3?"session-storage":"local-storage",{storage:Fp,type:Qy}}return kA=!0,Fp=null,Qy="none",{storage:null,type:"none"}}function HG(){const{storage:e}=nK();if(!tw(e))return vs=0,ca(),[];let t=null;try{t=e.getItem(ZC)}catch(o){return console.warn("Failed to read fallback backup vault storage contents",o),rK(),vs=0,ca(ec>0?{storageType:"memory"}:null),[]}if(typeof t!="string"||!t)return vs=0,ca(),[];let r;try{r=JSON.parse(t)}catch(o){return console.warn("Failed to parse fallback backup vault entries",o),vs=0,ca(ec>0?{storageType:"memory"}:null),[]}if(!Array.isArray(r))return vs=0,ca(),[];const n=[];for(let o=0;o<r.length;o+=1){const a=r[o];!a||typeof a!="object"||typeof a.id!="string"||n.push({...a})}return vs=n.length,ca(n.length>0?{storageType:"fallback"}:null),n}function UG(e){const{storage:t}=nK();if(!tw(t))return vs=0,ca(ec>0?{storageType:"memory"}:null),!1;const r=Array.isArray(e)?e:[];if(r.length===0)try{return t.removeItem(ZC),vs=0,ca(null),!0}catch(o){return console.warn("Failed to remove fallback backup vault entries",o),!1}let n="[]";try{n=JSON.stringify(r)}catch(o){return console.warn("Failed to serialize fallback backup vault entries",o),!1}try{return t.setItem(ZC,n),vs=r.length,ca(r.length>0?{storageType:"fallback"}:null),!0}catch(o){return console.warn("Failed to persist fallback backup vault entries",o),rK(),ca(ec>0?{storageType:"memory"}:null),!1}}function ux(e){const t=HG(),r=new Map;t.forEach(o=>{!o||typeof o!="object"||typeof o.id!="string"||r.set(o.id,{...o})}),r.set(e.id,{...e});const n=Array.from(r.values());return n.sort((o,a)=>{const i=typeof o.createdAtMs=="number"?o.createdAtMs:0,s=typeof a.createdAtMs=="number"?a.createdAtMs:0;return i-s}),UG(n)?Promise.resolve({id:e.id,persisted:!0,durable:!0,storageType:"fallback"}):Lb.save(e)}function Iee(e){if(!e)return Promise.resolve(!1);const t=HG();if(!t.length)return Promise.resolve(!1);const r=t.filter(o=>o&&o.id!==e);if(r.length===t.length)return vs=t.length,ca(t.length>0?{storageType:"fallback"}:null),Promise.resolve(!1);const n=UG(r);return Promise.resolve(!!n)}function Pee(e,t,r){const n=new Map,o=(i,s)=>{Array.isArray(i)&&i.forEach(l=>{if(!l||typeof l!="object"||typeof l.id!="string")return;const c={...l,storageType:s};s!=="memory"?c.durable=!0:c.durable=!1;const u=n.get(c.id);if(!u){n.set(c.id,c);return}const f=typeof u.createdAtMs=="number"?u.createdAtMs:0;(typeof c.createdAtMs=="number"?c.createdAtMs:0)>=f&&n.set(c.id,c)})};o(e,"indexeddb"),o(t,"fallback"),o(r,"memory");const a=Array.from(n.values());return a.sort((i,s)=>{const l=typeof i.createdAtMs=="number"?i.createdAtMs:0,c=typeof s.createdAtMs=="number"?s.createdAtMs:0;return l-c}),a}function oK(){return typeof indexedDB<"u"&&indexedDB!==null}function Bee(){return oK()?Ac||(Ac=new Promise(e=>{let t=!1;try{const r=indexedDB.open(Zq,Oee);r.addEventListener("upgradeneeded",n=>{const o=n.target.result;o.objectStoreNames.contains(JC)||o.createObjectStore(JC,{keyPath:"id"}).createIndex("createdAtMs","createdAtMs",{unique:!1})}),r.addEventListener("success",()=>{const n=r.result;t=!0,n.onversionchange=()=>{n.close(),Ac&&(Ac=null)},e(n)}),r.addEventListener("error",()=>{t||console.warn("Failed to open backup vault IndexedDB database",r.error),e(null)})}catch(r){console.warn("Unable to open backup vault IndexedDB database",r),e(null)}}),Ac):Promise.resolve(null)}function QL(e,t){return Bee().then(r=>r?new Promise((n,o)=>{let a=!1;try{const i=r.transaction(JC,e),s=i.objectStore(JC),l=t(s,i);i.addEventListener("complete",()=>{a||(a=!0,n(l))}),i.addEventListener("error",()=>{a||(a=!0,o(i.error))})}catch(i){o(i)}}).catch(n=>(console.warn("Backup vault IndexedDB transaction failed",n),t(null))):t(null))}function Gee(e){const t=e&&typeof e.source=="string"&&e.source?e.source:"automatic",r=e&&typeof e.reason=="string"&&e.reason?e.reason:"unknown",n=e&&typeof e.permissionState=="string"&&e.permissionState?e.permissionState:"unknown",o=e&&typeof e.createdAt=="string"&&e.createdAt?e.createdAt:new Date().toISOString(),a=e&&typeof e.createdAtMs=="number"&&Number.isFinite(e.createdAtMs)?e.createdAtMs:Date.now();return{source:t,reason:r,permissionState:n,createdAt:o,createdAtMs:a}}function Mee(e,t,r={}){const n=typeof e=="string"&&e?e:"cine-power-planner-backup.json",o=Gee(r);return{id:r&&typeof r.id=="string"&&r.id?r.id:`queued-${o.createdAtMs}-${Math.random().toString(16).slice(2,10)}`,fileName:n,payload:t,createdAt:o.createdAt,createdAtMs:o.createdAtMs,metadata:{source:o.source,reason:o.reason,permissionState:o.permissionState}}}function _ee(e){return!e||typeof e!="object"||!e.id?Promise.resolve(null):QL("readwrite",t=>t?new Promise((r,n)=>{try{const o=t.put(e);o.addEventListener("success",()=>{ca({storageType:"indexeddb"}),r({id:e.id,persisted:!0,durable:!0,storageType:"indexeddb"})}),o.addEventListener("error",()=>{n(o.error)})}catch(o){n(o)}}).catch(r=>(console.warn("Failed to persist backup vault record to IndexedDB",r),ux(e))):ux(e)).catch(t=>(console.warn("Backup vault persistence failed",t),ux(e)))}function Dee(){const e=QL("readonly",n=>n?new Promise((o,a)=>{try{const i=n.getAll();i.addEventListener("success",()=>{o(Array.isArray(i.result)?i.result:[])}),i.addEventListener("error",()=>{a(i.error)})}catch(i){a(i)}}).catch(o=>(console.warn("Failed to read backup vault records from IndexedDB",o),[])):[]).catch(n=>(console.warn("Backup vault record enumeration failed",n),[])),t=Promise.resolve().then(()=>HG()).catch(n=>(console.warn("Failed to enumerate fallback backup vault records",n),[])),r=Lb.list().catch(()=>[]);return Promise.all([e,t,r]).then(n=>{const[o,a,i]=n;return Pee(o,a,i)})}function aK(e){if(!e)return Promise.resolve(!1);wb.delete(e);const t=QL("readwrite",r=>r?new Promise((n,o)=>{try{const a=r.delete(e);a.addEventListener("success",()=>{ca(),n(!0)}),a.addEventListener("error",()=>{o(a.error)})}catch(a){o(a)}}).catch(n=>(console.warn("Failed to remove backup vault record from IndexedDB",n),!1)):!1).catch(r=>(console.warn("Backup vault record removal failed",r),!1));return Promise.all([Promise.resolve(t),Iee(e),Lb.remove(e)]).then(r=>{const n=r.some(o=>!!o);return n||ca(),n})}function Nee(){const e=(async()=>{try{if(Ac){const t=await Ac;if(t&&typeof t.close=="function")try{t.close()}catch(r){console.warn("Failed to close backup vault DB before deletion",r)}}}catch(t){console.warn("Failed to await backup vault DB cleanup",t)}return Ac=null,new Promise((t,r)=>{if(!oK()){t(!0);return}try{const n=indexedDB.deleteDatabase(Zq);n.addEventListener("success",()=>{t(!0)}),n.addEventListener("error",()=>{console.warn("Failed to delete backup vault database",n.error),QL("readwrite",o=>o?new Promise((a,i)=>{const s=o.clear();s.onsuccess=()=>a(!0),s.onerror=()=>i(s.error)}):!1).then(t).catch(r)}),n.addEventListener("blocked",()=>{console.warn("Backup vault database deletion blocked"),t(!0)})}catch(n){r(n)}})})();return Promise.all([e,UG([]),Lb.list().then(t=>Promise.all(t.map(r=>Lb.remove(r.id))))]).then(()=>(ca(),wb.clear(),!0)).catch(t=>(console.warn("clearBackupVault encountered errors",t),!0))}function iK(e,t){if(!e)return;const r=[];Xt&&typeof Xt.dispatchEvent=="function"&&r.push(Xt),Xt&&Xt.document&&typeof Xt.document.dispatchEvent=="function"&&r.push(Xt.document),Xt&&Xt.window&&typeof Xt.window.dispatchEvent=="function"&&r.push(Xt.window);const n=typeof CustomEvent=="function"?CustomEvent:null;r.forEach(o=>{if(!(!o||typeof o.dispatchEvent!="function"))try{if(n)o.dispatchEvent(new CustomEvent(e,{detail:t}));else if(typeof Event=="function"){const a=new Event(e);a.detail=t,o.dispatchEvent(a)}}catch(a){console.warn("Failed to dispatch backup vault event",a)}})}function zG(){return Dee().then(e=>{const t=new Map;Array.isArray(e)&&e.forEach(n=>{!n||!n.id||t.has(n.id)||t.set(n.id,{...n})}),wb.forEach((n,o)=>{if(!t.has(o)){const a={...n};typeof a.storageType!="string"&&(a.storageType="transient"),typeof a.durable!="boolean"&&(a.durable=!1),t.set(o,a)}});const r=Array.from(t.values());return r.sort((n,o)=>{const a=typeof n.createdAtMs=="number"?n.createdAtMs:0,i=typeof o.createdAtMs=="number"?o.createdAtMs:0;return a-i}),r})}function $G(e,t,r){const n=Mee(e,t,r||{});wb.set(n.id,{...n});try{_ee(n).then(o=>{wb.delete(n.id),o&&o.durable===!1&&console.warn("Backup vault record stored using non-durable fallback storage.",o)}).catch(o=>{console.warn("Failed to persist queued backup payload. Using in-memory vault fallback.",o)})}catch(o){console.warn("Queued backup persistence threw unexpectedly",o)}return iK("cineBackupVault:queued",{id:n.id,fileName:n.fileName,createdAt:n.createdAt,metadata:n.metadata}),n}function Hl(){const e=Xt&&typeof Xt.texts=="object"?Xt.texts:null,t=Xt&&typeof Xt.currentLang=="string"?Xt.currentLang:Xt&&typeof Xt.appLanguage=="string"?Xt.appLanguage:"en",r=t&&typeof t=="string"?t:"en",n=e&&e[r]?e[r]:null,o=e&&e.en?e.en:null;return{langTexts:n,fallbackTexts:o}}function VG(e){const{langTexts:t,fallbackTexts:r}=Hl();return(t&&t.queuedBackupDownloadDeferred||r&&r.queuedBackupDownloadDeferred||"Automatic downloads were blocked. The backup was saved to the local vault.").replace("{fileName}",e||"cine-power-planner-backup.json")}function VF(){const{langTexts:e,fallbackTexts:t}=Hl();return e&&e.queuedBackupVaultEmpty||t&&t.queuedBackupVaultEmpty||"No queued backups are stored in the local vault."}function fx(){const{langTexts:e,fallbackTexts:t}=Hl();return e&&e.queuedBackupVaultTitle||t&&t.queuedBackupVaultTitle||"Local backup vault"}function Fee(){const{langTexts:e,fallbackTexts:t}=Hl();return e&&e.queuedBackupVaultIntro||t&&t.queuedBackupVaultIntro||"Automatic downloads were blocked. Use the actions below to export or copy each backup while offline."}function sK(){return zG().then(e=>{if(!e||!e.length){const f=VF();if(typeof Xt.showNotification=="function")try{return Xt.showNotification("info",f),!1}catch{}if(typeof Xt.cineShowAlertDialog=="function")Xt.cineShowAlertDialog({title:fx(),message:f});else if(typeof alert=="function")try{alert(f)}catch{}return!1}if(typeof window>"u"||typeof document>"u")return console.warn("Cannot open queued backup vault window outside of a browser context"),!1;let t=null;try{t=window.open("","cineBackupVault","noopener,noreferrer,width=780,height=720")}catch(f){console.warn("Failed to open local backup vault window",f),t=null}if(!t){const f=Hl().fallbackTexts&&Hl().fallbackTexts.queuedBackupVaultPopupBlocked?Hl().fallbackTexts.queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.";if(typeof Xt.showNotification=="function")try{return Xt.showNotification("error",f),!1}catch{}if(typeof Xt.cineShowAlertDialog=="function")Xt.cineShowAlertDialog({title:fx(),message:f});else if(typeof alert=="function")try{alert(f)}catch{}return!1}const r=fx(),n=Fee(),a=JSON.stringify(e.map(f=>({id:f.id,fileName:f.fileName,createdAt:f.createdAt,createdAtMs:f.createdAtMs,metadata:f.metadata,payload:f.payload}))).replace(/</g,"\\u003c"),i=VF(),s=`(() => {
  'use strict';
  try {
    var source = document.getElementById('queued-backups');
    var records = [];
    if (source) {
      var text = source.textContent || '';
      var parsed = JSON.parse(text);
      if (Array.isArray(parsed)) {
        records = parsed;
      }
    }
    var container = document.getElementById('vault');
    if (!container) {
      return;
    }
    if (!records.length) {
      var empty = document.createElement('p');
      empty.className = 'empty';
      empty.textContent = ${JSON.stringify(i)};
      container.appendChild(empty);
      return;
    }
    records.forEach(function (record) {
      var entry = document.createElement('section');
      entry.className = 'backup-entry';
      var header = document.createElement('header');
      var heading = document.createElement('h2');
      heading.textContent = String(record.fileName || 'cine-power-planner-backup.json') + '  ' + String(record.createdAt || '');
      header.appendChild(heading);
      var downloadButton = document.createElement('button');
      downloadButton.type = 'button';
      downloadButton.textContent = 'Download JSON';
      downloadButton.addEventListener('click', function () {
        try {
          var blob = new Blob([record.payload], { type: 'application/json' });
          var url = URL.createObjectURL(blob);
          var link = document.createElement('a');
          link.href = url;
          link.download = record.fileName || 'cine-power-planner-backup.json';
          link.click();
          setTimeout(function () { URL.revokeObjectURL(url); }, 60000);
        } catch (error) {
          if (typeof window.opener.cineShowAlertDialog === 'function') {
            window.opener.cineShowAlertDialog('Download blocked  copy the JSON below instead.');
          } else {
            alert('Download blocked  copy the JSON below instead.');
          }
        }
      });
      header.appendChild(downloadButton);
      entry.appendChild(header);
      var textArea = document.createElement('textarea');
      textArea.readOnly = true;
      textArea.value = record.payload;
      entry.appendChild(textArea);
      container.appendChild(entry);
    });
  } catch (error) {
    console.error('Failed to bootstrap queued backup vault', error);
  }
})();`,l=`data:text/javascript;charset=utf-8,${encodeURIComponent(s)}`,c=Hl().fallbackTexts&&Hl().fallbackTexts.queuedBackupVaultPopupBlocked?Hl().fallbackTexts.queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.",u=t.document;try{u.open(),u.write(`<!DOCTYPE html><html lang="en"><head><meta charset="utf-8" />
<title>${r}</title>
<style>
:root { color-scheme: light dark; font-family: 'Inter', 'Helvetica Neue', Arial, sans-serif; }
body { margin: 0; padding: 1.5rem; background: #0f1624; color: #f5f7fb; }
h1 { margin-top: 0; font-size: 1.5rem; }
p { line-height: 1.6; max-width: 38rem; }
.backup-entry { background: rgba(15, 22, 36, 0.65); border: 1px solid rgba(111, 120, 141, 0.35); border-radius: 1rem; padding: 1rem; margin-top: 1rem; }
.backup-entry header { display: flex; flex-wrap: wrap; gap: 0.75rem; align-items: baseline; justify-content: space-between; }
.backup-entry h2 { font-size: 1rem; margin: 0; }
.backup-entry button { background: #ffbf3c; border: none; border-radius: 999px; padding: 0.5rem 1.25rem; font-weight: 600; cursor: pointer; color: #11131a; }
.backup-entry button:focus { outline: 2px solid #ffffff; outline-offset: 2px; }
.backup-entry textarea { width: 100%; min-height: 10rem; margin-top: 0.75rem; border-radius: 0.75rem; border: 1px solid rgba(255, 255, 255, 0.12); padding: 0.75rem; background: rgba(6, 10, 18, 0.92); color: #f5f7fb; font-family: 'Fira Code', 'SFMono-Regular', 'Consolas', 'Menlo', monospace; }
.empty { margin-top: 2rem; font-style: italic; color: rgba(245, 247, 251, 0.7); }
.banner { margin-bottom: 1.5rem; padding: 1rem 1.25rem; border-radius: 1rem; background: rgba(255, 191, 60, 0.18); border: 1px solid rgba(255, 191, 60, 0.4); color: #ffe3a4; }
.banner strong { display: block; font-size: 1.1rem; margin-bottom: 0.35rem; }
</style>
</head><body>
<div class="banner"><strong>${r}</strong><p>${n}</p></div>
<main id="vault"></main>
<script type="application/json" id="queued-backups">${a}<\/script>
<script src="${l}"><\/script>
</body></html>`),u.close()}catch(f){console.warn("Failed to render queued backup vault window",f);try{u.close()}catch{}if(t.close(),typeof Xt.showNotification=="function")try{Xt.showNotification("error",c)}catch{}return!1}return!0})}const $u=new Set(["darkMode","pinkMode","highContrast","showAutoBackups","accentColor","fontSize","fontFamily","customLogo","cineRentalPrintSections","language"]);typeof IOS_PWA_HELP_STORAGE_KEY=="string"&&IOS_PWA_HELP_STORAGE_KEY?$u.add(IOS_PWA_HELP_STORAGE_KEY):Xt&&typeof Xt.IOS_PWA_HELP_STORAGE_KEY=="string"&&Xt.IOS_PWA_HELP_STORAGE_KEY?$u.add(Xt.IOS_PWA_HELP_STORAGE_KEY):$u.add("iosPwaHelpShown");const lK=new Set(["settings","storage","localStorage","values","entries","sessionStorage","sessionState","sessionEntries","payload","plannerData","allData","generatedAt","version","appVersion","applicationVersion"]),qG=["devices","setups","session","feedback","project","projects","gearList","favorites","documentationTracker","ownGear","autoGearRules","autoGearSeeded","autoGearBackups","autoGearPresets","autoGearMonitorDefaults","autoGearActivePresetId","autoGearAutoPresetId","autoGearShowBackups","autoGearBackupRetention","customLogo","customFonts","contacts","userProfile","preferences","schemaCache","fullBackupHistory","fullBackups","documentationTracker"],cK=new Set(["devices","setups","session","sessions","feedback","project","projects","gearList","favorites","documentationTracker","ownGear","autoGearRules","autoGearBackups","autoGearPresets","autoGearMonitorDefaults","contacts","userProfile","preferences","fullBackupHistory","fullBackups","customFonts","documentationTracker"]),qF=(()=>{const e=new Set;return $u&&typeof $u.forEach=="function"&&$u.forEach(t=>{typeof t=="string"&&t&&e.add(t)}),jG.forEach(t=>{typeof t!="string"||!t||qG.forEach(r=>{typeof r!="string"||!r||e.add(`${t}${r}`)})}),e})();function Li(e){if(e===null||typeof e!="object"||Array.isArray(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;let r;try{r=Object.getPrototypeOf(e)}catch{return!1}return r===null||r===Object.prototype}function ep(e){if(!e||typeof e!="object")return!1;if(Object.prototype.toString.call(e)==="[object Map]")return!0;if(typeof Map<"u")try{if(e instanceof Map)return!0}catch{}return typeof e.size=="number"&&typeof e.entries=="function"&&typeof e.forEach=="function"&&typeof e.get=="function"&&typeof e.set=="function"}function jee(e){if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean"||typeof e=="bigint")return String(e);if(typeof e=="symbol")return e.description||e.toString();if(e&&typeof e=="object")try{const t=JSON.stringify(e);if(t&&t!=="{}")return t}catch{}try{return String(e)}catch{}return null}function Pg(e){if(!ep(e))return null;const t=Object.create(null),r=(o,a)=>{const i=jee(o);i!=null&&(Object.prototype.hasOwnProperty.call(t,i)||(t[i]=a))};let n=!1;if(typeof e.entries=="function")try{const o=e.entries();if(o&&typeof o.next=="function"){for(let a=o.next();!a.done;a=o.next()){const i=a&&a.value;Array.isArray(i)&&i.length>=2&&r(i[0],i[1])}n=!0}}catch(o){console.warn("Unable to iterate map-like backup value entries",o)}if(!n&&typeof e.forEach=="function")try{e.forEach((o,a)=>{r(a,o)}),n=!0}catch(o){console.warn("Unable to iterate map-like backup value via forEach",o)}return!Object.keys(t).length&&!n?null:t}function uK(e){const t=e instanceof Date&&!Number.isNaN(e.valueOf())?e:new Date,r=p=>String(p).padStart(2,"0"),n=t.getFullYear(),o=r(t.getMonth()+1),a=r(t.getDate()),i=r(t.getHours()),s=r(t.getMinutes()),l=r(t.getSeconds()),c=t.getTimezoneOffset();let u="Z";if(c!==0){const p=c>0?"-":"+",h=Math.abs(c),m=r(Math.floor(h/60)),g=r(h%60);u=`${p}${m}:${g}`}const f=`${n}-${o}-${a}T${i}:${s}:${l}${u}`,d=f.replace(/[:]/g,"-");return{iso:f,fileName:`cine_power_planner_backup_${d}.json`}}function fK(){if(typeof getSafeLocalStorage=="function")try{const e=getSafeLocalStorage();if(e)return e}catch(e){console.warn("Unable to obtain safe local storage reference",e)}return typeof SAFE_LOCAL_STORAGE<"u"?SAFE_LOCAL_STORAGE:typeof localStorage<"u"?localStorage:null}function dK(e){const t=Object.create(null);if(!e)return t;const r=(s,l)=>{if(!(typeof s!="string"||!s)&&!Object.prototype.hasOwnProperty.call(t,s))try{const c=typeof l=="function"?l():l;t[s]=c}catch(c){console.warn("Failed to read storage entry for backup",s,c)}},n=()=>{if(typeof e.key!="function"||typeof e.length!="number")return!1;let s=0;try{s=Number(e.length)||0}catch(l){return console.warn("Failed to inspect storage length for backup snapshot",l),!0}for(let l=0;l<s;l+=1){let c;try{c=e.key(l)}catch(u){console.warn("Failed to access storage key for backup snapshot",u);continue}r(c,()=>e.getItem(c))}return!0},o=()=>{if(typeof e.keys!="function")return!1;let s;try{s=e.keys()}catch(c){return console.warn("Failed to enumerate storage keys for backup snapshot",c),!0}return s&&(c=>{if(c){if(typeof c.forEach=="function")c.forEach(u=>r(u,()=>e.getItem(u)));else if(typeof c[Symbol.iterator]=="function")for(const u of c)r(u,()=>e.getItem(u))}})(s),!0},a=()=>{if(typeof e.forEach!="function")return!1;try{e.forEach((s,l)=>{r(l,s)})}catch(s){console.warn("Failed to iterate storage for backup snapshot",s)}return!0};let i=!1;try{i=n()}catch(s){console.warn("Failed to snapshot storage via index enumeration",s)}if(!Object.keys(t).length)try{i=o()||i}catch(s){console.warn("Failed to snapshot storage via key enumeration",s)}if(!Object.keys(t).length&&!i)try{a()}catch(s){console.warn("Failed to snapshot storage via iteration",s)}else Object.keys(t).length||a();return typeof e.getItem=="function"&&qF.size&&qF.forEach(s=>{r(s,()=>e.getItem(s))}),t}function pK(e,t){if(!e||typeof e.getItem!="function")return()=>null;const r=typeof t=="string"&&t?t:"Failed to read storage key";return n=>{if(typeof n!="string")return null;try{return e.getItem(n)}catch(o){return console.warn(`${r}`,n,o),null}}}function mK(e){if(typeof sessionStorage>"u"||!sessionStorage)return;const t=e&&typeof e=="object"?Object.entries(e):[],r=new Set(t.map(([o])=>o)),n=[];try{const{length:o}=sessionStorage;for(let a=0;a<o;a+=1){const i=sessionStorage.key(a);typeof i=="string"&&(r.has(i)||n.push(i))}}catch(o){console.warn("Failed to inspect sessionStorage during restore rollback",o)}n.forEach(o=>{try{sessionStorage.removeItem(o)}catch(a){console.warn("Failed to remove sessionStorage key during restore rollback",o,a)}}),t.forEach(([o,a])=>{if(typeof o=="string")try{sessionStorage.setItem(o,typeof a=="string"?a:String(a))}catch(i){console.warn("Failed to reapply sessionStorage key during restore rollback",o,i)}})}function gK(e){if(typeof e=="string")return e;if(e==null)return"";if(typeof e=="object")try{return JSON.stringify(e)}catch(t){return console.warn("Failed to serialize stored value for backup compatibility",t),""}try{return String(e)}catch(t){return console.warn("Failed to normalize stored value for backup compatibility",t),""}}function Hee(e){if(!e)return null;let t=e;if(ep(t)){const o=Pg(t);o&&(t=o)}if(typeof t=="string"){let o=null;try{o=JSON.parse(t)}catch{o=null}if(o&&(Array.isArray(o)||Li(o)))t=o;else return null}const r=Object.create(null),n=(o,a)=>{typeof o!="string"||!o||(r[o]=gK(a))};if(Array.isArray(t))t.forEach(o=>{if(o){if(Array.isArray(o)){n(o[0],o[1]);return}if(typeof o=="object"){if(typeof o.key=="string"){n(o.key,o.value??o.val??o.data??o.content??o.string);return}if(typeof o.name=="string"){n(o.name,o.value??o.val??o.data??o.content??o.string);return}Array.isArray(o.entry)&&n(o.entry[0],o.entry[1])}}});else if(Li(t))Object.entries(t).forEach(([o,a])=>{n(o,a)});else return null;return Object.keys(r).length?r:null}function KF(e,t){let r=e;if(!Li(r))if(ep(r)){const n=Pg(r);if(n&&Li(n))r=n;else return{snapshot:null,keyUsed:null}}else return{snapshot:null,keyUsed:null};for(let n=0;n<t.length;n+=1){const o=t[n];if(!Object.prototype.hasOwnProperty.call(r,o))continue;const a=Hee(r[o]);if(a)return{snapshot:a,keyUsed:o}}return{snapshot:null,keyUsed:null}}function yK(e){return $u.has(e)?!0:jG.some(t=>e.startsWith(t))}function hK(e,t){if(!e||typeof e.setItem!="function")return;const r=t&&typeof t=="object"?Object.entries(t):[],n=new Set(r.map(([a])=>a)),o=[];try{const{length:a}=e;for(let i=0;i<a;i+=1){const s=e.key(i);typeof s=="string"&&!n.has(s)&&yK(s)&&o.push(s)}}catch(a){console.warn("Failed to inspect storage during restore rollback",a)}o.forEach(a=>{try{e.removeItem(a)}catch(i){console.warn("Failed to remove storage key during restore rollback",a,i)}}),r.forEach(([a,i])=>{if(typeof a=="string")try{i==null?e.removeItem(a):e.setItem(a,typeof i=="string"?i:String(i))}catch(s){console.warn("Failed to reapply storage key during restore rollback",a,s)}})}function Uee(e,t){let r=e;if(ep(r)){const o=Pg(r);o&&(r=o)}if(!Li(r))return null;const n=Object.create(null);return Object.entries(r).forEach(([o,a])=>{t.has(o)||yK(o)&&(n[o]=gK(a))}),Object.keys(n).length?n:null}function bK(e){if(ep(e)){const a=Pg(e);if(a)return a}if(!Array.isArray(e))return null;const t=Object.create(null),r=(a,i)=>{typeof a!="string"||!a||Object.prototype.hasOwnProperty.call(t,a)||(t[a]=i)},n=["key","name","section","type"],o=["value","data","content","payload","entries","items","record","snapshot","state","values","settings","sectionData","body"];return e.forEach(a=>{if(!a)return;if(Array.isArray(a)){r(a[0],a[1]);return}if(!Li(a))return;if(Array.isArray(a.entry)){r(a.entry[0],a.entry[1]);return}const i=n.find(l=>{const c=a[l];return typeof c=="string"&&c});if(!i)return;let s;for(let l=0;l<o.length;l+=1){const c=o[l];if(Object.prototype.hasOwnProperty.call(a,c)){s=a[c];break}}s===void 0&&(s=a.value??a.data??a.content??a.payload??a.entries??a.items??a.snapshot??a.state??a.values??a.settings),s!==void 0&&r(a[i],s)}),Object.keys(t).length?t:null}function fg(e){if(ep(e)){const t=Pg(e);if(t)return fg(t)}if(Li(e))return e;if(Array.isArray(e)){const t=bK(e);if(t)return t}if(typeof e=="string"){const t=WG(e);if(t)return t}if(e&&typeof e=="object"&&typeof e.toJSON=="function")try{const t=e.toJSON();if(Li(t)||Array.isArray(t))return fg(t)}catch(t){console.warn("Failed to convert backup data via toJSON",t)}return null}function XL(e,t){if(typeof e=="string"&&cK.has(e)){const r=fg(t);if(r)return r}return t}function rw(e,t){if(!Li(t)||!Object.keys(t).length)return e?{...e}:null;const r=e?{...e}:{};return Object.entries(t).forEach(([n,o])=>{typeof n=="string"&&(Object.prototype.hasOwnProperty.call(r,n)||(r[n]=XL(n,o)))}),r}const zee=new RegExp("[\0-]","g");function KG(e){if(e==null)return"";const t=n=>{if(typeof n!="object"||n===null)return null;const o=typeof Buffer<"u"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(n),a=Object.prototype.toString.call(n),i=typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||a==="[object ArrayBuffer]"||a==="[object SharedArrayBuffer]"),s=typeof ArrayBuffer>"u"?!1:typeof ArrayBuffer.isView=="function"&&ArrayBuffer.isView(n)?!0:!!(n&&typeof n=="object"&&typeof n.buffer=="object"&&typeof n.byteLength=="number"&&typeof n.BYTES_PER_ELEMENT=="number");if(!o&&!i&&!s)return null;const l=()=>{if(o)return new Uint8Array(n.buffer,n.byteOffset,n.byteLength);if(i)return new Uint8Array(n);if(typeof n.buffer=="object"&&typeof n.byteLength=="number"){const p=typeof n.byteOffset=="number"?n.byteOffset:0;return new Uint8Array(n.buffer,p,n.byteLength)}throw new TypeError("Unsupported binary payload type")},c=p=>{if(typeof TextDecoder!="function")return null;try{return new TextDecoder("utf-8",{fatal:!1}).decode(p)}catch(h){return console.warn("Failed to decode backup payload with TextDecoder",h),null}},u=()=>{if(!o)return null;try{return n.toString("utf8")}catch(p){return console.warn("Failed to decode backup payload with Buffer",p),null}},f=p=>{try{let h="";for(let g=0;g<p.length;g+=32768){const S=p.subarray(g,g+32768);h+=String.fromCharCode.apply(null,S)}return h}catch(h){return console.warn("Failed to manually decode backup payload",h),null}},d=l();return c(d)||u()||f(d)};let r;if(typeof e=="string")r=e;else{const n=t(e);if(typeof n=="string")r=n;else try{r=String(e)}catch(o){console.warn("Failed to coerce backup payload to string",o),r=""}}if(typeof r!="string")return"";if(!r.includes("\0"))return r;try{return r.replace(zee,"")}catch(n){return console.warn("Failed to strip control characters from backup payload",n),r}}function WG(e){if(typeof e!="string")return null;const t=KG(e);if(!t)return null;const r=t.trim();if(!r)return null;try{const n=JSON.parse(r);if(Li(n))return n;if(Array.isArray(n))return bK(n)}catch(n){console.warn("Failed to parse backup data string",n)}return null}function SK(e){let t;if(Li(e))t=e;else if(ep(e)){const f=Pg(e);t=Li(f)?f:{}}else t={};const r=typeof t.version=="string"?t.version:typeof t.appVersion=="string"?t.appVersion:typeof t.applicationVersion=="string"?t.applicationVersion:void 0,n=KF(t,["settings","localStorage","storage","storedSettings","values","entries"]),o=KF(t,["sessionStorage","session","sessions","sessionState","sessionEntries"]),a=new Set(lK);n.keyUsed&&a.add(n.keyUsed),o.keyUsed&&a.add(o.keyUsed);const i=n.snapshot||Uee(t,a),s=o.snapshot;let l=null;const c=["data","payload","plannerData","allData"];for(let f=0;f<c.length;f+=1){const d=c[f];if(!Object.prototype.hasOwnProperty.call(t,d))continue;const p=fg(t[d]);p&&(l=rw(l,p))}const u={};return qG.forEach(f=>{a.has(f)||Object.prototype.hasOwnProperty.call(t,f)&&(u[f]=XL(f,t[f]))}),Object.keys(u).length&&(l=rw(l,u)),{fileVersion:r,settings:i,sessionStorage:s,data:Li(l)?l:null}}function dx(e){if(!e)return!1;const t=typeof e.name=="string"?e.name:"";if(t==="TypeError"||t==="NotSupportedError"||typeof DOMException<"u"&&e instanceof DOMException&&e.code===DOMException.NOT_SUPPORTED_ERR)return!0;if(typeof e.message=="string"){const r=e.message.toLowerCase();if(r.includes("automatic-download")&&r.includes("not a valid enum")||r.includes("downloads")&&r.includes("not a valid enum"))return!0}return!1}function $ee(){if(typeof navigator>"u"||!navigator.permissions||typeof navigator.permissions.query!="function")return null;const e=["automatic-downloads","downloads"];let t=null,r=null;for(let a=0;a<e.length;a+=1){const i=e[a];try{const s=navigator.permissions.query({name:i});if(!s||typeof s.then!="function")continue;t=s,r=i;break}catch(s){if(dx(s))continue;return console.warn(`Failed to query automatic download permission (${i})`,s),null}}if(!t||typeof t.then!="function")return null;let n=null;const o={state:"unknown",name:r,supported:!0,initial:t.then(a=>(n=a,!a||typeof a.state!="string"?(o.state="unknown",o.state):(o.state=a.state,o.state))).catch(a=>dx(a)?(o.supported=!1,o.state="unknown",o.state):(console.warn(`Failed to query automatic download permission (${r||"unknown"})`,a),o.state="unknown",o.state)),ready:null};return o.ready=o.initial.then(a=>!n||typeof n.state!="string"?o.state:a==="prompt"?new Promise(i=>{const s=()=>{try{n.removeEventListener("change",s)}catch{}o.state=typeof n.state=="string"?n.state:"unknown",i(o.state)};try{n.addEventListener("change",s)}catch(l){console.warn("Failed to observe automatic download permission changes",l),i("unknown")}}):a).catch(a=>(dx(a)||console.warn("Failed to observe automatic download permission changes",a),o.state="unknown",o.state)),o}function nw(e,t){if(typeof document>"u")return!1;const r=document.createElement("a");r.href=e,r.download=t,r.style.display="none",document.body.appendChild(r);let n=!1;try{r.click(),n=!0}catch(o){console.warn("Failed to trigger backup download",o),n=!1}return setTimeout(()=>{try{r.remove()}catch{}},1500),n}function YG(e){if(typeof e!="string")return null;try{return`data:application/json;charset=utf-8,${encodeURIComponent(e)}`}catch(t){return console.warn("Failed to encode backup payload as data URL",t),null}}function QG(e,t){if(typeof window>"u"||typeof document>"u")return!1;let r=null;try{r=window.open("","_blank","noopener")}catch(n){console.warn("Failed to open fallback backup window",n),r=null}if(!r)return!1;try{const n=r.document;if(!n)return!1;const o=document&&document.documentElement&&document.documentElement.getAttribute?document.documentElement.getAttribute("lang"):"en";n.open(),n.write(`<!DOCTYPE html><html lang="${o||"en"}"><head><meta charset="utf-8"><title>Manual download</title></head><body></body></html>`),n.close();try{n.title=t||"backup.json"}catch(f){}const a=n.body;if(!a)return!1;a.style.margin="0",a.style.padding="1.5rem",a.style.background="#f8f9fb",a.style.color="#0f172a",a.style.fontFamily="system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif";const i=n.createElement("div");i.style.maxWidth="960px",i.style.margin="0 auto",i.style.display="flex",i.style.flexDirection="column",i.style.gap="1rem";const s=n.createElement("h1");s.textContent=t||"Manual backup",s.style.margin="0",s.style.fontSize="1.5rem",s.style.fontWeight="400";const l=n.createElement("p");typeof getManualDownloadFallbackMessage=="function"?l.textContent=getManualDownloadFallbackMessage():l.textContent="Copy the text below and save it to a file ending with .json to keep your data safe.",l.style.margin="0",l.style.lineHeight="1.5";const c=n.createElement("p");typeof getManualDownloadCopyHint=="function"?c.textContent=getManualDownloadCopyHint():c.textContent="Select the text, copy it and paste into your preferred notes app or text editor.",c.style.margin="0",c.style.lineHeight="1.5";const u=n.createElement("textarea");u.value=e,u.readOnly=!0,u.spellcheck=!1,u.style.width="100%",u.style.height="70vh",u.style.resize="vertical",u.style.padding="1rem",u.style.borderRadius="1rem",u.style.border="1px solid rgba(15, 23, 42, 0.15)",u.style.background="#ffffff",u.style.fontFamily="'SFMono-Regular', 'Roboto Mono', 'Menlo', 'Courier New', monospace",u.style.fontSize="0.875rem",u.style.lineHeight="1.5",u.style.boxShadow="0 0.75rem 2.5rem rgba(15, 23, 42, 0.16)",i.appendChild(s),i.appendChild(l),i.appendChild(c),i.appendChild(u),a.appendChild(i);try{u.focus(),u.select()}catch(f){}try{r.focus()}catch(f){}return!0}catch(n){return console.warn("Failed to render manual backup window",n),!1}}function vK(e,t,r={}){const n=$ee(),o=typeof r=="object"&&r!==null?r:{},a=o.skipQueue===!0,i={success:!1,method:null,permission:n,queued:!1,queueMessage:VG(t)};let s=typeof t=="string"&&t.trim()?t.trim():"";if(s||(s=`${new Date().toISOString().replace(/[:.]/g,"-")}-backup.json`),s.toLowerCase().endsWith(".json")||(s+=".json"),typeof e!="string"||e.length<2)return i;let l=null;if(typeof Blob<"u")try{l=new Blob([e],{type:"application/json"})}catch(f){console.warn("Failed to create backup blob",f),l=null}if(l){if(typeof navigator<"u"&&typeof navigator.msSaveOrOpenBlob=="function")try{if(navigator.msSaveOrOpenBlob(l,s)===!1)console.warn("Saving backup via msSaveOrOpenBlob was cancelled or declined");else return{success:!0,method:"ms-save",permission:n}}catch(f){console.warn("Failed to save backup via msSaveOrOpenBlob",f)}if(typeof URL<"u"&&typeof URL.createObjectURL=="function"){let f=null;try{f=URL.createObjectURL(l)}catch(d){console.warn("Failed to create object URL for backup blob",d),f=null}if(f){const d=nw(f,s);if(typeof URL.revokeObjectURL=="function"&&setTimeout(()=>{try{URL.revokeObjectURL(f)}catch{}},6e4),d)return{success:!0,method:"blob-url",permission:n}}}}const c=YG(e);if(c&&nw(c,s))return{success:!0,method:"data-url",permission:n};if(QG(e,s))return{success:!0,method:"manual",permission:n};if(!a){const f=o.queueMetadata&&typeof o.queueMetadata=="object"?o.queueMetadata:{},d=$G(s,e,{reason:f.reason||o.reason||"download-blocked",permissionState:f.permissionState||(n&&typeof n.state=="string"?n.state:"unknown"),source:f.source||o.source||"automatic",createdAt:f.createdAt||null,createdAtMs:f.createdAtMs||null});i.queued=!0,i.queueEntryId=d&&typeof d.id=="string"?d.id:null}return i}function EK(e){return typeof e=="string"&&(e.startsWith(Ab)||e.startsWith(Cb))}function AK(e){if(typeof e!="string")return null;const t=e.startsWith(Cb)?{prefixLength:Cb.length,type:"auto-backup-before-delete",secondsOptional:!0}:e.startsWith(Ab)?{prefixLength:Ab.length,type:"auto-backup",secondsOptional:!0}:null;if(!t)return null;const n=e.slice(t.prefixLength).split("-");if(n.length<5)return null;const o=n.slice(0,5).map(m=>Number(m));if(o.some(m=>Number.isNaN(m)))return null;const[a,i,s,l,c]=o;let u=!1,f=0,d=5;if(n.length>d){const m=n[d];if(/^\d{1,2}$/u.test(m))u=!0,f=Number(m),d+=1;else if(!t.secondsOptional)return null}else if(!t.secondsOptional)return null;const p=n.slice(d).join("-").trim(),h=new Date(a,i-1,s,l,c,u?f:0,0);return{type:t.type,date:Number.isNaN(h.valueOf())?null:h,label:p,includeSeconds:u}}const CK=$F({formatFullBackupFilename:uK,resolveSafeLocalStorage:fK,captureStorageSnapshot:dK,createSafeStorageReader:pK,restoreSessionStorageSnapshot:mK,restoreLocalStorageSnapshot:hK,sanitizeBackupPayload:KG,parseBackupDataString:WG,normalizeBackupDataSection:fg,normalizeBackupDataValue:XL,mergeBackupDataSections:rw,extractBackupSections:SK,triggerBackupDownload:nw,encodeBackupDataUrl:YG,openBackupFallbackWindow:QG,downloadBackupPayload:vK,queueBackupPayloadForVault:$G,getQueuedBackupPayloads:zG,removeBackupVaultRecord:aK,openQueuedBackupVaultWindow:sK,resolveQueuedBackupMessage:VG,isBackupVaultFallbackActive:tK,getBackupVaultFallbackState:eK,isAutoBackupName:EK,parseAutoBackupName:AK,isPlainObject:Li,constants:$F({SESSION_AUTO_BACKUP_NAME_PREFIX:Ab,SESSION_AUTO_BACKUP_DELETION_PREFIX:Cb,BACKUP_STORAGE_KEY_PREFIXES:jG.slice(),BACKUP_STORAGE_KNOWN_KEYS:Array.from($u),BACKUP_METADATA_BASE_KEYS:Array.from(lK),BACKUP_DATA_KEYS:qG.slice(),BACKUP_DATA_COMPLEX_KEYS:Array.from(cK),BACKUP_VAULT_FALLBACK_STORAGE_KEY:ZC})});Tee("cineFeatureBackup",CK,{category:"feature",description:"Backup and restore helpers for snapshots, payload normalization, downloads and diff metadata.",replace:!0,connections:["cineModuleBase","cineModuleContext","cinePersistence"]},e=>{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to register cineFeatureBackup module.",e)});const Vee=[["cineFeatureBackup",CK],["formatFullBackupFilename",uK],["resolveSafeLocalStorage",fK],["captureStorageSnapshot",dK],["createSafeStorageReader",pK],["restoreSessionStorageSnapshot",mK],["restoreLocalStorageSnapshot",hK],["sanitizeBackupPayload",KG],["parseBackupDataString",WG],["normalizeBackupDataSection",fg],["normalizeBackupDataValue",XL],["mergeBackupDataSections",rw],["extractBackupSections",SK],["triggerBackupDownload",nw],["encodeBackupDataUrl",YG],["openBackupFallbackWindow",QG],["downloadBackupPayload",vK],["queueBackupPayloadForVault",$G],["getQueuedBackupPayloads",zG],["removeBackupVaultRecord",aK],["openQueuedBackupVaultWindow",sK],["resolveQueuedBackupMessage",VG],["isBackupVaultFallbackActive",tK],["getBackupVaultFallbackState",eK],["isAutoBackupName",EK],["parseAutoBackupName",AK],["clearBackupVault",Nee],["SESSION_AUTO_BACKUP_NAME_PREFIX",Ab],["SESSION_AUTO_BACKUP_DELETION_PREFIX",Cb]];Vee.forEach(([e,t])=>{Lee(e,t,{configurable:!0,writable:!0})});console.log("DEBUG: app-events.js START");const Sd=Gr||{},WF=zp||{getElement:function(e){return typeof document<"u"?document.getElementById(e):null}};function Ue(e,t){const r=t||e;try{Object.defineProperty(globalThis,e,{get:function(){return WF[r]||WF.getElement(r)},configurable:!0,enumerable:!0})}catch{globalThis[e]=null}}const Of="cameraPowerPlanner_devices";Ue("toggleDeviceBtn","toggleDeviceManager");Ue("deviceManagerSection","device-manager");Ue("saveSetupBtn");Ue("setupNameInput","setupName");Ue("deleteSetupBtn");Ue("addDeviceBtn");Ue("cancelEditBtn");Ue("languageSelect");Ue("skipLink");Ue("importDataBtn");Ue("importFileInput");Ue("exportBtn","exportDataBtn");Ue("generateGearListBtn");Ue("deleteGearListProjectBtn");Ue("gearItemEditExtra");Ue("newSubcategorySelect","newSubcategory");Ue("newCategorySelect","newCategory");Ue("subcategoryFieldDiv","subcategoryField");Ue("lensFocusScaleSelect","lensFocusScaleUnit");Ue("newNameInput","newName");Ue("newWattInput","newWatt");Ue("newCapacityInput","newCapacity");Ue("newPinAInput","newPinA");Ue("newDtapAInput","newDtapA");Ue("menuToggle");Ue("darkModeToggle");Ue("pinkModeToggle");Ue("settingsButton");Ue("settingsDialog");Ue("settingsSave");Ue("settingsCancel");Ue("settingsLanguage");Ue("settingsDarkMode");Ue("settingsPinkMode");Ue("settingsHighContrast");Ue("settingsReduceMotion");Ue("settingsRelaxedSpacing");Ue("settingsShowAutoBackups");Ue("settingsTemperatureUnit");Ue("settingsFontSize");Ue("settingsFontFamily");Ue("settingsLogo");Ue("settingsLogoPreview");Ue("accentColorInput");Ue("helpButton");Ue("reloadButton");Ue("closeMenuButton");Ue("openContactsBtn");Ue("shareSetupBtn");Ue("applySharedLinkBtn");Ue("generateOverviewBtn");Ue("runtimeFeedbackBtn");Ue("zoomOut");Ue("zoomIn");Ue("resetView");Ue("gridSnapToggle");Ue("accentColorReset");Ue("resolvedLocalFontsButton","localFontsButton");Ue("documentationTrackerAddRelease");Ue("mountVoltageReset");Ue("autoGearSavePreset");Ue("autoGearDeletePreset");Ue("autoGearBackupRestore");Ue("autoGearAddRule");Ue("autoGearResetFactory");Ue("autoGearHighlightToggle");Ue("closePrintPreviewBtn");Ue("printPreviewExportBtn");Ue("printPreviewPrintBtn");Ue("projectForm");function qee(){}typeof document<"u"&&document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",qee);Ue("cameraWattInput","cameraWatt");Ue("monitorWattInput","monitorWatt");Ue("viewfinderWattInput","viewfinderWatt");Ue("cameraVoltageInput","cameraVoltage");Ue("cameraPortTypeInput","cameraPortType");Ue("monitorScreenSizeInput","monitorScreenSize");Ue("monitorBrightnessInput","monitorBrightness");Ue("monitorVoltageInput","monitorVoltage");Ue("monitorPortTypeInput","monitorPortType");Ue("monitorLatencyInput","monitorLatency");Ue("monitorAudioOutputInput","monitorAudioOutput");Ue("viewfinderScreenSizeInput","viewfinderScreenSize");Ue("viewfinderBrightnessInput","viewfinderBrightness");Ue("viewfinderVoltageInput","viewfinderVoltage");Ue("viewfinderPortTypeInput","viewfinderPortType");Ue("viewfinderLatencyInput","viewfinderLatency");Ue("batteryFieldsDiv","batteryFields");Ue("cameraFieldsDiv","cameraFields");Ue("monitorFieldsDiv","monitorFields");Ue("viewfinderFieldsDiv","viewfinderFields");Ue("videoFieldsDiv","videoFields");Ue("motorFieldsDiv","motorFields");Ue("controllerFieldsDiv","controllerFields");Ue("distanceFieldsDiv","distanceFields");Ue("lensFieldsDiv","lensFields");Ue("wattFieldDiv","wattField");Ue("dynamicFieldsDiv","dynamicFields");const Jp=(function(){const t={},r=(o,a)=>{if(!o||typeof t[a]=="function")return;const i=o[a];typeof i=="function"&&(t[a]=i)};if(typeof require=="function")try{const o=require("./storage.js");o&&typeof o=="object"&&(r(o,"getSafeLocalStorage"),r(o,"saveDeviceData"),r(o,"clearUiCacheStorageEntries"))}catch{}const n=[];try{typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&n.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis=="object"&&globalThis&&n.push(globalThis),typeof window=="object"&&window&&n.push(window),typeof self=="object"&&self&&n.push(self),typeof global=="object"&&global&&n.push(global);for(let o=0;o<n.length;o+=1){const a=n[o];if(!(!a||typeof a!="object")&&(r(a,"getSafeLocalStorage"),r(a,"saveDeviceData"),r(a,"clearUiCacheStorageEntries"),typeof t.getSafeLocalStorage=="function"&&typeof t.saveDeviceData=="function"&&typeof t.clearUiCacheStorageEntries=="function"))break}return t})(),Kee="__backup",Wee="__legacyMigrationBackup";function Yee(e,t){if(typeof e!="string"||!e)return!1;const r=t&&typeof t=="object"?t:{},n=new Set;n.add(e),n.add(`${e}${Kee}`),n.add(`${e}${Wee}`);let o=!1;const a=r.logPrefix||"Failed to clear device storage variant",i=new Set;if(typeof Jp.getSafeLocalStorage=="function")try{const l=Jp.getSafeLocalStorage();l&&i.add(l)}catch(l){try{typeof console<"u"&&typeof console.warn=="function"&&console.warn(`${a}: safe storage lookup failed`,l)}catch{}}try{typeof SAFE_LOCAL_STORAGE<"u"&&SAFE_LOCAL_STORAGE&&i.add(SAFE_LOCAL_STORAGE)}catch{}try{typeof globalThis=="object"&&globalThis&&globalThis.localStorage&&i.add(globalThis.localStorage)}catch{}try{typeof window=="object"&&window&&window.localStorage&&i.add(window.localStorage)}catch{}try{typeof localStorage<"u"&&localStorage&&i.add(localStorage)}catch{}const s=Array.from(n);if(i.forEach(l=>{if(!(!l||typeof l.removeItem!="function"))for(let c=0;c<s.length;c+=1){const u=s[c];if(!(typeof u!="string"||!u))try{l.removeItem(u),o=!0}catch(f){try{typeof console<"u"&&typeof console.warn=="function"&&console.warn(`${a} "${u}"`,f)}catch{}}}}),typeof Jp.clearUiCacheStorageEntries=="function")try{Jp.clearUiCacheStorageEntries(s)}catch(l){try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to clear UI cache entries for device storage reset",l)}catch{}}return o}function Qee(){const e=Xee();if(!e||typeof e.forEach!="function")return!1;let t=!1;return e.forEach(r=>{if(typeof r!="string"||!r)return;if(r===Of&&typeof Jp.saveDeviceData=="function")try{Jp.saveDeviceData(null),t=!0}catch(o){try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to clear primary device storage via saveDeviceData",o)}catch{}}Yee(r,{logPrefix:"Failed to clear device storage variant"})&&(t=!0)}),t}const YF=Object.freeze(["power","video","fiz","cables"]);function wK(e){const t=[],r=new Set,n=i=>{if(typeof i!="string")return;const s=i.trim();!s||r.has(s)||(r.add(s),t.push(s))};let o=null;try{const i=typeof deviceSchema<"u"?deviceSchema:null;o=i&&i.accessories&&i.accessories.cables?i.accessories.cables:null}catch{o=null}if(o&&typeof o=="object")try{for(const i of Object.keys(o))n(i)}catch{}for(let i=0;i<YF.length;i+=1)n(YF[i]);let a=null;try{const i=typeof devices<"u"?devices:null;a=i&&i.accessories&&i.accessories.cables?i.accessories.cables:null}catch{a=null}if(a&&typeof a=="object")try{for(const i of Object.keys(a))n(i)}catch{}if(Array.isArray(e))for(let i=0;i<e.length;i+=1)n(e[i]);else n(e);return t}function Xee(){if(typeof require=="function")try{const t=require("./storage.js");if(t&&typeof t=="object"){if(typeof t.getDeviceStorageKeyVariants=="function"){const r=t.getDeviceStorageKeyVariants();if(r&&typeof r.forEach=="function")return Array.from(r)}if(typeof t.getStorageKeyVariants=="function"){const r=t.getStorageKeyVariants(Of);if(r&&typeof r.forEach=="function")return Array.from(r)}}}catch{}const e=new Set;return e.add(Of),Of.startsWith("cameraPowerPlanner_")?e.add(`cinePowerPlanner_${Of.slice(19)}`):Of.startsWith("cinePowerPlanner_")&&e.add(`cameraPowerPlanner_${Of.slice(17)}`),Array.from(e)}const Pc=(function(){if(typeof Sd.setButtonLabelWithIcon=="function")return Sd.setButtonLabelWithIcon;const t=[];try{typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE.setButtonLabelWithIcon=="function"&&t.push(CORE_GLOBAL_SCOPE.setButtonLabelWithIcon)}catch{}return typeof globalThis<"u"&&globalThis&&typeof globalThis.setButtonLabelWithIcon=="function"&&t.push(globalThis.setButtonLabelWithIcon),typeof window<"u"&&window&&typeof window.setButtonLabelWithIcon=="function"&&t.push(window.setButtonLabelWithIcon),typeof self<"u"&&self&&typeof self.setButtonLabelWithIcon=="function"&&t.push(self.setButtonLabelWithIcon),typeof global<"u"&&global&&typeof global.setButtonLabelWithIcon=="function"&&t.push(global.setButtonLabelWithIcon),t.length>0?t[0]:function(n,o){if(n)try{n.textContent=typeof o=="string"?o:""}catch{}}})(),Oi=(function(){if(typeof require=="function")try{const r=require("./modules/features/backup.js");if(r&&typeof r=="object")return r}catch{}const t=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&t.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&t.push(globalThis),typeof window<"u"&&window&&t.push(window),typeof self<"u"&&self&&t.push(self),typeof global<"u"&&global&&t.push(global);for(let r=0;r<t.length;r+=1){const n=t[r];if(n)try{const o=n.cineFeatureBackup;if(o&&typeof o=="object")return o}catch{}}return{}})(),QF=typeof Oi.queueBackupPayloadForVault=="function"?Oi.queueBackupPayloadForVault:null,Rb=typeof Oi.getQueuedBackupPayloads=="function"?Oi.getQueuedBackupPayloads:null,XF=typeof Oi.removeBackupVaultRecord=="function"?Oi.removeBackupVaultRecord:null,JF=typeof Oi.openQueuedBackupVaultWindow=="function"?Oi.openQueuedBackupVaultWindow:null,ow=typeof Oi.resolveQueuedBackupMessage=="function"?Oi.resolveQueuedBackupMessage:null,qI=typeof Oi.downloadBackupPayload=="function"?Oi.downloadBackupPayload:null,ZF=typeof Oi.isBackupVaultFallbackActive=="function"?Oi.isBackupVaultFallbackActive:null,ej=(function(){if(typeof buildSettingsBackupPackage=="function")return buildSettingsBackupPackage;const t=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&t.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&t.push(globalThis),typeof window<"u"&&window&&t.push(window),typeof self<"u"&&self&&t.push(self),typeof global<"u"&&global&&t.push(global);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.buildSettingsBackupPackage=="function")return n.buildSettingsBackupPackage}return null})();function LK(){const e=[],t=tp();return t&&e.indexOf(t)===-1&&e.push(t),typeof globalThis<"u"&&globalThis&&e.indexOf(globalThis)===-1&&e.push(globalThis),typeof window<"u"&&window&&e.indexOf(window)===-1&&e.push(window),typeof self<"u"&&self&&e.indexOf(self)===-1&&e.push(self),typeof global<"u"&&global&&e.indexOf(global)===-1&&e.push(global),e}function Jee(){if(typeof require=="function")try{const t=require("./modules/logging-resolver.js");if(t&&typeof t.resolveLogger=="function")return t}catch{}const e=LK();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.cineLoggingResolver;if(n&&typeof n.resolveLogger=="function")return n}catch{}}return null}function Zee(){const e=LK();for(let t=0;t<e.length;t+=1){const r=e[t];if(!r||typeof r!="object"&&typeof r!="function")continue;let n=null;try{n=r.cineLogging||null}catch{n=null}if(n&&typeof n.createLogger=="function")try{return n.createLogger("events",{meta:{source:"app-events"}})}catch(o){try{typeof n.error=="function"&&n.error("Failed to create events logger",o,{namespace:"events-bootstrap"})}catch{}}}return null}const vr=(function(){const t=Jee();if(t&&typeof t.resolveLogger=="function")try{const r=t.resolveLogger("events",{meta:{source:"app-events"}});if(r)return r}catch{}return Zee()})(),tj=typeof globalThis<"u"&&globalThis.__CINE_AUTO_BACKUP_RENAMED_FLAG?globalThis.__CINE_AUTO_BACKUP_RENAMED_FLAG:"__cineAutoBackupRenamed",Im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{};(!Im.viewfinderTypeOptions||!Array.isArray(Im.viewfinderTypeOptions))&&(Im.viewfinderTypeOptions=[]);(!Im.viewfinderConnectorOptions||!Array.isArray(Im.viewfinderConnectorOptions))&&(Im.viewfinderConnectorOptions=[]);function tp(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}const rj={categorySelect:null};function XG(){const e=rj.categorySelect;if(e&&typeof e=="object"){if(typeof e.isConnected=="boolean"){if(e.isConnected)return e}else if(e.ownerDocument)return e}let t=null;if(typeof newCategorySelect<"u"&&newCategorySelect?t=newCategorySelect:typeof document<"u"&&document&&typeof document.getElementById=="function"&&(t=document.getElementById("newCategory"),t||console.warn("Debug: resolveNewCategorySelect found nothing for ID newCategory")),t){rj.categorySelect=t;const r=tp();if(r&&typeof r=="object")try{r.newCategorySelect=r.newCategorySelect||t}catch{}}return t}const Pu=50,Xy=600*1e3,ete=600*1e3,tte=["interval","project-switch","import","export","export-revert","before-reload","change-threshold"],rte=new Set(["import"]),nte=new Set(["import","export","export-revert","before-reload","project-switch"]),ote={feature:"auto-backup"},nj={feature:"device-import",source:"app-events"},ate=10;function oj(e){if(!e)return null;if(typeof e=="string")return{message:e};if(typeof e!="object")try{return{message:String(e)}}catch{return{message:"Unknown error"}}const t={};if(typeof e.name=="string"&&e.name&&(t.name=e.name),typeof e.message=="string"&&e.message&&(t.message=e.message),(typeof e.code=="string"||typeof e.code=="number")&&(t.code=e.code),typeof e.lineNumber=="number"&&(t.lineNumber=e.lineNumber),typeof e.columnNumber=="number"&&(t.columnNumber=e.columnNumber),Object.keys(t).length>0)return t;try{return{message:String(e)}}catch{return{message:"Unknown error"}}}function ite(e){if(!Array.isArray(e)||e.length===0)return[];const t=[];for(let r=0;r<e.length&&t.length<ate;r+=1){const n=e[r];if(typeof n=="string")t.push(n);else if(n&&typeof n=="object"){const o={};if(typeof n.message=="string"&&n.message&&(o.message=n.message),(typeof n.code=="string"||typeof n.code=="number")&&(o.code=n.code),Object.keys(o).length>0)t.push(o);else try{t.push(String(n))}catch{}}else try{t.push(String(n))}catch{}}return t}function aj(e){if(typeof countDeviceDatabaseEntries!="function")return null;if(!e||typeof e!="object")return e===null?0:null;try{return countDeviceDatabaseEntries(e)}catch{}return null}function ij(e,t){const r={},n=aj(e);typeof n=="number"&&(r.existing=n);const o=aj(t);return typeof o=="number"&&(r.imported=o),Object.keys(r).length>0?r:null}function px(e,t,r,n){if(!vr||typeof vr[e]!="function")return;const o=n&&typeof n=="object"?{...nj,...n}:nj;try{vr[e](t,r||{},o)}catch{}}function ste(e){if(typeof e!="string")return"log";const t=e.toLowerCase();return t==="warn"||t==="error"||t==="info"||t==="debug"?t==="debug"&&typeof console<"u"&&console&&typeof console.debug!="function"?"log":t:"log"}function lte(){if(typeof require=="function")try{return require("./app-core-auto-backup.js")}catch{}const e=[tp(),typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{if(r.CORE_AUTO_BACKUP&&typeof r.CORE_AUTO_BACKUP=="object")return r.CORE_AUTO_BACKUP}catch{}}return null}const mx=lte(),sj=mx&&typeof mx.logAutoBackupEvent=="function"?mx.logAutoBackupEvent:null;function aw(e,t,r,n){const o=typeof e=="string"&&e?e:"info",a=typeof t=="string"&&t?t:"Auto backup event",i=ote;let s=!1;if(sj)try{sj(o,a,r,i),s=!0}catch(c){if(s=!1,typeof console<"u"&&typeof console.warn=="function")try{console.warn("Auto backup delegate logging failed",c)}catch{}}let l=!1;if(vr&&typeof vr[o]=="function")try{vr[o](a,r,i),l=!0}catch(c){if(vr&&typeof vr.warn=="function")try{vr.warn("Auto backup logger invocation failed",c,{...i,originalLevel:o,originalMessage:a})}catch{}}if(!(l||s)&&typeof console<"u"&&console){const c=ste(o),u=typeof console[c]=="function"?console[c]:console.log;if(typeof u=="function")try{typeof r<"u"?u.call(console,`[auto-backup] ${a}`,r):u.call(console,`[auto-backup] ${a}`)}catch{}}}function lj(e){if(!e||typeof e!="object")return{hasContent:!1};const t={hasContent:!1,projectInfoKeys:0,gearListLength:0,gearListAndProjectRequirementsGenerated:!!e.gearListAndProjectRequirementsGenerated,powerSelectionKeys:0,gearSelectorGroups:0,diagramPositionCount:0,autoGearRuleCount:0},r=e.projectInfo&&typeof e.projectInfo=="object"?e.projectInfo:null;if(r)try{t.projectInfoKeys=Object.keys(r).length}catch{t.projectInfoKeys=0}typeof e.gearList=="string"&&(t.gearListLength=e.gearList.length);const n=e.powerSelection&&typeof e.powerSelection=="object"?e.powerSelection:null;if(n)try{t.powerSelectionKeys=Object.keys(n).length}catch{t.powerSelectionKeys=0}const o=e.gearSelectors&&typeof e.gearSelectors=="object"?e.gearSelectors:null;if(o)try{t.gearSelectorGroups=Object.keys(o).length}catch{t.gearSelectorGroups=0}const a=e.diagramPositions&&typeof e.diagramPositions=="object"?e.diagramPositions:null;if(a)try{t.diagramPositionCount=Object.keys(a).length}catch{t.diagramPositionCount=0}return Array.isArray(e.autoGearRules)&&(t.autoGearRuleCount=e.autoGearRules.length),t.hasContent=!!(t.projectInfoKeys||t.gearListLength||t.gearListAndProjectRequirementsGenerated||t.powerSelectionKeys||t.gearSelectorGroups||t.diagramPositionCount||t.autoGearRuleCount),t}function cte(e,t){const r=typeof e=="string"?e:"",n=typeof t=="string"?t:"";return r==="error"?"error":r==="success"?"info":r==="skipped"?n==="disallowed"||n==="auto-backup-selected"?"warn":"info":"debug"}function ute(e,t){const r=typeof e=="string"?e:"",n=typeof t=="string"?t:"";return r==="success"?"Auto backup completed successfully":r==="error"?n?`Auto backup failed (${n})`:"Auto backup failed":r==="skipped"?n?`Auto backup skipped (${n})`:"Auto backup skipped":"Auto backup run recorded"}function fte(e){if(!e||typeof e!="object")return{status:"unknown"};const t={status:typeof e.status=="string"?e.status:"unknown"};if(typeof e.reason=="string"&&e.reason&&(t.reason=e.reason),typeof e.context=="string"&&e.context&&(t.context=e.context),typeof e.elapsedSinceLastAutoBackupMs=="number"&&Number.isFinite(e.elapsedSinceLastAutoBackupMs)&&(t.elapsedSinceLastAutoBackupMs=Math.max(0,e.elapsedSinceLastAutoBackupMs)),typeof e.remainingIntervalMs=="number"&&Number.isFinite(e.remainingIntervalMs)&&(t.remainingIntervalMs=Math.max(0,e.remainingIntervalMs)),typeof e.changesSinceSnapshot=="number"&&Number.isFinite(e.changesSinceSnapshot)&&(t.changesSinceSnapshot=Math.max(0,e.changesSinceSnapshot)),typeof e.requiredChangeThreshold=="number"&&Number.isFinite(e.requiredChangeThreshold)&&(t.requiredChangeThreshold=Math.max(0,e.requiredChangeThreshold)),typeof e.remainingChanges=="number"&&Number.isFinite(e.remainingChanges)&&(t.remainingChanges=Math.max(0,e.remainingChanges)),typeof e.requiredIntervalMs=="number"&&Number.isFinite(e.requiredIntervalMs)&&(t.requiredIntervalMs=Math.max(0,e.requiredIntervalMs)),typeof e.name=="string"){const r=e.name.trim();t.hasName=r.length>0,t.nameLength=r.length,t.nameWasAutoGenerated=r.startsWith("auto-backup-")}return typeof e.createdAt=="string"&&e.createdAt&&(t.createdAt=e.createdAt),t}const dte=120*1e3,gx=new Map,pte=800;let Es=0,IA=!1,gy=!1,iw=0,lu=0;function KI(){Es=0}function Hs(e,t){if(IA=!1,!e||typeof e!="object"){aw("warn","Auto backup run recorded without result metadata",{status:"unknown"});return}const r=typeof e.status=="string"?e.status:null,n=typeof e.reason=="string"?e.reason:null,o=t&&typeof t=="object"?{...t}:fte(e),a=cte(r,n),i=ute(r,n);if(aw(a,i,o),r==="skipped"){n==="unchanged"&&KI();return}r&&r!=="error"&&(KI(),r==="success"&&(iw=Date.now()))}function mte(e){return typeof e!="string"||!e?!1:tte.includes(e)}function gte(){const e=tp(),t=e&&typeof e.__cineShowAutoBackupIndicator=="function"?e.__cineShowAutoBackupIndicator:null;if(!t)return()=>{};try{const r=Nte(),n=t(r);return typeof n=="function"?n:()=>{}}catch(r){return console.warn("Failed to show auto backup indicator",r),()=>{}}}function cj(e){if(IA)return;IA=!0;const t=()=>{try{cc({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"change-threshold"})}catch(n){console.warn("Failed to run auto backup after change threshold",n),IA=!1,aw("error","Auto backup change-threshold execution failed",{status:"error",reason:"change-threshold-run",errorName:n&&typeof n.name=="string"?n.name:null,errorMessage:n&&typeof n.message=="string"?n.message:null})}};if(typeof queueMicrotask=="function")try{queueMicrotask(t);return}catch(n){console.warn("Failed to queue auto backup microtask",n),aw("warn","Auto backup microtask scheduling failed",{status:"skipped",reason:"microtask-scheduling",errorName:n&&typeof n.name=="string"?n.name:null,errorMessage:n&&typeof n.message=="string"?n.message:null})}const r=setTimeout(t,0);r&&typeof r.unref=="function"&&r.unref()}function RK(e={}){if(e&&e.reset===!0){KI(),gy=!1,lu=0;return}const t=!!(e&&e.pending===!0),r=!!(e&&e.commit===!0),n=e&&typeof e.context=="object"&&e.context!==null?e.context:null;if(t){gy=!0;return}if(!(r&&!gy&&e.force!==!0)){if(r||gy){if(gy=!1,!!(n&&n.immediate===!0)){let a=null;if(n&&typeof n.completedAt=="number"&&Number.isFinite(n.completedAt)?a=n.completedAt:n&&typeof n.requestedAt=="number"&&Number.isFinite(n.requestedAt)&&(a=n.requestedAt),Number.isFinite(a)||(a=Date.now()),e.force!==!0&&lu>0&&a>=lu&&a-lu<pte){lu=a;return}(a>=lu||lu<=0)&&(lu=a)}Es=Math.min(Pu,Es+1),Es>=Pu&&cj();return}Es=Math.min(Pu,Es+1),Es>=Pu&&cj()}}try{const e=tp();e&&(e.__cineNoteAutoBackupChange=RK)}catch(e){console.warn("Failed to expose auto backup change tracker",e)}function uj(e){if(!e||typeof e!="object")return;try{e[tj]=!0}catch{}const t=e.projectInfo;if(t&&typeof t=="object")try{t[tj]=!0}catch{}}function Wr(e,t=[],r={}){if(typeof callCoreFunctionIfAvailable=="function")return callCoreFunctionIfAvailable(e,t,r);const n=(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null)||null,o=typeof e=="string"?n&&n[e]:e;if(typeof o=="function"){try{return o.apply(n,t)}catch(a){if(vr&&typeof vr.error=="function"){const i={functionName:e,deferred:!!(r&&r.defer),argumentsSnapshot:Array.isArray(t)?t.slice(0,5):null};try{vr.error(`Failed to invoke ${e}`,a,i)}catch{}}typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,a)}return}if(r&&r.defer===!0){const a=n&&Array.isArray(n.CORE_BOOT_QUEUE)?n.CORE_BOOT_QUEUE:null;a&&a.push(()=>{Wr(e,t,{...r,defer:!1})})}return r&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}const fj=Object.freeze({missing:!0}),dj=(function(){if(typeof require=="function")try{const t=require("./modules/video-power-inputs.js");if(t&&typeof t=="object")return t}catch{}return{}})();function bf(e,t=[]){const r=Wr(e,t,{defaultValue:fj});if(r===fj){const n=new ReferenceError(`Missing core function: ${e}`);if(vr&&typeof vr.error=="function")try{vr.error(`Missing core function: ${e}`,n)}catch{}throw n}return r}function yx(e){let t;try{t=Wr("firstPowerInputType",[e])}catch(r){if(vr&&typeof vr.warn=="function")try{vr.warn("Failed to resolve firstPowerInputType from core",r,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to resolve firstPowerInputType from core",r)}if(typeof t=="string")return t;if(Array.isArray(t)&&t.length)return typeof t[0]=="string"?t[0]:"";if(t&&typeof t=="object"){const r=t.type||t.portType;if(typeof r=="string")return r}return""}function yte(e,t=[]){const r=Array.isArray(t)?t.slice():[];try{const n=Wr(e);if(Array.isArray(n))return n.slice()}catch(n){if(vr&&typeof vr.warn=="function")try{vr.warn(`Failed to resolve ${e}`,n)}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Failed to resolve ${e}`,n)}return r}function hte(e){const t=tp();if(!t||!e)return[];const r=t[e];return Array.isArray(r)?r.slice():[]}function bte(e,t){const r=tp();if(!(!r||!e)){if(!Array.isArray(t)){delete r[e];return}try{r[e]=t.slice()}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Failed to persist ${e} options on the global scope`,n)}}}function Xu(e,t,r=[]){const n=[],o=new Set,a=l=>{if(Array.isArray(l))for(let c=0;c<l.length;c+=1){const u=l[c];typeof u=="string"&&(o.has(u)||(o.add(u),n.push(u)))}};a(r),a(hte(e));const i=yte(t,n),s=Array.isArray(i)?i:n;return bte(e,s),s}const Ste=typeof viewfinderTypeOptions<"u"&&Array.isArray(viewfinderTypeOptions)?viewfinderTypeOptions:[];viewfinderTypeOptions=Xu("viewfinderTypeOptions","getAllViewfinderTypes",Ste);const vte=typeof viewfinderConnectorOptions<"u"&&Array.isArray(viewfinderConnectorOptions)?viewfinderConnectorOptions:[];viewfinderConnectorOptions=Xu("viewfinderConnectorOptions","getAllViewfinderConnectors",vte);function Ete(){return typeof globalThis<"u"&&typeof globalThis.hasAnyDeviceSelection=="function"?globalThis.hasAnyDeviceSelection:typeof window<"u"&&typeof window.hasAnyDeviceSelection=="function"?window.hasAnyDeviceSelection:typeof self<"u"&&typeof self.hasAnyDeviceSelection=="function"?self.hasAnyDeviceSelection:typeof global<"u"&&typeof global.hasAnyDeviceSelection=="function"?global.hasAnyDeviceSelection:null}function JL(){if(typeof refreshDeviceLists=="function")try{refreshDeviceLists();return}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("refreshDeviceLists failed, retrying via core bridge.",e)}if(typeof Wr=="function")try{Wr("refreshDeviceLists")}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not refresh device lists via core bridge.",e)}}function TK(e){const t=Ete();if(t)try{return t(e)}catch(o){if(vr&&typeof vr.warn=="function"){const a=e&&typeof e=="object"?Object.keys(e).slice(0,10):null;try{vr.warn("Failed to evaluate device selections via core helper",o,{statePreview:a})}catch{}}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to evaluate device selections via core helper",o)}if(!e||typeof e!="object")return!1;const r=o=>{if(Array.isArray(o))return o.some(i=>r(i));if(o==null)return!1;const a=typeof o=="string"?o.trim():o;if(!a)return!1;if(typeof a=="string"){const i=a.toLowerCase();if(i==="none"||i==="--"||i===""||i==="n/a"||i==="tbd"||i==="pending"||i.startsWith("-- ")||i.startsWith(" ")||i.startsWith("select ")||i.startsWith("choose ")||i.startsWith("pick ")||i.startsWith("add "))return!1}return!0};return!!([e.camera,e.monitor,e.video,e.cage,e.batteryPlate,e.battery,e.batteryHotswap].some(o=>r(o))||r(e.motors)||r(e.controllers)||r(e.distance))}function pj(e,t={}){const r=Object.prototype.hasOwnProperty.call(t,"defaultValue")?t.defaultValue:"",n=Wr(e,[],{defaultValue:r});if(typeof n=="string")return n;if(n==null)return r;try{return String(n)}catch{return r}}function ZL(e){Wr("storeLoadedSetupState",[e],{defaultValue:void 0})}function Ate(){const e=[];typeof globalThis<"u"&&e.push(globalThis),typeof window<"u"&&e.push(window),typeof self<"u"&&e.push(self),typeof global<"u"&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"))try{if(r.cineUi&&typeof r.cineUi=="object")return r.cineUi}catch{}}return null}function Bg(){if(typeof setupSelect<"u"&&setupSelect)return setupSelect;if(typeof document<"u"&&document){const e=document.getElementById("setupSelect");if(e)return e}return null}function ga(e,t,r,n){if(e&&typeof e.addEventListener=="function"){e.addEventListener(t,r,n);return}const o=a=>{let i=document.getElementById(a);if(!i)try{i=document.querySelector(a)}catch{}return i};if(typeof e=="string"){const a=o(e);if(a){a.addEventListener(t,r,n);return}if(Sd&&typeof Sd.whenElementAvailable=="function"){Sd.whenElementAvailable(e,i=>{i&&typeof i.addEventListener=="function"&&i.addEventListener(t,r,n)});return}}document.addEventListener("DOMContentLoaded",()=>{let a=null;typeof e=="string"?a=o(e):e&&e.id&&(a=document.getElementById(e.id)),a&&typeof a.addEventListener=="function"&&a.addEventListener(t,r,n)})}let mj=!1;function Cte(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof e!="function")return;try{const n=t.cineUi&&typeof t.cineUi=="object"?t.cineUi:null;if(n){e(n);return}}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("cineUi registration callback failed",n);return}const r="__cineUiReadyQueue";Array.isArray(t[r])||(t[r]=[]),t[r].push(e)}Cte(zK);ga("languageSelect","change",e=>{const t=()=>{if(typeof populateUserButtonDropdowns=="function")try{populateUserButtonDropdowns()}catch(r){console.warn("Failed to refresh user button selectors after manual language change",r)}};try{const r=setLanguage(e.target.value);if(r&&typeof r.then=="function"){r.then(t).catch(n=>{console.warn("Language selection update failed",n)});return}}catch(r){console.warn("Language selection handler threw",r)}t()});ga("skipLink","click",()=>{const e=document.getElementById("mainContent");e&&e.focus()});function gj(e){const t=e&&e.silent===!0,r=texts[currentLang]||{},n=texts.en||{};if(typeof applyPendingProjectNameCollisionResolution=="function")try{applyPendingProjectNameCollisionResolution()}catch(L){console.warn("Failed to finalize pending project name collision before saving setup",L)}const o=setupNameInput.value.trim();if(!o){t||(typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupNameTitle||n.alertSetupNameTitle||"Project Name Required",message:texts[currentLang].alertSetupName}):alert(texts[currentLang].alertSetupName));return}const a={...getCurrentSetupState()},i=TK(a),s=getCurrentGearListHtml();s&&(a.gearList=s);const l=Bg(),c=l&&typeof l.value=="string"?l.value:"",u=!!(c&&o&&c!==o),f=u&&typeof c=="string"&&c.startsWith("auto-backup-");let d=getSetups();const p=u?JSON.parse(JSON.stringify(d||{})):null;let h=o,m=null,g=!u,S=!1;if(u){if(typeof loadProject=="function")try{m=loadProject(c)}catch(L){console.warn("Failed to load project data while renaming setup",L)}if(typeof renameSetup=="function"){try{const L=renameSetup(c,o);typeof L=="string"&&L&&(h=L)}catch(L){console.warn("Failed to rename setup in storage",L)}d=getSetups()}else Object.prototype.hasOwnProperty.call(d,c)&&(d[o]=d[c],delete d[c],h=o)}const y=typeof h=="string"&&h.startsWith("auto-backup-");if(f&&y&&uj(a),d[h]=a,storeSetups(d),u&&m&&typeof saveProject=="function"){S=!0;try{f&&y&&uj(m),saveProject(h,m,{skipOverwriteBackup:!0,renamedFrom:c}),g=!0}catch(L){g=!1,console.warn("Failed to preserve project data during setup rename",L)}if(g&&typeof loadProject=="function")try{const L=loadProject(h);g=!!(L&&typeof L=="object")}catch(L){g=!1,console.warn("Failed to confirm project data after setup rename",L)}}else u&&m&&(S=!0,g=!1);if(u&&S&&!g){p&&(storeSetups(p),d=p),h=c;const L=r.alertSetupRenameSaveFailed||n.alertSetupRenameSaveFailed;if(typeof L=="string"&&L)if(typeof showNotification=="function")try{showNotification("warning",L)}catch{}else typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupRenameSaveFailedTitle||"Rename Failed",message:L}):alert(L)}if(dg(),t||(setupNameInput.value=h),l&&(l.value=h),lastSetupName=h,saveCurrentSession(),ZL(getCurrentSetupState()),checkSetupChanged(),saveCurrentGearList(),u&&c&&c!==h&&g){if(typeof deleteProject=="function")try{deleteProject(c)}catch(L){console.warn("Failed to remove old project entry during setup rename",L)}else if(typeof saveProject=="function")try{saveProject(c,{projectInfo:null,gearList:""},{skipOverwriteBackup:!0})}catch(L){console.warn("Failed to clear legacy project entry during setup rename",L)}}saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim());const E=i?r.alertSetupSaved||n.alertSetupSaved:r.alertSetupSavedNoDevices||n.alertSetupSavedNoDevices||r.alertSetupSaved||n.alertSetupSaved;if(!t&&typeof E=="string"&&E){const L=E.replace("{name}",h);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:r.alertSetupSavedTitle||n.alertSetupSavedTitle||"Project Saved",message:L}):alert(L)}}function JG(e){typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Saving Project..."),typeof setTimeout=="function"?setTimeout(function(){try{gj(e)}catch(t){console.error("Save failed:",t),alert("Save failed: "+t.message)}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},50):(gj(e),typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading())}ga("saveSetupBtn","click",JG);setupNameInput&&(ga("setupName","input",function(){if(saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim()),typeof checkSetupChanged=="function")try{checkSetupChanged()}catch(e){console.warn("Failed to evaluate setup change status after name update",e)}}),ga("setupName","keydown",function(e){e.isComposing||e.key==="Enter"&&(e.preventDefault(),JG(e))}));function wte(){const e=Bg(),t=e&&typeof e.value=="string"?e.value:"";if(!t){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertNoSetupSelectedTitle||"No Project Selected",message:texts[currentLang].alertNoSetupSelected}):alert(texts[currentLang].alertNoSetupSelected);return}const r=()=>{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Deleting Project..."),setTimeout(()=>{try{if(!Ite("delete setup"))return;let o=getSetups();delete o[t],storeSetups(o),typeof deleteProject=="function"&&deleteProject(t),dg(),setupNameInput.value="";let a=!1;if(e&&typeof e.dispatchEvent=="function"&&(lastSetupName="",e.value="",e.dispatchEvent(new Event("change")),a=!0),!a){gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList.add("hidden")),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList.add("hidden")),currentProjectInfo=null,projectForm&&populateProjectForm({}),ZL(null),updateBatteryPlateVisibility(),updateBatteryOptions(),clearProjectAutoGearRules(),renderAutoGearRulesList(),updateAutoGearCatalogOptions(),[cameraSelect,monitorSelect,videoSelect,cageSelect,distanceSelect,batterySelect,hotswapSelect].forEach(l=>{Array.from(l.options).find(u=>u.value==="None")?l.value="None":l.selectedIndex=0}),typeof updateCageSelectOptions=="function"&&updateCageSelectOptions("None");const s=getSliderBowlSelect();s&&(s.value=""),motorSelects.forEach(l=>{l.options.length&&(l.value="None")}),controllerSelects.forEach(l=>{l.options.length&&(l.value="None")}),updateCalculations()}const i=texts[currentLang].alertSetupDeleted.replace("{name}",t);typeof window.cineShowAlertDialog=="function"&&(window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].deleteSetupTitle||"Project Deleted",message:i}),alert(i))}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},50)};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].deleteSetupTitle||"Delete Project",message:texts[currentLang].confirmDeleteSetup.replace("{name}",t),confirmLabel:"Delete",danger:!0,onConfirm:()=>{setTimeout(()=>{window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].areYouSure||"Are you sure?",message:texts[currentLang].confirmDeleteSetupAgain,confirmLabel:"Confirm Delete",danger:!0,onConfirm:()=>r()})},150)}}):confirm(texts[currentLang].confirmDeleteSetup.replace("{name}",t))&&confirm(texts[currentLang].confirmDeleteSetupAgain)&&r()}function OK(){wte()}ga("deleteSetupBtn","click",OK);function Lte(e={}){const t=typeof suspendProjectPersistence=="function"&&typeof resumeProjectPersistence=="function";if(t)try{suspendProjectPersistence()}catch(o){console.warn("Failed to suspend project persistence during setup reset",o)}const n=!!(typeof e=="object"&&e!==null?e:{}).preserveSetupNameInput;try{!n&&setupNameInput&&(setupNameInput.value="");const o=i=>{if(!i||typeof i!="object")return;const s=i===cameraSelect;Array.from(i.options||[]).find(c=>c.value==="None")?i.value="None":i.options&&i.options.length?i.selectedIndex=0:i.value="",s&&Wr("updateRecordingMediaOptions")};if([cameraSelect,monitorSelect,videoSelect,cageSelect,distanceSelect,batterySelect,hotswapSelect].forEach(o),typeof updateCageSelectOptions=="function")try{updateCageSelectOptions("None")}catch(i){console.warn("Failed to reset cage options while preparing setup switch",i)}const a=typeof getSliderBowlSelect=="function"?getSliderBowlSelect():null;if(a&&(a.value=""),Array.isArray(motorSelects)&&motorSelects.forEach(o),Array.isArray(controllerSelects)&&controllerSelects.forEach(o),typeof updateBatteryPlateVisibility=="function")try{updateBatteryPlateVisibility()}catch(i){console.warn("Failed to reset battery plate visibility while preparing setup switch",i)}if(typeof updateBatteryOptions=="function")try{updateBatteryOptions()}catch(i){console.warn("Failed to reset battery options while preparing setup switch",i)}if(typeof displayGearAndRequirements=="function")try{displayGearAndRequirements("")}catch(i){console.warn("Failed to reset gear and requirements display while preparing setup switch",i)}if(gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList&&gearListOutput.classList.add("hidden")),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList&&projectRequirementsOutput.classList.add("hidden")),currentProjectInfo=null,projectForm)try{populateProjectForm({})}catch(i){console.warn("Failed to reset project form while preparing setup switch",i)}if(typeof clearProjectAutoGearRules=="function")try{clearProjectAutoGearRules()}catch(i){console.warn("Failed to clear project auto gear rules while preparing setup switch",i)}if(typeof setManualDiagramPositions=="function")try{setManualDiagramPositions({},{render:!1})}catch(i){console.warn("Failed to reset manual diagram positions while preparing setup switch",i)}try{ZL(null)}catch(i){console.warn("Failed to reset stored setup state while preparing setup switch",i)}typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml="")}finally{if(t)try{resumeProjectPersistence()}catch(o){console.warn("Failed to resume project persistence after setup reset",o)}}}function yj(e){if(typeof renderAutoGearRulesList=="function")try{renderAutoGearRulesList()}catch(t){console.warn("Failed to render auto gear rules list after setup switch",t)}if(typeof updateAutoGearCatalogOptions=="function")try{updateAutoGearCatalogOptions()}catch(t){console.warn("Failed to update auto gear catalog options after setup switch",t)}if(saveSetupBtn&&(saveSetupBtn.disabled=!setupNameInput.value.trim()),typeof updateCalculations=="function")try{updateCalculations()}catch(t){console.warn("Failed to update calculations after setup switch",t)}if(typeof checkSetupChanged=="function")try{checkSetupChanged()}catch(t){console.warn("Failed to evaluate setup changes after setup switch",t)}typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(e),lastSetupName=e}Bg();ga("setupSelect","change",e=>{console.log("DEBUG: setupSelect change listener ENTERED");const t=e.target.value,r=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",n=r.trim(),o=(lastSetupName&&typeof lastSetupName=="string"?lastSetupName:"")||n||"";typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(o);const a=c=>typeof c=="string"?c.replace(/\s+/g," ").trim():"",i=a(lastSetupName),s=a(t);let l=!1;if(typeof scheduleProjectAutoSave=="function")try{const c=typeof normalizeSetupName=="function"?normalizeSetupName:(p=>typeof p=="string"?p.trim():""),u=c(typeof lastSetupName=="string"?lastSetupName:""),f=c(o),d={setupNameState:{typedName:n,selectedName:u,storageKey:f,renameInProgress:!!(u&&n&&n!==u),typedNameHasTrailingWhitespace:!!(n&&typeof r=="string"&&/\s$/.test(r))}};console.log("DEBUG: calling scheduleProjectAutoSave (immediate)"),scheduleProjectAutoSave({immediate:!0,overrides:d}),console.log("DEBUG: scheduleProjectAutoSave returned"),l=!0}catch(c){console.warn("Failed to flush project autosave before switching setups",c)}if(!l)try{typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof saveCurrentGearList=="function"&&saveCurrentGearList()}catch(c){console.warn("Failed to persist project state before switching setups",c)}if(typeof saveProject=="function"){const c=projectForm?collectProjectFormData():{};c&&(c.sliderBowl=pj("getSliderBowlValue"),c.easyrig=pj("getEasyrigValue"));const u=deriveProjectInfo(c);currentProjectInfo=u;const f=typeof normalizeSetupName=="function"?normalizeSetupName:(E=>typeof E=="string"?E.trim():""),d=f(o),p=f(n),h=!!(d&&p&&p!==d),m=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(u,{projectNameOverride:h?d:void 0}):u,g=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null,S={projectInfo:m,gearList:getCurrentGearListHtml()};if(g&&(S.powerSelection=g),typeof getDiagramManualPositions=="function"){const E=getDiagramManualPositions();E&&Object.keys(E).length&&(S.diagramPositions=E)}const y=getProjectScopedAutoGearRules();y&&y.length&&(S.autoGearRules=y),saveProject(o,S,{skipOverwriteBackup:!0})}if(typeof cc=="function"&&s!==i)try{cc({suppressSuccess:!0,projectNameOverride:a(o),triggerAutoSaveNotification:!0,reason:"project-switch"})}catch(c){console.warn("Failed to auto backup project before loading a different setup",c)}if(Lte(),t===""){yj(t);return}{const u=getSetups()[t];if(u){setupNameInput.value=t,cameraSelect.value=u.camera||"None",Wr("updateRecordingMediaOptions"),updateBatteryPlateVisibility(),batteryPlateSelect.value=u.batteryPlate||batteryPlateSelect.value,applyBatteryPlateSelectionFromBattery(u.battery||"",batteryPlateSelect.value),monitorSelect.value=u.monitor||"None",videoSelect.value=u.video||"None",typeof updateCageSelectOptions=="function"?updateCageSelectOptions(u.cage||"None"):cageSelect&&(cageSelect.value=u.cage||"None"),(u.motors||[]).forEach((S,y)=>{motorSelects[y]&&(motorSelects[y].value=S)}),(u.controllers||[]).forEach((S,y)=>{controllerSelects[y]&&(controllerSelects[y].value=S)}),distanceSelect.value=u.distance||"None",batterySelect.value=u.battery||"None",applyBatteryPlateSelectionFromBattery(u.battery||"",batteryPlateSelect?batteryPlateSelect.value:""),hotswapSelect.value=u.batteryHotswap||"None",setSliderBowlValue(u.sliderBowl||""),setEasyrigValue(u.easyrig||"");let f=!1;u.powerSelection&&typeof applyStoredPowerSelection=="function"&&(f=applyStoredPowerSelection(u.powerSelection,{preferExisting:!1}));const d=typeof loadProject=="function"?loadProject(t):null;!f&&d&&typeof applyStoredPowerSelection=="function"&&d.powerSelection&&(f=applyStoredPowerSelection(d.powerSelection,{preferExisting:!1})),updateBatteryOptions(),!f&&d&&typeof applyStoredPowerSelection=="function"&&d.powerSelection&&(f=applyStoredPowerSelection(d.powerSelection,{preferExisting:!1}),f&&updateBatteryOptions());const p=typeof u.gearList=="string"&&u.gearList?u.gearList:typeof d?.gearList=="string"?d.gearList:"";currentProjectInfo=u.projectInfo||d?.projectInfo||null;const h=S=>Wr("generateGearListHtml",[S||{}],{defaultValue:""})||"";let m=p;if(m||(m=h(currentProjectInfo||{})),m&&typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml=m),typeof setManualDiagramPositions=="function"){let S={};if(typeof normalizeDiagramPositionsInput=="function"){S=normalizeDiagramPositionsInput(d?.diagramPositions);const y=normalizeDiagramPositionsInput(u.diagramPositions);Object.keys(y).length&&(S={...S,...y})}setManualDiagramPositions(S,{render:!1})}const g=Array.isArray(u.autoGearRules)&&u.autoGearRules.length?u.autoGearRules:Array.isArray(d?.autoGearRules)&&d.autoGearRules.length?d.autoGearRules:null;if(g?useProjectAutoGearRules(g):clearProjectAutoGearRules(),gearListOutput&&(displayGearAndRequirements(m),populateProjectForm(currentProjectInfo||{}),m&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener()),typeof saveProject=="function")){const S={projectInfo:currentProjectInfo,gearListAndProjectRequirementsGenerated:!!m},y=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null;if(y&&(S.powerSelection=y),typeof getDiagramManualPositions=="function"){const L=getDiagramManualPositions();L&&Object.keys(L).length&&(S.diagramPositions=L)}const E=getProjectScopedAutoGearRules();E&&E.length&&(S.autoGearRules=E),u.gearSelectors&&Object.keys(u.gearSelectors).length?S.gearSelectors=u.gearSelectors:d?.gearSelectors&&Object.keys(d.gearSelectors).length&&(S.gearSelectors=d.gearSelectors),saveProject(t,S,{skipOverwriteBackup:!0})}}else{const f=typeof loadProject=="function"?loadProject(t):null;if(f&&typeof applyStoredPowerSelection=="function"&&f.powerSelection?applyStoredPowerSelection(f.powerSelection,{preferExisting:!1})&&updateBatteryOptions():updateBatteryOptions(),currentProjectInfo=f?.projectInfo||null,projectForm&&populateProjectForm(currentProjectInfo||{}),gearListOutput){const d=m=>Wr("generateGearListHtml",[m||{}],{defaultValue:""})||"",h=(typeof f?.gearList=="string"?f.gearList:"")||d(currentProjectInfo||{});displayGearAndRequirements(h),h&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener())}else displayGearAndRequirements("");if(clearProjectAutoGearRules(),typeof setManualDiagramPositions=="function"){const d=f?.diagramPositions&&typeof normalizeDiagramPositionsInput=="function"?normalizeDiagramPositionsInput(f.diagramPositions):{};setManualDiagramPositions(d||{},{render:!1})}}ZL(getCurrentSetupState())}yj(t)});function dg(){const e=typeof getSetups=="function"?getSetups:null,t=Bg();if(!t){console.warn("populateSetupSelect: setup select element unavailable, aborting populate");return}const r=typeof texts=="object"&&texts?texts[currentLang]||texts.en||{}:{},n=typeof r.newSetupOption=="string"&&r.newSetupOption.trim()?r.newSetupOption:"New setup";e||console.warn("populateSetupSelect: getSetups is unavailable, using empty setup list");const o=e?e()||{}:{};t.innerHTML=`<option value="">${n}</option>`;let a=!1;if(typeof showAutoBackups=="boolean")a=showAutoBackups;else if(typeof localStorage<"u")try{a=localStorage.getItem("showAutoBackups")==="true"}catch(s){console.warn("Could not read auto backup visibility preference",s)}if(a&&typeof ensureAutoBackupsFromProjects=="function")try{ensureAutoBackupsFromProjects()}catch(s){console.warn("Failed to prepare auto backups before populating selector",s)}const i=Object.keys(o).filter(s=>a||!s.startsWith("auto-backup-")).sort((s,l)=>{const c=s.startsWith("auto-backup-"),u=l.startsWith("auto-backup-");return c!==u?c?1:-1:localeSort(s,l)});for(const s of i){const l=document.createElement("option");l.value=s,l.textContent=s,t.appendChild(l)}if(typeof document<"u"&&document.dispatchEvent&&typeof CustomEvent=="function")try{document.dispatchEvent(new CustomEvent("cine:setupselect:populated",{detail:{count:i.length,timestamp:Date.now()}}))}catch{}}typeof Sd.whenElementAvailable=="function"?Sd.whenElementAvailable("setupSelect",()=>{dg(),typeof checkSetupChanged=="function"&&checkSetupChanged()}):(dg(),typeof checkSetupChanged=="function"&&checkSetupChanged());function Rte(e,t,r){if(typeof e!="string")return;const n=e.trim();if(!n)return;const o="success";if(typeof showNotification=="function")try{showNotification(o,n)}catch(a){console.warn("Failed to display auto save notification after auto backup",a)}if(typeof document<"u"&&typeof CustomEvent=="function"&&document&&typeof document.dispatchEvent=="function")try{document.dispatchEvent(new CustomEvent("cine:auto-save-notification",{detail:{message:n,source:"auto-backup",backupName:t||null,severity:o,timestamp:new Date().toISOString()}}))}catch(a){console.warn("Failed to dispatch auto save notification event after auto backup",a)}}const Tte=30;let ed=null,Jy=null,Zy=null;function sw(e){if(e===null)return"null";if(e===void 0)return"undefined";if(Array.isArray(e)){let r="[";for(let n=0;n<e.length;n+=1)n>0&&(r+=","),r+=sw(e[n]);return r+="]",r}if(e instanceof Date){const r=e.getTime();return Number.isNaN(r)?"date:invalid":`date:${r}`}const t=typeof e;if(t==="number")return Number.isNaN(e)?"number:NaN":Number.isFinite(e)?`number:${e}`:e>0?"number:Infinity":"number:-Infinity";if(t==="bigint")return`bigint:${e.toString()}`;if(t==="boolean")return e?"boolean:true":"boolean:false";if(t==="string")return`string:${e}`;if(t==="symbol")return`symbol:${String(e)}`;if(t==="function")return`function:${e.name||"anonymous"}`;if(t==="object"){const r=Object.keys(e).sort();let n="{";for(let o=0;o<r.length;o+=1){const a=r[o];o>0&&(n+=","),n+=`${JSON.stringify(a)}:${sw(e[a])}`}return n+="}",n}return`${t}:${String(e)}`}function xK(e,t,r){return sw({setup:e||null,gearSelectors:t||null,gearListGenerated:!!r})}function Ote(e,t,r){const n=TK(e),o=!!(e&&typeof e=="object"&&e.projectInfo),a=Array.isArray(e&&e.autoGearRules)&&e.autoGearRules.length>0,i=!!(e&&e.diagramPositions&&typeof e.diagramPositions=="object"&&Object.keys(e.diagramPositions).length>0),s=!!(t&&typeof t=="object"&&Object.keys(t).length>0),l=!!(e&&e.powerSelection&&typeof e.powerSelection=="object"&&Object.keys(e.powerSelection).length>0);return n||o||a||i||s||l||!!r}function kK(e){return!e||typeof e!="object"?[]:Object.keys(e).filter(t=>typeof t=="string"&&t.startsWith("auto-backup-")).sort()}function IK(e){const t=kK(e);if(!t.length)return{name:null,entry:null};const r=t[t.length-1],n=e&&typeof e=="object"?e[r]:null;return{name:r,entry:n}}function PK(e,t){if(!t||typeof t!="object")return sw(null);let r=null;t.gearSelectors&&typeof t.gearSelectors=="object"&&(r=t.gearSelectors);let n=!1;if(typeof loadProject=="function"&&e)try{const o=loadProject(e);o&&typeof o=="object"&&(!r&&o.gearSelectors&&typeof o.gearSelectors=="object"&&(r=o.gearSelectors),typeof o.gearListAndProjectRequirementsGenerated=="boolean"&&(n=o.gearListAndProjectRequirementsGenerated))}catch(o){console.warn("Failed to inspect stored project payload for auto backup signature",o)}return xK(t,r,n)}function xte(e){if(ed||!e||typeof e!="object")return;const{name:t,entry:r}=IK(e);if(!(!t||!r||typeof r!="object"))try{ed=PK(t,r),Jy=t;const n=ZG(r);if(n&&typeof n.createdAt=="string"){Zy=n.createdAt;const o=Date.parse(n.createdAt);Number.isNaN(o)||(iw=o)}}catch(n){ed=null,console.warn("Failed to prime automatic backup signature cache",n)}}function ZG(e){if(!e||typeof e!="object")return null;const t=e.__cineAutoBackupMetadata;return!t||typeof t!="object"?null:t}function hj(e,t){if(!e||typeof e!="object")return;const r=t&&typeof t=="object"?{version:typeof t.version=="number"?t.version:1,snapshotType:t.snapshotType==="delta"?"delta":"full",base:typeof t.base=="string"?t.base:null,sequence:typeof t.sequence=="number"?t.sequence:0,createdAt:typeof t.createdAt=="string"?t.createdAt:null,changedKeys:Array.isArray(t.changedKeys)?t.changedKeys.slice():[],removedKeys:Array.isArray(t.removedKeys)?t.removedKeys.slice():[]}:null;try{Object.defineProperty(e,"__cineAutoBackupMetadata",{configurable:!0,enumerable:!1,writable:!0,value:r})}catch{try{e.__cineAutoBackupMetadata=r}catch{}}}function kte(e){if(!e||typeof e!="object")return{snapshotType:"full",base:null,sequence:0};const t=kK(e);if(!t.length)return{snapshotType:"full",base:null,sequence:0};const r=t[t.length-1],n=e[r],o=ZG(n);if(!n||!o)return{snapshotType:"full",base:null,sequence:0};const a=typeof o.sequence=="number"?o.sequence:0;return a>=Tte?{snapshotType:"full",base:null,sequence:0}:{snapshotType:"delta",base:r,sequence:a+1}}function cc(e={}){const t=Bg();if(!t)return null;const r=typeof e=="object"&&e!==null?e:{},n=!!r.suppressSuccess,o=!!r.suppressError,a=r.force===!0,i=typeof r.reason=="string"&&r.reason?r.reason:"unspecified",s=typeof r.successMessage=="string"&&r.successMessage?r.successMessage:"Auto backup saved",l=typeof r.errorMessage=="string"&&r.errorMessage?r.errorMessage:"Auto backup failed",c=!!r.triggerAutoSaveNotification,u=typeof r.autoSaveNotificationMessage=="string"&&r.autoSaveNotificationMessage.trim()?r.autoSaveNotificationMessage.trim():s,f=_=>typeof _=="string"?_.replace(/\s+/g," ").trim():"",p=Object.prototype.hasOwnProperty.call(r,"projectNameOverride")?f(r.projectNameOverride):null,h=typeof t.value=="string"?t.value:"",m=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",g=f(h),S=f(m),y=_=>typeof _=="string"&&_.startsWith("auto-backup-"),v=Date.now()-(iw||0),A=v>=Xy,R=Es>=Pu;if(!a&&!nte.has(i)&&!A&&!R){const _=Math.max(0,Xy-v),w={status:"skipped",reason:"cadence",context:i,elapsedSinceLastAutoBackupMs:v,changesSinceSnapshot:Es,requiredIntervalMs:Xy,requiredChangeThreshold:Pu,remainingIntervalMs:_,remainingChanges:Math.max(0,Pu-Es)};return typeof console<"u"&&typeof console.debug=="function"&&console.debug("Skipping auto backup because cadence requirements are not met.",w),Hs(w),w}if(!a&&!mte(i)){const _={status:"skipped",reason:"disallowed",context:i||null};return typeof console<"u"&&typeof console.debug=="function"&&console.debug("Skipping auto backup run because the trigger is not permitted.",{trigger:i}),Hs(_),_}if(!a&&rte.has(i)){const G=Date.now()-(iw||0)>=Xy,T=Es>=Pu;if(!G&&!T){const P={status:"skipped",reason:"rate-limited",context:i};return Hs(P),P}}let C="";if(p!=null){if(p&&y(p)){const _={status:"skipped",reason:"auto-backup-selected",context:i};return Hs(_),_}C=p}else if(g&&y(g))if(S&&!y(S)&&S!==g)C=S;else{const _={status:"skipped",reason:"auto-backup-selected",context:i};return Hs(_),_}else g?C=g:S&&(C=S);let k=null;try{k=gte()}catch(_){console.warn("Failed to prepare auto backup indicator",_),k=null}try{const _=ct=>String(ct).padStart(2,"0"),w=new Date,x=`auto-backup-${w.getFullYear()}-${_(w.getMonth()+1)}-${_(w.getDate())}-${_(w.getHours())}-${_(w.getMinutes())}-${_(w.getSeconds())}`,G=C||"",T={...getCurrentSetupState()},P=getSetups();let N=G?`${x}-${G}`:x;if(P&&typeof P=="object"){let ct=1;for(;Object.prototype.hasOwnProperty.call(P,N);){const Y=`copy-${ct}`,ee=`${x}-${Y}`;N=G?`${ee}-${G}`:ee,ct+=1}}xte(P);const q=kte(P);let Z=q;if(q.snapshotType==="delta"){const ct=q.base&&P?P[q.base]:null;(!ct||typeof ct!="object")&&(Z={snapshotType:"full",base:null,sequence:0})}const U=getCurrentGearListHtml(),K=!!U;let H=null;T.gearListAndProjectRequirementsGenerated=K;const te=Wr("getGearListSelectors",[],{defaultValue:{}})||{},re=Wr("cloneGearListSelectors",[te],{defaultValue:{}})||{};if(!Ote(T,re,K)){const ct={status:"skipped",reason:"empty",context:i};return Hs(ct),ct}re&&Object.keys(re).length&&(T.gearSelectors=re);const fe=xK(T,re,K),{name:Oe,entry:Te}=IK(P);if(!a&&Oe&&Te)try{if(PK(Oe,Te)===fe){const Y=ZG(Te),ee=Y&&typeof Y.createdAt=="string"?Y.createdAt:null;return ed=fe,Jy=Oe,Zy=ee,Hs({status:"skipped",reason:"unchanged",name:Oe,createdAt:ee,context:i}),gx.set(i,{timestamp:w.valueOf(),signature:fe}),{status:"skipped",reason:"unchanged",name:Oe,createdAt:ee,context:i}}}catch(ct){console.warn("Failed to compare current auto backup against latest snapshot before saving",ct)}if(!a){const ct=gx.get(i);if(ct&&w.valueOf()-ct.timestamp<dte&&ct.signature===fe){const ee={status:"skipped",reason:"duplicate-reason",name:Jy||null,createdAt:Zy||null,context:i};return Hs(ee),ee}}if(!a&&ed&&fe===ed){const ct={status:"skipped",reason:"unchanged",name:Jy||null,createdAt:Zy||null,context:i};return Hs(ct),ct}const Ne=w.toISOString(),Ie={version:1,snapshotType:Z.snapshotType,base:Z.base,sequence:Z.sequence,createdAt:Ne,changedKeys:[],removedKeys:[]};hj(T,Ie);const et=P;if(et[N]=T,storeSetups(et),typeof saveProject=="function"){const ct=typeof U=="string"?U:"";let Y=T.projectInfo||null;if(Y&&typeof createProjectInfoSnapshotForStorage=="function")try{Y=createProjectInfoSnapshotForStorage(Y)||Y}catch(de){console.warn("Failed to normalize project info for auto backup payload",de)}if(Y&&typeof Wr=="function")try{const de=Wr("cloneProjectInfoForStorage",[Y],{defaultValue:Y});de&&(Y=de)}catch(de){console.warn("Failed to clone project info for auto backup payload",de)}const ee={projectInfo:Y,gearListAndProjectRequirementsGenerated:!!ct};ct&&(ee.gearList=ct);const Ae=typeof getPowerSelectionSnapshot=="function"?getPowerSelectionSnapshot():null;if(Ae&&typeof Ae=="object"&&Object.keys(Ae).length&&(ee.powerSelection=Ae),re&&Object.keys(re).length&&(ee.gearSelectors=re),typeof getDiagramManualPositions=="function")try{const de=getDiagramManualPositions();de&&typeof de=="object"&&Object.keys(de).length&&(ee.diagramPositions=de)}catch(de){console.warn("Failed to capture diagram positions for auto backup payload",de)}const ve=getProjectScopedAutoGearRules();if(ve&&ve.length){let de=ve;if(typeof Wr=="function")try{de=Wr("cloneProjectInfoForStorage",[ve],{defaultValue:ve})||ve}catch(be){console.warn("Failed to clone auto gear rules for auto backup payload",be)}ee.autoGearRules=de}(ee.projectInfo&&typeof ee.projectInfo=="object"&&Object.keys(ee.projectInfo).length||ee.gearList||ee.gearListAndProjectRequirementsGenerated||ee.powerSelection&&Object.keys(ee.powerSelection).length||ee.gearSelectors&&Object.keys(ee.gearSelectors).length||ee.diagramPositions&&Object.keys(ee.diagramPositions).length||ee.autoGearRules&&ee.autoGearRules.length)&&(hj(ee,Ie),saveProject(N,ee)),H=lj(ee)}const Ze=t.value,Ft=setupNameInput?setupNameInput.value:"";dg(),t.value=Ze,setupNameInput&&(setupNameInput.value=Ft),n||showNotification("success",s),c&&Rte(u,N),ed=fe,Jy=N,Zy=Ne;const Ye={status:"success",reason:i,context:i,snapshotType:Z.snapshotType,hasPlanBase:!!Z.base,sequence:Z.sequence,appendedProjectName:!!C,backupNameLength:typeof N=="string"?N.length:0,changesSinceSnapshot:Es,elapsedSinceLastAutoBackupMs:v,force:a,gearListGenerated:K,payloadSummary:H||null};return Hs({status:"success",name:N,createdAt:Ne,context:i},Ye),gx.set(i,{timestamp:w.valueOf(),signature:fe}),N}catch(_){console.warn("Auto backup failed",_),o||showNotification("error",l);const w={status:"error",reason:"exception",context:i,errorName:_&&typeof _.name=="string"?_.name:null,errorMessage:_&&typeof _.message=="string"?_.message:null};if(_&&typeof _.stack=="string"&&_.stack){const x=_.stack.split(`
`).slice(0,5).join(`
`);w.errorStackPreview=x}return Hs({status:"error",reason:"exception",context:i},w),null}finally{if(typeof k=="function")try{k()}catch(_){console.warn("Failed to hide auto backup indicator",_)}}}function Ite(e,t={}){const r=typeof t=="object"&&t!==null?t:{},n=texts[currentLang]||{},o=texts.en||{},a=r.successMessage||n.preDeleteBackupSuccess||o.preDeleteBackupSuccess||"Automatic backup saved. Restore it anytime from Saved Projects.",i=r.failureMessage||n.preDeleteBackupFailed||o.preDeleteBackupFailed||"Automatic backup failed. The action was cancelled.",s=Bg(),l=g=>typeof g=="string"?g.replace(/\s+/g," ").trim():"",c=s&&typeof s.value=="string"?l(s.value):"",u=setupNameInput&&typeof setupNameInput.value=="string"?l(setupNameInput.value):"",f=l(typeof lastSetupName=="string"?lastSetupName:""),d=g=>typeof g=="string"&&g.startsWith("auto-backup-"),h=[c,u,f].find(g=>g&&!d(g))||"";if(!h)return r.notifyFailure!==!1&&showNotification("error",i),null;if(typeof scheduleProjectAutoSave=="function")try{scheduleProjectAutoSave(!0)}catch(g){console.warn("Failed to flush project autosave before deletion backup",g)}let m={status:"unsupported"};if(typeof createProjectDeletionBackup=="function")try{m=createProjectDeletionBackup(h)}catch(g){console.error(`Automatic backup before ${e} failed`,g),m={status:"failed"}}return m.status==="created"||m.status==="skipped"?(m.status==="created"&&RK({reset:!0}),r.notifySuccess!==!1&&showNotification("success",a),typeof m.backupName=="string"&&m.backupName?m.backupName:h):(typeof console<"u"&&typeof console.warn=="function"&&console.warn(`Automatic backup before ${e} failed.`,m),r.notifyFailure!==!1&&showNotification("error",i),null)}const lw=["pointerdown","keydown","touchstart"];let Pm=null,cw=null,uw=null,fw=!1,hx=!1,bx=!1,Rp=null,Tp=null,Op=null;function Pte(){const e=typeof texts=="object"&&texts&&texts[currentLang]||{},t=typeof texts=="object"&&texts&&texts.en||{};return{singular:e.queuedBackupBannerMessageOne||t.queuedBackupBannerMessageOne||"1 backup saved in the local vault.",plural:e.queuedBackupBannerMessageOther||t.queuedBackupBannerMessageOther||"{count} backups saved in the local vault.",gesture:e.queuedBackupBannerGesture||t.queuedBackupBannerGesture||"Interact with the planner to export them safely.",action:e.queuedBackupBannerAction||t.queuedBackupBannerAction||"Open local backup vault",fallbackHint:e.queuedBackupFallbackHint||t.queuedBackupFallbackHint||"Emergency fallback storage active. Export queued backups immediately."}}function Bte(){if(typeof document>"u")return null;if(Pm&&cw&&uw)return Pm;const e=document.createElement("section");e.id="cineQueuedBackupBanner",e.style.position="fixed",e.style.right="1.5rem",e.style.left="1.5rem",e.style.bottom="1.5rem",e.style.maxWidth="28rem",e.style.marginLeft="auto",e.style.padding="1rem 1.25rem",e.style.borderRadius="1.25rem",e.style.background="rgba(15, 22, 36, 0.92)",e.style.color="#f5f7fb",e.style.boxShadow="0 1.5rem 3.5rem rgba(5, 8, 17, 0.28)",e.style.zIndex="9999",e.style.display="none",e.style.flexDirection="column",e.style.gap="0.75rem",e.setAttribute("role","status"),e.setAttribute("aria-live","assertive"),e.setAttribute("aria-hidden","true");const t=document.createElement("p");t.style.margin="0",t.style.lineHeight="1.5",t.style.fontSize="0.95rem";const r=document.createElement("button");r.type="button",r.style.alignSelf="flex-start",r.style.background="#ffbf3c",r.style.color="#11131a",r.style.border="none",r.style.borderRadius="999px",r.style.padding="0.55rem 1.5rem",r.style.fontWeight="600",r.style.cursor="pointer",r.addEventListener("click",n=>{try{n.preventDefault()}catch{}typeof JF=="function"&&Promise.resolve().then(()=>JF()).catch(o=>{console.warn("Failed to open queued backup vault window",o)})}),e.appendChild(t),e.appendChild(r);try{(document.body||document.documentElement).appendChild(e)}catch(n){console.warn("Failed to attach queued backup banner to document",n)}return Pm=e,cw=t,uw=r,e}function Gte(e,t){const r=Bte();if(!r||!cw||!uw)return;const n=Pte(),o=typeof e=="number"&&Number.isFinite(e)?e:1,i=(o===1?n.singular:n.plural).replace("{count}",String(o)),s=n.gesture.replace("{count}",String(o)),l=[`${i} ${s}`.trim()];t&&l.push(n.fallbackHint),cw.textContent=l.join(" ").trim(),uw.textContent=n.action,r.style.display="flex",r.setAttribute("aria-hidden","false"),BK()}function PA(){Pm&&(Pm.style.display="none",Pm.setAttribute("aria-hidden","true"))}function BK(){if(fw||typeof document>"u")return;const e=GK;for(let t=0;t<lw.length;t+=1){const r=lw[t];try{document.addEventListener(r,e,{passive:!0})}catch{document.addEventListener(r,e)}}fw=!0}function BA(){if(!fw||typeof document>"u")return;const e=GK;for(let t=0;t<lw.length;t+=1){const r=lw[t];try{document.removeEventListener(r,e,{passive:!0})}catch{document.removeEventListener(r,e)}}fw=!1}function GK(){Mte("gesture")}function Mte(e){hx||typeof Rb!="function"||typeof qI!="function"||(hx=!0,Promise.resolve().then(()=>{hx=!1,_te(e)}))}function cS(){return typeof Rb!="function"?(PA(),BA(),Promise.resolve(0)):Promise.resolve(Rb()).then(e=>{const t=Array.isArray(e)?e.length:0,r=typeof ZF=="function"?!!ZF():!1;return t>0?Gte(t,r):(PA(),BA()),t}).catch(e=>(console.warn("Failed to update queued backup banner from vault",e),PA(),BA(),0))}async function _te(e){if(!bx&&!(typeof Rb!="function"||typeof qI!="function")){bx=!0;try{const t=await Promise.resolve(Rb()).then(r=>Array.isArray(r)?r:[]).catch(r=>(console.warn("Failed to read queued backups for deferred download",r),[]));if(!t.length){PA(),BA();return}for(let r=0;r<t.length;r+=1){const n=t[r];let o=null;try{o=qI(n.payload,n.fileName,{skipQueue:!0,source:n&&n.metadata&&n.metadata.source?n.metadata.source:"automatic",reason:e||"gesture-flush",queueMetadata:n&&n.metadata?n.metadata:{}})}catch(a){console.warn("Deferred backup download attempt threw an error",a),o=null}if(o&&o.success){if(typeof XF=="function")try{await XF(n.id)}catch(a){console.warn("Failed to remove queued backup after export",a)}}else{const a=o&&o.queueMessage?o.queueMessage:ow?ow(n.fileName):"Automatic downloads are still blocked. Keep working offline and try again after interacting with the planner.";if(typeof showNotification=="function")try{showNotification("warning",a)}catch(i){}break}}}finally{bx=!1,cS()}}}function MK(){cS(),BK()}function _K(){cS()}function DK(){if(Rp)try{clearTimeout(Rp)}catch{}Rp=setTimeout(()=>{try{cc({reason:"interval"})}catch(e){console.warn("Scheduled auto backup run failed",e)}DK()},Xy),Rp&&typeof Rp.unref=="function"&&Rp.unref()}function NK(){if(Tp)try{clearTimeout(Tp)}catch{}Tp=setTimeout(()=>{try{autoGearRulesDirtySinceBackup&&createAutoGearBackup()}catch(e){console.warn("Scheduled auto gear backup failed",e)}NK()},ete),Tp&&typeof Tp.unref=="function"&&Tp.unref()}async function Dte(){if(!(typeof QF!="function"||typeof ej!="function"))try{const e=await ej(new Date);if(!e||typeof e.payload!="string")return;if(QF(e.fileName,e.payload,{source:"hourly-scheduler",reason:"hourly-auto",createdAt:e.iso}),ow)try{const t=ow(e.fileName);t&&typeof showNotification=="function"&&showNotification("info",t)}catch(t){}cS()}catch(e){console.warn("Failed to queue scheduled full backup payload",e)}}function FK(){if(Op)try{clearTimeout(Op)}catch{}Op=setTimeout(()=>{Dte(),FK()},3600*1e3),Op&&typeof Op.unref=="function"&&Op.unref()}typeof window<"u"&&typeof window.addEventListener=="function"&&(window.addEventListener("cineBackupVault:queued",MK),window.addEventListener("cineBackupVault:fallbackChanged",_K));typeof document<"u"&&typeof document.addEventListener=="function"&&(document.addEventListener("cineBackupVault:queued",MK),document.addEventListener("cineBackupVault:fallbackChanged",_K));typeof setTimeout=="function"&&(DK(),NK(),FK());cS();function jK(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");if(!e||!t||!e.classList.contains("hidden"))return;e.classList.remove("hidden"),document.body.classList.add("device-manager-active");const{langTexts:r,fallbackTexts:n}=zd(),o=r.hideDeviceManager||n.hideDeviceManager||"Close Device Data",a=r.hideDeviceManagerHelp||n.hideDeviceManagerHelp||"Close defaults library editor";Pc(t,o,ICON_GLYPHS.minus),t.setAttribute("title",o),t.setAttribute("data-help",a),t.setAttribute("aria-expanded","true"),JL(),updateCalculations()}function HK(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");if(!e||!t||e.classList.contains("hidden"))return;e.classList.add("hidden"),document.body.classList.remove("device-manager-active");const{langTexts:r,fallbackTexts:n}=zd(),o=r.toggleDeviceManager||n.toggleDeviceManager||"Edit Device Data",a=r.toggleDeviceManagerHelp||n.toggleDeviceManagerHelp||"Manage available batteries, cameras, lenses...";Pc(t,o,ICON_GLYPHS.gears),t.setAttribute("title",o),t.setAttribute("data-help",a),t.setAttribute("aria-expanded","false")}function UK(){const e=deviceManagerSection||document.getElementById("device-manager"),t=toggleDeviceBtn||document.getElementById("toggleDeviceManager");!e||!t||(e.classList.contains("hidden")?jK():HK())}function WI(){WI.bound||(WI.bound=!0,typeof document<"u"&&document&&typeof document.addEventListener=="function"&&document.addEventListener("click",e=>{if(!e)return;const t=e.target;!t||typeof t.closest!="function"||!t.closest("#toggleDeviceManager")||UK()}))}WI();function zd(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=typeof texts<"u"&&texts||(e&&typeof e.texts=="object"?e.texts:null),r=typeof currentLang=="string"&&t&&typeof t[currentLang]=="object"?currentLang:"en",n=t&&typeof t[r]=="object"&&t[r]||{},o=t&&typeof t.en=="object"&&t.en||{};return{langTexts:n,fallbackTexts:o}}function Nte(){const{langTexts:e,fallbackTexts:t}=zd();return e&&e.autoBackupInProgressNotice||t&&t.autoBackupInProgressNotice||"Auto backup in progress. Performance may pause briefly."}function zK(e){if(!(!e||mj)){mj=!0;try{e.controllers&&typeof e.controllers.register=="function"&&e.controllers.register("deviceManagerSection",{show:jK,hide:HK,toggle:UK})}catch(t){console.warn("cineUi controller registration failed",t)}try{e.interactions&&typeof e.interactions.register=="function"&&(e.interactions.register("saveSetup",JG),e.interactions.register("deleteSetup",OK))}catch(t){console.warn("cineUi interaction registration failed",t)}try{e.help&&typeof e.help.register=="function"&&(e.help.register("saveSetup",()=>{const{langTexts:t,fallbackTexts:r}=zd();return t.saveSetupHelp||r.saveSetupHelp||"Capture the current projectincluding devices, requirements and notesso it can be restored instantly. The autosave status dot beside Project Name glows while changes are secured. Press Enter or Ctrl+S to save quickly; the Save button stays disabled until a name is entered."}),e.help.register("autoBackupBeforeDeletion",()=>{const{langTexts:t,fallbackTexts:r}=zd();return t.preDeleteBackupSuccess||r.preDeleteBackupSuccess||"Automatic safety copy stored before deletion. Find the matching auto-backup entry under Saved Projects and rename it if you plan to keep it permanently."}))}catch(t){console.warn("cineUi help registration failed",t)}}}function Fte(){const e=Ate();return e?(zK(e),!0):!1}Fte();function $K(e){const t=e.closest("li");if(!t)return;const r=t.querySelector(".device-details");if(!r)return;if(e.getAttribute("aria-expanded")==="true"){r.style.display="none";const{langTexts:o,fallbackTexts:a}=zd(),i=o.showDetails||a.showDetails||"Show Details";e.textContent=i,e.setAttribute("aria-expanded","false"),e.setAttribute("data-help",i)}else{r.style.display="block";const{langTexts:o,fallbackTexts:a}=zd(),i=o.hideDetails||a.hideDetails||"Hide Details";if(e.textContent=i,e.setAttribute("aria-expanded","true"),e.setAttribute("data-help",i),typeof document<"u"&&typeof document.dispatchEvent=="function"){const s=typeof e.dataset.name=="string"?e.dataset.name:"",l=typeof e.dataset.category=="string"?e.dataset.category:"",c=typeof e.dataset.subcategory=="string"?e.dataset.subcategory:"",u={name:s.trim(),category:l.trim(),subcategory:c.trim()||null};try{document.dispatchEvent(new CustomEvent("device-library:show-details",{detail:u}))}catch(f){console.warn("Failed to dispatch device-library:show-details event",f)}}}}function YI(e,t){return e==="batteries"||e.endsWith(".batteries")||t.capacity!==void 0?"batteries":e==="cameras"||t.recordingMedia||t.lensMount||t.power?.batteryPlateSupport?"cameras":e==="lenses"||t.mountOptions||t.focusScale?"lenses":e==="monitors"||t.screenSizeInches!==void 0&&!e.includes("viewfinder")?"monitors":e==="viewfinders"||e.includes("viewfinder")?"viewfinders":e==="video"||e==="wirelessReceivers"||e==="iosVideo"||t.videoInputs||t.videoOutputs||t.frequency!==void 0?"video":e==="fiz.motors"||t.torqueNm!==void 0||t.gearTypes?"fiz.motors":e==="fiz.controllers"||t.powerSource||t.batteryType||t.connectivity?"fiz.controllers":e==="fiz.distance"||t.measurementMethod||t.connectionCompatibility||t.measurementRange||t.accuracy?"distances":e==="accessories.cables"||typeof e=="string"&&e.startsWith("accessories.cables")?"accessories.cables":"generic"}function VK(){const e=devices&&devices.cameras?devices.cameras:null;if(!e||typeof e!="object")return"";const t=o=>{if(!o||typeof o!="object"||!Array.isArray(o.lensMount))return"";const a=o.lensMount.find(s=>s&&typeof s.type=="string"&&typeof s.mount=="string"&&s.mount.toLowerCase()==="native");if(a&&a.type)return a.type;const i=o.lensMount.find(s=>s&&typeof s.type=="string"&&s.type.trim());return i?i.type:""},r=typeof cameraSelect?.value=="string"?cameraSelect.value:"";if(r&&e[r]){const o=t(e[r]);if(o)return o}const n=Object.values(e).find(o=>o&&typeof o=="object");if(n){const o=t(n);if(o)return o}return""}function qK(e){if(typeof normalizeFocusScale=="function")try{const r=normalizeFocusScale(e);if(r==="imperial"||r==="metric")return r}catch{}const t=typeof e=="string"?e.trim().toLowerCase():"";return t==="imperial"||t==="metric"?t:""}function jte(e){const t=Array.isArray(e)?e.map(n=>!n||typeof n=="string"?n:typeof n=="object"&&typeof n.type=="string"?{...n}:n):[];let r=!1;if(typeof setFizConnectors=="function")try{setFizConnectors(t),r=!0}catch(n){if(vr&&typeof vr.warn=="function")try{vr.warn("Direct setFizConnectors invocation failed",n,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Direct setFizConnectors invocation failed",n)}if(!r)try{Wr("setFizConnectors",[t],{defer:!0}),r=!0}catch(n){if(vr&&typeof vr.error=="function")try{vr.error("Failed to schedule setFizConnectors",n,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to schedule setFizConnectors",n)}return r}function Hte(e){const t=Array.isArray(e)?e.map(n=>{if(!n)return n;if(typeof n=="string"){const o=n.trim();return o?{type:o,notes:""}:n}if(typeof n=="object"){const o={...n};if(typeof o.type!="string"||!o.type){const a=typeof o.format=="string"&&o.format||typeof o.name=="string"&&o.name||"";a&&(o.type=a)}return typeof o.notes!="string"&&(typeof o.comment=="string"?o.notes=o.comment:o.notes==null&&(o.notes="")),o}return n}):[];let r=!1;if(typeof setTimecodes=="function")try{setTimecodes(t),r=!0}catch(n){if(vr&&typeof vr.warn=="function")try{vr.warn("Direct setTimecodes invocation failed",n,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.warn=="function"&&console.warn("Direct setTimecodes invocation failed",n)}if(!r)try{Wr("setTimecodes",[t],{defer:!0}),r=!0}catch(n){if(vr&&typeof vr.error=="function")try{vr.error("Failed to schedule setTimecodes",n,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to schedule setTimecodes",n)}return r}function Ute(e,t,r){const n=(g,S)=>g||(typeof document<"u"?document.getElementById(S):null),o=n(typeof wattFieldDiv<"u"?wattFieldDiv:null,"wattField"),a=n(typeof batteryFieldsDiv<"u"?batteryFieldsDiv:null,"batteryFields"),i=n(typeof cameraFieldsDiv<"u"?cameraFieldsDiv:null,"cameraFields"),s=n(typeof monitorFieldsDiv<"u"?monitorFieldsDiv:null,"monitorFields"),l=n(typeof viewfinderFieldsDiv<"u"?viewfinderFieldsDiv:null,"viewfinderFields"),c=n(typeof videoFieldsDiv<"u"?videoFieldsDiv:null,"videoFields"),u=n(typeof motorFieldsDiv<"u"?motorFieldsDiv:null,"motorFields"),f=n(typeof controllerFieldsDiv<"u"?controllerFieldsDiv:null,"controllerFields"),d=n(typeof distanceFieldsDiv<"u"?distanceFieldsDiv:null,"distanceFields"),p=n(typeof lensFieldsDiv<"u"?lensFieldsDiv:null,"lensFields"),h=n(typeof subcategoryFieldDiv<"u"?subcategoryFieldDiv:null,"subcategoryField");n(typeof dynamicFieldsDiv<"u"?dynamicFieldsDiv:null,"dynamicFields"),placeWattField(e,t);const m=YI(e,t);if(o&&(o.style.display=""),hideFormSection(a),hideFormSection(i),hideFormSection(s),hideFormSection(l),hideFormSection(c),hideFormSection(u),hideFormSection(f),hideFormSection(d),hideFormSection(p),clearDynamicFields(),m==="batteries")o&&(o.style.display="none"),showFormSection(a),newCapacityInput.value=t.capacity??"",newPinAInput.value=t.pinA??"",dtapRow&&(dtapRow.style.display=e==="batteryHotswaps"?"none":""),newDtapAInput.value=e==="batteryHotswaps"?"":t.dtapA??"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="cameras"){o&&(o.style.display="none"),showFormSection(i);const g=yx(t);cameraWattInput.value=t.powerDrawWatts||"",cameraVoltageInput.value=t.power?.input?.voltageRange||"",cameraPortTypeInput.value=g||"",setBatteryPlates(t.power?.batteryPlateSupport||[]),setRecordingMedia(t.recordingMedia||[]),Wr("setLensMounts",[Array.isArray(t.lensMount)?t.lensMount:[]]),Wr("setPowerDistribution",[t.power?.powerDistributionOutputs||[]],{defer:!0}),setVideoOutputs(t.videoOutputs||[]),jte(t.fizConnectors||[]),setViewfinders(t.viewfinder||[]),Hte(t.timecode||[]),buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="lenses"){o&&(o.style.display="none"),showFormSection(p);const g=VK();let S=[];if(Array.isArray(t?.mountOptions)?S=t.mountOptions:Array.isArray(t?.lensMount)?S=t.lensMount:typeof t?.mount=="string"&&t.mount.trim()&&(S=[{type:t.mount.trim(),mount:"native"}]),setLensDeviceMountOptions(S,g),lensFocusScaleSelect){updateLensFocusScaleSelectOptions();const y=qK(t&&t.focusScale);lensFocusScaleSelect.value=y||""}buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="monitors"){o&&(o.style.display="none"),showFormSection(s),monitorScreenSizeInput.value=t.screenSizeInches||"",monitorBrightnessInput.value=t.brightnessNits||"",monitorWattInput.value=t.powerDrawWatts||"",monitorVoltageInput.value=t.power?.input?.voltageRange||"";const g=yx(t);monitorPortTypeInput.value=g||"",setMonitorVideoInputs(t.videoInputs||t.video?.inputs||[]),setMonitorVideoOutputs(t.videoOutputs||t.video?.outputs||[]),monitorWirelessTxInput.checked=!!t.wirelessTx,monitorLatencyInput.value=t.latencyMs??"",monitorAudioOutputInput.value=t.audioOutput?.portType||t.audioOutput?.type||t.audioOutput||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="viewfinders"){o&&(o.style.display="none"),showFormSection(l),viewfinderScreenSizeInput.value=t.screenSizeInches||"",viewfinderBrightnessInput.value=t.brightnessNits||"",viewfinderWattInput.value=t.powerDrawWatts||"",viewfinderVoltageInput.value=t.power?.input?.voltageRange||"";const g=yx(t);viewfinderPortTypeInput.value=g||"",setViewfinderVideoInputs(t.videoInputs||t.video?.inputs||[]),setViewfinderVideoOutputs(t.videoOutputs||t.video?.outputs||[]),viewfinderWirelessTxInput.checked=!!t.wirelessTx,viewfinderLatencyInput.value=t.latencyMs??"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="video")showFormSection(c),newWattInput.value=t.powerDrawWatts||"",Wr("setVideoPowerInputs",[t.power?.input||t.powerInput||null]),setVideoInputs(t.videoInputs||t.video?.inputs||[]),setVideoOutputsIO(t.videoOutputs||t.video?.outputs||[]),videoFrequencyInput.value=t.frequency||"",videoLatencyInput.value=t.latencyMs??"",motorConnectorInput.value="",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="fiz.motors")showFormSection(u),newWattInput.value=t.powerDrawWatts||"",motorConnectorInput.value=t.fizConnector||"",motorInternalInput.checked=!!t.internalController,motorTorqueInput.value=t.torqueNm||"",motorGearInput.value=Array.isArray(t.gearTypes)?t.gearTypes.join(", "):"",motorNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="fiz.controllers"){showFormSection(f),newWattInput.value=t.powerDrawWatts||"";const g=Array.isArray(t.fizConnectors)?t.fizConnectors.map(S=>S.type).join(", "):t.fizConnector||"";controllerConnectorInput.value=g,controllerPowerInput.value=t.powerSource||"",controllerBatteryInput.value=t.batteryType||"",controllerConnectivityInput.value=t.connectivity||"",controllerNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}else if(m==="distances")showFormSection(d),newWattInput.value=t.powerDrawWatts||"",distanceConnectionInput.value=t.connectionCompatibility||"",distanceMethodInput.value=t.measurementMethod||"",distanceRangeInput.value=t.measurementRange||"",distanceAccuracyInput.value=t.accuracy||"",distanceOutputInput.value=t.outputDisplay||"",distanceNotesInput.value=t.notes||"",buildDynamicFields(e,t,categoryExcludedAttrs[e]||[]);else if(m==="accessories.cables"){o&&(o.style.display="none"),h&&(h.hidden=!1);const g=wK(r?[r]:[]);if(newSubcategorySelect){newSubcategorySelect.innerHTML="";for(let y=0;y<g.length;y+=1){const E=g[y],L=document.createElement("option");L.value=E,L.textContent=E.charAt(0).toUpperCase()+E.slice(1),newSubcategorySelect.appendChild(L)}}const S=r&&g.includes(r)?r:newSubcategorySelect&&newSubcategorySelect.options.length>0?newSubcategorySelect.options[0].value:"";newSubcategorySelect&&(newSubcategorySelect.value=S||"",newSubcategorySelect.disabled=!1),S&&buildDynamicFields(`accessories.cables.${S}`,t,categoryExcludedAttrs[`accessories.cables.${S}`]||[])}else{const g=typeof t=="object"?t.powerDrawWatts:t;newWattInput&&(newWattInput.value=g||"");const S=typeof getSchemaAttributesForCategory=="function"?getSchemaAttributesForCategory(e):[],y=S.includes("powerDrawWatts")||t&&t.powerDrawWatts!==void 0;wattFieldDiv&&(wattFieldDiv.style.display=y?"":"none");const E=S.includes("dtapA")||S.includes("pinA")||t&&(t.dtapA!==void 0||t.pinA!==void 0);dtapRow&&(dtapRow.style.display=E?"":"none"),buildDynamicFields(e,t,categoryExcludedAttrs[e]||[])}}ga("device-manager","click",e=>{if(!e||!e.target)return;let t=null;try{typeof e.target.closest=="function"?t=e.target.closest("button"):e.target.parentElement&&typeof e.target.parentElement.closest=="function"&&(t=e.target.parentElement.closest("button"))}catch{}if(t){try{if(e.currentTarget&&typeof e.currentTarget.contains=="function"&&!e.currentTarget.contains(t))return}catch{}if(t.classList.contains("detail-toggle"))$K(t);else if(t.classList.contains("edit-btn")){const r=t.dataset.name,n=t.dataset.category,o=t.dataset.subcategory,a=XG();if(!a){console.warn("Cannot edit device: category select is unavailable");return}if(!Array.from(a.options).some(u=>u.value===n)){const u=document.createElement("option");u.value=n,u.textContent=categoryNames[currentLang]?.[n]||n,a.appendChild(u)}const i=addDeviceBtn;i&&(i.dataset.mode="edit",i.dataset.originalName=r,i.dataset.originalCategory=n,n==="accessories.cables"&&o?i.dataset.originalSubcategory=o:delete i.dataset.originalSubcategory),a.value=n,newNameInput.value=r,a.dispatchEvent(new Event("change"));let s;if(n==="accessories.cables")s=devices.accessories.cables[o][r];else if(n.includes(".")){const[u,f]=n.split(".");s=devices[u][f][r]}else s=devices[n][r];Ute(n,s,o);const l=addDeviceBtn;l&&(Pc(l,texts[currentLang].updateDeviceBtn,ICON_GLYPHS.save),l.setAttribute("data-help",texts[currentLang].updateDeviceBtnHelp));const c=cancelEditBtn;c&&(Pc(c,texts[currentLang].cancelEditBtn,ICON_GLYPHS.circleX),c.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),showFormSection(c)),document.getElementById("addDeviceHeading").scrollIntoView({behavior:"smooth",block:"start"})}else if(t.classList.contains("delete-btn")){const r=t.dataset.name,n=t.dataset.category,o=t.dataset.subcategory,a=()=>{if(n==="accessories.cables")delete devices.accessories.cables[o][r];else if(n.includes(".")){const[p,h]=n.split(".");delete devices[p][h][r]}else delete devices[n][r];typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),storeDevices(devices),viewfinderTypeOptions=Xu("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=Xu("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),JL(),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0});const i=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,s=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,l=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,c=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(i,devices.cameras,!0),populateMonitorSelect(),populateSelect(s,devices.video,!0);const u=devices.fiz||{},f=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],d=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];f.forEach(p=>populateSelect(p,u.motors,!0)),d.forEach(p=>populateSelect(p,u.controllers,!0)),populateSelect(l,u.distance,!0),populateSelect(c,devices.batteries,!0),updateFizConnectorOptions(),updateMotorConnectorOptions(),updateControllerConnectorOptions(),updateControllerPowerOptions(),updateControllerBatteryOptions(),updateControllerConnectivityOptions(),updatePowerDistTypeOptions(),updatePowerDistVoltageOptions(),updatePowerDistCurrentOptions(),updateTimecodeTypeOptions(),updateDistanceConnectionOptions(),updateDistanceMethodOptions(),updateDistanceDisplayOptions(),applyFilters(),updateCalculations()};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].deleteDeviceTitle||"Delete Device",message:texts[currentLang].confirmDeleteDevice.replace("{name}",r),confirmLabel:"Delete",danger:!0,onConfirm:()=>a()}):confirm(texts[currentLang].confirmDeleteDevice.replace("{name}",r))&&a()}}});function zte(){return deviceManagerSection||document.getElementById("device-manager")}ga("device-manager","keydown",e=>{zte()&&e.target.classList.contains("detail-toggle")&&(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),$K(e.target))});ga("newCategory","change",()=>{console.log("[newCategory change] Category change event fired");const e=addDeviceBtn?.dataset.mode==="edit",t=newNameInput?newNameInput.value:"",r=document.getElementById("newCategory"),n=(r?r.value:"").trim(),o=typeof YI=="function"?YI(n,{}):"generic";console.log("[newCategory change] Inferred type:",o,"for value:",`"${n}"`),placeWattField(n),clearDynamicFields(),subcategoryFieldDiv&&(subcategoryFieldDiv.hidden=!0);const a=newSubcategorySelect?newSubcategorySelect.value:"";if(newSubcategorySelect&&(newSubcategorySelect.innerHTML="",newSubcategorySelect.disabled=!1),dtapRow&&(dtapRow.style.display=""),wattFieldDiv&&(wattFieldDiv.style.display=""),hideFormSection(batteryFieldsDiv),hideFormSection(cameraFieldsDiv),hideFormSection(monitorFieldsDiv),hideFormSection(viewfinderFieldsDiv),hideFormSection(videoFieldsDiv),hideFormSection(motorFieldsDiv),hideFormSection(controllerFieldsDiv),hideFormSection(distanceFieldsDiv),hideFormSection(lensFieldsDiv),o==="batteries")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(batteryFieldsDiv),dtapRow&&(dtapRow.style.display=n==="batteryHotswaps"||n==="accessories.batteryHotswaps"?"none":""),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="cameras")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(cameraFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="lenses")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(lensFieldsDiv),setLensDeviceMountOptions([],VK()),lensFocusScaleSelect&&(updateLensFocusScaleSelectOptions(),lensFocusScaleSelect.value=""),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="monitors")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(monitorFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="viewfinders")wattFieldDiv&&(wattFieldDiv.style.display="none"),showFormSection(viewfinderFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="video")showFormSection(videoFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="fiz.motors")showFormSection(motorFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="fiz.controllers")showFormSection(controllerFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="distances")showFormSection(distanceFieldsDiv),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]);else if(o==="accessories.cables"){wattFieldDiv&&(wattFieldDiv.style.display="none"),subcategoryFieldDiv&&(subcategoryFieldDiv.hidden=!1);const s=wK(a?[a]:[]);for(let c=0;c<s.length;c+=1){const u=s[c],f=document.createElement("option");f.value=u,f.textContent=u.charAt(0).toUpperCase()+u.slice(1),newSubcategorySelect.appendChild(f)}const l=a&&s.includes(a)?a:newSubcategorySelect.options.length>0?newSubcategorySelect.options[0].value:"";newSubcategorySelect.value=newSubcategorySelect&&l||"",l&&buildDynamicFields(`accessories.cables.${l}`,{},categoryExcludedAttrs[`accessories.cables.${l}`]||[])}else{const s=typeof getSchemaAttributesForCategory=="function"?getSchemaAttributesForCategory(n):[],l=s.includes("powerDrawWatts");wattFieldDiv&&(wattFieldDiv.style.display=l?"":"none");const c=s.includes("dtapA")||s.includes("pinA");dtapRow&&(dtapRow.style.display=c?"":"none"),buildDynamicFields(n,{},categoryExcludedAttrs[n]||[])}newWattInput&&(newWattInput.value=""),newCapacityInput&&(newCapacityInput.value=""),newPinAInput&&(newPinAInput.value=""),newDtapAInput&&(newDtapAInput.value=""),cameraWattInput&&(cameraWattInput.value=""),cameraVoltageInput&&(cameraVoltageInput.value=""),cameraPortTypeInput&&(cameraPortTypeInput.value=""),monitorScreenSizeInput&&(monitorScreenSizeInput.value=""),monitorBrightnessInput&&(monitorBrightnessInput.value=""),monitorWattInput&&(monitorWattInput.value=""),monitorVoltageInput&&(monitorVoltageInput.value=""),monitorPortTypeInput&&(monitorPortTypeInput.value=""),monitorWirelessTxInput&&(monitorWirelessTxInput.checked=!1),monitorLatencyInput&&(monitorLatencyInput.value=""),monitorAudioOutputInput&&(monitorAudioOutputInput.value=""),typeof clearMonitorVideoInputs=="function"?clearMonitorVideoInputs():typeof window<"u"&&typeof window.clearMonitorVideoInputs=="function"&&window.clearMonitorVideoInputs(),typeof clearMonitorVideoOutputs=="function"?clearMonitorVideoOutputs():typeof window<"u"&&typeof window.clearMonitorVideoOutputs=="function"&&window.clearMonitorVideoOutputs(),viewfinderScreenSizeInput&&(viewfinderScreenSizeInput.value=""),viewfinderBrightnessInput&&(viewfinderBrightnessInput.value=""),viewfinderWattInput&&(viewfinderWattInput.value=""),viewfinderVoltageInput&&(viewfinderVoltageInput.value=""),viewfinderPortTypeInput&&(viewfinderPortTypeInput.value=""),viewfinderWirelessTxInput&&(viewfinderWirelessTxInput.checked=!1),viewfinderLatencyInput&&(viewfinderLatencyInput.value=""),typeof clearViewfinderVideoInputs=="function"&&clearViewfinderVideoInputs(),typeof clearViewfinderVideoOutputs=="function"&&clearViewfinderVideoOutputs(),clearBatteryPlates(),typeof clearRecordingMedia=="function"&&clearRecordingMedia(),clearLensMounts(),clearLensDeviceMountOptions(),lensFocusScaleSelect&&(lensFocusScaleSelect.value=""),Wr("clearPowerDistribution",[],{defer:!0}),clearVideoOutputs(),clearFizConnectors(),clearViewfinders(),clearTimecodes(),Wr("clearVideoPowerInputs"),clearVideoInputs(),clearVideoOutputsIO(),videoFrequencyInput&&(videoFrequencyInput.value=""),videoLatencyInput&&(videoLatencyInput.value=""),motorConnectorInput&&(motorConnectorInput.value=""),motorInternalInput&&(motorInternalInput.checked=!1),motorTorqueInput&&(motorTorqueInput.value=""),motorGearInput&&(motorGearInput.value=""),motorNotesInput&&(motorNotesInput.value=""),controllerConnectorInput&&(controllerConnectorInput.value=""),controllerPowerInput&&(controllerPowerInput.value=""),controllerBatteryInput&&(controllerBatteryInput.value=""),controllerConnectivityInput&&(controllerConnectivityInput.value=""),controllerNotesInput&&(controllerNotesInput.value=""),distanceConnectionInput&&(distanceConnectionInput.value=""),distanceMethodInput&&(distanceMethodInput.value=""),distanceRangeInput&&(distanceRangeInput.value=""),distanceAccuracyInput&&(distanceAccuracyInput.value=""),distanceOutputInput&&(distanceOutputInput.value=""),distanceNotesInput&&(distanceNotesInput.value=""),n!=="accessories.cables"&&buildDynamicFields(n,{},categoryExcludedAttrs[n]||[]),newNameInput&&(e?newNameInput.value=t:newNameInput.value="");const i=texts[currentLang].cancelEditBtn;if(e){const s=addDeviceBtn;s&&(Pc(s,texts[currentLang].updateDeviceBtn,ICON_GLYPHS.save),s.setAttribute("data-help",texts[currentLang].updateDeviceBtnHelp));const l=cancelEditBtn;l&&(Pc(l,i,ICON_GLYPHS.circleX),l.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),showFormSection(l))}else{const s=addDeviceBtn;s&&(Pc(s,texts[currentLang].addDeviceBtn,ICON_GLYPHS.add),s.setAttribute("data-help",texts[currentLang].addDeviceBtnHelp),s.dataset.mode="add",delete s.dataset.originalName,delete s.dataset.originalSubcategory,delete s.dataset.originalCategory);const l=cancelEditBtn;l&&(Pc(l,i,ICON_GLYPHS.circleX),l.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp),hideFormSection(l))}});ga("newSubcategory","change",()=>{const e=document.getElementById("newCategory");e&&e.value==="accessories.cables"&&buildDynamicFields(`accessories.cables.${newSubcategorySelect.value}`,{},categoryExcludedAttrs[`accessories.cables.${newSubcategorySelect.value}`]||[])});function KK(){const e=addDeviceBtn;e&&(e.dataset.mode="add",delete e.dataset.originalName,delete e.dataset.originalSubcategory,delete e.dataset.originalCategory);const t=cancelEditBtn;t&&(hideFormSection(t),Pc(t,texts[currentLang].cancelEditBtn,ICON_GLYPHS.circleX),t.setAttribute("data-help",texts[currentLang].cancelEditBtnHelp));const r=XG();if(r&&r.isConnected)try{r.dispatchEvent(new Event("change"))}catch(n){console.warn("resetDeviceForm dispatch failed",n)}}function $te(e,t){if(!e||typeof document>"u"||!document)return;const r=String(e),n=document.querySelector(`input.list-filter[data-category-key="${r}"]`)||document.getElementById(`${r.replace(/[^a-z0-9]+/gi,"_")}ListFilter`);if(!n)return;const a=(typeof n.value=="string"?n.value:"").trim();if(!a)return;const i=a.toLowerCase(),s=typeof t=="string"&&t?t.trim().toLowerCase():"";if(!(s&&s.includes(i))){n.value="";try{n.dispatchEvent(new Event("input",{bubbles:!0}))}catch{}try{n.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}}}function Us(e,t,r,n){if(!e||typeof e!="object"||!t){applyDynamicFieldValues(void 0,r,n);return}const o=e[t],a=applyDynamicFieldValues(o,r,n);a&&a!==o&&(e[t]=a)}ga("addDeviceBtn","click",e=>{if(e&&typeof e.preventDefault=="function")try{e.preventDefault()}catch{}const t=newNameInput.value.trim(),r=XG(),n=r?r.value:"",o=addDeviceBtn.dataset.mode==="edit",a=addDeviceBtn.dataset.originalName,i=addDeviceBtn.dataset.originalCategory,s=n==="accessories.cables"?newSubcategorySelect.value:null,l=addDeviceBtn.dataset.originalSubcategory;if(!t){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceNameTitle||"Name Required",message:texts[currentLang].alertDeviceName}):alert(texts[currentLang].alertDeviceName);return}if(n==="accessories.cables"&&!s){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const c=getCategoryContainer(n,s,{create:!0});if(!c){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const u=i||n,f=l||null,d=o?getCategoryContainer(u,u==="accessories.cables"?f:null,{create:!1}):null,p=o&&d?d[a]:void 0,m=o&&u===n&&(n!=="accessories.cables"||f===s),g=o&&u!==n,S=o&&(n==="accessories.cables"&&s!==f||u==="accessories.cables"&&f!==s),y=o&&t!==a;if(!o&&c[t]!==void 0||o&&c[t]!==void 0&&(y||g||S)){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceExistsTitle||"Device Exists",message:texts[currentLang].alertDeviceExists}):alert(texts[currentLang].alertDeviceExists);return}if(n==="batteries"||n==="accessories.batteries"||n==="batteryHotswaps"){const w=parseFloat(newCapacityInput.value),x=parseFloat(newPinAInput.value),G=n==="batteryHotswaps"?void 0:parseFloat(newDtapAInput.value);if(isNaN(w)||isNaN(x)||w<0||x<0||n!=="batteryHotswaps"&&(isNaN(G)||G<0)){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceFieldsTitle||"Incomplete Data",message:texts[currentLang].alertDeviceFields}):alert(texts[currentLang].alertDeviceFields);return}const T=m&&p?{...p}:{};n==="batteryHotswaps"?c[t]={...T,capacity:w,pinA:x}:c[t]={...T,capacity:w,pinA:x,dtapA:G},Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="accessories.cables"){const w=o&&p?{...p}:{};c[t]={...w},Us(c,t,`accessories.cables.${s}`,categoryExcludedAttrs[`accessories.cables.${s}`]||[])}else if(n==="cameras"){const w=parseFloat(cameraWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}let x,G,T,P,N,q;try{x=bf("getPowerDistribution"),G=bf("getVideoOutputs"),T=bf("getFizConnectors"),P=bf("getViewfinders"),N=bf("getTimecodes"),q=bf("getBatteryPlates")}catch(Z){console.error("Invalid camera JSON input:",Z),alert(texts[currentLang].alertInvalidCameraJSON);return}c[t]={powerDrawWatts:w,power:{input:{voltageRange:cameraVoltageInput.value,type:cameraPortTypeInput.value},batteryPlateSupport:q,powerDistributionOutputs:x},videoOutputs:G,fizConnectors:T,recordingMedia:getRecordingMedia(),viewfinder:P,lensMount:getLensMounts(),timecode:N},Us(c,t,n,categoryExcludedAttrs[n]||[]),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0})}else if(n==="lenses"){const w=m&&p?{...p}:{},x=getLensDeviceMountOptions();if(x.length?(w.mountOptions=x,w.mount=x[0].type||""):(delete w.mountOptions,delete w.mount),lensFocusScaleSelect){const G=qK(lensFocusScaleSelect.value);G?w.focusScale=G:delete w.focusScale}c[t]=w,Us(c,t,n,categoryExcludedAttrs[n]||[]),callCoreFunctionIfAvailable("updateMountTypeOptions",[],{defer:!0})}else if(n==="monitors"||n==="directorMonitors"){const w=parseFloat(monitorWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}const x=parseFloat(monitorScreenSizeInput.value),G=parseFloat(monitorBrightnessInput.value),T=typeof monitorLatencyInput.value=="string"?monitorLatencyInput.value.trim():"",P=T!==""?T:void 0,N={screenSizeInches:isNaN(x)?void 0:x,brightnessNits:isNaN(G)?void 0:G,powerDrawWatts:w,power:{input:{voltageRange:monitorVoltageInput.value,type:monitorPortTypeInput.value},output:null},video:{inputs:getMonitorVideoInputs(),outputs:getMonitorVideoOutputs()},wirelessTx:monitorWirelessTxInput.checked,audioOutput:monitorAudioOutputInput.value?{portType:monitorAudioOutputInput.value}:void 0};typeof P<"u"&&(N.latencyMs=P),c[t]=N,Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="viewfinders"){const w=parseFloat(viewfinderWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}const x=parseFloat(viewfinderScreenSizeInput.value),G=parseFloat(viewfinderBrightnessInput.value),T=typeof viewfinderLatencyInput.value=="string"?viewfinderLatencyInput.value.trim():"",P=T!==""?T:void 0,N={screenSizeInches:isNaN(x)?void 0:x,brightnessNits:isNaN(G)?void 0:G,powerDrawWatts:w,power:{input:{voltageRange:viewfinderVoltageInput.value,type:viewfinderPortTypeInput.value},output:null},video:{inputs:getViewfinderVideoInputs(),outputs:getViewfinderVideoOutputs()},wirelessTx:viewfinderWirelessTxInput.checked};typeof P<"u"&&(N.latencyMs=P),c[t]=N,Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="video"||n==="wirelessReceivers"||n==="iosVideo"){const w=parseFloat(newWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}const x=typeof videoLatencyInput.value=="string"?videoLatencyInput.value.trim():"",G=x!==""?x:void 0;let T;try{T=bf("getVideoPowerInputs",[])}catch(K){if(vr&&typeof vr.error=="function")try{vr.error("Failed to collect video power inputs",K,{namespace:"device-editor"})}catch{}typeof console<"u"&&typeof console.error=="function"&&console.error("Failed to collect video power inputs",K),T=void 0}const P=o&&p&&typeof p=="object"?(()=>{try{return JSON.parse(JSON.stringify(p))}catch{return{...p}}})():{},N=P&&typeof P=="object"?P:{};N.powerDrawWatts=w;const q=getVideoInputs();Array.isArray(q)&&q.length?N.videoInputs=q:delete N.videoInputs;const Z=getVideoOutputsIO();Array.isArray(Z)&&Z.length?N.videoOutputs=Z:delete N.videoOutputs;const U=typeof videoFrequencyInput.value=="string"?videoFrequencyInput.value.trim():"";if(U?N.frequency=U:delete N.frequency,typeof T<"u"){const H=(typeof dj.mergePowerInput=="function"?dj.mergePowerInput:(te,re)=>{const fe=te&&typeof te=="object"?{...te}:{};return fe.input=re,fe})(N.power,T);H&&Object.keys(H).length?N.power=H:delete N.power}else delete N.power;typeof G<"u"?N.latencyMs=G:delete N.latencyMs,c[t]=N,Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="fiz.motors"){const w=parseFloat(newWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}c[t]={powerDrawWatts:w,fizConnector:motorConnectorInput.value,internalController:motorInternalInput.checked,torqueNm:motorTorqueInput.value?parseFloat(motorTorqueInput.value):null,gearTypes:motorGearInput.value?motorGearInput.value.split(",").map(x=>x.trim()).filter(Boolean):[],notes:motorNotesInput.value},Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="fiz.controllers"){const w=parseFloat(newWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}c[t]={powerDrawWatts:w,fizConnector:controllerConnectorInput.value,powerSource:controllerPowerInput.value,batteryType:controllerBatteryInput.value,connectivity:controllerConnectivityInput.value,notes:controllerNotesInput.value},Us(c,t,n,categoryExcludedAttrs[n]||[])}else if(n==="fiz.distance"){const w=parseFloat(newWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}c[t]={powerDrawWatts:w,connectionCompatibility:distanceConnectionInput.value,measurementMethod:distanceMethodInput.value,measurementRange:distanceRangeInput.value,accuracy:distanceAccuracyInput.value,outputDisplay:distanceOutputInput.value,notes:distanceNotesInput.value},Us(c,t,n,categoryExcludedAttrs[n]||[])}else{const w=parseFloat(newWattInput.value);if(isNaN(w)||w<=0){alert(texts[currentLang].alertDeviceWatt);return}const x=m&&p?{...p}:{};c[t]={...x,powerDrawWatts:w},Us(c,t,n,categoryExcludedAttrs[n]||[])}o&&(removeOriginalDeviceEntry(u,f,a,n,s,t),addDeviceBtn.dataset.originalCategory=n,n==="accessories.cables"&&s?addDeviceBtn.dataset.originalSubcategory=s:delete addDeviceBtn.dataset.originalSubcategory,addDeviceBtn.dataset.originalName=t),$te(n,t),KK(),typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),storeDevices(devices),viewfinderTypeOptions=Xu("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=Xu("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),Wr("updatePlateTypeOptions"),Wr("updatePowerPortOptions"),Wr("updatePowerDistTypeOptions"),Wr("updatePowerDistVoltageOptions"),Wr("updatePowerDistCurrentOptions"),Wr("updateRecordingMediaOptions"),Wr("updateTimecodeTypeOptions"),JL();const E=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,L=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,v=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,A=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(E,devices.cameras,!0),populateMonitorSelect(),populateSelect(L,devices.video,!0);const R=devices.fiz||{},I=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],C=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];if(I.forEach(w=>populateSelect(w,R.motors,!0)),C.forEach(w=>populateSelect(w,R.controllers,!0)),populateSelect(v,R.distance,!0),populateSelect(A,devices.batteries,!0),updateFizConnectorOptions(),applyFilters(),updateCalculations(),typeof document<"u"&&typeof document.dispatchEvent=="function"){const w=n==="accessories.cables"&&s&&s.trim()||null,x={name:t,category:n,subcategory:w};o&&(x.original={name:a||"",category:u||"",subcategory:u==="accessories.cables"&&f||null});try{document.dispatchEvent(new CustomEvent(o?"device-library:update":"device-library:add",{detail:x}))}catch(G){console.warn("Failed to dispatch device library mutation event",G)}}let k=n.replace(".","_"),_=texts[currentLang]["category_"+k]||n;if(o){const w=texts[currentLang].alertDeviceUpdated.replace("{name}",t).replace("{category}",_);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceUpdatedTitle||"Device Updated",message:w}):alert(w)}else{const w=texts[currentLang].alertDeviceAdded.replace("{name}",t).replace("{category}",_);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertDeviceAddedTitle||"Device Added",message:w}):alert(w)}});ga("cancelEditBtn","click",()=>{KK()});function QI(e="cine_power_planner_export"){const t=new Date,r=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),o=String(t.getDate()).padStart(2,"0"),a=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),s=String(t.getSeconds()).padStart(2,"0");return`${e}_${r}-${n}-${o}_${a}-${i}-${s}.json`}ga("exportDataBtn","click",()=>{if(typeof cc=="function")try{cc({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"export"})}catch(t){console.warn("Failed to auto backup before export",t)}if(!devices||typeof devices!="object"){alert(texts[currentLang].alertExportError||"Export failed: No valid device data found.");return}let e;try{e=JSON.stringify(devices,null,2)}catch(t){console.error("Failed to stringify devices for export",t),typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Export Failed",message:"Unable to serialize device data. Please check for corrupted entries."}):alert("Export failed: Unable to serialize data.");return}if(exportOutput.style.display="block",exportOutput.value=e,typeof downloadBackupPayload=="function")downloadBackupPayload(e,QI());else{const t=new Blob([e],{type:"application/json"}),r=URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=QI(),document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),URL.revokeObjectURL(r)},1500)}});const Vte=document.getElementById("exportAndRevertBtn");Vte&&ga("exportAndRevertBtn","click",()=>{const e=()=>{if(typeof cc=="function")try{cc({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"export-revert"})}catch(o){console.warn("Failed to auto backup before export and revert",o)}const t=JSON.stringify(devices,null,2),r=QI("cine_power_planner_backup_before_revert");if(typeof downloadBackupPayload=="function")downloadBackupPayload(t,r);else{const o=new Blob([t],{type:"application/json"}),a=URL.createObjectURL(o),i=document.createElement("a");i.href=a,i.download=r,document.body.appendChild(i),i.click(),setTimeout(()=>{document.body.removeChild(i),URL.revokeObjectURL(a)},1500)}const n=setTimeout(()=>{if(!Qee())try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to confirm device storage reset during export & revert")}catch{}typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertExportAndRevertSuccessTitle||"Database Reset",message:texts[currentLang].alertExportAndRevertSuccess}):alert(texts[currentLang].alertExportAndRevertSuccess),location.reload()},500);typeof n.unref=="function"&&n.unref()};typeof window.cineShowConfirmDialog=="function"?window.cineShowConfirmDialog({title:texts[currentLang]&&texts[currentLang].exportAndRevertTitle||"Export and Revert",message:texts[currentLang].confirmExportAndRevert,confirmLabel:"Export & Revert",danger:!0,onConfirm:()=>e()}):confirm(texts[currentLang].confirmExportAndRevert)&&e()});ga("importDataBtn","click",()=>{importFileInput.click()});ga("importFileInput","change",e=>{const t=e.target.files[0];t&&(typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.showLoading("Importing Data..."),setTimeout(()=>{const r=new FileReader,n=typeof t.name=="string"&&t.name?t.name:null;r.onload=o=>{try{const a=JSON.parse(o.target.result),i=parseDeviceDatabaseImport(a),s=ij(devices,i.devices);if(!i.devices){const y=formatDeviceImportErrors(i.errors);px("warn","Device import validation failed",{fileName:n,deviceCounts:s,validationErrors:ite(i.errors),errorCount:Array.isArray(i.errors)?i.errors.length:0},{action:"validate"}),console.error("Device import validation failed:",i.errors);const E=y?`${texts[currentLang].alertImportError}
${y}`:texts[currentLang].alertImportError;typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportErrorTitle||"Import Error",message:E}):alert(E);return}if(typeof cc=="function")try{cc({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"import"})}catch(y){px("warn","Auto backup before device import failed",{fileName:n,deviceCounts:s,error:oj(y)},{action:"auto-backup"}),console.warn("Failed to auto backup before import",y)}devices=i.devices,typeof updateGlobalDevicesReference=="function"&&updateGlobalDevicesReference(devices),unifyDevices(devices,{force:!0}),storeDevices(devices),viewfinderTypeOptions=Xu("viewfinderTypeOptions","getAllViewfinderTypes",viewfinderTypeOptions),viewfinderConnectorOptions=Xu("viewfinderConnectorOptions","getAllViewfinderConnectors",viewfinderConnectorOptions),JL();const l=typeof cameraSelect<"u"?cameraSelect:typeof document<"u"?document.getElementById("cameraSelect"):null,c=typeof videoSelect<"u"?videoSelect:typeof document<"u"?document.getElementById("videoSelect"):null,u=typeof distanceSelect<"u"?distanceSelect:typeof document<"u"?document.getElementById("distanceSelect"):null,f=typeof batterySelect<"u"?batterySelect:typeof document<"u"?document.getElementById("batterySelect"):null;populateSelect(l,devices.cameras,!0),populateMonitorSelect(),populateSelect(c,devices.video,!0);const d=devices.fiz||{},p=typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[document.getElementById("motor1Select"),document.getElementById("motor2Select"),document.getElementById("motor3Select"),document.getElementById("motor4Select")],h=typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[document.getElementById("controller1Select"),document.getElementById("controller2Select")];p.forEach(y=>populateSelect(y,devices.fiz.motors,!0)),h.forEach(y=>populateSelect(y,devices.fiz.controllers,!0)),populateSelect(u,devices.fiz.distance,!0),populateSelect(f,devices.batteries,!0),updateFizConnectorOptions(),updateMotorConnectorOptions(),updateControllerConnectorOptions(),updateControllerPowerOptions(),updateControllerBatteryOptions(),updateControllerConnectivityOptions(),updateDistanceConnectionOptions(),updateDistanceMethodOptions(),updateDistanceDisplayOptions(),applyFilters(),updateCalculations();const m=countDeviceDatabaseEntries(devices),g=texts[currentLang].alertImportSuccess.replace("{num_devices}",m);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportSuccessTitle||"Import Successful",message:g}):alert(g);const S=typeof exportOutput<"u"?exportOutput:typeof document<"u"?document.getElementById("exportOutput"):null;S&&(S.style.display="block",S.value=JSON.stringify(devices,null,2))}catch(a){px("error","Failed to import device data",{fileName:n,deviceCounts:ij(devices,null),error:oj(a)},{action:"parse"}),console.error("Error parsing or importing data:",a);const i=a&&a.message?a.message:String(a),s=formatDeviceImportErrors([i]),l=s?`${texts[currentLang].alertImportError}
${s}`:texts[currentLang].alertImportError;typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].alertImportErrorTitle||"Import Error",message:l}):alert(l)}finally{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()}},r.onerror=()=>{typeof window<"u"&&window.cineUiFeedback&&window.cineUiFeedback.hideLoading()},r.readAsText(t)},50),e.target.value="")});function yy(){const e=document.getElementById("cameraSelect"),t=document.getElementById("sensorMode");document.getElementById("recordingResolution");const r=document.getElementById("recordingFrameRateHint");if(!r||!e||!t)return;const n=e.value,o=t.value;let a=200;const s=(globalThis.devices&&globalThis.devices.cameras?globalThis.devices.cameras:{})[n];s&&s.sensorModeMaxFps&&s.sensorModeMaxFps[o]&&(a=s.sensorModeMaxFps[o]);let l=r.getAttribute("data-range-template");l||(typeof texts<"u"&&texts[currentLang]&&texts[currentLang].recordingFrameRateRangeHint?l=texts[currentLang].recordingFrameRateRangeHint:l="Enter a recording frame rate from 1 to {max} fps.");const c=l.replace("{max}",a);r.textContent=c}(function(){const t=document.getElementById("cameraSelect"),r=document.getElementById("sensorMode"),n=document.getElementById("recordingResolution");t&&t.addEventListener("change",()=>{setTimeout(yy,100)}),r&&r.addEventListener("change",yy),n&&n.addEventListener("change",yy),setTimeout(yy,500),setTimeout(yy,500)})();typeof window<"u"&&(window.populateSetupSelect=dg);const $i=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,qte=typeof document<"u"&&document||null,Ge=qte||$i&&$i.document||null;let tl;if(!Ge)tl={autoGearRuleNameInput:null,autoGearRuleNameLabel:null,autoGearScenariosSelect:null,autoGearScenariosLabel:null,autoGearScenarioModeSelectElement:null,autoGearScenarioModeLabel:null,autoGearScenarioMultiplierContainer:null,autoGearScenarioBaseSelect:null,autoGearScenarioBaseLabel:null,autoGearScenarioFactorInput:null,autoGearScenarioFactorLabel:null,autoGearShootingDaysMode:null,autoGearShootingDaysInput:null,autoGearShootingDaysLabel:null,autoGearShootingDaysHelp:null,autoGearShootingDaysValueLabel:null,autoGearMatteboxSelect:null,autoGearMatteboxLabel:null,autoGearMatteboxModeLabel:null,autoGearMatteboxModeSelect:null,autoGearCameraHandleSelect:null,autoGearCameraHandleLabel:null,autoGearCameraHandleModeLabel:null,autoGearCameraHandleModeSelect:null,autoGearViewfinderExtensionSelect:null,autoGearViewfinderExtensionLabel:null,autoGearViewfinderExtensionModeLabel:null,autoGearViewfinderExtensionModeSelect:null,autoGearDeliveryResolutionSelect:null,autoGearDeliveryResolutionLabel:null,autoGearDeliveryResolutionModeLabel:null,autoGearDeliveryResolutionModeSelect:null,autoGearVideoDistributionSelect:null,autoGearVideoDistributionLabel:null,autoGearVideoDistributionModeLabel:null,autoGearVideoDistributionModeSelect:null,autoGearCameraSelect:null,autoGearCameraLabel:null,autoGearCameraModeLabel:null,autoGearCameraModeSelect:null,autoGearOwnGearLabel:null,autoGearOwnGearModeLabel:null,autoGearOwnGearModeSelect:null,autoGearOwnGearSelect:null,autoGearCameraWeightLabel:null,autoGearCameraWeightOperator:null,autoGearCameraWeightOperatorLabel:null,autoGearCameraWeightValueInput:null,autoGearCameraWeightValueLabel:null,autoGearCameraWeightHelp:null,autoGearMonitorSelect:null,autoGearMonitorLabel:null,autoGearMonitorModeLabel:null,autoGearMonitorModeSelect:null,autoGearTripodHeadBrandSelect:null,autoGearTripodHeadBrandLabel:null,autoGearTripodHeadBrandModeLabel:null,autoGearTripodHeadBrandModeSelect:null,autoGearTripodBowlSelect:null,autoGearTripodBowlLabel:null,autoGearTripodBowlModeLabel:null,autoGearTripodBowlModeSelect:null,autoGearTripodTypesSelect:null,autoGearTripodTypesLabel:null,autoGearTripodTypesModeLabel:null,autoGearTripodTypesModeSelect:null,autoGearTripodSpreaderSelect:null,autoGearTripodSpreaderLabel:null,autoGearTripodSpreaderModeLabel:null,autoGearTripodSpreaderModeSelect:null,autoGearCrewPresentSelect:null,autoGearCrewPresentLabel:null,autoGearCrewPresentModeLabel:null,autoGearCrewPresentModeSelect:null,autoGearCrewAbsentSelect:null,autoGearCrewAbsentLabel:null,autoGearCrewAbsentModeLabel:null,autoGearCrewAbsentModeSelect:null,autoGearWirelessSelect:null,autoGearWirelessLabel:null,autoGearWirelessModeLabel:null,autoGearWirelessModeSelect:null,autoGearMotorsSelect:null,autoGearMotorsLabel:null,autoGearMotorsModeLabel:null,autoGearMotorsModeSelect:null,autoGearControllersSelect:null,autoGearControllersLabel:null,autoGearControllersModeLabel:null,autoGearControllersModeSelect:null,autoGearDistanceSelect:null,autoGearDistanceLabel:null,autoGearDistanceModeLabel:null,autoGearDistanceModeSelect:null,autoGearConditionLabels:{},autoGearConditionSelects:{},autoGearConditionLogicLabels:{},autoGearConditionLogicSelects:{},AUTO_GEAR_CONDITION_KEYS:[],AUTO_GEAR_REPEATABLE_CONDITIONS:new Set,AUTO_GEAR_CONDITION_FALLBACK_LABELS:{},getViewfinderFallbackLabel:function(e){return e==="__none__"?"No":typeof e=="string"?e:""},getVideoDistributionFallbackLabel:function(e){return e==="__none__"?"No video distribution selected":typeof e=="string"?e:""},refreshAutoGearShootingDaysValue:function(){},refreshAutoGearScenarioOptions:function(){},refreshAutoGearScenarioBaseSelect:function(){},refreshAutoGearMatteboxOptions:function(){},refreshAutoGearCameraHandleOptions:function(){},refreshAutoGearViewfinderExtensionOptions:function(){},refreshAutoGearDeliveryResolutionOptions:function(){},refreshAutoGearVideoDistributionOptions:function(){},collectAutoGearSelectedValues:function(){return[]},getAutoGearScenarioModeSelectElement:function(){return null},setAutoGearScenarioModeSelectElement:function(){}},typeof module=="object"&&module&&module.exports&&(module.exports=tl),$i&&typeof $i=="object"&&($i.cineCoreAutoGearUi=tl,$i.getViewfinderFallbackLabel=tl.getViewfinderFallbackLabel,$i.getVideoDistributionFallbackLabel=tl.getVideoDistributionFallbackLabel);else{let o=function(v){if(!hE)return;const A=v&&typeof v=="object"&&!Array.isArray(v)?normalizeAutoGearShootingDaysCondition(v):Array.isArray(v)&&v.length?normalizeAutoGearShootingDaysCondition({mode:"minimum",value:v[0]}):autoGearEditorDraft?.shootingDays?normalizeAutoGearShootingDaysCondition(autoGearEditorDraft.shootingDays):null,R=A?A.mode:"minimum";vx&&(vx.value=AUTO_GEAR_SHOOTING_DAY_MODES.has(R)?R:"minimum");const I=A?A.value:"";hE.value=I?String(I):""},a=function(v){if(!zs)return;const A=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.scenarios)?autoGearEditorDraft.scenarios:[],R=Array.from(new Set(A.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));zs.innerHTML="",zs.multiple=!0;const I=Ge.getElementById("requiredScenarios");let C=!1;if(I&&Array.from(I.options).forEach(_=>{if(!_.value)return;const w=Ge.createElement("option");w.value=_.value,w.textContent=_.textContent,R.includes(_.value)&&(w.selected=!0),zs.appendChild(w),C=!0}),C)R.forEach(_=>{if(!Array.from(zs.options||[]).some(x=>x&&x.value===_)){const x=Ge.createElement("option");x.value=_,x.textContent=_,x.selected=!0,zs.appendChild(x)}});else{const _=Ge.createElement("option");_.value="",_.textContent=texts[currentLang]?.autoGearScenarioPlaceholder||texts.en?.autoGearScenarioPlaceholder||"Select scenarios",_.disabled=!0,_.selected=!0,zs.appendChild(_)}const k=Array.from(zs.options||[]).filter(_=>!_.disabled);zs.size=computeAutoGearMultiSelectSize(k.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS}),i(R)},i=function(v){const A=Array.isArray(v)?v.filter(C=>typeof C=="string"&&C.trim()):[],R=Array.from(new Set(A)),I=autoGearEditorDraft?normalizeAutoGearScenarioLogic(autoGearEditorDraft.scenarioLogic):normalizeAutoGearScenarioLogic(e?.value);if(e){const C={all:texts[currentLang]?.autoGearScenarioModeAll||texts.en?.autoGearScenarioModeAll||"Require every selected scenario",any:texts[currentLang]?.autoGearScenarioModeAny||texts.en?.autoGearScenarioModeAny||"Match any selected scenario",multiplier:texts[currentLang]?.autoGearScenarioModeMultiplier||texts.en?.autoGearScenarioModeMultiplier||"Multiply when combined"};Array.from(e.options||[]).forEach(_=>{if(!_)return;_.value==="multiplier"?_.disabled=R.length<2:_.disabled=!1;const w=C[_.value]||C.all;_.textContent=w});let k=I;k==="multiplier"&&R.length<2&&(k="all"),e.value=k,autoGearEditorDraft&&autoGearEditorDraft.scenarioLogic!==k&&(autoGearEditorDraft.scenarioLogic=k),s(k,R)}else s(I,R)},s=function(v,A){if(!yE)return;const R=normalizeAutoGearScenarioLogic(v),I=Array.isArray(A)?A.filter(k=>typeof k=="string"&&k.trim()):[],C=R==="multiplier"&&I.length>=1;yE.hidden=!C,yE.setAttribute("aria-hidden",C?"false":"true"),Sx&&(Sx.disabled=!C),l(I,{forceDisable:!C})},l=function(v,A={}){if(!bc)return;const{forceDisable:R=!1}=A,I=Array.isArray(v)?v.filter(G=>typeof G=="string"&&G.trim()):[],C=Array.from(new Set(I)),k=bc.value||"";if(bc.innerHTML="",R||!C.length){const G=Ge.createElement("option");G.value="",G.textContent=texts[currentLang]?.autoGearScenarioBasePlaceholder||texts.en?.autoGearScenarioBasePlaceholder||"Select a base scenario",G.disabled=!0,G.selected=!0,bc.appendChild(G),bc.disabled=!0;return}C.forEach(G=>{const T=Ge.createElement("option");T.value=G,T.textContent=G,bc.appendChild(T)});const _=autoGearEditorDraft?normalizeAutoGearScenarioPrimary(autoGearEditorDraft.scenarioPrimary):"",w=normalizeAutoGearTriggerValue(_);let x="";if(w){const G=C.find(T=>normalizeAutoGearTriggerValue(T)===w);G&&(x=G)}if(!x&&k){const G=normalizeAutoGearTriggerValue(k),T=C.find(P=>normalizeAutoGearTriggerValue(P)===G);T&&(x=T)}x||(x=C[0]),bc.value=x,bc.disabled=!1},c=function(v){if(!$s)return;const A=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.mattebox)?autoGearEditorDraft.mattebox:[],R=Array.from(new Set(A.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));$s.innerHTML="",$s.multiple=!0;const I=Ge.getElementById("mattebox");let C=!1;if(I&&Array.from(I.options).forEach(_=>{if(!_.value)return;const w=Ge.createElement("option");w.value=_.value,w.textContent=_.textContent,R.includes(_.value)&&(w.selected=!0),$s.appendChild(w),C=!0}),C)R.forEach(_=>{if(!Array.from($s.options||[]).some(x=>x&&x.value===_)){const x=Ge.createElement("option");x.value=_,x.textContent=_,x.selected=!0,$s.appendChild(x)}});else{const _=Ge.createElement("option");_.value="",_.textContent=texts[currentLang]?.autoGearMatteboxPlaceholder||texts.en?.autoGearMatteboxPlaceholder||"Select mattebox options",_.disabled=!0,_.selected=!0,$s.appendChild(_)}const k=Array.from($s.options||[]).filter(_=>!_.disabled);$s.size=computeAutoGearMultiSelectSize(k.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},u=function(v){if(!Vs)return;const A=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.cameraHandle)?autoGearEditorDraft.cameraHandle:[],R=Array.from(new Set(A.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));Vs.innerHTML="",Vs.multiple=!0;const I=Ge.getElementById("cameraHandle");let C=!1;if(I&&Array.from(I.options).forEach(_=>{if(!_.value)return;const w=Ge.createElement("option");w.value=_.value,w.textContent=_.textContent,R.includes(_.value)&&(w.selected=!0),Vs.appendChild(w),C=!0}),C)R.forEach(_=>{if(!Array.from(Vs.options||[]).some(x=>x&&x.value===_)){const x=Ge.createElement("option");x.value=_,x.textContent=_,x.selected=!0,Vs.appendChild(x)}});else{const _=Ge.createElement("option");_.value="",_.textContent=texts[currentLang]?.autoGearCameraHandlePlaceholder||texts.en?.autoGearCameraHandlePlaceholder||"Select camera handles",_.disabled=!0,_.selected=!0,Vs.appendChild(_)}const k=Array.from(Vs.options||[]).filter(_=>!_.disabled);Vs.size=computeAutoGearMultiSelectSize(k.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},f=function(v){if(!v)return"";const A=typeof v.value=="string"?v.value:"";return A||"__none__"},d=function(v){return v==="__none__"?texts[currentLang]?.viewfinderExtensionNone||texts.en?.viewfinderExtensionNone||"No":v},p=function(v){if(v==="__none__")return texts[currentLang]?.autoGearVideoDistributionNone||texts.en?.autoGearVideoDistributionNone||"No video distribution selected";const A=texts[currentLang]?.videoDistributionOptions?.[v];return A||v},h=function(v){if(typeof v!="string")return"";const A=v.trim();if(!A)return"";const R=A.toLowerCase();return R==="__none__"||R==="none"?"__none__":A},m=function(v){if(!qs)return;const A=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.viewfinderExtension)?autoGearEditorDraft.viewfinderExtension:[],R=Array.from(new Set(A.filter(_=>typeof _=="string").map(_=>_.trim()).filter(Boolean)));qs.innerHTML="",qs.multiple=!0;const I=Ge.getElementById("viewfinderExtension");let C=!1;if(I&&Array.from(I.options).forEach(_=>{const w=Ge.createElement("option"),x=f(_);w.value=x,w.textContent=_.textContent,R.includes(x)&&(w.selected=!0),qs.appendChild(w),C=!0}),C)R.forEach(_=>{if(!Array.from(qs.options||[]).some(x=>x&&x.value===_)){const x=Ge.createElement("option");x.value=_,x.textContent=d(_),x.selected=!0,qs.appendChild(x)}});else{const _=Ge.createElement("option");_.value="",_.textContent=texts[currentLang]?.autoGearViewfinderExtensionPlaceholder||texts.en?.autoGearViewfinderExtensionPlaceholder||"Select viewfinder extension options",_.disabled=!0,_.selected=!0,qs.appendChild(_)}const k=Array.from(qs.options||[]).filter(_=>!_.disabled);qs.size=computeAutoGearMultiSelectSize(k.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},g=function(v){if(!Gl)return;const A=y(v,"deliveryResolution");Gl.innerHTML="",Gl.multiple=!0;const R=new Set,I=(k,_)=>{const w=typeof k=="string"?k.trim():"";if(!w||R.has(w))return;const x=Ge.createElement("option");x.value=w,x.textContent=_||w,A.includes(w)&&(x.selected=!0),Gl.appendChild(x),R.add(w)};if(deliveryResolutionSelect&&Array.from(deliveryResolutionSelect.options||[]).forEach(k=>{if(!k||typeof k.value!="string")return;const _=k.value.trim();if(!_)return;const w=(k.textContent||_).trim();I(_,w)}),A.forEach(k=>{R.has(k)||I(k,k)}),!Gl.options.length){const k=Ge.createElement("option");k.value="",k.textContent=texts[currentLang]?.autoGearDeliveryResolutionPlaceholder||texts.en?.autoGearDeliveryResolutionPlaceholder||"Select delivery resolutions",k.disabled=!0,k.selected=!0,Gl.appendChild(k)}const C=Array.from(Gl.options||[]).filter(k=>!k.disabled).length;Gl.size=computeAutoGearMultiSelectSize(C,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},S=function(v){if(!ds)return;const A=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.videoDistribution)?autoGearEditorDraft.videoDistribution:[],R=Array.from(new Set(A.map(h).filter(Boolean))),I=R.includes("__none__"),C=R.filter(G=>G!=="__none__");ds.innerHTML="",ds.multiple=!0;const k=Ge.createElement("option");k.value="__none__",k.textContent=p("__none__"),I&&(k.selected=!0),ds.appendChild(k);const _=Ge.getElementById("videoDistribution");let w=!1;if(_&&Array.from(_.options).forEach(G=>{const T=h(G.value);if(!T)return;if(T==="__none__"){I&&(k.selected=!0);return}const P=Ge.createElement("option");P.value=T,P.textContent=G.textContent,C.includes(T)&&(P.selected=!0),ds.appendChild(P),w=!0}),w)C.forEach(G=>{if(!Array.from(ds.options||[]).some(P=>P&&P.value===G)){const P=Ge.createElement("option");P.value=G,P.textContent=p(G),P.selected=!0,ds.appendChild(P)}});else{const G=Ge.createElement("option");G.value="",G.textContent=texts[currentLang]?.autoGearVideoDistributionPlaceholder||texts.en?.autoGearVideoDistributionPlaceholder||"Select video distribution options",G.disabled=!0,G.selected=!0,ds.appendChild(G)}const x=Array.from(ds.options||[]).filter(G=>!G.disabled);ds.size=computeAutoGearMultiSelectSize(x.length,{minRows:AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS})},y=function(v,A){const R=Array.isArray(v)?v:typeof v=="string"&&v?[v]:Array.isArray(autoGearEditorDraft?.[A])?autoGearEditorDraft[A]:[];return Array.from(new Set(R.filter(I=>typeof I=="string").map(I=>I.trim()).filter(Boolean)))},E=function(){return e},L=function(v){e=v||null};var Kte=Ge.getElementById("autoGearRuleName"),Wte=Ge.getElementById("autoGearRuleNameLabel"),zs=Ge.getElementById("autoGearScenarios"),bj=Ge.getElementById("autoGearScenariosLabel");let e=Ge.getElementById("autoGearScenarioMode");var Yte=Ge.getElementById("autoGearScenarioModeLabel"),yE=Ge.getElementById("autoGearScenarioMultiplierContainer"),bc=Ge.getElementById("autoGearScenarioBase"),Qte=Ge.getElementById("autoGearScenarioBaseLabel"),Sx=Ge.getElementById("autoGearScenarioFactor"),Xte=Ge.getElementById("autoGearScenarioFactorLabel"),vx=Ge.getElementById("autoGearShootingDaysMode"),hE=Ge.getElementById("autoGearShootingDays"),Sj=Ge.getElementById("autoGearShootingDaysLabel"),Jte=Ge.getElementById("autoGearShootingDaysHelp"),Zte=Ge.getElementById("autoGearShootingDaysCountLabel"),$s=Ge.getElementById("autoGearMattebox"),vj=Ge.getElementById("autoGearMatteboxLabel"),Ej=Ge.getElementById("autoGearMatteboxModeLabel"),Aj=Ge.getElementById("autoGearMatteboxMode"),Vs=Ge.getElementById("autoGearCameraHandle"),Cj=Ge.getElementById("autoGearCameraHandleLabel"),wj=Ge.getElementById("autoGearCameraHandleModeLabel"),Lj=Ge.getElementById("autoGearCameraHandleMode"),qs=Ge.getElementById("autoGearViewfinderExtension"),Rj=Ge.getElementById("autoGearViewfinderExtensionLabel"),Tj=Ge.getElementById("autoGearViewfinderExtensionModeLabel"),Oj=Ge.getElementById("autoGearViewfinderExtensionMode"),Gl=Ge.getElementById("autoGearDeliveryResolution"),xj=Ge.getElementById("autoGearDeliveryResolutionLabel"),kj=Ge.getElementById("autoGearDeliveryResolutionModeLabel"),Ij=Ge.getElementById("autoGearDeliveryResolutionMode"),ds=Ge.getElementById("autoGearVideoDistribution"),Pj=Ge.getElementById("autoGearVideoDistributionLabel"),Bj=Ge.getElementById("autoGearVideoDistributionModeLabel"),Gj=Ge.getElementById("autoGearVideoDistributionMode"),Mj=Ge.getElementById("autoGearCamera"),_j=Ge.getElementById("autoGearCameraLabel"),Dj=Ge.getElementById("autoGearCameraModeLabel"),Nj=Ge.getElementById("autoGearCameraMode"),Fj=Ge.getElementById("autoGearOwnGearLabel"),jj=Ge.getElementById("autoGearOwnGearModeLabel"),Hj=Ge.getElementById("autoGearOwnGearMode"),Uj=Ge.getElementById("autoGearOwnGear"),zj=Ge.getElementById("autoGearCameraWeightLabel"),ere=Ge.getElementById("autoGearCameraWeightOperator"),tre=Ge.getElementById("autoGearCameraWeightOperatorLabel"),$j=Ge.getElementById("autoGearCameraWeightValue"),rre=Ge.getElementById("autoGearCameraWeightValueLabel"),nre=Ge.getElementById("autoGearCameraWeightHelp"),Vj=Ge.getElementById("autoGearMonitor"),qj=Ge.getElementById("autoGearMonitorLabel"),Kj=Ge.getElementById("autoGearMonitorModeLabel"),Wj=Ge.getElementById("autoGearMonitorMode"),Yj=Ge.getElementById("autoGearTripodHeadBrand"),Qj=Ge.getElementById("autoGearTripodHeadBrandLabel"),Xj=Ge.getElementById("autoGearTripodHeadBrandModeLabel"),Jj=Ge.getElementById("autoGearTripodHeadBrandMode"),Zj=Ge.getElementById("autoGearTripodBowl"),eH=Ge.getElementById("autoGearTripodBowlLabel"),tH=Ge.getElementById("autoGearTripodBowlModeLabel"),rH=Ge.getElementById("autoGearTripodBowlMode"),nH=Ge.getElementById("autoGearTripodTypes"),oH=Ge.getElementById("autoGearTripodTypesLabel"),aH=Ge.getElementById("autoGearTripodTypesModeLabel"),iH=Ge.getElementById("autoGearTripodTypesMode"),sH=Ge.getElementById("autoGearTripodSpreader"),lH=Ge.getElementById("autoGearTripodSpreaderLabel"),cH=Ge.getElementById("autoGearTripodSpreaderModeLabel"),uH=Ge.getElementById("autoGearTripodSpreaderMode"),fH=Ge.getElementById("autoGearCrewPresent"),dH=Ge.getElementById("autoGearCrewPresentLabel"),pH=Ge.getElementById("autoGearCrewPresentModeLabel"),mH=Ge.getElementById("autoGearCrewPresentMode"),gH=Ge.getElementById("autoGearCrewAbsent"),yH=Ge.getElementById("autoGearCrewAbsentLabel"),hH=Ge.getElementById("autoGearCrewAbsentModeLabel"),bH=Ge.getElementById("autoGearCrewAbsentMode"),SH=Ge.getElementById("autoGearWireless"),vH=Ge.getElementById("autoGearWirelessLabel"),EH=Ge.getElementById("autoGearWirelessModeLabel"),AH=Ge.getElementById("autoGearWirelessMode"),CH=Ge.getElementById("autoGearMotors"),wH=Ge.getElementById("autoGearMotorsLabel"),LH=Ge.getElementById("autoGearMotorsModeLabel"),RH=Ge.getElementById("autoGearMotorsMode"),TH=Ge.getElementById("autoGearControllers"),OH=Ge.getElementById("autoGearControllersLabel"),xH=Ge.getElementById("autoGearControllersModeLabel"),kH=Ge.getElementById("autoGearControllersMode"),IH=Ge.getElementById("autoGearDistance"),PH=Ge.getElementById("autoGearDistanceLabel"),BH=Ge.getElementById("autoGearDistanceModeLabel"),GH=Ge.getElementById("autoGearDistanceMode"),ore={always:autoGearAlwaysLabel,scenarios:bj,shootingDays:Sj,mattebox:vj,cameraHandle:Cj,viewfinderExtension:Rj,deliveryResolution:xj,videoDistribution:Pj,camera:_j,ownGear:Fj,cameraWeight:zj,monitor:qj,tripodHeadBrand:Qj,tripodBowl:eH,tripodTypes:oH,tripodSpreader:lH,crewPresent:dH,crewAbsent:yH,wireless:vH,motors:wH,controllers:OH,distance:PH},are={always:null,scenarios:zs,shootingDays:hE,mattebox:$s,cameraHandle:Vs,viewfinderExtension:qs,deliveryResolution:Gl,videoDistribution:ds,camera:Mj,ownGear:Uj,cameraWeight:$j,monitor:Vj,tripodHeadBrand:Yj,tripodBowl:Zj,tripodTypes:nH,tripodSpreader:sH,crewPresent:fH,crewAbsent:gH,wireless:SH,motors:CH,controllers:TH,distance:IH},ire={mattebox:Ej,cameraHandle:wj,viewfinderExtension:Tj,deliveryResolution:kj,videoDistribution:Bj,camera:Dj,ownGear:jj,monitor:Kj,tripodHeadBrand:Xj,tripodBowl:tH,tripodTypes:aH,tripodSpreader:cH,crewPresent:pH,crewAbsent:hH,wireless:EH,motors:LH,controllers:xH,distance:BH},MH={mattebox:Aj,cameraHandle:Lj,viewfinderExtension:Oj,deliveryResolution:Ij,videoDistribution:Gj,camera:Nj,ownGear:Hj,monitor:Wj,tripodHeadBrand:Jj,tripodBowl:rH,tripodTypes:iH,tripodSpreader:uH,crewPresent:mH,crewAbsent:bH,wireless:AH,motors:RH,controllers:kH,distance:GH};Object.values(MH).forEach(v=>{v&&(v.disabled=!0)}),tl={autoGearRuleNameInput:Kte,autoGearRuleNameLabel:Wte,autoGearScenariosSelect:zs,autoGearScenariosLabel:bj,autoGearScenarioModeSelectElement:e,autoGearScenarioModeLabel:Yte,autoGearScenarioMultiplierContainer:yE,autoGearScenarioBaseSelect:bc,autoGearScenarioBaseLabel:Qte,autoGearScenarioFactorInput:Sx,autoGearScenarioFactorLabel:Xte,autoGearShootingDaysMode:vx,autoGearShootingDaysInput:hE,autoGearShootingDaysLabel:Sj,autoGearShootingDaysHelp:Jte,autoGearShootingDaysValueLabel:Zte,autoGearMatteboxSelect:$s,autoGearMatteboxLabel:vj,autoGearMatteboxModeLabel:Ej,autoGearMatteboxModeSelect:Aj,autoGearCameraHandleSelect:Vs,autoGearCameraHandleLabel:Cj,autoGearCameraHandleModeLabel:wj,autoGearCameraHandleModeSelect:Lj,autoGearViewfinderExtensionSelect:qs,autoGearViewfinderExtensionLabel:Rj,autoGearViewfinderExtensionModeLabel:Tj,autoGearViewfinderExtensionModeSelect:Oj,autoGearDeliveryResolutionSelect:Gl,autoGearDeliveryResolutionLabel:xj,autoGearDeliveryResolutionModeLabel:kj,autoGearDeliveryResolutionModeSelect:Ij,autoGearVideoDistributionSelect:ds,autoGearVideoDistributionLabel:Pj,autoGearVideoDistributionModeLabel:Bj,autoGearVideoDistributionModeSelect:Gj,autoGearCameraSelect:Mj,autoGearCameraLabel:_j,autoGearCameraModeLabel:Dj,autoGearCameraModeSelect:Nj,autoGearOwnGearLabel:Fj,autoGearOwnGearModeLabel:jj,autoGearOwnGearModeSelect:Hj,autoGearOwnGearSelect:Uj,autoGearCameraWeightLabel:zj,autoGearCameraWeightOperator:ere,autoGearCameraWeightOperatorLabel:tre,autoGearCameraWeightValueInput:$j,autoGearCameraWeightValueLabel:rre,autoGearCameraWeightHelp:nre,autoGearMonitorSelect:Vj,autoGearMonitorLabel:qj,autoGearMonitorModeLabel:Kj,autoGearMonitorModeSelect:Wj,autoGearTripodHeadBrandSelect:Yj,autoGearTripodHeadBrandLabel:Qj,autoGearTripodHeadBrandModeLabel:Xj,autoGearTripodHeadBrandModeSelect:Jj,autoGearTripodBowlSelect:Zj,autoGearTripodBowlLabel:eH,autoGearTripodBowlModeLabel:tH,autoGearTripodBowlModeSelect:rH,autoGearTripodTypesSelect:nH,autoGearTripodTypesLabel:oH,autoGearTripodTypesModeLabel:aH,autoGearTripodTypesModeSelect:iH,autoGearTripodSpreaderSelect:sH,autoGearTripodSpreaderLabel:lH,autoGearTripodSpreaderModeLabel:cH,autoGearTripodSpreaderModeSelect:uH,autoGearCrewPresentSelect:fH,autoGearCrewPresentLabel:dH,autoGearCrewPresentModeLabel:pH,autoGearCrewPresentModeSelect:mH,autoGearCrewAbsentSelect:gH,autoGearCrewAbsentLabel:yH,autoGearCrewAbsentModeLabel:hH,autoGearCrewAbsentModeSelect:bH,autoGearWirelessSelect:SH,autoGearWirelessLabel:vH,autoGearWirelessModeLabel:EH,autoGearWirelessModeSelect:AH,autoGearMotorsSelect:CH,autoGearMotorsLabel:wH,autoGearMotorsModeLabel:LH,autoGearMotorsModeSelect:RH,autoGearControllersSelect:TH,autoGearControllersLabel:OH,autoGearControllersModeLabel:xH,autoGearControllersModeSelect:kH,autoGearDistanceSelect:IH,autoGearDistanceLabel:PH,autoGearDistanceModeLabel:BH,autoGearDistanceModeSelect:GH,autoGearConditionLabels:ore,autoGearConditionSelects:are,autoGearConditionLogicLabels:ire,autoGearConditionLogicSelects:MH,AUTO_GEAR_CONDITION_KEYS:["always","scenarios","shootingDays","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","cameraWeight","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"],AUTO_GEAR_REPEATABLE_CONDITIONS:new Set(["scenarios","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance"]),AUTO_GEAR_CONDITION_FALLBACK_LABELS:{always:"Always include",scenarios:"Required scenarios",shootingDays:"Shooting days condition",mattebox:"Mattebox options",cameraHandle:"Camera handles",viewfinderExtension:"Viewfinder extension",deliveryResolution:"Delivery resolution",videoDistribution:"Video distribution",camera:"Camera",ownGear:"Own gear items",cameraWeight:"Camera weight",monitor:"Onboard monitor",tripodHeadBrand:"Tripod head brand",tripodBowl:"Tripod bowl size",tripodTypes:"Tripod types",tripodSpreader:"Tripod spreader",crewPresent:"Crew present",crewAbsent:"Crew absent",wireless:"Wireless transmitter",motors:"FIZ motors",controllers:"FIZ controllers",distance:"FIZ distance devices"},getViewfinderFallbackLabel:d,getVideoDistributionFallbackLabel:p,refreshAutoGearShootingDaysValue:o,refreshAutoGearScenarioOptions:a,refreshAutoGearScenarioBaseSelect:l,refreshAutoGearMatteboxOptions:c,refreshAutoGearCameraHandleOptions:u,refreshAutoGearViewfinderExtensionOptions:m,refreshAutoGearDeliveryResolutionOptions:g,refreshAutoGearVideoDistributionOptions:S,collectAutoGearSelectedValues:y,getAutoGearScenarioModeSelectElement:E,setAutoGearScenarioModeSelectElement:L,normalizeVideoDistributionOptionValue:h}}$i&&typeof $i=="object"&&($i.cineCoreAutoGearUi=tl,$i.getViewfinderFallbackLabel=tl.getViewfinderFallbackLabel,$i.getVideoDistributionFallbackLabel=tl.getVideoDistributionFallbackLabel,$i.normalizeVideoDistributionOptionValue=tl.normalizeVideoDistributionOptionValue);const Ex=tl,sre={texts:{appTitle:"Cine Power Planner",tagline:"Plan your film rig and calculate power consumption & battery life.",printPreview:{title:"Print & Export",closeLabel:"Close Preview",layoutModeTitle:"Layout Mode",layoutRentalLabel:"Rental Friendly",layoutRentalDescription:"Optimizes layout for rental by grouping items by category.",sectionsTitle:"Sections",sectionProject:"Production Requirements",sectionDevices:"Camera Package Devices",sectionDiagram:"Power Diagram",sectionGearList:"Kit List",sectionBattery:"Battery Comparison",exportPdfButton:"Export PDF",printButton:"Print",generatedTitle:"Overview",generatedProjectNameLabel:"Project Name:",generatedProductionLabel:"Production:",generatedDateLabel:"Date:",generatedNoProjectRequirements:"No production requirements data.",generatedDeviceSelectionTitle:"Camera Package Devices",generatedNoDevicesSelected:"No devices selected.",generatedPowerDiagramTitle:"Power Diagram",generatedPowerSummaryTitle:"Power Summary",generatedGearListTitle:"Kit List",generatedTotalLoad:"Total Load",generatedPeak:"Peak:",generatedEstRuntime:"Est. Runtime",generatedWith:"w/",generatedDailyNeeds:"Daily Needs",generatedBatts:"Batts",generatedFor12hDay:"for 12h day"},skipToContent:"Skip to content",offlineIndicator:"Offline",offlineIndicatorHelp:"Appears when the planner is offline or the service worker reports degraded connectivity. All projects, backups and device data stay stored on this device so you can keep working. Force reload and other network actions stay disabled until connectivity recovers.",offlineIndicatorDegraded:"Connectivity degraded  working from cached copy.",offlineIndicatorDegradedHelp:"The service worker served cached content after a failed probe. Continue working from the offline copy and retry once the banner clears.",offlineIndicatorReasonCacheFallback:"Service worker served the cached bundle after a network error.",offlineIndicatorReasonGetFailed:"Network request for the reload check failed.",offlineIndicatorReasonTimeout:"Connectivity probe timed out before the server responded.",offlineIndicatorReasonUnreachable:"The probe could not reach the server.",offlineIndicatorReasonReloadBlocked:"Reload is paused until a healthy connection is confirmed.",offlineIndicatorReasonUnknown:"Connectivity degraded. Keep working offline until the banner clears.",globalLoadingIndicator:"Loading data",globalLoadingIndicatorPreparing:"Preparing planner",globalLoadingIndicatorModules:"Loading planner interface",globalLoadingIndicatorData:"Loading planner data",globalLoadingIndicatorAlmostReady:"Almost ready",installBannerText:"Install Cine Power Planner on your device for quick access.",installBannerDismiss:"Dismiss",installHelpTitleIos:"Install Cine Power Planner on iOS",installHelpTitleAndroid:"Install Cine Power Planner on Android",installHelpIntroIos:"Add the planner to your Home Screen to use it like an app.",installHelpIntroAndroid:"Add the planner to your Home Screen to use it like an app.",installHelpStepsIos:["Open Cine Power Planner in Safari.","Tap the Share button.","Choose Add to Home Screen and confirm."],installHelpStepsAndroid:["Open Cine Power Planner in Chrome.","Tap the browser menu ().","Choose Add to Home Screen and confirm."],installHelpNoteIos:"Once installed, launch Cine Power Planner from your Home Screen.",installHelpNoteAndroid:"Android keeps using the same storage for the browser and the installed app, so your projects stay available.",installHelpMigrationTitle:"Move your existing data into the app",installHelpClose:"Close",iosPwaHelpTitle:"Keep your data when installing on iOS",iosPwaHelpIntro:"Safari keeps the browser tab and the installed app separate. To move your Cine Power Planner data into the app:",iosPwaHelpStep1:"Open Cine Power Planner in Safari where your projects are still visible.",iosPwaHelpStep2:"Go to Settings  Backup & Restore  Backup to download a copy of your data.",iosPwaHelpStep3:"Open Cine Power Planner from your home screen.",iosPwaHelpStep4:"Go to Settings  Backup & Restore  Restore and pick the backup file.",iosPwaHelpNote:"After restoring once, all changes stay inside the installed app. Keep the backup if you plan to reinstall or switch devices.",iosPwaHelpClose:"Got it",impressum:"Imprint",privacy:"Privacy Policy",setupManageHeading:"Project Overview",deviceSelectionHeading:"Camera Package",overviewDeviceSelectionHeading:"Camera Package Devices",resultsHeading:"Power Summary",deviceManagerHeading:"Device Library",batteryComparisonHeading:"Battery Comparison",batteryComparisonDescription:"Review every compatible battery to see runtime estimates for your current setup.",batteryComparisonDescriptionHelp:"This table lists every compatible battery and updates as you change your setup. Hover any heading to learn what the numbers represent.",batteryComparisonTableHelp:"Rows show compatible batteries. Runtime includes current draw calculations, and the colored bar compares runtime length at a glance.",setupDiagramHeading:"Power Diagram",diagramPdfNote:"The Power Diagram is not included in the PDF export. Open the print view to review the layout.",projectRequirementsNav:"Production Requirements",projectRequirementsNavHelp:"Jump to the Production Requirements output once generated.",gearListNav:"Kit List",gearListNavHelp:"View the generated kit list with all items and categories.",ownGearNav:"Own Gear",ownGearNavHelp:"Track personal gear you already have on hand and reuse it across projects.",overviewExportTitleSuffix:"Kit List and Production Requirements",openSettingsNav:"Settings",openSettingsNavHelp:"Open Settings to adjust language, themes, accessibility options and backups.",openHelpNav:"Help Center",openHelpNavHelp:"Open the in-app help guide with tutorials, troubleshooting tips and shortcuts.",setupManageHeadingHelp:"Manage saved projects: save, load, or clear configurations.",deviceSelectionHeadingHelp:"Choose cameras, monitors, and accessories for your camera package.",resultsHeadingHelp:"See power consumption, estimated runtime, and battery counts.",resultsPlainSummaryTitle:"Quick summary",resultsPlainSummaryHelp:"Explains the power summary in plain language so you can confirm runtime and battery needs without reading every table.",resultsPlainSummaryPrompt:"Add devices and choose a battery to see a plain-language summary of runtime and consumption.",resultsPlainSummaryNeedBattery:"Choose a battery to see how long the rig will run and how many packs to pack.",resultsPlainSummaryRuntime:"With {batteryName}, expect about {hours} hours of runtime. Pack {batteryCount} batteries for a 10-hour day. Your rig currently draws {totalPower} W.",resultsPlainSummaryUnlimited:"With {batteryName}, your rig draws {totalPower} W, so runtime stays unlimited. Keep a charged pack connected before recording.",resultsPlainSummaryNote:"Pins and D-Tap status updates as you add gear.",resultsPlainSummaryPinsZero:"Pins: no 12V draw yet.",resultsPlainSummaryPinsOk:"Pins: {current}A within the {max}A limit.",resultsPlainSummaryPinsNear:"Pins: {current}A is close to the {max}A limit.",resultsPlainSummaryPinsExceeded:"Pins: {current}A exceeds the {max}A limit.",resultsPlainSummaryPinsUnknown:"Pins: draw is {current}A but no limit is documented.",resultsPlainSummaryDtapZero:"D-Tap: idle.",resultsPlainSummaryDtapOk:"D-Tap: {current}A within the {max}A rating.",resultsPlainSummaryDtapNear:"D-Tap: {current}A is close to the {max}A rating.",resultsPlainSummaryDtapExceeded:"D-Tap: {current}A exceeds the {max}A rating.",resultsPlainSummaryDtapUnavailable:"D-Tap: auxiliary port disabled for this battery selection.",resultsPlainSummaryDtapUnavailableBMount:"D-Tap: B-Mount cameras disable the aux port.",resultsPlainSummaryDtapUnknown:"D-Tap: rating missing, treat {current}A with caution.",resultsPlainSummaryUnnamedBattery:"your selected battery",deviceManagerHeadingHelp:"Add, edit or remove entries from the device database, including categories, subcategories and attributes.",batteryComparisonHeadingHelp:"Compare runtimes for all compatible batteries.",batteryTableBatteryHelp:"Battery name and mount that can power your current build.",batteryTableRuntimeHelp:"Estimated runtime in hours plus which outputs supply enough current.",batteryTableGraphLabel:"Runtime comparison bar",batteryTableGraphHelp:"Bar length compares runtime across batteries. Green covers pins and D-Tap, orange means only main pins, and blue marks infinite runtime estimates.",setupDiagramHeadingHelp:"View the Power Diagram showing how power, video, and control connect across the rig.",setupDiagramPlaceholder:"Select devices to visualize the project.",diagramLegendPower:"Power",diagramLegendVideo:"Video",diagramLegendFIZ:"FIZ",downloadDiagramBtn:"Download Power Diagram",gridSnapToggle:"Snap to Grid",existingDevicesHeading:"Existing Devices",deviceLibrarySearchLabel:"Search entire library",deviceLibrarySearchPlaceholder:"Search all device categories",deviceLibrarySearchHelp:"Filter across every category at once. Press Enter to jump to the closest match.",deviceLibrarySearchStatusDefault:"Showing all {total} devices.",deviceLibrarySearchResultOne:"Showing {visible} of {total} devices.",deviceLibrarySearchResultOther:"Showing {visible} of {total} devices.",deviceLibrarySearchNoResults:"No devices match {query}.",darkModeLabel:"Toggle dark mode",existingDevicesSubtitle:"Browse and manage devices in your library",existingDevicesTitle:"Existing Devices",addDeviceSubtitle:"Create a custom device entry for your database",addNewDeviceTitle:"Add New Device",tabBrowseLibrary:"Browse Library",tabAddDevice:"Add Device",deviceLibrarySubtitle:"Add, edit, and manage devices in your local database",deviceLibraryTitle:"Device Library",pinkModeLabel:"Toggle pink mode",menuToggleLabel:"Menu",menuToggleHelp:"Open the sidebar to jump between planner sections or reveal controls on smaller screens. Click again to close it.",sideMenuTitle:"Planner sections",sideMenuTitleHelp:"Swipe up to explore planner sections and mobile controls. Your project keeps saving automatically while you browse.",sideMenuClose:"Close navigation",sideMenuCloseHelp:"Close the navigation drawer and return to the planner. Your data stays saved and ready to restore if needed.",sideMenuHelp:"Sidebar navigation listing planner sections. Select a section to scroll there and the menu closes automatically.",contacts:{heading:"Contacts",description:"Save crew members once, keep them stored offline and reuse them for every project.",addContactButton:"Add contact",importButton:"Import vCard",importHint:"Import .vcf files to add contacts instantly. Existing details are preserved automatically.",emptyState:"No contacts saved yet. Add your crew to reuse them later.",close:"Close",selectLabel:"Saved contacts",selectPlaceholder:"Select contact",saveContact:"Save to contacts",openManager:"Open contacts",linkedBadge:"Linked to contact",linkedProfileBadge:"Linked to user profile",contactMissingDetails:"Enter a name, email, phone number or website before saving this contact.",websiteLabel:"Website",websitePlaceholder:"https://example.com",avatarOptionsTitle:"Photo options",avatarOptionsDescription:"Preview this photo, choose how to update it, or click outside the window to save and close.",avatarOptionsClose:"Close",avatarDelete:"Delete photo",avatarEditAction:"Edit framing",avatarChange:"Change photo",avatarCleared:"Profile photo removed.",avatarTooLarge:"Choose an image under 300 KB.",avatarReadError:"Could not read the selected image.",avatarUpdated:"Profile photo updated.",avatarEditInstructions:"Drag the photo to adjust the framing.",avatarEditZoomLabel:"Zoom",avatarEditCancel:"Cancel",avatarEditApply:"Apply framing",avatarMissingImage:"Add a photo before editing.",avatarEditUnavailable:"Photo editor unavailable.",avatarEditFailed:"Could not update the photo framing.",userProfileHeading:"Your profile",userProfileDescription:"Add your name, role, phone and email so your gear shows as User.",userProfileNameLabel:"Display name",userProfileNamePlaceholder:"Your name",userProfileRoleLabel:"Role or title",userProfileRolePlaceholder:"Select role",userProfilePhoneLabel:"Phone number",userProfilePhonePlaceholder:"Your phone number",userProfileEmailLabel:"Email address",userProfileEmailPlaceholder:"name@example.com",userProfileHint:"Used to show your first name and last initial for the User option in the provided by dropdown. Phone and email appear on exports and backups so crews can reach you offline.",userProfileAvatarButton:"Change photo",userProfileAvatarRemove:"Remove photo",userProfileSaved:"Profile saved.",contactDetached:"Crew row disconnected from saved contact.",contactApplied:"Crew row updated from contact.",contactDeleted:"Contact removed. Project rows keep their details.",contactSaved:"Contact saved for future projects.",contactUpdated:"Contact updated.",contactDraftCreated:"New contact ready. Fill in the details.",contactFallbackName:"Crew contact",useInProject:"Add to project crew",contactAddedToProject:"Contact added to the current project.",deleteContact:"Delete contact",deleteConfirm:"Remove this contact? Project rows will keep their details.",importSummary:"{added} added, {updated} updated.",importNone:"No new contacts found in the file.",importError:"Could not import the selected file.",rolePlaceholder:"Select role"},featureSearchPlaceholder:"Search features or devices...",featureSearchLabel:"Search features, devices and help",featureSearchHelp:`Type to jump to features, devices, quick actions like Save or Backup, or help topics. Suggestions prioritize direct feature and device matches before help topics so navigation lands on controls first. Each entry shows whether it opens a Feature, Action, Device or Help topic so you know what happens before pressing Enter. Exact matches and items you've used recently jump to the top automatically, so your go-to controls stay first. Every suggestion also includes a short description so you can confirm what it will do at a glance. Search also reads the same tooltip and help text shown around controls, so words like "JSON" or "autosave" still land on the right button even if the label differs. Small typos are forgiven too, so "bakcup" still finds Backup or Save. Connector and media abbreviations like "USB-C", "Micro-HDMI", "SDXC", "CFexpress", "V-Mount" or "D-Tap" automatically match their full names, so type whichever version you remember. Exposure and color vocabulary is linked the same wayISO, EI, ASA, exposure index, ND or neutral density, and WB, white balance or color temperature terms all resolve together so any phrasing points to the right controls. Press Enter to navigate, / or Ctrl+K (Cmd+K on Mac) to focus the search from anywhere, use Escape or  to clear the query, and notice how clearing the field floats your most recently used matches to the top for faster repeats. Prefix your query with "feature", "action", "device" or "help" (or your localized equivalents) (for example, "help: battery") to filter suggestions to that type. Start with "recent" or "history" (or your localized equivalents) (for example, "recent iso") to search only items you've used lately before scanning the full catalog. Wrap any phrase in double quotes to force an exact match, so typing "battery health" with quotes jumps ahead of broader matches. Common filler words are ignored automatically, so conversational questions like "how do I back up" still surface the important keywords.`,featureSearchFilterAliases:{feature:["feature","features","setting","settings"],action:["action","actions","command","commands"],device:["device","devices","gear","equipment"],help:["help","doc","docs","guide","guides","support"],recent:["recent","recents","recently","history","histories","frequent","frequently"]},featureSearchStopWords:["how","do","does","did","done","doing","can","cant","cannot","should","could","would","please","need","needs","needing","want","wants","wanting","i","im","ive","ill","id","we","were","weve","well","you","youre","youve","youll","they","theyre","theyve","them","us","me","my","mine","our","ours","your","yours","their","theirs","the","and","for","with","about","what","where","when","why","which","who","whom","whose","this","that","these","those","also","still","really","very","just","maybe","perhaps","again"],featureSearchClear:"Clear search",featureSearchClearHelp:"Clear the search box and show all results again. Press Escape to clear quickly.",featureSearchTypeFeature:"Feature",featureSearchTypeAction:"Action",featureSearchTypeDevice:"Device",featureSearchTypeHelp:"Help topic",darkModeHelp:"Switch between light and dark themes for comfortable viewing. Press D to toggle. The preference is saved.",pinkModeHelp:"Add a playful pink accent theme. The unicorn icon cycles every 30 seconds with a gentle pop animation while pink mode is on, and the setting works with light or dark mode and is remembered for next time.",settingsButton:"Settings",settingsButtonHelp:"Open Settings to personalize language, colors, fonts, accessibility options and backups.",settingsHeading:"Settings",settingsHeadingHelp:"Adjust language, themes, typography, accessibility preferences and backups in one place.",settingsSectionsLabel:"Settings sections",settingsTabGeneral:"General",settingsTabGeneralHelp:"Adjust language, theme, typography and branding preferences.",generalSectionLanguageHeading:"Language & units",generalSectionAppearanceHeading:"Appearance",generalSectionCameraColorsHeading:"Camera designations",generalSectionTypographyHeading:"Typography",generalSectionBrandingHeading:"Branding",documentationTrackerHeading:"Documentation update tracker",documentationTrackerDescription:"Use this log to mark translation, help and print guide refreshes before distributing offline bundles.",documentationTrackerAddRelease:"New release log",documentationTrackerEmpty:"No releases tracked yet. Add the upcoming release to start logging updates.",documentationTrackerSummaryIntro:"Create release log entries to track translations, help topics, READMEs and print guides until every item is verified.",documentationTrackerLocalesHeading:"Localized README coverage",documentationTrackerLocaleEnglish:"English README",documentationTrackerLocaleGerman:"German README",documentationTrackerLocaleSpanish:"Spanish README",documentationTrackerLocaleFrench:"French README",documentationTrackerLocaleItalian:"Italian README",documentationTrackerHelpHeading:"Help center topics",helpTopics:{projectManagement:{title:"Project Management",content:"Name projects and press **Save** to capture snapshots in Saved Projects. Saving wont overwrite other projects until you confirm the name. Autosave and auto-backups protect drafts, and Delete removes entries only after a safety snapshot is created."},saveShareBackup:{title:"Save, Share & Backup",content:"Use **Export Project** to download a JSON bundle (optionally include automatic gear rules and owned-gear markers). Use **Share Project** to create a share bundle for offline import; recipients open it with **Import Project** and nothing overwrites their current setup until they confirm Save. Use **Backup & Restore** for full-app backups, restore rehearsals, version comparisons, and the local backup vault when automatic downloads are blocked."},deviceConfiguration:{title:"Camera Package",content:"Build your camera package by selecting devices. Start with a **Camera**, then add **Monitors**, **Wireless Transmitters**, and **FIZ** systems. Use the Device Library to import or export custom gear so offline edits stay with your projects."},powerCalculation:{title:"Power Calculation",content:"The **Power Summary** shows the total power consumption of your rig and estimated runtime based on the selected battery and mount voltages. Watch for **Pin** and **D-Tap** warnings, and use the quick summary to explain results offline."},connectionDiagram:{title:"Power Diagram",content:"The **Power Diagram** shows how power, video, and control gear connect. Drag to arrange nodes, zoom and pan to inspect details, and download SVG or JPG snapshots for sharing."},gearList:{title:"Kit List",content:"Generate a detailed **Kit List** from camera package devices and production requirements. Edit quantities, providers, temporary extras and owned-gear badges, then print or export it for rental or crew."},contacts:{title:"Contacts",content:"Save crew members in **Contacts** or import vCards. Entries reuse across projects and flow into providers, backups and exports."},ownGear:{title:"Own Gear",content:"Track your personal inventory in **Own Gear**. Mark items you own so kit list rows can be flagged and exported with those annotations."},settings:{title:"Settings",content:"Customize the planner in **Settings**. Adjust **Language**, themes, typography, branding and **Backup & Restore** safeguards, plus automatic gear rules and documentation tracking."},offlineUse:{title:"Offline Use",content:"Cine Power Planner works fully **Offline** with locally stored icons, fonts and help content. Verify the offline indicator. Export at least one project and create a full backup before disconnecting. Run a restore rehearsal (or at minimum confirm the latest autosave timestamp in Settings  Data & Storage)."},troubleshooting:{title:"Troubleshooting",content:`If things aren't working as expected:

- **Force reload**: Open the toolbar help/status menu and choose **Force reload** to refresh the app without touching your data.
- **Export + Backup**: Before clearing browser cache or site data, **Export Project** and run **Backup & Restore** to capture your project and a full local backup.
- **Browser cache/site data**: Only if issues persist, clear your browser cache or site data. **Warning:** clearing site data can delete locally stored projects.`},shortcuts:{title:"Keyboard Shortcuts",content:`Navigate faster with these keys:

- **?**, **H**, **F1**: Open Help
- **/**: Focus Search
- **Esc**: Close dialogs or menus
- **D**: Toggle Dark Mode`},pinkMode:{title:"Pink Mode",content:"Activate **Pink Mode** in Settings or the top bar to add playful accents and animated icons. The unicorn icon cycles every 30 seconds, and floating stickers drift across the screen. Click any floating sticker **3 times** to trigger a celebratory rain effect."}},documentationTrackerHelpStart:"Start Here & navigation",documentationTrackerHelpSave:"Saving, sharing & exports",documentationTrackerHelpBackup:"Backup & restore drills",documentationTrackerHelpOwnGear:"Own gear & imports",documentationTrackerHelpOffline:"Offline readiness & service worker",documentationTrackerHelpPinkMode:"Pink mode & animations",documentationTrackerPrintHeading:"Printable guides",documentationTrackerPrintChecklist:"Documentation update checklist",documentationTrackerPrintMaintenance:"Documentation maintenance guide",documentationTrackerPrintSaveShare:"Save, share, import, backup & restore reference",documentationTrackerPrintOffline:"Offline readiness drill",documentationTrackerReleaseNameLabel:"Release name",documentationTrackerReleaseDateLabel:"Target release date",documentationTrackerNotesLabel:"Verification notes",documentationTrackerNotesPlaceholder:"Record what changed, who reviewed it and where the artifacts were stored.",documentationTrackerMarkAllComplete:"Mark all complete",documentationTrackerArchiveRelease:"Archive release",documentationTrackerRestoreRelease:"Reopen release",documentationTrackerArchivedBadge:"Archived",documentationTrackerArchiveConfirm:'Archive "{name}"? Completed checkmarks stay logged for audits.',documentationTrackerSummaryPending:'{remaining} of {total} documentation tasks remain for "{name}".',documentationTrackerSummaryComplete:'All {total} documentation tasks for "{name}" are complete.',documentationTrackerFallbackReleaseName:"Documentation release",documentationTrackerProgress:"{completed}/{total} complete",documentationTrackerSectionProgress:"{completed}/{total}",documentationTrackerUpdatedAt:"Updated {time}",documentationTrackerTargetSummary:"Target {date}",documentationTrackerDefaultReleaseName:"Release {date}",settingsTabBackup:"Backup & Restore",settingsTabData:"Data & Storage",settingsTabAbout:"About & Support",generalSectionInterfaceHeading:"Interface & Accessibility",generalSectionInterfaceHelp:"Manage font sizes, high contrast mode and animation preferences.",settingsBackupAutomatedHeading:"Automated Backups",settingsBackupManualHeading:"Manual Actions",settingsBackupDangerHeading:"Danger Zone",settingsDataStorageStatusHeading:"Storage Status",settingsDataPersistenceHeading:"Persistence & Backup",settingsDataLoggingHeading:"Logging",settingsAboutHeading:"About & Support",rulesViewTitle:"Auto Gear Rules",rulesViewSubtitle:"Manage automatic gear additions based on your equipment selection.",buttonAddRule:"Add Rule",rulesEmptyTitle:"No rules defined",rulesEmptyText:"Create your first rule to automate your gear list.",ruleBadgeAlways:"Always",ruleTagConditions:"Conditions",ruleTagItemsAdded:"Items Added",confirmDeleteRule:"Are you sure you want to delete this rule?",modalTitleCreateRule:"Create Rule",modalTitleEditRule:"Edit Rule",tabGeneral:"General",tabContext:"Context",tabCamera:"Camera",tabMonitoring:"Monitoring",tabSupport:"Support",tabCrew:"Crew",tabActions:"Actions",labelRuleName:"Rule Name",labelRuleEnabled:"Rule Enabled",labelRuleAlways:"Always Apply",helpRuleAlways:"Overrides all other conditions.",placeholderRuleName:"e.g. Add Batteries for Monitor",sectionScenarios:"Scenarios",sectionCameraModels:"Camera Models",sectionMatteboxes:"Matteboxes",sectionViewfinders:"Viewfinders / Top Handles (Extensions)",sectionMonitors:"Monitors",sectionWireless:"Wireless",sectionTripodHeads:"Tripod Heads",sectionBowlSize:"Bowl Size",sectionLegTypes:"Leg Types",sectionSpreaders:"Spreaders",sectionCrewPresent:"Crew Present",sectionCrewAbsent:"Crew Absent",sectionItemsToAdd:"Items to Add",sectionItemsToRemove:"Items to Remove",buttonAddItem:"+ Add Item",labelItemName:"Item Name",placeholderItemSearch:"Search...",labelCategory:"Category",labelQty:"Qty",buttonAdd:"Add",textNoOptions:"No options available.",textNoItems:"No items defined.",buttonSaveRule:"Save Rule",buttonCancel:"Cancel",buttonEdit:"Edit",buttonDelete:"Delete",alertEnterRuleName:"Please enter a rule name.",contactsViewTitle:"Contacts",contactsViewSubtitle:"Manage your crew and vendor contacts.",buttonAddContact:"Add Contact",buttonAddFirstContact:"+ Add First Contact",contactsEmptyTitle:"No contacts found",contactsEmptyText:"Add people and companies to your contact list to quickly assign them to projects.",linkWebsite:"Website",contactUnnamed:"Unnamed Contact",contactNoRole:"No Role",modalTitleDeleteContact:"Delete Contact",confirmDeleteContact:"Are you sure you want to delete this contact? This action cannot be undone.",buttonDeleteRed:"Delete",modalTitleNewContact:"New Contact",modalTitleEditContact:"Edit Contact",buttonUploadPhoto:"Upload Photo",buttonRemovePhoto:"Remove",labelName:"Name",labelRole:"Role",labelPhone:"Phone",labelEmail:"Email",labelWebsite:"Website / Link",labelNotes:"Notes",placeholderFullName:"Full Name",placeholderRole:"e.g. 1st AC",placeholderPhone:"+1 234 567 890",placeholderEmail:"email@example.com",placeholderWebsite:"https://...",placeholderNotes:"Additional details...",buttonSaveContact:"Save Contact",alertEnterName:"Please enter a name.",ownGearViewTitle:"Owned Gear",ownGearViewSubtitle:"Manage your personal equipment inventory.",buttonAddGearItem:"Add Item",buttonAddFirstGearItem:"+ Add First Item",ownGearEmptyTitle:"No gear found",ownGearEmptyText:"Add items to your personal inventory to quickly add them to projects.",labelQtyPrefix:"Qty: ",labelSourcePrefix:"Source: ",confirmDeleteGearItem:"Are you sure you want to delete this item?",modalTitleNewGearItem:"New Gear Item",modalTitleEditGearItem:"Edit Gear Item",placeholderGearName:"e.g. Arri Alexa Mini",placeholderGearQty:"1",placeholderGearNotes:"Condition, serial number, etc...",buttonSaveGearItem:"Save Item",alertInvalidItemData:"Invalid item data.",alertSaveItemFailed:"Failed to save item.",labelQuantity:"Quantity",buttonDownloadBackup:"Download Backup",buttonDownloadFullBackup:"Download Full Backup",buttonRestore:"Restore",buttonRestoreRehearsal:"Restore Rehearsal",buttonFactoryReset:"Factory Reset",buttonCompareVersions:"Compare Versions",buttonReset:"Reset",buttonUploadSvg:"Upload SVG",buttonClose:"Close",buttonExportLog:"Export Log",buttonChooseFile:"Choose File",buttonSupport:"Support",buttonReportBug:"Report Bug",buttonSuggestFeature:"Suggest Feature",buttonRequestPersistence:"Request Persistent Storage",labelBackupRetention:"Backup Retention (copies per project)",labelBaselineVersion:"Baseline Version",labelComparisonVersion:"Comparison Version",labelIncidentNotes:"Incident Notes",labelSelectFile:"Select File",labelNoFileSelected:"No file selected",labelLatestProjectSave:"Latest Project Save",labelLatestAutoBackup:"Latest Auto Backup",labelLatestFullBackup:"Latest Full Backup",tableHeaderData:"Data",tableHeaderDifference:"Difference",labelLogLevel:"Log Level",labelHistoryLimit:"History Limit",labelNamespaceFilter:"Namespace Filter",placeholderIncidentNotes:"Context for this comparison...",checkboxAutoBackupList:"Show auto-backups in project list",checkboxHighContrast:"High Contrast Elements",checkboxReduceMotion:"Reduce Motion",checkboxRelaxedSpacing:"Relaxed Spacing",checkboxMirrorConsole:"Mirror to Console",checkboxCaptureConsole:"Capture Console Output",checkboxCaptureGlobalErrors:"Capture Global Errors",checkboxPersistSession:"Persist Session Between Reloads",brandingNoLogo:"No custom logo set",documentationTrackerEmptyShort:"No releases tracked.",settingsFactoryResetHelp:"Reset the application to its initial state. All data will be deleted.",backupDiffModalTitle:"Version Comparison",backupDiffModalSubtitle:"Pick two manual saves or automatic backups to inspect changes.",backupDiffEmptyState:"Select versions to see differences.",rehearsalModalSubtitle:"Load a backup into a disposable workspace to verify it before running a full restore.",rehearsalModalSourceLabel:"Choose a rehearsal source",rehearsalModalSourceBackup:"Full app backup (.json)",rehearsalModalSourceProject:"Project bundle (.json)",textManageLocalData:"Manage your local data.",textRequestPersistence:"Request persistent storage verification to prevent browser eviction.",statusCheckingPersistence:"Checking storage protection...",textNoLogEntries:"No log entries.",optionLogLevelAll:"All levels",optionLogLevelInfo:"Info and above",optionLogLevelWarn:"Warnings and errors",optionLogLevelError:"Errors only",appCreator:"Created by Luca Zanner",languageSetting:"Language",settingsLanguageHelp:"Choose the interface language. Changes apply immediately and are remembered for next time.",darkModeSetting:"Dark mode",settingsDarkModeHelp:"Switch between light and dark themes from any control. The onboarding selector, top-bar toggle and Settings checkbox stay synchronized instantly.",pinkModeSetting:"Pink mode",settingsPinkModeHelp:"Enable the playful pink accent theme from Settings.",accentColorSetting:"Accent color",accentColorHelp:"Pick the accent color used for buttons, highlights and diagrams. The choice is saved with your settings.",cameraColorSettingDescription:"Assign a highlight color to each camera letter so linked gear stays coordinated across your lists.",cameraColorInputHelp:"Choose the highlight color for camera %s.",cameraColorALabel:"Camera A color",cameraColorBLabel:"Camera B color",cameraColorCLabel:"Camera C color",cameraColorDLabel:"Camera D color",cameraColorELabel:"Camera E color",accentColorReset:"Reset to default",accentColorResetHelp:"Revert the accent color to the original theme color while keeping other preferences intact.",temperatureUnitSetting:"Temperature unit",temperatureUnitSettingHelp:"Choose whether temperatures are shown in Celsius or Fahrenheit throughout the app.",focusScaleSetting:"Focus scale",focusScaleSettingHelp:"Choose the measurement markings displayed for focus scales in lens notes and overviews.",focusScaleMetric:"Metric",focusScaleImperial:"Imperial",mountVoltageSettingsHeading:"Battery mount voltages",mountVoltageSettingsHelp:"Adjust the voltages used for current draw calculations across B-Mount, V-Mount and Gold Mount setups.",mountVoltageDescription:"Set the default high and low voltages for each battery mount so the planner matches your hardware.",mountVoltageReset:"Restore defaults",mountVoltageResetHelp:"Reset all mount voltages to their factory defaults.",mountVoltageHighLabel:"High-voltage output",mountVoltageLowLabel:"Low-voltage output",mountVoltageHighHelp:"Used to calculate total current at the battery's main output such as the high-voltage pins.",mountVoltageLowHelp:"Used to calculate total current at auxiliary outputs such as D-Tap ports or B-Mount low-voltage pins.",mountVoltageNote:"These voltages update the totals in the power summary, runtime estimates and pin warnings.",mountVoltageCardLabelV:"V-Mount",mountVoltageCardLabelGold:"Gold Mount",mountVoltageCardLabelB:"B-Mount",totalCurrentHighLabelTemplate:"Total Current (at {voltage}V):",totalCurrentLowLabelTemplate:"Total Current (at {voltage}V):",totalCurrentHighHelpTemplate:"Current draw at the battery's main output ({voltage}V).",totalCurrentLowHelpTemplate:"Current draw at auxiliary outputs ({voltage}V).",temperatureUnitCelsius:"Celsius (C)",temperatureUnitFahrenheit:"Fahrenheit (F)",temperatureUnitSymbolCelsius:"C",temperatureUnitSymbolFahrenheit:"F",fontSizeSetting:"Font size",fontSizeSettingHelp:"Set the base interface font size to improve readability or fit more information on screen.",fontFamilySetting:"Font",fontFamilySettingHelp:"Select the typeface used throughout the planner. Added local fonts appear in this menu.",bundledFontsGroup:"Bundled fonts",localFontsGroup:"Local fonts",localFontsButton:"Add local font",localFontsButtonHelp:"Allow the planner to use installable fonts from this device when your browser supports it.",localFontsUnsupported:"Local fonts aren't supported in this browser.",localFontsFileFallback:"Your browser can't list installed fonts automatically. Upload font files instead.",localFontsAdded:"Added: %s",localFontsAlreadyAdded:"Already added: %s",localFontsNoFonts:"No fonts were selected.",localFontsError:"Could not access local fonts.",localFontsPermissionNeeded:"Access to installed fonts was denied. Upload font files instead.",localFontsUnsupportedFiles:"Some files weren't recognized as fonts: %s.",localFontsSaveError:"Font added for this session but couldn't be saved for offline use.",logoSetting:"Logo (SVG)",logoSettingHelp:"Upload an SVG logo to brand printable overviews and include it in backups.",logoFormatError:"Unsupported logo format. Please choose an SVG file.",autoGearHeading:"Automatic Gear Rules",autoGearHeadingHelp:"Adjust which Production Requirements scenarios automatically add or remove kit items.",autoGearDescription:"Create scenario-based rules that tweak the generated kit list. Rules apply after the default planner suggestions.",autoGearPresetDescription:"Save and reuse complete sets of automatic gear rules.",autoGearPresetLabel:"Preset",autoGearPresetPlaceholder:"Custom rules",autoGearAutoPresetLabel:"Autosaved rules",autoGearSavePresetButton:"Save preset",autoGearDeletePresetButton:"Delete preset",autoGearPresetNamePrompt:"Name this preset",autoGearPresetNameRequired:"Enter a preset name to continue.",autoGearPresetOverwriteConfirm:"Replace the existing preset %s?",autoGearPresetApplyConfirm:"Replace your automatic gear rules with the preset %s?",autoGearPresetSaved:"Automatic gear preset saved.",autoGearPresetDeleted:"Automatic gear preset deleted.",autoGearPresetApplied:"Preset applied.",autoGearPresetExportSuccess:"Automatic gear presets downloaded.",autoGearPresetExportError:"Automatic gear preset export failed.",autoGearAddRule:"Add rule",autoGearNoRules:"No custom rules yet.",autoGearNoMatches:"No rules match your filters.",autoGearNoFocusMatches:"No rules match the selected dashboard filter.",autoGearSummaryHeading:"Rule coverage overview",autoGearSummaryDescription:"Review automatic gear rules for duplicate triggers, conflicts, stacked scenarios and uncovered coverage.",autoGearSummaryEmpty:"Add a rule to unlock coverage insights.",autoGearSummaryTotalLabel:"Rules tracked",autoGearSummaryTotalDescription:"Rules currently saved in this setup.",autoGearSummaryCoverageLabel:"Scenario coverage",autoGearSummaryCoverageDescription:"{covered} of {total} scenarios covered",autoGearSummaryCoverageEmpty:"Add scenarios to measure coverage.",autoGearSummaryNetLabel:"Net change",autoGearSummaryNetDescription:"Adds {adds}  Removes {removes}",autoGearSummaryDuplicatesLabel:"Duplicated triggers",autoGearSummaryDuplicatesSome:"{rules} across {groups} groups",autoGearSummaryDuplicatesNone:"No duplicate triggers.",autoGearSummaryConflictsLabel:"Potential conflicts",autoGearSummaryConflictsSome:"{rules} affected across {items} items",autoGearSummaryConflictsNone:"No conflicting adds/removes.",autoGearSummaryOverlapsLabel:"Stacked scenarios",autoGearSummaryOverlapsSome:"{count} scenarios touched by multiple rules",autoGearSummaryOverlapsNone:"No scenarios currently stack multiple rules.",autoGearSummaryUncoveredLabel:"Uncovered scenarios",autoGearSummaryUncoveredSome:"Review {count} scenario gaps",autoGearSummaryUncoveredNone:"All required scenarios covered.",autoGearSummaryDetailsIntro:"Focus cards to inspect coverage percentages, stacked scenarios, duplicates and conflicts before exporting or printing.",autoGearSummaryDetailsDuplicatesHeading:"Duplicated triggers",autoGearSummaryDuplicateGroupTitle:"Matching triggers",autoGearSummaryDetailsConflictsHeading:"Potential conflicts",autoGearSummaryConflictAddsLabel:"Adds",autoGearSummaryConflictRemovesLabel:"Removes",autoGearSummaryDetailsOverlapsHeading:"Scenarios with stacked rules",autoGearSummaryDetailsOverlapsNone:"No scenarios currently stack multiple rules.",autoGearSummaryDetailsUncoveredHeading:"Uncovered scenarios",autoGearSummaryResetFocus:"Clear dashboard filter",autoGearSummaryDetailsFocusEmpty:"No coverage details match the current focus.",autoGearSummaryJumpToRule:"Jump to rule",autoGearSummarySetScenarioFilter:"Filter to scenario {scenario}",autoGearSummaryRuleReference:"Rule {position}: {label}",autoGearSummaryRuleReferenceUntitled:"Rule {position}",autoGearSummaryFilteredDescription:"Showing {visible} of {total} rules after filters.",autoGearSearchLabel:"Search rules",autoGearSearchHelp:"Filter automatic gear rules by name, scenario or items. Results update instantly as you type.",autoGearSearchPlaceholder:"Search by name, scenario or item",autoGearFilterScenarioLabel:"Filter by scenario",autoGearFilterScenarioHelp:"Show only rules that require a specific scenario.",autoGearFilterScenarioAny:"All scenarios",autoGearFilterClear:"Clear filters",autoGearRuleNameLabel:"Rule name",autoGearRuleNameHelp:"Optional label displayed in the rules list.",autoGearConditionSelectLabel:"Add a condition",autoGearConditionSelectHelp:"Reveal the selectors you want to use as rule conditions.",autoGearAddCondition:"Add condition",autoGearConditionPlaceholder:"Choose a condition",autoGearConditionAddShortcut:"Add another condition",autoGearConditionRemove:"Remove this condition",autoGearConditionLogicLabel:"Match behavior",autoGearConditionLogicHelp:"Choose how the selected values interact before the rule activates.",autoGearConditionLogicAll:"Require every selected value",autoGearConditionLogicAny:"Match any selected value",autoGearConditionLogicOr:"Start a new OR group (matches any selected value)",autoGearConditionLogicNone:"Require none of the selected values",autoGearConditionLogicMultiplier:"Multiply by matched values",autoGearConditionRepeatHint:"Condition already added. Existing inputs for {condition} are highlighted so you can add more selections.",autoGearAlwaysLabel:"Always include",autoGearAlwaysHelp:"Apply this rule to every kit list.",autoGearAlwaysMeta:"Always active",autoGearScenariosLabel:"Required scenarios",autoGearScenariosHelp:"Pick every scenario that must be selected for this rule to apply. Hold Ctrl (Cmd on Mac) to choose multiple.",autoGearScenarioPlaceholder:"Select scenarios",autoGearScenarioModeLabel:"Scenario matching",autoGearScenarioModeHelp:"Choose how the selected scenarios interact before the rule activates.",autoGearScenarioModeAll:"Require every selected scenario",autoGearScenarioModeAny:"Match any selected scenario",autoGearScenarioModeMultiplier:"Multiply when combined",autoGearScenarioBaseLabel:"Base scenario",autoGearScenarioBaseHelp:"Items always add when this scenario is active.",autoGearScenarioBasePlaceholder:"Select a base scenario",autoGearScenarioFactorLabel:"Multiplier factor",autoGearScenarioFactorHelp:"Scale item quantities when every additional scenario is active.",autoGearShootingDaysLabel:"Shooting days condition",autoGearShootingDaysHelp:"Activate this rule when the shooting schedule meets your chosen minimum or maximum, or repeat the gear for each block of days.",autoGearShootingDaysModeMinimum:"Minimum",autoGearShootingDaysModeMaximum:"Maximum",autoGearShootingDaysModeEvery:"Every",autoGearShootingDaysValueLabel:"Shooting days value",autoGearMatteboxLabel:"Mattebox options",autoGearMatteboxHelp:"Apply this rule when these mattebox choices are selected. Clamp-on rules automatically add the matching backing sizes for the selected lens fronts.",autoGearMatteboxPlaceholder:"Select mattebox options",autoGearCameraHandleLabel:"Camera handles",autoGearCameraHandleHelp:"Apply this rule when these camera handle options are selected.",autoGearCameraHandlePlaceholder:"Select camera handles",autoGearViewfinderExtensionLabel:"Viewfinder extension",autoGearViewfinderExtensionHelp:"Apply this rule when these viewfinder extension choices are selected.",autoGearViewfinderExtensionPlaceholder:"Select viewfinder extension options",autoGearDeliveryResolutionLabel:"Delivery resolution",autoGearDeliveryResolutionHelp:"Apply this rule when these delivery resolutions are selected.",autoGearDeliveryResolutionPlaceholder:"Select delivery resolutions",autoGearVideoDistributionLabel:"Video distribution",autoGearVideoDistributionHelp:"Apply this rule when these video distribution preferences are selected.",autoGearVideoDistributionPlaceholder:"Select video distribution options",autoGearTripodHeadBrandLabel:"Tripod head brand",autoGearTripodHeadBrandHelp:"Apply this rule when the tripod head preferences include these brands.",autoGearTripodHeadBrandPlaceholder:"Select tripod head brands",autoGearTripodBowlLabel:"Tripod bowl size",autoGearTripodBowlHelp:"Apply this rule when the tripod head preferences include these bowl sizes.",autoGearTripodBowlPlaceholder:"Select tripod bowl sizes",autoGearTripodTypesLabel:"Tripod types",autoGearTripodTypesHelp:"Apply this rule when the tripod preferences include these tripod types.",autoGearTripodTypesPlaceholder:"Select tripod types",autoGearTripodSpreaderLabel:"Tripod spreader",autoGearTripodSpreaderHelp:"Apply this rule when the tripod preferences include these spreader options.",autoGearTripodSpreaderPlaceholder:"Select tripod spreaders",autoGearVideoDistributionNone:"No video distribution selected",autoGearCameraLabel:"Camera selection",autoGearCameraHelp:"Apply this rule when these camera bodies are selected.",autoGearCameraWeightLabel:"Camera weight",autoGearCameraWeightHelp:"Compare the selected camera's weight to the threshold before triggering this rule.",autoGearCameraWeightOperatorLabel:"Weight comparison",autoGearCameraWeightOperatorGreater:"Heavier than",autoGearCameraWeightOperatorLess:"Lighter than",autoGearCameraWeightOperatorEqual:"Exactly",autoGearCameraWeightValueLabel:"Weight threshold (grams)",autoGearCameraWeightValueRequired:"Enter a camera weight threshold before saving.",autoGearMonitorLabel:"Onboard monitors",autoGearMonitorDefaultsHeading:"Monitor defaults",autoGearMonitorDefaultsDescription:"Choose which monitors should be preselected for new kit lists.",autoGearDefaultFocusMonitorLabel:"Focus monitor",autoGearDefaultHandheldMonitorLabel:'7" handheld monitor',autoGearDefaultComboMonitorLabel:'Combo monitor 15-21"',autoGearDefaultDirectorMonitorLabel:'Director monitor 15-21"',autoGearMonitorDefaultPlaceholder:"Use recommended automatically",autoGearMonitorHelp:"Apply this rule when these onboard monitors are selected.",autoGearCrewPresentLabel:"Crew present",autoGearCrewPresentHelp:"Apply this rule when these crew roles are listed on the project.",autoGearCrewAbsentLabel:"Crew absent",autoGearCrewAbsentHelp:"Apply this rule when these crew roles are not listed on the project.",autoGearWirelessLabel:"Wireless transmitters",autoGearWirelessHelp:"Apply this rule when these wireless transmitters are selected.",autoGearMotorsLabel:"FIZ motors",autoGearMotorsAny:"Any motor selected",autoGearMotorsHelp:"Apply this rule when these FIZ motors are selected.",autoGearControllersLabel:"FIZ controllers",autoGearControllersHelp:"Apply this rule when these FIZ controllers are selected.",autoGearDistanceLabel:"FIZ distance devices",autoGearDistanceHelp:"Apply this rule when these distance devices are selected.",autoGearRuleConditionRequired:"Select at least one scenario, camera, monitor, wireless transmitter, motor, controller, distance device, mattebox option, camera handle, viewfinder extension or video distribution before saving.",autoGearAddItemsHeading:"Add these items",autoGearOwnGearLabel:"Own gear item",autoGearOwnGearHelp:"Select an item you own to link this rule to your inventory.",autoGearConditionOwnGearLabel:"Own gear",autoGearConditionOwnGearHelp:"Apply this rule when these items are saved in your own gear list.",autoGearOwnGearMissing:"Removed own gear",autoGearOwnGearPlaceholder:"Manual entry",autoGearOwnGearBadge:"Own gear",autoGearAddItemLabel:"Item",autoGearAddCategoryLabel:"Category",autoGearAddQuantityLabel:"Qty",autoGearAddItemButton:"Add item",autoGearUpdateItemButton:"Save item",autoGearAddMultipleHint:"Separate multiple items with semicolons.",autoGearRemoveItemsHeading:"Remove these items",autoGearRemoveItemLabel:"Item",autoGearRemoveCategoryLabel:"Category",autoGearRemoveQuantityLabel:"Qty",autoGearRemoveItemButton:"Add removal",autoGearRemoveMultipleHint:"Separate multiple items with semicolons.",autoGearSaveRule:"Save rule",autoGearRuleSaved:"Automatic gear rule saved.",autoGearCancelEdit:"Cancel",autoGearResetFactoryButton:"Reset to factory additions",autoGearResetFactoryHelp:"Restore the automatic gear rules generated from the planner's default scenarios. Your current presets download before anything changes.",autoGearResetFactoryConfirm:"Replace your automatic gear rules with the default additions?",autoGearResetFactoryDone:"Automatic gear rules restored to factory additions.",autoGearResetFactoryEmpty:"Factory additions unavailable. Automatic gear rules cleared.",autoGearResetFactoryError:"Reset failed. Please try again.",autoGearResetFactoryExportFailed:"Automatic gear preset export failed. Reset cancelled.",autoGearExportButton:"Export rules",autoGearExportHelp:"Download your automatic gear rules as a JSON file.",autoGearExportSuccess:"Automatic gear rules downloaded.",autoGearExportError:"Automatic gear rules export failed.",autoGearImportButton:"Import rules",autoGearImportHelp:"Replace your automatic gear rules with a file you previously exported.",autoGearImportConfirm:"Replace your automatic gear rules with the imported file?",autoGearImportSuccess:"Automatic gear rules imported.",autoGearImportError:"Import failed. Please choose a valid automatic gear rules file.",autoGearImportSchemaError:"Import failed. The file does not match the automatic gear rules export format.",autoGearImportMetadataLabelType:"type marker",autoGearImportMetadataLabelVersion:"version",autoGearImportMetadataLabelTimestamp:"marca temporale",autoGearImportMissingMetadataWarning:"Imported rules are missing required metadata: {fields}. Confirm the file comes from a trusted export before saving.",autoGearImportInvalidMetadataWarning:"Imported rules include invalid metadata: {fields}. Confirm the file comes from a trusted export before saving.",autoGearImportNewerVersionWarning:"Imported rules were created with version {importVersion}, which is newer than this build ({appVersion}). Double-check compatibility before relying on them.",autoGearImportOlderVersionWarning:"Imported rules were created with version {importVersion}, which is older than this build ({appVersion}). Review them to confirm they still match your workflow.",autoGearImportInvalidVersionWarning:'Imported rules report version "{value}", which is not a valid semantic version string.',autoGearImportInvalidTimestampWarning:'The import timestamp "{value}" could not be verified. Confirm the file has not been modified.',autoGearBackupsHeading:"Automatic backups",autoGearBackupsDescription:"Backups save your rules every 10 minutes when changes occur and keep up to 50 tracked changes between full snapshots. Restore a snapshot if something goes wrong.",autoGearShowBackupsLabel:"Show automatic backups",autoGearShowBackupsHelp:"Reveal the snapshots captured in the background.",autoGearBackupsHidden:"Automatic backups stay hidden until you turn them on.",autoGearBackupSelectLabel:"Choose a backup",autoGearBackupSelectPlaceholder:"Select a backup to restore",autoGearBackupEmpty:"No automatic backups yet.",autoGearBackupRestore:"Restore",autoGearBackupRestoreConfirm:"Replace your automatic gear rules with this backup?",autoGearBackupRestoreSuccess:"Automatic gear backup restored.",autoGearBackupRestoreError:"Automatic gear backup restore failed.",autoGearBackupSaved:"Automatic gear backup saved.",autoGearBackupFailed:"Automatic gear backup failed.",autoGearBackupRetentionLabel:"Automatic backup retention",autoGearBackupRetentionHelp:"Choose how many automatic gear backups stay on this device.",autoGearBackupRetentionSummary:"Keeping the latest {limit}. Currently {stored} stored.",autoGearBackupRetentionWarning:"Lowering to {limit} will remove {trimmed}. A safety snapshot will be saved first.",autoGearBackupRetentionConfirm:"Save a safety snapshot and trim older backups now?",autoGearBackupRetentionSafetyNote:"Retention lowered to {limit}.",autoGearBackupRetentionSafetyNoteTrimmed:"Retention lowered to {limit}. Removed {trimmed} in this change.",autoGearBackupRetentionSafetySaved:"Safety snapshot captured before trimming backups.",autoGearBackupRetentionSafetyFailed:"Safety snapshot failed. Retention was not changed.",autoGearBackupRetentionUpdated:"Retention updated to {limit}. Removed {trimmed}.",autoGearBackupRetentionUpdatedNoTrim:"Retention updated to {limit}. No backups were removed.",autoGearBackupRetentionExpanded:"Retention updated to {limit}.",autoGearBackupRetentionUpdateFailed:"Could not apply the new retention limit. Try again.",autoGearRulesCountOne:"%s rule",autoGearRulesCountOther:"%s rules",autoGearRuleToggleEnable:"Enable rule",autoGearRuleToggleDisable:"Disable rule",autoGearRuleEnabledLabel:"Enabled",autoGearRuleDisabledLabel:"Disabled",autoGearSummaryAllDisabled:"All automatic gear rules are disabled.",autoGearSummaryDisabledSuffix:"{count} disabled rules are ignored in coverage.",autoGearSummaryDisabledNote:"Disabled rules are visible below but ignored until re-enabled.",autoGearBackupClearsRules:"Clears all rules",autoGearBackupMeta:"%s  %s",autoGearAddsCountOne:"%s addition",autoGearAddsCountOther:"%s additions",autoGearAddsListLabel:"Adds",autoGearItemSummaryWithCategory:"%s  %s (%s)",autoGearItemSummary:"%s  %s",autoGearRemovalsCountOne:"%s removal",autoGearRemovalsCountOther:"%s removals",autoGearDuplicateRule:"Duplicate",autoGearDuplicateSuffix:"Copy",autoGearDeleteRule:"Delete",autoGearDeleteConfirm:"Delete this rule?",autoGearItemNameRequired:"Enter an item name first.",autoGearEditSingleItemWarning:"Edit one item at a time.",autoGearRuleScenarioRequired:"Select a scenario before saving.",autoGearRuleNeedsItems:"Add at least one item to add or remove before saving.",autoGearListRemove:"Remove",autoGearListEdit:"Edit",autoGearEmptyList:"No items yet.",autoGearDraftImpactHeading:"Draft impact preview",autoGearDraftImpactDescription:"Simulated totals showing how this draft would change shared gear outputs.",autoGearDraftImpactEmpty:"No changes detected yet. Add or adjust items to preview the impact.",autoGearDraftImpactUnavailable:"Preview becomes available after this rule includes at least one item.",autoGearDraftImpactTotals:"Current total: %s  After save: %s",autoGearDraftImpactChange:"Change: %s",autoGearDraftImpactStackedOne:"Stacked across %s rule.",autoGearDraftImpactStackedOther:"Stacked across %s rules.",autoGearDraftImpactConflictOne:"Removals also active in %s rule.",autoGearDraftImpactConflictOther:"Removals also active in %s rules.",autoGearDraftWarningHeading:"Warnings",autoGearDraftWarningCritical:"%s would drop out of the kit list.",autoGearDraftWarningConflict:"%s has conflicting add and remove instructions.",autoGearDraftWarningRedundant:"%s is added by multiple rules without increasing totals.",autoGearDraftWarningConfirm:"Save anyway? Review the impact warnings below before confirming.",autoGearCustomCategory:"Custom Additions",autoGearAddScreenSizeLabel:"Screen size",autoGearAddSelectorTypeLabel:"Selector",autoGearAddSelectorDefaultLabel:"Default item",autoGearAddSelectorIncludeLabel:"Include selector",autoGearAddNotesLabel:"Notes",autoGearRemoveScreenSizeLabel:"Screen size",autoGearRemoveSelectorTypeLabel:"Selector",autoGearRemoveSelectorDefaultLabel:"Default item",autoGearRemoveSelectorIncludeLabel:"Include selector",autoGearRemoveNotesLabel:"Notes",autoGearSelectorDefaultPlaceholder:"Choose a default device",autoGearSelectorNoneOption:"No selector",autoGearSelectorMonitorOption:"Monitor selector",autoGearSelectorDirectorOption:"Director monitor selector",autoGearSelectorTripodHeadOption:"Tripod head selector",autoGearSelectorTripodBowlOption:"Tripod bowl selector",autoGearSelectorTripodTypesOption:"Tripod type selector",autoGearSelectorTripodSpreaderOption:"Tripod spreader selector",autoGearSelectorFizHandUnitOption:"FIZ hand unit selector",autoGearSelectorScrollHint:"Scroll to see more devices.",autoGearSelectorSummaryWithDefault:"%s selector (default: %s)",autoGearSelectorSummary:"%s selector",autoGearSelectorSummaryNoSelector:"%s default: %s",autoGearRuleTooltipNamed:"Added by automatic gear rule %s.",autoGearRuleTooltipUnnamed:"Added by an automatic gear rule.",autoGearRuleBadgeNamed:"Rule: %s",autoGearRuleBadgeUnnamed:"Automatic rule",accessibilityHeading:"Accessibility",accessibilityHeadingHelp:"Adjust contrast and other options that improve legibility.",highContrastSetting:"High contrast",highContrastSettingHelp:"Increase contrast for text and outlines to boost readability in any theme.",reduceMotionSetting:"Reduce motion",reduceMotionSettingHelp:"Limit color and interface animations so transitions feel steady for motion-sensitive users.",relaxedSpacingSetting:"Relaxed spacing",relaxedSpacingSettingHelp:"Increase line spacing and control padding to make text easier to scan and tap.",backupHeading:"Backup & Restore",backupHeadingHelp:"Manage full backups of settings, saved projects, custom devices, queued vault entries, and runtime feedback.",projectBackupsHeading:"Project Backups",projectBackupsDescription:"Manage automatic snapshots and compare saved versions before restoring changes.",showAutoBackupsSetting:"Show auto backups in project list",showAutoBackupsHelp:"Temporarily list automatic backup snapshots in Saved Projects so you can restore them manually.",versionCompareButton:"Compare versions",versionCompareButtonHelp:"Review differences between saves, add notes, and export a comparison log.",versionCompareHeading:"Version comparison",versionCompareIntro:"Pick two manual saves or automatic backups to inspect changes before archiving a log.",versionComparePrimaryLabel:"Baseline version",versionCompareSecondaryLabel:"Comparison version",versionCompareSelectPlaceholder:"Select a version",versionCompareEmpty:"Save a project or wait for auto-backups to start comparing versions.",versionCompareNoSelection:"Choose two versions to generate a diff.",versionCompareSameSelection:"Select two different versions to compare.",versionCompareDifferencesCountOne:"%s difference noted.",versionCompareDifferencesCountOther:"%s differences noted.",versionCompareIdentical:"Versions matchno changes detected.",versionCompareManualLabel:"Manual save",versionCompareAutoLabel:"Auto backup",versionCompareAutoDeleteLabel:"Auto backup before delete",versionCompareNotesLabel:"Incident notes",versionCompareNotesPlaceholder:"Record context, on-set observations, or required follow-up.",versionCompareExport:"Export log",versionCompareExportHelp:"Download a JSON copy of this comparison and your notes.",versionCompareClose:"Close",versionCompareExportSuccess:"Comparison log exported.",versionCompareExportFailure:"Comparison export failed.",versionCompareMissingSelection:"Select two versions before exporting a log.",versionCompareChangeAdded:"Added",versionCompareChangeRemoved:"Removed",versionCompareChangeUpdated:"Updated",versionCompareMissingValue:"Not present",versionCompareRootPath:"Entire setup",versionCompareListItemLabel:"Item %s",versionCompareSummaryAdded:"Added: %s",versionCompareSummaryRemoved:"Removed: %s",versionCompareSummaryChanged:"Updated: %s",backupSettings:"Backup",backupSettingsHelp:"Download a full JSON backup containing every project, device edit, preference, auto-gear rule, queued backup vault entry, and runtime log stored on this device. Keep multiple copies in your offline archive.",restoreSettings:"Restore",restoreSettingsHelp:"Restore a full JSON backup. The planner captures a fresh safety copy first, then replaces stored preferences and session data with the selected file so you can roll back immediately if anything looks wrong.",restoreRehearsalButton:"Restore rehearsal",restoreRehearsalButtonHelp:"Test a backup or project bundle in a disposable sandbox before you restore your live data.",restoreRehearsalHeading:"Restore rehearsal",restoreRehearsalIntro:"Load a backup or project bundle into a disposable workspace. We compare key counts with your live profile and clear the sandbox automatically.",restoreRehearsalModeLabel:"Choose a rehearsal source",restoreRehearsalModeBackup:"Full app backup (.json)",restoreRehearsalModeProject:"Project bundle (.json)",restoreRehearsalFileLabel:"Select file",restoreRehearsalFileButton:"Choose file",restoreRehearsalNoFile:"No file selected yet.",restoreRehearsalReady:"Sandbox ready. Pick a JSON file to inspect.",restoreRehearsalProcessing:"Loading file in an isolated sandbox",restoreRehearsalMatch:"All counts match. The sandbox was cleared automatically.",restoreRehearsalMismatch:"Differences detected: %s. The sandbox was cleared automatically.",restoreRehearsalError:"Restore rehearsal failed. Check the file and try again.",restoreRehearsalBackupMismatch:"File doesn't look like a full app backup. Double-check the source and try again.",restoreRehearsalProjectMismatch:"File doesn't look like a project bundle. Double-check the source and try again.",restoreRehearsalRuleHeading:"Automatic gear rule changes",restoreRehearsalRuleIntro:"Compare every automatic gear rule before loading the sandbox. Live rules stay untouched.",restoreRehearsalRuleEmpty:"No automatic gear rule differences found.",restoreRehearsalRuleAddsLabel:"Automatic additions",restoreRehearsalRuleRemovesLabel:"Automatic removals",restoreRehearsalRuleScenariosLabel:"Scenario scope",restoreRehearsalRuleNone:"None",restoreRehearsalRuleLogicLabel:"Scenario logic",restoreRehearsalRuleBaseLabel:"Base scenario",restoreRehearsalRuleMultiplierLabel:"Multiplier",restoreRehearsalRuleRequiredLabel:"Required scenarios",restoreRehearsalRuleAlwaysLabel:"Always active",restoreRehearsalRuleFallback:"Automatic rule change",restoreRehearsalProceed:"Resume restore rehearsal",restoreRehearsalProceedHelp:"Stage the sandbox snapshot to continue the rehearsal.",restoreRehearsalProceedMessage:"Sandbox snapshot staged. Live data remains untouched until you perform a full restore.",restoreRehearsalAbort:"Abort rehearsal",restoreRehearsalAbortHelp:"Discard the sandbox snapshot and keep live data unchanged.",restoreRehearsalAbortMessage:"Rehearsal sandbox cleared. Live data remains untouched.",restoreRehearsalTableCaption:"Backup rehearsal comparison",restoreRehearsalMetricColumn:"Data type",restoreRehearsalLiveColumn:"Live profile",restoreRehearsalSandboxColumn:"Sandbox import",restoreRehearsalDifferenceColumn:"Difference",restoreRehearsalClose:"Close rehearsal",restoreRehearsalMetricProjects:"Projects",restoreRehearsalMetricProjectDetails:"Project details",restoreRehearsalMetricCrew:"Crew entries",restoreRehearsalMetricSchedule:"Schedule entries",restoreRehearsalMetricRules:"Automatic gear rules",restoreRehearsalMetricFavorites:"Favorites",restoreRehearsalMetricDeviceLibrary:"Device library entries",restoreRehearsalMetricSession:"Stored session snapshot",restoreRehearsalMetricFeedback:"Feedback drafts",restoreRehearsalMetricAutoPresets:"Automatic gear presets",restoreRehearsalMetricAutoBackups:"Automatic gear backups",restoreRehearsalMetricBackupHistory:"Backup history entries",restoreRehearsalMetricCustomFonts:"Custom fonts",restoreRehearsalMetricCustomLogo:"Custom logo saved",restoreRehearsalMetricPreferences:"Stored preferences",restoreRehearsalMetricSchemaCache:"Device schema cache",restoreRehearsalMatchLabel:"Match",restoreRehearsalDifferenceListJoin:", ",restoreRehearsalIncreaseLabel:"Sandbox includes %d more %s.",restoreRehearsalDecreaseLabel:"Sandbox includes %d fewer %s.",factoryResetButton:"Factory reset",factoryResetButtonHelp:"Create a backup and wipe all planner data after confirmation.",confirmFactoryReset:"Create a backup and wipe all planner data?",confirmFactoryResetAgain:"Last warning: all projects, devices, settings and feedback will be deleted. Continue?",factoryResetBackupFailed:"Backup failed. Data was not deleted.",factoryResetAwaitDownload:"Allow downloads to save your backup. The factory reset will continue after you accept the download.",factoryResetDownloadBlocked:"The backup download was blocked. Data was not deleted.",factoryResetSuccess:"Backup downloaded. All planner data cleared. Reloading",factoryResetError:"Factory reset failed. Please try again.",preDeleteBackupSuccess:"Automatic safety copy stored before deletion. Find the matching auto-backup entry under Saved Projects and rename it if you plan to keep it permanently.",preDeleteBackupFailed:"Automatic backup failed. The action was cancelled.",restoreBackupFailed:"Backup failed. Restore cancelled.",restoreBackupQueuedConfirm:"The safety backup is waiting in the local vault. Continue with the restore now?",manualDownloadFallback:"The download didn't start automatically. A new tab opened with the file contents so you can copy or save them manually.",manualDownloadCopyHint:"Select all the text below and copy it to keep the file safe.",dataHeading:"Data & Storage",dataHeadingHelp:"Review what the planner stores locally and how much space backups take.",storageSummaryIntro:"Everything below stays in this browser unless you export or clear it.",storageSummaryFootnote:"Backups download human-readable JSON with each entryQuick safeguards keep fresh copies one click away.",storageSummaryEmpty:"No planner data is currently stored.",storagePersistenceHeading:"Storage reliability",storagePersistenceHeadingHelp:"Ask the browser to keep Cine Power Planner's data safe from automatic cleanups.",storagePersistenceIntro:"Request persistent storage so the browser keeps planner data even when space runs low.",storagePersistenceRequest:"Protect storage on this device",storagePersistenceRequestHelp:"Tell the browser to mark Cine Power Planner's data as persistent.",storagePersistenceStatusIdle:"Request persistent storage to reduce the risk of automatic cleanup.",storagePersistenceStatusChecking:"Checking storage protection",storagePersistenceStatusRequesting:"Requesting persistent storage from the browser",storagePersistenceStatusGranted:"Persistent storage granted. Planner data is protected from automatic cleanup.",storagePersistenceStatusDenied:"The browser could not grant persistent storage. Keep exporting backups regularly.",storagePersistenceStatusSafariIncompatible:"Safari currently blocks persistent storage requests. Treat this as a browser limitation.",storagePersistenceStatusError:"Persistent storage request failed. Try again after freeing space or review browser settings.",storagePersistenceStatusUnsupported:"This browser cannot grant persistent storage automatically. Continue keeping external backups.",storagePersistenceUsage:"Approximate usage: {used} of {quota}.",storagePersistenceUsageUnknown:"Approximate usage: {used}.",storageActionsHeading:"Quick safeguards",storageActionsHeadingHelp:"Download full backups or jump straight to restore tools from here.",storageActionsIntro:"Capture a fresh full backup or open restore utilities without leaving this tab.",storageBackupNow:"Download full backup",storageBackupNowHelp:"Exports the entire planner snapshot, including projects, auto backups and preferences.",storageOpenBackupTab:"Open Backup & Restore",storageOpenBackupTabHelp:"Switch to the Backup & Restore tab for rehearsal, restore and factory reset tools.",storageStatusHeading:"Latest activity",storageStatusHeadingHelp:"Review the most recent saves and backups at a glance.",storageStatusLastProjectLabel:"Latest project save",storageStatusLastAutoBackupLabel:"Latest auto backup",autoBackupInProgressNotice:"Auto backup running. Performance may pause briefly.",storageStatusLastFullBackupLabel:"Latest full app backup",loggingSectionHelp:"Review runtime diagnostics without leaving Settings. Service worker entries stream in automatically so offline cache and activation events stay visible.",loggingHeading:"Diagnostics log",loggingHeadingHelp:"Review runtime diagnostics without leaving Settings.",loggingIntro:"The log updates live while Settings stay open. Console capture runs by default so transcripts stay local; adjust the toggles below if you need to change diagnostics behavior. Nothing leaves this device.",loggingLevelFilterLabel:"Show entries from",loggingLevelFilterHelp:"Choose the minimum level to display.",loggingLevelFilterAll:"All levels",loggingLevelFilterInfo:"Info and above",loggingLevelFilterWarn:"Warnings and errors",loggingLevelFilterError:"Errors only",loggingNamespaceFilterLabel:"Namespace filter",loggingNamespaceFilterPlaceholder:"Filter namespaces (for example, backup)",loggingNamespaceFilterHelp:"Type a namespace such as backup, autosave or logging.",loggingHistoryLimitLabel:"History size",loggingHistoryLimitHelp:"Maximum entries stored on this device.",loggingHistoryLimitStatus:"Storing up to {count} entries locally.",loggingHistoryLimitAria:"Set how many log entries stay available offline",loggingConsoleOutputLabel:"Mirror to console",loggingConsoleOutputHelp:"Keep the browser console in sync with these entries.",loggingCaptureConsoleLabel:"Capture console output",loggingCaptureConsoleHelp:"Record console messages for diagnostics. Leave this enabled unless you need to reduce logging overhead.",loggingCaptureErrorsLabel:"Capture global errors",loggingCaptureErrorsHelp:"Record uncaught errors and unhandled promise rejections.",loggingPersistSessionLabel:"Keep log between reloads",loggingPersistSessionHelp:"Store entries in session storage so diagnostics survive refreshes.",loggingExportButton:"Export log",loggingExportHelp:"Download the full diagnostics log as a JSON file.",loggingExportSuccess:"Diagnostics log exported.",loggingExportError:"Log export failed. Try again after reloading Settings.",loggingExportUnavailable:"Logging unavailable. Try again after reloading Settings.",loggingStatusIdle:"Live log ready.",loggingStatusUpdating:"Updating log",loggingStatusExporting:"Preparing log export",loggingStatusExported:"Diagnostics log ready for download.",loggingStatusExportFailed:"Log export failed.",loggingStorageEstimateUpdated:"Storage estimate refreshed.",loggingStorageQuotaOnly:"Available storage: {quota}.",loggingStatusError:"Logging unavailable. Diagnostics remain in the browser console.",loggingEmptyState:"No log entries captured yet.",loggingEmptyFiltered:"No log entries match the current filters.",loggingUnavailable:"Logging module unavailable. Console output continues as a fallback.",loggingLevelDebug:"Debug",loggingLevelInfo:"Info",loggingLevelWarn:"Warning",loggingLevelError:"Error",loggingEntryTimestampLabel:"Time",loggingEntryNamespaceLabel:"Namespace",loggingEntryMetaLabel:"Meta",loggingEntryDetailLabel:"Details",loggingTimestampCombined:"{local} ({iso})",storageStatusNever:"Not captured yet.",storageStatusStoredWithoutTimestamp:"Stored (timestamp not recorded).",storageStatusTimestamp:"Captured {relative} ({absolute}).",storageStatusTimestampAbsolute:"Captured {absolute}.",storageStatusWithName:"{name}  {time}",storageStatusReminderUpToDate:"Backups look fresh. Keep autosave running and capture a full backup after major changes.",storageStatusReminderSaveProject:"Save a named project so your latest work stays protected offline.",storageStatusReminderRefreshProject:"Save your project again soon (last save {time}).",storageStatusReminderAutoBackupFirst:"Keep Cine Power Planner open until it captures an automatic backup.",storageStatusReminderAutoBackup:"Let an automatic backup run again soon (last snapshot {time}).",storageStatusReminderFullBackupFirst:"Download a full backup to archive every dataset before going offline.",storageStatusReminderFullBackup:"Download another full backup when possible (last archive {time}).",storageStatusReminderConnectivity:"Connectivity degraded  {reason} Keep working from the offline copy and avoid clearing caches until the banner clears.",storageKeyProjects:"Saved projects",storageKeyProjectsDesc:"Configurations saved from Manage Project.",storageProjectsCountOne:"%s project",storageProjectsCountOther:"%s projects",storageKeyAutoBackups:"Auto backups",storageKeyAutoBackupsDesc:"Timestamped safety copies saved every 10 minutes or after 50 tracked changes. Switching projects, importing, exporting or preparing to reload triggers an immediate snapshot even if that cadence hasn't elapsed.",storageAutoBackupsCountOne:"%s auto backup",storageAutoBackupsCountOther:"%s auto backups",storageKeyGearLists:"Kit list snapshots",storageKeyGearListsDesc:"Printable overviews and production requirements.",storageGearListsCountOne:"%s entry",storageGearListsCountOther:"%s entries",storageKeyDevices:"Custom or modified devices",storageKeyDevicesDesc:"Differences from the built-in device library.",storageDevicesCountOne:"%s device",storageDevicesCountOther:"%s devices",storageDeviceCategories:"Affected categories: %s",storageKeyFavorites:"Pinned favorites",storageKeyFavoritesDesc:"Dropdown entries marked with a star.",storageFavoritesCountOne:"%s favorite",storageFavoritesCountOther:"%s favorites",storageKeyFeedback:"Runtime feedback",storageKeyFeedbackDesc:"User-submitted runtime reports.",storageFeedbackCountOne:"%s entry",storageFeedbackCountOther:"%s entries",storageKeySession:"Unsaved session",storageKeySessionDesc:"Restores the working project after a reload.",storageKeyFullBackups:"Full app backups",storageKeyFullBackupsDesc:"Downloads created from Backup & Restore or hourly safety copies, including queued vault entries.",storageFullBackupsCountOne:"%s backup",storageFullBackupsCountOther:"%s backups",queuedBackupDownloadDeferred:"Automatic downloads were blocked. We saved {fileName} in the local vault so the next tap can export it safely.",queuedBackupVaultEmpty:"No queued backups are waiting in the local vault.",queuedBackupVaultTitle:"Local backup vault",queuedBackupVaultIntro:"Automatic downloads were blocked. Review the backups below and download them manually while you have the browser ready offline.",queuedBackupVaultPopupBlocked:"Enable pop-ups to review queued backups stored in the local vault.",queuedBackupBannerMessageOne:"1 backup saved in the local vault.",queuedBackupBannerMessageOther:"{count} backups saved in the local vault.",queuedBackupBannerGesture:"Interact with the planner to export them safely.",queuedBackupBannerAction:"Open local backup vault",queuedBackupFallbackHint:"Emergency fallback storage active. Export queued backups immediately.",storageSessionStored:"Stored",storageSessionNotStored:"Not stored",storageKeyTotalSize:"Approximate backup size",storageKeyTotalSizeDesc:"Based on the current backup export.",storageKeyIntegrityGuard:"Backup guardian",storageKeyIntegrityGuardDesc:"Mirrors every critical storage key into a backup slot before any edits.",storageIntegrityGuardStatus:"Active",storageIntegrityGuardStatusCreated:"Mirrored {count} key(s) this session",storageIntegrityGuardStatusIssue:"{count} issue(s)  check console",storageIntegrityGuardStatusMissing:"Waiting for first save",storageTotalSizeValue:"~%s KB",aboutHeading:"About & Support",aboutHeadingHelp:"Review version details and reach support resources.",versionLabel:"Version",supportLink:"Support",supportLinkHelp:"Open the GitHub repository in a new tab.",reportBugLink:"Report a bug",reportBugLinkHelp:"Open the GitHub issues tracker to report a bug.",suggestFeatureLink:"Suggest a feature",suggestFeatureLinkHelp:"Open the GitHub issues tracker to share feature ideas.",restoreSuccess:"Settings restored. Reload to apply all changes.",restoreVerificationMatch:"Restore verification passed. Live data matches the backup snapshot.",restoreVerificationMismatch:"Restore verification found differences. Review the counts before continuing:",restoreVerificationDifference:"{label}: backup {expected}, live {actual}",restoreVerificationFailed:"Restore verification could not confirm the imported data. Review the backup manually.",restoreVerificationUnknownMetric:"Metric",restoreFailed:"Restore failed. Check the backup file and try again.",restoreVersionWarning:"Backup created with a different version. Some features might not transfer.",restoreVersionSummaryTitle:"Older backup detected",restoreVersionSummaryHeading:"This backup was created with {oldVersion} and you are running {newVersion}.",restoreVersionCoreMissing:"Not included in this backup:",restoreVersionStorageMissing:"Stored preferences not included:",restoreVersionOptionalMissing:"Optional items you may need to recreate:",restoreVersionNoIssues:"All modern data sections were found in this backup.",restoreVersionTip:"We saved a safety backup of your current data before importing.",restoreVersionFooter:"You can continue and manually recreate the missing items afterward.",restoreVersionUnknownVersion:"unknown version",restoreVersionBackupLabel:"Safety backup saved before restore: {fileName}",restoreSectionDevices:"Device library",restoreSectionSetups:"Saved setups",restoreSectionProjects:"Projects",restoreSectionFavorites:"Favorites",restoreSectionAutoGearRules:"Automatic gear rules",restoreSectionAutoGearPresets:"Automatic gear presets",restoreSectionAutoGearBackups:"Automatic gear backups",restoreSectionAutoGearActivePreset:"Selected automatic gear preset",restoreSectionAutoGearAutoPreset:"Automatic assignment preset",restoreSectionAutoGearVisibility:"Automatic backup visibility",restoreSectionAutoGearBackupRetention:"Automatic backup retention",restoreSectionAutoGearSeeded:"Automatic gear onboarding status",restoreSectionAutoGearMonitorDefaults:"Monitor defaults",restoreSectionSession:"Current planner session",restoreSectionFeedback:"Feedback drafts",restoreSectionPreferences:"App preferences",restoreSectionCustomLogo:"Custom logo",restoreSectionCustomFonts:"Custom fonts",restoreSectionSchemaCache:"Device schema cache",restoreSectionFullBackupHistory:"Backup history",restoreSectionStoredSettings:"Stored settings snapshot",restoreSectionStoredSession:"Stored session snapshot",saveSettings:"Save",saveSettingsHelp:"Apply personalization changes and close Settings.",cancelSettings:"Cancel",cancelSettingsHelp:"Close Settings without saving; previous colors and logo are restored.",reloadAppLabel:"Force reload",reloadAppHelp:"Clear cached files, unregister outdated service workers and reload without removing saved data. The app now verifies connectivity before cleanup, broadcasts fallback status to the offline banner, and preloads the fresh bundle so the new version appears faster.",reloadAppOfflineNotice:"Offline or degraded  force reload pings the server first, so reconnect and try again.",favoriteToggleLabel:"Toggle favorite",favoriteToggleHelp:"Mark the current selection as a favorite to pin it to the top of the list.",savedSetupsLabel:"Saved Projects:",newSetupOption:"-- New Project --",setupNameLabel:"Project Name:",generatedOnLabel:"Generated on",deleteSetupBtn:"Delete",saveSetupBtn:"Save",updateSetupBtn:"Update",clearFilter:"Clear filter",shareSetupBtn:"Export Project",shareSetupPrompt:"Project file ready to export. Crew contacts are included.",shareLinkCopied:"Project file downloaded.",shareExportFailed:"Project export failed.",shareLinkTooLong:"Project data is too large to export.",shareFilenamePrompt:"Enter a name for the exported project file (default: {defaultName}).",shareFilenameInvalid:"Please enter a valid file name to continue.",shareIncludeAutoGearConfirm:"Include automatic gear rules in the exported file? Select OK to include them or Cancel to skip.",shareIncludeAutoGearLabel:"Include automatic gear rules",shareIncludeAutoGearHelp:"Add your automatic gear rules to the exported project file.",shareIncludeOwnedGearLabel:"Mark owned gear in export",shareIncludeOwnedGearHelp:"Add ownership badges for gear you marked as yours when exporting.",shareDialogTitle:"Export Project",shareFilenameLabel:"Export file name",shareDialogConfirm:"Download",shareDialogCancel:"Cancel",sharedLinkLabel:"Project file",loadSharedLinkBtn:"Import Project",invalidSharedLink:"Invalid project file.",sharedImportAutoGearLabel:"Automatic gear rules",sharedImportAutoGearNone:"Do not import automatic gear rules",sharedImportAutoGearNoneHelp:"Load the project without applying the shared automatic rules.",sharedImportAutoGearProject:"Use shared rules for this project only",sharedImportAutoGearProjectHelp:"Save the shared automatic gear rules as a preset, apply it here, and restore your previous preset for other projects.",sharedImportAutoGearGlobal:"Use shared rules for all projects",sharedImportAutoGearGlobalHelp:"Save the shared automatic gear rules as a preset, activate it, and keep it selected for every project.",sharedImportAutoGearPresetName:"Shared rules  %s",sharedImportAutoGearPresetFallback:"Shared automatic gear rules",sharedImportDialogTitle:"Automatic gear rules",sharedImportDialogMessage:"Choose how to apply the shared automatic gear rules from this project.",sharedImportMetadataTimestamp:"Exported {timestamp}",sharedImportMetadataVersion:"Planner version {version}",sharedImportMetadataVersionMismatch:"Planner version {importVersion} (current build {appVersion})",sharedImportMetadataIncludesAutoGear:"Includes automatic gear rules",sharedImportMetadataIncludesOwnedGear:"Marks owned gear items",sharedImportMetadataUnavailable:"Export details unavailable.",sharedImportDialogConfirm:"Apply",sharedImportDialogCancel:"Cancel",cameraLabel:"Camera:",monitorLabel:"Monitor:",videoLabel:"Wireless Transmitter:",cageLabel:"Camera Cage:",distanceLabel:"Distance Sensor:",batteryLabel:"Battery:",batteryBMountLabel:"B-Mount Battery:",batteryPlateLabel:"Battery Plate:",batteryHotswapLabel:"Battery Hotswap:",lensesLabel:"Lenses:",fizLegend:"FIZ (Follow Focus) Systems",fizMotorsLabel:"FIZ Motors:",fizControllersLabel:"FIZ Controllers:",fizLegendHelp:"Add motors, controllers or distance units for focus/iris/zoom control.",fizMotorsHelp:"Select focus, iris or zoom motors.",fizControllersHelp:"Choose hand units or controllers for your FIZ system.",breakdownListHelp:"Power consumption per device category.",totalPowerLabel:"Total Consumption:",totalPowerHelp:"Combined power draw of all selected devices.",availablePowerLabel:"Available Power:",totalCurrent144Label:"Total Current (at 14.4V):",totalCurrent144Help:"Current draw at the battery's high-voltage output (e.g., 14.4V pins).",totalCurrent12Label:"Total Current (at 12V):",totalCurrent12Help:"Current draw from a 12V output such as D-Tap.",totalCurrent336Label:"Total Current (at 33.6V):",totalCurrent336Help:"Current draw at the battery's high-voltage output (e.g., 33.6V pins).",totalCurrent216Label:"Total Current (at 21.6V):",totalCurrent216Help:"Current draw from a 21.6V output such as B-Mount low-voltage.",batteryLifeLabel:"Runtime (estimated):",batteryLifeHelp:"Estimated runtime based on total draw and chosen battery capacity.",batteryCountLabel:"Batteries for 10h shoot:",batteryCountHelp:"Batteries needed for a 10-hour shoot.",runtimeFeedbackBtn:"Submit User Runtime Feedback",selectedGearHeading:"Selected Gear",recommendationsHeading:"Recommended Accessories",recommendationsHeadingHelp:"Accessories suggested based on selected devices.",weightingHeading:"Runtime Weighting Breakdown",pinWarningHelp:"Alerts if current exceeds what the battery pins can supply.",dtapWarningHelp:"Alerts if current exceeds what the D-Tap port can supply.",hotswapWarningHelp:"Alerts if the selected hotswap restricts available current.",methodPinsOnly:"pins only!",methodPinsAndDTap:"both pins and D-Tap",methodInfinite:"infinite",pinOk:"Battery pins can supply up to {max}A  current draw is within limits.",dtapOk:"D-Tap can supply up to {max}A  current draw is within limits.",warnPinExceededLevel:"warning",warnPinNearLevel:"note",warnDTapExceededLevel:"warning",warnDTapNearLevel:"note",warnPinExceeded:"WARNING: current draw ({current}A at ~12V) exceeds the battery's main output rating ({max}A)!",warnPinNear:"Note: current draw is close to the main output limit ({current}A of {max}A).",warnDTapExceeded:"WARNING: current draw ({current}A) exceeds the battery's D-Tap output ({max}A)!",warnDTapNear:"Note: current draw uses over 80% of the D-Tap capacity ({current}A of {max}A).",warnHotswapLower:"WARNING: hotswap current limit ({max}A) is lower than battery ({batt}A).",powerWarningTitle:"Battery cannot power this load",powerWarningLimitsHeading:"Output limits",powerWarningMessage:"{battery} must deliver {current}A, which exceeds every available output.",powerWarningPinsDetail:"Pins limit: {max}A",powerWarningPinsUnavailable:"Pins limit unavailable.",powerWarningDtapDetail:"D-Tap limit: {max}A",powerWarningDtapUnavailable:"No D-Tap output is available.",powerWarningDtapBlocked:"D-Tap cannot be used with the current configuration.",powerWarningAdvice:"Choose another battery, reduce the draw, or adjust your power distribution.",powerWarningClose:"Understood",incompatibleFIZWarning:"WARNING: incompatible FIZ brands selected.",missingFIZControllerWarning:"ERROR: FIZ motors require a controller with LBUS/CAM connection.",arriUMC4Warning:"WARNING: UMC-4 only works with LCS (LEMO 7-pin) to LBUS cable with LBUS devices.",arriRIA1Warning:"WARNING: RIA-1 or cforce RF controllers are not compatible with CLM-3/4/5.",arriCLMNoUMC4Warning:"WARNING: No FIZ controller present. Select a UMC-4 for a complete project. CLM-3/4/5 are not compatible with RIA-1, cforce RF or Master Grips.",distanceControllerWarning:"WARNING: Distance units require UMC-4, RIA-1 or cforce RF.",masterGripWirelessWarning:"WARNING: Master Grip has no wireless capability. Use RIA-1, UMC-4 or cforce RF for wireless control.",amiraCforceRemoteWarning:"ERROR: AMIRA with cforce Mini/Plus requires RIA-1, cforce RF, or UMC-4 for remote focus. Master Grips only allow local operator focus.",category_cameras:"Cameras",category_lenses:"Lenses",category_viewfinders:"Viewfinders",category_monitors:"Monitors",category_video:"Wireless Transmitter",category_wirelessReceivers:"Wireless Receiver",category_cages:"Cages",category_fiz_motors:"FIZ Motors",category_fiz_controllers:"FIZ Controllers",category_fiz_distance:"FIZ Distance",category_batteries:"Batteries",category_batteryHotswaps:"Battery Hotswap",category_accessory_batteries:"Accessory Batteries",category_cables:"Cables",category_camera_support:"Camera Support",category_chargers:"Chargers",category_cardReaders:"Card Reader",lensSpecBrandLabel:"Brand",lensSpecTypeLabel:"Lens Type",lensSpecMountLabel:"Mount",lensSpecFrontDiameterLabel:"Front Diameter",lensSpecTStopLabel:"T-stop",lensSpecImageCircleLabel:"Image Circle",lensSpecLengthLabel:"Length",lensSpecMinFocusLabel:"Minimum Focus",lensSpecWeightLabel:"Weight",lensSpecRodStandardLabel:"Rod Standard",lensSpecRodLengthLabel:"Rod Length",lensSpecClampOnLabel:"Clamp-on",lensSpecSupportLabel:"Lens Support",lensSpecCategoryGeneralLabel:"General",lensSpecCategoryOpticsLabel:"Optics",lensSpecCategoryPhysicalLabel:"Physical",lensSpecCategorySupportLabel:"Support",lensSpecCategoryNotesLabel:"Notes",lensSpecNotesLabel:"Notes",lensSpecFocusScaleLabel:"Focus Scale",lensSpecYes:"Yes",lensSpecNo:"No",lensSpecSupportRequired:"Required",lensSpecSupportNotRequired:"Not required",lensSpecUnknownValue:"Unknown",addDeviceHeading:"Add New Device",categoryLabel:"Category:",subcategoryLabel:"Subcategory:",deviceNameLabel:"Name:",consumptionLabel:"Consumption (W):",capacityLabel:"Capacity (Wh):",pinLabel:"Max Pin A:",dtapLabel:"Max D-Tap A:",cameraWattLabel:"Power Draw (W):",cameraVoltageLabel:"Voltage Range:",cameraPortTypeLabel:"Port Type:",cameraPlatesLabel:"Battery Plates:",cameraMediaLabel:"Recording Media:",cameraLensMountLabel:"Lens Mount:",lensDeviceMountHeading:"Lens Mount Options",lensDeviceMountLabel:"Mount options:",lensDeviceMountHelp:'Add every mount this lens supports. Choose "native" when no adapter is required.',lensFocusScaleLabel:"Focus scale unit:",lensFocusScaleHelp:"Choose the measurement markings shown for this lens. Leave the global default to follow project settings.",lensFocusScaleDefault:"Use global focus scale",powerInputsHeading:"Power Inputs",powerDistributionHeading:"Power Distribution",videoOutputsHeading:"Video Outputs",fizConnectorHeading:"FIZ Connector",mediaHeading:"Media",viewfinderHeading:"Viewfinder",lensMountHeading:"Lens Mount",timecodeHeading:"Timecode",powerDistributionLabel:"Outputs:",videoOutputsLabel:"Outputs:",fizConnectorLabel:"Connectors:",viewfinderLabel:"Viewfinders:",timecodeLabel:"Timecode:",monitorScreenSizeLabel:"Screen Size (in):",monitorBrightnessLabel:"Brightness (nits):",monitorWattLabel:"Power Draw (W):",monitorVoltageLabel:"Voltage Range:",monitorPortTypeLabel:"Port Type:",monitorVideoInputsHeading:"Video Inputs",monitorVideoInputsLabel:"Inputs:",monitorVideoOutputsHeading:"Video Outputs",monitorVideoOutputsLabel:"Outputs:",monitorWirelessTxLabel:"Wireless TX:",monitorLatencyLabel:"Latency:",monitorLatencyHelp:"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.",monitorAudioOutputLabel:"Audio Output:",viewfinderDetailsHeading:"Viewfinder Details",viewfinderScreenSizeLabel:"Screen Size (in):",viewfinderBrightnessLabel:"Brightness (nits):",viewfinderPowerHeading:"Power Input",viewfinderWattLabel:"Power Draw (W):",viewfinderVoltageLabel:"Voltage Range:",viewfinderPortTypeLabel:"Port Type:",viewfinderVideoInputsHeading:"Video Inputs",viewfinderVideoInputsLabel:"Inputs:",viewfinderVideoOutputsHeading:"Video Outputs",viewfinderVideoOutputsLabel:"Outputs:",viewfinderWirelessTxLabel:"Wireless TX:",viewfinderLatencyLabel:"Latency:",viewfinderLatencyHelp:"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.",videoPowerInputsHeading:"Power Inputs",videoVideoInputsHeading:"Video Inputs",videoVideoInputsLabel:"Inputs:",videoVideoOutputsHeading:"Video Outputs",videoVideoOutputsLabel:"Outputs:",videoPowerInputLabel:"Connectors:",videoPowerInputHelp:"Add every supported power connector, including battery plates. Use notes for mount adapters or other details.",videoPowerTypeLabel:"Connector",videoPowerVoltageLabel:"Voltage range",videoPowerNotesLabel:"Notes",videoPowerVoltagePlaceholder:"Voltage range (e.g. 6-28V)",videoPowerNotesPlaceholder:"Notes (mount, adapter, etc.)",videoFrequencyLabel:"Frequency:",videoLatencyLabel:"Latency:",motorConnectorLabel:"Connector:",motorInternalLabel:"Internal Controller:",motorTorqueLabel:"Torque (Nm):",motorGearLabel:"Gear Types:",controllerConnectorLabel:"Connector:",controllerPowerLabel:"Power Source:",controllerBatteryLabel:"Battery Type:",controllerConnectivityLabel:"Connectivity:",distanceConnectionLabel:"Connection:",distanceMethodLabel:"Method:",distanceRangeLabel:"Range:",distanceAccuracyLabel:"Accuracy:",distanceOutputLabel:"Display:",notesLabel:"Notes:",monitorDetailsHeading:"Monitor Details",monitorPowerHeading:"Power Input",addDeviceBtn:"Add",addDeviceBtnHelp:"Add the new device to the database.",updateDeviceBtn:"Update",updateDeviceBtnHelp:"Save changes to the current device.",editBtn:"Edit",editBtnHelp:"Modify this device's details.",deleteDeviceBtn:"Delete",deleteDeviceBtnHelp:"Remove this device from the database.",cancelEditBtn:"Cancel",cancelEditBtnHelp:"Cancel editing and clear the form.",exportDataBtn:"Export Database",exportDataBtnHelp:"Download the current device database as a JSON file.",importDataBtn:"Import Database",importDataBtnHelp:"Load a device database from a JSON file.",alertImportSuccess:"Database imported successfully! {num_devices} devices loaded.",alertImportError:"Failed to import database. Invalid file or data format.",confirmExportAndRevert:"Are you sure you want to export the current database AND then revert to the default database? This will overwrite your current saved data with the original defaults.",alertExportAndRevertSuccess:"Database exported and reverted to defaults successfully.",alertStorageError:"Storage error: Unable to access local data. Changes may not be saved.",alertSessionFallback:"Warning: Local storage is unavailable. Data will only persist for this browser tab.",placeholder_deviceName:"Device name",placeholder_watt:"e.g. 12.5",placeholder_capacity:"e.g. 98",placeholder_pin:"e.g. 10",placeholder_dtap:"e.g. 5",placeholder_voltage:"11V-34V DC",placeholder_port:"Bat LEMO 8-pin",placeholder_plates:'[{"type":"V-Mount","mount":"native"}]',placeholder_media:'[{"type":"CFast 2.0"}]',placeholder_lensmount:"ARRI PL",placeholder_powerdist:"[{}]",placeholder_videooutputs:"[{}]",placeholder_fizconnector:"[{}]",placeholder_timecode:"[{}]",placeholder_filter:"Filter {item}...",toggleDeviceManager:"Edit Device Data",hideDeviceManager:"Hide Device Data",showDetails:"Show Details",hideDetails:"Hide Details",batteryTableLabel:"Battery",batteryLifeHeading:"Runtime comparison",runtimeLabel:"Estimated Runtime (h)",batteryLifeUnit:"hrs",runtimeAverageNote:"Note: runtime estimate uses a weighted average of user-submitted runtimes adjusted for resolution, codec, frame rate, brightness and temperature.",runtimeUserCountNote:"Based on {count} user reports for this project.",temperatureNoteHeading:"Temperature impact on runtime:",temperatureNoteHelp:"Shows how different temperatures affect battery runtime.",temperatureLabel:"Temperature",batteryCountTempLabel:"Batteries needed",noBatterySupports:"No battery can supply this load.",alertSetupName:"Please enter a name for the project.",alertSetupNeedsDevice:"You can save a project even if no devices are selected yet.",alertSetupSaved:'Project "{name}" saved in this browser. It stays available after closing or reopening tabs unless you clear the browser cache.',alertSetupSavedNoDevices:`Project "{name}" saved in this browser with no devices yet. Add gear and requirements whenever you're readywe'll keep everything protected.`,alertSetupRenameSaveFailed:"We couldnt finish saving the renamed project. Your original project is still availableplease try saving again to keep everything in sync.",alertNoSetupSelected:"Please select a saved project to delete.",alertSetupDeleted:'Project "{name}" deleted.',confirmDeleteSetup:'Really delete project "{name}"?',confirmDeleteSetupAgain:"This will permanently delete the project. Are you sure?",confirmDeleteDevice:'Really delete device "{name}"?',alertDeviceExists:"A device with this name already exists in this category.",alertDeviceAdded:'Device "{name}" added to category "{category}".',alertDeviceUpdated:'Device "{name}" updated in category "{category}".',alertDeviceFields:"Please provide valid values for capacity, Pin A and D-Tap A.",alertDeviceWatt:"Please enter a valid watt value.",alertDeviceName:"Device name cannot be empty.",alertInvalidCameraJSON:"Invalid JSON for camera details",generateOverviewBtn:"Generate Overview",generateGearListBtn:"Generate Kit List and Production Requirements",addExtraGearBtn:"Add temporary extra gear",editProjectBtn:"Edit Project requirements",projectForm:{heading:"Production Requirements",projectName:"Project Name:",productionCompany:"Production Company:",productionCompanyAddress:"Production Company Address (optional):",productionCompanyStreet:"Street address",productionCompanyStreetPlaceholder:"123 Production Way",productionCompanyStreet2:"Address line 2 (optional)",productionCompanyStreet2Placeholder:"Suite, building, etc.",productionCompanyCity:"City",productionCompanyCityPlaceholder:"Los Angeles",productionCompanyRegion:"State / Province / Region",productionCompanyRegionPlaceholder:"California",productionCompanyPostalCode:"Postal code",productionCompanyPostalCodePlaceholder:"90001",productionCompanyCountry:"Country",productionCompanyCountryPlaceholder:"United States",rentalHouse:"Rental:",crewHeading:"Crew",prepLabel:"Prep Days:",shootLabel:"Shooting Days:",returnLabel:"Return Day(s):",deliveryResolution:"Delivery Resolution:",recordingResolution:"Recording Resolution:",sensorMode:"Sensor Mode:",aspectRatio:"Aspect Ratio:",codec:"Codec:",baseFrameRate:"Base Frame Rate:",recordingFrameRate:"Recording Frame Rate:",recordingFrameRateRangeHint:"Enter a recording frame rate from 1 to {max} fps.",recordingFrameRateDefaultHint:"Enter the recording frame rate in frames per second.",slowMotionHeading:"Slow Motion Frame Rate",slowMotionRecordingResolution:"Slow Motion Recording Resolution:",slowMotionSensorMode:"Slow Motion Sensor Mode:",slowMotionAspectRatio:"Slow Motion Aspect Ratio:",slowMotionBaseFrameRate:"Slow Motion Base Frame Rate:",slowMotionRecordingFrameRate:"Slow Motion Recording Frame Rate:",slowMotionRecordingFrameRateRangeHint:"Enter a slow motion recording frame rate from 1 to {max} fps.",slowMotionRecordingFrameRateDefaultHint:"Enter the slow motion recording frame rate in frames per second.",lensesHeading:"Lenses",lensManufacturerStep:"Step 1: Select manufacturer",lensManufacturerPlaceholder:"Choose a manufacturer",lensSeriesStep:"Step 2: Select series",lensSeriesPlaceholder:"Choose a series",lensSeriesEmpty:"No series available for this manufacturer.",lensesLabel:"Step 3: Choose lenses",lensOptionsEmpty:"No lenses available for this series.",lensSelectionsLabel:"Selected lenses",lensSelectionsHint:"Selections update as you add or remove lenses.",lensRemoveLabel:"Remove {lens}",lensMountLabel:"Mount",riggingHeading:"Rigging & Mounting",requiredScenarios:"Shooting Scenarios & Environments",cameraHandle:"Camera Handle:",viewfinderExtension:"Viewfinder Extension:",viewfinderExtensionNone:"No",viewfinderExtensionYes:"Yes",matteboxFilterHeading:"Mattebox and Filter",mattebox:"Mattebox:",filter:"Filter:",storageHeading:"Storage & Media",storageNeedsLabel:"Recording media needs:",storageQuantityLabel:"Quantity",storageTypeLabel:"Media type:",storageVariantLabel:"Brand & capacity:",storageNotesLabel:"Notes:",storageTypePlaceholder:"Select media type",storageVariantPlaceholder:"Select brand & size",storageNotesPlaceholder:"Add notes (brand, capacity, recorder...)",storageDuplicateEntry:"Duplicate media row",storageSummaryFallback:"Media",monitoringHeading:"Monitoring",monitoringConfiguration:"Camera Monitoring Configuration:",viewfinderSettings:"Viewfinder Settings:",frameGuides:"Frameguides:",aspectMaskOpacity:"Aspect Mask Opacity:",videoDistribution:"Video distribution:",monitorUserButtons:"Onboard Monitor User Buttons:",cameraUserButtons:"Camera User Buttons:",viewfinderUserButtons:"Viewfinder User Buttons:",userButtonFunctions:{user1:"User 1",user2:"User 2",user3:"User 3",user4:"User 4",toggleLut:"Toggle LUT",falseColor:"False Color",peaking:"Peaking",anamorphicDesqueeze:"Anamorphic Desqueeze",surroundView:"Surround View",oneToOneZoom:"1:1 Zoom",waveform:"Waveform",histogram:"Histogram",vectorscope:"Vectorscope",zebra:"Zebra",playback:"Playback",record:"Record",zoom:"Zoom",frameLines:"Frame Lines",frameGrab:"Frame Grab",wb:"WB",iso:"ISO",nd:"ND",fps:"FPS",shutter:"Shutter"},tripodPreferencesHeading:"Tripod Preferences",tripodHeadBrand:"Head Brand:",tripodBowl:"Bowl type:",tripodTypes:"Tripod types:",tripodSpreader:"Spreader Preference:",cancel:"Cancel",addEntry:"Add",removeEntry:"Remove",submit:"OK",crewNamePlaceholder:"Name",crewPhonePlaceholder:"Phone",crewEmailPlaceholder:"Email",crewWebsitePlaceholder:"Website",crewRoleLabel:"Crew role",crewNameLabel:"Crew member name",crewPhoneLabel:"Crew member phone",crewEmailLabel:"Crew member email",crewWebsiteLabel:"Crew member website"},projectFields:{productionCompany:"Production Company",productionCompanyAddress:"Production Company Address",productionCompanyStreet:"Street address",productionCompanyStreetPlaceholder:"123 Production Way",productionCompanyStreet2:"Address line 2 (optional)",productionCompanyStreet2Placeholder:"Suite, building, etc.",productionCompanyCity:"City",productionCompanyCityPlaceholder:"Los Angeles",productionCompanyRegion:"State / Province / Region",productionCompanyRegionPlaceholder:"California",productionCompanyPostalCode:"Postal code",productionCompanyPostalCodePlaceholder:"90001",productionCompanyCountry:"Country",productionCompanyCountryPlaceholder:"United States",rentalHouse:"Rental",rentalHouseContact:"Rental contact",rentalHouseAddress:"Rental address",crew:"Crew",prepDays:"Prep Days",shootingDays:"Shooting Days",returnDays:"Return Days",deliveryResolution:"Delivery Resolution",recordingResolution:"Recording Resolution",aspectRatio:"Aspect Ratio",codec:"Codec",baseFrameRate:"Base Frame Rate",recordingFrameRate:"Recording Frame Rate",slowMotionRecordingResolution:"Slow Motion Recording Resolution",slowMotionSensorMode:"Slow Motion Sensor Mode",slowMotionAspectRatio:"Slow Motion Aspect Ratio",slowMotionBaseFrameRate:"Slow Motion Base Frame Rate",slowMotionRecordingFrameRate:"Slow Motion Recording Frame Rate",sensorMode:"Sensor Mode",lenses:"Lenses",requiredScenarios:"Required Scenarios",cameraHandle:"Camera Handle",viewfinderExtension:"Viewfinder Extension",viewfinderEyeLeatherColor:"Viewfinder Eye Leather Color",mattebox:"Mattebox",gimbal:"Gimbal",videoDistribution:"Video Distribution",monitoringSupport:"Monitoring support",monitoringConfiguration:"Monitoring configuration",focusMonitor:"Focus Monitor",monitorUserButtons:"Onboard Monitor User Buttons",cameraUserButtons:"Camera User Buttons",viewfinderUserButtons:"Viewfinder User Buttons",tripodHeadBrand:"Tripod Head Brand",tripodBowl:"Tripod Bowl",tripodTypes:"Tripod Types",tripodSpreader:"Tripod Spreader",sliderBowl:"Slider Bowl",easyrig:"Further Stabilisation",storageRequirements:"Storage & Media"},crewRoles:{Producer:"Producer","Production Manager":"Production Manager",Director:"Director","Assistant Director":"1st AD","Production Assistant":"Production Assistant",DoP:"DoP","Camera Operator":"Camera Operator","B-Camera Operator":"B-Camera Operator","Steadicam Operator":"Steadicam Operator","Drone Operator":"Drone Operator","1st AC":"1st AC","2nd AC":"2nd AC",DIT:"DIT","Video Operator":"Video Operator","Key Gaffer":"Gaffer",Gaffer:"Electric","Best Boy Electric":"Best Boy Electric",Electrician:"Electrician","Rigging Gaffer":"Rigging Gaffer","Key Grip":"Key Grip","Best Boy Grip":"Best Boy Grip",Grip:"Grip","Dolly Grip":"Dolly Grip","Rigging Grip":"Rigging Grip"},scenarios:{Indoor:"Indoor",Outdoor:"Outdoor",Studio:"Studio",Tripod:"Tripod",Handheld:"Handheld",Easyrig:"Easyrig","Cine Saddle":"Cine Saddle",Steadybag:"Steadybag",Dolly:"Dolly",Slider:"Slider",Steadicam:"Steadicam",Gimbal:"Gimbal",Trinity:"Trinity",Rollcage:"Rollcage","Car Mount":"Car Mount",Jib:"Jib","Undersling mode":"Undersling Mode",Crane:"Crane","Remote Head":"Remote Head","Extreme cold (snow)":"Extreme Cold (Snow)","Extreme rain":"Extreme Rain","Extreme heat":"Extreme Heat","Rain Machine":"Rain Machine","Slow Motion":"Slow Motion","Battery Belt":"Battery Belt"},gearListNoteLabel:"Note:",gearListAutosaveNote:"Autosaved after each rig tweak so the offline gear manifest mirrors your latest camera build.",gearListAddCustomItem:"Add custom item",gearListAddCustomItemToCategory:"Add custom item to {category}",gearListRemoveCustomItem:"Remove",gearListRemoveCustomItemFromCategory:"Remove custom item from {category}",gearListCustomItemQuantityLabel:"Quantity",gearListCustomItemQuantityAria:"Quantity for custom item in {category}",gearListCustomItemNameLabel:"Item name",gearListCustomItemNameAria:"Item name for custom item in {category}",gearListCustomItemNamePlaceholder:"Custom item",gearListCustomItemPreviewFallback:"Custom item",gearListCartSelectorLabel:"Camera cart",gearListCartConfigurationLabel:"Cart configuration",gearListCartAccessoriesLabel:"Cart accessories",gearListExcludeRentalToggle:"Exclude for rental",gearListIncludeRentalToggle:"Include for rental",gearListRentalNote:"Rental handles this item",gearListEditProviderLabel:"Provided by",gearListEditProviderHelp:"Select who provides this item. Rental stays the default unless the item is in your own gear list.",gearListProviderRental:"Rental",gearListProviderUser:"User",gearListProviderCrewHeading:"Crew",gearListProviderUnknown:"Custom provider",gearListEditOwnedLabel:"Owned",gearListEditOwnedHelp:"Add or remove this line from your Own Gear list to keep your inventory in sync.",gearListOwnedExportLabel:"Owned by %s",gearListEditCameraLinkLabel:"Camera link",gearListEditCameraAssignmentLabel:"Camera designation",gearListEditCameraAssignmentHelp:"Pick the letter for this camera body. Linked accessories will share its color.",gearListEditCameraLinkHelp:"Highlight items that should follow a specific camera letter so crews know which kit moves together.",gearListEditCameraLinkNoneOption:"No camera link",gearListEditCameraLinkCameraOption:"Camera %s  %s",gearListEditCameraLinkUnavailableOption:"Camera %s (unassigned)",gearListEditCameraLinkDefaultLabel:"Camera %s",gearListCameraLinkBadgeLabel:"Linked to camera",gearListEditDialogTitle:"Edit gear item",gearListEditQuantityLabel:"Quantity",gearListEditNameLabel:"Item name",gearListEditAttributesLabel:"Attributes",gearListEditNoteLabel:"Note",gearListEditExtraLabel:"Temporary extra gear",gearListEditExtraHelp:"Flag this item as a short-term addition. Set the period so everyone schedules it correctly.",gearListEditExtraStartLabel:"Needed from",gearListEditExtraEndLabel:"Needed until",gearListEditExtraPeriodHelp:"Leave the dates blank when the schedule is still tentative.",gearListExtraCategoryLabel:"Temporary Extras",gearListExtraIndicatorRange:"Temporary extra: %s  %s",gearListExtraIndicatorOpen:"Temporary extra from %s",gearListExtraIndicatorEnd:"Temporary extra until %s",gearListExtraIndicatorNoPeriod:"Temporary extra",gearListEditRentalLabel:"Exclude from rental",gearListEditSave:"Save",gearListEditCancel:"Cancel",gearListEditButton:"Edit gear item",gearListEditCustomItem:"Edit custom item",gearListEditReset:"Reset name",gearListEditDeviceHeading:"Device attributes",gearListEditDeviceEdit:"Edit device attributes",gearListEditDeviceEmpty:"No device attributes recorded yet. Update the device to add details.",gearListEditDeviceCategory:"Device library: %s",gearListLensCoverageWarning:"This lens may not cover the full sensor of this camera!",autoGearHighlightToggle:"Highlight automatic gear",autoGearHighlightToggleHelp:"Toggle a temporary color overlay for gear added by automatic rules. Useful while debugging gear rule behavior.",autoGearHighlightToggleStateOn:"On",autoGearHighlightToggleStateOff:"Off",deleteGearListBtn:"Delete Kit List",deleteGearListBtnHelp:"Remove the saved kit list from this project and hide the table.",confirmDeleteGearList:"Delete kit list?",confirmDeleteGearListAgain:"This will permanently delete the kit list. Are you sure?",ownGearDialogTitle:"Own gear",ownGearDialogDescription:"Capture the equipment you personally own so you can plan around what's already in your kit.",ownGearAddHeading:"Add gear",ownGearAddHelp:"Start typing to search our catalog for suggestions or describe custom items you own. Entries save immediately.",ownGearNameLabel:"Item",ownGearNamePlaceholder:"Lens, monitor, adapter",ownGearNameHelp:"Required. Use the exact model name so suggestions and exports stay clear.",ownGearQuantityLabel:"Quantity",ownGearQuantityPlaceholder:"1",ownGearQuantityHelp:"Enter how many of this item you own. Leave blank when it varies.",ownGearNotesLabel:"Notes",ownGearNotesPlaceholder:"Condition, accessories, case number",ownGearNotesHelp:"Optional notes about accessories, serial numbers or case locations.",ownGearSaveButton:"Save item",ownGearUpdateButton:"Update item",ownGearResetButton:"Reset form",ownGearCloseButton:"Close",ownGearListHeading:"Your gear",ownGearListEmpty:"No gear saved yet. Add the equipment you own to reuse it across projects.",ownGearListSummaryOne:"%s item tracked",ownGearListSummaryOther:"%s items tracked",ownGearEditButton:"Edit",ownGearEditButtonAria:"Edit %s",ownGearDeleteButton:"Remove",ownGearDeleteButtonAria:"Remove %s from your own gear list",ownGearDeleteConfirm:"Remove %s from your own gear list? This only removes it from your inventory.",ownGearQuantityInvalid:"Enter a non-negative quantity or leave the field blank.",ownGearNameRequired:"Enter the item name to save it.",alertSelectSetupForOverview:"Please select a saved project to generate an overview.",overviewTitle:"Project Overview",backToAppBtn:"Back to App",printBtn:"Print",exportPdfBtn:"Export PDF / Print",exportRentalPdfBtn:"Export PDF for Rental",rentalPrintDialogTitle:"Export PDF / Print",rentalPrintDialogDescription:"Choose what to include before exporting or printing.",rentalPrintDialogSectionsLabel:"Sections to include",rentalPrintDialogConfirm:"Export PDF",rentalPrintDialogCancel:"Cancel",rentalPrintDialogSelectAll:"Select all",printOptionsLayoutLabel:"Layout",printOptionsLayoutStandard:"Standard layout",printOptionsLayoutRental:"Rental-friendly layout",rentalPrintSectionProject:"Production Requirements",rentalPrintSectionDevices:"Camera Package Devices",rentalPrintSectionPower:"Power Summary",rentalPrintSectionDiagram:"Power Diagram",rentalPrintSectionGearList:"Kit List",rentalPrintSectionBattery:"Battery Comparison",pdfWarningsHeading:"Warnings",exportAndRevertBtn:"Export and revert to default database",exportAndRevertBtnHelp:"Export your database and restore default entries.",helpButtonLabel:"Help",helpButtonTitle:"Help (press ?, H, F1 or Ctrl+/)",helpButtonHelp:"Open the help dialog for step-by-step guidance. Keyboard shortcuts: F1, Ctrl + /, Cmd + /, ? or H.",helpButtonShortcuts:"F1; Ctrl + /; Cmd + /; ?; H",helpButtonAriaShortcuts:"F1 Control+Slash Meta+Slash Shift+Slash KeyH",helpClose:"Close (Esc)",helpCloseHelp:"Close the help dialog and return to the planner (press Esc).",helpTitle:"How to use",helpSearchPlaceholder:"Search help topics...",helpSearchLabel:"Search help topics",helpResultsSummaryAll:"All %s help topics are shown.",helpResultsSummaryFiltered:"Showing %1$s of %2$s help topics for %3$s.",helpResultsAssist:"Tip: Press Tab to move into the quick links, or press Enter to open the top visible topic.",helpNoResults:"No help topics match your search. Try shorter keywords, synonyms, or clear the field to browse everything.",helpNoResultsSuggestionsHeading:"Need a different result?",helpNoResultsSuggestionsIntro:"Try these steps to get back on track while keeping your data safe and confirming offline safeguards:",helpNoResultsSuggestionClear:"Use %s to browse every article again.",helpNoResultsSuggestionSynonyms:"Search for equipment nicknames, battery part numbers, or shorter keywords.",helpNoResultsSuggestionQuickStart:"Jump to the %s for a guided refresher on saving, sharing, and backups.",helpNoResultsSuggestionBackup:"Open %1$s, start a %2$s to confirm your offline exports, and review Settings  Data & Storage for the latest autosave timestamp before you continue.",helpOnboardingTutorialCopy:"to follow every workflow with offline progress trackingincluding the Power Summary checkpoint and the offline safety net drillbefore configuring your first project. Use the step navigator and progress meter to review completed sections offline.",onboardingTour:{startLabel:"Start guided tutorial",restartLabel:"Replay guided tutorial",resumeLabel:"Resume guided tutorial",skipLabel:"Skip tutorial",backLabel:"Back",nextLabel:"Next",introStartLabel:"Start onboarding tour",doneLabel:"Finish tutorial",stepIndicator:"Step {current} of {total}",completionIndicator:"First project secured offline",prefaceIndicator:"Welcome",stepListAriaLabel:"Tutorial steps",stepStatusCurrent:"Current step",stepStatusComplete:"Completed",stepStatusUpcoming:"Up next",resumeHint:"Picking up right where you paused. Use the step navigator to revisit earlier workflows without clearing offline progress.",resumeHintDetailed:"Resuming at step {current} of {total}. {completed} steps are already complete and locked into your offline saves.",userProfileInteractionIntro:"Enter your crew details once. Each update syncs to Contacts instantly, stays cached offline and flows into exports so crews always know who owns the setup.",userProfileInteractionSkipHint:"Press Next when you are readyContacts in the sidebar always shows these saved details without resetting tutorial progress.",userProfileAvatarAction:"Add profile photo",userProfileAvatarEditAction:"Edit photo",projectRequirementsMiniIntro:"Fill these proxy fields while the Production Requirements dialog stays open.",projectRequirementsMiniOfflineHint:"Every edit saves offline instantlyuse Back/Next here without risking data loss.",unitsPreferencesLanguageLabel:"Language",unitsPreferencesThemeLabel:"Theme",unitsPreferencesThemeLight:"Light",unitsPreferencesThemeDark:"Dark",unitsPreferencesPinkLabel:"Pink mode accents",unitsPreferencesPinkOff:"Disabled",unitsPreferencesPinkOn:"Enabled",unitsPreferencesUnitsLabel:"Temperature units",unitsPreferencesPersistenceHint:"Request persistent storage so the browser keeps planner data even when space runs low.",unitsPreferencesPersistenceAction:"Protect storage on this device",progressMeterLabel:"Tutorial progress",progressValueLabel:"Completed {completed} of {total} steps",resumeLabelWithProgress:"Resume guided tutorial ({completed}/{total} complete)",helpStatusNotStarted:"Guided tutorial progress saves offline as you advance. Up next: {next}.",helpStatusInProgress:"Offline progress saved: {completed} steps completed out of {total}. Next workflow: {next}.",helpStatusResume:"Paused on {current}. {completed} of {total} steps already secured offline.",helpStatusSkipped:"Tutorial skipped. Restart whenever you're readysaved progress stays available offline.",helpStatusCompleted:"Tutorial completed. Replay any step anytime for a refresher.",helpStatusLastCompleted:"Last completed: {step} ({timeAgo}).",helpStatusLastUpdated:"Last update: {timeAgo}.",helpStatusTimeJustNow:"just now",helpStatusTimeMinute:"1 minute ago",helpStatusTimeMinutes:"{count} minutes ago",helpStatusTimeHour:"1 hour ago",helpStatusTimeHours:"{count} hours ago",helpStatusTimeDay:"1 day ago",helpStatusTimeDays:"{count} days ago",skipConfirmationTitle:"Skip the guided tutorial?",skipConfirmationBody:"You can reopen the tutorial from Help or use the step navigator to replay any section later.",skipConfirmationAccept:"Skip tutorial",skipConfirmationCancel:"Continue tutorial",steps:{intro:{hero:{heading:"Welcome to Cine Power Planner!",subheading:"Safeguard every camera setup with power checks, AutoGear kits, and rental-ready handoffskept fully offline.",summary:"Plan safe camera setups, verify power limits, auto-build kit lists from production requirements, and export rental-ready PDFsevery save stays local before call time.",badgeIcon:"",badgeLabel:"Crew-first  Offline forever",badgeDescription:"No servers, no accounts, no subscriptions. Every save, autosave, backup, restore, share, and import lives on this device.",highlights:[{icon:"",title:"Lock in power, safety, and backups",body:"Model draw, runtime, changeovers, and redundant pack coverage so battery safety margins are confirmed before rolling."},{icon:"",title:"AutoGear builds reusable kits",body:"Generate full kit lists from shooting scenarios with AutoGear rules, adjust those rules for the day, and reuse the presets."},{icon:"",title:"Project requirements ready to hand off",body:"Track requirements, crew coverage, and rental notes, then export PDF packets the crew, rental, and production rely on."},{icon:"",title:"Offline-first, subscription-free PWA",body:"Run the planner entirely offline, install it as a mobile PWA, and keep workflows available without subscriptions or servers."},{icon:"",title:"Data is sacred",body:"Autosave, backup/restore, share, and import safeguards protect every project snapshot. Restore rehearsals prove nothing is lost."}],languageLabel:"Language",languageHint:"Choose the interface language so this tour, the help center, and exports translate instantly across offline saves.",offlineSummary:"Cine Power Planner is built for field reliability: offline by default, installable on mobile, and always storing redundant saves locally so crews retain control of their data."}},userProfile:{title:"Complete your crew profile",body:"Set your display name, role, phone, email and photo. Each update syncs to Contacts immediately, stays in offline saves and appears on exports."},unitsPreferences:{title:"Tune theme and units",body:"Open Settings  General to choose the theme, optional pink highlights, focus scale and temperature units. Request persistent storage so the browser keeps preferences and safeguards saves during cleanups."},nameProject:{title:"Name your first project",body:"Give the project a descriptive name to anchor autosave, history, exports and backups. Every workflow references it so your offline library stays organized and easy to restore."},saveProject:{title:"Capture an immediate save",body:"Select Save (or press Ctrl+S/S/Enter) to capture a complete offline snapshotdevices, power math, requirements, notes and diagnostics. The next workflow unlocks once the save finishes."},addCamera:{title:"Select the primary camera",body:"Choose the camera body you are planning. Offline search works inside the menu. That selection unlocks matching accessories, power draws and diagrams."},addMonitoring:{title:"Add monitors, wireless video and FIZ",body:"Pick onboard monitors, wireless transmitters and FIZ motors or controllers. Each selection feeds runtime math, diagrams and automatic gear rules so the generated kit reflects the full build."},selectBattery:{title:"Choose batteries",body:"Select the battery system that powers the rig. Runtime projections update immediately and the selection is stored with your offline project snapshots and backups."},resultsTotalDraw:{title:"Power Summary: Total draw",body:"Start your Power Summary review by confirming the Total Draw card and peak load so the demand math stays accurate before moving on to deeper checks."},resultsBatteryPacks:{title:"Power Summary: Battery runtimes",body:"Review each battery pack's projected runtime, all framed around a worst-case draw so most kits run longerhelping you know how many packs to bring, feel confident the rig won't demand constant swaps, and automatically pair the right batteries with each camera."},resultsChangeover:{title:"Power Summary: Changeovers",body:"Use the changeover card to review the category-by-category draw chart, see exactly which devices contribute the most load, and confirm every swap sequence keeps enough headroom. The breakdown ties each accessory to its watt draw so the next charged pack is staged for the hungriest circuit and the saved snapshot captures the latest handoff plan."},resultsWarnings:{title:"Power Summary: Warnings and backups",body:"Check the connector warning boxes: green shows the pin or D-Tap battery feed is safe, yellow means the feed is near its limit, and red means the rig is pulling more than that line can supply. Change out batteries and devices to get both boxes to appear green again. Rest assured the warnings keep you from pushing higher loads than a battery can safely handle."},batteryComparison:{title:"Battery Comparison",body:"Battery Comparison evaluates alternate packs side by side so you can lock in the safest runtime margin. The table shows which batteries can power the riggreen pins and D-Tap feeds are safe, orange pins-only outputs cover the rig without D-Tap supportand how long each pack runs."},runtimeFeedback:{title:"Submit runtime feedback",body:"Use the runtime feedback button to log real-world results. Entries sync with the current project, strengthen future estimates and remain available offline for audits."},connectionDiagram:{title:"Inspect the power diagram",body:"The interactive Power Diagram shows how power, video and control gear connect. Drag nodes to plan rig layout, double-click devices to open hover details, then save so the arrangement and annotations persist across exports and restores."},connectionDiagramDetails:{title:"Open device hover details",body:"Double-click any device node in the diagram to reveal its hover detail popup. Review draw notes, connector callouts and saved annotations, then close it to keep arranging the layout before saving."},editDeviceDataAdd:{title:"Add a device to the library",body:"Open Device Library, choose the correct category, enter the draw and connector details, then press Add. This stores the gear in the offline catalog so autosave, backups and shares all capture the new entry."},editDeviceDataReview:{title:"Review the device details",body:"Locate the device you just saved under Existing Devices and expand its details panel. Confirm the draw, outputs and compatibility information look right before relying on the data for runtime math or exports."},editDeviceDataEdit:{title:"Update and resave the device",body:"Use the Edit button on that entry, adjust specs or notes, and save again. This verifies the autosave timeline, backups and exports are refreshed with the latest numbers without risking any user data."},ownGearAccess:{title:"Open the Own Gear dialog",body:"Press the Own Gear button in the sidebar to launch your inventory dialog, then review the summary banner and your own gear list so you know where saved items, edit buttons and counts live. Finish by exploring the Add gear formitem search, quantity, notes, plus the Save and Reset controlsso you can add equipment instantly once the tour ends."},ownGearAddDevice:{title:"Add your first owned device",body:"Enter the item name, optional quantity and notes, then save. Owned gear is stored offline, included in backups and marked inside exports so teams instantly see what is available without duplicating requests."},projectRequirementsBrief:{title:"Capture the project brief",body:"Open the Production Requirements dialog from Generate Kit List and Production Requirements, then document production company, address, rental preferences, deliverables and schedule notes. These entries auto-fill rental-ready PDFs, stay cached offline and prepare the next sections."},projectRequirementsCrew:{title:"Map crew coverage and contacts",body:"Populate Crew, Prep, Shooting and Return rows with names, roles and coverage notes. Link saved Contacts, add emergency details and duplicate rows when multiple days share assignments so exports show who is on set and when."},projectRequirementsLogistics:{title:"Log lenses, rigging and monitoring plans",body:"Work through camera specs, the lens workflow, rigging scenarios, storage/media counts, matte box preferences and monitoring layouts. These entries feed automatic gear rules and storage math so the generated checklist reflects the full shoot plan."},generateGearAndRequirements:{title:"Save and rebuild the outputs",body:"Press OK inside the Production Requirements dialog to store every entry, regenerate the requirements summary and rebuild the categorized kit list. The planner snapshots the result with the active project so exports, backups and shares stay current."},autoGearRulesAccess:{title:"Open Automatic Gear Rules",body:"Go to Settings  Automatic Gear Rules to review automation controls. Opening the tab shows the presets, stock rules (including smart tripod logic that references your head/legs preference) and safety backups stored with your offline saves."},autoGearRulesEdit:{title:"Edit stock automatic gear rules",body:"Use the rules list to inspect factory additions. Select a stock rule to open it in the editor, adjust items or conditions, then save so the updated automation stays cached with backups and share bundles."},autoGearRulesCreate:{title:"Add a new automatic gear rule",body:"Press Add rule to create a custom automation. Name it, add conditions and required gear, then save. The planner runs new rules offline each time you regenerate the kit and includes them in exports, shares and backups."},projectRequirements:{title:"Refine production requirements boxes",body:"Review the regenerated Production Requirements summary beside the kit list. Confirm the brief, crew coverage and logistics boxes mirror the data you just saved, then rerun exports or backups so downstream teams get the updated context with every share."},gearList:{title:"Audit the generated kit list",body:"Check the categorized kit list for duplicates, counts and auto-added accessories. Edits save instantly, are included in share bundles and appear in printouts and PDFs."},exportImport:{title:"Export and import projects",body:"Use Export Project to download a JSON safety copy and Import Project to rehearse restores. Store exports on redundant media so no workstation loses data if a browser profile resets. Always keep the original export untouched so you can re-import even if a working copy gets edited."},overviewAndPrint:{title:"Generate overview, PDF and printouts",body:"Generate the project overview to access PDF, print and share-ready summaries. The dialog uses saved data only, so you can print or export even while fully offline."},help:{title:"Open the Help center",body:"The Help dialog includes searchable documentation, translation notes and onboarding references. Keep it pinned while workingarticles stay cached offline and update when new features arrive."},settingsGeneral:{title:"Revisit Settings  General",body:"Adjust language, typography, theme, pink mode, focus scale and other presentation options anytime. Preferences save locally, sync across projects and are bundled with backups."},settingsData:{title:"Monitor Data & Storage",body:"Use the Data & Storage tab to request persistent storage, watch save timestamps and launch quick safeguards. These controls verify that every project snapshot remains available offline."},settingsBackup:{title:"Maintain Backup & Restore",body:"The Backup & Restore tab manages full-app exports, restore rehearsals and diagnostics. Run backups before major changes, archive the files on external media and verify restores regularly."},completion:{title:"Tutorial complete",body:"You now know every safeguard. Keep saving often, export redundant backups and revisit any step from Help whenever you want a refresher. Cine Power Planner will keep protecting your data offline."}}},helpQuickStartChecklistTitle:"Quick start checklist",helpDataSafetyTitle:"Protect your work",helpRestoreDrillTitle:"Restore rehearsal drill",helpDataAuditTitle:"Monthly data health check",helpDataAuditStep1:"Open %1$s, switch to %2$s, then use %3$s under %4$s to capture a fresh full-app snapshot before auditing downloads.",helpDataAuditStep2:"Export each active project with %1$s, confirm each download opens without errors, and store the files in two separate locations.",helpDataAuditStep3:"While offline, reload using %1$s and confirm the %2$s stays visible while projects and help articles load from local storage. Test %3$s with one of the new exports to ensure share bundles restore without reconnecting.",helpDataAuditStep4:"Run %1$s with your latest backup, verify every project, device, and rule, then record the runtime guard output from %2$s in your verification log before closing the rehearsal without publishing changes.",helpDataAuditNote:"Log the results, capture a screenshot of Settings  Data & Storage with the latest autosave timestamp, and archive the console guard output with your backup rotation checklist so you always know which copies were verified offline.",helpRestoreDrillNote:"Log filenames, timestamps and verification results in your backup rotation checklist so every rehearsal documents a restorable copy.",helpSearchClear:"Clear search",helpSearchHelp:"Type keywords or alternate spellings to instantly filter help topics. Quick links update as you type and highlight the matching article when you press Enter. Press '/' or Ctrl+F (Cmd+F on Mac) to focus the search box when the help dialog is open (instead of the browser find), then press Tab to step through filtered quick links without leaving your project.",helpSearchClearHelp:"Clear the search box and show all help topics again.",helpQuickLinksHeading:"Jump to a topic",helpQuickLinksAriaLabel:"Help topics quick navigation",helpQuickLinksHelp:"Jump directly to any section of the help dialog. Buttons only show topics that match the current search.",helpQuickLinkButtonHelp:"Scroll to the %s section in the help dialog.",hoverHelpButtonLabel:"Hover for help",hoverHelpButtonHelp:"Activate hover help so moving the cursor over buttons, fields, dropdowns or headers reveals brief explanations. You can open Settings while hover help is active to explore preferences without leaving this mode. Hovered controls are outlined and the tooltip shows their title alongside any available details. Longer descriptions are automatically broken into readable steps or bullet lists when available. Keyboard shortcuts are displayed whenever they exist so you can learn faster ways to use each control. When a control doesn't have custom guidance, the planner fills in contextual descriptions automatically so every interface element explains itself.",hoverHelpExitHint:"Press Esc or click anywhere to exit hover help.",hoverHelpShortcutsHeading:"Shortcuts",hoverHelpFallbackGeneric:"Interactive control.",hoverHelpFallbackButton:"Button. Activate to perform this action.",hoverHelpFallbackToggleButton:"Toggle button. Activate to switch between on and off states.",hoverHelpFallbackMenuButton:"Menu button. Opens a menu with related options.",hoverHelpFallbackLink:"Link. Opens the referenced section without leaving the app.",hoverHelpFallbackSelect:"Dropdown list. Open to choose one of the available options.",hoverHelpFallbackTextInput:"Text field. Type to enter information and press Enter to confirm when needed.",hoverHelpFallbackNumberInput:"Number field. Type a value or use arrow keys to adjust the number.",hoverHelpFallbackTextarea:"Multiline text field. Type paragraphs or paste notes.",hoverHelpFallbackCheckbox:"Checkbox. Select to enable, deselect to disable.",hoverHelpFallbackRadio:"Radio option. Select exactly one choice from this group.",hoverHelpFallbackSwitch:"Switch control. Toggle between on and off.",hoverHelpFallbackSlider:"Slider. Drag or use arrow keys to set the value.",hoverHelpFallbackFileInput:"File picker. Browse your device for files to add.",hoverHelpFallbackColorInput:"Color picker. Choose a color value.",hoverHelpFallbackDetails:"Expandable details section. Activate to show or hide the extra content.",hoverHelpFallbackDialog:"Dialog. Remains on top until you close it. Complete or cancel before returning to the main planner.",hoverHelpFallbackTablist:"Tab list. Use arrow keys to move between tabs.",hoverHelpFallbackTab:"Tab. Activate to display its panel of settings.",hoverHelpFallbackMenu:"Menu. Use arrow keys to move through options and Enter to select.",hoverHelpFallbackProgress:"Progress indicator showing current completion.",hoverHelpFallbackStatus:"Status message that updates automatically.",hoverHelpFallbackAlert:"Important alert that may require your attention.",setupSelectHelp:"Pick a previously saved configuration or select '-- New Project --' to start from scratch.",setupNameHelp:"Enter a descriptive name for the current project so you can recognize it later.",deleteSetupHelp:"Remove the highlighted saved project permanently from your browser.",saveSetupHelp:"Capture a full snapshot of the current projectdevices, requirements, notes, runtime logs and diagram layoutand store it in your local library. The autosave status dot beside Project Name pulses while the write finishes, and the background auto-backup queue schedules the matching timestamped snapshot right after the save so redundancy stays current. Press Enter or Ctrl+S (S on Mac) for the same result; the Save button stays disabled until you enter a project name. Saving never overwrites other projects until you confirm the name, so your prior data remains protected.",generateOverviewHelp:"Rebuilds the print-ready summary for the selected saved project and opens the overview dialog so you can review power and connection details before printing when ready. Lens selections render with brand, mount, diameter, focus, weight, rod support and notes so exports cover spec-sensitive checkouts.",generateGearListHelp:"Build a categorized kit list that combines selected gear with production requirements. The list refreshes on every change, merges duplicate items with counts and auto-adds required cables, rigging, lens supports, matte box parts, battery counts with hotswap hardware, default monitors for each role and scenario-specific accessories. Entries are sorted alphabetically and include hover descriptions.",shareSetupHelp:"Download a JSON safety bundle of the current projectcovering custom gear, favorites, runtime feedback and devicesready to archive or share offline. Store the file with your redundant crew backups before closing the planner so every workstation can restore it without network access. The export leaves your current project unchanged, so nothing is lost while you create the share bundle.",applySharedLinkHelp:"Load the configuration from a JSON backup exported via Save & Share or Backup & Restore. Review the preview diff before applyingnothing overwrites your current project until you confirm Save, and the planner schedules a fresh auto-backup beforehand so you can roll back instantly. Unnamed imports are saved automatically under an -imported title so the data lands even when the bundle omitted a project name. The imported project remains local and offline-ready immediately after you save.",sharedLinkHelp:"Choose a project JSON exported from Save & Share or Backup & Restore. Keep the original file in your backups after importthe planner only reads a copy and logs the attempt in diagnostics for your records so you can audit every restore.",cameraSelectHelp:"Choose the camera body that anchors your rig.",monitorSelectHelp:"Choose an on-board or wireless monitor to include.",videoSelectHelp:"Choose a transmitter/receiver pair or other wireless video link.",cageSelectHelp:"Choose a camera cage for mounting accessories.",distanceSelectHelp:"Choose an optional distance or range-finder sensor.",batterySelectHelp:"Choose the battery model that will power the entire rig.",batteryPlateSelectHelp:"Choose the battery plate or adapter that connects the battery to the camera.",batteryHotswapSelectHelp:"Select the hot-swap buffer that keeps power during battery changes.",runtimeFeedbackBtnHelp:"Open a form where you can submit real-world runtime data for this configuration.",zoomOutHelp:"Zoom out of the project diagram to view more of the layout.",zoomInHelp:"Zoom in on the project diagram for a closer look at connections.",downloadDiagramHelp:"Download the Power Diagram as an SVG or JPG image.",gridSnapToggleHelp:"Turn grid snapping on or off to help align items in the diagram.",resetViewBtn:"Reset View",resetViewHelp:"Reset zoom and pan to their defaults.",toggleDeviceManagerHelp:"Open the editor where you can add, modify, export or import device data.",hideDeviceManagerHelp:"Close the device database editor and return to normal mode.",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",diagramHoverNotice:"Double click for details",diagramDetailBackLabel:"Back",diagramDetailDefaultHeading:"Diagram details",diagramMoveHint:"Drag nodes to rearrange; drag empty space to pan.",v2:{dashboard:{projects:"Projects",newProject:"New Project",projectLocked:"The project '{projectName}' is already open in another tab.",emptyState:{title:"No Projects Yet",subtitle:"Create your first power plan to get started.",help:"Need help getting started?",archiveTitle:"No Archived Projects",archiveSubtitle:"Projects you archive will appear here."},search:{noResults:{title:"No Results",subtitle:'No projects match "{query}"'}},projectTile:{prep:"Prep:",shoot:"Shoot:",return:"Return:",openProject:"Open Project",renameAndEdit:"Rename & Edit",moreOptions:"More options",actionsFor:"Actions for {project}"},contextMenu:{open:"Open Project",rename:"Rename & Edit",duplicate:"Duplicate",archive:"Archive",unarchive:"Restore",delete:"Delete",print:"Print",pdf:"Export PDF"},status:{draft:"Draft",planning:"Planning",waitingForApproval:"Waiting for Approval",approved:"Approved",shooting:"Shooting",completed:"Completed",archived:"Archived"}},sidebar:{nav:{allProjects:"All Projects",activeProjects:"Active Projects",archive:"Archive",autoBackups:"Auto Backups",deviceLibrary:"Device Library",contacts:"Contacts",autoGearRules:"Auto Gear Rules",ownedGear:"Owned Gear",createProject:"Create New Project",projectsSection:"Projects",toolsSection:"Tools",supportSection:"Support",help:"Help",settings:"Settings"},search:{placeholder:"Search features..."}},detail:{backButton:"Back to Projects",header:{export:"Export Project",print:"Print / Export PDF",generateReqs:"Reqs & Gear",generateOverview:"Generate Overview",save:"Save"},tabs:{cameraPackage:"Camera Package",powerSummary:"Power Summary",requirements:"Requirements",gearList:"Gear List"},actions:{projectRequirements:"Project Requirements",generateRequirements:"Generate Requirements",generateRequirementsHelp:'Click "Generate Requirements" to create your production report.',gearList:"Gear List",generateGearList:"Generate Gear List",generateGearListHelp:'Click "Generate Gear List" to create your equipment list.'},diagram:{zoomIn:"Zoom In",zoomOut:"Zoom Out",resetView:"Reset View",download:"Download Diagram"}}}},categoryNames:{cameras:"Camera",viewfinders:"Viewfinder",monitors:"Monitor",video:"Wireless Transmitter","fiz.motors":"FIZ Motor","fiz.controllers":"FIZ Controller","fiz.distance":"FIZ Distance",batteries:"Battery",batteryHotswaps:"Battery Hotswap",wirelessReceivers:"Wireless Receiver","accessories.batteries":"Accessory Battery","accessories.cables":"Cable","accessories.cages":"Camera Cage","accessories.cameraSupport":"Camera Support","accessories.chargers":"Charger",cages:"Camera Cage",chargers:"Charger",directorMonitors:"Director Monitor",iosVideo:"iOS Video",videoAssist:"Video Assist",media:"Recording Media","accessories.cardReaders":"Card Reader",cardReaders:"Card Reader",lenses:"Lens",filterOptions:"Filter Option",other:"Other"},gearItems:{"Tennis ball":"Tennis ball","Clapper Stick":"Clapper Stick"}},Ka="en",dw={de:()=>BS(()=>import("./de-pvgUBqlH.js"),[]),es:()=>BS(()=>import("./es-eujsHFI_.js"),[]),fr:()=>BS(()=>import("./fr-Dpl-mot0.js"),[]),it:()=>BS(()=>import("./it-EA9DKM11.js"),[])},eh=new Set(["en"]),hi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};hi.texts=hi.texts||{};hi.categoryNames=hi.categoryNames||{};hi.gearItems=hi.gearItems||{};function Ph(e){if(Array.isArray(e))return e.map(t=>Ph(t));if(e&&typeof e=="object"){const t={};return Object.keys(e).forEach(r=>{t[r]=Ph(e[r])}),t}return e}function Bh(e,t=new WeakMap){if(!e||typeof e!="object"||t.has(e))return e;t.set(e,!0),Array.isArray(e)?e.forEach(r=>Bh(r,t)):Object.values(e).forEach(r=>Bh(r,t));try{Object.isFrozen(e)||Object.freeze(e)}catch{}return e}function XI(e,t){const r=Array.isArray(e)?"array":e===null?"null":typeof e,n=Array.isArray(t)?"array":t===null?"null":typeof t;if(r==="array"){if(n!=="array")return Ph(e);const o=e.length,a=new Array(o);for(let i=0;i<o;i++){const s=e[i],l=i<t.length?t[i]:void 0;a[i]=XI(s,l)}return a}if(r==="object"){if(n!=="object")return Ph(e);const o=t&&typeof t=="object"?t:{};return Object.keys(e||{}).forEach(i=>{const s=e[i],l=Object.prototype.hasOwnProperty.call(o,i)?o[i]:void 0;o[i]=XI(s,l)}),Object.keys(o).forEach(i=>{Object.prototype.hasOwnProperty.call(e,i)||delete o[i]}),o}return n===r&&typeof t<"u"?t:Ph(e)}function Ax(e,t){const r={};return Object.keys(e||{}).forEach(o=>{const a=e[o],i=t&&Object.prototype.hasOwnProperty.call(t,o)?t[o]:void 0;r[o]=XI(a,i)}),r}function WK(e,t){if(!e||!t)return;const r=t.texts||{},n=t.categoryNames||{},o=t.gearItems||{};let a=hi.texts[Ka]?{texts:hi.texts[Ka],categoryNames:hi.categoryNames[Ka],gearItems:hi.gearItems[Ka]}:null;e===Ka&&(Bh(r),Bh(n),Bh(o),a={texts:r,categoryNames:n,gearItems:o});const i=a||{texts:{},categoryNames:{},gearItems:{}},s=e===Ka?i.texts:Ax(i.texts,r),l=e===Ka?i.categoryNames:Ax(i.categoryNames,n),c=e===Ka?i.gearItems:Ax(i.gearItems,o);hi.texts[e]=s,hi.categoryNames[e]=l,hi.gearItems[e]=c}function lre(e){if(typeof e!="string")return Ka;const t=e.trim();if(!t)return Ka;const r=t.toLowerCase();if(dw[r])return r;const n=r.split("-")[0];return dw[n]?n:Ka}async function eM(e){if(eh.has(e))return;const t=lre(e);if(!(t===Ka&&eh.has(Ka))&&dw[t])try{const r=await dw[t]();WK(t,r.data),eh.add(t),eh.add(e)}catch(r){console.error(`Failed to load locale: ${t}`,r)}}WK(Ka,sre);eh.add(Ka);hi.__cineTranslationsLoader__={loadLanguage:eM};const cre={loadLanguage:eM},ure=Object.freeze(Object.defineProperty({__proto__:null,default:cre,loadLanguage:eM},Symbol.toStringTag,{value:"Module"}));function YK(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}var Be=YK;const _H=(function(){return typeof globalThis<"u"&&typeof globalThis.deriveProjectInfo=="function"?globalThis.deriveProjectInfo:typeof window<"u"&&typeof window.deriveProjectInfo=="function"?window.deriveProjectInfo:typeof global<"u"&&typeof global.deriveProjectInfo=="function"?global.deriveProjectInfo:function(r){return r||{}}})(),DH=Ex&&typeof Ex.normalizeVideoDistributionOptionValue=="function"?Ex.normalizeVideoDistributionOptionValue:function(t){if(typeof t!="string")return"";const r=t.trim();if(!r)return"";const n=r.toLowerCase();return n==="__none__"||n==="none"?"__none__":r},pw=Gr||{},bE=ure||{};if(bE&&typeof bE.loadLanguage=="function"){const e=typeof currentLang=="string"&&currentLang||typeof DEFAULT_LANGUAGE_SAFE=="string"&&DEFAULT_LANGUAGE_SAFE||bE.defaultLanguage||"en";try{const t=bE.loadLanguage(e);t&&typeof t.then=="function"&&t.catch(r=>{console.warn("Failed to prepare translations for setups module",r)})}catch(t){console.warn("Could not prepare translations runtime for setups module",t)}}Be=typeof pw.escapeHtml=="function"?pw.escapeHtml:YK;const bi=(function(){if(typeof pw.setButtonLabelWithIcon=="function")return pw.setButtonLabelWithIcon;const t=[];try{typeof CORE_GLOBAL_SCOPE=="object"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE.setButtonLabelWithIcon=="function"&&t.push(CORE_GLOBAL_SCOPE.setButtonLabelWithIcon)}catch{}return typeof globalThis<"u"&&globalThis&&typeof globalThis.setButtonLabelWithIcon=="function"&&t.push(globalThis.setButtonLabelWithIcon),typeof window<"u"&&window&&typeof window.setButtonLabelWithIcon=="function"&&t.push(window.setButtonLabelWithIcon),typeof self<"u"&&self&&typeof self.setButtonLabelWithIcon=="function"&&t.push(self.setButtonLabelWithIcon),typeof global<"u"&&global&&typeof global.setButtonLabelWithIcon=="function"&&t.push(global.setButtonLabelWithIcon),t.length>0?t[0]:function(n,o){if(n)try{n.textContent=typeof o=="string"?o:""}catch{}}})(),NH=typeof globalThis<"u"&&globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN?globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN:"__any__";function fre(e){const t=[],r=n=>{!n||typeof n!="object"&&typeof n!="function"||t.includes(n)||t.push(n)};try{r(typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null)}catch{}try{r(typeof globalThis<"u"?globalThis:null)}catch{}try{r(typeof window<"u"?window:null)}catch{}try{r(typeof self<"u"?self:null)}catch{}try{r(typeof global<"u"?global:null)}catch{}for(let n=0;n<t.length;n+=1){const o=t[n];try{const a=o[e];if(typeof a=="function")return a}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to resolve runtime function from scope",e,a)}}return null}function uS(e=""){const t=fre("getCurrentProjectName");if(typeof t!="function")return e;try{const r=t();return typeof r=="string"&&r.trim()?r:e}catch(r){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("safeGetCurrentProjectName failed, falling back to default",r),e}}const Tb=["A","B","C","D","E"],FH="cameraPowerPlanner_cameraColors",dre=["ARRI K2.0019797 HEX-3","ARRI K2.0023751 B-Mount Battery Adapter","ARRI K2.74000.0 VEB-3 Viewfinder Extension Bracket","ARRI KK.0037820 Handle Extension Set",'SHAPE Telescopic Handle ARRI Rosette Kit 12"'];let hy=null;function pre(){return hy instanceof Set&&hy.size?hy:typeof normalizeGearNameForComparison!="function"?new Set:(hy=new Set(dre.map(e=>normalizeGearNameForComparison(e))),hy)}function mre(e){if(!e||typeof normalizeGearNameForComparison!="function")return"";const t=fn(e),r=normalizeGearNameForComparison(t);return pre().has(r)?t:""}const Ju=["productionCompanyAddress","productionCompanyStreet","productionCompanyStreet2","productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode","productionCompanyCountry"],gre={productionCompany:["Production Company","Produktionsfirma","Socit de production","Productora","Casa di produzione"],productionCompanyAddress:["Production Company Address","Adresse der Produktionsfirma","Adresse de la socit de production","Direccin de la productora","Indirizzo della casa di produzione"],productionCompanyStreet:["Street address","Strae und Hausnummer","Adresse","Direccin","Indirizzo"],productionCompanyStreet2:["Address line 2","Adresszusatz","Complment d'adresse","Lnea 2 de direccin","Seconda linea indirizzo"],productionCompanyCity:["City","Stadt","Ville","Ciudad","Citt"],productionCompanyRegion:["State / Province / Region","Bundesland / Region","tat / Rgion / Dpartement","Estado / Provincia / Regin","Regione / Provincia / Stato"],productionCompanyPostalCode:["Postal code","Postleitzahl","Code postal","Cdigo postal","CAP"],productionCompanyCountry:["Country","Land","Pays","Pas","Paese"]};function tM(e){return typeof e!="string"?"":e.trim().replace(/[:]\s*$/,"").trim()}function QK(e){const t=typeof texts<"u"?texts:null,r={},n=t&&t.en&&t.en.projectFields||{};return["productionCompany"].concat(Ju).forEach(a=>{const i=new Set,s=c=>{if(typeof c!="string")return;const u=tM(c);u&&i.add(u)};e&&e[a]&&s(e[a]),n&&n[a]&&s(n[a]);const l=gre[a];Array.isArray(l)&&l.forEach(s),r[a]=i}),r}function jH(e,t){if(!e||typeof e!="object")return[];const r=e[t];if(r==null)return[];if(Array.isArray(r)){const n=[];return r.forEach(o=>{if(o==null)return;(typeof o=="string"?o:String(o)).split(/\r?\n/).forEach(i=>{const s=i.trim();s&&n.push(s)})}),n}return typeof r=="string"?r.split(/\r?\n/).map(n=>n.trim()).filter(n=>n):[String(r)].map(n=>n.trim()).filter(n=>n)}function yre(e,t){const r=[],n=[],o=QK(t),a=new Set;Object.values(o).forEach(d=>{d&&d.forEach(p=>{typeof p=="string"&&p&&a.add(p)})});const i=d=>typeof d!="string"||!d.trim()?!1:a.has(tM(d)),s=(d,p,h)=>{if(typeof d!="string")return;const m=d.trim();if(!m)return;const g=Be(m),S=Array.isArray(h)?h.filter(E=>typeof E=="string"&&E.trim()):[],y=S.length?` data-fields="${Be(S.join(" "))}"`:"";r.push(p?`<span class="${p}"${y}>${g}</span>`:g),n.push(m)};typeof texts<"u"&&texts;const l={entries:[],indexMap:new Map},c=(d,p)=>{if(typeof d!="string")return;const h=d.trim();if(!h||i(h))return;const m=h.toLowerCase();let g=l.indexMap.get(m);g||(g={value:h,fields:[]},l.entries.push(g),l.indexMap.set(m,g)),typeof p=="string"&&Ju.includes(p)&&!g.fields.includes(p)&&g.fields.push(p)};jH(e,"productionCompany").forEach(d=>s(d,"req-primary-line")),Ju.forEach(d=>{const p=jH(e,d);p.length&&p.forEach(h=>c(h,d))});const{entries:f}=l;if(f.length){const d=new Set(["productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode"]),p={productionCompanyCity:[],productionCompanyRegion:[],productionCompanyPostalCode:[]},h=[];let m=null;f.forEach(I=>{const{value:C,fields:k}=I;(Array.isArray(k)?k.some(w=>d.has(w)):!1)?(m===null&&(m=h.length),k.forEach(w=>{d.has(w)&&p[w].push(C)})):h.push(I)});const g=I=>{if(!Array.isArray(I))return"";const C=I.find(k=>typeof k=="string"&&k.trim());return C?C.trim():""},S=g(p.productionCompanyCity),y=g(p.productionCompanyRegion),E=g(p.productionCompanyPostalCode),L=[],v=[];S&&(L.push(S),v.push("productionCompanyCity"));const A=[];if(y&&(A.push(y),v.push("productionCompanyRegion")),E&&(A.push(E),v.push("productionCompanyPostalCode")),A.length){const I=A.join(", ");L.push(I)}const R=L.join(", ").trim();if(R){const I=R.toLowerCase();if(!h.some(k=>{const _=typeof k.value=="string"?k.value.trim():"";return _&&_.toLowerCase()===I})){const k=m===null?h.length:m;h.splice(k,0,{value:R,fields:v})}}h.forEach(I=>{const{value:C,fields:k}=I;s(C,"req-sub-line",k)})}return r.length?{__html:r.join("<br>"),text:n.join(`
`)}:null}function HH(e,t,r){if(!e||typeof e!="object")return!1;const o=yre(t&&typeof t=="object"?t:e,r);return o?(e.productionCompany=o,Ju.forEach(a=>{Object.prototype.hasOwnProperty.call(e,a)&&delete e[a]}),!0):!1}function hre(e,t,r){if(typeof e!="string")return null;const n=e.replace(/\r\n?/g,`
`).split(`
`).map(f=>f.trim()).filter(f=>f);if(!n.length)return null;const o=QK(t),a={},[i,...s]=n;i&&(a.productionCompany=i);const l=Array.isArray(r?.lines)?r.lines:null;if(l&&l.length){const f={};if(l.forEach(d=>{if(!d||typeof d.text!="string")return;const p=d.text.trim();if(!p)return;let h=d.fields;typeof h=="string"&&(h=h.split(/\s+/)),!(!Array.isArray(h)||!h.length)&&h.map(m=>typeof m=="string"?m.trim():"").filter(m=>m&&Ju.includes(m)).forEach(m=>{f[m]||(f[m]=[]),f[m].push(p)})}),Object.keys(f).length){if(f.productionCompanyAddress&&f.productionCompanyAddress.length&&(a.productionCompanyAddress=f.productionCompanyAddress.join(`
`)),f.productionCompanyStreet&&f.productionCompanyStreet.length){const p=f.productionCompanyStreet;if([a.productionCompanyStreet]=p,p.length>1){const h=p.slice(1).join(`
`);h&&(a.productionCompanyStreet2=h)}}if(f.productionCompanyStreet2&&f.productionCompanyStreet2.length){const p=f.productionCompanyStreet2.join(`
`);p&&(a.productionCompanyStreet2=a.productionCompanyStreet2?`${a.productionCompanyStreet2}
${p}`:p)}const d=p=>{if(!f[p]||!f[p].length)return;const h=f[p].join(" ");h&&(a[p]=h)};return["productionCompanyCity","productionCompanyRegion","productionCompanyPostalCode","productionCompanyCountry"].forEach(d),a}}const c={};let u=null;if(s.forEach(f=>{const d=tM(f);let p=null;if(Ju.forEach(h=>{p||!o[h]||o[h].has(d)&&(p=h)}),p){u=p,c[u]||(c[u]=[]);return}if(!u){a.productionCompany?a.productionCompany+=`
${f}`:a.productionCompany=f;return}c[u]||(c[u]=[]),c[u].push(f)}),c.productionCompanyAddress&&c.productionCompanyAddress.length&&(a.productionCompanyAddress=c.productionCompanyAddress.join(`
`)),c.productionCompanyStreet&&c.productionCompanyStreet.length){const f=c.productionCompanyStreet;a.productionCompanyStreet=f[0],f.length>1&&(a.productionCompanyStreet2=f.slice(1).join(`
`))}return c.productionCompanyCity&&c.productionCompanyCity.length&&(a.productionCompanyCity=c.productionCompanyCity.join(" ")),c.productionCompanyRegion&&c.productionCompanyRegion.length&&(a.productionCompanyRegion=c.productionCompanyRegion.join(" ")),c.productionCompanyPostalCode&&c.productionCompanyPostalCode.length&&(a.productionCompanyPostalCode=c.productionCompanyPostalCode.join(" ")),c.productionCompanyCountry&&c.productionCompanyCountry.length&&(a.productionCompanyCountry=c.productionCompanyCountry.join(" ")),a}const Nf="temporary-extras",Ks=typeof Object.freeze=="function"?Object.freeze:e=>e;let GA=null,JI=!0;function bre(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function UH(e,t){if(!e||!t)return e;const r=new RegExp(`^${bre(t)}\\s+`,"i");return e.replace(r,"").trim()}function Sre(e){if(!e)return!1;const t=e.trim();return t?!!(/^T\d+/i.test(t)||/^f\//i.test(t)||/\d/.test(t)&&(/(?:mm|cm|m||ft)$/i.test(t)||/^\d+(?:\.\d+)?x$/i.test(t)||/^\d+-\d+/.test(t))):!1}function vre(e,t){return e&&typeof e.brand=="string"&&e.brand.trim()?e.brand.trim():(typeof t=="string"?t.trim().split(/\s+/)[0]:"")||"Other"}function Ere(e,t){if(typeof e!="string"||!e.trim())return"General";let r=e.trim();if(t&&r.toLowerCase().startsWith(t.toLowerCase())&&(r=r.slice(t.length).trim()),!r)return"General";const n=r.split(/\s+/),o=[];for(let i=0;i<n.length;i+=1){const s=n[i];if(Sre(s))break;o.push(s)}return o.join(" ").trim()||"General"}function Are(e,t,r){const n=UH(e||"",t||"");return UH(n,r||"").trim()}function Cre(...e){for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r!="string")continue;const o=r.toLowerCase().indexOf("mm"),i=(o===-1?r:r.slice(0,o)).match(/\d+(?:\.\d+)?/g);if(i&&i.length){const s=i.map(l=>Number(l)).filter(Number.isFinite);if(s.length)return Math.min(...s)}}return Number.POSITIVE_INFINITY}function XK(e,t){const r=vre(t,e),n=Ere(e,r),o=Are(e,r,n),a=Cre(o,e);return{manufacturer:r,series:n,focalLabel:o,focalSortKey:a}}function Ys(e,t){const r=typeof e=="string"?e:"",n=typeof t=="string"?t:"";return typeof localeSort=="function"?localeSort(r,n):r.localeCompare(n,void 0,{sensitivity:"base"})}const Vu=(()=>{const e=typeof document<"u"?document:null,t={snapshot(){return{names:[],lensSelections:[],legacyValue:""}},applyInfo(){},refreshCatalog(){},getSelections(){return[]}};if(!e)return t;const r=e.getElementById("lensManufacturer"),n=e.getElementById("lensSeries"),o=e.getElementById("lensManufacturerStep"),a=e.getElementById("lensSeriesStep"),i=e.getElementById("lensOptionsStep"),s=e.getElementById("lensOptions"),l=e.getElementById("lensOptionsEmpty"),c=e.getElementById("lensSeriesEmpty"),u=e.getElementById("lensSelectionChips"),f=e.getElementById("lensSelectionsValue"),d=e.getElementById("lensSelectionsData"),p=e.getElementById("lenses"),h=e.getElementById("lensManufacturerPlaceholder"),m=e.getElementById("lensSeriesPlaceholder");if(!r||!n||!s||!u||!f||!d||!p)return t;const g="data-remove-template",S="data-mount-label",y="lens-step-disabled",E=new Set(["LDS"]),L=new Map([["B4","B4"],["DJI DL","DJI DL"],["DJI DL-S","DJI DL-S"],["DL","DJI DL"],["E","E-mount"],["E-mount","E-mount"],["Sony E","E-mount"],["EF","EF"],["F","F"],["Hasselblad","Hasselblad"],["L","L-Mount"],["L-Mount","L-Mount"],["Leica L","L-Mount"],["Leica M","Leica M"],["Leitz M Mount for ARRI","Leica M"],["M","Leica M"],["MFT","MFT"],["PL","PL"],["PV","PV"],["PV70","PV70"],["RF","RF"],["X","X-mount"],["X-mount","X-mount"],["XPL52","XPL52"],["Z","Z-mount"],["Z-mount","Z-mount"]]),v=typeof localeSort=="function"?localeSort:void 0,A={manufacturer:"",series:"",selections:[]};let R={manufacturers:new Map,lensIndex:new Map};const I=new Map,C=Y=>{const ee=R.lensIndex.get(Y);if(!ee||typeof ee!="object")return[];const Ae=new Map,ve=[],se=(ye,$e="native")=>{const xe=typeof ye=="string"?ye.trim():"";if(!xe)return;const St=typeof $e=="string"&&$e.trim().toLowerCase()==="adapted"?"adapted":"native";if(Ae.has(xe)){const xt=Ae.get(xe);xt&&xt.status!=="native"&&St==="native"&&(xt.status="native");return}const Tt={type:xe,status:St};Ae.set(xe,Tt),ve.push(xe)},de=(ye,$e="native")=>{if(!ye)return;const xe=w(ye);if(Array.isArray(xe)&&xe.length){xe.forEach(St=>se(St,$e));return}se(ye,$e)},be=ee?.data?.mountOptions;return Array.isArray(be)&&be.length&&be.forEach(ye=>{if(!ye)return;const $e=typeof ye.mount=="string"&&ye.mount.trim().toLowerCase()==="adapted"?"adapted":"native";de(ye.type,$e)}),!ve.length&&Array.isArray(ee.mountLabels)&&ee.mountLabels.length&&ee.mountLabels.forEach(ye=>se(ye,"native")),ve.length||de(ee?.data?.mount,"native"),ve.map(ye=>Ae.get(ye)).filter(ye=>ye&&ye.type)},k=Y=>C(Y).map(ee=>ee.type),_=(Y,ee)=>{Y&&(ee?Y.classList.add("select-placeholder"):Y.classList.remove("select-placeholder"))},w=Y=>{const ee=[],Ae=new Set,ve=de=>{!de||Ae.has(de)||(Ae.add(de),ee.push(de))},se=de=>{if(!de||typeof de!="string")return;de.replace(/\([^)]*\)/g," ").replace(/ or /gi,"/").replace(/\\/g,"/").split("/").forEach(ye=>{ye.split(",").forEach($e=>{const xe=$e.trim();if(!xe||E.has(xe))return;const St=L.has(xe)?L.get(xe):xe;St&&ve(St)})})};return Array.isArray(Y)?Y.forEach(de=>se(de)):se(Y),ee},x=()=>{const Y=typeof devices=="object"&&devices&&devices.lenses&&Object.keys(devices.lenses).length?devices.lenses:null;return Y||(typeof devices=="object"&&devices&&devices.accessories&&devices.accessories.lenses?devices.accessories.lenses:{})},G=()=>{const Y=x(),ee=new Map,Ae=new Map,ve=Object.keys(Y||{});return ve.length&&v?ve.sort(v):ve.sort(),ve.forEach(se=>{const de=Y[se]||{},be=XK(se,de),{manufacturer:ye,series:$e,focalLabel:xe,focalSortKey:St}=be,Tt=w(de.mount),xt={name:se,data:de,manufacturer:ye,series:$e,displayName:se,focalLabel:xe,focalSortKey:St,mountLabels:Tt,optionMeta:Tt[0]?`Mount: ${Tt[0]}`:""};ee.has(ye)||ee.set(ye,new Map);const ut=ee.get(ye);ut.has($e)||ut.set($e,[]),ut.get($e).push(xt),Ae.set(se,xt)}),ee.forEach(se=>{se.forEach(de=>{!Array.isArray(de)||!de.length||de.sort((be,ye)=>{const $e=Number.isFinite(be.focalSortKey),xe=Number.isFinite(ye.focalSortKey);return $e&&xe&&be.focalSortKey!==ye.focalSortKey?be.focalSortKey-ye.focalSortKey:$e!==xe?$e?-1:1:be.focalLabel&&ye.focalLabel&&be.focalLabel!==ye.focalLabel?Ys(be.focalLabel,ye.focalLabel):Ys(be.displayName,ye.displayName)})})}),{manufacturers:ee,lensIndex:Ae}},T=Y=>!Y||typeof Y.type!="string"?"":w(Y.type)[0]||"",P=()=>{const Y=e.getElementById("cameraSelect"),ee=Y&&typeof Y.value=="string"?Y.value:"";if(!ee||typeof devices!="object"||!devices||!devices.cameras)return[];const Ae=devices.cameras[ee];if(!Ae||!Array.isArray(Ae.lensMount))return[];const ve=new Map,se=[];return Ae.lensMount.forEach(de=>{if(!de)return;const be=T(de);if(!be)return;const ye=typeof de.mount=="string"&&de.mount.trim().toLowerCase()==="adapted"?"adapted":"native";if(ve.has(be)){const xe=ve.get(be);xe&&xe.status!=="native"&&ye==="native"&&(xe.status="native");return}const $e={type:be,status:ye};ve.set(be,$e),se.push(be)}),se.map(de=>ve.get(de)).filter(de=>de&&de.type)},N=(Y,ee)=>{const Ae=[],ve=new Set,se=$e=>{if(!$e)return;const xe=$e.trim();!xe||ve.has(xe)||(ve.add(xe),Ae.push(xe))};k(ee).forEach(se);const be=typeof Y=="string"?Y.trim():"",ye=be&&ve.has(be);return{options:Ae,hiddenValue:ye?"":be}},q=(Y,ee="")=>{const Ae=C(Y),ve=Ae.map(xe=>xe.type),se=P(),de=xe=>{if(!xe)return"";const St=se.find(xt=>xt.type===xe&&xt.status==="native")||se.find(xt=>xt.type===xe);if(St)return St.status;const Tt=Ae.find(xt=>xt.type===xe);return Tt?Tt.status:""},be=typeof ee=="string"?ee.trim():"";if(be&&ve.includes(be))return{mount:be,status:de(be)};const ye=se.find(xe=>xe.status==="native"&&ve.includes(xe.type));if(ye)return{mount:ye.type,status:de(ye.type)};const $e=se.find(xe=>xe.status==="adapted"&&ve.includes(xe.type));if($e)return{mount:$e.type,status:de($e.type)};if(Ae.length){const xe=Ae[0].type,St=de(xe),Tt=se.length>0,xt=se.some(Er=>Er.type===xe);let ut=St;return(!xt&&Tt||!ut&&Tt)&&(ut="adapted"),{mount:xe,status:ut}}return{mount:"",status:""}},Z=Y=>typeof Y!="string"?"":Y.trim(),U=()=>{const Y=!!A.manufacturer,ee=!!A.series;o&&o.classList.toggle(y,!1),a&&(a.classList.toggle(y,!Y),a.setAttribute("aria-disabled",Y?"false":"true")),i&&(i.classList.toggle(y,!ee),i.setAttribute("aria-disabled",ee?"false":"true")),n.disabled=!Y,_(n,!A.series),_(r,!A.manufacturer)},K=()=>{const Y=new Set(A.selections.map(ee=>ee.name));Array.from(p.options||[]).forEach(ee=>{!ee||typeof ee.value!="string"||(ee.selected=Y.has(ee.value))})},H=({skipEvent:Y=!1,skipDirty:ee=!1}={})=>{const ve=A.selections.map(ye=>ye.name).join(", "),se=JSON.stringify(A.selections.map(ye=>{const $e={name:ye.name,mount:ye.mount||""};return ye.mountState&&($e.mountState=ye.mountState),$e})),de=f.value!==ve,be=d.value!==se;if(de&&(f.value=ve),be&&(d.value=se),!Y&&(de||be))try{f.dispatchEvent(new Event("change",{bubbles:!0})),d.dispatchEvent(new Event("change",{bubbles:!0}))}catch{}if(!ee&&(de||be))try{Ms()}catch{}K()},te=({skipEvent:Y=!1,skipDirty:ee=!1}={})=>{if(u.innerHTML="",!A.selections.length){H({skipEvent:Y,skipDirty:ee});return}const Ae=u.getAttribute(g)||"",ve=u.getAttribute(S)||"Mount";A.selections.forEach((se,de)=>{const be=R.lensIndex.get(se.name),ye=be?be.displayName:se.name,$e=be&&be.focalLabel?be.focalLabel:"",xe=e.createElement("div");xe.className="lens-chip",xe.setAttribute("role","listitem");const St=e.createElement("div");St.className="lens-chip-label";const Tt=e.createElement("span");if(Tt.className="lens-chip-name",Tt.textContent=ye,St.appendChild(Tt),$e){const De=e.createElement("span");De.className="lens-chip-focal",De.textContent=$e,St.appendChild(De)}xe.appendChild(St);const xt=`lensMount-${de}`,ut=e.createElement("div"),Er=e.createElement("label");Er.className="visually-hidden",Er.setAttribute("for",xt),Er.textContent=`${ve}: ${ye}`,ut.appendChild(Er);const zt=e.createElement("select");zt.id=xt,zt.dataset.lensName=se.name;const dr=typeof se.mount=="string"?se.mount.trim():"",Jt=q(se.name,dr);se.mount!==Jt.mount&&(se.mount=Jt.mount),Jt.status?se.mountState=Jt.status:se.mountState&&delete se.mountState;const{options:rr,hiddenValue:Jn}=N(dr,se.name);if(rr.forEach(De=>{const vt=e.createElement("option");vt.value=De;const j=q(se.name,De).status;vt.textContent=j==="adapted"?`${De} (adapted)`:De,j&&(vt.dataset.mountState=j),se.mount===De&&(vt.selected=!0),zt.appendChild(vt)}),Jn){const De=e.createElement("option");De.value=Jn,De.textContent=Jn,De.hidden=!0,De.disabled=!0,zt.appendChild(De)}if(se.mount&&(zt.value=se.mount),!se.mount&&rr.length){zt.value=rr[0],se.mount=zt.value;const De=q(se.name,se.mount);De.status?se.mountState=De.status:se.mountState&&delete se.mountState}zt.setAttribute("aria-label",`${ve}: ${ye}`),zt.addEventListener("change",De=>{const vt=De.target.dataset.lensName,Yt=typeof De.target.value=="string"?De.target.value:"",j=A.selections.find(Q=>Q.name===vt);if(!j)return;const O=q(vt,Yt),D=O.mount,F=O.status,z=j.mountState||"",J=(F||"")!==z;j.mount===D&&!J||(j.mount=D,F?j.mountState=F:j.mountState&&delete j.mountState,De.target.value!==D&&(De.target.value=D||""),H())}),ut.appendChild(zt),xe.appendChild(ut);const nr=e.createElement("button");nr.type="button",nr.className="lens-chip-remove",nr.dataset.lensName=se.name;const $n=Ae.includes("{lens}")?Ae.replace("{lens}",ye):Ae||ye;nr.setAttribute("aria-label",$n),nr.setAttribute("title",$n),typeof iconMarkup=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.circleX?nr.innerHTML=iconMarkup(ICON_GLYPHS.circleX,"btn-icon"):nr.textContent="",nr.addEventListener("click",()=>{Ie(se.name,{focus:!0})}),xe.appendChild(nr),u.appendChild(xe)}),H({skipEvent:Y,skipDirty:ee})},re=()=>{if(s.innerHTML="",I.clear(),!A.series){l&&(l.hidden=!0);return}const Y=R.manufacturers.get(A.manufacturer),ee=Y?Y.get(A.series):null;if(!ee||!ee.length){l&&(l.hidden=!1);return}l&&(l.hidden=!0);const Ae=e.createElement("div");Ae.className="lens-options-header";const ve=e.createElement("span");ve.textContent=`${ee.length} items`,Ae.appendChild(ve);const se=e.createElement("label");se.className="lens-set-toggle";const de=e.createElement("input");de.type="checkbox";const be=ee.filter(xe=>A.selections.some(St=>St.name===xe.name)).length,ye=ee.length>0&&be===ee.length,$e=be>0&&!ye;de.checked=ye,de.indeterminate=$e,de.addEventListener("change",xe=>{fe(ee,xe.target.checked)}),se.appendChild(de),se.appendChild(e.createTextNode("Select Full Set")),Ae.appendChild(se),s.appendChild(Ae),ee.forEach((xe,St)=>{const Tt=e.createElement("div");Tt.className="lens-option";const xt=`lensOption-${St}`,ut=e.createElement("input");ut.type="checkbox",ut.id=xt,ut.dataset.lensName=xe.name,ut.checked=A.selections.some(dr=>dr.name===xe.name),ut.addEventListener("change",dr=>{const Jt=!!dr.target.checked;Ne(xe.name,Jt)}),Tt.appendChild(ut);const Er=e.createElement("label");Er.className="lens-option-label",Er.setAttribute("for",xt);const zt=e.createElement("span");if(zt.className="lens-option-name",zt.textContent=xe.displayName,Er.appendChild(zt),xe.optionMeta){const dr=e.createElement("span");dr.className="lens-option-meta",dr.textContent=xe.optionMeta,Er.appendChild(dr)}Tt.appendChild(Er),s.appendChild(Tt),I.set(xe.name,ut)})},fe=(Y,ee)=>{if(!Array.isArray(Y)||!Y.length)return;let Ae=!1;const ve=new Set(Y.map(se=>se.name));if(ee)Y.forEach(se=>{if(!A.selections.some(de=>de.name===se.name)){const de=q(se.name),be={name:se.name,mount:de.mount};de.status&&(be.mountState=de.status),A.selections.push(be),Ae=!0}});else{const se=A.selections.length;A.selections=A.selections.filter(de=>!ve.has(de.name)),A.selections.length!==se&&(Ae=!0)}Ae&&(te(),re())},Oe=()=>{n.innerHTML="",n.appendChild(m);const Y=A.manufacturer?R.manufacturers.get(A.manufacturer):null;if(!Y||Y.size===0){A.series="",c&&(c.hidden=!A.manufacturer),l&&(l.hidden=!0),m.selected=!0,U();return}const ee=Array.from(Y.keys());if(!ee.length){A.series="",c&&(c.hidden=!1),l&&(l.hidden=!0),m.selected=!0,U();return}c&&(c.hidden=!0),v?ee.sort(v):ee.sort(),ee.forEach(Ae=>{const ve=e.createElement("option");ve.value=Ae,ve.textContent=Ae,A.series===Ae&&(ve.selected=!0),n.appendChild(ve)}),Y.has(A.series)?n.value=A.series:(A.series="",m.selected=!0),U()},Te=()=>{r.innerHTML="",r.appendChild(h);const Y=Array.from(R.manufacturers.keys());Y.length&&(v?Y.sort(v):Y.sort(),Y.forEach(ee=>{const Ae=e.createElement("option");Ae.value=ee,Ae.textContent=ee,A.manufacturer===ee&&(Ae.selected=!0),r.appendChild(Ae)})),R.manufacturers.has(A.manufacturer)?r.value=A.manufacturer:(A.manufacturer="",h.selected=!0),U()},Ne=(Y,ee)=>{if(ee){if(A.selections.some(se=>se.name===Y))return;const Ae=q(Y),ve={name:Y,mount:Ae.mount};Ae.status&&(ve.mountState=Ae.status),A.selections.push(ve),te()}else Ie(Y)},Ie=(Y,{focus:ee=!1,skipEvent:Ae=!1,skipDirty:ve=!1}={})=>{const se=A.selections.findIndex(be=>be.name===Y);if(se===-1)return;A.selections.splice(se,1);const de=I.get(Y);de&&(de.checked=!1,ee&&de.focus()),te({skipEvent:Ae,skipDirty:ve})},et=()=>{const Y=Z(r.value);Y!==A.manufacturer&&(A.manufacturer=Y,A.series="",Te(),Oe(),re())},Ze=()=>{const Y=Z(n.value);Y!==A.series&&(A.series=Y,Oe(),re())},Ft=(Y={})=>{R=G();const ee=new Set(R.lensIndex.keys()),Ae=[],ve=new Set;if(Array.isArray(Y.lensSelections)&&Y.lensSelections.forEach(se=>{if(!se||typeof se!="object")return;const de=Z(se.name);if(!de||ve.has(de)||!ee.has(de))return;const be=typeof se.mount=="string"?se.mount.trim():"",ye=typeof se.mountState=="string"?se.mountState.trim():"";Ae.push({name:de,mount:be,mountState:ye}),ve.add(de)}),Ae.length||Ob(Y.lenses).forEach(se=>{const de=Z(se);!de||ve.has(de)||!ee.has(de)||(Ae.push({name:de,mount:""}),ve.add(de))}),A.selections=Ae.map(se=>{const de=typeof se.mount=="string"?se.mount.trim():"",be=q(se.name,de),ye={name:se.name,mount:be.mount},$e=be.status||(typeof se.mountState=="string"?se.mountState.trim():"");return $e&&(ye.mountState=$e),ye}),A.selections.length){const se=R.lensIndex.get(A.selections[0].name);A.manufacturer=se?se.manufacturer:"",A.series=se?se.series:""}else A.manufacturer="",A.series="";Te(),Oe(),re(),te({skipEvent:!0,skipDirty:!0})},Ye=()=>({names:A.selections.map(Y=>Y.name),lensSelections:A.selections.map(Y=>({name:Y.name,mount:Y.mount||"",...Y.mountState?{mountState:Y.mountState}:{}})),legacyValue:A.selections.map(Y=>Y.name).join(", ")}),ct=({preserveSelections:Y=!0,skipEvent:ee=!1,skipDirty:Ae=!1}={})=>{const ve=Y?A.selections.map(ye=>({...ye})):[],se=Y?A.manufacturer:"",de=Y?A.series:"";R=G();const be=new Set(R.lensIndex.keys());if(A.selections=Y?ve.filter(ye=>be.has(ye.name)):[],A.manufacturer=Y&&R.manufacturers.has(se)?se:"",A.manufacturer){const ye=R.manufacturers.get(A.manufacturer);A.series=ye&&ye.has(de)?de:""}else A.series="";Te(),Oe(),re(),te({skipEvent:ee||Y,skipDirty:Ae||Y})};return r.addEventListener("change",et),n.addEventListener("change",Ze),R=G(),Te(),Oe(),re(),te({skipEvent:!0,skipDirty:!0}),{snapshot:Ye,applyInfo:Ft,refreshCatalog:ct,getSelections(){return A.selections.map(Y=>({...Y}))}}})();typeof globalThis<"u"&&globalThis&&(typeof globalThis.updateLensWorkflowCatalog!="function"&&(globalThis.updateLensWorkflowCatalog=function(t){try{Vu.refreshCatalog(t||{preserveSelections:!0,skipEvent:!0,skipDirty:!0})}catch{}}),globalThis.lensSelectionManager||(globalThis.lensSelectionManager=Vu));function Ob(e){return Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():"").filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim()).filter(Boolean):[]}function Ms(){JI=!0,GA=null}const Yc=(()=>{function e(r){if(!r)return"";const n=rs(),o=n&&typeof n.texts=="object"&&n.texts||typeof texts=="object"&&texts||null;if(!o)return"";const a=n&&typeof n.currentLang=="string"&&typeof o[n.currentLang]=="object"?n.currentLang:null,i=typeof currentLang=="string"&&typeof o[currentLang]=="object"?currentLang:null,s=a||i||"en",l=typeof o[s]=="object"&&o[s]||{},c=Object.prototype.hasOwnProperty.call(l,r)?l[r]:void 0;if(typeof c=="string")return c;const u=typeof o.en=="object"&&o.en||{},f=Object.prototype.hasOwnProperty.call(u,r)?u[r]:void 0;return typeof f=="string"?f:""}let t=!1;return function r(n){const o=rs(),a=o&&typeof o.getLocalizedText=="function"&&o.getLocalizedText!==r?o.getLocalizedText:null;if(a)try{const i=a(n);if(typeof i=="string")return i}catch(i){!t&&typeof console<"u"&&typeof console.warn=="function"&&(console.warn("getLocalizedText fallback used after global failure",i),t=!0)}return e(n)}})(),Cx=rs();Cx&&typeof Cx.getLocalizedText!="function"&&(Cx.getLocalizedText=Yc);const wre="rentalHouseOptions";function Lre(){const e=[];if(typeof require=="function")try{const r=require("../data/rental-houses.js");Array.isArray(r)&&r.length?e.push(r):r&&Array.isArray(r.rentalHouses)&&r.rentalHouses.length?e.push(r.rentalHouses):r&&Array.isArray(r.default)&&r.default.length&&e.push(r.default)}catch(r){const n=r&&r.message?r.message:"";if(r&&r.code!=="MODULE_NOT_FOUND"&&!/Cannot find module/i.test(n))try{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to load rental house catalog module",r)}catch{}}const t=rs();if(t){const r=t.devices;r&&Array.isArray(r.rentalHouses)&&r.rentalHouses.length&&e.push(r.rentalHouses),Array.isArray(t.rentalHouses)&&t.rentalHouses.length&&e.push(t.rentalHouses)}typeof devices<"u"&&devices&&Array.isArray(devices.rentalHouses)&&devices.rentalHouses.length&&e.push(devices.rentalHouses);for(let r=0;r<e.length;r+=1){const n=e[r];if(Array.isArray(n)&&n.length)return n.slice()}return[]}const zH=50;let SE=null;function JK(e){return!!e&&Array.isArray(e.catalog)&&Array.isArray(e.searchIndex)&&e.lookup&&typeof e.lookup=="object"&&typeof e.signature=="string"}function Rre(e){if(!e)return;const t=rs();if(t){try{t.__cineRentalHouseRuntime=e}catch{}if(!Array.isArray(t.__cineRentalHouseCatalog))try{t.__cineRentalHouseCatalog=e.catalog}catch{}try{t.__cineRentalHouseSearchIndex=e.searchIndex}catch{}try{t.__cineRentalHouseLookup=e.lookup}catch{}try{t.__cineRentalHouseSignature=e.signature}catch{}}}function Tre(){const e=rs();if(e)try{const a=e.__cineRentalHouseRuntime;if(JK(a))return a}catch{}let t=[];if(e)try{const a=e.__cineRentalHouseCatalog;Array.isArray(a)&&a.length&&(t=a.slice())}catch{}t.length||(t=Lre());const r=t.map(a=>{if(!a||typeof a!="object")return null;const i=a.name?String(a.name).trim():"";if(!i)return null;const s=xb(i);if(!s)return null;const l=tW(a),c=Bm(i),u=Bm(l),f=Bm([a.city,a.country,a.address,a.phone,a.email].map(p=>p?String(p).trim():"").filter(Boolean).join(" ")),d=[c,u,f].filter(Boolean).join(" ");return{entry:a,name:i,key:s,location:l,normalizedName:c,normalizedLocation:u,searchKey:d}}).filter(Boolean),n=r.map(a=>`${a.key}|${a.location}`).join("||"),o=Object.create(null);return t.forEach(a=>{if(!a||typeof a!="object")return;const i=xb(a.name);i&&!o[i]&&(o[i]=a)}),{catalog:t,searchIndex:r,signature:n,lookup:o}}function fS(){return JK(SE)||(SE=Tre(),Rre(SE)),SE}function Bm(e){if(!e)return"";let t=String(e);try{typeof t.normalize=="function"&&(t=t.normalize("NFD"))}catch{}return t.replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[\u2012\u2013\u2014\u2015]/g,"-").replace(/[^a-z0-9]+/g," ").replace(/\s+/g," ").trim()}function xb(e){return e?String(e).trim().replace(/[\u2012\u2013\u2014\u2015]/g,"-").toLowerCase():""}const Ore=new Set(["AG","BV","BVBA","CO","GMBH","INC","KG","LLC","LTD","PLC","PTY","SAS","SARL","SL","SPA","S.P.A","SRL"]);function xre(e){if(!e)return"";const t=typeof e=="object"&&e&&typeof e.shortName=="string"?e.shortName.trim():"";if(t)return t;const r=typeof e=="string"?e:e&&e.name,n=r?String(r).trim():"";if(!n)return"";let o=n.replace(/\s*\([^)]*\)\s*/g," ").replace(/\s+/g," ").trim();const a=o.match(/\s*[\u2012\u2013\u2014\u2015-]\s*/);if(a){const s=o.indexOf(a[0]);s>0&&(o=o.slice(0,s).trim())}o||(o=n.trim());const i=o.match(/\b[A-Z]{2,5}\b/g);if(i&&i.length)for(let s=0;s<i.length;s+=1){const l=i[s];if(!Ore.has(l))return l==="ARRI"?"Arri":l}return/^arri\b/i.test(o)?"Arri":/^ludwig\s+kamera/i.test(o)?"Kamera Ludwig":o.trim()}function kre(e={}){const t=e.input||eR();if(e.preferInput!==!1&&t&&typeof t.value=="string"){const a=t.value.trim();if(a)return a}if(typeof e.rentalHouse=="string"&&e.rentalHouse.trim())return e.rentalHouse.trim();let r=null;const n=rs();if(n&&typeof n.getCurrentProjectInfo=="function")try{r=n.getCurrentProjectInfo()}catch{}const o=r&&typeof r=="object"&&typeof r.rentalHouse=="string"?r.rentalHouse.trim():"";return o||(e.preferInput===!1&&t&&typeof t.value=="string"?t.value.trim():"")}function ZK(e={}){const t=typeof e.fallback=="string"?e.fallback:"",r=typeof e.rentalHouse=="string"&&e.rentalHouse.trim()?e.rentalHouse.trim():kre({input:e.input});if(!r)return t;let n=null;if(r){const a=fS(),i=a&&a.lookup;n=i?i[xb(r)]:null}const o=xre(n||r);return o||t||r}let $H=null;function eW(e={}){const t=Mg(e),r=t.noteLabel&&t.noteLabel.trim()?t.noteLabel.trim():"";if($H===r)return r;$H=r;const n=typeof document<"u"?document:null,o=[];if(typeof gearListOutput<"u"&&gearListOutput&&o.push(gearListOutput),typeof projectRequirementsOutput<"u"&&projectRequirementsOutput&&o.push(projectRequirementsOutput),n&&o.push(n),o.length){const i=".gear-item[data-rental-note], .gear-custom-item[data-rental-note]";o.forEach(s=>{!s||typeof s.querySelectorAll!="function"||s.querySelectorAll(i).forEach(l=>{!l||typeof l.setAttribute!="function"||(r?l.getAttribute("data-rental-note")!==r&&l.setAttribute("data-rental-note",r):typeof l.removeAttribute=="function"&&l.removeAttribute("data-rental-note"))})})}let a=null;if(typeof _a=="function")try{a=_a()}catch(i){if(!i||i.name!=="ReferenceError")throw i}return a&&a.rentalDescription&&(a.rentalDescription.textContent=r,a.rentalDescription.hidden=!r,a.rentalCheckbox&&(r?a.rentalCheckbox.setAttribute("aria-describedby",a.rentalDescription.id):a.rentalCheckbox.removeAttribute("aria-describedby"))),r}function tW(e){const t=[],r=e&&e.city?String(e.city).trim():"",n=e&&e.country?String(e.country).trim():"";return r&&t.push(r),n&&t.push(n),t.join(", ")}function Ire(e){if(!e||typeof e!="object")return"";const t=[],r=tW(e),n=e.address?String(e.address).trim():"",o=e.phone?String(e.phone).trim():"",a=e.email?String(e.email).trim():"";return r&&t.push(r),n&&t.push(n),o&&t.push(o),a&&t.push(a),t.join("  ")}function Pre(e){const t=typeof e=="string"?e.trim():"";if(!t)return null;const r=fS(),n=r&&r.lookup,o=xb(t);if(n&&o&&n[o])return n[o];const a=Bm(t);if(!a||!r||!Array.isArray(r.searchIndex))return null;const i=r.searchIndex.find(s=>s&&s.normalizedName===a);return i?i.entry:null}function eR(){return typeof document>"u"?null:document.getElementById("rentalHouse")}function Bre(e){if(!e||typeof document>"u")return null;let t=e.getAttribute("list");t||(t=wre,e.setAttribute("list",t));let r=t?document.getElementById(t):null;return r||(r=document.createElement("datalist"),r.id=t,e.insertAdjacentElement("afterend",r)),r}function Gre(e,t){if(!t)return 0;if(!e)return Number.POSITIVE_INFINITY;const{normalizedName:r,normalizedLocation:n,searchKey:o}=e;if(!o||o.indexOf(t)===-1)return Number.POSITIVE_INFINITY;const a=r?r.indexOf(t):-1,i=n?n.indexOf(t):-1;if(a===0)return 0;if(i===0)return 100;if(a>0)return 200+a;if(i>0)return 400+i;const s=o.indexOf(t);return 800+(s>=0?s:0)}function VH(e){const t=fS(),r=t&&Array.isArray(t.searchIndex)?t.searchIndex:[],n=Bm(e);if(!r.length)return[];if(!n)return r.slice().sort((a,i)=>a.name.localeCompare(i.name)).slice(0,zH);const o=[];return r.forEach(a=>{const i=Gre(a,n);Number.isFinite(i)&&o.push({info:a,score:i})}),o.sort((a,i)=>a.score!==i.score?a.score-i.score:a.info.name.localeCompare(i.info.name)),o.slice(0,zH).map(a=>a.info)}function MA(e=eR()){const t=fS(),r=t&&Array.isArray(t.searchIndex)?t.searchIndex:[];if(!e||!r.length)return;const n=Bre(e);if(!n)return;const o=typeof e.value=="string"?e.value:"",a=Bm(o),s=`${t&&typeof t.signature=="string"?t.signature:""}::${a}`;if(n.__rentalHouseSignature===s)return;const l=document.createDocumentFragment(),c=new Set,u=VH(o);(u.length?u:VH("")).forEach(d=>{if(!d||c.has(d.key))return;const p=document.createElement("option");p.value=d.name,d.location&&(p.label=d.location),p.textContent=d.name,l.appendChild(p),c.add(d.key)}),n.innerHTML="",n.appendChild(l),n.__rentalHouseSignature=s}function th(e=eR()){if(!e)return;const t=typeof e.value=="string"?e.value.trim():"";let r=null;if(t){const n=fS(),o=n&&n.lookup;r=o?o[xb(t)]:null}if(r){const n=Ire(r);n?(e.title=n,e.setAttribute("data-help",n)):(e.removeAttribute("title"),e.removeAttribute("data-help"))}else e.removeAttribute("title"),e.removeAttribute("data-help");eW({input:e,rentalHouse:t})}const ps=eR();ps&&(th(ps),ps.addEventListener("input",()=>{MA(ps),th(ps)}),ps.addEventListener("change",()=>{MA(ps),th(ps)}),ps.addEventListener("blur",()=>th(ps)),ps.addEventListener("focus",()=>MA(ps)));function _A(e){return typeof e=="string"?e.trim():e==null?"":String(e)}function rs(){return typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null}function Mre(e){if(typeof structuredClone=="function")return structuredClone;if(e&&typeof e.structuredClone=="function")try{return e.structuredClone.bind(e)}catch{}if(typeof require=="function"){try{const t=require("node:util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}try{const t=require("util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}}return null}function qH(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function _re(e){const t=Mre(e);return t?function(n){if(n===null||typeof n!="object")return n;try{return t(n)}catch{}return qH(n)}:qH}const KH=(()=>{const e=rs();return e&&typeof e.__cineDeepClone=="function"?e.__cineDeepClone:_re(e)})();function ZI(e){const t=typeof e=="string"?e:"",r={projectHtml:"",gearHtml:t},n=rs(),o=typeof splitGearListHtml=="function"?splitGearListHtml:n&&typeof n.splitGearListHtml=="function"?n.splitGearListHtml:null;if(!o)return r;try{const a=o(t);if(!a||typeof a!="object")return r;const i=typeof a.projectHtml=="string"?a.projectHtml:"",s=typeof a.gearHtml=="string"?a.gearHtml:i?"":t;return{projectHtml:i,gearHtml:s}}catch(a){return console.warn("Failed to split gear list HTML",a),r}}function Ct(e,t){const r=typeof document<"u"?document:null;if(r&&typeof r.getElementById=="function"){const o=r.getElementById(e);if(o)return o}const n=rs();if(n&&t&&typeof n=="object")try{const o=n[t];if(o)return o}catch{}return null}function Dre(){const e=rs(),t=[];if(typeof cineGearList=="object"&&cineGearList&&t.push(cineGearList),e&&typeof e.cineGearList=="object"&&e.cineGearList&&(t.includes(e.cineGearList)||t.push(e.cineGearList)),typeof require=="function")try{const r=require("./modules/gear-list.js");r&&typeof r=="object"&&!t.includes(r)&&t.push(r)}catch{}for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n.setImplementation!="function"))return n}return null}function Nre(){const e=Dre(),t={getSafeGearListHtmlSections:ZI,generateGearListHtml:uP,getCurrentGearListHtml:Ew};if(e&&typeof e.setImplementation=="function")try{return e.setImplementation(t,{source:"app-setups"}),!0}catch(n){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Unable to register gear list implementation with cineGearList.",n)}const r=rs();if(r&&typeof r=="object"){try{r.getSafeGearListHtmlSections=ZI}catch{}try{r.generateGearListHtml=uP}catch{}try{r.getCurrentGearListHtml=Ew}catch{}}return!1}Nre();function Fre(){return{dialog:Ct("shareDialog","shareDialog"),form:Ct("shareForm","shareForm"),filenameInput:Ct("shareFilename","shareFilenameInput"),filenameMessage:Ct("shareFilenameMessage","shareFilenameMessage"),linkMessage:Ct("shareLinkMessage","shareLinkMessage"),includeAutoGearCheckbox:Ct("shareIncludeAutoGear","shareIncludeAutoGearCheckbox"),includeAutoGearLabel:Ct("shareIncludeAutoGearLabel","shareIncludeAutoGearLabelElem"),includeOwnedGearCheckbox:Ct("shareIncludeOwnedGear","shareIncludeOwnedGearCheckbox"),includeOwnedGearLabel:Ct("shareIncludeOwnedGearLabel","shareIncludeOwnedGearLabelElem"),cancelButton:Ct("shareCancelBtn","shareCancelBtn"),sharedLinkInput:Ct("sharedLinkInput","sharedLinkInput"),applySharedLinkButton:Ct("applySharedLinkBtn","applySharedLinkBtn")}}function jre(){return{dialog:Ct("sharedImportDialog","sharedImportDialog"),form:Ct("sharedImportForm","sharedImportForm"),modeSelect:Ct("sharedImportModeSelect","sharedImportModeSelect"),cancelButton:Ct("sharedImportCancelBtn","sharedImportCancelBtn")}}let wx=null,Lx=null,vd=null;function tu(e){return e&&typeof e=="object"&&e.context&&typeof e.context=="object"?e.context:(wx||(wx=Fre()),wx)}function rW(e){return Lx||(Lx=jre()),Lx}function pg(e){if(e==null)return e;if(Array.isArray(e))return e.map(t=>pg(t));if(Object.prototype.toString.call(e)==="[object Object]"){const t={};return Object.keys(e).forEach(r=>{t[r]=pg(e[r])}),t}return e}function Hre(){if(currentProjectInfo)return pg(currentProjectInfo);if(projectForm)try{return pg(dS())}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to read current project form data before opening dialog",e)}return{}}function Ure(){if(!projectForm){vd=null;return}try{const e=dS();vd=pg(e)}catch(e){vd=null,typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to capture project dialog snapshot",e)}}function zre(e){projectForm?(rR(e&&typeof e=="object"?e:{}),Ure()):vd=null,openDialog(projectDialog)}function nW(){projectForm&&(vd&&typeof vd=="object"?rR(pg(vd)):projectForm.reset())}function oW(e,t=[],r={}){if(typeof callCoreFunctionIfAvailable=="function")return callCoreFunctionIfAvailable(e,t,r);const n=(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null)||null,o=typeof e=="string"?n&&n[e]:e;if(typeof o=="function"){try{return o.apply(n,t)}catch(a){typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,a)}return}if(r&&r.defer===!0){const a=n&&Array.isArray(n.CORE_BOOT_QUEUE)?n.CORE_BOOT_QUEUE:null;a&&a.push(()=>{oW(e,t,{...r,defer:!1})})}return r&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}function mg(e,t={}){const r=Object.prototype.hasOwnProperty.call(t,"defaultValue")?t.defaultValue:"",n=oW(e,[],{defaultValue:r});if(typeof n=="string")return n;if(n==null)return r;try{return String(n)}catch{return r}}function $re(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!e||typeof e!="object")return null;try{const t=e.cineUi;return t&&typeof t=="object"?t:null}catch{return null}}function ms(e,t){if(!e||typeof e!="object")return!1;if(typeof e.get=="function")try{return!!e.get(t)}catch{}if(typeof e.list=="function")try{const r=e.list();return Array.isArray(r)&&r.indexOf(t)!==-1}catch{}return!1}function Rx(e,t,r){if(!(!e||typeof e.register!="function"))for(let n=0;n<t.length;n+=1){const o=t[n];if(!(!o||typeof o.name!="string")&&!ms(e,o.name))try{e.register(o.name,o.value)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn(r,a)}}}function aW(e){if(!e||typeof e!="object")return!1;const t=e.controllers,r=e.interactions,n=e.help;return ms(t,"shareDialog")&&ms(t,"sharedImportDialog")&&ms(r,"shareOpen")&&ms(r,"shareSubmit")&&ms(r,"shareCancel")&&ms(r,"shareApplyFile")&&ms(r,"shareInputChange")&&ms(r,"sharedImportSubmit")&&ms(r,"sharedImportCancel")&&ms(n,"shareProject")&&ms(n,"sharedImport")}let WH=aW($re());function Vre(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof e!="function")return;try{const n=t.cineUi&&typeof t.cineUi=="object"?t.cineUi:null;if(n){e(n);return}}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("cineUi registration callback (setups) failed",n);return}const r="__cineUiReadyQueue";Array.isArray(t[r])||(t[r]=[]),t[r].push(e)}function iW(){if(!batterySelect&&!batteryPlateSelect&&!hotswapSelect)return null;const e=batterySelect?_A(batterySelect.value):"",t=batteryPlateSelect?_A(batteryPlateSelect.value):"",r=hotswapSelect?_A(hotswapSelect.value):"",o={batteryPlate:(typeof normalizeBatteryPlateValue=="function"?normalizeBatteryPlateValue(t,e):t)||"",battery:e||"",batteryHotswap:r||""};return!o.batteryPlate&&!o.battery&&!o.batteryHotswap?null:o}function rM(e){if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=t.replace(/,/g,"."),n=parseFloat(r);return Number.isFinite(n)?n:null}return null}function qre(e,t){if(typeof t!="function")return;const r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;let n=null;if(r){try{typeof r.cineEnsureDeferredScriptsLoaded=="function"&&(n=r.cineEnsureDeferredScriptsLoaded({reason:e}))}catch{}if(!n)try{n=r.cineDeferredScriptsReady}catch{}}if(!n||typeof n.then!="function"){t();return}n.then(()=>{t()}).catch(o=>{typeof console<"u"&&typeof console.error=="function"&&console.error("Deferred scripts failed to load before generating an overview.",o),t()})}const YH=typeof generateOverviewBtn<"u"?generateOverviewBtn:document.getElementById("generateOverviewBtn");YH&&YH.addEventListener("click",()=>{const e=typeof setupSelect<"u"?setupSelect:document.getElementById("setupSelect");if(!e||!e.value){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].alertSelectSetupForOverviewTitle||"No Project Selected",message:texts[currentLang].alertSelectSetupForOverview}):alert(texts[currentLang].alertSelectSetupForOverview);return}qre("overview-dialog",()=>{typeof generatePrintableOverview=="function"?generatePrintableOverview():typeof console<"u"&&typeof console.error=="function"&&console.error("generatePrintableOverview is unavailable after deferred loading.")})});function sW(){const e=batterySelect&&batterySelect.value;if(!e||e==="None"||!(devices&&devices.batteries&&devices.batteries[e]))return!0;const t=devices&&devices.batteries?devices.batteries[e]:null,r=parseFloat(totalCurrent12Elem.textContent);if(!isFinite(r))return!0;const n=rM(t.pinA);return!Number.isFinite(n)||n<=0?!0:r<=n}function lW(){const e=batterySelect&&batterySelect.value;if(!e||e==="None"||!(devices&&devices.batteries&&devices.batteries[e]))return;const t=devices&&devices.batteries?devices.batteries[e]:null,r=parseFloat(totalCurrent12Elem.textContent),n=rM(t.pinA);if(!Number.isFinite(n)||n<=0)return;const o=texts[currentLang].warnPinExceeded.replace("{current}",r.toFixed(2)).replace("{max}",String(n));typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang].warnPinExceededTitle||"Current Limit Exceeded",message:o}):alert(o)}const QH=typeof generateGearListBtn<"u"?generateGearListBtn:document.getElementById("generateGearListBtn");QH&&QH.addEventListener("click",()=>{const e=typeof setupSelect<"u"?setupSelect:document.getElementById("setupSelect");if(!e||!e.value){typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:texts[currentLang]&&texts[currentLang].alertSelectSetupForOverviewTitle||"No Project Selected",message:texts[currentLang].alertSelectSetupForOverview}):alert(texts[currentLang].alertSelectSetupForOverview);return}if(!sW()){lW();return}const t=Hre();t&&typeof t=="object"&&(populateRecordingResolutionDropdown(t.recordingResolution),populateSensorModeDropdown(t.sensorMode),populateCodecDropdown(t.codec)),zre(t)});const XH=typeof deleteGearListProjectBtn<"u"?deleteGearListProjectBtn:document.getElementById("deleteGearListProjectBtn");XH&&XH.addEventListener("click",()=>{Cw()});const gg=typeof projectCancelBtn<"u"?projectCancelBtn:null;gg&&gg.addEventListener("click",()=>{nW(),closeDialog(projectDialog)});function Kre(){if(!projectForm||!projectDialog)return;const e=typeof projectDialog.open=="boolean"?projectDialog.open:null,t=typeof projectDialog.hasAttribute=="function"?projectDialog.hasAttribute("open"):!1;if(!(e===null?t:e||t))return;const n=projectDialog.querySelector('[type="submit"]');if(typeof projectForm.requestSubmit=="function")try{n?projectForm.requestSubmit(n):projectForm.requestSubmit();return}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Project dialog backdrop submit failed to use requestSubmit",a)}const o=new Event("submit",{bubbles:!0,cancelable:!0});projectForm.dispatchEvent(o)}const JH=typeof projectDialogCloseBtn<"u"?projectDialogCloseBtn:document.getElementById("projectDialogClose");JH&&JH.addEventListener("click",()=>{gg?gg.click():closeDialog(projectDialog)});const by=typeof projectDialog<"u"?projectDialog:document.getElementById("projectDialog");by&&(by.addEventListener("cancel",e=>{e&&e.preventDefault(),gg?gg.click():(nW(),closeDialog(by))}),by.addEventListener("click",e=>{e.target===by&&(e.preventDefault(),e.stopPropagation(),Kre())}));const Tx=typeof projectForm<"u"?projectForm:document.getElementById("projectForm");Tx&&(Tx.addEventListener("input",()=>{Ms()}),Tx.addEventListener("submit",e=>{if(e.preventDefault(),!sW()){lW();return}const t=Yoe(),r=dS();currentProjectInfo=r,yne(r);const n=uP(r);displayGearAndRequirements(n),Qoe(t),Xoe(),Zoe(),eae(),tae(),rae(),nae(),oae(),saveCurrentSession(),scheduleProjectAutoSave(!0),closeDialog(projectDialog)}));function Wre(){if(typeof ACTIVE_APP_VERSION=="string"){const e=ACTIVE_APP_VERSION.trim();if(e)return e}if(typeof APP_VERSION=="string"){const e=APP_VERSION.trim();if(e)return e}return""}function Yre({includeAutoGear:e,hasAutoGearRules:t,includeOwnedGearMarks:r,hasOwnedGearMarkers:n}){const o={type:"camera-power-planner/project-bundle",includesAutoGearRules:!!(e&&t)};o.includesOwnedGearMarkers=!!(r&&n);const a=Wre();a&&(o.version=a);try{const i=new Date;Number.isNaN(i.valueOf())||(o.exportedAt=i.toISOString())}catch(i){console.warn("Unable to capture export timestamp for shared project metadata.",i)}return o.generator="Camera Power Planner",o}function ZH(e){const t=e||gearListOutput;return!t||typeof t.querySelector!="function"?!1:!!t.querySelector("[data-gear-own-gear-id]")}function Qre(e){const t=typeof getLocalizedText=="function"?getLocalizedText("gearListOwnedExportLabel"):"",r=texts?.en?.gearListOwnedExportLabel||"Owned by %s",n=t&&t.trim()?t:r;return n.includes("%s")?n.replace("%s",e):`${n} ${e}`.trim()}function Gg(e){if(!e||typeof e.getAttribute!="function")return"";const t=e.getAttribute("data-gear-name")||"",r=e.getAttribute("data-gear-label")||"",n=(t||r||"").trim(),o=(e.getAttribute("data-gear-attributes")||"").trim();if(!o)return n;if(!n)return o;const a=n.toLowerCase(),i=o.toLowerCase();return a.includes(i)?n:`${n} (${o})`}function Xre(e){const t=e||gearListOutput;if(!t||typeof t.querySelectorAll!="function")return[];const r=t.querySelectorAll("[data-gear-own-gear-id]"),n=[];return r.forEach(o=>{if(!o)return;const a=o.getAttribute("data-gear-own-gear-id");if(!a)return;const i=o.getAttribute("data-gear-provider")||"",s=o.getAttribute("data-gear-provider-label")||"",l=dW(i,{label:s}),c=(l.type==="user"?l.profileDisplayName||l.label||s||nM().user:l.type==="contact"?l.label||s:s||l.label||"").trim(),u={ownedId:a,providerValue:l.value||i,providerLabel:l.label||s,ownerDisplayName:c,ownerProfileName:l.profileName||"",ownerType:l.type||"",contactId:l.contactId||"",gearName:Gg(o)};n.push(u)}),n}function Jre(e,t,r={}){if(!e||!t||!t.length)return e;let n;try{n=document.implementation.createHTMLDocument("")}catch{}if(!n||!n.body)return e;n.body.innerHTML=e;const o=r.ownerLabelFallback||"Owned";return t.forEach(a=>{if(!a||!a.ownedId)return;const s=`[data-gear-own-gear-id="${typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(a.ownedId):a.ownedId.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"]`,l=n.body.querySelector(s);if(!l)return;a.ownerDisplayName?l.setAttribute("data-gear-owned-export-label",a.ownerDisplayName):l.removeAttribute("data-gear-owned-export-label"),l.querySelectorAll("[data-gear-owned-export]").forEach(g=>{g&&g.parentElement&&g.parentElement.removeChild(g)});const u=a.ownerDisplayName||o,f=Qre(u),d=n.createElement("span");d.className="gear-item-provider gear-item-owned-export",d.setAttribute("data-gear-owned-export","true"),d.textContent=f;const h=l.classList?.contains("gear-custom-item")&&l.querySelector(".gear-custom-item-summary")||l,m=h.querySelector(".gear-item-note");m&&m.parentElement===h?h.insertBefore(d,m):h.appendChild(d)}),n.body.innerHTML}function cW(e,t,r){if(!e)return;const n=tu(this),o=n.linkMessage,a=n.includeAutoGearCheckbox;n.includeAutoGearLabel;const i=uS(),s=T=>T&&typeof T.value=="string"?_A(T.value):"",l=s(batterySelect),c=s(batteryPlateSelect),u=s(hotswapSelect),f={setupName:i},d=(T,P)=>{if(P!=null)if(typeof P=="string"){const N=P.trim();if(!N||N==="None")return;f[T]=N}else if(Array.isArray(P)){const N=P.filter(q=>typeof q=="string"&&q.trim()&&q!=="None");N.length&&(f[T]=N)}else f[T]=P};d("camera",cameraSelect.value),d("monitor",monitorSelect.value),d("video",videoSelect.value),d("cage",cageSelect.value),Array.isArray(motorSelects)&&d("motors",motorSelects.map(T=>T.value)),Array.isArray(controllerSelects)&&d("controllers",controllerSelects.map(T=>T.value)),d("distance",distanceSelect.value),d("batteryPlate",normalizeBatteryPlateValue(c,l)),d("battery",l),d("batteryHotswap",u);const p=iW();if(p&&(f.powerSelection=p,f.battery=p.battery||"",f.batteryPlate=p.batteryPlate||"",f.batteryHotswap=p.batteryHotswap||""),typeof getDiagramManualPositions=="function"){const T=getDiagramManualPositions();T&&Object.keys(T).length&&(f.diagramPositions=T)}const h=[];if(currentProjectInfo&&h.push(currentProjectInfo),typeof loadProject=="function"){const T=new Set;if(typeof i=="string"&&i&&T.add(i),typeof getCurrentProjectStorageKey=="function"){const P=getCurrentProjectStorageKey({allowTyped:!0});typeof P=="string"&&P&&T.add(P)}if(typeof getSetupNameState=="function"){const P=getSetupNameState();P&&typeof P=="object"&&["storageKey","selectedName","typedName"].forEach(N=>{const q=typeof P[N]=="string"?P[N].trim():"";q&&T.add(q)})}T.forEach(P=>{if(!(typeof cineFeatureBackup<"u"&&typeof cineFeatureBackup.isAutoBackupName=="function"&&cineFeatureBackup.isAutoBackupName(P)))try{const N=loadProject(P);N&&N.projectInfo&&h.push(N.projectInfo)}catch(N){console.warn("Unable to read project info for export from storage key",P,N)}})}let m=null,g=null;if(h.forEach(T=>{T&&(m?m=WW(m,T):m=la(T))}),m){const T=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(m,{projectNameOverride:i}):m,P=la(T);P&&typeof P=="object"&&(g=P)}const S=KW(qW());Object.keys(S).length&&(f.gearSelectors=S);const y=r?Xre(gearListOutput):[],E=Ew();if(f.gearListAndProjectRequirementsGenerated=!!E,f.gearListAndProjectRequirementsGenerated){const{projectHtml:T,gearHtml:P}=ZI(E);if(T&&(f.projectHtml=T),P){const N=r&&y.length?Jre(P,y):P;f.gearList=N,r&&y.length&&(f.ownedGearMarkers=y.map(q=>({...q})))}}f.gearListAndProjectRequirementsGenerated&&g&&(f.projectInfo=g);const L=getCurrentSetupKey(),v=loadFeedbackSafe()[L]||[];v.length&&(f.feedback=v);const A=getAutoGearRules(),R=Array.isArray(A)&&A.length>0;if(t&&R){f.autoGearRules=A;const T=getAutoGearRuleCoverageSummary({rules:A});T&&(f.autoGearCoverage=T)}const I=(()=>{if(typeof getContactsSnapshot!="function")return[];try{const T=getContactsSnapshot();if(!Array.isArray(T)||!T.length)return[];const P=N=>typeof N=="string"?N.trim():"";return T.map(N=>{if(!N||typeof N!="object")return null;const q=P(N.id);if(!q)return null;const Z=Number.isFinite(N.createdAt)?N.createdAt:Date.now(),U=Number.isFinite(N.updatedAt)?N.updatedAt:Z,K={id:q,name:P(N.name),role:P(N.role),phone:P(N.phone),email:P(N.email),website:P(N.website),notes:P(N.notes),avatar:P(N.avatar),createdAt:Z,updatedAt:U},H=P(typeof getContactDisplayLabel=="function"?getContactDisplayLabel({...N,...K}):N&&typeof N.label=="string"?N.label:"");return H&&(K.label=H),K}).filter(Boolean)}catch(T){return console.warn("Unable to prepare shared contact snapshot",T),[]}})();I.length&&(f.contacts=I);const C=Yre({includeAutoGear:t,hasAutoGearRules:R,includeOwnedGearMarks:r,hasOwnedGearMarkers:y.length>0});C&&typeof C=="object"&&(f.metadata=C);const k=(()=>{const T={};return C&&typeof C=="object"&&Object.keys(C).forEach(P=>{const N=C[P];N==null?T[P]=N:typeof N=="string"?T[P]=N.length>120?`${N.slice(0,117)}`:N:typeof N=="object"?T[P]=Array.isArray(N)?{type:"array",length:N.length}:{type:"object",keys:Object.keys(N).length}:T[P]=N}),{setupName:typeof i=="string"?i:"",setupKey:typeof L=="string"?L:"",includeAutoGear:!!t,includeOwnedGear:!!r,ownedGearMarkerCount:Array.isArray(y)?y.length:0,metadata:T,contacts:Array.isArray(I)?I.length:0}})(),_=T=>{T?console.warn("Project export failed",k,T):console.warn("Project export failed",k);const P=getLocalizedText("shareExportFailed")||"Project export failed.";o?(o.textContent=P,setStatusLevel(o,"danger"),o.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>o.classList.add("hidden"),6e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Export Failed",message:P}):typeof alert=="function"&&alert(P)};let w;try{w=JSON.stringify(f,null,2)}catch(T){console.error("Failed to serialize shared project",T),_(T);return}const x=downloadBackupPayload(w,e);if(a&&(a.checked=t&&R),n.includeOwnedGearCheckbox&&(n.includeOwnedGearCheckbox.checked=r&&y.length>0),!x||!x.success){_();return}if(x.method==="window-fallback"){const T=typeof getManualDownloadFallbackMessage=="function"?getManualDownloadFallbackMessage():getLocalizedText("manualDownloadFallback")||"The download did not start automatically. A new tab opened so you can copy or save the file manually.";o?(o.textContent=T,setStatusLevel(o,"warning"),o.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>o.classList.add("hidden"),8e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Download Blocked",message:T}):typeof alert=="function"&&alert(T);return}const G=typeof getLocalizedText=="function"&&getLocalizedText("shareLinkCopied")||texts?.en?.shareLinkCopied||"Project file downloaded.";o?(o.textContent=G,setStatusLevel(o,"success"),o.classList.remove("hidden"),typeof setTimeout=="function"&&setTimeout(()=>o.classList.add("hidden"),4e3)):typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Success",message:G}):typeof alert=="function"&&alert(G)}let Bc=null;function nM(){const e=os();return{rental:e.providerRental||"Rental",user:e.providerUser||"User",crewHeading:e.providerCrewHeading||"Crew",unknown:e.providerUnknown||"Custom provider",help:e.providerHelp||""}}function Zre(){if(Bc={names:new Set,timestamp:Date.now()},typeof loadOwnGear!="function")return Bc.names;try{const e=loadOwnGear();Array.isArray(e)&&e.forEach(t=>{if(t&&typeof t.name=="string"){const r=t.name.trim().toLowerCase();r&&Bc.names.add(r)}})}catch(e){console.warn("Unable to refresh own gear cache for provider defaults",e)}return Bc.names}function ene(){return!Bc||!(Bc.names instanceof Set)?Zre():Bc.names}const e0=typeof OWN_GEAR_SOURCE_CATALOG=="string"&&OWN_GEAR_SOURCE_CATALOG?OWN_GEAR_SOURCE_CATALOG:"catalog",tne=typeof OWN_GEAR_SOURCE_CUSTOM=="string"&&OWN_GEAR_SOURCE_CUSTOM?OWN_GEAR_SOURCE_CUSTOM:"custom";function tR(){if(typeof resolveOwnGearModule=="function")try{const t=resolveOwnGearModule();if(t&&typeof t=="object")return t}catch{}const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;return e&&typeof e.cineFeaturesOwnGear<"u"?e.cineFeaturesOwnGear:typeof cineFeaturesOwnGear=="object"&&cineFeaturesOwnGear?cineFeaturesOwnGear:null}function uW(){const e=tR();if(e&&typeof e.generateOwnGearId=="function")try{return e.generateOwnGearId()}catch{}if(typeof generateOwnGearId=="function")try{return generateOwnGearId()}catch{}const t=Date.now().toString(36),r=Math.floor(Math.random()*1e8).toString(36);return`own-${t}-${r}`}function mw(e){if(!e||typeof e!="object")return null;const t=tR();if(t&&typeof t.normalizeOwnGearRecord=="function")try{return t.normalizeOwnGearRecord(e)}catch{}if(typeof normalizeOwnGearRecord=="function")try{return normalizeOwnGearRecord(e)}catch{}const r=typeof e.name=="string"?e.name.trim():"";if(!r)return null;const n={id:typeof e.id=="string"&&e.id.trim()?e.id.trim():uW(),name:r};return typeof e.quantity=="string"&&e.quantity.trim()?n.quantity=e.quantity.trim():typeof e.quantity=="number"&&Number.isFinite(e.quantity)&&(n.quantity=String(e.quantity)),typeof e.notes=="string"&&e.notes.trim()&&(n.notes=e.notes.trim()),typeof e.source=="string"&&e.source.trim()&&(n.source=e.source.trim()),n}function t0(e){return Array.isArray(e)?e.map(t=>mw(t)).filter(Boolean).map(t=>({...t})):[]}function oM(){const e=tR();if(e&&typeof e.loadStoredOwnGearItems=="function")try{const t=e.loadStoredOwnGearItems();if(Array.isArray(t))return t0(t)}catch(t){console.warn("Unable to load own gear items for gear editor via module.",t)}if(typeof loadOwnGear=="function")try{const t=loadOwnGear();if(Array.isArray(t))return t0(t)}catch(t){console.warn("Unable to load own gear items for gear editor from storage.",t)}return[]}function Ox(e){const t=Array.isArray(e)?e.map(n=>mw(n)).filter(Boolean):[],r=tR();if(r&&typeof r.persistOwnGearItems=="function")try{return r.persistOwnGearItems(t),!0}catch(n){console.warn("Unable to persist own gear items via module for gear editor.",n)}if(typeof saveOwnGear=="function")try{return saveOwnGear(t),typeof document<"u"&&typeof document.dispatchEvent=="function"&&typeof CustomEvent=="function"&&document.dispatchEvent(new CustomEvent("own-gear-data-changed")),!0}catch(n){console.warn("Unable to persist own gear items via storage for gear editor.",n)}return!1}function aM(e,t,r){if(!Array.isArray(e))return{index:-1,record:null};const n=typeof t=="string"?t.trim():"",o=typeof r=="string"?r.trim().toLowerCase():"";let a=-1;return n&&(a=e.findIndex(i=>i&&i.id===n)),a===-1&&o&&(a=e.findIndex(i=>!i||typeof i.name!="string"?!1:i.name.trim().toLowerCase()===o)),{index:a,record:a>=0?e[a]:null}}function r0(e){return!e||typeof e!="object"||!e.classList?e0:e.classList.contains("gear-custom-item")?tne:e0}function rne(e,t,r={}){const n=!!(r&&r.wantsOwned),o=r&&typeof r.existingId=="string"?r.existingId.trim():"",a=oM(),i=typeof t.name=="string"?t.name.trim():"",s=typeof t.quantity=="string"?t.quantity.trim():"",{index:l,record:c}=aM(a,o,i);if(n&&i){if(c&&l>=0){let m=!1;const g={...c};c.name!==i&&(g.name=i,m=!0),s?c.quantity!==s&&(g.quantity=s,m=!0):c.quantity&&(delete g.quantity,m=!0);const S=r0(e);if(S&&c.source!==S&&(g.source=S,m=!0),!m)return{id:c.id,changed:!1};const y=mw(g);if(!y)return{id:c.id,changed:!1};const E=a.slice();return E[l]=y,Ox(E)?{id:y.id,changed:!0}:{id:c.id,changed:!1}}const f={id:uW(),name:i};s&&(f.quantity=s);const d=r0(e);d&&(f.source=d);const p=mw(f);if(!p)return{id:"",changed:!1};const h=a.slice();return h.push(p),Ox(h)?{id:p.id,changed:!0}:{id:"",changed:!1}}if(!c||l<0)return{id:"",changed:!1};const u=a.filter((f,d)=>d!==l);return Ox(u)?{id:"",changed:!0}:{id:c.id,changed:!1}}function nne(e,t={}){const r=typeof t.name=="string"?t.name.trim():"",n=typeof t.existingId=="string"?t.existingId.trim():"",o=oM();return aM(o,n,r).record}function gw(e){const t=typeof e=="string"?e.trim():"";return t&&ene().has(t.toLowerCase())?"user":"rental-house"}function one(e){if(!e)return null;let t=e.querySelector(".gear-item-provider");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;if(t=r.createElement("span"),t.className="gear-item-provider",t.hidden=!0,e.classList?.contains("gear-custom-item")){const a=e.querySelector(".gear-custom-item-summary"),i=e.querySelector(".gear-item-note");if(a)return i?a.insertBefore(t,i):a.appendChild(t),t}const o=e.querySelector(".gear-item-note")||e.querySelector(".gear-item-edit-btn")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn");return o&&o.parentElement?o.parentElement.insertBefore(t,o):e.appendChild(t),t}function fW(e){const t=typeof e=="string"?e.trim():"";if(!t)return"";const r=t.split(/\s+/).filter(Boolean);if(!r.length)return"";const n=r[0];if(r.length===1)return n;const o=r[r.length-1],a=Array.from(o)[0]||"";if(!a)return n;const i=typeof a.toLocaleUpperCase=="function"?a.toLocaleUpperCase():a.toUpperCase();return`${n} ${i}`}function dW(e,t={}){const r=typeof e=="string"?e.trim():"",n=nM();if(!r)return{value:"",label:"",type:""};if(r==="rental-house")return{value:"rental-house",label:n.rental,type:"rental"};if(r==="user"){const o=typeof getUserProfileSnapshot=="function"?getUserProfileSnapshot():null,a=o&&o.name?o.name:"",i=fW(a);return{value:"user",label:i?`${i}  ${n.user}`:t.label||n.user,type:"user",profileName:a,profileDisplayName:i}}if(r.startsWith("contact:")){const o=r.slice(8),a=typeof getContactById=="function"?getContactById(o):null;if(a){const s=typeof getContactDisplayLabel=="function"?getContactDisplayLabel(a):a.name||a.email||a.phone||a.id||n.crewHeading;return{value:r,label:s,type:"contact",contactId:o}}const i=t&&t.label||(typeof getContactsText=="function"?getContactsText("missingContactFallback","Saved contact"):"Saved contact");return{value:r,label:i,type:"contact",contactId:o,missing:!0}}return{value:r,label:t&&t.label?t.label:n.unknown,type:"custom"}}function iM(e,t,r={}){if(!e)return;const n=dW(t||e.getAttribute("data-gear-provider")||"",{label:r.label});n.value?e.setAttribute("data-gear-provider",n.value):e.removeAttribute("data-gear-provider"),n.label?e.setAttribute("data-gear-provider-label",n.label):e.removeAttribute("data-gear-provider-label");const o=one(e);o&&(n.label?(o.textContent=n.label,o.hidden=!1,o.setAttribute("data-provider-type",n.type||""),o.setAttribute("title",n.label),o.setAttribute("data-help",n.label)):(o.textContent="",o.hidden=!0,o.removeAttribute("data-provider-type"),o.removeAttribute("title"),o.removeAttribute("data-help")))}function n0(e){return e?e.textContent?e.textContent.trim():e.value:""}function pW(e,t={}){if(!e||!e.providerSelect)return;const r=e.providerSelect;for(;r.firstChild;)r.removeChild(r.firstChild);const n=nM(),o=typeof getUserProfileSnapshot=="function"?getUserProfileSnapshot():null,a=typeof getContactsSnapshot=="function"?getContactsSnapshot():[],i=r.ownerDocument||(typeof document<"u"?document:null);if(!i)return;const s=i.createElement("option");s.value="rental-house",s.textContent=n.rental,r.appendChild(s);const l=i.createElement("option");l.value="user";const c=o&&o.name?o.name:"",u=fW(c);if(l.textContent=u?`${u}  ${n.user}`:n.user,r.appendChild(l),a.length){const d=i.createElement("optgroup");d.label=n.crewHeading,a.forEach(p=>{const h=i.createElement("option");h.value=`contact:${p.id}`,h.textContent=p.label||p.name||p.email||p.phone||p.id,d.appendChild(h)}),r.appendChild(d)}const f=typeof t.providedBy=="string"&&t.providedBy.trim()?t.providedBy.trim():gw(t.name||"");if(f&&!Array.from(r.options).some(d=>d.value===f)){const d=i.createElement("option");d.value=f,d.textContent=t.providerLabel||(typeof getContactsText=="function"?getContactsText("missingContactFallback","Saved contact"):n.unknown),d.setAttribute("data-provider-fallback","true"),r.appendChild(d)}r.value=f||"rental-house"}function mW(e,t={}){if(!e||!e.cameraLinkSelect)return;const r=e.cameraLinkSelect;for(;r.firstChild;)r.removeChild(r.firstChild);const n=r.ownerDocument||(typeof document<"u"?document:null);if(!n)return;const o=os();if(!!e.isCameraItem){Tb.forEach(f=>{const d=n.createElement("option");d.value=f;const p=o.cameraLinkDefaultLabel;d.textContent=p.replace("%s",f),d.dataset.cameraLabel=p.replace("%s",f),r.appendChild(d)});const u=Zi(typeof t.cameraLink=="string"&&t.cameraLink?t.cameraLink:e.currentCameraLinkValue||"")||"A";r.value=u,r.disabled=!1,r.removeAttribute("aria-disabled");return}const i=n.createElement("option");i.value="",i.textContent=o.cameraLinkNoneOption,r.appendChild(i);const s=Zne(),l=new Map;s.forEach(u=>{!u||!u.letter||l.set(u.letter,u)}),Tb.forEach(u=>{const f=n.createElement("option");f.value=u;const d=l.get(u),p=o.cameraLinkCameraOption,h=o.cameraLinkUnavailableOption,m=d&&d.label?p.replace("%s",u).replace("%s",d.label):h.replace("%s",u);f.textContent=m;const g=typeof t.cameraLinkLabel=="string"?t.cameraLinkLabel.trim():"";if(d&&d.label)f.dataset.cameraLabel=d.label;else if(g&&Zi(t.cameraLink)===u)f.dataset.cameraLabel=g;else{const S=o.cameraLinkDefaultLabel;f.dataset.cameraLabel=S.replace("%s",u)}f.dataset.cameraColor=aR(u),r.appendChild(f)});const c=Zi(typeof t.cameraLink=="string"&&t.cameraLink?t.cameraLink:e.currentCameraLinkValue||"");r.value=c||""}function o0(e){const t=gearListOutput;if(!t)return;t.querySelectorAll(".gear-item, .gear-custom-item").forEach(n=>{const o=Ts(n);iM(n,o.providedBy,{label:o.providerLabel})}),eW()}async function eP(){const e=tu(this),t=e.dialog,r=e.form,n=e.filenameInput,o=e.filenameMessage,a=e.includeAutoGearCheckbox,i=e.includeAutoGearLabel;fa();const s=uS(),l=getDefaultShareFilename(s),c=ensureJsonExtension(l);if(!t||!r||!n){const m=promptForSharedFilename(s);if(!m)return;const g=getAutoGearRules(),S=Array.isArray(g)&&g.length>0;let y=!1;S&&(y=await confirmAutoGearSelection(a?a.checked:!1)),a&&(a.checked=y&&S);const E=ZH(gearListOutput),L=E;e.includeOwnedGearCheckbox&&(e.includeOwnedGearCheckbox.checked=L&&E),cW(m,y,L);return}if(n.value=c,n.setCustomValidity(""),o){const m=getLocalizedText("shareFilenamePrompt")||"";o.textContent=m.includes("{defaultName}")?m.replace("{defaultName}",l):m}const u=getAutoGearRules(),f=Array.isArray(u)&&u.length>0,d=ZH(gearListOutput);a&&(a.disabled=!f,a.setAttribute("aria-disabled",f?"false":"true"),f||(a.checked=!1)),i&&(i.classList.toggle("disabled",!f),i.setAttribute("aria-disabled",f?"false":"true"));const p=e.includeOwnedGearCheckbox,h=e.includeOwnedGearLabel;p&&(p.disabled=!d,p.setAttribute("aria-disabled",d?"false":"true"),p.checked=d),h&&(h.classList.toggle("disabled",!d),h.setAttribute("aria-disabled",d?"false":"true")),openDialog(t),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{n&&(n.focus(),n.select())}):n&&setTimeout(()=>{n.focus(),n.select()},0)}const a0=Ct("shareSetupBtn","shareSetupBtn");a0&&a0.addEventListener("click",eP);function tP(e){e.preventDefault();const t=tu(this),r=t.filenameInput,n=t.dialog,o=t.includeAutoGearCheckbox,a=t.includeOwnedGearCheckbox;if(!r)return;const i=sanitizeShareFilename(r.value);if(!i){const u=getLocalizedText("shareFilenameInvalid")||"Please enter a valid file name to continue.";r.setCustomValidity(u),r.reportValidity();return}r.setCustomValidity("");const s=ensureJsonExtension(i),l=!!(o&&!o.disabled&&o.checked),c=!!(a&&!a.disabled&&a.checked);closeDialog(n),cW(s,l,c)}function rP(){const e=tu(this),t=e.filenameInput,r=e.dialog;t&&t.setCustomValidity(""),closeDialog(r)}function gW(e){e.preventDefault();const t=tu(this),r=t.filenameInput,n=t.dialog;r&&r.setCustomValidity(""),closeDialog(n)}const bl=tu();bl.form&&bl.form.addEventListener("submit",tP);bl.cancelButton&&bl.cancelButton.addEventListener("click",rP);bl.dialog&&bl.dialog.addEventListener("cancel",gW);function yW(){const t=tu(this).sharedLinkInput;if(!t||pendingSharedLinkListener)return;const r=t.files&&t.files[0];r&&readSharedProjectFile(r)}function hW(){const t=tu(this).sharedLinkInput;if(!t)return;pendingSharedLinkListener&&(t.removeEventListener("change",pendingSharedLinkListener),pendingSharedLinkListener=null);const r=()=>{t.removeEventListener("change",r),pendingSharedLinkListener=null;const n=t.files&&t.files[0];n&&readSharedProjectFile(n)};pendingSharedLinkListener=r,t.addEventListener("change",r),t.value="",t.click(),t.files&&t.files.length&&r()}bl.sharedLinkInput&&bl.sharedLinkInput.addEventListener("change",yW);bl.applySharedLinkButton&&bl.sharedLinkInput&&bl.applySharedLinkButton.addEventListener("click",hW);function bW(){sharedImportPromptActive||lastSharedSetupData!==null&&reapplySharedImportSelection()}function nP(e){e.preventDefault(),finalizeSharedImportPrompt(),applyStoredSharedImport()}function oP(){finalizeSharedImportPrompt(),clearStoredSharedImportData()}function SW(e){e.preventDefault(),finalizeSharedImportPrompt(),clearStoredSharedImportData()}const Zu=rW();Zu.modeSelect&&Zu.modeSelect.addEventListener("change",bW);Zu.form&&Zu.form.addEventListener("submit",nP);Zu.cancelButton&&Zu.cancelButton.addEventListener("click",oP);Zu.dialog&&Zu.dialog.addEventListener("cancel",SW);Vre(vW);function i0(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=typeof texts<"u"&&texts||(e&&typeof e.texts=="object"?e.texts:null),r=typeof currentLang=="string"&&t&&typeof t[currentLang]=="object"?currentLang:"en",n=t&&typeof t[r]=="object"&&t[r]||{},o=t&&typeof t.en=="object"&&t.en||{};return{langTexts:n,fallbackTexts:o}}function vW(e){if(!e||WH)return;const t=tu(),r=rW();Rx(e.controllers,[{name:"shareDialog",value:{context:t,open:eP,submit:tP,cancel:rP,dismiss:gW}},{name:"sharedImportDialog",value:{context:r,submit:nP,cancel:oP,dismiss:SW,changeMode:bW}}],"cineUi controller registration (setups) failed"),Rx(e.interactions,[{name:"shareOpen",value:eP},{name:"shareSubmit",value:tP},{name:"shareCancel",value:rP},{name:"shareApplyFile",value:hW},{name:"shareInputChange",value:yW},{name:"sharedImportSubmit",value:nP},{name:"sharedImportCancel",value:oP}],"cineUi interaction registration (setups) failed"),Rx(e.help,[{name:"shareProject",value:()=>{const{langTexts:n,fallbackTexts:o}=i0();return n.shareSetupHelp||o.shareSetupHelp||"Download a JSON safety bundle of the current project so you can archive or share it offline. Store the file with your crew backups before closing the planner."}},{name:"sharedImport",value:()=>{const{langTexts:n,fallbackTexts:o}=i0();return n.applySharedLinkHelp||o.applySharedLinkHelp||"Load the configuration from a JSON backup exported via Save & Share or Backup & Restore. Review the preview before applyingnothing overwrites your current project until you confirm Save."}}],"cineUi help registration (setups) failed"),WH=aW(e)}function ane(){const e=typeof globalThis<"u"&&globalThis.cineUi||typeof window<"u"&&window.cineUi||typeof self<"u"&&self.cineUi||null;return e?(vW(e),!0):!1}console.log("Registering setups with cineUi...");const ine=ane();console.log("Setups registration status:",ine);const xx=typeof cineResults=="object"?cineResults:null;xx&&typeof xx.setupRuntimeFeedback=="function"&&xx.setupRuntimeFeedback({openDialog:typeof openDialog=="function"?openDialog:null,closeDialog:typeof closeDialog=="function"?closeDialog:null,getCurrentSetupKey:typeof getCurrentSetupKey=="function"?getCurrentSetupKey:null,loadFeedback:typeof loadFeedbackSafe=="function"?loadFeedbackSafe:typeof loadFeedback=="function"?loadFeedback:null,saveFeedback:typeof saveFeedbackSafe=="function"?saveFeedbackSafe:typeof saveFeedback=="function"?saveFeedback:null,updateCalculations:typeof updateCalculations=="function"?updateCalculations:null,setButtonLabelWithIcon:typeof bi=="function"?bi:null,iconGlyphs:typeof ICON_GLYPHS<"u"?ICON_GLYPHS:null});function sne(e){return Array.isArray(e)?e.reduce((t,r)=>(r?.type&&(t[r.type]=(t[r.type]||0)+1),t),{}):{}}function ro(e){const t=e!=null?String(e).trim():"";return t?`<span class="info-box-label">${Be(t)}:</span> `:""}function lne(e,t,r="neutral-conn",n="",o=""){if(!Array.isArray(e)||e.length===0)return"";const a=sne(e),i=Object.entries(a).map(([u,f])=>`${Be(u)}${f>1?` ${f}`:""}`);if(!i.length)return"";const s=n?`${n}${o?` ${o}`:""}`:"",l=ro(s),c=iconMarkup(t,"connector-icon");return`<span class="connector-block ${r}">${c}${l}${i.join(", ")}</span>`}function s0(e){if(!e||typeof e!="object")return"";const t=v=>{if(typeof v!="string")return"";const A=v.trim().toLowerCase();return A==="imperial"||A==="metric"?A:""},n=(()=>{const v=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,R=(v&&typeof v.focusScalePreference=="string"?v.focusScalePreference:null)||(typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";if(typeof normalizeFocusScale=="function")try{const C=normalizeFocusScale(R);if(C==="imperial"||C==="metric")return C}catch{}return t(R)||"metric"})(),o=typeof currentLang=="string"&&currentLang.trim()?currentLang:"en",a=(v,A={})=>{const R=typeof v=="string"?Number(v):v;if(!Number.isFinite(R))return"";const I=typeof A.maximumFractionDigits=="number"?A.maximumFractionDigits:0,C=typeof A.minimumFractionDigits=="number"?A.minimumFractionDigits:Math.min(0,I);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{return new Intl.NumberFormat(o,{maximumFractionDigits:I,minimumFractionDigits:C}).format(R)}catch{}const k=Math.max(C,Math.min(20,I));try{return R.toFixed(k)}catch{}return String(R)},i=(v,A=n)=>{const R=typeof v=="string"?Number(v):v;if(!Number.isFinite(R))return"";if(A==="imperial"){const k=R/453.59237,_=k>=10?1:2,w=a(k,{maximumFractionDigits:_,minimumFractionDigits:0});return w?`${w} lb`:""}const C=a(R,{maximumFractionDigits:0,minimumFractionDigits:0});return C?`${C} g`:""};let s="";const l=[{items:e.power?.powerDistributionOutputs,icon:diagramConnectorIcons.powerOut,cls:"power-conn",label:"Power",dir:"Out"},{items:powerInputTypes(e).map(v=>({type:v})),icon:diagramConnectorIcons.powerIn,cls:"power-conn",label:"Power",dir:"In"},{items:e.fizConnectors,icon:diagramConnectorIcons.fiz,cls:"fiz-conn",label:"FIZ Port"},{items:e.video?.inputs||e.videoInputs,icon:diagramConnectorIcons.video,cls:"video-conn",label:"Video",dir:"In"},{items:e.video?.outputs||e.videoOutputs,icon:diagramConnectorIcons.video,cls:"video-conn",label:"Video",dir:"Out"},{items:e.timecode,icon:diagramConnectorIcons.timecode,cls:"neutral-conn",label:"Timecode"},{items:e.audioInput?.portType?[{type:e.audioInput.portType}]:void 0,icon:diagramConnectorIcons.audioIn,cls:"neutral-conn",label:"Audio",dir:"In"},{items:e.audioOutput?.portType?[{type:e.audioOutput.portType}]:void 0,icon:diagramConnectorIcons.audioOut,cls:"neutral-conn",label:"Audio",dir:"Out"},{items:e.audioIo?.portType?[{type:e.audioIo.portType}]:void 0,icon:diagramConnectorIcons.audioIo,cls:"neutral-conn",label:"Audio",dir:"I/O"}];for(const{items:v,icon:A,cls:R,label:I,dir:C}of l)s+=lne(v,A,R,I,C);let c="";if(typeof e.powerDrawWatts=="number"&&(c+=`<span class="info-box power-conn">${iconMarkup(diagramConnectorIcons.powerSpec)}${ro("Power")}${e.powerDrawWatts} W</span>`),e.power?.input?.voltageRange&&(c+=`<span class="info-box power-conn">${iconMarkup(ICON_GLYPHS.batteryBolt)}${ro("Voltage")}${Be(String(e.power.input.voltageRange))}V</span>`),typeof e.weight_g=="number"){const v=i(e.weight_g);v&&(c+=`<span class="info-box neutral-conn">${iconMarkup(ICON_GLYPHS.gears)}${ro("Weight")}${Be(v)}</span>`)}typeof e.capacity=="number"&&(c+=`<span class="info-box power-conn">${iconMarkup(ICON_GLYPHS.batteryFull)}${ro("Capacity")}${e.capacity} Wh</span>`);const u=rM(e.pinA);Number.isFinite(u)&&u>0&&(c+=`<span class="info-box power-conn">${ro("Pins")}${u}A</span>`),typeof e.dtapA=="number"&&(c+=`<span class="info-box power-conn">${ro("D-Tap")}${e.dtapA}A</span>`),e.mount_type&&(c+=`<span class="info-box power-conn">${ro("Mount")}${Be(String(e.mount_type))}</span>`),typeof e.screenSizeInches=="number"&&(c+=`<span class="info-box video-conn">${iconMarkup(DIAGRAM_MONITOR_ICON)}${ro("Screen")}${e.screenSizeInches}"</span>`),typeof e.brightnessNits=="number"&&(c+=`<span class="info-box video-conn">${iconMarkup(ICON_GLYPHS.brightness)}${ro("Brightness")}${e.brightnessNits} nits</span>`),typeof e.wirelessTx=="boolean"&&(c+=`<span class="info-box video-conn">${iconMarkup(ICON_GLYPHS.wifi)}${ro("Wireless")}${e.wirelessTx}</span>`),e.internalController&&(c+=`<span class="info-box fiz-conn">${iconMarkup(diagramConnectorIcons.controller)}${ro("Controller")}Internal</span>`),typeof e.torqueNm=="number"&&(c+=`<span class="info-box fiz-conn">${iconMarkup(diagramConnectorIcons.torque)}${ro("Torque")}${e.torqueNm} Nm</span>`),e.powerSource&&(c+=`<span class="info-box power-conn">${iconMarkup(diagramConnectorIcons.powerSource)}${ro("Power Source")}${Be(String(e.powerSource))}</span>`);const f=v=>{if(!Array.isArray(v))return[];const A=new Set,R=[];return v.forEach(I=>{const C=I!=null?String(I).trim():"";!C||A.has(C)||(A.add(C),R.push(Be(C)))}),R},d=(v,A,R,I,C)=>{const k=f(A);if(!k.length)return v;const _=iconMarkup(C),w=ro(R),x=`<span class="info-box-values">${k.join(", ")}</span>`;return`${v}<span class="info-box ${I} info-box-list">${_}${w}${x}</span>`};let p="";if(Array.isArray(e.sensorModes)&&(p=d(p,e.sensorModes,"Sensor Modes","video-conn",ICON_GLYPHS.sensor)),Array.isArray(e.resolutions)&&(p=d(p,e.resolutions,"Resolutions","video-conn",ICON_GLYPHS.screen)),Array.isArray(e.frameRates)){const v=diagramConnectorIcons?.timecode||ICON_GLYPHS.camera;p=d(p,e.frameRates,"Frame Rates","video-conn",v)}if(Array.isArray(e.recordingCodecs)&&(p=d(p,e.recordingCodecs,"Codecs","video-conn",ICON_GLYPHS.camera)),Array.isArray(e.recordingMedia)){const v=e.recordingMedia.map(A=>A&&A.type?A.type:"");p=d(p,v,"Media","video-conn",ICON_GLYPHS.save)}let h="";if(Array.isArray(e.power?.batteryPlateSupport)&&e.power.batteryPlateSupport.length){const v=e.power.batteryPlateSupport.map(A=>{const R=A.mount?` (${Be(A.mount)})`:"";return`${Be(A.type)}${R}`});h+=`<span class="info-box power-conn">${ro("Battery Plate")}${v.join(", ")}</span>`}if(Array.isArray(e.viewfinder)&&e.viewfinder.length){const v=e.viewfinder.map(A=>Be(A.type));h+=`<span class="info-box video-conn">${ro("Viewfinder")}${v.join(", ")}</span>`}if(Array.isArray(e.gearTypes)&&e.gearTypes.length){const v=e.gearTypes.map(A=>Be(A));h+=`<span class="info-box fiz-conn">${ro("Gear")}${v.join(", ")}</span>`}e.connectivity&&(h+=`<span class="info-box video-conn">${ro("Connectivity")}${Be(String(e.connectivity))}</span>`),e.notes&&(h+=`<span class="info-box neutral-conn">${ro("Notes")}${Be(String(e.notes))}</span>`);let m="";if(Array.isArray(e.lensMount)){const v=e.lensMount.map(A=>{const R=A.mount?` (${Be(A.mount)})`:"";return`<span class="info-box neutral-conn">${Be(A.type)}${R}</span>`}).join("");v&&(m=`<div class="lens-mount-box">${v}</div>`)}let g="";const S=(v,A)=>A?`<div class="info-label">${v}</div>${A}`:"";g+=S("Ports",s),g+=S("Specs",c),g+=S("Recording",p),g+=S("Extras",h),m&&(g+=`<div class="info-label">Lens Mount</div>${m}`);const y=new Set(["power","powerDrawWatts","weight_g","capacity","pinA","dtapA","mount_type","screenSizeInches","brightnessNits","wirelessTx","internalController","torqueNm","powerSource","sensorModes","resolutions","frameRates","recordingCodecs","recordingMedia","viewfinder","gearTypes","connectivity","notes","lensMount","video","videoInputs","videoOutputs","fizConnectors","timecode","audioInput","audioOutput","audioIo"]);let E="";const L=v=>v.replace(/([A-Z])/g," $1").replace(/^./,A=>A.toUpperCase()).replace(/_/g," ").trim();return Object.entries(e).forEach(([v,A])=>{if(y.has(v)||A==null||A==="")return;if(v==="verified_source"){const I=String(A);E+=`<span class="info-box neutral-conn"><a href="${Be(I)}" target="_blank" rel="noopener noreferrer" style="color:inherit;text-decoration:underline;">Source</a></span>`;return}const R=L(v);if(Array.isArray(A)){const I=A.map(C=>typeof C=="string"?C:JSON.stringify(C));if(I.length){const C=`<span class="info-box-values">${I.map(Be).join(", ")}</span>`,k=typeof ICON_GLYPHS<"u"&&ICON_GLYPHS.fileText?iconMarkup(ICON_GLYPHS.fileText):"";E+=`<span class="info-box neutral-conn info-box-list">${k}${ro(R)}${C}</span>`}}else if(typeof A!="object"){let I=String(A);typeof A=="boolean"&&(I=A?"Yes":"No"),E+=`<span class="info-box neutral-conn">${ro(R)}${Be(I)}</span>`}}),E&&(g+=S("Other Attributes",E)),g?`<div class="connector-summary">${g}</div>`:""}function cne(e){let t=Math.floor(e/4);const r=e%4;let n=0,o=0;return r===0||(r===3?t+=1:r>0&&(n+=1)),{quad:t,dual:n,single:o}}function fn(e){if(!e)return e;const t=typeof devices<"u"?devices:{},r=[t.viewfinders,t.directorMonitors,t.iosVideo,t.videoAssist,t.media,t.lenses];for(const n of r)if(n&&n[e]){const o=n[e];return o.brand&&o.brand.toUpperCase().includes("ARRI")&&o.kNumber&&!e.includes(o.kNumber)?e.replace(/^ARRI\s*/i,`ARRI ${o.kNumber} `):e}if(t.accessories){const n=o=>{if(!o)return null;if(o[e])return o[e];for(const a of Object.values(o))if(a&&typeof a=="object"){const i=n(a);if(i)return i}return null};for(const o of Object.values(t.accessories)){const a=n(o);if(a)return a.brand&&a.brand.toUpperCase().includes("ARRI")&&a.kNumber&&!e.includes(a.kNumber)?/^ARRI\s*/i.test(e)?e.replace(/^ARRI\s*/i,`ARRI ${a.kNumber} `):`ARRI ${a.kNumber} ${e}`:e}}return e}const aP=e=>(e||"").replace(/[()]/g,"").replace(/\s{2,}/g," ").trim(),_l=(e,t)=>{const r=aP(t);return r?`${e} (${r})`:e};function une(){const e="LBUS to LBUS 0,5m",t="Cable UDM  SERIAL (4p) 0,5m",r="Cable UDM  SERIAL (7p) 1,5m",n=[],o=[],a=[],i=cameraSelect?.value||"",s=motorSelects.map(R=>R.value).filter(R=>R&&R!=="None"),l=controllerSelects.map(R=>R.value).filter(R=>R&&R!=="None"),c=distanceSelect?.value||"",u=s[0]||"",f=l.includes("Arri Master Grip (single unit)"),d=l.includes("Arri RIA-1");let p=c.includes("UDM"),h=c.includes("LCube");h&&(d||i==="Arri Alexa 35")&&(h=!1);const m=/cforce mini rf/i.test(u),g=/cforce mini/i.test(u)&&!m,S=u?`for ${u}`:"for FIZ motor",y="for Arri Master Grip (single unit)",E=c?`for ${c}`:"for distance sensor",L=[];d&&L.push("Arri RIA-1"),m&&L.push("Arri cforce mini RF");const v=L[0]||l[0]||"",A=(R,I)=>{const C=String(R).replace(".",","),k=I||S;n.push(_l(`LBUS to LBUS ${C}m`,k)),o.push(Number(R))};if((i==="Arri Alexa Mini"||i==="Arri Alexa Mini LF")&&g?(A(.3),h&&A(.4,E),f&&A(.5,y)):i==="Arri Alexa 35"&&g?(A(.3),f&&A(.5,y)):m?(h&&A(.4,E),f&&A(.5,y)):d&&g&&(A(.4),f&&A(.5,y)),L.length){const R=devices.accessories?.cables||{};let I=null;for(const[C,k]of Object.entries(R)){const _=[];Array.isArray(k.connectors)&&_.push(...k.connectors),k.from&&_.push(k.from),k.to&&_.push(k.to),!(!_.some(G=>/CAM \(7-pin/i.test(G))||!(k.compatibleControllers||[]).some(G=>L.some(T=>G.toLowerCase().includes(T.toLowerCase())))||!(!k.compatibleCameras||k.compatibleCameras.some(G=>G.toLowerCase()===i.toLowerCase())))&&(!I||(k.lengthM??1/0)<(R[I].lengthM??1/0))&&(I=C)}if(I){const C=i?`for ${i}`:"for camera control";n.push(_l(I,C)),a.push(I)}else if(d&&R["Cable CAM (7-pin)  D-Tap 0,5m"]){const C="Cable CAM (7-pin)  D-Tap 0,5m",k=v?`for ${v} power`:"for controller power";n.push(_l(C,k)),a.push(C)}}if(p&&(h?n.push(_l(r,E)):(n.push(_l(t,E)),n.push(_l(t,"spare")))),o.length){const R=Math.min(...o),I=String(R).replace(".",",");n.push(_l(`LBUS to LBUS ${I}m`,"spare")),n.push(_l(e,"spare"))}return a.forEach(R=>n.push(_l(R,"spare"))),n}function fne({hasMotor:e=!1,videoDistPrefs:t=[]}={}){const r=(H,te)=>te||(typeof document<"u"?document.getElementById(H):null),n=r("cameraSelect",typeof cameraSelect<"u"?cameraSelect:null),o=r("monitorSelect",typeof monitorSelect<"u"?monitorSelect:null),a=r("videoSelect",typeof videoSelect<"u"?videoSelect:null),i=r("batterySelect",typeof batterySelect<"u"?batterySelect:null),s=r("cageSelect",typeof cageSelect<"u"?cageSelect:null),l=r("distanceSelect",typeof distanceSelect<"u"?distanceSelect:null),c=H=>H&&typeof H.value<"u"?H.value:"",u=c(n),f=c(o),d=c(a),p=c(i),h=c(s),m=c(l),g=[],S=[],y=[],E=[],L=[],v=[],A=devices.accessories||{},R=new Set(["D-Tap to LEMO 2-pin","HDMI Cable"]);if(p){const H=(devices&&devices.batteries&&devices.batteries[p])?.mount_type;if(A.powerPlates)for(const[te,re]of Object.entries(A.powerPlates))(!re.mount||re.mount===H)&&(!re.compatible||re.compatible.includes(u))&&g.push(te);if(A.chargers){let te=parseInt(batteryCountElem?.textContent||"",10);Number.isFinite(te)||(te=p?1:0);let re=0;if(Array.isArray(t)){const Oe=t.filter(Ne=>/Monitor(?: \d+")? handheld$/.test(Ne)).length;re+=Oe*3;const Te=t.filter(Ne=>{const Ie=Ne.match(/Monitor (\d+(?:\.\d+)?)/);return Ie&&parseFloat(Ie[1])>10&&!/handheld$/.test(Ne)}).length;re+=Te*2}e&&(re+=3);const fe=(Oe,Te)=>{if(!Oe||Te<=0)return;const Ne=cne(Te),Ie=Ze=>{for(const[Ft,Ye]of Object.entries(A.chargers))if(Ye.mount===Oe&&Ye.slots===Ze)return Ft;return null},et=(Ze,Ft)=>{const Ye=Ie(Ze);if(Ye)for(let ct=0;ct<Ft;ct++)L.push(Ye)};et(4,Ne.quad),et(2,Ne.dual),et(1,Ne.single)};H==="B-Mount"?(fe("B-Mount",te),fe("V-Mount",re)):fe(H,te+re)}}if(u&&A.cages&&(!h||h==="None"))for(const[H,te]of Object.entries(A.cages))(!te.compatible||te.compatible.includes(u))&&g.push(H);const I=A.cables?.power||{},C=(H,te=S,re=!1)=>{const fe=H?.power?.input?.type;(Array.isArray(fe)?fe:fe?[fe]:[]).forEach(Te=>{for(const[Ne,Ie]of Object.entries(I)){const et=R.has(Ne);Ie.to===Te&&(!et||re)&&te.push(Ne)}})};u&&devices.cameras&&C(devices.cameras[u]),d&&devices.video&&C(devices.video[d]);const k=f&&devices.monitors?devices.monitors[f]:null;if(k){const H="Onboard monitor",te=k?.power?.input?.type;(Array.isArray(te)?te.includes("LEMO 2-pin"):te==="LEMO 2-pin")&&y.push(`D-Tap to Lemo-2-pin Cable 0,5m (${H})`,`D-Tap to Lemo-2-pin Cable 0,5m (${H})`);const Oe=((u&&devices.cameras?devices.cameras[u]:null)?.videoOutputs||[]).map(et=>et?.type?.toUpperCase()),Te=(k.videoInputs||[]).map(et=>et?.type?.toUpperCase()),Ne=Oe.some(et=>et&&et.includes("SDI"))&&Te.some(et=>et&&et.includes("SDI")),Ie=Oe.includes("HDMI")&&Te.includes("HDMI");Ne?y.push(`Ultraslim BNC Cable 0.5 m (${H})`,`Ultraslim BNC Cable 0.5 m (${H})`):Ie&&y.push(`Ultraslim HDMI 0.5 m (${H})`,`Ultraslim HDMI 0.5 m (${H})`),E.push(`ULCS Arm mit 3/8" und 1/4" double (${H})`)}if(d){const H=d.replace(/ TX\b/," RX");devices.wirelessReceivers&&devices.wirelessReceivers[H]&&C(devices.wirelessReceivers[H])}devices.fiz&&devices.fiz.motors&&Array.isArray(motorSelects)&&motorSelects.forEach(H=>{const te=c(H);te&&C(devices.fiz.motors[te])}),devices.fiz&&devices.fiz.controllers&&Array.isArray(controllerSelects)&&controllerSelects.forEach(H=>{const te=c(H);te&&C(devices.fiz.controllers[te])}),devices.fiz&&devices.fiz.distance&&m&&C(devices.fiz.distance[m]);const _=A.cables?.fiz||{},w=H=>{const te=[];return H?(Array.isArray(H.fizConnectors)&&H.fizConnectors.forEach(re=>{const fe=re&&typeof re=="object"?re.type:re;fe&&te.push(fe)}),H.fizConnector&&te.push(H.fizConnector),[...new Set(te.filter(Boolean))]):te},x=(H,te)=>{v.push(_l(H,te))},G={},T=(H,te)=>{const re=[aP(H),aP(te)].filter(Boolean);if(!re.length)return"";const fe=re.join("  "),Oe=fe.toLowerCase(),Te=(G[Oe]||0)+1;return G[Oe]=Te,Te>1?`${fe} #${Te}`:fe},P=(H,te,re)=>{if(!H)return!1;const fe=(Oe,Te)=>H.from===Oe&&H.to===Te||H.from===Te&&H.to===Oe;if(H.from&&H.to&&fe(te,re))return!0;if(Array.isArray(H.connectors)){const Oe=H.connectors;if(Oe.includes(te)&&Oe.includes(re))return!0}return!1},N=motorSelects.map(H=>c(H)).filter(H=>H&&H!=="None").map(H=>({name:H,data:devices.fiz?.motors?.[H]})).filter(H=>H.data),q=controllerSelects.map(H=>c(H)).filter(H=>H&&H!=="None").map(H=>({name:H,data:devices.fiz?.controllers?.[H]})).filter(H=>H.data);N.forEach(H=>{const te=w(H.data);q.forEach(re=>{const fe=w(re.data);te.forEach(Oe=>{fe.forEach(Te=>{if(Oe===Te){for(const[Ne,Ie]of Object.entries(_))if(P(Ie,Oe,Te)){const et=T(H.name,re.name);x(Ne,et)}}})})})}),une().forEach(H=>v.push(H));const Z=[...new Set(S)],U=y.slice(),K=[...new Set(E)];return{cameraSupport:[...new Set(g)],chargers:L,fizCables:v,misc:Z,monitoringSupport:U,rigging:K}}function l0(e){if(!e||typeof e!="object")return{};const t={...e};return Array.isArray(e.people)&&(t.people=e.people.map(r=>({...r}))),Array.isArray(e.prepDays)&&(t.prepDays=[...e.prepDays]),Array.isArray(e.shootingDays)&&(t.shootingDays=[...e.shootingDays]),Array.isArray(e.returnDays)&&(t.returnDays=[...e.returnDays]),Array.isArray(e.storageRequirements)&&(t.storageRequirements=e.storageRequirements.map(r=>({...r}))),e.monitorBatteries&&typeof e.monitorBatteries=="object"&&(t.monitorBatteries={...e.monitorBatteries}),Array.isArray(e.lensSelections)&&(t.lensSelections=e.lensSelections.map(r=>({...r}))),t}function dne(e){const t={...e};return Array.isArray(e.people)&&(t.people=Ks(e.people.map(r=>Ks({...r})))),Array.isArray(e.prepDays)&&(t.prepDays=Ks([...e.prepDays])),Array.isArray(e.shootingDays)&&(t.shootingDays=Ks([...e.shootingDays])),Array.isArray(e.returnDays)&&(t.returnDays=Ks([...e.returnDays])),Array.isArray(e.storageRequirements)&&(t.storageRequirements=Ks(e.storageRequirements.map(r=>Ks({...r})))),e.monitorBatteries&&typeof e.monitorBatteries=="object"&&(t.monitorBatteries=Ks({...e.monitorBatteries})),Array.isArray(e.lensSelections)&&(t.lensSelections=Ks(e.lensSelections.map(r=>Ks({...r})))),Ks(t)}function pne(e){if(typeof e!="string")return"";const t=e.trim();return t&&(t.match(/^data:image\/(png|jpeg|jpg|gif|webp);base64,/i)||/^[a-zA-Z0-9._-]+$/.test(t))?t:""}function dS(){if(!projectForm)return{};if(!JI&&GA)return l0(GA);const e=new FormData(projectForm),t=N=>{const q=e.get(N);return typeof q=="string"?q.trim():""},r=N=>{const q=e.getAll(N);return!q||q.length===0?"":q.map(Z=>typeof Z=="string"?Z:String(Z)).join(", ")},n=r("viewfinderSettings"),o=r("frameGuides"),a=r("aspectMaskOpacity"),i=typeof collectFilterSelections=="function"?collectFilterSelections():"",l=(i?i.split(",").map(N=>N.split(":")[0]):[]).some(N=>N==="ND Grad HE"||N==="ND Grad SE")?"Swing Away":t("mattebox"),c=Array.from(crewContainer?.querySelectorAll(".person-row")||[]).map(N=>{const q=N.querySelector(".person-role-select")?.value,Z=N.querySelector(".person-name"),U=N.querySelector(".person-phone"),K=N.querySelector(".person-email"),H=N.querySelector(".person-website"),te=N.querySelector(".person-avatar-data"),re=typeof q=="string"?q.trim():q==null?"":String(q),fe=typeof Z?.value=="string"?Z.value.trim():"",Oe=typeof U?.value=="string"?U.value.trim():"",Te=typeof K?.value=="string"?K.value.trim():"",Ne=typeof H?.value=="string"?H.value.trim():"",Ie=typeof te?.value=="string"?te.value.trim():"",et=pne(Ie);return{role:re,name:fe,phone:Oe,email:Te,website:Ne,avatar:et}}).filter(N=>N.role||N.name||N.phone||N.email||N.website||N.avatar),u=(N,q,Z)=>Array.from(N?.querySelectorAll(".period-row")||[]).map(U=>{const K=U.querySelector(q)?.value,H=U.querySelector(Z)?.value;return[K,H].filter(Boolean).join(" to ")}).filter(Boolean),f=u(prepContainer,".prep-start",".prep-end"),d=u(shootContainer,".shoot-start",".shoot-end"),p=u(returnContainer,".return-start",".return-end"),h=gearListOutput?(()=>{const N=["gearListDirectorMonitor","gearListDopMonitor","gearListGafferMonitor","gearListDirectorMonitor15","gearListComboMonitor15","gearListDopMonitor15","gearListFocusMonitor","gearListProGaffColor1","gearListProGaffWidth1","gearListProGaffColor2","gearListProGaffWidth2","gearListEyeLeatherColor"],q=new Map;return N.forEach(Z=>{const U=gearListOutput.querySelector(`#${Z}`);if(!U)return;const K=U.value;q.set(Z,typeof K=="string"?K:K==null?"":String(K))}),q})():null,m=N=>h&&h.has(N)?h.get(N):"",g=gearListOutput?(()=>{const N={};return gearListOutput.querySelectorAll("select[data-monitor-battery-key]").forEach(q=>{const Z=q.getAttribute("data-monitor-battery-key");if(!Z)return;const U=q.value,K=typeof U=="string"?U.trim():U==null?"":String(U);K&&(N[Z]=K)}),N})():{},S=m("gearListProGaffColor1"),y=m("gearListProGaffWidth1"),E=m("gearListProGaffColor2"),L=m("gearListProGaffWidth2"),v={street:t("productionCompanyStreet"),street2:t("productionCompanyStreet2"),city:t("productionCompanyCity"),region:t("productionCompanyRegion"),postalCode:t("productionCompanyPostalCode"),country:t("productionCompanyCountry")},A=[];v.street&&A.push(v.street),v.street2&&A.push(v.street2);const R=[v.city,v.region,v.postalCode].map(N=>N||"").filter(N=>N);R.length&&A.push(R.join(", ")),v.country&&A.push(v.country);const I=Vu&&typeof Vu.snapshot=="function"?Vu.snapshot():{names:Ob(r("lenses")),lensSelections:[]},C=Array.isArray(I.names)?I.names.map(N=>typeof N=="string"?N.trim():"").filter(Boolean):Ob(I.names),k=Array.isArray(I.lensSelections)?I.lensSelections.map(N=>({name:typeof N?.name=="string"?N.name.trim():"",mount:typeof N?.mount=="string"?N.mount.trim():"",mountState:typeof N?.mountState=="string"?N.mountState.trim():""})).filter(N=>N.name):[],_={productionCompany:t("productionCompany"),productionCompanyAddress:A.join(`
`),productionCompanyStreet:v.street,productionCompanyStreet2:v.street2,productionCompanyCity:v.city,productionCompanyRegion:v.region,productionCompanyPostalCode:v.postalCode,productionCompanyCountry:v.country,rentalHouse:t("rentalHouse"),...c.length?{people:c}:{},prepDays:f,shootingDays:d,returnDays:p,deliveryResolution:t("deliveryResolution"),recordingResolution:t("recordingResolution"),slowMotionRecordingResolution:t("slowMotionRecordingResolution"),aspectRatio:r("aspectRatio"),codec:t("codec"),baseFrameRate:t("baseFrameRate"),recordingFrameRate:t("recordingFrameRate"),slowMotionBaseFrameRate:t("slowMotionBaseFrameRate"),slowMotionRecordingFrameRate:t("slowMotionRecordingFrameRate"),sensorMode:t("sensorMode"),slowMotionSensorMode:t("slowMotionSensorMode"),slowMotionAspectRatio:t("slowMotionAspectRatio"),lenses:C,requiredScenarios:r("requiredScenarios"),cameraHandle:r("cameraHandle"),viewfinderExtension:t("viewfinderExtension"),viewfinderEyeLeatherColor:m("gearListEyeLeatherColor")||t("viewfinderEyeLeatherColor"),mattebox:l,gimbal:r("gimbal"),viewfinderSettings:n,frameGuides:o,aspectMaskOpacity:a,videoDistribution:r("videoDistribution"),monitoringConfiguration:t("monitoringConfiguration"),monitorUserButtons:r("monitorUserButtons"),cameraUserButtons:r("cameraUserButtons"),viewfinderUserButtons:r("viewfinderUserButtons"),tripodHeadBrand:t("tripodHeadBrand"),tripodBowl:t("tripodBowl"),tripodTypes:r("tripodTypes"),tripodSpreader:t("tripodSpreader"),sliderBowl:mg("getSliderBowlValue"),easyrig:mg("getEasyrigValue"),filter:i};_.lensSelections=k,g&&Object.keys(g).length&&(_.monitorBatteries=g);const w=(N,q)=>{const Z=m(q);Z&&(_[N]=Z)},x=(N,q)=>{if(!gearListOutput)return;const Z=gearListOutput.querySelector(`#${q}`);Z&&Z.dataset&&Z.dataset.autoGearManual==="true"&&(_[`${N}Manual`]=!0)};w("directorMonitor","gearListDirectorMonitor"),w("dopMonitor","gearListDopMonitor"),w("gafferMonitor","gearListGafferMonitor"),w("directorMonitor15","gearListDirectorMonitor15"),w("comboMonitor15","gearListComboMonitor15"),w("dopMonitor15","gearListDopMonitor15"),_.focusMonitor=m("gearListFocusMonitor")||"",x("directorMonitor","gearListDirectorMonitor"),x("dopMonitor","gearListDopMonitor"),x("gafferMonitor","gearListGafferMonitor"),x("directorMonitor15","gearListDirectorMonitor15"),x("comboMonitor15","gearListComboMonitor15"),x("dopMonitor15","gearListDopMonitor15"),x("focusMonitor","gearListFocusMonitor"),(S||y)&&(_.proGaffColor1=S||"",_.proGaffWidth1=y||""),(E||L)&&(_.proGaffColor2=E||"",_.proGaffWidth2=L||"");const G=Array.from(storageNeedsContainer?.querySelectorAll(".storage-row")||[]).map(N=>{const q=N.querySelector(".storage-quantity"),Z=N.querySelector(".storage-type"),U=N.querySelector(".storage-variant"),K=N.querySelector(".storage-notes"),H=q?parseInt(q.value,10):NaN,te=Number.isFinite(H)&&H>0?H:null,re=typeof Z?.value=="string"?Z.value.trim():"",fe=typeof U?.value=="string"?U.value.trim():"",Oe=typeof K?.value=="string"?K.value.trim():"";if(!te&&!re&&!fe&&!Oe)return null;const Te={};return te&&(Te.quantity=te),re&&(Te.type=re),fe&&(Te.variant=fe),Oe&&(Te.notes=Oe),Te}).filter(Boolean);G.length&&(_.storageRequirements=G);const T=uS();T&&(_.projectName=T);const P=dne(_);return GA=P,JI=!1,l0(P)}const mne=["ND","ND Grad HE","ND Grad SE","ND Grad Reverse","Polarizer","Variable ND","Diopter","Optical Flat","Rota-Pola","Mist","Glimmerglass","Diffusion","Streak","Star","UV","IR","Color","Effect"];function gne(e=[]){const t=document.getElementById("filter");if(!t)return;const r=new Set(mne);Array.isArray(e)&&e.forEach(s=>{s&&r.add(s)});const n=Array.from(r).sort();if(!t.options)return;const o=new Set(Array.from(t.options).map(s=>s.value));if(n.filter(s=>!o.has(s)).length===0&&t.options.length===n.length)return;t.innerHTML="";const i=document.createDocumentFragment();n.forEach(s=>{const l=document.createElement("option");l.value=s,l.textContent=s,i.appendChild(l)}),t.appendChild(i)}function rR(e={}){typeof window<"u"&&(window.cineSuppressAutosave=!0);try{const t=typeof projectForm<"u"?projectForm:typeof document<"u"?document.getElementById("projectForm"):null;if(!t)return;t.reset();const r=(d,p)=>{if(p===void 0)return;const h=t.querySelector(`[name="${d}"]`);if(!h)return;let m=p;if(d==="recordingFrameRate"||d==="slowMotionRecordingFrameRate"){if(typeof p=="number"&&Number.isFinite(p))m=p%1?p.toFixed(3).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1"):String(p);else if(typeof p=="string"){const g=p.trim(),S=g.match(/-?\d+(?:\.\d+)?/);if(S){const y=Number.parseFloat(S[0]);Number.isFinite(y)?m=y%1?y.toFixed(3).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1"):String(y):m=g}else m=g}}h.value=m},n=(d,p)=>{const h=projectForm.querySelector(`[name="${d}"]`);if(!h||p===void 0)return;const m=Array.isArray(p)?p:p?p.split(",").map(g=>g.trim()):[];h.options&&Array.from(h.options).forEach(g=>{g.selected=m.includes(g.value)})},o=(d,p)=>d||(typeof document<"u"?document.getElementById(p):null),a=o(typeof crewContainer<"u"?crewContainer:null,"crewContainer"),i=o(typeof prepContainer<"u"?prepContainer:null,"prepContainer"),s=o(typeof shootContainer<"u"?shootContainer:null,"shootContainer"),l=o(typeof returnContainer<"u"?returnContainer:null,"returnContainer"),c=o(typeof storageNeedsContainer<"u"?storageNeedsContainer:null,"storageNeedsContainer");populateRecordingResolutionDropdown(e.recordingResolution),populateSensorModeDropdown(e.sensorMode),populateCodecDropdown(e.codec),typeof populateFrameRateDropdown=="function"&&populateFrameRateDropdown(e.recordingFrameRate),populateSlowMotionRecordingResolutionDropdown(e.slowMotionRecordingResolution),populateSlowMotionSensorModeDropdown(e.slowMotionSensorMode),typeof populateSlowMotionFrameRateDropdown=="function"&&populateSlowMotionFrameRateDropdown(e.slowMotionRecordingFrameRate),r("productionCompany",e.productionCompany);const u=(()=>{const d={street:e.productionCompanyStreet||"",street2:e.productionCompanyStreet2||"",city:e.productionCompanyCity||"",region:e.productionCompanyRegion||"",postalCode:e.productionCompanyPostalCode||"",country:e.productionCompanyCountry||""};if(Object.values(d).some(g=>g))return d;const h=typeof e.productionCompanyAddress=="string"?e.productionCompanyAddress.trim():"";if(!h)return d;const m=h.split(/\r?\n/).map(g=>g.trim()).filter(Boolean);return m.length&&(d.street=m[0]||"",d.street2=m[1]||"",m.length>=3&&(d.city=m.slice(2).join(", "))),d})();if(r("productionCompanyStreet",u.street),r("productionCompanyStreet2",u.street2),r("productionCompanyCity",u.city),r("productionCompanyRegion",u.region),r("productionCompanyPostalCode",u.postalCode),r("productionCompanyCountry",u.country),r("rentalHouse",e.rentalHouse),a){a.innerHTML="";const d=Array.isArray(e.people)?e.people.map(p=>p&&typeof p=="object"?{...p}:{}):[];if(typeof profile<"u"&&profile&&typeof profile=="object"){const p=typeof profile.name=="string"?profile.name.trim():""}d.forEach(p=>{createCrewRow(p)})}if(i){i.innerHTML="";const d=Array.isArray(e.prepDays)?e.prepDays:e.prepDays?String(e.prepDays).split(`
`):[""];d.length||d.push(""),d.forEach(p=>{const[h,m]=p.split(" to ");createPrepRow({start:h,end:m})})}if(s){s.innerHTML="";const d=Array.isArray(e.shootingDays)?e.shootingDays:e.shootingDays?String(e.shootingDays).split(`
`):[""];d.length||d.push(""),d.forEach(p=>{const[h,m]=p.split(" to ");createShootRow({start:h,end:m})})}if(l){l.innerHTML="";const d=Array.isArray(e.returnDays)?e.returnDays:e.returnDays?String(e.returnDays).split(`
`):[""];d.length||d.push(""),d.forEach(p=>{const[h,m]=p.split(" to ");createReturnRow({start:h,end:m})})}if(c){c.innerHTML="";const d=Array.isArray(e.storageRequirements)?e.storageRequirements:[];d.length?d.forEach(p=>createStorageRequirementRow(p)):createStorageRequirementRow()}r("deliveryResolution",e.deliveryResolution),n("aspectRatio",e.aspectRatio),r("baseFrameRate",e.baseFrameRate),r("recordingFrameRate",e.recordingFrameRate),r("sensorMode",e.sensorMode),r("slowMotionRecordingResolution",e.slowMotionRecordingResolution),r("slowMotionSensorMode",e.slowMotionSensorMode),r("slowMotionAspectRatio",e.slowMotionAspectRatio),r("slowMotionBaseFrameRate",e.slowMotionBaseFrameRate),r("slowMotionRecordingFrameRate",e.slowMotionRecordingFrameRate),Vu&&typeof Vu.applyInfo=="function"&&Vu.applyInfo(e||{}),n("requiredScenarios",e.requiredScenarios),n("cameraHandle",e.cameraHandle),r("viewfinderExtension",e.viewfinderExtension),r("viewfinderEyeLeatherColor",e.viewfinderEyeLeatherColor),r("mattebox",e.mattebox),n("gimbal",e.gimbal),n("viewfinderSettings",e.viewfinderSettings),n("frameGuides",e.frameGuides),n("aspectMaskOpacity",e.aspectMaskOpacity),n("videoDistribution",e.videoDistribution),r("monitoringConfiguration",e.monitoringConfiguration),n("monitorUserButtons",e.monitorUserButtons),n("cameraUserButtons",e.cameraUserButtons),n("viewfinderUserButtons",e.viewfinderUserButtons),r("tripodHeadBrand",e.tripodHeadBrand),r("tripodBowl",e.tripodBowl),n("tripodTypes",e.tripodTypes),r("tripodSpreader",e.tripodSpreader),typeof setSliderBowlValue=="function"&&setSliderBowlValue(e.sliderBowl||""),setEasyrigValue(e.easyrig||"");const f=parseFilterTokens(e.filter);if(gne(f.map(d=>d.type)),n("filter",f.map(d=>d.type)),renderFilterDetails(f),f.forEach(({type:d,size:p,values:h})=>{const m=document.getElementById(`filter-size-${filterId(d)}`);m&&(m.value=p);const g=document.getElementById(`filter-values-${filterId(d)}`);if(g){const S=Array.isArray(h)?h:[];g.options&&Array.from(g.options).forEach(y=>{y.selected=S.includes(y.value)})}}),projectForm){const d=projectForm.querySelector("#rentalHouse");MA(d),th(d)}Ms()}finally{typeof window<"u"&&setTimeout(()=>{window.cineSuppressAutosave=!1},500)}}function yne(e){if(!e||!e.tripodPreferences||!e.tripodPreferences.includes("Zoom Remote handle"))return;let t=motorSelects.map(o=>o.value).filter(o=>o&&o!=="None");if(!t.length)return;if(t.length<2&&motorSelects[1]){let o=t[0];/cforce.*rf/i.test(o)&&devices.fiz.motors["Arri Cforce Mini"]&&(o="Arri Cforce Mini"),motorSelects[1].value=o,t=motorSelects.map(a=>a.value).filter(a=>a&&a!=="None")}const r=new Set(["Arri Master Grip (single unit)","Arri ZMU-4 (body only, wired)","Tilta Nucleus-M Hand Grip (single)","Tilta Nucleus-M II Handle (single)"]);if(!controllerSelects.map(o=>o.value).filter(o=>o&&o!=="None").some(o=>r.has(o))){const o=detectBrand(t[0]);let a=null;o==="arri"?a="Arri Master Grip (single unit)":o==="tilta"&&(a="Tilta Nucleus-M Hand Grip (single)"),a&&controllerSelects[0]&&(controllerSelects[0].value=a)}typeof updateCalculations=="function"&&updateCalculations(),typeof saveCurrentSession=="function"&&saveCurrentSession()}function hne(e){return(e||"").replace(/\s*\([^)]*\)\s*$/,"").trim()}function Ed(e){return hne(e).toLowerCase()}function iP(e){const t=typeof normalizeAutoGearText=="function"?normalizeAutoGearText(e,{collapseWhitespace:!0}):(e==null?"":String(e)).trim().replace(/\s+/g," ");return t?t.replace(/^[\s\-]+/u,"").trim().toLowerCase():""}function bne(e){if(!e||!e.dataset)return"";const t=typeof e.dataset.autoGearNotes=="string"?e.dataset.autoGearNotes:"";if(t)return iP(t);const r=e.querySelector(".auto-gear-notes");return!r||typeof r.textContent!="string"?"":iP(r.textContent)}function EW(e,t){if(!e||!t)return!1;const r=Ed(e),n=Ed(t);return r===n?!0:r===Ed(t.replace(/^\d+x\s+/,""))}function Sne(e){if(typeof e!="string")return!1;const t=Ed(fP);return t?Ed(e)===t:!1}function vne(e){return!e||typeof e!="object"?!1:Sne(e.name)}function Ene(){if(typeof texts=="object"&&texts){const e=texts[currentLang]?.autoGearMonitorLabel;if(typeof e=="string"&&e.trim())return e.trim();const t=texts.en?.autoGearMonitorLabel;if(typeof t=="string"&&t.trim())return t.trim()}return"Onboard monitors"}function Ane(e){if(!e||typeof e.querySelectorAll!="function")return;const t=Ed(fP);if(!t)return;const r=Ene(),n={id:Ioe,label:r},o=Array.from(e.querySelectorAll(".gear-item")).filter(a=>{if(!a)return!1;const i=Gg(a)||a.textContent||"";return Ed(i)===t});o.length&&o.forEach(a=>{const i=Math.max(1,yw(a));if(!a.classList.contains("auto-gear-item")){const l=normalizeAutoGearItem({id:koe,name:fP,category:"Rigging",quantity:i,contextNotes:[r]});lP(a,l,i,n);return}wW(a,n),sR(a,n),cM(a).has(r)?Bu(a):RW(a,[r],i),lR(a)})}function yw(e){if(!e)return 1;const r=(e.textContent||"").trim().match(/^(\d+)x\s+/);return r?parseInt(r[1],10):1}function sM(e,t){if(!e)return;const r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);let n=null;for(;r.nextNode();){const i=r.currentNode;if(/\d+x\s+/i.test(i.textContent)){n=i;break}}if(!n){e.insertBefore(document.createTextNode(`${t}x `),e.firstChild);return}const o=n.textContent||"",a=o.match(/^(\s*)(\d+)x\s+(.*)$/);a?n.textContent=`${a[1]}${t}x ${a[3]}`:n.textContent=o.replace(/^(\d+)x\s+/,`${t}x `)}function Cne(e){if(!e)return;const t=Array.from(e.childNodes);let r=!0;for(t.forEach(o=>{if(o.nodeType===Node.TEXT_NODE&&!o.textContent.trim()){e.removeChild(o);return}if(o.nodeName==="BR"){if(r||!o.nextSibling){e.removeChild(o);return}r=!0}else r=!1});e.firstChild&&e.firstChild.nodeName==="BR";)e.removeChild(e.firstChild);for(;e.lastChild&&e.lastChild.nodeName==="BR";)e.removeChild(e.lastChild);if(!(e.textContent?e.textContent.trim():"")&&!e.querySelector(".gear-item")){const o=e.closest("tr"),a=o?o.closest("tbody"):null;a&&a.classList.contains("auto-gear-category")&&a.remove()}}function wne(e){if(!e||!e.length)return null;const t=e.find(l=>l.nodeType===1&&l.classList&&l.classList.contains("gear-item"));if(t){const l=Gg(t)||(t.textContent||"").replace(/^(\d+)x\s+/,"").trim(),c=yw(t);return{span:t,name:l,count:c}}const r=document.createElement("div");e.forEach(l=>r.appendChild(l.cloneNode(!0)));let n=r.innerHTML.replace(/<select[\s\S]*?<\/select>/gi,""),o;do o=n,n=n.replace(/<[^>]+>/g,"");while(n!==o);let a=n.trim();if(!a)return null;const i=a.match(/^(\d+)x\s+/);let s=1;return i&&(s=parseInt(i[1],10),a=a.slice(i[0].length).trim()),{span:null,name:a,count:s,wrapper:r}}function Lne(e,t,r){if(!e.length)return;let n=!1;for(const o of e)if(o.nodeType===Node.TEXT_NODE){const a=o.textContent||"";if(/\d+x\s+/i.test(a)){o.textContent=a.replace(/^(\s*)(\d+)x\s+/,(i,s)=>`${s}${r}x `),n=!0;break}if(a.trim()){o.textContent=`${r}x ${a.trim().replace(/^(\d+)x\s+/,"")}`,n=!0;break}}else if(o.nodeType===1){const a=o.firstChild;if(a&&a.nodeType===Node.TEXT_NODE&&/\d+x\s+/i.test(a.textContent||"")){a.textContent=(a.textContent||"").replace(/^(\s*)(\d+)x\s+/,(i,s)=>`${s}${r}x `),n=!0;break}}if(!n){const o=e[0],a=o.parentNode;a&&a.insertBefore(document.createTextNode(`${r}x ${t.name}`),o)}}function c0(e,t,r){if(!e)return normalizeAutoGearQuantity(t.quantity);let n=typeof r=="number"?r:normalizeAutoGearQuantity(t.quantity);if(n<=0)return n;const o=Array.from(e.childNodes);if(!o.length)return n;const a=[];let i=[];o.forEach(l=>{l.nodeName==="BR"?(a.push({nodes:i,separator:l}),i=[]):i.push(l)}),a.push({nodes:i,separator:null});let s=!1;return a.forEach(l=>{if(!l.nodes.length||n<=0)return;const c=wne(l.nodes);if(!(!c||!c.name||!EW(t.name,c.name)))if(c.span){const u=c.count;u>n?(sM(c.span,u-n),n=0):(n-=u,l.nodes.forEach(f=>f.remove())),s=!0}else c.count>n&&c.count>1?(Lne(l.nodes,c,c.count-n),n=0,s=!0):(n-=c.count,l.nodes.forEach(u=>u.remove()),s=!0)}),s&&Cne(e),n}function u0(e){if(typeof e!="string")return"";const t=e.trim();return t?((texts[currentLang]||texts.en||{}).crewRoles||texts.en?.crewRoles||{})?.[t]||t:""}function lM(e){if(!e||typeof e!="object")return"";const t=typeof e.label=="string"?e.label.trim():"";if(t)return t;const r=Array.isArray(e.scenarios)?e.scenarios.filter(Boolean):[];if(r.length)return r.join(" + ");const n=Array.isArray(e.camera)?e.camera.filter(Boolean):[];if(n.length)return n.join(" + ");const o=Array.isArray(e.monitor)?e.monitor.filter(Boolean):[];if(o.length)return o.join(" + ");const a=Array.isArray(e.crewPresent)?e.crewPresent.filter(Boolean):[];if(a.length)return a.map(u0).join(" + ");const i=Array.isArray(e.crewAbsent)?e.crewAbsent.filter(Boolean):[];if(i.length)return i.map(u0).join(" + ");const s=Array.isArray(e.wireless)?e.wireless.filter(Boolean):[];if(s.length)return s.join(" + ");const l=Array.isArray(e.motors)?e.motors.filter(Boolean):[];if(l.length)return l.join(" + ");const c=Array.isArray(e.controllers)?e.controllers.filter(Boolean):[];if(c.length)return c.join(" + ");const u=Array.isArray(e.distance)?e.distance.filter(Boolean):[];if(u.length)return u.join(" + ");const f=Array.isArray(e.mattebox)?e.mattebox.filter(Boolean):[];if(f.length)return f.join(" + ");const d=Array.isArray(e.cameraHandle)?e.cameraHandle.filter(Boolean):[];if(d.length)return d.join(" + ");const p=Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.filter(Boolean).map(getViewfinderFallbackLabel):[];if(p.length)return p.join(" + ");const h=Array.isArray(e.videoDistribution)?e.videoDistribution.filter(Boolean).map(getVideoDistributionFallbackLabel):[];return h.length?h.join(" + "):""}function AW(e){const t=texts[currentLang]||texts.en||{},r=t.autoGearRuleTooltipUnnamed||texts.en?.autoGearRuleTooltipUnnamed||"Added by automatic gear rule";if(!e||typeof e!="object")return r;const n=lM(e);return n?(t.autoGearRuleTooltipNamed||texts.en?.autoGearRuleTooltipNamed||`${r}: %s`).replace("%s",n):r}function CW(e){if(!e||typeof e!="object")return null;const t=typeof e.id=="string"?e.id.trim():"",r=lM(e);return!t&&!r?null:{id:t,label:r}}function Rne(e){if(!e)return null;if(typeof e=="string"){const n=e.trim();return n?{id:"",label:n}:null}if(typeof e!="object")return null;const t=typeof e.id=="string"?e.id.trim():"",r=typeof e.label=="string"?e.label.trim():"";return!t&&!r?null:{id:t,label:r}}function sP(e){if(!Array.isArray(e)||!e.length)return[];const t=new Set,r=[];return e.forEach(n=>{const o=Rne(n);if(!o)return;const a=o.id?o.id.toLowerCase():"",i=o.label?o.label.toLowerCase():"",s=a?`id:${a}`:i?`label:${i}`:"";!s||t.has(s)||(t.add(s),r.push({id:o.id,label:o.label}))}),r}function kx(e,t){const r=typeof t=="string"?t:t==null?"":String(t),n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{};return typeof n.formatAutoGearSelectorValue=="function"?n.formatAutoGearSelectorValue(e,r):typeof fn=="function"&&(e==="monitor"||e==="directorMonitor")?fn(r):r}function kb(e){if(!e||!e.dataset)return[];const t=e.dataset,r=typeof t.autoGearRuleSources=="string"?t.autoGearRuleSources:"";let n=[];if(r)try{const o=JSON.parse(r);Array.isArray(o)&&(n=sP(o))}catch(o){console.warn("Failed to parse automatic gear rule metadata",o),n=[]}return n.length||(n=sP([{id:t.autoGearRuleId,label:t.autoGearRuleLabel}])),n}function nR(e,t){if(!e||!e.dataset)return;const r=sP(t),n=e.dataset;if(!r.length){delete n.autoGearRuleSources,delete n.autoGearRuleId,delete n.autoGearRuleLabel;return}try{n.autoGearRuleSources=JSON.stringify(r)}catch(a){console.warn("Failed to serialize automatic gear rule metadata",a)}const o=r[0];o.id?n.autoGearRuleId=o.id:delete n.autoGearRuleId,o.label?n.autoGearRuleLabel=o.label:delete n.autoGearRuleLabel}function wW(e,t){if(!e||!e.dataset)return;const r=CW(t),n=kb(e);r&&n.push(r),nR(e,n)}function hw(e){if(!Array.isArray(e)||!e.length)return"";const t=e.map(r=>{if(!r)return"";const n=typeof r.label=="string"?r.label.trim():"";return n||(typeof r.id=="string"?r.id.trim():"")}).filter(Boolean);return t.length?AW({label:t.join(", ")}):""}function cM(e){if(!e||!e.dataset||!e.dataset.autoGearContextCounts)return new Map;try{const t=JSON.parse(e.dataset.autoGearContextCounts);if(!t||typeof t!="object")return new Map;const r=new Map;return Object.keys(t).forEach(n=>{const o=n&&n.trim();if(!o)return;const a=Number(t[n]);!Number.isFinite(a)||a<=0||r.set(o,a)}),r}catch{return new Map}}function LW(e,t){if(!e||!e.dataset)return;if(!t||!(t instanceof Map)||t.size===0){delete e.dataset.autoGearContextCounts;return}const r={};t.forEach((o,a)=>{a&&(!Number.isFinite(o)||o<=0||(r[a]=o))}),Object.keys(r).length?e.dataset.autoGearContextCounts=JSON.stringify(r):delete e.dataset.autoGearContextCounts}const f0=new Map([["director handheld",1],["gaffer handheld",2],["dop handheld",3]]);function Tne(e,t,r){if(!e||!e.dataset)return;const n=new Map,o=Math.max(0,Number(r)||0);Array.isArray(t)&&t.forEach(a=>{const i=a&&a.trim();i&&n.set(i,(n.get(i)||0)+o)}),LW(e,n),Bu(e)}function RW(e,t,r){if(!e||!e.dataset){Bu(e);return}if(!Array.isArray(t)||!t.length){Bu(e);return}const n=cM(e),o=Math.max(0,Number(r)||0);if(o<=0){Bu(e);return}t.forEach(a=>{const i=a&&a.trim();i&&n.set(i,(n.get(i)||0)+o)}),LW(e,n),Bu(e)}function Bu(e){if(!e)return;const t=cM(e),r=Array.from(t.entries()).filter(([,i])=>Number.isFinite(i)&&i>0);let n=e.querySelector(".auto-gear-context-notes");if(r.length<=1){n&&n.remove();return}const a=` (${r.sort(([i],[s])=>{const l=f0.get(i.trim().toLowerCase())??Number.POSITIVE_INFINITY,c=f0.get(s.trim().toLowerCase())??Number.POSITIVE_INFINITY;return l!==c?l-c:i.localeCompare(s,void 0,{sensitivity:"base"})}).map(([i,s])=>`${s}x ${i}`).join(", ")})`;if(!n){n=document.createElement("span"),n.className="auto-gear-context-notes";const i=e.querySelector(".auto-gear-selector-container"),s=e.querySelector(".auto-gear-notes"),l=i||s;l&&l.parentNode===e?e.insertBefore(n,l):e.appendChild(n)}n.textContent=a}function d0(e){if(!e)return;const t=e.options[e.selectedIndex],r=t?t.text:"",n=document.createElement("span"),o=window.getComputedStyle(e);n.style.fontFamily=o.fontFamily,n.style.fontSize=o.fontSize,n.style.fontWeight=o.fontWeight,n.style.letterSpacing=o.letterSpacing,n.style.textTransform=o.textTransform,n.style.visibility="hidden",n.style.position="absolute",n.style.whiteSpace="pre",n.textContent=r,document.body.appendChild(n);const a=n.getBoundingClientRect().width;document.body.removeChild(n),e.style.width=`calc(${a}px + 2.5em)`}function lP(e,t,r,n){if(!e||!t)return;const o=t.name?t.name.trim():"";if(!o)return;const a=Mg(),i=a&&typeof a.noteLabel=="string"?a.noteLabel.trim():"",s=e.classList&&e.classList.contains("gear-item-rental-excluded")||e.getAttribute?.("data-rental-excluded")==="true",l=!!e.querySelector("select, input");if(!l)for(;e.firstChild;)e.removeChild(e.firstChild);if(e.classList.add("gear-item"),e.classList.add("auto-gear-item"),e.setAttribute("data-gear-name",o),i?e.setAttribute("data-rental-note",i):e.removeAttribute&&e.removeAttribute("data-rental-note"),e.dataset&&delete e.dataset.autoGearContextCounts,e.dataset){const h=CW(n);nR(e,h?[h]:[])}const c=kb(e),u=c.length?hw(c):AW(n);if(u?e.title=u:e.removeAttribute("title"),l)sM(e,r);else{const h=typeof fn=="function"?fn(o):o;e.appendChild(document.createTextNode(`${r}x ${h}`)),t.screenSize&&e.appendChild(document.createTextNode(` - ${t.screenSize}`))}e.dataset&&(t.ownGearId?e.dataset.autoGearOwnGearId=t.ownGearId:Object.prototype.hasOwnProperty.call(e.dataset,"autoGearOwnGearId")&&delete e.dataset.autoGearOwnGearId),t.ownGearId&&iM(e,"user"),Array.isArray(t.contextNotes)&&t.contextNotes.length?Tne(e,t.contextNotes,r):Bu(e);const f=t.selectorType||"none",d=t.selectorDefault||"",p=getAutoGearSelectorLabel(f);if(!l&&f&&f!=="none")if(t.selectorEnabled){const h=getAutoGearSelectorOptions(f,t),g=`autoGearSelector_${n&&n.id?n.id.replace(/[^a-zA-Z0-9_-]/g,""):"rule"}_${t.id}`,S=document.createElement("select");S.id=g,S.className="auto-gear-selector",S.dataset.autoGearSelectorType=f,t.selectorContext&&(S.dataset.autoGearSelectorContext=t.selectorContext),p&&S.setAttribute("aria-label",p);let y="";if(h.forEach(L=>{const v=document.createElement("option");v.value=L,v.textContent=kx(f,L),!y&&d&&L.toLowerCase()===d.toLowerCase()&&(y=v.value),S.appendChild(v)}),d&&!y){const L=document.createElement("option");L.value=d,L.textContent=kx(f,d),S.insertBefore(L,S.firstChild),y=d}if(y?S.value=y:S.options.length&&(S.selectedIndex=0),!S.options.length){const L=document.createElement("option");L.value="",L.textContent=p||"",L.disabled=!0,L.selected=!0,S.appendChild(L),S.disabled=!0}const E=document.createElement("span");E.className="auto-gear-selector-container",E.appendChild(S),e.appendChild(document.createTextNode(" - ")),e.appendChild(E),requestAnimationFrame(()=>{d0(S)}),S.addEventListener("change",()=>{d0(S)})}else if(d){const h=kx(f,d);e.appendChild(document.createTextNode(` - ${p}: ${h}`))}else p&&e.appendChild(document.createTextNode(` - ${p}`));if(e.dataset&&(t.notes?e.dataset.autoGearNotes=t.notes:Object.prototype.hasOwnProperty.call(e.dataset,"autoGearNotes")&&delete e.dataset.autoGearNotes),t.notes){const h=t.notes.trim().toLowerCase().startsWith("incl")?" ":"  ",m=document.createElement("span");m.className="auto-gear-notes",m.textContent=`${h}${t.notes}`,e.appendChild(m)}pS(e,s),sR(e,n),lR(e)}function One(e,t,r){if(!e)return;const n=normalizeAutoGearItem(t);if(!n)return;const o=normalizeAutoGearQuantity(n.quantity);if(o<=0)return;const a=n.name?n.name.trim():"";if(!a)return;const i=Array.from(e.querySelectorAll(".gear-item")),s=iP(n.notes);for(const c of i){const u=Gg(c)||(c.textContent||"").replace(/^(\d+)x\s+/,"").trim();if(EW(a,u)){const f=bne(c);if(s){if(c.classList.contains("auto-gear-item")){if(!f||f!==s)continue}else if(f&&f!==s)continue}else if(c.classList.contains("auto-gear-item")&&f)continue;if(c.classList.contains("auto-gear-item")){const d=yw(c)+o;sM(c,d),Array.isArray(n.contextNotes)&&n.contextNotes.length?RW(c,n.contextNotes,o):Bu(c),c.dataset&&(n.notes?c.dataset.autoGearNotes=n.notes:Object.prototype.hasOwnProperty.call(c.dataset,"autoGearNotes")&&delete c.dataset.autoGearNotes),r&&typeof r=="object"?wW(c,r):c.dataset&&nR(c,kb(c));const p=hw(kb(c));p?c.title=p:c.removeAttribute("title"),sR(c,r),lR(c)}else{const p=yw(c)+o;lP(c,n,p,r)}return}}e.childNodes.length&&e.appendChild(document.createElement("br"));const l=document.createElement("span");lP(l,n,o,r),e.appendChild(l)}function xne(e,t){const r=t&&typeof t=="string"?t.trim():String(t??"").trim(),n=r.toLowerCase(),o=r||AUTO_GEAR_CUSTOM_CATEGORY,a=Array.from(e.querySelectorAll("tbody.category-group")).find(d=>{if(d.dataset){const E=(d.dataset.autoCategory||"").trim().toLowerCase();if(n&&E===n)return!0;const L=(d.dataset.gearTableCategory||"").trim().toLowerCase();if(n&&L===n)return!0}const p=(d.getAttribute("data-auto-category")||"").trim().toLowerCase();if(n&&p===n)return!0;const h=(d.getAttribute("data-gear-table-category")||"").trim().toLowerCase();if(n&&h===n)return!0;const m=d.querySelector(".category-row td");if(!m)return!1;const g=(m.getAttribute("data-gear-category-label")||"").trim().toLowerCase();if(n&&g===n)return!0;let S=m.textContent.trim();S.endsWith("+")&&(S=S.substring(0,S.length-1).trim());const y=S.toLowerCase();return n?y===n:d.classList.contains("auto-gear-category")||y===o.toLowerCase()});if(a)return a.querySelector("tr:not(.category-row) td")||null;const i=document.createElement("tbody");i.className="category-group auto-gear-category",i.dataset.autoCategory=r,i.dataset.gearTableCategory=r||o;const s=document.createElement("tr");s.className="category-row";const l=document.createElement("td"),c=r||texts[currentLang]?.autoGearCustomCategory||texts.en?.autoGearCustomCategory||"Custom Additions";l.setAttribute("data-gear-category-label",c),l.textContent=c,s.appendChild(l),i.appendChild(s);const u=document.createElement("tr"),f=document.createElement("td");return u.appendChild(f),i.appendChild(u),e.appendChild(i),f}function kne(e,t){if(!e)return null;const r=t&&typeof t=="string"?t.trim():String(t??"").trim(),n=r.toLowerCase(),o=r||AUTO_GEAR_CUSTOM_CATEGORY,a=Array.from(e.querySelectorAll("tbody.category-group"));for(const i of a){if(i.dataset){const p=(i.dataset.autoCategory||"").trim().toLowerCase();if(n&&p===n){const m=i.querySelector("tr:not(.category-row) td");if(m)return m}const h=(i.dataset.gearTableCategory||"").trim().toLowerCase();if(n&&h===n){const m=i.querySelector("tr:not(.category-row) td");if(m)return m}}const s=(i.getAttribute("data-auto-category")||"").trim().toLowerCase();if(n&&s===n){const p=i.querySelector("tr:not(.category-row) td");if(p)return p}const l=(i.getAttribute("data-gear-table-category")||"").trim().toLowerCase();if(n&&l===n){const p=i.querySelector("tr:not(.category-row) td");if(p)return p}const c=i.querySelector(".category-row td");if(!c)continue;const u=(c.getAttribute("data-gear-category-label")||"").trim().toLowerCase();if(n&&u===n){const p=i.querySelector("tr:not(.category-row) td");if(p)return p}let f=c.textContent.trim();f.endsWith("+")&&(f=f.substring(0,f.length-1).trim());const d=f.toLowerCase();if(n){if(d===n){const p=i.querySelector("tr:not(.category-row) td");if(p)return p}}else if(i.classList.contains("auto-gear-category")||d===o.toLowerCase()){const p=i.querySelector("tr:not(.category-row) td");if(p)return p}}return null}function Ine(e){if(typeof e!="string")return"all";const t=e.trim().toLowerCase();return t?t==="or"?"any":t==="and"?"all":t==="any"?"any":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":"all":"all"}function Pne(e){const t=parseInt(e,10);return Number.isFinite(t)&&t>1?t:1}function Bne(e,t){if(!e||typeof e!="object")return{active:!0,multiplier:1};const r=Array.isArray(e.scenarios)?e.scenarios.filter(Boolean):[];if(!r.length)return{active:!0,multiplier:1};const n=r.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!n.length)return{active:!1,multiplier:0};const o=Ine(e.scenarioLogic);if(o==="any"){const i=n.some(s=>t.has(s));return{active:i,multiplier:i?1:0}}if(o==="multiplier"){const i=typeof e.scenarioPrimary=="string"?e.scenarioPrimary:"",s=normalizeAutoGearTriggerValue(i);let l="";if(s&&n.includes(s)?l=s:l=n[0]||"",!l||!t.has(l))return{active:!1,multiplier:0};const c=n.filter(d=>d!==l);if(!c.length)return{active:!0,multiplier:1};const u=c.every(d=>t.has(d)),f=Pne(e.scenarioMultiplier);return{active:!0,multiplier:u?f:1}}const a=n.every(i=>t.has(i));return{active:a,multiplier:a?1:0}}function Gne(e){return Number.isFinite(e)?Number(e).toFixed(3):""}function Mne(e){if(!Number.isFinite(e))return"";const t=Number(Number(e).toFixed(2));return Number.isFinite(t)?String(t):""}function _ne(e){if(!e||typeof e!="object")return!1;const t=Array.isArray(e.mattebox)?e.mattebox.filter(Boolean):[];if(!t.length)return!1;const r=t.map(n=>normalizeAutoGearTriggerValue(n).replace(/-/g," ")).filter(Boolean);return r.length?r.includes("clamp on"):!1}function Dne(e){const t=Ob(e?e.lenses:null);if(!t.length)return[];const r=devices&&devices.lenses?devices.lenses:null;if(!r||typeof r!="object")return[];const n=new Map;Object.keys(r).forEach(i=>{if(typeof i!="string"||!i)return;const s=i.trim().toLowerCase();s&&!n.has(s)&&n.set(s,r[i])});const o=new Map;return t.forEach(i=>{if(typeof i!="string")return;const s=i.trim();if(!s)return;const l=s.toLowerCase();let c=Object.prototype.hasOwnProperty.call(r,s)?r[s]:null;if(!c&&n.has(l)&&(c=n.get(l)),!c||typeof c!="object")return;const u=Number(c.frontDiameterMm);if(!Number.isFinite(u)||u<=0)return;const f=Gne(u);if(!f)return;o.has(f)||o.set(f,{diameter:u,lenses:[]});const d=o.get(f);d.lenses.indexOf(s)===-1&&d.lenses.push(s)}),o.size?Array.from(o.values()).sort((i,s)=>i.diameter===s.diameter?0:i.diameter<s.diameter?-1:1).map(({diameter:i,lenses:s})=>{const c={name:`Mattebox Clamp-On Backing ${Mne(i)||String(Number(i))}mm`,category:"Matte box + filter",quantity:1};return Array.isArray(s)&&s.length&&(c.contextNotes=[`Lenses: ${s.join(", ")}`]),c}):[]}function Nne(e,t){const r=[],n=new Set,o=a=>{if(!a||typeof a!="object")return;const i=typeof a.name=="string"?a.name.trim():"";if(!i)return;const s=typeof a.category=="string"?a.category.trim():"",l=`${i.toLowerCase()}|${s.toLowerCase()}`;n.has(l)||(n.add(l),r.push(a))};return e.forEach(o),t.forEach(o),r}function Fne(e,t){const r=typeof getEnabledAutoGearRules=="function"?getEnabledAutoGearRules():autoGearRules.filter(Y=>!Y||Y.enabled!==!1);if(!e||!r.length||typeof document>"u")return e;const n=t&&t.requiredScenarios?t.requiredScenarios.split(",").map(Y=>Y.trim()).filter(Boolean):[],o=new Set(n.map(normalizeAutoGearTriggerValue).filter(Boolean)),a=t&&typeof t.mattebox=="string"?t.mattebox.trim():"",i=normalizeAutoGearTriggerValue(a),l=(t&&typeof t.cameraHandle=="string"?t.cameraHandle.split(",").map(Y=>Y.trim()).filter(Boolean):[]).map(normalizeAutoGearTriggerValue).filter(Boolean),c=new Set(l),u=t&&typeof t.viewfinderExtension=="string"?t.viewfinderExtension.trim():"",d=!!u?normalizeAutoGearTriggerValue(u):"",p=t&&typeof t.deliveryResolution=="string"?t.deliveryResolution.trim():"",h=normalizeAutoGearTriggerValue(p);let m=[];t&&Array.isArray(t.videoDistribution)?m=t.videoDistribution:t&&typeof t.videoDistribution=="string"&&(m=t.videoDistribution.split(",").map(Y=>Y.trim()).filter(Boolean));const g=m.map(DH).map(Y=>Y==="__none__"?"":normalizeAutoGearTriggerValue(Y)).filter(Boolean),S=new Set(g),y=t&&typeof t.cameraSelection=="string"?t.cameraSelection.trim():"",E=normalizeAutoGearTriggerValue(y),L=devices&&devices.cameras?devices.cameras:null,v=(()=>{if(!L)return null;const Y={};return Object.keys(L).forEach(ee=>{const Ae=L[ee];if(!Ae||!Number.isFinite(Ae.weight_g))return;const ve=normalizeAutoGearTriggerValue(ee);ve&&!Object.prototype.hasOwnProperty.call(Y,ve)&&(Y[ve]=Number(Ae.weight_g))}),Y})(),A=(()=>{if(!L)return null;const Y=y&&Object.prototype.hasOwnProperty.call(L,y)?L[y]:null;return Y&&Number.isFinite(Y.weight_g)?Number(Y.weight_g):!E||!v?null:Object.prototype.hasOwnProperty.call(v,E)?v[E]:null})(),R=t&&typeof t.monitorSelection=="string"?t.monitorSelection.trim():"",I=normalizeAutoGearTriggerValue(R),C=(()=>{if(typeof getAutoGearOwnGearItems!="function")return new Set;try{const Y=getAutoGearOwnGearItems();return new Set((Array.isArray(Y)?Y:[]).map(ee=>ee&&typeof ee.id=="string"?ee.id.trim():"").filter(Boolean))}catch{return new Set}})(),k=t&&typeof t.wirelessSelection=="string"?t.wirelessSelection.trim():"",_=normalizeAutoGearTriggerValue(k),w=t&&typeof t.tripodHeadBrand=="string"?t.tripodHeadBrand.trim():"",x=normalizeAutoGearTriggerValue(w),G=t&&typeof t.tripodBowl=="string"?t.tripodBowl.trim():"",T=normalizeAutoGearTriggerValue(G),P=Array.isArray(t?.tripodTypes)?t.tripodTypes:typeof t?.tripodTypes=="string"?t.tripodTypes.split(",").map(Y=>Y.trim()).filter(Boolean):[],N=new Set(P.map(Y=>normalizeAutoGearTriggerValue(Y)).filter(Boolean)),q=t&&typeof t.tripodSpreader=="string"?t.tripodSpreader.trim():"",Z=normalizeAutoGearTriggerValue(q),U=new Set(Array.isArray(t?.people)?t.people.map(Y=>Y&&typeof Y.role=="string"?Y.role.trim():"").filter(Boolean).map(Y=>normalizeAutoGearTriggerValue(Y)).filter(Boolean):[]),K=[];t&&(Array.isArray(t.motorSelections)&&K.push(...t.motorSelections),Array.isArray(t.motors)&&K.push(...t.motors));const H=new Set(K.filter(Y=>typeof Y=="string").map(Y=>normalizeAutoGearTriggerValue(Y)).filter(Boolean)),te=[];t&&(Array.isArray(t.controllerSelections)&&te.push(...t.controllerSelections),Array.isArray(t.controllers)&&te.push(...t.controllers));const re=new Set(te.filter(Y=>typeof Y=="string").map(Y=>normalizeAutoGearTriggerValue(Y)).filter(Boolean)),fe=Y=>{if(typeof Y!="string")return 0;const ee=Y.trim();if(!ee)return 0;const Ae=ee.split(" to ");let ve=Ae[0]?Ae[0].trim():"",se=Ae[1]?Ae[1].trim():"";if(!ve&&se&&(ve=se),!se&&ve&&(se=ve),!ve)return 0;const de=xe=>xe?Date.parse(`${xe}T00:00:00Z`):NaN,be=de(ve);let ye=de(se);return Number.isFinite(be)?(Number.isFinite(ye)||(ye=be),ye<be?1:Math.floor((ye-be)/(1440*60*1e3))+1):0},Te=(t?Array.isArray(t.shootingDays)?t.shootingDays:typeof t.shootingDays=="string"?t.shootingDays.split(`
`).map(Y=>Y.trim()).filter(Boolean):[]:[]).reduce((Y,ee)=>Y+fe(ee),0),Ne=t&&typeof t.distanceSelection=="string"?t.distanceSelection.trim():"",Ie=normalizeAutoGearTriggerValue(Ne);if(!n.length&&!r.some(ee=>(Array.isArray(ee.scenarios)?ee.scenarios.filter(Boolean):[]).length===0))return e;const et=Y=>{if(!Y||typeof Y!="object")return!1;const ee=[];return Array.isArray(Y.add)&&ee.push(Y.add),Array.isArray(Y.remove)&&ee.push(Y.remove),ee.some(Ae=>Ae.some(ve=>!ve||typeof ve!="object"?!1:(typeof ve.category=="string"?ve.category.trim().toLowerCase():"")==="matte box + filter"))},Ze=[];if(r.forEach(Y=>{if(!Y)return;let ee=1;if(Y.always)ee=1;else{const De=Bne(Y,o);if(!De.active)return;ee=De.multiplier||1}const Ae=Array.isArray(Y.mattebox)?Y.mattebox.filter(Boolean):[];if(Ae.length){const De=Ae.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!i||!De.includes(i))return!1}const ve=Array.isArray(Y.camera)?Y.camera.filter(Boolean):[],se=normalizeAutoGearCameraWeightCondition(Y.cameraWeight);if(ve.length){const De=ve.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!E||!De.includes(E))return!1}const de=Array.isArray(Y.ownGear)?Y.ownGear.filter(Boolean):[];if(de.length){const De=de.map(Yt=>typeof Yt=="string"?Yt.trim():"").filter(Boolean);if(!De.length)return!1;const vt=normalizeAutoGearConditionLogic(Y.ownGearLogic);if(vt==="none"){if(De.some(Yt=>C.has(Yt)))return!1}else if(vt==="any"||vt==="or"){if(!De.some(Yt=>C.has(Yt)))return!1}else if(!De.every(Yt=>C.has(Yt)))return!1}if(se&&(!Number.isFinite(A)||!evaluateAutoGearCameraWeightCondition(se,A)))return!1;const be=Array.isArray(Y.monitor)?Y.monitor.filter(Boolean):[];if(be.length){const De=be.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!I||!De.includes(I))return!1}const ye=Array.isArray(Y.tripodHeadBrand)?Y.tripodHeadBrand.filter(Boolean):[];if(ye.length){const De=ye.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!x||!De.includes(x))return!1}const $e=Array.isArray(Y.tripodBowl)?Y.tripodBowl.filter(Boolean):[];if($e.length){const De=$e.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!T||!De.includes(T))return!1}const xe=Array.isArray(Y.tripodTypes)?Y.tripodTypes.filter(Boolean):[];if(xe.length){const De=xe.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!De.every(vt=>N.has(vt)))return!1}const St=Array.isArray(Y.tripodSpreader)?Y.tripodSpreader.filter(Boolean):[];if(St.length){const De=St.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!Z||!De.includes(Z))return!1}const Tt=Array.isArray(Y.crewPresent)?Y.crewPresent.filter(Boolean):[];if(Tt.length){const De=Tt.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!De.every(vt=>U.has(vt)))return!1}const xt=Array.isArray(Y.crewAbsent)?Y.crewAbsent.filter(Boolean):[];if(xt.length){const De=xt.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||De.some(vt=>U.has(vt)))return!1}const ut=Array.isArray(Y.wireless)?Y.wireless.filter(Boolean):[];if(ut.length){const De=ut.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!_||!De.includes(_))return!1}const Er=Array.isArray(Y.motors)?Y.motors.filter(Boolean):[];if(Er.length){const De=Er.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length)return!1;const vt=De.includes(NH),Yt=De.filter(j=>j!==NH);if(vt&&H.size===0||Yt.length&&!Yt.every(j=>H.has(j)))return!1}const zt=Array.isArray(Y.controllers)?Y.controllers.filter(Boolean):[];if(zt.length){const De=zt.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!De.every(vt=>re.has(vt)))return!1}const dr=Array.isArray(Y.distance)?Y.distance.filter(Boolean):[];if(dr.length){const De=dr.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!Ie||!De.includes(Ie))return!1}const Jt=normalizeAutoGearShootingDaysCondition(Y.shootingDays);if(Jt&&Number.isFinite(Jt.value)&&Jt.value>0){if(Jt.mode==="minimum"){if(Te<Jt.value)return!1}else if(Jt.mode==="maximum"){if(Te>Jt.value)return!1}else if(Jt.mode==="every"){const De=Jt.value,vt=De>0?Math.floor(Te/De):0;if(vt<1)return!1;ee*=vt}}const rr=Array.isArray(Y.cameraHandle)?Y.cameraHandle.filter(Boolean):[];if(rr.length){const De=rr.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!De.every(vt=>c.has(vt)))return!1}const Jn=Array.isArray(Y.viewfinderExtension)?Y.viewfinderExtension.filter(Boolean):[];if(Jn.length){const De=Jn.map(vt=>normalizeAutoGearTriggerValue(vt)).filter(Boolean);if(!De.length||!d||!De.includes(d))return!1}const nr=Array.isArray(Y.deliveryResolution)?Y.deliveryResolution.filter(Boolean):[];if(nr.length){const De=nr.map(normalizeAutoGearTriggerValue).filter(Boolean);if(!De.length||!h||!De.includes(h))return!1}const $n=Array.isArray(Y.videoDistribution)?Y.videoDistribution.filter(Boolean):[];if($n.length){const De=$n.map(vt=>DH(vt)).map(vt=>vt==="__none__"?"":normalizeAutoGearTriggerValue(vt)).filter(Boolean);if(!De.length||!De.every(vt=>S.has(vt)))return!1}Ze.push({rule:Y,multiplier:ee})}),!Ze.length)return e;if(i){const Y=Ze.filter(({rule:ee})=>{if(!et(ee))return!0;const Ae=Array.isArray(ee.mattebox)?ee.mattebox.filter(Boolean):[];if(!Ae.length)return!0;const ve=Ae.map(normalizeAutoGearTriggerValue).filter(Boolean);return ve.length?ve.includes(i):!1});if(!Y.length)return e;Ze.length=0,Y.forEach(ee=>Ze.push(ee))}const Ft=document.createElement("div");Ft.innerHTML=e;const Ye=Ft.querySelector(".gear-table");if(!Ye)return e;let ct=!1;return Ze.forEach(({rule:Y,multiplier:ee})=>{const Ae=Math.max(1,Math.round(Number.isFinite(ee)?ee:1));Y.remove.forEach(de=>{let be=normalizeAutoGearQuantity(de.quantity)*Ae;if(be<=0)return;const ye=kne(Ye,de.category);if(ye&&(be=c0(ye,de,be)),be>0){const $e=Array.from(Ye.querySelectorAll("tbody.category-group tr:not(.category-row) td"));for(const xe of $e)if(xe!==ye&&(be=c0(xe,de,be),be<=0))break}});const ve=Array.isArray(Y.add)?Y.add.slice():[];let se=ve;if(_ne(Y)){const de=Dne(t);de.length&&(se=Nne(ve,de))}se.forEach(de=>{const be=normalizeAutoGearQuantity(de.quantity)*Ae,ye=be===normalizeAutoGearQuantity(de.quantity)?de:{...de,quantity:be},$e=xne(Ye,de.category);$e&&One($e,ye,Y),!ct&&vne(de)&&(ct=!0)})}),ct&&Ane(Ye),Ft.innerHTML}function p0(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.replace(/[^0-9+*#;,]/g,"");return r||""}function m0(e){if(typeof e!="string")return"";const t=e.trim();if(!t||!t.includes("@"))return"";const r=t.replace(/\s+/g,"");if(!r||!r.includes("@"))return"";const n=encodeURIComponent(r);return n?n.replace(/%40/g,"@"):""}function jne(e){if(e&&typeof e=="object"){if(typeof e.__html=="string"&&e.__html)return e.__html;if(Array.isArray(e)&&e.length){const r=e.map(n=>Be(typeof n=="string"?n:String(n||""))).join("<br>");if(r)return r}if(typeof e.text=="string"&&e.text)return Be(e.text).replace(/\n/g,"<br>")}const t=typeof e=="string"?e:e==null?"":String(e);return Be(t).replace(/\n/g,"<br>")}function Vi(e,t,r){const n=texts?.[currentLang]?.[e],o=texts?.en?.[e],a=typeof n=="string"&&n.trim()?n:typeof o=="string"&&o.trim()?o:t;return!r||typeof r!="object"?a:Object.keys(r).reduce((i,s)=>{const l=r[s],c=typeof l=="string"?l:String(l??"");return i.replace(new RegExp(`\\{${s}\\}`,"g"),c)},a)}function Mg(e={}){const t=Vi("gearListExcludeRentalToggle","Exclude for rental"),r=Vi("gearListIncludeRentalToggle","Include for rental"),n=Vi("gearListRentalNote","Rental handles this item"),o=ZK({fallback:n,rentalHouse:e&&e.rentalHouse?e.rentalHouse:void 0,input:e&&e.input?e.input:void 0});return{excludeLabel:t,includeLabel:r,noteLabel:o}}function pS(e,t){if(!e||typeof e!="object")return!1;const r=!!t,n=e.classList?.contains("gear-item-rental-excluded")||e.getAttribute?.("data-rental-excluded")==="true",o=e.querySelector?.(".gear-rental-toggle");if(r?(e.classList?.add("gear-item-rental-excluded"),e.setAttribute?.("data-rental-excluded","true")):(e.classList?.remove("gear-item-rental-excluded"),e.removeAttribute?.("data-rental-excluded")),o){const i=o.getAttribute("data-label-off")||"",s=o.getAttribute("data-label-on")||i;o.setAttribute("aria-pressed",r?"true":"false"),o.textContent=r&&s||i}const{noteLabel:a}=Mg();return a&&e.getAttribute?e.getAttribute("data-rental-note")!==a&&e.setAttribute("data-rental-note",a):e.removeAttribute&&e.removeAttribute("data-rental-note"),n!==r}function bw(e){return typeof e!="string"||!e.trim()?"category":e.trim().toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+/,"").replace(/-+$/,"")||"category"}function uM(e){return!gearListOutput||typeof e!="string"?null:gearListOutput.querySelector(`.gear-custom-items[data-gear-custom-list="${e}"]`)}const Hne={camera:["cameras"],"camera-support":["accessories.cameraSupport"],media:["media","accessories.media","accessories.cardReaders"],lens:["lenses"],"lens-support":["accessories.cameraSupport","accessories.rigging"],"matte-box-filter":["accessories.matteboxes","accessories.filters"],"lds-fiz":["fiz","accessories.cables.fiz"],"camera-batteries":["batteries","accessories.batteries"],"monitoring-batteries":["batteries","accessories.batteries"],chargers:["accessories.chargers"],monitoring:["monitors","directorMonitors","video","videoAssist","iosVideo"],"monitoring-support":["accessories.rigging","accessories.grip","accessories.carts"],rigging:["accessories.rigging","accessories.grip"],power:["accessories.power","accessories.powerPlates"],grip:["accessories.grip"],"carts-and-transportation":["accessories.carts"],miscellaneous:["accessories.matteboxes","accessories.filters","accessories.cables"],consumables:[]};function Une(e){return!e||typeof e!="object"||Array.isArray(e)?!1:Object.values(e).some(t=>{if(t===null)return!0;const r=typeof t;return!!(r==="string"||r==="number"||r==="boolean"||Array.isArray(t))})}function TW(e){if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([r,n])=>{if(!(!n||typeof n!="object")){if(Une(n)){t.push(r);return}t.push(...TW(n))}}),t}function zne(e){if(!e||typeof e!="string")return[];const t=e.split(".");let r=devices;for(let n=0;n<t.length;n+=1){const o=t[n];if(!r||typeof r!="object")return[];r=r[o]}return!r||typeof r!="object"?[]:TW(r)}function $ne(e){if(!gearListOutput||typeof e!="string")return[];const t=gearListOutput.querySelector(`.category-group[data-gear-custom-key="${e}"]`);if(!t)return[];const r=new Set,n=o=>{if(typeof o!="string")return;const a=o.trim();if(!a)return;const i=a.match(/^(?:\d+\s*x\s+)?(.+)$/i),s=i?i[1].trim():a;!s||/^none$/i.test(s)||r.add(s)};return t.querySelectorAll(".gear-standard-items .gear-item").forEach(o=>{const a=Gg(o)||o.getAttribute("data-gear-name");n(a||o.textContent||"")}),t.querySelectorAll("select option").forEach(o=>{if(!o||typeof o.value!="string")return;const a=o.value.trim();a&&n(a)}),Array.from(r)}function Vne(e,t){const r=e||bw(t||""),n=new Set,o=[];(Hne[r]||[]).forEach(s=>{zne(s).forEach(l=>{if(typeof l!="string")return;const c=l.trim();if(!c||/^none$/i.test(c))return;const u=c.toLowerCase();n.has(u)||(n.add(u),o.push(c))})}),$ne(r).forEach(s=>{const l=s.trim();if(!l||/^none$/i.test(l))return;const c=l.toLowerCase();n.has(c)||(n.add(c),o.push(l))});const i=typeof localeSort=="function"?localeSort:(s,l)=>s.localeCompare(l,void 0,{sensitivity:"base"});return o.sort(i)}function qne(e,t){const r=uM(e);if(!r)return null;const n=r.ownerDocument||(typeof document<"u"?document:null);if(!n)return null;const o=Vne(e,t),a=r.querySelector(`datalist[data-gear-custom-suggestions="${e}"]`);if(!o.length)return a&&a.remove(),null;const i=`gear-custom-suggestions-${e}`,s=o.map(c=>`<option value="${Be(c)}"></option>`).join("");let l=a;return l?l.id!==i&&(l.id=i):(l=n.createElement("datalist"),l.id=i,l.setAttribute("data-gear-custom-suggestions",e),r.appendChild(l)),l._lastRenderedOptions!==s&&(l.innerHTML=s,l._lastRenderedOptions=s),i}function fM(e,t,r){if(!e)return;const n=qne(t,r);n?e.setAttribute("data-gear-suggestions",n):e.removeAttribute("data-gear-suggestions")}function OW(e){if(!e)return;const t=e.querySelector(".gear-custom-item-preview");if(!t)return;const r=(e.getAttribute("data-gear-quantity")||"").trim(),n=e.getAttribute("data-gear-label")||e.getAttribute("data-gear-name")||"",o=String(n||"").trim(),a=(e.getAttribute("data-gear-attributes")||"").trim(),i=Vi("gearListCustomItemPreviewFallback","Custom item");let s="";r&&o?s=`${r}x ${o}`:o?s=o:r?s=`${r}x ${i}`:s=i,a&&(s+=` (${a})`),t.textContent=s}function Kne(e,t){if(!e)return;const r=e.querySelector(".gear-item-note");if(!r)return;const n=r.ownerDocument||(typeof document<"u"?document:null),o=typeof Yc=="function"?Yc("gearListNoteLabel"):"",a=typeof o=="string"&&o.trim()?o.trim():"Note:",s=(typeof t=="string"?t:String(t??"")).trim();if(s){let l=r.querySelector(".gear-item-note__label"),c=r.querySelector(".gear-item-note__text");!l&&n&&(l=n.createElement("span"),l.className="gear-item-note__label",r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l)),!c&&n&&(c=n.createElement("span"),c.className="gear-item-note__text",r.appendChild(c)),l&&c?(l.textContent=a,c.textContent=s):r.textContent=`${a} ${s}`,r.hidden=!1,r.removeAttribute("hidden"),r.setAttribute("aria-label",`${a} ${s}`.trim())}else{const l=r.querySelector(".gear-item-note__label"),c=r.querySelector(".gear-item-note__text");l&&(l.textContent=""),c&&(c.textContent=""),r.textContent="",r.hidden=!0,r.setAttribute("hidden",""),r.removeAttribute("aria-label")}}function xW(e){if(!e)return null;let t=e.querySelector(".gear-item-note");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-note",t.hidden=!0;const n=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(n)n.appendChild(t);else{const o=e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");o?e.insertBefore(t,o):e.appendChild(t)}return t}function kW(e){if(!e)return null;let t=e.querySelector(".gear-item-extra-indicator");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-extra-indicator",t.hidden=!0;const n=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(n){const o=n.querySelector(".gear-item-note");o?n.insertBefore(t,o):n.appendChild(t)}else{const o=e.querySelector(".gear-item-note")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");o?e.insertBefore(t,o):e.appendChild(t)}return t}let vE=null;function Wne(){if(vE&&vE.size)return vE;const e=new Set;if(["camera","cameras"].forEach(r=>e.add(r)),typeof Yc=="function"){const r=Yc("category_cameras");typeof r=="string"&&r.trim()&&(e.add(r.trim().toLowerCase()),e.add(bw(r)))}const t=typeof texts=="object"&&texts?texts:null;return t&&typeof Object.keys=="function"&&Object.keys(t).forEach(r=>{const n=t[r];if(!n||typeof n!="object")return;const o=n.category_cameras;if(typeof o=="string"&&o.trim()){const a=o.trim().toLowerCase();e.add(a),e.add(bw(o))}}),vE=e,e}function rp(e){if(!e||typeof e.closest!="function")return!1;const t=e.closest("tbody.category-group");if(!t)return!1;const r=(t.getAttribute("data-gear-category-label")||"").trim().toLowerCase(),n=(t.getAttribute("data-gear-custom-key")||"").trim().toLowerCase(),o=(t.getAttribute("data-gear-table-category")||"").trim().toLowerCase(),a=Wne();return r&&a.has(r)||n&&a.has(n)||o&&a.has(o)}function oR(){if(typeof cameraSelect>"u"||!cameraSelect)return"";const e=cameraSelect.options&&cameraSelect.options[cameraSelect.selectedIndex];if(!e||e.value&&e.value==="None")return"";const t=typeof e.text=="string"?e.text:e.textContent||"";return typeof t=="string"?t.trim():""}function IW(e){if(typeof e!="string")return"";const t=e.trim();return t?/^#[0-9a-f]{6}$/i.test(t)?t.toLowerCase():/^[0-9a-f]{6}$/i.test(t)?`#${t.toLowerCase()}`:"":""}function Yne(e){const t=()=>{let n=0;if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"){const a=new Uint8Array(1);crypto.getRandomValues(a),n=a[0]/255}else n=Math.random();const o=Math.floor(n*200)+28;return Math.max(24,Math.min(232,o))};return`#${[t(),t(),t()].map(n=>n.toString(16).padStart(2,"0")).join("")}`}let DA=null;function Qne(){if(DA)return DA;const e={A:"#d32f2f",B:"#1e88e5",C:"#fdd835",D:"#43a047",E:"#7b1fa2"};let t=null;try{if(typeof localStorage<"u"){const r=localStorage.getItem(FH);r&&(t=JSON.parse(r))}}catch(r){console.warn("Failed to read stored camera colors",r),t=null}if(t&&typeof t=="object")Tb.forEach(r=>{const n=t[r]||t[r.toLowerCase()],o=IW(n);o&&(e[r]=o)});else{const r=Yne();r&&(e.E=r);try{typeof localStorage<"u"&&localStorage.setItem(FH,JSON.stringify(e))}catch(n){console.warn("Unable to persist default camera colors",n)}}return DA=e,e}function Zi(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";if(t.toLowerCase()==="camera")return"A";const r=t[0].toUpperCase();return Tb.includes(r)?r:""}function Xne(){const e=Qne();if(typeof getCameraLetterColors=="function")try{const t=getCameraLetterColors();if(t&&typeof t=="object"){const r={...e};return Tb.forEach(n=>{const o=t[n]||t[n.toLowerCase()],a=IW(o);a&&(r[n]=a)}),r}}catch(t){console.warn("Failed to load camera letter colors",t)}return e}function aR(e){const t=Xne(),r=Zi(e);return r&&t[r]?t[r]:t.A}function Jne(e){if(typeof e!="string"||!e)return"";const t=e.trim().match(/^#?([0-9a-f]{3}|[0-9a-f]{6})$/i);if(!t)return"";let r=t[1];r.length===3&&(r=r.split("").map(s=>s+s).join(""));const n=parseInt(r.slice(0,2),16)/255,o=parseInt(r.slice(2,4),16)/255,a=parseInt(r.slice(4,6),16)/255;return .2126*n+.7152*o+.0722*a>.55?"#111111":"#ffffff"}function Zne(e){const t=gearListOutput||(typeof document<"u"?document:null);if(!t||typeof t.querySelectorAll!="function")return[];const r=t.querySelectorAll('[data-gear-camera-role="source"], [data-gear-camera-letter]'),n=new Map;return r.forEach(o=>{if(!o||typeof o.getAttribute!="function"||!rp(o))return;const a=o.getAttribute("data-gear-camera-letter")||o.getAttribute("data-gear-camera-link")||"",i=Zi(a);if(!i||n.has(i))return;const s=(o.getAttribute("data-gear-camera-link-label")||o.getAttribute("data-gear-label")||o.textContent||"").trim();n.set(i,{letter:i,label:s})}),Array.from(n.values())}function g0(e){const t=gearListOutput||(typeof document<"u"?document:null);if(!t||typeof t.querySelectorAll!="function")return;const r=t.querySelectorAll(".gear-item, .gear-custom-item"),o=os().cameraLinkBadgeLabel;r.forEach(a=>{if(!a||typeof a.getAttribute!="function")return;const i=a.getAttribute("data-gear-camera-link")||a.getAttribute("data-gear-camera-letter")||"",s=Zi(i),l=rp(a),c=a.getAttribute("data-gear-camera-link-label")||(l?oR():"")||"",u=c?`${o}  ${c}`:o,f=s?aR(s):"";PW(a,!!s,{isPrimary:l,badgeLabel:u,letter:s,color:f})})}function eoe(e){if(!e)return null;let t=e.querySelector(".gear-item-camera-link");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;const n=os();t=r.createElement("span"),t.className="gear-item-camera-link",t.hidden=!0,t.setAttribute("data-camera-letter","");const o=r.createElement("span");o.className="gear-item-camera-link__icon",o.setAttribute("aria-hidden","true"),o.textContent="A",t.appendChild(o);const a=r.createElement("span");a.className="visually-hidden",a.setAttribute("data-camera-link-assist","true"),a.textContent=n.cameraLinkBadgeLabel,t.appendChild(a);const i=e.classList&&e.classList.contains("gear-custom-item")?e.querySelector(".gear-custom-item-summary"):null;if(i){const s=i.querySelector(".gear-item-note");s?i.insertBefore(t,s):i.appendChild(t)}else{const s=e.querySelector(".gear-item-note")||e.querySelector(".gear-item-provider")||e.querySelector(".gear-item-extra-indicator")||e.querySelector(".gear-item-edit-btn")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn");s?e.insertBefore(t,s):e.appendChild(t)}return t}function PW(e,t,r={}){const n=eoe(e);if(!n)return;if(!t){n.hidden=!0,n.setAttribute("hidden",""),n.classList.remove("gear-item-camera-link--primary"),n.removeAttribute("data-camera-letter"),n.style.removeProperty("--camera-link-color"),n.style.removeProperty("--camera-link-text-color");return}const o=os();n.hidden=!1,n.removeAttribute("hidden"),n.classList.toggle("gear-item-camera-link--primary",!!r.isPrimary);const a=n.querySelector(".gear-item-camera-link__icon");if(a){const s=Zi(r.letter||r.iconText||"")||"A";a.textContent=s,n.setAttribute("data-camera-letter",s);const l=r.color||aR(s);if(l){n.style.setProperty("--camera-link-color",l);const c=Jne(l);c?n.style.setProperty("--camera-link-text-color",c):n.style.removeProperty("--camera-link-text-color")}else n.style.removeProperty("--camera-link-color"),n.style.removeProperty("--camera-link-text-color")}const i=n.querySelector("[data-camera-link-assist]");if(i){const s=r.badgeLabel||o.cameraLinkBadgeLabel;i.textContent=s}}function BW(e){if(!e)return null;let t=e.querySelector(".gear-item-text");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;t=r.createElement("span"),t.className="gear-item-text";const n=[];e.childNodes.forEach(a=>{if(a){if(a.nodeType===1){const i=a.classList;if(i&&(i.contains("gear-item-note")||i.contains("gear-item-extra-indicator")||i.contains("gear-item-edit-btn")||i.contains("gear-custom-item-actions")||i.contains("gear-custom-remove-btn")))return}n.push(a)}});const o=e.querySelector(".gear-item-extra-indicator")||e.querySelector(".gear-item-note")||e.querySelector(".gear-custom-item-actions")||e.querySelector(".gear-custom-remove-btn")||e.querySelector(".gear-item-edit-btn");return n.forEach(a=>{t.appendChild(a)}),o?e.insertBefore(t,o):e.appendChild(t),t}function dM(e){const t=typeof e=="string"?e.trim():"";if(!t)return{quantity:"",name:"",attributes:""};let r=t,n="";const o=r.match(/^(\d+)\s*x\s*(.*)$/i);o&&(n=o[1]||"",r=o[2]||"");const a=r.match(/^(.*?)(?:\s*\(([^()]+)\))?$/),i=a?(a[1]||"").trim():r.trim(),s=a&&a[2]?a[2].trim():"";return{quantity:n,name:i,attributes:s}}function Ts(e){if(!e)return{quantity:"",name:"",attributes:"",note:"",rentalExcluded:!1};const t=e.getAttribute("data-gear-quantity")||"",r=e.getAttribute("data-gear-label")||e.getAttribute("data-gear-name")||"",n=e.getAttribute("data-gear-attributes")||"",o=e.getAttribute("data-gear-note")||"",a=e.getAttribute("data-gear-provider")||"",i=e.getAttribute("data-gear-provider-label")||"",s=e.getAttribute("data-gear-extra")==="true",l=e.getAttribute("data-gear-extra-start")||"",c=e.getAttribute("data-gear-extra-end")||"",u=e.getAttribute("data-gear-extra-label")||"",f=e.querySelector(".gear-item-text"),d=f?f.textContent:e.textContent||"",p=dM(d),h=t.trim()||p.quantity||"",m=r.trim()||p.name||"",g=n.trim()||p.attributes||"",S=o.trim(),y=e.getAttribute("data-rental-excluded")==="true"||e.classList.contains("gear-item-rental-excluded");let E=a.trim();E||(E=gw(m));const L=i.trim(),v=e.getAttribute("data-gear-camera-link")||"",A=e.getAttribute("data-gear-camera-letter")||"",R=e.getAttribute("data-gear-camera-link-label")||"",I=rp(e);let C=Zi(v||A);I&&!C&&(C="A");const k=R.trim()||(I?oR():"");return{quantity:h,name:m,attributes:g,note:S,rentalExcluded:y,providedBy:E,providerLabel:L,extra:s,extraStart:l.trim(),extraEnd:c.trim(),extraLabel:u.trim(),cameraLink:C,cameraLinkLabel:k}}function cP(e){if(!e)return{name:"",attributes:""};const t=e.getAttribute("data-gear-original-name")||e.getAttribute("data-gear-name")||"",r=dM(t);let n=e.getAttribute("data-gear-original-label")||"",o=e.getAttribute("data-gear-original-attributes")||"";return!n&&r.name&&(n=r.name),!o&&r.attributes&&(o=r.attributes),{name:typeof n=="string"?n.trim():"",attributes:typeof o=="string"?o.trim():""}}function GW(){const e=typeof texts=="object"&&texts?texts:{},t=typeof currentLang=="string"&&e[currentLang]?currentLang:"en",r=e[t]||{},n=e.en||{};return{indicatorBase:r.gearListExtraIndicatorNoPeriod||n.gearListExtraIndicatorNoPeriod||"Temporary extra",indicatorRange:r.gearListExtraIndicatorRange||n.gearListExtraIndicatorRange||"Temporary extra: %s  %s",indicatorStart:r.gearListExtraIndicatorOpen||n.gearListExtraIndicatorOpen||"Temporary extra from %s",indicatorEnd:r.gearListExtraIndicatorEnd||n.gearListExtraIndicatorEnd||"Temporary extra until %s"}}function MW(){const e=typeof texts=="object"&&texts?texts:{},t=typeof currentLang=="string"&&e[currentLang]?currentLang:"en",r=e[t]||{},n=e.en||{};return{categoryLabel:r.gearListExtraCategoryLabel||n.gearListExtraCategoryLabel||"Temporary Extras",addButton:r.addExtraGearBtn||n.addExtraGearBtn||"Add temporary extra gear",checkboxLabel:r.gearListEditExtraLabel||n.gearListEditExtraLabel||"Temporary extra gear",checkboxHelp:r.gearListEditExtraHelp||n.gearListEditExtraHelp||"",periodHelp:r.gearListEditExtraPeriodHelp||n.gearListEditExtraPeriodHelp||"",startLabel:r.gearListEditExtraStartLabel||n.gearListEditExtraStartLabel||"Needed from",endLabel:r.gearListEditExtraEndLabel||n.gearListEditExtraEndLabel||"Needed until"}}function y0(e){const t=typeof e=="string"?e.trim():"";if(!t)return"";const r=new Date(t);if(Number.isNaN(r.getTime()))return t;try{return new Intl.DateTimeFormat(void 0,{dateStyle:"medium"}).format(r)}catch{}return t}function _W(e,t){const r=typeof e=="string"?e.trim():"",n=typeof t=="string"?t.trim():"";let o=r,a=n;if(r&&n){const i=new Date(r),s=new Date(n);!Number.isNaN(i.getTime())&&!Number.isNaN(s.getTime())&&i.getTime()>s.getTime()&&(o=n,a=r)}return{start:o,end:a}}function toe(e,t){const r=GW(),n=y0(e),o=y0(t);return n&&o?r.indicatorRange.replace("%s",n).replace("%s",o):n?r.indicatorStart.replace("%s",n):o?r.indicatorEnd.replace("%s",o):r.indicatorBase}function yg(e,t={},r={}){if(!e)return;const n=e.ownerDocument||(typeof document<"u"?document:null);if(!n)return;const o=e.classList&&e.classList.contains("gear-custom-item"),a=o?e.querySelector(".gear-item-text"):BW(e);if(xW(e),!a&&!o)return;let i=typeof t.quantity=="string"?t.quantity.trim():String(t.quantity??"").trim();const s=typeof t.name=="string"?t.name.trim():String(t.name??"").trim(),l=typeof t.attributes=="string"?t.attributes.trim():String(t.attributes??"").trim(),c=typeof t.note=="string"?t.note.trim():String(t.note??"").trim();if(!o&&!i){const x=e.querySelector("select[data-monitor-battery-key]");if(x){const G=x.getAttribute("data-monitor-battery-type")||(x.dataset?x.dataset.monitorBatteryType:"");G==="large"?i="2":G&&(i="3")}}if(!o&&a){const x=Array.from(a.querySelectorAll("select, input, textarea"));for(x.forEach(T=>{T&&T.parentElement===a&&a.removeChild(T)});a.firstChild;)a.removeChild(a.firstChild);const G=!!i&&(s||x.length||l);i&&a.appendChild(n.createTextNode(`${i}x${G?" ":""}`)),s&&(a.appendChild(n.createTextNode(s)),(x.length||l)&&a.appendChild(n.createTextNode(" "))),!s&&x.length&&i&&a.appendChild(n.createTextNode("")),x.forEach((T,P)=>{a.appendChild(T),(P<x.length-1||l)&&a.appendChild(n.createTextNode(" "))}),l&&a.appendChild(n.createTextNode(`(${l})`))}i?e.setAttribute("data-gear-quantity",i):e.removeAttribute("data-gear-quantity"),s?e.setAttribute("data-gear-label",s):e.removeAttribute("data-gear-label"),l?e.setAttribute("data-gear-attributes",l):e.removeAttribute("data-gear-attributes"),c?e.setAttribute("data-gear-note",c):e.removeAttribute("data-gear-note");const u=typeof t.providedBy=="string"?t.providedBy.trim():e.getAttribute("data-gear-provider")||"",f=typeof t.providerLabel=="string"?t.providerLabel.trim():e.getAttribute("data-gear-provider-label")||"";iM(e,u,{label:f});const d=Zi(typeof t.cameraLink=="string"?t.cameraLink.trim():""),p=typeof t.cameraLinkLabel=="string"?t.cameraLinkLabel.trim():"",h=rp(e),m=h&&!d?"A":d,g=!!m,S=p||(h?oR():"");g?(e.setAttribute("data-gear-camera-link",m),h?(e.setAttribute("data-gear-camera-role","source"),e.setAttribute("data-gear-camera-letter",m)):(e.removeAttribute("data-gear-camera-role"),e.removeAttribute("data-gear-camera-letter")),S?e.setAttribute("data-gear-camera-link-label",S):e.removeAttribute("data-gear-camera-link-label")):(e.removeAttribute("data-gear-camera-link"),e.removeAttribute("data-gear-camera-link-label"),e.removeAttribute("data-gear-camera-role"),e.removeAttribute("data-gear-camera-letter")),e.classList&&e.classList.toggle("gear-item-camera-linked",g);const E=os().cameraLinkBadgeLabel,L=S?`${E}  ${S}`:E,v=g?m:"",A=v?aR(v):"";if(PW(e,g,{isPrimary:h,badgeLabel:L,letter:v,color:A}),!e.getAttribute("data-gear-original-name")){const x=e.getAttribute("data-gear-name");if(x){e.setAttribute("data-gear-original-name",x);const G=dM(x);!e.getAttribute("data-gear-original-label")&&G.name&&e.setAttribute("data-gear-original-label",G.name),!e.getAttribute("data-gear-original-attributes")&&G.attributes&&e.setAttribute("data-gear-original-attributes",G.attributes)}}const R=l?`${s||""} (${l})`.trim():s;R?e.setAttribute("data-gear-name",R):i&&e.setAttribute("data-gear-name",`${i}x`);const I=!!(t&&(t.extra===!0||t.extra==="true"||t.extra===1||t.extra==="1")),C=I?_W(Object.prototype.hasOwnProperty.call(t,"extraStart")?t.extraStart:"",Object.prototype.hasOwnProperty.call(t,"extraEnd")?t.extraEnd:""):{start:"",end:""},k=GW(),_=I?toe(C.start,C.end):"",w=kW(e);if(I){e.setAttribute("data-gear-extra","true"),C.start?e.setAttribute("data-gear-extra-start",C.start):e.removeAttribute("data-gear-extra-start"),C.end?e.setAttribute("data-gear-extra-end",C.end):e.removeAttribute("data-gear-extra-end");const x=_||k.indicatorBase;if(e.setAttribute("data-gear-extra-label",x),w){const G=_||k.indicatorBase;w.textContent=G,w.hidden=!1,w.removeAttribute("hidden"),w.setAttribute("aria-label",G)}}else e.removeAttribute("data-gear-extra"),e.removeAttribute("data-gear-extra-start"),e.removeAttribute("data-gear-extra-end"),e.removeAttribute("data-gear-extra-label"),w&&(w.textContent="",w.hidden=!0,w.setAttribute("hidden",""),w.removeAttribute("aria-label"));Kne(e,c),o&&!r.skipPreview&&OW(e),typeof t.rentalExcluded=="boolean"&&pS(e,t.rentalExcluded)}function roe(e){if(!e||!e.classList||!e.classList.contains("gear-custom-item")||!e.querySelector("[data-gear-custom-input]"))return e;const r=e.parentElement;if(!r)return e;const n=e.getAttribute("data-gear-custom-entry")||"",o=r.getAttribute("data-gear-custom-category")||"",a=e.querySelector('[data-gear-custom-input="quantity"]'),i=e.querySelector('[data-gear-custom-input="name"]'),s=a?String(a.value??""):"",l=i?String(i.value??""):"",c=e.getAttribute("data-gear-attributes")||"",u=e.getAttribute("data-gear-note")||"",f=e.getAttribute("data-rental-excluded")==="true",d=$W(n,o,{quantity:s,name:l,attributes:c,note:u});return d?(r.insertBefore(d,e.nextSibling),e.remove(),pS(d,f),fM(d,n,o),d):e}function noe(e){if(!e)return null;if(e.querySelector(".gear-item-edit-btn"))return e.querySelector(".gear-item-edit-btn");const t=e.ownerDocument||(typeof document<"u"?document:null);if(!t)return null;const r=t.createElement("button");r.type="button",r.className="gear-item-edit-btn",r.setAttribute("data-gear-edit","");const o=os().editButtonLabel;r.setAttribute("aria-label",o),r.setAttribute("title",o);const i=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?ICON_GLYPHS.sliders:null;typeof bi=="function"&&i?bi(r,"",i):typeof iconMarkup=="function"&&i?r.innerHTML=iconMarkup(i,{className:"btn-icon"}):r.textContent=o;const s=e.querySelector(".gear-item-note");return s?e.insertBefore(r,s.nextSibling):e.appendChild(r),r}function ooe(e){if(!e)return;e.classList&&e.classList.contains("gear-custom-item")&&(e=roe(e));const t=e.classList&&e.classList.contains("gear-custom-item");xW(e),kW(e),t||(BW(e),noe(e));const r=Ts(e);if(!r.quantity){const n=e.querySelector("select[data-monitor-battery-type]");if(n){const o=n.getAttribute("data-monitor-battery-type")==="handheld"?"3":"2";r.quantity=o}}yg(e,r,{skipPreview:!t})}function aoe(){if(!gearListOutput)return null;const e=uM(Nf);if(e)return e;const t=gearListOutput.querySelector(".gear-table");if(!t)return null;const r=t.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;const n=MW(),o=n.categoryLabel,a=r.createElement("tbody");a.className="category-group",a.setAttribute("data-gear-custom-key",Nf),a.setAttribute("data-gear-table-category",o);const i=r.createElement("tr");i.className="category-row";const s=r.createElement("td");s.setAttribute("data-gear-category-label",o);const l=r.createElement("div");l.className="gear-category-header";const c=r.createElement("span");c.className="gear-category-label",c.textContent=o,l.appendChild(c);const u=r.createElement("button");u.type="button",u.className="gear-custom-add-btn",u.setAttribute("data-gear-custom-add",Nf),u.setAttribute("data-gear-custom-category",o),u.setAttribute("data-extra-gear","true"),u.setAttribute("aria-label",n.addButton),u.setAttribute("title",n.addButton);const f=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS,d=f&&(ICON_GLYPHS.add||ICON_GLYPHS.plus);typeof bi=="function"&&f&&d?bi(u,"",d):typeof iconMarkup=="function"&&d?u.innerHTML=iconMarkup(d,{className:"btn-icon"}):u.textContent="+",l.appendChild(u),s.appendChild(l),i.appendChild(s),a.appendChild(i);const p=r.createElement("tr"),h=r.createElement("td"),m=r.createElement("div");m.className="gear-custom-section",m.setAttribute("data-gear-custom-key",Nf),m.setAttribute("data-gear-custom-category",o);const g=r.createElement("div");return g.className="gear-custom-items",g.setAttribute("data-gear-custom-list",Nf),g.setAttribute("data-gear-custom-category",o),g.setAttribute("aria-live","polite"),m.appendChild(g),h.appendChild(m),p.appendChild(h),a.appendChild(p),t.appendChild(a),g}function ioe(){return{dialog:Ct("gearItemEditDialog","gearItemEditDialog"),form:Ct("gearItemEditForm","gearItemEditForm"),title:Ct("gearItemEditTitle","gearItemEditTitle"),preview:Ct("gearItemEditPreview","gearItemEditPreview"),quantityInput:Ct("gearItemEditQuantity","gearItemEditQuantity"),quantityLabel:Ct("gearItemEditQuantityLabel","gearItemEditQuantityLabel"),nameInput:Ct("gearItemEditName","gearItemEditName"),nameLabel:Ct("gearItemEditNameLabel","gearItemEditNameLabel"),attributesInput:Ct("gearItemEditAttributes","gearItemEditAttributes"),attributesLabel:Ct("gearItemEditAttributesLabel","gearItemEditAttributesLabel"),noteInput:Ct("gearItemEditNote","gearItemEditNote"),noteLabel:Ct("gearItemEditNoteLabel","gearItemEditNoteLabel"),deviceSection:Ct("gearItemEditDeviceSection","gearItemEditDeviceSection"),deviceHeading:Ct("gearItemEditDeviceHeading","gearItemEditDeviceHeading"),deviceCategory:Ct("gearItemEditDeviceCategory","gearItemEditDeviceCategory"),deviceSummary:Ct("gearItemEditDeviceSummary","gearItemEditDeviceSummary"),deviceEmpty:Ct("gearItemEditDeviceEmpty","gearItemEditDeviceEmpty"),deviceButton:Ct("gearItemEditDeviceButton","gearItemEditDeviceButton"),extraContainer:Ct("gearItemEditExtraContainer","gearItemEditExtraContainer"),extraCheckbox:Ct("gearItemEditExtra","gearItemEditExtra"),extraLabel:Ct("gearItemEditExtraLabel","gearItemEditExtraLabel"),extraHelp:Ct("gearItemEditExtraHelp","gearItemEditExtraHelp"),extraPeriodContainer:Ct("gearItemEditExtraPeriod","gearItemEditExtraPeriod"),extraStartInput:Ct("gearItemEditExtraStart","gearItemEditExtraStart"),extraStartLabel:Ct("gearItemEditExtraStartLabel","gearItemEditExtraStartLabel"),extraEndInput:Ct("gearItemEditExtraEnd","gearItemEditExtraEnd"),extraEndLabel:Ct("gearItemEditExtraEndLabel","gearItemEditExtraEndLabel"),extraPeriodHelp:Ct("gearItemEditExtraPeriodHelp","gearItemEditExtraPeriodHelp"),providerSelect:Ct("gearItemEditProvider","gearItemEditProvider"),providerLabel:Ct("gearItemEditProviderLabel","gearItemEditProviderLabel"),providerHelp:Ct("gearItemEditProviderHelp","gearItemEditProviderHelp"),ownedContainer:Ct("gearItemEditOwnedContainer","gearItemEditOwnedContainer"),ownedCheckbox:Ct("gearItemEditOwned","gearItemEditOwned"),ownedLabel:Ct("gearItemEditOwnedLabel","gearItemEditOwnedLabel"),ownedHelp:Ct("gearItemEditOwnedHelp","gearItemEditOwnedHelp"),cameraLinkContainer:Ct("gearItemEditCameraLinkContainer","gearItemEditCameraLinkContainer"),cameraLinkSelect:Ct("gearItemEditCameraLink","gearItemEditCameraLink"),cameraLinkLabel:Ct("gearItemEditCameraLinkLabel","gearItemEditCameraLinkLabel"),cameraLinkHelp:Ct("gearItemEditCameraLinkHelp","gearItemEditCameraLinkHelp"),rentalCheckbox:Ct("gearItemEditRental","gearItemEditRental"),rentalSection:Ct("gearItemEditRentalSection","gearItemEditRentalSection"),rentalLabel:Ct("gearItemEditRentalLabel","gearItemEditRentalLabel"),rentalDescription:Ct("gearItemEditRentalDescription","gearItemEditRentalDescription"),cancelButton:Ct("gearItemEditCancel","gearItemEditCancel"),saveButton:Ct("gearItemEditSave","gearItemEditSave"),resetButton:Ct("gearItemEditReset","gearItemEditReset"),resetDefaults:null,currentAttributes:"",currentOwnedEntryId:"",currentCameraLinkValue:"",isCameraItem:!1,deviceEditData:null}}let Ix=null;function _a(e){return e&&typeof e=="object"&&e.context&&typeof e.context=="object"?e.context:(Ix||(Ix=ioe()),Ix)}function os(){const e=typeof texts=="object"&&texts?texts[currentLang]||texts.en||{}:{},t=texts&&texts.en?texts.en:{};return{dialogTitle:e.gearListEditDialogTitle||t.gearListEditDialogTitle||"Edit gear item",quantityLabel:e.gearListEditQuantityLabel||t.gearListEditQuantityLabel||"Quantity",nameLabel:e.gearListEditNameLabel||t.gearListEditNameLabel||"Item name",attributesLabel:e.gearListEditAttributesLabel||t.gearListEditAttributesLabel||"Attributes",noteLabel:e.gearListEditNoteLabel||t.gearListEditNoteLabel||"Note",extraLabel:e.gearListEditExtraLabel||t.gearListEditExtraLabel||"Temporary extra gear",extraHelp:e.gearListEditExtraHelp||t.gearListEditExtraHelp||"",extraStartLabel:e.gearListEditExtraStartLabel||t.gearListEditExtraStartLabel||"Needed from",extraEndLabel:e.gearListEditExtraEndLabel||t.gearListEditExtraEndLabel||"Needed until",extraPeriodHelp:e.gearListEditExtraPeriodHelp||t.gearListEditExtraPeriodHelp||"",providerLabel:e.gearListEditProviderLabel||t.gearListEditProviderLabel||"Provided by",providerHelp:e.gearListEditProviderHelp||t.gearListEditProviderHelp||"",providerRental:e.gearListProviderRental||t.gearListProviderRental||"Rental",providerUser:e.gearListProviderUser||t.gearListProviderUser||"User",providerCrewHeading:e.gearListProviderCrewHeading||t.gearListProviderCrewHeading||"Crew",providerUnknown:e.gearListProviderUnknown||t.gearListProviderUnknown||"Custom provider",ownedLabel:e.gearListEditOwnedLabel||t.gearListEditOwnedLabel||"Owned",ownedHelp:e.gearListEditOwnedHelp||t.gearListEditOwnedHelp||"",cameraLinkLabel:e.gearListEditCameraLinkLabel||t.gearListEditCameraLinkLabel||"Camera link",cameraLinkHelp:e.gearListEditCameraLinkHelp||t.gearListEditCameraLinkHelp||"",cameraAssignmentLabel:e.gearListEditCameraAssignmentLabel||t.gearListEditCameraAssignmentLabel||"Camera designation",cameraAssignmentHelp:e.gearListEditCameraAssignmentHelp||t.gearListEditCameraAssignmentHelp||"",cameraLinkNoneOption:e.gearListEditCameraLinkNoneOption||t.gearListEditCameraLinkNoneOption||"No camera link",cameraLinkCameraOption:e.gearListEditCameraLinkCameraOption||t.gearListEditCameraLinkCameraOption||"Camera %s  %s",cameraLinkUnavailableOption:e.gearListEditCameraLinkUnavailableOption||t.gearListEditCameraLinkUnavailableOption||"Camera %s (unassigned)",cameraLinkDefaultLabel:e.gearListEditCameraLinkDefaultLabel||t.gearListEditCameraLinkDefaultLabel||"Camera %s",cameraLinkBadgeLabel:e.gearListCameraLinkBadgeLabel||t.gearListCameraLinkBadgeLabel||"Linked to camera",rentalLabel:e.gearListEditRentalLabel||t.gearListEditRentalLabel||"Exclude from rental",rentalNote:ZK({fallback:e.gearListRentalNote||t.gearListRentalNote||"Rental handles this item"}),saveLabel:e.gearListEditSave||t.gearListEditSave||"Save",cancelLabel:e.gearListEditCancel||t.gearListEditCancel||"Cancel",editButtonLabel:e.gearListEditButton||t.gearListEditButton||"Edit gear item",resetLabel:e.gearListEditReset||t.gearListEditReset||"Reset name",deviceHeading:e.gearListEditDeviceHeading||t.gearListEditDeviceHeading||"Device attributes",deviceEditButton:e.gearListEditDeviceEdit||t.gearListEditDeviceEdit||"Edit device attributes",deviceEmpty:e.gearListEditDeviceEmpty||t.gearListEditDeviceEmpty||"No device attributes recorded yet. Update the device to add details.",deviceCategoryLabel:e.gearListEditDeviceCategory||t.gearListEditDeviceCategory||"Device library: %s"}}function DW(e){if(!e)return;const t=os();if(e.title&&(e.title.textContent=t.dialogTitle),e.preview&&(e.preview.textContent="",e.preview.hidden=!0),Sw(e),e.quantityLabel&&(e.quantityLabel.textContent=t.quantityLabel),e.nameLabel&&(e.nameLabel.textContent=t.nameLabel),e.noteLabel&&(e.noteLabel.textContent=t.noteLabel),e.attributesLabel&&(e.attributesLabel.textContent=t.attributesLabel),e.extraLabel){const a=e.extraLabel.querySelector("span");a?a.textContent=t.extraLabel:e.extraLabel.textContent=t.extraLabel}if(e.extraCheckbox&&e.extraCheckbox.setAttribute("aria-label",t.extraLabel),e.extraHelp&&(t.extraHelp?(e.extraHelp.textContent=t.extraHelp,e.extraHelp.hidden=!1,e.extraHelp.removeAttribute("hidden")):(e.extraHelp.textContent="",e.extraHelp.hidden=!0,e.extraHelp.setAttribute("hidden",""))),e.extraStartLabel&&(e.extraStartLabel.textContent=t.extraStartLabel),e.extraEndLabel&&(e.extraEndLabel.textContent=t.extraEndLabel),e.extraPeriodHelp&&(t.extraPeriodHelp?(e.extraPeriodHelp.textContent=t.extraPeriodHelp,e.extraPeriodHelp.hidden=!1,e.extraPeriodHelp.removeAttribute("hidden")):(e.extraPeriodHelp.textContent="",e.extraPeriodHelp.hidden=!0,e.extraPeriodHelp.setAttribute("hidden",""))),e.providerLabel&&(e.providerLabel.textContent=t.providerLabel),e.providerHelp&&(e.providerHelp.textContent=t.providerHelp||"",e.providerHelp.hidden=!e.providerHelp.textContent),e.providerSelect&&(e.providerHelp&&e.providerHelp.textContent?e.providerSelect.setAttribute("aria-describedby",e.providerHelp.id):e.providerSelect.removeAttribute("aria-describedby"),e.providerSelect.setAttribute("aria-label",t.providerLabel)),e.cameraLinkLabel&&(e.cameraLinkLabel.textContent=t.cameraLinkLabel),e.cameraLinkHelp){const a=t.cameraLinkHelp||"";e.cameraLinkHelp.textContent=a,a?(e.cameraLinkHelp.hidden=!1,e.cameraLinkHelp.removeAttribute("hidden")):(e.cameraLinkHelp.hidden=!0,e.cameraLinkHelp.setAttribute("hidden",""))}if(e.cameraLinkSelect&&(e.cameraLinkHelp&&e.cameraLinkHelp.textContent?e.cameraLinkSelect.setAttribute("aria-describedby",e.cameraLinkHelp.id):e.cameraLinkSelect.removeAttribute("aria-describedby"),e.cameraLinkSelect.setAttribute("aria-label",t.cameraLinkLabel)),e.deviceHeading&&(e.deviceHeading.textContent=t.deviceHeading),e.deviceButton&&(e.deviceButton.textContent=t.deviceEditButton,e.deviceButton.setAttribute("aria-label",t.deviceEditButton),e.deviceButton.disabled=!0,e.deviceButton.setAttribute("aria-disabled","true")),e.deviceEmpty&&(e.deviceEmpty.textContent=t.deviceEmpty),e.ownedLabel){const a=e.ownedLabel.querySelector("span");a&&(a.textContent=t.ownedLabel)}if(e.ownedHelp){const a=t.ownedHelp||"";e.ownedHelp.textContent=a,e.ownedHelp.hidden=!a}e.ownedCheckbox&&(e.ownedCheckbox.setAttribute("aria-label",t.ownedLabel),e.ownedHelp&&e.ownedHelp.textContent&&!e.ownedHelp.hidden?e.ownedCheckbox.setAttribute("aria-describedby",e.ownedHelp.id):e.ownedCheckbox.removeAttribute("aria-describedby"));const r=Mg(),n=r.excludeLabel||t.rentalLabel,o=t.rentalNote||r.noteLabel||"";if(e.rentalLabel&&(e.rentalLabel.textContent=n),e.rentalCheckbox&&e.rentalCheckbox.setAttribute("aria-label",t.rentalLabel),e.resetButton){const a=t.resetLabel;if(e.resetButton.setAttribute("aria-label",a),e.resetButton.title=a,typeof bi=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS){const i=ICON_GLYPHS.reload||ICON_GLYPHS.save;bi(e.resetButton,a,i)}else e.resetButton.textContent=a}if(e.rentalDescription&&(e.rentalDescription.textContent=o,e.rentalDescription.hidden=!o),e.rentalCheckbox&&(e.rentalDescription&&e.rentalDescription.textContent?e.rentalCheckbox.setAttribute("aria-describedby",e.rentalDescription.id):e.rentalCheckbox.removeAttribute("aria-describedby")),e.cancelButton){const a=t.cancelLabel;e.cancelButton.setAttribute("aria-label",a),typeof bi=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?bi(e.cancelButton,a,ICON_GLYPHS.circleX||ICON_GLYPHS.minus):e.cancelButton.textContent=a}if(e.saveButton){const a=t.saveLabel;typeof bi=="function"&&typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?bi(e.saveButton,a,ICON_GLYPHS.save):e.saveButton.textContent=a}}function soe(e){if(!e)return"";const t=e.quantityInput?e.quantityInput.value.trim():"",r=e.nameInput?e.nameInput.value.trim():"",n=e.attributesInput?e.attributesInput.value.trim():typeof e.currentAttributes=="string"?e.currentAttributes.trim():"",o=[];t&&o.push(`${t}x`),r&&o.push(r);let a=o.join(" ").trim();return n&&(a=a?`${a} (${n})`:`(${n})`),a.trim()}function NW(e){if(!e)return"";const t=soe(e);return e.preview&&(e.preview.textContent=t,e.preview.hidden=!t),t}function Px(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function Bx(e){return typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(e):String(e??"").replace(/\r?\n/g,"").replace(/[^a-zA-Z0-9_-]/g,t=>`\\${t}`)}function loe(e){return typeof e!="string"||!e.trim()?"":e.replace(/[_-]+/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").split(/\s+/).filter(Boolean).map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function coe(e){return!Array.isArray(e)||!e.length?"":e.map(loe).filter(Boolean).join("  ")}function uoe(e){const t=typeof e=="string"?e.trim():"";if(!t||!devices||typeof devices!="object")return null;const r=new Set,n=(l,c)=>{if(!Px(l)||r.has(l))return null;if(r.add(l),Object.prototype.hasOwnProperty.call(l,t)&&Px(l[t]))return{info:l[t],categoryPath:c.slice()};for(const[u,f]of Object.entries(l)){if(!Px(f))continue;const d=n(f,c.concat(u));if(d)return d}return null},o=n(devices,[]);if(!o)return null;const a=Array.isArray(o.categoryPath)?o.categoryPath.slice():[];let i="",s="";return a.length>=2&&a[0]==="accessories"?(i=`accessories.${a[1]}`,a[1]==="cables"&&a.length>=3&&(s=a[2])):a.length>=2&&a[0]==="fiz"?i=`fiz.${a[1]}`:a.length>=2?i=`${a[0]}.${a[1]}`:a.length===1&&(i=a[0]),{info:o.info,categoryPath:a,categoryKey:i,subcategory:s}}function foe(e){if(!e||typeof e!="object")return"";const t=typeof generateSafeConnectorSummary=="function"?generateSafeConnectorSummary:typeof s0=="function"?s0:null;if(!t)return"";try{const r=t(e);return typeof r=="string"?r:""}catch{return""}}function Sw(e){e&&(e.deviceSummary&&(e.deviceSummary.innerHTML="",e.deviceSummary.hidden=!0,e.deviceSummary.setAttribute("hidden","")),e.deviceCategory&&(e.deviceCategory.textContent="",e.deviceCategory.hidden=!0,e.deviceCategory.setAttribute("hidden","")),e.deviceEmpty&&(e.deviceEmpty.hidden=!0,e.deviceEmpty.setAttribute("hidden","")),e.deviceButton&&(e.deviceButton.disabled=!0,e.deviceButton.setAttribute("aria-disabled","true")),e.deviceSection&&(e.deviceSection.hidden=!0,e.deviceSection.setAttribute("hidden","")),e.deviceEditData=null)}function FW(e,t={}){if(!e||!e.deviceSection)return;const r=os(),n=typeof t.name=="string"?t.name:null,o=typeof t.fallbackName=="string"?t.fallbackName:"",a=n&&n.trim()?n.trim():o.trim();if(!a){Sw(e);return}const i=uoe(a);if(!i||!i.info){Sw(e);return}const s=foe(i.info);if(e.deviceSummary&&(e.deviceSummary.innerHTML=s||"",s?(e.deviceSummary.hidden=!1,e.deviceSummary.removeAttribute("hidden")):(e.deviceSummary.hidden=!0,e.deviceSummary.setAttribute("hidden",""))),e.deviceCategory){const l=coe(i.categoryPath||[]);if(l){const c=r.deviceCategoryLabel,u=c.includes("%s")?c.replace("%s",l):`${c} ${l}`.trim();e.deviceCategory.textContent=u,e.deviceCategory.hidden=!1,e.deviceCategory.removeAttribute("hidden")}else e.deviceCategory.textContent="",e.deviceCategory.hidden=!0,e.deviceCategory.setAttribute("hidden","")}if(e.deviceEmpty){const l=r.deviceEmpty;s?(e.deviceEmpty.textContent=l,e.deviceEmpty.hidden=!0,e.deviceEmpty.setAttribute("hidden","")):(e.deviceEmpty.textContent=l,e.deviceEmpty.hidden=!1,e.deviceEmpty.removeAttribute("hidden"))}e.deviceButton&&(e.deviceButton.disabled=!1,e.deviceButton.setAttribute("aria-disabled","false")),e.deviceSection&&(e.deviceSection.hidden=!1,e.deviceSection.removeAttribute("hidden")),e.deviceEditData={name:a,categoryKey:i.categoryKey,subcategory:i.subcategory||""}}function doe(e){if(!e||!e.name||!e.categoryKey)return;try{typeof showDeviceManagerSection=="function"?showDeviceManagerSection():typeof toggleDeviceManagerSection=="function"&&toggleDeviceManagerSection()}catch{}try{typeof refreshDeviceLists=="function"&&refreshDeviceLists()}catch{}const t=4;let r=0;const n=()=>{r+=1;let o=`#device-manager .edit-btn[data-category="${Bx(e.categoryKey)}"][data-name="${Bx(e.name)}"]`;e.subcategory?o+=`[data-subcategory="${Bx(e.subcategory)}"]`:o+=":not([data-subcategory])";let a=null;try{a=document.querySelector(o)}catch{a=null}if(a){try{a.scrollIntoView&&a.scrollIntoView({block:"center",behavior:"smooth"}),a.focus({preventScroll:!0})}catch{}try{a.click()}catch{}return}r<t?setTimeout(n,120*r):typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Could not locate device edit button for gear item",e)};setTimeout(n,60)}function poe(e){e&&e.preventDefault();const t=_a();if(!(!t||!t.deviceEditData)){if(t.dialog)try{typeof t.dialog.close=="function"?t.dialog.close("device-edit"):t.dialog.removeAttribute("open")}catch{}doe(t.deviceEditData)}}function pM(e,t){if(!e)return;const r=!!t;e.extraPeriodContainer&&(r?(e.extraPeriodContainer.hidden=!1,e.extraPeriodContainer.removeAttribute("hidden")):(e.extraPeriodContainer.hidden=!0,e.extraPeriodContainer.setAttribute("hidden",""))),e.extraStartInput&&(e.extraStartInput.disabled=!r,r?e.extraStartInput.removeAttribute("aria-disabled"):e.extraStartInput.setAttribute("aria-disabled","true")),e.extraEndInput&&(e.extraEndInput.disabled=!r,r?e.extraEndInput.removeAttribute("aria-disabled"):e.extraEndInput.setAttribute("aria-disabled","true"))}function jW(e){if(!e||!e.resetButton)return;const t=e.resetDefaults||{name:"",attributes:""},r=Yo&&Yo.element,n=!!(r&&r.hasAttribute("data-gear-original-name")),o=typeof t.name=="string"?t.name.trim():"",a=typeof t.attributes=="string"?t.attributes.trim():"",i=e.nameInput?e.nameInput.value.trim():"",s=e.attributesInput?e.attributesInput.value.trim():typeof e.currentAttributes=="string"?e.currentAttributes.trim():"",u=!(n||!!(o||a||s))||i===o&&s===a;e.resetButton.disabled=u,e.resetButton.setAttribute("aria-disabled",u?"true":"false")}function HW(e,t,r){if(!e)return;const n=!!t,o=!!r;e.rentalCheckbox&&(e.rentalCheckbox.checked=n,e.rentalCheckbox.disabled=!o,o?e.rentalCheckbox.removeAttribute("aria-disabled"):e.rentalCheckbox.setAttribute("aria-disabled","true")),e.rentalSection&&(e.rentalSection.hidden=!o),e.rentalDescription&&(e.rentalDescription.hidden=!e.rentalDescription.textContent)}function Ff(){const e=_a();if(!e)return;e.extraCheckbox&&pM(e,e.extraCheckbox.checked);const t=NW(e),r=os();if(e.title&&(e.title.textContent=t?`${r.dialogTitle}  ${t}`:r.dialogTitle),e.ownedCheckbox){const a=!!(e.nameInput&&e.nameInput.value.trim());e.ownedCheckbox.disabled=!a,e.ownedCheckbox.disabled?(e.ownedCheckbox.setAttribute("aria-disabled","true"),e.ownedCheckbox.checked=!1):e.ownedCheckbox.removeAttribute("aria-disabled")}jW(e);const n=e.resetDefaults&&typeof e.resetDefaults.name=="string"?e.resetDefaults.name:"",o=e.nameInput?e.nameInput.value:"";FW(e,{name:o,fallbackName:n})}function moe(){const e=_a();if(!e)return;const t=e.rentalCheckbox?!e.rentalCheckbox.disabled:!0,r=e.rentalCheckbox?e.rentalCheckbox.checked:!1;HW(e,r,t)}function goe(){const e=_a();if(!e||!e.ownedCheckbox)return;if(!!!(e.nameInput&&e.nameInput.value.trim())){e.ownedCheckbox.checked=!1,e.ownedCheckbox.disabled=!0,e.ownedCheckbox.setAttribute("aria-disabled","true");return}e.ownedCheckbox.disabled=!1,e.ownedCheckbox.removeAttribute("aria-disabled"),e.providerSelect&&(e.ownedCheckbox.checked?(!e.providerSelect.value||e.providerSelect.value==="rental-house")&&(e.providerSelect.value="user"):e.providerSelect.value==="user"&&(e.providerSelect.value="rental-house"))}function yoe(){const e=_a();!e||!e.extraCheckbox||(pM(e,e.extraCheckbox.checked),Ff())}function hoe(e){e&&e.preventDefault();const t=_a();if(!t||!t.resetButton||t.resetButton.disabled)return;const r=t.resetDefaults||{name:"",attributes:""};if(t.nameInput&&(t.nameInput.value=r.name||""),t.attributesInput?t.attributesInput.value=r.attributes||"":t.currentAttributes=typeof r.attributes=="string"?r.attributes:"",Ff(),t.nameInput&&typeof t.nameInput.focus=="function")try{t.nameInput.focus({preventScroll:!0})}catch{}}function Gx(e){if(!e)return;const t=_a();!t||!t.dialog||e.target===t.dialog&&(e.preventDefault(),e.stopPropagation(),UW(e))}let h0=!1,Yo=null;function UW(e){e.preventDefault();const t=_a();if(!t||!t.dialog)return;const r=Yo&&Yo.element,n=Yo&&Yo.options,o=!n||n.allowRentalToggle!==!1;if(!r||!r.isConnected){t.dialog.close("cancel"),Yo=null;return}const a={quantity:t.quantityInput?t.quantityInput.value:"",name:t.nameInput?t.nameInput.value:"",attributes:t.attributesInput?t.attributesInput.value:typeof t.currentAttributes=="string"?t.currentAttributes:"",note:t.noteInput?t.noteInput.value:"",rentalExcluded:o&&t.rentalCheckbox?t.rentalCheckbox.checked:r.getAttribute("data-rental-excluded")==="true",providedBy:t.providerSelect?t.providerSelect.value:"",providerLabel:t.providerSelect&&t.providerSelect.selectedOptions&&t.providerSelect.selectedOptions.length?n0(t.providerSelect.selectedOptions[0]):"",extra:t.extraCheckbox?t.extraCheckbox.checked:r.getAttribute("data-gear-extra")==="true",extraStart:t.extraStartInput?t.extraStartInput.value:r.getAttribute("data-gear-extra-start")||"",extraEnd:t.extraEndInput?t.extraEndInput.value:r.getAttribute("data-gear-extra-end")||"",cameraLink:"",cameraLinkLabel:""};if(a.extra){const h=_W(a.extraStart,a.extraEnd);a.extraStart=h.start,a.extraEnd=h.end}else a.extraStart="",a.extraEnd="";const i=!!(a.name&&a.name.trim()),s=!!(t.ownedCheckbox&&t.ownedCheckbox.checked&&i);if(s&&(!a.providedBy||a.providedBy==="rental-house"))if(t.providerSelect){t.providerSelect.value="user";const h=t.providerSelect.selectedOptions&&t.providerSelect.selectedOptions[0];a.providedBy=t.providerSelect.value,a.providerLabel=h?n0(h):a.providerLabel}else a.providedBy="user";const l=!!t.isCameraItem;let c="",u="";if(t.cameraLinkSelect){c=t.cameraLinkSelect.value||"";const h=t.cameraLinkSelect.selectedOptions&&t.cameraLinkSelect.selectedOptions[0];if(h&&(u=h.getAttribute("data-camera-label")||(h.dataset?h.dataset.cameraLabel:"")||"",!u)){const m=h.textContent||"";m&&(u=m.replace(/\s*\([^)]*\)\s*$/,"").trim())}}const f=Zi(l&&!c?"A":c);!!f?(a.cameraLink=f,a.cameraLinkLabel=u||a.name&&a.name.trim()||oR()||""):(a.cameraLink="",a.cameraLinkLabel=""),t.currentCameraLinkValue=a.cameraLink,yg(r,a),Ms();const p=s||t.currentOwnedEntryId?rne(r,a,{wantsOwned:s,existingId:t.currentOwnedEntryId||r.getAttribute("data-gear-own-gear-id")||""}):{id:"",changed:!1};p&&Object.prototype.hasOwnProperty.call(p,"id")&&(p.id?r.setAttribute("data-gear-own-gear-id",p.id):r.removeAttribute("data-gear-own-gear-id"),t.currentOwnedEntryId=p.id||"",p.changed&&(Bc=null)),t.currentAttributes=typeof a.attributes=="string"?a.attributes:"",r.classList&&r.classList.contains("gear-custom-item")?iR():(typeof fa=="function"&&fa(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged()),t.dialog.close("save")}function b0(e){e&&e.preventDefault();const t=_a();t&&t.dialog&&t.dialog.close("cancel")}function boe(){const e=_a(),t=Yo&&Yo.element;if(e&&e.dialog&&e.dialog.returnValue,e&&Sw(e),e&&e.form)try{e.form.reset()}catch{}if(e&&e.nameInput&&e.nameInput.removeAttribute("list"),e&&e.preview&&(e.preview.textContent="",e.preview.hidden=!0),e&&(e.resetDefaults=null,e.currentAttributes="",e.currentOwnedEntryId="",e.currentCameraLinkValue="",e.isCameraItem=!1,e.resetButton&&(e.resetButton.disabled=!1,e.resetButton.setAttribute("aria-disabled","false")),e.ownedCheckbox&&(e.ownedCheckbox.checked=!1,e.ownedCheckbox.disabled=!1,e.ownedCheckbox.removeAttribute("aria-disabled"),e.ownedCheckbox.removeAttribute("aria-describedby")),e.cameraLinkSelect&&(e.cameraLinkSelect.disabled=!1,e.cameraLinkSelect.value="",e.cameraLinkSelect.removeAttribute("aria-disabled"))),Yo=null,t&&t.isConnected){const r=t.querySelector("[data-gear-edit]");if(r&&typeof r.focus=="function")try{r.focus({preventScroll:!0})}catch{}}}function S0(){const e=_a();if(!e||!e.dialog||!e.providerSelect||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=Yo&&Yo.element,n=r?Ts(r):{};pW(e,n)}function v0(){const e=_a();if(!e||!e.dialog||!e.cameraLinkSelect||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=Yo&&Yo.element,n=r?Ts(r):{};mW(e,n);const o=!!(e.isCameraItem||r&&rp(r));if(e.cameraLinkLabel||e.cameraLinkHelp){const i=os();if(e.cameraLinkLabel){const s=o?i.cameraAssignmentLabel:i.cameraLinkLabel;e.cameraLinkLabel.textContent=s;const l=o?i.cameraAssignmentHelp:i.cameraLinkHelp;l?e.cameraLinkLabel.setAttribute("data-help",l):e.cameraLinkLabel.removeAttribute("data-help")}if(e.cameraLinkHelp){const s=o?i.cameraAssignmentHelp:i.cameraLinkHelp;e.cameraLinkHelp.textContent=s||"",s?(e.cameraLinkHelp.hidden=!1,e.cameraLinkHelp.removeAttribute("hidden")):(e.cameraLinkHelp.hidden=!0,e.cameraLinkHelp.setAttribute("hidden",""))}}const a=o?Zi(n.cameraLink)||"A":Zi(n.cameraLink);e.cameraLinkSelect.value=a||"",e.cameraLinkSelect.disabled=!1,e.cameraLinkSelect.removeAttribute("aria-disabled")}function Soe(){const e=_a();if(!e||!e.dialog||!e.ownedCheckbox||!(typeof e.dialog.open=="boolean"?e.dialog.open:!e.dialog.hasAttribute("hidden")))return;const r=Yo&&Yo.element;if(!r||!r.isConnected)return;const n=e.nameInput?e.nameInput.value.trim():"",o=Ts(r),a=n||o.name||"",i=e.currentOwnedEntryId||r.getAttribute("data-gear-own-gear-id")||"",s=oM(),{record:l}=aM(s,i,a),c=!!a;e.ownedCheckbox.disabled=!c,e.ownedCheckbox.disabled?(e.ownedCheckbox.setAttribute("aria-disabled","true"),e.ownedCheckbox.checked=!1):(e.ownedCheckbox.removeAttribute("aria-disabled"),e.ownedCheckbox.checked=!!l),l?(e.currentOwnedEntryId=l.id,r.setAttribute("data-gear-own-gear-id",l.id)):(e.currentOwnedEntryId="",r.removeAttribute("data-gear-own-gear-id"))}function voe(e){if(h0||!e||!e.dialog)return;DW(e),e.form&&e.form.addEventListener("submit",UW),e.cancelButton&&e.cancelButton.addEventListener("click",b0),e.resetButton&&e.resetButton.addEventListener("click",hoe),e.dialog.addEventListener("cancel",b0),e.dialog.addEventListener("close",boe),"onpointerdown"in e.dialog?e.dialog.addEventListener("pointerdown",Gx):(e.dialog.addEventListener("mousedown",Gx),e.dialog.addEventListener("touchstart",Gx)),[e.quantityInput,e.nameInput,e.attributesInput].forEach(r=>{r&&(r.addEventListener("input",Ff),r.addEventListener("change",Ff))}),e.rentalCheckbox&&e.rentalCheckbox.addEventListener("change",moe),e.ownedCheckbox&&e.ownedCheckbox.addEventListener("change",goe),e.extraCheckbox&&e.extraCheckbox.addEventListener("change",yoe),[e.extraStartInput,e.extraEndInput].forEach(r=>{r&&(r.addEventListener("input",Ff),r.addEventListener("change",Ff))}),e.cameraLinkSelect&&e.cameraLinkSelect.addEventListener("change",Ff),e.deviceButton&&e.deviceButton.addEventListener("click",poe),h0=!0}function zW(e,t={}){if(!e)return!1;const r=_a();if(!r||!r.dialog)return!1;if(voe(r),ooe(e),e.classList&&e.classList.contains("gear-custom-item")){const S=e.closest(".gear-custom-items[data-gear-custom-list]");if(S){const y=S.getAttribute("data-gear-custom-list")||"",E=S.getAttribute("data-gear-custom-category")||"";fM(e,y,E)}}const n=Ts(e),o=(()=>{const S=n&&Object.prototype.hasOwnProperty.call(n,"id")?n.id:"",y=typeof S=="string"?S:S==null?"":String(S),E=n&&Object.prototype.hasOwnProperty.call(n,"name")?n.name:"",L=typeof E=="string"?E.slice(0,120):"",v=e&&e.dataset?e.dataset:{},A=typeof v.category=="string"?v.category:"",R=!!(e&&e.classList&&e.classList.contains("gear-custom-item")),I={allowRentalToggle:t&&Object.prototype.hasOwnProperty.call(t,"allowRentalToggle")?!!t.allowRentalToggle:void 0,focusField:t&&typeof t.focusField=="string"?t.focusField.slice(0,60):void 0};return{id:y,name:L,category:A,custom:R,options:I}})();Yo={element:e,options:t||{}},r.resetDefaults=cP(e),r.currentAttributes=typeof n.attributes=="string"?n.attributes:String(n.attributes??""),r.resetButton&&(r.resetButton.disabled=!1,r.resetButton.setAttribute("aria-disabled","false")),DW(r);const a=e.getAttribute("data-gear-own-gear-id")||"",i=nne(e,{name:n.name||"",existingId:a||r.currentOwnedEntryId||""});r.currentOwnedEntryId=i?i.id:"";const s=!!(n.name&&n.name.trim());r.ownedCheckbox&&(r.ownedCheckbox.checked=!!i&&s,r.ownedCheckbox.disabled=!s,r.ownedCheckbox.disabled?r.ownedCheckbox.setAttribute("aria-disabled","true"):r.ownedCheckbox.removeAttribute("aria-disabled")),r.ownedContainer&&(r.ownedContainer.hidden=!1),i&&e?e.setAttribute("data-gear-own-gear-id",i.id):a&&e.removeAttribute("data-gear-own-gear-id");const l=!(t&&t.allowRentalToggle===!1);if(r.quantityInput&&(r.quantityInput.value=n.quantity||""),r.nameInput){r.nameInput.value=n.name||"";const S=e.getAttribute("data-gear-suggestions")||"";S?r.nameInput.setAttribute("list",S):r.nameInput.removeAttribute("list")}if(r.attributesInput&&(r.attributesInput.value=n.attributes||""),r.noteInput&&(r.noteInput.value=n.note||""),r.extraCheckbox){const S=!!n.extra;r.extraCheckbox.checked=S,pM(r,S)}r.extraStartInput&&(r.extraStartInput.value=n.extraStart||""),r.extraEndInput&&(r.extraEndInput.value=n.extraEnd||""),r.extraPeriodContainer&&!r.extraCheckbox&&(r.extraPeriodContainer.hidden=!0,r.extraPeriodContainer.setAttribute("hidden","")),r.providerSelect&&pW(r,n);const c=Zi(n.cameraLink),u=rp(e);r.isCameraItem=u,r.cameraLinkContainer&&(r.cameraLinkContainer.hidden=!1,r.cameraLinkContainer.removeAttribute("hidden"));const f=os();if(r.cameraLinkLabel){const S=u?f.cameraAssignmentLabel:f.cameraLinkLabel;r.cameraLinkLabel.textContent=S;const y=u?f.cameraAssignmentHelp:f.cameraLinkHelp;y?r.cameraLinkLabel.setAttribute("data-help",y):r.cameraLinkLabel.removeAttribute("data-help")}if(r.cameraLinkHelp){const S=u?f.cameraAssignmentHelp:f.cameraLinkHelp;r.cameraLinkHelp.textContent=S||"",S?(r.cameraLinkHelp.hidden=!1,r.cameraLinkHelp.removeAttribute("hidden")):(r.cameraLinkHelp.hidden=!0,r.cameraLinkHelp.setAttribute("hidden",""))}if(r.cameraLinkSelect){mW(r,n);const S=u?c||"A":c||"";r.cameraLinkSelect.value=S,r.cameraLinkSelect.disabled=!1,r.cameraLinkSelect.removeAttribute("aria-disabled")}r.currentCameraLinkValue=c||(u?"A":""),HW(r,!!n.rentalExcluded,l);const d=(()=>{const S=e.querySelector(".gear-item-text");return S&&S.textContent?S.textContent.trim():n.name||""})(),h=NW(r)||d;r.preview&&h&&(r.preview.textContent=h,r.preview.hidden=!1),r.title&&(r.title.textContent=h?`${f.dialogTitle}  ${h}`:f.dialogTitle),jW(r);const m=typeof n.name=="string"?n.name:"",g=r.nameInput?r.nameInput.value:m;FW(r,{name:g,fallbackName:m});try{typeof r.dialog.showModal=="function"?r.dialog.showModal():r.dialog.hidden=!1}catch(S){return console.warn("Failed to open gear item edit dialog",S,o),Yo=null,!1}if(t.focusField==="name"&&r.nameInput)try{r.nameInput.focus({preventScroll:!0})}catch{}else if(r.quantityInput)try{r.quantityInput.focus({preventScroll:!0})}catch{}return!0}function $W(e,t,r){const n=gearListOutput&&gearListOutput.ownerDocument||(typeof document<"u"?document:null);if(!n)return null;const o=n.createElement("template"),a=r&&Object.prototype.hasOwnProperty.call(r,"quantity")?r.quantity:"1",i=r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:"",s=r&&Object.prototype.hasOwnProperty.call(r,"attributes")?r.attributes:"",l=r&&Object.prototype.hasOwnProperty.call(r,"note")?r.note:"",c=r&&Object.prototype.hasOwnProperty.call(r,"extra")?r.extra:!1,u=r&&Object.prototype.hasOwnProperty.call(r,"extraStart")?r.extraStart:"",f=r&&Object.prototype.hasOwnProperty.call(r,"extraEnd")?r.extraEnd:"",d=typeof a=="string"?a:String(a??""),p=typeof i=="string"?i:String(i??""),h=typeof s=="string"?s:String(s??""),m=typeof l=="string"?l:String(l??""),g=c===!0||c==="true"||c===1||c==="1",S=typeof u=="string"?u:String(u??""),y=typeof f=="string"?f:String(f??""),E=Vi("gearListRemoveCustomItem","Remove"),L=Vi("gearListRemoveCustomItemFromCategory","Remove custom item from {category}",{category:t}),v=Vi("gearListEditCustomItem","Edit custom item"),A=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS,R=A&&(ICON_GLYPHS.sliders||ICON_GLYPHS.gears||ICON_GLYPHS.gearList||ICON_GLYPHS.settingsGeneral||ICON_GLYPHS.note)||null,I=typeof iconMarkup=="function"&&A?iconMarkup(ICON_GLYPHS.minus,{className:"btn-icon"}):"",C=typeof iconMarkup=="function"&&R?iconMarkup(R,{className:"btn-icon"}):"",k=Mg(),_=k.noteLabel&&k.noteLabel.trim()?k.noteLabel:"";o.innerHTML=`
    <div class="gear-custom-item" data-gear-custom-entry="${Be(e)}">
      <div class="gear-custom-item-summary">
        <span class="gear-custom-item-preview" aria-hidden="true"></span>
        <span class="gear-item-note" hidden></span>
      </div>
      <div class="gear-custom-item-actions">
        <button
          type="button"
          class="gear-item-edit-btn"
          data-gear-edit
          aria-label="${Be(v)}"
        >
          ${C||`<span class="gear-item-edit-fallback">${Be(v)}</span>`}
        </button>
        <button
          type="button"
          class="gear-custom-remove-btn"
          data-gear-custom-remove="${Be(e)}"
          data-gear-custom-category="${Be(t)}"
          aria-label="${Be(L)}"
        >
          ${I}<span>${Be(E)}</span>
        </button>
      </div>
    </div>
  `.trim();const w=o.content.firstElementChild;return w?(_&&w.setAttribute("data-rental-note",_),w.setAttribute("data-gear-quantity",d),w.setAttribute("data-gear-label",p),h?w.setAttribute("data-gear-attributes",h):w.removeAttribute("data-gear-attributes"),m?w.setAttribute("data-gear-note",m):w.removeAttribute("data-gear-note"),yg(w,{quantity:d,name:p,attributes:h,note:m,rentalExcluded:r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"),providedBy:r&&(r.providedBy||r.provider)?r.providedBy||r.provider:"",providerLabel:r&&r.providerLabel?r.providerLabel:"",extra:g,extraStart:S,extraEnd:y}),w):null}function iR(){Ms(),typeof fa=="function"&&fa(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged()}function vw(e,t,r={},n={}){const o=uM(e);if(!o)return null;const a=$W(e,t,r);if(!a)return null;o.appendChild(a),fM(a,e,t);const i=r&&(r.extra===!0||r.extra==="true"||r.extra===1||r.extra==="1"),s=r&&Object.prototype.hasOwnProperty.call(r,"extraStart")?r.extraStart:"",l=r&&Object.prototype.hasOwnProperty.call(r,"extraEnd")?r.extraEnd:"";yg(a,{quantity:r&&Object.prototype.hasOwnProperty.call(r,"quantity")?r.quantity:"",name:r&&Object.prototype.hasOwnProperty.call(r,"name")?r.name:"",attributes:r&&Object.prototype.hasOwnProperty.call(r,"attributes")?r.attributes:"",note:r&&Object.prototype.hasOwnProperty.call(r,"note")?r.note:"",rentalExcluded:r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"),providedBy:r&&(r.providedBy||r.provider)?r.providedBy||r.provider:"",providerLabel:r&&r.providerLabel?r.providerLabel:"",extra:i,extraStart:s,extraEnd:l,cameraLink:r&&Object.prototype.hasOwnProperty.call(r,"cameraLink")?r.cameraLink:"",cameraLinkLabel:r&&Object.prototype.hasOwnProperty.call(r,"cameraLinkLabel")?r.cameraLinkLabel:""},{skipPreview:!1});const c=!!(r&&(r.rentalExcluded===!0||r.rentalExcluded==="true"));if(pS(a,c),!n.skipFocus){const u=a.querySelector("[data-gear-edit]");u&&u.focus()}return!n.skipEditDialog&&typeof requestAnimationFrame=="function"&&requestAnimationFrame(()=>{try{zW(a,{focusField:"name",allowRentalToggle:!0})}catch(u){console.warn("Failed to open gear item editor for new custom item",u)}}),n.skipPersist||iR(),a}function VW(e={}){const t=aoe();if(!t)return null;const r=MW(),n=t.getAttribute("data-gear-custom-category")||r.categoryLabel;return vw(Nf,n,{quantity:e&&Object.prototype.hasOwnProperty.call(e,"quantity")?e.quantity:"1",name:e&&Object.prototype.hasOwnProperty.call(e,"name")?e.name:"",attributes:e&&Object.prototype.hasOwnProperty.call(e,"attributes")?e.attributes:"",note:e&&Object.prototype.hasOwnProperty.call(e,"note")?e.note:"",extra:!0,extraStart:e&&Object.prototype.hasOwnProperty.call(e,"extraStart")?e.extraStart:"",extraEnd:e&&Object.prototype.hasOwnProperty.call(e,"extraEnd")?e.extraEnd:""},{skipFocus:!!(e&&e.skipFocus),skipPersist:!!(e&&e.skipPersist),skipEditDialog:!!(e&&e.skipEditDialog)})}function Eoe(e){if(!e)return;const t=e.getAttribute("data-gear-custom-add")||"";if(!t)return;const r=e.getAttribute("data-gear-custom-category")||"";if(e.hasAttribute("data-extra-gear")||t===Nf){VW({skipFocus:!1,skipPersist:!1,skipEditDialog:!1});return}vw(t,r,{quantity:"1",name:""})}function Aoe(e){if(!e)return;const t=e.closest(".gear-custom-item");if(!t)return;const r=e.getAttribute("data-gear-custom-remove")||t.getAttribute("data-gear-custom-entry")||"";if(t.remove(),iR(),r){const n=gearListOutput?.querySelector(`[data-gear-custom-add="${r}"]`);n&&n.focus()}}function Coe(){if(!gearListOutput)return{};const e={};return gearListOutput.querySelectorAll(".gear-custom-items[data-gear-custom-list]").forEach(r=>{const n=r.getAttribute("data-gear-custom-list");if(!n)return;const o=[];r.querySelectorAll(".gear-custom-item").forEach(a=>{const i=String(a.getAttribute("data-gear-quantity")||""),s=String(a.getAttribute("data-gear-label")||a.getAttribute("data-gear-name")||""),l=String(a.getAttribute("data-gear-attributes")||""),c=String(a.getAttribute("data-gear-note")||""),u=a.getAttribute("data-rental-excluded")==="true",f=String(a.getAttribute("data-gear-provider")||""),d=String(a.getAttribute("data-gear-provider-label")||""),p=a.getAttribute("data-gear-extra")==="true",h=String(a.getAttribute("data-gear-extra-start")||""),m=String(a.getAttribute("data-gear-extra-end")||""),g=String(a.getAttribute("data-gear-camera-link")||""),S=String(a.getAttribute("data-gear-camera-link-label")||"");o.push({quantity:i,name:s,attributes:l,note:c,rentalExcluded:u,providedBy:f,providerLabel:d,extra:p,extraStart:h,extraEnd:m,cameraLink:g,cameraLinkLabel:S})}),o.length&&(e[n]=o)}),e}function uP(e={}){const t=(B,X)=>X||(typeof document<"u"?document.getElementById(B):null),r=t("cameraSelect",typeof cameraSelect<"u"?cameraSelect:null),n=t("monitorSelect",typeof monitorSelect<"u"?monitorSelect:null),o=t("videoSelect",typeof videoSelect<"u"?videoSelect:null),a=t("distanceSelect",typeof distanceSelect<"u"?distanceSelect:null),i=t("cageSelect",typeof cageSelect<"u"?cageSelect:null),s=t("batterySelect",typeof batterySelect<"u"?batterySelect:null),l=B=>{if(!B||!B.options||typeof B.selectedIndex!="number"||B.selectedIndex<0)return"";const X=B.options[B.selectedIndex];return X?(typeof X.text=="string"?X.text:typeof X.textContent=="string"?X.textContent:"").trim():""},c={camera:r&&typeof r.value<"u"&&r.value&&r.value!=="None"?l(r):"",monitor:n&&typeof n.value<"u"&&n.value&&n.value!=="None"?l(n):"",video:o&&typeof o.value<"u"&&o.value&&o.value!=="None"?l(o):"",motors:(typeof motorSelects<"u"&&Array.isArray(motorSelects)?motorSelects:[]).map(B=>B&&typeof B.value<"u"&&B.value&&B.value!=="None"?l(B):"").filter(Boolean),controllers:(typeof controllerSelects<"u"&&Array.isArray(controllerSelects)?controllerSelects:[]).map(B=>B&&typeof B.value<"u"&&B.value&&B.value!=="None"?l(B):"").filter(Boolean),distance:a&&typeof a.value<"u"&&a.value&&a.value!=="None"?l(a):"",cage:i&&typeof i.value<"u"&&i.value&&i.value!=="None"?l(i):"",battery:s&&typeof s.value<"u"&&s.value&&s.value!=="None"?l(s):""},d=os().cameraLinkDefaultLabel.replace("%s","A"),p=typeof c.camera=="string"&&c.camera.trim()||d,h=!!p,m=new Set,g=B=>{if(!h||typeof B!="string")return;const X=normalizeGearNameForComparison(B);X&&m.add(X)},S=B=>{if(!B||typeof B!="string")return;const X=B.trim();if(!X)return;g(X);const $=fn(X);$&&$!==X&&g($)},y=B=>{!B||!h||(B.cameraLink=!0,p&&!B.cameraLinkLabel&&(B.cameraLinkLabel=p))},E=({base:B,entry:X})=>{if(h)try{const $=normalizeGearNameForComparison(B);$&&m.has($)&&y(X)}catch{}},L=B=>{if(!h)return"";const X=typeof B=="string"&&B.trim()?B.trim():p,$=['data-gear-camera-link="camera"'];return X&&$.push(`data-gear-camera-link-label="${Be(X)}"`),$.join(" ")},v=c.motors.length>0,A=e.videoDistribution?e.videoDistribution.split(",").map(B=>B.trim()).filter(Boolean):[],R=A.map(B=>{const X=B.match(/^(Director|Gaffer|DoP) Monitor (?:(\d+)" )?handheld$/);return X?{role:X[1],size:X[2]?parseFloat(X[2]):void 0}:null}).filter(Boolean),I=A.map(B=>{const X=B.match(/^(Director|Combo|DoP) Monitor 15-21"$/);return X?{role:X[1]}:null}).filter(Boolean);["Arri Alexa Mini","Arri Amira"].includes(c.camera)?c.viewfinder="ARRI K2.75004.0 MVF-1 Viewfinder":c.viewfinder="";const{cameraSupport:C,chargers:k,fizCables:_,misc:w,monitoringSupport:x,rigging:G}=fne({hasMotor:v,videoDistPrefs:A}),T=devices.accessories?.cages||{},P=[];if(cameraSelect&&cameraSelect.value&&cameraSelect.value!=="None")for(const[B,X]of Object.entries(T))(!X.compatible||X.compatible.includes(cameraSelect.value))&&P.push(B);const N=C.filter(B=>!P.includes(B));if(c.viewfinder){const B=new Set(N.map($=>normalizeGearNameForComparison($))),X=normalizeGearNameForComparison(c.viewfinder);B.has(X)||N.push(c.viewfinder)}const q=e.requiredScenarios?e.requiredScenarios.split(",").map(B=>B.trim()).filter(Boolean):[],Z=hasSeededAutoGearDefaults(),U=autoGearRules.length===0&&!Z,K=B=>U&&q.includes(B),H=B=>U&&B.some(X=>q.includes(X)),te=K("Gimbal");if(H(["Trinity","Steadicam"])){for(let B=0;B<2;B++)G.push("D-Tap Splitter");G.push("D-Tap Extension 50 cm (Steadicam/Trinity)"),G.push("D-Tap Extension 50 cm (Spare)")}const re=e.cameraHandle?e.cameraHandle.split(",").map(B=>B.trim()).filter(Boolean):[],fe=e.viewfinderExtension?e.viewfinderExtension.split(",").map(B=>B.trim()).filter(Boolean):[],Oe=[...e.viewfinderSettings?e.viewfinderSettings.split(",").map(B=>B.trim()):[],...e.frameGuides?e.frameGuides.split(",").map(B=>B.trim()):[],...e.aspectMaskOpacity?e.aspectMaskOpacity.split(",").map(B=>B.trim()):[],...e.monitoringSettings?e.monitoringSettings.split(",").map(B=>B.trim()):[]].filter(Boolean),Te=Ob(e.lenses),Ne=Te.reduce((B,X)=>{const $=devices.lenses&&devices.lenses[X];return Math.max(B,$&&$.frontDiameterMm||0)},0),Ie=parseFilterTokens(e.filter),Ze=Ie.map(B=>B.type).some(B=>B==="ND Grad HE"||B==="ND Grad SE"),Ft=buildFilterGearEntries(Ie);let Ye=collectFilterAccessories(Ie);if(Ft.length&&Ye.length){const B=new Set(Ft.map(X=>normalizeGearNameForComparison(X.gearName)));Ye=Ye.filter(X=>!B.has(normalizeGearNameForComparison(X)))}const ct=buildFilterSelectHtml(Ie,Ft);if(e.mattebox){const B=e.mattebox.trim();B==="Swing Away"?(Ye.push("ARRI LMB 4x5 Pro Set"),Ye.push("ARRI LMB 19mm Studio Rod Adapter"),Ye.push("ARRI LMB 4x5 / LMB-6 Tray Catcher")):B==="Rod based"?(Ye.push("ARRI LMB 4x5 15mm LWS Set 3-Stage"),Ye.push("ARRI LMB 19mm Studio Rod Adapter"),Ye.push("ARRI LMB 4x5 / LMB-6 Tray Catcher"),Ye.push("ARRI LMB 4x5 Side Flags"),Ye.push("ARRI LMB Flag Holders"),Ye.push("ARRI LMB 4x5 Set of Mattes spherical"),Ye.push("ARRI LMB Accessory Adapter"),Ye.push("ARRI Anti-Reflection Frame 4x5.65")):B==="Clamp On"&&(Ye.push("ARRI LMB 4x5 Clamp-On (3-Stage)"),Ye.push("ARRI LMB 4x5 / LMB-6 Tray Catcher"),Ye.push("ARRI LMB 4x5 Side Flags"),Ye.push("ARRI LMB Flag Holders"),Ye.push("ARRI LMB 4x5 Set of Mattes spherical"),Ye.push("ARRI LMB Accessory Adapter"),Ye.push("ARRI Anti-Reflection Frame 4x5.65"),Ye.push("ARRI LMB 4x5 Clamp Adapter Set Pro"))}e.mattebox&&!Ze&&e.mattebox.toLowerCase().includes("clamp")&&[...new Set(Te.map($=>devices.lenses&&devices.lenses[$]&&devices.lenses[$].frontDiameterMm).filter(Boolean))].forEach($=>Ye.push(`ARRI LMB 4x5 Clamp Adapter ${$}mm`)),fe.forEach(B=>N.push(B)),H(["Rain Machine","Extreme rain"])&&(Ye.push("Schulz Sprayoff Micro"),Ye.push("Spare Disc (Schulz Sprayoff Micro)"),G.push("Fischer RS to D-Tap cable 0,5m"),G.push("Fischer RS to D-Tap cable 0,5m"));let Y=[],ee="";if(te){const B=e.gimbal?e.gimbal.split(",").map($=>$.trim()).filter(Boolean):[],X=Ne>95;if(B.length)Y=B.map($=>/Ronin RS4 Pro/i.test($)&&X?"DJI Ronin 2":$),Y.length===1&&(ee=Y[0]);else{const $=devices&&devices.cameras&&devices.cameras[c.camera],ue=$&&$.weight_g,ce=ue!=null?ue<2e3:/(FX3|FX6|R5)/i.test(c.camera);ee=X?"DJI Ronin 2":ce?"DJI Ronin RS4 Pro Combo":"DJI Ronin 2",Y=[ee]}/Ronin RS4 Pro/i.test(ee)&&Ne<=95?(Ye.push("Tilta Mirage VND Kit"),Ye.push("Tilta 95 mm Polarizer Filter fr Tilta Mirage"),Ye.push("Vaxis 95 mm IRND Filter 0.3 + 0.6 + 0.9 + 1.2 Filter"),Ye.push("Vaxis 95mm Black Mist 1/4 + 1/8 Filter")):Ye.push("Arri KK.0038066 Flexible Sunshade Side Flag Holders Set")}const Ae=[];R.forEach(B=>Ae.push(`${B.role} handheld`)),I.forEach(B=>Ae.push(`${B.role} 15-21"`)),v&&Ae.push("Focus");const ve=Ae.length;if(c.video){x.push("Antenna 5,8GHz 5dBi Long (spare)");const B=c.video.replace(/ TX\b/," RX");if(devices&&devices.wirelessReceivers&&devices.wirelessReceivers[B]){const X=ve||1;for(let $=0;$<X;$++)x.push("Antenna 5,8GHz 5dBi Long (spare)")}}const se=B=>{x.push(`D-Tap to Lemo-2-pin Cable 0,3m (${B})`,`D-Tap to Lemo-2-pin Cable 0,3m (${B})`,`Ultraslim BNC Cable 0.3 m (${B})`,`Ultraslim BNC Cable 0.3 m (${B})`)};R.forEach(B=>se(`${B.role} handheld`));const de=B=>{x.push(`D-Tap to Lemo-2-pin Cable 0,5m (${B})`,`D-Tap to Lemo-2-pin Cable 0,5m (${B})`,`Ultraslim BNC Cable 0.5 m (${B})`,`Ultraslim BNC Cable 0.5 m (${B})`)};I.forEach(B=>de(`${B.role} 15-21"`));const be='SHAPE Telescopic Handle ARRI Rosette Kit 12"',ye=()=>{N.includes(be)||N.push(be)};K("Handheld")&&K("Easyrig")&&ye(),re.includes("Hand Grips")&&ye(),re.includes("Handle Extension")&&N.push("ARRI K2.0019797 HEX-3"),re.includes("L-Handle")&&N.push("ARRI KK.0037820 Handle Extension Set");const $e={...e},xe=texts[currentLang]?.projectForm||texts.en?.projectForm||{},St=texts[currentLang]?.projectFields||texts.en?.projectFields||{},Tt=Pre(e&&e.rentalHouse?e.rentalHouse:"");if(Tt){const B=[],X=[],$=Tt.phone?String(Tt.phone).trim():"";if($){const ge=p0($),He=Be($);X.push($),ge?B.push(`<a href="tel:${ge}" class="req-contact-link">${He}</a>`):B.push(He)}const ue=Tt.email?String(Tt.email).trim():"";if(ue){const ge=m0(ue),He=Be(ue);X.push(ue),ge?B.push(`<a href="mailto:${ge}" class="req-contact-link">${He}</a>`):B.push(He)}B.length&&($e.rentalHouseContact={__html:B.join("<br>"),text:X.join(`
`)});const ce=Tt.address?String(Tt.address).trim():"";ce&&($e.rentalHouseAddress=ce)}let xt=HH($e,e,St);xt||Ju.some(X=>{const $=$e[X];return typeof $=="string"?$.trim().length>0:$!=null})&&(xt=HH($e,$e,St));const ut=xe.storageSummaryFallback||xe.storageTypeLabel||"Media",Er=texts[currentLang]?.crewRoles||texts.en?.crewRoles||{};if(Array.isArray(e.people)){const B=[],X=[];e.people.filter($=>$&&typeof $.name=="string"&&$.name.trim()).forEach($=>{const ue=Er[$.role]||$.role||"",ce=Be(ue),ge=typeof $.name=="string"?$.name.trim():$.name?String($.name).trim():"";if(!ge)return;const He=Be(ge),_e=[],Fe=[],gt=typeof $.phone=="string"?$.phone.trim():$.phone?String($.phone).trim():"";if(gt){const er=p0(gt),Qt=Be(gt);Fe.push(gt),er?_e.push(`<a href="tel:${er}" class="req-contact-link">${Qt}</a>`):_e.push(Qt)}const Ve=typeof $.email=="string"?$.email.trim():$.email?String($.email).trim():"";if(Ve){const er=m0(Ve),Qt=Be(Ve);Fe.push(Ve),er?_e.push(`<a href="mailto:${er}" class="req-contact-link">${Qt}</a>`):_e.push(Qt)}const Pt=_e.length?` (${_e.join(", ")})`:"",Zt=Fe.length?` (${Fe.join(", ")})`:"",mr=ue?`${ce}: `:"",gr=ue?`${ue}: `:"";B.push(`<span class="crew-entry">${mr}${He}${Pt}</span>`),X.push(`${gr}${ge}${Zt}`)}),B.length&&($e.crew={__html:B.join("<br>"),text:X.join(`
`)})}if(delete $e.people,Array.isArray(e.storageRequirements)){const B=[],X=[];e.storageRequirements.forEach($=>{if(!$||typeof $!="object")return;const ue=Number.isFinite($.quantity)&&$.quantity>0?$.quantity:null,ce=typeof $.type=="string"?$.type.trim():"",ge=typeof $.variant=="string"?$.variant.trim():"",He=typeof $.notes=="string"?$.notes.trim():"";if(!ue&&!ce&&!ge&&!He)return;let _e=ge||ce||"";ge&&ce&&!ge.toLowerCase().includes(ce.toLowerCase())?_e=`${ge} (${ce})`:!_e&&ce&&(_e=ce),He&&(_e=_e?`${_e}  ${He}`:He);const Fe=_e||ut,Ve=`${ue?`${ue}x `:""}${Fe}`.trim();X.push(Ve),B.push(`<span class="storage-entry">${Be(Ve)}</span>`)}),B.length&&($e.storageRequirements={__html:B.join("<br>"),text:X.join(`
`)})}if(Array.isArray(e.prepDays)&&($e.prepDays=e.prepDays.join(`
`)),Array.isArray(e.shootingDays)&&($e.shootingDays=e.shootingDays.join(`
`)),Array.isArray(e.returnDays)&&($e.returnDays=e.returnDays.join(`
`)),Oe.length&&($e.monitoringSupport=Oe.join(", ")),delete $e.monitoringSettings,delete $e.viewfinderSettings,delete $e.frameGuides,delete $e.aspectMaskOpacity,e.filter){const B=parseFilterTokens(e.filter);if(B.length){const X=B.map($=>{const ue=$.size&&$.size!=="4x5.65"?` (${Be($.size)})`:"",ce=$.values&&$.values.length?`: ${Be($.values.join(", "))}`:"";return`<span class="filter-req-token">${Be($.type)}${ue}${ce}</span>`});$e.filter={__html:X.join("<br>"),text:B.map($=>{const ue=$.size&&$.size!=="4x5.65"?` (${$.size})`:"",ce=$.values&&$.values.length?`: ${$.values.join(", ")}`:"";return`${$.type}${ue}${ce}`}).join(`
`)}}}const zt=uS(e.projectName||"")||e.projectName||"",dr=Be(zt),Jt=new Set(["filter","cameraHandle","viewfinderExtension","mattebox","videoDistribution","monitoringConfiguration","focusMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","sliderBowl","easyrig","lenses","viewfinderSettings","frameGuides","aspectMaskOpacity","viewfinderEyeLeatherColor","directorMonitor","dopMonitor","gafferMonitor","directorMonitor15","comboMonitor15","dopMonitor15","proGaffColor1","proGaffWidth1","proGaffColor2","proGaffWidth2","storageRequirements","monitorBatteries","lensSelections"]),rr=Object.entries($e).filter(([B,X])=>X&&B!=="projectName"&&!Jt.has(B)&&!B.endsWith("Manual")&&!(xt&&Ju.includes(B))),Jn=rr.length?'<div class="requirements-grid">'+rr.map(([B,X])=>{const $=jne(X),ue=St[B]||B,ce=iconMarkup(projectFieldIcons[B],{className:"req-icon",size:"var(--req-icon-size)"}),ge=[];B==="productionCompany"&&xt&&ge.push('data-has-address="true"');const He=ge.length?` ${ge.join(" ")}`:"";return`<div class="requirement-box" data-field="${B}"${He}>${ce}<span class="req-label">${Be(ue)}</span><span class="req-value">${$}</span></div>`}).join("")+"</div>":"",nr=xe.heading||"Project Requirements",$n=rr.length?`<h3>${Be(nr)}</h3>${Jn}`:"",De=Mg({rentalHouse:e&&e.rentalHouse}),vt=De.noteLabel&&De.noteLabel.trim()?` data-rental-note="${Be(De.noteLabel)}"`:"",Yt=(B,X={})=>{const $={},ue=Fe=>{const gt=Fe.trim();if(!gt)return{base:"",ctx:""};if(gt.charAt(gt.length-1)!==")")return{base:gt,ctx:""};const Ve=gt.lastIndexOf(" (");if(Ve===-1)return{base:gt,ctx:""};const Pt=gt.slice(0,Ve).trim(),Zt=gt.slice(Ve+2,-1).trim();return!Pt||!Zt||Zt.indexOf("(")!==-1||Zt.indexOf(")")!==-1?{base:gt,ctx:""}:{base:Pt,ctx:Zt}};B.filter(Boolean).forEach(Fe=>{let gt=Fe;try{if(typeof fn=="function"){const Pr=fn(Fe);typeof Pr=="string"&&Pr.trim()&&(gt=Pr)}}catch{}const Ve=gt.trim();if(!Ve)return;const Pt=Ve.match(/^(\d+)x\s+(.*)$/),Zt=Pt?parseInt(Pt[1],10):NaN,mr=Number.isFinite(Zt)&&Zt>0?Zt:1,gr=Pt?Pt[2]:Ve,{base:er,ctx:Qt}=ue(gr);if(!er)return;$[er]||($[er]={total:0,ctxCounts:{},cameraLink:!1,cameraLinkLabel:""});const tn=$[er];if(tn.total+=mr,tn.ctxCounts[Qt]=(tn.ctxCounts[Qt]||0)+mr,typeof X.onItem=="function")try{X.onItem({rawItem:Ve,base:er,context:Qt,quantity:mr,entry:tn})}catch(Pr){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("formatItems onItem callback failed",Pr)}});const ce=De,ge=ce.noteLabel&&ce.noteLabel.trim()?` data-rental-note="${Be(ce.noteLabel)}"`:"",He=Object.entries($),_e=typeof X.sorter=="function"?X.sorter:(Fe,gt)=>Ys(Fe[0],gt[0]);return He.sort((Fe,gt)=>{try{return _e(Fe,gt)}catch(Ve){return typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("formatItems sorter failed, falling back to default",Ve),Ys(Fe[0],gt[0])}}),He.map(([Fe,gt])=>{const Ve=gt.total,Pt=gt.ctxCounts,mr=Object.keys(Pt).some(dt=>dt);let gr=[];if(mr)if(Fe==="sand bag"){const dt=Object.entries(Pt).filter(([Dt])=>Dt&&Dt.toLowerCase()!=="spare").sort(([Dt],[ae])=>Ys(Dt,ae)),Zr=dt.reduce((Dt,[,ae])=>Dt+ae,0),Zn=Ve-Zr;gr=dt.map(([Dt,ae])=>`${ae}x ${Dt}`),Zn>0&&gr.push(`${Zn}x Spare`)}else if(Fe.startsWith("Bebob ")){const dt=Object.entries(Pt).filter(([Dt])=>Dt&&Dt.toLowerCase()!=="spare").map(([Dt,ae])=>{const at=Dt.match(/^(\d+)x\s+(.*)$/i);if(at){const[,Nt,Bn]=at,Tr=parseInt(Nt,10);if(Number.isFinite(Tr)&&Tr>0)return[Bn.trim(),ae*Tr]}return[Dt,ae]}).sort(([Dt],[ae])=>Ys(Dt,ae)),Zr=dt.reduce((Dt,[,ae])=>Dt+ae,0),Zn=Ve-Zr;gr=dt.map(([Dt,ae])=>`${ae}x ${Dt}`),Zn>0&&gr.push(`${Zn}x Spare`)}else{const dt=Object.entries(Pt).filter(([ae])=>ae&&ae.toLowerCase()!=="spare").sort(([ae],[at])=>Ys(ae,at)),Zr=dt.reduce((ae,[,at])=>ae+at,0),Zn=Object.entries(Pt).filter(([ae])=>ae&&ae.toLowerCase()==="spare").reduce((ae,[,at])=>ae+at,0);if(dt.length>0&&dt.every(([,ae])=>ae===dt[0][1])&&Zn===0?gr=dt.map(([ae])=>ae):gr=dt.map(([ae,at])=>`${at}x ${ae}`),Zn>0)gr.push(`${Zn}x Spare`);else if(Fe==="D-Tap Extension 50 cm"){const ae=Ve-Zr;ae>0&&gr.push(`${ae}x Spare`)}}const er=gr.length?` (${gr.join(", ")})`:"",Qt=gearItemTranslations[currentLang]?.[Fe]||Fe,tn=`${Qt}${er}`,Pr=`${Fe}${er}`,Ht=` data-gear-quantity="${Be(String(Ve))}"`,or=` data-gear-label="${Be(Qt)}"`,At=gr.length?` data-gear-attributes="${Be(gr.join(", "))}"`:"",Fa=Be(Pr),jo=`${Ve}x ${tn}`,jr=[];if(gt.cameraLink){const dt=L(gt.cameraLinkLabel);dt&&jr.push(dt)}const ar=jr.length?` ${jr.join(" ")}`:"";return`<span class="gear-item" data-gear-name="${Fa}"${Ht}${or}${At}${ge}${ar}><span class="gear-item-text">${Be(jo)}</span><span class="gear-item-note" hidden></span></span>`}).join("")},j=(B,X={})=>{if(!B)return"";const{name:$="",quantity:ue="",label:ce="",attributes:ge="",rentalNote:He=vt,extraAttributes:_e=""}=X,Fe=$?` data-gear-name="${Be(String($))}"`:"",gt=ue?` data-gear-quantity="${Be(String(ue))}"`:"",Ve=ce?` data-gear-label="${Be(String(ce))}"`:"",Pt=ge?` data-gear-attributes="${Be(String(ge))}"`:"",Zt=typeof He=="string"?He:"",mr=_e?` ${_e.trim()}`:"";return`<span class="gear-item"${Fe}${gt}${Ve}${Pt}${Zt}${mr}><span class="gear-item-text">${B}</span><span class="gear-item-note" hidden></span></span>`},O=(B,X)=>{if(typeof registerDevice!="function")return;const $={};B.filter(Boolean).forEach(ue=>{const ce=ue.trim().match(/^(.*?)(?: \(([^()]+)\))?$/),ge=ce?ce[1].trim():ue.trim();$[ge]=$[ge]||{}}),Object.keys($).length&&registerDevice(X,$)},D=[],F=(B,X)=>{if(!X||!String(X).trim())return;const ue=(typeof B=="string"?B:String(B??"")).trim()||String(B??""),ce=bw(ue),ge=Be(ue),He=Vi("gearListAddCustomItem","Add custom item"),_e=Vi("gearListAddCustomItemToCategory","Add custom item to {category}",{category:ue}),Fe=typeof ICON_GLYPHS=="object"&&ICON_GLYPHS?ICON_GLYPHS.add||ICON_GLYPHS.plus:null,Ve=(typeof iconMarkup=="function"&&Fe?iconMarkup(Fe,{className:"btn-icon"}):"")||Be("+"),Pt=`<button type="button" class="gear-custom-add-btn" data-gear-custom-add="${Be(ce)}" data-gear-custom-category="${ge}" aria-label="${Be(_e)}" title="${Be(He)}">${Ve}</button>`,Zt=`<div class="gear-standard-items">${X}</div>`,mr=`<div class="gear-custom-section" data-gear-custom-key="${Be(ce)}" data-gear-custom-category="${ge}"><div class="gear-custom-items" data-gear-custom-list="${Be(ce)}" data-gear-custom-category="${ge}" aria-live="polite"></div></div>`,gr=`${Zt}${mr}`;D.push(`<tbody class="category-group" data-gear-table-category="${ge}" data-gear-custom-key="${Be(ce)}"><tr class="category-row"><td data-gear-category-label="${ge}"><div class="gear-category-header"><span class="gear-category-label">${ge}</span>${Pt}</div></td></tr><tr><td>${gr}</td></tr></tbody>`)};F("Camera",Yt([c.camera])),N.forEach(B=>{const X=mre(B);X&&S(X)});const z=Yt(N,{onItem:E});let J="";if(P.length){const B=P.map(_e=>`<option value="${Be(_e)}"${_e===c.cage?" selected":""}>${Be(fn(_e))}</option>`).join(""),X=typeof Yc=="function"?Yc("category_cages"):"",$=X&&X.trim()?X.trim():"Camera Cage",ue=$?` aria-label="${Be($)}"`:"";$&&`${Be($)}`;const ce=`<span class="cage-select-wrapper"><span>1x</span><select id="gearListCage"${ue}>${B}</select></span>`;c.cage&&c.cage.trim();const ge=$,He=c.cage&&h?L(c.cage):"";J=j(ce,{name:ge,quantity:1,label:$,attributes:"",extraAttributes:He})}F("Camera Support",[z,J].filter(Boolean).join(""));const Q=Array.isArray(e.storageRequirements)?e.storageRequirements.map(B=>{if(!B||typeof B!="object")return"";const X=Number.isFinite(B.quantity)&&B.quantity>0?B.quantity:null,$=typeof B.type=="string"?B.type.trim():"",ue=typeof B.variant=="string"?B.variant.trim():"",ce=typeof B.notes=="string"?B.notes.trim():"";if(!X&&!$&&!ue&&!ce)return"";const ge=[],He=$.toLowerCase();let _e=ue||"";if(_e){const Ve=_e.toLowerCase();He&&!Ve.includes(He)&&$&&ge.push($)}else $&&(_e=$);_e||(_e=ut),ce&&ge.push(ce);const Fe=ge.length?` (${ge.join(", ")})`:"";return`${X?`${X}x `:""}${_e}${Fe}`.trim()}).filter(Boolean):[],le=devices&&devices.cameras&&c.camera?devices.cameras[c.camera]:null;let Ee="";if(Q.length)Ee=Yt(Q);else if(le&&Array.isArray(le.recordingMedia)&&le.recordingMedia.length){const B={"CFexpress Type A":"320GB","CFast 2.0":"512GB","CFexpress Type B":"512GB","Codex Compact Drive":"1TB","AXS Memory A-Series slot":"1TB",SD:"128GB","SD Card":"128GB",SDXC:"128GB","XQD Card":"120GB","RED MINI-MAG":"512GB",'REDMAG 1.8" SSD':"512GB","Blackmagic Media Module":"8TB","DJI PROSSD":"1TB","USB-C 3.1 Gen 1 expansion port for external media":"1TB","USB-C 3.1 Gen 2 expansion port for external media":"1TB","USB-C to external SSD/HDD":"1TB"};Ee=le.recordingMedia.slice(0,1).map(X=>{const $=X&&X.type?X.type:"";if(!$)return"";const ue=X&&X.brand?X.brand.trim():"";let ce="";if(X.notes){const _e=X.notes.match(/(\d+(?:\.\d+)?\s*(?:TB|GB))/i);_e&&(ce=_e[1].toUpperCase())}return ce||(ce=B[$]||"512GB"),`4x ${`${ue?`${Be(ue)} `:""}${Be(ce)} ${Be($)}`}<br>2x ${Be($)} reader with USB-C`}).filter(Boolean).join("<br>")}F("Media",Ee);const pe=(()=>{if(!le)return null;const B=le.requiredImageCircleMm??le.requiredImageCircle,X=Number(B);return Number.isFinite(X)?X:null})(),ne=Vi("gearListLensCoverageWarning","This lens may not cover the full sensor of this camera!"),Se=B=>{if(typeof B!="string")return"";const X=B.trim().toLowerCase();return X==="imperial"||X==="metric"?X:""},ke=(()=>{const B=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,$=(B&&typeof B.focusScalePreference=="string"?B.focusScalePreference:null)||(typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";return Se($)||"metric"})(),We=B=>!B||typeof B!="object"?ke:Se(B.focusScale)||ke,nt=typeof currentLang=="string"&&currentLang.trim()?currentLang:"en",it=(B,X={})=>{const $=typeof B=="string"?Number(B):B;if(!Number.isFinite($))return"";const ue=typeof X.maximumFractionDigits=="number"?X.maximumFractionDigits:0,ce=typeof X.minimumFractionDigits=="number"?X.minimumFractionDigits:Math.min(0,ue);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{return new Intl.NumberFormat(nt,{maximumFractionDigits:ue,minimumFractionDigits:ce}).format($)}catch{}const ge=Math.max(ce,Math.min(20,ue));try{return $.toFixed(ge)}catch{}return String($)},Et=(B,X=ke)=>{const $=typeof B=="string"?Number(B):B;if(!Number.isFinite($))return"";if(X==="imperial"){const ge=$/453.59237,He=ge>=10?1:2,_e=it(ge,{maximumFractionDigits:He,minimumFractionDigits:0});return _e?`${_e} lb`:""}const ce=it($,{maximumFractionDigits:0,minimumFractionDigits:0});return ce?`${ce} g`:""},yr=(B,X=ke)=>{const $=typeof B=="string"?Number(B):B;if(!Number.isFinite($))return"";if(X==="imperial"){const ge=$/25.4,He=ge>=10?1:2,_e=it(ge,{maximumFractionDigits:He,minimumFractionDigits:0});return _e?`${_e} in`:""}const ce=it($,{maximumFractionDigits:1,minimumFractionDigits:0});return ce?`${ce} mm`:""},hr=(B,X=ke)=>{const $=typeof B=="string"?Number(B):B;if(!Number.isFinite($))return"";if(X==="imperial"){const He=$*3.280839895,_e=He<10?2:1,Fe=it(He,{maximumFractionDigits:_e,minimumFractionDigits:_e});return Fe?`${Fe} ft`:""}const ce=$<1?2:1,ge=it($,{maximumFractionDigits:ce,minimumFractionDigits:ce});return ge?`${ge} m`:""},Vr=(B,X=ke)=>{const $=typeof B=="string"?Number(B):B;if(!Number.isFinite($))return"";if(X==="imperial"){const ge=$/2.54,He=ge>=10?1:2,_e=it(ge,{maximumFractionDigits:He,minimumFractionDigits:0});return _e?`${_e} in`:""}const ce=it($,{maximumFractionDigits:1,minimumFractionDigits:0});return ce?`${ce} cm`:""},Rr=new Map,Qe=Te.map(B=>{const X=devices.lenses&&devices.lenses[B],$=fn(B),ue=XK(B,X);if(Rr.set($,{manufacturer:ue.manufacturer,series:ue.series,focalLabel:ue.focalLabel,focalSortKey:ue.focalSortKey}),!X)return $;const ce=We(X),ge=[],He=Et(X.weight_g,ce);if(He&&ge.push(He),X.clampOn)if(X.frontDiameterMm){const Ve=yr(X.frontDiameterMm,ce);ge.push(Ve?`${Ve} clamp-on`:"clamp-on")}else ge.push("clamp-on");else X.clampOn===!1&&ge.push("no clamp-on");const _e=X.minFocusMeters??X.minFocus??(X.minFocusCm?X.minFocusCm/100:null);if(Number.isFinite(_e)&&_e>0){const Ve=hr(_e,ce);Ve&&ge.push(`${Ve} min focus`)}const Fe=Number(X.imageCircleMm??X.imageCircle);return Number.isFinite(pe)&&Number.isFinite(Fe)&&Fe+.5<pe&&ne&&ge.push(ne),ge.length?`${$} (${ge.join(", ")})`:$});F("Lens",Yt(Qe,{sorter:([B],[X])=>{const $=Rr.get(B),ue=Rr.get(X);if($&&ue){const ce=Ys($.manufacturer,ue.manufacturer);if(ce!==0)return ce;const ge=Ys($.series,ue.series);if(ge!==0)return ge;const He=Number.isFinite($.focalSortKey),_e=Number.isFinite(ue.focalSortKey);if(He&&_e&&$.focalSortKey!==ue.focalSortKey)return $.focalSortKey-ue.focalSortKey;if(He!==_e)return He?-1:1;const Fe=Ys($.focalLabel,ue.focalLabel);if(Fe!==0)return Fe}else{if($&&!ue)return-1;if(!$&&ue)return 1}return Ys(B,X)}}));const qn=B=>{if(!B&&B!==0)return[];const X=Array.isArray(B)?B:[B],$=new Set;return X.forEach(ce=>{const ge=(ce??"").toString().toLowerCase();ge&&(/\b15\s*mm\b/.test(ge)&&$.add("15mm"),/\b19\s*mm\b/.test(ge)&&$.add("19mm"))}),["15mm","19mm"].filter(ce=>$.has(ce))},Lo=[],sn=new Set;Te.forEach(B=>{const X=devices.lenses&&devices.lenses[B];if(!X)return;const $=qn(X.rodStandard),ue=$[0]||(X.rodStandard?X.rodStandard:"15mm"),ce=$[0]||(ue==="19mm"?"19mm":"15mm"),ge=X.rodLengthCm||(ce==="19mm"?45:30),He=`${ce}-${ge}`;if(!sn.has(He)){const Fe=Vr(ge,We(X))||`${ge}cm`;Lo.push(`${ce} rods ${Fe}`),sn.add(He)}X.needsLensSupport&&Lo.push(`${ce} lens support`)}),F("Lens Support",Yt(Lo)),F("Matte box + filter",[ct,Yt(Ye)].filter(Boolean).join(""));const hn=[],ln={clm3:!1,clm4:!1,clm5:!1};c.motors.forEach(B=>{const X=(B||"").toLowerCase();let $="";/cforce\s*mini\s*rf|cforce\s*rf/.test(X)?($="ARRI KK.0040345 CFORCE MINI RF Basic Set 2",hn.push($)):/cforce\s*mini/.test(X)&&!/rf/.test(X)?($="ARRI KK.0040344 Cforce Mini Basic Set 2",hn.push($)):/cforce\s*plus/.test(X)?($="Arri KK.0008824 cforce plus Basic Set",hn.push($),hn.push("ARRI K2.0009335 Cforce Plus Gear M0.8/32p, 60t")):/clm-3/.test(X)?($="Arri KK.0005854 Controlled Lens Motor CLM-3 Basic Set",hn.push($),ln.clm3||(hn.push("Arri K2.65145.0, Cable CLM-3 (7p) - CLM/FIZ (12p) (0,8m/2.6ft) (spare)"),ln.clm3=!0)):/clm-4/.test(X)?($="ARRI Controlled Lens Motor CLM-4, Basic Kit (KK.0005855)",hn.push($),ln.clm4||(hn.push("Arri K2.72099.0 CLM-4 Motor Cable (spare)"),ln.clm4=!0)):/clm-5/.test(X)&&($="Arri K2.0006361 Controlled Lens Motor CLM-5 Basic Set",hn.push($),ln.clm5||(hn.push("Arri K2.0006361 Controlled Lens Motor CLM-5 Basic Set (spare)"),ln.clm5=!0)),!$&&B&&($=B,hn.push(B)),$&&S($)}),c.controllers.forEach(S);const Zo=[],kn=c.distance;if(kn)if(kn.toLowerCase()==="udm-1 + lcube"){const X="Arri KK.0005853 Ultrasonic Distance Measure UDM-1 Basic Set";Zo.push(X),S(X);const $=c.controllers.some(ce=>/ria-1/i.test(ce)),ue=/alexa 35/i.test(c.camera||"");if(!$&&!ue){const ce="Arri KK.0009001 LCUBE CUB-1 Basic Set";Zo.push(ce),S(ce)}}else Zo.push(kn),S(kn);F("LDS (FIZ)",Yt([...hn,...c.controllers,...Zo,..._],{onItem:E}));let ea="";if(c.battery){S(c.battery);let B=batteryCountElem?parseInt(batteryCountElem.textContent,10):NaN;(!B||isNaN(B))&&(B=1);const X=[`${B}x ${c.battery}`],$=hotswapSelect&&hotswapSelect.value&&hotswapSelect.value!=="None"?l(hotswapSelect):"";$&&(X.push(`1x ${$}`),S($)),ea=Yt(X,{onItem:E})}F("Camera Batteries",ea);let Fr="";const yo=[];if(c.monitor){const B="Onboard Monitor",X=devices?.monitors||{},$=ar=>{if(typeof ar!="string")return"";const dt=ar.trim();if(!dt)return"";const Zr=dt.toLowerCase(),Zn=["linked","to","camera"],Dt="",ae=To=>To===" "||To==="	"||To===`
`||To==="\r"||To==="\f"||To==="\v"||To===Dt,at=To=>{let Ds=To;for(;Ds<Zr.length&&ae(Zr[Ds]);)Ds+=1;return Ds};let Nt=0;for(let To=0;To<Zn.length;To+=1){Nt=at(Nt);const Ds=Zn[To];if(Zr.slice(Nt,Nt+Ds.length)!==Ds)return dt;Nt+=Ds.length}const Bn=Nt;Nt=at(Nt);const Tr=Nt>Bn;if(Nt>=dt.length)return dt;const eo=new Set(["","","-",":"]);let ui=!1;return eo.has(dt[Nt])&&(Nt+=1,ui=!0),Nt=at(Nt),!Tr&&!ui||Nt>=dt.length?dt:dt.slice(Nt).trim()},ue=ar=>{if(typeof ar!="string")return"";const dt=ar.trim();if(!dt)return"";const Zr=ae=>ae==='"'||ae==="'"||ae===""||ae===""||ae===""||ae===""||ae==="";let Zn=0,Dt=dt.length;for(;Zn<Dt&&Zr(dt[Zn]);)Zn+=1;for(;Dt>Zn&&Zr(dt[Dt-1]);)Dt-=1;return dt.slice(Zn,Dt).trim()},ce=ar=>ue($(ar)),ge=typeof monitorSelect<"u"&&monitorSelect&&monitorSelect.value&&monitorSelect.value!=="None"?monitorSelect.value:"",He=typeof e.monitorSelection=="string"?e.monitorSelection.trim():"",_e=[],Fe=ar=>{const dt=typeof ar=="string"?ar.trim():"";if(!dt)return;_e.includes(dt)||_e.push(dt);const Zr=ce(dt);Zr&&!_e.includes(Zr)&&_e.push(Zr)};Fe(ge),Fe(He),Fe(c.monitor);let gt="",Ve=null;_e.some(ar=>Object.prototype.hasOwnProperty.call(X,ar)?(gt=ar,Ve=X[ar],!0):!1);let Pt=Ve&&typeof Ve.screenSizeInches<"u"?Number(Ve.screenSizeInches):NaN;if(!Number.isFinite(Pt)){const ar=parseFloat(String(Ve?.screenSizeInches??""));Pt=Number.isFinite(ar)?ar:NaN}Number.isFinite(Pt)||(Pt=NaN),Number.isFinite(Pt)&&yo.push(Pt);const mr=(ar=>{if(!Number.isFinite(ar))return"";const dt=Number(ar.toFixed(2));return Number.isInteger(dt)?String(dt):String(dt).replace(/\.0+$/,"")})(Pt),gr=mr?`${Be(mr)}&quot;`:"",er=ce(c.monitor)||gt||ce(He)||ce(ge),Qt=er?fn(er):"",tn=Qt?`&quot;${Be(Qt)}&quot;`:"",Pr=[`1x <strong>${B}</strong>`];gr&&Pr.push(gr),tn&&Pr.push(tn),Pr.push("incl. Sunhood");const Ht=Pr.join(" - "),or=[];mr&&or.push(`${mr}"`),Qt&&or.push(Qt),or.push("incl. Sunhood");const At=or.filter(Boolean).join(" - "),Fa=At?`${B} (${At})`:B,jo=Qt||ce(c.monitor)||ce(He)||ce(ge)||"",jr=h?L(jo||void 0):"";Fr+=(Fr?"<br>":"")+j(Ht,{name:Fa,quantity:1,label:B,attributes:At,extraAttributes:jr})}if(R.forEach(({role:B,size:X})=>{const $=devices&&devices.monitors?devices.monitors:{},ue=Object.keys($).filter(dt=>!$[dt].wirelessTx||$[dt].wirelessRX).sort(localeSort),ce=B==="DoP"?"dopMonitor":`${B.toLowerCase()}Monitor`,ge=!!e[`${ce}Manual`],He=typeof e[ce]=="string"?e[ce].trim():"",_e=getAutoGearMonitorDefault("handheld7");let Fe="";ge&&He?Fe=He:_e?Fe=_e:He&&(Fe=He);const gt=ue.map(dt=>dt.toLowerCase());let Ve="";if(Fe){const dt=gt.indexOf(Fe.toLowerCase());dt>=0&&(Ve=ue[dt])}if(!Ve){if(!ge&&X){const dt=ue.find(Zr=>$[Zr].screenSizeInches===X);X===7&&ue.includes("SmallHD Ultra 7")?Ve="SmallHD Ultra 7":dt&&(Ve=dt)}Ve||(!ge&&!Fe&&ue.includes("SmallHD Ultra 7")?Ve="SmallHD Ultra 7":ue.length?Ve=ue[0]:Fe&&(Ve=Fe))}const Pt=ue.slice();Fe&&!gt.includes(Fe.toLowerCase())&&Pt.unshift(Fe),Ve&&!Pt.some(dt=>dt.toLowerCase()===Ve.toLowerCase())&&Pt.unshift(Ve);const Zt=new Set,mr=Pt.filter(Boolean).filter(dt=>{const Zr=dt.toLowerCase();return Zt.has(Zr)?!1:(Zt.add(Zr),!0)}).map(dt=>{const Zr=dt.toLowerCase()===(Ve||"").toLowerCase();return`<option value="${Be(dt)}"${Zr?" selected":""}>${Be(fn(dt))}</option>`}).join(""),gr=B==="DoP"?"Dop":B,er=B.replace(/s$/,""),Qt=Array.from(Zt.values()).find(dt=>dt===(Ve||"").toLowerCase())?Pt.find(dt=>dt&&dt.toLowerCase()===(Ve||"").toLowerCase()):Ve,Pr=(Qt&&$[Qt]?$[Qt]:$[Ve]||$[Fe]||null)?.screenSizeInches||"",Ht=`${er} Handheld Monitor`,or=`<span id="monitorSize${gr}">(${Be(Pr?String(Pr):"")}&quot;)</span>`,At=`<select id="gearList${gr}Monitor" data-auto-gear-manual="${ge?"true":"false"}">${mr}</select>`,Fa=`1x <strong>${Be(Ht)}</strong> - ${or} - ${At} incl. Directors cage, shoulder strap, sunhood, rigging for teradeks`,jo=[];Pr&&jo.push(`${Pr}"`),Qt&&jo.push(fn(Qt)),jo.push("incl. Directors cage, shoulder strap, sunhood, rigging for teradeks");const jr=jo.filter(Boolean).join(" - "),ar=jr?`${Ht} (${jr})`:Ht;Fr+=(Fr?"<br>":"")+j(Fa,{name:ar,quantity:1,label:Ht,attributes:jr}),Pr&&yo.push(Pr)}),I.forEach(({role:B})=>{const X=devices&&devices.directorMonitors?devices.directorMonitors:{},$=Object.keys(X).filter(jr=>jr!=="None").sort(localeSort),ue=B==="DoP"?"dopMonitor15":B==="Combo"?"comboMonitor15":"directorMonitor15",ce=!!e[`${ue}Manual`],ge=typeof e[ue]=="string"?e[ue].trim():"",He=B==="Combo"?"combo15":"director15",_e=getAutoGearMonitorDefault(He);let Fe="";ce&&ge?Fe=ge:_e?Fe=_e:ge&&(Fe=ge);const gt=$.map(jr=>jr.toLowerCase());let Ve="";if(Fe){const jr=gt.indexOf(Fe.toLowerCase());jr>=0&&(Ve=$[jr])}Ve||($.includes('SmallHD Cine 24" 4K High-Bright Monitor')?Ve='SmallHD Cine 24" 4K High-Bright Monitor':$.length?Ve=$[0]:Fe&&(Ve=Fe));const Pt=$.slice();Fe&&!gt.includes(Fe.toLowerCase())&&Pt.unshift(Fe),Ve&&!Pt.some(jr=>jr.toLowerCase()===Ve.toLowerCase())&&Pt.unshift(Ve);const Zt=new Set,mr=Pt.filter(Boolean).filter(jr=>{const ar=jr.toLowerCase();return Zt.has(ar)?!1:(Zt.add(ar),!0)}).map(jr=>{const ar=jr.toLowerCase()===(Ve||"").toLowerCase();return`<option value="${Be(jr)}"${ar?" selected":""}>${Be(fn(jr))}</option>`}).join(""),gr=B==="DoP"?"Dop":B,er=Array.from(Zt.values()).find(jr=>jr===(Ve||"").toLowerCase())?Pt.find(jr=>jr&&jr.toLowerCase()===(Ve||"").toLowerCase()):Ve,Qt=er&&X[er]?.screenSizeInches?X[er].screenSizeInches:X[Ve]?.screenSizeInches||X[Fe]?.screenSizeInches||"",tn=`${B} Monitor`,Pr=`<span id="monitorSize${gr}15">(${Be(Qt?String(Qt):"")}&quot;)</span>`,Ht=`<select id="gearList${gr}Monitor15" data-auto-gear-manual="${ce?"true":"false"}">${mr}</select>`,or=`1x <strong>${Be(tn)}</strong> - ${Pr} - ${Ht} incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)`,At=[];Qt&&At.push(`${Qt}"`),er&&At.push(fn(er)),At.push("incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)");const Fa=At.filter(Boolean).join(" - "),jo=Fa?`${tn} (${Fa})`:tn;Fr+=(Fr?"<br>":"")+j(or,{name:jo,quantity:1,label:tn,attributes:Fa}),Qt&&yo.push(Qt)}),v){const B=devices&&devices.monitors?devices.monitors:{},X=Object.keys(B).filter(or=>!B[or].wirelessTx||B[or].wirelessRX).sort(localeSort),$=!!e.focusMonitorManual,ue=typeof e.focusMonitor=="string"?e.focusMonitor.trim():"",ce=getAutoGearMonitorDefault("focus");let ge="";$&&ue?ge=ue:ce?ge=ce:ue&&(ge=ue);const He=X.map(or=>or.toLowerCase());let _e="";if(ge){const or=He.indexOf(ge.toLowerCase());or>=0&&(_e=X[or])}_e||(X.includes("TV Logic F7HS")?_e="TV Logic F7HS":X.length?_e=X[0]:ge&&(_e=ge));const Fe=X.slice();ge&&!He.includes(ge.toLowerCase())&&Fe.unshift(ge),_e&&!Fe.some(or=>or.toLowerCase()===_e.toLowerCase())&&Fe.unshift(_e);const gt=new Set,Ve=Fe.filter(Boolean).filter(or=>{const At=or.toLowerCase();return gt.has(At)?!1:(gt.add(At),!0)}).map(or=>{const At=or.toLowerCase()===(_e||"").toLowerCase();return`<option value="${Be(or)}"${At?" selected":""}>${Be(fn(or))}</option>`}).join(""),Pt=Array.from(gt.values()).find(or=>or===(_e||"").toLowerCase())?Fe.find(or=>or&&or.toLowerCase()===(_e||"").toLowerCase()):_e,Zt=Pt&&B[Pt]?B[Pt].screenSizeInches:B[_e]?.screenSizeInches||B[ge]?.screenSizeInches||"",mr="Focus Monitor",gr=`<span id="monitorSizeFocus">(${Be(Zt?String(Zt):"")}&quot;)</span>`,er=`<select id="gearListFocusMonitor" data-auto-gear-manual="${$?"true":"false"}">${Ve}</select>`,Qt=`1x <strong>${Be(mr)}</strong> - ${gr} - ${er} incl Directors cage, shoulder strap, sunhood, rigging for teradeks`,tn=[];Zt&&tn.push(`${Zt}"`),Pt&&tn.push(fn(Pt)),tn.push("incl Directors cage, shoulder strap, sunhood, rigging for teradeks");const Pr=tn.filter(Boolean).join(" - "),Ht=Pr?`${mr} (${Pr})`:mr;Fr+=(Fr?"<br>":"")+j(Qt,{name:Ht,quantity:1,label:mr,attributes:Pr}),Zt&&yo.push(Zt)}const br=[],_t=yo.includes(5)?5:null;if(c.video){const B=_t?`${_t}&quot; - `:"",X=`Wireless Transmitter - ${B}${fn(c.video)}`;br.push(X),S(X);const $=c.video.replace(/ TX\b/," RX");devices&&devices.wirelessReceivers&&devices.wirelessReceivers[$]&&Ae.forEach(ue=>{const ce=`Wireless Receiver - ${B}${fn($)} (${ue})`;br.push(ce),S(ce)})}if(br.length){const B=Yt(br,{onItem:E}).replace(/>(\d+x )Wireless Transmitter/g,">$1<strong>Wireless Transmitter</strong>").replace(/>(\d+x )Wireless Receiver/g,">$1<strong>Wireless Receiver</strong>").replace(/&amp;quot;/g,"&quot;");Fr+=(Fr?"<br>":"")+B}const kt=(()=>{const B=e.monitorBatteries;if(!B||typeof B!="object"||Array.isArray(B))return{};const X={};return Object.entries(B).forEach(([$,ue])=>{if(typeof $!="string"||typeof ue!="string")return;const ce=ue.trim();ce&&(X[$]=ce)}),X})(),Mr=devices&&devices.batteries?devices.batteries:{},In=Object.keys(Mr).filter(B=>B&&B!=="None").sort(localeSort),Do=B=>{const X=typeof B=="string"?B.trim():"",$=In.slice();X&&!$.some(ce=>ce.toLowerCase()===X.toLowerCase())&&$.unshift(X);const ue=new Set;return $.filter(Boolean).filter(ce=>{const ge=ce.toLowerCase();return ue.has(ge)?!1:(ue.add(ge),!0)}).map(ce=>{const ge=X&&ce.toLowerCase()===X.toLowerCase();return`<option value="${Be(ce)}"${ge?" selected":""}>${Be(fn(ce))}</option>`}).join("")},ho=[],is=Object.keys(Mr).find(B=>/V98micro/i.test(B))||"Bebob V98micro";R.forEach((B,X)=>{const ue=(typeof B.role=="string"?B.role:"").trim(),ce=`${ue||"Monitor"} handheld`,ge=`handheld:${ue}:${X}`,He=kt[ge],_e=typeof He=="string"&&He.trim()||is,Fe=(ue||"Monitor").replace(/[^A-Za-z0-9]/g,"")||"Monitor",gt=`gearListMonitorBatteryHandheld${X}${Fe}`,Ve=Do(_e),Pt=`<select id="${gt}" data-monitor-battery-key="${Be(ge)}" data-monitor-battery-type="handheld" data-monitor-battery-role="${Be(ue)}">${Ve}</select>`,Zt=`Monitoring Battery ${ce}`,mr=' data-gear-quantity="3"',gr=' data-gear-label="Monitoring Battery"',er=ce?` data-gear-attributes="${Be(ce)}"`:"",Qt=`3x ${Pt} (${Be(ce)})`;ho.push(`<span class="gear-item" data-gear-name="${Be(Zt)}"${mr}${gr}${er}${vt}><span class="gear-item-text">${Qt}</span><span class="gear-item-note" hidden></span></span>`)});const nu=Object.keys(Mr).find(B=>/V290RM-Cine/i.test(B))||"Bebob V290RM-Cine";I.forEach((B,X)=>{const ue=(typeof B.role=="string"?B.role:"").trim(),ce=`${ue||"Monitor"} 15-21"`,ge=`large:${ue}:${X}`,He=kt[ge],_e=typeof He=="string"&&He.trim()||nu,Fe=(ue||"Monitor").replace(/[^A-Za-z0-9]/g,"")||"Monitor",gt=`gearListMonitorBatteryLarge${X}${Fe}`,Ve=Do(_e),Pt=`<select id="${gt}" data-monitor-battery-key="${Be(ge)}" data-monitor-battery-type="large" data-monitor-battery-role="${Be(ue)}">${Ve}</select>`,Zt=`Monitoring Battery ${ce}`,mr=' data-gear-quantity="2"',gr=' data-gear-label="Monitoring Battery"',er=ce?` data-gear-attributes="${Be(ce)}"`:"",Qt=`2x ${Pt} (${Be(ce)})`;ho.push(`<span class="gear-item" data-gear-name="${Be(Zt)}"${mr}${gr}${er}${vt}><span class="gear-item-text">${Qt}</span><span class="gear-item-note" hidden></span></span>`)}),F("Monitoring Batteries",ho.length?ho.join(""):""),F("Chargers",Yt(k)),F("Monitoring",Fr),O(x,"accessories.monitoringSupport");const si=Yt(x.filter(B=>typeof B!="string"?!0:!(B.startsWith("Monitoring Battery ")||B.endsWith("Monitor"))));F("Monitoring support",si);const bo=devices&&typeof devices=="object"&&devices.carts&&typeof devices.carts=="object"?devices.carts:{},Mn=Object.keys(bo).filter(B=>B&&B!=="None").sort(localeSort),xi=Mn.includes('Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)')?'Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)':Mn[0]||"",Da=[{pattern:/magliner\s+senior/,value:'Backstage Magliner Senior 24" Film Cart (8" Conversion Kit)'},{pattern:/magliner\s+junior/,value:'Backstage Magliner Junior 24" Film Cart (8" Conversion Kit)'},{pattern:/voyager\s*30/,value:"Inovativ Voyager 30 EVO X"},{pattern:/voyager\s*36/,value:"Inovativ Voyager 36 EVO X"},{pattern:/voyager\s*42/,value:"Inovativ Voyager 42 EVO X"},{pattern:/apollo\s*40/,value:"Inovativ Apollo 40 EVO"},{pattern:/apollo\s*52/,value:"Inovativ Apollo 52 EVO"},{pattern:/echo\s*36/,value:"Inovativ Echo 36 Workstation Cart"},{pattern:/echo\s*48/,value:"Inovativ Echo 48 Workstation Cart"},{pattern:/adicam\s+mini/,value:"Adicam MINI Camera Cart"},{pattern:/adicam\s+standard\+/,value:"Adicam STANDARD+ Camera Cart"},{pattern:/adicam\s+standard/,value:"Adicam STANDARD Camera Cart"},{pattern:/adicam\s+max/,value:"Adicam MAX Camera Cart"},{pattern:/tilta\s+boulder/,value:'Tilta Boulder 36" Camera Cart'},{pattern:/smallrig/,value:'SmallRig MD4573 36" Lightweight Video Production Camera Cart'}];function li(B){return B?B.replace(/["']/g,"").replace(/\(.*?\)/g,"").replace(/[^a-z0-9]+/gi," ").trim().toLowerCase():""}function ta(B){if(!Mn.length)return"";const X=typeof B=="string"?B.trim():"";if(X&&Object.prototype.hasOwnProperty.call(bo,X))return X;const $=li(X);if($){const ue=Mn.find(ge=>li(ge)===$);if(ue)return ue;const ce=Da.find(ge=>ge.pattern.test($)&&Mn.includes(ge.value));if(ce)return ce.value}return""}function So(B){return B?B.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/_/g," ").replace(/\b\w/g,X=>X.toUpperCase()):""}function ra(B,X){if(!B||typeof B!="object")return"";const $=[];X&&$.push(X),typeof B.diameterIn<"u"?$.push(`${B.diameterIn}"`):typeof B.diameterMainMm<"u"&&$.push(`${B.diameterMainMm} mm`),B.tireType&&$.push(B.tireType);const ue=$.filter(Boolean).join(" ");return B.notes?ue?`${ue} (${B.notes})`:B.notes:B.name&&ue?`${B.name} - ${ue}`:B.name||ue}function _n(B){if(!B||typeof B!="object")return[];const X=[],$=new Set,ue=(ge,He,_e,Fe)=>{if(!ge||!He||$.has(ge))return;const gt=fn(He)||He;X.push({value:ge,label:gt,selected:!!_e,title:Fe}),$.add(ge)};B.config&&typeof B.config=="object"&&Object.entries(B.config).forEach(([ge,He])=>{if(!He)return;const _e=So(ge);_e&&ue(`feature:${ge}`,_e,!0)});const ce=B.wheelConfig&&typeof B.wheelConfig=="object"?B.wheelConfig:null;if(ce&&ce.standard){const ge=ra(ce.standard,"Standard wheel")||"Standard wheel";ue("wheel:standard",ge,!0,ce.standard.notes)}return ce&&Array.isArray(ce.options)&&ce.options.forEach((ge,He)=>{const _e=ra(ge,ge&&ge.name?ge.name:"Wheel option")||`Wheel option ${He+1}`;ue(`wheel:option:${He}`,_e,!1,ge&&ge.notes)}),Array.isArray(B.kits)&&B.kits.forEach((ge,He)=>{const _e=ge&&ge.name?ge.name:`Kit ${He+1}`;ue(`kit:${He}`,_e,!1,ge&&ge.notes)}),X}function ki(B){if(!B||typeof B!="object")return[];const X=[],$=new Set,ue=(ce,ge,He,_e)=>{if(!ce||!ge||$.has(ce))return;const Fe=fn(ge)||ge;X.push({value:ce,label:Fe,selected:!!He,title:_e}),$.add(ce)};return Array.isArray(B.accessories)&&B.accessories.forEach((ce,ge)=>{ce&&ue(`accessory:${ge}`,ce,!0)}),Array.isArray(B.brandAccessories)&&B.brandAccessories.forEach((ce,ge)=>{if(!ce||!ce.name)return;const He=ce.accessoryKind?So(ce.accessoryKind):"",_e=He?`[${He}] ${ce.name}`:ce.name;ue(`brand:${ge}`,_e,!0,ce.notes)}),X}function Ii(B,X,$){if(!$.length)return"";const ue=X||"Options",ce=Math.min(6,Math.max(2,$.length)),ge=$.map(He=>{const _e=[`value="${Be(He.value)}"`];return He.selected&&_e.push("selected"),He.title&&_e.push(`title="${Be(He.title)}"`),`<option ${_e.join(" ")}>${Be(He.label)}</option>`}).join("");return`
        <span class="gear-cart-option">
          <span class="gear-cart-option-label">${Be(ue)}</span>
          <select id="${Be(B)}" multiple size="${ce}" aria-label="${Be(ue)}">
            ${ge}
          </select>
        </span>
      `.replace(/\s+/g," ").trim()}function Na(B,X){if(!Mn.length)return"";const $=ta(B)||xi||"";if(!$&&!B)return"";const ue=$||B,ce=Mn.length?Mn.map(Pr=>`<option value="${Be(Pr)}"${Pr===$?" selected":""}>${Be(fn(Pr)||Pr)}</option>`).join(""):`<option value="${Be(ue)}" selected>${Be(fn(ue)||ue)}</option>`,ge=`gearListCartSelect${X}`,He=Vi("gearListCartSelectorLabel","Camera cart"),_e=`<select id="${ge}" aria-label="${Be(He)}">${ce}</select>`,Fe=bo[$]||bo[ue]||null,gt=_n(Fe),Ve=ki(Fe),Pt=gt.length?Ii(`gearListCartConfig${X}`,Vi("gearListCartConfigurationLabel","Cart configuration"),gt):"",Zt=Ve.length?Ii(`gearListCartAccessories${X}`,Vi("gearListCartAccessoriesLabel","Cart accessories"),Ve):"",mr=[Pt,Zt].filter(Boolean).join(""),gr=mr?`<div class="gear-cart-detail">${mr}</div>`:"",er=He||"Camera cart",Qt=`1x <strong>${Be(er)}</strong> - ${_e}${gr}`,tn=ue?fn(ue)||ue:"";return j(Qt,{name:tn?`${er} (${tn})`:er,label:er,attributes:tn,extraAttributes:' data-gear-cart-entry="true"'})}function na(B){return!Array.isArray(B)||!B.length?"":B.map(($,ue)=>Na($,ue)).filter(Boolean).join("")}const vo=[];O(vo,"accessories.carts");const tt=[];let so=!1,oa="",ya="";if(R.forEach(B=>{tt.push(`Avenger C-Stand Sliding Leg 20" (${B.role} handheld)`),tt.push(`Steelfingers Wheel C-Stand 3er Set (${B.role} handheld)`),tt.push(`Lite-Tite Swivel Aluminium Umbrella Adapter (${B.role} handheld)`),G.push(`Spigot with male 3/8" and 1/4" (${B.role} handheld)`)}),I.forEach(B=>{tt.push(`Matthews Monitor Stand II (249562) (${B.role} 15-21")`),tt.push(`Avenger C590 Conka Bonka Stativ-Verlngerungen Set (${B.role} 15-21")`),tt.push(`Impact Baby to Junior Receiver Adapter (${B.role} 15-21")`),tt.push(`Matthews BIG F'ING Monitor Wheel Set (3 pieces) (${B.role} 15-21")`),G.push(`ULCS Bracket with 1/4" to 1/4" (${B.role} 15-21")`),tt.push(`Manfrotto 635 Quick-Action Super Clamp (${B.role} 15-21")`),G.push(`Spigot with male 3/8" and 1/4" (${B.role} 15-21")`),G.push(`Cine Quick Release (${B.role} 15-21")`),G.push(`D-Tap Splitter (${B.role} 15-21")`),G.push(`D-Tap Splitter (${B.role} 15-21")`)}),K("Easyrig")){const B=devices&&devices.accessories&&devices.accessories.cameraStabiliser&&devices.accessories.cameraStabiliser["Easyrig 5 Vario"];ya=`1x Easyrig 5 Vario <select id="gearListEasyrig">${["no further stabilisation",...B&&Array.isArray(B.options)?B.options:[]].map(ce=>`<option value="${Be(ce)}">${Be(fn(ce))}</option>`).join("")}</select>`}te&&tt.push(...Y);const _s=te?2:1;tt.push(...Array(_s).fill("Manfrotto 244N Friktion Arm")),te&&(tt.push("Avenger D200B Grip Head"),tt.push('Spigot with male 3/8" and 1/4"')),K("Cine Saddle")&&tt.push("Cinekinetic Cinesaddle"),K("Steadybag")&&tt.push("Steadybag"),K("Jib")&&(tt.push("Pro Sup EJIb-Arm"),tt.push("Jib counter weights"),so=!0),K("Slider")&&(oa=`1x Prosup Tango Roller <select id="gearListSliderBowl">${["","75er bowl","100er bowl","150er bowl","Mitchell Mount"].map(X=>`<option value="${Be(X)}"${X===e.sliderBowl?" selected":""}>${Be(fn(X))}</option>`).join("")}</select>`,tt.push("Avenger Combo Stand 10 A1010CS 64-100 cm black"),tt.push("Avenger Combo Stand 10 A1010CS 64-100 cm black"),tt.push("Avenger Combo Stand 20 A1020B 110-198 cm black"),tt.push("Avenger Combo Stand 20 A1020B 110-198 cm black"),tt.push("Apple Box Set / Bhnenkisten Set"),tt.push("Apple Box Set / Bhnenkisten Set"),tt.push("Paganini set"),tt.push("Sand bag (Slider)"),tt.push("Sand bag (Slider)"),tt.push("Cable mat"),tt.push("Cable mat"),tt.push("Cable mat")),K("Slider")&&K("Undersling mode")&&tt.push("Tango Beam"),K("Outdoor")&&G.push('Spigot with male 3/8" and 1/4" (Focus Umbrella)'),H(["Extreme heat","Extreme rain","Rain Machine"])&&(tt.push("Large Umbrella"),tt.push("Avenger A5036CS Roller 36 Low Base with Umbrella Mounting"));const ss=e.tripodTypes?e.tripodTypes.split(",").map(B=>B.trim()).filter(Boolean):[],Kn=e.tripodBowl,lo=e.tripodSpreader,ha=e.tripodHeadBrand,Wn={OConnor:{"100mm bowl":"O'Connor Ultimate 1040 Fluid-Head","150mm bowl":"O'Connor Ultimate 2560 Fluid-Head","Mitchell Mount":"O'Connor Ultimate 2560 Fluid-Head"},Sachtler:{"75mm bowl":"Sachtler aktiv8T S2068T","100mm bowl":"Sachtler aktiv18T S2088T","150mm bowl":"Sachtler Cine 30 3007"}},vn=Wn[ha]&&Wn[ha][Kn];if(vn){const B=`${vn} ${Kn}`;tt.push(B),S(B)}ss.forEach(B=>{const X=B==="Hi-Head"?"Hi-Head":`${B} Tripod`,$=Kn?`${Kn} ${X}`:X,ue=[];B==="Hi-Head"?ue.push($):lo?ue.push(`${$} + ${lo}`):ue.push($),B==="Short"&&ue.push("Sand bag (Short Tripod)"),B==="Hi-Head"&&ue.push("Sand bag (Hi-Head)"),ue.forEach(ce=>{tt.push(ce),S(ce)})}),so&&!tt.some(B=>/Long Tripod/.test(B))&&tt.push("Long Tripod");const Pi=tt.filter(B=>/\bstand\b/i.test(B)&&!/wheel/i.test(B)).length;Pi&&tt.push(...Array(Pi*3).fill("Tennis ball"));const ba=vo.filter(B=>/Magliner/i.test(B)).length;ba&&tt.push(...Array(ba*2).fill("Wooden wedge")),O(G,"accessories.rigging"),O(tt,"accessories.grip");const Bi=Yt(G);F("Rigging",Bi);const co=[];K("Studio")&&co.push("Camera Power Supply"),O(co,"accessories.power"),F("Power",Yt(co));const Gi=Yt(tt,{onItem:E});F("Grip",[oa,Gi,ya].filter(Boolean).join(""));const ci=na(vo);F("Carts and Transportation",ci||Yt(vo));const Ro=new Set(["D-Tap to LEMO 2-pin","HDMI Cable","BNC SDI Cable","Ultraslim BNC Cable 0.5 m"]),Dn=[...w].filter(B=>!Ro.has(B)),Sa=[],No=Array.isArray(le?.viewfinder)&&le.viewfinder.length>0;let Fo=e.viewfinderEyeLeatherColor||"red";const Mi=[{id:1,color:e.proGaffColor1||"red",width:e.proGaffWidth1||"24mm"},{id:2,color:e.proGaffColor2||"blue",width:e.proGaffWidth2||"24mm"}],_i=[{name:"Kimtech Wipes",count:1},{name:'Sprigs Red 1/4"',count:1,noScale:!0},{name:"Clapper Stick",count:2,klappen:!0}];let va=No?2:0,Sr=0,Ir=!1;const b=Array.isArray(e.shootingDays)?e.shootingDays:e.shootingDays?[e.shootingDays]:[],M=new Set([9,10,11,0,1,2,3,4]);b.forEach(B=>{const X=B.split(" to ");if(X.length===2){const $=new Date(X[0]),ue=new Date(X[1]);if(!isNaN($)&&!isNaN(ue)&&(Sr+=Math.floor((ue-$)/(1e3*60*60*24))+1,!Ir)){const ce=new Date($);for(ce.setHours(0,0,0,0);ce<=ue;){if(M.has(ce.getMonth())){Ir=!0;break}ce.setMonth(ce.getMonth()+1)}}}});let me=1;Sr>21?me=4:Sr>14?me=3:Sr>7&&(me=2);const ze=me%2===0?me:Math.max(1,me-1);for(const B of _i){let X=B.count;B.noScale||(B.klappen?X*=ze:X*=me);for(let $=0;$<X;$++)Sa.push(B.name)}va&&(va*=me);const Lt=H(["Outdoor","Extreme rain","Rain Machine"]);if(Lt&&c.camera&&Dn.push(`Rain Cover ${fn(c.camera)}`),(Lt||K("Extreme heat"))&&(Dn.includes("Umbrella for Focus Monitor")||Dn.push("Umbrella for Focus Monitor"),Dn.includes("Umbrella Magliner incl Mounting to Magliner")||Dn.push("Umbrella Magliner incl Mounting to Magliner")),Lt){const B=[];if(monitorSelect&&monitorSelect.value){const ue=devices.monitors[monitorSelect.value];ue&&ue.screenSizeInches&&B.push(ue.screenSizeInches)}const X=B.filter(ue=>ue>10).length,$=B.filter(ue=>ue<=10).length;for(let ue=0;ue<X+2;ue++)Sa.push("CapIt Large");for(let ue=0;ue<$+3;ue++)Sa.push("CapIt Medium");for(let ue=0;ue<3;ue++)Sa.push("CapIt Small");for(let ue=0;ue<10;ue++)Sa.push("Shower Cap");Sa.push("Magliner Rain Cover Transparent")}const sr=Ir&&K("Outdoor")||K("Extreme cold (snow)"),pr=K("Extreme cold (snow)");if(sr&&(Dn.push("Hair Dryer"),["Sony Venice 2","Sony Venice"].includes(c.camera)?Dn.push("Denz C0100072 Shut-Eye Heater fr Sony"):["Arri Alexa Mini","Arri Amira"].includes(c.camera)&&Dn.push("Arri K2.0003898 Heated Eyecup HE-7 for the MVF-1")),pr){const B=Math.max(Sr,1)*2;for(let X=0;X<B;X++)Dn.push("Hand Warmers");for(let X=0;X<B;X++)Dn.push("Feet Warmers")}const Xe=[["red","Red"],["blue","Blue"],["green","Green"],["yellow","Yellow"],["black","Black"],["pink","Pink"],["orange","Orange"],["violette","Violette"],["white","White"]],Yn=["6mm","12mm","19mm","24mm","48mm"],cn=me,lt=Mi.map(({id:B,color:X,width:$})=>{const ue=Xe.map(([Fe,gt])=>`<option value="${Fe}"${Fe===X?" selected":""}>${gt}</option>`).join(""),ce=Yn.map(Fe=>`<option value="${Fe}"${Fe===$?" selected":""}>${Fe}</option>`).join(""),ge=` data-gear-quantity="${Be(String(cn))}"`,He=' data-gear-label="Pro Gaff Tape"',_e=`${Be(String(cn))}x Pro Gaff Tape <select id="gearListProGaffColor${B}">${ue}</select> <select id="gearListProGaffWidth${B}">${ce}</select>`;return`<span class="gear-item" data-gear-name="Pro Gaff Tape"${ge}${He}${vt}><span class="gear-item-text">${_e}</span><span class="gear-item-note" hidden></span></span>`}).join("");let It="";if(va){const X=[["red","Red"],["blue","Blue"],["natural","Natural"],["green","Green"],["purple","Purple"],["orange","Orange"],["gray","Gray"],["yellow","Yellow"],["jaguar","Jaguar"],["killer bee","Killer Bee"],["green rabbit","Green Rabbit"],["black","Black"]].map(([ge,He])=>`<option value="${ge}"${ge===Fo?" selected":""}>${He}</option>`).join(""),$=` data-gear-quantity="${Be(String(va))}"`,ue=' data-gear-label="Bluestar eye leather made of microfiber oval, large"',ce=`${Be(String(va))}x Bluestar eye leather made of microfiber oval, large <select id="gearListEyeLeatherColor">${X}</select>`;It=`<span class="gear-item" data-gear-name="Bluestar eye leather made of microfiber oval, large"${$}${ue}${vt}><span class="gear-item-text">${ce}</span><span class="gear-item-note" hidden></span></span>`}F("Miscellaneous",Yt(Dn)),F("Consumables",[It,lt,Yt(Sa)].filter(Boolean).join(""));let bn=`<h2>${dr}</h2>`;$n&&(bn+=$n);const ls='<table class="gear-table">'+D.join("")+"</table>",Di={...e,cameraSelection:c.camera,monitorSelection:c.monitor,wirelessSelection:c.video,motorSelections:c.motors.slice(),controllerSelections:c.controllers.slice(),distanceSelection:c.distance},Tl=Fne(ls,Di);return bn+="<h3>Gear List</h3>"+Tl,bn}function Ew(e={}){const t=e.forPersistence===!0||e.isForPersistence===!0,r=rs(),n=r&&typeof r.__cineLastGearListHtml=="string"?r.__cineLastGearListHtml:"";if(!gearListOutput&&!projectRequirementsOutput)return n;const o=projectRequirementsOutput&&typeof projectRequirementsOutput.cloneNode!="function",a=gearListOutput&&typeof gearListOutput.cloneNode!="function";if(o||a)return n;let i="";if(projectRequirementsOutput){const f=projectRequirementsOutput.cloneNode(!0),d=f.querySelector("#editProjectBtn");d&&d.remove();const p=f.querySelector("h2");p&&p.remove(),i=f.innerHTML.trim()}let s="";if(gearListOutput){const f=gearListOutput.cloneNode(!0),d=typeof gearListOutput.querySelector=="function"?gearListOutput:null,p=f.querySelector("#gearListActions");p&&p.remove();const h=f.querySelector("#editProjectBtn");h&&h.remove(),["Director","Dop","Gaffer","Focus"].forEach(v=>{const A=f.querySelector(`#gearList${v}Monitor`);if(A&&A.options){const R=d?d.querySelector(`#gearList${v}Monitor`):null,I=R?R.value:A.value;Array.from(A.options).forEach(C=>{C.value===I?C.setAttribute("selected",""):C.removeAttribute("selected")})}}),["Director","Combo","Dop"].forEach(v=>{const A=f.querySelector(`#gearList${v}Monitor15`);if(A&&A.options){const R=d?d.querySelector(`#gearList${v}Monitor15`):null,I=R?R.value:A.value;Array.from(A.options).forEach(C=>{C.value===I?C.setAttribute("selected",""):C.removeAttribute("selected")})}});const m=f.querySelector("#gearListCage");if(m&&m.options){const v=d?d.querySelector("#gearListCage"):null,A=v?v.value:m.value;Array.from(m.options).forEach(R=>{R.value===A?R.setAttribute("selected",""):R.removeAttribute("selected")})}const g=f.querySelector("#gearListEasyrig");if(g&&g.options){const v=d?d.querySelector("#gearListEasyrig"):null,A=v?v.value:g.value;Array.from(g.options).forEach(R=>{R.value===A?R.setAttribute("selected",""):R.removeAttribute("selected")})}const S=f.querySelector("#gearListSliderBowl");if(S&&S.options){const v=d?d.querySelector("#gearListSliderBowl"):null,A=v?v.value:S.value;Array.from(S.options).forEach(R=>{R.value===A?R.setAttribute("selected",""):R.removeAttribute("selected")})}f.querySelectorAll("select[data-monitor-battery-key]").forEach(v=>{if(!v.id||!v.options)return;const A=d?d.querySelector(`#${v.id}`):null,R=A?A.value:v.value;Array.from(v.options).forEach(I=>{I.value===R?I.setAttribute("selected",""):I.removeAttribute("selected")})});const E=f.querySelector("#gearListEyeLeatherColor");if(E&&E.options){const v=d?d.querySelector("#gearListEyeLeatherColor"):null,A=v?v.value:E.value;Array.from(E.options).forEach(R=>{R.value===A?R.setAttribute("selected",""):R.removeAttribute("selected")})}[1,2].forEach(v=>{const A=f.querySelector(`#gearListProGaffColor${v}`);if(A&&A.options){const I=d?d.querySelector(`#gearListProGaffColor${v}`):null,C=I?I.value:A.value;Array.from(A.options).forEach(k=>{k.value===C?k.setAttribute("selected",""):k.removeAttribute("selected")})}const R=f.querySelector(`#gearListProGaffWidth${v}`);if(R&&R.options){const I=d?d.querySelector(`#gearListProGaffWidth${v}`):null,C=I?I.value:R.value;Array.from(R.options).forEach(k=>{k.value===C?k.setAttribute("selected",""):k.removeAttribute("selected")})}}),f.querySelectorAll('input[type="checkbox"]').forEach(v=>{v.checked?v.setAttribute("checked",""):v.removeAttribute("checked")}),f.querySelectorAll("[data-gear-custom-input]").forEach(v=>{v&&typeof v.getAttribute=="function"&&v.setAttribute("value",v.value)}),t||woe(f);const L=f.querySelector(".gear-table");s=L?"<h3>Gear List</h3>"+L.outerHTML:""}if(!i&&!s)return n;const l=uS(),u=`${l?`<h2>${l}</h2>`:""}${i}${s}`.trim();return u&&r&&(r.__cineLastGearListHtml=u),u||n}function qW(){const e={},t=a=>{if(!(!a||!a.id))if(a.multiple){const i=a.selectedOptions&&typeof a.selectedOptions.length=="number"?Array.from(a.selectedOptions):Array.from(a.options||[]).filter(s=>s.selected);e[a.id]=i.map(s=>s.value)}else e[a.id]=a.value},r=(function(){if(gearListOutput&&typeof gearListOutput.querySelectorAll=="function")return gearListOutput;if(typeof document<"u"&&document){const i=document.getElementById("gearListOutput");if(i&&typeof i.querySelectorAll=="function")return i}return null})();r&&r.querySelectorAll("select[id]").forEach(a=>{t(a)});const n=typeof filterDetailsStorage<"u"?filterDetailsStorage:null;n&&typeof n.querySelectorAll=="function"&&n.querySelectorAll("select[id]").forEach(a=>{!a||!a.id||Object.prototype.hasOwnProperty.call(e,a.id)||t(a)});const o=Coe();if(o&&Object.keys(o).length&&(e.__customItems=o),r){const a={};r.querySelectorAll(".gear-item[data-gear-name]").forEach(i=>{const s=Gg(i)||i.getAttribute("data-gear-name");if(!s)return;const l={};let c=!1;const u=(f,d,p=!1)=>{const h=i.getAttribute(f);h!=null&&h!==""&&(l[d]=p?h==="true":h,c=!0)};u("data-gear-quantity","quantity"),u("data-gear-label","name"),u("data-gear-attributes","attributes"),u("data-gear-note","note"),u("data-rental-excluded","rentalExcluded",!0),u("data-gear-provider","providedBy"),u("data-gear-provider-label","providerLabel"),u("data-gear-extra","extra",!0),u("data-gear-extra-start","extraStart"),u("data-gear-extra-end","extraEnd"),u("data-gear-camera-link","cameraLink"),u("data-gear-camera-link-label","cameraLinkLabel"),c&&(a[s]=l)}),Object.keys(a).length>0&&(e.__gearItemOverrides=a)}return e}function KW(e){if(!e||typeof e!="object")return{};const t=n=>{if(Array.isArray(n))return n.map(o=>t(o));if(n&&typeof n=="object"){const o={};return Object.entries(n).forEach(([a,i])=>{o[a]=t(i)}),o}return n==null?"":typeof n=="string"?n:String(n)},r={};return Object.entries(e).forEach(([n,o])=>{!n||typeof n!="string"||(r[n]=t(o))}),r}function woe(e){if(!e)return;const t=e.ownerDocument||(typeof document<"u"?document:null);if(!t||(typeof e.isConnected=="boolean"?e.isConnected:typeof t.contains=="function"&&t.contains(e)))return;e.querySelectorAll(".gear-custom-section").forEach(o=>{const a=o.querySelector(".gear-custom-items"),i=o.parentElement;if(!a||!i){o.remove();return}o.querySelectorAll(".gear-rental-toggle").forEach(u=>u.remove());const l=Array.from(a.querySelectorAll(".gear-custom-item-preview")).map(u=>({preview:u,value:(u.textContent||"").replace(/\s+/g," ").trim()})).filter(u=>u.value);let c=o.previousElementSibling;(!c||!c.classList.contains("gear-standard-items"))&&(c=t.createElement("div"),c.className="gear-standard-items",i.insertBefore(c,o)),l.length&&l.forEach(({value:u,preview:f})=>{if(c.childNodes.length){const h=c.lastChild;h&&h.nodeType===1&&h.tagName==="BR"||c.appendChild(t.createElement("br"))}const d=t.createElement("span");d.className="gear-item",d.textContent=u,d.setAttribute("data-gear-name",u),d.setAttribute("data-gear-custom-output","true");const p=f.closest(".gear-custom-item");if(p){const h=p.getAttribute("data-rental-note");h&&d.setAttribute("data-rental-note",h),p.getAttribute("data-rental-excluded")==="true"&&(d.setAttribute("data-rental-excluded","true"),d.classList.add("gear-item-rental-excluded"))}c.appendChild(d)}),o.remove()}),e.querySelectorAll(".gear-custom-add-btn").forEach(o=>o.remove()),e.querySelectorAll(".gear-rental-toggle").forEach(o=>o.remove()),e.querySelectorAll(".gear-item-edit-btn").forEach(o=>o.remove()),e.querySelectorAll(".gear-custom-item-actions").forEach(o=>o.remove())}function la(e){if(e==null)return null;if(typeof e!="object")return e;if(typeof KH=="function")try{return KH(e)}catch(r){console.warn("Failed to clone project info for storage",r)}if(Array.isArray(e))return e.map(r=>la(r));const t={};return Object.keys(e).forEach(r=>{t[r]=la(e[r])}),t}function Aw(e){return e==null?!1:typeof e=="string"?e.trim().length>0:typeof e=="number"?!Number.isNaN(e):typeof e=="boolean"?e:Array.isArray(e)?e.some(t=>Aw(t)):typeof e=="object"?Object.values(e).some(t=>Aw(t)):!1}function WW(e,t){const r=Aw(e);if(!Aw(t))return la(r?e:t);if(!r)return la(t);if(Array.isArray(e)&&Array.isArray(t))return la(t.length?t:e);if(typeof e=="object"&&typeof t=="object"){const o=la(e);return Object.keys(t).forEach(a=>{o[a]=WW(o[a],t[a])}),o}return la(t)}function YW(e){if(!e)return"";const t=typeof Node>"u"?3:Node.TEXT_NODE,r=typeof Node>"u"?1:Node.ELEMENT_NODE;return e.nodeType===t?e.textContent||"":e.nodeType===r?(e.tagName?e.tagName.toLowerCase():"")==="br"?`
`:Array.from(e.childNodes||[]).map(YW).join(""):""}function Loe(){if(!projectRequirementsOutput)return null;const e=projectRequirementsOutput&&typeof projectRequirementsOutput.querySelectorAll=="function"?Array.from(projectRequirementsOutput.querySelectorAll(".requirement-box")):[];if(!e.length)return null;const t={},r=texts[currentLang]?.projectFields||texts.en?.projectFields||{};return e.forEach(n=>{if(!n||typeof n.getAttribute!="function")return;const o=n.getAttribute("data-field");if(!o)return;const a=n.querySelector(".req-value");if(!a)return;const s=Array.from(a.childNodes||[]).map(YW).join("").replace(/\r\n?/g,`
`).split(`
`).map(c=>c.replace(/\s+/g," ").trim()).filter(c=>c);if(!s.length)return;const l=s.join(`
`);if(Object.prototype.hasOwnProperty.call(t,o)||(t[o]=l),o==="productionCompany"){let c=null;const u=Array.from(a.querySelectorAll(".req-sub-line"));if(u.length){const d=u.map(p=>{if(!p||typeof p.textContent!="string")return null;const h=p.textContent.replace(/\s+/g," ").trim();if(!h)return null;const g=(typeof p.getAttribute=="function"&&(p.getAttribute("data-fields")||p.getAttribute("data-field"))||"").split(/\s+/).map(S=>S.trim()).filter(S=>S);return{text:h,fields:g}}).filter(p=>p);d.length&&(c={lines:d})}const f=hre(l,r,c);f&&typeof f=="object"&&Object.entries(f).forEach(([d,p])=>{if(d==="productionCompany"){t.productionCompany=p;return}Object.prototype.hasOwnProperty.call(t,d)||(t[d]=p)})}}),Object.keys(t).length?t:null}function hg(e){return typeof e!="string"?"":e.trim().toLowerCase()}let Gc=null;function Mx(e){if(!Gc)return;if(!e){Gc=null;return}const t=hg(e);(!t||Gc.base===t)&&(Gc=null)}function Roe(e){if(!Gc)return null;const t=hg(e);return t&&Gc.base===t?Gc.resolved:null}function Toe(e,t){const r=hg(e),n=hg(t);if(!r||!n){Gc=null;return}Gc={base:r,resolved:t,resolvedNormalized:n}}function QW(e){const t=typeof e=="string"?e.trim():"";if(console.log("DEBUG: resolveProjectStorageNameCollision ENTERED with:",t),!t)return{name:t,changed:!1};if(typeof loadProject!="function")return{name:t,changed:!1};let r;try{r=loadProject()}catch(d){console.warn("Unable to inspect existing projects while resolving name collision",d),r=null}if(!r||typeof r!="object")return{name:t,changed:!1};const n=new Set(Object.keys(r).map(d=>typeof d=="string"?d.trim().toLowerCase():"").filter(d=>d)),o=t.toLowerCase();if(!n.has(o))return{name:t,changed:!1};let a=t,i=1;const s=t.match(/^(.*)\s+\((\d+)\)$/);if(s){a=s[1];const d=parseInt(s[2],10);isNaN(d)||(i=d)}let l=i+1,c=`${a} (${l})`,u=c.trim().toLowerCase();console.log("DEBUG: resolveProjectStorageNameCollision starting loop for:",c);let f=0;for(;n.has(u);){if(f++,console.log("DEBUG: resolveProjectStorageNameCollision iteration:",f,"Candidate:",u),f>100){console.error("DEBUG: resolveProjectStorageNameCollision INFINITE LOOP DETECTED for:",a);break}l+=1,c=`${a} (${l})`,u=c.trim().toLowerCase()}return console.log("DEBUG: resolveProjectStorageNameCollision returning:",c),{name:c,changed:!0}}function XW(e){if(typeof loadProject!="function")return!1;const t=hg(e);if(!t)return!1;let r=null;try{r=loadProject()}catch(n){return console.warn("Unable to inspect project names while deferring collision resolution",n),!1}return!r||typeof r!="object"?!1:Object.keys(r).some(n=>hg(n)===t)}const E0=new Set;let _x=null;function fa(){_x&&clearTimeout(_x),_x=setTimeout(()=>{Ooe()},300)}let Dx=!1;function Ooe(){if(console.log("DEBUG: saveCurrentGearList ENTERED"),Dx){console.log("DEBUG: saveCurrentGearList EXIT: recursion detected");return}if(factoryResetInProgress){console.log("DEBUG: saveCurrentGearList EXIT: factoryResetInProgress");return}if(typeof restoringSession<"u"&&restoringSession){console.log("DEBUG: saveCurrentGearList EXIT: restoringSession");return}Dx=!0;try{console.log("DEBUG: saveCurrentGearList: collecting form data...");const e=Ew({forPersistence:!0}),t=typeof e=="string"?e.trim():"",r=!!t,n=projectForm?dS():{};n.sliderBowl=mg("getSliderBowlValue"),n.easyrig=mg("getEasyrigValue");const o=currentProjectInfo&&typeof currentProjectInfo=="object"?currentProjectInfo:null,a=!!(projectRequirementsOutput&&typeof projectRequirementsOutput.querySelector=="function"&&projectRequirementsOutput.querySelector(".requirement-box"));let i=_H(n);const s=iW(),l=qW(),c=KW(l),u=Object.keys(c).length>0;let f=typeof getSetupNameState=="function"?getSetupNameState():null;if(typeof getProjectAutoSaveOverrides=="function"){const Ie=getProjectAutoSaveOverrides();if(Ie&&typeof Ie=="object"&&Ie.setupNameState&&typeof Ie.setupNameState=="object"){const et=ee=>typeof ee=="string"?ee.trim():"",Ze=Ie.setupNameState,Ft=et(Ze.typedName),Ye=et(Ze.selectedName),ct=et(typeof Ze.storageKey=="string"?Ze.storageKey:Ye||Ft),Y=typeof Ze.renameInProgress=="boolean"?Ze.renameInProgress:!!(Ye&&Ft&&Ft!==Ye);f={typedName:Ft,selectedName:Ye,storageKey:ct,renameInProgress:Y,typedNameHasTrailingWhitespace:!!(Ft&&Ze&&typeof Ze.typedNameHasTrailingWhitespace=="boolean"&&Ze.typedNameHasTrailingWhitespace)}}}const d=Ie=>typeof Ie!="string"?"":Ie.trim(),p=setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:"",h=!!(p&&p.trim()&&/\s$/.test(p));let m=f?f.selectedName:d(setupSelect&&typeof setupSelect.value=="string"?setupSelect.value:""),g=f?f.typedName:d(setupNameInput&&typeof setupNameInput.value=="string"?setupNameInput.value:""),S=f?f.storageKey:m||g;const y=f?f.renameInProgress:!!(m&&g&&m!==g),E=f&&typeof f=="object"?!!(f.typedNameHasTrailingWhitespace&&f.typedName):h;let L=y&&m||S;if(console.log("DEBUG: saveCurrentGearList: effectiveStorageKey:",L),!!(E&&!y&&!m&&typeof L=="string"&&L&&XW(L))){Mx(L);return}if(!y&&!m&&typeof L=="string"&&L){const Ie=Roe(L);if(Ie&&Ie!==L)L=Ie;else if(!Ie){let et=!1;E0.has(L)&&(et=!0);const Ze=et?{changed:!1,name:L}:QW(L);Ze.changed&&Ze.name&&Ze.name!==L?(Toe(L,Ze.name),L=Ze.name):Ze.changed||Mx(L)}}else Mx();if(!i&&a){if(o&&Object.keys(o).length)i=o;else if(typeof loadProject=="function"){const Ie=typeof L=="string"?L:typeof S=="string"&&S?S:typeof m=="string"?m:"";if(typeof Ie=="string"){const et=loadProject(Ie);et&&et.projectInfo&&Object.keys(et.projectInfo).length&&(i=la(et.projectInfo))}}if(!i){const Ie=Loe();Ie&&(i=_H(Ie)||Ie)}}currentProjectInfo=i;const A=typeof createProjectInfoSnapshotForStorage=="function"?createProjectInfoSnapshotForStorage(currentProjectInfo,{projectNameOverride:y?m||S:void 0}):currentProjectInfo,R=la(A),I=R?stableStringify(R):"",C=R?la(R):null,k=getProjectScopedAutoGearRules(),_=k&&k.length?la(k):null,w=_?la(_):null;let x=null,G=null;if(typeof getDiagramManualPositions=="function"){const Ie=getDiagramManualPositions();Ie&&Object.keys(Ie).length&&(x=la(Ie),G=la(x))}if(typeof saveProject=="function"&&typeof L=="string"){typeof setActiveProjectCompressionHold=="function"&&setActiveProjectCompressionHold(L);const Ie={projectInfo:R,gearListAndProjectRequirementsGenerated:r};s&&(Ie.powerSelection=s),u&&(Ie.gearSelectors=c),x&&(Ie.diagramPositions=x),_&&_.length&&(Ie.autoGearRules=_),saveProject(L,Ie,{skipOverwriteBackup:!0}),E0.add(L)}const T=m||L;if(!T)return;const P=Ib(),N=P[T];if(!N&&!e&&!currentProjectInfo&&!(_&&_.length)&&!x)return;const q=N||{};let Z=!1;if(q.gearListAndProjectRequirementsGenerated!==r&&(q.gearListAndProjectRequirementsGenerated=r,Z=!0),q.gearList!==t&&(q.gearList=t,Z=!0),I){const Ie=q.projectInfo;(Ie?stableStringify(Ie):"")!==I&&(q.projectInfo=C,Z=!0)}else R===null?q.projectInfo!==null&&(q.projectInfo=null,Z=!0):Object.prototype.hasOwnProperty.call(q,"projectInfo")&&(delete q.projectInfo,Z=!0);if(G){const Ie=q.diagramPositions?stableStringify(q.diagramPositions):"",et=stableStringify(G);Ie!==et&&(q.diagramPositions=G,Z=!0)}else Object.prototype.hasOwnProperty.call(q,"diagramPositions")&&(delete q.diagramPositions,Z=!0);const U=q.autoGearRules,K=U&&U.length?stableStringify(U):"",H=_&&_.length?stableStringify(_):"";H?K!==H&&(q.autoGearRules=w,Z=!0):Object.prototype.hasOwnProperty.call(q,"autoGearRules")&&(delete q.autoGearRules,Z=!0);const te=q.gearSelectors,re=te?stableStringify(te):"",fe=u?stableStringify(c):"";fe?re!==fe&&(q.gearSelectors=c,Z=!0):Object.prototype.hasOwnProperty.call(q,"gearSelectors")&&(delete q.gearSelectors,Z=!0);const Oe=q.powerSelection?stableStringify(q.powerSelection):"",Te=s?stableStringify(s):"";Te?Oe!==Te&&(q.powerSelection=s,Z=!0):Object.prototype.hasOwnProperty.call(q,"powerSelection")&&(delete q.powerSelection,Z=!0);const Ne=m||L;return Ne&&(N?Z&&(P[Ne]=q,storeSetups(P)):(P[Ne]=q,storeSetups(P))),console.log("DEBUG: saveCurrentGearList EXIT: Success"),Z}finally{Dx=!1}}function Cw(){const e=()=>{const t=ensureAutoBackupBeforeDeletion("delete gear list");if(!t)return!1;const r=getCurrentProjectStorageKey();typeof deleteProject=="function"?deleteProject(r):typeof saveProject=="function"&&saveProject(r,{projectInfo:null,gearListAndProjectRequirementsGenerated:!1},{skipOverwriteBackup:!0});const n=Ib();if(n&&typeof n=="object"){const o=n[r];if(o&&typeof o=="object"){let a=!1;Object.prototype.hasOwnProperty.call(o,"gearList")&&(delete o.gearList,a=!0),["projectInfo","autoGearRules","diagramPositions","powerSelection","gearSelectors","gearListAndProjectRequirementsGenerated"].forEach(i=>{Object.prototype.hasOwnProperty.call(o,i)&&(delete o[i],a=!0)}),a&&storeSetups(n)}}if(gearListOutput&&(gearListOutput.innerHTML="",gearListOutput.classList.add("hidden"),mM()),projectRequirementsOutput&&(projectRequirementsOutput.innerHTML="",projectRequirementsOutput.classList.add("hidden")),typeof globalThis<"u"&&(globalThis.__cineLastGearListHtml=""),currentProjectInfo=null,projectForm&&rR({}),storeSession({setupName:setupNameInput?setupNameInput.value:"",setupSelect:setupSelect?setupSelect.value:"",camera:cameraSelect?cameraSelect.value:"",monitor:monitorSelect?monitorSelect.value:"",video:videoSelect?videoSelect.value:"",cage:cageSelect?cageSelect.value:"",motors:motorSelects.map(o=>o?o.value:""),controllers:controllerSelects.map(o=>o?o.value:""),distance:distanceSelect?distanceSelect.value:"",batteryPlate:normalizeBatteryPlateValue(batteryPlateSelect?batteryPlateSelect.value:"",batterySelect?batterySelect.value:""),battery:batterySelect?batterySelect.value:"",batteryHotswap:hotswapSelect?hotswapSelect.value:"",sliderBowl:mg("getSliderBowlValue"),easyrig:mg("getEasyrigValue"),projectInfo:null}),typeof autoSaveCurrentSetup=="function"&&(autoSaveCurrentSetup(),r)){const o=Ib(),a=o&&o[r];if(a&&typeof a=="object"){let i=!1;Object.prototype.hasOwnProperty.call(a,"gearList")&&(delete a.gearList,i=!0),["projectInfo","gearListAndProjectRequirementsGenerated","gearSelectors"].forEach(s=>{Object.prototype.hasOwnProperty.call(a,s)&&(delete a[s],i=!0)}),i&&storeSetups(o)}}if(currentProjectInfo=null,updateGearListButtonVisibility(),typeof document<"u"&&typeof document.dispatchEvent=="function"){const o={projectName:r,backupName:t,source:"deleteCurrentGearList"};try{document.dispatchEvent(new CustomEvent("gearlist:deleted",{detail:o}))}catch(a){if(typeof document.createEvent=="function"){const i=document.createEvent("CustomEvent");i.initCustomEvent("gearlist:deleted",!1,!1,o),document.dispatchEvent(i)}else console.warn("Unable to dispatch gearlist:deleted event",a)}}return!0};if(typeof window.cineShowConfirmDialog=="function")window.cineShowConfirmDialog({title:typeof texts<"u"&&texts[currentLang]&&texts[currentLang].deleteGearListTitle||"Delete Gear List",message:texts[currentLang].confirmDeleteGearList,confirmLabel:"Delete",danger:!0,onConfirm:()=>{setTimeout(()=>{window.cineShowConfirmDialog({title:typeof texts<"u"&&texts[currentLang]&&texts[currentLang].areYouSure||"Are you sure?",message:texts[currentLang].confirmDeleteGearListAgain,confirmLabel:"Confirm Delete",danger:!0,onConfirm:()=>e()})},150)}});else return!confirm(texts[currentLang].confirmDeleteGearList)||!confirm(texts[currentLang].confirmDeleteGearListAgain)?!1:e()}const JW="show-auto-gear-highlight",xoe="auto-gear-highlight-context",fP='ULCS Arm mit 3/8" und 1/4" double',koe="autoGearMonitorRiggingItem",Ioe="autoGearMonitorRiggingHighlight",Nx="",Poe="Highlight automatic gear",Boe="Toggle a temporary color overlay for gear added by automatic rules. Useful while debugging gear rule behavior.",Goe="On",Moe="Off",_oe="Rule: %s",Doe="Automatic rule",Sy=Object.freeze([{bg:"rgba(255, 210, 64, 0.35)",border:"rgba(255, 181, 0, 0.7)"},{bg:"rgba(88, 200, 255, 0.32)",border:"rgba(0, 146, 214, 0.65)"},{bg:"rgba(146, 232, 129, 0.32)",border:"rgba(70, 180, 80, 0.65)"},{bg:"rgba(255, 186, 222, 0.32)",border:"rgba(230, 112, 190, 0.65)"},{bg:"rgba(255, 214, 153, 0.32)",border:"rgba(230, 156, 64, 0.65)"},{bg:"rgba(201, 186, 255, 0.32)",border:"rgba(146, 118, 230, 0.65)"},{bg:"rgba(152, 219, 217, 0.32)",border:"rgba(72, 182, 178, 0.65)"}]);function Noe(e,t){if(e&&typeof e=="object"){const r=typeof e.id=="string"?e.id.trim():"";if(r)return`id:${r.toLowerCase()}`;const n=lM(e);if(n)return`label:${n.toLowerCase()}`}if(t&&typeof t=="object"){const r=typeof t.autoGearRuleId=="string"?t.autoGearRuleId.trim():"";if(r)return`id:${r.toLowerCase()}`;const n=typeof t.autoGearRuleLabel=="string"?t.autoGearRuleLabel.trim():"";if(n)return`label:${n.toLowerCase()}`}return""}function Foe(e,t){if(!Sy.length)return null;const r=Noe(e,t);if(!r)return{...Sy[0],index:0};let n=0;for(let i=0;i<r.length;i+=1)n=n*31+r.charCodeAt(i)&2147483647;const o=Math.abs(n)%Sy.length;return{...Sy[o]||Sy[0],index:o}}function sR(e,t){if(!e||!e.style)return;const r=e.dataset||{},n=Foe(t,r);if(!n){e.style.removeProperty("--auto-gear-rule-bg"),e.style.removeProperty("--auto-gear-rule-border"),e.style.removeProperty("--auto-gear-rule-text"),r&&Object.prototype.hasOwnProperty.call(r,"autoGearRuleColor")&&delete r.autoGearRuleColor;return}const{bg:o,border:a,text:i,index:s}=n;if(o?e.style.setProperty("--auto-gear-rule-bg",o):e.style.removeProperty("--auto-gear-rule-bg"),a?e.style.setProperty("--auto-gear-rule-border",a):e.style.removeProperty("--auto-gear-rule-border"),i?e.style.setProperty("--auto-gear-rule-text",i):e.style.removeProperty("--auto-gear-rule-text"),r)try{e.dataset.autoGearRuleColor=String(s)}catch(l){console.warn("Failed to annotate automatic gear color index",l)}}function joe(){const e=texts[currentLang]||texts.en||{},t=e.autoGearRuleBadgeNamed||texts.en?.autoGearRuleBadgeNamed||_oe,r=e.autoGearRuleBadgeUnnamed||texts.en?.autoGearRuleBadgeUnnamed||Doe;return{named:t,unnamed:r}}function Hoe(e,t){const{named:r,unnamed:n}=joe(),o=typeof e=="string"?e.trim():"";if(o)return r.replace("%s",o);const a=typeof t=="string"?t.trim():"";return a?r.replace("%s",a):n}function lR(e){if(!e||!e.classList||!e.classList.contains("auto-gear-item"))return;const t=kb(e);nR(e,t),sR(e);const r=t.map(a=>Hoe(a.label,a.id)).filter(Boolean),n=Array.from(e.querySelectorAll(".auto-gear-rule-badge"));if(!r.length){n.forEach(i=>i.remove()),e.dataset&&Object.prototype.hasOwnProperty.call(e.dataset,"autoGearRuleBadge")&&delete e.dataset.autoGearRuleBadge;const a=hw(t);a?e.title=a:e.removeAttribute("title");return}if(r.forEach((a,i)=>{let s=n[i];s||(s=document.createElement("span"),s.className="auto-gear-rule-badge",e.appendChild(s)),s.textContent=a}),n.length>r.length&&n.slice(r.length).forEach(a=>a.remove()),e.dataset)try{e.dataset.autoGearRuleBadge=JSON.stringify(r)}catch(a){console.warn("Failed to serialize automatic gear rule badge labels",a)}const o=hw(t);o?e.title=o:e.removeAttribute("title")}function ZW(e){const t=e||gearListOutput;if(!t||typeof t.querySelectorAll!="function")return;t.querySelectorAll(".auto-gear-item").forEach(n=>lR(n))}function Uoe(){const e=typeof getLocalizedText=="function"?getLocalizedText("autoGearHighlightToggle"):"";return typeof e=="string"&&e.trim()?e.trim():Poe}function zoe(){const e=typeof getLocalizedText=="function"?getLocalizedText("autoGearHighlightToggleHelp"):"";return typeof e=="string"&&e.trim()?e.trim():Boe}function e2(){return!!(gearListOutput&&gearListOutput.classList&&gearListOutput.classList.contains(JW))}function $oe(){return!gearListOutput||!gearListOutput.classList?!1:!gearListOutput.classList.contains("hidden")}function Voe(e){if(!e)return null;e.classList.add("auto-gear-highlight-toggle","gear-list-action-btn");const t="auto-gear-highlight-icon";let r=e.querySelector(`.${t}`);r?(r.classList.contains("btn-icon")||r.classList.add("btn-icon"),r.classList.contains("icon-glyph")||r.classList.add("icon-glyph"),r.classList.contains(t)||r.classList.add(t),r.setAttribute("aria-hidden","true"),r.setAttribute("data-icon-font","uicons"),r.textContent!==Nx&&(r.textContent=Nx)):(r=document.createElement("span"),r.className=`btn-icon icon-glyph ${t}`,r.setAttribute("aria-hidden","true"),r.setAttribute("data-icon-font","uicons"),r.textContent=Nx,e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r));let n=e.querySelector(".auto-gear-highlight-label");n||(n=document.createElement("span"),n.className="auto-gear-highlight-label",e.appendChild(n));let o=e.querySelector(".auto-gear-highlight-state");return o||(o=document.createElement("span"),o.className="auto-gear-highlight-state",typeof n.after=="function"?n.after(o):e.appendChild(o)),o&&(o.setAttribute("aria-live","polite"),o.setAttribute("aria-atomic","true")),Array.from(e.childNodes||[]).filter(i=>i&&i.nodeType===3&&i.textContent&&i.textContent.trim().length).forEach(i=>{e.removeChild(i)}),o&&typeof n<"u"&&n&&o.previousElementSibling!==n&&typeof n.after=="function"&&n.after(o),{label:n,state:o}}function qoe(e){const t=e?"autoGearHighlightToggleStateOn":"autoGearHighlightToggleStateOff",r=e?Goe:Moe,n=typeof getLocalizedText=="function"?getLocalizedText(t):"";return typeof n=="string"&&n.trim()?n.trim():r}function Koe(e){if(typeof document>"u")return;const t=!!e;[document.documentElement,document.body,document.getElementById("autoGearDraftImpact")].forEach(n=>{n&&n.classList&&n.classList.toggle(xoe,t)})}function Woe(e){const t=!!e;gearListOutput&&gearListOutput.classList&&gearListOutput.classList.toggle(JW,t),mM()}function mM(){const e=document.getElementById("autoGearHighlightToggle");if(!e)return;const t=Uoe(),r=zoe(),n=Voe(e),o=n&&n.label,a=n&&n.state;o?o.textContent=t:typeof e.textContent=="string"?e.textContent=t:e.innerHTML=Be(t),e.setAttribute("title",r),e.setAttribute("data-help",r),e.setAttribute("aria-label",r);const i=e2();Koe(i);const s=qoe(i);a&&(a.textContent=s,a.setAttribute("data-state",i?"on":"off")),e.setAttribute("data-state",i?"on":"off"),e.setAttribute("data-state-label",s),e.setAttribute("aria-pressed",i?"true":"false"),e.classList.toggle("is-active",i);const l=$oe();e.disabled=!l,l?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true"),ZW(gearListOutput)}function Yoe(){if(!gearListOutput)return{items:{},customItems:[]};const e={items:{},customItems:[]};try{gearListOutput.querySelectorAll(".gear-custom-item").forEach(n=>{const o=n.getAttribute("data-gear-custom-entry"),a=n.closest(".gear-custom-section"),i=a?a.getAttribute("data-gear-custom-category"):"";if(typeof Ts=="function"){const s=Ts(n);e.customItems.push({categoryKey:o,categoryLabel:i,data:s})}}),gearListOutput.querySelectorAll(".gear-item:not(.gear-custom-item)").forEach(n=>{if(typeof Ts=="function"&&typeof cP=="function"){const o=Ts(n),a=cP(n),i=a.name;if(!i)return;(o.quantity!==a.quantity||o.name!==a.name||o.attributes!==a.attributes||o.note||o.rentalExcluded||o.providedBy&&o.providedBy!==(typeof gw=="function"?gw(o.name):"")||o.cameraLink&&o.cameraLink!=="A"&&!rp(n))&&(e.items[i]=o)}})}catch(t){typeof console<"u"&&console.warn&&console.warn("Failed to collect current gear list modifications",t)}return e}function Qoe(e){if(!(!gearListOutput||!e))try{Array.isArray(e.customItems)&&e.customItems.forEach(t=>{typeof vw=="function"&&vw(t.categoryKey,t.categoryLabel,t.data,{skipPersist:!0,skipEditDialog:!0,skipFocus:!0})}),e.items&&Object.keys(e.items).length&&gearListOutput.querySelectorAll(".gear-item:not(.gear-custom-item)").forEach(r=>{const n=typeof Ts=="function"?Ts(r):null,o=n?n.name:null;if(o&&e.items[o]){const a=e.items[o];typeof yg=="function"&&yg(r,a,{skipPreview:!1})}})}catch(t){typeof console<"u"&&console.warn&&console.warn("Failed to apply gear list modifications",t)}}function Xoe(){if(!gearListOutput)return;let e=document.getElementById("gearListActions");e||(e=document.createElement("div"),e.id="gearListActions",gearListOutput.appendChild(e));const t=e.querySelector("#deleteGearListBtn");t&&(t.removeEventListener("click",Cw),t.remove());let r=document.getElementById("gearListAutosaveNote");r?e.contains(r)||e.appendChild(r):(r=document.createElement("p"),r.id="gearListAutosaveNote",r.className="gear-list-autosave-note",e.appendChild(r));const n=texts[currentLang]&&texts[currentLang].gearListAutosaveNote||"",o=typeof n=="string"?n.trim():"";o.length>0?(r.hidden=!1,r.removeAttribute("hidden"),r.textContent=o,r.setAttribute("title",o),r.setAttribute("data-help",o)):(r.textContent="",r.setAttribute("title",""),r.setAttribute("data-help",""),r.hidden=!0);const i=texts[currentLang]&&texts[currentLang].deleteGearListBtn||texts.en&&texts.en.deleteGearListBtn||"Delete Gear List",s=texts[currentLang]&&(texts[currentLang].deleteGearListBtnHelp||texts[currentLang].deleteGearListBtn)||texts.en&&(texts.en.deleteGearListBtnHelp||texts.en.deleteGearListBtn)||i,l=document.createElement("button");if(l.id="deleteGearListBtn",l.type="button",l.className="gear-list-action-btn danger",typeof bi=="function"&&typeof ICON_GLYPHS=="object")bi(l,i,ICON_GLYPHS.trash);else{const f=typeof iconMarkup=="function"&&typeof ICON_GLYPHS=="object"?iconMarkup(ICON_GLYPHS.trash,"btn-icon"):"";l.innerHTML=`${f}${Be(i)}`}l.setAttribute("title",s),l.setAttribute("data-help",s),l.setAttribute("aria-label",s),l.setAttribute("data-feature-search","true"),l.setAttribute("data-feature-search-keywords","delete remove clear gear list project"),l.addEventListener("click",Cw),!gearListOutput||gearListOutput.classList.contains("hidden")||gearListOutput.innerHTML.trim()===""?(l.hidden=!0,l.setAttribute("hidden","")):(l.hidden=!1,l.removeAttribute("hidden")),r&&r.parentElement===e?e.insertBefore(l,r):e.appendChild(l);const u=document.getElementById("autoGearHighlightToggle");u&&!u.dataset.gearListHighlightBound&&(u.addEventListener("click",()=>{const f=!e2();Woe(f),typeof saveCurrentSession=="function"&&saveCurrentSession({skipGearList:!0})}),u.dataset.gearListHighlightBound="true"),mM(),ZW(e.closest("#gearListOutput")||gearListOutput),gearListOutput._filterListenerBound||(gearListOutput.addEventListener("change",f=>{const d=f.target;d&&d.matches("select")&&adjustGearListSelectWidth(d);let p=!1;if(d.matches('.filter-values-container input[type="checkbox"]')){const h=d.closest(".filter-values-container"),m=h&&h.getAttribute("data-storage-values"),g=h&&h.querySelector("select");if(d.checked?d.setAttribute("checked",""):d.removeAttribute("checked"),m)syncGearListFilterValue(m,d.value,d.checked);else if(g&&g.options){const S=Array.from(g.options).find(y=>y.value===d.value);S&&(S.selected=d.checked),g.dispatchEvent(new Event("change"))}p=!0}else if(d.matches("select[data-storage-id]")){const h=d.getAttribute("data-storage-id");h&&syncGearListFilterSize(h,d.value),p=!0}else(d.id&&d.id.startsWith("filter-size-")||d.id&&d.id.startsWith("filter-values-")||d.matches("input, select, textarea")&&!d.closest("#gearListActions"))&&(p=!0);p&&(fa(),saveCurrentSession(),checkSetupChanged())}),gearListOutput._filterListenerBound=!0),gearListOutput._inputListenerBound||(gearListOutput.addEventListener("input",f=>{const d=f.target;d&&(d.closest("#gearListActions")||(d.closest(".gear-custom-item")&&OW(d.closest(".gear-custom-item")),d.matches("input, textarea")&&(fa(),saveCurrentSession(),checkSetupChanged())))}),gearListOutput._inputListenerBound=!0),gearListOutput._customClickListenerBound||(gearListOutput.addEventListener("click",f=>{const d=f.target&&f.target.closest("[data-gear-edit]");if(d){f.preventDefault();const g=d.closest(".gear-item, .gear-custom-item");g&&zW(g,{allowRentalToggle:!0});return}const p=f.target&&f.target.closest(".gear-rental-toggle");if(p){f.preventDefault();const g=p.closest(".gear-item, .gear-custom-item");if(!g)return;const S=p.getAttribute("aria-pressed")!=="true";pS(g,S),g.classList&&g.classList.contains("gear-custom-item")?iR():(typeof fa=="function"&&fa(),typeof saveCurrentSession=="function"&&saveCurrentSession(),typeof checkSetupChanged=="function"&&checkSetupChanged());return}const h=f.target&&f.target.closest("[data-gear-custom-add]");if(h){f.preventDefault(),Eoe(h);return}const m=f.target&&f.target.closest("[data-gear-custom-remove]");m&&(f.preventDefault(),Aoe(m))}),gearListOutput._customClickListenerBound=!0)}let A0=!1;if(typeof document<"u"&&typeof document.addEventListener=="function"&&!A0){const e=()=>{try{Cw()}catch(t){console.warn("Failed to handle gear list deletion request",t)}};document.addEventListener("gearlist:delete-requested",e),A0=!0}function Joe(){const e=typeof Yc=="function"?Yc("category_cages"):"";return(typeof e=="string"?e.trim():"")||"Camera Cage"}function C0(e){if(!e)return;const t=e.closest(".gear-item");if(!t)return;const r=e.options&&e.selectedIndex>=0?e.options[e.selectedIndex]:null,n=r&&typeof r.text=="string"?r.text.trim():r&&r.textContent?r.textContent.trim():"",o=Joe();t.setAttribute("data-gear-quantity","1"),t.setAttribute("data-gear-label",o),t.setAttribute("data-gear-name",o),n?t.setAttribute("data-gear-attributes",n):t.removeAttribute("data-gear-attributes")}function Zoe(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListCage");e&&(e.addEventListener("change",t=>{typeof restoringSession<"u"&&restoringSession||(cageSelect&&(cageSelect.value=t.target.value,cageSelect.dispatchEvent(new Event("change"))),C0(e),Ms(),fa())}),C0(e))}function eae(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListEasyrig");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Ms(),fa(),saveCurrentSession(),checkSetupChanged())})}function tae(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListSliderBowl");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Ms(),fa(),saveCurrentSession(),checkSetupChanged())})}function rae(){if(!gearListOutput)return;const e=gearListOutput.querySelector("#gearListEyeLeatherColor");e&&e.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Ms(),fa())})}function nae(){gearListOutput&&[1,2].forEach(e=>{const t=gearListOutput.querySelector(`#gearListProGaffColor${e}`),r=gearListOutput.querySelector(`#gearListProGaffWidth${e}`);[t,r].forEach(n=>{n&&n.addEventListener("change",()=>{typeof restoringSession<"u"&&restoringSession||(Ms(),fa())})})})}function w0(e){if(e==null||e==="")return"";if(typeof e=="number"&&Number.isFinite(e))return String(e);const t=parseFloat(String(e));return Number.isFinite(t)?String(t):""}function L0(e,t={}){if(!e)return;const r=e.closest(".gear-item");if(!r)return;const n=t.label||r.getAttribute("data-gear-label")||"";n&&r.setAttribute("data-gear-label",n);const o=[];t.size&&o.push(`${t.size}"`),t.name&&o.push(fn(t.name)),t.suffix&&o.push(t.suffix);const a=o.filter(Boolean).join(" - ");if(a?r.setAttribute("data-gear-attributes",a):r.removeAttribute("data-gear-attributes"),n){const i=a?`${n} (${a})`:n;r.setAttribute("data-gear-name",i)}}function oae(){if(!gearListOutput)return;const e="incl. Directors cage, shoulder strap, sunhood, rigging for teradeks",t="incl. sunhood, V-Mount, AC Adapter and Wooden Camera Ultra QR Monitor Mount (Baby Pin, C-Stand)";["Director","Dop","Gaffer","Focus"].forEach(r=>{const n=gearListOutput.querySelector(`#gearList${r}Monitor`);n&&n.addEventListener("change",()=>{if(typeof restoringSession<"u"&&restoringSession)return;const o=devices&&devices.monitors&&devices.monitors[n.value],a=gearListOutput.querySelector(`#monitorSize${r}`),i=w0(o?.screenSizeInches);a&&(a.textContent=`(${i}")`);const l=r==="Focus"?"Focus Monitor":`${r==="Dop"?"DoP":r} Handheld Monitor`;L0(n,{label:l,name:n.value||"",size:i,suffix:e}),n.dataset.autoGearManual="true",Ms(),fa(),saveCurrentSession(),checkSetupChanged()})}),["Director","Combo","Dop"].forEach(r=>{const n=gearListOutput.querySelector(`#gearList${r}Monitor15`);n&&n.addEventListener("change",()=>{if(typeof restoringSession<"u"&&restoringSession)return;const o=devices&&devices.directorMonitors&&devices.directorMonitors[n.value],a=gearListOutput.querySelector(`#monitorSize${r}15`),i=w0(o?.screenSizeInches);a&&(a.textContent=`(${i}")`),L0(n,{label:`${r==="Dop"?"DoP":r} Monitor`,name:n.value||"",size:i,suffix:t}),n.dataset.autoGearManual="true",Ms(),fa(),saveCurrentSession(),checkSetupChanged()})})}typeof document<"u"&&(document.addEventListener("gearlist:add-extra-gear",()=>{try{VW()}catch(e){console.warn("Failed to add extra gear item from request",e)}}),document.addEventListener("gear-provider-data-changed",()=>{o0(),S0()}),document.addEventListener("own-gear-data-changed",()=>{Bc=null,o0(),S0(),Soe()}),document.addEventListener("camera-selection-changed",()=>{v0(),g0()}),document.addEventListener("camera-colors-changed",()=>{DA=null,g0(),v0()}));typeof globalThis<"u"&&(globalThis.saveCurrentGearList=fa,globalThis.doesProjectNameExist=XW,globalThis.resolveProjectStorageNameCollision=QW,globalThis.collectProjectFormData=dS,globalThis.populateProjectForm=rR);console.log("app-setups.js: Execution complete");function Ib(){return{}}typeof globalThis<"u"&&(globalThis.getSetups=Ib);window.getSetups=Ib;window.normalizeBatteryPlateValue=normalizeBatteryPlateValue;function aae(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const lr=aae();function iae(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const Ia=iae(lr),sae=Ia&&typeof Ia.safeWarn=="function"?Ia.safeWarn.bind(Ia):(e,t)=>{if(lr&&lr.console&&typeof lr.console.warn=="function")try{typeof t>"u"?lr.console.warn(e):lr.console.warn(e,t)}catch{}};function tr(e,t){return typeof e=="function"?e:typeof t=="function"?t:()=>{}}function Nn(e,t){return typeof e>"u"?t:e}function Fx(e){return typeof e=="function"?e:null}function lae(e={}){const t=Nn(e.document,lr.document||null),r=Nn(e.window,typeof lr.addEventListener=="function"?lr:null),n=Nn(e.navigator,lr.navigator||null),o=tr(e.getTexts,()=>Nn(e.texts,lr.texts||{})),a=tr(e.getCurrentLang,()=>Nn(e.currentLang,lr.currentLang||"en")),i=tr(e.getDevices,()=>Nn(e.devices,lr.devices||{})),s=tr(e.getCameraSelect,()=>Nn(e.cameraSelect,lr.cameraSelect||null)),l=tr(e.getMonitorSelect,()=>Nn(e.monitorSelect,lr.monitorSelect||null)),c=tr(e.getVideoSelect,()=>Nn(e.videoSelect,lr.videoSelect||null)),u=tr(e.getDistanceSelect,()=>Nn(e.distanceSelect,lr.distanceSelect||null)),f=tr(e.getBatterySelect,()=>Nn(e.batterySelect,lr.batterySelect||null)),d=tr(e.getMotorSelects,()=>Nn(e.motorSelects,lr.motorSelects||[])),p=tr(e.getControllerSelects,()=>Nn(e.controllerSelects,lr.controllerSelects||[])),h=tr(e.getSetupDiagramContainer,()=>Nn(e.setupDiagramContainer,t?t.getElementById("diagramArea"):null)),m=tr(e.getDiagramLegend,()=>Nn(e.diagramLegend,t?t.getElementById("diagramLegend"):null)),g=tr(e.getDiagramHint,()=>Nn(e.diagramHint,t?t.getElementById("diagramHint"):null));tr(e.getDownloadDiagramBtn,()=>Nn(e.downloadDiagramBtn,t?t.getElementById("downloadDiagram"):null));const S=tr(e.getZoomInBtn,()=>Nn(e.zoomInBtn,t?t.getElementById("zoomIn"):null)),y=tr(e.getZoomOutBtn,()=>Nn(e.zoomOutBtn,t?t.getElementById("zoomOut"):null)),E=tr(e.getResetViewBtn,()=>Nn(e.resetViewBtn,t?t.getElementById("resetView"):null));tr(e.getGridSnapToggleBtn,()=>Nn(e.gridSnapToggleBtn,t?t.getElementById("gridSnapToggle"):null));const L=tr(e.getDiagramDetailDialog,()=>Nn(e.diagramDetailDialog,t?t.getElementById("diagramDetailDialog"):null)),v=tr(e.getDiagramDetailContent,()=>Nn(e.diagramDetailContent,t?t.getElementById("diagramDetailDialogContent"):null)),A=tr(e.getCurrentGridSnap,()=>!1),R=Fx(e.scheduleProjectAutoSave),I=Fx(e.saveCurrentSession),C=Fx(e.checkSetupChanged),k=tr(e.motorPriority,()=>0),_=tr(e.controllerPriority,()=>0),w=tr(e.isArri,()=>!1),x=tr(e.isArriOrCmotion,()=>!1),G=tr(e.fizNeedsPower,()=>!1),T=tr(e.fizPowerPort,()=>""),P=tr(e.controllerDistancePort,()=>""),N=tr(e.controllerCamPort,()=>""),q=tr(e.cameraFizPort,()=>""),Z=tr(e.motorFizPort,()=>""),U=tr(e.getSelectedPlate,()=>""),K=tr(e.isSelectedPlateNative,()=>!1),H=tr(e.firstPowerInputType,()=>""),te=tr(e.formatConnLabel,(V,ie)=>[V,ie].filter(Boolean).join("  ")),re=tr(e.connectionLabel,(V,ie)=>te(V,ie)),fe=tr(e.fizPort,()=>""),Oe=tr(e.iconGlyph,(V,ie)=>typeof lr.iconGlyph=="function"?lr.iconGlyph(V,ie):null),Te=Nn(e.ICON_FONT_KEYS,lr.ICON_FONT_KEYS||{});tr(e.applyIconGlyph,(V,ie)=>typeof lr.applyIconGlyph=="function"?lr.applyIconGlyph(V,ie):null);const Ne=tr(e.resolveIconGlyph,V=>typeof lr.resolveIconGlyph=="function"?lr.resolveIconGlyph(V):V),Ie=tr(e.positionSvgMarkup,(V,ie,je,ot)=>typeof lr.positionSvgMarkup=="function"?lr.positionSvgMarkup(V,ie,je,ot):null),et=tr(e.ensureSvgHasAriaHidden,V=>typeof lr.ensureSvgHasAriaHidden=="function"?lr.ensureSvgHasAriaHidden(V):V),Ze=tr(e.formatSvgCoordinate,V=>typeof lr.formatSvgCoordinate=="function"?lr.formatSvgCoordinate(V):Number.isFinite(V)?String(V):"0"),Ft=tr(e.getSafeGenerateConnectorSummary,()=>Ia&&typeof Ia.safeGenerateConnectorSummary=="function"?Ia.safeGenerateConnectorSummary.bind(Ia):lr&&typeof lr.safeGenerateConnectorSummary=="function"?lr.safeGenerateConnectorSummary:null),Ye=V=>V?Array.isArray(V)?V:typeof V.length=="number"?Array.from(V):[]:[];let ct={},Y={},ee=null,Ae={},ve=null,se=null,de=null,be=!1,ye="Diagram details",$e="Back";const xe=()=>h(),St=()=>m(),Tt=()=>g(),xt=()=>S(),ut=()=>y(),Er=()=>E(),zt=()=>{try{return o()||{}}catch{return{}}},dr=()=>{try{return a()||"en"}catch{return"en"}},Jt=()=>{try{return i()||{}}catch{return{}}},rr=()=>s(),Jn=()=>l(),nr=()=>c(),$n=()=>u(),De=()=>f(),vt=()=>Ye(d()),Yt=()=>Ye(p()),j=V=>V==null?"":String(V).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),O=V=>{if(typeof V!="string")return"";const ie=V.trim();return ie&&ie.replace(/[^a-zA-Z0-9_-]+/g,"-").replace(/^-+|-+$/g,"")||""},D=V=>{const ie=O(V);return ie?`diagramPopupTitle-${ie}`:"diagramPopupTitle"},F=(V,ie,je)=>{if(!V||!ie||!je)return null;const ot=String(ie).split(".").filter(Boolean);let yt=V;for(let Pe=0;Pe<ot.length;Pe+=1){const Bt=ot[Pe];if(!yt||typeof yt!="object"){yt=null;break}yt=yt[Bt]}if(!yt||typeof yt!="object")return null;try{return yt[je]||null}catch{return null}},z=V=>V?V==="cameras"?"diagram-popup--camera":V==="batteries"?"diagram-popup--battery":V==="monitors"?"diagram-popup--monitor":V==="video"?"diagram-popup--video":V==="fiz.motors"?"diagram-popup--motor":V==="fiz.controllers"?"diagram-popup--controller":V==="fiz.distance"?"diagram-popup--distance":"":"",J=()=>!!(se&&(se.open||se.hasAttribute("open"))),Q=()=>{const V=xe();if(!V||typeof V.getBoundingClientRect!="function")return!1;const ie=V.getBoundingClientRect(),je=r?r.innerWidth:t?.documentElement?.clientWidth||0,ot=r?r.innerHeight:t?.documentElement?.clientHeight||0;return!je||!ot?!1:ie.bottom>0&&ie.right>0&&ie.top<ot&&ie.left<je};function le(){const V=L(),ie=v(),je=V!==se;if(se=V||null,de=ie||null,se&&(je||!be)){const ot=yt=>{if(!yt)return;const Pe=yt.target===se,Bt=se.querySelector(".modal-surface");if(Pe&&(!Bt||!Bt.contains(yt.target))){Ee();return}!Pe&&Bt&&!Bt.contains(yt.target)&&Ee()};se.addEventListener("click",ot),se.addEventListener("cancel",yt=>{yt.preventDefault(),Ee()}),se.addEventListener("close",()=>{de&&(de.innerHTML=""),se.removeAttribute("open"),se.removeAttribute("aria-labelledby"),se.setAttribute("aria-label",ye),se.classList.remove("diagram-detail-dialog--camera")}),se.setAttribute("aria-label",ye),be=!0}}function Ee(){if(le(),!se)return;typeof se.close=="function"&&se.open?se.close():(se.removeAttribute("open"),de&&(de.innerHTML=""),se.removeAttribute("aria-labelledby"),se.setAttribute("aria-label",ye),se.classList.remove("diagram-detail-dialog--camera"));const V=se.querySelector(".modal-surface");V&&(V.style.position="",V.style.margin="",V.style.left="",V.style.top="",V.style.visibility="")}function pe(V,ie=null){if(le(),!se||!de||!V)return;const je=typeof V.content=="string"?V.content.trim():V.content;if(!je){Ee();return}if(!Q()){Ee();return}const ot=se.ownerDocument||t;if(!ot)return;const yt=se.querySelector(".modal-surface");yt&&(ie&&typeof ie.x=="number"&&typeof ie.y=="number"?(yt.style.visibility="hidden",yt.style.position="absolute",yt.style.margin="0",yt.style.left="0",yt.style.top="0"):(yt.style.position="",yt.style.margin="",yt.style.left="",yt.style.top="",yt.style.visibility="")),de.innerHTML="";const Pe=ot.createElement("div");Pe.className=V.className?`diagram-popup ${V.className}`:"diagram-popup",Pe.innerHTML=je,de.appendChild(Pe);const Bt=Pe.querySelector("[data-diagram-popup-close]");if(Bt&&Bt.addEventListener("click",$t=>{$t&&($t.preventDefault(),$t.stopPropagation()),Ee()}),Pe.hasAttribute("tabindex")||(Pe.tabIndex=-1),typeof Pe.addEventListener=="function"&&Pe.addEventListener("keydown",$t=>{if(!$t)return;const to=$t.key||$t.code;(to==="Escape"||to==="Esc")&&($t.preventDefault(),Ee())}),typeof Pe.focus=="function")try{Pe.focus({preventScroll:!0})}catch{Pe.focus()}const Hr=!!(V.className&&V.className.includes("diagram-popup--camera"));se.classList.toggle("diagram-detail-dialog--camera",Hr);const un=V.label||ye;if(V.headingId?(se.setAttribute("aria-labelledby",V.headingId),se.removeAttribute("aria-label")):(se.removeAttribute("aria-labelledby"),se.setAttribute("aria-label",un)),typeof se.showModal=="function"?se.open||se.showModal():se.setAttribute("open",""),yt&&ie&&typeof ie.x=="number"&&typeof ie.y=="number"){const $t=r?r.innerWidth:t.documentElement.clientWidth||0,to=r?r.innerHeight:t.documentElement.clientHeight||0,Sn=yt.getBoundingClientRect(),uo=5,Oo=20;let fi=ie.x+uo,ja=ie.y+uo;fi+Sn.width>$t-Oo&&(fi=ie.x-Sn.width-uo),fi<Oo&&(fi=Oo),fi+Sn.width>$t-Oo&&(fi=$t-Sn.width-Oo),ja+Sn.height>to-Oo&&(ja=ie.y-Sn.height-uo),ja<Oo&&(ja=Oo),ja+Sn.height>to-Oo&&(ja=to-Sn.height-Oo),yt.style.left=`${Math.round(fi)}px`,yt.style.top=`${Math.round(ja)}px`,yt.style.visibility=""}}const ne=`
    .node-box{fill:var(--diagram-node-fill, #f0f0f0);stroke:none;}
    .node-box.first-fiz{stroke:none;}
    .first-fiz-highlight{stroke:url(#firstFizGrad);stroke-width:1px;fill:none;}
    .node-icon{font-size:var(--font-size-diagram-icon, 24px);font-family:'UiconsThinStraightV2',system-ui,sans-serif;font-style:normal;}
    .node-icon[data-icon-font='essential']{font-family:'EssentialIconsV2',system-ui,sans-serif;}
    .conn{stroke:none;}
    .conn.red{fill:var(--diagram-power-stroke, #d33);}
    .conn.blue{fill:var(--diagram-video-stroke, #369);}
    .conn.green{fill:var(--diagram-fiz-stroke, #090);}
    text{font-family:system-ui,sans-serif;fill:var(--diagram-text-fill, #000);}
    .edge-label{font-size:var(--font-size-diagram-label, 11px);fill:var(--diagram-text-fill, #000);}
    line{stroke:var(--diagram-stroke, #333);stroke-width:2px;}
    path.edge-path{stroke:var(--diagram-stroke, #333);stroke-width:2px;fill:none;}
    path.power{stroke:var(--diagram-power-stroke, #d33);}
    path.video{stroke:var(--diagram-video-stroke, #369);}
    path.fiz{stroke:var(--diagram-fiz-stroke, #090);}
    .diagram-placeholder{font-style:italic;color:#666;margin:0;}
    `;function Se(){return ne}const Le=(V,ie)=>{try{return Oe(V,ie)}catch{}return null},ke=Le(""),We=Le(""),nt=Le(""),it=Le(""),Et=Le(""),yr=Le(""),hr=Le("",Te.UICONS),Vr=Le(""),Rr=Le(""),Qe=Le("",Te.UICONS),Vn=Le(""),qn=Le(""),Lo=Le(""),sn=Le(""),hn=Le(""),ln=Le(""),Zo=Object.freeze({powerOut:Vn,powerIn:qn,fiz:hr,video:Et,timecode:Lo,audioIn:sn,audioOut:hn,audioIo:ln,torque:hr,controller:Vr,powerSpec:Vn,powerSource:qn}),kn={battery:ke,camera:We,monitor:nt,viewfinder:it,video:yr,motors:hr,controllers:Vr,handle:Vr,distance:Rr,lenses:Qe},ea={category_batteries:ke,category_batteryHotswaps:ke,category_cameras:We,category_lenses:Qe,category_viewfinders:it,category_monitors:nt,category_video:yr,category_fiz_motors:hr,category_fiz_controllers:Vr,category_fiz_distance:Rr},Fr=xe();if(!Fr)return;const yo=zt(),br=dr(),_t=Jt(),kt=rr(),Mr=Jn(),In=nr(),Do=$n(),ho=De(),is=vt(),nu=Yt(),ou=yo[br]?.diagramDetailDefaultHeading||yo.en?.diagramDetailDefaultHeading||"Diagram details",si=yo[br]?.diagramDetailBackLabel||yo.en?.diagramDetailBackLabel||"Back";ye=ou,$e=si,le(),(n&&Number.isFinite(n.maxTouchPoints)?n.maxTouchPoints:0)>0;const bo=kt?kt.value:"",Mn=_t.cameras?_t.cameras[bo]:void 0,xi=Mr?Mr.value:"",Da=_t.monitors?_t.monitors[xi]:void 0,li=In?In.value:"",ta=_t.video?_t.video[li]:void 0,So=ho?ho.value:"",ra=Do?Do.value:"";let _n=is.map(V=>V?V.value:"").filter(V=>V&&V!=="None");_n.sort((V,ie)=>k(V)-k(ie));const ki=_n.findIndex(V=>_t.fiz?.motors?.[V]?.internalController),Ii=ki!==-1;if(Ii&&ki>0){const[V]=_n.splice(ki,1);_n.unshift(V)}let Na=nu.map(V=>V?V.value:"").filter(V=>V&&V!=="None");Na.sort((V,ie)=>_(V)-_(ie));const na=Na,vo=[];console.warn("[PowerDiagram Debug] Starting node generation..."),console.warn("[PowerDiagram Debug] cameraSelect:",kt,"Value:",kt?kt.value:"N/A"),console.warn("[PowerDiagram Debug] batterySelect:",ho,"Value:",ho?ho.value:"N/A"),console.warn("[PowerDiagram Debug] devices available:",Object.keys(_t||{}));const tt={},so={},oa=300,ya=10,_s=12,ss=8,Kn=10,lo=220;let ha=80;if(So&&So!=="None"){let V=So;const ie=_t.batteries?.[So]?.mount_type;Mn&&ie&&Mn.power?.batteryPlateSupport?.some(je=>je.type===ie&&je.mount==="native")&&(V+=` on native ${ie} plate via Pins`),tt.battery={x:ha,y:lo,label:V},vo.push("battery"),so.battery={category:"batteries",name:So},ha+=oa}bo&&bo!=="None"&&(tt.camera={x:ha,y:lo,label:bo},vo.push("camera"),so.camera={category:"cameras",name:bo},ha+=oa);const Wn=Na.map((V,ie)=>`controller${ie}`),vn=_n.map((V,ie)=>`motor${ie}`),Pi=new Map;Wn.forEach((V,ie)=>{Pi.set(V,na[ie]||Na[ie])});const ba=new Map;vn.forEach((V,ie)=>{ba.set(V,_n[ie])});const Bi=Na.some(V=>_(V)===0);let co=!Bi&&Ii||!Wn.length&&vn.length&&k(_n[0])===0;const Gi=(V,ie,je)=>{tt[V]={x:ha,y:lo,label:je},vo.push(V),so[V]={category:ie,name:je},ha+=oa};co&&vn.length?(Gi(vn[0],"fiz.motors",_n[0]),Wn.forEach((V,ie)=>{Gi(V,"fiz.controllers",na[ie])}),vn.slice(1).forEach((V,ie)=>{Gi(V,"fiz.motors",_n[ie+1])})):(Wn.forEach((V,ie)=>{Gi(V,"fiz.controllers",na[ie])}),vn.forEach((V,ie)=>{Gi(V,"fiz.motors",_n[ie])})),xi&&xi!=="None"&&(tt.monitor={x:tt.camera?tt.camera.x:60,y:lo-oa,label:xi},vo.push("monitor"),so.monitor={category:"monitors",name:xi}),li&&li!=="None"&&(tt.video={x:tt.camera?tt.camera.x:60,y:lo+oa,label:li},vo.push("video"),so.video={category:"video",name:li});let ci=!1,Ro=!1;if(ra&&ra!=="None"){const V=na.length?Wn[0]:vn[0];if(V){const ie=[...na,..._n].some(ot=>w(ot)),je=na.some(ot=>/RIA-1/i.test(ot)||/UMC-4/i.test(ot));if(Ro=je&&ie,ci=ie&&!je&&na.length,ci&&vn.length){const ot=vn[0];tt.distance={x:(tt[V].x+tt[ot].x)/2,y:lo-oa,label:ra}}else tt.distance={x:tt[V].x,y:lo-oa,label:ra};vo.push("distance"),so.distance={category:"fiz.distance",name:ra}}}Object.keys(ct).forEach(V=>{tt[V]||delete ct[V]}),Object.entries(tt).forEach(([V,ie])=>{ct[V]&&(ie.x=ct[V].x,ie.y=ct[V].y)});const Dn=120,Sa=120,No={},Fo={},Mi="var(--font-size-diagram-label, 11px)",_i="var(--font-size-diagram-text, 13px)",va=13,Sr=8,Ir=24;function b(V,ie=16){if(!V)return[];const je=String(V);if(je.length<=ie)return[je];const ot=je.split(/\s+/),yt=[];let Pe="";return ot.forEach(Bt=>{const Hr=Pe?`${Pe} ${Bt}`:Bt;Hr.length>ie&&Pe?(yt.push(Pe),Pe=Bt):Pe=Hr}),Pe&&yt.push(Pe),yt}vo.forEach(V=>{const ie=tt[V].label||V,je=b(ie),ot=kn[V]||V.startsWith("controller")||V.startsWith("motor");No[V]=Math.max(Dn,je.length*va+(ot?30:20));const yt=je.reduce((Pe,Bt)=>Math.max(Pe,Bt.length),0);Fo[V]=Math.max(Sa,yt*9+20)});const M=Math.max(...Object.values(Fo),Sa),me=Math.max(...Object.values(No),Dn),ze=V=>No[V]||me;let Lt,ft=[];const sr=[],pr={},Xe=(V,ie)=>{pr[`${V}|${ie}`]=!0},Yn=(V,ie)=>pr[`${V}|${ie}`],cn=(V,ie)=>{const je=tt[V];if(!je)return{x:0,y:0};const ot=ze(V);return ie==="top"?{x:je.x,y:je.y-ot/2}:ie==="bottom"?{x:je.x,y:je.y+ot/2}:ie==="bottom-left"?{x:je.x-M/2+M/3,y:je.y+ot/2}:ie==="bottom-right"?{x:je.x+M/2-M/3,y:je.y+ot/2}:ie==="left"?{x:je.x-M/2,y:je.y}:ie==="right"?{x:je.x+M/2,y:je.y}:{x:je.x,y:je.y}},lt=V=>{const ie=ze(V),je=[{side:"left",color:"red"},{side:"right",color:"red"},{side:"top",color:"blue"},{side:"bottom",color:"green"}];return ie>me&&(je.push({side:"bottom-left",color:"green"}),je.push({side:"bottom-right",color:"green"})),je},It=(V,ie,je)=>{const ot=lt(V),yt=lt(ie);let Pe=null,Bt=1/0;return ot.forEach(Hr=>{if(je[`${V}|${Hr.side}`])return;const un=cn(V,Hr.side);yt.forEach($t=>{if(Hr.color!==$t.color||je[`${ie}|${$t.side}`])return;const to=cn(ie,$t.side),Sn=Math.hypot(un.x-to.x,un.y-to.y);Sn<Bt&&(Bt=Sn,Pe={fromSide:Hr.side,toSide:$t.side})})}),Pe},bn=(V,ie)=>{if(!V.fromSide||!V.toSide){const je=It(V.from,V.to,pr);je&&(V.fromSide||(V.fromSide=je.fromSide),V.toSide||(V.toSide=je.toSide))}else if(Yn(V.from,V.fromSide)||Yn(V.to,V.toSide))return;Xe(V.from,V.fromSide),Xe(V.to,V.toSide),sr.push({...V,type:ie})},ls=_t.batteries?.[So]?.mount_type;if(Mn&&So&&So!=="None"){const V=U(),ie=V&&K(bo),ot=H(Mn)||V,yt=ie?"":te(ls,ot);bn({from:"battery",to:"camera",label:yt,fromSide:"right",toSide:"left"},"power")}if(Da&&H(Da)){const V=H(Da);So&&So!=="None"&&bn({from:"battery",to:"monitor",label:te(ls,V),fromSide:"top",toSide:"left"},"power")}if(ta&&H(ta)){const V=H(ta);So&&So!=="None"&&bn({from:"battery",to:"video",label:te(ls,V),fromSide:"bottom",toSide:"left"},"power")}if(Mn&&Mn.videoOutputs?.length){const V=Mn.videoOutputs[0].type,ie=Da&&(Da.video?.inputs?.[0]||Da.videoInputs?.[0]),je=ta&&(ta.videoInputs?.[0]||(ta.video?ta.video.inputs[0]:null));if(Da&&ie){const ot=ie.portType||ie.type||ie;bn({from:"camera",to:"monitor",label:re(V,ot),fromSide:"top",toSide:"bottom",labelSpacing:ya},"video")}if(ta&&je){const ot=je.portType||je.type||je;bn({from:"camera",to:"video",label:re(V,ot),fromSide:"bottom",toSide:"top",labelSpacing:ya},"video")}}co=!Bi&&Ii||!Wn.length&&vn.length&&k(_n[0])===0;const Di=ra&&ra!=="None",Tl=Di&&!Ro;let B=!1,X=!1;if(co&&vn.length?(ft.push(vn[0]),X=!0):Wn.length?(ft.push(Wn[0]),B=!0):vn.length&&(ft.push(vn[0]),X=!0),Tl&&ft.push("distance"),Wn.length&&(ft=ft.concat(Wn.slice(B?1:0))),vn.length&&(ft=ft.concat(vn.slice(X?1:0))),tt.distance&&!ct.distance){const V=[],ie=ft.indexOf("distance");if(ie!==-1){const je=ie>0?ft[ie-1]:null,ot=ie<ft.length-1?ft[ie+1]:null;je&&tt[je]&&V.push(tt[je]),ot&&tt[ot]&&V.push(tt[ot])}V.length<2&&ft.filter(ot=>ot!=="distance").slice(0,2).forEach(ot=>{tt[ot]&&!V.includes(tt[ot])&&V.push(tt[ot])}),V.length>=2?tt.distance.x=(V[0].x+V[1].x)/2:V.length===1&&(tt.distance.x=V[0].x)}if(Mn&&ft.length){let V=ft[0];V==="distance"&&ft.length>1&&(Wn.length||Ii)&&(V=ft[1]);let ie=null;V.startsWith("controller")?ie=Pi.get(V):V.startsWith("motor")&&(ie=ba.get(V));const je=V==="distance"?"LBUS":N(ie),ot=q(bo,je,ie);bn({from:"camera",to:V,label:te(ot,je),noArrow:!0},"fiz")}else if(vn.length&&Mn){const V=q(bo,Z(_n[0]),_n[0]);bn({from:"camera",to:vn[0],label:te(V,Z(_n[0])),noArrow:!0},"fiz")}for(let V=0;V<ft.length-1;V++){const ie=ft[V],je=ft[V+1];let ot=null,yt=null;ie.startsWith("controller")?ot=Pi.get(ie):ie.startsWith("motor")&&(ot=ba.get(ie)),je.startsWith("controller")?yt=Pi.get(je):je.startsWith("motor")&&(yt=ba.get(je)),bn({from:ie,to:je,label:te(fe(ot),fe(yt)),noArrow:!0},"fiz")}if(Ro&&Wn.length&&Di){const V=na[0]||Na[0],ie=P(V),je=te(fe(V),ie);bn({from:Wn[0],to:"distance",label:je,noArrow:!0,toSide:"bottom-right"},"fiz")}const $=[];Wn.forEach((V,ie)=>{$.push({id:V,name:na[ie]||Na[ie]})}),vn.forEach((V,ie)=>{$.push({id:V,name:_n[ie]})});const ue=V=>/RIA-1/i.test(V)||/UMC-4/i.test(V)||/cforce.*rf/i.test(V);let ce=null;const ge=$.find(V=>ue(V.name));if(ge?ce=ge:ce=$.find(V=>G(V.name)),ce&&G(ce.name)){const{id:V,name:ie}=ce,je=So&&So!=="None"?"battery":null,ot=te("D-Tap",T(ie)),yt=w(bo)&&x(ie);je&&!yt&&bn({from:je,to:V,label:ot,fromSide:"bottom-left",toSide:"bottom",route:"down-right-up"},"power")}if(vo.length===0){Fr.innerHTML=`<p class="diagram-placeholder">${yo[br]?.setupDiagramPlaceholder||yo.en?.setupDiagramPlaceholder||""}</p>`;return}let He=Object.values(tt).map(V=>V.x),_e=Math.min(...He),Fe=Math.max(...He);const gt=Fe-_e,Ve=Math.max(500,gt+M);if(Object.keys(ct).length===0){const V=Ve/2-(_e+Fe)/2;Object.values(tt).forEach(ie=>{ie.x+=V}),He=Object.values(tt).map(ie=>ie.x),_e=Math.min(...He),Fe=Math.max(...He)}const Pt=Object.values(tt).map(V=>V.y),Zt=Math.min(...Pt),mr=Math.max(...Pt),gr=Math.max(40,M*.25),er=Math.max(40,me*.25),Qt=Math.max(120,me*.4),tn=_e-M/2-gr,Pr=Fe+M/2+gr,Ht=Zt-me/2-er,or=mr+me/2+Qt,At=Math.floor(Math.min(0,tn)),Fa=Math.floor(Ht);Lt=Math.max(Ve,Math.ceil(Pr-At));const jo=mr-Zt+me+er+Qt,jr=Math.max(Math.ceil(jo),Math.ceil(or-Fa));function ar(V,ie,je=0,ot={}){const yt=Math.max(0,ot.labelLineCount||0),Pe=yt>1?(yt-1)*va:0,Bt=cn(V,ot.fromSide),Hr=cn(ie,ot.toSide);let un,$t,to,Sn=0;if(ot.route==="down-right-up"){const uo=mr+me;un=`M ${Bt.x} ${Bt.y} V ${uo} H ${Hr.x} V ${Hr.y}`,$t=(Bt.x+Hr.x)/2,to=uo-Kn-je-Pe}else{un=`M ${Bt.x} ${Bt.y} L ${Hr.x} ${Hr.y}`;const uo=Hr.x-Bt.x,Oo=Hr.y-Bt.y;Sn=Math.atan2(Oo,uo)*180/Math.PI;const fi=(Bt.x+Hr.x)/2,ja=(Bt.y+Hr.y)/2,cf=Math.hypot(uo,Oo)||1,Ea=(Math.abs(uo)<Math.abs(Oo)?ss:_s)+je+Pe,aa=Oo/cf*Ea,Ol=-uo/cf*Ea;$t=fi+aa,to=ja+Ol}return{path:un,labelX:$t,labelY:to,angle:Sn}}const dt=18,Zn=`
        <defs>
          <style>${Se()}</style>
          <linearGradient id="firstFizGrad" x1="0" y1="0" x2="0" y2="1">
            <stop offset="0%" stop-color="#fff" stop-opacity="0.9"></stop>
            <stop offset="100%" stop-color="#fff" stop-opacity="0"></stop>
          </linearGradient>
        </defs>
      `;let Dt=`<svg viewBox="${At} ${Fa} ${Lt} ${jr}" role="group" aria-labelledby="diagramDesc">${Zn}`;Dt+='<g id="diagramRoot">',vo.forEach(V=>{const ie=tt[V];if(!ie)return;const je=ze(V),ot="diagram-node",yt="node-box";Dt+=`<g class="${ot}" data-node="${V}">`,Dt+=`<rect class="${yt}" x="${ie.x-M/2}" y="${ie.y-je/2}" width="${M}" height="${je}" rx="4" ry="4" />`,lt(V).forEach(Ea=>{const{x:aa,y:Ol}=cn(V,Ea.side);Dt+=`<circle class="conn ${Ea.color}" cx="${aa}" cy="${Ol}" r="4" />`});let Bt=kn[V];if(!Bt)if(V.startsWith("motor"))Bt=kn.motors;else if(V.startsWith("controller")){const Ea=(so[V]?.name||"").toLowerCase();/handle|grip/.test(Ea)?Bt=kn.handle:Bt=kn.controllers}else V==="distance"&&(Bt=kn.distance);const Hr=b(ie.label||V),un=Bt?Ne(Bt):null,$t=!!(un&&(un.markup||un.char)),to=$t&&Number.isFinite(un.size)?un.size:Ir,Sn=$t?to:0,uo=Hr.length,Oo=uo?uo*va:0,fi=$t&&uo?Sr:0,ja=Sn+fi+Oo,cf=ie.y-ja/2,uf=Ze(ie.x);if($t){const Ea=cf+Sn/2;if(un.markup&&Ie){const aa=Ie(et(un.markup),ie.x,Ea,to);if(aa&&aa.markup){const Ol=["node-icon-svg"];un.className&&Ol.push(un.className),Dt+=`<g class="${Ol.join(" ")}" transform="translate(${aa.x}, ${aa.y})">${aa.markup}</g>`}}else if(un.char){const aa=un.font?` data-icon-font="${un.font}"`:"";Dt+=`<text class="node-icon"${aa} x="${uf}" y="${Ze(Ea)}" text-anchor="middle" dominant-baseline="middle">${un.char}</text>`}}if(uo){const Ea=cf+Sn+fi,aa=Ze(Ea);Dt+=`<text x="${uf}" y="${aa}" text-anchor="middle" dominant-baseline="hanging" style="font-size: ${$t?Mi:_i};">`,Hr.forEach((jg,Ns)=>{const Fs=Ns===0?"":` dy="${va}"`;Dt+=`<tspan x="${uf}"${Fs}>${jg}</tspan>`}),Dt+="</text>"}Dt+="</g>"}),sr.forEach(V=>{const ie=V.label?b(V.label,dt):[],{path:je,labelX:ot,labelY:yt,angle:Pe}=ar(V.from,V.to,V.labelSpacing,{...V,labelLineCount:ie.length});if(Dt+=`<path class="edge-path ${V.type}" d="${je}" />`,ie.length){const Bt=Math.abs(Pe)>90?`rotate(${Pe+180} ${ot} ${yt})`:`rotate(${Pe} ${ot} ${yt})`,Hr=Ze(ot),un=Ze(yt);Dt+=`<text class="edge-label" x="${Hr}" y="${un}" transform="${Bt}" text-anchor="middle">`,ie.forEach(($t,to)=>{const Sn=to===0?"":` dy="${va}"`;Dt+=`<tspan x="${Hr}"${Sn}>${$t}</tspan>`}),Dt+="</text>"}}),Dt+="</g></svg>";let ae=t?t.getElementById("diagramPopup"):null;!ae&&t&&(ae=t.createElement("div"),ae.id="diagramPopup"),ae&&(ae.className="diagram-popup",ae.setAttribute("role","dialog"),ae.setAttribute("aria-modal","false"),ae.hasAttribute("tabindex")||(ae.tabIndex=-1)),Fr.innerHTML="",Fr.insertAdjacentHTML("beforeend",Dt),ae&&Fr.appendChild(ae);const at={},Nt=Ft();if(Object.entries(so).forEach(([V,ie])=>{const je=tt[V]?.label||ie?.name||V,ot=j(je),yt=z(ie?.category);let Pe="";if(typeof Nt=="function"){const Sn=F(_t,ie?.category,ie?.name);if(Sn)try{Pe=Nt(Sn)||""}catch{}}const Bt=j($e||"Back"),Hr=D(V),un=j(Hr),$t=Pe||`<p class="diagram-popup__fallback">${ot}</p>`,to=`
          <div class="diagram-popup__layout">
            <header class="diagram-popup__header">
              <button
                type="button"
                class="diagram-popup__back"
                data-diagram-popup-close
                aria-label="${Bt}"
              >
                <span class="btn-icon icon-glyph icon-text" aria-hidden="true" data-icon-font="text">&larr;</span>
                <span class="diagram-popup__back-label">${Bt}</span>
              </button>
              <h3 class="diagram-popup__title" id="${un}">${ot}</h3>
            </header>
            <div class="diagram-popup__body">
              ${$t}
            </div>
          </div>
        `;at[V]={className:yt,content:to,label:ot,headingId:Hr}}),Ae=at,!Fr.querySelector("svg"))return;if(Tt()){const V=Fr.getBoundingClientRect(),ie=Fr.parentElement?.getBoundingClientRect(),je=V?.width||Fr.clientWidth||0;ie&&je&&je>ie.width*.95?Fr.dataset.initialScale=String(Math.max(.5,ie.width/je*.95)):delete Fr.dataset.initialScale}Y=Object.fromEntries(Object.entries(tt)),Ds(),x_();function eo(V){if(!V||typeof V!="object")return{};const ie={};return Object.entries(V).forEach(([je,ot])=>{if(!ot||typeof ot!="object")return;const yt=Number(ot.x),Pe=Number(ot.y);!Number.isFinite(yt)||!Number.isFinite(Pe)||(ie[je]={x:yt,y:Pe})}),ie}function ui(){return eo(ct)}function To(V,ie={}){ct=eo(V),ie&&ie.render}function Ds(){const V=xe();if(!V)return;const ie=V.querySelector("svg");if(!ie)return;const je=zt(),ot=dr(),yt=je[ot]?.diagramHoverNotice||je.en?.diagramHoverNotice||"Double click for more information";ye=je[ot]?.diagramDetailDefaultHeading||je.en?.diagramDetailDefaultHeading||ye,$e=je[ot]?.diagramDetailBackLabel||je.en?.diagramDetailBackLabel||$e,le();const Pe=V.querySelector("#diagramPopup");let Bt=null,Hr=null;const un=Re=>!Re||typeof Re!="object"?null:typeof Re.closest=="function"?Re:"parentElement"in Re&&Re.parentElement?Re.parentElement:"parentNode"in Re&&Re.parentNode&&Re.parentNode!==Re?un(Re.parentNode):null,$t=()=>{Pe&&(Pe.style.display="none",Pe.setAttribute("hidden",""),Pe.innerHTML="",Pe.dataset.columns="1",Pe.style.removeProperty("--diagram-popup-dynamic-width"),Pe.className="diagram-popup",Pe.removeAttribute("aria-label"),Pe.removeAttribute("aria-labelledby"),Pe.onkeydown=null,Bt=null,Hr=null)};$t(),ee&&ee();const to=ie.querySelector("#diagramRoot")||ie,Sn=(n&&Number.isFinite(n.maxTouchPoints)?n.maxTouchPoints:0)>0,uo=Sn?1/0:3,Oo=Sn?.55:.6,fi=Sn?.4:.35,ja=parseFloat(V.dataset.initialScale||""),cf=Sn?.95:.85,uf=Number.isFinite(ja)&&ja>0?ja:cf,Ea=Math.max(fi,Math.min(Oo,uf)),aa=Re=>!Number.isFinite(Re)||Re<=0?Ea:Re>uo?uo:Re<Ea?Ea:Re,Ol=aa(uf);let jg={x:0,y:0};if(V.dataset.initialPan)try{const Re=JSON.parse(V.dataset.initialPan);Re&&Number.isFinite(Re.x)&&Number.isFinite(Re.y)&&(jg={x:Re.x,y:Re.y})}catch{}let Ns={...jg},Fs=Ol,IR=!1,PR={...Ns},Hg=null;const ff=Re=>Re.touches&&Re.touches[0]?{x:Re.touches[0].clientX,y:Re.touches[0].clientY}:Re.changedTouches&&Re.changedTouches[0]?{x:Re.changedTouches[0].clientX,y:Re.changedTouches[0].clientY}:{x:Re.clientX,y:Re.clientY},k_=()=>{const Re=typeof ie.getBoundingClientRect=="function"?ie.getBoundingClientRect():null,qe=ie.viewBox?.baseVal,Gt=qe&&Number.isFinite(qe.width)&&qe.width>0?qe.width:ie.width?.baseVal?.value||Re?.width||1,Mt=qe&&Number.isFinite(qe.height)&&qe.height>0?qe.height:ie.height?.baseVal?.value||Re?.height||1,Or=Re&&Number.isFinite(Re.width)&&Re.width>0?Re.width:Gt,fo=Re&&Number.isFinite(Re.height)&&Re.height>0?Re.height:Mt,Ha=Or>0?Gt/Or:1,Ua=fo>0?Mt/fo:1;return{rect:Re,viewPerPxX:Ha,viewPerPxY:Ua}},BR=(Re,qe)=>{const{viewPerPxX:Gt,viewPerPxY:Mt}=k_();return{x:(Number.isFinite(Re)?Re:0)*Gt/(Fs||1),y:(Number.isFinite(qe)?qe:0)*Mt/(Fs||1)}},Ug=()=>{Fs=aa(Fs),to.setAttribute("transform",`translate(${Ns.x},${Ns.y}) scale(${Fs})`)},I_=Re=>{const qe=Fs;if(!Number.isFinite(qe)||qe<=0)return;const Gt=aa(qe*Re);if(!Number.isFinite(Gt)||Gt<=0||Gt===qe){Fs=Gt,Ug();return}const{rect:Mt,viewPerPxX:Or,viewPerPxY:fo}=k_();if(Mt&&Number.isFinite(Mt.width)&&Number.isFinite(Mt.height)&&Mt.width>0&&Mt.height>0){const Ha=Mt.width/2,Ua=Mt.height/2,za=1/qe,Aa=1/Gt;Ns.x+=Ha*Or*(Aa-za),Ns.y+=Ua*fo*(Aa-za)}Fs=Gt,Ug()},GR=(Re,qe)=>{const Gt=Re();Gt&&(Gt.onclick=qe)};GR(xt,()=>{I_(1.1)}),GR(ut,()=>{I_(.9)}),GR(Er,()=>{Ns={...jg},Fs=Ol,Ug(),ct={},R?R():I&&I(),C&&C()});const LS=Re=>{if(Re.target.closest(".diagram-node"))return;const qe=ff(Re);IR=!0,Hg=qe,PR={...Ns},Re.touches&&Re.preventDefault(),$t()},RS=Re=>{if(!IR||!Hg)return;const qe=ff(Re),Gt=BR(qe.x-Hg.x,qe.y-Hg.y);Ns.x=PR.x+Gt.x,Ns.y=PR.y+Gt.y,Ug(),Re.touches&&Re.preventDefault()},TS=()=>{IR=!1,Hg=null},$5=140,P_=4,V5=350,B_=30;let np=null,xl=null,op=null,cs=null,ap=null,df=null,gc=!1,kl=null;const pf=()=>{ap&&(clearTimeout(ap),ap=null),df=null},MR=()=>{if(!df)return!1;const{node:Re,pointer:qe}=df;if(!Re)return pf(),!1;const Gt=Re.getAttribute("data-node");if(!Gt)return pf(),!1;const Mt=Y[Gt];return Mt?(np=Gt,op=Re,xl=qe,cs={x:Mt.x,y:Mt.y},gc=!0,pf(),!0):(pf(),!1)},OS=Re=>{const qe=Re.target.closest(".diagram-node");if(!qe)return;const Gt=ff(Re);df={node:qe,pointer:Gt,time:Date.now()},$t(),gc=!1,ap&&clearTimeout(ap),ap=setTimeout(()=>{MR()},$5)},q5=()=>gc?!0:MR(),xS=Re=>{if(df&&!gc){const Aa=ff(Re),Pl=Math.abs(Aa.x-df.pointer.x),zg=Math.abs(Aa.y-df.pointer.y);(Pl>P_||zg>P_)&&MR()}if(!q5()||!xl||!cs)return;const qe=ff(Re),Gt=BR(qe.x-xl.x,qe.y-xl.y),Mt=Gt.x,Or=Gt.y;let fo=cs.x+Mt,Ha=cs.y+Or;A()&&(fo=Math.round(fo/20)*20,Ha=Math.round(Ha/20)*20);const Ua=fo-cs.x,za=Ha-cs.y;op&&op.setAttribute("transform",`translate(${Ua},${za})`),gc&&Re.touches&&Re.preventDefault()},kS=Re=>{if(!gc||!np||!xl||!cs){pf(),gc=!1,np=null,op=null,xl=null,cs=null;return}const qe=ff(Re),Gt=BR(qe.x-xl.x,qe.y-xl.y);let Mt=cs.x+Gt.x,Or=cs.y+Gt.y;A()&&(Mt=Math.round(Mt/20)*20,Or=Math.round(Or/20)*20),ct[np]={x:Mt,y:Or},pf(),np=null,op=null,xl=null,cs=null,gc=!1,R?R():I&&I(),C&&C(),Re.touches&&Re.preventDefault()},G_=Re=>{const qe=Re.target.closest(".diagram-node");if(!qe){kl=null;return}const Gt=qe.getAttribute("data-node");if(!Gt){kl=null;return}const Mt=Date.now(),Or=ff(Re);if(kl&&kl.id===Gt&&Mt-kl.time<=V5&&Math.abs(Or.x-kl.pos.x)<=B_&&Math.abs(Or.y-kl.pos.y)<=B_){const fo=Ae[Gt];fo&&(Q5(qe,fo),typeof Re.preventDefault=="function"&&Re.preventDefault()),kl=null;return}kl={id:Gt,pos:Or,time:Mt},M_(qe)},K5=(Re,qe,Gt,Mt)=>{if(!Pe||(Pe.dataset.columns="1",Pe.style.removeProperty("--diagram-popup-dynamic-width"),!(Re&&typeof Re.className=="string"&&Re.className.includes("diagram-popup--camera")||Pe.classList.contains("diagram-popup--camera")))||!Number.isFinite(Gt)||Gt<=Mt*2)return;const fo=Gt-Mt*2;if(fo<=0||!Pe)return;const Ha=Pe.scrollHeight;if(!Number.isFinite(Ha)||Ha<=fo)return;const Ua=Number.isFinite(qe)&&qe>Mt*2?Math.max(260,qe-Mt*2):1/0,za=520,Aa=220,Pl=220;let zg=1,z_=za;for(let ip=2;ip<=4;ip+=1){const _R=Math.min(Ua,za+(ip-1)*Aa);if(_R<ip*Pl)continue;Pe.style.setProperty("--diagram-popup-dynamic-width",`${_R}px`),Pe.dataset.columns=String(ip),Pe.offsetHeight;const $_=Pe.scrollHeight;if(zg=ip,z_=_R,Number.isFinite($_)&&$_<=fo)break}zg>1?(Pe.dataset.columns=String(zg),Pe.style.setProperty("--diagram-popup-dynamic-width",`${z_}px`),Pe.offsetHeight):(Pe.dataset.columns="1",Pe.style.removeProperty("--diagram-popup-dynamic-width"),Pe.offsetHeight)},IS=(Re,qe,Gt=!1)=>{if(!Pe||!Re)return;const Mt=typeof Re.getBoundingClientRect=="function"?Re.getBoundingClientRect():null;if(!Mt)return;const Or=8;Gt||(Pe.style.visibility="hidden",Pe.style.display=Pe.classList.contains("diagram-popup--notice")?"flex":"block",Pe.removeAttribute("hidden"));const fo=r&&Number.isFinite(r.innerWidth)?r.innerWidth:t?.documentElement?.clientWidth||0,Ha=r&&Number.isFinite(r.innerHeight)?r.innerHeight:t?.documentElement?.clientHeight||0;Gt||K5(qe,fo,Ha,Or);const Ua=typeof Pe.getBoundingClientRect=="function"?Pe.getBoundingClientRect():null;if(!Ua)return;let za=0,Aa=0;const Pl=ve;Pl&&Number.isFinite(Pl.x)&&Number.isFinite(Pl.y)?(za=Pl.x+5,Aa=Pl.y+5,fo&&(za+Ua.width>fo-Or&&(za=fo-Ua.width-Or),za<Or&&(za=Or)),Ha&&(Aa<Or&&(Aa=Pl.y+Or*2),Aa+Ua.height>Ha-Or&&(Aa=Ha-Ua.height-Or))):(za=Mt.left+Mt.width/2-Ua.width/2,Aa=Mt.top-Ua.height-Or),Pe.style.left=`${Math.round(za)}px`,Pe.style.top=`${Math.round(Aa)}px`,Gt||(Pe.style.visibility="visible")},W5=()=>{if(!(!Pe||typeof Pe.focus!="function"))try{Pe.focus({preventScroll:!0})}catch{Pe.focus()}},Y5=(Re,qe)=>{if(!Pe)return;const Gt=Pe.querySelector("[data-diagram-popup-close]");if(Gt&&(Gt.onclick=Mt=>{Mt&&(Mt.preventDefault(),Mt.stopPropagation()),$t()}),Pe.onkeydown=Mt=>{if(!Mt)return;const Or=Mt.key||Mt.code;(Or==="Escape"||Or==="Esc")&&(Mt.preventDefault(),$t())},qe){const Mt=Pe.querySelector("[data-diagram-popup-expand]");Mt&&(Mt.onclick=Or=>{Or&&(Or.preventDefault(),Or.stopPropagation()),$t(),pe(qe)})}Pe.classList.contains("diagram-popup--notice")||W5()},Il=Re=>{if(!Re)return;let qe,Gt;if(Re.touches&&Re.touches.length){const Mt=Re.touches[0];qe=Mt?.clientX,Gt=Mt?.clientY}else typeof Re.clientX=="number"&&typeof Re.clientY=="number"&&(qe=Re.clientX,Gt=Re.clientY);Number.isFinite(qe)&&Number.isFinite(Gt)&&(ve={x:qe,y:Gt})},M_=Re=>{if(!Pe||!Re)return;const qe=Re.getAttribute("data-node");if(!qe||!Ae[qe]){$t();return}const Gt=Ae[qe],Mt=j(yt);Pe.className=`diagram-popup diagram-popup--notice ${Gt.className||""}`,Pe.innerHTML=`<p class="diagram-popup-notice">${Mt}</p>`,Pe.setAttribute("aria-label",yt),Pe.removeAttribute("aria-labelledby"),Bt=Re,Hr=null,IS(Re,null)},__=Re=>{Il(Re);const qe=Re.target.closest(".diagram-node");!qe||qe===Bt||M_(qe)},D_=Re=>{if(!Bt)return;const qe=Re.relatedTarget;qe&&Bt.contains(qe)||qe&&qe.closest&&qe.closest(".diagram-node")===Bt||Pe&&(qe===Pe||qe&&Pe.contains(qe))||$t()},N_=Re=>{Il(Re),Bt&&Pe&&Pe.classList.contains("diagram-popup--notice")&&IS(Bt,null,!0)},F_=Re=>{ie.contains(Re.relatedTarget)||Pe&&(Re.relatedTarget===Pe||Pe.contains(Re.relatedTarget))||$t()},PS=Re=>{if(!Pe||Pe.hasAttribute("hidden"))return;const qe=un(Re?.target||null);qe&&(qe===Pe||typeof Pe.contains=="function"&&Pe.contains(qe)||typeof qe.closest=="function"&&qe.closest(".diagram-node")||$t())};ie.addEventListener("mousedown",LS),ie.addEventListener("touchstart",LS,{passive:!1}),r&&(r.addEventListener("mousemove",RS),r.addEventListener("touchmove",RS,{passive:!1}),r.addEventListener("mouseup",TS),r.addEventListener("touchend",TS),r.addEventListener("mousemove",xS),r.addEventListener("touchmove",xS,{passive:!1}),r.addEventListener("mouseup",kS),r.addEventListener("touchend",kS),r.addEventListener("mousemove",Il),r.addEventListener("touchmove",Il,{passive:!0}));const Q5=(Re,qe)=>{if(qe){if(!Pe||!Re){pe(qe);return}Pe.className=qe.className?`diagram-popup ${qe.className}`:"diagram-popup",Pe.innerHTML=qe.content||"",qe.headingId?(Pe.setAttribute("aria-labelledby",qe.headingId),Pe.removeAttribute("aria-label")):qe.label?(Pe.setAttribute("aria-label",qe.label),Pe.removeAttribute("aria-labelledby")):(Pe.removeAttribute("aria-label"),Pe.removeAttribute("aria-labelledby")),Bt=Re,Hr=qe,IS(Re,qe),Y5(Re,qe)}},j_=Re=>{const qe=Re.target.closest(".diagram-node");if(!qe)return;const Gt=qe.getAttribute("data-node");if(!Gt)return;const Mt=Ae[Gt];if(!Mt)return;$t(),Bt=null,Hr=null;let Or=null;Re.clientX!==void 0&&Re.clientY!==void 0?Or={x:Re.clientX,y:Re.clientY}:ve&&(Or={...ve}),pe(Mt,Or),Re.stopPropagation(),Re.preventDefault()};ie.addEventListener("mousedown",OS),ie.addEventListener("touchstart",OS,{passive:!1}),ie.addEventListener("touchend",G_,{passive:!1}),ie.addEventListener("mouseover",__),ie.addEventListener("mouseout",D_),ie.addEventListener("mousemove",N_),ie.addEventListener("mouseleave",F_),ie.addEventListener("dblclick",j_);const H_=()=>{if(!Bt)return;const Re=Bt.getAttribute("data-node");if(!Re||!Ae[Re]){$t();return}const qe=Hr||Ae[Re];IS(Bt,qe||null)};ie.addEventListener("mousemove",Il),ie.addEventListener("touchstart",Il,{passive:!0}),t&&(t.addEventListener("mousedown",PS),t.addEventListener("touchstart",PS,{passive:!0})),r&&r.addEventListener("resize",H_);const U_=()=>{J()&&(Q()||Ee())};r&&r.addEventListener("scroll",U_,{passive:!0}),ee=()=>{ie.removeEventListener("mousedown",LS),ie.removeEventListener("touchstart",LS),r&&(r.removeEventListener("mousemove",RS),r.removeEventListener("touchmove",RS),r.removeEventListener("mouseup",TS),r.removeEventListener("touchend",TS),r.removeEventListener("mousemove",xS),r.removeEventListener("touchmove",xS),r.removeEventListener("mouseup",kS),r.removeEventListener("touchend",kS),r.removeEventListener("mousemove",Il),r.removeEventListener("touchmove",Il)),ie.removeEventListener("mousedown",OS),ie.removeEventListener("touchstart",OS),ie.removeEventListener("touchend",G_),ie.removeEventListener("mouseover",__),ie.removeEventListener("mouseout",D_),ie.removeEventListener("mousemove",N_),ie.removeEventListener("mouseleave",F_),ie.removeEventListener("mousemove",Il),ie.removeEventListener("touchstart",Il),ie.removeEventListener("dblclick",j_),t&&(t.removeEventListener("mousedown",PS),t.removeEventListener("touchstart",PS,{passive:!0})),r&&r.removeEventListener("resize",H_),r&&r.removeEventListener("scroll",U_),pf(),np=null,op=null,xl=null,cs=null,gc=!1,kl=null,$t()},Ug()}function x_(){const V=St();if(!V)return;const ie=zt(),je=dr(),ot=[{cls:"power",text:ie[je]?.diagramLegendPower||ie.en?.diagramLegendPower||"Power"},{cls:"video",text:ie[je]?.diagramLegendVideo||ie.en?.diagramLegendVideo||"Video"},{cls:"fiz",text:ie[je]?.diagramLegendFIZ||ie.en?.diagramLegendFIZ||"FIZ"}];V.innerHTML=ot.map(({cls:yt,text:Pe})=>`<span><span class="swatch ${yt}"></span>${Pe}</span>`).join("")}return{enableDiagramInteractions:Ds,updateDiagramLegend:x_,getDiagramManualPositions:ui,setManualDiagramPositions:To,getDiagramCss:Se,diagramConnectorIcons:Zo,diagramIcons:kn,overviewSectionIcons:ea,DIAGRAM_MONITOR_ICON:nt}}const Gu=Object.freeze({createConnectionDiagram:lae});Ia&&Ia.registerOrQueueModule("cine.features.connectionDiagram",Gu,{category:"features",description:"Connection diagram rendering and interactions.",replace:!0,connections:["cineModuleBase","cineModuleContext","cineUi"]},e=>sae("Unable to register cine.features.connectionDiagram module.",e),lr,Ia.getModuleRegistry&&Ia.getModuleRegistry(lr));if(Ia&&typeof Ia.exposeGlobal=="function")Ia.exposeGlobal("cineFeaturesConnectionDiagram",Gu,lr,{configurable:!0,enumerable:!1,writable:!1}),Ia.exposeGlobal("renderSetupDiagram",Gu.createConnectionDiagram,lr,{configurable:!0,enumerable:!1,writable:!0});else try{lr.cineFeaturesConnectionDiagram=Gu,lr.renderSetupDiagram=Gu.createConnectionDiagram}catch{}console.log("app-session.js: Starting execution (ESM)");typeof window<"u"&&typeof window.batteryPlateSelect>"u"&&(window.batteryPlateSelect=document.getElementById("batteryPlateSelect"));const{saveSessionState:rye,loadSessionState:ww,getSafeLocalStorage:Lw,getProjectStorageRevisionKeyName:nye,loadProject:uc,clearUiCacheStorageEntries:R0,loadAutoGearMonitorDefaults:T0,loadDocumentationTracker:O0,saveContacts:x0}=e3,jx=typeof window<"u"&&window.cineCoreShared||typeof globalThis<"u"&&globalThis.cineCoreShared||{},k0=typeof window<"u"&&window.resolveTemperatureStorageKey||(()=>"cameraPowerPlanner_temperatureUnit"),I0=typeof window<"u"&&window.TEMPERATURE_STORAGE_KEY||"cameraPowerPlanner_temperatureUnit",Gh=typeof window<"u"&&window.getCurrentProjectStorageKey||(()=>"cameraPowerPlanner_project"),P0=typeof window<"u"&&window.getUserProfileSnapshot||(()=>null),B0=typeof window<"u"&&window.formatUserProfileProviderName||(e=>e),G0=typeof window<"u"&&window.ensureContactForImportedOwner||(()=>{}),M0=typeof window<"u"&&window.setGearItemProvider||(()=>{}),_0=typeof window<"u"&&window.dispatchGearProviderDataChanged||(()=>{}),EE=typeof window<"u"&&window.enqueueCoreBootTask||(e=>e()),yn=typeof window<"u"&&window.CORE_GLOBAL_SCOPE||(typeof globalThis<"u"?globalThis:{});let Ad=!1,AE=null,Hx=!1,vy=null,CE=null,Ni=null,_r=null,rl=!0;const Gs=typeof document<"u"?document.getElementById("projectForm"):null,Pn=typeof document<"u"?document.getElementById("gearListOutput"):null,td=typeof document<"u"?document.getElementById("projectRequirementsOutput"):null,Ca=typeof document<"u"?document.getElementById("helpDialog"):null,ia=typeof document<"u"?document.getElementById("helpSearch"):null,Ux=typeof document<"u"?document.getElementById("helpSearchClear"):null,Ri=typeof document<"u"?document.getElementById("cameraSelect"):null,Wa=typeof document<"u"?document.getElementById("monitorSelect"):null,xa=typeof document<"u"?document.getElementById("batteryPlateSelect"):null;typeof document<"u"&&document.getElementById("batteryHotswapSelect");const ur=typeof document<"u"?document.getElementById("setupSelect"):null,Kt=typeof document<"u"?document.getElementById("setupName"):null;typeof document<"u"&&document.getElementById("offlineIndicator");const Vl=typeof document<"u"?document.getElementById("settingsDialog"):null;typeof document<"u"&&document.getElementById("featureSearchInput");const pl=typeof document<"u"?document.getElementById("settingsDarkMode"):null,ml=typeof document<"u"?document.getElementById("settingsPinkMode"):null;typeof document<"u"&&document.getElementById("gridSnapToggle");typeof document<"u"&&document.getElementById("diagramArea");typeof document<"u"&&document.getElementById("autoGearShowBackups");typeof document<"u"&&document.getElementById("autoGearScenarioMode");const zx=typeof document<"u"?document.getElementById("videoDistributionSelect"):null,Qi=typeof window<"u"&&typeof window.checkSetupChanged=="function"?window.checkSetupChanged:(()=>{console.warn("checkSetupChanged not available")}),$d=typeof window<"u"&&typeof window.updateCalculations=="function"?window.updateCalculations:(()=>{console.warn("updateCalculations not available")}),$x=function(...e){const t=typeof $d=="function"?$d:typeof globalThis<"u"&&typeof globalThis.updateCalculations=="function"?globalThis.updateCalculations:typeof window<"u"&&typeof window.updateCalculations=="function"?window.updateCalculations:null;if(t)return t(...e)},cR=function(...e){const t=typeof Qi=="function"?Qi:typeof globalThis<"u"&&typeof globalThis.checkSetupChanged=="function"?globalThis.checkSetupChanged:typeof window<"u"&&typeof window.checkSetupChanged=="function"?window.checkSetupChanged:null;if(t)return t(...e)},uR=function(...e){const t=typeof Ji=="function"?Ji:typeof globalThis<"u"&&typeof globalThis.saveCurrentSession=="function"?globalThis.saveCurrentSession:typeof window<"u"&&typeof window.saveCurrentSession=="function"?window.saveCurrentSession:null;if(t)return t(...e)},gM=function(...e){const t=typeof saveCurrentGearList=="function"?saveCurrentGearList:typeof globalThis<"u"&&typeof globalThis.saveCurrentGearList=="function"?globalThis.saveCurrentGearList:typeof window<"u"&&typeof window.saveCurrentGearList=="function"?window.saveCurrentGearList:null;if(t)return t(...e)},mS=function(...e){const t=typeof vP=="function"?vP:typeof globalThis<"u"&&typeof globalThis.autoSaveCurrentSetup=="function"?globalThis.autoSaveCurrentSetup:typeof window<"u"&&typeof window.autoSaveCurrentSetup=="function"?window.autoSaveCurrentSetup:null;if(t)return t(...e)},fR=function(...e){const t=typeof updateBatteryPlateVisibility=="function"?updateBatteryPlateVisibility:typeof globalThis<"u"&&typeof globalThis.updateBatteryPlateVisibility=="function"?globalThis.updateBatteryPlateVisibility:typeof window<"u"&&typeof window.updateBatteryPlateVisibility=="function"?window.updateBatteryPlateVisibility:null;if(t)return t(...e)},zc=function(...e){const t=typeof updateBatteryOptions=="function"?updateBatteryOptions:typeof globalThis<"u"&&typeof globalThis.updateBatteryOptions=="function"?globalThis.updateBatteryOptions:typeof window<"u"&&typeof window.updateBatteryOptions=="function"?window.updateBatteryOptions:null;if(t)return t(...e)},cae=function(...e){const t=typeof updateMonitoringConfigurationOptions=="function"?updateMonitoringConfigurationOptions:typeof globalThis<"u"&&typeof globalThis.updateMonitoringConfigurationOptions=="function"?globalThis.updateMonitoringConfigurationOptions:typeof window<"u"&&typeof window.updateMonitoringConfigurationOptions=="function"?window.updateMonitoringConfigurationOptions:null;if(t)return t(...e)},uae=function(...e){const t=typeof updateViewfinderSettingsVisibility=="function"?updateViewfinderSettingsVisibility:typeof globalThis<"u"&&typeof globalThis.updateViewfinderSettingsVisibility=="function"?globalThis.updateViewfinderSettingsVisibility:typeof window<"u"&&typeof window.updateViewfinderSettingsVisibility=="function"?window.updateViewfinderSettingsVisibility:null;if(t)return t(...e)},fae=function(...e){const t=typeof nU=="function"?nU:typeof globalThis<"u"&&typeof globalThis.populateRecordingResolutionDropdown=="function"?globalThis.populateRecordingResolutionDropdown:typeof window<"u"&&typeof window.populateRecordingResolutionDropdown=="function"?window.populateRecordingResolutionDropdown:null;if(t)return t(...e)},dae=function(...e){const t=typeof _P=="function"?_P:typeof globalThis<"u"&&typeof globalThis.populateSensorModeDropdown=="function"?globalThis.populateSensorModeDropdown:typeof window<"u"&&typeof window.populateSensorModeDropdown=="function"?window.populateSensorModeDropdown:null;if(t)return t(...e)},pae=function(...e){const t=typeof sU=="function"?sU:typeof globalThis<"u"&&typeof globalThis.populateSlowMotionRecordingResolutionDropdown=="function"?globalThis.populateSlowMotionRecordingResolutionDropdown:typeof window<"u"&&typeof window.populateSlowMotionRecordingResolutionDropdown=="function"?window.populateSlowMotionRecordingResolutionDropdown:null;if(t)return t(...e)},mae=function(...e){const t=typeof lU=="function"?lU:typeof globalThis<"u"&&typeof globalThis.populateSlowMotionSensorModeDropdown=="function"?globalThis.populateSlowMotionSensorModeDropdown:typeof window<"u"&&typeof window.populateSlowMotionSensorModeDropdown=="function"?window.populateSlowMotionSensorModeDropdown:null;if(t)return t(...e)},Vx=function(...e){const t=typeof MP=="function"?MP:typeof globalThis<"u"&&typeof globalThis.populateFrameRateDropdown=="function"?globalThis.populateFrameRateDropdown:typeof window<"u"&&typeof window.populateFrameRateDropdown=="function"?window.populateFrameRateDropdown:null;if(t)return t(...e)},wE=function(...e){const t=typeof Qw=="function"?Qw:typeof globalThis<"u"&&typeof globalThis.populateSlowMotionFrameRateDropdown=="function"?globalThis.populateSlowMotionFrameRateDropdown:typeof window<"u"&&typeof window.populateSlowMotionFrameRateDropdown=="function"?window.populateSlowMotionFrameRateDropdown:null;if(t)return t(...e)},D0=function(...e){const t=typeof handleMountVoltageInputChange=="function"?handleMountVoltageInputChange:typeof globalThis<"u"&&typeof globalThis.handleMountVoltageInputChange=="function"?globalThis.handleMountVoltageInputChange:typeof window<"u"&&typeof window.handleMountVoltageInputChange=="function"?window.handleMountVoltageInputChange:null;if(t)return t(...e)},gae=function(...e){const t=typeof normalizeAutoGearScenarioPrimary=="function"?normalizeAutoGearScenarioPrimary:typeof globalThis<"u"&&typeof globalThis.normalizeAutoGearScenarioPrimary=="function"?globalThis.normalizeAutoGearScenarioPrimary:typeof window<"u"&&typeof window.normalizeAutoGearScenarioPrimary=="function"?window.normalizeAutoGearScenarioPrimary:null;if(t)return t(...e)},yae=function(...e){const t=typeof normalizeAutoGearScenarioMultiplier=="function"?normalizeAutoGearScenarioMultiplier:typeof globalThis<"u"&&typeof globalThis.normalizeAutoGearScenarioMultiplier=="function"?globalThis.normalizeAutoGearScenarioMultiplier:typeof window<"u"&&typeof window.normalizeAutoGearScenarioMultiplier=="function"?window.normalizeAutoGearScenarioMultiplier:null;if(t)return t(...e)},hae=function(...e){const t=typeof removeAutoGearCondition=="function"?removeAutoGearCondition:typeof globalThis<"u"&&typeof globalThis.removeAutoGearCondition=="function"?globalThis.removeAutoGearCondition:typeof window<"u"&&typeof window.removeAutoGearCondition=="function"?window.removeAutoGearCondition:null;if(t)return t(...e)},bae=function(...e){const t=typeof handleAutoGearConditionShortcut=="function"?handleAutoGearConditionShortcut:typeof globalThis<"u"&&typeof globalThis.handleAutoGearConditionShortcut=="function"?globalThis.handleAutoGearConditionShortcut:typeof window<"u"&&typeof window.handleAutoGearConditionShortcut=="function"?window.handleAutoGearConditionShortcut:null;if(t)return t(...e)},Sae=function(...e){const t=typeof handleAutoGearImportSelection=="function"?handleAutoGearImportSelection:typeof globalThis<"u"&&typeof globalThis.handleAutoGearImportSelection=="function"?globalThis.handleAutoGearImportSelection:typeof window<"u"&&typeof window.handleAutoGearImportSelection=="function"?window.handleAutoGearImportSelection:null;if(t)return t(...e)},vae=function(...e){const t=typeof setAutoGearSearchQuery=="function"?setAutoGearSearchQuery:typeof globalThis<"u"&&typeof globalThis.setAutoGearSearchQuery=="function"?globalThis.setAutoGearSearchQuery:typeof window<"u"&&typeof window.setAutoGearSearchQuery=="function"?window.setAutoGearSearchQuery:null;if(t)return t(...e)},Eae=function(...e){const t=typeof setAutoGearScenarioFilter=="function"?setAutoGearScenarioFilter:typeof globalThis<"u"&&typeof globalThis.setAutoGearScenarioFilter=="function"?globalThis.setAutoGearScenarioFilter:typeof window<"u"&&typeof window.setAutoGearScenarioFilter=="function"?window.setAutoGearScenarioFilter:null;if(t)return t(...e)},Aae=function(...e){const t=typeof clearAutoGearFilters=="function"?clearAutoGearFilters:typeof globalThis<"u"&&typeof globalThis.clearAutoGearFilters=="function"?globalThis.clearAutoGearFilters:typeof window<"u"&&typeof window.clearAutoGearFilters=="function"?window.clearAutoGearFilters:null;if(t)return t(...e)},Cae=function(...e){const t=typeof setAutoGearSummaryFocus=="function"?setAutoGearSummaryFocus:typeof globalThis<"u"&&typeof globalThis.setAutoGearSummaryFocus=="function"?globalThis.setAutoGearSummaryFocus:typeof window<"u"&&typeof window.setAutoGearSummaryFocus=="function"?window.setAutoGearSummaryFocus:null;if(t)return t(...e)},wae=function(...e){const t=typeof handleAutoGearPresetSelection=="function"?handleAutoGearPresetSelection:typeof globalThis<"u"&&typeof globalThis.handleAutoGearPresetSelection=="function"?globalThis.handleAutoGearPresetSelection:typeof window<"u"&&typeof window.handleAutoGearPresetSelection=="function"?window.handleAutoGearPresetSelection:null;if(t)return t(...e)},Lae=function(...e){const t=typeof handleAutoGearSavePreset=="function"?handleAutoGearSavePreset:typeof globalThis<"u"&&typeof globalThis.handleAutoGearSavePreset=="function"?globalThis.handleAutoGearSavePreset:typeof window<"u"&&typeof window.handleAutoGearSavePreset=="function"?window.handleAutoGearSavePreset:null;if(t)return t(...e)},Rae=function(...e){const t=typeof handleAutoGearDeletePreset=="function"?handleAutoGearDeletePreset:typeof globalThis<"u"&&typeof globalThis.handleAutoGearDeletePreset=="function"?globalThis.handleAutoGearDeletePreset:typeof window<"u"&&typeof window.handleAutoGearDeletePreset=="function"?window.handleAutoGearDeletePreset:null;if(t)return t(...e)},N0=function(...e){const t=typeof addAutoGearDraftItem=="function"?addAutoGearDraftItem:typeof globalThis<"u"&&typeof globalThis.addAutoGearDraftItem=="function"?globalThis.addAutoGearDraftItem:typeof window<"u"&&typeof window.addAutoGearDraftItem=="function"?window.addAutoGearDraftItem:null;if(t)return t(...e)},Tae=function(...e){const t=typeof saveAutoGearRuleFromEditor=="function"?saveAutoGearRuleFromEditor:typeof globalThis<"u"&&typeof globalThis.saveAutoGearRuleFromEditor=="function"?globalThis.saveAutoGearRuleFromEditor:typeof window<"u"&&typeof window.saveAutoGearRuleFromEditor=="function"?window.saveAutoGearRuleFromEditor:null;if(t)return t(...e)},Oae=function(...e){const t=typeof closeAutoGearEditor=="function"?closeAutoGearEditor:typeof globalThis<"u"&&typeof globalThis.closeAutoGearEditor=="function"?globalThis.closeAutoGearEditor:typeof window<"u"&&typeof window.closeAutoGearEditor=="function"?window.closeAutoGearEditor:null;if(t)return t(...e)},F0=function(...e){const t=typeof renderAutoGearDraftLists=="function"?renderAutoGearDraftLists:typeof globalThis<"u"&&typeof globalThis.renderAutoGearDraftLists=="function"?globalThis.renderAutoGearDraftLists:typeof window<"u"&&typeof window.renderAutoGearDraftLists=="function"?window.renderAutoGearDraftLists:null;if(t)return t(...e)},xae=function(...e){const t=typeof duplicateAutoGearRule=="function"?duplicateAutoGearRule:typeof globalThis<"u"&&typeof globalThis.duplicateAutoGearRule=="function"?globalThis.duplicateAutoGearRule:typeof window<"u"&&typeof window.duplicateAutoGearRule=="function"?window.duplicateAutoGearRule:null;if(t)return t(...e)},kae=function(...e){const t=typeof Iw=="function"?Iw:typeof globalThis<"u"&&typeof globalThis.invokeSessionOpenAutoGearEditor=="function"?globalThis.invokeSessionOpenAutoGearEditor:typeof window<"u"&&typeof window.invokeSessionOpenAutoGearEditor=="function"?window.invokeSessionOpenAutoGearEditor:null;if(t)return t(...e)},Iae=function(...e){const t=typeof updateAutoGearBackupRestoreButtonState=="function"?updateAutoGearBackupRestoreButtonState:typeof globalThis<"u"&&typeof globalThis.updateAutoGearBackupRestoreButtonState=="function"?globalThis.updateAutoGearBackupRestoreButtonState:typeof window<"u"&&typeof window.updateAutoGearBackupRestoreButtonState=="function"?window.updateAutoGearBackupRestoreButtonState:null;if(t)return t(...e)},Pae=function(...e){const t=typeof handleAutoGearShowBackupsToggle=="function"?handleAutoGearShowBackupsToggle:typeof globalThis<"u"&&typeof globalThis.handleAutoGearShowBackupsToggle=="function"?globalThis.handleAutoGearShowBackupsToggle:typeof window<"u"&&typeof window.handleAutoGearShowBackupsToggle=="function"?window.handleAutoGearShowBackupsToggle:null;if(t)return t(...e)},Bae=function(...e){const t=typeof restoreAutoGearBackup=="function"?restoreAutoGearBackup:typeof globalThis<"u"&&typeof globalThis.restoreAutoGearBackup=="function"?globalThis.restoreAutoGearBackup:typeof window<"u"&&typeof window.restoreAutoGearBackup=="function"?window.restoreAutoGearBackup:null;if(t)return t(...e)},dP=function(...e){const t=typeof syncAutoGearMonitorFieldVisibility=="function"?syncAutoGearMonitorFieldVisibility:typeof globalThis<"u"&&typeof globalThis.syncAutoGearMonitorFieldVisibility=="function"?globalThis.syncAutoGearMonitorFieldVisibility:typeof window<"u"&&typeof window.syncAutoGearMonitorFieldVisibility=="function"?window.syncAutoGearMonitorFieldVisibility:null;if(t)return t(...e)},Gae=function(...e){const t=typeof updateAutoGearMonitorCatalogOptions=="function"?updateAutoGearMonitorCatalogOptions:typeof globalThis<"u"&&typeof globalThis.updateAutoGearMonitorCatalogOptions=="function"?globalThis.updateAutoGearMonitorCatalogOptions:typeof window<"u"&&typeof window.updateAutoGearMonitorCatalogOptions=="function"?window.updateAutoGearMonitorCatalogOptions:null;if(t)return t(...e)},Mae=function(...e){const t=typeof clearAutoGearDraftItemEdit=="function"?clearAutoGearDraftItemEdit:typeof globalThis<"u"&&typeof globalThis.clearAutoGearDraftItemEdit=="function"?globalThis.clearAutoGearDraftItemEdit:typeof window<"u"&&typeof window.clearAutoGearDraftItemEdit=="function"?window.clearAutoGearDraftItemEdit:null;if(t)return t(...e)},_ae=function(...e){const t=typeof updateAutoGearCatalogOptions=="function"?updateAutoGearCatalogOptions:typeof globalThis<"u"&&typeof globalThis.updateAutoGearCatalogOptions=="function"?globalThis.updateAutoGearCatalogOptions:typeof window<"u"&&typeof window.updateAutoGearCatalogOptions=="function"?window.updateAutoGearCatalogOptions:null;if(t)return t(...e)},Dae=function(...e){const t=typeof beginAutoGearDraftItemEdit=="function"?beginAutoGearDraftItemEdit:typeof globalThis<"u"&&typeof globalThis.beginAutoGearDraftItemEdit=="function"?globalThis.beginAutoGearDraftItemEdit:typeof window<"u"&&typeof window.beginAutoGearDraftItemEdit=="function"?window.beginAutoGearDraftItemEdit:null;if(t)return t(...e)},t2=new Set(["exactKey","keyPrefix","keySubset"]);typeof globalThis<"u"&&typeof globalThis.STRONG_SEARCH_MATCH_TYPES>"u"&&(globalThis.STRONG_SEARCH_MATCH_TYPES=t2);const Nae="Force reload requires an internet connection. Try again once you are back online.";var tc=typeof tc<"u"?tc:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("pinkModeToggle"):null,rc=typeof rc<"u"?rc:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("darkModeToggle"):null,Ti=typeof Ti<"u"?Ti:typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("batteryHotswapSelect"):null;typeof globalThis<"u"&&Ti&&typeof globalThis.hotswapSelect>"u"&&(globalThis.hotswapSelect=Ti);function r2(){return typeof yn<"u"&&yn?yn:typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function dR(e){if(typeof e!="string"||!e)return null;const t=[],r=new Set,n=a=>{!a||typeof a!="object"&&typeof a!="function"||r.has(a)||(r.add(a),t.push(a))};try{n(typeof yn<"u"?yn:null)}catch{}try{n(typeof globalThis<"u"?globalThis:null)}catch{}try{n(typeof window<"u"?window:null)}catch{}try{n(typeof self<"u"?self:null)}catch{}try{n(typeof global<"u"?global:null)}catch{}let o=0;for(let a=0;a<t.length;a+=1){if(o++,o>1e3){typeof console<"u"&&typeof console.warn=="function"&&console.warn("resolveSessionRuntimeFunction: exceeded max iterations",e);break}const i=t[a];if(i){try{const s=i[e];if(typeof s=="function")return s}catch(s){typeof console<"u"&&typeof console.warn=="function"&&console.warn("resolveSessionRuntimeFunction: failed to read candidate from scope",e,s)}try{const s=i.CORE_GLOBAL_SCOPE||i.core||i.__cineRuntimeState;if(s&&!r.has(s)){n(s);const l=s[e];if(typeof l=="function")return l}}catch(s){typeof console<"u"&&typeof console.debug=="function"&&console.debug("resolveSessionRuntimeFunction: nested scope probe failed",e,s)}}}return null}function Fae(e){return!e||typeof e!="object"||typeof e.onLine!="boolean"?!1:e.onLine===!1}function jae(){let e="";if(typeof document<"u"&&document&&typeof document.getElementById=="function"){const r=document.getElementById("offlineIndicator");if(r){const n=r.dataset||{},o=typeof n.forceReloadNotice=="string"&&n.forceReloadNotice.trim()?n.forceReloadNotice.trim():null,a=typeof n.reloadNotice=="string"&&n.reloadNotice.trim()?n.reloadNotice.trim():null,i=typeof r.getAttribute=="function"?r.getAttribute("data-help"):null,s=typeof i=="string"&&i.trim()?i.trim():null,l=typeof r.textContent=="string"&&r.textContent.trim()?r.textContent.trim():null;if(e=o||a||s||l||"",!e){const c=typeof n.baseLabel=="string"&&n.baseLabel.trim()?n.baseLabel.trim():null;c&&(e=c)}if(e)return e}}const t=dR("resolveLocaleString");if(typeof t=="function")try{const r=t("reloadAppOfflineNotice");if(typeof r=="string"&&r.trim())return r.trim()}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("resolveForceReloadOfflineNotice: failed to resolve locale string",r)}return Nae}function pP(){const e=jae();let t=!1;if(typeof document<"u"&&document&&typeof document.getElementById=="function"){const r=document.getElementById("offlineIndicator");r&&(t=!0,r.dataset&&(r.dataset.forceReloadNotice=e,r.dataset.reloadNotice=e),typeof r.setAttribute=="function"&&(r.setAttribute("data-help",e),r.setAttribute("role","status"),r.setAttribute("aria-live","polite")),typeof r.removeAttribute=="function"&&r.removeAttribute("hidden"),(typeof r.textContent=="string"||typeof r.textContent=="object")&&(r.textContent=e))}if(!t&&typeof window<"u"&&typeof window.alert=="function")try{window.alert(e)}catch{}}try{typeof globalThis<"u"&&globalThis&&typeof globalThis.announceForceReloadOfflineNotice!="function"&&(globalThis.announceForceReloadOfflineNotice=pP)}catch{}(function(e){e.cineProjectLockManager||(e.cineProjectLockManager={requestLock:async t=>{if(Ni&&Ni.name===t||(Ni&&(Ni.unlock&&Ni.unlock(),Ni=null),!t)||typeof navigator>"u"||!navigator.locks)return!0;const r=`cine_project_lock_${t}`;return new Promise(n=>{navigator.locks.request(r,{ifAvailable:!0},async o=>{if(!o){n(!1);return}let a;const i=new Promise(s=>{a=s});Ni={name:t,unlock:a},n(!0),await i})})},releaseLock:()=>{Ni&&(Ni.unlock&&Ni.unlock(),Ni=null)},isLocked:t=>Ni&&Ni.name===t})})(typeof globalThis<"u"?globalThis:typeof window<"u"?window:{});function pR(e=""){const t=dR("getCurrentProjectName");if(typeof t!="function")return e;try{const r=t();if(typeof r=="string"&&r.trim())return r}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("safeGetCurrentProjectName: runtime call failed, using fallback",r)}return e}const Hae="cameraPowerPlanner_project_rev";function n2(e){if(typeof e=="number"&&Number.isFinite(e))return Math.max(0,Math.floor(e));if(typeof e=="string"){const t=e.trim();if(!t)return null;const r=Number(t);if(Number.isFinite(r))return Math.max(0,Math.floor(r))}return null}function o2(){const e=dR("getProjectStorageRevisionKeyName");if(typeof e=="function")try{const t=e();if(typeof t=="string"&&t.trim())return t.trim()}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to resolve project storage revision key name",t)}return Hae}function Uae(){const e=typeof Lw=="function"?Lw():typeof localStorage<"u"?localStorage:null;if(!e||typeof e.getItem!="function")return null;try{const t=e.getItem(o2());return n2(t)}catch(t){return typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to read project storage revision from localStorage",t),null}}function zae(){if(typeof Gh=="function")try{const t=Gh({allowTyped:!0});if(typeof t=="string"&&t.trim())return t}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to resolve active project storage key",t)}const e=pR("");return e||(ur&&typeof ur.value=="string"&&ur.value.trim()?ur.value.trim():"")}function $ae(e={}){if(ef||restoringSession)return!1;const t=Ad;Ad=!0;try{if(typeof isProjectPersistenceSuspended=="function"&&isProjectPersistenceSuspended()||typeof uc!="function")return!1;const r=zae();if(!r)return!1;let n=null;try{n=uc(r)}catch(s){return!e.silent&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to reload project from storage after external update",s),!1}if(!n||typeof n!="object"){if(typeof populateSetupSelect=="function")try{populateSetupSelect()}catch(s){}if(ur&&typeof ur.value<"u"){ur.value="";try{ur.dispatchEvent(new Event("change",{bubbles:!0}))}catch(s){}}if(_r=null,Gs&&typeof populateProjectForm=="function")try{populateProjectForm({})}catch(s){}return!e.silent&&typeof console<"u"&&typeof console.info=="function"&&console.info("[app-session] Project no longer exists, reset to New Project state"),!1}if(typeof getCurrentSetupState=="function"&&typeof stableStringify=="function")try{const s={...getCurrentSetupState()},l=typeof getCurrentGearListHtml=="function"?getCurrentGearListHtml():"";if(l&&(s.gearList=l),typeof getDiagramManualPositions=="function"){const f=getDiagramManualPositions();f&&Object.keys(f).length?s.diagramPositions=f:Object.prototype.hasOwnProperty.call(s,"diagramPositions")&&delete s.diagramPositions}const c=stableStringify(s),u=stableStringify(n);if(c===u)return!0}catch(s){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Project reload optimization check failed",s)}if(n.powerSelection&&typeof applyStoredPowerSelection=="function"&&applyStoredPowerSelection(n.powerSelection,{preferExisting:!1}),updateBatteryOptions(),_r=n.projectInfo||null,Gs&&typeof populateProjectForm=="function"&&populateProjectForm(_r||{}),typeof setManualDiagramPositions=="function"){const s=n.diagramPositions&&typeof normalizeDiagramPositionsInput=="function"?normalizeDiagramPositionsInput(n.diagramPositions):{};setManualDiagramPositions(s||{},{render:!1})}n.autoGearRules&&n.autoGearRules.length?typeof useProjectAutoGearRules=="function"&&useProjectAutoGearRules(n.autoGearRules):typeof clearProjectAutoGearRules=="function"&&clearProjectAutoGearRules();const o=s=>Fn("generateGearListHtml",[s||{}],{defaultValue:""})||"",i=(typeof n.gearList=="string"?n.gearList:"")||o(_r||{});if(typeof displayGearAndRequirements=="function"&&displayGearAndRequirements(i),Pn&&(i&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener()),typeof applyGearListSelectors=="function"&&n.gearSelectors&&Object.keys(n.gearSelectors).length&&applyGearListSelectors(n.gearSelectors),typeof updateGearListButtonVisibility=="function"&&updateGearListButtonVisibility()),typeof populateSetupSelect=="function")try{if(populateSetupSelect(),r){const s=document.getElementById("setupSelect");s&&(s.value=r)}}catch(s){!e.silent&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to refresh setup selector after external project update",s)}return typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),typeof storeLoadedSetupStateSafe=="function"&&typeof getCurrentSetupState=="function"&&storeLoadedSetupStateSafe(getCurrentSetupState()),typeof Qi=="function"&&Qi(),!0}finally{Ad=t}}function Vae(e={}){Hx||(AE&&clearTimeout(AE),AE=setTimeout(()=>{AE=null,Hx=!0;try{$ae({silent:e.silent})}finally{Hx=!1}},120))}if(typeof window<"u"&&window&&typeof window.addEventListener=="function"){try{vy=Uae()}catch{vy=null}window.addEventListener("storage",e=>{if(!e||typeof e!="object")return;const t=o2();if(e.key!==t)return;const r=n2(e.newValue);if(Ad){r!==null&&(vy=r);return}r!==null&&r===vy||(vy=r,Vae({silent:!0}))})}function qae(){return dR("setLanguage")}function bg(e,t={}){const r=qae();if(typeof r!="function")return!t?.silent&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("applySetLanguage: setLanguage runtime function not available"),!1;try{return r(e)}catch(n){return!t?.silent&&typeof console<"u"&&typeof console.error=="function"&&console.error("applySetLanguage: setLanguage execution failed",n),!1}}function j0(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function Kae(e){if(typeof structuredClone=="function")return structuredClone;if(e&&typeof e.structuredClone=="function")try{return e.structuredClone.bind(e)}catch{}if(typeof require=="function"){try{const t=require("node:util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}try{const t=require("util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}}return null}function Wae(e){const t=Kae(e);return t?function(n){if(n===null||typeof n!="object")return n;try{return t(n)}catch{}return j0(n)}:j0}let Rw,Sg,Tw,Ow,xw,Mh,a2,i2;const yM=typeof yn<"u"&&yn&&typeof yn.__cineDeepClone=="function"?yn.__cineDeepClone:Wae(r2());if(typeof yn<"u"&&yn&&typeof yn.__cineDeepClone!="function")try{yn.__cineDeepClone=yM}catch{}function Yae(){if(CE instanceof Set)return CE;const e=[typeof yn<"u"&&yn&&typeof yn=="object"?yn:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null].filter(Boolean);for(let r=0;r<e.length;r+=1){const n=e[r];try{const o=n.__cineMissingMountVoltageWarnings;if(o instanceof Set)return CE=o,o}catch{}}const t=new Set;for(let r=0;r<e.length;r+=1){const n=e[r];try{n.__cineMissingMountVoltageWarnings=t;break}catch{}}return CE=t,t}function Os(e,t){const r=Yae(),n=typeof e=="string"&&e?e:"unknown";if(!r.has(n)&&(r.add(n),typeof console<"u"&&typeof console.warn=="function")){const o=`Mount voltage helper "${n}" is unavailable; using defaults to protect user data.`;t?console.warn(o,t):console.warn(o)}}function _o(e,t){const r=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,n=typeof t=="function"?t:()=>t;if(!r||typeof r!="object")return n();try{const o=r[e];if(typeof o>"u"||o===null){const a=n();return typeof a<"u"&&a!==null&&(r[e]=a),a}return o}catch{return n()}}function s2(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function Gm(e,t,r,n={}){if(typeof e!="string"||!e||typeof t!="function"||typeof r!="function")return!1;const o=s2();if(!o||typeof o!="object"&&typeof o!="function")return!1;const a=typeof n.maxAttempts=="number"?n.maxAttempts:150,i=a<0,s=typeof n.interval=="number"&&n.interval>0?n.interval:200,l=y=>{try{r(y)}catch(E){typeof console<"u"&&console&&typeof console.error=="function"&&console.error(`whenGlobalValueAvailable: handler for ${e} threw.`,E)}},c=y=>t(y)?(l(y),!0):!1,u=(()=>{try{return o[e]}catch(y){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn(`whenGlobalValueAvailable: unable to read ${e} during initial attempt.`,y);return}})();if(c(u))return!0;let f=0,d=!1;const p=[],h=()=>{d=!0;for(let y=0;y<p.length;y+=1)try{clearTimeout(p[y])}catch{}p.length=0},m=()=>{if(typeof n.onTimeout=="function")try{n.onTimeout()}catch(y){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn(`whenGlobalValueAvailable: timeout handler for ${e} failed.`,y)}},g=()=>{if(d)return;f+=1;let y;try{y=o[e]}catch(L){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn(`whenGlobalValueAvailable: unable to read ${e} during polling.`,L),y=void 0}if(c(y)){h();return}if(!i&&f>=a){h(),m();return}const E=setTimeout(g,s);p.push(E)},S=setTimeout(g,s);return p.push(S),!0}function pc(){const e=[],t=r=>{!r||typeof r!="object"||e.indexOf(r)===-1&&e.push(r)};try{typeof yn<"u"&&yn&&t(yn)}catch{}return t(typeof globalThis<"u"?globalThis:null),t(typeof window<"u"?window:null),t(typeof self<"u"?self:null),t(typeof global<"u"?global:null),e}function l2(e,t){if(typeof e!="string"||!e)return null;const r=typeof t=="function"?t:u=>!!u,n=new Set,o=[],a=u=>{!u||typeof u!="object"&&typeof u!="function"||n.has(u)||(n.add(u),o.push(u))},i=["CORE_SHARED","CORE_GLOBAL_SCOPE","CORE_AGGREGATED_EXPORTS","CORE_RUNTIME_SCOPE","CORE_PART2_RUNTIME_SCOPE","CORE_SCOPE","CORE_SHARED_SCOPE_PART2","cine","cineGlobals","cineModuleGlobals","cineModuleBase","cineModuleContext","cineRuntime","cinePersistence","cineOffline","cineUi","APP","app","__cineGlobal","__cineScope","__cineModules","__cineExports","__cineRuntime"],s=u=>{if(!u)return null;try{if(r(u))return u}catch{}return null},l=u=>{let f;try{f=u[e]}catch{f=void 0}const d=s(f);if(d)return d;let p;try{p=u.cineModuleGlobals}catch{p=null}if(p&&typeof p.getModule=="function")try{const m=p.getModule(e),g=s(m);if(g)return g}catch{}let h;try{h=u.cineModules}catch{h=null}if(h&&typeof h.get=="function")try{const m=h.get(e),g=s(m);if(g)return g}catch{}return null};a(s2());const c=pc();for(let u=0;u<c.length;u+=1)a(c[u]);for(;o.length;){const u=o.shift();if(!u)continue;const f=l(u);if(f)return f;for(let d=0;d<i.length;d+=1){const p=i[d];let h;try{h=u[p]}catch{h=void 0}h&&a(h)}}return null}function $c(e){if(typeof e!="string")return null;const t=e.trim();return t||null}function c2(e){const t=$c(e);if(t)return t;try{if(typeof APP_VERSION=="string"){const c=$c(APP_VERSION);if(c)return c}}catch{}const r=new Set,n=[],o=c=>{if(!c)return;const u=typeof c;u!=="object"&&u!=="function"||r.has(c)||(r.add(c),n.push(c))},a=pc();for(let c=0;c<a.length;c+=1)o(a[c]);try{typeof jx<"u"&&jx&&o(jx)}catch{}try{typeof yn<"u"&&yn&&o(yn)}catch{}const i=["APP_VERSION","appVersion","applicationVersion","version"],s=["CORE_SHARED","CORE_GLOBAL_SCOPE","CORE_AGGREGATED_EXPORTS","CORE_RUNTIME_SCOPE","CORE_PART2_RUNTIME_SCOPE","CORE_SCOPE","CORE_SHARED_SCOPE_PART2","cineCoreShared","cineModules","cineModuleGlobals","cineModuleBase","cineModuleContext","cineRuntime","cinePersistence","cineOffline","cineUi","cineGlobals","cine","APP","app","globalScope","scope","exports","module","modules","environment","context","runtime","shared","globals","__cineGlobal","__cineScope","__cineModules","__cineExports","__cineRuntime","details","meta","metadata","build","buildInfo"];let l=0;for(;n.length;){if(l++,l>1e3){typeof console<"u"&&typeof console.warn=="function"&&console.warn("resolveKnownAppVersion: exceeded max iterations");break}const c=n.shift();if(!c)continue;for(let d=0;d<i.length;d+=1){const p=i[d];let h;try{h=c[p]}catch{h=void 0}const m=$c(h);if(m)return m}for(let d=0;d<s.length;d+=1){const p=s[d];let h;try{h=c[p]}catch{h=null}o(h)}let u=[];try{u=Object.keys(c)}catch{u=[]}const f=u.length>50?u.slice(0,50):u;for(let d=0;d<f.length;d+=1){const p=f[d];if(!/(version|core|cine|shared|global|app)/i.test(p))continue;let h;try{h=c[p]}catch{h=null}o(h)}}return null}const es=c2(typeof APP_VERSION=="string"?APP_VERSION:null);function Qae(){const e=pc();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.cineCoreMountVoltage;if(n&&typeof n=="object")return n}catch{}}return null}function Xae(){const e=pc();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.MOUNT_VOLTAGE_RUNTIME_EXPORTS;if(n&&typeof n=="object")return n}catch{}}return null}function Qc(e){if(typeof e!="string"||!e)return null;const t=Qae();if(t&&typeof t[e]=="function")return t[e];const r=Xae();if(r&&typeof r[e]=="function")return r[e];const n=pc();for(let o=0;o<n.length;o+=1){const a=n[o];let i=null;try{i=a[e]}catch{i=null}if(typeof i=="function")return i}return null}function Jae(){if(typeof require=="function")try{const t=require("./modules/logging-resolver.js");if(t&&typeof t.resolveLogger=="function")return t}catch{}const e=pc();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.cineLoggingResolver;if(n&&typeof n.resolveLogger=="function")return n}catch{}}return null}function Zae(){const e=pc();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.cineLogging;if(n&&typeof n.createLogger=="function")try{return n.createLogger("settings",{meta:{source:"app-session"}})}catch(o){try{typeof n.error=="function"&&n.error("Failed to create settings logger",o,{namespace:"settings-bootstrap"})}catch(a){}}}catch{}}return null}const qx=(()=>{const e=Jae();if(e&&typeof e.resolveLogger=="function")try{const t=e.resolveLogger("settings",{meta:{source:"app-session"}});if(t)return t}catch{}return Zae()})();function xs(e,t,r,n){const o=typeof e=="string"&&e?e.toLowerCase():"info";let a=!1;if(qx&&typeof qx[o]=="function")try{qx[o](t,r,n),a=!0}catch(s){a=!1,typeof console<"u"&&typeof console.warn=="function"&&console.warn("Settings logger invocation failed",s)}if(a||typeof console>"u"||!console)return;let i=null;if(o==="error"&&typeof console.error=="function"?i=console.error:o==="warn"&&typeof console.warn=="function"?i=console.warn:typeof console.info=="function"?i=console.info:typeof console.log=="function"&&(i=console.log),typeof i=="function")try{i.call(console,`[settings] ${t}`,r||null,n||null)}catch{}}let kw=null;function H0(e){e&&typeof e=="object"?kw={...e}:kw=null}function eie(e){const t=kw;return kw=null,t&&typeof t=="object"?{...t}:e&&typeof e=="object"?{...e}:{reason:"settings-button"}}function u2(){if(typeof Vl<"u"&&Vl)return Vl;if(typeof document<"u"&&document)try{return document.getElementById("settingsDialog")}catch{}return null}function f2(){if(typeof settingsButton<"u"&&settingsButton)return settingsButton;if(typeof document<"u"&&document)try{return document.getElementById("settingsButton")}catch{}return null}function tie(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t)return null;let r=null;try{typeof t.cineEnsureDeferredScriptsLoaded=="function"&&(r=t.cineEnsureDeferredScriptsLoaded({reason:e}))}catch{r=null}if(!r)try{r=t.cineDeferredScriptsReady}catch{r=null}return r}function rie(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t)return null;let r=null;try{typeof t.cineEnsureOnboardingTourLoaded=="function"&&(r=t.cineEnsureOnboardingTourLoaded(e))}catch{r=null}return r&&typeof r.then=="function"&&r.catch(n=>{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Onboarding tour module failed to pre-load for help interactions.",n)}),r}function U0(e){const t=u2(),r=f2(),n=t?typeof isDialogOpen=="function"?isDialogOpen(t):!!(t&&t.open):!1,o=e&&typeof e=="object"?{...e}:{};if(typeof o.openBefore!="boolean"&&(o.openBefore=n),tie("settings-open"),r&&typeof r.click=="function"){H0(o);try{r.click()}catch(a){throw H0(null),xs("error","Settings dialog open request failed during click",{...o,buttonAvailable:!0},{action:"open-request"}),a}return!0}return xs("warn","Settings dialog open request unavailable",{...o,buttonAvailable:!1},{action:"open-request"}),!1}function gS(e,t){const r=typeof texts=="object"&&texts?texts:{},n=t||r.en||{},o=typeof currentLang=="string"&&r[currentLang]?currentLang:"en",a=e||r[o]||n;return{lang:o,langTexts:a,fallbackTexts:n}}function Kx(e){return e==null?!1:typeof e=="string"?e.trim().length>0:typeof e=="number"||typeof e=="boolean"?!0:Array.isArray(e)?e.length>0:typeof e=="object"?Object.keys(e).length>0:!1}const Vd=_o("formatNumberForComparison",()=>{const e=new Map,t=(r,n)=>{const o=`${r}|${n?"fraction":"integer"}`;if(e.has(o))return e.get(o);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{const a=new Intl.NumberFormat(r,{maximumFractionDigits:n?2:0});return e.set(o,a),a}catch(a){console.warn("Unable to create comparison number formatter",a)}return e.set(o,null),null};return r=>{if(r==null)return"";const n=typeof r=="number"?r:Number(typeof r=="string"?r.trim():r);if(!Number.isFinite(n))return typeof r=="string"?r:String(r);const{lang:o}=gS(),a=Math.abs(n%1)>Number.EPSILON,i=t(o,a);if(i)try{return i.format(n)}catch(s){console.warn("Comparison number formatting failed",s)}try{return n.toLocaleString(o)}catch{}return String(n)}}),d2=_o("getManualDownloadFallbackMessage",()=>()=>{const{langTexts:e,fallbackTexts:t}=gS();return e.manualDownloadFallback||t.manualDownloadFallback||"The download did not start automatically. A new tab opened with the file contents so you can copy or save them manually."});_o("getManualDownloadCopyHint",()=>()=>{const{langTexts:e,fallbackTexts:t}=gS();return e.manualDownloadCopyHint||t.manualDownloadCopyHint||"Select all the text below and copy it to keep the file safe."});let Mu=_o("backupDiffOptionsCache",()=>[]),fc=_o("backupDiffState",()=>({baseline:"",comparison:""}));const nie=["devices","setups","project","projects","gearList","favorites"],oie=["autoGearRules","autoGearPresets","autoGearBackups","autoGearMonitorDefaults","autoGearActivePresetId","autoGearAutoPresetId","autoGearShowBackups","autoGearBackupRetention","fullBackups","fullBackupHistory","session"],aie=["accentColor","fontSize","fontFamily","language","showAutoBackups","customLogo","customFonts"],z0={autoGearRules:"Automatic gear rules",autoGearPresets:"Automatic gear presets",autoGearBackups:"Automatic gear backups",autoGearMonitorDefaults:"Monitor defaults",autoGearActivePresetId:"Active auto gear preset",autoGearAutoPresetId:"Auto gear auto preset",autoGearShowBackups:"Auto gear backup visibility",autoGearBackupRetention:"Auto gear backup retention",fullBackups:"Full backups",fullBackupHistory:"Full backup history",showAutoBackups:"Automatic backup visibility"};function iie(e){if(z0[e])return z0[e];if(typeof e!="string")return String(e);const t=e.replace(/[_\s-]+/g," ").replace(/([a-z\d])([A-Z])/g,"$1 $2").trim();return t?t.charAt(0).toUpperCase()+t.slice(1):e}function sie({data:e,settingsSnapshot:t,sessionSnapshot:r}){const n=e&&typeof e=="object"?e:null,o=t&&typeof t=="object"?t:null,a=r&&typeof r=="object"?r:null,i=[],s=[],l=[],c=(u,f)=>{if(!n||!Object.prototype.hasOwnProperty.call(n,u)){f.push(u);return}Kx(n[u])||f.push(u)};return nie.forEach(u=>c(u,i)),oie.forEach(u=>c(u,s)),(!a||!Kx(a))&&(s.includes("session")||s.push("session")),aie.forEach(u=>{if(!o||!Object.prototype.hasOwnProperty.call(o,u)){l.push(u);return}Kx(o[u])||l.push(u)}),{missingCore:i,missingOptional:s,missingStorage:l}}function Wx(e,t){if(!e||!Array.isArray(t)||!t.length)return"";const r=t.map(n=>` ${iie(n)}`).join(`
`);return`${e}
${r}`}function p2(e={}){const{langTexts:t,fallbackTexts:r,fileVersion:n,targetVersion:o,data:a,settingsSnapshot:i,sessionSnapshot:s,backupFileName:l}=e,{langTexts:c,fallbackTexts:u}=gS(t,r),f=sie({data:a,settingsSnapshot:i,sessionSnapshot:s}),d=(k,_)=>c&&typeof c[k]=="string"?c[k]:u&&typeof u[k]=="string"?u[k]:_||"",p=[],h=d("restoreVersionSummaryTitle");h&&p.push(h);const m=d("restoreVersionUnknownVersion","unknown version"),g=d("restoreVersionSummaryHeading","This backup was created with {oldVersion} and you are running {newVersion}."),S=$c(n),y=c2(o)||es||$c(o),E=g.replace("{oldVersion}",S||m).replace("{newVersion}",y||m);p.push(E);const L=d("restoreVersionWarning");L&&p.push(L);const v=Wx(d("restoreVersionCoreMissing","Not included in this backup:"),f.missingCore);v&&p.push(v);const A=Wx(d("restoreVersionStorageMissing","Stored preferences not included:"),f.missingStorage);A&&p.push(A);const R=Wx(d("restoreVersionOptionalMissing","Optional items you may need to recreate:"),f.missingOptional);if(R&&p.push(R),!f.missingCore.length&&!f.missingStorage.length&&!f.missingOptional.length){const k=d("restoreVersionNoIssues");k&&p.push(k)}if(l){const k=d("restoreVersionBackupLabel");k&&p.push(k.replace("{fileName}",l))}const I=d("restoreVersionTip");I&&p.push(I);const C=d("restoreVersionFooter");return C&&p.push(C),{evaluation:f,message:p.filter(Boolean).join(`

`),langTexts:c,fallbackTexts:u}}const lie=_o("buildRestoreVersionCompatibilityMessage",()=>(e={})=>p2(e).message),cie=_o("verifyRestoredBackupIntegrity",()=>e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)&&(e.data||e.settingsSnapshot||e.sessionSnapshot)?e:{data:e},r=p2(t),{evaluation:n,message:o,langTexts:a,fallbackTexts:i}=r,s=n.missingCore.length+n.missingStorage.length+n.missingOptional.length,l=a&&a.restoreVersionWarning||i&&i.restoreVersionWarning||"Backup created with a different version. Some features might not transfer.",c=a&&a.restoreVersionNoIssues||i&&i.restoreVersionNoIssues||"All modern data sections were found in this backup.";return s===0?{notificationType:"success",notificationMessage:c,alertMessage:""}:{notificationType:"warning",notificationMessage:l,alertMessage:o}});function mP(){const e=Qc("revertAccentColor");if(typeof e=="function")try{e()}catch(t){console.warn("Failed to revert accent color",t)}}function Iw(...e){const t=Qc("openAutoGearEditor");if(typeof t!="function"){console.warn("Auto Gear editor runtime is not available yet.");return}try{t(...e)}catch(r){console.warn("Failed to open Auto Gear editor",r)}}_o("autoGearScenarioModeSelect",null);const uie=_o("normalizeAccentValue",()=>e=>typeof e=="string"?e.trim().toLowerCase():""),fie=e=>{if(e===null||typeof e!="object"||Array.isArray(e))return!1;const t=Object.getPrototypeOf(e);return t===Object.prototype||t===null},Rt=_o("isPlainObject",()=>fie),m2=_o("applyFontSize",()=>{const e={"--page-padding":20,"--gap-size":10,"--button-size":32,"--border-radius":5,"--form-label-width":150,"--form-label-min-width":120,"--form-action-width":110},t=Object.keys(e),r={...e};let n=null;const o=()=>{if(n!==null)return;n=16;const a=typeof document<"u"&&document?document.documentElement:null;if(a)try{const i=typeof window<"u"&&window&&typeof window.getComputedStyle=="function"?window.getComputedStyle(a):null;if(!i)return;const s=parseFloat(i.fontSize);Number.isFinite(s)&&s>0&&(n=s);for(let l=0;l<t.length;l+=1){const c=t[l],u=i.getPropertyValue(c),f=parseFloat(u);Number.isFinite(f)&&f>0&&(r[c]=f)}}catch(i){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to capture base UI scale metrics",i)}};return a=>{const i=typeof document<"u"&&document?document.documentElement:null;if(!i)return;const s=Number.parseFloat(a);if(!Number.isFinite(s)||s<=0)return;o(),i.style.fontSize=`${s}px`;const l=Number.isFinite(n)&&n>0?n:s,c=l>0?s/l:1,u=Number.isFinite(c)&&c>0?c:1;for(let f=0;f<t.length;f+=1){const d=t[f],p=r[d];Number.isFinite(p)&&p>0&&i.style.setProperty(d,`${p*u}px`)}i.style.setProperty("--ui-scale",String(u))}}),g2=_o("applyFontFamily",()=>e=>{const t=typeof document<"u"&&document?document.documentElement:null;if(t)try{t.style.setProperty("--font-family",e||"")}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to apply font family",r)}}),die=_o("downloadDiagramBtn",()=>{if(typeof document>"u"||!document||typeof document.getElementById!="function")return null;try{return document.getElementById("downloadDiagram")}catch{return null}}),NA=_o("gridSnapToggleBtn",()=>{if(typeof document>"u"||!document||typeof document.getElementById!="function")return null;try{return document.getElementById("gridSnapToggle")}catch{return null}}),gP="__cineGridSnapState",y2=()=>{try{if(typeof getGridSnapState=="function")return!!getGridSnapState()}catch{}if(typeof gridSnap<"u")try{return!!gridSnap}catch{}const e=pc();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object")){try{const n=r[gP];if(typeof n=="boolean")return n}catch{}try{const n=r.gridSnap;if(typeof n=="boolean")return n}catch{}}}return!1},pie=e=>{const t=e===!0;try{if(typeof setGridSnapState=="function")return!!setGridSnapState(t)}catch{}const r=pc();for(let n=0;n<r.length;n+=1){const o=r[n];if(!(!o||typeof o!="object")){try{o[gP]=t}catch{try{Object.defineProperty(o,gP,{configurable:!0,writable:!0,value:t})}catch{}}try{o.gridSnap=t}catch{try{Object.defineProperty(o,"gridSnap",{configurable:!0,writable:!0,value:t})}catch{}}}}try{if(typeof applyLegacyGridSnapValue=="function")return!!applyLegacyGridSnapValue(t)}catch{}return t},mie=()=>{if(typeof setupDiagramContainer<"u"&&setupDiagramContainer)return setupDiagramContainer;if(typeof document<"u"&&document&&typeof document.getElementById=="function")try{return document.getElementById("diagramArea")}catch{}return null},h2=e=>{const t=mie();NA&&(NA.classList.toggle("active",e),NA.setAttribute("aria-pressed",e?"true":"false")),t&&t.classList.toggle("grid-snap",e)};h2(y2());function gie(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!e||typeof e!="object")return null;try{const t=e.cineUi;return t&&typeof t=="object"?t:null}catch{return null}}function pu(e,t){if(!e||typeof e!="object")return!1;if(typeof e.get=="function")try{return!!e.get(t)}catch{}if(typeof e.list=="function")try{const r=e.list();return Array.isArray(r)&&r.indexOf(t)!==-1}catch{}return!1}function Yx(e,t,r){if(!(!e||typeof e.register!="function"))for(let n=0;n<t.length;n+=1){const o=t[n];if(!(!o||typeof o.name!="string")&&!pu(e,o.name))try{e.register(o.name,o.value)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn(r,a)}}}function rd(){if(typeof loadStoredLogoPreview=="function")try{loadStoredLogoPreview()}catch(e){console.warn("Failed to load stored logo preview",e)}}function b2(e){if(!e||typeof e!="object")return!1;const t=e.controllers,r=e.interactions,n=e.help;return pu(t,"backupSettings")&&pu(t,"restoreSettings")&&pu(r,"performBackup")&&pu(r,"openRestorePicker")&&pu(r,"applyRestoreFile")&&pu(n,"backupSettings")&&pu(n,"restoreSettings")}let $0=b2(gie());function yie(e){const t=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;if(!t||typeof e!="function")return;try{const n=t.cineUi&&typeof t.cineUi=="object"?t.cineUi:null;if(n){e(n);return}}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("cineUi registration callback (session) failed",n);return}const r="__cineUiReadyQueue";Array.isArray(t[r])||(t[r]=[]),t[r].push(e)}yie(J2);const $r=typeof yn=="object"&&yn||(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null)||null,S2="#001589",hie="#ffffff",Pb=(()=>{if($r&&typeof $r.DEFAULT_ACCENT_COLOR=="string"){const e=$r.DEFAULT_ACCENT_COLOR.trim();if(e)return e}if($r&&typeof $r.accentColor=="string"){const e=$r.accentColor.trim();if(e)return e}return S2})(),V0=typeof Pb=="string"?Pb.toLowerCase():S2.toLowerCase(),q0=(()=>{if($r&&typeof $r.HIGH_CONTRAST_ACCENT_COLOR=="string"){const e=$r.HIGH_CONTRAST_ACCENT_COLOR.trim();if(e)return e}return hie})(),Pw=(()=>{if($r&&typeof $r.accentColor=="string"){const e=$r.accentColor.trim();if(e)return e}return Pb})(),bie=typeof DEFAULT_ACCENT_COLOR=="string"&&DEFAULT_ACCENT_COLOR.trim();if(!bie)try{DEFAULT_ACCENT_COLOR=Pb}catch{$r&&typeof $r=="object"&&($r.DEFAULT_ACCENT_COLOR=Pb)}const Sie=typeof DEFAULT_ACCENT_NORMALIZED=="string"&&DEFAULT_ACCENT_NORMALIZED;if(!Sie)try{DEFAULT_ACCENT_NORMALIZED=V0}catch{$r&&typeof $r=="object"&&($r.DEFAULT_ACCENT_NORMALIZED=V0)}const vie=typeof HIGH_CONTRAST_ACCENT_COLOR=="string"&&HIGH_CONTRAST_ACCENT_COLOR.trim();if(!vie)try{HIGH_CONTRAST_ACCENT_COLOR=q0}catch{$r&&typeof $r=="object"&&($r.HIGH_CONTRAST_ACCENT_COLOR=q0)}const Eie=typeof accentColor=="string"&&accentColor.trim();if(!Eie)try{accentColor=Pw}catch{$r&&typeof $r=="object"&&($r.accentColor=Pw)}const Aie=typeof prevAccentColor=="string"&&prevAccentColor.trim();if(!Aie)try{prevAccentColor=Pw}catch{$r&&typeof $r=="object"&&($r.prevAccentColor=Pw)}if(typeof restoringSession!="boolean")try{restoringSession=!1}catch{$r&&typeof $r=="object"&&($r.restoringSession=!1)}if(typeof filterSelectElem>"u")try{filterSelectElem=null}catch{$r&&typeof $r=="object"&&($r.filterSelectElem=null)}function _g(){if(filterSelectElem&&typeof filterSelectElem=="object"&&typeof filterSelectElem.tagName=="string")return filterSelectElem;if(typeof document>"u"||!document)return null;try{const e=document.getElementById("filter");if(e)return filterSelectElem=e,e}catch{}return filterSelectElem}function Fn(e,t=[],r={}){if(typeof callCoreFunctionIfAvailable=="function")return callCoreFunctionIfAvailable(e,t,r);const n=(typeof globalThis<"u"?globalThis:null)||(typeof window<"u"?window:null)||(typeof self<"u"?self:null)||(typeof global<"u"?global:null),o=typeof e=="string"?n&&n[e]:e;if(typeof o=="function"){try{return o.apply(n,t)}catch(a){typeof console<"u"&&typeof console.error=="function"&&console.error(`Failed to invoke ${e}`,a)}return}if(r&&r.defer===!0){const a=n&&Array.isArray(n.CORE_BOOT_QUEUE)?n.CORE_BOOT_QUEUE:null;a&&a.push(()=>{Fn(e,t,{...r,defer:!1})})}return r&&Object.prototype.hasOwnProperty.call(r,"defaultValue")?r.defaultValue:void 0}function v2(e,t={}){return _o(e,()=>{const r=(...n)=>Fn(e,n,t);try{Object.defineProperty(r,"__cineSessionProxy__",{value:!0,writable:!1,enumerable:!1})}catch{try{r.__cineSessionProxy__=!0}catch{}}return r})}const K0=["handleAutoGearImportSelection","handleAutoGearPresetSelection","handleAutoGearSavePreset","handleAutoGearDeletePreset","handleAutoGearShowBackupsToggle","handleAutoGearConditionShortcut","saveAutoGearRuleFromEditor"];for(let e=0;e<K0.length;e+=1){const t=K0[e];v2(t,{defer:!0})}const W0=["setAutoGearSummaryFocus","focusAutoGearRuleById","setAutoGearSearchQuery","setAutoGearScenarioFilter","clearAutoGearFilters"];for(let e=0;e<W0.length;e+=1){const t=W0[e];v2(t,{defer:!0})}function Y0(e,t={}){const r=Object.prototype.hasOwnProperty.call(t,"defaultValue")?t.defaultValue:"",n=Fn(e,[],{defaultValue:r});if(typeof n=="string")return n;if(n==null)return r;try{return String(n)}catch{return r}}function Cie(e){const t=e&&typeof e=="object"?{...e}:{},r=Fn("deriveProjectInfo",[e],{defaultValue:t});return r&&typeof r=="object"?r:t}const hM=typeof I0=="string"?I0:typeof k0=="function"?k0():"cameraPowerPlanner_temperatureUnit",Xi=r2();function Bb(e){return e==="fahrenheit"||e==="celsius"?e:e&&typeof e=="string"?e.toLowerCase():"celsius"}function wie(){if(Xi&&typeof Xi.temperatureUnit=="string")return Bb(Xi.temperatureUnit);try{if(typeof localStorage<"u"&&localStorage){const e=localStorage.getItem(hM);if(typeof e=="string"&&e)return Bb(e)}}catch(e){console.warn("Unable to read stored temperature unit preference",e)}return"celsius"}let Cd=wie();function Lie(){if(typeof applyTemperatureUnitPreference=="function")return applyTemperatureUnitPreference;if(Xi&&typeof Xi.applyTemperatureUnitPreference=="function")return Xi.applyTemperatureUnitPreference;if(typeof globalThis<"u")try{const e=globalThis.applyTemperatureUnitPreference;if(typeof e=="function")return e}catch{}return null}function mR(e,t={}){const r=Bb(e),n=!(t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"persist")&&t.persist===!1),o=Lie();if(o)try{o(e,t)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not apply temperature unit preference via controller",a)}try{Cd=r}catch{}if(Xi&&typeof Xi=="object")try{Xi.temperatureUnit=r}catch(a){typeof console<"u"&&typeof console.debug=="function"&&console.debug("Unable to propagate temperature unit preference to session scope",a)}if(n)try{typeof localStorage<"u"&&localStorage&&localStorage.setItem(hM,r)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Could not save temperature unit preference",a)}return r}if(Xi&&typeof Xi=="object")try{Object.defineProperty(Xi,"temperatureUnit",{configurable:!0,enumerable:!0,get(){return Cd},set(e){Cd=Bb(e)}})}catch{try{Xi.temperatureUnit=Cd}catch{}}let yP=()=>{},hP=()=>({ensured:[],skipped:[],errors:[]});try{({recordFullBackupHistoryEntry:yP,ensureCriticalStorageBackups:hP}=require("./storage.js"))}catch{typeof window<"u"&&window&&typeof window.recordFullBackupHistoryEntry=="function"&&(yP=window.recordFullBackupHistoryEntry),typeof window<"u"&&window&&typeof window.ensureCriticalStorageBackups=="function"&&(hP=window.ensureCriticalStorageBackups)}const Rie=()=>{const e=typeof document<"u"?document:null;return e?{toggleButton:e.getElementById("backupDiffToggleButton"),section:e.getElementById("backupDiffSection"),primarySelect:e.getElementById("backupDiffPrimary"),secondarySelect:e.getElementById("backupDiffSecondary"),emptyState:e.getElementById("backupDiffEmptyState"),summary:e.getElementById("backupDiffSummary"),list:e.getElementById("backupDiffList"),listContainer:e.getElementById("backupDiffListContainer"),notes:e.getElementById("backupDiffNotes"),exportButton:e.getElementById("backupDiffExport"),closeButton:e.getElementById("backupDiffClose")}:{toggleButton:null,section:null,primarySelect:null,secondarySelect:null,emptyState:null,summary:null,list:null,listContainer:null,notes:null,exportButton:null,closeButton:null}};let Gb,vi,Mm,bM,E2,Tc,_m,Dm,ks,Ws,Tie;({toggleButton:Gb,section:vi,primarySelect:Mm,secondarySelect:bM,emptyState:E2,summary:Tc,list:_m,listContainer:Dm,notes:ks,exportButton:Ws,closeButton:Tie}=Rie());function Oie(){const e=typeof document<"u"?document:null;if(!e)return{button:null,section:null,heading:null,closeButton:null,input:null,browseButton:null,fileName:null,status:null,table:null,tableBody:null,ruleSection:null,ruleHeading:null,ruleIntro:null,ruleEmpty:null,ruleList:null,actions:null,proceedButton:null,abortButton:null,modeInputs:[]};const t=[e.getElementById("restoreRehearsalModeBackup"),e.getElementById("restoreRehearsalModeProject")].filter(Boolean);return{button:e.getElementById("restoreRehearsalButton"),section:e.getElementById("restoreRehearsalSection"),heading:e.getElementById("restoreRehearsalHeading"),closeButton:e.getElementById("restoreRehearsalClose"),input:e.getElementById("restoreRehearsalInput"),browseButton:e.getElementById("restoreRehearsalBrowse"),fileName:e.getElementById("restoreRehearsalFileName"),status:e.getElementById("restoreRehearsalStatus"),table:e.getElementById("restoreRehearsalTable"),tableBody:e.getElementById("restoreRehearsalTableBody"),ruleSection:e.getElementById("restoreRehearsalRuleSection"),ruleHeading:e.getElementById("restoreRehearsalRuleHeading"),ruleIntro:e.getElementById("restoreRehearsalRuleIntro"),ruleEmpty:e.getElementById("restoreRehearsalRuleEmpty"),ruleList:e.getElementById("restoreRehearsalRuleList"),actions:e.getElementById("restoreRehearsalActions"),proceedButton:e.getElementById("restoreRehearsalProceed"),abortButton:e.getElementById("restoreRehearsalAbort"),modeInputs:t}}const{button:Q0,section:Oc,heading:Qx,closeButton:X0,input:Is,browseButton:J0,fileName:_h,status:Ci,table:vg,tableBody:xc,ruleSection:wd,ruleHeading:oye,ruleIntro:aye,ruleEmpty:jf,ruleList:Dh,actions:_u,proceedButton:Z0,abortButton:e1,modeInputs:Xx}=Oie();let el=null;function A2(){return R2.reduce((e,t)=>(e[t.key]=0,e),{})}function xie(e){return Array.isArray(e)?e.length:Rt(e)?Object.keys(e).length:typeof e=="string"&&e.trim()?1:0}function C2(e){return Rt(e)?Object.values(e).reduce((t,r)=>Array.isArray(r)?t+r.filter(Boolean).length:Rt(r)&&Array.isArray(r.entries)?t+r.entries.filter(Boolean).length:t,0):0}function Bw(e){return e==null?!1:typeof e=="string"?e.trim().length>0:typeof e=="number"?!Number.isNaN(e):typeof e=="boolean"?e:Array.isArray(e)?e.some(t=>Bw(t)):Rt(e)?Object.keys(e).some(t=>Bw(e[t])):!1}function jp(e){if(!e)return 0;if(Array.isArray(e))return e.reduce((t,r)=>t+jp(r),0);if(typeof e=="string")return e.split(/\r?\n+/).map(t=>t.trim()).filter(Boolean).length;if(Rt(e)){if(Array.isArray(e.people))return jp(e.people);if(Array.isArray(e.entries))return jp(e.entries);if(typeof e.text=="string")return jp(e.text);if(typeof e.name=="string"||typeof e.role=="string"||typeof e.phone=="string"||typeof e.email=="string"||typeof e.website=="string"||typeof e.text=="string"){const r=typeof e.name=="string"?e.name.trim():"",n=typeof e.role=="string"?e.role.trim():"",o=typeof e.phone=="string"?e.phone.trim():"",a=typeof e.email=="string"?e.email.trim():"",i=typeof e.website=="string"?e.website.trim():"",s=typeof e.text=="string"?e.text.trim():"";return r||n||o||a||i||s?1:0}const t=Object.keys(e).filter(r=>r!=="__html");if(t.length)return jp(t.map(r=>e[r]))}return 0}function rh(e){if(!e)return 0;if(Array.isArray(e))return e.reduce((t,r)=>t+rh(r),0);if(typeof e=="string")return e.split(/\r?\n+/).map(t=>t.trim()).filter(Boolean).length;if(Rt(e)){if(Array.isArray(e.entries))return rh(e.entries);if(typeof e.text=="string")return rh(e.text);if(typeof e.label=="string"||typeof e.value=="string"){const r=typeof e.label=="string"?e.label.trim():"",n=typeof e.value=="string"?e.value.trim():"";return r||n?1:0}const t=Object.keys(e).filter(r=>r!=="__html");if(t.length)return rh(t.map(r=>e[r]))}return 0}function SM(e){if(typeof e=="string")try{const a=JSON.parse(e);if(Rt(a))return SM(a)}catch{}if(!e||typeof e!="object"||Array.isArray(e)){const a=Bw(e);return{details:a?1:0,crew:0,schedule:0,hasDetails:a}}let t=0,r=0,n=0,o=!1;return Object.entries(e).forEach(([a,i])=>{if(a!=="projectName"){if(Bw(i)&&(t+=1,o=!0),a==="crew"||a==="people"){const s=jp(i);s>0&&(r+=s,o=!0)}if(a==="prepDays"||a==="shootingDays"||a==="returnDays"){const s=rh(i);s>0&&(n+=s,o=!0)}}}),{details:t,crew:r,schedule:n,hasDetails:o}}function t1(e){const t={details:0,crew:0,schedule:0,hasProjectInfo:!1};return e&&(Array.isArray(e)?e:Rt(e)?Object.values(e):[]).forEach(n=>{if(!n)return;let o=null;if(Rt(n)&&Object.prototype.hasOwnProperty.call(n,"projectInfo")?o=n.projectInfo:Rt(n)&&Rt(n.project)&&Object.prototype.hasOwnProperty.call(n.project,"projectInfo")&&(o=n.project.projectInfo),!o)return;t.hasProjectInfo||(t.hasProjectInfo=!0);const a=SM(o);a.hasDetails&&(t.hasProjectInfo=!0),t.details+=a.details,t.crew+=a.crew,t.schedule+=a.schedule}),t}function w2(e){const t=A2(),r=Rt(e)&&Rt(e.setups)?e.setups:{},n=Rt(e)&&Array.isArray(e.autoGearRules)?e.autoGearRules:[],o=Rt(e)&&Rt(e.favorites)?e.favorites:{},a=Rt(e)?t1(e.project):{details:0,crew:0,schedule:0},i=t1(r),s=Math.max(a.details,i.details),l=Math.max(a.crew,i.crew),c=Math.max(a.schedule,i.schedule);t.projects=xie(r),t.projectDetails=s,t.projectCrew=l,t.projectSchedules=c,t.rules=n.length,t.favorites=C2(o),t.deviceLibrary=Yie(Rt(e)?e.devices:null);const u=Rt(e)?e.session:null;t.sessionSnapshots=Rt(u)&&Object.keys(u).length?1:0,t.feedbackDrafts=Qie(Rt(e)?e.feedback:null),t.autoGearPresets=Array.isArray(e?.autoGearPresets)?e.autoGearPresets.filter(Boolean).length:0,t.autoGearBackups=Array.isArray(e?.autoGearBackups)?e.autoGearBackups.filter(Boolean).length:0,t.fullBackupHistory=Array.isArray(e?.fullBackupHistory)?e.fullBackupHistory.filter(Boolean).length:0,t.customFonts=Array.isArray(e?.customFonts)?e.customFonts.filter(p=>p?typeof p=="string"?p.trim().length>0:Rt(p)?Object.keys(p).length>0:!1:!1).length:0,t.customLogo=typeof e?.customLogo=="string"&&e.customLogo.trim()?1:0;const f=Rt(e?.preferences)?e.preferences:null;t.storedPreferences=f&&Object.keys(f).length?1:0;const d=e?.schemaCache;return typeof d=="string"?t.schemaCache=d.trim()?1:0:Rt(d)&&(t.schemaCache=Object.keys(d).length?1:0),t}function L2(e){return Rt(e)?!!(typeof e.setupName=="string"&&e.setupName.trim()||typeof e.projectHtml=="string"&&e.projectHtml.trim()||typeof e.gearList=="string"&&e.gearList.trim()||Rt(e.projectInfo)&&Object.keys(e.projectInfo).length||Rt(e.gearSelectors)&&Object.keys(e.gearSelectors).length||["camera","monitor","video","cage","distance","batteryPlate","battery","batteryHotswap"].some(r=>typeof e[r]=="string"&&e[r].trim())||Array.isArray(e.motors)&&e.motors.some(Boolean)||Array.isArray(e.controllers)&&e.controllers.some(Boolean)):!1}const r1=["data","payload","plannerData","allData","devices","setups","session","sessions","sessionStorage","sessionState","customLogo","customFonts","preferences","schemaCache","fullBackupHistory"],R2=[{key:"projects",translationKey:"restoreRehearsalMetricProjects",fallback:"Projects",modes:["backup","project"]},{key:"projectDetails",translationKey:"restoreRehearsalMetricProjectDetails",fallback:"Project details",modes:["backup","project"]},{key:"projectCrew",translationKey:"restoreRehearsalMetricCrew",fallback:"Crew entries",modes:["backup","project"]},{key:"projectSchedules",translationKey:"restoreRehearsalMetricSchedule",fallback:"Schedule entries",modes:["backup","project"]},{key:"rules",translationKey:"restoreRehearsalMetricRules",fallback:"Rules",modes:["backup","project"]},{key:"favorites",translationKey:"restoreRehearsalMetricFavorites",fallback:"Favorites",modes:["backup","project"]},{key:"deviceLibrary",translationKey:"restoreRehearsalMetricDeviceLibrary",fallback:"Device library entries",modes:["backup"]},{key:"sessionSnapshots",translationKey:"restoreRehearsalMetricSession",fallback:"Stored session snapshot",modes:["backup"]},{key:"feedbackDrafts",translationKey:"restoreRehearsalMetricFeedback",fallback:"Feedback drafts",modes:["backup"]},{key:"autoGearPresets",translationKey:"restoreRehearsalMetricAutoPresets",fallback:"Automatic gear presets",modes:["backup"]},{key:"autoGearBackups",translationKey:"restoreRehearsalMetricAutoBackups",fallback:"Automatic gear backups",modes:["backup"]},{key:"fullBackupHistory",translationKey:"restoreRehearsalMetricBackupHistory",fallback:"Backup history entries",modes:["backup"]},{key:"customFonts",translationKey:"restoreRehearsalMetricCustomFonts",fallback:"Custom fonts",modes:["backup"]},{key:"customLogo",translationKey:"restoreRehearsalMetricCustomLogo",fallback:"Custom logo saved",modes:["backup"]},{key:"storedPreferences",translationKey:"restoreRehearsalMetricPreferences",fallback:"Stored preferences",modes:["backup"]},{key:"schemaCache",translationKey:"restoreRehearsalMetricSchemaCache",fallback:"Device schema cache",modes:["backup"]}],n1=["setupName","camera","monitor","video","cage","distance","batteryPlate","battery","batteryHotswap","motors","controllers","project","projectInfo","projectHtml","gearList","gearSelectors","autoGearRules","favorites","feedback","changedDevices"];function Gw(e,t){if(!Rt(e))return!1;for(let r=0;r<t.length;r+=1){const n=t[r];if(Object.prototype.hasOwnProperty.call(e,n))return!0}return!1}function kie(e){if(!Rt(e))return!1;if(L2(e)||Gw(e,n1))return!0;const t=Rt(e.project)?e.project:null;return!!Gw(t,n1)}function Iie(e){if(!Rt(e))return!1;if(Gw(e,r1))return!0;const t=["data","payload","plannerData","allData"];for(let r=0;r<t.length;r+=1){const n=t[r];if(Gw(e[n],r1))return!0}return!1}function Pie(e){const t=A2();if(!Rt(e))return t;const r=Rt(e.favorites)?e.favorites:{};let n=null;Rt(e.projectInfo)||typeof e.projectInfo=="string"?n=e.projectInfo:Rt(e.project)&&(Rt(e.project.projectInfo)||typeof e.project.projectInfo=="string")&&(n=e.project.projectInfo);const o=SM(n);return t.projects=L2(e)?1:0,t.projectDetails=o.details,t.projectCrew=o.crew,t.projectSchedules=o.schedule,t.rules=Array.isArray(e.autoGearRules)?e.autoGearRules.length:0,t.favorites=C2(r),t}function Bie(){if(!Array.isArray(Xx)||!Xx.length)return"backup";const e=Xx.find(t=>t&&t.checked);return e&&typeof e.value=="string"?e.value:"backup"}function Gie(e,t,r={}){const n=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",o=texts[n]||texts.en||{},a=typeof r.mode=="string"?r.mode:"backup";return R2.filter(s=>s.modes.includes(a)).map(s=>({key:s.key,label:o[s.translationKey]||s.fallback})).map(s=>{const l=typeof e[s.key]=="number"?e[s.key]:0,c=typeof t[s.key]=="number"?t[s.key]:0;return{key:s.key,label:s.label,live:l,sandbox:c,diff:c-l}})}function Mie(e){if(typeof e!="string")return"all";const t=e.trim().toLowerCase();return t?t==="any"||t==="or"?"any":t==="multiplier"||t==="multiply"?"multiplier":"all":"all"}function _ie(e){if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=e.trim();if(t){const r=Number(t);if(Number.isFinite(r))return r}}return 1}function o1(e){if(!Array.isArray(e))return[];const t=e.map(r=>{if(!Rt(r))return null;const n=typeof r.name=="string"?r.name.trim():"";if(!n)return null;const o=typeof r.category=="string"?r.category.trim():"";let a=1;if(typeof r.quantity=="number"&&Number.isFinite(r.quantity))a=r.quantity;else if(typeof r.quantity=="string"){const h=r.quantity.trim();if(h){const m=Number(h);Number.isFinite(m)&&(a=m)}}const i=typeof r.notes=="string"?r.notes.trim():"",s=typeof r.screenSize=="string"?r.screenSize.trim():"",l=typeof r.selectorType=="string"?r.selectorType.trim():"",c=typeof r.selectorDefault=="string"?r.selectorDefault.trim():"",u=!!r.selectorEnabled,f=Array.isArray(r.contextNotes)?r.contextNotes.map(h=>typeof h=="string"?h.trim():"").filter(Boolean):[];f.sort((h,m)=>h.localeCompare(m));const d={id:typeof r.id=="string"?r.id:"",name:n,category:o,quantity:a,notes:i,screenSize:s,selectorType:l,selectorDefault:c,selectorEnabled:u,contextNotes:f},p={name:n,category:o,quantity:a,notes:i,screenSize:s,selectorType:l,selectorDefault:c,selectorEnabled:u,contextNotes:f};return d.signature=JSON.stringify(p),d}).filter(Boolean);return t.sort((r,n)=>{const o=r.category||"",a=n.category||"";return o!==a?o.localeCompare(a):r.name.localeCompare(n.name)}),t}function a1(e){if(!e)return"";const t=e.quantity,n=t!=null&&t!==1?` ${Vd(t)}`:"",o=e.category?` (${e.category})`:"",a=e.notes?`  ${e.notes}`:"",i=Array.isArray(e.contextNotes)&&e.contextNotes.length?` (${e.contextNotes.join(", ")})`:"",s=e.screenSize?` [${e.screenSize}]`:"",l=[];e.selectorType&&e.selectorType!=="none"&&l.push(e.selectorType),e.selectorDefault&&l.push(e.selectorDefault);const c=l.length?` {${l.join(": ")}}`:"";return`${e.name}${o}${n}${a}${i}${s}${c}`}function Die(e,t,r){if(!Rt(e))return null;const n={id:typeof e.id=="string"?e.id:"",label:typeof e.label=="string"?e.label.trim():"",always:!!e.always};n.scenarioLogic=Mie(e.scenarioLogic),n.scenarioMultiplier=_ie(e.scenarioMultiplier),n.scenarioLogic!=="multiplier"&&(n.scenarioMultiplier=1),n.scenarioPrimary=typeof e.scenarioPrimary=="string"?e.scenarioPrimary.trim():"";const o=Array.isArray(e.scenarios)?e.scenarios.map(u=>typeof u=="string"?u.trim():"").filter(Boolean):[],a=new Set(o);n.scenarios=Array.from(a).sort((u,f)=>u.localeCompare(f)),n.addItems=o1(e.add),n.removeItems=o1(e.remove);const i=n.addItems.map(u=>u.signature).sort(),s=n.removeItems.map(u=>u.signature).sort();n.signature=JSON.stringify({always:n.always,scenarioLogic:n.scenarioLogic,scenarioPrimary:n.scenarioPrimary,scenarioMultiplier:n.scenarioMultiplier,scenarios:n.scenarios,add:i,remove:s});const c=[n.label.toLowerCase(),n.scenarios.join("|").toLowerCase(),n.addItems.map(u=>u.name.toLowerCase()).join("|"),n.removeItems.map(u=>u.name.toLowerCase()).join("|")].filter(Boolean).join("::");return n.matchKey=n.id?`id:${n.id}`:c?`fallback:${c}`:`index:${r}:${t}`,n.entryKey=`${n.matchKey}|${r}|${t}`,n.label?n.displayName=n.label:n.scenarios.length?n.displayName=n.scenarios.join(" + "):n.id?n.displayName=n.id:n.displayName=`Rule ${t+1}`,n}function bP(e,t="sandbox"){return Array.isArray(e)?e.map((r,n)=>Die(r,n,t)).filter(Boolean):[]}function Nie(e){const t=new Map;return Array.isArray(e)&&e.forEach(r=>{if(!r||!r.matchKey)return;const n=t.get(r.matchKey);n?n.push(r):t.set(r.matchKey,[r])}),t}function Fie(e,t){const r=Array.isArray(e)?e:[],n=Array.isArray(t)?t:[],o=Nie(r),a=new Set(r.filter(Boolean)),i=[];n.forEach(c=>{if(!c)return;let u=null;const f=c.matchKey?o.get(c.matchKey):null;f&&f.length&&(u=f.shift(),f.length||o.delete(c.matchKey)),u?(a.delete(u),u.signature!==c.signature&&i.push({status:"changed",label:c.displayName||u.displayName,live:u,sandbox:c,key:`changed:${c.entryKey}`})):i.push({status:"added",label:c.displayName,live:null,sandbox:c,key:`added:${c.entryKey}`})}),a.forEach(c=>{c&&i.push({status:"removed",label:c.displayName,live:c,sandbox:null,key:`removed:${c.entryKey}`})});const s=typeof localeSort=="function"?(c,u)=>localeSort(c,u):(c,u)=>c.localeCompare(u),l={changed:0,removed:1,added:2};return i.sort((c,u)=>{const f=l[c.status]??Number.MAX_SAFE_INTEGER,d=l[u.status]??Number.MAX_SAFE_INTEGER;return f!==d?f-d:s(c.label||"",u.label||"")})}function jie(e,t){if(!e)return[];const r=texts.en||{},n=t.restoreRehearsalRuleLogicLabel||r.restoreRehearsalRuleLogicLabel||"Scenario logic",o=t.restoreRehearsalRuleBaseLabel||r.restoreRehearsalRuleBaseLabel||"Base scenario",a=t.restoreRehearsalRuleMultiplierLabel||r.restoreRehearsalRuleMultiplierLabel||"Multiplier",i=t.restoreRehearsalRuleRequiredLabel||texts[currentLang]?.projectFields?.requiredScenarios||r.projectFields?.requiredScenarios||"Required scenarios",s=t.restoreRehearsalRuleAlwaysLabel||r.restoreRehearsalRuleAlwaysLabel||"Always active",l=t.restoreRehearsalRuleNone||r.restoreRehearsalRuleNone||"None";let c=r.autoGearScenarioModeAll||"Require every selected scenario";e.scenarioLogic==="any"?c=texts[currentLang]?.autoGearScenarioModeAny||r.autoGearScenarioModeAny||"Match any selected scenario":e.scenarioLogic==="multiplier"?c=texts[currentLang]?.autoGearScenarioModeMultiplier||r.autoGearScenarioModeMultiplier||"Multiply when combined":c=texts[currentLang]?.autoGearScenarioModeAll||r.autoGearScenarioModeAll||"Require every selected scenario";const u=[`${n}: ${c}`];return e.scenarioPrimary&&u.push(`${o}: ${e.scenarioPrimary}`),e.scenarioLogic==="multiplier"&&e.scenarioMultiplier!==1&&u.push(`${a}: ${Vd(e.scenarioMultiplier)}`),e.scenarios&&e.scenarios.length?u.push(`${i}: ${e.scenarios.join(" + ")}`):u.push(`${i}: ${l}`),e.always&&u.push(s),u}function Hie(e,t){const r=document.createElement("ul");r.className="restore-rehearsal-rule-list";const n=Array.isArray(e)?e.filter(o=>typeof o=="string"&&o.trim()):[];if(!n.length){const o=document.createElement("li");return o.textContent=t,r.appendChild(o),r}return n.forEach(o=>{const a=document.createElement("li");a.textContent=o,r.appendChild(a)}),r}function Jx(e,t,r){const n=document.createElement("div");n.className="restore-rehearsal-rule-section";const o=document.createElement("span");return o.className="restore-rehearsal-rule-section-label",o.textContent=e,n.appendChild(o),n.appendChild(Hie(t,r)),n}function i1(e,t,r,n,o){const a=document.createElement("div");a.className="restore-rehearsal-rule-column",r&&a.classList.add(`restore-rehearsal-rule-column--${r}`);const i=document.createElement("div");i.className="restore-rehearsal-rule-column-title",i.textContent=e,a.appendChild(i);const s=t?t.addItems.map(u=>a1(u)).filter(Boolean):[];a.appendChild(Jx(n.restoreRehearsalRuleAddsLabel||texts.en?.restoreRehearsalRuleAddsLabel||"Automatic additions",s,o));const l=t?t.removeItems.map(u=>a1(u)).filter(Boolean):[];a.appendChild(Jx(n.restoreRehearsalRuleRemovesLabel||texts.en?.restoreRehearsalRuleRemovesLabel||"Automatic removals",l,o));const c=jie(t,n);return a.appendChild(Jx(n.restoreRehearsalRuleScenariosLabel||texts.en?.restoreRehearsalRuleScenariosLabel||"Scenario scope",c,o)),a}function Uie(e){if(!wd||!Dh||!jf)return;const t=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",r=texts[t]||texts.en||{};if(Dh.innerHTML="",!(Array.isArray(e)&&e.length>0)){jf&&(jf.textContent=r.restoreRehearsalRuleEmpty||texts.en?.restoreRehearsalRuleEmpty||"No automatic gear rule differences found.",jf.removeAttribute("hidden")),wd.removeAttribute("hidden"),_u&&_u.removeAttribute("hidden");return}jf.setAttribute("hidden","");const o=r.restoreRehearsalLiveColumn||texts.en?.restoreRehearsalLiveColumn||"Live profile",a=r.restoreRehearsalSandboxColumn||texts.en?.restoreRehearsalSandboxColumn||"Sandbox import",i=r.restoreRehearsalRuleNone||texts.en?.restoreRehearsalRuleNone||"None";e.forEach(s=>{if(!s)return;const l=document.createElement("li"),c=s.status?` diff-${s.status}`:"";l.className=`diff-entry${c}`;const u=document.createElement("div");u.className="diff-entry-header";const f=document.createElement("div");f.className="diff-path";const d=s.label||s.sandbox?.displayName||s.live?.displayName||r.restoreRehearsalRuleFallback||texts.en?.restoreRehearsalRuleFallback||"Automatic rule change";f.textContent=d,u.appendChild(f),u.appendChild(V2(s.status||"changed")),l.appendChild(u);const p=document.createElement("div");if(p.className="restore-rehearsal-rule-columns",s.status==="changed"&&p.classList.add("restore-rehearsal-rule-columns--split"),s.live){const h=s.status==="added"?null:"removed";p.appendChild(i1(o,s.live,h,r,i))}if(s.sandbox){const h=s.status==="removed"?null:"added";p.appendChild(i1(a,s.sandbox,h,r,i))}l.appendChild(p),Dh.appendChild(l)}),wd.removeAttribute("hidden"),_u&&_u.removeAttribute("hidden")}function zie(){const e=typeof exportAllData=="function"?exportAllData():{},t=Rt(e)?e:{};return{counts:w2(t),rules:bP(t.autoGearRules,"live")}}function gR(e={}){const{keepStatus:t=!1}=e||{};if(_h){const r=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",n=texts.en?.restoreRehearsalNoFile||"No file selected yet.",o=texts[r]?.restoreRehearsalNoFile||n;_h.textContent=o}if(!t&&Ci){const r=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",n=texts.en?.restoreRehearsalReady||"";Ci.textContent=texts[r]?.restoreRehearsalReady||n}if(vg&&vg.setAttribute("hidden",""),xc)for(;xc.firstChild;)xc.removeChild(xc.firstChild);wd&&wd.setAttribute("hidden",""),Dh&&(Dh.innerHTML=""),jf&&jf.setAttribute("hidden",""),_u&&_u.setAttribute("hidden",""),el=null,Is&&(Is.value="")}function SP(){Oc&&(Oc.removeAttribute("hidden"),gR(),Qx&&typeof Qx.focus=="function"&&Qx.focus({preventScroll:!0}))}function $ie(){gR(),Oc&&Oc.setAttribute("hidden","")}function Vie(e){return e?typeof e.text=="function"?Promise.resolve().then(()=>e.text()):new Promise((t,r)=>{if(typeof FileReader!="function"){r(new Error("No supported file reader available"));return}const n=new FileReader;n.onload=()=>t(n.result),n.onerror=()=>r(n.error||new Error("Failed to read file"));try{n.readAsText(e)}catch(o){r(o)}}):Promise.reject(new Error("No file provided"))}function qie(e){const t=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",r=texts[t]||texts.en||{},n=r.restoreRehearsalDifferenceListJoin||", ",o=e.filter(i=>i.diff!==0).map(i=>`${i.label} (${i.diff>0?"+":""}${Math.abs(i.diff)})`);return o.length?(r.restoreRehearsalMismatch||texts.en?.restoreRehearsalMismatch||"Differences detected: %s. The sandbox was cleared automatically.").replace("%s",o.join(n)):r.restoreRehearsalMatch||texts.en?.restoreRehearsalMatch||"All counts match. The sandbox was cleared automatically."}function Kie(e,t,r){if(!e)return;const n=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",o=texts[n]||texts.en||{};if(e.textContent="",e.classList.remove("restore-rehearsal-diff-match","restore-rehearsal-diff-positive","restore-rehearsal-diff-negative"),r===0){const l=o.restoreRehearsalMatchLabel||texts.en?.restoreRehearsalMatchLabel||"Match";e.textContent=l,e.classList.add("restore-rehearsal-diff-match"),e.setAttribute("aria-label",`${t} ${l}`);return}const a=Math.abs(r),i=r>0?o.restoreRehearsalIncreaseLabel||texts.en?.restoreRehearsalIncreaseLabel||"Sandbox includes %d more %s.":o.restoreRehearsalDecreaseLabel||texts.en?.restoreRehearsalDecreaseLabel||"Sandbox includes %d fewer %s.",s=`${r>0?"+":""}${a}`;e.textContent=s,e.setAttribute("aria-label",i.replace("%d",a).replace("%s",t)),e.classList.add(r>0?"restore-rehearsal-diff-positive":"restore-rehearsal-diff-negative")}function Wie(e,t){if(!(!xc||!Ci)){for(;xc.firstChild;)xc.removeChild(xc.firstChild);e.forEach(r=>{const n=document.createElement("tr"),o=document.createElement("th");o.scope="row",o.textContent=r.label,n.appendChild(o);const a=document.createElement("td");a.textContent=String(r.live),n.appendChild(a);const i=document.createElement("td");i.textContent=String(r.sandbox),n.appendChild(i);const s=document.createElement("td");Kie(s,r.label,r.diff),n.appendChild(s),xc.appendChild(n)}),vg&&vg.removeAttribute("hidden"),Ci.textContent=qie(e),Uie(Array.isArray(t)?t:[])}}function Yie(e){if(typeof countDeviceDatabaseEntries=="function")try{const o=countDeviceDatabaseEntries(e);if(typeof o=="number"&&Number.isFinite(o))return o}catch(o){console.warn("Primary device counting failed during restore rehearsal",o)}const t=new Set(["filterOptions","None"]),r=o=>Rt(o)?Object.values(o).some(a=>a===null||typeof a!="object"||Array.isArray(a)):!1,n=o=>{if(!Rt(o))return 0;let a=0;return Object.entries(o).forEach(([i,s])=>{if(!(!i||t.has(i))){if(r(s)){a+=1;return}a+=n(s)}}),a};return n(e)}function Qie(e){return Rt(e)?Object.values(e).reduce((t,r)=>r?Array.isArray(r)?t+r.filter(Boolean).length:typeof r=="string"?r.trim()?t+1:t:Rt(r)?Object.keys(r).length?t+1:t:t+1:t,0):0}function Xie(e){if(!e)return;const t=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",r=texts[t]||texts.en||{};if(Ci){const n=r.restoreRehearsalProcessing||texts.en?.restoreRehearsalProcessing||"Loading file in an isolated sandbox";Ci.textContent=n}Vie(e).then(n=>{const o=Bie();let a,i=[];if(o==="project"){const d=sanitizeBackupPayload(n);if(!d||!d.trim()){const h=new Error("Restore rehearsal received an empty project bundle.");throw h.code="restore-rehearsal-project-mismatch",h}const p=JSON.parse(d);if(!kie(p)){const h=new Error("Restore rehearsal received an unrecognized project bundle.");throw h.code="restore-rehearsal-project-mismatch",h}a=Pie(p),i=bP(p.autoGearRules,"sandbox")}else{const d=sanitizeBackupPayload(n);if(!d||!d.trim())throw new Error("Backup payload empty");const p=JSON.parse(d);if(!Iie(p)){const g=new Error("Restore rehearsal received an unrecognized backup payload.");throw g.code="restore-rehearsal-backup-mismatch",g}const{data:h}=extractBackupSections(p),m=Rt(h)?h:{};a=w2(m),i=bP(m.autoGearRules,"sandbox")}const s=zie(),l=s&&Rt(s.counts)?s.counts:{},c=s&&Array.isArray(s.rules)?s.rules:[],u=Gie(l,a,{mode:o}),f=Fie(c,i);Wie(u,f),el={fileName:typeof e.name=="string"?e.name:"",mode:o,processedAt:Date.now(),live:{counts:l,rules:c},sandbox:{counts:a,rules:i},diff:f},Is&&(Is.value="")}).catch(n=>{if(console.warn("Restore rehearsal failed",n),el=null,Ci){let o;n&&n.code==="restore-rehearsal-project-mismatch"?o=r.restoreRehearsalProjectMismatch||texts.en?.restoreRehearsalProjectMismatch:n&&n.code==="restore-rehearsal-backup-mismatch"&&(o=r.restoreRehearsalBackupMismatch||texts.en?.restoreRehearsalBackupMismatch),o||(o=r.restoreRehearsalError||texts.en?.restoreRehearsalError||"Restore rehearsal failed. Check the file and try again."),Ci.textContent=o}vg&&vg.setAttribute("hidden",""),wd&&wd.setAttribute("hidden",""),_u&&_u.setAttribute("hidden","")}).finally(()=>{if(Is)try{Is.value=""}catch{}})}function Jie(){const e=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",t=texts[e]||texts.en||{};if(!el){if(Ci){const n=t.restoreRehearsalReady||texts.en?.restoreRehearsalReady||"";Ci.textContent=n}return}const r=t.restoreRehearsalProceedMessage||texts.en?.restoreRehearsalProceedMessage||"Sandbox snapshot staged. Live data remains untouched until you perform a full restore.";if(Ci&&(Ci.textContent=r),typeof document<"u"&&typeof document.dispatchEvent=="function")try{document.dispatchEvent(new CustomEvent("restoreRehearsalProceed",{detail:{fileName:el.fileName,mode:el.mode,processedAt:el.processedAt,sandboxCounts:el.sandbox?.counts||{},ruleChanges:Array.isArray(el.diff)?el.diff.length:0}}))}catch(n){console.warn("Restore rehearsal proceed notification failed",n)}}function Zie(){const e=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",r=(texts[e]||texts.en||{}).restoreRehearsalAbortMessage||texts.en?.restoreRehearsalAbortMessage||"Rehearsal sandbox cleared. Live data remains untouched.";el=null,gR({keepStatus:!0}),Ci&&(Ci.textContent=r)}function Ji(e={}){if(restoringSession||ef||typeof window<"u"&&window.cineSuppressAutosave||typeof isProjectPersistenceSuspended=="function"&&isProjectPersistenceSuspended())return;const t=Gs?collectProjectFormData():{};t.sliderBowl=Y0("getSliderBowlValue"),t.easyrig=Y0("getEasyrigValue"),_r=Cie(t);const r=batterySelect?batterySelect.value:"",n=xa?xa.value:"",o={setupName:Kt?Kt.value:"",setupSelect:ur?ur.value:"",camera:Ri?Ri.value:"",monitor:Wa?Wa.value:"",video:videoSelect?videoSelect.value:"",cage:cageSelect?cageSelect.value:"",motors:(typeof window<"u"&&window.motorSelects?window.motorSelects:[]).map(a=>a?a.value:""),controllers:(typeof window<"u"&&window.controllerSelects?window.controllerSelects:[]).map(a=>a?a.value:""),distance:distanceSelect?distanceSelect.value:"",batteryPlate:typeof normalizeBatteryPlateValue=="function"?normalizeBatteryPlateValue(n,r):n,battery:r,batteryHotswap:Ti?Ti.value:"",sliderBowl:t.sliderBowl,easyrig:t.easyrig,projectInfo:_r,autoGearHighlight:typeof isAutoGearHighlightEnabled=="function"?!!isAutoGearHighlightEnabled():!1};if(typeof getDiagramManualPositions=="function"){const a=getDiagramManualPositions();a&&Object.keys(a).length&&(o.diagramPositions=a)}storeSession(o),e.skipGearList||saveCurrentGearList()}function vP(){if(console.log("DEBUG: autoSaveCurrentSetup ENTERED"),ef)return;const e=typeof Kt<"u"?Kt:document.getElementById("setupName");if(!e)return;const t=e.value.trim();if(!t)return Ji({skipGearList:!0}),Qi(),!1;const r=typeof ur<"u"?ur:document.getElementById("setupSelect"),n=r?r.value:"";if(!n||t!==n)return Ji({skipGearList:!0}),Qi(),!1;const o=typeof getSetups=="function"?getSetups():{};if(!o||typeof o!="object"||!Object.prototype.hasOwnProperty.call(o,t))return Ji({skipGearList:!0}),Qi(),!1;const a=o&&typeof o=="object"?o[t]:void 0,i=a?stableStringify(a):"",s={...getCurrentSetupState()},l=getCurrentGearListHtml();if(l&&(s.gearList=l),typeof getDiagramManualPositions=="function"){const f=getDiagramManualPositions();f&&Object.keys(f).length?s.diagramPositions=f:Object.prototype.hasOwnProperty.call(s,"diagramPositions")&&delete s.diagramPositions}const c=!a||i==="";o[t]=s,console.log("DEBUG: calling storeSetups"),storeSetups(o),c&&(console.log("DEBUG: calling populateSetupSelect"),typeof populateSetupSelect=="function"&&populateSetupSelect(),console.log("DEBUG: populateSetupSelect returned")),r&&(r.value=t),Ji(),typeof storeLoadedSetupState=="function"&&storeLoadedSetupState(getCurrentSetupState()),Qi();const u=stableStringify(s);return i!==u}const s1=300,ese=900,tse=5e3,l1=4;let jn=null,Zp=0,Mc=null,ef=!1,EP=null;function vM(e){try{const t=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:null,r=t&&typeof t.__cineNoteAutoBackupChange=="function"?t.__cineNoteAutoBackupChange:null;r&&r(e||{})}catch(t){console.warn("Failed to record auto backup change context",t)}}function rse(e){if(!e||typeof e!="object")return;const t={};if(e.setupNameState&&typeof e.setupNameState=="object"){const r=e.setupNameState,n=typeof r.typedName=="string"?r.typedName:"",o=typeof r.selectedName=="string"?r.selectedName:"",a=typeof r.storageKey=="string"?r.storageKey:"",i=typeof r.renameInProgress=="boolean"?r.renameInProgress:!!(o&&n&&n!==o),s=!!(n&&r&&typeof r.typedNameHasTrailingWhitespace=="boolean"&&r.typedNameHasTrailingWhitespace);t.setupNameState={typedName:n,selectedName:o,storageKey:a,renameInProgress:i,typedNameHasTrailingWhitespace:s}}t.setupNameState}function nse(){if(Zp<=0)return s1;const e=s1+ese*(Zp-1);return Math.min(e,tse)}function c1(){console.log("DEBUG: runProjectAutoSave ENTERED"),Ad=!0;try{if(ef){jn&&(clearTimeout(jn),jn=null);return}if(restoringSession){jn=null,Mc!=="immediate"&&(Mc=Mc||"queued");return}jn=null,Mc=null;const e=EP;EP=null;let t=!1;const r=(s,l,c)=>{if(typeof s!="function")return{ok:!0,result:void 0};try{const u=s();if(typeof c=="function")try{c(u)}catch(f){console.warn("Auto backup mutation observer callback failed",f)}return{ok:!0,result:u}}catch(u){return t=!0,console.error(`Project autosave failed while ${l}.`,u),{ok:!1,result:void 0}}};let n=!1,o=!1;if(Kt&&typeof Kt.value=="string"&&Kt.value.trim()||r(()=>Ji(),"saving the current session state"),r(vP,"saving the current setup",s=>{s===!0&&(n=!0)}).ok||r(()=>Ji({skipGearList:!0}),"saving the current session state as a fallback"),r(saveCurrentGearList,"saving the gear list",s=>{s===!0&&(o=!0)}),t){Zp<l1?(Zp+=1,Mb()):Zp===l1&&console.warn("Project autosave retries have been paused after repeated failures.");return}if(Zp=0,!t&&(n||o)){const s=Date.now(),l=e&&typeof e.requestedAt=="number"&&Number.isFinite(e.requestedAt)?e.requestedAt:s;vM({commit:!0,context:{immediate:!!(e&&e.immediate),overrides:!!(e&&e.overrides),requestedAt:l,completedAt:s}})}}finally{Ad=!1}}function Mb(e=!1){if(Ad||typeof window<"u"&&window.cineSuppressAutosave)return;let t=!1,r;typeof e=="object"&&e!==null?(t=!!e.immediate,r=e.overrides):(t=!!e,r=void 0);const n=r!==void 0;if(n&&rse(r),ef){jn&&(clearTimeout(jn),jn=null);return}if(restoringSession){jn&&(clearTimeout(jn),jn=null),Mc!=="immediate"&&(Mc=t?"immediate":"queued");return}Mc=null;const o=Date.now();if(EP={immediate:t,overrides:n,requestedAt:o},vM({immediate:t,overrides:n,pending:!0}),t){jn&&(clearTimeout(jn),jn=null),console.log("DEBUG: scheduleProjectAutoSave calling runProjectAutoSave"),c1(),console.log("DEBUG: scheduleProjectAutoSave executed runProjectAutoSave");return}jn&&clearTimeout(jn);const a=nse();jn=setTimeout(c1,a),jn&&typeof jn=="object"&&typeof jn.unref=="function"&&jn.unref()}var Ey=typeof Gs<"u"&&Gs?Gs:typeof document<"u"?document.getElementById("projectForm"):null;if(Ey){const e=(a,i)=>{const s=u=>{if(!u||typeof u!="object")return null;if(typeof u.closest=="function")return u.closest("select");let f=u.parentElement;for(;f&&f.tagName!=="SELECT";)f=f.parentElement;return f&&f.tagName==="SELECT"?f:null},l=u=>u&&typeof u=="object"&&u.tagName==="OPTION"&&s(u)===i;if(l(a.target))return a.target;if(typeof a.composedPath=="function"){const u=a.composedPath().find(l);if(u)return u}if(a.target&&typeof a.target.closest=="function"){const u=a.target.closest("option");if(l(u))return u}const c=a.type&&a.type.startsWith("touch")&&a.touches&&a.touches[0]?{x:a.touches[0].clientX,y:a.touches[0].clientY}:typeof a.clientX=="number"&&typeof a.clientY=="number"?{x:a.clientX,y:a.clientY}:null;if(c&&typeof document<"u"&&typeof document.elementFromPoint=="function"){const u=document.elementFromPoint(c.x,c.y);if(l(u))return u;if(u&&typeof u.closest=="function"){const f=u.closest("option");if(l(f))return f}}return null},t=a=>{if(!a)return;const i=l=>{if(typeof l.button=="number"&&l.button!==0)return;const c=e(l,a);if(!c||c.disabled)return;l.preventDefault();const u=a.scrollTop,f=!c.selected;c.selected=f,f?c.setAttribute("selected",""):c.removeAttribute("selected");const d=new Event("change",{bubbles:!0});if(a.dispatchEvent(d),typeof a.focus=="function")try{a.focus({preventScroll:!0})}catch{a.focus()}a.scrollTop=u};typeof window<"u"&&typeof window.PointerEvent=="function"?a.addEventListener("pointerdown",i):(a.addEventListener("mousedown",i),a.addEventListener("touchstart",l=>{i(l)},{passive:!1})),a.addEventListener("dblclick",l=>{l.preventDefault()})};Ey.querySelectorAll("select[multiple]").forEach(a=>{t(a)});const r=a=>{if(!a)return;const i=typeof updateSelectIconBoxes=="function"?updateSelectIconBoxes:null,s=typeof globalThis<"u"&&globalThis&&typeof globalThis.updateSelectIconBoxes=="function"?globalThis.updateSelectIconBoxes:null,l=i||s;if(typeof l=="function")try{l(a)}catch(c){typeof console<"u"&&typeof console.warn=="function"&&console.warn("updateSelectIconBoxes handler failed",c)}};Ey.querySelectorAll("select").forEach(a=>{const i=()=>r(a);a.addEventListener("change",i),i()});const n=()=>{typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty()},o=a=>{typeof window<"u"&&window.cineSuppressAutosave||(n(),Mb())};Ey.addEventListener("input",o),Ey.addEventListener("change",o)}function no(e,t){if(!e||t===void 0)return;const r=t===null?"":t;if(e.value=r,e.value!==r){r!==""?e.dataset.pendingValue=r:e.dataset.pendingValue&&delete e.dataset.pendingValue;const n=Array.from(e.options||[]),o=n.find(a=>a.value==="None");r===""&&!n.length?e.value="":o?e.value="None":e.selectedIndex=-1}else e.dataset.pendingValue&&delete e.dataset.pendingValue;typeof updateFavoriteButton=="function"?updateFavoriteButton(e):typeof EE=="function"&&EE(()=>{typeof updateFavoriteButton=="function"&&updateFavoriteButton(e)}),e===Ri&&typeof callCoreFunctionIfAvailable=="function"&&callCoreFunctionIfAvailable("updateRecordingMediaOptions"),typeof adjustGearListSelectWidth=="function"?adjustGearListSelectWidth(e):typeof EE=="function"&&EE(()=>{typeof adjustGearListSelectWidth=="function"&&adjustGearListSelectWidth(e)})}function Eg(e){e.forEach(t=>{if(!t)return;const r=Array.from(t.options||[]);r.find(o=>o.value==="None")?t.value="None":r.length?t.selectedIndex=-1:t.value=""})}const ose=typeof window<"u"&&typeof window.loadSession=="function"?window.loadSession:function(){return typeof ww=="function"?ww():null};function T2(){typeof restoringSession<"u"&&(restoringSession=!0);const e=ose(),t=e&&typeof e=="object"?{...e}:null;if(t){const a=typeof t.battery=="string"?t.battery:"",i=typeof t.batteryPlate=="string"?t.batteryPlate:"",s=typeof normalizeBatteryPlateValue=="function"?normalizeBatteryPlateValue(i,a):i;t.batteryPlate=s}typeof storeLoadedSetupState=="function"&&storeLoadedSetupState(t||null);let r={};if(t&&typeof t.diagramPositions=="object"&&typeof normalizeDiagramPositionsInput=="function"&&(r=normalizeDiagramPositionsInput(t.diagramPositions)),typeof setManualDiagramPositions=="function"&&setManualDiagramPositions(r,{render:!1}),typeof motorSelects<"u"&&Eg(motorSelects),typeof controllerSelects<"u"&&Eg(controllerSelects),t?(Kt&&(Kt.value=t.setupName||"",Kt.dispatchEvent(new Event("input"))),no(Ri,t.camera),fR(),no(xa,t.batteryPlate),typeof applyBatteryPlateSelectionFromBattery=="function"&&applyBatteryPlateSelectionFromBattery(t.battery,xa?xa.value:""),zc(),no(Wa,t.monitor),no(videoSelect,t.video),typeof updateCageSelectOptions=="function"?updateCageSelectOptions(t.cage):no(cageSelect,t.cage),no(distanceSelect,t.distance),Array.isArray(t.motors)&&typeof motorSelects<"u"&&t.motors.forEach((a,i)=>{motorSelects[i]&&no(motorSelects[i],a)}),Array.isArray(t.controllers)&&typeof controllerSelects<"u"&&t.controllers.forEach((a,i)=>{controllerSelects[i]&&no(controllerSelects[i],a)}),no(batterySelect,t.battery),typeof applyBatteryPlateSelectionFromBattery=="function"&&applyBatteryPlateSelectionFromBattery(t.battery,xa?xa.value:""),no(Ti,t.batteryHotswap),(t&&typeof t.battery=="string"&&t.battery.trim()||t&&typeof t.batteryHotswap=="string"&&t.batteryHotswap.trim())&&zc(),no(ur,t.setupSelect),_r=t.projectInfo||null,Gs&&typeof populateProjectForm=="function"&&populateProjectForm(_r||{})):(Pn&&(Pn.innerHTML="",Pn.classList.add("hidden")),td&&(td.innerHTML="",td.classList.add("hidden"))),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),Pn||td){const a=pR(),i=Gh(),s=f=>typeof uc=="function"&&typeof f=="string"?uc(f):null,l=f=>{if(!f||typeof f!="object")return!1;if(Object.prototype.hasOwnProperty.call(f,"gearList"))return!0;if(Object.prototype.hasOwnProperty.call(f,"gearSelectors")){const d=f.gearSelectors;if(d&&typeof d=="object"&&Object.keys(d).length)return!0}return Object.prototype.hasOwnProperty.call(f,"gearListAndProjectRequirementsGenerated")?!0:!!(f.projectInfo||f.powerSelection||f.autoGearRules&&f.autoGearRules.length||f.diagramPositions&&Object.keys(f.diagramPositions).length)},c=[];a&&c.push(a),(i||i==="")&&(c.includes(i)||c.push(i));let u=null;for(const f of c)if(u=s(f),l(u))break;if(!l(u)&&t){const f=typeof t.setupSelect=="string"?t.setupSelect.trim():"";if(f&&!c.includes(f)){const d=s(f);l(d)&&(u=d)}}if(l(u)){u&&u.powerSelection&&typeof applyStoredPowerSelection=="function"&&applyStoredPowerSelection(u.powerSelection)&&updateBatteryOptions();const f=Object.prototype.hasOwnProperty.call(u,"projectInfo"),d=f&&u.projectInfo&&typeof u.projectInfo=="object"?u.projectInfo:null,p=_r&&typeof _r=="object"?_r:null;let h=null;if(f?d&&p?h={...d,...p}:d?h={...d}:h=null:p&&(h={...p}),_r=h,Gs&&typeof populateProjectForm=="function"&&populateProjectForm(_r||{}),typeof normalizeDiagramPositionsInput=="function"&&typeof setManualDiagramPositions=="function"){const m=normalizeDiagramPositionsInput(u.diagramPositions),g=Object.keys(m).length?{...m,...r}:r;setManualDiagramPositions(g,{render:!1}),r=g}displayGearAndRequirements(u.gearList),Pn&&u.gearList&&(Pn.classList.remove("hidden"),skipNextGearListRefresh=!0),Pn&&(ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener(),u&&Rt(u.gearSelectors)&&Object.keys(u.gearSelectors).length&&applyGearListSelectors(u.gearSelectors),t&&(setSliderBowlValue(t.sliderBowl),setEasyrigValue(t.easyrig)),updateGearListButtonVisibility())}else if(_r&&typeof generateGearListHtml=="function"){const f=generateGearListHtml(_r||{});f&&(displayGearAndRequirements(f),Pn&&(Pn.classList.remove("hidden"),skipNextGearListRefresh=!0,ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListEyeLeatherListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener(),u&&Rt(u.gearSelectors)&&Object.keys(u.gearSelectors).length&&typeof applyGearListSelectors=="function"&&applyGearListSelectors(u.gearSelectors),t&&(setSliderBowlValue(t.sliderBowl),setEasyrigValue(t.easyrig)),updateGearListButtonVisibility()))}}const n=t&&Object.prototype.hasOwnProperty.call(t,"autoGearHighlight")?!!t.autoGearHighlight:!1;if(typeof setAutoGearHighlightEnabled=="function"?setAutoGearHighlightEnabled(n):Pn&&Pn.classList&&(Pn.classList.toggle("show-auto-gear-highlight",n),Fn("updateAutoGearHighlightToggleButton",[],{defer:!0})),typeof lastSetupName<"u"&&(lastSetupName=ur?ur.value:""),typeof setActiveProjectCompressionHold=="function"){let a="";if(typeof Gh=="function")try{a=Gh({allowTyped:!0})||""}catch(i){console.warn("Unable to determine active project key for compression hold after session restore",i),a=ur&&typeof ur.value=="string"?ur.value:""}else ur&&typeof ur.value=="string"&&(a=ur.value);setActiveProjectCompressionHold(a)}typeof restoringSession<"u"&&(restoringSession=!1),Ji();const o=Mc;Mc=null,o==="immediate"?Mb(!0):o==="queued"&&Mb()}function ase(e){const t=typeof e=="string"?e.trim():"";if(!t)return"Project-imported";const r=t.match(/^(.*?)-imported(?:-(\d+))?$/i);if(r){const n=typeof r[1]=="string"?r[1].trim():"";return n?`${n}-imported`:"Project-imported"}return t.toLowerCase().endsWith("-imported")?t:`${t}-imported`}function ise(e){const t=typeof e=="string"?e.trim():"",r=ase(e);if(!t)return{base:r,initialCandidate:r,suffixStart:2};const n=t.match(/^(.*?)-imported(?:-(\d+))?$/i),o=n&&n[2]?Number(n[2]):NaN,a=Number.isFinite(o)?o+1:2;return n?{base:r,initialCandidate:t,suffixStart:a}:{base:r,initialCandidate:r,suffixStart:2}}function sse(e,t,r){const n=r||new Set([...t].map(l=>typeof l=="string"?l.trim().toLowerCase():"").filter(l=>l)),o=ise(e);let a=typeof o.initialCandidate=="string"?o.initialCandidate.trim():"";a||(a=o.base||"Project-imported");let i=a.trim().toLowerCase(),s=o.suffixStart;for(;i&&n.has(i);)a=`${o.base||"Project-imported"}-${s++}`,i=a.trim().toLowerCase();return t.add(a),i&&n.add(i),a}function lse(e,t){if(!e||typeof saveProject!="function")return"";let r=new Set,n=new Set;if(typeof uc=="function")try{const s=uc();if(s&&typeof s=="object"){const l=Object.keys(s);r=new Set(l),n=new Set(l.map(c=>typeof c=="string"?c.trim().toLowerCase():"").filter(c=>c))}}catch(s){console.warn("Unable to read existing projects while generating fallback name for imported project",s)}const o=Array.isArray(t)?t:[];let a="";for(let s=0;s<o.length;s+=1){const l=typeof o[s]=="string"?o[s].trim():"";if(l){a=l;break}}a||(a="Imported project");const i=sse(a,r,n);return saveProject(i,e,{skipOverwriteBackup:!0}),i}function cse(e){if(!e||typeof e.querySelectorAll!="function")return;e.removeAttribute("data-gear-owned-export-label"),e.querySelectorAll("[data-gear-owned-export]").forEach(r=>{r&&r.parentElement&&r.parentElement.removeChild(r)})}function use(e,t={}){if(!Array.isArray(e)||!e.length)return!1;const r=t&&t.root?t.root:Pn;if(!r||typeof r.querySelector!="function")return!1;const n=typeof P0=="function"?P0():null,o=n&&typeof n.name=="string"?n.name.trim():"",a=o?o.toLowerCase():"",i=typeof B0=="function"?B0(o):o,s=i?i.toLowerCase():"";let l=!1;return e.forEach(c=>{if(!c||!c.ownedId)return;const u=typeof CSS<"u"&&CSS&&typeof CSS.escape=="function"?CSS.escape(c.ownedId):String(c.ownedId).replace(/\\/g,"\\\\").replace(/"/g,'\\"'),f=r.querySelector(`[data-gear-own-gear-id="${u}"]`);if(!f)return;cse(f);const d=typeof c.ownerDisplayName=="string"?c.ownerDisplayName.trim():"",p=d?d.toLowerCase():"",h=typeof c.ownerProfileName=="string"?c.ownerProfileName.trim():"",m=h?h.toLowerCase():"",g=typeof c.providerLabel=="string"?c.providerLabel.trim():d,S=!!(a&&m&&a===m||s&&p&&s===p||a&&p&&a===p);let y="",E=g;if(S)y="user",E="";else if(c.ownerType==="contact"||d){const L=typeof G0=="function"?G0(d||g,{contactId:c.contactId,fallbackLabel:g}):null;L&&L.value?(y=L.value,E=L.label||g):(typeof c.providerValue=="string"&&c.providerValue.startsWith("contact:")||c.providerValue&&c.providerValue!=="user")&&(y=c.providerValue)}else typeof c.providerValue=="string"&&c.providerValue&&(y=c.providerValue);typeof M0=="function"?M0(f,y,{label:E}):(y?f.setAttribute("data-gear-provider",y):f.removeAttribute("data-gear-provider"),E?f.setAttribute("data-gear-provider-label",E):f.removeAttribute("data-gear-provider-label")),l=!0}),l&&typeof _0=="function"&&_0("owned-gear-import"),l}function fse(e){if(!Array.isArray(e)||!e.length)return{added:0,updated:0};if(typeof contactsCache>"u")return{added:0,updated:0};const t=a=>typeof sanitizeContactValue=="function"?sanitizeContactValue(a):typeof a=="string"?a.trim():"",r=Array.isArray(contactsCache)?contactsCache.slice():[];let n=0,o=0;if(e.forEach(a=>{if(!a||typeof a!="object")return;const i=typeof normalizeContactEntry=="function"?normalizeContactEntry(a):{...a};if(!i||typeof i!="object")return;const s=t(i.id||a.id);if(!s)return;const l=r.findIndex(d=>d&&d.id===s),c=Number.isFinite(i.createdAt)?i.createdAt:Number.isFinite(a.createdAt)?a.createdAt:Date.now(),u=Number.isFinite(i.updatedAt)?i.updatedAt:Number.isFinite(a.updatedAt)?a.updatedAt:c;if(l!==-1){const d=r[l];let p=!1;["name","role","phone","email","website","notes"].forEach(m=>{const g=t(Object.prototype.hasOwnProperty.call(i,m)?i[m]:a[m]);if(!g)return;t(d[m])||(d[m]=g,p=!0)});const h=t(i.avatar||a.avatar);h&&!t(d.avatar)&&(d.avatar=h,p=!0),!Number.isFinite(d.createdAt)&&Number.isFinite(c)&&(d.createdAt=c,p=!0),Number.isFinite(u)&&(!Number.isFinite(d.updatedAt)||d.updatedAt<u)?(d.updatedAt=u,p=!0):(p&&Number.isFinite(d.updatedAt)||p&&!Number.isFinite(d.updatedAt))&&(d.updatedAt=Date.now()),p&&(o+=1);return}const f={id:s,name:t(i.name||a.name),role:t(i.role||a.role),phone:t(i.phone||a.phone),email:t(i.email||a.email),website:t(i.website||a.website),notes:t(i.notes||a.notes),avatar:t(i.avatar||a.avatar),createdAt:c,updatedAt:u};f.avatar||delete f.avatar,r.push(f),n+=1}),!n&&!o)return{added:0,updated:0};try{typeof sortContacts=="function"?contactsCache=sortContacts(r):contactsCache=r.filter(Boolean)}catch(a){console.warn("Shared contact merge could not sort contacts",a),contactsCache=r.filter(Boolean)}if(typeof x0=="function")try{x0(contactsCache)}catch(a){console.warn("Shared contact merge could not persist contacts",a)}if(typeof renderContactsList=="function")try{renderContactsList()}catch{}if(typeof updateContactPickers=="function")try{updateContactPickers()}catch{}return{added:n,updated:o}}function dse(e){const t=typeof e=="string"?e.trim():"";if(!t)return{name:t,changed:!1};if(typeof uc!="function")return{name:t,changed:!1};let r;try{r=uc()}catch(l){console.warn("Unable to inspect existing projects during shared import",l),r=null}if(!r||typeof r!="object")return{name:t,changed:!1};const n=new Set(Object.keys(r).map(l=>typeof l=="string"?l.trim().toLowerCase():"").filter(l=>l)),o=t.toLowerCase();if(!n.has(o))return{name:t,changed:!1};let a=2,i=`${t} (${a})`,s=i.trim().toLowerCase();for(;n.has(s);)a+=1,i=`${t} (${a})`,s=i.trim().toLowerCase();return{name:i,changed:!0}}function EM(e,t={}){try{const r=decodeSharedSetup(typeof e=="string"?JSON.parse(e):e);r&&r.contacts&&fse(r.contacts),deactivateSharedImportProjectPreset();const n=Array.isArray(r.autoGearRules)?r.autoGearRules:null,o=Array.isArray(t.sharedAutoGearRules)&&t.sharedAutoGearRules.length?t.sharedAutoGearRules:n,a=Array.isArray(o)&&o.length>0,i=t.autoGearMode;let s=Array.isArray(i)?i.slice():typeof i=="string"?[i]:[];s=s.filter((m,g,S)=>(m==="none"||m==="project"||m==="global")&&S.indexOf(m)===g),s.length||(s=a?["project"]:["none"]),s.length>1&&s.includes("none")&&(s=s.filter(m=>m!=="none")),s.length||(s=a?["project"]:["none"]);const l=s.includes("global"),c=s.includes("project"),u=s.length===1&&s[0]==="none";let f=!1;if(l)if(a){const m=mergeAutoGearRules(getBaseAutoGearRules(),o),g=ensureSharedAutoGearPreset(m,r);g&&setActiveAutoGearPresetId(g.id,{persist:!0,skipRender:!0}),setAutoGearRules(m),f=!0}else usingProjectAutoGearRules()&&(clearProjectAutoGearRules(),f=!0);if(c){if(a){const m=ensureSharedAutoGearPreset(o,r);m&&activateSharedImportProjectPreset(m.id),useProjectAutoGearRules(o)}else clearProjectAutoGearRules(),deactivateSharedImportProjectPreset();f=!0}else!l&&(u||!a)&&usingProjectAutoGearRules()&&(clearProjectAutoGearRules(),deactivateSharedImportProjectPreset(),f=!0);f&&(renderAutoGearRulesList(),updateAutoGearCatalogOptions()),r.changedDevices&&applyDeviceChanges(r.changedDevices),Kt&&r.setupName&&(Kt.value=r.setupName,Kt.dispatchEvent(new Event("input"))),typeof motorSelects<"u"&&Eg(motorSelects),typeof controllerSelects<"u"&&Eg(controllerSelects),no(Ri,r.camera),fR(),no(xa,r.batteryPlate),typeof applyBatteryPlateSelectionFromBattery=="function"&&applyBatteryPlateSelectionFromBattery(r.battery,xa?xa.value:""),zc(),no(Wa,r.monitor),no(videoSelect,r.video),typeof updateCageSelectOptions=="function"?updateCageSelectOptions(r.cage):no(cageSelect,r.cage),no(distanceSelect,r.distance),Array.isArray(r.motors)&&typeof motorSelects<"u"&&r.motors.forEach((m,g)=>{motorSelects[g]&&no(motorSelects[g],m)}),Array.isArray(r.controllers)&&typeof controllerSelects<"u"&&r.controllers.forEach((m,g)=>{controllerSelects[g]&&no(controllerSelects[g],m)}),no(batterySelect,r.battery),typeof applyBatteryPlateSelectionFromBattery=="function"&&applyBatteryPlateSelectionFromBattery(r.battery,xa?xa.value:""),no(Ti,r.batteryHotswap);let d=!1;if(r.powerSelection&&typeof applyStoredPowerSelection=="function"&&(d=applyStoredPowerSelection(r.powerSelection)),(typeof r.battery=="string"&&r.battery.trim()||typeof r.batteryHotswap=="string"&&r.batteryHotswap.trim()||d)&&zc(),typeof setManualDiagramPositions=="function"){let m={};typeof normalizeDiagramPositionsInput=="function"&&r.diagramPositions&&(m=normalizeDiagramPositionsInput(r.diagramPositions)),setManualDiagramPositions(m,{render:!1})}if(Ji(),Array.isArray(r.feedback)&&r.feedback.length){const m=getCurrentSetupKey(),g=loadFeedbackSafe();g[m]=(g[m]||[]).concat(r.feedback),saveFeedbackSafe(g)}_r=r.projectInfo||null,Gs&&typeof populateProjectForm=="function"&&populateProjectForm(_r||{});let p=!1,h="";if((r.projectHtml||r.gearList)&&(h=`${r.projectHtml||""}${r.gearList||""}`),!h&&r.projectInfo&&typeof generateGearListHtml=="function"&&(h=generateGearListHtml(r.projectInfo||{})),!h&&typeof generateGearListHtml=="function"&&(h=generateGearListHtml(_r||{})),h&&(displayGearAndRequirements(h),ensureGearListActions(),bindGearListCageListener(),bindGearListEasyrigListener(),bindGearListSliderBowlListener(),bindGearListProGaffTapeListener(),bindGearListDirectorMonitorListener(),p=!0),r.gearSelectors&&p&&applyGearListSelectors(r.gearSelectors),p&&Array.isArray(r.ownedGearMarkers)&&r.ownedGearMarkers.length&&use(r.ownedGearMarkers,{root:Pn}),r.projectInfo||r.gearSelectors||r.gearList||Object.prototype.hasOwnProperty.call(r,"gearListAndProjectRequirementsGenerated")){const m=getCurrentGearListHtml(),g={projectInfo:r.projectInfo||null,gearListAndProjectRequirementsGenerated:!!m};if(r.gearSelectors&&Object.keys(r.gearSelectors).length&&(g.gearSelectors=r.gearSelectors),typeof getDiagramManualPositions=="function"){const R=getDiagramManualPositions();R&&Object.keys(R).length&&(g.diagramPositions=R)}const S=getProjectScopedAutoGearRules();S&&S.length&&(g.autoGearRules=S);const y=ur&&typeof ur.value=="string"?ur.value.trim():"";let E=Kt&&typeof Kt.value=="string"?Kt.value.trim():"",L=y||E;if(!y&&L){const R=dse(L);if(R.changed&&R.name&&(L=R.name,E=R.name,Kt&&Kt.value!==R.name)){Kt.value=R.name;try{Kt.dispatchEvent(new Event("input"))}catch(I){}}}const v=Object.prototype.hasOwnProperty.call(g,"gearSelectors"),A=g.autoGearRules&&g.autoGearRules.length;if(typeof L=="string"&&(g.projectInfo||v||g.gearListAndProjectRequirementsGenerated||A||g.diagramPositions))A||delete g.autoGearRules,saveProject(L,g,{skipOverwriteBackup:!0});else if(g&&(g.projectInfo||v||g.gearListAndProjectRequirementsGenerated||A||g.diagramPositions)){A||delete g.autoGearRules;const R=[r.setupName,r.projectInfo&&r.projectInfo.projectName,g.projectInfo&&g.projectInfo.projectName],I=lse(g,R);if(I&&(Kt&&Kt.value!==I&&(Kt.value=I,Kt.dispatchEvent(new Event("input"))),typeof populateSetupSelect=="function"))try{populateSetupSelect()}catch(C){console.warn("Unable to refresh project selector after saving imported project without a provided name",C)}}}}catch(r){console.error("Failed to apply shared setup",r),alert(texts[currentLang].invalidSharedLink)}}let Ul=!1;function pse(e,t){if(typeof URLSearchParams=="function")try{return new URLSearchParams(e).get(t)}catch(o){!Ul&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Falling back to manual query parameter parsing.",o),Ul=!0}if(typeof e!="string"||e.length===0)return null;const r=e.charAt(0)==="?"?e.slice(1):e;if(!r)return null;const n=r.split("&");for(let o=0;o<n.length;o+=1){if(!n[o])continue;const[a,i=""]=n[o].split("=");if(!a)continue;let s;try{s=decodeURIComponent(a.replace(/\+/g," "))}catch(l){!Ul&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to decode query parameter name",a,l),Ul=!0;continue}if(s===t)try{return decodeURIComponent(i.replace(/\+/g," "))}catch(l){return!Ul&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to decode query parameter value",i,l),Ul=!0,i}}return null}function mse(e){if(typeof e!="string"||e.length===0)return"";const t=e.charAt(0)==="?"?e.slice(1):e;if(!t)return"";const r=[],n=t.split("&");for(let o=0;o<n.length;o+=1){const a=n[o];if(!a)continue;const[i]=a.split("=");if(!i){r.push(a);continue}let s;try{s=decodeURIComponent(i.replace(/\+/g," "))}catch(l){!Ul&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to decode query parameter name",i,l),Ul=!0,s=i}s!=="shared"&&r.push(a)}return r.length===0?"":`?${r.join("&")}`}function gse(){if(typeof window>"u")return;const{location:e,history:t}=window;if(!e||!t||typeof t.replaceState!="function")return;const r=typeof e.pathname=="string"&&e.pathname?e.pathname:"/",n=typeof e.search=="string"?e.search:"",o=typeof e.hash=="string"?e.hash:"";let a="",i=!1;if(typeof URLSearchParams=="function")try{const f=new URLSearchParams(n);f.delete("shared");const d=f.toString();a=d?`?${d}`:"",i=!0}catch(f){!Ul&&typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to rewrite query string with URLSearchParams",f),Ul=!0}i||(a=mse(n));const s=n||"",l=typeof a=="string"?a:"",c=`${r}${s}${o}`,u=`${r}${l}${o}`;c!==u&&t.replaceState(null,"",u)}function AM(){const t=typeof window<"u"&&window.location&&typeof window.location.search=="string"?window.location.search:"",r=pse(t,"shared");if(r)try{const n=LZString.decompressFromEncodedURIComponent(r);if(typeof n!="string")throw new Error("Shared payload could not be decompressed");const o=JSON.parse(n);EM(o),typeof $d=="function"&&$d(),gse()}catch(n){console.error("Failed to apply shared setup from URL",n)}}function Dg(){const e=typeof Ti>"u"?null:Ti;return[Ri,Wa,videoSelect,cageSelect,distanceSelect,batterySelect,e,xa].filter(Boolean)}typeof window<"u"&&(window.getTrackedPowerSelects=Dg);function O2(){const e=Dg(),t=typeof ur>"u"?null:ur;return t&&e.push(t),e}typeof window<"u"&&(window.getTrackedPowerSelectsWithSetup=O2);function as(e,t){if(!e||typeof t!="function")return;if(typeof e.forEach=="function"){e.forEach(t);return}(Array.isArray(e)?e:Array.from(e||[])).forEach(t)}const u1=()=>{const e=(u,f)=>u||document.getElementById(f),t=e(typeof Ri<"u"?Ri:null,"cameraSelect"),r=e(typeof Rw<"u"?Rw:null,"sensorModeDropdown"),n=e(typeof Sg<"u"?Sg:null,"recordingResolutionDropdown"),o=e(typeof Tw<"u"?Tw:null,"slowMotionSensorModeDropdown"),a=e(typeof Ow<"u"?Ow:null,"slowMotionRecordingResolutionDropdown"),i=e(typeof xw<"u"?xw:null,"slowMotionAspectRatioSelect"),s=e(typeof monitoringConfigurationSelect<"u"?monitoringConfigurationSelect:null,"monitoringConfigurationSelect"),l=e(typeof Wa<"u"?Wa:null,"monitorSelect"),c=e(typeof xa<"u"?xa:null,"batteryPlateSelect");return e(typeof batterySelect<"u"?batterySelect:null,"batterySelect"),!t&&document.readyState==="loading"?!1:(as(Dg(),u=>{u.removeEventListener("change",$x),u.addEventListener("change",$x)}),t&&(t.dataset.sessionBound||(t.dataset.sessionBound="true",t.addEventListener("change",()=>{fR(),zc(),typeof updateCageSelectOptions=="function"&&updateCageSelectOptions();const u=_r&&_r.recordingFrameRate,f=_r&&_r.slowMotionRecordingFrameRate;if(fae(_r&&_r.recordingResolution),dae(_r&&_r.sensorMode),pae(_r&&_r.slowMotionRecordingResolution),mae(_r&&_r.slowMotionSensorMode),Vx(u),wE(f),typeof updateStorageRequirementTypeOptions=="function"&&updateStorageRequirementTypeOptions(),typeof document<"u"&&typeof document.dispatchEvent=="function"&&typeof CustomEvent=="function")try{document.dispatchEvent(new CustomEvent("camera-selection-changed"))}catch{}}))),r&&!r.dataset.sessionBound&&(r.dataset.sessionBound="true",r.addEventListener("change",()=>{Vx(iU())})),n&&!n.dataset.sessionBound&&(n.dataset.sessionBound="true",n.addEventListener("change",()=>{Vx(iU())})),o&&!o.dataset.sessionBound&&(o.dataset.sessionBound="true",o.addEventListener("change",()=>{wE(Fh(Mh))})),a&&!a.dataset.sessionBound&&(a.dataset.sessionBound="true",a.addEventListener("change",()=>{wE(Fh(Mh))})),i&&!i.dataset.sessionBound&&(i.dataset.sessionBound="true",i.addEventListener("change",()=>{wE(Fh(Mh))})),s&&!s.dataset.sessionBound&&(s.dataset.sessionBound="true",s.addEventListener("change",()=>{monitoringConfigurationUserChanged=!0,uae()})),l&&!l.dataset.sessionBound&&(l.dataset.sessionBound="true",l.addEventListener("change",cae)),c&&c.addEventListener("change",zc),typeof batterySelect<"u"&&batterySelect&&batterySelect.addEventListener("change",zc),typeof Ti<"u"&&Ti&&Ti.addEventListener("change",$x),!0)};u1()||document.addEventListener("DOMContentLoaded",u1);as(O2(),e=>{e.addEventListener("change",uR)});typeof motorSelects<"u"&&as(motorSelects,e=>{e&&e.addEventListener("change",uR)});typeof controllerSelects<"u"&&as(controllerSelects,e=>{e&&e.addEventListener("change",uR)});if(Kt){let e=null;const t=()=>{e&&clearTimeout(e),e=setTimeout(()=>{const r=Kt.value?Kt.value.trim():"",n=ur?ur.value:"";Ji({skipGearList:!!(n&&r&&r!==n)})},500)};Kt.addEventListener("input",t)}as(Dg(),e=>{e.addEventListener("change",gM)});typeof motorSelects<"u"&&as(motorSelects,e=>{e&&e.addEventListener("change",gM)});typeof controllerSelects<"u"&&as(controllerSelects,e=>{e&&e.addEventListener("change",gM)});as(Dg(),e=>{e.addEventListener("change",cR)});typeof motorSelects<"u"&&as(motorSelects,e=>{e&&e.addEventListener("change",cR)});typeof controllerSelects<"u"&&as(controllerSelects,e=>{e&&e.addEventListener("change",cR)});typeof Kt<"u"&&Kt&&Kt.addEventListener("input",cR);as(Dg(),e=>{e.addEventListener("change",mS)});typeof motorSelects<"u"&&as(motorSelects,e=>{e&&e.addEventListener("change",mS)});typeof controllerSelects<"u"&&as(controllerSelects,e=>{e&&e.addEventListener("change",mS)});typeof Kt<"u"&&Kt&&Kt.addEventListener("change",mS);function CM(e){if(ef)return;let t=null,r=null;e&&typeof e=="object"&&(typeof e.type=="string"?t=e:r=e);const n=r&&typeof r.reason=="string"&&r.reason.trim()?r.reason.trim():null,o=t&&typeof t.type=="string"&&t.type?`before-${t.type}`:null,a=n||o||"before-exit",i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:null;let s=null;if(i&&typeof i.__cineShowAutoBackupIndicator=="function")try{const l=texts[currentLang]||{},c=texts.en||{},u=l.autoBackupInProgressNotice||c.autoBackupInProgressNotice||"Auto backup in progress. Performance may pause briefly.";s=i.__cineShowAutoBackupIndicator(u)}catch(l){console.warn("Failed to show auto backup indicator before exit",l),s=null}vM({immediate:!0,reason:a,pending:!0});try{i&&typeof i.autoBackup=="function"&&i.autoBackup({suppressSuccess:!0,triggerAutoSaveNotification:!0,reason:"before-reload"})}catch(l){console.warn("Failed to auto backup before exit",l)}finally{if(s)try{s()}catch(l){console.warn("Failed to hide auto backup indicator after exit flush",l)}}Mb(!0)}typeof document<"u"&&document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&CM({reason:"before-visibility-hidden"})});typeof window<"u"&&["pagehide","beforeunload","freeze"].forEach(e=>{window.addEventListener(e,CM)});if(Kt&&saveSetupBtn){const e=()=>{saveSetupBtn.disabled=!Kt.value.trim()};e(),Kt.addEventListener("input",e),Kt.addEventListener("keydown",t=>{t.isComposing||t.keyCode===229||t.key==="Enter"&&!saveSetupBtn.disabled&&saveSetupBtn.click()})}const Zx=typeof Os=="function"?Os:()=>{};let f1=()=>{},d1=()=>{},_b=()=>{},qd=()=>{},Mw=()=>{},_w=()=>{},Ag=()=>{},Dw=()=>{},_c=()=>{},Db=()=>{},kc=()=>{},Nb=()=>{},al=()=>{},Fb=()=>{},Nw=()=>{},nd=()=>{},Fw=()=>{},ql=()=>{},jw=()=>{},AP=()=>{},p1=()=>{};const Ld=[];let Hw=!1;const yse=25;function hse(e){if(!Array.isArray(e))return e;try{return e.slice()}catch{}return e}function x2(e,t,r){if(typeof PINK_MODE_SUPPORT_API>"u"||!PINK_MODE_SUPPORT_API)return;const n=PINK_MODE_SUPPORT_API[e];if(typeof n=="function")try{return n.apply(PINK_MODE_SUPPORT_API,Array.isArray(t)?t:[])}catch(o){typeof console<"u"&&console&&typeof console.warn=="function"&&r&&console.warn(r,o)}}function wM(){if(Hw=!1,typeof PINK_MODE_SUPPORT_API>"u"||!PINK_MODE_SUPPORT_API){Ld.length&&typeof setTimeout=="function"&&(Hw=!0,setTimeout(wM,50));return}for(;Ld.length;){const e=Ld.shift();if(e)try{x2(e.methodName,e.args,e.warningMessage)}catch{}}}function bse(){Hw||typeof setTimeout!="function"||(Hw=!0,setTimeout(wM,0))}function Sse(e,t,r){Ld.length>=yse&&Ld.shift(),Ld.push({methodName:e,args:hse(t),warningMessage:r}),bse()}function LM(e,t,r){if(!(typeof PINK_MODE_SUPPORT_API<"u"&&PINK_MODE_SUPPORT_API)){Sse(e,t,r);return}const o=x2(e,t,r);return Ld.length&&wM(),o}const vse=()=>LM("triggerPinkModeIconRain",null,"cineSession: triggerPinkModeIconRain failed.");let em=typeof window<"u"&&typeof window.triggerPinkModeIconRain=="function"?window.triggerPinkModeIconRain:vse,m1=()=>{},CP=()=>{};const Ese=()=>LM("startPinkModeAnimatedIcons",null,"cineSession: startPinkModeAnimatedIcons failed.");let tm=typeof window<"u"&&typeof window.startPinkModeAnimatedIcons=="function"?window.startPinkModeAnimatedIcons:Ese;const Ase=()=>LM("stopPinkModeAnimatedIcons",null,"cineSession: stopPinkModeAnimatedIcons failed.");let rm=typeof window<"u"&&typeof window.stopPinkModeAnimatedIcons=="function"?window.stopPinkModeAnimatedIcons:Ase,g1=()=>{},y1=()=>{},h1=()=>{},Uw=()=>!!(typeof document<"u"&&document.body&&document.body.classList.contains("pink-mode"));const b1=_o("cineSettingsAppearance",()=>null),od=e=>!!e&&typeof e.initialize=="function";let Vo=null,sa=null;const RM=[],TM=[],S1=(e,t)=>{if(!(!e||typeof e.registerControl!="function"||!Array.isArray(t)))for(;t.length>0;){const r=t.shift();if(r&&r.element)try{const n=e.registerControl(r.element,r.options);typeof r.callback=="function"&&r.callback(n)}catch(n){console.warn("Failed to process pending control registration",n)}}};let Nm=!1,Fm=null;function zw(){if(Fm!==null){try{clearTimeout(Fm)}catch{}Fm=null}}function v1(){Nm||typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("cineSettingsAppearance module is not available; settings appearance features are limited.")}function Cse(){if(Fm===null){if(typeof setTimeout!="function"){v1();return}Fm=setTimeout(()=>{Fm=null,v1()},1500)}}const Eo={document:typeof document<"u"?document:null,window:typeof window<"u"?window:null,elements:{darkModeToggle:typeof rc<"u"?rc:null,pinkModeToggle:typeof tc<"u"?tc:null,pinkModeHelpIcon:typeof pinkModeHelpIcon<"u"?pinkModeHelpIcon:null},settings:{darkMode:typeof pl<"u"?pl:null,highContrast:typeof settingsHighContrast<"u"?settingsHighContrast:null,pinkMode:typeof ml<"u"?ml:null,reduceMotion:typeof settingsReduceMotion<"u"?settingsReduceMotion:null,relaxedSpacing:typeof settingsRelaxedSpacing<"u"?settingsRelaxedSpacing:null,showAutoBackups:typeof settingsShowAutoBackups<"u"?settingsShowAutoBackups:null,temperatureUnit:typeof settingsTemperatureUnit<"u"?settingsTemperatureUnit:null,focusScale:typeof settingsFocusScale<"u"?settingsFocusScale:null},accent:{accentColorInput:typeof accentColorInput<"u"?accentColorInput:null,getAccentColor:()=>accentColor,setAccentColor:e=>{accentColor=e},getPrevAccentColor:()=>prevAccentColor,setPrevAccentColor:e=>{prevAccentColor=e},getHighContrastAccentColor:()=>HIGH_CONTRAST_ACCENT_COLOR,clearAccentColorOverrides:()=>{typeof clearAccentColorOverrides=="function"&&clearAccentColorOverrides()},applyAccentColor:e=>{typeof applyAccentColor=="function"&&applyAccentColor(e)},updateAccentColorResetButtonState:()=>{typeof updateAccentColorResetButtonState=="function"&&updateAccentColorResetButtonState()},refreshDarkModeAccentBoost:e=>{typeof refreshDarkModeAccentBoost=="function"&&refreshDarkModeAccentBoost(e)},isHighContrastActive:()=>typeof isHighContrastActive=="function"?isHighContrastActive():!1},cameraColors:{getColors:()=>kM(),setColors:e=>IM(e)},icons:{registry:typeof ICON_GLYPHS=="object"?ICON_GLYPHS:null,applyIconGlyph:typeof applyIconGlyph=="function"?(e,t)=>applyIconGlyph(e,t):null,get ensureSvgHasAriaHidden(){return typeof ensureSvgHasAriaHidden=="function"?ensureSvgHasAriaHidden:typeof window<"u"&&typeof window.ensureSvgHasAriaHidden=="function"?window.ensureSvgHasAriaHidden:null},get ensurePinkModeLottieRuntime(){const e=typeof window<"u"?window:{},t=e.cineCorePinkModeSupport||e.PINK_MODE_SUPPORT_API||{};return(typeof ensurePinkModeLottieRuntime=="function"?ensurePinkModeLottieRuntime:null)||(typeof e.ensurePinkModeLottieRuntime=="function"?e.ensurePinkModeLottieRuntime:null)||(typeof t.ensurePinkModeLottieRuntime=="function"?t.ensurePinkModeLottieRuntime:null)||(typeof t.resolvePinkModeLottieRuntime=="function"?t.resolvePinkModeLottieRuntime:null)||null},get pinkModeIcons(){return typeof pinkModeIcons=="object"&&pinkModeIcons?pinkModeIcons:typeof window<"u"&&window.pinkModeIcons?window.pinkModeIcons:typeof globalThis<"u"&&globalThis.pinkModeIcons?globalThis.pinkModeIcons:null},startPinkModeAnimatedIcons:(...e)=>{const t=(typeof window<"u"&&typeof window.startPinkModeAnimatedIcons=="function"?window.startPinkModeAnimatedIcons:null)||tm;return typeof t=="function"?t(...e):void 0},stopPinkModeAnimatedIcons:(...e)=>{const t=(typeof window<"u"&&typeof window.stopPinkModeAnimatedIcons=="function"?window.stopPinkModeAnimatedIcons:null)||rm;return typeof t=="function"?t(...e):void 0},triggerPinkModeIconRain:(...e)=>{const t=(typeof window<"u"&&typeof window.triggerPinkModeIconRain=="function"?window.triggerPinkModeIconRain:null)||em;return typeof t=="function"?t(...e):void 0}},storage:{getLocalStorage:()=>{try{return typeof localStorage<"u"?localStorage:null}catch{return null}},getSafeLocalStorage:()=>{try{if(typeof Lw=="function")return Lw()}catch(e){console.warn("cineSettingsAppearance: getSafeLocalStorage threw while building context",e)}return null},resolveSafeLocalStorage:()=>{try{if(typeof resolveSafeLocalStorage=="function")return resolveSafeLocalStorage()}catch(e){console.warn("cineSettingsAppearance: resolveSafeLocalStorage threw while building context",e)}return null}},preferences:{getTemperatureUnit:()=>Cd,setTemperatureUnit:e=>{Cd=Bb(e)},applyTemperatureUnitPreference:mR,getFocusScale:()=>{const e=typeof focusScalePreference=="string"?focusScalePreference:ws;return ws=typeof normalizeFocusScale=="function"?normalizeFocusScale(e):e,ws},setFocusScale:e=>{ws=typeof normalizeFocusScale=="function"?normalizeFocusScale(e):e},applyFocusScalePreference:typeof applyFocusScalePreference=="function"?(e,t)=>{applyFocusScalePreference(e,t),ws=typeof normalizeFocusScale=="function"?normalizeFocusScale(e):e}:null,getShowAutoBackups:()=>rl,setShowAutoBackups:e=>{rl=!!e},ensureAutoBackupsFromProjects:typeof ensureAutoBackupsFromProjects=="function"?ensureAutoBackupsFromProjects:null},autoBackups:{populateSetupSelect:typeof populateSetupSelect=="function"?populateSetupSelect:null,setupSelect:typeof ur<"u"?ur:null,setupNameInput:typeof Kt<"u"?Kt:null},mountVoltages:{getPreferencesClone:()=>getSessionMountVoltagePreferencesClone(),applyPreferences:(e,t)=>applySessionMountVoltagePreferences(e,t),supportedTypes:typeof SUPPORTED_MOUNT_VOLTAGE_TYPES<"u"?SUPPORTED_MOUNT_VOLTAGE_TYPES:[],defaultVoltages:typeof DEFAULT_MOUNT_VOLTAGES<"u"?DEFAULT_MOUNT_VOLTAGES:{},updateInputsFromState:()=>{const e=Qc("updateMountVoltageInputsFromState");if(e)try{e()}catch(t){Zx("updateMountVoltageInputsFromState",t)}else Zx("updateMountVoltageInputsFromState")},warnMissingHelper:(e,t)=>{Zx(e,t)}}};function wse(){if(typeof window>"u"||typeof window.matchMedia!="function")return null;try{return window.matchMedia("(prefers-color-scheme: dark)").matches}catch(e){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("cineSettingsAppearance: detectSystemPreference failed",e)}return null}function Lse(e){if(!e||typeof e.createThemePreferenceController!="function")return null;try{return e.createThemePreferenceController({detectSystemPreference:wse})}catch(t){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("cineSettingsAppearance: failed to create theme preference controller.",t)}return null}function Rse(e){if(!e||typeof e.createPinkModePreferenceController!="function")return null;try{return e.createPinkModePreferenceController({})}catch(t){typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("cineSettingsAppearance: failed to create pink mode preference controller.",t)}return null}function Tse(e){if(!e||typeof e!="object")return!1;if(zw(),f1=e.updateThemeColor||f1,d1=e.setToggleIcon||d1,_b=e.applyDarkMode||_b,qd=e.applyHighContrast||qd,Mw=e.applyReduceMotion||Mw,_w=e.applyRelaxedSpacing||_w,Ag=e.applyPinkMode||Ag,Dw=e.persistPinkModePreference||Dw,_c=e.rememberSettingsPinkModeBaseline||_c,Db=e.revertSettingsPinkModeIfNeeded||Db,kc=e.rememberSettingsTemperatureUnitBaseline||kc,Nb=e.revertSettingsTemperatureUnitIfNeeded||Nb,al=e.rememberSettingsFocusScaleBaseline||al,Fb=e.revertSettingsFocusScaleIfNeeded||Fb,Nw=e.applyShowAutoBackupsPreference||Nw,nd=e.rememberSettingsShowAutoBackupsBaseline||nd,Fw=e.revertSettingsShowAutoBackupsIfNeeded||Fw,ql=e.rememberSettingsMountVoltagesBaseline||ql,jw=e.revertSettingsMountVoltagesIfNeeded||jw,AP=e.handlePinkModeIconPress||AP,p1=e.triggerPinkModeIconAnimation||p1,em=e.triggerPinkModeIconRain||em,m1=e.startPinkModeIconRotation||m1,CP=e.stopPinkModeIconRotation||CP,typeof e.startPinkModeAnimatedIcons=="function"){const n=tm,o=e.startPinkModeAnimatedIcons;tm=(...a)=>{const i=Eo&&Eo.icons?Eo.icons:null,s=i?i.startPinkModeAnimatedIcons:void 0,l=typeof window<"u",c=l?window.startPinkModeAnimatedIcons:void 0;let u=!1,f;const d=(...p)=>(u=!0,f=n(...p),f);i&&(i.startPinkModeAnimatedIcons=d),l&&(window.startPinkModeAnimatedIcons=d);try{const p=o(...a);return u?f:typeof p>"u"?n(...a):p}catch{return u?f:n(...a)}finally{i&&(i.startPinkModeAnimatedIcons=s),l&&(window.startPinkModeAnimatedIcons=c)}}}if(typeof e.stopPinkModeAnimatedIcons=="function"){const n=rm,o=e.stopPinkModeAnimatedIcons;rm=(...a)=>{const i=Eo&&Eo.icons?Eo.icons:null,s=i?i.stopPinkModeAnimatedIcons:void 0,l=typeof window<"u",c=l?window.stopPinkModeAnimatedIcons:void 0;let u=!1,f;const d=(...p)=>(u=!0,f=n(...p),f);i&&(i.stopPinkModeAnimatedIcons=d),l&&(window.stopPinkModeAnimatedIcons=d);try{const p=o(...a);return u?f:typeof p>"u"?n(...a):p}catch{return u?f:n(...a)}finally{i&&(i.stopPinkModeAnimatedIcons=s),l&&(window.stopPinkModeAnimatedIcons=c)}}}g1=e.startPinkModeAnimatedIconRotation||g1,y1=e.stopPinkModeAnimatedIconRotation||y1,h1=e.applyPinkModeIcon||h1,Uw=e.isPinkModeActive||Uw,typeof window<"u"&&(window.triggerPinkModeIconRain=em,window.startPinkModeAnimatedIcons=tm,window.stopPinkModeAnimatedIcons=rm),Eo&&Eo.icons&&(Eo.icons.startPinkModeAnimatedIcons=tm,Eo.icons.stopPinkModeAnimatedIcons=rm,Eo.icons.triggerPinkModeIconRain=em);const t=Lse(e);t&&(Vo=t,S1(Vo,RM));const r=Rse(e);return r&&(sa=r,S1(sa,TM)),!0}function Ose(e){if(!e||typeof e.initialize!="function")return!1;let t=null;try{t=e.initialize(Eo)||null}catch(r){return typeof console<"u"&&console&&typeof console.error=="function"&&console.error("cineSettingsAppearance: initialize() threw.",r),!1}return!t||typeof t!="object"?!1:Tse(t)}function k2(e){if(!od(e))return!1;if(Nm)return!0;typeof document<"u"&&(Eo.elements.darkModeToggle||(Eo.elements.darkModeToggle=rc||document.getElementById("darkModeToggle")),Eo.elements.pinkModeToggle||(Eo.elements.pinkModeToggle=tc||document.getElementById("pinkModeToggle")),Eo.settings.darkMode||(Eo.settings.darkMode=(typeof pl<"u"?pl:null)||document.getElementById("settingsDarkMode")),Eo.settings.pinkMode||(Eo.settings.pinkMode=(typeof ml<"u"?ml:null)||document.getElementById("settingsPinkMode")));const t=Ose(e);return t&&(Nm=!0,zw()),t}const xse=od(b1)?b1:l2("cineSettingsAppearance",od),kse=k2(xse);if(!kse){Cse();const e={interval:200,maxAttempts:300,onTimeout:()=>{typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("cineSettingsAppearance module failed to load after waiting. Appearance features remain limited."),zw()}},t=r=>{const n=Nm;k2(r)&&!n&&(zw(),typeof console<"u"&&console&&typeof console.info=="function"&&console.info("cineSettingsAppearance module became available after deferred load."))};Gm("cineSettingsAppearance",od,t,e),Gm("cineModuleGlobals",r=>r&&typeof r.whenModuleAvailable=="function",r=>{if(Nm)return;let n=null;if(typeof r.getModule=="function")try{n=r.getModule("cineSettingsAppearance")}catch(o){n=null}if(od(n)){t(n);return}if(typeof r.whenModuleAvailable=="function")try{r.whenModuleAvailable("cineSettingsAppearance",o=>{od(o)&&t(o)})}catch(o){}},{interval:200,maxAttempts:150}),Gm("cineModules",r=>r&&typeof r.get=="function",r=>{if(Nm)return;let n=null;try{n=r.get("cineSettingsAppearance")}catch(o){n=null}od(n)&&t(n)},{interval:200,maxAttempts:150})}const OM=["A","B","C","D","E"],wP="cameraPowerPlanner_cameraColors";function xM(e){if(typeof e!="string")return"";const t=e.trim();return t?/^#[0-9a-f]{6}$/i.test(t)?t.toLowerCase():/^[0-9a-f]{6}$/i.test(t)?`#${t.toLowerCase()}`:"":""}function Ise(e){const t=()=>{let n=0;if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"){const a=new Uint8Array(1);crypto.getRandomValues(a),n=a[0]/255}else n=Math.random();const o=Math.floor(n*200)+28;return Math.max(24,Math.min(232,o))};return`#${[t(),t(),t()].map(n=>n.toString(16).padStart(2,"0")).join("")}`}function Pse(){const e={A:"#d32f2f",B:"#1e88e5",C:"#fdd835",D:"#43a047",E:"#7b1fa2"},t=Ise();return t&&(e.E=t),e}let FA=null;function I2(){if(FA)return FA;const e=Pse();let t=null;try{const n=localStorage.getItem(wP);n&&(t=JSON.parse(n))}catch(n){console.warn("Failed to read stored camera colors",n),t=null}const r={...e};if(t&&typeof t=="object")OM.forEach(n=>{const o=t[n]||t[n.toLowerCase()],a=xM(o);a&&(r[n]=a)});else try{localStorage.setItem(wP,JSON.stringify(r))}catch(n){console.warn("Unable to persist default camera colors",n)}return FA=r,r}function kM(){return{...I2()}}function IM(e={}){const t={...I2()};let r=!1;if(OM.forEach(n=>{const o=e[n]||e[n.toLowerCase()],a=xM(o);a&&t[n]!==a&&(t[n]=a,r=!0)}),!r)return t;FA=t;try{localStorage.setItem(wP,JSON.stringify(t))}catch(n){console.warn("Failed to persist camera color preferences",n)}if(typeof document<"u"&&typeof document.dispatchEvent=="function"&&typeof CustomEvent=="function")try{document.dispatchEvent(new CustomEvent("camera-colors-changed"))}catch(n){console.warn("Failed to broadcast camera color change",n)}return t}function PM(){return typeof document>"u"?[]:OM.map(e=>{const t=`cameraColor${e}`;let r=null;try{r=typeof window<"u"&&window[t]?window[t]:document.getElementById(t)}catch{r=null}return r?{letter:e,element:r}:null}).filter(Boolean)}function Bse(){const e=kM();PM().forEach(t=>{if(!t||!t.element)return;const r=e[t.letter]||"";r&&(t.element.value=r)})}function Gse(){const e={};return PM().forEach(t=>{if(!t||!t.element)return;const r=xM(t.element.value||"");r&&(e[t.letter]=r)}),e}try{typeof window<"u"&&(window.getCameraLetterColors=()=>kM(),window.setCameraLetterColors=e=>IM(e))}catch(e){console.warn("Unable to expose camera color helpers",e)}const ek=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null,yS=(e,t={})=>{const r=!!e;if(Vo&&typeof Vo.setValue=="function"){Vo.setValue(r,t);return}_b(r);const n=r?"true":"false",o=[];try{if(typeof resolveSafeLocalStorage=="function"){const a=resolveSafeLocalStorage();a&&typeof a.setItem=="function"&&o.push({name:"safeLocalStorage",storage:a})}}catch(a){console.warn("Could not resolve SafeLocalStorage while persisting dark mode preference",a)}try{typeof localStorage<"u"&&o.push({name:"localStorage",storage:localStorage})}catch(a){console.warn("Could not access localStorage while persisting dark mode preference",a)}o.forEach(a=>{if(!(!a||!a.storage||typeof a.storage.setItem!="function"))try{a.storage.setItem("darkMode",n)}catch(i){console.warn(`Could not persist dark mode preference to ${a.name}`,i)}})},$w=()=>Vo&&typeof Vo.getValue=="function"?!!Vo.getValue():typeof document<"u"&&document.body&&typeof document.body.classList<"u"&&document.body.classList.contains("dark-mode"),P2=(e,t)=>{if(Vo&&typeof Vo.registerControl=="function")return Vo.registerControl(e,t);let r=()=>{};return RM.push({element:e,config:t,callback:n=>{r=n}}),()=>r()},B2=(e,t)=>{if(sa&&typeof sa.registerControl=="function")return sa.registerControl(e,t);let r=()=>{};return TM.push({element:e,options:t,callback:n=>{r=n}}),()=>r()};(rc||typeof document<"u"&&document.getElementById("darkModeToggle"))&&P2(rc||document.getElementById("darkModeToggle"),{type:"button"});if(typeof pl<"u"||typeof document<"u"&&document.getElementById("settingsDarkMode")){const e=(typeof pl<"u"?pl:null)||document.getElementById("settingsDarkMode");e&&P2(e,{type:"checkbox"})}if(!Vo){let e=!1;try{const t=typeof localStorage<"u"?localStorage.getItem("darkMode"):null;t!==null?e=t==="true":typeof window<"u"&&typeof window.matchMedia=="function"&&(e=window.matchMedia("(prefers-color-scheme: dark)").matches)}catch(t){console.warn("Could not load dark mode preference",t)}_b(e)}if(ek)try{ek.cineThemePreference={registerControl:(e,t)=>{if(Vo&&typeof Vo.registerControl=="function")return Vo.registerControl(e,t);let r=()=>{};return RM.push({element:e,options:t,callback:n=>{r=n}}),()=>r()},setValue:(e,t)=>yS(e,t),getValue:()=>$w(),reloadFromStorage:e=>Vo&&typeof Vo.reloadFromStorage=="function"?Vo.reloadFromStorage(e):$w()},ek.cinePinkModePreference={registerControl:(e,t)=>{if(sa&&typeof sa.registerControl=="function")return sa.registerControl(e,t);let r=()=>{};return TM.push({element:e,options:t,callback:n=>{r=n}}),()=>r()},setValue:(e,t)=>sa&&typeof sa.setValue=="function"?sa.setValue(e,t):!1,getValue:()=>sa&&typeof sa.getValue=="function"?sa.getValue():Uw(),reloadFromStorage:e=>sa&&typeof sa.reloadFromStorage=="function"?sa.reloadFromStorage(e):Uw()}}catch(e){console.warn("Unable to expose theme preference bridge",e)}const G2="cameraPowerPlanner_pinkMode",M2="pinkMode";let ws=typeof focusScalePreference=="string"?focusScalePreference:"metric",BM=!1;try{BM=localStorage.getItem("highContrast")==="true"}catch(e){console.warn("Could not load high contrast preference",e)}qd(BM);typeof window<"u"&&(window.handlePinkModeIconPress=AP,window.triggerPinkModeIconRain=em,window.startPinkModeAnimatedIcons=tm,window.stopPinkModeAnimatedIcons=rm);let GM=!1;try{let e=localStorage.getItem(G2);(e==null||e==="")&&(e=localStorage.getItem(M2)),GM=e==="true"}catch(e){console.warn("Could not load pink mode preference",e)}Ag(GM);_c();kc();al();nd();ql();(tc||typeof document<"u"&&document.getElementById("pinkModeToggle"))&&B2(tc||document.getElementById("pinkModeToggle"),{type:"button"});if(typeof ml<"u"||typeof document<"u"&&document.getElementById("settingsPinkMode")){const e=(typeof ml<"u"?ml:null)||document.getElementById("settingsPinkMode");e&&B2(e,{type:"checkbox"})}settingsShowAutoBackups&&settingsShowAutoBackups.addEventListener("change",()=>{Nw(settingsShowAutoBackups.checked)});settingsTemperatureUnit&&settingsTemperatureUnit.addEventListener("change",()=>{mR(settingsTemperatureUnit.value,{persist:!1})});typeof settingsFocusScale<"u"&&settingsFocusScale&&settingsFocusScale.addEventListener("change",()=>{typeof applyFocusScalePreference=="function"&&(applyFocusScalePreference(settingsFocusScale.value,{persist:!1}),ws=typeof normalizeFocusScale=="function"?normalizeFocusScale(settingsFocusScale.value):settingsFocusScale.value);try{zM()}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to refresh lens dropdown after focus scale change",e)}});typeof settingsFocusScale<"u"&&settingsFocusScale&&(settingsFocusScale.value=ws);const Mse=Array.from(typeof document<"u"?document.querySelectorAll(".mount-voltage-input"):[]);Mse.forEach(e=>{e.addEventListener("change",D0),e.addEventListener("blur",D0)});const E1=(()=>{const e=[typeof yn<"u"&&yn&&typeof yn=="object"?yn:null,typeof globalThis<"u"&&typeof globalThis=="object"?globalThis:null,typeof window<"u"&&typeof window=="object"?window:null,typeof self<"u"&&typeof self=="object"?self:null,typeof global<"u"&&typeof global=="object"?global:null].filter(Boolean);for(let t=0;t<e.length;t+=1){const r=e[t],n=r&&r.mountVoltageResetButton;if(n)return n}return null})();E1&&E1.addEventListener("click",()=>{const e=Qc("resetMountVoltagePreferences");if(e)try{e({persist:!1,triggerUpdate:!0})}catch(r){Os("resetMountVoltagePreferences",r)}else Os("resetMountVoltagePreferences");const t=Qc("updateMountVoltageInputsFromState");if(t)try{t()}catch(r){Os("updateMountVoltageInputsFromState",r)}else Os("updateMountVoltageInputsFromState")});const A1=f2(),C1=u2();if(A1&&C1){const e=A1,t=C1;e.addEventListener("click",()=>{const i=eie({reason:"settings-button"}),s=typeof t.hasAttribute=="function"?t.hasAttribute("hidden"):null,l=typeof isDialogOpen=="function"?isDialogOpen(t):!!(t&&t.open);xs("info","Settings dialog open requested",{...i,openBefore:l,hiddenBefore:s},{action:"open-request"}),prevAccentColor=accentColor,_c(),kc(),al(),nd(),ql();const c=Qc("updateMountVoltageInputsFromState");if(c)try{c()}catch(m){Os("updateMountVoltageInputsFromState",m)}else Os("updateMountVoltageInputsFromState");if(settingsLanguage&&(settingsLanguage.value=currentLang),pl&&(pl.checked=$w()),ml&&(ml.checked=document.body.classList.contains("pink-mode")),settingsHighContrast&&(settingsHighContrast.checked=document.body.classList.contains("high-contrast")),settingsReduceMotion){const m=document.documentElement.classList.contains("reduce-motion");settingsReduceMotion.checked=m}if(settingsRelaxedSpacing){const m=document.documentElement.classList.contains("relaxed-spacing");settingsRelaxedSpacing.checked=m}if(settingsShowAutoBackups){const m=typeof rl<"u"?rl:!0;settingsShowAutoBackups.checked=m}if(accentColorInput){const m=localStorage.getItem("accentColor");accentColorInput.value=m||accentColor,typeof updateAccentColorResetButtonState=="function"&&updateAccentColorResetButtonState()}Bse(),settingsTemperatureUnit&&(settingsTemperatureUnit.value=Cd),settingsFontSize&&(settingsFontSize.value=fontSize),settingsFontFamily&&(settingsFontFamily.value=fontFamily),settingsLogo&&(settingsLogo.value=""),settingsLogoPreview&&rd(),updateStorageSummary(),autoGearEditor&&(closeAutoGearEditor(),Fn("refreshAutoGearScenarioOptions"),Fn("refreshAutoGearMatteboxOptions"),Fn("refreshAutoGearCameraHandleOptions"),Fn("refreshAutoGearViewfinderExtensionOptions"),Fn("refreshAutoGearVideoDistributionOptions"),Fn("refreshAutoGearCameraOptions",[],{defer:!0}),Fn("refreshAutoGearMonitorOptions"),Fn("refreshAutoGearWirelessOptions"),Fn("refreshAutoGearMotorsOptions"),Fn("refreshAutoGearControllersOptions"),Fn("refreshAutoGearDistanceOptions"),populateAutoGearCategorySelect(autoGearAddCategorySelect,""),populateAutoGearCategorySelect(autoGearRemoveCategorySelect,""),renderAutoGearRulesList(),renderAutoGearDraftLists(),updateAutoGearCatalogOptions(),Fn("renderAutoGearBackupControls",[],{defer:!0}),Fn("applyAutoGearBackupVisibility",[],{defer:!0})),activeSettingsTabId&&activateSettingsTab(activeSettingsTabId),id(),t.removeAttribute("hidden"),openDialog(t),scheduleSettingsTabsOverflowUpdate();const f=t.querySelector(".settings-panel:not([hidden])")?.querySelector('input:not([type="hidden"]), select:not(#settingsLanguage), textarea');if(f)try{f.focus({preventScroll:!0})}catch{f.focus()}const d=typeof t.hasAttribute=="function"?t.hasAttribute("hidden"):null,p=typeof isDialogOpen=="function"?isDialogOpen(t):!!(t&&t.open),h={...i,openBefore:l,openAfter:p,hiddenAfter:d};xs(p?"info":"warn",p?"Settings dialog opened":"Settings dialog did not open",h,{action:"open-result"})}),settingsCancel&&settingsCancel.addEventListener("click",()=>{Db(),_c(),Nb(),kc(),Fb(),al(),Fw(),nd(),jw(),ql(),mP(),settingsLogo&&(settingsLogo.value=""),settingsLogoPreview&&rd(),closeAutoGearEditor(),id(),closeDialog(t),t.setAttribute("hidden","")});const r=async()=>{if(!t)return;if(settingsLanguage&&(await bg(settingsLanguage.value),typeof sd=="function"))try{sd()}catch(f){console.warn("Failed to refresh user button selectors after language change",f)}if(pl&&yS(pl.checked,{persist:!0}),ml&&Dw(ml.checked),settingsHighContrast){const f=settingsHighContrast.checked;qd(f);try{localStorage.setItem("highContrast",f)}catch(d){console.warn("Could not save high contrast preference",d)}}if(settingsReduceMotion){const f=settingsReduceMotion.checked;Mw(f);try{localStorage.setItem("reduceMotion",f)}catch(d){console.warn("Could not save reduce motion preference",d)}}if(settingsRelaxedSpacing){const f=settingsRelaxedSpacing.checked;_w(f);try{localStorage.setItem("relaxedSpacing",f)}catch(d){console.warn("Could not save relaxed spacing preference",d)}}settingsShowAutoBackups&&Nw(settingsShowAutoBackups.checked);const i=typeof document<"u"&&typeof document.getElementById=="function"?document.getElementById("autoGearShowBackups"):null;if(i&&Fn("setAutoGearBackupsVisible",[!!i.checked]),accentColorInput){const f=accentColorInput.value;document.body.classList.contains("pink-mode")||applyAccentColor(f);try{uie(f)===DEFAULT_ACCENT_NORMALIZED?localStorage.removeItem("accentColor"):localStorage.setItem("accentColor",f)}catch(d){console.warn("Could not save accent color",d)}accentColor=f,prevAccentColor=f,typeof updateAccentColorResetButtonState=="function"&&updateAccentColorResetButtonState()}const s=Gse(),l=IM(s);if(PM().forEach(f=>{const d=l[f.letter];d&&(f.element.value=d)}),settingsTemperatureUnit){const f=typeof settingsTemperatureUnit.value=="string"?settingsTemperatureUnit.value:"celsius";mR(f),kc()}if(typeof settingsFocusScale<"u"&&settingsFocusScale&&(typeof applyFocusScalePreference=="function"&&applyFocusScalePreference(settingsFocusScale.value),al(),ws=typeof normalizeFocusScale=="function"?normalizeFocusScale(settingsFocusScale.value):settingsFocusScale.value),applySessionMountVoltagePreferences(collectMountVoltageFormValues(),{persist:!0,triggerUpdate:!0}),ql(),settingsFontSize){const f=settingsFontSize.value;m2(f);try{localStorage.setItem("fontSize",f)}catch(d){console.warn("Could not save font size",d)}fontSize=f}if(settingsFontFamily){const f=settingsFontFamily.value;g2(f);try{localStorage.setItem("fontFamily",f)}catch(d){console.warn("Could not save font family",d)}fontFamily=f}const u=document.getElementById("settingsLogo");if(u&&u.files&&u.files[0]){const f=u.files[0];if(console.log("[Settings] Logo upload detected:",f.name,f.type,f.size),f.type==="image/svg+xml"||f.name.toLowerCase().endsWith(".svg")){console.log("[Settings] Logo format valid (SVG). Reading file...");const d=new FileReader;d.onload=p=>{if(!p.target.result){console.error("[Settings] FileReader result is empty"),qr("error","Failed to read logo file");return}console.log("[Settings] Logo file read success. Length:",p.target.result.length);try{localStorage.setItem("customLogo",p.target.result),console.log("[Settings] Logo saved to localStorage")}catch(h){console.warn("[Settings] Could not save custom logo to localStorage",h),qr("error","Failed to save logo to storage (quota exceeded?)")}renderSettingsLogoPreview(p.target.result)},d.onerror=p=>{console.error("[Settings] FileReader error:",p),qr("error","Error reading logo file")},d.readAsDataURL(f)}else console.warn("[Settings] Unsupported logo format:",f.type),qr("error",texts[currentLang].logoFormatError||"Unsupported logo format. Please use SVG."),u&&(u.value=""),rd()}else u&&u.files&&u.files.length===0||u||console.warn("[Settings] settingsLogo element not found during save");closeAutoGearEditor(),id(),_c(),kc(),al(),nd(),ql(),closeDialog(t),t.setAttribute("hidden","")};settingsSave&&settingsSave.addEventListener("click",()=>{r()}),t.addEventListener("click",i=>{i.target===t&&r()}),t.addEventListener("cancel",i=>{i.preventDefault(),Db(),_c(),Nb(),kc(),Fb(),al(),Fw(),nd(),jw(),ql(),mP(),settingsLogo&&(settingsLogo.value=""),settingsLogoPreview&&rd(),closeAutoGearEditor(),id(),closeDialog(t),t.setAttribute("hidden","")}),typeof autoGearAddRuleBtn<"u"&&autoGearAddRuleBtn&&autoGearAddRuleBtn.addEventListener("click",()=>{typeof Iw=="function"?Iw():typeof globalThis<"u"&&typeof globalThis.invokeSessionOpenAutoGearEditor=="function"?globalThis.invokeSessionOpenAutoGearEditor():typeof window<"u"&&typeof window.invokeSessionOpenAutoGearEditor=="function"&&window.invokeSessionOpenAutoGearEditor()}),typeof autoGearConditionSelect<"u"&&autoGearConditionSelect&&autoGearConditionSelect.addEventListener("change",()=>{typeof updateAutoGearConditionAddButtonState=="function"?updateAutoGearConditionAddButtonState():typeof globalThis<"u"&&typeof globalThis.updateAutoGearConditionAddButtonState=="function"&&globalThis.updateAutoGearConditionAddButtonState()}),typeof autoGearConditionAddButton<"u"&&autoGearConditionAddButton&&autoGearConditionAddButton.addEventListener("click",()=>{typeof addAutoGearConditionFromPicker=="function"?addAutoGearConditionFromPicker():typeof globalThis<"u"&&typeof globalThis.addAutoGearConditionFromPicker=="function"&&globalThis.addAutoGearConditionFromPicker()});const n=(()=>{let i=null;try{typeof autoGearScenarioModeSelect<"u"&&(i=autoGearScenarioModeSelect)}catch{}if(!i){const s=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;s&&typeof s=="object"&&"autoGearScenarioModeSelect"in s&&(i=s.autoGearScenarioModeSelect||null)}if(!i&&typeof document<"u"&&document&&typeof document.getElementById=="function")try{i=document.getElementById("autoGearScenarioMode")||null}catch{}return i})();if(n&&typeof n.addEventListener=="function"&&n.addEventListener("change",()=>{if(autoGearEditorDraft){const i=typeof n.value=="string"?n.value:"";autoGearEditorDraft.scenarioLogic=normalizeAutoGearScenarioLogic(i)}applyAutoGearScenarioSettings(getAutoGearScenarioSelectedValues())}),typeof autoGearScenarioBaseSelect<"u"&&autoGearScenarioBaseSelect&&autoGearScenarioBaseSelect.addEventListener("change",()=>{autoGearEditorDraft&&(autoGearEditorDraft.scenarioPrimary=gae(autoGearScenarioBaseSelect.value))}),typeof autoGearScenarioFactorInput<"u"&&autoGearScenarioFactorInput){const i=()=>{autoGearEditorDraft&&(autoGearEditorDraft.scenarioMultiplier=yae(autoGearScenarioFactorInput.value))};autoGearScenarioFactorInput.addEventListener("change",i),autoGearScenarioFactorInput.addEventListener("input",i)}typeof autoGearConditionList<"u"&&autoGearConditionList&&autoGearConditionList.addEventListener("click",i=>{const s=i.target instanceof HTMLElement?i.target.closest("button"):null;if(s){if(s.classList.contains("auto-gear-condition-remove")){const l=s.dataset.condition||"";l&&hae(l,{focusPicker:!0});return}s.classList.contains("auto-gear-condition-add")&&bae()}});const o=()=>{if(typeof resetAutoGearRulesToFactoryAdditions=="function")return resetAutoGearRulesToFactoryAdditions;if(typeof globalThis<"u"&&typeof globalThis.resetAutoGearRulesToFactoryAdditions=="function")return globalThis.resetAutoGearRulesToFactoryAdditions;const i=l2("cineFeatureAutoGearRules",s=>s&&typeof s.resetAutoGearRulesToFactoryAdditions=="function");return i&&typeof i.resetAutoGearRulesToFactoryAdditions=="function"?i.resetAutoGearRulesToFactoryAdditions:null};if(typeof autoGearResetFactoryButton<"u"&&autoGearResetFactoryButton){let i=null;const s=()=>{if(i!==null){try{clearTimeout(i)}catch{}i=null}},l=()=>{typeof console<"u"&&typeof console.warn=="function"&&!d&&console.warn("Automatic gear reset action unavailable: reset handler missing.")},c=()=>{if(i===null){if(typeof setTimeout!="function"){l();return}i=setTimeout(()=>{i=null,l()},1500)}},u=()=>{autoGearResetFactoryButton.disabled=!1,autoGearResetFactoryButton.setAttribute("aria-disabled","false")},f=()=>{autoGearResetFactoryButton.disabled=!0,autoGearResetFactoryButton.setAttribute("aria-disabled","true")};let d=!1;const p=g=>d||typeof g!="function"?!1:(autoGearResetFactoryButton.addEventListener("click",g),u(),d=!0,s(),!0),h=o(),m=(g,S={})=>p(g)?(S.logReenabledReason==="deferredModuleLoad"&&typeof console<"u"&&typeof console.info=="function"&&console.info("Automatic gear reset action re-enabled after deferred module load."),!0):!1;m(h)||(f(),c(),Gm("resetAutoGearRulesToFactoryAdditions",g=>typeof g=="function",g=>{m(g,{logReenabledReason:"deferredModuleLoad"})},{interval:200,maxAttempts:300,onTimeout:()=>{s(),typeof console<"u"&&typeof console.warn=="function"&&console.warn("Automatic gear reset action unavailable after waiting for handler registration.")}}),Gm("cineModuleGlobals",g=>g&&typeof g.whenModuleAvailable=="function",g=>{if(d)return;const S=y=>{y&&typeof y.resetAutoGearRulesToFactoryAdditions=="function"&&m(y.resetAutoGearRulesToFactoryAdditions,{logReenabledReason:"deferredModuleLoad"})};if(typeof g.getModule=="function")try{const y=g.getModule("cineFeatureAutoGearRules");S(y)}catch(y){}if(!d&&typeof g.whenModuleAvailable=="function")try{g.whenModuleAvailable("cineFeatureAutoGearRules",y=>{S(y)})}catch(y){}},{interval:200,maxAttempts:150}),Gm("cineModules",g=>g&&typeof g.get=="function",g=>{if(!d)try{const S=g.get("cineFeatureAutoGearRules");S&&typeof S.resetAutoGearRulesToFactoryAdditions=="function"&&m(S.resetAutoGearRulesToFactoryAdditions)}catch(S){}},{interval:200,maxAttempts:150}))}if(typeof autoGearExportButton<"u"&&autoGearExportButton&&autoGearExportButton.addEventListener("click",()=>{Fn("exportAutoGearRules",[],{defer:!0})}),typeof autoGearImportButton<"u"&&autoGearImportButton&&typeof autoGearImportInput<"u"&&autoGearImportInput&&(autoGearImportButton.addEventListener("click",()=>{autoGearImportInput.click()}),autoGearImportInput.addEventListener("change",Sae)),typeof autoGearSearchInput<"u"&&autoGearSearchInput){const i=s=>{vae(s?.target?.value||"")};autoGearSearchInput.addEventListener("input",i),autoGearSearchInput.addEventListener("search",i)}typeof autoGearFilterScenarioSelect<"u"&&autoGearFilterScenarioSelect&&autoGearFilterScenarioSelect.addEventListener("change",i=>{Eae(i?.target?.value||"all")}),typeof autoGearFilterClearButton<"u"&&autoGearFilterClearButton&&autoGearFilterClearButton.addEventListener("click",Aae),typeof autoGearSummaryCards<"u"&&autoGearSummaryCards&&autoGearSummaryCards.addEventListener("click",i=>{const s=i.target instanceof HTMLElement?i.target.closest(".auto-gear-summary-action"):null;if(!s||s.disabled)return;const l=s.dataset.focus||"all";Cae(l)}),autoGearSummaryDetails&&autoGearSummaryDetails.addEventListener("click",i=>{const s=i.target instanceof HTMLElement?i.target:null;if(!s)return;const l=s.closest("button[data-auto-gear-scenario]");if(l){const f=l.dataset.autoGearScenario||"";f&&(setAutoGearSummaryFocus("all"),setAutoGearScenarioFilter(f));return}const c=s.closest("button[data-auto-gear-rule]");if(c){focusAutoGearRuleById(c.dataset.autoGearRule||"");return}s.closest("button[data-auto-gear-summary-reset]")&&setAutoGearSummaryFocus("all")}),typeof autoGearPresetSelect<"u"&&autoGearPresetSelect&&autoGearPresetSelect.addEventListener("change",wae),typeof autoGearSavePresetButton<"u"&&autoGearSavePresetButton&&autoGearSavePresetButton.addEventListener("click",Lae),typeof autoGearDeletePresetButton<"u"&&autoGearDeletePresetButton&&autoGearDeletePresetButton.addEventListener("click",Rae),typeof autoGearAddItemButton<"u"&&autoGearAddItemButton&&autoGearAddItemButton.addEventListener("click",()=>N0("add")),typeof autoGearRemoveItemButton<"u"&&autoGearRemoveItemButton&&autoGearRemoveItemButton.addEventListener("click",()=>N0("remove")),typeof autoGearSaveRuleButton<"u"&&autoGearSaveRuleButton&&autoGearSaveRuleButton.addEventListener("click",Tae),typeof autoGearCancelEditButton<"u"&&autoGearCancelEditButton&&autoGearCancelEditButton.addEventListener("click",()=>{Oae(),F0()}),typeof autoGearRulesList<"u"&&autoGearRulesList&&(autoGearRulesList.addEventListener("click",i=>{const s=i.target,l=s&&typeof s.closest=="function"?s.closest("button"):null;if(l){if(l.classList.contains("auto-gear-edit")){const c=l.dataset.ruleId||"",u=l.dataset.ruleIndex,f={};u!==void 0&&(f.ruleIndex=u),kae(c,f)}else if(l.classList.contains("auto-gear-duplicate")){const c=l.dataset.ruleId||"";xae(c,l.dataset.ruleIndex)}else if(l.classList.contains("auto-gear-delete")){const c=l.dataset.ruleId||"",u=l.dataset.ruleIndex;Fn("deleteAutoGearRule",u!==void 0?[c,u]:[c])}}}),autoGearRulesList.addEventListener("change",i=>{const s=i.target;if(!(!s||!(s instanceof HTMLElement))&&s.classList.contains("auto-gear-enabled-toggle")){const l=s.dataset.ruleId||"",c=s.dataset.ruleIndex;Fn("setAutoGearRuleEnabled",[l,s.checked,c])}})),typeof autoGearBackupSelect<"u"&&autoGearBackupSelect&&autoGearBackupSelect.addEventListener("change",()=>{Iae()}),typeof autoGearShowBackupsCheckbox<"u"&&autoGearShowBackupsCheckbox&&autoGearShowBackupsCheckbox.addEventListener("change",Pae),typeof autoGearBackupRestoreButton<"u"&&autoGearBackupRestoreButton&&autoGearBackupRestoreButton.addEventListener("click",()=>{if(!autoGearBackupSelect)return;const i=autoGearBackupSelect.value;i&&Bae(i)}),typeof autoGearAddCategorySelect<"u"&&autoGearAddCategorySelect&&autoGearAddCategorySelect.addEventListener("change",dP),typeof autoGearRemoveCategorySelect<"u"&&autoGearRemoveCategorySelect&&autoGearRemoveCategorySelect.addEventListener("change",dP);const a=(i,s)=>{if(!i)return;const l=()=>{Gae(i.value,s)};i.addEventListener("change",l),s&&(s.addEventListener("focus",l),s.addEventListener("click",l)),l()};typeof autoGearAddSelectorTypeSelect<"u"&&typeof autoGearAddSelectorDefaultInput<"u"&&a(autoGearAddSelectorTypeSelect,autoGearAddSelectorDefaultInput),typeof autoGearRemoveSelectorTypeSelect<"u"&&typeof autoGearRemoveSelectorDefaultInput<"u"&&a(autoGearRemoveSelectorTypeSelect,autoGearRemoveSelectorDefaultInput),typeof autoGearEditor<"u"&&autoGearEditor&&autoGearEditor.addEventListener("click",i=>{const s=i.target;if(s){if(s.classList.contains("auto-gear-remove-entry")){const c=s.dataset.listType==="remove"?"remove":"add",u=s.dataset.itemId;if(!autoGearEditorDraft||!u)return;const f=c==="remove"?autoGearEditorDraft.remove:autoGearEditorDraft.add,d=f.findIndex(p=>p.id===u);d>=0&&(f.splice(d,1),autoGearEditorActiveItem&&autoGearEditorActiveItem.listType===c&&autoGearEditorActiveItem.itemId===u&&Mae(c,{skipRender:!0}),F0(),_ae());return}s.classList.contains("auto-gear-edit-entry")&&Dae(s.dataset.listType,s.dataset.itemId)}})}dP();const tf=e=>{if(!e||typeof e!="object")return;try{if(typeof e.remove=="function"){e.remove();return}}catch(r){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to remove node via native remove()",r)}const t=e.parentNode;t&&typeof t.removeChild=="function"&&t.removeChild(e)},_se=()=>{const e=typeof accentColor=="string"&&accentColor?accentColor:DEFAULT_ACCENT_COLOR;return getCssVariableValue("--accent-color",e)||e},Dse=e=>{try{if(typeof computeRelativeLuminance=="function"){const t=parseColorToRgb(e);if(t)return computeRelativeLuminance(t)>.55?"#000000":"#ffffff"}}catch(t){console.warn("Failed to determine notification text color",t)}return"#ffffff"},Nse=()=>{let t=16;try{const r=document.getElementById("topBar");if(r&&typeof r.getBoundingClientRect=="function"){const n=r.getBoundingClientRect();n&&typeof n.bottom=="number"&&n.bottom>0&&(t=Math.max(t,n.bottom+16))}}catch(r){console.warn("Failed to measure top bar for notifications",r)}return`${Math.ceil(t)}px`};let tk=!1;const w1=()=>{if(tk)return;tk=!0;const e=()=>{tk=!1;try{hS()}catch(t){console.warn("Failed to ensure notification container after scheduling",t)}};typeof requestAnimationFrame=="function"?requestAnimationFrame(e):typeof setTimeout=="function"&&setTimeout(e,16)},hS=()=>{if(typeof document>"u")return null;const e="backupNotificationContainer";let t=document.getElementById(e),r=!1;if(!t&&typeof window<"u"){const o=window.__cineLoadingNotice;if(o&&typeof o.ensureContainer=="function")try{t=o.ensureContainer()}catch(a){console.warn("Failed to reuse bootstrap notification container",a),t=null}}t||(t=document.createElement("div"),t.id=e,t.style.position="fixed",t.style.right="1rem",t.style.zIndex="10000",r=!0),t.classList&&!t.classList.contains("cine-notification-stack")&&t.classList.add("cine-notification-stack"),t.dataset&&t.dataset.bootstrap&&delete t.dataset.bootstrap;const n=typeof document.body<"u"&&document.body?document.body:typeof document.documentElement<"u"?document.documentElement:null;if(n?(t.parentNode!==n&&n.appendChild(t),t.style.top=Nse()):t.parentNode||w1(),r&&typeof document.addEventListener=="function"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{try{hS()}catch(o){console.warn("Failed to ensure notification container after DOMContentLoaded",o)}},{once:!0}):w1()),typeof window<"u"){const o=window.__cineLoadingNotice;o&&typeof o=="object"&&(o.container=t)}return t};function qr(e,t){if(typeof document>"u")return;const r=hS();if(!r)return;const n=document.createElement("div");n.textContent=t,n.style.padding="0.75rem 1.25rem",n.style.marginTop="0.5rem",n.style.borderRadius="0.75rem",n.style.border="none",n.style.boxShadow="0 0.75rem 2.5rem rgba(0, 0, 0, 0.14)";const o=_se(),a=Dse(o);n.style.background=o,n.style.color=a,r.appendChild(n),setTimeout(()=>{tf(n),r.children.length||tf(r)},4e3)}const L1="cineAutoBackupIndicator",R1="cineAutoBackupSpinnerStyles";let Ay=0;const _2=()=>{if(typeof document>"u"||document.getElementById(R1))return;const e=document.createElement("style");e.id=R1,e.textContent=`@keyframes cineAutoBackupSpinnerRotate {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }`,document.head.appendChild(e)},Fse=e=>{if(typeof document>"u")return()=>{};const t=hS();if(!t)return()=>{};_2();let r=document.getElementById(L1);if(!r){r=document.createElement("div"),r.id=L1,r.style.display="flex",r.style.alignItems="center",r.style.gap="0.75rem",r.style.padding="0.75rem 1.25rem",r.style.marginTop="0.5rem",r.style.borderRadius="0.75rem",r.style.border="none",r.style.boxShadow="0 0.75rem 2.5rem rgba(0, 0, 0, 0.14)",r.style.background="rgba(32, 40, 62, 0.92)",r.style.color="#ffffff",r.setAttribute("role","status"),r.setAttribute("aria-live","polite");const o=document.createElement("span");o.style.display="inline-block",o.style.width="1.5rem",o.style.height="1.5rem",o.style.borderRadius="50%",o.style.border="0.2rem solid rgba(255, 255, 255, 0.3)",o.style.borderTopColor="#ffffff",o.style.animation="cineAutoBackupSpinnerRotate 1s linear infinite",o.setAttribute("aria-hidden","true"),r.appendChild(o);const a=document.createElement("span");a.className="auto-backup-indicator-text",r.appendChild(a),t.appendChild(r)}const n=r.querySelector(".auto-backup-indicator-text");return n&&(n.textContent=e),Ay+=1,r.dataset.count=String(Ay),r.style.display="flex",()=>{Ay=Math.max(0,Ay-1),Ay===0&&(tf(r),t.children.length||tf(t))}},Vw="cineGlobalLoadingIndicator";let cu=0;const rk={default:"globalLoadingIndicator",preparing:"globalLoadingIndicatorPreparing",modules:"globalLoadingIndicatorModules",data:"globalLoadingIndicatorData",almost:"globalLoadingIndicatorAlmostReady"},jb=e=>{if(typeof e=="string"&&e.trim())return e.trim();const t=texts&&typeof currentLang=="string"&&currentLang&&texts[currentLang]?texts[currentLang]:null,r=texts&&typeof texts.en=="object"&&texts.en?texts.en:null,n=t&&typeof t.globalLoadingIndicator=="string"?t.globalLoadingIndicator.trim():"";if(n)return n;const o=r&&typeof r.globalLoadingIndicator=="string"?r.globalLoadingIndicator.trim():"";return o||"Loading"},ad=(e,t)=>{const r=typeof e=="string"&&e.trim()?e.trim():"",n=r&&rk[r]?rk[r]:rk.default,o=texts&&typeof currentLang=="string"&&currentLang&&texts[currentLang]?texts[currentLang]:null,a=texts&&typeof texts.en=="object"&&texts.en?texts.en:null;let i="";n&&o&&typeof o[n]=="string"&&(i=o[n].trim()),!i&&n&&a&&typeof a[n]=="string"&&(i=a[n].trim());const s=typeof t=="string"&&t.trim()?t.trim():"";return!i&&s&&(i=s),i||(i=jb(s)),i||"Loading"},MM=()=>{if(typeof window>"u")return;const e=window.__cineLoadingNotice;if(!e||typeof e.applyLocalization!="function")return;const t=typeof e.getFallbackMessages=="function"?e.getFallbackMessages():{};e.applyLocalization({preparing:ad("preparing",t.preparing||""),modules:ad("modules",t.modules||""),data:ad("data",t.data||""),almost:ad("almost",t.almost||"")})},jse=()=>{if(typeof document>"u")return;const e=document.getElementById(Vw);if(!e)return;const t=e.querySelector(".global-loading-indicator-text");if(!t)return;MM();const r=e.dataset.messageMode||"auto";if(r==="custom"){const o=e.dataset.customMessage||"";o&&(t.textContent=o);return}if(r==="key"){const o=e.dataset.messageKey||"default",a=e.dataset.fallbackMessage||"",i=ad(o,a);t.textContent=i,e.dataset.currentMessage=i;return}const n=jb();t.textContent=n,e.dataset.currentMessage=n},LP=260,Hse=(e,t)=>{if(typeof document>"u")return;const r=document.getElementById(Vw);if(!r)return;const n=typeof e=="string"&&e.trim()?e.trim():"default",o=ad(n,t||""),a=r.querySelector(".global-loading-indicator-text");r.dataset.messageMode="key",r.dataset.messageKey=n,typeof t=="string"&&t.trim()?r.dataset.fallbackMessage=t.trim():delete r.dataset.fallbackMessage,r.dataset.currentMessage=o,a&&(a.textContent=o),MM()},T1=()=>typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now(),qw=e=>{if(typeof document>"u")return()=>{};const t=hS();if(!t)return()=>{};_2();const r=typeof window<"u"?window.__cineLoadingNotice:null;let n=document.getElementById(Vw);if(!n&&r&&typeof r.ensureIndicator=="function")try{n=r.ensureIndicator()}catch(f){console.warn("Failed to adopt bootstrap loading indicator",f),n=null}n||(n=document.createElement("div"),n.id=Vw),n.setAttribute("role","status"),n.setAttribute("aria-live","polite"),n.setAttribute("aria-busy","true"),n.dataset&&n.dataset.bootstrap&&delete n.dataset.bootstrap,n.classList?n.classList.add("cine-notification","cine-notification--loading"):n.className=[n.className||"","cine-notification","cine-notification--loading"].join(" ").trim();let o=n.querySelector(".cine-notification__spinner");o||(o=document.createElement("span"),o.className="cine-notification__spinner",o.setAttribute("aria-hidden","true"),n.insertBefore(o,n.firstChild));let a=n.querySelector(".global-loading-indicator-text");if(a||(a=document.createElement("span"),a.className="global-loading-indicator-text",n.appendChild(a)),n.parentNode!==t&&t.appendChild(n),r&&typeof r.setBusy=="function")try{r.setBusy(!0)}catch(f){console.warn("Failed to mark bootstrap loading indicator busy",f)}MM();const i=!!(e&&typeof e=="string"&&e.trim());let s;i?(s=jb(e),n.dataset.messageMode="custom",n.dataset.customMessage=s):n.dataset.messageMode==="key"&&n.dataset.messageKey?(s=ad(n.dataset.messageKey,n.dataset.fallbackMessage||""),n.dataset.currentMessage=s,n.dataset.customMessage=""):(s=jb(),n.dataset.messageMode="auto",n.dataset.customMessage="",n.dataset.currentMessage=s),a&&(a.textContent=s),r&&typeof r.ensureIndicator=="function"&&(r.indicator=n),cu=Math.max(0,cu),cu+=1,n.dataset.count=String(cu),n.style.display="flex";const l=T1();let c=!1;const u=()=>{if(!c&&(c=!0,cu=Math.max(0,cu-1),n.dataset.count=String(cu),cu===0)){if(n.setAttribute("aria-busy","false"),r&&typeof r.setBusy=="function")try{r.setBusy(!1)}catch(f){console.warn("Failed to clear bootstrap loading indicator busy state",f)}tf(n),t.children.length||tf(t),r&&typeof r=="object"&&(r.indicator=null)}};return()=>{if(c)return;const f=T1()-l;if(f<LP){const d=LP-f;if(typeof setTimeout=="function"){setTimeout(u,Math.max(16,d));return}}u()}};try{const e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:null;e&&(e.__cineShowAutoBackupIndicator=Fse,e.__cineShowGlobalLoadingIndicator=qw,e.__cineSetGlobalLoadingIndicatorMessageKey=Hse)}catch(e){console.warn("Failed to expose auto backup indicator helper",e)}const Use=()=>{const e=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:null;if(!e||typeof e.fetch!="function"||e.__cineFetchWithLoadingIndicatorInstalled)return;const t=e.fetch,r=()=>jb(),n=typeof e.__cineShowGlobalLoadingIndicator=="function"?e.__cineShowGlobalLoadingIndicator:qw,o=a=>{if(typeof a=="function")try{a()}catch(i){console.warn("Failed to hide global loading indicator after fetch",i)}};e.fetch=function(i,s){let l=null;try{l=n(r())}catch(u){console.warn("Failed to show global loading indicator before fetch",u),l=null}let c;try{c=t.apply(this,arguments)}catch(u){throw o(l),u}return!c||typeof c.then!="function"?(o(l),c):typeof c.finally=="function"?c.finally(()=>{o(l)}):c.then(u=>(o(l),u),u=>{throw o(l),u})},e.__cineFetchWithLoadingIndicatorInstalled=!0};try{Use()}catch(e){console.warn("Failed to install global loading indicator for fetch",e)}typeof window<"u"&&typeof window.addEventListener=="function"&&window.addEventListener("languagechange",()=>{try{jse()}catch(e){console.warn("Failed to refresh global loading indicator after language change",e)}});const zse=480;let jm=null,Nh=!1,RP=!1;const D2=()=>{if(!(Nh||RP)&&typeof qw=="function")try{const e=qw();typeof e=="function"?jm=e:jm=null,Nh=!0}catch(e){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to show initial global loading indicator",e),jm=null,Nh=!1}},nk=()=>{const e=jm;if(jm=null,Nh=!1,typeof e=="function")try{e()}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to hide initial global loading indicator",t)}},N2=()=>{if(RP||(RP=!0,!Nh&&!jm))return;const e=()=>{if(typeof requestIdleCallback=="function"){requestIdleCallback(nk,{timeout:zse});return}if(typeof setTimeout=="function"){setTimeout(nk,LP);return}nk()};typeof requestAnimationFrame=="function"?requestAnimationFrame(e):e()};function gn(e,t=""){if(typeof e!="string"||!e)return typeof t=="string"?t:`${t??""}`;const r=typeof t=="string"?t:`${t??""}`,n=texts&&typeof currentLang=="string"&&currentLang&&texts[currentLang]?texts[currentLang]:null,o=texts&&typeof texts.en=="object"?texts.en:null,a=l=>{if(!l||typeof l!="object"||!Object.prototype.hasOwnProperty.call(l,e))return null;const c=l[e];if(typeof c!="string")return null;const u=c.trim();return u||null},i=a(n);if(i)return i;const s=a(o);return s||r}function $se(e,t){if(!(e instanceof Date)||Number.isNaN(e.valueOf()))return"";const r=typeof currentLang=="string"&&currentLang?currentLang:"en",n={year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"};t&&(n.second="2-digit");try{return new Intl.DateTimeFormat(r,n).format(e)}catch(o){if(r!=="en")try{return new Intl.DateTimeFormat("en",n).format(e)}catch(a){console.warn("Date formatting failed for comparison timestamp",o,a)}else console.warn("Date formatting failed for comparison timestamp",o)}return e.toISOString()}function Vse(e,t){if(typeof e!="string")return"";const r=t||parseAutoBackupName(e);if(!r)return`${gn("versionCompareManualLabel","Manual save")}  ${e}`;const n=r.type==="auto-backup-before-delete"?gn("versionCompareAutoDeleteLabel","Auto backup before delete"):gn("versionCompareAutoLabel","Auto backup"),o=$se(r.date,r.includeSeconds),a=r.label?`  ${r.label}`:"";return o?`${n}  ${o}${a}`:`${n}${a?`  ${a}`:""}`}function qse(){const e=[],t=typeof getSetups=="function"?getSetups():{};if(t&&typeof t=="object"){const r=Object.keys(t).filter(n=>typeof n=="string"&&n).map(n=>{const o=parseAutoBackupName(n),a=Vse(n,o),i=o&&o.date instanceof Date&&!Number.isNaN(o.date.valueOf());return{value:n,label:a,data:t[n],parsed:o,timestamp:i?o.date.getTime():null}}).sort((n,o)=>{const a=!!n.parsed,i=!!o.parsed;if(a!==i)return a?1:-1;if(a&&i){const s=typeof n.timestamp=="number"?n.timestamp:null,l=typeof o.timestamp=="number"?o.timestamp:null;if(s!==null&&l!==null&&s!==l)return l-s;if(s!==null&&l===null)return-1;if(s===null&&l!==null)return 1}return localeSort(n.label,o.label)}).map(({parsed:n,timestamp:o,...a})=>a);e.push(...r)}return e}function O1(e,t,r){if(!e)return;const n=gn("versionCompareSelectPlaceholder","Select a version"),o=document.createDocumentFragment(),a=document.createElement("option");a.value="",a.textContent=n,a.disabled=t.length>0,a.selected=!0,o.appendChild(a),t.forEach(i=>{const s=document.createElement("option");s.value=i.value,s.textContent=i.label,o.appendChild(s)}),e.innerHTML="",e.appendChild(o),r&&t.some(i=>i.value===r)?(e.value=r,a.selected=!1):e.value=""}function LE(){_m&&(_m.innerHTML=""),Dm&&(Dm.hidden=!0)}function Kse(e){if(typeof e!="string")return String(e);const t=e.replace(/[_\s-]+/g," ").replace(/([a-z\d])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z][a-z])/g,"$1 $2").trim();return t?t.split(" ").map(r=>!r||r.length>3&&r===r.toUpperCase()?r:/^\d+$/.test(r)?Vd(Number(r)):r.charAt(0).toUpperCase()+r.slice(1)).join(" "):e}function F2(e){if(typeof e!="string")return String(e);if(typeof humanizeKey=="function")try{const t=humanizeKey(e);if(typeof t=="string"&&t)return t}catch(t){console.warn("Failed to humanize diff key via humanizeKey",t)}return Kse(e)}const Wse=["name","label","title","id","uuid","key","slug"],Yse={id:"ID",uuid:"UUID"},Qse=new Set(["name","label","title"]);function j2(e){if(e===null)return!0;const t=typeof e;return t==="string"||t==="number"||t==="boolean"}function x1(e){if(!Array.isArray(e))return!1;for(let t=0;t<e.length;t+=1)if(!j2(e[t]))return!1;return!0}function TP(e){return e===null?"primitive:null":typeof e=="number"?Number.isNaN(e)?"primitive:number:NaN":Object.is(e,-0)?"primitive:number:-0":`primitive:number:${e}`:typeof e=="string"?`primitive:string:${e}`:typeof e=="boolean"?`primitive:boolean:${e}`:`primitive:other:${String(e)}`}function k1(e){const t=new Map;if(!Array.isArray(e))return t;for(let r=0;r<e.length;r+=1){const n=e[r];if(!j2(n))continue;const o=TP(n);t.has(o)||t.set(o,{value:n,count:0});const a=t.get(o);a.count+=1}return t}function I1(e){if(typeof e=="number"){if(Number.isNaN(e))return"NaN";if(!Number.isFinite(e))return e>0?"Infinity":"-Infinity";if(Object.is(e,-0))return"-0"}return e}function jA(e,t){let r;try{r=JSON.stringify(t)}catch(n){console.warn("Failed to serialize keyed diff path value",n);try{r=JSON.stringify(String(t))}catch(o){console.warn("Failed to stringify keyed diff fallback value",o),r='"?"'}}return`[${e}=${r}]`}function H2(e){if(typeof e!="string")return null;const t=e.match(/^\[([^=[\]]+)=([\s\S]+)\]$/);if(!t)return null;const r=t[1],n=t[2];try{return{key:r,value:JSON.parse(n)}}catch(o){return console.warn("Failed to parse keyed diff path segment",e,o),{key:r,value:n}}}function U2(e,t){if(!Array.isArray(e)||!Array.isArray(t))return null;const r=[e,t];for(const n of Wse){let o=!1,a=!0;const i=r.map(()=>new Set);for(let s=0;s<r.length&&a;s+=1){const l=r[s];for(let c=0;c<l.length;c+=1){const u=l[c];if(!Rt(u)){a=!1;break}if(!Object.prototype.hasOwnProperty.call(u,n)){a=!1;break}const f=u[n];if(f==null){a=!1;break}if(typeof f!="string"&&typeof f!="number"){a=!1;break}o=!0;const d=String(f),p=i[s];if(p.has(d)){a=!1;break}p.add(d)}}if(a&&o)return n}return null}function P1(e,t){const r=new Map,n=[];return Array.isArray(e)?(e.forEach(o=>{if(!Rt(o))return;const a=o[t];if(a==null||typeof a!="string"&&typeof a!="number")return;const i=String(a);r.has(i)||(r.set(i,{value:o,keyValue:a}),n.push(i))}),{map:r,order:n}):{map:r,order:n}}function z2(e){if(typeof e!="string")return null;const t=e.match(/^\[(\d+)\]$/);if(t){const n=Number(t[1]);return!Number.isFinite(n)||n<0?null:gn("versionCompareListItemLabel","Item %s").replace("%s",Vd(n+1))}const r=H2(e);if(r){const{key:n,value:o}=r;let a;if(typeof o=="number"&&Number.isFinite(o))a=Vd(o);else if(typeof o=="string")a=o;else if(o===null)a="null";else try{a=JSON.stringify(o)}catch(u){console.warn("Failed to stringify keyed diff value",u),a=String(o)}const s=gn("versionCompareListItemLabel","Item %s").replace("%s",a);if(Qse.has(n))return s;const c=Yse[n]||F2(n);return c?`${c}  ${s}`:s}return null}function Xse(e){const t=z2(e);return t||(typeof e!="string"?String(e):F2(e))}function $2(e){return!Array.isArray(e)||!e.length?gn("versionCompareRootPath","Entire setup"):e.map(Xse).join("  ")}function Jse(e,t){return e===t?!0:Number.isNaN(e)&&Number.isNaN(t)}function _M(e,t){const r=[];function n(o,a,i){if(Jse(o,a))return;const s=Rt(o),l=Rt(a);if(s&&l){new Set([...Object.keys(o),...Object.keys(a)]).forEach(p=>{const h=Object.prototype.hasOwnProperty.call(o,p),m=Object.prototype.hasOwnProperty.call(a,p);h?m?n(o[p],a[p],i.concat(p)):r.push({type:"removed",path:i.concat(p),before:o[p],after:void 0}):r.push({type:"added",path:i.concat(p),before:void 0,after:a[p]})});return}const c=Array.isArray(o),u=Array.isArray(a);if(c&&u){const d=U2(o,a);if(d){const{map:h,order:m}=P1(o,d),{map:g,order:S}=P1(a,d),y=[],E=new Set,L=v=>{E.has(v)||(E.add(v),y.push(v))};m.forEach(L),S.forEach(L),y.forEach(v=>{const A=h.get(v)||null,R=g.get(v)||null,I=A?A.keyValue:R?R.keyValue:v,C=i.concat(jA(d,I));!A&&R?r.push({type:"added",path:C,before:void 0,after:R.value}):A&&!R?r.push({type:"removed",path:C,before:A.value,after:void 0}):A&&R&&n(A.value,R.value,C)});return}if(x1(o)&&x1(a)){const h=k1(o),m=k1(a),g=[],S=new Set,y=E=>{S.has(E)||(S.add(E),g.push(E))};for(let E=0;E<o.length;E+=1)y(TP(o[E]));for(let E=0;E<a.length;E+=1)y(TP(a[E]));g.forEach(E=>{const L=h.get(E)||null,v=m.get(E)||null,A=L?L.count:0,R=v?v.count:0;if(R>A){const I=v?v.value:void 0,C=R-A;for(let k=0;k<C;k+=1)r.push({type:"added",path:i.concat(jA("value",I1(I))),before:void 0,after:I})}if(A>R){const I=L?L.value:void 0,C=A-R;for(let k=0;k<C;k+=1)r.push({type:"removed",path:i.concat(jA("value",I1(I))),before:I,after:void 0})}});return}const p=Math.max(o.length,a.length);for(let h=0;h<p;h+=1){const m=h<o.length,g=h<a.length,S=i.concat(`[${h}]`);m?g?n(o[h],a[h],S):r.push({type:"removed",path:S,before:o[h],after:void 0}):r.push({type:"added",path:S,before:void 0,after:a[h]})}return}if(!s&&!c&&(l||u)){r.push({type:"changed",path:i,before:o,after:a});return}if((s||c)&&!l&&!u){r.push({type:"changed",path:i,before:o,after:a});return}const f=o===void 0?"added":a===void 0?"removed":"changed";r.push({type:f,path:i,before:o,after:a})}return n(e,t,[]),r}function Zse(e,t){const r=document.createElement("pre");if(r.className="diff-value",t&&(r.className+=` diff-value-${t}`),e===void 0)return r.textContent=gn("versionCompareMissingValue","Not present"),r;if(e===null)return r.textContent="null",r;if(typeof e=="string")return r.textContent=e,r;if(typeof e=="number"||typeof e=="boolean")return r.textContent=String(e),r;try{r.textContent=JSON.stringify(e,null,2)}catch(n){console.warn("Failed to stringify diff value",n),r.textContent=String(e)}return r}function Cy(e,t,r){const n=document.createElement("div");n.className="diff-change",r&&n.classList.add(`diff-change-${r}`);const o=document.createElement("span");return o.className="diff-label",o.textContent=e,n.appendChild(o),n.appendChild(Zse(t,r)),n}function V2(e){const t=document.createElement("span");t.className="diff-label diff-status-badge";let r="changed",n="versionCompareChangeUpdated",o="Updated";return e==="added"?(r="added",n="versionCompareChangeAdded",o="Added"):e==="removed"?(r="removed",n="versionCompareChangeRemoved",o="Removed"):e==="changed"&&(r="changed",n="versionCompareChangeUpdated",o="Updated"),t.classList.add(`diff-status-${r}`),t.textContent=gn(n,o),t}function ele(e){if(!Array.isArray(e))return[];const t={changed:0,added:1,removed:2},r=typeof localeSort=="function"?(n,o)=>localeSort(n,o):(n,o)=>n.localeCompare(o);return e.map(n=>({entry:n,pathText:$2(n&&n.path),rank:n&&n.type&&Object.prototype.hasOwnProperty.call(t,n.type)?t[n.type]:3})).sort((n,o)=>n.rank!==o.rank?n.rank-o.rank:r(n.pathText,o.pathText))}function tle(e){if(!_m||!Dm)return;if(_m.innerHTML="",!Array.isArray(e)||!e.length){Dm.hidden=!0;return}Dm.hidden=!1,ele(e).forEach(({entry:r,pathText:n})=>{if(!r)return;const o=document.createElement("li"),a=r.type?` diff-${r.type}`:"";o.className=`diff-entry${a}`;const i=document.createElement("div");i.className="diff-entry-header";const s=document.createElement("div");s.className="diff-path",s.textContent=n,i.appendChild(s),i.appendChild(V2(r.type)),o.appendChild(i);const l=document.createElement("div");l.className="diff-change-group",r.type==="changed"?(l.classList.add("diff-change-group--split"),l.appendChild(Cy(gn("versionCompareChangeRemoved","Removed"),r.before,"removed")),l.appendChild(Cy(gn("versionCompareChangeAdded","Added"),r.after,"added"))):r.type==="added"?l.appendChild(Cy(gn("versionCompareChangeAdded","Added"),r.after,"added")):r.type==="removed"?l.appendChild(Cy(gn("versionCompareChangeRemoved","Removed"),r.before,"removed")):l.appendChild(Cy(gn("versionCompareChangeUpdated","Updated"),r.after,"changed")),l.childNodes.length&&o.appendChild(l),_m.appendChild(o)})}function rle(e){return gn(e===1?"versionCompareDifferencesCountOne":"versionCompareDifferencesCountOther",e===1?"%s difference noted.":"%s differences noted.").replace("%s",Vd(e))}function ok(e,t){return gn(e,"%s").replace("%s",Vd(t))}function nle(e){if(!Tc)return;if(!Array.isArray(e)||!e.length){Tc.textContent=gn("versionCompareIdentical","Versions matchno changes detected.");return}const t={added:0,removed:0,changed:0};e.forEach(o=>{o&&o.type&&Object.prototype.hasOwnProperty.call(t,o.type)&&(t[o.type]+=1)});const r=rle(e.length),n=[];t.added&&n.push(ok("versionCompareSummaryAdded",t.added)),t.removed&&n.push(ok("versionCompareSummaryRemoved",t.removed)),t.changed&&n.push(ok("versionCompareSummaryChanged",t.changed)),Tc.textContent=n.length?`${r} (${n.join("  ")})`:r}function q2(){if(!Tc)return;if(!Mu.length){LE(),Tc.textContent=gn("versionCompareEmpty","Save a project or wait for auto-backups to start comparing versions."),Ws&&(Ws.disabled=!0),ks&&(ks.disabled=!0);return}ks&&(ks.disabled=!1);const e=fc.baseline,t=fc.comparison;if(!e||!t){LE(),Tc.textContent=gn("versionCompareNoSelection","Choose two versions to generate a diff."),Ws&&(Ws.disabled=!0);return}if(e===t){LE(),Tc.textContent=gn("versionCompareSameSelection","Select two different versions to compare."),Ws&&(Ws.disabled=!0);return}const r=new Map(Mu.map(i=>[i.value,i])),n=r.get(e),o=r.get(t);if(!n||!o){LE(),Tc.textContent=gn("versionCompareMissingSelection","Select two versions before exporting a log."),Ws&&(Ws.disabled=!0);return}const a=_M(n.data,o.data);tle(a),nle(a),Ws&&(Ws.disabled=!1)}function ole(){const e=(o,a)=>o||(typeof document<"u"?document.getElementById(a):null),t=e(Mm,"backupDiffPrimary"),r=e(bM,"backupDiffSecondary"),n=e(E2,"backupDiffEmptyState");Mu=qse(),O1(t,Mu,fc.baseline),O1(r,Mu,fc.comparison),n&&(n.hidden=Mu.length>0),q2()}function id(e={}){vi&&(vi.hasAttribute("hidden")||vi.setAttribute("hidden",""),Gb&&Gb.setAttribute("aria-expanded","false"),e.resetSelections&&(fc.baseline="",fc.comparison=""),e.resetNotes&&ks&&(ks.value=""))}function OP(){if(vi&&(ole(),vi.removeAttribute("hidden"),Gb&&Gb.setAttribute("aria-expanded","true"),Mm))try{Mm.focus({preventScroll:!0})}catch{Mm.focus()}}function ale(){vi&&(vi.hasAttribute("hidden")?OP():id())}function B1(e){const t=e&&e.target?e.target:null;if(!t)return;const r=typeof t.value=="string"?t.value:"";t===Mm?fc.baseline=r:t===bM&&(fc.comparison=r),q2()}function G1(e){return typeof e!="string"?"manual":e.startsWith(SESSION_AUTO_BACKUP_DELETION_PREFIX)?"auto-backup-before-delete":e.startsWith(SESSION_AUTO_BACKUP_NAME_PREFIX)?"auto-backup":"manual"}function M1(e){if(e!==void 0)try{return yM(e)}catch(t){return console.warn("Failed to clone comparison snapshot for export",t),e}}function ile(){if(!Mu.length){qr("warning",gn("versionCompareEmpty","Save a project or wait for auto-backups to start comparing versions."));return}const e=fc.baseline,t=fc.comparison;if(!e||!t||e===t){qr("warning",gn("versionCompareMissingSelection","Select two versions before exporting a log."));return}const r=new Map(Mu.map(m=>[m.value,m])),n=r.get(e),o=r.get(t);if(!n||!o){qr("warning",gn("versionCompareMissingSelection","Select two versions before exporting a log."));return}const a=_M(n.data,o.data),i={added:0,removed:0,changed:0};a.forEach(m=>{m&&m.type&&Object.prototype.hasOwnProperty.call(i,m.type)&&(i[m.type]+=1)});const s=ks&&typeof ks.value=="string"?ks.value.trim():"",l=new Date,{iso:c}=formatFullBackupFilename(l),f=`cine-power-planner-version-log-${c.replace(/[:]/g,"-")}.json`,d={type:"cine-power-planner-version-log",version:1,createdAt:new Date().toISOString(),appVersion:typeof es=="string"?es:$c(typeof APP_VERSION=="string"?APP_VERSION:null),baseline:{id:n.value,label:n.label,type:G1(n.value),snapshot:M1(n.data)},comparison:{id:o.value,label:o.label,type:G1(o.value),snapshot:M1(o.data)},summary:{totalDifferences:a.length,added:i.added,removed:i.removed,updated:i.changed},differences:a.map(m=>({type:m.type,path:m.path,before:m.before,after:m.after}))};s&&(d.note=s);let p;try{p=JSON.stringify(d,null,2)}catch(m){console.warn("Failed to serialize comparison export payload",m),qr("error",gn("versionCompareExportFailure","Comparison export failed."));return}const h=downloadBackupPayload(p,f);h&&h.success?qr("success",gn("versionCompareExportSuccess","Comparison log exported.")):qr("error",gn("versionCompareExportFailure","Comparison export failed."))}function _1(e){if(typeof e!="function")return{showAutoBackups:!1,accentColor:null,language:null};const t=e(hM);if(t)try{mR(t,{persist:!1})}catch(l){console.warn("Failed to apply restored temperature unit preference",l)}const r=typeof FOCUS_SCALE_STORAGE_KEY_NAME=="string"&&FOCUS_SCALE_STORAGE_KEY_NAME||typeof globalThis<"u"&&globalThis&&typeof globalThis.FOCUS_SCALE_STORAGE_KEY_NAME=="string"&&globalThis.FOCUS_SCALE_STORAGE_KEY_NAME||"cameraPowerPlanner_focusScale",n=e(r);let o=null;if(n){let l=null;if(typeof normalizeFocusScale=="function")try{l=normalizeFocusScale(n)}catch(c){console.warn("Failed to normalize restored focus scale preference",c)}if((typeof l!="string"||!l)&&(l=typeof n=="string"?n.trim().toLowerCase():""),l==="metric"||l==="imperial"){o=l;try{typeof applyFocusScalePreference=="function"&&applyFocusScalePreference(l,{persist:!1,forceUpdate:!0})}catch(c){console.warn("Failed to apply restored focus scale preference",c)}ws=l;try{typeof settingsFocusScale<"u"&&settingsFocusScale&&(settingsFocusScale.value=l)}catch(c){console.warn("Failed to sync restored focus scale selection",c)}if(typeof al=="function")try{al()}catch(c){console.warn("Failed to update focus scale baseline after restore",c)}if(typeof globalThis<"u"&&globalThis)try{globalThis.focusScalePreference=l}catch(c){console.warn("Failed to update global focus scale preference",c)}if(typeof focusScalePreference<"u")try{focusScalePreference=l}catch(c){console.warn("Failed to update scoped focus scale preference",c)}}}try{yS(e("darkMode")==="true",{persist:!0})}catch(l){console.warn("Failed to apply restored dark mode preference",l)}try{let l=e(G2);(l==null||l==="")&&(l=e(M2)),Ag(l==="true")}catch(l){console.warn("Failed to apply restored pink mode preference",l)}try{qd(e("highContrast")==="true")}catch(l){console.warn("Failed to apply restored high contrast preference",l)}try{Mw(e("reduceMotion")==="true")}catch(l){console.warn("Failed to apply restored reduce motion preference",l)}try{_w(e("relaxedSpacing")==="true")}catch(l){console.warn("Failed to apply restored relaxed spacing preference",l)}const a=e("showAutoBackups")==="true",i=e("accentColor");if(i){try{document.documentElement.style.setProperty("--accent-color",i),document.documentElement.style.setProperty("--link-color",i)}catch(l){console.warn("Failed to apply restored accent color",l)}accentColor=i,prevAccentColor=i,accentColorInput&&(accentColorInput.value=i),typeof updateAccentColorResetButtonState=="function"&&updateAccentColorResetButtonState()}const s=e("language");try{const l=typeof getMountVoltageStorageKeyName=="function"?getMountVoltageStorageKeyName():"cameraPowerPlanner_mountVoltages",c=e(l);let u=parseStoredMountVoltages(c),f=!1;if(!u){const d=typeof getMountVoltageStorageBackupKeyName=="function"?getMountVoltageStorageBackupKeyName():`${l}__backup`,p=e(d);if(p!=null){const h=parseStoredMountVoltages(p);h&&(u=h,f=!0)}}if(u){applySessionMountVoltagePreferences(u,{persist:f,triggerUpdate:!0});const d=Qc("updateMountVoltageInputsFromState");if(d)try{d()}catch(p){Os("updateMountVoltageInputsFromState",p)}else Os("updateMountVoltageInputsFromState");ql()}}catch(l){console.warn("Failed to apply restored mount voltage preferences",l)}return{showAutoBackups:a,accentColor:i||null,language:s||null,focusScale:o}}function sle(){return{value:ur?ur.value:"",name:Kt?Kt.value:""}}function D1(e,t){if(!e||typeof e!="object")return;const{value:r="",name:n=""}=e;if(ur)try{t||!r||!r.startsWith("auto-backup-")?ur.value=r:ur.value=""}catch(o){console.warn("Failed to restore setup selection after restore",o)}if(Kt)try{Kt.value=n||""}catch(o){console.warn("Failed to restore setup name after restore",o)}}const lle=[{key:"devices",loaderName:"loadDeviceData",isValid:e=>e===null||Rt(e),loader:()=>typeof loadDeviceData=="function"?loadDeviceData():void 0},{key:"setups",loaderName:"loadSetups",isValid:e=>Rt(e),loader:()=>typeof loadSetups=="function"?loadSetups():void 0},{key:"session",loaderName:"loadSessionState",isValid:e=>e===null||Rt(e),loader:()=>typeof ww=="function"?ww():void 0},{key:"feedback",loaderName:"loadFeedback",isValid:e=>e===null||Rt(e),loader:()=>typeof loadFeedback=="function"?loadFeedback():void 0},{key:"project",loaderName:"loadProject",isValid:e=>Rt(e),loader:()=>typeof uc=="function"?uc():void 0},{key:"favorites",loaderName:"loadFavorites",isValid:e=>Rt(e),loader:()=>typeof loadFavorites=="function"?loadFavorites():void 0},{key:"documentationTracker",loaderName:"loadDocumentationTracker",isValid:e=>e===null||Rt(e)&&Array.isArray(e.releases)||Array.isArray(e),loader:()=>typeof O0=="function"?O0():void 0},{key:"autoGearBackups",loaderName:"loadAutoGearBackups",isValid:e=>Array.isArray(e),loader:()=>typeof loadAutoGearBackups=="function"?loadAutoGearBackups():void 0},{key:"autoGearPresets",loaderName:"loadAutoGearPresets",isValid:e=>Array.isArray(e),loader:()=>typeof loadAutoGearPresets=="function"?loadAutoGearPresets():void 0},{key:"autoGearMonitorDefaults",loaderName:"loadAutoGearMonitorDefaults",isValid:e=>Rt(e),loader:()=>typeof T0=="function"?T0():void 0},{key:"autoGearSeeded",loaderName:"loadAutoGearSeedFlag",isValid:e=>typeof e=="boolean",loader:()=>typeof loadAutoGearSeedFlag=="function"?loadAutoGearSeedFlag():void 0},{key:"autoGearActivePresetId",loaderName:"loadAutoGearActivePresetId",isValid:e=>typeof e=="string",loader:()=>typeof loadAutoGearActivePresetId=="function"?loadAutoGearActivePresetId():void 0},{key:"autoGearAutoPresetId",loaderName:"loadAutoGearAutoPresetId",isValid:e=>typeof e=="string",loader:()=>typeof loadAutoGearAutoPresetId=="function"?loadAutoGearAutoPresetId():void 0},{key:"autoGearShowBackups",loaderName:"loadAutoGearBackupVisibility",isValid:e=>typeof e=="boolean",loader:()=>typeof loadAutoGearBackupVisibility=="function"?loadAutoGearBackupVisibility():void 0},{key:"autoGearBackupRetention",loaderName:"loadAutoGearBackupRetention",isValid:e=>typeof e=="number"&&Number.isFinite(e),loader:()=>typeof loadAutoGearBackupRetention=="function"?loadAutoGearBackupRetention():void 0},{key:"fullBackupHistory",loaderName:"loadFullBackupHistory",isValid:e=>Array.isArray(e),loader:()=>typeof loadFullBackupHistory=="function"?loadFullBackupHistory():void 0}];function Sl(e){if(!e)return null;if(typeof e=="string")return e;if(typeof e.message=="string"&&e.message.trim())return e.message;try{return JSON.stringify(e)}catch{}try{return String(e)}catch{}return null}function Qs(e,t,r,n={}){if(!Array.isArray(e))return;const o={section:t,status:r};if(n.source&&typeof n.source=="string"&&(o.source=n.source),typeof n.message=="string"){const a=n.message.trim();a&&(o.message=a)}e.push(o)}function cle(e,t){!e||typeof e!="object"||lle.forEach(({key:r,loader:n,loaderName:o,isValid:a})=>{const i=e[r];if(!a(i)&&typeof n=="function")try{const s=n();if(s===void 0){Qs(t,r,"missing",{source:o});return}e[r]=s,Qs(t,r,"recovered",{source:o})}catch(s){console.warn(`Failed to recover ${r} for full backup`,s);const l=Sl(s);Qs(t,r,"error",{source:o,message:l})}})}function ule(e,t){const r=Array.isArray(e)?e.slice():[];if(!Array.isArray(t)||!t.length)return{combined:r,changed:!1};const n=new Set(r.map(a=>a&&typeof a.id=="string"?a.id:null).filter(Boolean));let o=!1;return t.forEach(a=>{if(!a)return;const i=a&&typeof a.id=="string"?a.id:null;i&&n.has(i)||(i&&n.add(i),r.push(a),o=!0)}),{combined:r,changed:o}}async function fle(){const e=[];let t={},r=!1,n=!1;if(typeof prepareBackupForExport=="function")try{await prepareBackupForExport()}catch(a){console.warn("Failed to prepare backup vault cache",a)}if(typeof exportAllData=="function"){r=!0;try{t=exportAllData()}catch(a){n=!0,console.warn("Failed to collect planner data for full backup",a);const i=Sl(a);Qs(e,"exportAllData","error",{source:"exportAllData",message:i}),t={}}}else Qs(e,"exportAllData","missing",{source:"exportAllData"});let o={};if(Rt(t)?o={...t}:r&&!n&&t&&typeof t=="object"?(o={...t},Qs(e,"exportAllData","coerced",{source:"exportAllData"})):(r&&!n&&Qs(e,"exportAllData","invalid",{source:"exportAllData"}),o={}),cle(o,e),!Array.isArray(o.autoGearRules)){let a=null,i="",s=!1;if(typeof getBaseAutoGearRules=="function")try{const c=getBaseAutoGearRules();Array.isArray(c)&&(a=c.slice(),i="getBaseAutoGearRules",s=!0)}catch(c){console.warn("Failed to capture automatic gear rules from state for full backup",c);const u=Sl(c);Qs(e,"autoGearRules","error",{source:"getBaseAutoGearRules",message:u})}let l=null;if(typeof loadAutoGearRules=="function")try{l=loadAutoGearRules()}catch(c){console.warn("Failed to load automatic gear rules from storage for full backup",c);const u=Sl(c);Qs(e,"autoGearRules","error",{source:"loadAutoGearRules",message:u})}if(Array.isArray(l)&&l.length)if(!Array.isArray(a)||!a.length)a=l,i="loadAutoGearRules",s=!0;else{const{combined:c,changed:u}=ule(a,l);a=c,u&&(s=!0,i=i?`${i}+loadAutoGearRules`:"loadAutoGearRules")}Array.isArray(a)?(o.autoGearRules=a,Qs(e,"autoGearRules",s?"recovered":"preserved",{source:i||(Array.isArray(l)&&l.length?"loadAutoGearRules":"")})):(o.autoGearRules=[],Qs(e,"autoGearRules","defaulted"))}return{data:o,diagnostics:e}}async function K2(e=new Date){const{iso:t,fileName:r}=formatFullBackupFilename(e),n=resolveSafeLocalStorage(),o=captureStorageSnapshot(n),a=captureStorageSnapshot(typeof sessionStorage<"u"?sessionStorage:null),{data:i,diagnostics:s}=await fle(),c={version:es||$c(typeof APP_VERSION=="string"?APP_VERSION:null)||void 0,generatedAt:t,settings:o,sessionStorage:Object.keys(a).length?a:void 0,data:i};Array.isArray(s)&&s.length&&(c.diagnostics=s);const u=JSON.stringify(c);return{fileName:r,payload:u,iso:t,backup:c,diagnostics:s}}async function Kw(e=!0,t=new Date,r={}){try{const n=typeof r=="object"&&r!==null?r:{},o=e&&typeof e=="object"&&typeof e.type=="string",a=n.deferDownload?!1:o?!0:!!e,{fileName:i,payload:s,iso:l}=await K2(t);if(n.deferDownload)return{fileName:i,payload:s,createdAt:l};const c=downloadBackupPayload(s,i);if(!c||!c.success&&!c.queued)throw new Error("No supported download method available");if(c.success){try{yP({createdAt:l,fileName:i})}catch(u){console.warn("Failed to record full backup history entry",u)}if(c.method==="window-fallback"){const u=d2();qr("warning",u),typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Download Blocked",message:u}):typeof alert=="function"&&alert(u)}else a&&qr("success","Full app backup downloaded")}else c.queued&&c.queueMessage&&qr("warning",c.queueMessage);return{fileName:i,downloadResult:c}}catch(n){return console.warn("Backup failed",n),e&&qr("error","Backup failed"),null}}function Hb(e=!0,t=new Date){let r=e,n=t;return e&&typeof e=="object"&&(e instanceof Event||e.type)&&(r=!0,n=new Date),Kw(r,n).then(o=>o?o.fileName:null)}typeof backupSettings<"u"&&backupSettings&&backupSettings.addEventListener("click",Hb);const N1=typeof document<"u"?document.getElementById("storageBackupNow"):null;N1&&N1.addEventListener("click",Hb);const Xs=typeof document<"u"?document.getElementById("storagePersistenceRequest"):null,pi=typeof document<"u"?document.getElementById("storagePersistenceStatus"):null,W2=typeof document<"u"?document.getElementById("loggingSection"):null,wy=typeof document<"u"?document.getElementById("loggingHistory"):null,RE=typeof document<"u"?document.getElementById("loggingStatus"):null,uu=typeof document<"u"?document.getElementById("loggingEmpty"):null,nm=typeof document<"u"?document.getElementById("loggingUnavailable"):null,mu=typeof document<"u"?document.getElementById("loggingLevelFilter"):null,nh=typeof document<"u"?document.getElementById("loggingNamespaceFilter"):null,F1=typeof document<"u"?document.getElementById("loggingNamespaceFilterHelp"):null,Dl=typeof document<"u"?document.getElementById("loggingHistoryLimit"):null,TE=typeof document<"u"?document.getElementById("loggingHistoryLimitHelp"):null,DM=typeof document<"u"?document.getElementById("loggingConsoleOutput"):null,NM=typeof document<"u"?document.getElementById("loggingCaptureConsole"):null,FM=typeof document<"u"?document.getElementById("loggingCaptureErrors"):null,jM=typeof document<"u"?document.getElementById("loggingPersistSession"):null,Js=typeof document<"u"?document.getElementById("loggingExportBtn"):null,ht={supported:null,persisted:null,usage:null,quota:null,checking:!1,requestInFlight:!1,requestAttempted:!1,lastRequestDenied:!1,lastError:null,lastLoggedUsage:null,lastLoggedQuota:null,lastLoggedSupported:null,lastLoggedPersisted:null,lastLoggedSummary:null};let ak=0;function dle(e={}){const{fromRequest:t=!1}=e||{},r=typeof ht.quota=="number"&&Number.isFinite(ht.quota)?ht.quota:null;if(r===null)return;const n=typeof ht.usage=="number"&&Number.isFinite(ht.usage)?ht.usage:null,o=typeof ht.supported=="boolean"?ht.supported:null,a=typeof ht.persisted=="boolean"?ht.persisted:null,{lang:i,langTexts:s,fallbackTexts:l}=Q2(),c=Yw(r,i),u=n!==null?Yw(n,i):"";let f="";u?f=(s&&s.storagePersistenceUsage||l&&l.storagePersistenceUsage||"").replace("{used}",u).replace("{quota}",c):f=(s&&s.loggingStorageQuotaOnly||l&&l.loggingStorageQuotaOnly||"").replace("{quota}",c);const d=s&&s.loggingStorageEstimateUpdated||l&&l.loggingStorageEstimateUpdated||"Storage estimate refreshed.";ht.lastLoggedUsage===n&&ht.lastLoggedQuota===r&&ht.lastLoggedSupported===o&&ht.lastLoggedPersisted===a&&ht.lastLoggedSummary===f&&!t||(xs("info",d,{summary:f||null,usageBytes:n,usageDisplay:u||null,quotaBytes:r,quotaDisplay:c||null,supported:o,persisted:a,trigger:t?"user-request":"auto-refresh"},{source:"storage-persistence"}),ht.lastLoggedUsage=n,ht.lastLoggedQuota=r,ht.lastLoggedSupported=o,ht.lastLoggedPersisted=a,ht.lastLoggedSummary=f)}const OE={debug:10,info:20,warn:30,error:40},ple=50,mle=2e3,ik=6e3,mt={initialized:!1,loggingApi:null,unsubscribeHistory:null,unsubscribeConfig:null,retryTimer:null,renderScheduled:!1,levelFilter:"all",namespaceFilter:"",config:null,namespaceDebounce:null,statusResetTimer:null,degraded:!1};function yR(){const e=texts&&texts.en?texts.en:{},t=typeof currentLang=="string"&&texts&&texts[currentLang]?currentLang:"en",r=texts&&texts[t]||e;return{lang:t,langTexts:r,fallbackTexts:e}}function da(e){if(!RE)return;mt.statusResetTimer!=null&&(clearTimeout(mt.statusResetTimer),mt.statusResetTimer=null);const{langTexts:t,fallbackTexts:r}=yR(),n=t&&t[e]||r&&r[e]||"";RE.textContent=n,n?RE.setAttribute("data-help",n):RE.removeAttribute("data-help")}function sk(e=5e3,t="loggingStatusIdle"){if(mt.statusResetTimer!=null&&(clearTimeout(mt.statusResetTimer),mt.statusResetTimer=null),typeof setTimeout!="function"){t&&da(t);return}const r=typeof e=="number"&&Number.isFinite(e)?Math.max(0,e):5e3;mt.statusResetTimer=setTimeout(()=>{mt.statusResetTimer=null,t&&da(t)},r)}function hR(){if(mt.loggingApi&&typeof mt.loggingApi.getHistory=="function")return mt.loggingApi;const e=[];typeof globalThis<"u"&&globalThis&&e.push(globalThis),typeof window<"u"&&window&&e.indexOf(window)===-1&&e.push(window),typeof self<"u"&&self&&e.indexOf(self)===-1&&e.push(self),typeof global<"u"&&global&&e.indexOf(global)===-1&&e.push(global);for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.cineLogging;if(n&&typeof n=="object"&&typeof n.getHistory=="function"&&typeof n.subscribe=="function")return mt.loggingApi=n,n}catch(n){console.warn("Unable to resolve cineLogging",n)}}return null}function xP(){if(mt.unsubscribeHistory)try{mt.unsubscribeHistory()}catch(e){console.warn("Failed to detach logging history subscription",e)}if(mt.unsubscribeConfig)try{mt.unsubscribeConfig()}catch(e){console.warn("Failed to detach logging config subscription",e)}mt.unsubscribeHistory=null,mt.unsubscribeConfig=null}function kP(e){[mu,nh,Dl,DM,NM,FM,jM,Js].forEach(r=>{r&&(r.disabled=!!e,e?r.setAttribute("aria-disabled","true"):r.setAttribute("aria-disabled","false"))})}function gle(e){if(e==null)return"";if(typeof e=="string")return e;try{return JSON.stringify(e,null,2)}catch{return String(e)}}function yle(e,t,r){const n=typeof currentLang=="string"&&texts&&texts[currentLang]?currentLang:"en",o=typeof e.timestamp=="number"&&Number.isFinite(e.timestamp)?e.timestamp:null;let a="";if(o!=null){const s=new Date(o);if(!Number.isNaN(s.getTime()))try{typeof Intl<"u"&&typeof Intl.DateTimeFormat=="function"?a=new Intl.DateTimeFormat(n,{dateStyle:"short",timeStyle:"medium"}).format(s):a=s.toLocaleString()}catch(l){console.warn("Unable to format log timestamp",l),a=s.toISOString()}}const i=typeof e.isoTimestamp=="string"&&e.isoTimestamp?e.isoTimestamp:o!=null?new Date(o).toISOString():"";return a&&i&&i!==a?(t.loggingTimestampCombined||r.loggingTimestampCombined||"{local} ({iso})").replace("{local}",a).replace("{iso}",i):a||i||""}function j1(e,t){const r=document.createElement("details");r.className="log-entry-details";const n=document.createElement("summary");n.textContent=e;const o=document.createElement("pre");return o.className="log-entry-detail",o.textContent=gle(t),r.appendChild(n),r.appendChild(o),r}function lk(e){if(typeof e!="string")return"";const t=e.trim();return t?t.replace(/[^A-Za-z0-9.-]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""):""}function hle(e=new Date){let t=e instanceof Date&&!Number.isNaN(e.getTime())?e:new Date;(!(t instanceof Date)||Number.isNaN(t.getTime()))&&(t=new Date);let r="";if(t&&typeof t.toISOString=="function")try{r=t.toISOString()}catch{r=""}if(!r){const c=new Date(Date.now());try{r=c.toISOString(),t=c}catch{r=String(Date.now())}}const n=r||String(Date.now()),o=lk(n.replace(/[:.]/g,"-"))||lk(n)||String(Date.now()),a=typeof es=="string"&&es?es:typeof APP_VERSION=="string"&&APP_VERSION?APP_VERSION:"",i=lk(a),s=["cine-power-planner-log"];i&&s.push(`v${i}`),s.push(o);const l=typeof t.getTimezoneOffset=="function"?0-t.getTimezoneOffset():null;return{isoTimestamp:r,timezoneOffsetMinutes:l,fileName:`${s.join("-")}.json`}}function ck(e){if(e===null||typeof e!="object")return e;try{return yM(e)}catch{}try{return JSON.parse(JSON.stringify(e))}catch{}return Array.isArray(e)?e.slice():{...e}}function ble(){const e=hR(),{langTexts:t,fallbackTexts:r}=yR(),n=t&&t.loggingExportUnavailable||r&&r.loggingExportUnavailable||"",o=t&&t.loggingExportError||r&&r.loggingExportError||"",a=t&&t.loggingExportSuccess||r&&r.loggingExportSuccess||"Diagnostics log exported.",i=Js&&!Js.disabled;Js&&(Js.disabled=!0,Js.setAttribute("aria-disabled","true"));try{if(!e||typeof e.getHistory!="function"){n&&qr("error",n),da("loggingStatusError"),sk(ik,"loggingStatusIdle");return}da("loggingStatusExporting");const s=e.getHistory({})||[];if(!Array.isArray(s))throw new Error("Invalid diagnostics history snapshot.");const l=s;let c=ck(l);Array.isArray(c)||(c=l.slice());let u=null;if(typeof e.getConfig=="function")try{const S=e.getConfig();if(S&&typeof S=="object"){const y=ck(S);u=y&&typeof y=="object"?y:{...S}}}catch(S){xs("warn","Diagnostics log export config capture failed",{message:Sl(S)},{namespace:"logging-export"})}let f=null;if(typeof e.getStats=="function")try{const S=e.getStats();if(S&&typeof S=="object"){const y=ck(S);f=y&&typeof y=="object"?y:{...S}}}catch(S){xs("warn","Diagnostics log export stats capture failed",{message:Sl(S)},{namespace:"logging-export"})}const d=hle(new Date),p={exportedAt:d.isoTimestamp,timezoneOffsetMinutes:d.timezoneOffsetMinutes,filters:{level:mt.levelFilter||"all",namespace:mt.namespaceFilter||""},history:c,historyLength:c.length},h=typeof es=="string"&&es?es:typeof APP_VERSION=="string"&&APP_VERSION?APP_VERSION:null;h&&(p.appVersion=h),u&&typeof u=="object"&&(p.config=u),f&&typeof f=="object"&&(p.stats=f);const m=JSON.stringify(p,null,2);if(!m)throw new Error("Empty diagnostics export payload.");if(typeof downloadBackupPayload!="function")throw new Error("downloadBackupPayload unavailable.");const g=downloadBackupPayload(m,d.fileName);if(!g||!g.success)throw new Error("Diagnostics log download failed.");if(xs("info","Diagnostics log exported",{entries:c.length,fileName:d.fileName},{namespace:"logging-export"}),a&&qr("success",a),da("loggingStatusExported"),sk(ik),g.method==="manual"||g.method==="window-fallback"){const S=d2();S&&qr("warning",S)}}catch(s){const l=Sl(s);xs("error","Diagnostics log export failed",{message:l||null},{namespace:"logging-export"}),qr("error",o||l||"Log export failed."),da("loggingStatusExportFailed"),sk(ik)}finally{Js&&i&&(Js.disabled=!1,Js.setAttribute("aria-disabled","false"))}}function H1(){if(mt.renderScheduled=!1,!W2||!wy)return;const e=hR(),{langTexts:t,fallbackTexts:r}=yR();if(!e||typeof e.getHistory!="function"){kP(!0),nm&&nm.removeAttribute("hidden"),uu&&uu.setAttribute("hidden",""),wy&&(wy.textContent=""),da("loggingStatusError");return}kP(!1),nm&&nm.setAttribute("hidden","");let n=[];try{const c=e.getHistory({});Array.isArray(c)&&(n=c)}catch(c){console.warn("Unable to read logging history",c);const u={};if(Object.prototype.hasOwnProperty.call(mt,"levelFilter")){const d=mt.levelFilter;u.level=typeof d>"u"?null:d}if(Object.prototype.hasOwnProperty.call(mt,"namespaceFilter")){const d=mt.namespaceFilter;u.namespace=typeof d>"u"?null:d}const f={message:Sl(c)};Object.keys(u).length>0&&(f.filters=u),xs("error","Failed to read diagnostics history",f,{namespace:"logging-panel"}),da("loggingStatusError"),n=[]}const o=typeof mt.namespaceFilter=="string"?mt.namespaceFilter.trim().toLowerCase():"",a=mt.levelFilter==="all"?-1/0:OE[mt.levelFilter]||OE.warn,i=n.slice().reverse().filter(c=>{if(!c||typeof c!="object")return!1;const u=typeof c.level=="string"?c.level.toLowerCase():"info";return!((OE[u]??OE.info)<a||o&&!(typeof c.namespace=="string"?c.namespace.toLowerCase():"").includes(o))}),s=document.createDocumentFragment(),l={debug:t.loggingLevelDebug||r.loggingLevelDebug||"Debug",info:t.loggingLevelInfo||r.loggingLevelInfo||"Info",warn:t.loggingLevelWarn||r.loggingLevelWarn||"Warn",error:t.loggingLevelError||r.loggingLevelError||"Error"};if(i.forEach(c=>{const u=typeof c.level=="string"?c.level.toLowerCase():"info",f=document.createElement("li");f.className=`log-entry level-${u}`;const d=document.createElement("div");d.className="log-entry-header";const p=document.createElement("span");p.className="log-entry-message",p.textContent=typeof c.message=="string"?c.message:"";const h=document.createElement("span");h.className="log-entry-level",h.textContent=l[u]||l.info,d.appendChild(p),d.appendChild(h),f.appendChild(d);const m=document.createElement("dl");m.className="log-entry-meta";const g=document.createElement("div");g.className="log-entry-meta-row";const S=document.createElement("dt");S.textContent=t.loggingEntryTimestampLabel||r.loggingEntryTimestampLabel||"Time";const y=document.createElement("dd");y.textContent=yle(c,t,r),g.appendChild(S),g.appendChild(y),m.appendChild(g);const E=typeof c.namespace=="string"?c.namespace:"";if(E){const L=document.createElement("div");L.className="log-entry-meta-row";const v=document.createElement("dt");v.textContent=t.loggingEntryNamespaceLabel||r.loggingEntryNamespaceLabel||"Namespace";const A=document.createElement("dd");A.textContent=E,L.appendChild(v),L.appendChild(A),m.appendChild(L)}if(f.appendChild(m),c.meta!=null){const L=j1(t.loggingEntryMetaLabel||r.loggingEntryMetaLabel||"Meta",c.meta);f.appendChild(L)}if(c.detail!=null){const L=j1(t.loggingEntryDetailLabel||r.loggingEntryDetailLabel||"Details",c.detail);f.appendChild(L)}s.appendChild(f)}),wy.textContent="",wy.appendChild(s),uu)if(i.length===0){const c=n.length>0?"loggingEmptyFiltered":"loggingEmptyState",u=t&&t[c]||r&&r[c]||(c==="loggingEmptyFiltered"?"No log entries match the current filters.":"No log entries captured yet.");uu.textContent=u,uu.removeAttribute("hidden"),uu.setAttribute("data-help",u)}else uu.setAttribute("hidden",""),uu.removeAttribute("data-help");mt.degraded||da("loggingStatusIdle")}function Ww(e={}){if(mt.renderScheduled&&!e.immediate)return;if(e.immediate){H1();return}mt.renderScheduled=!0,(typeof requestAnimationFrame=="function"?requestAnimationFrame:r=>setTimeout(r,50))(()=>{H1()})}function U1(e){if(!e||typeof e!="object")return;mt.config=e;const{langTexts:t,fallbackTexts:r}=yR();if(Dl&&typeof e.historyLimit=="number"){Dl.value=e.historyLimit;const o=t.loggingHistoryLimitStatus||r.loggingHistoryLimitStatus||(TE?TE.textContent:"");TE&&o&&(TE.textContent=o.replace("{count}",String(e.historyLimit)))}const n=(o,a)=>{if(!o)return;const i=!!a;o.checked=i,o.setAttribute("aria-checked",i?"true":"false")};n(DM,e.consoleOutput!==!1),n(NM,e.captureConsole===!0),n(FM,e.captureGlobalErrors!==!1),n(jM,e.persistSession!==!1)}function Sle(e){if(!e||typeof e!="object")return null;const t=64,r={};try{const n=Object.keys(e);r.keys=n.slice(0,20),r.values=r.keys.reduce((o,a)=>{const i=e[a];if(i==null||typeof i=="boolean")return o[a]=i,o;if(typeof i=="number")return o[a]=Number.isFinite(i)?i:"[number]",o;if(typeof i=="string"){const s=i.length>t?`${i.slice(0,t)}`:i;return o[a]=s,i.length>t&&(o[`${a}Length`]=i.length),o}if(Array.isArray(i))return o[a]=`[array:${i.length}]`,o;if(typeof i=="object"){let s=null;try{s=Object.keys(i).length}catch(l){}return o[a]=`[object${s!=null?`:${s}`:""}]`,o}return o[a]=`[${typeof i}]`,o},{})}catch(n){r.error=Sl(n)}return r}function z1(e){const t=hR();if(!(!t||typeof t.setConfig!="function"||!e||typeof e!="object"))try{t.setConfig(e)}catch(r){console.warn("Unable to update logging config",r),xs("error","Failed to update diagnostics logging config",{message:Sl(r),partial:Sle(e)},{namespace:"logging-config"}),da("loggingStatusError")}}function Y2(){const e=hR();if(!e){xP(),kP(!0),nm&&nm.removeAttribute("hidden"),mt.retryTimer==null&&typeof setTimeout=="function"&&(mt.retryTimer=setTimeout(()=>{mt.retryTimer=null,Y2()},2e3));return}mt.retryTimer!=null&&(clearTimeout(mt.retryTimer),mt.retryTimer=null);try{const t=typeof e.getConfig=="function"?e.getConfig():{};U1(t),mt.degraded=!1}catch(t){mt.degraded=!0,da("loggingStatusError"),xs("warn","Failed to load diagnostics logging config snapshot",{message:Sl(t)},{namespace:"logging-panel"}),typeof console<"u"&&console&&typeof console.warn=="function"&&console.warn("Unable to read logging config",t)}xP(),typeof e.subscribe=="function"&&(mt.unsubscribeHistory=e.subscribe(()=>{mt.degraded||da("loggingStatusUpdating"),Ww()})),typeof e.subscribeConfig=="function"&&(mt.unsubscribeConfig=e.subscribeConfig(t=>{U1(t||{}),mt.degraded&&(mt.degraded=!1,da("loggingStatusIdle"))})),Ww({immediate:!0})}function vle(){if(!W2||mt.initialized)return;if(mt.initialized=!0,mu){const t=typeof mu.value=="string"&&mu.value?mu.value:"all";mt.levelFilter=t,mu.addEventListener("change",()=>{const r=typeof mu.value=="string"?mu.value:"all";mt.levelFilter=r,mt.degraded||da("loggingStatusUpdating"),Ww({immediate:!0})})}if(nh){nh.value="";const t=200;nh.addEventListener("input",()=>{mt.namespaceDebounce&&clearTimeout(mt.namespaceDebounce),mt.namespaceDebounce=setTimeout(()=>{mt.namespaceDebounce=null,mt.namespaceFilter=nh.value||"",mt.degraded||da("loggingStatusUpdating"),Ww({immediate:!0})},t)})}if(Dl){const t=()=>{const r=Dl.value,n=parseInt(r,10);if(!Number.isFinite(n)){mt.config&&typeof mt.config.historyLimit=="number"&&(Dl.value=mt.config.historyLimit);return}const o=Math.min(Math.max(n,ple),mle);if(mt.config&&mt.config.historyLimit===o){n!==o&&(Dl.value=o);return}Dl.value=o,mt.degraded||da("loggingStatusUpdating"),z1({historyLimit:o})};Dl.addEventListener("change",t),Dl.addEventListener("blur",t)}const e=(t,r)=>{t&&t.addEventListener("change",()=>{const n=!!t.checked;if(mt.config&&mt.config[r]===n){t.setAttribute("aria-checked",n?"true":"false");return}t.setAttribute("aria-checked",n?"true":"false"),mt.degraded||da("loggingStatusUpdating"),z1({[r]:n})})};e(DM,"consoleOutput"),e(NM,"captureConsole"),e(FM,"captureGlobalErrors"),e(jM,"persistSession"),Js&&Js.addEventListener("click",()=>{ble()}),F1&&F1.setAttribute("aria-live","polite"),Y2()}function Q2(){const e=texts&&texts.en?texts.en:{},t=typeof currentLang=="string"&&texts&&texts[currentLang]?currentLang:"en",r=texts&&texts[t]||e;return{lang:t,langTexts:r,fallbackTexts:e}}function X2(){return typeof navigator<"u"&&navigator&&typeof navigator.storage=="object"?navigator.storage:null}function Yw(e,t){if(typeof e!="number"||!Number.isFinite(e)||e<0)return"";const r=["B","KB","MB","GB","TB"];let n=0,o=e;for(;o>=1024&&n<r.length-1;)o/=1024,n+=1;let a="";if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{a=new Intl.NumberFormat(t,{maximumFractionDigits:o>=100?0:1}).format(o)}catch(i){console.warn("Unable to format storage size",i),a=o.toFixed(o>=100?0:1)}else a=o.toFixed(o>=100?0:1);return`${a} ${r[n]}`}function Rd(){if(!pi)return;const{lang:e,langTexts:t,fallbackTexts:r}=Q2();let n="",o="idle";ht.requestInFlight?(o="requesting",n=t.storagePersistenceStatusRequesting||r.storagePersistenceStatusRequesting||""):ht.checking?(o="checking",n=t.storagePersistenceStatusChecking||r.storagePersistenceStatusChecking||""):ht.supported===!1?(o="unsupported",n=t.storagePersistenceStatusUnsupported||r.storagePersistenceStatusUnsupported||""):ht.persisted?(o="granted",n=t.storagePersistenceStatusGranted||r.storagePersistenceStatusGranted||""):ht.lastError?(o="error",n=t.storagePersistenceStatusError||r.storagePersistenceStatusError||""):ht.requestAttempted&&ht.lastRequestDenied?(o="denied",n=t.storagePersistenceStatusDenied||r.storagePersistenceStatusDenied||""):(o="idle",n=t.storagePersistenceStatusIdle||r.storagePersistenceStatusIdle||"");const a=[n];if(o==="denied"&&Ele()){const l=t.storagePersistenceStatusSafariIncompatible||r.storagePersistenceStatusSafariIncompatible||"";l&&a.push(l)}if(typeof ht.usage=="number"){const l=Yw(ht.usage,e);if(l)if(typeof ht.quota=="number"&&ht.quota>0){const c=Yw(ht.quota,e),u=t.storagePersistenceUsage||r.storagePersistenceUsage||"";u?a.push(u.replace("{used}",l).replace("{quota}",c||"")):c?a.push(`${l} / ${c}`):a.push(l)}else{const c=t.storagePersistenceUsageUnknown||r.storagePersistenceUsageUnknown||"";c?a.push(c.replace("{used}",l)):a.push(l)}}const s=a.filter(Boolean).join(" ").trim()||n||"";if(pi.textContent=s,pi.dataset.state=o,pi.setAttribute("data-state",o),s?pi.setAttribute("data-help",s):pi.removeAttribute("data-help"),Xs){const l=!pi||ht.supported===!1||ht.persisted||ht.requestInFlight||ht.checking;Xs.disabled=l,Xs.setAttribute("aria-disabled",l?"true":"false");const c=t.storagePersistenceRequest||r.storagePersistenceRequest||Xs.dataset.defaultLabel||Xs.textContent||"",u=t.storagePersistenceRequestHelp||r.storagePersistenceRequestHelp||c;u&&(Xs.setAttribute("data-help",u),Xs.setAttribute("title",u),Xs.setAttribute("aria-label",u))}if(typeof pi.dispatchEvent=="function")try{let l;const c={state:o,message:s,rawMessage:n};typeof CustomEvent=="function"?l=new CustomEvent("storagepersistencechange",{detail:c}):pi.ownerDocument&&typeof pi.ownerDocument.createEvent=="function"&&(l=pi.ownerDocument.createEvent("CustomEvent"),l.initCustomEvent("storagepersistencechange",!1,!1,c)),l&&pi.dispatchEvent(l)}catch(l){console.warn("Unable to broadcast storage persistence status change",l)}}function Ele(){if(typeof navigator>"u"||!navigator)return!1;const e=navigator;if(typeof e!="object"||e===null)return!1;if(typeof window<"u"&&window&&typeof window.safari=="object"&&window.safari&&typeof window.safari.pushNotification=="object")return!0;const t=typeof e.vendor=="string"?e.vendor:"",r=typeof e.userAgent=="string"?e.userAgent:"";if(!t&&!r)return!1;const n=t.toLowerCase().trim(),o=r.toLowerCase(),a=["crios","fxios","edgios","edga","edge","opr/","opt/","opera","chrome","chromium"];for(let m=0;m<a.length;m+=1)if(o.includes(a[m]))return!1;const i=n.includes("apple"),s=o.includes("safari"),l=o.includes("applewebkit"),c=o.includes("version/"),u=o.includes("mobile/"),f=o.includes("macintosh")||o.includes("iphone")||o.includes("ipad")||o.includes("ipod")||o.includes("watch")||o.includes("apple tv"),d=n.length===0,p=s||l&&(c||u||f),h=d&&l&&p;return!i&&!h?!1:i?p:h}async function HM(e={}){if(!pi)return;const{fromRequest:t=!1}=e||{},r=++ak;ht.checking=!0,t||(ht.lastError=null),Rd();const n=X2();if(!n){if(r!==ak)return;ht.supported=!1,ht.persisted=!1,ht.usage=null,ht.quota=null,ht.checking=!1,t&&(ht.lastRequestDenied=!0),Rd();return}const o=typeof n.persist=="function";ht.supported=o;let a=ht.persisted;if(typeof n.persisted=="function")try{a=await n.persisted()}catch(l){console.warn("Unable to determine persistent storage state",l)}let i=ht.usage,s=ht.quota;if(typeof n.estimate=="function")try{const l=await n.estimate();l&&typeof l=="object"&&(typeof l.usage=="number"&&Number.isFinite(l.usage)&&(i=l.usage),typeof l.quota=="number"&&Number.isFinite(l.quota)&&(s=l.quota))}catch(l){console.warn("Unable to estimate storage usage",l)}r===ak&&(ht.persisted=!!a,ht.usage=typeof i=="number"&&Number.isFinite(i)?i:null,ht.quota=typeof s=="number"&&Number.isFinite(s)?s:null,ht.checking=!1,t&&(ht.lastRequestDenied=!ht.persisted),dle({fromRequest:t}),Rd())}async function Ale(e){if(e&&typeof e.preventDefault=="function"&&e.preventDefault(),!Xs||ht.requestInFlight)return;const t=X2();ht.requestAttempted=!0;const r=!!(t&&typeof t.persist=="function");if(!r){ht.supported=r,ht.lastRequestDenied=!0,ht.lastError=null,Rd();return}ht.requestInFlight=!0,ht.lastError=null,Rd();let n=!1,o=!1;try{if(typeof requestPersistentStorage=="function"){const a=await requestPersistentStorage();a&&typeof a.supported=="boolean"&&(ht.supported=a.supported),a&&typeof a.granted=="boolean"&&(n=a.granted),a&&typeof a.alreadyGranted=="boolean"&&(o=a.alreadyGranted),a&&a.error&&(ht.lastError=a.error,console.warn("Persistent storage request error",a.error))}else n=await t.persist()}catch(a){ht.lastError=a,console.warn("Persistent storage request failed",a)}ht.requestInFlight=!1,ht.lastRequestDenied=!(n||o),(n||o)&&(ht.persisted=!0),Rd(),HM({fromRequest:!0}).catch(a=>{console.warn("Persistent storage status refresh failed",a)})}Xs&&Xs.addEventListener("click",Ale);pi&&HM().catch(e=>{console.warn("Persistent storage status initialization failed",e)});vle();typeof window<"u"&&window&&typeof window.addEventListener=="function"&&window.addEventListener("beforeunload",()=>{xP(),mt.retryTimer!=null&&(clearTimeout(mt.retryTimer),mt.retryTimer=null)});_o("renderStoragePersistenceStatus",()=>Rd);_o("refreshStoragePersistenceStatus",()=>HM);const Cle=()=>{const e=o=>typeof document<"u"?document.getElementById(o):null,t=(o,a,i)=>{const s=e(o);s?s.addEventListener(a,i):typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable(o,l=>l.addEventListener(a,i))};t("backupDiffToggleButton","click",ale),t("backupDiffClose","click",()=>id()),t("backupDiffPrimary","change",B1),t("backupDiffSecondary","change",B1),t("backupDiffExport","click",ile);const r=e("backupDiffSummary");r?r.textContent=gn("versionCompareNoSelection","Choose two versions to generate a diff."):typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable("backupDiffSummary",o=>{o.textContent=gn("versionCompareNoSelection","Choose two versions to generate a diff.")});const n=e("backupDiffExport");n&&(n.disabled=!0)};Cle();ks&&(ks.disabled=!0);vi&&id();function IP(){restoreSettingsInput&&restoreSettingsInput.click()}function PP(){const e=restoreSettingsInput.files[0];if(!e)return;const t=texts[currentLang]||{},r=texts.en||{},n=t.restoreFailed||r.restoreFailed||"Restore failed. Check the backup file and try again.";let o=null,a=null;try{const S=Kw(!1,new Date);o=S?S.fileName:null,a=S?S.downloadResult:null}catch(S){console.error("Backup before restore failed",S)}if(!o||!a||!a.success&&!a.queued){const S=t.restoreBackupFailed||r.restoreBackupFailed||"Backup failed. Restore cancelled.";qr("error",S),typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Restore Failed",message:S}):alert(S),restoreSettingsInput.value="";return}if(a.success)qr("success","Full app backup downloaded");else if(a.queued){const S=a.queueMessage||r.queuedBackupDownloadDeferred||"Automatic downloads were blocked. The backup was saved to the local vault.",y=t.restoreBackupQueuedConfirm||r.restoreBackupQueuedConfirm||"The safety backup is waiting in the local vault. Continue with the restore now?";qr("warning",S);let E=!1;if(typeof confirm=="function"?E=confirm(`${S}

${y}`):typeof alert=="function"&&alert(`${S}

${y}`),!E){restoreSettingsInput.value="";return}}const i=resolveSafeLocalStorage(),s=captureStorageSnapshot(i),l=captureStorageSnapshot(typeof sessionStorage<"u"?sessionStorage:null),c=sle();let u=!1;const f=async()=>{try{restoreSettingsInput.value=""}catch{}},d=async()=>{try{restoreLocalStorageSnapshot(i,s)}catch(E){console.warn("Failed to restore localStorage snapshot after restore failure",E)}try{restoreSessionStorageSnapshot(l)}catch(E){console.warn("Failed to restore sessionStorage snapshot after restore failure",E)}try{rd()}catch(E){console.warn("Failed to refresh logo preview after restore failure",E)}try{syncAutoGearRulesFromStorage()}catch(E){console.warn("Failed to resync automatic gear rules after restore failure",E)}const S=createSafeStorageReader(i,"Failed to read restored storage key"),y=_1(S);rl=y.showAutoBackups;try{populateSetupSelect()}catch(E){console.warn("Failed to repopulate setup selector after restore failure",E)}if(D1(c,rl),settingsShowAutoBackups)try{settingsShowAutoBackups.checked=rl}catch(E){console.warn("Failed to restore automatic backup visibility toggle after restore failure",E)}if(y.language)try{if(await bg(y.language),typeof sd=="function")try{sd()}catch(E){console.warn("Failed to refresh user button selectors after restoring language",E)}}catch(E){console.warn("Failed to restore language after restore failure",E)}},p=S=>{console.warn("Restore failed",S),qr("error",n),typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Restore Failed",message:n}):alert(n),f()},h=async S=>{try{const y=sanitizeBackupPayload(S);if(!y||!y.trim())throw new Error("Backup payload empty");const E=JSON.parse(y),{settings:L,sessionStorage:v,data:A,fileVersion:R}=extractBackupSections(E),I=L&&Object.keys(L).length>0,C=v&&Object.keys(v).length>0,k=A&&Object.keys(A).length>0;if(!I&&!C&&!k)throw new Error("Backup missing recognized sections");const _=$c(R),w=es||$c(typeof APP_VERSION=="string"?APP_VERSION:null);if(_!==w){const K=lie({langTexts:t,fallbackTexts:r,fileVersion:_,targetVersion:w,data:A,settingsSnapshot:L,sessionSnapshot:v,backupFileName:o});typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Version Compatibility",message:K}):alert(K)}const x=L&&typeof L=="object"&&!Array.isArray(L),G=v&&typeof v=="object"&&!Array.isArray(v);x&&(u=!0,restoreLocalStorageSnapshot(i,L)),G&&(u=!0,restoreSessionStorageSnapshot(v));try{rd()}catch(K){console.warn("Failed to refresh logo preview after restore",K)}A&&typeof importAllData=="function"&&(u=!0,importAllData(A));try{syncAutoGearRulesFromStorage(A?.autoGearRules)}catch(K){console.warn("Failed to sync automatic gear rules after restore",K)}const T=createSafeStorageReader(i,"Failed to read restored storage key"),P=_1(T);if(rl=P.showAutoBackups,typeof populateSetupSelect=="function"&&populateSetupSelect(),D1(c,rl),settingsShowAutoBackups&&(settingsShowAutoBackups.checked=rl),P.language&&(await bg(P.language),typeof sd=="function"))try{sd()}catch(K){console.warn("Failed to refresh user button selectors after applying restored preferences",K)}G&&restoreSessionStorageSnapshot(v);let N=null;try{N=cie(A)}catch(K){console.warn("Restore verification execution failed",K),N=null}N&&N.notificationType&&N.notificationMessage&&qr(N.notificationType,N.notificationMessage);const Z=[texts[currentLang].restoreSuccess];N&&N.alertMessage&&Z.push(N.alertMessage);const U=Z.join(`

`);typeof window.cineShowAlertDialog=="function"?window.cineShowAlertDialog({title:"Restore Successful",message:U}):alert(U),f()}catch(y){if(u)try{await d()}catch(E){console.warn("Failed to restore previous state after restore error",E)}p(y)}},m=S=>!e||typeof e.text!="function"?!1:(S?console.warn("FileReader unavailable for restore, using file.text()",S):console.warn("FileReader unavailable for restore, using file.text()"),Promise.resolve().then(()=>e.text()).then(h).catch(p),!0);let g=null;if(typeof FileReader=="function")try{g=new FileReader}catch(S){console.warn("Failed to create FileReader for restore",S),g=null}if(g&&typeof g.readAsText=="function"){g.onload=S=>{const y=S&&S.target?S.target.result:"";h(y)},g.onerror=()=>{const S=g.error||new Error("Failed to read backup file");console.warn("FileReader failed while reading restore file",S),m(S)||p(S)};try{g.readAsText(e);return}catch(S){console.warn("Failed to read restore file",S),m(S)||p(S);return}}m()||p(new Error("No supported file reader available"))}restoreSettings&&restoreSettingsInput&&(restoreSettings.addEventListener("click",IP),restoreSettingsInput.addEventListener("change",PP));function $1(){const e=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,t=typeof texts<"u"&&texts||(e&&typeof e.texts=="object"?e.texts:null),r=typeof currentLang=="string"&&t&&typeof t[currentLang]=="object"?currentLang:"en",n=t&&typeof t[r]=="object"&&t[r]||{},o=t&&typeof t.en=="object"&&t.en||{};return{langTexts:n,fallbackTexts:o}}function J2(e){!e||$0||(Yx(e.controllers,[{name:"backupSettings",value:{execute:Hb}},{name:"restoreSettings",value:{openPicker:IP,processFile:PP}}],"cineUi controller registration (session) failed"),Yx(e.interactions,[{name:"performBackup",value:Hb},{name:"openRestorePicker",value:IP},{name:"applyRestoreFile",value:PP}],"cineUi interaction registration (session) failed"),Yx(e.help,[{name:"backupSettings",value:()=>{const{langTexts:t,fallbackTexts:r}=$1();return t.backupSettingsHelp||r.backupSettingsHelp||"Download a full JSON backup containing every project, device edit, preference, auto-gear rule and runtime log stored on this device. Keep multiple copies in your offline archive."}},{name:"restoreSettings",value:()=>{const{langTexts:t,fallbackTexts:r}=$1();return t.restoreSettingsHelp||r.restoreSettingsHelp||"Restore a full JSON backup. The planner captures a fresh safety copy first, then applies the selected file so you can roll back immediately if anything looks wrong."}}],"cineUi help registration (session) failed"),$0=b2(e))}function wle(){const e=typeof globalThis<"u"&&globalThis.cineUi||typeof window<"u"&&window.cineUi||typeof self<"u"&&self.cineUi||null;return e?(J2(e),!0):!1}wle();Q0&&Q0.addEventListener("click",()=>{SP()});X0&&X0.addEventListener("click",()=>{$ie()});J0&&Is&&J0.addEventListener("click",()=>{Is.click()});Z0&&Z0.addEventListener("click",()=>{Jie()});e1&&e1.addEventListener("click",()=>{Zie()});Is&&Is.addEventListener("change",()=>{const e=Is.files&&Is.files[0];if(!e){gR({keepStatus:!0});return}_h&&(_h.textContent=e.name||_h.textContent),Xie(e)});typeof globalThis<"u"&&(globalThis.applySharedSetup=EM,globalThis.applySharedSetupFromUrl=AM);function Z2(){const e=typeof suspendProjectPersistence=="function"&&typeof resumeProjectPersistence=="function";if(e)try{suspendProjectPersistence()}catch(t){console.warn("Failed to suspend project persistence during factory reset cleanup",t)}try{try{typeof storeLoadedSetupState=="function"&&storeLoadedSetupState(null)}catch(r){console.warn("Failed to reset loaded setup state during factory reset",r)}try{_r=null}catch(r){console.warn("Failed to clear in-memory project info during factory reset",r)}try{typeof populateProjectForm=="function"?populateProjectForm({}):Gs&&typeof Gs.reset=="function"&&Gs.reset()}catch(r){console.warn("Failed to reset project form during factory reset",r)}try{displayGearAndRequirements("")}catch(r){console.warn("Failed to reset gear displays during factory reset",r),Pn&&(Pn.innerHTML="",Pn.classList.add("hidden")),td&&(td.innerHTML="",td.classList.add("hidden"))}[Ri,Wa,videoSelect,cageSelect,distanceSelect,batterySelect,Ti,xa].forEach(r=>{if(r)try{const n=Array.from(r.options||[]);n.find(a=>a.value==="None")?r.value="None":n.length?r.selectedIndex=0:r.value=""}catch(n){console.warn("Failed to reset selector during factory reset",n)}});try{Eg(motorSelects)}catch(r){console.warn("Failed to reset motor selections during factory reset",r)}try{Eg(controllerSelects)}catch(r){console.warn("Failed to reset controller selections during factory reset",r)}try{if(typeof getSliderBowlSelect=="function"){const r=getSliderBowlSelect();r&&(r.value="")}else console.warn("Skipping slider bowl selection reset during factory reset because helper is unavailable")}catch(r){console.warn("Failed to reset slider bowl selection during factory reset",r)}try{if(typeof getEasyrigSelect=="function"){const r=getEasyrigSelect();r&&(r.value="")}else console.warn("Skipping Easyrig selection reset during factory reset because helper is unavailable")}catch(r){console.warn("Failed to reset Easyrig selection during factory reset",r)}try{Kt&&(Kt.value="")}catch(r){console.warn("Failed to clear setup name during factory reset",r)}try{ur&&(populateSetupSelect(),ur.value="")}catch(r){console.warn("Failed to reset setup selector options during factory reset",r)}try{syncAutoGearRulesFromStorage()}catch(r){console.warn("Failed to sync automatic gear rules during factory reset",r);try{clearProjectAutoGearRules()}catch(n){console.warn("Failed to clear project automatic gear rules during factory reset",n)}}try{renderAutoGearRulesList()}catch(r){console.warn("Failed to render automatic gear rules during factory reset",r)}try{resetSharedImportStateForFactoryReset()}catch(r){console.warn("Failed to reset shared import state during factory reset",r)}try{updateAutoGearCatalogOptions()}catch(r){console.warn("Failed to refresh automatic gear catalog during factory reset",r)}try{updateBatteryPlateVisibility()}catch(r){console.warn("Failed to reset battery plate visibility during factory reset",r)}try{updateBatteryOptions()}catch(r){console.warn("Failed to reset battery options during factory reset",r)}try{rd()}catch(r){console.warn("Failed to reset custom logo preview during factory reset",r)}try{typeof resetCustomFontsForFactoryReset=="function"?resetCustomFontsForFactoryReset():console.warn("Skipping custom font reset during factory reset because helper is unavailable")}catch(r){console.warn("Failed to reset custom fonts during factory reset",r)}try{updateStorageSummary()}catch(r){console.warn("Failed to update storage summary during factory reset",r)}try{ensureGearListActions()}catch(r){console.warn("Failed to ensure gear list actions during factory reset",r)}try{Qi()}catch(r){console.warn("Failed to refresh setup state during factory reset",r)}try{$d()}catch(r){console.warn("Failed to update calculations during factory reset",r)}}finally{if(e)try{resumeProjectPersistence()}catch(t){console.warn("Failed to resume project persistence after factory reset cleanup",t)}}}window.cineShowConfirmDialog=e=>{const{title:t,message:r,confirmLabel:n,cancelLabel:o,onConfirm:a,onCancel:i,danger:s=!1}=e||{},l=document.getElementById("appConfirmDialog"),c=document.getElementById("appConfirmTitle"),u=document.getElementById("appConfirmMessage"),f=document.getElementById("appConfirmBtn"),d=document.getElementById("appConfirmCancelBtn");if(!l||!f||!d){console.warn("Confirmation dialog elements missing");return}c&&(c.textContent=t||"Confirm"),u&&(typeof r=="string"&&r.includes(`
`)?u.innerHTML=r.replace(/\n/g,"<br>"):u.textContent=r||"Are you sure?"),f.textContent=n||"Confirm",d.textContent=o||"Cancel",d.style.display="inline-block",s?f.classList.add("danger"):f.classList.remove("danger");const p=f.cloneNode(!0),h=d.cloneNode(!0);f.parentNode.replaceChild(p,f),d.parentNode.replaceChild(h,d);const m=()=>{typeof l.close=="function"&&l.close(),l.setAttribute("hidden","")};p.addEventListener("click",()=>{m(),typeof a=="function"&&a()}),h.addEventListener("click",()=>{m(),typeof i=="function"&&i()}),l.removeAttribute("hidden"),typeof l.showModal=="function"&&l.showModal()};window.cineShowAlertDialog=e=>{const t=typeof e=="string"?{message:e}:e||{},{title:r,message:n,confirmLabel:o,onConfirm:a}=t,i=document.getElementById("appConfirmDialog"),s=document.getElementById("appConfirmTitle"),l=document.getElementById("appConfirmMessage"),c=document.getElementById("appConfirmBtn"),u=document.getElementById("appConfirmCancelBtn");if(!i||!c||!u){console.warn("Alert dialog elements missing"),typeof alert=="function"&&alert(n);return}s&&(s.textContent=r||"Notification"),l&&(typeof n=="string"&&n.includes(`
`)?l.innerHTML=n.replace(/\n/g,"<br>"):l.textContent=n||""),c.textContent=o||"OK",c.classList.remove("danger"),u.style.display="none";const f=c.cloneNode(!0);c.parentNode.replaceChild(f,c);const d=()=>{typeof i.close=="function"&&i.close(),i.setAttribute("hidden","")};f.addEventListener("click",()=>{d(),typeof a=="function"&&a()}),i.removeAttribute("hidden"),typeof i.showModal=="function"&&i.showModal()};factoryResetButton&&factoryResetButton.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const t=texts[currentLang]||texts.en||{};window.cineShowConfirmDialog({title:t.factoryResetTitle||"Factory Reset",message:t.confirmFactoryReset||"Create a backup and wipe all planner data? This action cannot be undone.",confirmLabel:t.factoryResetConfirm||"Reset Everything",cancelLabel:t.cancel||"Cancel",danger:!0,onConfirm:async()=>{if(typeof Kw!="function"){const s=t.factoryResetError||"Factory reset failed. Please try again.";qr("error",s);return}let r=null;try{r=await Kw(!1,new Date)}catch(s){console.error("Backup before factory reset failed",s)}if(!r||!r.fileName){const s=t.factoryResetBackupFailed||"Backup failed. Data was not deleted.";qr("error",s);return}let n="unknown",o="unknown";const a=r.downloadResult,i=a&&a.permission?a.permission:null;if(i&&i.initial&&typeof i.initial.then=="function")try{n=await i.initial}catch(s){console.warn("Failed to inspect automatic download permission before factory reset",s),n="unknown"}if(n==="denied"){const s=t.factoryResetDownloadBlocked||"The backup download was blocked. Data was not deleted.";qr("error",s),typeof alert=="function"&&alert(s);return}if(n==="prompt"){const s=t.factoryResetAwaitDownload||"Allow downloads to save your backup. The factory reset will continue after you accept the download.";qr("info",s),typeof alert=="function"&&alert(s)}if(i&&i.ready&&typeof i.ready.then=="function")try{o=await i.ready}catch(s){console.warn("Failed to await automatic download permission before factory reset",s),o="unknown"}else o=n;if(n==="prompt"){if((typeof o!="string"||!o)&&(o="unknown"),o!=="granted"){const s=t.factoryResetDownloadBlocked||"The backup download was blocked. Data was not deleted.";qr("error",s),typeof alert=="function"&&alert(s);return}}else if(o==="denied"){const s=t.factoryResetDownloadBlocked||"The backup download was blocked. Data was not deleted.";qr("error",s),typeof alert=="function"&&alert(s);return}if(typeof clearAllData!="function"){const s=t.factoryResetError||"Factory reset failed. Please try again.";qr("error",s);return}try{if(ef=!0,typeof globalThis<"u")try{globalThis.__cameraPowerPlannerFactoryResetting=!0}catch(l){console.warn("Unable to flag factory reset on global scope",l)}jn&&(clearTimeout(jn),jn=null);try{CP(),stopPinkModeAnimatedIcons()}catch(l){console.warn("Failed to stop pink mode animations during factory reset",l)}await clearAllData();try{if(typeof window<"u"&&typeof window.dispatchEvent=="function"){const l="cameraPowerPlannerFactoryReset";let c=null;typeof window.CustomEvent=="function"?c=new window.CustomEvent(l):typeof document<"u"&&typeof document.createEvent=="function"&&(c=document.createEvent("Event"),c.initEvent(l,!1,!1)),c&&window.dispatchEvent(c)}}catch(l){console.warn("Failed to dispatch factory reset event",l)}try{Z2()}catch(l){console.warn("Failed to reset planner state after factory reset",l)}try{yS(!1,{persist:!0})}catch(l){console.warn("Failed to reset dark mode during factory reset",l)}try{BM=!1,qd(!1),settingsHighContrast&&(settingsHighContrast.checked=!1)}catch(l){console.warn("Failed to reset high contrast during factory reset",l)}try{GM=!1,Ag(!1),_c()}catch(l){console.warn("Failed to reset pink mode during factory reset",l)}rl=!1,settingsShowAutoBackups&&(settingsShowAutoBackups.checked=!1);try{accentColor=DEFAULT_ACCENT_COLOR,prevAccentColor=DEFAULT_ACCENT_COLOR,clearAccentColorOverrides(),applyAccentColor(accentColor),accentColorInput&&(accentColorInput.value=DEFAULT_ACCENT_COLOR),typeof updateAccentColorResetButtonState=="function"&&updateAccentColorResetButtonState()}catch(l){console.warn("Failed to reset accent color during factory reset",l)}try{const l=Qc("resetMountVoltagePreferences");l?l({persist:!0,triggerUpdate:!0}):Os("resetMountVoltagePreferences");const c=Qc("updateMountVoltageInputsFromState");c?c():Os("updateMountVoltageInputsFromState"),ql()}catch(l){console.warn("Failed to reset mount voltages during factory reset",l)}try{fontSize="16",m2(fontSize),settingsFontSize&&(settingsFontSize.value=fontSize)}catch(l){console.warn("Failed to reset font size during factory reset",l)}try{fontFamily="'Ubuntu', sans-serif",g2(fontFamily),settingsFontFamily&&(settingsFontFamily.value=fontFamily)}catch(l){console.warn("Failed to reset font family during factory reset",l)}Vl&&Vl.setAttribute("hidden","");const s=t.factoryResetSuccess||"Backup downloaded. All planner data cleared. Reloading";qr("success",s),setTimeout(()=>{typeof window<"u"&&window.location&&window.location.reload&&window.location.reload()},600)}catch(s){if(console.error("Factory reset failed",s),ef=!1,typeof globalThis<"u")try{delete globalThis.__cameraPowerPlannerFactoryResetting}catch(c){console.warn("Unable to clear factory reset flag from global scope",c)}const l=t.factoryResetError||"Factory reset failed. Please try again.";qr("error",l)}}})});const Lle=["cameraPowerPlanner_schemaCache","cinePowerPlanner_schemaCache"],Rle=["","__backup","__legacyMigrationBackup"],Ml=new Set;function Tle(){const e=new Set,t=(o,a)=>{if(!o||typeof o!="object"&&typeof o!="function")return;const i=typeof o.removeItem=="function",s=typeof o.delete=="function";!i&&!s||e.add(o)},r=(o,a)=>{if(!o||typeof o!="object"&&typeof o!="function")return;try{t(o.SAFE_LOCAL_STORAGE,`${a}.SAFE_LOCAL_STORAGE`)}catch(s){Ml.has(`${a}.SAFE_LOCAL_STORAGE`)||(Ml.add(`${a}.SAFE_LOCAL_STORAGE`),console.warn(`Unable to inspect ${a}.SAFE_LOCAL_STORAGE while clearing UI caches`,s))}try{t(o.localStorage,`${a}.localStorage`)}catch(s){Ml.has(`${a}.localStorage`)||(Ml.add(`${a}.localStorage`),console.warn(`Unable to inspect ${a}.localStorage while clearing UI caches`,s))}try{t(o.sessionStorage,`${a}.sessionStorage`)}catch(s){Ml.has(`${a}.sessionStorage`)||(Ml.add(`${a}.sessionStorage`),console.warn(`Unable to inspect ${a}.sessionStorage while clearing UI caches`,s))}let i=null;try{i=o.__cineGlobal}catch(s){Ml.has(`${a}.__cineGlobal`)||(Ml.add(`${a}.__cineGlobal`),console.warn(`Unable to inspect ${a}.__cineGlobal while clearing UI caches`,s))}i&&i!==o&&r(i,`${a}.__cineGlobal`)};if(t(resolveSafeLocalStorage()),typeof SAFE_LOCAL_STORAGE<"u")try{t(SAFE_LOCAL_STORAGE,"SAFE_LOCAL_STORAGE")}catch(o){Ml.has("SAFE_LOCAL_STORAGE")||(Ml.add("SAFE_LOCAL_STORAGE"),console.warn("Unable to inspect SAFE_LOCAL_STORAGE while clearing UI caches",o))}const n=[{scope:typeof globalThis<"u"?globalThis:null,label:"globalThis"},{scope:typeof window<"u"?window:null,label:"window"},{scope:typeof self<"u"?self:null,label:"self"},{scope:typeof global<"u"?global:null,label:"global"}];return typeof __cineGlobal<"u"&&n.push({scope:__cineGlobal,label:"__cineGlobal"}),n.forEach(({scope:o,label:a})=>{r(o,a)}),typeof localStorage<"u"&&t(localStorage),typeof sessionStorage<"u"&&t(sessionStorage),e}function Ole(){const e=Tle();!e||!e.size||e.forEach(t=>{Lle.forEach(r=>{typeof r!="string"||!r||Rle.forEach(n=>{const o=n?`${r}${n}`:r;try{typeof t.removeItem=="function"?t.removeItem(o):typeof t.delete=="function"&&t.delete(o)}catch(a){console.warn("Failed to remove UI cache entry",o,a)}})})})}const V1=["cine-power-planner","cinepowerplanner"];function xle(){const e=[typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function"))try{const n=r.CINE_CACHE_NAME;if(typeof n=="string"&&n)return n}catch{}}return""}function kle(e,t,r){if(typeof e!="string"||!e)return!1;if(t&&(e===t||e.toLowerCase()===r))return!0;const n=e.toLowerCase();for(let o=0;o<V1.length;o+=1)if(n.includes(V1[o]))return!0;return!1}function El(e){if(!e||typeof e!="object")return"";try{const t=e.href;return typeof t=="string"?t:""}catch{return""}}function Ile(e){if(!e||typeof e!="object")return"";try{const t=e.pathname;return typeof t=="string"?t:""}catch{return""}}function Ple(e){if(!e||typeof e!="object")return"";try{const n=e.origin;if(typeof n=="string"&&n)return n}catch{}const t=El(e);if(!t)return"";if(typeof URL=="function")try{return new URL(t).origin}catch{}const r=t.match(/^([a-zA-Z][a-zA-Z\d+.-]*:\/\/[^/]+)/);return r&&r[1]?r[1]:""}function Ble(e,t){const r=[],n=new Set,o=l=>{if(typeof l!="string")return;const c=l.trim();!c||n.has(c)||(n.add(c),r.push(c))},a=El(e);a&&o(a),typeof t=="string"&&t&&o(t);const i=Ple(e),s=Ile(e);if(i&&(s&&o(`${i}${s}`),o(`${i}/`)),typeof window<"u"&&window&&window.location){const l=El(window.location);l&&o(l)}return r}function qu(e,t){if(typeof e!="string")return"";const r=e.trim();if(!r)return"";if(typeof URL=="function")try{return new URL(r).toString()}catch{if(typeof t=="string"&&t)try{return new URL(r,t).toString()}catch{}}return r}function Gle(e,t){const r=typeof t=="string"&&t?t:"forceReload",n=Date.now().toString(36),o=El(e),a=Ble(e,o);if(!o)return{originalHref:o,nextHref:o,param:r,timestamp:n};if(typeof URL=="function"){const f=[o,...a];for(let d=0;d<f.length;d+=1){const p=f[d];try{const h=d===0?new URL(p):new URL(o,p);return h.searchParams.set(r,n),{originalHref:o,nextHref:h.toString(),param:r,timestamp:n}}catch{}}}let i=o,s="";const l=i.indexOf("#");l!==-1&&(s=i.slice(l),i=i.slice(0,l));const c=new RegExp(`([?&])${r}=[^&]*`),u=`$1${r}=${n}`;if(c.test(i)?i=i.replace(c,u):i.indexOf("?")!==-1?i+=`&${r}=${n}`:i&&(i+=`?${r}=${n}`),typeof URL=="function")for(let f=0;f<a.length;f+=1){const d=a[f];try{const p=new URL(i+s,d).toString();return{originalHref:o,nextHref:p,param:r,timestamp:n}}catch{}}return{originalHref:o,nextHref:i?i+s:o,param:r,timestamp:n}}function Mle(e,t={}){if(typeof window>"u"||!window)return Promise.resolve(!1);const r=window,n=typeof e=="string"?e:"",o=t&&typeof t.timeout=="number"&&t.timeout>0?t.timeout:1500,a=t&&typeof t.interval=="number"&&t.interval>0?t.interval:60,i=typeof r.setTimeout=="function"?r.setTimeout.bind(r):setTimeout,s=typeof r.clearTimeout=="function"?r.clearTimeout.bind(r):clearTimeout;return new Promise(l=>{let c=!1,u=null,f=null;const d=()=>{if(u){try{s(u)}catch{}u=null}if(f){try{s(f)}catch{}f=null}if(typeof r.removeEventListener=="function"){try{r.removeEventListener("beforeunload",h,!0)}catch{}try{r.removeEventListener("pagehide",h,!0)}catch{}try{r.removeEventListener("unload",h,!0)}catch{}}},p=g=>{c||(c=!0,d(),l(g))},h=()=>{p(!0)},m=()=>{if(!c){try{const g=El(r.location);if(n&&g&&g!==n){p(!0);return}}catch{}u=i(m,a)}};if(typeof r.addEventListener=="function"){try{r.addEventListener("beforeunload",h,!0)}catch{}try{r.addEventListener("pagehide",h,!0)}catch{}try{r.addEventListener("unload",h,!0)}catch{}}m(),f=i(()=>{p(!1)},o)})}function eY(e,t,r,n,o,a){let i=null;try{typeof window<"u"&&window&&typeof window.setTimeout=="function"&&(i=window.setTimeout.bind(window))}catch{}if(!i)if(typeof setTimeout=="function")i=setTimeout;else{console.warn("Forced reload navigation attempt did not update location",{description:r,before:n,after:a,expected:o});return}let s=!1;const l=()=>{const u=El(e),f=qu(u,t);return o&&(f===o||f===`${o}#`)||n!==f&&f&&(!o||f===o)?(s=!0,{matched:!0,value:f}):{matched:!1,value:f}},c=[90,240,480];c.forEach((u,f)=>{const d=f===c.length-1,p=()=>{if(s)return;const h=l();h.matched||d&&(s=!0,console.warn("Forced reload navigation attempt did not update location",{description:r,before:n,after:h.value,expected:o}))};try{i(p,u)}catch{d&&p()}})}function uk(e,t,r,n,o){if(!e||typeof n!="function"||typeof t!="string"||!t)return!1;const a=El(e),i=qu(a,r);try{n(t)}catch(u){return console.warn("Forced reload navigation helper failed",{description:o,error:u}),!1}const s=El(e),l=qu(s,r),c=qu(t,r);return c&&(l===c||l===`${c}#`)||i!==l&&l&&(!c||l===c)?!0:(eY(e,r,o,i,c,l),!1)}function _le(e,t,r,n){if(!e||!t||typeof r!="string"||!r)return!1;let o=null;try{o=e.history||null}catch(h){console.warn("Forced reload history access failed",h),o=null}if(!o||typeof o.replaceState!="function")return!1;const a=El(t),i=qu(a,n),s=qu(r,n);let l=r;try{const h=a||n||void 0,m=typeof URL=="function"?new URL(r,h):null;m&&(l=`${m.pathname||""}${m.search||""}${m.hash||""}`||m.toString())}catch(h){console.warn("Forced reload history fallback URL parse failed",h),l=r}let c=null,u=!1;try{c=o.state,u=!0}catch(h){console.warn("Forced reload history state snapshot failed",h)}try{o.replaceState(u?c:null,"",l)}catch(h){return console.warn("Forced reload history replaceState failed",h),!1}const f=El(t),d=qu(f,n);if(!(s&&(d===s||d===`${s}#`)||i!==d&&d&&(!s||d===s)))return eY(t,n,"history.replaceState",i,s,d),!1;if(typeof t.reload=="function")try{return t.reload(),!0}catch(h){console.warn("Forced reload via history replaceState reload failed",h)}return!0}function Dle(e,t,r={}){if(!e||!t)return;let n=null;try{typeof e.setTimeout=="function"&&(n=e.setTimeout.bind(e))}catch{}if(!n)if(typeof setTimeout=="function")n=setTimeout;else return;const o=r.hasReload===!0&&typeof t.reload=="function",a=typeof r.baseHref=="string"?r.baseHref:"",i=typeof r.nextHref=="string"?r.nextHref:"",s=typeof r.originalHref=="string"?r.originalHref:"",l=i||a||s||"",c=l?l.split("#")[0]:a||s||"",u=typeof r.timestamp=="string"&&r.timestamp?r.timestamp:Date.now().toString(36),f=c?`${c}#forceReload-${u}`:"",d=[];let p=120;const h=120,m=g=>{d.push({delay:p,run:g}),p+=h};if(l&&(typeof t.assign=="function"&&m(()=>{try{t.assign(l)}catch(g){console.warn("Forced reload fallback via location.assign failed",g)}}),typeof t.replace=="function"&&m(()=>{try{t.replace(l)}catch(g){console.warn("Forced reload fallback via location.replace failed",g)}}),m(()=>{try{t.href=l}catch(g){console.warn("Forced reload fallback via href assignment failed",g)}})),f&&f!==l&&m(()=>{try{t.href=f}catch(g){console.warn("Forced reload fallback via hash injection failed",g)}}),o){const g=d.length?Math.max(p,280):280;d.push({delay:g,run(){try{t.reload()}catch(S){console.warn("Timed force reload fallback failed",S)}}})}d.length&&d.forEach(g=>{try{n(g.run,g.delay)}catch(S){console.warn("Unable to schedule forced reload fallback",S)}})}function Nle(e){if(!e||!e.location)return null;const{location:t}=e,r=typeof t.replace=="function",n=typeof t.assign=="function",o=typeof t.reload=="function",a=Gle(t,"forceReload"),{originalHref:i,nextHref:s,timestamp:l}=a,c=qu(i,i)||i;return{win:e,location:t,hasReplace:r,hasAssign:n,hasReload:o,originalHref:i,nextHref:s,timestamp:l,baseHref:c}}function Fle(e){if(!e||!e.location)return!1;const{win:t,location:r,hasReplace:n,hasAssign:o,hasReload:a,originalHref:i,nextHref:s,timestamp:l,baseHref:c}=e;let u=!1;if(n&&s&&(u=uk(r,s,c,d=>r.replace(d),"location.replace")),!u&&o&&s&&(u=uk(r,s,c,d=>r.assign(d),"location.assign")),!u&&s&&s!==i&&(u=uk(r,s,c,d=>{r.href=d},"location.href assignment")),!u&&t&&s&&(u=_le(t,r,s,c)),!u&&(!s||s===i)&&a)try{r.reload(),u=!0}catch(d){console.warn("Forced reload via location.reload failed",d)}return u||Dle(t,r,{originalHref:i,baseHref:c,nextHref:s,hasReload:a,timestamp:l}),u}function BP(e){const t=Nle(e);return t?Fle(t):!1}function jle(e,t=4500){if(!e)return null;let r=null,n=null;try{typeof e.setTimeout=="function"&&(r=e.setTimeout.bind(e))}catch{}try{typeof e.clearTimeout=="function"&&(n=e.clearTimeout.bind(e))}catch{}if(!r)if(typeof setTimeout=="function")r=setTimeout;else return{triggerNow(){BP(e)}};n||(n=typeof clearTimeout=="function"?clearTimeout:null);let o=!1,a=null;const i=()=>{if(!o){o=!0,a=null;try{!BP(e)&&e&&e.location&&typeof e.location.reload=="function"&&e.location.reload()}catch(s){console.warn("Force reload fallback execution failed",s);try{e&&e.location&&typeof e.location.reload=="function"&&e.location.reload()}catch(l){console.warn("Ultimate force reload fallback failed",l)}}}};try{a=r(i,t)}catch(s){console.warn("Unable to schedule reload fallback timer",s),i()}return{triggerNow(){if(!o){if(a!=null&&typeof n=="function")try{n(a)}catch{}i()}}}}const q1=5e3,K1=700;function W1(e,t,r,n){if(!e||typeof e.then!="function")return Promise.resolve({timedOut:!1,result:e});const o=typeof t=="number"&&t>=0?t:null,a=typeof setTimeout=="function"?setTimeout:null,i=typeof clearTimeout=="function"?clearTimeout:null;if(o===null||!a)return e.then(c=>({timedOut:!1,result:c}));let s=!1,l=null;return new Promise((c,u)=>{e.then(f=>{if(s)return f;if(s=!0,l!=null&&i)try{i(l)}catch{}return c({timedOut:!1,result:f}),f},f=>{if(s){if(typeof n=="function")try{n(f)}catch{}return null}if(s=!0,l!=null&&i)try{i(l)}catch{}return u(f),null}),l=a(()=>{if(!s){if(s=!0,typeof r=="function")try{r()}catch{}c({timedOut:!0,result:void 0})}},o)})}function Hle(e){const t=e&&typeof e=="object"?e:null;if(!t||!t.serviceWorker)return null;const{serviceWorker:r}=t;if(!r)return null;let n=!1,o=null,a=null,i=!1;const s=c=>{if(n)return;n=!0;const u=a;if(a=null,typeof o=="function"){try{o()}catch{}o=null}if(typeof u=="function")try{u(c)}catch{}},l=new Promise(c=>{if(a=c,r.controller){s(!0);return}const u=()=>{s(!0)};try{if(typeof r.addEventListener=="function")r.addEventListener("controllerchange",u),o=()=>{try{r.removeEventListener("controllerchange",u)}catch(f){}},i=!0;else if("oncontrollerchange"in r){const f=r.oncontrollerchange;r.oncontrollerchange=function(p){if(typeof f=="function")try{f.call(this,p)}catch(h){console.warn("Existing service worker controllerchange handler failed",h)}u(p)},o=()=>{try{r.oncontrollerchange=f}catch(d){}},i=!0}else s(!1)}catch(f){console.warn("Failed to observe service worker controllerchange",f),s(!1)}});return!i&&!r.controller?(s(!1),null):{promise:l,cancel(){s(!1)}}}async function Ule(e){if(!e)return[];const t=[],r=n=>{n&&t.push(n)};try{if(typeof e.getRegistrations=="function"){const n=await e.getRegistrations();Array.isArray(n)&&n.forEach(r)}else if(typeof e.getRegistration=="function"){const n=await e.getRegistration();r(n)}else if(e.ready&&typeof e.ready.then=="function")try{const n=await e.ready;r(n)}catch(n){console.warn("Failed to await active service worker",n)}}catch(n){console.warn("Failed to query service worker registrations",n)}return t}async function zle(){const e=typeof navigator<"u"?navigator:void 0;if(Fae(e))return pP(),{blocked:!0,reason:"offline"};try{CM({reason:"before-manual-reload"})}catch(d){console.warn("Failed to flush auto save before manual reload",d)}const t=typeof window<"u"&&window?jle(window):null,r=typeof globalThis<"u"&&globalThis&&globalThis.cineOffline||typeof window<"u"&&window&&window.cineOffline||null,n=typeof window<"u"&&window&&window.location?El(window.location):"",o=typeof caches<"u"?caches:void 0,a=e&&e.serviceWorker?e.serviceWorker:null,i=a?Ule(a):Promise.resolve([]);if(r&&typeof r.reloadApp=="function")try{const d=r.reloadApp({window,navigator:e,caches:o,onOfflineReloadBlocked:pP}),{timedOut:p,result:h}=await W1(d,q1,()=>{console.warn("Offline module reload timed out; continuing with manual fallback after soft timeout.",{timeoutMs:q1})},m=>{console.warn("Offline module reload promise rejected after timeout",m)});if(!p&&(h===!0||h&&typeof h=="object"&&(h.reloadTriggered===!0||h.navigationTriggered===!0))&&await Mle(n).catch(()=>!1))return}catch(d){console.warn("Offline module reload failed, falling back to manual refresh",d)}let s=!1;try{typeof R0=="function"&&(R0(),s=!0)}catch(d){console.warn("Failed to clear UI caches via storage helper",d)}if(!s)try{Ole(),s=!0}catch(d){console.warn("Fallback UI cache clear failed",d)}let l=Promise.resolve(!1),c=Promise.resolve(!1);a&&(l=(async()=>{try{const d=await i;return d.length?(await Promise.all(d.map(p=>!p||typeof p.unregister!="function"?Promise.resolve(!1):p.unregister().catch(h=>(console.warn("Service worker unregister failed",h),!1)))),!0):!1}catch(d){return console.warn("Service worker cleanup failed",d),!1}})()),o&&typeof o.keys=="function"&&(c=(async()=>{try{const d=await o.keys();if(!Array.isArray(d)||!d.length)return!1;const p=xle(),h=p?p.toLowerCase():null,m=d.filter(S=>kle(S,p,h));if(!m.length)return!1;let g=!1;return await Promise.all(m.map(S=>!S||typeof o.delete!="function"?Promise.resolve(!1):o.delete(S).then(y=>(g=g||!!y,y)).catch(y=>(console.warn("Failed to delete cache",S,y),!1)))),g}catch(d){return console.warn("Cache clear failed",d),!1}})());let u=null,f=l;e&&e.serviceWorker&&(u=Hle(e),u&&u.promise&&l&&typeof l.then=="function"&&(f=Promise.race([l,u.promise])));try{await W1(f,K1,()=>{console.warn("Service worker cleanup timed out before reload; continuing anyway.",{timeoutMs:K1})},d=>{console.warn("Service worker cleanup failed after reload triggered",d)})}catch(d){console.warn("Service worker cleanup failed",d)}finally{if(u&&typeof u.cancel=="function")try{u.cancel()}catch{}}try{if(t&&typeof t.triggerNow=="function")t.triggerNow();else{const d=typeof window<"u"?window:null;!BP(d)&&d&&d.location&&typeof d.location.reload=="function"&&d.location.reload()}}catch(d){console.warn("Forced reload failed",d),typeof window<"u"&&window.location&&typeof window.location.reload=="function"&&window.location.reload()}try{await c}catch(d){console.warn("Cache clear failed",d)}}const Y1=typeof document<"u"?document.getElementById("reloadButton"):null;Y1&&Y1.addEventListener("click",zle);function tY(){if(!setupDiagramContainer)return"";const e=setupDiagramContainer.querySelector("svg");if(!e)return"";const t=e.cloneNode(!0),r=e.querySelectorAll(".edge-label"),n=t.querySelectorAll(".edge-label");r.forEach((s,l)=>{n[l]&&(n[l].textContent=s.textContent)});const o=document.createElementNS("http://www.w3.org/2000/svg","style");let a=typeof getDiagramCss=="function"?getDiagramCss:null;return!a&&typeof Gu=="object"&&typeof Gu.getDiagramCss=="function"&&(a=Gu.getDiagramCss),o.textContent=a?a(!1):"",t.insertBefore(o,t.firstChild),new XMLSerializer().serializeToString(t)}function $le(e){if(typeof e!="string"||!e)return;if(typeof navigator<"u"&&navigator&&navigator.clipboard&&typeof navigator.clipboard.writeText=="function"){navigator.clipboard.writeText(e).catch(()=>{});return}if(typeof document>"u"||!document||!document.body||typeof document.createElement!="function")return;let t=null;const r=document.activeElement;try{t=document.createElement("textarea"),t.value=e,t.setAttribute("readonly",""),t.style.position="fixed",t.style.top="-9999px",t.style.opacity="0",document.body.appendChild(t);try{t.focus()}catch{}try{t.select(),typeof t.setSelectionRange=="function"&&t.setSelectionRange(0,t.value.length)}catch{}if(typeof document.execCommand=="function")try{document.execCommand("copy")}catch{}}catch{}finally{if(t&&t.parentNode&&t.parentNode.removeChild(t),r&&typeof r.focus=="function")try{r.focus()}catch{}}}const Q1=()=>{const e=die||document.getElementById("downloadDiagram");return e?(e.removeEventListener("click",X1),e.addEventListener("click",X1),!0):!1};function X1(e){const t=tY();if(!t)return;$le(t);const r=l=>String(l).padStart(2,"0"),n=new Date,o=`${n.getFullYear()}-${r(n.getMonth()+1)}-${r(n.getDate())}_${r(n.getHours())}-${r(n.getMinutes())}`,a=(pR("setup")||"setup").replace(/\s+/g,"-").replace(/[^a-z0-9-_]/gi,""),i=`${o}_${a}_diagram`,s=()=>{const l=new Blob([t],{type:"image/svg+xml;charset=utf-8"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c,u.download=`${i}.svg`,u.click(),setTimeout(()=>{URL.revokeObjectURL(c)},6e4)};if(e.shiftKey){const l=new Image;l.onload=()=>{const c=document.createElement("canvas");c.width=l.width,c.height=l.height,c.getContext("2d").drawImage(l,0,0),c.toBlob(f=>{const d=URL.createObjectURL(f),p=document.createElement("a");p.href=d,p.download=`${i}.jpg`,p.click(),setTimeout(()=>{URL.revokeObjectURL(d)},6e4)},"image/jpeg",.95)},l.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t)}else s()}const J1=()=>{const e=NA||document.getElementById("gridSnapToggle");return e?(e.removeEventListener("click",Z1),e.addEventListener("click",Z1),!0):!1};function Z1(){const e=!y2(),t=pie(e);h2(t)}Q1()||document.addEventListener("DOMContentLoaded",Q1);J1()||document.addEventListener("DOMContentLoaded",J1);const eU=()=>{let e=document.getElementById("helpQuickLinksNav"),t=document.getElementById("helpQuickLinksList"),r=document.getElementById("helpQuickLinksHeading"),n=document.getElementById("helpSectionsContainer"),o;const a=helpButton||document.getElementById("helpButton"),i=Ca||document.getElementById("helpDialog");if(!a||!i)return!1;if(a.dataset.helpInitialized)return!0;a.dataset.helpInitialized="true",a.addEventListener("click",j=>{j.preventDefault(),q()});const s=i.querySelector(".help-content"),l=new Map,c=new Map,u=new Map,f=new Map;(()=>{if(!s)return;s.querySelectorAll("a.help-link").forEach(O=>{O.classList.add("button-link")})})();const p=j=>{if(!j)return;const O=j,D=u.get(O);D&&clearTimeout(D),O.classList.add("help-target-focus");const F=setTimeout(()=>{O.classList.remove("help-target-focus"),u.delete(O)},2e3);u.set(O,F)},h=j=>{if(!Array.isArray(j)||j.length===0)return;const O=new Set;j.forEach(D=>{if(!D||typeof D.classList?.add!="function"||O.has(D))return;O.add(D);const F=f.get(D);F&&clearTimeout(F),D.classList.add("feature-search-focus");const z=setTimeout(()=>{D.classList.remove("feature-search-focus"),f.delete(D)},2500);f.set(D,z)})},m=j=>{if(!j)return[];const O=new Set,D=j.ownerDocument||(typeof document<"u"?document:null);if(j.labels&&typeof j.labels=="object"&&Array.from(j.labels).forEach(F=>{F&&O.add(F)}),typeof j.closest=="function"){const F=j.closest("label");F&&O.add(F)}if(D&&typeof j.getAttribute=="function"){const F=z=>{z&&z.split(/\s+/).filter(Boolean).forEach(J=>{const Q=D.getElementById(J);Q&&O.add(Q)})};F(j.getAttribute("aria-labelledby")),F(j.getAttribute("aria-describedby"))}return Array.from(O)},g=j=>{if(!(!j||typeof j!="object"||typeof j.nodeType!="number")){if(vi&&vi.contains(j)&&vi.hasAttribute("hidden"))if(typeof OP=="function")try{OP()}catch(O){console.warn("Unable to open backup diff section for feature search target",O),vi.removeAttribute("hidden")}else vi.removeAttribute("hidden");if(Oc&&Oc.contains(j)&&Oc.hasAttribute("hidden"))if(typeof SP=="function")try{SP()}catch(O){console.warn("Unable to open restore rehearsal section for feature search target",O),Oc.removeAttribute("hidden")}else Oc.removeAttribute("hidden")}},S=j=>{if(!j||typeof j.closest!="function")return;g(j);const O=j.closest("#settingsDialog"),D=j.closest(".settings-panel");if(D){const pe=(D.getAttribute("aria-labelledby")||"").split(/\s+/).map(ne=>ne.trim()).filter(Boolean).find(ne=>document.getElementById(ne));pe&&activateSettingsTab(pe)}if(O&&!isDialogOpen(Vl)){const le={reason:"feature-search",targetId:typeof j.id=="string"&&j.id?j.id:null};if(typeof j.getAttribute=="function"){const Ee=j.getAttribute("aria-label")||j.getAttribute("data-help")||j.getAttribute("data-feature-key");Ee&&(le.targetLabel=Ee);const pe=j.getAttribute("role");pe&&(le.targetRole=pe)}U0(le)}const F=j.closest("dialog");F&&!isDialogOpen(F)&&(F.id==="projectDialog"?generateGearListBtn?.click?.():F.id==="feedbackDialog"?runtimeFeedbackBtn?.click?.():F.id==="overviewDialog"?generateOverviewBtn?.click?.():openDialog(F)),j.closest("#device-manager")&&showDeviceManagerSection(),typeof j.scrollIntoView=="function"&&j.scrollIntoView({behavior:"smooth",block:"center"});const J=j.hasAttribute("tabindex");let Q=!1;if(!J){const le=j.tabIndex;typeof le=="number"&&le<0&&(j.setAttribute("tabindex","-1"),Q=!0)}if(typeof j.focus=="function")try{j.focus({preventScroll:!0})}catch{j.focus()}Q&&j.addEventListener("blur",()=>j.removeAttribute("tabindex"),{once:!0})},y=j=>{if(!j)return;const O=j.querySelector("h3, summary, h4, h5, h6")||j.querySelector("button, a");if(!O)return;const D=O.hasAttribute("tabindex");D||O.setAttribute("tabindex","-1");try{O.focus({preventScroll:!0})}catch{O.focus()}D||O.addEventListener("blur",()=>O.removeAttribute("tabindex"),{once:!0})},E=j=>{if(!j)return;const O=c.get(j);O&&clearTimeout(O),j.classList.add("help-section-focus");const D=setTimeout(()=>{j.classList.remove("help-section-focus"),c.delete(j)},1500);c.set(j,D)};let L=null,v=null;const A=()=>{if(!t||!t.childElementCount)return;const j=()=>{t.querySelectorAll('li[data-quick-link-spacer="true"]').forEach(tf);const O=Array.from(t.children);if(!O.length)return;const D=[],F=[],z=[];if(O.forEach((pe,ne)=>{const Se=pe.querySelector(".help-quick-link");if(!Se){z.push({index:ne,node:pe});return}if(pe.hasAttribute("hidden")){z.push({index:ne,node:pe,button:Se}),Se.classList.remove("help-quick-link-multiline");return}const Le=Se.querySelector(".help-quick-link-label");if(!Le){F.push({index:ne,node:pe,button:Se}),Se.classList.remove("help-quick-link-multiline");return}const ke=window.getComputedStyle(Le);let We=Number.parseFloat(ke.lineHeight);(!We||Number.isNaN(We))&&(We=Number.parseFloat(ke.fontSize)||0);const nt=Le.offsetHeight||Le.getBoundingClientRect().height,Et=(We?Math.round(nt/We):1)>1;Se.classList.toggle("help-quick-link-multiline",Et),Et?D.push({index:ne,node:pe,button:Se}):F.push({index:ne,node:pe,button:Se})}),!D.length&&!F.length)return;const J=document.createDocumentFragment(),Q=D.sort((pe,ne)=>pe.index-ne.index),le=F.sort((pe,ne)=>pe.index-ne.index),Ee=Math.max(Math.ceil(Q.length/2),Math.ceil(le.length/2));for(let pe=0;pe<Ee;pe+=1){const ne=pe*2;if(ne<Q.length){if(J.appendChild(Q[ne].node),ne+1<Q.length)J.appendChild(Q[ne+1].node);else if(le.length){const Le=document.createElement("li");Le.dataset.quickLinkSpacer="true",Le.setAttribute("aria-hidden","true"),Le.setAttribute("role","presentation"),Le.className="help-quick-link-spacer",J.appendChild(Le)}}const Se=pe*2;Se<le.length&&(J.appendChild(le[Se].node),Se+1<le.length&&J.appendChild(le[Se+1].node))}z.sort((pe,ne)=>pe.index-ne.index).forEach(({node:pe})=>J.appendChild(pe)),J.childNodes.length&&t.appendChild(J)};typeof window<"u"&&typeof window.requestAnimationFrame=="function"?(L&&window.cancelAnimationFrame(L),L=window.requestAnimationFrame(()=>{L=null,j()})):j()},R=()=>{v&&clearTimeout(v),v=setTimeout(()=>{v=null,A()},150)},I=()=>{if(!e||!t||!l.size){e&&e.setAttribute("hidden","");return}let j=!1;l.forEach(({section:O,listItem:D,button:F})=>{O&&!O.hasAttribute("hidden")?(D.removeAttribute("hidden"),j=!0):(D.setAttribute("hidden",""),F&&F.classList.remove("active"))}),j?(e.removeAttribute("hidden"),A()):e.setAttribute("hidden","")},C=j=>{if(!e)return;const O=texts&&texts[j]||{},D=texts&&texts.en||{},F=O.helpQuickLinksHeading||D.helpQuickLinksHeading;r&&F&&(r.textContent=F);const z=O.helpQuickLinksAriaLabel||F||D.helpQuickLinksAriaLabel||"Help topics quick navigation";e.setAttribute("aria-label",z);const J=O.helpQuickLinksHelp||D.helpQuickLinksHelp;J?e.setAttribute("data-help",J):e.removeAttribute("data-help");const Q=O.helpQuickLinkButtonHelp||D.helpQuickLinkButtonHelp;l.forEach(({button:le,label:Ee})=>{if(le)if(Q){const pe=Q.replace("%s",Ee);le.setAttribute("data-help",pe),le.setAttribute("aria-label",pe)}else le.removeAttribute("data-help"),le.setAttribute("aria-label",Ee)}),A()};typeof globalThis<"u"?globalThis.updateHelpQuickLinksForLanguage=C:typeof window<"u"&&(window.updateHelpQuickLinksForLanguage=C),(()=>{if(!e||!t||!n){l.clear(),e&&e.setAttribute("hidden","");return}l.clear(),t.textContent="";const j=document.createDocumentFragment();if(Array.from(n.querySelectorAll("section[data-help-section]")).forEach(D=>{const F=D.id;if(!F)return;const z=D.querySelector("h3");if(!z)return;const J=z.querySelector(".help-icon.icon-glyph");let Q=z.textContent||"";if(J){const ne=J.textContent||"";if(ne){const Se=Q.indexOf(ne);Se>-1&&(Q=Q.slice(0,Se)+Q.slice(Se+ne.length))}}if(Q=Q.trim(),!Q)return;const le=document.createElement("li"),Ee=document.createElement("button");if(Ee.type="button",Ee.className="help-quick-link button-link",Ee.dataset.targetId=F,Ee.setAttribute("aria-label",Q),J){const ne=J.cloneNode(!0);ne.classList.remove("help-icon"),ne.classList.add("help-quick-link-icon"),Ee.appendChild(ne)}const pe=document.createElement("span");pe.className="help-quick-link-label",pe.textContent=Q,Ee.appendChild(pe),Ee.addEventListener("click",()=>{if(D.hasAttribute("hidden"))return;t&&t.querySelectorAll(".help-quick-link.active").forEach(Se=>Se.classList.remove("active")),Ee.classList.add("active"),typeof D.scrollIntoView=="function"&&D.scrollIntoView({behavior:"smooth",block:"start"}),E(D),y(D);const ne=D.querySelector('h3, summary, h4, h5, h6, [role="heading"]')||D.querySelector("button, a");h(ne?[ne]:[D])}),le.appendChild(Ee),j.appendChild(le),l.set(F,{section:D,button:Ee,listItem:le,label:Q})}),!j.childNodes.length){e.setAttribute("hidden","");return}t.appendChild(j),C(currentLang),I()})(),typeof window<"u"&&window.addEventListener("resize",()=>{!t||e?.hasAttribute("hidden")||R()},{passive:!0}),Ca&&Ca.addEventListener("click",j=>{const O=j.target.closest("a[data-help-target]");if(!O)return;const F=(O.dataset.helpTarget||O.getAttribute("href")||"").trim();if(!F)return;let z;try{z=document.querySelector(F)}catch{z=null}if(!z)return;j.preventDefault();const J=O.dataset.helpHighlight||"";let Q=z;if(J)try{const pe=document.querySelector(J);pe&&(Q=pe)}catch{}const le=Ca.contains(z),Ee=()=>{S(z),Q&&p(Q);const pe=m(Q||z);pe.length&&h(pe)};if(le){Ee();return}N(null),requestAnimationFrame(()=>{requestAnimationFrame(Ee)})});const _=new Map([["a",""],["b",""],["c",""],["d",""],["e",""],["f",""],["g",""],["h",""],["i",""],["j",""],["k",""],["l",""],["m",""],["n",""],["o",""],["p",""],["q",""],["r",""],["s",""],["t",""],["u",""],["v",""],["w",""],["x",""],["y",""],["z",""]]),w=j=>{if(!j)return"";let O=String(j).toLowerCase();return typeof O.normalize=="function"&&(O=O.normalize("NFD")),O=O.replace(/[\u0300-\u036f]/g,"").replace(//g,"ss").replace(//g,"ae").replace(//g,"oe").replace(//g,"o").replace(/&/g,"and").replace(/\+/g,"plus").replace(/[]/g,"deg").replace(/\bdegrees?\b/g,"deg").replace(/[]/g,"x"),typeof normalizeSpellingVariants=="function"&&(O=normalizeSpellingVariants(O)),O=normaliseMarkVariants(O),O.replace(/[^a-z0-9]+/g,"")},x=j=>{if(!j)return null;const O=J=>J.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),D=[],F=J=>{const Q=_.get(J)||"",le=new Set,Ee=`${J}${Q}`;for(const ne of Ee){le.add(ne);const Se=ne.toUpperCase();Se&&le.add(Se)}return`[${Array.from(le).map(O).join("")}]`};return Array.from(j).forEach((J,Q)=>{Q>0&&D.push("\\s*"),/[a-z]/.test(J)?D.push(F(J)):/[0-9]/.test(J)?D.push(J):D.push(O(J))}),`(${D.join("")})`},G=({totalCount:j,visibleCount:O,hasQuery:D,queryText:F}={})=>{const z=()=>{helpResultsAssist&&(helpResultsAssist.textContent="",helpResultsAssist.setAttribute("hidden",""))};if(!helpResultsSummary){z();return}typeof j=="number"&&Number.isFinite(j)&&(helpResultsSummary.dataset.totalCount=String(j)),typeof O=="number"&&Number.isFinite(O)&&(helpResultsSummary.dataset.visibleCount=String(O)),typeof D=="boolean"&&(helpResultsSummary.dataset.hasQuery=D?"true":"false"),typeof F=="string"&&(helpResultsSummary.dataset.query=F);const J=Number(helpResultsSummary.dataset.totalCount||0);if(!J){helpResultsSummary.textContent="",helpResultsSummary.setAttribute("hidden",""),z();return}const Q=Number(helpResultsSummary.dataset.visibleCount||0),le=helpResultsSummary.dataset.hasQuery==="true",Ee=helpResultsSummary.dataset.query||"",pe=texts&&texts[currentLang]||{},ne=texts&&texts.en||{};let Se="";if(le){const Le=pe.helpResultsSummaryFiltered||ne.helpResultsSummaryFiltered;Le?Se=Le.replace("%1$s",Q).replace("%2$s",J).replace("%3$s",Ee):Ee?Se=`Showing ${Q} of ${J} help topics for ${Ee}.`:Se=`Showing ${Q} of ${J} help topics.`}else{const Le=pe.helpResultsSummaryAll||ne.helpResultsSummaryAll;Le?Se=Le.replace("%s",J):Se=`All ${J} help topics are shown.`}if(helpResultsSummary.textContent=Se,helpResultsSummary.removeAttribute("hidden"),helpResultsAssist)if(Q>0){const ke=pe.helpResultsAssist||ne.helpResultsAssist||"Tip: Press Tab to move into the quick links, or press Enter to open the top visible topic.";helpResultsAssist.textContent=ke,helpResultsAssist.removeAttribute("hidden")}else z()};typeof globalThis<"u"?globalThis.updateHelpResultsSummaryText=G:typeof window<"u"&&(window.updateHelpResultsSummaryText=G);const T=()=>{if(!ia){helpResultsSummary&&helpResultsSummary.setAttribute("hidden","");return}const j=ia.value.trim(),O=w(j),D=O.length>0,F=Array.from(Ca.querySelectorAll("[data-help-section]")),z=Array.from(Ca.querySelectorAll(".faq-item")),J=F.concat(z),Q=J.length;let le=0;const Ee=D?x(O):null,pe=(Se,Le)=>{if(!Le||typeof document.createTreeWalker!="function"||typeof NodeFilter>"u")return;const ke=document.createTreeWalker(Se,NodeFilter.SHOW_TEXT,null),We=[];for(;ke.nextNode();)We.push(ke.currentNode);We.forEach(nt=>{const it=nt.textContent;if(!it)return;const Et=new RegExp(Le,"giu"),yr=Et.exec(it);if(!yr)return;const hr=document.createDocumentFragment();let Vr=0,Rr=yr;do{const Qe=Rr.index,Vn=Qe+Rr[0].length;Qe>Vr&&hr.appendChild(document.createTextNode(it.slice(Vr,Qe)));const qn=document.createElement("mark");qn.textContent=it.slice(Qe,Vn),hr.appendChild(qn),Vr=Vn,Et.lastIndex===Qe&&Et.lastIndex++}while((Rr=Et.exec(it))!==null);Vr<it.length&&hr.appendChild(document.createTextNode(it.slice(Vr))),nt.parentNode&&nt.parentNode.replaceChild(hr,nt)})};J.forEach(Se=>{const Le=Se.classList.contains("faq-item");Se.dataset.origHtml?Se.innerHTML=Se.dataset.origHtml:(Se.dataset.origHtml=Se.innerHTML,Le&&(Se.dataset.defaultOpen=Se.hasAttribute("open")?"true":"false"));const ke=w(Se.textContent||""),We=w(Se.dataset.helpKeywords||"");!D||ke.includes(O)||We.includes(O)?(D&&Ee&&pe(Se,Ee),Se.removeAttribute("hidden"),Le&&(D||Se.dataset.defaultOpen==="true"?Se.setAttribute("open",""):Se.removeAttribute("open")),le+=1):(Se.setAttribute("hidden",""),Le&&Se.removeAttribute("open"))}),typeof G=="function"&&G({totalCount:Q,visibleCount:le,hasQuery:D,queryText:j||O});const ne=D&&le===0;helpNoResults&&(ne?helpNoResults.removeAttribute("hidden"):helpNoResults.setAttribute("hidden","")),typeof helpNoResultsSuggestions<"u"&&helpNoResultsSuggestions&&(ne?helpNoResultsSuggestions.removeAttribute("hidden"):helpNoResultsSuggestions.setAttribute("hidden","")),Ux&&(D?Ux.removeAttribute("hidden"):Ux.setAttribute("hidden","")),I()},P=()=>{if(rie("help-open"),closeSideMenu(),Ca.removeAttribute("hidden"),openDialog(Ca),ia)ia.value="",T(),t&&t.querySelectorAll(".help-quick-link.active").forEach(j=>j.classList.remove("active")),s&&(s.scrollTop=0),ia.focus();else try{Ca.focus({preventScroll:!0})}catch{Ca.focus()}},N=(j=helpButton)=>{const O=Ca||document.getElementById("helpDialog");if(O&&(closeDialog(O),O.setAttribute("hidden",""),O.style.display="none"),j&&typeof j.focus=="function")try{j.focus({preventScroll:!0})}catch{j.focus()}},q=()=>{isDialogOpen(Ca)?N():P()};let Z=!1,U,K=null,H=null,te=null,re=null;const fe=j=>typeof j!="string"?[]:j.split(",").map(O=>O.trim()).filter(Boolean),Oe=j=>typeof j!="string"?[]:j.split(/\s+/).map(O=>O.trim()).filter(Boolean),Te=j=>{if(!j||!document?.querySelector)return[];const O=[],D=new Set,F=Q=>{!Q||!(Q instanceof Element)||Q!==j&&(D.has(Q)||(D.add(Q),O.push(Q)))},z=Q=>{fe(Q).forEach(le=>{try{const Ee=document.querySelector(le);F(Ee)}catch{}})},J=Q=>{Oe(Q).forEach(le=>{const Ee=document.getElementById(le);F(Ee)})};return z(j.getAttribute("data-hover-help-target")),z(j.getAttribute("data-hover-help-source")),j.hasAttribute("data-hover-help-skip-help-target")||z(j.getAttribute("data-help-target")),J(j.getAttribute("data-hover-help-targets")),O},Ne="[data-help], [aria-label], [title], [aria-labelledby], [alt], [aria-describedby]",Ie=j=>{if(!j)return null;const O=j.closest(Ne);return!O||O.tagName==="SECTION"?null:O},et={control:"Ctrl",ctrl:"Ctrl",meta:"Cmd",cmd:"Cmd",command:"Cmd",option:"Alt",alt:"Alt",shift:"Shift",enter:"Enter",return:"Enter",escape:"Esc",esc:"Esc",space:"Space",spacebar:"Space",tab:"Tab",slash:"/",question:"?",backslash:"\\",minus:"",dash:"",plus:"+",period:".",comma:",",semicolon:";",colon:":",arrowup:"",arrowdown:"",arrowleft:"",arrowright:"",pageup:"Page Up",pagedown:"Page Down",home:"Home",end:"End",delete:"Delete",backspace:"Backspace",insert:"Insert"},Ze=j=>{if(typeof j!="string")return"";const O=j.trim();if(!O)return"";const D=O.toLowerCase();if(et[D])return et[D];if(/^f\d{1,2}$/i.test(O))return O.toUpperCase();if(/^key[a-z]$/i.test(O))return O.slice(3).toUpperCase();if(/^digit\d$/i.test(O))return O.slice(5);if(/^numpad\d$/i.test(O))return`Numpad ${O.slice(6)}`;if(/^numpad(add|subtract|multiply|divide)$/i.test(D)){const F=D.slice(6);return`Numpad ${{add:"+",subtract:"",multiply:"",divide:""}[F]||F}`}return O.length===1?O.toUpperCase():O.replace(/^[a-z]/,F=>F.toUpperCase())},Ft=j=>{if(typeof j!="string")return"";const O=j.split("+").map(Ze).filter(Boolean);return O.length?O.join(" + "):""},Ye=j=>typeof j!="string"?[]:j.split(/[;,\n\u2022\u2027\u00b7]+/).map(O=>O.trim()).filter(Boolean),ct=j=>{if(!j)return[];const O=[];[j.getAttribute("data-shortcut"),j.getAttribute("data-shortcuts"),j.getAttribute("data-help-shortcut"),j.getAttribute("data-help-shortcuts")].forEach(z=>{Ye(z).forEach(J=>{J&&O.push(J)})});const F=j.getAttribute("aria-keyshortcuts");return F&&F.split(/\s+/).map(Ft).filter(Boolean).forEach(z=>O.push(z)),O},Y=j=>{if(!texts||typeof texts!="object")return"";const O=typeof texts.en=="object"?texts.en[j]:"";if(typeof currentLang=="string"&&texts[currentLang]){const D=texts[currentLang][j];if(typeof D=="string"&&D.trim())return D}return typeof O=="string"?O:""},ee=j=>{if(!j)return[];const O=[],D=ne=>{!ne||O.includes(ne)||O.push(ne)},F=(j.getAttribute("role")||"").toLowerCase(),z=j.tagName?j.tagName.toLowerCase():"",J=(j.getAttribute("type")||"").toLowerCase(),Q=typeof j.type=="string"?j.type.toLowerCase():"",le=J||Q,Ee=(j.getAttribute("aria-haspopup")||"").toLowerCase(),pe=(j.getAttribute("aria-pressed")||"").toLowerCase();if((F==="dialog"||F==="alertdialog")&&D("hoverHelpFallbackDialog"),F==="alertdialog"&&D("hoverHelpFallbackAlert"),F==="tablist"&&D("hoverHelpFallbackTablist"),F==="tab"&&D("hoverHelpFallbackTab"),F==="menu"&&D("hoverHelpFallbackMenu"),F==="menuitem"&&D("hoverHelpFallbackMenu"),F==="listbox"&&D("hoverHelpFallbackSelect"),F==="link"&&D("hoverHelpFallbackLink"),F==="progressbar"&&D("hoverHelpFallbackProgress"),F==="status"&&D("hoverHelpFallbackStatus"),F==="alert"&&D("hoverHelpFallbackAlert"),F==="switch"&&D("hoverHelpFallbackSwitch"),(F==="checkbox"||F==="menuitemcheckbox")&&D("hoverHelpFallbackCheckbox"),(F==="radio"||F==="menuitemradio")&&D("hoverHelpFallbackRadio"),F==="slider"&&D("hoverHelpFallbackSlider"),F==="spinbutton"&&D("hoverHelpFallbackNumberInput"),(F==="textbox"||F==="searchbox")&&D("hoverHelpFallbackTextInput"),F==="combobox"&&D("hoverHelpFallbackSelect"),z==="button"||F==="button"||j.matches?.("input[type='button']")||j.matches?.("input[type='submit']")||j.matches?.("input[type='reset']"))Ee&&Ee!=="false"&&D("hoverHelpFallbackMenuButton"),(pe==="true"||pe==="mixed"||pe==="false")&&D("hoverHelpFallbackToggleButton"),D("hoverHelpFallbackButton");else if(z==="a"&&j.hasAttribute("href"))D("hoverHelpFallbackLink");else if(z==="select")D("hoverHelpFallbackSelect");else if(z==="textarea")D("hoverHelpFallbackTextarea");else if(z==="details")D("hoverHelpFallbackDetails");else if(z==="input")switch(le){case"checkbox":D("hoverHelpFallbackCheckbox");break;case"radio":D("hoverHelpFallbackRadio");break;case"range":D("hoverHelpFallbackSlider");break;case"number":D("hoverHelpFallbackNumberInput");break;case"file":D("hoverHelpFallbackFileInput");break;case"color":D("hoverHelpFallbackColorInput");break;default:D("hoverHelpFallbackTextInput");break}else j.isContentEditable&&D("hoverHelpFallbackTextarea");return D("hoverHelpFallbackGeneric"),O},Ae=j=>{if(!j)return{label:"",details:[]};const O=new Set,D=[],F=[],z=[],J=(ke,We)=>{if(typeof ke!="string")return;const nt=ke.replace(/\s+/g," ").trim();!nt||O.has(nt)||(O.add(nt),We.push(nt))},Q=ke=>J(ke,D),le=ke=>J(ke,F),Ee=ke=>J(ke,z),pe=(ke,{includeTextContent:We=!1,preferTextAsLabel:nt=!1}={})=>{if(!ke)return;le(ke.getAttribute("data-help")),le(ke.getAttribute("aria-description")),le(ke.getAttribute("title")),le(ke.getAttribute("aria-placeholder")),Q(ke.getAttribute("aria-label")),Q(ke.getAttribute("alt"));const it=ke.getAttribute("placeholder");le(it),ke.placeholder&&ke.placeholder!==it&&le(ke.placeholder);const Et=ke.getAttribute("aria-roledescription");if(Et&&(nt?Q(Et):le(Et)),ct(ke).forEach(Ee),We){const yr=ke.textContent;nt?Q(yr):le(yr)}},ne=(ke,{preferTextAsLabel:We=!1}={})=>{ke&&ke.split(/\s+/).map(nt=>nt.trim()).filter(Boolean).forEach(nt=>{const it=document.getElementById(nt);it&&pe(it,{includeTextContent:!0,preferTextAsLabel:We})})},Se=new Set,Le=[{element:j,preferTextAsLabel:!0,includeTextContent:!1}];for(;Le.length;){const{element:ke,preferTextAsLabel:We,includeTextContent:nt}=Le.shift();!ke||Se.has(ke)||(Se.add(ke),pe(ke,{includeTextContent:nt,preferTextAsLabel:We}),ne(ke.getAttribute("aria-labelledby"),{preferTextAsLabel:!0}),ne(ke.getAttribute("aria-describedby")),ne(ke.getAttribute("aria-details")),ne(ke.getAttribute("aria-errormessage")),ne(ke.getAttribute("aria-controls")),m(ke).forEach(it=>{pe(it,{includeTextContent:!0,preferTextAsLabel:!0})}),Te(ke).forEach(it=>{Le.push({element:it,preferTextAsLabel:!1,includeTextContent:!0})}))}if(D.length||Q(j.textContent),!F.length&&D.length>1&&D.slice(1).forEach(ke=>le(ke)),!F.length){const ke=ee(j);let We=!1;ke.forEach(nt=>{const it=Y(nt);it&&(We=!0,le(it))}),We||le(Y("hoverHelpFallbackGeneric"))}return{label:D[0]||"",details:F,shortcuts:z}},ve=()=>{H&&H.classList&&H.classList.remove("hover-help-highlight"),H=null},se=j=>{H!==j&&(ve(),j&&j.classList&&typeof j.classList.add=="function"&&(j.classList.add("hover-help-highlight"),H=j))},de=()=>Z&&U&&typeof te=="number"&&typeof re=="number"&&Number.isFinite(te)&&Number.isFinite(re),be=j=>{if(!j)return null;if(typeof j.clientX=="number"&&typeof j.clientY=="number"&&Number.isFinite(j.clientX)&&Number.isFinite(j.clientY))return[j.clientX,j.clientY];if(typeof j.pageX=="number"&&typeof j.pageY=="number"&&Number.isFinite(j.pageX)&&Number.isFinite(j.pageY)){const F=window.scrollX||window.pageXOffset||0,z=window.scrollY||window.pageYOffset||0;return[j.pageX-F,j.pageY-z]}return null},ye=j=>{if(!Z||!U)return!1;const O=be(j);if(!O)return!1;const[D,F]=O;return te=D,re=F,!0},$e=j=>{if(!U||!j)return;const O=j.getBoundingClientRect(),D=document.documentElement,F=Math.max(D?.clientWidth||0,window.innerWidth||0),z=Math.max(D?.clientHeight||0,window.innerHeight||0),J=window.scrollX||window.pageXOffset||0,Q=window.scrollY||window.pageYOffset||0,le=12,Ee=10,pe=8,ne=Number.isFinite(O.left)?O.left:0,Se=Number.isFinite(O.right)?O.right:ne+(O.width||0),Le=Number.isFinite(O.top)?O.top:0,ke=Number.isFinite(O.bottom)?O.bottom:Le,We=U.getBoundingClientRect(),nt=We.width||U.offsetWidth||0,it=We.height||U.offsetHeight||0,Et=de(),yr=Et&&typeof te=="number"?te:Number.isFinite(O.left)?ne+(O.width||0)/2:F/2,hr=(()=>{if(nt){const Vn=nt+le+pe,qn=F-yr,Lo=yr;if(qn<Vn&&Lo>=Vn)return!0}const Qe=F*.6;return yr>=Qe})();let Vr=Et?re+Q+Ee:ke+Q+Ee,Rr;if(Et?(Rr=te+J+le,hr&&(Rr=te+J-nt-le)):(Rr=(hr?Se:ne)+J+(hr?-le:le),hr&&(Rr-=nt)),nt){const Qe=J+F-pe;Rr+nt>Qe?Et?Rr=te+J-nt-le:Rr=Se+J-nt-le:Rr<J+pe&&hr&&(Rr=Math.max(Rr,J+pe));const qn=J+pe,Lo=J+Math.max(F-nt-pe,pe);Rr<qn?Rr=qn:Rr>Lo&&(Rr=Lo)}if(it){const Qe=Q+pe,Vn=Q+Math.max(z-it-pe,pe);if(Vr>Vn){const qn=Et?re+Q-it-Ee:Le+Q-it-Ee;qn>=Qe?Vr=qn:Vr=Math.min(Math.max(Vr,Qe),Vn)}else Vr<Qe&&(Vr=Qe)}U.style.top=`${Vr}px`,U.style.left=`${Rr}px`},xe=()=>{U&&(U.setAttribute("hidden",""),U.style.removeProperty("visibility"),te=null,re=null,ve())},St=j=>{const O=document.createDocumentFragment();if(!Array.isArray(j)||j.length===0)return O;const D=Q=>{if(!Q)return;const le=document.createElement("p");le.textContent=Q,O.appendChild(le)};let F=[];const z=()=>{if(!F.length)return;const Q=document.createElement("ul");F.forEach(le=>{const Ee=document.createElement("li");Ee.textContent=le,Q.appendChild(Ee)}),O.appendChild(Q),F=[]},J=Q=>{Q&&F.push(Q)};return j.forEach(Q=>{if(typeof Q!="string")return;Q.replace(/\r\n/g,`
`).replace(/\s*[]\s*/g,`
 `).split(/\n+/).map(pe=>pe.trim()).filter(Boolean).forEach(pe=>{const ne=pe.match(/^[\-]\s*(.+)$/);if(ne){J(ne[1].trim());return}z(),D(pe)}),z()}),z(),O.childElementCount||D(j.filter(Boolean).join(" ")),O},Tt=j=>{if(K=j||null,se(j||null),!Z||!U||!j){xe();return}const{label:O,details:D,shortcuts:F}=Ae(j),z=typeof O=="string"&&O.trim().length>0,J=Array.isArray(D)?D.filter(Boolean):[],Q=Array.isArray(F)?F.filter(Boolean):[];if(!z&&J.length===0&&Q.length===0){xe();return}if(J.length===0&&Q.length===0&&(!z||O.trim()==="")){xe();return}if(U.textContent="",z){const pe=document.createElement("div");pe.className="hover-help-heading",pe.textContent=O.trim(),U.appendChild(pe)}if(J.length){const pe=document.createElement("div");pe.className="hover-help-details",pe.appendChild(St(J)),U.appendChild(pe)}if(Q.length){const pe=document.createElement("div");pe.className="hover-help-shortcuts";const ne=Y("hoverHelpShortcutsHeading");if(ne){const Le=document.createElement("div");Le.className="hover-help-shortcuts-heading",Le.textContent=ne,pe.appendChild(Le)}const Se=document.createElement("ul");Se.className="hover-help-shortcuts-list",Q.forEach(Le=>{if(!Le)return;const ke=document.createElement("li");ke.className="hover-help-shortcut",ke.textContent=Le,Se.appendChild(ke)}),Se.childElementCount&&(pe.appendChild(Se),U.appendChild(pe))}const le=Y("hoverHelpExitHint");if(le){const pe=document.createElement("div");pe.className="hover-help-hint",pe.textContent=le,U.appendChild(pe)}const Ee=U.hasAttribute("hidden");Ee&&(U.style.visibility="hidden",U.removeAttribute("hidden")),$e(j),Ee&&U.style.removeProperty("visibility"),U.removeAttribute("hidden")},xt=j=>!Z||!j?!1:!!j.closest("[data-allow-hover-help], #settingsButton, #settingsDialog"),ut=()=>{Z=!1,K=null,U&&(tf(U),U=null),ve(),document.body.style.cursor="",document.body.classList.remove("hover-help-active")},Er=()=>{Z=!0,N(),document.body.style.cursor="help",document.body.classList.add("hover-help-active"),ve(),U=document.createElement("div"),U.id="hoverHelpTooltip",U.setAttribute("role","tooltip"),U.setAttribute("hidden",""),document.body.appendChild(U)},zt=()=>{Z&&U&&K&&$e(K)};document.addEventListener("mouseover",j=>{if(!Z||!U)return;ye(j);const O=Ie(j.target);Tt(O)}),document.addEventListener("focusin",j=>{if(!Z||!U)return;te=null,re=null;const O=Ie(j.target);Tt(O)}),document.addEventListener("focusout",j=>{!Z||!U||(!j.relatedTarget||!Ie(j.relatedTarget))&&(K=null,xe())}),window.addEventListener("scroll",zt,!0),window.addEventListener("resize",zt);const dr=j=>{ye(j)&&K&&$e(K)};typeof window<"u"&&"PointerEvent"in window?(window.addEventListener("pointermove",dr,!0),window.addEventListener("pointerdown",dr,!0)):(window.addEventListener("mousemove",dr,!0),window.addEventListener("mousedown",dr,!0)),document.addEventListener("mousedown",j=>{Z&&!xt(j.target)&&j.preventDefault()},!0),document.addEventListener("click",j=>{Z&&(xt(j.target)||(j.preventDefault(),ut()))}),hoverHelpButton&&hoverHelpButton.addEventListener("click",j=>{j.stopPropagation(),Er()});const Jt=()=>{if(!featureSearch)return;document.getElementById("sideMenu")?.contains(featureSearch)&&openSideMenu(),typeof featureSearch.scrollIntoView=="function"&&featureSearch.scrollIntoView({behavior:"smooth",block:"center"});try{featureSearch.focus({preventScroll:!0})}catch{featureSearch.focus()}typeof featureSearch.select=="function"&&featureSearch.select(),featureSearch.hasAttribute("data-skip-native-picker")||Yt(featureSearch)},rr=j=>typeof j!="string"||!j?"":j.toLowerCase().replace(/[^a-z0-9]/g,""),Jn=j=>typeof j!="string"||!j?new Set:new Set(j.toLowerCase().split(/[\s\-_]+/).filter(Boolean)),nr=(j,O,D)=>null,$n=(j,O)=>{featureSearch&&(featureSearch.value=j)},De=j=>typeof j!="string"?"":j.trim().toLowerCase(),vt=(j,O,D)=>{typeof console<"u"&&console.debug&&console.debug("Search usage:",j,O,D)};if(o=j=>{const O=typeof j=="string"?j:featureSearch?.value||"";De(O);const D=O.trim();if(!D)return;const z=typeof extractFeatureSearchFilter=="function"?extractFeatureSearchFilter(D):{filterType:null,queryText:D},J=z?.filterType||null,Q=J?z.queryText:D,le=typeof Q=="string"?Q.trim():"",pe=D.toLowerCase().endsWith(" (help)"),ne=pe?D.slice(0,-7).trim():le||(typeof Q=="string"?Q.trim():"");if(J==="help"&&!pe&&!ne){P(),ia&&(ia.value="",T(),ia.focus());return}const Se=ne||(J?"":D),Le=rr(Se);Jn(Se);const ke=nr(helpMap,Le),We=nr(deviceMap,Le),nt=nr(featureMap,Le),it=nr(actionMap,Le),Et=J==="feature"?nt:J==="action"?it:it?!nt||it.score>nt.score?it:nt.score>it.score?nt:it:nt,yr=ke?.score||0,hr=We?.score||0,Vr=typeof STRONG_SEARCH_MATCH_TYPES<"u"&&STRONG_SEARCH_MATCH_TYPES instanceof Set?STRONG_SEARCH_MATCH_TYPES:t2,Rr=We?Vr.has(We.matchType):!1,Qe=J==="device",Vn=J==="action",qn=J==="feature",Lo=qn||Vn,sn=(()=>{if(!Et)return null;const br=Et.value;if(!br)return null;const _t=br.entryType||"feature";return _t==="device"||Qe||qn&&_t!=="feature"||Vn&&_t!=="action"?null:{match:Et,entryType:_t,entry:br}})(),hn=Et&&Et.value&&Et.value.entryType!=="device"?Et:null,ln=sn?.match||hn,Zo=ln?.score||0,kn=ln?Vr.has(ln.matchType):!1,ea=Math.max(hr,Zo),yo=!!ke&&(pe||J==="help"||!(Rr||kn)&&yr>ea);if(!pe&&!yo){const br=ln?.matchType;if(!Lo&&!!We&&(!ln||Rr&&!kn||Rr===kn&&(hr>Zo||hr===Zo&&br!=="exactKey"))||Qe&&!!We){const kt=We.value;if(kt&&kt.select){if(kt.select.value=kt.value,kt.select.dispatchEvent(new Event("change",{bubbles:!0})),kt.label&&$n(kt.label),typeof vt=="function"){let In=kt.label;if(!In&&kt.select){const Do=Array.from(kt.select.options||[]).find(ho=>ho.value===kt.value);Do&&Do.textContent&&(In=Do.textContent.trim())}vt(We.key,"device",In)}S(kt.select);const Mr=[kt.select,...m(kt.select)];h(Mr);return}if(kt&&kt.entryType==="deviceLibrary"&&(kt.element||kt.rawElement)){const Mr=kt.label||Se;Mr&&$n(Mr),typeof vt=="function"&&vt(We.key,"device",Mr),typeof kt.focusLibraryEntry=="function"&&kt.focusLibraryEntry();const In=kt.element||kt.rawElement;if(In){S(In);const Do=[In,...m(In)];h(Do)}typeof kt.highlightLibraryEntry=="function"&&kt.highlightLibraryEntry();return}}if(sn){const kt=sn.entry,Mr=kt?.element||kt;if(Mr){const In=kt?.label||Mr.textContent?.trim();if(In&&$n(In),typeof vt=="function"){const ho=sn.entryType||"feature",is=sn.match?.key||Et?.key;vt(is,ho,In)}S(Mr);const Do=[Mr,...m(Mr)];h(Do);return}}}if(ke){const br=ke.value||{},_t=br.section;if(typeof vt=="function"&&vt(ke.key,"help",br.label),P(),ia&&(ia.value=Se,T()),_t){_t.hasAttribute("hidden")&&(_t.removeAttribute("hidden"),helpNoResults&&helpNoResults.setAttribute("hidden",""),typeof helpNoResultsSuggestions<"u"&&helpNoResultsSuggestions&&helpNoResultsSuggestions.setAttribute("hidden",""),I()),typeof _t.scrollIntoView=="function"&&_t.scrollIntoView({behavior:"smooth",block:"start"}),E(_t);const kt=_t.querySelector('h3, summary, h4, h5, h6, [role="heading"]')||_t.querySelector("button, a");h(kt?[kt]:[_t]);const Mr=_t.id?l.get(_t.id):null;t&&t.querySelectorAll(".help-quick-link.active").forEach(In=>In.classList.remove("active")),Mr&&Mr.button&&Mr.button.classList.add("active")}return}P(),ia&&(ia.value=Se,T(),h([ia]))},featureSearch){const j=document.getElementById("featureSearchDropdown"),O=ne=>{if(!ne||!j)return null;const Se=ne.closest("#featureSearchDropdown")||j,Le=Se&&Se.__optionEntries instanceof Map?Se.__optionEntries:null;if(!Le)return null;if(ne.id&&Le.has(ne.id))return Le.get(ne.id)||null;const ke=ne.getAttribute("data-entry-key");if(ke){for(const We of Le.values())if(We&&We.key===ke)return We}return null},D=(ne,Se)=>{if(!ne)return!1;const Le=ne.type||ne.entryType||"feature",ke=De(Se||""),We=ne.label||ne.display||ne.optionLabel||ke||"",nt=ne.key||null,it=()=>{typeof vt=="function"&&nt&&vt(nt,Le==="deviceLibrary"?"device":Le,We)};if(Le==="device"){if(ne.select){ne.select.value=ne.value,ne.select.dispatchEvent(new Event("change",{bubbles:!0})),We&&$n(We),it(),S(ne.select);const Et=[ne.select,...m(ne.select)];return h(Et),!0}if(ne.entryType==="deviceLibrary"&&(ne.element||ne.rawElement)){We&&$n(We),it(),typeof ne.focusLibraryEntry=="function"&&ne.focusLibraryEntry();const Et=ne.element||ne.rawElement;if(Et){S(Et);const yr=[Et,...m(Et)];h(yr)}return typeof ne.highlightLibraryEntry=="function"&&ne.highlightLibraryEntry(),!0}}if(Le==="feature"){const Et=ne.element||ne;if(Et){We&&$n(We),it(),S(Et);const yr=[Et,...m(Et)];return h(yr),!0}}if(Le==="help"){it(),P(),ia&&(ia.value=We||ke,T());const Et=ne.section;if(Et){Et.hasAttribute("hidden")&&(Et.removeAttribute("hidden"),helpNoResults&&helpNoResults.setAttribute("hidden",""),typeof helpNoResultsSuggestions<"u"&&helpNoResultsSuggestions&&helpNoResultsSuggestions.setAttribute("hidden",""),I()),typeof Et.scrollIntoView=="function"&&Et.scrollIntoView({behavior:"smooth",block:"start"}),E(Et);const yr=Et.querySelector('h3, summary, h4, h5, h6, [role="heading"]')||Et.querySelector("button, a");h(yr?[yr]:[Et]);const hr=Et.id?l.get(Et.id):null;return t&&t.querySelectorAll(".help-quick-link.active").forEach(Vr=>Vr.classList.remove("active")),hr&&hr.button&&hr.button.classList.add("active"),!0}}if(Le==="action")switch(it(),ne.action){case"create-new-project":return typeof ur<"u"&&ur&&(ur.value="",ur.dispatchEvent(new Event("change",{bubbles:!0})),typeof Qi=="function"&&Qi()),!0;case"save-project":return typeof saveSetupBtn<"u"&&saveSetupBtn&&saveSetupBtn.click(),!0;case"export-project":return typeof shareSetupBtn<"u"&&shareSetupBtn&&shareSetupBtn.click(),!0;case"toggle-dark-mode":return typeof rc<"u"&&rc&&rc.click(),!0;case"toggle-pink-mode":return typeof tc<"u"&&tc&&tc.click(),!0;case"open-settings":return typeof settingsButton<"u"&&settingsButton&&settingsButton.click(),!0;case"open-help":return typeof helpButton<"u"&&helpButton&&helpButton.click(),!0;case"force-reload":return typeof reloadButton<"u"&&reloadButton&&reloadButton.click(),!0}return!1},F=()=>j?Array.from(j.querySelectorAll('[role="option"]')||[]):[],z=()=>{F().forEach(Se=>{Se.setAttribute("tabindex","-1"),Se.setAttribute("aria-selected","false")}),featureSearch&&featureSearch.hasAttribute("aria-activedescendant")&&featureSearch.removeAttribute("aria-activedescendant")},J=(ne,{focusOption:Se=!1}={})=>{const Le=F();if(!Le.length)return featureSearch&&featureSearch.hasAttribute("aria-activedescendant")&&featureSearch.removeAttribute("aria-activedescendant"),null;const ke=Math.max(0,Math.min(ne,Le.length-1));return Le.forEach((We,nt)=>{const it=nt===ke;We.setAttribute("tabindex",it?"0":"-1"),We.setAttribute("aria-selected",it?"true":"false"),it&&(featureSearch&&(We.id?featureSearch.setAttribute("aria-activedescendant",We.id):featureSearch.hasAttribute("aria-activedescendant")&&featureSearch.removeAttribute("aria-activedescendant")),Se&&We.focus())}),j&&(j.dataset.activeIndex=String(ke)),Le[ke]},Q=()=>{if(!j)return;z(),j.dataset.open="false",j.hidden=!0,j.setAttribute("aria-expanded","false"),j.dataset.activeIndex="",featureSearch&&featureSearch.setAttribute("aria-expanded","false");const ne=j.closest(".feature-search");ne&&ne.classList.remove("feature-search-open")},le=()=>{if(!j)return;if(j.dataset.count==="0"){Q();return}j.dataset.open="true",j.hidden=!1,j.setAttribute("aria-expanded","true"),featureSearch&&featureSearch.setAttribute("aria-expanded","true");const ne=j.closest(".feature-search");if(ne&&ne.classList.add("feature-search-open"),!F().length){featureSearch&&featureSearch.hasAttribute("aria-activedescendant")&&featureSearch.removeAttribute("aria-activedescendant");return}const Le=j.dataset.activeIndex,ke=typeof Le=="string"&&Le!==""?Number(Le):NaN,We=document.activeElement&&document.activeElement!==featureSearch;Number.isNaN(ke)?J(0,{focusOption:We}):J(ke,{focusOption:We})},Ee=(ne,Se)=>{if(!featureSearch||!ne)return;const Le=Se?O(Se):null;featureSearch.value=ne;try{featureSearch.focus({preventScroll:!0})}catch{featureSearch.focus()}if(featureSearch.setSelectionRange?.(ne.length,ne.length),Le&&D(Le,ne)){updateFeatureSearchSuggestions(ne),Q();return}updateFeatureSearchSuggestions(ne),o(ne),Q()},pe=()=>{Q(),o(featureSearch.value)};featureSearch.addEventListener("change",pe),featureSearch.addEventListener("focus",()=>{le()}),featureSearch.addEventListener("blur",()=>{window.setTimeout(()=>{!j||j.contains(document.activeElement)||Q()},100)}),featureSearch.addEventListener("input",()=>{updateFeatureSearchSuggestions(featureSearch.value),le()}),featureSearch.addEventListener("keydown",ne=>{if(ne.key==="Enter")pe();else if(ne.key==="Escape")featureSearch.value&&(featureSearch.value="",restoreFeatureSearchDefaults()),Q(),ne.preventDefault();else if(ne.key==="ArrowDown"){if(!j||j.dataset.count==="0")return;ne.preventDefault(),le();const Se=F(),Le=j.dataset.activeIndex,ke=Le?Number(Le)+1:0;J(ke>=Se.length?0:ke,{focusOption:!1})}else if(ne.key==="ArrowUp"){if(!j||j.dataset.count==="0")return;ne.preventDefault(),le();const Se=F();if(!Se.length)return;const Le=j.dataset.activeIndex;if(!Le)J(Se.length-1,{focusOption:!1});else{const ke=Number(Le)-1;J(ke>=0?ke:Se.length-1,{focusOption:!1})}}}),j&&(j.addEventListener("mousedown",ne=>{ne.target.closest("[data-value]")&&ne.preventDefault()}),j.addEventListener("click",ne=>{const Se=ne.target.closest("[data-value]");if(!Se)return;const Le=Se.getAttribute("data-value")||"";Le&&Ee(Le,Se)}),j.addEventListener("keydown",ne=>{const Se=F();if(!Se.length)return;const Le=document.activeElement,ke=Se.indexOf(Le);if(ne.key==="ArrowDown"){ne.preventDefault();const We=ke>=0?ke+1:0;J(We>=Se.length?0:We,{focusOption:!0})}else if(ne.key==="ArrowUp"){ne.preventDefault();const We=ke>0?ke-1:Se.length-1;J(We,{focusOption:!0})}else if(ne.key==="Home")ne.preventDefault(),J(0,{focusOption:!0});else if(ne.key==="End")ne.preventDefault(),J(Se.length-1,{focusOption:!0});else if(ne.key==="Enter"){if(ne.preventDefault(),ke>=0&&Se[ke]){const We=Se[ke].getAttribute("data-value")||"";We&&Ee(We,Se[ke])}}else ne.key==="Escape"?(ne.preventDefault(),Q(),Jt()):ne.key==="Tab"&&Q()}),j.addEventListener("focusout",()=>{window.setTimeout(()=>{document.activeElement===featureSearch||j&&j.contains(document.activeElement)||Q()},100)}))}function Yt(j){if(!(!j||typeof j.showPicker!="function"))try{j.showPicker()}catch(O){if(O&&O.name==="NotAllowedError")return;console.warn("Unable to show picker",O)}}return document.addEventListener("keydown",j=>{const O=document.activeElement.tagName,D=O==="INPUT"||O==="TEXTAREA",F=typeof j.key=="string"?j.key:"",z=F.toLowerCase();Z&&j.key==="Escape"?ut():j.key==="Escape"&&isDialogOpen(Ca)?(j.preventDefault(),N()):j.key==="Escape"&&Vl&&isDialogOpen(Vl)?(j.preventDefault(),Db(),_c(),Nb(),kc(),Fb(),al(),mP(),closeDialog(Vl),Vl.setAttribute("hidden","")):j.key==="F1"||(j.key==="/"||j.key==="?")&&(j.ctrlKey||j.metaKey)?(j.preventDefault(),q()):j.key==="/"&&!D&&(!Ca||typeof isDialogOpen=="function"&&!isDialogOpen(Ca))?(j.preventDefault(),Jt()):j.key==="?"&&!D||z==="h"&&!D?(j.preventDefault(),q()):typeof isDialogOpen=="function"&&isDialogOpen(Ca)&&(j.key==="/"&&!D||z==="f"&&(j.ctrlKey||j.metaKey))?(j.preventDefault(),ia&&ia.focus()):F===","&&(j.ctrlKey||j.metaKey)?(j.preventDefault(),U0({reason:"keyboard-shortcut",key:F,ctrl:!!j.ctrlKey,meta:!!j.metaKey,shift:!!j.shiftKey})):z==="k"&&(j.ctrlKey||j.metaKey)?(j.preventDefault(),Jt()):z==="d"&&!D?yS(!$w()):z==="s"&&(j.ctrlKey||j.metaKey)?(j.preventDefault(),saveSetupBtn&&!saveSetupBtn.disabled&&saveSetupBtn.click()):z==="p"&&!D&&Dw(!document.body.classList.contains("pink-mode"))}),i.addEventListener("click",j=>{j.target===i&&N()}),i.addEventListener("cancel",j=>{j.preventDefault(),N()}),!0};eU()||document.addEventListener("DOMContentLoaded",eU);const UM={Indoor:iconGlyph("",ICON_FONT_KEYS.ESSENTIAL),Outdoor:iconGlyph("",ICON_FONT_KEYS.ESSENTIAL),Studio:iconGlyph("",ICON_FONT_KEYS.FILM),Tripod:iconGlyph("",ICON_FONT_KEYS.FILM),Handheld:iconGlyph("",ICON_FONT_KEYS.UICONS),Easyrig:iconGlyph("",ICON_FONT_KEYS.UICONS),"Cine Saddle":iconGlyph("",ICON_FONT_KEYS.UICONS),Steadybag:iconGlyph("",ICON_FONT_KEYS.UICONS),Dolly:iconGlyph("",ICON_FONT_KEYS.FILM),Slider:iconGlyph("",ICON_FONT_KEYS.UICONS),Steadicam:iconGlyph("",ICON_FONT_KEYS.UICONS),Gimbal:iconGlyph("",ICON_FONT_KEYS.UICONS),Trinity:iconGlyph("",ICON_FONT_KEYS.UICONS),Rollcage:iconGlyph("",ICON_FONT_KEYS.UICONS),"Car Mount":iconGlyph("",ICON_FONT_KEYS.UICONS),Jib:iconGlyph("",ICON_FONT_KEYS.UICONS),"Undersling mode":iconGlyph("",ICON_FONT_KEYS.UICONS),Crane:iconGlyph("",ICON_FONT_KEYS.UICONS),"Remote Head":ICON_GLYPHS.controller,"Extreme cold (snow)":iconGlyph("",ICON_FONT_KEYS.UICONS),"Extreme rain":iconGlyph("",ICON_FONT_KEYS.UICONS),"Extreme heat":iconGlyph("",ICON_FONT_KEYS.UICONS),"Rain Machine":iconGlyph("",ICON_FONT_KEYS.UICONS),"Slow Motion":iconGlyph("",ICON_FONT_KEYS.UICONS),"Battery Belt":ICON_GLYPHS.batteryBolt};function Vle(e){if(typeof e!="function")return;const t=pc();for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n!="object"))try{n.getRequiredScenarioOptionEntries=e}catch{try{Object.defineProperty(n,"getRequiredScenarioOptionEntries",{configurable:!0,writable:!0,value:e})}catch{}}}}function qle(){const e=new Map;return requiredScenariosSelect&&requiredScenariosSelect.options&&Array.from(requiredScenariosSelect.options).forEach(t=>{if(!t||t.disabled)return;const r=typeof t.value=="string"?t.value.trim():"";if(!r)return;const n=typeof t.textContent=="string"&&t.textContent.trim()?t.textContent.trim():r;e.has(r)||e.set(r,n)}),Object.keys(UM).forEach(t=>{if(typeof t!="string")return;const r=t.trim();!r||e.has(r)||e.set(r,r)}),Array.from(e.entries()).map(([t,r])=>({value:t,label:r})).sort((t,r)=>t.label.localeCompare(r.label,void 0,{sensitivity:"base"}))}Vle(qle);function xE(){if(!requiredScenariosSelect||!requiredScenariosSummary)return;requiredScenariosSummary.innerHTML="";let e=Array.from(requiredScenariosSelect.selectedOptions).map(r=>r.value);const t=e.includes("Dolly");if(remoteHeadOption&&(t?remoteHeadOption.hidden=!1:(remoteHeadOption.hidden=!0,remoteHeadOption.selected=!1,e=e.filter(r=>r!=="Remote Head"))),t&&Wa&&(!Wa.value||Wa.value==="None")){const r="SmallHD Ultra 7";if((typeof window<"u"&&window.devices||{})?.monitors?.[r]){if(!Array.from(Wa.options).some(o=>o.value===r)){const o=document.createElement("option");o.value=r,o.textContent=r,Wa.appendChild(o)}Wa.value=r,Wa.dispatchEvent(new Event("change"))}}if(zx){const r=n=>{let o=Array.from(zx.options).find(a=>a.value===n);o||(o=document.createElement("option"),o.value=n,o.textContent=n,zx.appendChild(o))};r('DoP Monitor 7" handheld'),r('DoP Monitor 15-21"')}e.forEach(r=>{const n=document.createElement("span");n.className="scenario-box";const o=document.createElement("span");o.className="scenario-icon icon-glyph",applyIconGlyph(o,UM[r]||ICON_GLYPHS.pin),n.appendChild(o),n.appendChild(document.createTextNode(r)),requiredScenariosSummary.appendChild(n)}),tripodPreferencesRow&&(e.includes("Tripod")?(tripodPreferencesRow.classList.remove("hidden"),tripodPreferencesHeading&&tripodPreferencesHeading.classList.remove("hidden"),tripodPreferencesSection&&tripodPreferencesSection.classList.remove("hidden")):(tripodPreferencesRow.classList.add("hidden"),tripodPreferencesHeading&&tripodPreferencesHeading.classList.add("hidden"),tripodPreferencesSection&&tripodPreferencesSection.classList.add("hidden"),tripodHeadBrandSelect&&(tripodHeadBrandSelect.value=""),tripodBowlSelect&&(tripodBowlSelect.value=""),tripodTypesSelect&&Array.from(tripodTypesSelect.options).forEach(r=>{r.selected=!1}),tripodSpreaderSelect&&(tripodSpreaderSelect.value=""),updateTripodOptions()))}function Kle(){console.log("DEBUG: initApp ENTERED");try{hP()}catch(t){typeof console<"u"&&typeof console.error=="function"&&console.error("Critical storage backup guard failed during initialization",t)}const e=_g();sharedLinkRow&&sharedLinkRow.classList.remove("hidden"),bg(currentLang),Yle(),zM(),oY(),e&&(e.addEventListener("change",Xw),e.addEventListener("change",()=>{Ji(),saveCurrentGearList(),Qi()}),Xw()),sd(),rU(()=>{document.querySelectorAll("#projectForm select").forEach(t=>{typeof attachSelectSearch=="function"&&attachSelectSearch(t),Fn("initFavoritableSelect",[t],{defer:!0})})}),rU(()=>{if(typeof globalThis<"u"&&typeof globalThis.setupInstallBanner=="function")try{globalThis.setupInstallBanner()}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to set up install banner",t)}if(typeof maybeShowIosPwaHelp=="function")try{maybeShowIosPwaHelp()}catch(t){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Failed to display iOS PWA help prompt",t)}}),typeof resetDeviceForm=="function"&&resetDeviceForm(),typeof ensureDefaultProjectInfoSnapshot=="function"?ensureDefaultProjectInfoSnapshot():typeof window<"u"&&typeof window.ensureDefaultProjectInfoSnapshot=="function"&&window.ensureDefaultProjectInfoSnapshot(),T2(),AM(),typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"?(Gr.whenElementAvailable("requiredScenarios",t=>{if(typeof requiredScenariosSelect>"u"||!requiredScenariosSelect)try{typeof window<"u"&&(window.requiredScenariosSelect=t)}catch{}t.addEventListener("change",xE),xE()}),Gr.whenElementAvailable("tripodHeadBrand",t=>{if(typeof tripodHeadBrandSelect>"u"||!tripodHeadBrandSelect)try{typeof window<"u"&&(window.tripodHeadBrandSelect=t)}catch{}t.addEventListener("change",updateTripodOptions)}),Gr.whenElementAvailable("tripodBowl",t=>{if(typeof tripodBowlSelect>"u"||!tripodBowlSelect)try{typeof window<"u"&&(window.tripodBowlSelect=t)}catch{}t.addEventListener("change",updateTripodOptions)}),Gr.whenElementAvailable("tripodTypes",t=>{if(typeof tripodTypesSelect>"u"||!tripodTypesSelect)try{typeof window<"u"&&(window.tripodTypesSelect=t)}catch{}t.addEventListener("change",updateTripodOptions)}),Gr.whenElementAvailable("tripodSpreader",t=>{if(typeof tripodSpreaderSelect>"u"||!tripodSpreaderSelect)try{typeof window<"u"&&(window.tripodSpreaderSelect=t)}catch{}t.addEventListener("change",updateTripodOptions)})):(requiredScenariosSelect&&(requiredScenariosSelect.addEventListener("change",xE),xE()),tripodHeadBrandSelect&&tripodHeadBrandSelect.addEventListener("change",updateTripodOptions),tripodBowlSelect&&tripodBowlSelect.addEventListener("change",updateTripodOptions)),typeof updateTripodOptions=="function"&&updateTripodOptions(),typeof updateViewfinderExtensionVisibility=="function"&&updateViewfinderExtensionVisibility(),typeof $d=="function"&&$d(),typeof applyFilters=="function"&&applyFilters()}function GP(e){if(!e)return;if(typeof ensureFeedbackTemperatureOptions=="function"){ensureFeedbackTemperatureOptions(e);return}const t=typeof FEEDBACK_TEMPERATURE_MIN=="number"?FEEDBACK_TEMPERATURE_MIN:-20,r=typeof FEEDBACK_TEMPERATURE_MAX_LIMIT=="number"?FEEDBACK_TEMPERATURE_MAX_LIMIT:50,n=r-t+2;if(e.options.length===n)return;const o=e.value;e.innerHTML="";const a=document.createElement("option");a.value="",a.textContent="",e.appendChild(a);for(let i=t;i<=r;i+=1){const s=document.createElement("option");s.value=String(i),s.textContent=String(i),e.appendChild(s)}o&&Array.from(e.options).find(s=>s.value===o)&&(e.value=o)}function tU(){if(typeof updateFeedbackTemperatureOptions=="function"){updateFeedbackTemperatureOptions();return}const e=document.getElementById("fbTemperature");e&&(GP(e),Array.from(e.options).forEach(t=>{if(t){if(t.value===""){t.textContent="";return}t.textContent=`${t.value}C`}}))}const Wle=120;function rU(e,t={}){if(typeof e!="function")return;const r=typeof t.timeout=="number"&&t.timeout>=0?t.timeout:Wle,n=a=>{try{e(a)}catch(i){typeof console<"u"&&typeof console.error=="function"&&console.error("Deferred task failed during post-render scheduling",i)}},o=()=>{if(typeof requestIdleCallback=="function"){requestIdleCallback(n,{timeout:r});return}setTimeout(n,r)};typeof requestAnimationFrame=="function"?requestAnimationFrame(o):o()}function Yle(){const e=r=>{r&&(typeof GP=="function"&&GP(r),typeof tU=="function"&&tU())},t=document.getElementById("fbTemperature");t?e(t):typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable("fbTemperature",e)}function zM(){const t=typeof lensSelect<"u"&&lensSelect?lensSelect:typeof document<"u"?document.getElementById("lenses"):null;if(!t){typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable("lenses",y=>{(typeof lensSelect>"u"||!lensSelect)&&typeof window<"u"&&(window.lensSelect=y),zM()});return}const r=t,n=y=>{if(typeof y!="string")return"";const E=y.trim().toLowerCase();return E==="imperial"||E==="metric"?E:""},a=(()=>{const y=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null,v=(y&&typeof y.focusScalePreference=="string"?y.focusScalePreference:null)||(typeof ws<"u"&&ws?ws:typeof focusScalePreference=="string"?focusScalePreference:null)||"metric";if(typeof normalizeFocusScale=="function")try{const R=normalizeFocusScale(v);if(R==="imperial"||R==="metric")return R}catch{}return n(v)||"metric"})(),i=y=>{if(!y||typeof y!="object")return a;if(typeof normalizeFocusScale=="function")try{const L=normalizeFocusScale(y.focusScale);if(L==="imperial"||L==="metric")return L}catch{}return n(y.focusScale)||a},{lang:s}=gS(),l=(y,E={})=>{const L=typeof y=="string"?Number(y):y;if(!Number.isFinite(L))return"";const v=typeof E.maximumFractionDigits=="number"?E.maximumFractionDigits:0,A=typeof E.minimumFractionDigits=="number"?E.minimumFractionDigits:Math.min(0,v);if(typeof Intl<"u"&&typeof Intl.NumberFormat=="function")try{return new Intl.NumberFormat(s,{maximumFractionDigits:v,minimumFractionDigits:A}).format(L)}catch{}const R=Math.max(A,Math.min(20,v));try{return L.toFixed(R)}catch{}return String(L)},c=(y,E=a)=>{const L=typeof y=="string"?Number(y):y;if(!Number.isFinite(L))return"";if(E==="imperial"){const R=L/453.59237,I=R>=10?1:2,C=l(R,{maximumFractionDigits:I,minimumFractionDigits:0});return C?`${C} lb`:""}const A=l(L,{maximumFractionDigits:0,minimumFractionDigits:0});return A?`${A} g`:""},u=(y,E=a)=>{const L=typeof y=="string"?Number(y):y;if(!Number.isFinite(L))return"";if(E==="imperial"){const R=L/25.4,I=R>=10?1:2,C=l(R,{maximumFractionDigits:I,minimumFractionDigits:0});return C?`${C} in`:""}const A=l(L,{maximumFractionDigits:1,minimumFractionDigits:0});return A?`${A} mm`:""},f=(y,E=a)=>{const L=typeof y=="string"?Number(y):y;if(!Number.isFinite(L))return"";if(E==="imperial"){const I=L*3.280839895,C=I<10?2:1,k=l(I,{maximumFractionDigits:C,minimumFractionDigits:C});return k?`${k} ft`:""}const A=L<1?2:1,R=l(L,{maximumFractionDigits:A,minimumFractionDigits:A});return R?`${R} m`:""},d=typeof window<"u"&&window.devices||{},p=(d&&d.lenses&&Object.keys(d.lenses).length?d.lenses:null)||d&&d.accessories&&d.accessories.lenses||null;if(!p||Object.keys(p).length===0)return;const h=new Set(Array.from(r.selectedOptions||[]).map(y=>y.value)),m=document.createDocumentFragment();if(!r.multiple){const y=document.createElement("option");y.value="",m.appendChild(y)}const g=Object.keys(p),S=typeof localeSort=="function"?localeSort:void 0;g.sort(S);for(let y=0;y<g.length;y+=1){const E=g[y],L=document.createElement("option");L.value=E;const v=p[E]||{},A=i(v),R=[],I=c(v.weight_g,A);if(I&&R.push(I),v.clampOn)if(v.frontDiameterMm){const k=u(v.frontDiameterMm,A);R.push(k?`${k} clamp-on`:"clamp-on")}else R.push("clamp-on");else v.clampOn===!1&&R.push("no clamp-on");const C=v.minFocusMeters??v.minFocus??(v.minFocusCm?v.minFocusCm/100:null);if(Number.isFinite(C)&&C>0){const k=f(C,A);k&&R.push(`${k} min focus`)}L.textContent=R.length?`${E} (${R.join(", ")})`:E,h.has(E)&&(L.selected=!0),m.appendChild(L)}if(r.innerHTML="",r.appendChild(m),typeof updateLensWorkflowCatalog=="function")try{updateLensWorkflowCatalog({preserveSelections:!0,skipEvent:!0,skipDirty:!0})}catch{}}function bS(e,t,r=""){const n=a=>{a.innerHTML="";const i=document.createElement("option");i.value="",a.appendChild(i);const s=typeof Ri<"u"&&Ri?Ri.value:"",l=typeof window<"u"&&window.devices||{},c=s&&l&&l.cameras&&l.cameras[s]?l.cameras[s][t]:null;Array.isArray(c)&&c.forEach(u=>{const f=document.createElement("option");f.value=u,f.textContent=u,u===r&&(f.selected=!0),a.appendChild(f)})},o=document.getElementById(e);o?n(o):typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable(e,n)}function nU(e=""){bS("recordingResolution","resolutions",e)}const rY=typeof document<"u"?document.getElementById("recordingFrameRate"):null,Qle=typeof document<"u"?document.getElementById("recordingFrameRateHint"):null,Xle=typeof document<"u"?document.getElementById("recordingFrameRateOptions"):null;Mh=typeof document<"u"?document.getElementById("slowMotionRecordingFrameRate"):null;a2=typeof document<"u"?document.getElementById("slowMotionRecordingFrameRateHint"):null;i2=typeof document<"u"?document.getElementById("slowMotionRecordingFrameRateOptions"):null;Rw=typeof document<"u"?document.getElementById("sensorMode"):null;Tw=typeof document<"u"?document.getElementById("slowMotionSensorMode"):null;Sg=typeof document<"u"?document.getElementById("recordingResolution"):null;Ow=typeof document<"u"?document.getElementById("slowMotionRecordingResolution"):null;xw=typeof document<"u"?document.getElementById("slowMotionAspectRatio"):null;const Jle=Object.freeze([.75,1,8,12,12.5,15,23.976,24,25,29.97,30,47.952,48,50,59.94,60,72,75,90,96,100,110,112,120,144,150,160,170,180,200,240]),Zle=Object.freeze(["0.75","1","8","12","12.5","15","23.976","24","25","29.97","30","48","50","59.94","60","72","75","90","96","100","110","112","120","144","150","160","170","180","200","240"]),kE=1,Ly=5e-4;function Ki(e){const t=typeof e=="number"?e:Number.parseFloat(e);if(!Number.isFinite(t))return"";const r=Math.round(t*1e3)/1e3;return Number.isInteger(r)?String(r):r.toFixed(3).replace(/\.0+$/,"").replace(/(\.\d*?)0+$/,"$1")}function Cg(e){if(typeof e!="string"||!e)return[];const t=e.toLowerCase(),r=t.replace(/[\u2013\u2014]/g,"-").replace(/[()]/g," ").replace(/[[\]]/g," ").split(/[\s,/]+/).map(c=>c.replace(/[^a-z0-9:.+-]/g,"").replace(/^[:.+-]+|[:.+-]+$/g,"")).filter(c=>c&&c!=="fps"),n=new Set(r),o=c=>{if(!c)return;const u=c.replace(/[^a-z0-9]/g,"");u&&n.add(u)},a=t.replace(/\u00d7/g,"x"),i=a.replace(/\s+/g,""),s=c=>a.includes(c),l=c=>i.includes(c);return(s("uhd")||s("ultra hd")||l("ultrahd")||/3840\s*x\s*2160/.test(a))&&(o("uhd"),o("4k")),(s("dci")||/4096\s*x\s*2160/.test(a))&&(o("dci"),o("4k")),(l("2048x1080")||/2048\s*x\s*1080/.test(a)||/(?:^|[^a-z0-9])2k(?:[^a-z0-9]|$)/.test(a))&&(o("2k"),o("dci")),(l("fullhd")||s("full hd")||s("full-hd")||s("fhd")||s("1080p")||/1920\s*x\s*1080/.test(a))&&(o("hd"),o("fhd"),o("1080p")),(s("720p")||/1280\s*x\s*720/.test(a))&&(o("hd"),o("720p")),/(?:^|[^a-z0-9])6k(?:[^a-z0-9]|$)/.test(a)&&o("6k"),/(?:^|[^a-z0-9])8k(?:[^a-z0-9]|$)/.test(a)&&o("8k"),(/(?:^|[^a-z0-9])4k(?:[^a-z0-9]|$)/.test(a)||s("4k"))&&o("4k"),Array.from(n)}function IE(e){return typeof e!="string"||!e?"":e.toLowerCase().replace(/[^a-z0-9]/g,"")}function oU(e,t,r){if(!Number.isFinite(e)||!Number.isFinite(t)||!r)return;const n=Math.min(e,t),o=Math.max(e,t);Jle.forEach(a=>{if(a>=n-5e-4&&a<=o+5e-4){const i=Ki(a);i&&r.add(i)}})}function nY(e){if(typeof e!="string"||!e.trim())return[];const t=e.replace(/[\u2013\u2014]/g,"-"),r=t.split(":"),n=r.length>1?r.slice(1).join(":"):t,o=new Set,a=/(\d+(?:\.\d+)?)(?:\s*(?:-|to)\s*)(\d+(?:\.\d+)?)(?=\s*(?:fps|FPS))/g;let i=a.exec(n);for(;i;){const c=i[1],u=i[2],f=Number.parseFloat(c),d=Number.parseFloat(u),p=Ki(f),h=Ki(d);p&&o.add(p),h&&o.add(h),oU(f,d,o),i=a.exec(n)}const s=/(?:up to||<=|less than|max(?:imum)?(?:\s*of)?)\s*(\d+(?:\.\d+)?)(?=\s*(?:fps|FPS))/gi;for(;i=s.exec(n);){const c=Ki(i[1]);c&&(o.add(c),oU(0,Number.parseFloat(i[1]),o))}const l=/(\d+(?:\.\d+)?)(?=\s*(?:fps|FPS))/g;for(;i=l.exec(n);){const c=Ki(i[1]);c&&o.add(c)}if(!o.size){const c=n.split("fps")[0]||n,u=/(\d+(?:\.\d+)?)/g;for(;i=u.exec(c);){const f=Ki(i[1]);f&&o.add(f)}}return Array.from(o)}function ece(e){if(typeof e=="number"&&Number.isFinite(e))return Ki(e);if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.match(/-?\d+(?:\.\d+)?/);return r&&Ki(r[0])||t}function tce(e,t){const r=new Map,n=t.filter(a=>Array.isArray(a)&&a.length);if(e.forEach(a=>{if(typeof a!="string")return;const i=a.trim();if(!i)return;const[s]=i.split(":"),l=Cg(s),c=nY(i);let f=l.length?1:0;if(n.length&&l.length){const d=new Set(l);n.forEach(p=>{let h=0;p.forEach(m=>{d.has(m)&&(h+=1)}),h&&(f+=h*3,h===p.length&&(f+=2))})}c.forEach(d=>{const p=Ki(d);if(!p)return;const h=r.get(p);(!h||f>h.score)&&r.set(p,{score:f,label:i,tokens:l})})}),!r.size)return{values:Array.from(Zle),metadata:new Map};const o=Array.from(r.entries()).sort((a,i)=>{if(i[1].score!==a[1].score)return i[1].score-a[1].score;const s=Number.parseFloat(a[0]),l=Number.parseFloat(i[0]);return Number.isFinite(s)&&Number.isFinite(l)?s-l:a[0].localeCompare(i[0])});return{values:o.map(([a])=>a),metadata:new Map(o)}}function aU(e,t,r=""){if(!Array.isArray(e)||!e.length||!Array.isArray(t)||!t.length)return null;const n=new Set(t);if(!n.size)return null;const o=IE(r),a=new Set(t.map(IE).filter(Boolean));let i=0,s=Number.NEGATIVE_INFINITY;return e.forEach(l=>{if(typeof l!="string")return;const c=l.trim();if(!c)return;const[u]=c.split(":"),f=Cg(u),d=nY(c).map(S=>Number.parseFloat(S)).filter(Number.isFinite);if(!d.length)return;let p=0;const h=IE(u),m=f.map(IE).filter(Boolean);if(f.forEach(S=>{n.has(S)&&(p+=4)}),m.forEach(S=>{if(a.has(S)){p+=2;return}for(const y of a)if(y&&S.includes(y)){p+=1;break}}),o&&h&&h.includes(o)&&(p+=Math.max(n.size*4,8)),!p)return;const g=Math.max(...d);(p>i||p===i&&g>s)&&(i=p,s=g)}),!i||!Number.isFinite(s)?null:s}function Fh(e){if(!e)return"";const t=e.value;return typeof t=="string"?t.trim():""}function iU(){return Fh(rY)}function rce(e){if(!e)return[];if(e.multiple)return Array.from(e.selectedOptions||[]).map(r=>Cg(r&&r.value)).reduce((r,n)=>n&&n.length?r.concat(n):r,[]);const t=typeof e.value=="string"?e.value:"";return Cg(t)}function $M(e={}){const{selected:t="",recordingInput:r,optionsList:n,sensorSelect:o,resolutionSelect:a,aspectSelect:i,hintElement:s}=e;if(!r||!n)return;let c=ece(t)||Fh(r);const u=Ri&&Ri.value,f=typeof window<"u"&&window.devices||{},d=u&&f&&f.cameras&&f.cameras[u]?f.cameras[u].frameRates:null,p=o&&typeof o.value=="string"?o.value:"",h=Cg(p),m=a&&typeof a.value=="string"?a.value:"",g=Cg(m),S=rce(i),y=aU(Array.isArray(d)?d:[],h,p),E=aU(Array.isArray(d)?d:[],g,Sg&&Sg.value),{values:L}=tce(Array.isArray(d)?d:[],[h,g,S]);n.innerHTML="";const v=new Set,A=[],R=[],I=[];Number.isFinite(y)&&I.push(y),Number.isFinite(E)&&I.push(E);const C=I.length?Math.min(...I):null;if(L.forEach(q=>{if(!q)return;let Z=q;const U=Number.parseFloat(Z);if(Number.isFinite(U)){if(U+Ly<kE||C!==null&&U>C+Ly)return;const H=Ki(U);H&&(Z=H),R.push({numeric:U,formatted:Z})}if(v.has(Z))return;v.add(Z),A.push(Z);const K=document.createElement("option");K.value=Z,n.appendChild(K)}),c&&!v.has(c)){const q=Number.parseFloat(c);if(!Number.isFinite(q)||q+Ly>=kE){const Z=document.createElement("option");Z.value=c,n.appendChild(Z)}}const k=R.reduce((q,Z)=>Z.numeric>q.numeric?Z:q,{numeric:Number.NEGATIVE_INFINITY,formatted:""});let _=k.numeric;Number.isFinite(C)&&(_=Number.isFinite(_)?Math.min(_,C):C);const w=Number.isFinite(_)?k.formatted||Ki(_):"",x=Ki(kE),G=Number.parseFloat(c);let T=c,P=!1;if(Number.isFinite(_)&&Number.isFinite(G)&&G>_+Ly){const q=w||Ki(_);q&&(T=q,T!==c&&(P=!0))}x&&Number.isFinite(G)&&G+Ly<kE&&(T=x,T!==c&&(P=!0)),P?(r.value=T,c=T,r.dispatchEvent(new Event("input",{bubbles:!0}))):r.value=c;const N=A[0];if(!c&&N?r.placeholder=N:r.placeholder&&(r.placeholder=""),x&&(r.min=x),w?r.setAttribute("max",w):r.removeAttribute("max"),s){let q="";if(w){const Z=s.getAttribute("data-range-template");q=Z?Z.replace("{max}",w):`Enter a recording frame rate from ${x} to ${w} fps.`}else q=s.getAttribute("data-default-message")||"";s.textContent=q,s.hidden=!q}}function MP(e=""){const t=(n,o)=>n||(typeof document<"u"?document.getElementById(o):null),r=t(rY,"recordingFrameRate");if(!r&&typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"){Gr.whenElementAvailable("recordingFrameRate",()=>MP(e));return}$M({selected:e,recordingInput:r,optionsList:t(Xle,"recordingFrameRateOptions"),sensorSelect:t(Rw,"sensorMode"),resolutionSelect:t(Sg,"recordingResolution"),hintElement:t(Qle,"recordingFrameRateHint")})}function Qw(e=""){const t=(n,o)=>n||(typeof document<"u"?document.getElementById(o):null),r=t(Mh,"slowMotionRecordingFrameRate");if(!r&&typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"){Gr.whenElementAvailable("slowMotionRecordingFrameRate",()=>Qw(e));return}$M({selected:e,recordingInput:r,optionsList:t(i2,"slowMotionRecordingFrameRateOptions"),sensorSelect:t(Tw,"slowMotionSensorMode"),resolutionSelect:t(Ow,"slowMotionRecordingResolution"),aspectSelect:t(xw,"slowMotionAspectRatio"),hintElement:t(a2,"slowMotionRecordingFrameRateHint")})}function sU(e=""){bS("slowMotionRecordingResolution","resolutions",e)}function lU(e=""){bS("slowMotionSensorMode","sensorModes",e)}function _P(e=""){bS("sensorMode","sensorModes",e)}function nce(e=""){bS("codec","recordingCodecs",e)}function oY(){const e=r=>{const n=typeof window<"u"&&window.devices||{};if(r&&n&&Array.isArray(n.filterOptions)){const o=document.createDocumentFragment();if(!r.multiple){const a=document.createElement("option");a.value="",o.appendChild(a)}for(let a=0;a<n.filterOptions.length;a+=1){const i=n.filterOptions[a],s=document.createElement("option");s.value=i,s.textContent=i,o.appendChild(s)}r.innerHTML="",r.appendChild(o)}},t=_g();t?e(t):typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"&&Gr.whenElementAvailable("filter",r=>{typeof filterSelectElem<"u"&&(!filterSelectElem||typeof filterSelectElem!="object")&&(filterSelectElem=r),e(r)})}const Vc=e=>e.replace(/[^a-z0-9]/gi,"_");function jh(e){switch(e){case"IRND":return{opts:["0.3","0.6","0.9","1.2","1.5","1.8","2.1","2.5"],defaults:["0.3","1.2"]};case"Diopter":return{opts:["+1/4","+1/2","+1","+2","+3","+4"],defaults:["+1/2","+1","+2","+4"]};case"ND Grad HE":return{opts:["0.3 HE Vertical","0.6 HE Vertical","0.9 HE Vertical","1.2 HE Vertical","0.3 HE Horizontal","0.6 HE Horizontal","0.9 HE Horizontal","1.2 HE Horizontal"],defaults:["0.3 HE Horizontal","0.6 HE Horizontal","0.9 HE Horizontal"]};case"ND Grad SE":return{opts:["0.3 SE Vertical","0.6 SE Vertical","0.9 SE Vertical","1.2 SE Vertical","0.3 SE Horizontal","0.6 SE Horizontal","0.9 SE Horizontal","1.2 SE Horizontal"],defaults:["0.3 SE Horizontal","0.6 SE Horizontal","0.9 SE Horizontal"]};default:return{opts:["1","1/2","1/4","1/8","1/16"],defaults:["1/2","1/4","1/8"]}}}const nc=_o("DEFAULT_FILTER_SIZE",()=>"4x5.65");function aY(e,t=nc,r={}){const{includeId:n=!0,idPrefix:o="filter-size-"}=r,a=document.createElement("select");n&&(a.id=`${o}${Vc(e)}`);let i=[nc,"4x4","6x6","95mm"];return e==="Rota-Pol"&&(i=[nc,"6x6","95mm"]),i.forEach(s=>{const l=document.createElement("option");l.value=s,l.textContent=s,s===t&&(l.selected=!0),a.appendChild(l)}),a}function Hp(e,t=nc){switch(e){case"Diopter":return{label:"Schneider CF DIOPTER FULL GEN2",gearName:"Schneider CF DIOPTER FULL GEN2"};case"Clear":return{label:"Clear Filter",gearName:"Clear Filter"};case"IRND":return{label:"IRND Filter Set",gearName:"IRND Filter Set",hideDetails:!1};case"Pol":return{label:"Pol Filter",gearName:"Pol Filter"};case"Rota-Pol":return t==="6x6"?{label:"ARRI Rota Pola Filter Frame (6x6)",gearName:"ARRI Rota Pola Filter Frame (6x6)"}:t==="95mm"?{label:"Tilta 95mm Polarizer Filter for Tilta Mirage",gearName:"Tilta 95mm Polarizer Filter for Tilta Mirage"}:{label:"ARRI Rota Pola Filter Frame",gearName:"ARRI Rota Pola Filter Frame"};case"ND Grad HE":return{label:"ND Grad HE Filter Set",gearName:"ND Grad HE Filter Set",hideDetails:!1};case"ND Grad SE":return{label:"ND Grad SE Filter Set",gearName:"ND Grad SE Filter Set",hideDetails:!1};default:return{label:`${e} Filter Set`,gearName:`${e} Filter Set`,hideDetails:!0}}}function VM(e=[]){const t=[];return e.forEach(({type:r,size:n=nc,values:o})=>{if(!r)return;const a=n||nc,i=`filter-${Vc(r)}`;switch(r){case"Diopter":{t.push({id:`${i}-frame`,gearName:"ARRI Diopter Frame 138mm",label:"ARRI Diopter Frame 138mm",type:"",size:"",values:[]});const s=o==null?(jh(r).defaults||[]).slice():Array.isArray(o)?o.slice():[];t.push({id:`${i}-set`,gearName:"Schneider CF DIOPTER FULL GEN2",label:"Schneider CF DIOPTER FULL GEN2",type:r,size:"",values:s});break}case"Clear":{const{label:s,gearName:l}=Hp(r,a);t.push({id:i,gearName:l,label:s,type:r,size:a,values:[]});break}case"Pol":{const{label:s,gearName:l}=Hp(r,a);t.push({id:i,gearName:l,label:s,type:r,size:a,values:[]});break}case"Rota-Pol":{const{label:s,gearName:l}=Hp(r,a),c=s.includes(a)?"":a;t.push({id:i,gearName:l,label:s,type:r,size:c,values:[]});break}case"ND Grad HE":case"ND Grad SE":{const{label:s,gearName:l,hideDetails:c}=Hp(r,a),u=o==null?(jh(r).defaults||[]).slice():Array.isArray(o)?o.slice():[];t.push({id:i,gearName:l,label:s,hideDetails:c,type:r,size:a,values:u});break}default:{const{label:s,gearName:l,hideDetails:c}=Hp(r,a),u=o==null?(jh(r).defaults||[]).slice():Array.isArray(o)?o.slice():[];t.push({id:i,gearName:l,label:s,hideDetails:c,type:r,size:a,values:u})}}}),t}function qM(e=[]){if(!Pn)return;const t=new Map(e.map(r=>[r.id,r]));Pn.querySelectorAll("[data-filter-entry]").forEach(r=>{const n=r.getAttribute("data-filter-entry");if(!n)return;const o=t.get(n);if(!o)return;const a=typeof o?.label=="string"?o.label:"";r.textContent=a?`1x ${a}`:"",r.setAttribute("data-gear-name",o.gearName),r.setAttribute("data-filter-label",o.label),o.type?r.setAttribute("data-filter-type",o.type):r.removeAttribute("data-filter-type")})}function oce(){return Pn?Pn.querySelector("#gearListFilterDetails"):null}function DP(e){return e==="Diopter"||e==="IRND"||e==="ND Grad HE"||e==="ND Grad SE"||e!=="Clear"&&e!=="Pol"&&e!=="Rota-Pol"}function ace(e,t){const r=document.createElement("select");r.id=`filter-values-${Vc(e)}`,r.multiple=!0,r.setAttribute("multiple",""),r.hidden=!0,r.setAttribute("aria-hidden","true");const{opts:n,defaults:o=[]}=jh(e),a=Array.isArray(t)?t.slice():o.slice();return n.forEach(i=>{const s=document.createElement("option");s.value=i,s.textContent=i,a.includes(i)&&(s.selected=!0,s.setAttribute("selected","")),r.appendChild(s)}),r}function ice(){if(typeof filterDetailsStorage<"u"&&filterDetailsStorage)return filterDetailsStorage;if(typeof document>"u")return null;const e=document.getElementById("filterDetails");if(!e)return null;try{typeof globalThis<"u"&&globalThis?globalThis.filterDetailsStorage=e:typeof window<"u"&&window&&(window.filterDetailsStorage=e)}catch{}return e}function sce(e){const t=ice();if(t){if(t.innerHTML="",!e.length){t.hidden=!0;return}t.hidden=!0,e.forEach(r=>{const{type:n,size:o,values:a,needsSize:i,needsValues:s}=r;if(i){const l=aY(n,o);l.hidden=!0,l.setAttribute("aria-hidden","true"),l.addEventListener("change",cU),t.appendChild(l)}if(s){const l=ace(n,a);l.addEventListener("change",cU),t.appendChild(l)}})}}function lce(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function cce(e){if(!e)return null;const t=e.querySelector(".gear-item-edit-btn");if(t)return t;const r=e.ownerDocument||(typeof document<"u"?document:null);if(!r)return null;const n=lce();let o="Edit item";const a=n&&typeof n.getGearItemEditTexts=="function"?n.getGearItemEditTexts:null;if(a)try{const f=a.call(n)||{};if(f.editButtonLabel&&typeof f.editButtonLabel=="string"){const d=f.editButtonLabel.trim();d&&(o=d)}}catch{}const i=r.createElement("button");i.type="button",i.className="gear-item-edit-btn",i.setAttribute("data-gear-edit",""),o&&(i.setAttribute("aria-label",o),i.setAttribute("title",o));const s=n&&typeof n.setButtonLabelWithIcon=="function"?n.setButtonLabelWithIcon:null,l=n&&n.ICON_GLYPHS?n.ICON_GLYPHS:null,c=l&&(l.sliders||l.gears||l.gearList||l.settingsGeneral||l.note)||null;s&&c?s.call(n,i,"",c):o&&(i.textContent=o);const u=e.querySelector(".gear-item-note");return u&&u.parentNode===e?e.insertBefore(i,u.nextSibling):e.appendChild(i),i}function uce(e){const t=oce();if(t){if(t.innerHTML="",!e.length){t.classList.add("hidden");return}t.classList.remove("hidden"),e.forEach(r=>{const{type:n,label:o,gearName:a,entryId:i,size:s,values:l,needsSize:c,needsValues:u}=r,f=document.createElement("div");f.className="filter-detail",a&&f.setAttribute("data-gear-name",a),n&&f.setAttribute("data-filter-type",n);const d=document.createElement("div");d.className="filter-detail-label gear-item",i&&d.setAttribute("data-filter-entry",i),a&&d.setAttribute("data-gear-name",a),o&&(d.setAttribute("data-filter-label",o),d.setAttribute("data-gear-label",o)),n&&d.setAttribute("data-filter-type",n),!!c?d.setAttribute("data-filter-hide-size",""):d.removeAttribute("data-filter-hide-size"),d.textContent=o?`1x ${o}`:"",f.appendChild(d),typeof enhanceGearItemElement=="function"&&enhanceGearItemElement(d),cce(d);const h=document.createElement("div");if(h.className="filter-detail-controls",c){const m=document.createElement("label");m.className="filter-detail-size";const g=document.createElement("span");g.className="filter-detail-sublabel",g.textContent="Size";const S=document.createElement("span");S.className="select-wrapper";const y=aY(n,s,{includeId:!1});y.setAttribute("data-storage-id",`filter-size-${Vc(n)}`),y.addEventListener("change",()=>{const E=y.getAttribute("data-storage-id");E&&fce(E,y.value)}),S.appendChild(y),m.append(g,S),h.appendChild(m)}if(u){const m=document.createElement("div");m.className="filter-detail-values";const g=document.createElement("span");g.className="filter-detail-sublabel",g.textContent="Strengths";const S=document.createElement("span");S.className="filter-values-container",S.setAttribute("data-storage-values",`filter-values-${Vc(n)}`);const y=S.getAttribute("data-storage-values"),{opts:E,defaults:L=[]}=jh(n),v=`filterValues-${Vc(n)}`,A=l==null?L:Array.isArray(l)?l:[];E.forEach(R=>{const I=document.createElement("label");I.className="filter-value-option";const C=document.createElement("input");C.type="checkbox",C.name=v,C.value=R,A.includes(R)&&(C.checked=!0,C.setAttribute("checked","")),C.addEventListener("change",()=>{y&&dce(y,R,C.checked)}),I.append(C,document.createTextNode(R)),S.appendChild(I)}),m.append(g,S),h.appendChild(m)}f.appendChild(h),t.appendChild(f)}),adjustGearListSelectWidths(t)}}function fce(e,t){const r=document.getElementById(e);r&&(r.value!==t&&(r.value=t),typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),r.dispatchEvent(new Event("change")))}function dce(e,t,r){const n=document.getElementById(e);if(!n)return;let o=!1;Array.from(n.options).forEach(a=>{a.value===t&&a.selected!==r&&(a.selected=r,o=!0,r?a.setAttribute("selected",""):a.removeAttribute("selected"))}),o&&(typeof markProjectFormDataDirty=="function"&&markProjectFormDataDirty(),n.dispatchEvent(new Event("change")))}function Xw(e){const t=_g();if(!t)return;const r=Array.from(t.selectedOptions).map(l=>l.value).filter(Boolean);let n;if(Array.isArray(e))n=e.filter(l=>l&&l.type).map(l=>({type:l.type,size:l.size,values:l.values===void 0?void 0:Array.isArray(l.values)?l.values.slice():l.values}));else{const l=KM();if(l)n=wg(l);else{const c=typeof _r<"u"?_r:{};c&&c.filter?n=wg(c.filter):n=[]}}const o=new Map(n.map(l=>[l.type,l])),a=r.map(l=>{const c=o.get(l)||{},u=c.size||nc,f=l!=="Diopter",d=DP(l),{label:p,gearName:h,hideDetails:m}=Hp(l,u);let g=`filter-${Vc(l)}`;return l==="Diopter"&&(g=`${g}-set`),{type:l,label:p,gearName:h,entryId:g,size:u,values:Array.isArray(c.values)?c.values.slice():[],needsSize:f,needsValues:d,hideDetails:m}});sce(a),uce(a);let i=VM(n);i.length||(i=a.map(l=>({id:l.entryId,gearName:l.gearName,label:l.label,type:l.type,hideDetails:l.hideDetails})).filter(l=>l.id&&l.label)),qM(i);const s=typeof matteboxSelect<"u"?matteboxSelect:typeof document<"u"?document.getElementById("mattebox"):null;s&&r.some(c=>c==="ND Grad HE"||c==="ND Grad SE")&&(s.value="Swing Away")}function cU(){if(!_g())return;const e=KM(),t=VM(wg(e));qM(t),Pn&&adjustGearListSelectWidths(Pn),Ji(),saveCurrentGearList(),Qi(),Xw()}function KM(){const e=_g();if(!e)return"";const t=Array.from(e.selectedOptions).map(u=>typeof u.value=="string"?u.value.trim():"").filter(Boolean),r=typeof _r<"u"?_r:{},n=r&&typeof r.filter=="string"?r.filter:"",o=n?wg(n):[],a=Object.fromEntries(o.map(u=>[u.type,u])),i={};n&&n.split(",").forEach(u=>{const f=typeof u=="string"?u.trim():"";if(!f)return;const d=f.split(":")[0]?.trim();d&&(i[d]=f)});const s=t.map(u=>{const f=document.getElementById(`filter-size-${Vc(u)}`),d=document.getElementById(`filter-values-${Vc(u)}`),p=a[u]||{},h=f?f.value:p.size||nc;let m;const g=DP(u);d?m=Array.from(d.selectedOptions).map(y=>y.value):Array.isArray(p.values)&&p.values.length?m=p.values.slice():m=[];let S="";return g&&(S=m.length?`:${m.join("|")}`:":!"),`${u}:${h}${S}`}),l=new Set(Array.from(e.options).map(u=>typeof u.value=="string"?u.value.trim():"").filter(Boolean)),c=new Set(t);return o.forEach(u=>{if(!u||!u.type||c.has(u.type)||l.has(u.type))return;const f=i[u.type]||(()=>{const d=u.size||nc,p=Array.isArray(u.values)?u.values.filter(Boolean):[];let h="";return DP(u.type)&&(h=p.length?`:${p.join("|")}`:":!"),`${u.type}:${d}${h}`})();s.push(f)}),s.join(",")}function wg(e){return e?e.split(",").map(t=>{const r=t.split(":").map(s=>s.trim()),n=r[0],o=r[1]||nc,a=r.length>2?r[2]:void 0;let i;return a===void 0?i=void 0:a===""||a==="!"?i=[]:i=a.split("|").map(s=>s.trim()).filter(Boolean),{type:n,size:o,values:i}}).filter(t=>t.type):[]}function pce(e){if(!Pn)return;_g();const t=e&&e.filter?wg(e.filter):[],r=VM(t);qM(r),adjustGearListSelectWidths(Pn)}const uU=[{key:"toggleLut",value:"Toggle LUT"},{key:"falseColor",value:"False Color"},{key:"peaking",value:"Peaking"},{key:"anamorphicDesqueeze",value:"Anamorphic Desqueeze"},{key:"surroundView",value:"Surround View"},{key:"oneToOneZoom",value:"1:1 Zoom"},{key:"waveform",value:"Waveform"},{key:"histogram",value:"Histogram"},{key:"vectorscope",value:"Vectorscope"},{key:"zebra",value:"Zebra"},{key:"playback",value:"Playback"},{key:"record",value:"Record"},{key:"zoom",value:"Zoom"},{key:"frameLines",value:"Frame Lines"},{key:"frameGrab",value:"Frame Grab"},{key:"wb",value:"WB"},{key:"iso",value:"ISO"},{key:"nd",value:"ND"},{key:"fps",value:"FPS"},{key:"shutter",value:"Shutter"}];function sd(){const e=typeof currentLang=="string"&&texts[currentLang]?currentLang:"en",t=texts?.en?.projectForm||{},n=(texts?.[e]?.projectForm||t).userButtonFunctions||{},o=t.userButtonFunctions||{},a=uU.map(s=>{const l=n[s.key]||o[s.key]||s.value;return{...s,label:l}}),i=new Set(a.map(s=>s.value));["monitorUserButtons","cameraUserButtons","viewfinderUserButtons"].forEach(s=>{const l=c=>{if(!c)return;const u=new Set(Array.from(c.selectedOptions||[]).map(p=>p.value)),f=document.createDocumentFragment();for(let p=0;p<a.length;p+=1){const{value:h,label:m}=a[p];if(!h)continue;const g=document.createElement("option");g.value=h,g.textContent=m,u.has(h)&&(g.selected=!0),f.appendChild(g)}u.forEach(p=>{if(i.has(p))return;const h=document.createElement("option");h.value=p,h.textContent=p,h.selected=!0,f.appendChild(h)}),c.innerHTML="",c.appendChild(f);const d=c.options?c.options.length:0;c.size=d>0?d:uU.length};typeof Gr<"u"&&typeof Gr.whenElementAvailable=="function"?Gr.whenElementAvailable(s,l):l(document.getElementById(s))})}const fU=()=>{D2();try{Kle()}finally{N2()}};D2();typeof document<"u"&&typeof document.addEventListener=="function"?document.readyState==="loading"?document.addEventListener("DOMContentLoaded",fU):fU():N2();const Ry={APP_VERSION:typeof es=="string"?es:typeof APP_VERSION<"u"?APP_VERSION:"unknown",closeSideMenu,openSideMenu,setupSideMenu,setupResponsiveControls,setLanguage:bg,applySetLanguage:bg,safeGetCurrentProjectName:pR,updateCalculations:function(...e){if(typeof globalThis<"u"&&typeof globalThis.updateCalculations=="function")return globalThis.updateCalculations(...e)},setBatteryPlates,getBatteryPlates,setRecordingMedia,getRecordingMedia,applyDarkMode:_b,applyPinkMode:Ag,applyHighContrast:qd,generatePrintableOverview,generateGearListHtml,ensureZoomRemoteSetup,encodeSharedSetup,decodeSharedSetup,applySharedSetupFromUrl:AM,applySharedSetup:EM,updateBatteryPlateVisibility:fR,updateBatteryOptions:zc,cameraFizPort,controllerCamPort,controllerDistancePort,detectBrand,connectionLabel,generateConnectorSummary,exportDiagramSvg:tY,fixPowerInput,ensureList,normalizeVideoType,normalizeFizConnectorType,normalizeViewfinderType,normalizePowerPortType,setSelectValue:no,autoSaveCurrentSetup:mS,saveCurrentSession:uR,saveCurrentGearList:function(...e){if(typeof globalThis<"u"&&typeof globalThis.saveCurrentGearList=="function")return globalThis.saveCurrentGearList(...e)},crewRoles:typeof globalThis<"u"&&Array.isArray(globalThis.crewRoles)?globalThis.crewRoles:[],setSliderBowlValue:function(...e){if(typeof globalThis<"u"&&typeof globalThis.setSliderBowlValue=="function")return globalThis.setSliderBowlValue(...e)},setEasyrigValue:function(...e){if(typeof globalThis<"u"&&typeof globalThis.setEasyrigValue=="function")return globalThis.setEasyrigValue(...e)},restoreSessionState:T2,scenarioIcons:UM,renderFilterDetails:Xw,collectFilterSelections:KM,parseFilterTokens:wg,applyFilterSelectionsToGearList:pce,createSettingsBackup:Hb,buildSettingsBackupPackage:K2,captureStorageSnapshot,sanitizeBackupPayload,extractBackupSections,runFeatureSearch,computeSetupDiff:_M,__versionCompareInternals:{formatDiffPath:$2,formatDiffListIndex:z2,createKeyedDiffPathSegment:jA,parseKeyedDiffPathSegment:H2,findArrayComparisonKey:U2},__featureSearchInternals:{featureMap,actionMap,deviceMap,helpMap,featureSearchEntries,featureSearchDefaultOptions,featureSearchInput:featureSearch,featureSearchDropdownElement:typeof globalThis<"u"&&globalThis.featureSearchDropdown?globalThis.featureSearchDropdown:null},__customFontInternals:{addFromData:(e,t,r)=>addCustomFontFromData(e,t,r),getEntries:()=>Array.from(customFontEntries.values())},__sharedImportInternals:{getLastSharedSetupData:()=>lastSharedSetupData,setLastSharedSetupDataForTest:e=>{lastSharedSetupData=e},getLastSharedAutoGearRules:()=>lastSharedAutoGearRules,setLastSharedAutoGearRulesForTest:e=>{lastSharedAutoGearRules=e},isProjectPresetActive:()=>sharedImportProjectPresetActive,setProjectPresetActiveForTest:e=>{sharedImportProjectPresetActive=!!e},getPreviousPresetId:()=>sharedImportPreviousPresetId,setPreviousPresetIdForTest:e=>{sharedImportPreviousPresetId=typeof e=="string"?e:""},isPromptActive:()=>sharedImportPromptActive,setPromptActiveForTest:e=>{sharedImportPromptActive=!!e},getPendingSharedLinkListener:()=>pendingSharedLinkListener,setPendingSharedLinkListenerForTest:e=>{pendingSharedLinkListener=typeof e=="function"?e:null}},__mountVoltageInternals:{getSessionMountVoltagePreferencesClone,applySessionMountVoltagePreferences,cloneMountVoltageDefaultsForSession},resetPlannerStateAfterFactoryReset:Z2,__autoGearInternals:{buildVideoDistributionAutoRules:typeof window<"u"&&window.buildVideoDistributionAutoRules||void 0},populateFilterDropdown:oY,populateFrameRateDropdownFor:$M,populateSlowMotionFrameRateDropdown:Qw,populateSensorModeDropdown:_P,populateCodecDropdown:nce};typeof window<"u"&&(window.cineCoreSession=Ry,["saveCurrentSession","autoSaveCurrentSetup","createSettingsBackup","handleRestoreRehearsalProceed","handleRestoreRehearsalAbort","downloadSharedProject","encodeSharedSetup","decodeSharedSetup","applySharedSetup","applySharedSetupFromUrl","renderFilterDetails","populateFilterDropdown","populateFrameRateDropdownFor","populateSlowMotionFrameRateDropdown","populateSensorModeDropdown","populateCodecDropdown"].forEach(t=>{Ry[t]&&(window[t]=Ry[t])}),Ry.__autoGearInternals&&(window.__autoGearInternals=Ry.__autoGearInternals));console.log("app-session.js: Execution complete (ESM)");var iY=(function(){const t=typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE?CORE_PART1_RUNTIME_SCOPE:null,r=typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null,n=[t,r,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];for(let i=0;i<n.length;i+=1){const s=n[i];if(!(!s||typeof s!="object"))try{const l=s.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS;if(l&&typeof l=="object")return l}catch{}}const o=resolveCoreSupportModule("cineCoreAppRuntimeSharedNamespace","./modules/app-core/runtime.js"),a=[t,r];for(let i=0;i<a.length;i+=1){const s=a[i];if(!(!s||typeof s!="object"))try{typeof s.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS>"u"&&Object.defineProperty(s,"CORE_RUNTIME_SHARED_NAMESPACE_TOOLS",{configurable:!0,writable:!0,value:o})}catch{try{s.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS=o}catch{}}}return o})(),sY=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrap","./modules/app-core/runtime.js");resolveCoreSupportModule("cineCoreAppLocalizationAccessors","./modules/app-core/localization-fixed.js");var mce=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapInline","./modules/app-core/runtime.js"),gce=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapResult","./modules/app-core/runtime.js"),yce=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapLoader","./modules/app-core/runtime.js"),hce=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapManager","./modules/app-core/runtime.js"),Sf=resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapResolver","./modules/app-core/runtime.js");resolveCoreSupportModule("cineCoreAppRuntimeSharedBootstrapContext","./modules/app-core/runtime.js");function bce(){return typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE?CORE_PART1_RUNTIME_SCOPE:null}function Sce(){return typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE?CORE_GLOBAL_SCOPE:null}var dU=APP_CORE_BOOTSTRAP_TOOLS&&APP_CORE_BOOTSTRAP_TOOLS.resolver&&typeof APP_CORE_BOOTSTRAP_TOOLS.resolver.createInlineRuntimeSharedFallback=="function"?APP_CORE_BOOTSTRAP_TOOLS.resolver.createInlineRuntimeSharedFallback:function(){return null},pa=(function(){const t=bce(),r=Sce(),n=typeof require=="function"?require:null,o=typeof Td<"u"&&Td?Td:null,a=Sf&&typeof Sf.collectBootstrapFallbackScopes=="function"?Sf.collectBootstrapFallbackScopes({fallbackScopes:[],runtimeScope:t,coreGlobalScope:r}):[],i=APP_CORE_BOOTSTRAP_TOOLS,s={bootstrapTools:i,bootstrapFallbackTools:APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,runtimeSharedBootstrapResolverTools:Sf,runtimeSharedBootstrapTools:sY,runtimeSharedNamespaceTools:iY,runtimeSharedBootstrapInlineTools:mce,runtimeSharedBootstrapResultTools:gce,runtimeSharedBootstrapLoaderTools:yce,runtimeSharedBootstrapManagerTools:hce,resolveCoreSupportModule,requireFn:n,runtimeScope:t,coreGlobalScope:r,currentRuntimeShared:o,fallbackScopes:a,collectFallbackScopes(l){return Sf&&typeof Sf.collectBootstrapFallbackScopes=="function"?Sf.collectBootstrapFallbackScopes({fallbackScopes:Array.isArray(l)?l:[],runtimeScope:t,coreGlobalScope:r}):[]},createInlineRuntimeSharedFallback:dU,runtimeSharedBootstrapInlineRequirePath:null,runtimeSharedBootstrapResultRequirePath:null};if(APP_CORE_BOOTSTRAP_SUITE&&typeof APP_CORE_BOOTSTRAP_SUITE.createRuntimeSharedBootstrapResult=="function")try{const l=APP_CORE_BOOTSTRAP_SUITE.createRuntimeSharedBootstrapResult(s);if(l&&typeof l=="object")return l}catch{}if(APP_CORE_BOOTSTRAP_RESULTS_TOOLS&&typeof APP_CORE_BOOTSTRAP_RESULTS_TOOLS.resolveRuntimeSharedBootstrapResult=="function")try{const l=APP_CORE_BOOTSTRAP_RESULTS_TOOLS.resolveRuntimeSharedBootstrapResult(s);if(l&&typeof l=="object")return l}catch{}if(i&&typeof i.createRuntimeSharedBootstrapResult=="function")try{const l=i.createRuntimeSharedBootstrapResult(s);if(l&&typeof l=="object")return l}catch{}if(i&&typeof i.createRuntimeSharedBootstrapFallback=="function")try{const l=i.createRuntimeSharedBootstrapFallback(s);if(l&&typeof l=="object")return l}catch{}return dU(s)})(),vce=pa&&pa.runtimeSharedNamespace?pa.runtimeSharedNamespace:null,NP=pa&&typeof pa.runtimeSharedResolver=="function"?pa.runtimeSharedResolver:null,oh=(pa&&pa.existingRuntimeShared&&typeof pa.existingRuntimeShared=="object"?pa.existingRuntimeShared:null)||(typeof Td<"u"&&Td?Td:null),Ece=pa&&typeof pa.fallbackResolveRuntimeSharedFromGlobal=="function"?pa.fallbackResolveRuntimeSharedFromGlobal:function(){return null},Td=(pa&&pa.runtimeShared&&typeof pa.runtimeShared=="object"?pa.runtimeShared:null)||(oh&&typeof oh=="object"?oh:null)||(NP?(function(){try{const t=NP({currentShared:oh,resolveCoreSupportModule,requireFn:typeof require=="function"?require:null,runtimeScope:typeof CORE_PART1_RUNTIME_SCOPE<"u"?CORE_PART1_RUNTIME_SCOPE:null,coreGlobalScope:typeof CORE_GLOBAL_SCOPE<"u"?CORE_GLOBAL_SCOPE:null});if(t&&typeof t=="object")return t}catch{}return null})():null)||Ece()||Object.create(null);typeof window<"u"&&(window.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS=iY,window.RUNTIME_SHARED_BOOTSTRAP_TOOLS=sY,window.CORE_RUNTIME_SHARED_NAMESPACE=vce,window.CORE_RUNTIME_SHARED_RESOLVER=NP,window.EXISTING_CORE_RUNTIME_SHARED=oh,window.CORE_RUNTIME_SHARED=Td);(function(t){if(!t||typeof document>"u")return;var r="backupNotificationContainer",n="cineGlobalLoadingIndicator",o="cine-notification-stack",a="cine-notification",i="cine-notification--loading",s="cine-notification__spinner",l="global-loading-indicator-text";if(t.__cineLoadingNotice&&t.__cineLoadingNotice.indicator)return;var c={preparing:"Preparing planner",modules:"Loading planner interface",data:"Loading planner data",almost:"Almost ready"},u={},f="preparing",d=null,p=null,h=null;function m(){h!==null&&(typeof clearTimeout=="function"&&clearTimeout(h),h=null)}function g(){t.__cineLoadingNotice&&typeof t.__cineLoadingNotice=="object"&&(t.__cineLoadingNotice.container=d,t.__cineLoadingNotice.indicator=p)}function S(){m(),p&&p.parentNode&&p.parentNode.removeChild(p),p=null,d&&(d.children&&d.children.length===0&&d.parentNode&&d.parentNode.removeChild(d),d.children&&d.children.length===0&&(d=null)),g()}function y(){if(h===null){if(typeof setTimeout!="function"){S();return}h=setTimeout(function(){h=null,!(p&&p.dataset&&p.dataset.preventBootstrapHide==="true")&&S()},600)}}function E(G){var T=typeof G=="string"?G.trim():"";if(!T)return"";if(u&&typeof u=="object"){var P=u[T];if(typeof P=="string"&&P.trim())return P.trim()}var N=c[T];return typeof N=="string"&&N.trim()?N.trim():""}function L(){if(d&&d.parentNode)return d;m();var G=document.getElementById(r);d=G||document.createElement("div"),d.id=r,d.classList?d.classList.add(o):d.className=[d.className||"",o].join(" ").trim(),d.setAttribute("role","presentation"),d.dataset.bootstrap="true";var T=document.body||document.documentElement;return T&&d.parentNode!==T&&T.appendChild(d),g(),d}function v(){if(p&&p.parentNode)return p;m(),d=L();var G=document.getElementById(n);p=G||document.createElement("div"),p.id=n,p.classList?p.classList.add(a,i):p.className=[p.className||"",a,i].join(" ").trim(),p.setAttribute("role","status"),p.setAttribute("aria-live","polite"),p.setAttribute("aria-busy","true"),p.dataset.bootstrap="true";var T=p.querySelector("."+s);T||(T=document.createElement("span"),T.className=s,T.setAttribute("aria-hidden","true"),p.insertBefore(T,p.firstChild));var P=p.querySelector("."+l);return P||(P=document.createElement("span"),P.className=l,p.appendChild(P)),d&&p.parentNode!==d&&d.appendChild(p),g(),p}function A(){var G=p?p.querySelector("."+l):null;if(G){var T=E(f);!T&&f!=="preparing"&&(T=E("preparing")),T||(T="Loading"),G.textContent=T,p.dataset.messageMode="key",p.dataset.messageKey=f,p.dataset.fallbackMessage=T,p.dataset.currentMessage=T}}function R(G){p&&(G?p.setAttribute("aria-busy","true"):p.setAttribute("aria-busy","false"))}function I(G){var T=typeof G=="string"&&G.trim()?G.trim():"preparing";f=T,v(),A()}function C(G){u=G&&typeof G=="object"?G:{},A()}function k(){if(d){var G=d.parentNode;!G||G===document.body||document.body&&document.body.appendChild(d)}}d=L(),p=v(),I(f),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",k,{once:!0}):k();function _(G){if(G){var T=G.detail||{},P=Number(T.total),N=Number(T.index),q="modules";Number.isFinite(P)&&P>0&&Number.isFinite(N)&&(N+1>=P?q="almost":N>0&&(q="data")),I(q)}}function w(){if(I("almost"),R(!1),y(),typeof setTimeout=="function")try{setTimeout(function(){p&&p.dataset&&p.dataset.bootstrap==="true"&&S()},800)}catch{}}document.addEventListener("cine-loader-progress",_);function x(G,T){!G||typeof G.addEventListener!="function"||typeof T!="function"||G.addEventListener("cine-loader-complete",T,!1)}x(document,w),t.__cineLoadingNotice={container:d,indicator:p,ensureContainer:L,ensureIndicator:v,setMessageKey:I,applyLocalization:C,setBusy:R,refresh:A,getCurrentKey:function(){return f},getFallbackMessages:function(){var G={};for(var T in c)Object.prototype.hasOwnProperty.call(c,T)&&(G[T]=c[T]);return G}}})(typeof window<"u"?window:void 0);const pU="cineGlobalOperationOverlay",Ace="cineGlobalOperationText",mU="cine-notification__spinner";let po=null,Hf=null;function Cce(){if(!(po&&document.contains(po))){if(po=document.getElementById(pU),po||(po=document.createElement("div"),po.id=pU,po.className="cine-notification cine-notification--loading cine-notification--overlay",Object.assign(po.style,{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:"10000",backgroundColor:"var(--bg-surface, #222)",color:"var(--text-primary, #fff)",padding:"1rem 2rem",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",gap:"1rem",minWidth:"200px",justifyContent:"center",pointerEvents:"none"})),!Hf||!po.contains(Hf)){po.innerHTML="";const e=document.createElement("span");if(e.className=mU,!document.querySelector("style#cine-spinner-style")){const t=document.createElement("style");t.id="cine-spinner-style",t.textContent=`
            .@keyframes cine-spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
            .${mU} {
                display: inline-block;
                width: 1rem;
                height: 1rem;
                border: 2px solid currentColor;
                border-right-color: transparent;
                border-radius: 50%;
                animation: cine-spin 0.75s linear infinite;
            }
            .cine-notification--overlay {
                transition: opacity 0.2s ease-in-out;
            }
        `,document.head.appendChild(t)}po.appendChild(e),Hf=document.createElement("span"),Hf.id=Ace,po.appendChild(Hf)}po.parentNode||document.body.appendChild(po)}}function wce(e="Loading..."){typeof document>"u"||(Cce(),Hf&&(Hf.textContent=e),po&&(po.style.opacity="1",po.hidden=!1))}function Lce(){typeof document>"u"||po&&(po.style.opacity="0",setTimeout(()=>{po&&(po.hidden=!0)},300))}typeof window<"u"&&(window.cineUiFeedback={showLoading:wce,hideLoading:Lce});(function(){function e(){try{const t=document.querySelectorAll("dialog[open], .app-modal[open]");console.log(`Found ${t.length} open dialog(s) on page load`),t.forEach((r,n)=>{console.log(`Closing dialog ${n}:`,r.id||r.className),typeof r.close=="function"&&r.open?r.close():r.removeAttribute("open")})}catch(t){console.warn("Failed to close stuck dialogs:",t)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e(),setTimeout(e,500)})();function Rce(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}function Tce(e){const t=[];try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&t.push(CORE_GLOBAL_SCOPE)}catch{}try{typeof CORE_PART1_RUNTIME_SCOPE<"u"&&CORE_PART1_RUNTIME_SCOPE&&t.push(CORE_PART1_RUNTIME_SCOPE)}catch{}try{typeof CORE_PART2_RUNTIME_SCOPE<"u"&&CORE_PART2_RUNTIME_SCOPE&&t.push(CORE_PART2_RUNTIME_SCOPE)}catch{}return e&&t.push(e),typeof window<"u"&&window&&window!==e&&t.push(window),typeof self<"u"&&self&&self!==e&&t.push(self),typeof global<"u"&&global&&global!==e&&t.push(global),t}function lY(e,t){const r=[];e&&e.helpers&&typeof e.helpers=="object"&&r.push(e.helpers);for(let n=0;n<t.length;n+=1){const o=t[n];if(o)try{const a=o.cineCoreRuntimeUiBridge;a&&a!==e&&typeof a=="object"&&a.helpers&&typeof a.helpers=="object"&&r.push(a.helpers)}catch{}}for(let n=0;n<t.length;n+=1){const o=t[n];if(o)try{const a=o.cineCoreUiHelpers;a&&typeof a=="object"&&r.push(a)}catch{}}for(let n=0;n<r.length;n+=1){const o=r[n];if(o&&typeof o=="object")return o}return{}}const ld=Rce();let Xr=null;ld&&typeof ld.cineCoreRuntimeUiBridge=="object"&&ld.cineCoreRuntimeUiBridge&&(Xr=ld.cineCoreRuntimeUiBridge);!Xr&&typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&typeof CORE_GLOBAL_SCOPE.cineCoreRuntimeUiBridge=="object"&&(Xr=CORE_GLOBAL_SCOPE.cineCoreRuntimeUiBridge);Xr||(Xr={});const cY=Tce(ld),Bo=lY(Xr,cY);function uY(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function fY(e){return typeof e!="string"||e===""?"":(typeof Xr.escapeHtml=="function"?Xr.escapeHtml:typeof Bo.escapeHtml=="function"?Bo.escapeHtml:uY)(e)}function dY(){return""}function Oce(e,t,r){if(!e)return;let n=r;if(typeof n>"u")try{typeof ICON_GLYPHS=="object"&&ICON_GLYPHS&&ICON_GLYPHS.save&&(n=ICON_GLYPHS.save)}catch{}const o=(typeof Xr.resolveButtonIconMarkup=="function"?Xr.resolveButtonIconMarkup:typeof Bo.resolveButtonIconMarkup=="function"?Bo.resolveButtonIconMarkup:dY)(n),i=(typeof Xr.escapeButtonLabelSafely=="function"?Xr.escapeButtonLabelSafely:typeof Bo.escapeButtonLabelSafely=="function"?Bo.escapeButtonLabelSafely:fY)(typeof t=="string"?t:"");try{e.innerHTML=`${o}${i}`}catch{}}const xce=typeof Xr.escapeHtml=="function"?Xr.escapeHtml:typeof Bo.escapeHtml=="function"?Bo.escapeHtml:uY,kce=typeof Xr.escapeButtonLabelSafely=="function"?Xr.escapeButtonLabelSafely:typeof Bo.escapeButtonLabelSafely=="function"?Bo.escapeButtonLabelSafely:function(t){return fY(t)},Ice=typeof Xr.resolveButtonIconMarkup=="function"?Xr.resolveButtonIconMarkup:typeof Bo.resolveButtonIconMarkup=="function"?Bo.resolveButtonIconMarkup:dY,Pce=typeof Xr.setButtonLabelWithIcon=="function"?Xr.setButtonLabelWithIcon:typeof Bo.setButtonLabelWithIcon=="function"?Bo.setButtonLabelWithIcon:function(t,r,n){Oce(t,r,n)},Bce=typeof Xr.whenElementAvailable=="function"?Xr.whenElementAvailable:typeof Bo.whenElementAvailable=="function"?Bo.whenElementAvailable:function(t,r,n){return typeof Bo.whenElementAvailable=="function"?Bo.whenElementAvailable(t,r,n):!1};Xr.helpers=Bo;Xr.escapeHtml=xce;Xr.escapeButtonLabelSafely=kce;Xr.resolveButtonIconMarkup=Ice;Xr.setButtonLabelWithIcon=Pce;Xr.whenElementAvailable=Bce;Xr.resolveCoreUiHelpers=function(){return lY(Xr,cY)};if(ld)try{ld.cineCoreRuntimeUiBridge=Xr}catch{}if(typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE)try{CORE_GLOBAL_SCOPE.cineCoreRuntimeUiBridge=Xr}catch{}const om=300*1024,pY=6*1024*1024,mY=256,gY=.85,HA=.55,FP=Object.freeze({name:"",role:"",avatar:"",phone:"",email:""});function fk(e){return{name:typeof e?.name=="string"?e.name:"",role:typeof e?.role=="string"?e.role:"",avatar:typeof e?.avatar=="string"?e.avatar:"",phone:typeof e?.phone=="string"?e.phone:"",email:typeof e?.email=="string"?e.email:""}}function Gce(e={}){const{loadProfile:t=()=>null,saveProfile:r=()=>{},announce:n=()=>{},getText:o=()=>"",dispatchChange:a=()=>{},now:i=()=>Date.now(),schedule:s=(C,k)=>typeof setTimeout=="function"?setTimeout(C,k):C(),throttleMs:l=400}=e;let c=fk(t()||FP),u=!1,f=!1,d=null,p=null;const h=new Set;function m(){return{name:c.name.trim(),role:c.role.trim(),avatar:c.avatar||"",phone:c.phone.trim(),email:c.email.trim()}}function g(){const C=m();h.forEach(k=>{try{k(C)}catch{}});try{a(C)}catch{}return C}function S(C={}){return c=fk({...c,...C}),g()}function y(C={}){const{announce:k=!1}=C,_=()=>{p=null;const T=m();try{r(T)}catch(P){console.warn("Failed to save user profile via contacts/profile module",P)}if(u=!1,g(),k){const P=o("userProfileSaved","Profile saved.");P&&n(P),f=!1}},w=typeof d=="number"?d:null,x=w===null?l:i()-w;if(w===null||x>=l){d=i(),_();return}const G=Math.max(0,l-x);p&&clearTimeout(p),p=s(()=>{d=i(),_()},G)}function E(C,k){if(!C)return!1;const _=typeof k=="string"?k:"";return(typeof c[C]=="string"?c[C]:"").trim()===_.trim()?!1:(S({[C]:_}),u=!0,f=!0,y(),!0)}function L(){if(!u&&f){const C=o("userProfileSaved","Profile saved.");C&&n(C),f=!1}}function v(C){return c=fk(C||t()||FP),u=!1,f=!1,g(),m()}function A(C,k={}){const{announce:_=!1}=k;S({avatar:typeof C=="string"?C:""}),u=!1,f=f||_,y({announce:_})}function R(C={}){return c.avatar?(A("",C),!0):!1}function I(C){return typeof C!="function"?()=>{}:(h.add(C),()=>h.delete(C))}return{assignUserProfileState:S,getUserProfileSnapshot:m,handleFieldInput:E,handleFieldBlur:L,load:v,setAvatar:A,clearAvatar:R,onChange:I,schedulePersist:y,markDirty:C=>{u=!!C},setPendingAnnouncement:C=>{f=!!C}}}function Jw(e){if(typeof e!="string"||!e)return 0;const t="base64,",r=e.indexOf(t);if(r===-1)return e.length;const n=e.slice(r+t.length).trim();if(!n)return 0;const o=n.endsWith("==")?2:n.endsWith("=")?1:0;return Math.max(0,Math.floor(n.length/4)*3-o)}function Mce(e,t){if(typeof document>"u")return null;const r=document.createElement("canvas");return r.width=e,r.height=t,r}function yY(e,t,r,n){if(!e||typeof document>"u"){typeof n=="function"&&n();return}try{const o=new Image,a=()=>{o.onload=null,o.onerror=null,typeof n=="function"&&n()};o.onload=()=>{o.onload=null,o.onerror=null;try{const i=o.naturalWidth||o.width||0,s=o.naturalHeight||o.height||0;if(!i||!s){a();return}const l=Math.min(1,mY/Math.max(i,s)),c=Math.max(1,Math.round(i*l)),u=Math.max(1,Math.round(s*l)),f=Mce(c,u);if(!f){a();return}const d=f.getContext("2d");if(!d){a();return}d.clearRect(0,0,c,u),d.drawImage(o,0,0,c,u);const h=typeof t=="string"&&/image\/(png|gif|webp)/i.test(t)?["image/png","image/jpeg"]:["image/jpeg","image/png"],m=g=>{const S=Jw(g);return S&&S<=om?(typeof r=="function"&&r(g),!0):!1};for(let g=0;g<h.length;g+=1){const S=h[g];if(S==="image/jpeg"){let y=gY;for(;y+1e-4>=HA;){const E=Math.max(HA,Math.min(.95,Number(y.toFixed(2)))),L=f.toDataURL("image/jpeg",E);if(m(L))return;if(E===HA)break;y-=.1}}else{const y=f.toDataURL(S);if(m(y))return}}a()}catch(i){a()}},o.onerror=a,o.decoding="async",o.src=e}catch{typeof n=="function"&&n()}}function _ce(e,t,r){if(!e)return;const n=pY;if(e.size>n){typeof r=="function"&&r("tooLarge");return}const o=new FileReader,a=i=>{typeof r=="function"&&r(i)};o.addEventListener("error",()=>a("readError")),o.addEventListener("load",()=>{const i=typeof o.result=="string"?o.result:"";if(!i){a("readError");return}const s=Jw(i);if(s&&s<=om){typeof t=="function"&&t(i);return}yY(i,typeof e.type=="string"?e.type:"",l=>{if(l&&Jw(l)<=om){typeof t=="function"&&t(l);return}if(s&&s<=om){typeof t=="function"&&t(i);return}a("tooLarge")},()=>{if(s&&s<=om){typeof t=="function"&&t(i);return}a("readError")})});try{o.readAsDataURL(e)}catch{a("readError")}}function Dce(e){if(typeof e!="string")return!1;if(e.startsWith("data:")){const t=["image/png","image/jpeg","image/gif","image/webp"];try{const r=e.indexOf(";",5),n=r>=0?e.substring(5,r):"";if(t.includes(n))return!0}catch{}return!1}return/^\s*(javascript:|https?:|\/\/)/i.test(e)?!1:!!/^[a-zA-Z0-9._-]+$/.test(e)}const Nce={CONTACT_AVATAR_MAX_BYTES:om,CONTACT_AVATAR_MAX_SOURCE_BYTES:pY,CONTACT_AVATAR_MAX_DIMENSION:mY,CONTACT_AVATAR_JPEG_QUALITY:gY,CONTACT_AVATAR_JPEG_MIN_QUALITY:HA,DEFAULT_PROFILE_STATE:FP,createProfileController:Gce,estimateDataUrlSize:Jw,optimiseAvatarDataUrl:yY,readAvatarFile:_ce,isSafeImageUrl:Dce};Fce(Nce);function Fce(e){if(!e||typeof e!="object")return;const t=jce();t&&(t.CINE_CONTACTS_PROFILE_MODULE=e,(typeof t.CONTACT_AVATAR_MAX_SOURCE_BYTES>"u"||t.CONTACT_AVATAR_MAX_SOURCE_BYTES===null)&&(t.CONTACT_AVATAR_MAX_SOURCE_BYTES=e.CONTACT_AVATAR_MAX_SOURCE_BYTES),typeof t.readAvatarFile!="function"&&(t.readAvatarFile=e.readAvatarFile))}function jce(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:null}const Hce=Object.freeze(["id","name","role","phone","email","website","avatar","createdAt","updatedAt"]);function yu(e){return typeof e!="string"?"":e.trim()}function hY(){return()=>`contact-${Date.now().toString(36)}-${Math.random().toString(36).slice(2,8)}`}function Zw(e={},t={}){const r=typeof t.generateContactId=="function"?t.generateContactId:hY(),n=yu(e.id)||r(),o=yu(e.name),a=yu(e.role),i=yu(e.phone),s=yu(e.email),l=yu(e.website),c=typeof e.avatar=="string"&&e.avatar.startsWith("data:")?e.avatar:"",u=Number.isFinite(e.createdAt)?e.createdAt:Date.now(),f=Number.isFinite(e.updatedAt)?e.updatedAt:u;return{id:n,name:o,role:a,phone:i,email:s,website:l,avatar:c,createdAt:u,updatedAt:f}}function bY(e=[]){return e.map(t=>Zw(t)).filter(Boolean).sort((t,r)=>{const n=(t?.name||"").toLowerCase(),o=(r?.name||"").toLowerCase();if(n&&o&&n!==o)try{return n.localeCompare(o)}catch{}return n&&!o?-1:!n&&o?1:(t?.createdAt||0)-(r?.createdAt||0)})}function Uce(e,t={}){const r=typeof t.sanitize=="function"?t.sanitize:yu;if(typeof e!="string")return[];const n=e.replace(/\r\n?/g,`
`),o=[];n.split(`
`).forEach(s=>{/^[ \t]/.test(s)&&o.length?o[o.length-1]+=s.replace(/^[ \t]/,""):o.push(s)});const a=[];let i=null;return o.forEach(s=>{if(/^BEGIN:VCARD/i.test(s)){i={name:"",role:"",phone:"",email:"",website:"",avatar:""};return}if(/^END:VCARD/i.test(s)){i&&(i.name||i.email||i.phone||i.website)&&a.push({...i}),i=null;return}if(!i)return;const[l,...c]=s.split(":");if(!c.length)return;const u=l.split(";"),f=u[0]?.toUpperCase(),d=c.join(":").trim();if(f){if(f==="FN"){i.name=r(d);return}if(f==="N"&&!i.name){i.name=d.split(";").filter(Boolean).join(" ").trim();return}if(f==="TEL"){i.phone||(i.phone=r(d));return}if(f==="EMAIL"){i.email||(i.email=r(d));return}if(f==="URL"||/\.URL$/.test(f)){i.website||(i.website=r(d));return}if((f==="ROLE"||f==="TITLE")&&!i.role){i.role=r(d);return}if(f==="ORG"&&!i.role){i.role=r(d);return}if(f==="PHOTO"){let p=d;if(!p)return;if(/^data:/i.test(p)){i.avatar=p;return}const h=u.slice(1);let m="image/jpeg";h.forEach(g=>{const[S,y]=g.split("=");if(!y)return;const E=S.trim().toUpperCase(),L=y.trim();if(E==="MEDIATYPE")m=L;else if(E==="TYPE"){const v=L.toLowerCase();v.includes("/")?m=v:m=`image/${v}`}}),i.avatar=`data:${m};base64,${p}`}}}),a.map(s=>({name:r(s.name),role:r(s.role),phone:r(s.phone),email:r(s.email),website:r(s.website),avatar:typeof s.avatar=="string"&&s.avatar.startsWith("data:")?s.avatar:""})).filter(s=>s.name||s.email||s.phone||s.website)}function zce(e={}){const{existing:t=[],imported:r=[],now:n=()=>Date.now(),generateContactId:o=hY()}=e,a=t.map(l=>Zw(l,{generateContactId:o}));let i=0,s=0;return r.forEach(l=>{const c=Zw({...l,id:l.id||o(),createdAt:n(),updatedAt:n()},{generateContactId:o}),u=a.find(f=>{if(c.email&&f.email&&c.email.toLowerCase()===f.email.toLowerCase())return!0;if(c.phone&&f.phone){const d=c.phone.replace(/\D+/g,""),p=f.phone.replace(/\D+/g,"");if(d&&p&&d===p)return!0}return!!(c.name&&f.name&&c.name.toLowerCase()===f.name.toLowerCase()||c.website&&f.website&&c.website.toLowerCase()===f.website.toLowerCase())});u?(Hce.forEach(f=>{c[f]&&(u[f]=c[f])}),u.updatedAt=n(),s+=1):(a.push(c),i+=1)}),{contacts:bY(a),added:i,updated:s}}function $ce(e={},t={}){const r={...e};return r.role=t.role||"",r.name=t.name||"",r.phone=t.phone||"",r.email=t.email||"",r.website=t.website||"",r.avatar=t.avatar||"",r.contactId=t.id||"",r}const Vce={sanitizeContactValue:yu,normalizeContactEntry:Zw,sortContacts:bY,parseVCard:Uce,mergeImportedContacts:zce,createCrewRowSync:$ce};qce(Vce);function qce(e){if(!e||typeof e!="object")return;const t=Kce();t&&(t.CINE_CONTACTS_LIST_MODULE=e)}function Kce(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:null}function Wce(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const ah=Wce();function Yce(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const Cc=Yce(ah),Qce=Cc&&typeof Cc.safeWarn=="function"?Cc.safeWarn:function(t,r){typeof console>"u"||!console||typeof console.warn!="function"||(typeof r>"u"?console.warn(t):console.warn(t,r))},Xce=/[\u200B\u200C\u200D\u2060]/g,Jce=/[\u0009-\u000D\u00A0\u1680\u180E\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/g,Zce=/[\u0300-\u036F]/g,eue=/[\u2010-\u2015\u2212\uFE58\uFE63\uFF0D]/g,tue=/[\u2018\u2019\u201A\u201B\u2032\u2035]/g,rue=/[\u201C\u201D\u201E\u201F\u2033\u2036]/g,nue=/[\u2044\u2215]/g,oue=/[]/g,aue=/[]/g,iue=/[\u2026]/g,sue=/[\u00AE\u2122]/g,lue=/[!#$%()*,:;<=>?@[\]^{|}~._]/g,cue=/[]/g,uue=/[]/g,bR=String.raw`\d+(?:\s*[.,/-]\s*\d+)*(?:\s+\d+(?:\s*[.,/-]\s*\d+)*)*`,fue=new RegExp(String.raw`(${bR})[\s-]*(?:feet|foot|ft\.?)(?![a-z])`,"gi"),due=new RegExp(String.raw`(${bR})\s*['](?=\s|[\d"'-]|$)`,"g"),pue=new RegExp(String.raw`(${bR})[\s-]*(?:inches|inch|in\.?)(?![a-z])`,"gi"),mue=new RegExp(String.raw`(${bR})\s*["](?=\s|[\d'"-]|$)`,"g");function PE(e){return typeof e=="string"?e.replace(/\s+/g," ").trim():e}function SY(e){if(typeof e!="string"||!e)return e;let t=e.replace(cue,'"').replace(uue,"'");return t=t.replace(fue,(r,n)=>{const o=PE(n);return o?`${o} ft `:n}),t=t.replace(due,(r,n)=>{const o=PE(n);return o?`${o} ft `:n}),t=t.replace(pue,(r,n)=>{const o=PE(n);return o?`${o} inch `:n}),t=t.replace(mue,(r,n)=>{const o=PE(n);return o?`${o} inch `:n}),t}const jP=[["","ss"],["","ae"],["","oe"],["","o"],["","th"],["","d"],["","d"],["","h"],["","i"],["","ij"],["","ng"],["","l"],["","s"]],gue=jP.map(e=>new RegExp(e[0],"g"));function yue(e){if(typeof e!="string")return"";let t=e.replace(Xce,"");if(typeof t.normalize=="function")try{t=t.normalize("NFKD")}catch{}t=t.toLowerCase(),t=SY(t),t=t.replace(Jce," ").replace(tue," ").replace(rue," ").replace(eue," ").replace(nue," ").replace(oue," x ").replace(aue," deg ").replace(/\bdegrees?\b/gi," deg ").replace(/&/g," and ").replace(/\+/g," plus ").replace(/@/g," at ").replace(sue," ").replace(iue," ").replace(lue," "),t=t.replace(Zce,"");for(let r=0;r<jP.length;r+=1){const n=jP[r],o=gue[r];t=t.replace(o,n[1])}return t=t.replace(/['"`]/g," ").replace(/\s+/g," ").trim(),t}const dk=Object.freeze({normalizeMeasurementUnits:SY,normalizeSearchValue:yue});if(Cc)if(Cc.registerOrQueueModule("cine.features.featureSearchNormalization",dk,{category:"features",description:"Shared normalization helpers for feature search, including measurement units and punctuation folding.",replace:!0,connections:["cineModuleBase","cineModuleContext","cineUi"]},e=>Qce("Unable to register cine.features.featureSearchNormalization module.",e),ah,Cc.getModuleRegistry&&Cc.getModuleRegistry(ah)),typeof Cc.exposeGlobal=="function")Cc.exposeGlobal("cineFeaturesFeatureSearchNormalization",dk,ah,{configurable:!0,enumerable:!1,writable:!1});else try{ah.cineFeaturesFeatureSearchNormalization=dk}catch{}function vY(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const wr=vY(),gU=new Set;function SS(e,t){gU.has(e)||(gU.add(e),typeof console<"u"&&typeof console.warn=="function"&&(t?console.warn(`[cine] Missing auto gear helper: ${e}`,t):console.warn(`[cine] Missing auto gear helper: ${e}`)))}function EY(){if(!wr||typeof wr!="object"&&typeof wr!="function")return null;try{if(wr.cineCoreAutoGearUi&&typeof wr.cineCoreAutoGearUi=="object")return wr.cineCoreAutoGearUi}catch(e){SS("cineCoreAutoGearUi",e)}return null}function WM(e){if(typeof e!="string"||!e)return null;const t=EY();return t&&typeof t[e]=="function"?t[e]:wr&&typeof wr[e]=="function"?wr[e]:(SS(e),null)}function YM(e,t){if(typeof e!="string"||!e||typeof t!="function")return!1;let r=!1;if(wr&&(typeof wr=="object"||typeof wr=="function")&&typeof(()=>{try{return wr[e]}catch{return}})()!="function")try{Object.defineProperty(wr,e,{configurable:!0,enumerable:!1,writable:!0,value:t}),r=!0}catch{try{wr[e]=t,r=!0}catch{}}const n=EY();if(n&&typeof n[e]!="function")try{n[e]=t,r=!0}catch{}return r}function hue(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.toLowerCase();return r==="__none__"||r==="none"?"__none__":t}YM("normalizeVideoDistributionOptionValue",hue);function bue(e){if(e==="__none__"){const t=typeof currentLang=="string"&&currentLang?currentLang:"en",r=typeof texts=="object"&&texts?texts[t]||texts.en||{}:{};return r.viewfinderExtensionNone||r.autoGearViewfinderExtensionNone||"No"}return typeof e=="string"?e:""}function Sue(e){if(e==="__none__"){const t=typeof currentLang=="string"&&currentLang?currentLang:"en";return(typeof texts=="object"&&texts?texts[t]||texts.en||{}:{}).autoGearVideoDistributionNone||"No video distribution selected"}return typeof e=="string"?e:""}function QM(e,t,r){const n=WM(e);if(typeof n=="function")try{const o=n.call(wr,r);return o??t(r)}catch(o){SS(e,o)}return t(r)}function AY(e){if(e==="__none__"){const t=typeof currentLang=="string"&&currentLang?currentLang:"en";return(typeof texts=="object"&&texts?texts[t]||texts.en||{}:{}).autoGearMatteboxNone||"No mattebox selected"}return typeof e=="string"?e:""}function vue(e){return QM("getMatteboxFallbackLabel",AY,e)}YM("getMatteboxFallbackLabel",AY);function CY(e){if(typeof e!="string")return"";const t=e.trim();if(!t)return"";const r=t.toLowerCase();return r==="__none__"||r==="none"?"__none__":t}YM("normalizeMatteboxOptionValue",CY);function yU(e){const t=WM("normalizeMatteboxOptionValue");if(typeof t=="function")try{return t.call(wr,e)}catch(r){SS("normalizeMatteboxOptionValue",r)}return CY(e)}function hU(e){const t=WM("normalizeVideoDistributionOptionValue");if(typeof t=="function")try{return t.call(wr,e)}catch(o){SS("normalizeVideoDistributionOptionValue",o)}if(typeof e!="string")return"";const r=e.trim();if(!r)return"";const n=r.toLowerCase();return n==="__none__"||n==="none"?"__none__":r}function wY(e){return QM("getViewfinderFallbackLabel",bue,e)}function HP(e){return QM("getVideoDistributionFallbackLabel",Sue,e)}function Eue(e){const t=e&&(typeof e=="object"||typeof e=="function")?e:vY(),r=t&&(typeof t=="object"||typeof t=="function")?t:null;if(!r)return null;let n=null;try{r&&typeof r.cineModuleBase=="object"&&(n=r.cineModuleBase)}catch{n=null}if(n)return n;const o=Object.create(null),a=Object.create(null),i=(p,h)=>{if(typeof p!="string"||!p)return;const m=a[p];if(!(!Array.isArray(m)||m.length===0)){a[p]=[];for(let g=0;g<m.length;g+=1){const S=m[g];if(typeof S=="function")try{S(h)}catch{}}}},s=(p,h)=>{typeof p!="string"||!p||(o[p]=h,i(p,h))},l=p=>typeof p!="string"||!p?null:Object.prototype.hasOwnProperty.call(o,p)?o[p]:null,c=(p,h)=>{if(typeof h!="function"||typeof p!="string"||!p)return!1;const m=l(p);if(m){try{h(m)}catch{}return!0}return Array.isArray(a[p])||(a[p]=[]),a[p].push(h),!0},u=()=>{let p=null;try{p=r.cineModuleGlobals}catch{p=null}(!p||typeof p!="object")&&(p={}),typeof p.getModule!="function"&&(p.getModule=h=>l(h)),typeof p.whenModuleAvailable!="function"&&(p.whenModuleAvailable=(h,m)=>c(h,m)),typeof p.register!="function"&&(p.register=(h,m)=>(s(h,m),!0));try{Object.defineProperty(r,"cineModuleGlobals",{configurable:!0,enumerable:!1,writable:!0,value:p})}catch{try{r.cineModuleGlobals=p}catch{}}return p},f=()=>{let p=null;try{p=r.cineModules}catch{p=null}(!p||typeof p!="object")&&(p={}),typeof p.get!="function"&&(p.get=h=>l(h)),typeof p.register!="function"&&(p.register=(h,m)=>(s(h,m),!0));try{Object.defineProperty(r,"cineModules",{configurable:!0,enumerable:!1,writable:!0,value:p})}catch{try{r.cineModules=p}catch{}}return p},d={freezeDeep(p){return p},safeWarn(p,h){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof h>"u"?console.warn(p):console.warn(p,h)}catch{}},informModuleGlobals(p,h){const m=u();if(m&&typeof m.register=="function")try{return m.register(p,h),!0}catch{}return s(p,h),!0},registerOrQueueModule(p,h){const m=f();if(m&&typeof m.register=="function")try{m.register(p,h)}catch{s(p,h)}else s(p,h);return u(),!0},exposeGlobal(p,h,m,g={}){const S=m&&(typeof m=="object"||typeof m=="function")?m:r;if(!S||typeof S!="object"&&typeof S!="function")return!1;const y={configurable:g.configurable!==!1,enumerable:!!g.enumerable,writable:g.writable===!0,value:h};try{return Object.defineProperty(S,p,y),!0}catch{try{return S[p]=h,!0}catch{}}return!1}};return d.registerOrQueueModule("cineModuleBase",d),d.exposeGlobal("cineModuleBase",d,r,{configurable:!0,enumerable:!1,writable:!1}),u(),f(),d}function UP(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function Aue(e){if(typeof structuredClone=="function")return structuredClone;if(e&&typeof e.structuredClone=="function")try{return e.structuredClone.bind(e)}catch{}return null}function Cue(e){const t=Aue(e);return t?function(n){if(n===null||typeof n!="object")return n;try{return t(n)}catch{}return UP(n)}:UP}const bU=wr&&typeof wr.__cineDeepClone=="function"?wr.__cineDeepClone:Cue(wr);function wue(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const $o=wue(wr)||Eue(wr),Lue=typeof $o.freezeDeep=="function"?$o.freezeDeep:function(t){if(!t||typeof t=="function"||typeof t!="object"&&typeof t!="function")return t;const r=new WeakSet;function n(o){if(!o||typeof o!="object"&&typeof o!="function"||r.has(o))return o;r.add(o);try{const a=Object.getOwnPropertyNames(o);for(let i=0;i<a.length;i+=1){const s=a[i];let l;try{l=o[s]}catch(c){l=void 0}!l||typeof l=="function"||typeof l!="object"&&typeof l!="function"||n(l)}Object.freeze(o)}catch{}return o}return n(t)},Rue=typeof $o.exposeGlobal=="function"?function(t,r,n){return $o.exposeGlobal(t,r,wr,n||{})}:function(t,r){try{return wr[t]=r,!0}catch{return!1}},Tue=typeof $o.getModuleRegistry=="function"?$o.getModuleRegistry(wr):null,Oue=typeof $o.registerOrQueueModule=="function"?function(t,r,n,o){return $o.registerOrQueueModule(t,r,n,o,wr,Tue)}:function(){return!1};let rf=null,Si=null;function xue(e){const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}const SU=(function(){if($o&&typeof $o.collectCandidateScopes=="function")try{const t=$o.collectCandidateScopes(wr);if(Array.isArray(t)&&t.length)return t}catch{}return xue(wr)})(),vU=(function(){const t=[];function r(n,o){if(typeof n!="function")return;t.some(i=>i&&i.fn===n)||t.push({fn:n,scope:o||null})}if($o&&(typeof $o.structuredClone=="function"&&r($o.structuredClone,$o),typeof $o.getStructuredClone=="function"))try{const n=$o.getStructuredClone();r(n,$o)}catch{}for(let n=0;n<SU.length;n+=1){const o=SU[n];if(!o||typeof o!="object"&&typeof o!="function")continue;const a=o.structuredClone;typeof a=="function"&&r(a,o)}return t})();let BE=null;function kue(e){if(BE)try{const t=BE;return{success:!0,value:t.scope?t.fn.call(t.scope,e):t.fn(e)}}catch{BE=null}for(let t=0;t<vU.length;t+=1){const r=vU[t];if(!(!r||typeof r.fn!="function"))try{const n=r.scope?r.fn.call(r.scope,e):r.fn(e);return BE=r,{success:!0,value:n}}catch{}}return{success:!1,value:null}}function XM(e){if(e===null||typeof e>"u")return e;const t=kue(e);if(t.success)return t.value;if(bU)try{const r=bU(e);if(r!==e||e===null||typeof e!="object")return r}catch{}try{return UP(e)}catch{}return Array.isArray(e)?e.slice():typeof e=="object"?{...e}:e}function Qr(e){return e.map(t=>{const r=normalizeAutoGearItem(t);return r?{...r}:null}).filter(Boolean)}function eL(e){return!e||typeof e!="object"?{id:"",name:"",category:"",quantity:0,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:"",contextNotes:[]}:{id:typeof e.id=="string"?e.id:"",name:typeof e.name=="string"?e.name:"",category:typeof e.category=="string"?e.category:"",quantity:normalizeAutoGearQuantity(e.quantity),screenSize:typeof e.screenSize=="string"?e.screenSize:"",selectorType:typeof e.selectorType=="string"?e.selectorType:"none",selectorDefault:typeof e.selectorDefault=="string"?e.selectorDefault:"",selectorEnabled:!!e.selectorEnabled,selectorContext:typeof e.selectorContext=="string"?e.selectorContext:"",notes:typeof e.notes=="string"?e.notes:"",contextNotes:Array.isArray(e.contextNotes)?e.contextNotes.filter(Boolean):[]}}function JM(e){return!e||typeof e!="object"?null:{id:typeof e.id=="string"?e.id:"",label:typeof e.label=="string"?e.label:"",always:!!e.always,scenarios:Array.isArray(e.scenarios)?e.scenarios.slice():[],mattebox:Array.isArray(e.mattebox)?e.mattebox.slice():[],cameraHandle:Array.isArray(e.cameraHandle)?e.cameraHandle.slice():[],viewfinderExtension:Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.slice():[],videoDistribution:Array.isArray(e.videoDistribution)?e.videoDistribution.slice():[],camera:Array.isArray(e.camera)?e.camera.slice():[],monitor:Array.isArray(e.monitor)?e.monitor.slice():[],tripodHeadBrand:Array.isArray(e.tripodHeadBrand)?e.tripodHeadBrand.slice():[],tripodBowl:Array.isArray(e.tripodBowl)?e.tripodBowl.slice():[],tripodTypes:Array.isArray(e.tripodTypes)?e.tripodTypes.slice():[],tripodSpreader:Array.isArray(e.tripodSpreader)?e.tripodSpreader.slice():[],crewPresent:Array.isArray(e.crewPresent)?e.crewPresent.slice():[],crewAbsent:Array.isArray(e.crewAbsent)?e.crewAbsent.slice():[],wireless:Array.isArray(e.wireless)?e.wireless.slice():[],motors:Array.isArray(e.motors)?e.motors.slice():[],controllers:Array.isArray(e.controllers)?e.controllers.slice():[],distance:Array.isArray(e.distance)?e.distance.slice():[],shootingDays:normalizeAutoGearShootingDaysCondition(e.shootingDays),add:Array.isArray(e.add)?e.add.map(eL):[],remove:Array.isArray(e.remove)?e.remove.map(eL):[]}}function Ub(e){return Array.isArray(e)?e.map(JM).filter(Boolean):[]}function il(e){if(!Array.isArray(e)){rf=null;return}rf=Ub(e)}function LY(e,t,r){const n=(o,a)=>o.map(i=>{let s=normalizeAutoGearQuantity(i.quantity);if(t.forEach(c=>{const u=r.get(c);if(!u)return;const f=u[a].find(d=>d.name===i.name&&d.category===i.category);f&&(s-=normalizeAutoGearQuantity(f.quantity))}),s=Math.max(s,0),s<=0)return null;const l=normalizeAutoGearItem(i);return l?{...l,quantity:s}:null}).filter(Boolean);return{add:n(e.add,"add"),remove:n(e.remove,"remove")}}function vS(e){return typeof e!="string"?[]:e.split(",").map(t=>t.trim()).filter(Boolean)}function RY(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=vS(e&&e.cameraHandle),n=new Set(r),o=[];if(typeof document<"u"){const s=document.getElementById("cameraHandle");s&&Array.from(s.options||[]).forEach(l=>{const c=typeof l.value=="string"?l.value.trim():"";c&&o.push(c)})}const a=Array.from(new Set(r.concat(o).map(s=>typeof s=="string"?s.trim():"").filter(Boolean)));if(!a.length)return[];const i=[];return a.forEach(s=>{const l=s.trim();if(!l)return;let c,u;if(n.has(l)){c=r.filter(g=>g!==l);const p={...e,cameraHandle:c.join(", ")},h=generateGearListHtml({...p,requiredScenarios:""}),m=parseGearTableForAutoRules(h);if(!m)return;u=diffGearTableMaps(m,t)}else{c=r.slice(),c.push(l);const p={...e,cameraHandle:c.join(", ")},h=generateGearListHtml({...p,requiredScenarios:""}),m=parseGearTableForAutoRules(h);if(!m)return;u=diffGearTableMaps(t,m)}if(!u||!u.add.length&&!u.remove.length)return;const f=Array.isArray(u.add)?Qr(u.add):[],d=Array.isArray(u.remove)?Qr(u.remove):[];!f.length&&!d.length||i.push({id:generateAutoGearId("rule"),label:l,scenarios:[],mattebox:[],cameraHandle:[l],viewfinderExtension:[],videoDistribution:[],add:f,remove:d})}),i}function TY(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=vS(e&&e.viewfinderExtension);if(!r.length)return[];const n=Array.from(new Set(r)),o=[];return n.forEach(a=>{const i=a.trim();if(!i)return;const s=r.filter(h=>h!==i),l={...e,viewfinderExtension:s.join(", ")},c=generateGearListHtml({...l,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;const f=diffGearTableMaps(u,t);if(!f.add.length&&!f.remove.length)return;const d=Qr(f.add);if(!d.length)return;const p=Qr(f.remove);o.push({id:generateAutoGearId("rule"),label:wY(i),scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[i],videoDistribution:[],add:d,remove:p})}),o}function Iue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=typeof batterySelect<"u"?batterySelect:document.getElementById("battery");if(!r||!r.options)return[];const n=[];if(Array.from(r.options).forEach(i=>{const s=typeof i.value=="string"?i.value.trim():"";s&&s!=="None"&&n.push(s)}),!n.length)return[];const o=e&&typeof e.battery=="string"?e.battery.trim():"",a=[];return n.forEach(i=>{let s,l;if(i===o){s={...e,battery:""};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(u,t)}else{s={...e,battery:i};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(t,u)}!l||!l.add.length&&!l.remove.length||a.push({id:generateAutoGearId("rule"),label:`Battery: ${i}`,scenarios:[],battery:[i],add:Qr(l.add),remove:Qr(l.remove)})}),a}function Pue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=typeof distanceSelect<"u"?distanceSelect:document.getElementById("distance");if(!r||!r.options)return[];const n=[];if(Array.from(r.options).forEach(i=>{const s=typeof i.value=="string"?i.value.trim():"";s&&s!=="None"&&n.push(s)}),!n.length)return[];const o=e&&typeof e.distance=="string"?e.distance.trim():"",a=[];return n.forEach(i=>{let s,l;if(i===o){s={...e,distance:""};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(u,t)}else{s={...e,distance:i};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(t,u)}!l||!l.add.length&&!l.remove.length||a.push({id:generateAutoGearId("rule"),label:`Distance: ${i}`,scenarios:[],distance:[i],add:Qr(l.add),remove:Qr(l.remove)})}),a}function Bue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=typeof hotswapSelect<"u"?hotswapSelect:document.getElementById("hotswap");if(!r||!r.options)return[];const n=[];if(Array.from(r.options).forEach(i=>{const s=typeof i.value=="string"?i.value.trim():"";s&&s!=="None"&&n.push(s)}),!n.length)return[];const o=e&&typeof e.hotswap=="string"?e.hotswap.trim():"",a=[];return n.forEach(i=>{let s,l;if(i===o){s={...e,hotswap:""};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(u,t)}else{s={...e,hotswap:i};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(t,u)}!l||!l.add.length&&!l.remove.length||a.push({id:generateAutoGearId("rule"),label:`Hotswap: ${i}`,scenarios:[],hotswap:[i],add:Qr(l.add),remove:Qr(l.remove)})}),a}function Gue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=typeof batteryPlateSelect<"u"?batteryPlateSelect:document.getElementById("batteryPlate");if(!r||!r.options)return[];const n=[];if(Array.from(r.options).forEach(i=>{const s=typeof i.value=="string"?i.value.trim():"";s&&s!=="None"&&n.push(s)}),!n.length)return[];const o=e&&typeof e.batteryPlate=="string"?e.batteryPlate.trim():"",a=[];return n.forEach(i=>{let s,l;if(i===o){s={...e,batteryPlate:""};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(u,t)}else{s={...e,batteryPlate:i};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(t,u)}!l||!l.add.length&&!l.remove.length||a.push({id:generateAutoGearId("rule"),label:`Battery Plate: ${i}`,scenarios:[],batteryPlate:[i],add:Qr(l.add),remove:Qr(l.remove)})}),a}function Mue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=typeof cageSelect<"u"?cageSelect:document.getElementById("cage");if(!r||!r.options)return[];const n=[];if(Array.from(r.options).forEach(i=>{const s=typeof i.value=="string"?i.value.trim():"";s&&s!=="None"&&n.push(s)}),!n.length)return[];const o=e&&typeof e.cage=="string"?e.cage.trim():"",a=[];return n.forEach(i=>{let s,l;if(i===o){s={...e,cage:""};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(u,t)}else{s={...e,cage:i};const c=generateGearListHtml({...s,requiredScenarios:""}),u=parseGearTableForAutoRules(c);if(!u)return;l=diffGearTableMaps(t,u)}!l||!l.add.length&&!l.remove.length||a.push({id:generateAutoGearId("rule"),label:`Cage: ${i}`,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],cage:[i],add:Qr(l.add),remove:Qr(l.remove)})}),a}function _ue(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=e&&typeof e.tripodHeadBrand=="string"?e.tripodHeadBrand.trim():"",n=e&&typeof e.tripodBowl=="string"?e.tripodBowl.trim():"",o=[];if(r&&n&&r!=="None"&&n!=="None"){const s={...e,tripodHeadBrand:"",tripodBowl:""},l=generateGearListHtml({...s,requiredScenarios:""}),c=parseGearTableForAutoRules(l);if(c){const u=diffGearTableMaps(c,t);(u.add.length||u.remove.length)&&o.push({id:generateAutoGearId("rule"),label:`Tripod Head: ${r} (${n})`,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],tripodHeadBrand:[r],tripodBowl:[n],add:Qr(u.add),remove:Qr(u.remove)})}}const a=e&&typeof e.tripodSpreader=="string"?e.tripodSpreader.trim():"";if(a&&a!=="None"){const s={...e,tripodSpreader:""},l=generateGearListHtml({...s,requiredScenarios:""}),c=parseGearTableForAutoRules(l);if(c){const u=diffGearTableMaps(c,t);(u.add.length||u.remove.length)&&o.push({id:generateAutoGearId("rule"),label:`Tripod Spreader: ${a}`,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],tripodSpreader:[a],add:Qr(u.add),remove:Qr(u.remove)})}}const i=vS(e&&e.tripodTypes);return i.forEach(s=>{const l=i.filter(d=>d!==s),c={...e,tripodTypes:l.join(", ")},u=generateGearListHtml({...c,requiredScenarios:""}),f=parseGearTableForAutoRules(u);if(f){const d=diffGearTableMaps(f,t);(d.add.length||d.remove.length)&&o.push({id:generateAutoGearId("rule"),label:`Tripod Type: ${s}`,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],tripodTypes:[s],add:Qr(d.add),remove:Qr(d.remove)})}}),o}function ZM(e={}){const t=typeof e.tripodHeadBrand=="string"?e.tripodHeadBrand.trim():"",r=typeof e.tripodBowl=="string"?e.tripodBowl.trim():"";if(!t||!r)return[];const n=normalizeAutoGearTriggerValue(t),o=normalizeAutoGearTriggerValue(r);if(!n||!o)return[];const i=[{brand:"O'Connor",entries:[{bowl:"100mm bowl",item:"O'Connor Ultimate 1040 Fluid-Head 100mm bowl"},{bowl:"150mm bowl",item:"O'Connor Ultimate 2560 Fluid-Head 150mm bowl"},{bowl:"Mitchell Mount",item:"O'Connor Ultimate 2560 Fluid-Head Mitchell Mount"}]},{brand:"Sachtler",entries:[{bowl:"75mm bowl",item:"Sachtler aktiv8 head 75mm bowl"},{bowl:"100mm bowl",item:"Sachtler aktiv18T head 100mm bowl"},{bowl:"150mm bowl",item:"Sachtler Cine 30 head 150mm bowl"},{bowl:"Mitchell Mount",item:"Sachtler Cine 30 head Mitchell mount"}]}].find(l=>normalizeAutoGearTriggerValue(l.brand)===n);if(!i)return[];const s=i.entries.filter(l=>normalizeAutoGearTriggerValue(l.bowl)===o);return s.length?s.map(l=>{const c=l.item,u=["Tripod preferences"];return{id:generateAutoGearId("rule"),label:`Tripod head: ${c}`,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],camera:[],monitor:[],tripodHeadBrand:[i.brand],tripodBowl:[l.bowl],tripodTypes:[],tripodSpreader:[],crewPresent:[],crewAbsent:[],wireless:[],motors:[],controllers:[],distance:[],add:[{id:generateAutoGearId("item"),name:c,category:"Grip",quantity:1,screenSize:"",selectorType:"tripodHeadBrand",selectorDefault:c,selectorEnabled:!0,notes:"",contextNotes:u}],remove:[]}}):[]}function e_(e,t){if(!t||typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const r=vS(e&&e.videoDistribution);if(!r.length)return[];const n=Array.from(new Set(r)),o=[];return n.forEach(a=>{const i=a.trim();if(!i)return;const s=i.toLowerCase();if(s==="__none__"||s==="none")return;const l=r.filter(m=>m!==i),c={...e,videoDistribution:l.join(", ")},u=generateGearListHtml({...c,requiredScenarios:""}),f=parseGearTableForAutoRules(u);if(!f)return;const d=diffGearTableMaps(f,t);if(!d.add.length&&!d.remove.length)return;const p=Qr(d.add);if(!p.length)return;const h=Qr(d.remove);o.push({id:generateAutoGearId("rule"),label:HP(i),scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[i],add:p,remove:h})}),o}function OY(){const e=typeof monitorSelect<"u"?monitorSelect:null;if(!e||!e.options)return[];const t=[],r=new Set;if(Array.from(e.options).forEach(a=>{if(!a)return;const i=typeof a.value=="string"?a.value.trim():"";if(!i||i==="None")return;const s=typeof a.textContent=="string"?a.textContent.trim():"";if(!s)return;const l=normalizeAutoGearTriggerValue(s);!l||r.has(l)||(r.add(l),t.push(s))}),!t.length)return[];const n=typeof texts=="object"&&texts&&(texts[currentLang]&&texts[currentLang].autoGearMonitorLabel||texts.en&&texts.en.autoGearMonitorLabel)||"Onboard monitors",o=n;return[{id:generateAutoGearId("rule"),label:n,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],camera:[],monitor:t.slice(),crewPresent:[],crewAbsent:[],wireless:[],motors:[],controllers:[],distance:[],add:[{id:generateAutoGearId("item"),name:'ULCS Arm mit 3/8" und 1/4" double',category:"Rigging",quantity:1,contextNotes:[o]}],remove:[]}]}const Due="ARRI K2.74000.0 VEB-3 Viewfinder Extension Bracket",Nue="Camera Support";function Fue(e){if(typeof generateAutoGearId!="function")return null;const t=Array.isArray(e)?e.filter(r=>typeof r=="string"&&r.trim()):[];return{id:generateAutoGearId("item"),name:Due,category:Nue,quantity:1,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:"",contextNotes:t.map(r=>r.trim())}}function jue(){const e=[],t=devices&&typeof devices=="object"?devices.cameras:null;return!t||typeof t!="object"||Object.keys(t).forEach(r=>{if(!r)return;const n=t[r],o=n&&typeof n.brand=="string"?n.brand:"";/arri/i.test(o||r)&&e.push(r)}),e}function EU(e){if(!e||typeof e!="object")return null;const t=Fue(e.contextNotes||[]);if(!t)return null;const r=Array.isArray(e.camera)?e.camera.filter(Boolean):[];return{id:generateAutoGearId("rule"),label:typeof e.label=="string"&&e.label.trim()?e.label.trim():"ARRI viewfinder extension support",scenarios:Array.isArray(e.scenarios)?e.scenarios.filter(Boolean):[],mattebox:[],cameraHandle:[],viewfinderExtension:Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.filter(Boolean):[],deliveryResolution:[],videoDistribution:[],camera:r,monitor:[],tripodHeadBrand:[],tripodBowl:[],tripodTypes:[],tripodSpreader:[],crewPresent:[],crewAbsent:[],wireless:[],motors:[],controllers:[],distance:[],shootingDays:null,add:[t],remove:[]}}function t_(e={}){const t=jue();if(!t.length)return[];const r=e&&typeof e.viewfinderExtension=="string"?e.viewfinderExtension.trim():"",a=(e&&typeof e.requiredScenarios=="string"?e.requiredScenarios.split(",").map(s=>typeof s=="string"?s.trim():"").filter(Boolean):[]).map(s=>normalizeAutoGearTriggerValue(s)).filter(Boolean).includes(normalizeAutoGearTriggerValue("Slider")),i=[];if(r){const s=wY(r),l=EU({label:`${s||r}  ARRI viewfinder support`,viewfinderExtension:[r],camera:t.slice(),contextNotes:["ARRI viewfinder extension support"]});l&&i.push(l)}if(a&&!r){const s=EU({label:"Slider  ARRI viewfinder extension support",scenarios:["Slider"],camera:t.slice(),contextNotes:["Slider scenario"]});s&&i.push(s)}return i}function r_(e={}){if(typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const t=document.getElementById("videoDistribution");if(!t)return[];const r=[],n=new Set;if(Array.from(t.options||[]).forEach(u=>{if(!u)return;const f=typeof u.value=="string"?u.value.trim():"",d=hU(f);!d||d==="__none__"||n.has(d)||(n.add(d),r.push(f))}),!r.length)return[];const o={...e||{}};delete o.videoDistribution;const a=generateGearListHtml({...o,requiredScenarios:""}),i=parseGearTableForAutoRules(a);if(!i)return[];const s=[],l=new Set;if(r.forEach(u=>{const f=typeof u=="string"?u.trim():"";if(!f)return;const d=hU(f);if(!d||l.has(d))return;l.add(d);const p={...e||{},videoDistribution:f},h=generateGearListHtml({...p,requiredScenarios:""}),m=parseGearTableForAutoRules(h);if(!m)return;const g=diffGearTableMaps(i,m),S=Qr(g.add),y=Qr(g.remove);!S.length&&!y.length||s.push({id:generateAutoGearId("rule"),label:HP(f),scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[f],add:S,remove:y})}),r.some(u=>u&&u.toLowerCase()==="ios video")){const u=r.find(p=>p&&p.toLowerCase()==="ios video")||"IOS Video",f=normalizeAutoGearTriggerValue(u);if(!s.some(p=>Array.isArray(p.videoDistribution)&&p.videoDistribution.some(h=>normalizeAutoGearTriggerValue(h)===f))){const p=new Set,h=(y,E,L=1)=>{if(!y||!E||L<=0)return null;const v=`${y}|${E}`;return p.has(v)?null:(p.add(v),{id:generateAutoGearId("item"),name:y,category:E,quantity:L,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:""})},m=[],g=devices&&typeof devices=="object"?devices.iosVideo:null;if(g&&typeof g=="object"&&Object.keys(g).forEach(y=>{const E=h(y,"Monitoring");E&&m.push(E)}),!m.length){const y=h("Teradek - Link AX WifiRouter/Access Point","Monitoring");y&&m.push(y)}const S=(y,E,L=1)=>{const v=h(y,E,L);v&&m.push(v)};S("Apple iPad Air 5 or better","Monitoring",1),S("USB-C Charger (iOS Video)","Monitoring support",2),S("Wi-Fi Router (iOS Video Village)","Monitoring support"),m.length&&s.push({id:generateAutoGearId("rule"),label:HP(u),scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[u],add:m,remove:[]})}}return s}function n_(){return[]}function Hue(e={}){if(typeof generateGearListHtml!="function"||typeof parseGearTableForAutoRules!="function")return[];const t=document.getElementById("mattebox");if(!t)return[];const r=[],n=new Set;if(Array.from(t.options||[]).forEach(c=>{if(!c)return;const u=typeof c.value=="string"?c.value.trim():"",f=yU(u);!f||f==="__none__"||n.has(f)||(n.add(f),r.push(u))}),!r.length)return[];const o={...e||{}};delete o.mattebox;const a=generateGearListHtml({...o,requiredScenarios:""}),i=parseGearTableForAutoRules(a);if(!i)return[];const s=[],l=new Set;return r.forEach(c=>{const u=typeof c=="string"?c.trim():"";if(!u)return;const f=yU(u);if(!f||l.has(f))return;l.add(f);const d={...e||{},mattebox:u},p=generateGearListHtml({...d,requiredScenarios:""}),h=parseGearTableForAutoRules(p);if(!h)return;const m=diffGearTableMaps(i,h),g=Qr(m.add),S=Qr(m.remove);!g.length&&!S.length||s.push({id:generateAutoGearId("rule"),label:vue(u),scenarios:[],mattebox:[u],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],add:g,remove:S})}),s}function xY(){let e=null,t=null;try{typeof AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS<"u"&&AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS&&typeof AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"&&(e=AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS)}catch{}!e&&wr&&typeof wr.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"&&(e=wr.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS);try{typeof AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP<"u"&&AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP&&typeof AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"&&(t=AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP)}catch{}return!t&&wr&&typeof wr.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"&&(t=wr.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP),{groups:e&&typeof e=="object"?e:null,motorMap:t&&typeof t=="object"?t:null}}function Uue(e){if(!e)return null;const t=xY();if(!t.groups)return null;const r=normalizeAutoGearTriggerValue(e);if(!r)return null;let n=null;if(t.motorMap&&Object.prototype.hasOwnProperty.call(t.motorMap,r)?n=t.motorMap[r]:Object.prototype.hasOwnProperty.call(t.groups,r)&&(n=r),!n||!t.groups[n])return null;const o=t.groups[n];return!o||!Array.isArray(o.options)||!o.options.length?null:{key:n,group:o}}function zue(){const e=[];if(!devices||typeof devices!="object")return e;const t=devices.video&&typeof devices.video=="object"?devices.video:null;return t&&Object.keys(t).forEach(r=>{!r||r==="None"||e.includes(r)||e.push(r)}),e}function $ue(e){if(!xY().groups)return[];const r=typeof Lg=="function"?Lg():null,n=[];r&&Array.isArray(r.motors)&&n.push(...r.motors),e&&Array.isArray(e.motorSelections)&&n.push(...e.motorSelections),e&&Array.isArray(e.motors)&&n.push(...e.motors);const o=n.map(c=>typeof c=="string"?c.trim():"").filter(c=>c&&c!=="None").map(c=>({name:c,normalized:normalizeAutoGearTriggerValue(c)})).filter(c=>c.normalized);if(!o.length)return[];let a="";if(r&&typeof r.video=="string"&&(a=r.video.trim()),!a&&e&&typeof e.wirelessSelection=="string"&&(a=e.wirelessSelection.trim()),!a||a==="None")return[];const i=[],s=new Set;if(o.forEach(c=>{const u=Uue(c.normalized);if(!u||s.has(u.key))return;s.add(u.key);const f=u.group,d=Array.isArray(f.options)?f.options.filter(Boolean):[];if(!d.length)return;const p=typeof f.defaultOption=="string"&&f.defaultOption?f.defaultOption:d[0],h=[];f.label&&h.push(f.label),Array.isArray(f.motors)&&f.motors.length&&h.push(`Compatible motors: ${f.motors.join(", ")}`),i.push({id:generateAutoGearId("item"),name:p,category:"LDS (FIZ)",quantity:1,screenSize:"",selectorType:"fizHandUnit",selectorDefault:p,selectorEnabled:!0,selectorContext:u.key,notes:"",contextNotes:h})}),!i.length)return[];const l=zue();return l.length||l.push(a),[{id:generateAutoGearId("rule"),label:"FIZ hand units",scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],camera:[],monitor:[],wireless:l,motors:[AUTO_GEAR_ANY_MOTOR_TOKEN],controllers:[],distance:[],add:i,remove:[]}]}function kY(){if(typeof Lg!="function")return null;const e=Lg();if(!(Array.isArray(e?.motors)?e.motors.filter(a=>typeof a=="string"&&a&&a!=="None"):[]).length)return null;const r=(a,i,s=1)=>!a||!i||s<=0?null:{id:generateAutoGearId("item"),name:a,category:i,quantity:s,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:""},n=[],o=(a,i,s=1)=>{const l=r(a,i,s);l&&n.push(l)};return o('Avenger C-Stand Sliding Leg 20" (Focus)',"Grip"),o("Steelfingers Wheel C-Stand 3er Set (Focus)","Grip"),o("Lite-Tite Swivel Aluminium Umbrella Adapter (Focus)","Grip"),o("Tennis ball","Grip",3),o("D-Tap to Mini XLR 3-pin Cable 0,3m (Focus)","Monitoring support",2),o("Ultraslim BNC Cable 0.3 m (Focus)","Monitoring support",2),o("Bebob V150micro (V-Mount) (Focus)","Monitoring Batteries",3),n.length?{id:generateAutoGearId("rule"),label:"FIZ motor support kit",scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],deliveryResolution:[],videoDistribution:[],camera:[],monitor:[],crewPresent:[],crewAbsent:[],wireless:[],motors:[AUTO_GEAR_ANY_MOTOR_TOKEN],controllers:[],distance:[],add:n,remove:[]}:null}function IY(){const e=(n,o,a=1,i={})=>!n||!o||a<=0?null:{id:generateAutoGearId("item"),name:n,category:o,quantity:a,screenSize:typeof i.screenSize=="string"?i.screenSize:"",selectorType:typeof i.selectorType=="string"?i.selectorType:"none",selectorDefault:typeof i.selectorDefault=="string"?i.selectorDefault:"",selectorEnabled:i.selectorEnabled===!0,notes:typeof i.notes=="string"?i.notes:""},t=[],r=(n,o,a,i)=>{const s=e(n,o,a,i);s&&t.push(s)};return[["BNC Cable 0.5 m","Monitoring support",1],["BNC Cable 1 m","Monitoring support",1],["BNC Cable 5 m","Monitoring support",1],["BNC Cable 10 m","Monitoring support",1],["BNC Drum 25 m","Monitoring support",1],["BNC Connector","Monitoring support",4],['ULCS Bracket with 1/4" to 1/4"',"Rigging",2],['ULCS Bracket with 3/8" to 1/4"',"Rigging",2],["Noga Arm","Rigging",2],["Mini Magic Arm","Rigging",2],["Cine Quick Release","Rigging",4],["SmallRig - Super lightweight 15mm RailBlock","Rigging",1],['Spigot with male 3/8" and 1/4"',"Rigging",3],["Clapper Stick","Rigging",2],["D-Tap Splitter","Rigging",2],["Magliner Senior - with quick release mount + tripod holder + utility tray + OConnor-Aufhngung","Carts and Transportation",1],["Securing Straps (25mm wide)","Carts and Transportation",10],["Loading Ramp (pair, 420kg)","Carts and Transportation",1],["Ring Fitting for Airline Rails","Carts and Transportation",20],["Power Cable Drum 25-50 m","Power",1],["Power Cable 10 m","Power",2],["Power Cable 5 m","Power",2],["Power Strip","Power",3],["Power Three Way Splitter","Power",3],["PRCD-S (Portable Residual Current Device-Safety)","Power",3]].forEach(([n,o,a])=>r(n,o,a)),t.length?{id:generateAutoGearId("rule"),label:"Always",always:!0,scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],videoDistribution:[],camera:[],monitor:[],wireless:[],motors:[],controllers:[],distance:[],add:t,remove:[]}:null}function PY(){const e=(n,o,a=1,i={})=>!n||!o||a<=0?null:{id:generateAutoGearId("item"),name:n,category:o,quantity:a,screenSize:typeof i.screenSize=="string"?i.screenSize:"",selectorType:typeof i.selectorType=="string"?i.selectorType:"none",selectorDefault:typeof i.selectorDefault=="string"?i.selectorDefault:"",selectorEnabled:i.selectorEnabled===!0,notes:typeof i.notes=="string"?i.notes:""},t=[],r=(n,o,a,i)=>{const s=e(n,o,a,i);s&&t.push(s)};return r("Bluestar eye leather made of microfiber oval, large","Consumables",4),r("Pro Gaff Tape","Consumables",2,{notes:"Primary color roll"}),r("Pro Gaff Tape","Consumables",2,{notes:"Secondary color roll"}),r("Clapper Stick","Rigging",4),r("Kimtech Wipes","Consumables",2),r('Sprigs Red 1/4"',"Consumables",1),t.length?{id:generateAutoGearId("rule"),label:"Every 5 shooting days",scenarios:[],mattebox:[],cameraHandle:[],viewfinderExtension:[],deliveryResolution:[],videoDistribution:[],camera:[],monitor:[],crewPresent:[],crewAbsent:[],wireless:[],motors:[],controllers:[],distance:[],shootingDays:{mode:"every",value:5},add:t,remove:[]}:null}function Hm(){const e=n_();if(!e.length)return!1;const t=new Set(autoGearRules.map(autoGearRuleMatteboxKey).filter(Boolean)),r=e.filter(n=>{const o=autoGearRuleMatteboxKey(n);return!o||t.has(o)?!1:(t.add(o),!0)});return r.length?(setAutoGearRules(autoGearRules.concat(r)),!0):!1}function Lg(){const e=r=>r.map(n=>n&&typeof n.value=="string"?n.value:""),t={camera:cameraSelect&&typeof cameraSelect.value=="string"?cameraSelect.value:"",monitor:monitorSelect&&typeof monitorSelect.value=="string"?monitorSelect.value:"",video:videoSelect&&typeof videoSelect.value=="string"?videoSelect.value:"",cage:cageSelect&&typeof cageSelect.value=="string"?cageSelect.value:"",distance:distanceSelect&&typeof distanceSelect.value=="string"?distanceSelect.value:"",battery:batterySelect&&typeof batterySelect.value=="string"?batterySelect.value:"",batteryPlate:batteryPlateSelect&&typeof batteryPlateSelect.value=="string"?batteryPlateSelect.value:"",hotswap:hotswapSelect&&typeof hotswapSelect.value=="string"?hotswapSelect.value:"",motors:e(motorSelects),controllers:e(controllerSelects),sliderBowl:typeof getSliderBowlValue=="function"?getSliderBowlValue():"",easyrig:typeof getEasyrigValue=="function"?getEasyrigValue():""};return Vue(t)}function Vue(e){return!e||typeof e!="object"||(e.batteryPlate=normalizeBatteryPlateValue(e.batteryPlate,e.battery)),e}function AU(e){!e||typeof e!="object"||(cameraSelect&&(setSelectValue(cameraSelect,e.camera),typeof updateBatteryPlateVisibility=="function"&&updateBatteryPlateVisibility(),typeof updateBatteryOptions=="function"&&updateBatteryOptions()),batteryPlateSelect&&setSelectValue(batteryPlateSelect,e.batteryPlate),e&&typeof e.battery=="string"&&applyBatteryPlateSelectionFromBattery(e.battery,batteryPlateSelect?batteryPlateSelect.value:""),monitorSelect&&setSelectValue(monitorSelect,e.monitor),videoSelect&&setSelectValue(videoSelect,e.video),cageSelect&&setSelectValue(cageSelect,e.cage),distanceSelect&&setSelectValue(distanceSelect,e.distance),Array.isArray(e.motors)&&e.motors.forEach((t,r)=>{motorSelects[r]&&setSelectValue(motorSelects[r],t)}),Array.isArray(e.controllers)&&e.controllers.forEach((t,r)=>{controllerSelects[r]&&setSelectValue(controllerSelects[r],t)}),batterySelect&&setSelectValue(batterySelect,e.battery),hotswapSelect&&setSelectValue(hotswapSelect,e.hotswap),typeof setSliderBowlValue=="function"&&setSliderBowlValue(e.sliderBowl),typeof setEasyrigValue=="function"&&setEasyrigValue(e.easyrig))}function SR(){if(Si||typeof collectProjectFormData!="function")return;const e=collectProjectFormData()||{};let t=XM(e);(!t||typeof t!="object")&&(t={...e});const r=requiredScenariosSelect?Array.from(requiredScenariosSelect.options||[]).map(n=>n&&typeof n.value=="string"?n.value:"").filter(n=>n):[];Si={projectFormData:t,scenarioValues:r,setupValues:Lg()}}function vR(e,t){const r=[],n=typeof generateGearListHtml=="function"&&typeof parseGearTableForAutoRules=="function",o=Array.isArray(t)?t.filter(c=>typeof c=="string"&&c):[];let a=null;if(n){const c=generateGearListHtml({...e,requiredScenarios:""});if(a=parseGearTableForAutoRules(c),a&&o.length){const u=new Map;o.forEach(h=>{const m=generateGearListHtml({...e,requiredScenarios:h}),g=parseGearTableForAutoRules(m);if(!g)return;const S=diffGearTableMaps(a,g);let y=Qr(S.add),E=Qr(S.remove);!y.length&&!E.length||(u.set(h,{add:y,remove:E}),r.push({id:generateAutoGearId("rule"),label:h,scenarios:[h],add:y,remove:E}))}),[["Handheld","Easyrig"],["Slider","Undersling mode"]].filter(h=>h.every(m=>o.includes(m))).forEach(h=>{const m=h.join(" + "),g=generateGearListHtml({...e,requiredScenarios:h.join(", ")}),S=parseGearTableForAutoRules(g);if(!S)return;const y=diffGearTableMaps(a,S),E=LY({add:Qr(y.add),remove:Qr(y.remove)},h,u);!E.add.length&&!E.remove.length||r.push({id:generateAutoGearId("rule"),label:m,scenarios:h.slice(),add:E.add,remove:E.remove})});const d=["Extreme rain","Rain Machine"];if(d.every(h=>u.has(h))){const h=[{name:"Schulz Sprayoff Micro",quantity:1,category:"Matte box + filter"},{name:"Fischer RS to D-Tap cable 0,5m",quantity:2,category:"Rigging"},{name:"Spare Disc (Schulz Sprayoff Micro)",quantity:1,category:"Matte box + filter"}].map(m=>({id:generateAutoGearId("item"),name:m.name,category:m.category,quantity:m.quantity}));r.push({id:generateAutoGearId("rule"),label:"Extreme rain + Rain Machine overlap",scenarios:d.slice(),add:[],remove:h})}}}if(a){RY(e,a).forEach(f=>r.push(f)),TY(e,a).forEach(f=>r.push(f)),e_(e,a).forEach(f=>r.push(f)),Hue(e).forEach(f=>r.push(f)),Mue(e,a).forEach(f=>r.push(f)),_ue(e,a).forEach(f=>r.push(f)),Iue(e,a).forEach(f=>r.push(f)),Pue(e,a).forEach(f=>r.push(f)),Bue(e,a).forEach(f=>r.push(f)),Gue(e,a).forEach(f=>r.push(f));const c=new Set(r.map(autoGearRuleSignature).filter(f=>typeof f=="string"&&f)),u=f=>{!Array.isArray(f)||!f.length||f.forEach(d=>{const p=autoGearRuleSignature(d);!p||c.has(p)||(r.push(d),c.add(p))})};u(r_(e)),u(OY()),u(ZM(e)),u(t_(e)),u($ue(e))}const i=kY();if(i){const c=autoGearRuleSignature(i);r.some(f=>autoGearRuleSignature(f)===c)||r.push(i)}const s=IY();s&&r.push(s);const l=PY();return l&&r.push(l),n_().forEach(c=>r.push(c)),r}function o_(){SR();const e=Si;if(!e)return null;const t=Lg(),r=hasSeededAutoGearDefaults(),n=autoGearRules.slice(),o=baseAutoGearRulesState.slice(),a=projectScopedAutoGearRules?projectScopedAutoGearRules.slice():null,i=autoGearRulesLastBackupSignature,s=autoGearRulesLastPersistedSignature,l=autoGearRulesDirtySinceBackup;try{r&&clearAutoGearDefaultsSeeded(),assignAutoGearRules([]),baseAutoGearRulesState=[],projectScopedAutoGearRules=null,autoGearRulesLastBackupSignature=i,autoGearRulesLastPersistedSignature=s,autoGearRulesDirtySinceBackup=l,AU(e.setupValues);const c=e.projectFormData||{};let u=XM(c);(!u||typeof u!="object")&&(u={...c});const f=vR(u,e.scenarioValues||[]);return f.length&&il(f),f}finally{AU(t),assignAutoGearRules(n),baseAutoGearRulesState=o.slice(),projectScopedAutoGearRules=a?a.slice():null,autoGearRulesLastBackupSignature=i,autoGearRulesLastPersistedSignature=s,autoGearRulesDirtySinceBackup=l,r&&markAutoGearDefaultsSeeded()}}function BY(){SR();const e=hasSeededAutoGearDefaults();if(autoGearRules.length){Hm()&&!e?(markAutoGearDefaultsSeeded(),il(getAutoGearRules())):rf||il(getAutoGearRules());return}if(e){Hm()&&!rf&&il(getAutoGearRules());return}const t=Si&&Si.projectFormData?{...Si.projectFormData}:collectProjectFormData?collectProjectFormData():{},r=Si&&Array.isArray(Si.scenarioValues)?Si.scenarioValues:requiredScenariosSelect?Array.from(requiredScenariosSelect.options||[]).map(o=>o&&o.value).filter(Boolean):[],n=vR(t,r);if(!n.length){Hm()&&(markAutoGearDefaultsSeeded(),il(getAutoGearRules()));return}setAutoGearRules(n),markAutoGearDefaultsSeeded(),il(n)}function GY(){const e=texts[currentLang]||texts.en||{},t=texts.en||{},r=e.autoGearResetFactoryConfirm||texts.en?.autoGearResetFactoryConfirm||"Replace your automatic gear rules with the default additions?",n=()=>{const o=e.autoGearResetFactoryExportFailed||t.autoGearResetFactoryExportFailed||"Automatic gear preset export failed. Reset cancelled.";let a={status:"skipped",reason:"empty"};if(typeof exportAutoGearPresets=="function")try{a=exportAutoGearPresets({reason:"reset-auto-gear"})||{status:"failed",reason:"unknown"}}catch(u){console.error("Failed to export automatic gear presets before reset",u),a={status:"failed",reason:"exception",error:u}}else a={status:"failed",reason:"unavailable"};if(!a||a.status==="failed"||a.status==="skipped"&&a.reason!=="empty"){typeof showNotification=="function"&&showNotification("error",o);return}const i=ensureAutoBackupBeforeDeletion("reset automatic gear rules");if(!i)return;const s=e.autoGearResetFactoryDone||t.autoGearResetFactoryDone||"Automatic gear rules restored to factory additions.",l=e.autoGearResetFactoryEmpty||t.autoGearResetFactoryEmpty||"Factory additions unavailable. Automatic gear rules cleared.",c=e.autoGearResetFactoryError||t.autoGearResetFactoryError||"Reset failed. Please try again.";try{const u=o_();if(Array.isArray(u)&&u.length){setAutoGearRules(u),markAutoGearDefaultsSeeded(),il(getAutoGearRules()),typeof showNotification=="function"&&showNotification("success",s);return}if(setAutoGearRules([]),il(null),clearAutoGearDefaultsSeeded(),Hm()){markAutoGearDefaultsSeeded(),il(getAutoGearRules()),typeof showNotification=="function"&&showNotification("success",s);return}typeof showNotification=="function"&&showNotification("info",l)}catch(u){if(console.error("Failed to reset automatic gear rules to factory additions",u),typeof showNotification=="function"&&showNotification("error",c),i&&typeof notifyAutoSaveFromBackup=="function")try{notifyAutoSaveFromBackup(c,i,"error")}catch(f){console.warn("Failed to announce automatic backup after reset failure",f)}}};if(typeof window.cineShowConfirmDialog=="function"){window.cineShowConfirmDialog({title:e.autoGearResetFactoryTitle||"Reset to Factory",message:r,confirmLabel:e.autoGearResetFactoryConfirmLabel||"Reset",cancelLabel:e.cancel||"Cancel",danger:!0,onConfirm:n});return}console.warn("Missing window.cineShowConfirmDialog for resetAutoGearRulesToFactoryAdditions")}const a_=Lue({getFactoryAutoGearRulesSnapshot:function(){return rf?Ub(rf):null},getFactoryAutoGearSeedContext:function(){if(!Si)return null;const t=XM(Si);return t&&typeof t=="object"?t:{...Si}},setFactoryAutoGearRulesSnapshot:il,cloneAutoGearItems:Qr,cloneAutoGearRuleItem:eL,cloneAutoGearRule:JM,cloneAutoGearRules:Ub,subtractScenarioContributions:LY,extractAutoGearSelections:vS,buildCameraHandleAutoRules:RY,buildViewfinderExtensionAutoRules:TY,buildVideoDistributionAutoRules:e_,buildOnboardMonitorRiggingAutoGearRules:OY,buildTripodPreferenceAutoGearRules:ZM,buildDefaultVideoDistributionAutoGearRules:r_,buildDefaultMatteboxAutoGearRules:n_,buildAutoGearAnyMotorRule:kY,buildAlwaysAutoGearRule:IY,buildFiveDayConsumablesAutoGearRule:PY,buildArriViewfinderBracketRules:t_,ensureDefaultMatteboxAutoGearRules:Hm,captureAutoGearSeedContext:SR,buildAutoGearRulesFromBaseInfo:vR,computeFactoryAutoGearRules:o_,seedAutoGearRulesFromCurrentProject:BY,resetAutoGearRulesToFactoryAdditions:GY});Oue("cineFeatureAutoGearRules",a_,{category:"feature",description:"Automatic gear rule cloning, factory defaults and seeding helpers.",replace:!0,connections:["cineModuleBase","cineModuleContext","cinePersistence"]},e=>{typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to register cineFeatureAutoGearRules module.",e)});const que=[["cineFeatureAutoGearRules",a_],["buildDefaultVideoDistributionAutoGearRules",r_],["buildVideoDistributionAutoRules",e_],["buildTripodPreferenceAutoGearRules",ZM],["cloneAutoGearItems",Qr],["cloneAutoGearRuleItem",eL],["cloneAutoGearRule",JM],["cloneAutoGearRules",Ub],["setFactoryAutoGearRulesSnapshot",il],["ensureDefaultMatteboxAutoGearRules",Hm],["captureAutoGearSeedContext",SR],["buildAutoGearRulesFromBaseInfo",vR],["buildArriViewfinderBracketRules",t_],["computeFactoryAutoGearRules",o_],["seedAutoGearRulesFromCurrentProject",BY],["resetAutoGearRulesToFactoryAdditions",GY],["factoryAutoGearRulesSnapshot",null],["factoryAutoGearSeedContext",null]];que.forEach(([e,t])=>{if(e==="factoryAutoGearRulesSnapshot"){Object.defineProperty(wr,e,{configurable:!0,get(){return rf},set(r){rf=Array.isArray(r)?Ub(r):null}});return}if(e==="factoryAutoGearSeedContext"){Object.defineProperty(wr,e,{configurable:!0,get(){return Si},set(r){Si=r&&typeof r=="object"?r:null}});return}Rue(e,t,{configurable:!0,writable:!0})});console.log(" Auto Gear Rules loaded (ESM)");const iye=Object.freeze(Object.defineProperty({__proto__:null,default:a_},Symbol.toStringTag,{value:"Module"})),MY="cinePowerPlanner_onboardingTutorial",Kue=["cameraPowerPlanner_onboardingTutorial"],CU=[MY,...Kue],_Y=`${MY}:skip`,Wue=`${_Y}=true`,DY="[data-onboarding-tour-trigger]",zP="helpOnboardingTutorialButton",wU="onboarding-tour:",Yue=2e3,$P=(()=>{const e=[typeof globalThis<"u"&&globalThis?globalThis.__CPP_ONBOARDING_WAIT_TIMEOUT_MS:void 0,typeof window<"u"&&window?window.__CPP_ONBOARDING_WAIT_TIMEOUT_MS:void 0,typeof self<"u"&&self?self.__CPP_ONBOARDING_WAIT_TIMEOUT_MS:void 0,typeof global<"u"&&global?global.__CPP_ONBOARDING_WAIT_TIMEOUT_MS:void 0];for(let t=0;t<e.length;t+=1){const r=e[t];if(r==null)continue;const n=Number(r);if(Number.isFinite(n)&&n>=0)return n}return 4e3})(),Que=4500,Xue=Math.max(($P||0)*10,$P+1e3);let Ty=null,Um=!1,cd=null,Oy=null,fu=null,tL=!1,VP=!1;const UA=[],xy=typeof WeakSet=="function"?new WeakSet:null;function pk(){VP||(VP=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn("Onboarding tour module did not become available after deferred load."))}function oc(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:null}function NY(e){const t=e||oc();if(!t)return null;try{if(t.document&&typeof t.document.addEventListener=="function")return t.document}catch{}return null}function ER(e,t){if(typeof e!="function")return;const r=t||oc();if(r&&typeof r.requestAnimationFrame=="function")try{r.requestAnimationFrame(()=>{try{e()}catch(n){}});return}catch{}setTimeout(()=>{try{e()}catch{}},32)}function Jue(e,t){const r=typeof t=="string"&&t?`${wU}${t}`:`${wU}bootstrap`;return new Promise(n=>{const o=Date.now();function a(){const i=e||oc();if(!i){n(!1);return}let s=null;try{s=i.cineEnsureDeferredScriptsLoaded}catch{s=null}if(typeof s=="function"){try{const c=s({reason:r});c&&typeof c.then=="function"?c.then(()=>n(!0)).catch(()=>n(!1)):n(!0)}catch{n(!1)}return}let l=null;try{l=i.cineDeferredScriptsReady}catch{l=null}if(l&&typeof l.then=="function"){l.then(()=>n(!0)).catch(()=>n(!1));return}if(Date.now()-o>=Yue){n(!1);return}ER(a,i)}a()})}function qP(e){if(!cd)return;const t=NY(e);if(t&&typeof t.removeEventListener=="function")try{t.removeEventListener("click",cd,!0)}catch{}cd=null}function mk(e,t){if(!t||(Um=!0,tL=!1,VP=!1,qP(e),!UA.length))return;const r=UA.slice();UA.length=0;for(let n=0;n<r.length;n+=1){const o=r[n];if(typeof o=="function")try{o(t)}catch(a){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Onboarding tour queued trigger failed after module ready.",a)}}}function FY(e,t,r){ER(()=>{try{e&&typeof e.click=="function"?e.click():t&&typeof t.start=="function"&&t.start()}catch(n){typeof console<"u"&&typeof console.warn=="function"&&console.warn("Onboarding tour trigger failed after deferred load.",n)}},r)}function Zue(e,t){if(xy&&e)try{if(xy.has(e))return;xy.add(e)}catch{}UA.push(r=>{if(xy&&e)try{xy.delete(e)}catch{}FY(e,r,t)})}function efe(e){if(Oy){const n=e||oc();if(n&&n.cineFeaturesOnboardingTour&&(mk(n,n.cineFeaturesOnboardingTour),fu)){try{fu(n.cineFeaturesOnboardingTour)}catch{}fu=null}return Oy}const t=e||oc();if(!t)return Promise.resolve(null);if(t.cineFeaturesOnboardingTour)return mk(t,t.cineFeaturesOnboardingTour),Promise.resolve(t.cineFeaturesOnboardingTour);const r=Date.now();return Oy=new Promise(n=>{fu=n;function o(){const a=e||oc();if(!a){n(null),fu=null;return}if(a.cineFeaturesOnboardingTour){mk(a,a.cineFeaturesOnboardingTour),n(a.cineFeaturesOnboardingTour),fu=null;return}if(Date.now()-r>=Xue){n(null),fu=null;return}ER(o,a)}o()}).finally(()=>{Oy=null,fu=null}),Oy}function tfe(e){return efe(e)}function i_(e){const t=oc();if(!t)return Promise.resolve(null);if(Um&&t.cineFeaturesOnboardingTour)return Promise.resolve(t.cineFeaturesOnboardingTour);if(Ty)return Ty;const r={};return Ty=Jue(t,e).catch(n=>!1).then(n=>{if(!n)return tL=!0,{moduleApi:null,reason:"deferred-load-unavailable"};tL=!1;const o=tfe(t),a=new Promise(i=>{try{setTimeout(()=>{i(r)},$P)}catch{i(r)}});return Promise.race([o,a]).then(i=>i===r?(o&&typeof o.then=="function"?o.then(s=>{s||pk()}).catch(s=>{}):pk(),{moduleApi:null,reason:"timeout-pending"}):(i||pk(),{moduleApi:i||null,reason:i?"ready":"monitor-timeout"}))}).then(n=>{const o=n&&n.moduleApi;return!o&&typeof console<"u"&&typeof console.warn=="function"&&n&&n.reason==="deferred-load-unavailable"&&console.warn("Onboarding tour module deferred scripts could not be requested."),o||null}).finally(()=>{Ty=null}),Ty}function LU(e,t){const r=t||{},n=Array.isArray(r.trueValues)?r.trueValues:[],o=Array.isArray(r.falseValues)?r.falseValues:[];if(e===!0)return!0;if(e===!1)return!1;if(typeof e=="number"){if(Number.isFinite(e)){if(e===1)return!0;if(e===0)return!1}return e}if(typeof e!="string")return e;const a=e.trim().toLowerCase();return a?n.indexOf(a)!==-1?!0:o.indexOf(a)!==-1?!1:e:e}function Fi(e){if(!e||typeof e!="object")return null;const t={...e};return Object.prototype.hasOwnProperty.call(t,"completed")&&(t.completed=LU(t.completed,{trueValues:["true","1","yes","completed","done","finished"],falseValues:["false","0","no","pending","incomplete"]})),Object.prototype.hasOwnProperty.call(t,"skipped")&&(t.skipped=LU(t.skipped,{trueValues:["true","1","yes","skipped","dismissed"],falseValues:["false","0","no","pending","incomplete"]})),t}function rfe(e){if(!e)return null;if(typeof e=="object")return Fi(e)||e;if(typeof e!="string")return null;const t=e.trim();if(!t)return null;try{const r=JSON.parse(t);if(r&&typeof r=="object")return Fi(r)||r;if(r===!0)return Fi({completed:!0})||{completed:!0};if(r===!1)return Fi({completed:!1})||{completed:!1};if(typeof r=="string"){if(r==="completed")return Fi({completed:!0})||{completed:!0};if(r==="skipped")return Fi({skipped:!0})||{skipped:!0}}}catch{}return t==="completed"?Fi({completed:!0})||{completed:!0}:t==="skipped"?Fi({skipped:!0})||{skipped:!0}:t==="true"?Fi({completed:!0})||{completed:!0}:t==="false"?Fi({completed:!1})||{completed:!1}:null}function jY(e){const t=[],r=o=>{o&&t.indexOf(o)===-1&&t.push(o)};try{if(typeof getSafeLocalStorage=="function"){const o=getSafeLocalStorage();r(o)}}catch{}typeof SAFE_LOCAL_STORAGE=="object"&&SAFE_LOCAL_STORAGE&&r(SAFE_LOCAL_STORAGE);const n=e||oc();return n&&typeof n.localStorage=="object"&&n.localStorage&&r(n.localStorage),n&&typeof n.sessionStorage=="object"&&n.sessionStorage&&r(n.sessionStorage),t}function nfe(e){const t=jY(e);for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||typeof n.getItem!="function"))try{const o=n.getItem(_Y);if(o===null||typeof o>"u")continue;if(o===!0||o==="true")return!0;if(o===!1||o==="false")return!1;try{const a=JSON.parse(o);if(a===!0||a===!1)return a}catch(a){}}catch{}}try{const r=e||oc(),n=r&&typeof r.name=="string"?r.name:"";if(n&&n.indexOf(Wue)!==-1)return!0}catch{}return null}function HY(e){const t=ofe(e),r=Fi(t)||t;return!!(r&&typeof r=="object"&&(r.completed===!0||r.skipped===!0))}function ofe(e){const t=jY(e);let r=null;if(nfe(e)===!0)return{skipped:!0,completed:!1};for(let o=0;o<t.length;o+=1){const a=t[o];if(!(!a||typeof a.getItem!="function"))for(let i=0;i<CU.length;i+=1){const s=CU[i];try{const l=a.getItem(s),c=rfe(l);if(c){const u=Fi(c)||c;if(u.completed===!0||u.skipped===!0)return u;r||(r=u)}}catch{}}}return r&&(Fi(r)||r)}function afe(e){Um||HY(e)||ER(()=>{i_("first-run")},e)}function gk(e){return e?typeof e.matches=="function"&&e.matches(DY)||typeof e.getAttribute=="function"&&e.getAttribute("data-onboarding-tour-trigger")!==null?!0:typeof e.id=="string"&&e.id===zP:!1}function ife(e,t){if(!e)return null;if(typeof e.closest=="function")try{const n=e.closest(`${DY}, #${zP}`);if(n)return n}catch{}let r=e;for(;r&&r!==t&&r!==t.documentElement;){if(gk(r))return r;r=r.parentElement||r.parentNode||null}if(gk(r))return r;if(t&&typeof t.getElementById=="function")try{const n=t.getElementById(zP);if(n&&gk(n))return n}catch{}return null}function sfe(e){if(cd||Um)return;const t=NY(e);if(!(!t||typeof t.addEventListener!="function")){cd=r=>{if(!r||r.defaultPrevented||Um||r.type!=="click")return;const n=ife(r.target,t);if(!n)return;if(HY(e)){qP(e);return}if(typeof r.preventDefault=="function"&&r.preventDefault(),typeof r.stopPropagation=="function"&&r.stopPropagation(),typeof r.stopImmediatePropagation=="function"&&r.stopImmediatePropagation(),typeof n.setAttribute=="function")try{n.setAttribute("aria-busy","true")}catch{}let o=null;function a(){if(o!==null){try{clearTimeout(o)}catch{}o=null}if(typeof n.removeAttribute=="function")try{n.removeAttribute("aria-busy")}catch{}}try{typeof setTimeout=="function"&&(o=setTimeout(a,Que))}catch{o=null}i_("ui-trigger").then(i=>{if(a(),!i){tL||Zue(n,e);return}Um=!0,qP(e),FY(n,i,e)}).catch(i=>{a(),typeof console<"u"&&typeof console.warn=="function"&&console.warn("Unable to load onboarding tour before handling trigger.",i)})};try{t.addEventListener("click",cd,!0)}catch{cd=null}}}const GE=oc();if(GE){try{GE.cineEnsureOnboardingTourLoaded=i_}catch{}sfe(GE),afe(GE)}function lfe(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const Io=lfe();function cfe(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}const ufe={freezeDeep(e){if(e&&(typeof e=="object"||typeof e=="function"))try{Object.freeze(e)}catch{}return e},exposeGlobal(e,t,r){try{const n=r||Io;if(n)return n[e]=t,!0}catch{}return!1},getModuleRegistry(){return null},registerOrQueueModule(){return!1}},nf=cfe(Io)||ufe,UY=typeof nf.freezeDeep=="function"?nf.freezeDeep:function(t){return t},ffe=typeof nf.exposeGlobal=="function"?function(t,r,n){return nf.exposeGlobal(t,r,Io,n||{})}:function(t,r){try{return Io[t]=r,!0}catch{return!1}},dfe=typeof nf.getModuleRegistry=="function"?nf.getModuleRegistry(Io):null,pfe=typeof nf.registerOrQueueModule=="function"?function(t,r,n,o){return nf.registerOrQueueModule(t,r,n,o,Io,dfe)}:function(){return!1};function KP(e){return!e||typeof e!="object"?typeof console=="object"&&console?console:null:e}function zY(e){const t=e&&typeof e=="object"?e:{},r=t.windowRef||t.window||(typeof window<"u"?window:null)||(typeof Io.window<"u"?Io.window:null),n=t.documentRef||t.document||r&&r.document||(typeof document<"u"?document:null)||Io&&Io.document||null,o=typeof t.openFallbackPrintView=="function"?t.openFallbackPrintView:function(){return!1},a=typeof t.closeAfterPrint=="function"?t.closeAfterPrint:function(){},i=typeof t.printDocumentTitle=="string"?t.printDocumentTitle:"",s=typeof t.originalDocumentTitle=="string"?t.originalDocumentTitle:n&&typeof n.title=="string"?n.title:"",l=KP(t.logger||Io&&Io.console);return{windowRef:r,documentRef:n,openFallbackPrintView:o,closeAfterPrint:a,printDocumentTitle:i,originalDocumentTitle:s,logger:l,logPrefix:typeof t.logPrefix=="string"&&t.logPrefix?t.logPrefix:"Overview print",exportLogPrefix:typeof t.exportLogPrefix=="string"&&t.exportLogPrefix?t.exportLogPrefix:"Overview PDF export"}}function hu(e,t,r,n){if(!(!e||typeof e[t]!="function"))try{typeof n<"u"?e[t](r,n):e[t](r)}catch{}}function s_(e,t){const r=zY(e),{windowRef:n,documentRef:o,openFallbackPrintView:a,closeAfterPrint:i}=r,s=t&&typeof t=="object"&&t.preferFallback===!0,l=t&&typeof t=="object"&&typeof t.reason=="string"?t.reason:"print",c=l==="export"||l==="rental-export",u=c?r.exportLogPrefix:r.logPrefix,f=r.logger;let d=0;function p(g){d+=1,g&&g.name!=="AbortError"&&hu(f,"warn",`${u}: falling back to print window.`,g);let S=!1;try{S=a()}catch(y){hu(f,"error",`${u}: fallback print window failed to open.`,y),S=!1}if(S){try{i()}catch(y){hu(f,"warn",`${u}: unable to run post-print cleanup after fallback window.`,y)}return!0}return g&&g.name!=="AbortError"&&hu(f,"error",`${u}: unable to open fallback print window.`,g),!1}function h(){if(!n||typeof n.print!="function")return!1;try{o&&r.printDocumentTitle&&(o.title=r.printDocumentTitle);const g=n.print();return g&&typeof g.then=="function"&&g.catch(S=>{d||p(S)}),!0}catch(g){return p(g)}}let m=!1;if(!m&&Io.cineFeaturePrintPreview&&typeof Io.cineFeaturePrintPreview.open=="function")try{Io.cineFeaturePrintPreview.open(),m=!0}catch(g){hu(f,"warn",`${u}: preview failed to open.`,g)}if(m||(s&&!c?(m=p(),m||(m=h())):m=h()),!m&&d===0&&(m=p()),!m&&o&&typeof o.title=="string"&&o.title===r.printDocumentTitle)try{o.title=r.originalDocumentTitle}catch(g){hu(f,"warn",`${u}: unable to restore original document title after failed print.`,g)}return m}function $Y(e){const t=zY(e);return UY({trigger(n){return s_(t,n)}})}const VY=UY({createOverviewPrintWorkflow:$Y,triggerOverviewPrintWorkflow:s_});try{pfe("cineFeaturePrint",VY,{category:"feature",description:"Print orchestration for overview exports and PDF generation.",freeze:!1,replace:!0,connections:["cineModuleBase","cineModuleContext","cineUi"]},e=>{hu(KP(Io&&Io.console),"warn","Unable to register cineFeaturePrint module.",e)})}catch(e){hu(KP(Io&&Io.console),"warn","cineFeaturePrint registration failed.",e)}const mfe=[["cineFeaturePrint",VY],["createOverviewPrintWorkflow",$Y],["triggerOverviewPrintWorkflow",s_]];mfe.forEach(([e,t])=>{ffe(e,t,{configurable:!0,writable:!0})});(function(){const e=typeof window<"u"?window:this;function t(y){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:y&&typeof y.cineModuleBase=="object"?y.cineModuleBase:null}const r=t(e)||{freezeDeep:y=>y,exposeGlobal:(y,E,L)=>{L&&(L[y]=E)},registerOrQueueModule:()=>{}},n={isOpen:!1,elements:{},preferences:{layout:"rental",sections:{project:!0,devices:!0,diagram:!0,gearList:!0,battery:!0}}};function o(y,E){const L=typeof cineCoreAppLocalizationAccessors<"u"?cineCoreAppLocalizationAccessors:typeof window<"u"?window.cineCoreAppLocalizationAccessors:null;if(L&&typeof L.getLanguageTexts=="function"){const v=typeof document<"u"&&document.documentElement&&document.documentElement.lang||"en",A=L.getLanguageTexts(v),R=y.split(".");let I=A;for(const C of R)if(I&&typeof I=="object"&&C in I)I=I[C];else return E;return I||E}return E}function a(){if(!n.elements.modal)return;const y=n.elements.modal.querySelector(".mockup-sidebar");if(!y)return;const E=y.querySelector(".mockup-sidebar-header h2");if(E&&(E.textContent=o("printPreview.title","Print & Export")),n.elements.closeBtn){n.elements.closeBtn.setAttribute("aria-label",o("printPreview.backLabel","Back"));const C=n.elements.closeBtn.querySelector(".btn-text");C&&(C.textContent=o("printPreview.backLabel","Back"))}const L=y.querySelector(".control-section:nth-child(2) .section-title");L&&(L.textContent=o("printPreview.layoutModeTitle","Layout Mode"));const v=y.querySelector('label[for="printLayoutRentalToggle"]');if(v&&v.childNodes.length>0){const C=Array.from(v.childNodes).find(k=>k.nodeType===3&&k.textContent.trim().length>0);C&&(C.textContent=o("printPreview.layoutRentalLabel","Rental Friendly"))}const A=y.querySelector(".control-section:nth-child(2) p");A&&(A.textContent=o("printPreview.layoutRentalDescription","Optimizes layout for rental by grouping items by category."));const R=y.querySelector(".control-section:nth-child(3) .section-title");if(R&&(R.textContent=o("printPreview.sectionsTitle","Sections")),Object.entries({printSectionProject:"printPreview.sectionProject",printSectionDevices:"printPreview.sectionDevices",printSectionDiagram:"printPreview.sectionDiagram",printSectionGearList:"printPreview.sectionGearList",printSectionBattery:"printPreview.sectionBattery"}).forEach(([C,k])=>{const _=y.querySelector(`#${C}`),w=_?_.closest("label")||y.querySelector(`label[for="${C}"]`):null;if(w){let x=Array.from(w.childNodes).find(G=>G.nodeType===3&&G.textContent.trim().length>0);if(!x){const G=w.querySelector("span:not(.slider)");if(G&&G.textContent.trim().length>0){G.textContent=o(k,G.textContent.trim());return}}if(x){const G=o(k,x.textContent.trim()),T=document.createElement("span");T.style.position="relative",T.style.zIndex="1",T.textContent=" "+G,x.replaceWith(T)}}}),n.elements.exportBtn){const C=n.elements.exportBtn.querySelector(".icon-glyph");n.elements.exportBtn.innerHTML="",C&&n.elements.exportBtn.appendChild(C),n.elements.exportBtn.appendChild(document.createTextNode(" "+o("printPreview.exportPdfButton","Export PDF")))}if(n.elements.printBtn){const C=n.elements.printBtn.querySelector(".icon-glyph");n.elements.printBtn.innerHTML="",C&&n.elements.printBtn.appendChild(C),n.elements.printBtn.appendChild(document.createTextNode(" "+o("printPreview.printButton","Print")))}}function i(){return typeof document>"u"?!1:(n.elements={modal:document.getElementById("printPreviewModal"),closeBtn:document.getElementById("closePrintPreviewBtn"),paper:document.getElementById("printPreviewPaper"),layoutToggle:document.getElementById("printLayoutRentalToggle"),sectionToggles:{project:document.getElementById("printSectionProject"),devices:document.getElementById("printSectionDevices"),diagram:document.getElementById("printSectionDiagram"),gearList:document.getElementById("printSectionGearList"),battery:document.getElementById("printSectionBattery")},exportBtn:document.getElementById("printPreviewExportBtn"),printBtn:document.getElementById("printPreviewPrintBtn")},!!n.elements.modal)}function s(){if(n.elements.modal){if(n.elements.closeBtn){const y=n.elements.closeBtn.cloneNode(!0);n.elements.closeBtn.parentNode.replaceChild(y,n.elements.closeBtn),n.elements.closeBtn=y,n.elements.closeBtn.addEventListener("click",h)}if(n.elements.layoutToggle&&n.elements.layoutToggle.addEventListener("change",y=>{const E=y.target.checked;n.preferences.layout=E?"rental":"standard",E?(n.elements.sectionToggles.devices&&(n.elements.sectionToggles.devices.checked=!1),n.elements.sectionToggles.diagram&&(n.elements.sectionToggles.diagram.checked=!1),n.elements.sectionToggles.battery&&(n.elements.sectionToggles.battery.checked=!0),n.elements.sectionToggles.battery&&(n.elements.sectionToggles.battery.checked=!1),n.preferences.sections.devices=!1,n.preferences.sections.diagram=!1,n.preferences.sections.battery=!1):(n.elements.sectionToggles.devices&&(n.elements.sectionToggles.devices.checked=!0),n.elements.sectionToggles.diagram&&(n.elements.sectionToggles.diagram.checked=!0),n.elements.sectionToggles.battery&&(n.elements.sectionToggles.battery.checked=!0),n.preferences.sections.devices=!0,n.preferences.sections.diagram=!0,n.preferences.sections.battery=!0),d(),f()}),Object.entries(n.elements.sectionToggles).forEach(([y,E])=>{E&&E.addEventListener("change",L=>{n.preferences.sections[y]=L.target.checked,d()})}),n.elements.printBtn){const y=n.elements.printBtn.cloneNode(!0);n.elements.printBtn.parentNode.replaceChild(y,n.elements.printBtn),n.elements.printBtn=y,n.elements.printBtn.addEventListener("click",()=>{m()})}if(n.elements.exportBtn){const y=n.elements.exportBtn.cloneNode(!0);n.elements.exportBtn.parentNode.replaceChild(y,n.elements.exportBtn),n.elements.exportBtn=y,n.elements.exportBtn.addEventListener("click",()=>{m()})}}}typeof document<"u"&&document.body&&document.body.addEventListener("click",y=>{y.target.closest("#openPrintOptionsBtn")&&(y.preventDefault(),y.stopImmediatePropagation(),p())},{capture:!0});function l(){let y=document.getElementById("overviewDeviceSection");if(!y){const R=document.querySelectorAll(".device-category");if(R.length>0){const I=document.createElement("div");return I.className="device-category-container",R.forEach(C=>{I.appendChild(C.cloneNode(!0))}),I.outerHTML}return"<p>No devices selected or overview not generated.</p>"}const E=document.createElement("div");E.className="device-category-container";const L=y.querySelectorAll(".device-category");if(L.length>0)return L.forEach(R=>{E.appendChild(R.cloneNode(!0))}),E.outerHTML;const v=Array.from(y.children);let A=null;return v.forEach(R=>{if(R.tagName==="H3"){A=document.createElement("div"),A.className="device-category";const I=document.createElement("h3");I.innerHTML=R.innerHTML,A.appendChild(I),E.appendChild(A)}else if(R.classList.contains("device-block")){if(!A){A=document.createElement("div"),A.className="device-category";const C=document.createElement("h3");C.textContent=o("categoryNames.other","Other"),A.appendChild(C),E.appendChild(A)}const I=R.cloneNode(!0);A.appendChild(I)}else R.classList.contains("device-category")&&E.appendChild(R.cloneNode(!0))}),E.outerHTML}function c(){const y=document.getElementById("heroTotalDraw")?.textContent||document.getElementById("totalPower")?.textContent||"0 W",E=document.getElementById("heroRuntime")?.textContent||document.getElementById("batteryLife")?.textContent||"",L=document.getElementById("heroBatteryCount")?.textContent||document.getElementById("batteryCount")?.textContent||"0",v=document.getElementById("batterySelect")?.selectedOptions[0]?.text||"Battery",A=document.getElementById("heroCurrent144")?.textContent||document.getElementById("totalCurrent144Elem")?.textContent||"";return`
            <div style="display: flex; gap: 15px;">
                <div style="flex: 1; background: #f0fdf4; padding: 10px; border: 1px solid #bbf7d0; border-radius: 4px;">
                    <div style="font-size: 0.8em; color: #166534; text-transform: uppercase; font-weight: bold;">${o("printPreview.generatedTotalLoad","Total Load")}</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #14532d;">${y}</div>
                    <div style="font-size: 0.8em; color: #166534;">${A?o("printPreview.generatedPeak","Peak:")+" "+A:""}</div>
                </div>
                <div style="flex: 1; background: #eff6ff; padding: 10px; border: 1px solid #bfdbfe; border-radius: 4px;">
                    <div style="font-size: 0.8em; color: #1e40af; text-transform: uppercase; font-weight: bold;">${o("printPreview.generatedEstRuntime","Est. Runtime")}</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #1e3a8a;">${E}</div>
                    <div style="font-size: 0.8em; color: #1e40af;">${o("printPreview.generatedWith","w/")} ${v}</div>
                </div>
                <div style="flex: 1; background: #fff7ed; padding: 10px; border: 1px solid #fed7aa; border-radius: 4px;">
                    <div style="font-size: 0.8em; color: #9a3412; text-transform: uppercase; font-weight: bold;">${o("printPreview.generatedDailyNeeds","Daily Needs")}</div>
                    <div style="font-size: 1.5em; font-weight: bold; color: #7c2d12;">${L} ${o("printPreview.generatedBatts","Batts")}</div>
                    <div style="font-size: 0.8em; color: #9a3412;">${o("printPreview.generatedFor12hDay","for 12h day")}</div>
                </div>
            </div>
        `}function u(y){if(!y)return;y.querySelectorAll("input, textarea").forEach(A=>{if(A.type==="hidden")return;const R=A.value;let I=R;A.type==="date"&&R&&e.cineProjectDashboard&&typeof e.cineProjectDashboard.formatDate=="function"&&(I=e.cineProjectDashboard.formatDate(R));const C=document.createElement("span");C.className="print-value",C.textContent=I,A.classList.contains("prep-start")&&C.classList.add("prep-start"),A.classList.contains("prep-end")&&C.classList.add("prep-end"),A.classList.contains("shoot-start")&&C.classList.add("shoot-start"),A.classList.contains("shoot-end")&&C.classList.add("shoot-end"),A.classList.contains("return-start")&&C.classList.add("return-start"),A.classList.contains("return-end")&&C.classList.add("return-end"),A.parentNode&&A.parentNode.replaceChild(C,A)}),y.querySelectorAll("select").forEach(A=>{const R=A.options[A.selectedIndex],I=R?R.text:"",C=document.createElement("span");C.className="print-value",C.textContent=I,A.parentNode&&A.parentNode.replaceChild(C,A)}),y.querySelectorAll("button").forEach(A=>A.remove())}function f(){const y=n.elements.paper;if(!y)return;y.innerHTML="";const E=n.preferences.layout==="rental",L=document.createElement("div");L.className="preview-header";const v=document.getElementById("setupName")?.value||"Untitled Project",A=document.getElementById("productionInput")?.value||"",R=new Date().toLocaleDateString();L.innerHTML=`
            <h1>${o("printPreview.generatedTitle","Overview")}</h1>
            <p><strong>${o("printPreview.generatedProjectNameLabel","Project Name:")}</strong> ${v}</p>
            <p><strong>${o("printPreview.generatedProductionLabel","Production:")}</strong> ${A} | <strong>${o("printPreview.generatedDateLabel","Date:")}</strong> ${R}</p>
        `,y.appendChild(L);const I=document.createElement("section");I.id="preview-section-project",I.className="print-section project-requirements-section";const C=document.getElementById("projectRequirementsOutput");if(C){const q=C.cloneNode(!0);u(q),I.appendChild(q)}else I.innerHTML="<p><em>"+o("printPreview.generatedNoProjectRequirements","No project requirements data.")+"</em></p>";y.appendChild(I);const k=document.createElement("section");if(k.id="preview-section-devices",k.className="print-section",k.innerHTML="<h2>"+o("printPreview.generatedDeviceSelectionTitle","Device Selection")+"</h2>",n.preferences.layout==="rental")k.innerHTML+=l();else{const q=document.getElementById("overviewDeviceSection");if(q)k.innerHTML+=q.innerHTML;else{const Z=document.querySelectorAll(".device-category");Z.length>0?Z.forEach(U=>{k.appendChild(U.cloneNode(!0))}):k.innerHTML+="<p>"+o("printPreview.generatedNoDevicesSelected","No devices selected.")+"</p>"}}y.appendChild(k);const _=document.createElement("section");_.id="preview-section-diagram",_.className="print-section",_.innerHTML="<h2>"+o("printPreview.generatedPowerDiagramTitle","Power Diagram")+"</h2>";const w=document.getElementById("setupDiagram");if(w){const q=w.querySelector("svg");q?_.appendChild(q.cloneNode(!0)):_.innerHTML+=w.innerHTML}y.appendChild(_);const x=document.createElement("section");x.id="preview-section-battery",x.className="print-section",x.style.marginTop="20px",x.innerHTML="<h2>"+o("printPreview.generatedPowerSummaryTitle","Power Summary")+"</h2>",x.innerHTML+=c();const G=document.getElementById("batteryComparison");if(G){const q=G.cloneNode(!0),Z=q.querySelector("h2");Z&&Z.remove(),x.appendChild(q)}y.appendChild(x);const T=document.createElement("section");T.id="preview-section-gearList",T.className="print-section gear-list-section",T.innerHTML="<h2>"+o("printPreview.generatedGearListTitle","Gear List")+"</h2>";const P=document.getElementById("gearListOutput");if(P){const q=P.cloneNode(!0);q.querySelectorAll(".gear-rental-toggle, .gear-edit-btn, button, .ui-only").forEach(U=>U.remove()),E&&(q.querySelectorAll(".gear-item").forEach(H=>{const te=H.textContent||"",re=H.getAttribute("data-gear-attributes")||"",fe=H.getAttribute("data-rental-note")||"";if(te.includes("Own Gear")||re.includes("Own Gear")||fe.includes("Own Gear")){const Te=H.nextSibling;Te&&Te.nodeName==="BR"&&Te.remove(),H.remove()}}),q.querySelectorAll("tbody.category-group, .gear-category").forEach(H=>{H.querySelectorAll(".gear-item").length>0||(H.style.display="none")})),T.appendChild(q)}let N=!1;if(typeof window.getCurrentProjectInfo=="function"&&typeof window.hasProjectInfoData=="function"){const q=window.getCurrentProjectInfo();N=window.hasProjectInfoData(q)}N&&y.appendChild(T),d()}function d(){Object.entries({project:"preview-section-project",devices:"preview-section-devices",diagram:"preview-section-diagram",gearList:"preview-section-gearList",battery:"preview-section-battery"}).forEach(([E,L])=>{const v=document.getElementById(L);v&&(v.style.display=n.preferences.sections[E]?"block":"none")})}function p(y){n.elements.modal||i(),n.elements.modal&&(y&&typeof y=="object"&&(y.layout==="rental"?(n.preferences.layout="rental",n.elements.layoutToggle?(n.elements.layoutToggle.checked=!0,n.elements.layoutToggle.dispatchEvent(new Event("change"))):(n.preferences.sections.devices=!1,n.preferences.sections.diagram=!1,n.preferences.sections.battery=!1)):y.layout==="standard"&&(n.preferences.layout="standard",n.elements.layoutToggle&&(n.elements.layoutToggle.checked=!1,n.elements.layoutToggle.dispatchEvent(new Event("change"))))),f(),typeof n.elements.modal.showModal=="function"&&(n.elements.modal.open||n.elements.modal.showModal()),n.elements.modal.classList.remove("hidden"),n.isOpen=!0,document.body.style.overflow="hidden")}function h(){n.elements.modal&&(typeof n.elements.modal.close=="function"&&n.elements.modal.open&&n.elements.modal.close(),n.elements.modal.classList.add("hidden"),n.isOpen=!1,document.body.style.overflow="")}function m(){document.body.classList.add("printing-preview"),window.print(),document.body.classList.remove("printing-preview")}const g={open:p,close:h};function S(){i()&&(s(),a())}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S()),r.registerOrQueueModule("cineFeaturePrintPreview",g,{category:"feature",description:"Print Preview Modal",connections:["cineUi"]}),r.exposeGlobal("cineFeaturePrintPreview",g)})();function qY(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}const dc=qY();function gfe(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"&&e.cineModuleBase?e.cineModuleBase:null}const sl=gfe(dc);function Od(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return e;try{return Object.freeze(e)}catch{}return e}const zb=sl&&typeof sl.safeWarn=="function"?function(t,r){try{sl.safeWarn(t,r)}catch{}if(typeof console<"u"&&console&&typeof console.warn=="function")try{typeof r>"u"?console.warn(t):console.warn(t,r)}catch{}}:function(t,r){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof r>"u"?console.warn(t):console.warn(t,r)}catch{}},RU=function(t,r){try{zb(t,r)}catch{}if(!(typeof console>"u"||!console||typeof console.error!="function"))try{typeof r>"u"?console.error(t):console.error(t,r)}catch{}};function yfe(e){const t=[],r=n=>{!n||typeof n=="function"||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)};return e&&typeof e.cineModules=="object"&&r(e.cineModules),t}function KY(e){const t=e||dc;if(!t||typeof t!="object"&&typeof t!="function")return Od({registryCount:0,descriptorCount:0,registered:0});const r=yfe(t),n=[],o=new Set;for(let s=0;s<r.length;s+=1){const l=r[s];!l||typeof l.register!="function"||typeof l.has!="function"||o.has(l)||(o.add(l),n.push(l))}if(n.length===0)return Od({registryCount:0,descriptorCount:0,registered:0});const a=[{name:"cineModuleBase",category:"infrastructure",description:"Shared helpers for module registration, freezing, and safe global exposure.",resolve(){return t.cineModuleBase||null}},{name:"cineModuleGlobals",category:"infrastructure",description:"Shared module globals for cross-script coordination.",resolve(){return t.cineModuleGlobals||null}},{name:"cineCoreShared",category:"shared",description:"Shared helpers for deterministic stringification, weights, and version markers.",resolve(){return t.cineCoreShared||null}},{name:"cinePersistence",category:"persistence",description:"Data integrity facade for storage, autosave, backups, restore, and share flows.",resolve(){return t.cinePersistence||null}},{name:"cineOffline",category:"offline",description:"Offline helpers for service worker registration and cache recovery.",resolve(){return t.cineOffline||null}},{name:"cineUi",category:"ui",description:"UI controller registry for dialogs, interactions, orchestration, and help copy.",resolve(){return t.cineUi||null}},{name:"cineFeaturePrint",category:"feature",description:"Print orchestration helpers for overview exports and fallback workflows.",resolve(){return t.cineFeaturePrint||null}},{name:"cineCoreProject",category:"domain",description:"Project intelligence helpers for derived metadata, selectors, and calculations.",resolve(){return t.cineCoreProject||null}},{name:"cineCoreGuard",category:"safety",description:"Persistence guards that preserve autosaves, presets, and backup state across workflows.",resolve(){return t.cineCoreGuard||null}},{name:"cineCoreExperience",category:"experience",description:"Experience helpers for UI orchestration, feature discovery, and presentation.",resolve(){return t.cineCoreExperience||null}},{name:"cineRuntime",category:"runtime",description:"Runtime orchestrator ensuring persistence, offline, and UI safeguards stay intact.",resolve(){return t.cineRuntime||null}}];let i=0;for(let s=0;s<a.length;s+=1){const l=a[s];let c=null;try{c=l.resolve()}catch{c=null}if(c)for(let u=0;u<n.length;u+=1){const f=n[u];try{if(f.has(l.name))continue;f.register(l.name,c,{category:l.category,description:l.description,replace:!0}),i+=1}catch{}}}return Od({registryCount:n.length,descriptorCount:a.length,registered:i})}function TU(e,t){if(!e||typeof e!="object"&&typeof e!="function")return!1;try{return Object.defineProperty(e,"__cineRuntimeIntegrity",{configurable:!0,enumerable:!1,value:t,writable:!1}),!0}catch{}try{return e.__cineRuntimeIntegrity=t,!0}catch{}return!1}function hfe(e){const t=e||dc;if(t)try{const r=t.cineRuntime;if(r&&typeof r=="object")return r}catch{}return null}function WY(e,t={}){const r=e||dc;if(!r)return null;const n=hfe(r);if(!n||typeof n.verifyCriticalFlows!="function")return null;const o=t.warnOnFailure!==!1,a=t.throwOnFailure!==!1;let i;try{i=n.verifyCriticalFlows({warnOnFailure:o})}catch(l){const c=Od({ok:!1,error:l});if(TU(r,c),o&&RU("cineRuntime.verifyCriticalFlows() threw during startup.",l),a)throw l;return c}const s=i&&typeof i=="object"?i:Od({ok:!1});if(TU(r,s),!s||s.ok!==!0){const l=s&&Array.isArray(s.missing)?JSON.stringify(s.missing):"unknown",c=new Error(`cineRuntime integrity verification failed during startup. Missing: ${l}`);if(c.details=s||null,o&&RU(c.message,c),a)throw typeof console<"u"&&console.log("INTEGRITY CHECK FAILURE DETAILS:",JSON.stringify(s,null,2)),c}return s}function bfe(e){const t=[],r=n=>{!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)};r(e),r(dc),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global);for(let n=0;n<t.length;n+=1){const o=t[n];try{const a=o&&o.cineRuntimeGuard;if(a&&typeof a=="object")return a}catch{}}return typeof module<"u"&&module&&module.exports?module.exports:null}function Sfe(e,t={}){const r=e||dc,n=KY(r),o=WY(r,t);return Od({registry:n,integrity:o})}const xd=Od({detectGlobalScope:qY,resolveRuntimeGuard:bfe,attemptRegistryBackfill:KY,verifyRuntimeIntegrity:WY,bootstrap:Sfe});if(sl&&typeof sl.registerOrQueueModule=="function")try{sl.registerOrQueueModule("cineRuntimeGuard",xd,{category:"infrastructure",description:"Runtime backfill and integrity helpers reused by the legacy entry point.",replace:!0,connections:["cineModuleBase","cineModuleGlobals","cinePersistence","cineRuntime"]},e=>zb("Unable to register cineRuntimeGuard module.",e),dc,sl.getModuleRegistry&&sl.getModuleRegistry(dc))}catch(e){zb("cineRuntimeGuard registration failed.",e)}if(sl&&typeof sl.exposeGlobal=="function")try{sl.exposeGlobal("cineRuntimeGuard",xd,dc,{configurable:!0,enumerable:!1,writable:!1})}catch(e){zb("cineRuntimeGuard could not expose global api.",e)}else try{dc.cineRuntimeGuard=xd}catch(e){zb("cineRuntimeGuard could not assign global api.",e)}typeof module<"u"&&module&&module.exports&&(module.exports=xd);var OU={};function WP(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}function ES(e){const t=[];function r(n){!n||typeof n!="object"&&typeof n!="function"||t.indexOf(n)===-1&&t.push(n)}return r(e),typeof globalThis<"u"&&r(globalThis),typeof window<"u"&&r(window),typeof self<"u"&&r(self),typeof global<"u"&&r(global),t}function vfe(e){const t=ES(e);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.cineModuleEnvironment=="object")return n.cineModuleEnvironment}return null}function Efe(e){const t=ES(e);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.cineEnvironmentBridge=="object")return n.cineEnvironmentBridge}return null}function Afe(e){const t=ES(e);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.cineModuleGlobals=="object")return n.cineModuleGlobals}return null}function yk(e){return null}const YY=WP();function Cfe(e){const t=e||YY;return t&&typeof t.cineModuleEnvironmentContext=="object"?t.cineModuleEnvironmentContext:null}const zn=Cfe(YY),wfe=zn&&typeof zn.detectGlobalScope=="function"?function(){try{return zn.detectGlobalScope()}catch{}return WP()}:WP,xU=zn&&typeof zn.getPrimaryScope=="function"?zn.getPrimaryScope():wfe(),ir=(zn&&typeof zn.getGlobalScope=="function"?zn.getGlobalScope(xU):null)||xU,On=(zn&&typeof zn.resolveModuleEnvironment=="function"?zn.resolveModuleEnvironment(ir):null)||vfe(ir),xn=(zn&&typeof zn.resolveEnvironmentBridge=="function"?zn.resolveEnvironmentBridge(ir):null)||Efe(ir),an=(zn&&typeof zn.resolveModuleGlobals=="function"?zn.resolveModuleGlobals(ir):null)||Afe(ir);function Lfe(e,t){if(!(!an||typeof an.recordModule!="function"))try{an.recordModule(e,t)}catch{}}const kU=(function(){return zn&&typeof zn.tryRequire=="function"?function(r){const n=zn.tryRequire(r);return typeof n>"u"?yk():n}:an&&typeof an.tryRequire=="function"?an.tryRequire:xn&&typeof xn.tryRequire=="function"?function(r){const n=xn.tryRequire(r);return typeof n>"u"?yk():n}:On&&typeof On.tryRequire=="function"?On.tryRequire:yk})();function Rfe(e){if(an&&typeof an.resolveModuleRegistry=="function")try{const r=an.resolveModuleRegistry(e||ir);if(r)return r}catch{}if(xn&&typeof xn.getModuleRegistry=="function")try{const r=xn.getModuleRegistry(e||ir);if(r)return r}catch{}if(On&&typeof On.resolveModuleRegistry=="function")try{return On.resolveModuleRegistry(e||ir)}catch{}const t=ES(ir);for(let r=0;r<t.length;r+=1){const n=t[r];if(n&&typeof n.cineModules=="object")return n.cineModules}return null}function Tfe(e){if(zn&&typeof zn.resolveModuleRegistry=="function")try{const t=zn.resolveModuleRegistry(e||ir);if(t)return t}catch{}return Rfe(e)}const zm=(function(){if(an&&typeof an.getModuleRegistry=="function")try{const e=an.getModuleRegistry(ir);if(e)return e}catch{}if(xn&&typeof xn.getModuleRegistry=="function")try{const e=xn.getModuleRegistry(ir);if(e)return e}catch{}if(On&&typeof On.getModuleRegistry=="function")try{const e=On.getModuleRegistry(ir);if(e)return e}catch{}return Tfe()})(),xp=(function(){if(an&&typeof an.getPendingQueueKey=="function")try{const t=an.getPendingQueueKey();if(typeof t=="string"&&t)return t}catch{}if(xn&&typeof xn.getPendingQueueKey=="function")try{const t=xn.getPendingQueueKey();if(typeof t=="string"&&t)return t}catch{}return On&&typeof On.PENDING_QUEUE_KEY=="string"?On.PENDING_QUEUE_KEY:"__cinePendingModuleRegistrations__"})();function Ofe(e){if(!e||typeof e!="object")return{};const t={},r=Object.keys(e);for(let n=0;n<r.length;n+=1){const o=r[n];t[o]=e[o]}return t}function xfe(e,t,r){if(!ir||typeof ir!="object")return!1;const n=Object.freeze({name:e,api:t,options:Object.freeze(Ofe(r))});let o=ir[xp];if(!Array.isArray(o))try{Object.defineProperty(ir,xp,{configurable:!0,enumerable:!1,writable:!0,value:[]}),o=ir[xp]}catch{try{Array.isArray(ir[xp])||(ir[xp]=[]),o=ir[xp]}catch{return!1}}try{o.push(n)}catch{o[o.length]=n}return!0}function kfe(e,t,r){if(an&&typeof an.queueModuleRegistration=="function")try{if(an.queueModuleRegistration(e,t,r,ir))return!0}catch{}if(xn&&typeof xn.queueModuleRegistration=="function")try{if(xn.queueModuleRegistration(e,t,r))return!0}catch{}return On&&typeof On.queueModuleRegistration=="function"?On.queueModuleRegistration(e,t,r,ir):xfe(e,t,r)}function hk(e,t,r,n){if(zm&&typeof zm.register=="function")try{return zm.register(e,t,r),!0}catch(o){if(typeof n=="function")try{n(o)}catch{}}return kfe(e,t,r),!1}const Ife=(function(){return an&&typeof an.registerOrQueueModule=="function"?function(r,n,o,a){try{if(an.registerOrQueueModule(r,n,o,a,ir,zm))return!0}catch{}return hk(r,n,o,a)}:xn&&typeof xn.registerOrQueueModule=="function"?function(r,n,o,a){try{if(xn.registerOrQueueModule(r,n,o,a,ir,zm))return!0}catch{}return hk(r,n,o,a)}:On&&typeof On.registerOrQueueModule=="function"?function(r,n,o,a){return On.registerOrQueueModule(r,n,o,a,ir,zm)}:hk})();function Pfe(e){if(!e||typeof process>"u"||!process)return!1;if(e===process)return!0;if(typeof e=="object"){try{if(e.constructor&&e.constructor.name==="process")return!0}catch{}if(typeof e.pid=="number"&&typeof e.nextTick=="function"&&typeof e.emit=="function"&&typeof e.binding=="function")return!0}if(typeof e=="function"){if(e===process.binding||e===process._linkedBinding||e===process.dlopen)return!0;try{const t=e.name||"";if(t&&(t==="binding"||t==="dlopen")){const r=Function.prototype.toString.call(e);if(r&&r.indexOf("[native code]")!==-1)return!0}}catch{}}return!1}function Bfe(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return!1;if(Pfe(e)||typeof process<"u"&&process&&process.release&&e===process.release)return!0;try{if(typeof e.pipe=="function"&&typeof e.unpipe=="function")return!0;if(typeof e.on=="function"&&typeof e.emit=="function"){if(typeof e.write=="function"||typeof e.read=="function")return!0;const t=e.constructor&&e.constructor.name;if(t&&/Stream|Emitter|Port/i.test(t))return!0}if(typeof Symbol<"u"&&e[Symbol.toStringTag]){const t=e[Symbol.toStringTag];if(typeof t=="string"&&/Stream|Port/i.test(t))return!0}}catch{}return!1}function Gfe(e){if(e&&typeof e.has=="function"&&typeof e.add=="function")return e;if(Array.isArray(e))return{has(r){return e.indexOf(r)!==-1},add(r){e.indexOf(r)===-1&&e.push(r)}};if(typeof WeakSet=="function")try{return new WeakSet}catch{}const t=[];return{has(r){return t.indexOf(r)!==-1},add(r){t.indexOf(r)===-1&&t.push(r)}}}function YP(e,t){if(!e||typeof e!="object"||Bfe(e))return e;if(typeof process<"u"&&process&&OU&&OU.JEST_WORKER_ID){try{typeof Object.freeze=="function"&&Object.freeze(e)}catch{}return e}const r=Gfe(t);if(r.has(e))return e;r.add(e);const n=Object.getOwnPropertyNames(e);for(let o=0;o<n.length;o+=1){const a=n[o];let i;try{i=e[a]}catch{i=void 0}!i||typeof i=="function"||typeof i!="object"&&typeof i!="function"||YP(i,r)}try{return Object.freeze(e)}catch{return e}}function rL(e){if(!e||typeof e=="function"||typeof e!="object"&&typeof e!="function")return e;let t=e;if(typeof Object.freeze=="function")try{t=Object.freeze(t)}catch{}let r=!1;if(typeof Object.isFrozen=="function")try{r=Object.isFrozen(t)}catch{r=!1}if(r)return t;try{const n=Object.getOwnPropertyNames(t);for(let o=0;o<n.length;o+=1){const a=n[o],i=Object.getOwnPropertyDescriptor(t,a);i&&(Object.prototype.hasOwnProperty.call(i,"value")?(i.configurable||i.writable)&&Object.defineProperty(t,a,{configurable:!1,enumerable:i.enumerable,writable:!1,value:i.value}):i.configurable&&Object.defineProperty(t,a,{configurable:!1,enumerable:i.enumerable,get:i.get,set:i.set}))}if(typeof Object.preventExtensions=="function")try{Object.preventExtensions(t)}catch(o){}}catch{}return t}const mc=(function(){return an&&typeof an.freezeDeep=="function"?an.freezeDeep:xn&&typeof xn.freezeDeep=="function"?function(r,n){try{return xn.freezeDeep(r,n)}catch{return YP(r,n)}}:On&&typeof On.freezeDeep=="function"?On.freezeDeep:YP})();function IU(e,t){if(!(typeof console>"u"||typeof console.warn!="function"))try{typeof t>"u"?console.warn(e):console.warn(e,t)}catch{}}const of=(function(){return an&&typeof an.safeWarn=="function"?an.safeWarn:xn&&typeof xn.safeWarn=="function"?function(r,n){try{xn.safeWarn(r,n)}catch{IU(r,n)}}:On&&typeof On.safeWarn=="function"?On.safeWarn:IU})();function bk(e,t){if(!ir||typeof ir!="object")return!1;try{return Object.defineProperty(ir,e,{configurable:!0,enumerable:!1,value:t,writable:!1}),!0}catch{try{return ir[e]=t,!0}catch{return!1}}}const Mfe=(function(){return an&&typeof an.exposeGlobal=="function"?function(r,n,o){try{return an.exposeGlobal(r,n,o)}catch{return bk(r,n)}}:xn&&typeof xn.exposeGlobal=="function"?function(r,n,o){try{return xn.exposeGlobal(r,n,o)}catch{return bk(r,n)}}:On&&typeof On.exposeGlobal=="function"?function(r,n,o){return On.exposeGlobal(r,n,ir,o)}:bk})(),Uf=new Map,zf=new Map,$f=new Map,QP=new Set;function qc(e){if(typeof e=="string"&&e.trim())return e.trim();throw new TypeError("cineUi registry names must be non-empty strings.")}function l_(e){return typeof e!="function"?null:function(){return e.apply(this,arguments)}}function _fe(e,t){if(!t||typeof t!="object")throw new TypeError(`cineUi controller "${e}" requires a descriptor object.`);const r={},n={},o=Object.getOwnPropertyNames(t);for(let c=0;c<o.length;c+=1){const u=o[c],f=t[u];if(typeof f=="function"){r[u]=l_(f);continue}if(u==="context"&&f&&typeof f=="object"){const d=Object.getOwnPropertyNames(f);for(let p=0;p<d.length;p+=1){const h=d[p];n[h]=f[h]}continue}n[u]=f}const a=Object.getOwnPropertyNames(r);if(!a.length)throw new Error(`cineUi controller "${e}" did not provide any callable actions.`);const i=Object.create(null),s=Object.getOwnPropertyNames(n);for(let c=0;c<s.length;c+=1){const u=s[c];i[u]=n[u]}rL(i);const l={};Object.defineProperty(l,"context",{configurable:!1,enumerable:!0,get(){return i}});for(let c=0;c<a.length;c+=1){const u=a[c],f=r[u];l[u]=function(){return f.apply(l,arguments)}}return rL(mc(l))}function Dfe(e,t){const r=l_(t);if(!r)throw new TypeError(`cineUi interaction "${e}" must be a function.`);return rL(mc({handler:r}))}function Nfe(e,t){const r=l_(t);if(!r)throw new TypeError(`cineUi initializer "${e}" must be a function.`);return rL(mc({initializer:r}))}function c_(e,t){const r=`${t}:${e}`;QP.has(r)||(QP.add(r),of(`cineUi ${t} "${e}" was replaced. Using the latest registration.`))}function $b(e){return Array.from(e.keys()).sort()}const Ffe=mc({register(e,t){const r=qc(e),n=_fe(r,t);return Uf.has(r)&&c_(r,"controller"),Uf.set(r,n),n},get(e){const t=qc(e);return Uf.get(t)||null},invoke(e,t,...r){const n=this.get(e);if(!n)throw new Error(`cineUi controller "${e}" is not registered.`);const o=n[t];if(typeof o!="function")throw new Error(`cineUi controller "${e}" does not expose "${t}".`);return o.apply(n,r)},list(){return $b(Uf)},has(e){const t=qc(e);return Uf.has(t)}}),jfe=mc({register(e,t){const r=qc(e),n=Dfe(r,t);return zf.has(r)&&c_(r,"interaction"),zf.set(r,n),n.handler},get(e){const t=qc(e),r=zf.get(t);return r?r.handler:null},trigger(e,...t){const r=this.get(e);if(typeof r!="function")throw new Error(`cineUi interaction "${e}" is not registered.`);return r.apply(null,t)},list(){return $b(zf)},has(e){const t=qc(e);return zf.has(t)}}),Hfe=mc({register(e,t){const r=qc(e),n=Nfe(r,t);return $f.has(r)&&c_(r,"initializer"),$f.set(r,n),n.initializer},get(e){const t=qc(e),r=$f.get(t);return r?r.initializer:null},run(e,...t){const r=this.get(e);if(typeof r!="function")throw new Error(`cineUi initializer "${e}" is not registered.`);return r.apply(null,t)},list(){return $b($f)},has(e){const t=qc(e);return $f.has(t)}});function Ufe(e){const t=[];if(typeof kU=="function"){const n=kU("./help.js");n&&typeof n=="object"&&t.push(n)}const r=ES(e);for(let n=0;n<r.length;n+=1){const o=r[n];if(o){try{const a=o.cineHelpModule;a&&t.indexOf(a)===-1&&t.push(a)}catch{}try{const a=o.cineHelp;if(a){let i=!1;for(let s=0;s<t.length;s+=1){const l=t[s];if(l===a||l&&l.help===a){i=!0;break}}i||t.push({help:a,__internal:null})}}catch{}}}for(let n=0;n<t.length;n+=1){const o=t[n];if(!o)continue;const a=o.help||o;if(a&&typeof a.register=="function"&&typeof a.get=="function"&&typeof a.resolve=="function"&&typeof a.list=="function")return!o.help&&a?{help:a,__internal:o.__internal||null}:o}for(let n=0;n<r.length;n+=1){const o=r[n];if(o)try{const a=o.__cineCreateHelpModule;if(typeof a=="function"){const i=a({freezeDeep:mc,safeWarn:of});if(i&&typeof i=="object")return i}}catch(a){of("cineUi: Failed to create help module from factory.",a)}}return null}const $m=Ufe(ir),wc=new Map,zfe=$m&&$m.help?$m.help:mc({register(e,t){const r=typeof e=="string"?e.trim():"";if(!r)throw new TypeError("cineUi registry names must be non-empty strings.");if(typeof t=="function")return wc.set(r,t),t;if(typeof t!="string")throw new TypeError(`cineUi help entry "${r}" must be a string or function.`);const n=t.trim();if(!n)throw new Error(`cineUi help entry "${r}" cannot be empty.`);const o=function(){return n};return wc.set(r,o),o},get(e){const t=typeof e=="string"?e.trim():"";if(!t)throw new TypeError("cineUi registry names must be non-empty strings.");return wc.get(t)||null},resolve(e,...t){const r=this.get(e);if(typeof r!="function")throw new Error(`cineUi help entry "${e}" is not registered.`);return r.apply(null,t)},list(){return typeof $b=="function"?$b(wc):Array.from(wc.keys()).sort()},has(e){const t=typeof e=="string"?e.trim():"";return t?wc.has(t):!1}}),Nl=$m&&$m.__internal?$m.__internal:mc({helpRegistry:wc,clearRegistries(){wc.clear()}});function $fe(){if(Uf.clear(),zf.clear(),$f.clear(),QP.clear(),Nl&&typeof Nl.clearRegistries=="function")try{Nl.clearRegistries()}catch(e){of("cineUi: Unable to clear help registry.",e)}else Nl&&Nl.helpRegistry&&typeof Nl.helpRegistry.clear=="function"&&Nl.helpRegistry.clear()}const Kd={controllers:Ffe,interactions:jfe,orchestration:Hfe,help:zfe,__internal:{controllerRegistry:Uf,interactionRegistry:zf,orchestrationRegistry:$f,helpRegistry:Nl&&Nl.helpRegistry?Nl.helpRegistry:wc,clearRegistries:$fe}};mc(Kd);Lfe("cineUi",Kd);Ife("cineUi",Kd,{category:"ui",description:"UI controller registry for dialogs, interactions, orchestration, and help copy.",replace:!0,connections:["cineModuleGlobals","cineModuleEnvironment","cineHelp","cineModuleContext"]},e=>{of("Unable to register cineUi module.",e)});if(ir&&typeof ir=="object"){let e=null;try{e=ir.cineUi||null}catch{e=null}e!==Kd&&(Mfe("cineUi",Kd,{configurable:!0,enumerable:!1,writable:!1})||of("Unable to expose cineUi globally."))}function Vfe(){if(!ir||typeof ir!="object")return;const e="__cineUiReadyQueue",t=Array.isArray(ir[e])?ir[e]:null;if(!t||t.length===0)return;const r=t.slice();t.length=0;for(let n=0;n<r.length;n+=1){const o=r[n];if(typeof o=="function")try{o(Kd)}catch(a){of("cineUi registration callback failed.",a)}}}Vfe();function qfe(){const e=[];if(ir&&typeof ir.dispatchEvent=="function"&&e.push(ir),typeof window<"u"&&window&&typeof window.dispatchEvent=="function"&&e.indexOf(window)===-1&&e.push(window),!!e.length)for(let t=0;t<e.length;t+=1){const r=e[t];let n=null;if(typeof Event=="function")try{n=new Event("cine-ui-ready")}catch{n=null}if(!n){const o=r&&r.document;if(o&&typeof o.createEvent=="function")try{const a=o.createEvent("Event");a.initEvent("cine-ui-ready",!1,!1),n=a}catch{n=null}}if(n)try{r.dispatchEvent(n)}catch(o){of("Unable to dispatch cine-ui-ready event.",o)}}}qfe();typeof module<"u"&&module&&module.exports&&(module.exports=Kd);function Kfe(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:typeof global<"u"?global:{}}var bt=Kfe();function Wfe(e){var t=[],r=[];e&&(typeof e=="object"||typeof e=="function")&&r.push(e);try{typeof CORE_GLOBAL_SCOPE<"u"&&CORE_GLOBAL_SCOPE&&r.push(CORE_GLOBAL_SCOPE)}catch{}typeof globalThis<"u"&&globalThis&&r.push(globalThis),typeof window<"u"&&window&&r.push(window),typeof self<"u"&&self&&r.push(self),typeof global<"u"&&global&&r.push(global);for(var n=0;n<r.length;n+=1){var o=r[n];if(!(!o||typeof o!="object"&&typeof o!="function"))try{var a=o.cineCoreUiHelpers;a&&typeof a=="object"&&t.push(a)}catch{}}for(var i=0;i<t.length;i+=1){var s=t[i];if(s&&typeof s=="object")return s}return{}}var nL=Wfe(bt),Yfe=typeof nL.escapeHtml=="function"?nL.escapeHtml:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},Qfe=typeof nL.setButtonLabelWithIcon=="function"?nL.setButtonLabelWithIcon:null;function Xfe(e){return typeof cineModuleBase=="object"&&cineModuleBase?cineModuleBase:e&&typeof e.cineModuleBase=="object"?e.cineModuleBase:null}var Al=Xfe(bt);if(!Al)throw new Error("cineResults: MODULE_BASE not found");var Jfe=typeof Al.getModuleRegistry=="function"?Al.getModuleRegistry(bt):null,QY=typeof Al.freezeDeep=="function"?function(t){try{return Al.freezeDeep(t)}catch{}return t}:function(t){return t},u_=typeof Al.exposeGlobal=="function"?function(t,r,n){return Al.exposeGlobal(t,r,bt,n||{})}:function(t,r){try{return bt[t]=r,!0}catch{}return!1},Zfe=typeof Al.registerOrQueueModule=="function"?function(t,r,n,o){return Al.registerOrQueueModule(t,r,n,o,bt,Jfe)}:function(){return!1},Ar=typeof Al.safeWarn=="function"?function(t,r){try{Al.safeWarn(t,r)}catch{}}:function(t,r){if(!(typeof console>"u"||!console||typeof console.warn!="function"))try{typeof r>"u"?console.warn(t):console.warn(t,r)}catch{}},we={elements:{},handlers:{},feedbackFieldCache:[],feedbackFieldCacheDoc:null,feedbackOptionFallbacks:Object.create(null),collatorCache:Object.create(null),fallbackCollator:null,sensorModeFrameRateMap:Object.create(null),allFrameRateOptions:[],selectedSensorMode:"",selectedFramerate:"",dependencies:{mailTarget:"info@lucazanner.de",document:null,window:null,navigator:null,alert:null,openDialog:null,closeDialog:null,getCurrentSetupKey:null,loadFeedback:null,saveFeedback:null,updateCalculations:null,renderFeedbackTable:null,dispatchTemperatureNoteRender:null,refreshFeedbackTemperatureLabel:null,updateFeedbackTemperatureOptions:null,refreshTotalCurrentLabels:null,updateMountVoltageSettingLabels:null,setButtonLabelWithIcon:Qfe,iconGlyphs:null,getSelectedPlate:null,getMountVoltageConfig:null,updateBatteryOptions:null,setStatusMessage:null,setStatusLevel:null,closePowerWarningDialog:null,showPowerWarningDialog:null,drawPowerDiagram:null,renderTemperatureNote:null,checkFizCompatibility:null,checkFizController:null,checkArriCompatibility:null,renderSetupDiagram:null,refreshGearListIfVisible:null,supportsBMountCamera:null,supportsGoldMountCamera:null,getCssVariableValue:null,escapeHtml:Yfe,getLastRuntimeHours:null,setLastRuntimeHours:null,getDevices:null,getTexts:null,getCurrentLang:null,getCollator:null}};function PU(e){if(!e)return we.feedbackFieldCache=[],we.feedbackFieldCacheDoc=null,we.feedbackFieldCache;for(var t=[],r=0;r<XP.length;r+=1){var n=XP[r],o=null;try{o=e.getElementById(n.id)}catch{o=null}t.push({map:n,element:o})}return we.feedbackFieldCache=t,we.feedbackFieldCacheDoc=e,t}function BU(e){if(!e)return[];if(we.feedbackFieldCacheDoc!==e||!we.feedbackFieldCache||we.feedbackFieldCache.length!==XP.length)return PU(e);for(var t=we.feedbackFieldCache,r=0;r<t.length;r+=1){var n=t[r];if(!n||!n.map)return PU(e);var o=n.element;if(!o||typeof o.isConnected=="boolean"&&!o.isConnected){var a=null;try{a=e.getElementById(n.map.id)}catch{a=null}n.element=a}}return t}var XP=[{id:"fbUsername",key:"username",trim:!0},{id:"fbDate",key:"date",trim:!1},{id:"fbLocation",key:"location",trim:!0},{id:"fbCamera",key:"camera",trim:!0},{id:"fbBatteryPlate",key:"batteryPlate",trim:!0},{id:"fbLensMount",key:"lensMount",trim:!0},{id:"fbResolution",key:"resolution",trim:!0},{id:"fbCodec",key:"codec",trim:!0},{id:"fbSensorMode",key:"sensorMode",trim:!0},{id:"fbFramerate",key:"framerate",trim:!0},{id:"fbWifi",key:"cameraWifi",trim:!1},{id:"fbFirmware",key:"firmware",trim:!0},{id:"fbBattery",key:"battery",trim:!0},{id:"fbBatteryAge",key:"batteryAge",trim:!0},{id:"fbWirelessVideo",key:"wirelessVideo",trim:!0},{id:"fbMonitor",key:"monitor",trim:!0},{id:"fbMonitorBrightness",key:"monitorBrightness",trim:!0},{id:"fbLens",key:"lens",trim:!0},{id:"fbLensData",key:"lensData",trim:!0},{id:"fbControllers",key:"controllers",trim:!0},{id:"fbMotors",key:"motors",trim:!0},{id:"fbDistance",key:"distance",trim:!0},{id:"fbTemperature",key:"temperature",trim:!0},{id:"fbCharging",key:"charging",trim:!0},{id:"fbRuntime",key:"runtime",trim:!0},{id:"fbBatteriesPerDay",key:"batteriesPerDay",trim:!0}],zA={lensMount:{elementName:"feedbackMountOptions",elementId:"mountOptions"},resolution:{elementName:"feedbackResolutionOptions",elementId:"resolutionOptions"},codec:{elementName:"feedbackCodecOptions",elementId:"codecOptions"}};function XY(){var e=we.feedbackOptionFallbacks;return(!e||typeof e!="object")&&(e=Object.create(null),we.feedbackOptionFallbacks=e),e}function ede(e){var t=[];if(!e)return t;var r=null;try{r=e.options}catch{r=null}if(r&&typeof r.length=="number"){for(var n=0;n<r.length;n+=1){var o=r[n];if(o){var a="";typeof o.value=="string"&&o.value?a=o.value:typeof o.getAttribute=="function"?a=o.getAttribute("value")||"":typeof o.textContent=="string"&&o.textContent&&(a=o.textContent),a&&t.push(a)}}return t}if(e.childNodes&&typeof e.childNodes.length=="number")for(var i=0;i<e.childNodes.length;i+=1){var s=e.childNodes[i];if(s){var l="";typeof s.value=="string"&&s.value?l=s.value:typeof s.getAttribute=="function"?l=s.getAttribute("value")||"":typeof s.textContent=="string"&&s.textContent&&(l=s.textContent),l&&t.push(l)}}return t}function oL(e,t){if(!(!e||!t)){var r=XY();r[e]||(r[e]=ede(t))}}function tde(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function rde(e,t){if(e){for(var r=Array.isArray(t)?t:[],n="",o=0;o<r.length;o+=1)n+='<option value="'+tde(r[o])+'"></option>';if(typeof e.innerHTML=="string")try{e.innerHTML=n;return}catch{}var a=null;try{a=e.ownerDocument||null}catch{a=null}if(a||(a=ns()),!(!a||typeof a.createElement!="function"||typeof e.appendChild!="function")){try{for(;e.firstChild;)e.removeChild(e.firstChild)}catch{}for(var i=0;i<r.length;i+=1){var s=null;try{s=a.createElement("option")}catch{s=null}if(s){var l=r[i];try{s.value=l}catch{typeof s.setAttribute=="function"&&s.setAttribute("value",l)}if(typeof s.textContent=="string")try{s.textContent=l}catch{}try{e.appendChild(s)}catch{}}}}}}function aL(e,t){if(we.elements[e])return we.elements[e];var r=ns();if(!r||!t)return null;var n=null;try{n=r.getElementById(t)}catch{n=null}return n&&(we.elements[e]=n),n}function nde(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function JY(e,t,r,n){if(!e)return"";for(var o=Object.create(null),a=[],i=Array.isArray(t)?t:[],s=0;s<i.length;s+=1){var l=i[s];if(l!=null){var c=String(l);if(c){var u=c.trim();u&&(Object.prototype.hasOwnProperty.call(o,u)||(o[u]=!0,a.push(u)))}}}for(var f=['<option value="">--</option>'],d=0;d<a.length;d+=1){var p=nde(a[d]);f.push('<option value="'+p+'">'+p+"</option>")}var h=f.join(""),m=!1;if(typeof e.innerHTML=="string")try{e.innerHTML=h,m=!0}catch{m=!1}if(!m){var g=null;try{g=e.ownerDocument||null}catch{g=null}if(g||(g=ns()),g&&typeof g.createElement=="function"&&typeof e.appendChild=="function"){try{for(;e.firstChild;)e.removeChild(e.firstChild)}catch{}var S=null;try{S=g.createElement("option")}catch{S=null}if(S){try{S.value=""}catch{typeof S.setAttribute=="function"&&S.setAttribute("value","")}if(typeof S.textContent=="string")try{S.textContent="--"}catch{}try{e.appendChild(S)}catch{}}for(var y=0;y<a.length;y+=1){var E=null;try{E=g.createElement("option")}catch{E=null}if(E){var L=a[y];try{E.value=L}catch{typeof E.setAttribute=="function"&&E.setAttribute("value",L)}if(typeof E.textContent=="string")try{E.textContent=L}catch{}try{e.appendChild(E)}catch{}}}}}var v=typeof r=="string"?r:"",A="";v&&a.indexOf(v)!==-1?A=v:n&&a.length&&(A=a[0]);try{e.value=A}catch{typeof e.setAttribute=="function"&&e.setAttribute("value",A)}var R=null;try{R=e.options||null}catch{R=null}if(R&&typeof R.length=="number")for(var I=0;I<R.length;I+=1){var C=R[I];if(C){var k="";try{k=typeof C.value=="string"?C.value:""}catch{k=""}var _=k===A;if(typeof C.selected=="boolean")try{C.selected=_}catch{}else if(_&&typeof C.setAttribute=="function")try{C.setAttribute("selected","selected")}catch{}else if(!_&&typeof C.removeAttribute=="function")try{C.removeAttribute("selected")}catch{}}}if(typeof e.selectedIndex=="number"&&R&&typeof R.length=="number"){for(var w=-1,x=0;x<R.length;x+=1){var G=R[x];if(G){var T="";try{T=typeof G.value=="string"?G.value:""}catch{T=""}if(T===A){w=x;break}}}try{e.selectedIndex=w}catch{}}return A}function JP(e){if(typeof e!="string")return"";var t=e.trim();return t?t.toLowerCase().replace(/\s+/g," "):""}var iL=Object.freeze([.75,1,8,12,12.5,15,23.976,24,25,29.97,30,36,40,47.952,48,50,59.94,60,72,75,80,90,96,100,110,112,120,144,150,160,168,170,180,200,240,290,300]);function ode(e){if(typeof e!="number"||!Number.isFinite(e))return e;for(var t=.05,r=e,n=t+1,o=0;o<iL.length;o+=1){var a=iL[o],i=Math.abs(a-e);i<=t&&i<n&&(r=a,n=i)}return r}function ade(e){if(typeof e!="number"||!Number.isFinite(e))return"";var t=Math.round(e);if(Math.abs(t-e)<5e-4)return String(t);var r=e.toFixed(3).replace(/0+$/,"").replace(/\.$/,"");return r}function Hh(e,t,r){if(!(typeof r!="number"||!Number.isFinite(r))){var n=ode(r),o=ade(n);if(o){var a=o+" fps";Object.prototype.hasOwnProperty.call(t,a)||(t[a]=n,e.push({numeric:n,label:a}))}}}function Sk(e,t,r,n){if(!(typeof r!="number"||!Number.isFinite(r)||typeof n!="number"||!Number.isFinite(n))){var o=r,a=n;if(o>a){var i=o;o=a,a=i}for(var s=.05,l=0;l<iL.length;l+=1){var c=iL[l];if(!(c+s<o)){if(c-s>a)break;Hh(e,t,c)}}Hh(e,t,o),Hh(e,t,a)}}function ZY(e){Array.isArray(e)&&e.sort(function(r,n){var o=parseFloat(r),a=parseFloat(n);if(Number.isFinite(o)&&Number.isFinite(a)){if(o<a)return-1;if(o>a)return 1}return r<n?-1:r>n?1:0})}function e5(e){if(typeof e!="string")return[];var t=e.trim();if(!t)return[];var r=t.lastIndexOf(":"),n=r!==-1?t.slice(r+1):t,o=n.replace(/\([^)]*\)/g," "),a=[];if(o.replace(/([0-9]+(?:\.[0-9]+)?)/g,function(I,C){var k=parseFloat(C);return Number.isFinite(k)&&a.push(k),C}),!a.length)return[];var i=[],s=Object.create(null),l=/[0-9]\s*\//.test(o),c=/[0-9]\s*,\s*[0-9]/.test(o),u=/\b(?:or|and)\b/i.test(o),f=/up to/i.test(o)||/\bmax(?:imum)?\b/i.test(o),d=/\bbetween\b/i.test(o),p=/(?:|-|\bto\b)/i.test(o);if(f){var h=Math.max.apply(Math,a),m=a.length>1?Math.min.apply(Math,a):1;Sk(i,s,m,h)}else if((p||d)&&a.length>=2){var g=Math.min.apply(Math,a),S=Math.max.apply(Math,a);Sk(i,s,g,S)}else if(l||c||u&&a.length>1)for(var y=0;y<a.length;y+=1)Hh(i,s,a[y]);else if(a.length===1)Hh(i,s,a[0]);else{var E=Math.min.apply(Math,a),L=Math.max.apply(Math,a);Sk(i,s,E,L)}i.sort(function(I,C){return I.numeric<C.numeric?-1:I.numeric>C.numeric?1:I.label<C.label?-1:I.label>C.label?1:0});for(var v=[],A=0;A<i.length;A+=1)v.push(i[A].label);return v}function ide(e){for(var t=[],r=Object.create(null),n=Array.isArray(e)?e:[],o=0;o<n.length;o+=1)for(var a=e5(n[o]),i=0;i<a.length;i+=1){var s=a[i];Object.prototype.hasOwnProperty.call(r,s)||(r[s]=!0,t.push(s))}return ZY(t),t}function GU(e){if(typeof e!="string")return[];var t=e.replace(/\([^)]*\)/g," "),r=t.replace(/[^0-9a-zA-Z]+/g," ").toLowerCase().trim();if(!r)return[];for(var n=r.split(/\s+/),o=[],a=0;a<n.length;a+=1){var i=n[a];i&&(/^\d$/.test(i)||o.push(i))}return o}function sde(e,t){var r=GU(t);if(!r.length)return!1;var n=GU(e);if(!n.length)return!1;for(var o=Object.create(null),a=0;a<n.length;a+=1)o[n[a]]=!0;for(var i=0,s=0;s<r.length;s+=1)o[r[s]]&&(i+=1);if(!i)return!1;var l=r.length;return r.length>=3&&(l=r.length-1),i>=Math.max(1,l)}function lde(e,t){for(var r=Object.create(null),n=Array.isArray(e)?e:[],o=Array.isArray(t)?t:[],a=0;a<n.length;a+=1){var i=n[a];if(typeof i=="string"){var s=i.trim();if(s){var l=JP(s);l&&(r[l]||(r[l]=[]))}}}for(var c=0;c<o.length;c+=1){var u=o[c];if(typeof u=="string"){var f=u.trim();if(f){var d=e5(f);if(d.length)for(var p=0;p<n.length;p+=1){var h=n[p];if(typeof h=="string"){var m=h.trim();if(m){var g=JP(m);if(g&&sde(f,m)){r[g]||(r[g]=[]);for(var S=0;S<d.length;S+=1){var y=d[S];r[g].indexOf(y)===-1&&r[g].push(y)}}}}}}}}for(var E in r)Object.prototype.hasOwnProperty.call(r,E)&&ZY(r[E]);return r}function cde(e,t){var r=aL("sensorModeSelect","fbSensorMode");if(!r)return"";var n=typeof t=="string"?t:"",o=JY(r,e,n,!0);return we.selectedSensorMode=o,o}function t5(e,t){var r=aL("framerateSelect","fbFramerate");if(!r)return"";var n=we.sensorModeFrameRateMap||{},o=Array.isArray(we.allFrameRateOptions)?we.allFrameRateOptions:[],a=JP(e),i=a&&n[a]&&n[a].length?n[a]:[],s=typeof t=="string"?t:"",l=!!a&&i.length>0,c=JY(r,a?i:o,s,l);return we.selectedFramerate=c,c}function ude(e){if(!e)return null;var t=we.elements[e.elementName];if(t)return oL(e.elementName,t),t;var r=ns();if(!r)return null;var n=null;try{n=r.getElementById(e.elementId)}catch{n=null}return n&&(we.elements[e.elementName]=n,oL(e.elementName,n)),n}function vk(e,t){var r=zA[e];if(r){var n=ude(r);if(n){var o=XY(),a=o[r.elementName]||[],i=[],s=Object.create(null);if(Array.isArray(t))for(var l=0;l<t.length;l+=1){var c=t[l];if(c!=null){var u=String(c).trim();u&&(Object.prototype.hasOwnProperty.call(s,u)||(s[u]=!0,i.push(u)))}}i.length||(i=a.slice()),rde(n,i)}}}function fde(e){if(e){for(var t in zA)if(Object.prototype.hasOwnProperty.call(zA,t)){var r=zA[t];if(r){if(we.elements[r.elementName]){oL(r.elementName,we.elements[r.elementName]);continue}var n=null;try{n=e.getElementById(r.elementId)}catch{n=null}n&&(we.elements[r.elementName]=n,oL(r.elementName,n))}}}}function ZP(e,t){if(e==null)return"";if(typeof e=="string")return e.trim();if(typeof e=="number"&&Number.isFinite(e))return String(e);if(e&&typeof e=="object")for(var r=Array.isArray(t)?t:[],n=0;n<r.length;n+=1){var o=r[n];if(o){var a=e[o];if(typeof a=="string"&&a.trim())return a.trim()}}return""}function dde(e){if(!e||typeof e!="object")return[];var t=[],r=e.lensMount;if(Array.isArray(r))for(var n=0;n<r.length;n+=1){var o=r[n];if(o){var a=ZP(o.type||o,[]);if(a){var i="";typeof o.mount=="string"&&o.mount.trim()&&(i=o.mount.trim());var s=a;i&&(s+=" ("+i+")"),t.push(s)}}}if(!t.length&&Array.isArray(e.mountOptions))for(var l=e.mountOptions,c=0;c<l.length;c+=1){var u=l[c],f=ZP(u,["type","name"]);f&&t.push(f)}return t}function ME(e,t,r){if(!e||typeof e!="object")return[];var n=e[t];if(!Array.isArray(n))return[];for(var o=[],a=0;a<n.length;a+=1){var i=ZP(n[a],r);i&&o.push(i)}return o}function pde(e,t){var r=null;e&&t&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,t)&&(r=e[t]);var n=dde(r),o=ME(r,"resolutions",["label","name","value"]),a=ME(r,"recordingCodecs",["label","name","codec","type"]),i=ME(r,"sensorModes",["label","name","mode"]),s=ME(r,"frameRates",["label","name","rate","value"]);vk("lensMount",n),vk("resolution",o),vk("codec",a),we.allFrameRateOptions=ide(s),we.sensorModeFrameRateMap=lde(i,s);var l=aL("sensorModeSelect","fbSensorMode"),c=aL("framerateSelect","fbFramerate"),u=l&&typeof l.value=="string"?l.value:we.selectedSensorMode,f=cde(i,u),d=c&&typeof c.value=="string"?c.value:we.selectedFramerate;t5(f,d)}function ns(e){return e&&e.document&&typeof e.document=="object"?e.document:we.dependencies.document?we.dependencies.document:typeof document<"u"&&document?document:bt&&bt.document?bt.document:null}function xr(e,t,r){if(t&&typeof t[r]=="function"){e[r]=t[r];return}!e[r]&&bt&&typeof bt[r]=="function"&&(e[r]=bt[r])}function f_(e){var t=we.dependencies,r=e||{},n=ns(r);n&&(t.document=n);var o=null;r.window&&typeof r.window=="object"?o=r.window:t.window?o=t.window:typeof window<"u"&&window?o=window:bt&&bt.window&&(o=bt.window),o&&(t.window=o);var a=null;r.navigator&&typeof r.navigator=="object"?a=r.navigator:t.navigator?a=t.navigator:o&&o.navigator?a=o.navigator:typeof navigator<"u"&&navigator&&(a=navigator),a&&(t.navigator=a);var i=null;return typeof r.alert=="function"?i=r.alert:t.alert?i=t.alert:o&&typeof o.alert=="function"?i=o.alert:bt&&typeof bt.alert=="function"&&(i=bt.alert),i&&(t.alert=i),xr(t,r,"openDialog"),xr(t,r,"closeDialog"),xr(t,r,"getCurrentSetupKey"),xr(t,r,"loadFeedback"),xr(t,r,"saveFeedback"),xr(t,r,"updateCalculations"),xr(t,r,"renderFeedbackTable"),xr(t,r,"dispatchTemperatureNoteRender"),xr(t,r,"refreshFeedbackTemperatureLabel"),xr(t,r,"updateFeedbackTemperatureOptions"),xr(t,r,"refreshTotalCurrentLabels"),xr(t,r,"updateMountVoltageSettingLabels"),xr(t,r,"setButtonLabelWithIcon"),xr(t,r,"getSelectedPlate"),xr(t,r,"getMountVoltageConfig"),xr(t,r,"updateBatteryOptions"),xr(t,r,"setStatusMessage"),xr(t,r,"setStatusLevel"),xr(t,r,"closePowerWarningDialog"),xr(t,r,"showPowerWarningDialog"),xr(t,r,"drawPowerDiagram"),xr(t,r,"renderTemperatureNote"),xr(t,r,"checkFizCompatibility"),xr(t,r,"checkFizController"),xr(t,r,"checkArriCompatibility"),xr(t,r,"renderSetupDiagram"),xr(t,r,"refreshGearListIfVisible"),xr(t,r,"supportsBMountCamera"),xr(t,r,"supportsGoldMountCamera"),xr(t,r,"getCssVariableValue"),xr(t,r,"escapeHtml"),xr(t,r,"getLastRuntimeHours"),xr(t,r,"setLastRuntimeHours"),xr(t,r,"getDevices"),xr(t,r,"getTexts"),xr(t,r,"getCurrentLang"),xr(t,r,"getCollator"),r.iconGlyphs&&typeof r.iconGlyphs=="object"?t.iconGlyphs=r.iconGlyphs:!t.iconGlyphs&&bt&&bt.ICON_GLYPHS&&(t.iconGlyphs=bt.ICON_GLYPHS),typeof r.mailTarget=="string"&&r.mailTarget.trim()?t.mailTarget=r.mailTarget.trim():t.mailTarget||(t.mailTarget="info@lucazanner.de"),t.loadFeedback||(t.loadFeedback=function(){return{}}),t.saveFeedback||(t.saveFeedback=function(){}),t.updateCalculations||(t.updateCalculations=function(){}),t.getCurrentSetupKey||(t.getCurrentSetupKey=function(){return""}),t}function Ot(e,t,r,n){var o=e||{},a=o.elements&&typeof o.elements=="object"?o.elements:null;if(a&&a[t])return a[t];if(o[t])return o[t];if(we.elements[t])return we.elements[t];var i=ns(o);if(i&&r){var s=null;try{s=i.getElementById(r)}catch{s=null}if(s)return s}var l=n||t;return bt&&bt[l]?bt[l]:null}function mde(e,t){if(e&&typeof e.compare=="function")return e;var r=we.collatorCache;(!r||typeof r!="object")&&(r=Object.create(null),we.collatorCache=r);var n=typeof t=="string"?t.trim():"",o=n||"default",a=r[o];if(a&&typeof a.compare=="function")return a;var i=null;if(typeof Intl<"u"&&typeof Intl.Collator=="function")for(var s=o==="default"?[void 0]:[n,void 0],l=0;l<s.length;l+=1){var c=s[l];if(!(typeof c=="string"&&!c))try{i=new Intl.Collator(c,{numeric:!0,sensitivity:"base"});break}catch{i=null}}if(!i){var u=we.fallbackCollator;(!u||typeof u.compare!="function")&&(u={compare:function(d,p){return String(d).localeCompare(String(p))}},we.fallbackCollator=u),i=u}return r[o]=i,i}function gde(e){return e?Array.isArray(e)?e.filter(Boolean):typeof e.length=="number"?Array.prototype.slice.call(e).filter(Boolean):[e].filter(Boolean):[]}function MU(e,t,r,n){var o=e||{},a=o.elements&&typeof o.elements=="object"?o.elements:null,i=null;a&&a[t]?i=a[t]:o[t]?i=o[t]:we.elements[t]?i=we.elements[t]:bt&&n&&bt[n]&&(i=bt[n]);var s=gde(i);if(s.length)return we.elements[t]=s,s;var l=[],c=ns(o);if(c&&Array.isArray(r))for(var u=0;u<r.length;u+=1){var f=r[u];if(f){var d=null;try{d=c.getElementById(f)}catch{d=null}d&&l.push(d)}}return we.elements[t]=l,l}function Zs(e,t){if(e)if(t&&typeof t=="string"&&t.trim())try{e.setAttribute("data-help",t)}catch{}else try{e.removeAttribute("data-help")}catch{}}function Vm(e){if(typeof e!="string")return"";var t=e.trim();return t||""}function ll(e,t){if(typeof e!="string"||!e)return"";var r=e;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var o=t[n],a="{"+n+"}";if(r.indexOf(a)!==-1){var i=typeof o>"u"?"":String(o);r=r.split(a).join(i)}}return r}function yde(e,t,r){var n=Vm(e);if(n)return n;var o=Vm(t);return o||Vm(r)}function hde(e){return Number.isFinite(e)?e>=10?e.toFixed(1):e.toFixed(2):""}function Uh(e){return Number.isFinite(e)?e.toFixed(2):"0.00"}function vf(e){if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="string"){var t=e.trim();if(!t)return null;var r=t.replace(/,/g,"."),n=parseFloat(r);return Number.isFinite(n)?n:null}return null}function bde(e,t){var r=Number.isFinite(t.current)?t.current:0,n=Number.isFinite(t.limit)?t.limit:null;if(r<=0)return e("resultsPlainSummaryPinsZero");if(!Number.isFinite(n)||n<=0){var o=e("resultsPlainSummaryPinsUnknown");return ll(o,{current:Uh(r)})}var a={current:Uh(r),max:String(n)};return r>n?ll(e("resultsPlainSummaryPinsExceeded"),a):r>=n*.8?ll(e("resultsPlainSummaryPinsNear"),a):ll(e("resultsPlainSummaryPinsOk"),a)}function Sde(e,t){var r=Number.isFinite(t.current)?t.current:0,n=Number.isFinite(t.limit)?t.limit:null,o=t.hasRating,a=t.allowed,i=t.bMountCam;if(!a){if(i)return e("resultsPlainSummaryDtapUnavailableBMount");if(!o){var s=e("resultsPlainSummaryDtapUnknown");return ll(s,{current:Uh(r)})}return e("resultsPlainSummaryDtapUnavailable")}if(r<=0)return e("resultsPlainSummaryDtapZero");if(!Number.isFinite(n)||n<=0){var l=e("resultsPlainSummaryDtapUnknown");return ll(l,{current:Uh(r)})}var c={current:Uh(r),max:String(n)};return r>n?ll(e("resultsPlainSummaryDtapExceeded"),c):r>=n*.8?ll(e("resultsPlainSummaryDtapNear"),c):ll(e("resultsPlainSummaryDtapOk"),c)}function vde(e,t){if(typeof e!="function")return"";var r=t||{},n=[],o=bde(e,{current:r.current,limit:r.pinLimit});o&&n.push(o);var a=Sde(e,{current:r.current,limit:r.dtapLimit,hasRating:r.hasDtapRating,allowed:r.dtapAllowed,bMountCam:r.bMountCam});return a&&n.push(a),n.join(" ")}function Ede(e){var t=e||{},r=Vm(t.summaryPrompt),n=Vm(t.needBatterySummary)||r,o=Vm(t.unnamedBatteryLabel),a=yde(t.batteryLabelText,t.battery,o),i=Number.isFinite(t.totalWatt)?t.totalWatt.toFixed(1):"0.0";if(!t.battery){var s=t.totalWatt>0?n:r;return s||n||r||a||""}if(!Number.isFinite(t.runtimeHoursValue)){if(t.unlimitedSummaryTemplate&&Number.isFinite(t.totalWatt)&&t.totalWatt===0){var l=ll(t.unlimitedSummaryTemplate,{batteryName:a||o||"",totalPower:i});if(l)return l}return n||r||a||""}if(t.runtimeSummaryTemplate&&t.batteriesNeededValue!==null&&Number.isFinite(t.batteriesNeededValue)&&t.batteriesNeededValue>0){var c=hde(t.runtimeHoursValue),u=ll(t.runtimeSummaryTemplate,{batteryName:a||o||"",hours:c,batteryCount:String(t.batteriesNeededValue),totalPower:i});if(u)return u}return r||n||a||""}function d_(e,t){var r=e&&typeof e=="object"?e:{},n=t&&typeof t=="object"?t:{};return function(a){if(!a)return"";var i=r[a];if(typeof i=="string"){var s=i.trim();if(s)return s}if(i=n[a],typeof i=="string"){var l=i.trim();if(l)return l}return""}}var _U=QY([{celsius:25,multiplier:1},{celsius:0,multiplier:1.25},{celsius:-10,multiplier:1.6},{celsius:-20,multiplier:2}]);function Ade(){var e=we&&we.dependencies?we.dependencies.escapeHtml:null;return!e&&bt&&typeof bt.escapeHtml=="function"&&(e=bt.escapeHtml),typeof e=="function"?e:function(r){var n=r==null?"":String(r);return n.replace(/[&<>"']/g,function(a){switch(a){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;";default:return a}})}}function Cde(e){if(typeof e!="string")return"celsius";var t=e.trim().toLowerCase();return t==="fahrenheit"||t==="f"||t==="f"?"fahrenheit":t==="kelvin"||t==="k"?"kelvin":"celsius"}function wde(){var e=[];we&&we.dependencies&&(typeof we.dependencies.temperatureUnit=="string"&&e.push(we.dependencies.temperatureUnit),we.dependencies.sessionGlobalScope&&typeof we.dependencies.sessionGlobalScope.temperatureUnit=="string"&&e.push(we.dependencies.sessionGlobalScope.temperatureUnit)),bt&&(typeof bt.temperatureUnit=="string"&&e.push(bt.temperatureUnit),bt.sessionGlobalScope&&typeof bt.sessionGlobalScope.temperatureUnit=="string"&&e.push(bt.sessionGlobalScope.temperatureUnit),typeof bt.localTemperatureUnit=="string"&&e.push(bt.localTemperatureUnit));for(var t=0;t<e.length;t+=1){var r=e[t],n=Cde(r);if(n)return n==="kelvin"?"celsius":n}return"celsius"}function Ek(e,t,r){try{var n=new Intl.NumberFormat(e||"en",t||{});return function(i){return n.format(i)}}catch{}var o=typeof r=="number"?r:0;return function(i){if(typeof i!="number"||!Number.isFinite(i))return String(i);try{return i.toFixed(o)}catch{}return String(i)}}function Lde(e){var t=null;if(we&&we.dependencies){var r=we.dependencies.getCurrentLang;if(typeof r=="function")try{t=r()}catch{}}return!t&&bt&&typeof bt.currentLang=="string"&&(t=bt.currentLang),!t&&e&&e.documentElement&&typeof e.documentElement.lang=="string"&&(t=e.documentElement.lang),typeof t!="string"||!t?"en":t}function Rde(e){var t=null;if(we&&we.dependencies){var r=we.dependencies.getTexts;if(typeof r=="function")try{t=r()}catch{}}!t&&bt&&bt.texts&&typeof bt.texts=="object"&&(t=bt.texts);var n=t&&t.en||{};if(!e||!t)return{langTexts:n,fallbackTexts:n};if(t[e])return{langTexts:t[e],fallbackTexts:n};var o=e.indexOf("-");if(o!==-1){var a=e.slice(0,o);if(t[a])return{langTexts:t[a],fallbackTexts:n}}return{langTexts:n,fallbackTexts:n}}function Tde(e,t){return t==="fahrenheit"?e*9/5+32:e}function p_(e){var t=ns({}),r=we&&we.elements?we.elements.tempNote:null;if(!r&&t){try{r=t.getElementById("temperatureNote")}catch{}r&&we&&we.elements&&(we.elements.tempNote=r)}if(!r||typeof r!="object")return!1;var n=Lde(t),o=Rde(n),a=d_(o.langTexts,o.fallbackTexts),i=Ade(),s=a("temperatureNoteHeading")||"Temperature impact on runtime:",l=a("temperatureLabel")||"Temperature",c=a("runtimeLabel")||"Estimated Runtime (h)",u=a("batteryCountTempLabel")||"Batteries needed",f=a("batteryLifeUnit"),d=wde(),p=d==="fahrenheit"?"temperatureUnitSymbolFahrenheit":"temperatureUnitSymbolCelsius",h=a(p)||(d==="fahrenheit"?"F":"C"),m=Ek(n,{minimumFractionDigits:2,maximumFractionDigits:2},2),g=Ek(n,{maximumFractionDigits:0},0),S=Ek(n,{maximumFractionDigits:0,signDisplay:"exceptZero"},0),y="",E=Number.isFinite(e)?e:Number(e);!Number.isFinite(E)&&e!==1/0&&(E=null);for(var L=e===1/0,v=0;v<_U.length;v+=1){var A=_U[v],R=Tde(A.celsius,d),I=S(R),C=null,k=null;if(L)C=1/0,k=1;else if(Number.isFinite(E)&&E>0){var _=E/A.multiplier;if(Number.isFinite(_)&&_>0){C=_;var w=10/_;Number.isFinite(w)&&w>0&&(k=Math.max(1,Math.ceil(w)))}}var x="";C===1/0?x="":Number.isFinite(C)&&C>0&&(x=m(C),f&&(x+=" "+f));var G="";Number.isFinite(k)&&k>0&&(G=g(k)),y+="<tr><td>"+i(I+" "+h)+"</td><td>"+i(x)+"</td><td>"+i(G)+"</td></tr>"}var T="<table><thead><tr><th>"+i(l+" ("+h+")")+"</th><th>"+i(c)+"</th><th>"+i(u)+"</th></tr></thead><tbody>"+y+"</tbody></table>",P="<h3>"+i(s)+"</h3>";try{r.innerHTML=P+T}catch{r.innerHTML=P+T}return!0}function Ode(e){var t=e||{},r=f_(t),n=ns(t);if(!n)return!1;var o=typeof t.lang=="string"?t.lang:"",a=t.langTexts&&typeof t.langTexts=="object"?t.langTexts:{},i=t.fallbackTexts&&typeof t.fallbackTexts=="object"?t.fallbackTexts:{},s=d_(a,i),l=Ot(t,"breakdownListElem","breakdownList","breakdownListElem");if(l){var c=s("breakdownListHelp");Zs(l,c)}var u=Ot(t,"resultsPlainSummaryElem","resultsPlainSummary","resultsPlainSummaryElem");u&&Zs(u,s("resultsPlainSummaryHelp"));var f=Ot(t,"resultsPlainSummaryTitleElem","resultsPlainSummaryTitle","resultsPlainSummaryTitleElem");if(f)try{f.textContent=s("resultsPlainSummaryTitle")||f.textContent||""}catch{}var d=Ot(t,"resultsPlainSummaryTextElem","resultsPlainSummaryText","resultsPlainSummaryTextElem");if(d){var p=s("resultsPlainSummaryPrompt");!p&&typeof d.textContent=="string"&&(p=d.textContent);try{d.textContent=p}catch{}}var h=Ot(t,"resultsPlainSummaryNoteElem","resultsPlainSummaryNote","resultsPlainSummaryNoteElem");if(h)try{h.textContent=s("resultsPlainSummaryNote")||h.textContent||""}catch{}function m(fe,Oe,Te){if(fe){var Ne=s(Oe);Ne||typeof fe.textContent=="string"&&(Ne=fe.textContent);try{typeof fe.textContent=="string"&&(fe.textContent=Ne)}catch{}var Ie=s(Te);Zs(fe,Ie)}}var g=Ot(t,"totalPowerLabel","totalPowerLabel");if(m(g,"totalPowerLabel","totalPowerHelp"),typeof r.refreshTotalCurrentLabels=="function")try{r.refreshTotalCurrentLabels(o)}catch(fe){Ar("Unable to refresh total current labels via cineResults.",fe)}if(typeof r.updateMountVoltageSettingLabels=="function")try{r.updateMountVoltageSettingLabels(o)}catch(fe){Ar("Unable to refresh mount voltage labels via cineResults.",fe)}var S=Ot(t,"batteryCountLabel","batteryCountLabel");m(S,"batteryCountLabel","batteryCountHelp");var y=Ot(t,"pinWarning",null,"pinWarnElem");Zs(y,s("pinWarningHelp"));var E=Ot(t,"dtapWarning",null,"dtapWarnElem");Zs(E,s("dtapWarningHelp"));var L=Ot(t,"hotswapWarning",null,"hotswapWarnElem");Zs(L,s("hotswapWarningHelp"));var v=Ot(t,"powerWarningTitle",null,"powerWarningTitleElem");if(v)try{v.textContent=s("powerWarningTitle")||v.textContent||""}catch{}var A=Ot(t,"powerWarningLimitsHeading",null,"powerWarningLimitsHeadingElem");if(A)try{A.textContent=s("powerWarningLimitsHeading")||A.textContent||""}catch{}var R=Ot(t,"powerWarningAdvice",null,"powerWarningAdviceElem");if(R)try{R.textContent=s("powerWarningAdvice")||R.textContent||""}catch{}var I=r.setButtonLabelWithIcon,C=r.iconGlyphs||{},k=Ot(t,"powerWarningCloseBtn",null,"powerWarningCloseBtn");if(k&&typeof I=="function"&&C&&C.check)try{I(k,s("powerWarningClose")||k.textContent||"",C.check)}catch(fe){Ar("Unable to localize power warning close button via cineResults.",fe)}var _=Ot(t,"batteryLifeUnit","batteryLifeUnit");if(_)try{_.textContent=s("batteryLifeUnit")||_.textContent||""}catch{}var w=r.getCurrentSetupKey,x=r.renderFeedbackTable,G=null;if(typeof x=="function"&&typeof w=="function")try{G=x(w())}catch(fe){Ar("cineResults failed to render runtime feedback summary.",fe),G=null}var T=Ot(t,"batteryLifeLabel","batteryLifeLabel");if(T){var P=s("batteryLifeLabel");if(!P&&typeof T.textContent=="string"&&(P=T.textContent),G&&G.count){var N=s("runtimeUserCountNote");if(N&&N.indexOf("{count}")!==-1){var q=N.replace("{count}",G.count),Z=P.indexOf(")");Z!==-1?P=P.slice(0,Z)+", "+q+P.slice(Z):P?P=P+" ("+q+")":P=q}}try{T.textContent=P}catch{}Zs(T,s("batteryLifeHelp"))}var U=Ot(t,"runtimeAverageNote","runtimeAverageNote");if(U){var K="";G&&G.count>4&&(K=s("runtimeAverageNote"));try{U.textContent=K}catch{}}var H=typeof t.lastRuntimeHours<"u"?t.lastRuntimeHours:typeof bt.lastRuntimeHours<"u"?bt.lastRuntimeHours:null;if(typeof r.dispatchTemperatureNoteRender=="function")try{r.dispatchTemperatureNoteRender(H)}catch(fe){Ar("Unable to dispatch temperature note render via cineResults.",fe)}var te=typeof t.temperatureUnit<"u"?t.temperatureUnit:typeof bt.temperatureUnit<"u"?bt.temperatureUnit:null;if(typeof r.refreshFeedbackTemperatureLabel=="function")try{r.refreshFeedbackTemperatureLabel(o,te)}catch(fe){Ar("Unable to refresh feedback temperature label via cineResults.",fe)}if(typeof r.updateFeedbackTemperatureOptions=="function")try{r.updateFeedbackTemperatureOptions(o,te)}catch(fe){Ar("Unable to update feedback temperature options via cineResults.",fe)}var re=Ot(t,"tempNote","temperatureNote");return Zs(re,s("temperatureNoteHelp")),we.elements.breakdownListElem=l,we.elements.totalPowerLabel=g,we.elements.batteryCountLabel=S,we.elements.batteryLifeLabel=T,we.elements.runtimeAverageNote=U,we.elements.tempNote=re,!0}function xde(e){var t=e||{},r=ns(t);if(!r)return!1;var n=t.langTexts&&typeof t.langTexts=="object"?t.langTexts:{},o=t.fallbackTexts&&typeof t.fallbackTexts=="object"?t.fallbackTexts:{},a=d_(n,o),i=Ot(t,"batteryComparisonHeading","batteryComparisonHeading","batteryComparisonHeading"),s=Ot(t,"batteryComparisonDescription","batteryComparisonDescription"),l=Ot(t,"batteryComparisonTable","batteryTable","batteryTable"),c=!1;if(i){var u=a("batteryComparisonHeading");!u&&typeof i.textContent=="string"&&(u=i.textContent);try{typeof i.textContent=="string"&&(i.textContent=u)}catch{}Zs(i,a("batteryComparisonHeadingHelp")),c=!0}if(s){var f=a("batteryComparisonDescription");!f&&typeof s.textContent=="string"&&(f=s.textContent);try{typeof s.textContent=="string"&&(s.textContent=f)}catch{}Zs(s,a("batteryComparisonDescriptionHelp")),c=!0}return l&&(Zs(l,a("batteryComparisonTableHelp")),c=!0),we.elements.batteryComparisonHeading=i,we.elements.batteryComparisonDescription=s,we.elements.batteryComparisonTable=l,c}function kp(e,t,r,n){if(!(!e||!t||!r||typeof n!="function")&&!we.handlers[r]){var o=n();if(typeof o=="function")try{e.addEventListener(t,o),we.handlers[r]=o}catch(a){Ar("cineResults could not attach runtime feedback handler.",a)}}}function m_(e){try{let Ht=function(ae){return t&&typeof t[ae]=="function"?t[ae]:r&&typeof r[ae]=="function"?r[ae]:bt&&typeof bt[ae]=="function"?bt[ae]:null},or=function(ae){if(typeof ae=="function")try{return ae()}catch(at){Ar("cineResults.updateCalculations dependency call failed.",at);return}},At=function(ae){if(!ae)return"";var at=l&&Object.prototype.hasOwnProperty.call(l,ae)?l[ae]:void 0;return typeof at>"u"&&(at=c&&Object.prototype.hasOwnProperty.call(c,ae)?c[ae]:void 0),typeof at=="string"?at:""},Fa=function(ae){if(typeof ae=="string"){var at=ae.trim();return at&&at!=="None"?at:""}if(ae==null)return"";var Nt=String(ae).trim();return Nt&&Nt!=="None"?Nt:""},jo=function(ae){return!re||!ae?"":Fa(re[ae])},jr=function(ae){if(!re||!ae)return[];var at=re[ae];if(!Array.isArray(at))return[];for(var Nt=[],Bn=0;Bn<at.length;Bn+=1){var Tr=Fa(at[Bn]);Tr&&Nt.push(Tr)}return Nt},ar=function(ae,at){var Nt=ae&&typeof ae.value=="string"?ae.value:"";if(Nt&&Nt!=="None")return Nt;var Bn=jo(at);return Bn||Nt},dt=function(ae){if(!ae||typeof ae.selectedIndex!="number")return"";var at=ae.options;if(!at||ae.selectedIndex<0||ae.selectedIndex>=at.length)return"";var Nt=at[ae.selectedIndex];return!Nt||typeof Nt.textContent!="string"?"":Nt.textContent.trim()},Zr=function(ae){if(typeof ae=="number"&&Number.isFinite(ae))return ae;if(ae&&typeof ae=="object"&&typeof ae.powerDrawWatts=="number")return ae.powerDrawWatts||0;if(typeof ae=="string"){var at=Number(ae);return Number.isFinite(at)?at:0}return 0},Zn=function(ae){if(ae){if(typeof ae.innerHTML=="string")try{ae.innerHTML="";return}catch(at){}if(typeof ae.replaceChildren=="function")try{ae.replaceChildren();return}catch(at){}if(ae.childNodes&&ae.childNodes.length)try{for(;ae.firstChild;)ae.removeChild(ae.firstChild)}catch(at){}}},Dt=function(ae,at,Nt){if(!(!ae||!at||!(Nt>0))){var Bn="<strong>"+nr(at)+"</strong> "+Nt.toFixed(1)+" W";if(typeof ae.insertAdjacentHTML=="function")try{ae.insertAdjacentHTML("beforeend","<li>"+Bn+"</li>");return}catch(eo){}if(n&&typeof n.createElement=="function"&&typeof ae.appendChild=="function")try{var Tr=n.createElement("li");Tr.innerHTML=Bn,ae.appendChild(Tr);return}catch(eo){}if(typeof ae.innerHTML=="string")try{ae.innerHTML+="<li>"+Bn+"</li>"}catch(eo){}}};var t=e||{},r=f_(t),n=ns(t),o=null;typeof t.getDevices=="function"&&(o=or(function(){return t.getDevices()})),o||(o=or(Ht("getDevices"))),!o&&t&&typeof t.devices=="object"&&(o=t.devices),!o&&bt&&typeof bt.devices=="object"&&(o=bt.devices),(!o||typeof o!="object")&&(o={});var a=null;typeof t.getTexts=="function"&&(a=or(function(){return t.getTexts()})),a||(a=or(Ht("getTexts"))),!a&&t&&typeof t.texts=="object"&&(a=t.texts),!a&&bt&&typeof bt.texts=="object"&&(a=bt.texts),(!a||typeof a!="object")&&(a={});var i=null;typeof t.getCurrentLang=="function"&&(i=or(function(){return t.getCurrentLang()})),i||(i=or(Ht("getCurrentLang"))),!i&&typeof t.currentLang=="string"&&(i=t.currentLang),!i&&typeof r.currentLang=="string"&&(i=r.currentLang),!i&&typeof bt.currentLang=="string"&&(i=bt.currentLang),(typeof i!="string"||!i)&&(i="en");var s=null;typeof t.getCollator=="function"&&(s=or(function(){return t.getCollator()})),s||(s=or(Ht("getCollator"))),!s&&t&&t.collator&&(s=t.collator),!s&&r&&r.collator&&(s=r.collator),!s&&bt&&bt.collator&&(s=bt.collator),s&&r&&typeof r=="object"&&(r.collator=s);var l=a&&typeof a=="object"&&a[i]&&typeof a[i]=="object"?a[i]:null,c=a&&typeof a=="object"&&a.en&&typeof a.en=="object"?a.en:null;l||(l=c||{}),c||(c={});var u=Ot(t,"cameraSelect","cameraSelect","cameraSelect"),f=Ot(t,"monitorSelect","monitorSelect","monitorSelect"),d=Ot(t,"videoSelect","videoSelect","videoSelect"),p=Ot(t,"distanceSelect","distanceSelect","distanceSelect"),h=Ot(t,"batterySelect","batterySelect","batterySelect"),m=Ot(t,"batteryPlateSelect","batteryPlateSelect","batteryPlateSelect"),g=Ot(t,"hotswapSelect","batteryHotswapSelect","hotswapSelect"),S=MU(t,"motorSelects",["motor1Select","motor2Select","motor3Select","motor4Select"],"motorSelects"),y=MU(t,"controllerSelects",["controller1Select","controller2Select","controller3Select","controller4Select"],"controllerSelects"),E=Ot(t,"resultsPlainSummaryElem","resultsPlainSummary","resultsPlainSummaryElem"),L=Ot(t,"resultsPlainSummaryTextElem","resultsPlainSummaryText","resultsPlainSummaryTextElem"),v=Ot(t,"resultsPlainSummaryNoteElem","resultsPlainSummaryNote","resultsPlainSummaryNoteElem"),A=Ot(t,"totalPowerElem","totalPower","totalPowerElem"),R=Ot(t,"breakdownListElem","breakdownList","breakdownListElem"),I=Ot(t,"totalCurrent144Elem","totalCurrent144","totalCurrent144Elem"),C=Ot(t,"totalCurrent12Elem","totalCurrent12","totalCurrent12Elem"),k=Ot(t,"batteryLifeElem","batteryLife","batteryLifeElem"),_=Ot(t,"batteryCountElem","batteryCount","batteryCountElem"),w=Ot(t,"batteryLifeLabelElem","batteryLifeLabel","batteryLifeLabelElem"),x=Ot(t,"runtimeAverageNoteElem","runtimeAverageNote","runtimeAverageNoteElem"),G=Ot(t,"pinWarnElem","pinWarning","pinWarnElem"),T=Ot(t,"dtapWarnElem","dtapWarning","dtapWarnElem"),P=Ot(t,"hotswapWarnElem","hotswapWarning","hotswapWarnElem"),N=Ot(t,"batteryComparisonSection","batteryComparison","batteryComparisonSection"),q=Ot(t,"batteryTableElem","batteryTable","batteryTableElem"),Z=Ot(t,"setupDiagramContainer","diagramArea","setupDiagramContainer"),U=n&&typeof n.getElementById=="function"?n.getElementById("heroRuntime"):null,K=n&&typeof n.getElementById=="function"?n.getElementById("heroCurrent144"):null,H=n&&typeof n.getElementById=="function"?n.getElementById("heroCurrent12"):null,te=n&&typeof n.getElementById=="function"?n.getElementById("heroBatteryCount"):null;we.elements.cameraSelect=u,we.elements.monitorSelect=f,we.elements.videoSelect=d,we.elements.distanceSelect=p,we.elements.batterySelect=h,we.elements.hotswapSelect=g,we.elements.batteryPlateSelect=m,we.elements.motorSelects=S,we.elements.controllerSelects=y,we.elements.resultsPlainSummaryElem=E,we.elements.resultsPlainSummaryTextElem=L,we.elements.resultsPlainSummaryNoteElem=v,we.elements.totalPowerElem=A,we.elements.breakdownListElem=R,we.elements.totalCurrent144Elem=I,we.elements.totalCurrent12Elem=C,we.elements.batteryLifeElem=k,we.elements.batteryCountElem=_,we.elements.batteryLifeLabelElem=w,we.elements.runtimeAverageNoteElem=x,we.elements.pinWarnElem=G,we.elements.dtapWarnElem=T,we.elements.hotswapWarnElem=P,we.elements.batteryComparisonSection=N,we.elements.batteryTableElem=q,we.elements.setupDiagramContainer=Z;var re=t&&typeof t.previewSelections=="object"&&t.previewSelections?t.previewSelections:null,fe=ar(u,"camera"),Oe=ar(f,"monitor"),Te=ar(d,"video"),Ne=ar(p,"distance"),Ie=ar(h,"battery"),et=dt(h),Ze=S.map(function(at){return ar(at)}),Ft=y.map(function(at){return ar(at)}),Ye=jr("motors");if(Ye.length){var ct=Ze.some(function(at){return at&&at!=="None"});ct||(Ze=Ye.slice())}var Y=jr("controllers");if(Y.length){var ee=Ft.some(function(at){return at&&at!=="None"});ee||(Ft=Y.slice())}if(!et||!et.trim()){var Ae=jo("batteryLabel")||jo("battery");Ae&&(et=Ae)}var ve=o&&typeof o.cameras=="object"&&o.cameras?o.cameras:{};pde(ve,fe);for(var se=o&&typeof o.monitors=="object"&&o.monitors?o.monitors:{},de=o&&typeof o.video=="object"&&o.video?o.video:{},be=o&&typeof o.fiz=="object"&&o.fiz?o.fiz:{},ye=be&&typeof be.motors=="object"?be.motors:{},$e=be&&typeof be.controllers=="object"?be.controllers:{},xe=be&&typeof be.distance=="object"?be.distance:{},St=Zr(ve[fe]),Tt=Zr(se[Oe]),xt=Zr(de[Te]),ut=0,Er=0;Er<Ze.length;Er+=1)ut+=Zr(ye[Ze[Er]]);for(var zt=0,dr=0;dr<Ft.length;dr+=1)zt+=Zr($e[Ft[dr]]);var Jt=Zr(xe[Ne]),rr=St+Tt+xt+ut+zt+Jt;if(A&&typeof A.textContent<"u")try{A.textContent=rr.toFixed(1)}catch(ae){}var Jn=[{power:St,className:"camera",label:At("cameraLabel")},{power:Tt,className:"monitor",label:At("monitorLabel")},{power:xt,className:"video",label:At("videoLabel")},{power:ut,className:"motors",label:At("fizMotorsLabel")},{power:zt,className:"controllers",label:At("fizControllersLabel")},{power:Jt,className:"distance",label:At("distanceLabel")}].filter(function(at){return at.power>0}),nr=Ht("escapeHtml");nr||(nr=function(at){var Nt=at==null?"":String(at);return Nt.replace(/[&<>"']/g,function(Tr){switch(Tr){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;";default:return Tr}})}),R&&(Zn(R),Dt(R,At("cameraLabel"),St),Dt(R,At("monitorLabel"),Tt),Dt(R,At("videoLabel"),xt),Dt(R,At("fizMotorsLabel"),ut),Dt(R,At("fizControllersLabel"),zt),Dt(R,At("distanceLabel"),Jt));var $n=Ht("getSelectedPlate"),De="";if(typeof $n=="function"){var vt=or($n);typeof vt=="string"&&(De=vt)}De||(De=jo("plate")||jo("batteryPlate")||"");var Yt=Ht("getMountVoltageConfig"),j={};if(typeof Yt=="function"){var O;try{O=Yt(De)}catch(ae){Ar("cineResults.updateCalculations could not determine mount voltage configuration.",ae),O=null}O&&typeof O=="object"&&(j=O)}var D=De==="B-Mount",F=Number.isFinite(j.high)?j.high:D?33.6:14.4,z=Number.isFinite(j.low)?j.low:D?21.6:12,J=rr>0?rr/F:0,Q=rr>0?rr/z:0,le=Ht("refreshTotalCurrentLabels");if(le)try{le(i,De,j)}catch(ae){Ar("cineResults.updateCalculations could not refresh total current labels.",ae)}if(I&&typeof I.textContent<"u")try{I.textContent=J.toFixed(2)}catch(ae){}if(C&&typeof C.textContent<"u")try{C.textContent=Q.toFixed(2)}catch(ae){}var Ee=Ht("updateBatteryOptions");if(Ee)try{Ee()}catch(ae){Ar("cineResults.updateCalculations could not refresh battery options.",ae)}Ie=ar(h,"battery");var pe=Ht("setStatusMessage");pe||(pe=function(at,Nt){if(at)try{at.textContent=Nt||""}catch(Bn){}});var ne=Ht("setStatusLevel");ne||(ne=function(at,Nt){if(at){var Bn=Nt||"";if(typeof at.setAttribute=="function")try{at.setAttribute("data-status",Bn);return}catch(Tr){}at.dataStatus=Bn}});var Se=Ht("closePowerWarningDialog"),Le=Ht("showPowerWarningDialog"),ke=Ht("drawPowerDiagram"),We=Ht("renderFeedbackTable"),nt=Ht("getCurrentSetupKey"),it=Ht("renderTemperatureNote"),Et=Ht("checkFizCompatibility"),yr=Ht("checkFizController"),hr=Ht("checkArriCompatibility"),Vr=Ht("renderSetupDiagram"),Rr=Ht("supportsBMountCamera"),Qe=Ht("supportsGoldMountCamera"),Vn=Ht("getCssVariableValue");Vn||(Vn=function(at,Nt){return typeof Nt=="string"?Nt:""});var qn=Ht("getLastRuntimeHours");qn||(qn=function(){return typeof bt.lastRuntimeHours<"u"?bt.lastRuntimeHours:null});var Lo=Ht("setLastRuntimeHours");Lo||(Lo=function(at){try{bt.lastRuntimeHours=at}catch(Nt){}});var sn=null,hn=null,ln=null,Zo=null;if(!Ie||!o.batteries||!o.batteries[Ie]){if(k&&typeof k.textContent<"u")try{k.textContent=""}catch(ae){}if(U&&(U.textContent=""),_&&typeof _.textContent<"u")try{_.textContent=""}catch(ae){}if(pe(G,""),ne(G,null),pe(T,""),ne(T,null),P&&(pe(P,""),ne(P,null)),Se)try{Se()}catch(ae){Ar("cineResults.updateCalculations could not close power warning dialog.",ae)}if(Lo(null),hn=null,ln=null,Zo=null,ke)try{ke(0,Jn,0)}catch(ae){Ar("cineResults.updateCalculations could not draw power diagram.",ae)}}else{var kn=o.batteries[Ie],ea=ar(g,"hotswap"),Fr=o.batteryHotswaps&&o.batteryHotswaps[ea]?o.batteryHotswaps[ea]:null,yo=(kn&&typeof kn.capacity=="number"?kn.capacity:0)+(Fr&&typeof Fr.capacity=="number"?Fr.capacity:0),br=vf(kn&&kn.pinA),_t=vf(kn&&kn.dtapA),kt=Number.isFinite(br)&&br>0,Mr=Number.isFinite(_t)&&_t>0,In=vf(Fr&&Fr.pinA);if(Number.isFinite(In)){if(!kt||In<br){var Do=At("warnHotswapLower").replace("{max}",String(In)).replace("{batt}",kt?String(br):"?");pe(P,Do),ne(P,"warning")}else pe(P,""),ne(P,null);br=In,kt=Number.isFinite(br)&&br>0}else P&&(pe(P,""),ne(P,null));var ho=kt?br*z:0;if(ke)try{ke(ho,Jn,kt?br:null)}catch(ae){Ar("cineResults.updateCalculations could not draw power diagram.",ae)}if(I&&typeof I.textContent<"u")try{I.textContent=J.toFixed(2)}catch(ae){}if(K&&(K.textContent=`${J.toFixed(2)} A`),C&&typeof C.textContent<"u")try{C.textContent=Q.toFixed(2)}catch(ae){}if(H&&(H.textContent=`${Q.toFixed(2)} A`),rr===0){if(sn=1/0,k&&typeof k.textContent<"u")try{k.textContent=""}catch(ae){}U&&(U.textContent="")}else{if(sn=yo/rr,k&&typeof k.textContent<"u")try{k.textContent=sn.toFixed(2)}catch(ae){}if(U){var is=Math.floor(sn),nu=Math.round((sn-is)*60);U.textContent=`${is}h ${nu} m`}}if(Lo(sn),hn=sn,ln=1,Number.isFinite(sn)&&sn>0&&(ln=Math.max(1,Math.ceil(10/sn))),Zo=ln,_&&typeof _.textContent<"u")try{_.textContent=String(ln)}catch(ae){}te&&(te.textContent=String(ln))}pe(G,""),pe(T,"");var ou="",si="";if(kt&&Q>br){var bo=At("warnPinExceeded").replace("{current}",Q.toFixed(2)).replace("{max}",String(br));pe(G,bo),ou="danger"}else if(kt&&Q>br*.8){var Mn=At("warnPinNear").replace("{current}",Q.toFixed(2)).replace("{max}",String(br));pe(G,Mn),ou="note"}if(!D){if(Mr&&Q>_t){var xi=At("warnDTapExceeded").replace("{current}",Q.toFixed(2)).replace("{max}",String(_t));pe(T,xi),si="danger"}else if(Mr&&Q>_t*.8){var Da=At("warnDTapNear").replace("{current}",Q.toFixed(2)).replace("{max}",String(_t));pe(T,Da),si="note"}}var li=kt&&Q>br,ta=!D&&Mr,So=!ta||Mr&&Q>_t,ra=typeof Ie=="string"?Ie.trim():"",_n=ra!==""&&ra.toLowerCase()!=="none";if(Q>0&&li&&So&&_n){var ki=h&&h.options?h.options[h.selectedIndex]:null,Ii=ki&&typeof ki.textContent=="string"?ki.textContent.trim():Ie||"";if(Le)try{Le({batteryName:Ii,current:Q,hasPinLimit:kt,pinLimit:kt?br:null,hasDtapRating:Mr,dtapLimit:Mr?_t:null,dtapAllowed:ta})}catch(ae){Ar("cineResults.updateCalculations could not show power warning dialog.",ae)}}else if(Se)try{Se()}catch(ae){Ar("cineResults.updateCalculations could not close power warning dialog.",ae)}if(kt&&G&&G.textContent===""){var Na=At("pinOk").replace("{max}",String(br));pe(G,Na),ne(G,"success")}else kt?ne(G,ou||"warning"):ne(G,null);if(D)pe(T,""),ne(T,null);else if(Mr&&T&&T.textContent===""){var na=At("dtapOk").replace("{max}",String(_t));pe(T,na),ne(T,"success")}else ne(T,si||"warning");var vo=vde(At,{current:Q,pinLimit:br,dtapLimit:_t,hasDtapRating:Mr,dtapAllowed:ta,bMountCam:D});if(v)try{v.textContent=vo}catch(ae){}if(typeof N<"u"&&N&&N.style&&(N.style.display=rr>0?"block":"none"),q&&rr>0&&o.batteries){let ae=function(Tr,eo){var ui=eo.hours-Tr.hours;return ui!==0?ui:Sa.compare(Tr.name,eo.name)},at=function(Tr){return Tr==="pins"?"bar bar-pins-only":"bar"},Nt=function(Tr){var eo={pins:{var:"--warning-color",fallback:"#FF9800",text:At("methodPinsOnly")},"both pins and D-Tap":{var:"--success-color",fallback:"#4CAF50",text:At("methodPinsAndDTap")},infinite:{var:"--info-color",fallback:"#007bff",text:At("methodInfinite")}},ui=eo[Tr];if(ui){var To=Vn(ui.var,ui.fallback);return'<span style="color:'+nr(To)+';">'+nr(ui.text)+"</span>"}return nr(Tr)},Bn=function(Tr,eo){var ui=Nt(Tr.method),To=Tl>0?Tr.hours/Tl*100:0;ls+="<tr"+(eo?' class="'+eo+'"':"")+"><td>"+nr(Tr.name)+"</td><td>"+Tr.hours.toFixed(2)+"h ("+ui+')</td><td><div class="barContainer"><div class="'+at(Tr.method)+'" style="width: '+To+'%;"></div></div></td></tr>'};var tt=o.batteries,so=ar(h,"battery"),oa=ar(u,"camera"),ya=De,_s=Rr?!!Rr(oa):!1,ss=Qe?!!Qe(oa):!1,Kn=null;if(so&&so!=="None"&&tt[so]){var lo=tt[so],ha=!ya||lo.mount_type===ya,Wn=_s||lo.mount_type!=="B-Mount",vn=ss||lo.mount_type!=="Gold-Mount";if(ha&&Wn&&vn){var Pi=vf(lo.pinA),ba=vf(lo.dtapA),Bi=Number.isFinite(Pi)&&Pi>0?Q<=Pi:!1,co=!D&&Number.isFinite(ba)&&ba>0?Q<=ba:!1;if(Bi||co){var Gi=rr===0?1/0:lo.capacity/rr,ci;Bi&&co?ci="both pins and D-Tap":Bi?ci="pins":ci="dtap",Kn={name:so,hours:Gi,method:ci}}}}var Ro=[],Dn=[],Sa=mde(s,i);for(var No in tt)if(Object.prototype.hasOwnProperty.call(tt,No)&&No!=="None"&&!(Kn&&No===Kn.name)){var Fo=tt[No];if(!(ya&&Fo.mount_type!==ya)&&!(!ya&&!_s&&Fo.mount_type==="B-Mount")&&!(!ya&&!ss&&Fo.mount_type==="Gold-Mount")){var Mi=vf(Fo.pinA),_i=vf(Fo.dtapA),va=Number.isFinite(Mi)&&Mi>0?Q<=Mi:!1,Sr=!D&&Number.isFinite(_i)&&_i>0?Q<=_i:!1;if(va){var Ir=Fo.capacity/rr,b=Sr?"both pins and D-Tap":"pins";Ro.push({name:No,hours:Ir,method:b})}else if(Sr){var M=Fo.capacity/rr;Dn.push({name:No,hours:M,method:"dtap"})}}}Ro.sort(ae),Dn.sort(ae);var me=At("batteryTableBatteryHelp"),ze=At("batteryTableRuntimeHelp"),Lt=At("batteryTableGraphHelp"),ft=At("batteryTableGraphLabel"),sr=At("batteryTableLabel"),pr=At("runtimeLabel"),Xe=At("noBatterySupports"),Yn=me?' data-help="'+nr(me)+'"':"",cn=ze?' data-help="'+nr(ze)+'"':"",lt=Lt?' data-help="'+nr(Lt)+'"':"",It=ft?' aria-label="'+nr(ft)+'"':"",bn=ft?'<span class="visually-hidden">'+nr(ft)+"</span>":"",ls="<tr><th"+Yn+">"+nr(sr)+"</th><th"+cn+">"+nr(pr)+"</th><th"+lt+It+">"+bn+"</th></tr>",Di=[];Kn&&Di.push(Kn),Array.prototype.push.apply(Di,Ro),Array.prototype.push.apply(Di,Dn);var Tl=1;if(Di.length){var B=Di.map(function(eo){return eo.hours}),X=Math.max.apply(Math,B);Tl=Number.isFinite(X)&&X>0?X:1}if((Kn?1:0)+Ro.length+Dn.length===0)ls+='<tr><td colspan="3">'+nr(Xe)+"</td></tr>";else{Kn&&Bn(Kn,"selectedBatteryRow");for(var $=0;$<Ro.length;$+=1){var ue=Ro[$];Kn&&ue.name===Kn.name||Bn(ue)}for(var ce=0;ce<Dn.length;ce+=1){var ge=Dn[ce];if(!(Kn&&ge.name===Kn.name)){var He=Ro.some(function(eo){return eo.name===ge.name});He||Bn(ge)}}}try{q.innerHTML=ls}catch(Tr){Ar("cineResults.updateCalculations could not render battery comparison table.",Tr)}var _e=At("batteryComparisonTableHelp");if(_e)try{q.setAttribute("data-help",_e)}catch(Tr){}}else N&&N.style&&(N.style.display="none");var Fe=null;if(We&&nt)try{Fe=We(nt())}catch(ae){Ar("cineResults.updateCalculations could not render runtime feedback table.",ae),Fe=null}if(Fe!==null){var gt=Fe.runtime;if(Number.isFinite(sn)&&(gt=(Fe.runtime*Fe.weight+sn)/(Fe.weight+1)),k&&typeof k.textContent<"u")try{k.textContent=gt.toFixed(2)}catch(ae){}if(Lo(gt),hn=gt,w){var Ve=At("batteryLifeLabel"),Pt=At("runtimeUserCountNote");if(Pt.indexOf("{count}")!==-1){var Zt=Pt.replace("{count}",Fe.count),mr=Ve.indexOf(")");mr!==-1?Ve=Ve.slice(0,mr)+", "+Zt+Ve.slice(mr):Ve?Ve=Ve+" ("+Zt+")":Ve=Zt}try{w.textContent=Ve,w.setAttribute("data-help",At("batteryLifeHelp"))}catch(ae){}}if(x){var gr=Fe.count>4?At("runtimeAverageNote"):"";try{x.textContent=gr}catch(ae){}}var er=1;if(Number.isFinite(gt)&&gt>0&&(er=Math.max(1,Math.ceil(10/gt))),ln=er,Zo=er,_&&typeof _.textContent<"u")try{_.textContent=String(er)}catch(ae){}}else{if(w)try{w.textContent=At("batteryLifeLabel"),w.setAttribute("data-help",At("batteryLifeHelp"))}catch(ae){}if(x)try{x.textContent=""}catch(ae){}}if(L){var Qt=At("resultsPlainSummaryPrompt")||"",tn=Ede({summaryPrompt:Qt,needBatterySummary:At("resultsPlainSummaryNeedBattery"),runtimeSummaryTemplate:At("resultsPlainSummaryRuntime"),unlimitedSummaryTemplate:At("resultsPlainSummaryUnlimited"),unnamedBatteryLabel:At("resultsPlainSummaryUnnamedBattery"),batteryLabelText:et,battery:Ie,totalWatt:rr,runtimeHoursValue:hn,batteriesNeededValue:Zo});tn||(tn=Qt);try{L.textContent=tn}catch(ae){}}if(it)try{it(qn())}catch(ae){Ar("cineResults.updateCalculations could not render temperature note.",ae)}if(Et)try{Et()}catch(ae){Ar("cineResults.updateCalculations could not verify FIZ compatibility.",ae)}if(yr)try{yr()}catch(ae){Ar("cineResults.updateCalculations could not verify controller compatibility.",ae)}if(hr)try{hr()}catch(ae){Ar("cineResults.updateCalculations could not verify ARRI compatibility.",ae)}if(Z&&Vr)try{Vr({document:ns(t),window:we.dependencies.window,getDevices:Ht("getDevices"),getTexts:Ht("getTexts"),getCurrentLang:Ht("getCurrentLang"),cameraSelect:Ot(t,"cameraSelect"),monitorSelect:Ot(t,"monitorSelect"),videoSelect:Ot(t,"videoSelect"),distanceSelect:Ot(t,"distanceSelect"),batterySelect:Ot(t,"batterySelect"),motorSelects:Ot(t,"motorSelects"),controllerSelects:Ot(t,"controllerSelects"),setupDiagramContainer:Z})}catch(ae){Ar("cineResults.updateCalculations could not render setup diagram.",ae)}var Pr=Ht("refreshGearListIfVisible");if(Pr)try{Pr()}catch(ae){Ar("cineResults.updateCalculations could not refresh gear list.",ae)}}catch(Ht){throw Ar("cineResults.updateCalculations total failure",Ht),Ht}}function kde(e){var t=e||{},r=f_(t),n=ns(t);fde(n);var o=Ot(t,"runtimeFeedbackButton","runtimeFeedbackBtn","runtimeFeedbackBtn"),a=Ot(t,"feedbackDialog","feedbackDialog","feedbackDialog"),i=Ot(t,"feedbackForm","feedbackForm","feedbackForm"),s=Ot(t,"feedbackCancelBtn","fbCancel","feedbackCancelBtn"),l=Ot(t,"feedbackUseLocationBtn","fbUseLocationBtn","feedbackUseLocationBtn"),c=Ot(t,"sensorModeSelect","fbSensorMode","sensorModeSelect"),u=Ot(t,"framerateSelect","fbFramerate","framerateSelect");we.elements.runtimeFeedbackButton=o,we.elements.feedbackDialog=a,we.elements.feedbackForm=i,we.elements.feedbackCancelBtn=s,we.elements.feedbackUseLocationBtn=l,c&&(we.elements.sensorModeSelect=c),u&&(we.elements.framerateSelect=u);function f(C){if(!a)return!1;var k=r.closeDialog;if(typeof k=="function")try{return k(a),!0}catch(_){C&&Ar(C,_)}if(typeof a.close=="function")try{return a.close(),!0}catch{}return!1}function d(C){if(typeof C=="number"&&Number.isFinite(C))return String(C);if(typeof C!="string"){if(C==null)return"";C=String(C)}var k=C.trim();return!k||k.toLowerCase()==="none"?"":k}function p(C,k,_){var w=C;if(!w&&n&&typeof n.getElementById=="function"&&k)try{w=n.getElementById(k)}catch{w=null}if(!w)return"";var x="";try{var G=w.options,T=typeof w.selectedIndex=="number"?w.selectedIndex:-1;if(G&&T>=0&&T<G.length){var P=G[T];P&&(typeof P.text=="string"&&P.text?x=P.text:typeof P.textContent=="string"&&P.textContent?x=P.textContent:typeof P.label=="string"&&P.label?x=P.label:typeof P.value=="string"&&P.value&&(x=P.value))}!x&&typeof w.value=="string"&&(x=w.value)}catch(N){_&&Ar(_,N),x=""}return d(x)}function h(){var C=we&&we.elements?we.elements.cameraSelect:null;return p(C,"cameraSelect","cineResults could not inspect camera selection for runtime feedback prefill.")}function m(){var C="",k=r&&typeof r.getSelectedPlate=="function"?r.getSelectedPlate:null;if(k)try{C=d(k())}catch(w){Ar("cineResults could not resolve battery plate selection via helper for runtime feedback.",w),C=""}if(C)return C;var _=we&&we.elements?we.elements.batteryPlateSelect:null;return p(_,"batteryPlateSelect","cineResults could not inspect battery plate selection for runtime feedback prefill.")}function g(){var C=we&&we.elements?we.elements.batterySelect:null;return p(C,"batterySelect","cineResults could not inspect battery selection for runtime feedback prefill.")}function S(){var C=we&&we.elements?we.elements.monitorSelect:null;return p(C,"monitorSelect","cineResults could not inspect monitor selection for runtime feedback prefill.")}function y(){var C=we&&we.elements?we.elements.videoSelect:null;return p(C,"videoSelect","cineResults could not inspect wireless video selection for runtime feedback prefill.")}function E(){var C=we&&we.elements?we.elements.distanceSelect:null;return p(C,"distanceSelect","cineResults could not inspect FIZ distance selection for runtime feedback prefill.")}function L(C,k,_){var w=[],x=Array.isArray(C)?C:[];if((!x||!x.length)&&n&&typeof n.getElementById=="function"&&Array.isArray(k)){for(var G=[],T=0;T<k.length;T+=1){var P=k[T];if(P){var N=null;try{N=n.getElementById(P)}catch{N=null}N&&G.push(N)}}x=G}for(var q=0;q<x.length;q+=1){var Z=x[q],U=Array.isArray(k)&&q<k.length?k[q]:null,K=p(Z,U,_);K&&w.indexOf(K)===-1&&w.push(K)}return w}function v(){var C=we&&we.elements?we.elements.motorSelects:null;return L(C,["motor1Select","motor2Select","motor3Select","motor4Select"],"cineResults could not inspect FIZ motor selection for runtime feedback prefill.")}function A(){var C=we&&we.elements?we.elements.controllerSelects:null;return L(C,["controller1Select","controller2Select","controller3Select","controller4Select"],"cineResults could not inspect FIZ controller selection for runtime feedback prefill.")}function R(C,k){if(!(!C||typeof C!="object"||typeof C.value>"u")){var _=typeof k=="string"?k:d(k);typeof _!="string"&&(_="");var w=typeof C.tagName=="string"?C.tagName.toUpperCase():"";if(w==="SELECT")try{var x=C.options,G=!1;if(x&&typeof x.length=="number")for(var T=0;T<x.length;T+=1){var P=x[T];if(P){var N=typeof P.value=="string"?P.value:"",q=typeof P.text=="string"?P.text:P.textContent;if(N===_||q===_){P.selected=!0,G=!0;break}}}if(!G)if(_){var Z=C.ownerDocument&&typeof C.ownerDocument.createElement=="function"?C.ownerDocument:null,U=Z?Z.createElement("option"):null;U&&(U.value=_,U.textContent=_,C.appendChild(U),U.selected=!0,G=!0)}else typeof C.selectedIndex=="number"&&(C.selectedIndex=-1);if(G){C.value=_;return}}catch(K){Ar("cineResults could not update runtime feedback select prefill.",K)}try{C.value=_}catch(K){Ar("cineResults could not update runtime feedback field prefill.",K)}}}function I(){if(n){for(var C=BU(n),k=null,_=null,w=null,x=null,G=null,T=null,P=null,N=null,q=0;q<C.length;q+=1){var Z=C[q];!Z||!Z.map||(Z.map.key==="camera"&&!k?k=Z:Z.map.key==="batteryPlate"&&!_?_=Z:Z.map.key==="battery"&&!w?w=Z:Z.map.key==="wirelessVideo"&&!x?x=Z:Z.map.key==="monitor"&&!G?G=Z:Z.map.key==="distance"&&!T?T=Z:Z.map.key==="controllers"&&!P?P=Z:Z.map.key==="motors"&&!N&&(N=Z))}if(k&&k.element&&R(k.element,h()),_&&_.element&&R(_.element,m()),w&&w.element&&R(w.element,g()),x&&x.element&&R(x.element,y()),G&&G.element&&R(G.element,S()),T&&T.element&&R(T.element,E()),P&&P.element){var U=A();R(P.element,U.join(", "))}if(N&&N.element){var K=v();R(N.element,K.join(", "))}}}return kp(o,"click","openDialog",function(){return function(){if(I(),!!a){var k=r.openDialog;if(typeof k=="function")try{k(a);return}catch(_){Ar("cineResults could not open runtime feedback dialog.",_)}if(typeof a.showModal=="function")try{a.showModal()}catch{}}}}),kp(c,"change","sensorModeChange",function(){return function(){var k="";c&&typeof c.value=="string"&&(k=c.value),we.selectedSensorMode=k,t5(k,"")}}),kp(a,"click","dialogBackdrop",function(){return function(k){if(a){var _=k?k.target:null;_===a&&f("cineResults could not close runtime feedback dialog from backdrop interaction.")}}}),kp(s,"click","cancelDialog",function(){return function(){f("cineResults could not close runtime feedback dialog via helper.")}}),kp(l,"click","useLocation",function(){return function(){if(l){var k=r.navigator,_=r.alert;if(!k||!k.geolocation||typeof k.geolocation.getCurrentPosition!="function"){typeof _=="function"&&_("Geolocation is not supported by your browser");return}l.disabled=!0;var w=function(G){try{if(!n)return;var T=null;try{T=n.getElementById("fbLocation")}catch(U){T=null}if(!T)return;var P=G&&G.coords&&typeof G.coords.latitude=="number"?G.coords.latitude:null,N=G&&G.coords&&typeof G.coords.longitude=="number"?G.coords.longitude:null;if(P===null||N===null)return;var q=P.toFixed?P.toFixed(5):String(P),Z=N.toFixed?N.toFixed(5):String(N);T.value=q+", "+Z}finally{l.disabled=!1}},x=function(G){if(l.disabled=!1,typeof console<"u"&&typeof console.error=="function"&&console.error("Geolocation failed:",G),typeof _=="function"){var T="Unable to retrieve your location";G&&G.message&&(T+=": "+G.message),_(T)}};k.geolocation.getCurrentPosition(w,function(G){typeof console<"u"&&typeof console.warn=="function"&&console.warn("High accuracy geolocation failed, retrying with low accuracy",G),k.geolocation.getCurrentPosition(w,x,{enableHighAccuracy:!1,timeout:1e4,maximumAge:0})},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}}}),kp(i,"submit","submitFeedback",function(){return function(k){if(k&&typeof k.preventDefault=="function")try{k.preventDefault()}catch{}if(n){for(var _={},w=BU(n),x=0;x<w.length;x+=1){var G=w[x],T=G.map,P=G.element;if(!(!T||!T.key)){var N="";P&&typeof P.value<"u"&&(N=String(P.value),T.trim&&N&&(N=N.trim())),_[T.key]=N}}var q="";try{q=r.getCurrentSetupKey?r.getCurrentSetupKey():""}catch(Ne){Ar("cineResults could not resolve the current setup key for runtime feedback.",Ne),q=""}var Z=null;try{Z=r.loadFeedback?r.loadFeedback():{}}catch(Ne){Ar("cineResults could not load runtime feedback from storage.",Ne),Z={}}(!Z||typeof Z!="object")&&(Z={}),Z[q]||(Z[q]=[]),Z[q].push(_);try{typeof r.saveFeedback=="function"&&r.saveFeedback(Z)}catch(Ne){Ar("cineResults could not save runtime feedback entry.",Ne)}for(var U=[],K=0;K<w.length;K+=1){var H=w[K].map;!H||!H.key||U.push(H.key+": "+(_[H.key]||""))}var te=encodeURIComponent("Cine Power Planner Runtime Feedback"),re=encodeURIComponent(U.join(`
`)),fe=r.mailTarget||"info@lucazanner.de",Oe="mailto:"+fe+"?subject="+te+"&body="+re,Te=r.window||bt;if(Te&&Te.location)try{Te.location.href=Oe}catch(Ne){Ar("cineResults could not trigger runtime feedback email composition.",Ne)}if(a&&f("cineResults could not close runtime feedback dialog after submit."),typeof r.updateCalculations=="function")try{r.updateCalculations()}catch(Ne){Ar("cineResults could not refresh calculations after runtime feedback submit.",Ne)}}}}),!!(o&&a&&i)}var g_={localizeResultsSection:Ode,localizeBatteryComparisonSection:xde,updateCalculations:m_,setupRuntimeFeedback:kde,renderTemperatureNote:p_};typeof we<"u"&&we&&we.dependencies&&(we.dependencies.updateCalculations=m_);QY(g_);we&&we.dependencies&&(we.dependencies.renderTemperatureNote=p_);u_("renderTemperatureNote",p_,{configurable:!0,enumerable:!1,writable:!0});u_("updateCalculations",m_,{configurable:!0,enumerable:!1,writable:!0});Zfe("cineResults",g_,{category:"ui",description:"Power summary localisation and runtime feedback coordination.",replace:!0},function(e){Ar("Unable to register cineResults module.",e)});u_("cineResults",g_,{configurable:!0,enumerable:!1,writable:!1});if(typeof document<"u"){let e=function(y){for(var E=y;E&&E!==document&&E!==document.body;){if(E.classList&&E.classList.contains("form-row"))return E;E=E.parentNode}return null},t=function(y){return y?typeof y.closest=="function"?y.closest(".form-row"):e(y):null},r=function(y){y&&(y.removeEventListener("change",g),y.removeEventListener("input",g))},n=function(y){y&&(y.addEventListener("change",g),y.addEventListener("input",g))},o=function(y){Ef&&DE!==y&&(Ef.disconnect(),Ef=null,DE=null),!(!y||typeof MutationObserver!="function")&&(Ef||(Ef=new MutationObserver(g)),DE!==y&&(Ef.disconnect(),Ef.observe(y,{attributes:!0,attributeFilter:["hidden","selected","value"],childList:!0,subtree:!0}),DE=y))},a=function(){var y=document.getElementById(Ide);_E!==y&&(r(_E),_E=y,n(_E)),o(y)},i=function(y){y.observer&&y.observerTarget!==y.select&&(y.observer.disconnect(),y.observer=null,y.observerTarget=null),!(!y.select||typeof MutationObserver!="function")&&(y.observer||(y.observer=new MutationObserver(g)),y.observerTarget!==y.select&&(y.observer.disconnect(),y.observer.observe(y.select,{attributes:!0,attributeFilter:["hidden","selected","value"],childList:!0,subtree:!0}),y.observerTarget=y.select))},s=function(y){var E=document.getElementById(y.id);y.select!==E?(r(y.select),y.select=E,y.row=t(E),n(y.select)):(!y.row||y.row&&!y.row.contains(y.select))&&(y.row=t(y.select)),i(y)},l=function(){var y=document.getElementById(Gde);NU!==y&&(ky&&(ky.disconnect(),ky=null),NU=y,!(!y||typeof MutationObserver!="function")&&(ky=new MutationObserver(g),ky.observe(y,{attributes:!0,attributeFilter:["hidden"],childList:!0,subtree:!0})))},c=function(){a();for(var y=0;y<Af.length;y+=1)s(Af[y]);l()},u=function(y){return y==null?"":typeof y=="string"?y:String(y)},f=function(){var y=document.getElementById(Bde);if(!y)return!1;for(var E=y.querySelectorAll("[data-condition]"),L=0;L<E.length;L+=1){var v=E[L];if(v){var A=v.getAttribute("data-condition");if(Pde.indexOf(A)!==-1&&!v.hidden&&v.getAttribute("aria-hidden")!=="true")return!0}}return!1},d=function(y){if(!y)return!1;var E=y.selectedOptions||y.options;if(!E)return!1;for(var L=0;L<E.length;L+=1){var v=E[L];if(!(!v||!v.selected)){var A=u(v.value).trim();if(A.length>0)return!0;var R=u(v.textContent).trim();if(R.length>0)return!0}}return!1},p=function(){for(var y=0;y<Af.length;y+=1)if(d(Af[y].select))return!0;return!1},h=function(){for(var y=f()||p(),E=0;E<Af.length;E+=1){var L=Af[E];if((!L.row||!L.select||!L.row.contains(L.select))&&(L.row=t(L.select)),L.row){var v=!y;L.row.hidden!==v&&(L.row.hidden=v)}}},m=function(){c(),h()},g=function(){Ak===null&&(Ak=setTimeout(function(){Ak=null,m()},0))},S=function(){m()};for(var Ide="autoGearScenarios",DU=["autoGearVideoDistribution","autoGearMonitor","autoGearWireless"],Pde=["videoDistribution","monitor","wireless"],Bde="autoGearConditionList",Gde="autoGearEditor",_E=null,Ef=null,DE=null,Af=[],NU=null,ky=null,Ak=null,Ck=0;Ck<DU.length;Ck+=1)Af.push({id:DU[Ck],select:null,row:null,observer:null,observerTarget:null});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",S):S(),typeof window<"u"&&(window.autoGearMonitoringVisibility||(window.autoGearMonitoringVisibility={}),window.autoGearMonitoringVisibility.refresh=function(){m()})}function Mde(){const e=[];return typeof globalThis<"u"&&globalThis&&e.indexOf(globalThis)===-1&&e.push(globalThis),typeof window<"u"&&window&&e.indexOf(window)===-1&&e.push(window),typeof self<"u"&&self&&e.indexOf(self)===-1&&e.push(self),typeof global<"u"&&global&&e.indexOf(global)===-1&&e.push(global),e}function _de(){return t3}function Dde(){const e=Mde();for(let t=0;t<e.length;t+=1){const r=e[t];if(!r||typeof r!="object"&&typeof r!="function")continue;let n=null;try{n=r.cineLogging||null}catch{n=null}if(n&&typeof n.createLogger=="function")try{return n.createLogger("overview",{meta:{source:"overview-dialog"}})}catch(o){try{typeof n.error=="function"&&n.error("Failed to create overview logger",o,{namespace:"overview-bootstrap"})}catch{}}}return null}(()=>{const e=_de();if(e&&typeof e.resolveLogger=="function")try{const t=e.resolveLogger("overview",{meta:{source:"overview-dialog"}});if(t)return t}catch{}return Dde()})();function Nde(){return typeof globalThis<"u"&&globalThis?globalThis:typeof window<"u"&&window?window:typeof self<"u"&&self?self:typeof global<"u"&&global?global:null}function FU(e){if(e===null||typeof e!="object")return e;try{return JSON.parse(JSON.stringify(e))}catch{}return e}function Fde(e){if(typeof structuredClone=="function")return structuredClone;if(e&&typeof e.structuredClone=="function")try{return e.structuredClone.bind(e)}catch{}if(typeof require=="function"){try{const t=require("node:util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}try{const t=require("util");if(t&&typeof t.structuredClone=="function")return t.structuredClone.bind(t)}catch{}}return null}function jde(e){const t=Fde(e);return t?function(n){if(n===null||typeof n!="object")return n;try{return t(n)}catch{}return FU(n)}:FU}(()=>{const e=Nde();return e&&typeof e.__cineDeepClone=="function"?e.__cineDeepClone:jde(e)})();console.log(" Overview module loaded (ESM)");var Hde="settingsDialog",y_="gearListAutosaveNote",jU="gearListAutosaveOverlayNote",r5="is-visible",gl=null,En=null,Ei=null,HU="",Iy=null,Py=null,wk=null;function Ude(){return typeof document>"u"?null:((!gl||!document.contains(gl))&&(gl=document.getElementById(Hde)||null),gl)}function zde(e){return e?((!En||!e.contains(En))&&(En=e.querySelector("#"+jU)),En||(En=document.createElement("p"),En.id=jU,En.className="gear-list-autosave-note gear-list-autosave-note--overlay",En.setAttribute("role","status"),En.setAttribute("aria-live","polite"),En.setAttribute("aria-atomic","true"),En.hidden=!0,En.setAttribute("aria-hidden","true"),e.appendChild(En)),En):null}function eB(){En&&(En.textContent="",En.hidden=!0,En.setAttribute("aria-hidden","true"),En.classList&&En.classList.remove(r5)),gl&&gl.classList&&gl.classList.remove("has-gear-list-note")}function AR(e){if(En){var t=e&&e.textContent?e.textContent:"";t!==HU&&(HU=t,En.textContent=t,t||eB())}}function Ng(e){if(!(!En||!gl)){if(!e||e.hidden||e.offsetParent===null){eB();return}if(!gl.open){eB();return}En.hidden=!1,En.removeAttribute("aria-hidden"),En.classList&&En.classList.add(r5),gl.classList&&gl.classList.add("has-gear-list-note")}}function n5(e){Iy&&(Iy.disconnect(),Iy=null),!(!e||typeof MutationObserver!="function")&&(Iy=new MutationObserver(function(){AR(e),Ng(e)}),Iy.observe(e,{childList:!0,subtree:!0,characterData:!0,attributes:!0}))}function $de(e){Py&&(Py.disconnect(),Py=null),!(!e||typeof MutationObserver!="function")&&(Py=new MutationObserver(function(){Ng(Ei)}),Py.observe(e,{attributes:!0,attributeFilter:["open"]}))}function Vde(){wk||typeof MutationObserver!="function"||(wk=new MutationObserver(function(){var e=document.getElementById(y_);e!==Ei&&(Ei=e||null,n5(Ei),AR(Ei),Ng(Ei))}),wk.observe(document.body,{childList:!0,subtree:!0}))}function qde(e){if(!(!e||typeof e.addEventListener!="function")){var t=function(){Ng(Ei)};e.addEventListener("close",t),e.addEventListener("cancel",t),e.addEventListener("submit",t)}}function Kde(){typeof window>"u"||typeof window.addEventListener!="function"||window.addEventListener("languagechange",function(){Ei=document.getElementById(y_)||null,AR(Ei),Ng(Ei)})}function UU(){if(!(typeof document>"u")){var e=Ude();e&&(zde(e),Ei=document.getElementById(y_)||null,AR(Ei),Ng(Ei),$de(e),n5(Ei),Vde(),qde(e),Kde())}}typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",UU,{once:!0}):UU());const he=typeof window<"u"?window:{},Me=Rn.safeWarn;function Wde(){if(!he||typeof he.matchMedia!="function")return!1;try{return he.matchMedia("(prefers-reduced-motion: reduce)").matches===!0}catch{}return!1}function h_(e){if(typeof Rn.collectCandidateScopes=="function")try{return Rn.collectCandidateScopes(e)}catch(t){Me("cine.features.onboardingTour could not collect candidate scopes.",t)}return[e]}function Yde(e){const t=h_(e||he);for(let r=0;r<t.length;r+=1){const n=t[r];if(n)try{if(n.document&&typeof n.document.getElementById=="function")return n.document}catch{}}return null}const W=Yde(he),ud="cinePowerPlanner_onboardingTutorial",Qde=["cameraPowerPlanner_onboardingTutorial"],sL=[ud,...Qde],Vb=`${ud}:skip`,o5=`${Vb}=true`,ys=2,a5="onboardingTutorialOverlay",i5="helpOnboardingTutorialButton",b_="[data-onboarding-tour-trigger]",Xde="helpOnboardingTutorialStatus",Jde="mainContent",Zde="topBar",epe=44,zU=1.5,tpe=.97,$U=[{maxViewportRem:48,marginRem:1.15},{maxViewportRem:26,marginRem:.75}],rpe=120,npe=24;function s5(e,t){const r=Number.isFinite(t)&&t>0?t:16;if(!Number.isFinite(e)||e<=0)return Math.max(0,zU*r);const n=e/r;let o=zU;if(Number.isFinite(n))for(let a=0;a<$U.length;a+=1){const i=$U[a];i&&Number.isFinite(i.maxViewportRem)&&n<=i.maxViewportRem&&(o=i.marginRem)}return Math.max(0,o*r)}const Rg=(function(){if(!W||typeof W.createElement!="function"||(function(){if(!he||!he.navigator)return!1;const n=he.navigator.userAgent||"",o=he.navigator.vendor||"";return/Safari/.test(n)&&/Apple Computer/.test(o)&&!/Chrome|Chromium|Edg/.test(n)})())return!1;try{const r=W.createElement("dialog");return typeof r.show=="function"&&typeof r.close=="function"}catch{return!1}})(),ope=typeof Node<"u"&&Node?Node.DOCUMENT_POSITION_FOLLOWING:4,ape=typeof Node<"u"&&Node?Node.DOCUMENT_POSITION_PRECEDING:2,l5=["button:not([disabled])","a[href]",'input:not([disabled]):not([type="hidden"])',"select:not([disabled])","textarea:not([disabled])",'[role="button"]:not([aria-disabled="true"])','[tabindex]:not([tabindex="-1"])'].join(",");function VU(e){return!e||typeof e.matches!="function"||e.hasAttribute("disabled")||e.getAttribute&&e.getAttribute("aria-disabled")==="true"||e.hidden||typeof e.getAttribute=="function"&&e.getAttribute("hidden")!==null||typeof e.closest=="function"&&(e.closest('[aria-hidden="true"]')||e.closest("[hidden]"))?!1:e.matches(l5)}function qU(e,t=!1){if(!e)return[];const r=[];if(t&&VU(e)&&r.push(e),typeof e.querySelectorAll!="function")return r;const n=e.querySelectorAll(l5);for(let o=0;o<n.length;o+=1){const a=n[o];VU(a)&&r.push(a)}return r}function ipe(e){return Array.isArray(e)?e.slice().sort((t,r)=>{if(!t||!r||t===r||typeof t.compareDocumentPosition!="function")return 0;const n=t.compareDocumentPosition(r);return n&ope?-1:n&ape?1:0}):[]}function c5(){if(!W||!W.documentElement)return 16;const e=W.documentElement;try{const r=e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:W.defaultView||he;if(r&&typeof r.getComputedStyle=="function"){const n=r.getComputedStyle(e);if(n&&typeof n.fontSize=="string"){const o=parseFloat(n.fontSize);if(Number.isFinite(o)&&o>0)return o}}}catch{}const t=e&&e.style&&typeof e.style.fontSize=="string"?parseFloat(e.style.fontSize):NaN;return Number.isFinite(t)&&t>0?t:16}function lL(e){return!!(e&&typeof e.nodeName=="string"&&e.nodeName.toLowerCase()==="dialog")}function Tg(){if(Je&&!(Du&&W&&Du!==W.body)){if(Je.style&&(Je.style.pointerEvents="none"),Rg&&lL(Je)&&typeof Je.show=="function"){try{Je.open&&typeof Je.close=="function"&&Je.close()}catch{}try{Je.show(),Je.style&&(Je.style.pointerEvents="none")}catch(e){Me("cine.features.onboardingTour could not refresh overlay top layer.",e)}return}if(Je.parentNode&&typeof Je.parentNode.appendChild=="function")try{Je.parentNode.appendChild(Je)}catch(e){Me("cine.features.onboardingTour could not move overlay to front.",e)}}}function u5(e){if(!wo||!e||!e.target)return;const t=e.target;t!==Je&&lL(t)&&t.open&&Tg()}function spe(){if(typeof getSafeLocalStorage=="function")try{const e=getSafeLocalStorage();if(e&&typeof e.getItem=="function")return e}catch(e){Me("cine.features.onboardingTour could not access getSafeLocalStorage()",e)}if(typeof SAFE_LOCAL_STORAGE=="object"&&SAFE_LOCAL_STORAGE)return SAFE_LOCAL_STORAGE;try{if(typeof he.localStorage=="object"&&he.localStorage)return he.localStorage}catch(e){Me("cine.features.onboardingTour could not access window.localStorage.",e)}return null}const lpe=spe();function By(e,t){if(!(!e||!Array.isArray(e))&&t){try{const r=typeof t.getItem=="function",n=typeof t.setItem=="function";if(!r&&!n)return}catch{return}e.indexOf(t)===-1&&e.push(t)}}function CR(){const e=[];By(e,lpe);try{if(typeof getSafeLocalStorage=="function"){const r=getSafeLocalStorage();By(e,r)}}catch{}typeof SAFE_LOCAL_STORAGE=="object"&&SAFE_LOCAL_STORAGE&&By(e,SAFE_LOCAL_STORAGE);const t=h_(he);for(let r=0;r<t.length;r+=1){const n=t[r];if(n){try{n.localStorage&&By(e,n.localStorage)}catch{}try{n.sessionStorage&&By(e,n.sessionStorage)}catch{}}}return e}function cpe(){try{if(he&&typeof he.name=="string")return he.name.indexOf(o5)!==-1}catch{}return!1}function upe(e){try{if(!he||typeof he.name>"u")return!1;const r=(typeof he.name=="string"?he.name:"").split(";").map(o=>o.trim()).filter(Boolean).filter(o=>o.indexOf(`${Vb}=`)!==0);e&&r.push(o5);const n=r.join("; ");return he.name=n,!0}catch{return!1}}function f5(){const e=CR();for(let t=0;t<e.length;t+=1){const r=e[t];if(!(!r||typeof r.getItem!="function"))try{const n=r.getItem(Vb);if(n===null||typeof n>"u")continue;if(n===!0||n==="true")return!0;if(n===!1||n==="false")return!1;try{const o=JSON.parse(n);if(o===!0||o===!1)return o}catch(o){}}catch{}}return cpe()?!0:null}function AS(e){const t=CR();let r=!1;for(let o=0;o<t.length;o+=1){const a=t[o];if(a){if(e===!1&&typeof a.removeItem=="function")try{a.removeItem(Vb),r=!0;continue}catch{}if(typeof a.setItem=="function")try{a.setItem(Vb,e?"true":"false"),r=!0}catch{}}}const n=upe(!!e);return r||n}let xf=null,d5=null,zh=null;const As={lastAdded:null,lastReviewed:null,lastUpdated:null},$h=[];function NE(e){if(!e||typeof e!="object")return null;const t=typeof e.name=="string"?e.name.trim():"",r=typeof e.category=="string"?e.category.trim():"";let n=null;if(typeof e.subcategory=="string"){const o=e.subcategory.trim();o&&(n=o)}return!t||!r?null:{name:t,category:r,subcategory:n}}function tB(e,t){if(!e||!t)return!1;const r=n=>typeof n=="string"?n.trim().toLowerCase():"";return r(e.name)===r(t.name)&&r(e.category)===r(t.category)&&r(e.subcategory||"")===r(t.subcategory||"")}function Lk(){if(!$h.length)return;const e=$h.slice();for(let t=0;t<e.length;t+=1){const r=e[t];if(typeof r=="function")try{r(As)}catch(n){Me("cine.features.onboardingTour could not deliver device library update.",n)}}}function fpe(e){return typeof e!="function"?()=>{}:($h.push(e),()=>{const t=$h.indexOf(e);t!==-1&&$h.splice(t,1)})}W&&typeof W.addEventListener=="function"&&(W.addEventListener("device-library:add",e=>{const t=NE(e&&e.detail);As.lastAdded=t,As.lastReviewed=null,As.lastUpdated=null,Lk()}),W.addEventListener("device-library:show-details",e=>{const t=NE(e&&e.detail);As.lastReviewed=t,Lk()}),W.addEventListener("device-library:update",e=>{const t=NE(e&&e.detail),r=NE(e&&e.detail&&e.detail.original);!t&&!r?As.lastUpdated=null:As.lastUpdated={current:t,original:r},Lk()}));function KU(e){if(typeof Rn.freezeDeep=="function")try{return Rn.freezeDeep(e)}catch(t){Me("cine.features.onboardingTour could not deep-freeze value.",t)}return e}const cL=["intro","userProfile","unitsPreferences","nameProject","saveProject","addCamera","addMonitoring","selectBattery","resultsTotalDraw","resultsBatteryPacks","resultsChangeover","resultsWarnings","batteryComparison","runtimeFeedback","connectionDiagram","connectionDiagramDetails","editDeviceDataAdd","editDeviceDataReview","editDeviceDataEdit","ownGearAccess","ownGearAddDevice","projectRequirementsAccess","projectRequirementsBrief","projectRequirementsCrew","projectRequirementsLogistics","generateGearAndRequirements","autoGearRulesAccess","autoGearRulesEdit","autoGearRulesCreate","gearList","exportImport","overviewAndPrint","help","settingsGeneral","settingsData","settingsBackup","completion"];function dpe(){if(!W)return[];if(!io&&typeof W.getElementById=="function")try{io=W.getElementById("ownGearDialog")}catch{io=null}let e=null;try{e=W.getElementById("sideMenu")}catch{e=null}let t=null;e&&typeof e.querySelector=="function"&&(t=e.querySelector('[data-sidebar-action="open-own-gear"]')),!t&&typeof W.querySelector=="function"&&(t=W.querySelector('#sideMenu [data-sidebar-action="open-own-gear"]')||W.querySelector('[data-sidebar-action="open-own-gear"]'));let r=null;try{r=W.getElementById("menuToggle")}catch{r=null}const n=!!(e&&typeof e.classList=="object"&&typeof e.classList.contains=="function"&&e.classList.contains("open")),o=[],a=i=>{typeof i!="string"||!i||o.indexOf(i)===-1&&o.push(i)};if(io&&typeof Kb=="function"){let i=!1;try{i=Kb()}catch(s){Me("cine.features.onboardingTour could not determine Own Gear dialog highlight state.",s)}i&&a("#ownGearDialog")}return n&&t?a('#sideMenu [data-sidebar-action="open-own-gear"]'):!n&&r?a("#menuToggle"):t?a('#sideMenu [data-sidebar-action="open-own-gear"]'):r&&a("#menuToggle"),o}const ppe={intro:{title:"",body:"",hero:{heading:"Step 1  Welcome aboard",subheading:"Power planning without losing data",summary:"Preview how Cine Power Planner protects work-in-progress before you add your first camera. The tour keeps progress local, explains every safety net and helps you confirm each safeguard.",badgeIcon:"",badgeLabel:"Offline-first & private",badgeDescription:"No servers, no accounts, no risk. Saves, autosaves, backups, restores, shares and imports never leave this device.",highlights:[{icon:"",title:"Lock in power, safety, and backups",body:"Model draw, runtime, changeovers, and redundant pack coverage so battery safety margins are confirmed before rolling."},{icon:"",title:"AutoGear builds reusable kits",body:"Generate full gear lists from shooting scenarios with AutoGear rules, adjust those rules for the day, and reuse the presets."},{icon:"",title:"Project requirements ready to hand off",body:"Track requirements, crew coverage, and rental notes, then export PDF packets the crew, rental, and production rely on."}],languageLabel:"Choose your language",languageHint:"Switch languages nowthe tutorial, help and exports update instantly across offline saves.",offlineSummary:"Install the Cine Power Planner PWA to mirror safeguarded saves, backups, shares and restore rehearsals on set without subscriptions."}},userProfile:{title:"Complete your crew profile",body:"Set your display name, role, phone, email and photo. Every update syncs to Contacts immediately, stays in offline saves and appears on exports."},unitsPreferences:{title:"Tune theme and units",body:"Open Settings  General to choose the theme, optional pink highlights, focus scale and temperature units. Request persistent storage so the browser keeps preferences and safeguards saves during cleanups."},nameProject:{title:"Name your first project",body:"Give the project a descriptive name to anchor autosave, history, exports and backups. Every workflow references it so your offline library stays organized and easy to restore."},saveProject:{title:"Capture an immediate save",body:"Select Save (or press Ctrl+S/S/Enter) to capture a complete offline snapshotdevices, power math, requirements, notes and diagnostics. The next workflow unlocks once the save finishes."},addCamera:{title:"Select the primary camera",body:"Choose the camera body you are planning. Offline search works inside the menu. That selection unlocks matching accessories, power draws and diagrams."},addMonitoring:{title:"Add monitors, wireless video and FIZ",body:"Pick onboard monitors, wireless transmitters and FIZ motors or controllers. Each selection feeds runtime math, diagrams and automatic gear rules so the generated kit reflects the full build."},selectBattery:{title:"Choose batteries",body:"Select the battery system that powers the rig. Runtime projections update immediately and the selection is stored with your offline project snapshots and backups."},resultsTotalDraw:{title:"Power Summary: Total draw",body:"Start your Power Summary review by confirming the Total Draw card and peak load so the demand math stays accurate before moving on to deeper checks."},resultsBatteryPacks:{title:"Power Summary: Battery runtimes",body:"Review each battery pack's projected runtime, all framed around a worst-case draw so most kits run longerhelping you know how many packs to bring, feel confident the rig won't demand constant swaps, and automatically pair the right batteries with each camera."},resultsChangeover:{title:"Power Summary: Changeovers",body:"Step through the changeover list to check remaining runtime, confirm the next charged pack is staged and mark swaps as complete so the saved snapshot reflects the current handoff plan."},resultsWarnings:{title:"Power Summary: Warnings and backups",body:"Check the connector warning boxes: green shows the pin or D-Tap battery feed is safe, yellow means the battery feed is near its limit, and red means the camera rig is pulling more power than the battery can supply."},batteryComparison:{title:"Battery Comparison",body:"Battery Comparison evaluates alternate packs side by side so you can lock in the safest runtime margin. The table shows which batteries can power the riggreen pins and D-Tap feeds are safe, orange pins-only outputs cover the rig without D-Tap supportand how long each pack runs."},runtimeFeedback:{title:"Submit runtime feedback",body:"Use the runtime feedback button to log real-world results. Entries sync with the current project, strengthen future estimates and remain available offline for audits."},connectionDiagram:{title:"Inspect the connection diagram",body:"The interactive diagram shows how power, video and control gear connect. Drag nodes to plan rig layout, double-click devices to pop open hover details, then save so the arrangement and annotations persist across exports and restores."},connectionDiagramDetails:{title:"Open device hover details",body:"Double-click any device node in the diagram to reveal its hover detail popup. Review draw notes, connector callouts and saved annotations, then close it to continue arranging the layout before saving."},editDeviceDataAdd:{title:"Add a device to the library",body:"Open Device Library, pick a category, name the item and record its draw or connector data. Press Add so the new device is stored offline, included in autosave and ready for backups and exports."},editDeviceDataReview:{title:"Review the device details",body:"Find the device you just saved inside Existing Devices and open its details. Confirm the draw, outputs and compatibility metadata look correct before relying on it in runtime math or shares."},editDeviceDataEdit:{title:"Update and resave the device",body:"Use the Edit button on that same entry, adjust specs or notes, then save. This verifies autosave, backups and exports all carry the most current numbers without risking any loss of user data."},ownGearAccess:{title:"Open the Own Gear dialog",body:"Press the Own Gear button in the sidebar to launch your inventory dialog, then review the summary banner and the Your gear list so you know where saved items, edit buttons and counts live. Finish by exploring the Add gear formitem search, quantity, notes, plus the Save and Reset controlsso you can add equipment instantly once the tour ends."},ownGearAddDevice:{title:"Add your first owned device",body:"Enter the item name, optional quantity and notes, then save. Owned gear is stored offline, included in backups and marked inside exports so teams instantly see what is available without duplicating requests."},projectRequirementsAccess:{title:"Open Project Requirements from Generate",body:"Press Generate Gear List and Project Requirements to open the requirements form. This confirms the dialog opens from the standard trigger while autosave and backups keep your data safe."},projectRequirementsBrief:{title:"Capture the project brief",body:"Open the Project Requirements dialog from Generate Gear List and Project Requirements, then document production company, address, rental preferences, deliverables and schedule notes. These entries auto-fill rental-ready PDFs, stay cached offline and seed the next sections."},projectRequirementsCrew:{title:"Map crew coverage and contacts",body:"Populate Crew, Prep, Shooting and Return rows with names, roles and coverage notes. Link saved Contacts, flag emergency details and duplicate rows when multiple days share the same assignments. Everything syncs to the saved project so exports list who is on set and when."},projectRequirementsLogistics:{title:"Log lenses, rigging and monitoring plans",body:"Work down the remaining sectionscamera specs, lens workflow, rigging scenarios, storage/media counts, matte box, tripod and monitoring preferences. Each field feeds automatic gear rules, storage math and monitoring assignments so the generated checklist reflects the full shoot plan."},generateGearAndRequirements:{title:"Save and rebuild the outputs",body:"Press OK inside the Project Requirements dialog to save every entry, regenerate the requirements summary and rebuild the categorized gear list. The planner snapshots the result with the active project so exports, backups and shares stay current."},autoGearRulesAccess:{title:"Open Automatic Gear Rules",body:"Go to Settings  Automatic Gear Rules to review automation controls. Opening the tab shows the presets, stock rules (including smart tripod logic that references your head/legs preference) and safety backups stored with your offline saves."},autoGearRulesEdit:{title:"Edit stock automatic gear rules",body:"Use the rules list to inspect factory additions. Select a stock rule to open it in the editor, adjust items or conditions, then save so the updated automation stays cached with backups and share bundles."},autoGearRulesCreate:{title:"Add a new automatic gear rule",body:"Press Add rule to create a custom automation. Name it, add conditions and required gear, then save. The planner runs new rules offline each time you regenerate the kit and includes them in exports, shares and backups."},gearList:{title:"Audit the generated gear list",body:"Check the categorized gear list for duplicates, counts and auto-added accessories. Edits save instantly, are included in share bundles and appear in printouts and PDFs."},exportImport:{title:"Export and import projects",body:"Use Export Project to download a JSON safety copy and Import Project to rehearse restores. Store exports on redundant media so no workstation loses data if a browser profile resets."},overviewAndPrint:{title:"Generate overview, PDF and printouts",body:"Generate the project overview to access PDF, print and share-ready summaries. The dialog uses saved data only, so you can print or export even while fully offline."},help:{title:"Open the Help center",body:"The Help dialog includes searchable documentation, translation notes and onboarding references. Keep it pinned while workingarticles stay cached offline and update when new features arrive."},settingsGeneral:{title:"Revisit Settings  General",body:"Adjust language, typography, theme, pink mode, focus scale and other presentation options anytime. Preferences save locally, sync across projects and are bundled with backups."},settingsData:{title:"Monitor Data & Storage",body:"Use the Data & Storage tab to request persistent storage, watch save timestamps and launch quick safeguards. These controls verify that every project snapshot remains available offline."},settingsBackup:{title:"Maintain Backup & Restore",body:"The Backup & Restore tab manages full-app exports, restore rehearsals and diagnostics. Run backups before major changes, archive the files on external media and verify restores regularly."},completion:{title:"Tutorial complete",body:"You now know every safeguard. Keep saving often, export redundant backups and revisit any step from Help whenever you want a refresher. Cine Power Planner will keep protecting your data offline."}};function p5(e){return!!(e&&e.preface)}function mpe(e){return!!(e&&e.key==="completion")}function Wd(e){return!!(e&&!p5(e)&&!mpe(e))}function wR(e){if(!Array.isArray(e))return 0;let t=0;for(let r=0;r<e.length;r+=1)Wd(e[r])&&(t+=1);return t}function S_(e,t){if(!Array.isArray(e)||typeof t!="number"||t<0||t>=e.length||!Wd(e[t]))return null;let r=-1;for(let n=0;n<=t;n+=1)Wd(e[n])&&(r+=1);return r}function LR(e,t){if(!Array.isArray(e)||!t||typeof t.has!="function")return 0;let r=0;for(let n=0;n<e.length;n+=1){const o=e[n];Wd(o)&&t.has(o.key)&&(r+=1)}return r}function gpe(e,t){if(!Array.isArray(e))return null;for(let r=0;r<e.length;r+=1){const n=e[r];if(Wd(n)&&(!t||typeof t.has!="function"||!t.has(n.key)))return n}return null}function Jr(e){if(typeof e!="string"||!e)return null;try{return W.querySelector(e)}catch(t){return Me("cine.features.onboardingTour could not query selector.",t),null}}function rB(e){return e?typeof e.value=="string"?e.value:typeof e.textContent=="string"?e.textContent:"":""}function Rk(e,t,r){const n=Array.isArray(r)&&r.length?r:["input","change"];return{check(){const o=Jr(e);if(!o)return!1;try{return!!t(rB(o),o)}catch(a){return Me("cine.features.onboardingTour could not evaluate field requirement.",a),!1}},attach(o){const a=Jr(e);if(!a)return typeof o.complete=="function"&&o.complete(),()=>{};const i=()=>{let s=!1;try{s=!!t(rB(a),a)}catch(l){Me("cine.features.onboardingTour could not evaluate field change.",l),s=!1}s?typeof o.complete=="function"&&o.complete():typeof o.incomplete=="function"&&o.incomplete()};for(let s=0;s<n.length;s+=1){const l=n[s];a.addEventListener(l,i)}return i(),()=>{for(let s=0;s<n.length;s+=1){const l=n[s];a.removeEventListener(l,i)}}}}}function WU(e,t){const r=Array.isArray(e)?e.slice():[e],n="click";return{check(){return!1},attach(o){const a=[];let i=!1;for(let s=0;s<r.length;s+=1){const l=r[s],c=Jr(l);if(!c)continue;i=!0;const u=()=>{typeof o.complete=="function"&&o.complete()};c.addEventListener(n,u),a.push(()=>{c.removeEventListener(n,u)})}return!i&&typeof o.complete=="function"&&o.complete(),()=>{for(let s=0;s<a.length;s+=1)try{a[s]()}catch(l){Me("cine.features.onboardingTour could not detach click requirement.",l)}}}}}function ype(){const e="#projectForm";return{check(){return!1},attach(t){const r=Jr(e);if(!r)return typeof t.complete=="function"&&t.complete(),null;typeof t.incomplete=="function"&&t.incomplete();const n=()=>{typeof t.complete=="function"&&t.complete()};return r.addEventListener("submit",n),()=>{try{r.removeEventListener("submit",n)}catch(o){Me("cine.features.onboardingTour could not detach project dialog submit requirement.",o)}}}}}function v_(e){const t=typeof e=="function"?e:(()=>!1);return{check(){try{return!!t()}catch(r){return Me("cine.features.onboardingTour could not evaluate device library requirement.",r),!1}},attach(r){const n=()=>{let a=!1;try{a=!!t()}catch(i){Me("cine.features.onboardingTour could not evaluate device library change.",i),a=!1}a?typeof r.complete=="function"&&r.complete():typeof r.incomplete=="function"&&r.incomplete()},o=fpe(n);return n(),()=>{typeof o=="function"&&o()}}}}function hpe(){return v_(()=>!!As.lastAdded)}function bpe(){return v_(()=>{const e=As.lastAdded,t=As.lastReviewed;return!e||!t?!1:tB(e,t)})}function Spe(){return v_(()=>{const e=As.lastAdded,t=As.lastUpdated;if(!e||!t)return!1;const r=t.current?tB(e,t.current):!1,n=t.original?tB(e,t.original):!1;return r||n})}function uL(){try{return Kb()}catch(e){return Me("cine.features.onboardingTour could not evaluate Own Gear dialog visibility.",e),!1}}function vpe(){return{check(){return uL()},attach({complete:e,incomplete:t}){const r=Jr("#ownGearDialog");if(!r)return null;let n=null;const o=()=>{uL()?e():t()};if(o(),typeof MutationObserver=="function")try{n=new MutationObserver(()=>{o()}),n.observe(r,{attributes:!0,attributeFilter:["open","hidden","aria-hidden"]})}catch(l){Me("cine.features.onboardingTour could not observe Own Gear dialog attributes.",l),n=null}const a=()=>{o()};r.addEventListener("close",a),r.addEventListener("cancel",a);const i=Jr('[data-sidebar-action="open-own-gear"]'),s=()=>{setTimeout(o,100)};return i&&i.addEventListener("click",s),()=>{if(r.removeEventListener("close",a),r.removeEventListener("cancel",a),i&&i.removeEventListener("click",s),n)try{n.disconnect()}catch(l){Me("cine.features.onboardingTour could not disconnect Own Gear dialog observer.",l)}}}}}function Epe(){return{check(){return!uL()&&yL()},attach({complete:e,incomplete:t}){const r=[],n=()=>{!uL()&&yL()?e():t()},o=Jr("#ownGearDialog");if(o){const s=()=>{setTimeout(n,75)};if(o.addEventListener("close",s),o.addEventListener("cancel",s),r.push(()=>{o.removeEventListener("close",s),o.removeEventListener("cancel",s)}),typeof MutationObserver=="function")try{const l=new MutationObserver(()=>{n()});l.observe(o,{attributes:!0,attributeFilter:["open","hidden","aria-hidden"]}),r.push(()=>{l.disconnect()})}catch(l){Me("cine.features.onboardingTour could not observe Own Gear dialog state for project requirements access.",l)}}const a=Jr("#projectDialog");if(a){const s=()=>{setTimeout(n,75)};if(a.addEventListener("close",s),a.addEventListener("cancel",s),r.push(()=>{a.removeEventListener("close",s),a.removeEventListener("cancel",s)}),typeof MutationObserver=="function")try{const l=new MutationObserver(()=>{n()});l.observe(a,{attributes:!0,attributeFilter:["open","hidden","aria-hidden"]}),r.push(()=>{l.disconnect()})}catch(l){Me("cine.features.onboardingTour could not observe project dialog state for requirements access.",l)}}const i=Jr("#generateGearListBtn");if(i){const s=()=>{setTimeout(n,150)};i.addEventListener("click",s),r.push(()=>{i.removeEventListener("click",s)})}return n(),()=>{for(let s=0;s<r.length;s+=1)try{r[s]()}catch(l){Me("cine.features.onboardingTour could not detach project requirements access requirement.",l)}}}}}function YU(){const e=Jr("#ownGearList");if(e&&typeof e.querySelector=="function"&&e.querySelector(".own-gear-item"))return!0;const t=Jr("#ownGearEmptyState");return!!(t&&t.hasAttribute("hidden"))}function Ape(){return{check(){return YU()},attach({complete:e,incomplete:t}){const r=Jr("#ownGearList"),n=Jr("#ownGearEmptyState"),o=()=>{YU()?e():t()};o();let a=null;if(r&&typeof MutationObserver=="function")try{a=new MutationObserver(()=>{o()}),a.observe(r,{childList:!0})}catch(d){Me("cine.features.onboardingTour could not observe Own Gear list changes.",d),a=null}const i=()=>{o()};r&&r.addEventListener("click",i,!0);const s=Jr("#ownGearForm"),l=()=>{setTimeout(o,50)};s&&typeof s.addEventListener=="function"&&s.addEventListener("submit",l);const c=Jr("#ownGearSaveButton"),u=()=>{setTimeout(o,50)};c&&typeof c.addEventListener=="function"&&c.addEventListener("click",u);let f=null;if(n&&typeof MutationObserver=="function")try{f=new MutationObserver(()=>{o()}),f.observe(n,{attributes:!0,attributeFilter:["hidden","aria-hidden"]})}catch(d){Me("cine.features.onboardingTour could not observe Own Gear empty state.",d),f=null}return()=>{if(r&&r.removeEventListener("click",i,!0),s&&typeof s.removeEventListener=="function"&&s.removeEventListener("submit",l),c&&typeof c.removeEventListener=="function"&&c.removeEventListener("click",u),a)try{a.disconnect()}catch(d){Me("cine.features.onboardingTour could not disconnect Own Gear list observer.",d)}if(f)try{f.disconnect()}catch(d){Me("cine.features.onboardingTour could not disconnect Own Gear empty state observer.",d)}}}}}function Cpe(){const e=["#crewContainer .person-row","#prepContainer .period-row","#shootContainer .period-row","#returnContainer .period-row"];for(let t=0;t<e.length;t+=1){const r=e[t];if(r)try{if(W.querySelector(r))return!0}catch(n){Me("cine.features.onboardingTour could not query crew selector.",n)}}return!1}function wpe(){const e=()=>Cpe();return{check(){return e()},attach(t){const r=typeof t?.complete=="function"?t.complete:(()=>{}),n=typeof t?.incomplete=="function"?t.incomplete:(()=>{});if(!Jr("#projectForm"))return r(),null;const a=()=>{e()?r():n()},i=["#crewContainer","#prepContainer","#shootContainer","#returnContainer"],s=["#addPersonBtn","#addPrepBtn","#addShootBtn","#addReturnBtn"],l=[];for(let c=0;c<i.length;c+=1){const u=Jr(i[c]);if(!u)continue;const f=()=>{a()};if(u.addEventListener("input",f),u.addEventListener("change",f),l.push(()=>{u.removeEventListener("input",f)}),l.push(()=>{u.removeEventListener("change",f)}),typeof MutationObserver=="function")try{const d=new MutationObserver(()=>{a()});d.observe(u,{childList:!0,subtree:!0}),l.push(()=>{d.disconnect()})}catch(d){Me("cine.features.onboardingTour could not observe crew container.",d)}}for(let c=0;c<s.length;c+=1){const u=Jr(s[c]);if(!u)continue;const f=()=>{setTimeout(a,120)};u.addEventListener("click",f),l.push(()=>{u.removeEventListener("click",f)})}return a(),()=>{for(let c=0;c<l.length;c+=1)try{l[c]()}catch(u){Me("cine.features.onboardingTour could not detach crew requirement listener.",u)}}}}}function QU(){const e=["#deliveryResolution","#recordingResolution","#sensorMode","#codec","#recordingFrameRate","#lensManufacturer","#lensSeries","#cameraHandle","#mattebox","#filter","#monitoringConfiguration","#frameGuides","#videoDistribution","#storageNeedsContainer .storage-quantity","#storageNeedsContainer .storage-type","#storageNeedsContainer .storage-variant","#storageNeedsContainer .storage-notes"];for(let t=0;t<e.length;t+=1){const r=e[t];if(!r)continue;let n=[];try{n=W.querySelectorAll(r)}catch(o){Me("cine.features.onboardingTour could not query logistics selector.",o),n=[]}if(!(!n||n.length===0))for(let o=0;o<n.length;o+=1){const a=n[o];if(!a)continue;if(a.multiple){if(a.selectedOptions&&a.selectedOptions.length>0)return!0;continue}if(a.type==="number"){const s=Number(a.value);if(!Number.isNaN(s)&&a.value!=="")return!0;continue}const i=rB(a);if(typeof i=="string"&&i.trim().length>0)return!0}}return!1}function Lpe(){return{check(){return QU()},attach(e){const t=typeof e?.complete=="function"?e.complete:(()=>{}),r=typeof e?.incomplete=="function"?e.incomplete:(()=>{}),n=Jr("#projectForm");if(!n)return t(),null;const o=()=>{QU()?t():r()},a=()=>{o()};n.addEventListener("input",a),n.addEventListener("change",a);let i=null;const s=Jr("#storageNeedsContainer");if(s&&typeof MutationObserver=="function")try{i=new MutationObserver(()=>{o()}),i.observe(s,{childList:!0,subtree:!0})}catch(l){Me("cine.features.onboardingTour could not observe storage rows.",l),i=null}return o(),()=>{if(n.removeEventListener("input",a),n.removeEventListener("change",a),i)try{i.disconnect()}catch(l){Me("cine.features.onboardingTour could not detach storage observer.",l)}}}}}function XU(){const e=Jr("#setupName");return typeof e?.value=="string"?e.value.trim():""}function JU(e){if(!e)return!1;const t=Jr("#setupSelect");if(!t||!t.options)return!1;for(let r=0;r<t.options.length;r+=1){const n=t.options[r];if(n&&typeof n.value=="string"&&n.value===e)return!0}return!1}function Rpe(){return{check(){return JU(XU())},attach(e){const t=[],r=()=>{JU(XU())?typeof e.complete=="function"&&e.complete():typeof e.incomplete=="function"&&e.incomplete()},n=Jr("#saveSetupBtn");if(n){const i=()=>{setTimeout(r,50)};n.addEventListener("click",i),t.push(()=>{n.removeEventListener("click",i)})}const o=Jr("#setupSelect");if(o){const i=()=>{r()};o.addEventListener("change",i),t.push(()=>{o.removeEventListener("change",i)})}const a=Jr("#setupName");if(a){const i=()=>{r()};a.addEventListener("input",i),t.push(()=>{a.removeEventListener("input",i)})}return r(),()=>{for(let i=0;i<t.length;i+=1)try{t[i]()}catch(s){Me("cine.features.onboardingTour could not detach save requirement.",s)}}}}}const Tpe={nameProject:Rk("#setupName",e=>e.trim().length>0,["input","change"]),saveProject:Rpe(),addCamera:Rk("#cameraSelect",e=>e&&e!=="None",["change"]),selectBattery:Rk("#batterySelect",e=>e&&e!=="None",["change"]),editDeviceDataAdd:hpe(),editDeviceDataReview:bpe(),editDeviceDataEdit:Spe(),ownGearAccess:vpe(),ownGearAddDevice:Ape(),projectRequirementsAccess:Epe(),projectRequirementsCrew:wpe(),projectRequirementsLogistics:Lpe(),generateGearAndRequirements:ype(),exportImport:WU(["#shareSetupBtn","#applySharedLinkBtn"]),overviewAndPrint:WU("#generateOverviewBtn")},FE=cL.join("|");function Fg(){if(typeof Date<"u"&&typeof Date.now=="function")return Date.now();try{return new Date().getTime()}catch{}return 0}function Ope(e,t){if(!Array.isArray(e))return[];const r=[];for(let n=0;n<e.length;n+=1){const o=e[n];typeof o!="string"||!o||t&&t.indexOf(o)===-1||r.indexOf(o)===-1&&r.push(o)}return r}function Ya(e){const t=e&&typeof e=="object"?{...e}:{},r=t.skipped===!0;t.version=ys,t.completed=!!t.completed,t.skipped=r&&!t.completed;const n=cL;t.completedSteps=Ope(t.completedSteps,n),t.activeStep=typeof t.activeStep=="string"&&t.activeStep?t.activeStep:null,t.activeStep&&n.indexOf(t.activeStep)===-1&&(t.activeStep=null);const o=typeof t.stepSignature=="string"?t.stepSignature:null;if(o!==FE){if(t.stepSignature=FE,t.completed=!1,t.skipped=r,!t.activeStep)for(let a=0;a<n.length;a+=1){const i=n[a];if(t.completedSteps.indexOf(i)===-1){t.activeStep=i;break}}}else t.stepSignature=FE;return t.completedSteps.length<n.length&&(t.completed=!1),t.skipped=(r||t.skipped===!0)&&!t.completed,(typeof t.timestamp!="number"||Number.isNaN(t.timestamp))&&(t.timestamp=Fg()),t.lastCompletedStep=typeof t.lastCompletedStep=="string"&&t.lastCompletedStep?t.lastCompletedStep:null,t.lastCompletedStep&&n.indexOf(t.lastCompletedStep)===-1&&(t.lastCompletedStep=null),t.lastCompletedAt=typeof t.lastCompletedAt=="number"&&!Number.isNaN(t.lastCompletedAt)?t.lastCompletedAt:null,o!==FE&&(t.lastCompletedStep=null,t.lastCompletedAt=t.timestamp),t}function bu(e,t,r){xf=e,d5=typeof t=="string"?t:t||null,zh=r||zh||null}function xpe(e,t){if(typeof e!="string")return null;const r=e.trim(),n={priority:t===ud?2:1,version:0,hasContent:r?1:0,parsed:0,timestamp:0};let o=null,a=null;try{const i=JSON.parse(e);i&&typeof i=="object"&&(o=i)}catch(i){a=i}return o&&(n.parsed=1,typeof o.timestamp=="number"&&!Number.isNaN(o.timestamp)&&(n.timestamp=o.timestamp),o.version===ys?n.version=2:typeof o.version=="number"&&(n.version=1)),{key:t,raw:e,parsed:o,parseError:a,metrics:n}}function kpe(e,t){if(!e)return!1;if(!t)return!0;const r=["priority","version","hasContent","parsed","timestamp"];for(let n=0;n<r.length;n+=1){const o=r[n],a=e.metrics[o]||0,i=t.metrics[o]||0;if(a!==i)return a>i}return!1}function E_(){const e=CR();let t=null,r=null;for(let s=0;s<e.length;s+=1){const l=e[s];if(!(!l||typeof l.getItem!="function"))for(let c=0;c<sL.length;c+=1){const u=sL[c];let f=null;try{f=l.getItem(u)}catch(h){r||(r=h);continue}if(f===null||typeof f>"u")continue;let d=null;if(typeof f=="string")d=f;else{try{d=JSON.stringify(f)}catch{}if(d===null)try{d=String(f)}catch{}}if(typeof d!="string")continue;const p=xpe(d,u);p&&(!t||kpe(p,t))&&(t=p)}}if(!e.length&&!t){if(xf&&zh==="memory")return xf;const s=Ya({version:ys});return bu(s,null,"memory"),s}if(!t){if(xf&&zh==="memory")return xf;r&&Me("cine.features.onboardingTour could not read onboarding state.",r);const s=Ya({version:ys});return bu(s,null,"memory"),s}const n=t.raw,o="storage";if(typeof n!="string"||!n){const s=Ya({version:ys});return t.key!==ud?cl(s):(bu(s,n,o),s)}if(xf&&zh==="storage"&&n===d5)return xf;if(t.parseError){Me("cine.features.onboardingTour could not parse onboarding state.",t.parseError);const s=Ya({version:ys});return t.key!==ud?cl(s):(bu(s,n,o),s)}const a=t.parsed;if(!a||typeof a!="object"){const s=Ya({version:ys});return t.key!==ud?cl(s):(bu(s,n,o),s)}if(a.version!==ys){const s=Ya({...a,version:ys,completed:!1,skipped:!1});return cl(s)}const i=Ya(a);return t.key!==ud?cl(i):(bu(i,n,o),i)}function cl(e){const t=Ya({...e,version:ys}),r={...t,timestamp:Fg()},n=JSON.stringify(r),o=CR();let a=!1,i=null;for(let s=0;s<o.length;s+=1){const l=o[s];if(!l||typeof l.setItem!="function")continue;let c=!1;for(let u=0;u<sL.length;u+=1){const f=sL[u];try{l.setItem(f,n),c=!0}catch(d){i||(i=d)}}c&&(a=!0)}return a?(bu(r,n,"storage"),r):(i&&Me("cine.features.onboardingTour could not persist onboarding state.",i),bu(t,null,"memory"),t)}let wt=null;function af(){const e=E_(),r=f5()===!0&&e?Ya({...e,skipped:!0,activeStep:null,completed:!1}):e;return wt=r,r}af();function Ipe(e,t){if(!e||typeof e!="string"&&typeof e!="number")return null;const r=t&&typeof t=="object"?t:{},n=String(e).trim();if(!n)return null;if(Object.prototype.hasOwnProperty.call(r,n))return n;const o=n.toLowerCase();if(Object.prototype.hasOwnProperty.call(r,o))return o;const a=o.split(/[-_]/)[0];return a&&Object.prototype.hasOwnProperty.call(r,a)?a:null}function RR(){const e=he&&he.texts&&typeof he.texts=="object"?he.texts:{},t=Object.prototype.hasOwnProperty.call(e,"en")?"en":Object.keys(e)[0]||"en",r=new Set,n=[],o=a=>{const i=Ipe(a,e);!i||r.has(i)||(r.add(i),n.push(i))};try{typeof he.currentLang=="string"&&o(he.currentLang)}catch{}if(W&&W.documentElement&&typeof W.documentElement.lang=="string"&&o(W.documentElement.lang),W&&typeof W.getElementById=="function"){const a=W.getElementById("languageSelect");a&&typeof a.value=="string"&&o(a.value);const i=W.getElementById("settingsLanguage");i&&typeof i.value=="string"&&o(i.value)}try{he&&he.localStorage&&typeof he.localStorage.getItem=="function"&&o(he.localStorage.getItem("language"))}catch{}try{const a=he&&he.navigator?he.navigator:null;if(a){if(Array.isArray(a.languages))for(let i=0;i<a.languages.length;i+=1)o(a.languages[i]);typeof a.language=="string"&&o(a.language)}}catch{}for(let a=0;a<n.length;a+=1){const i=n[a];if(i&&Object.prototype.hasOwnProperty.call(e,i))return i}return t}function A_(){const e=RR(),t=he.texts&&he.texts.en&&he.texts.en.onboardingTour?he.texts.en.onboardingTour:{},r=he.texts&&he.texts[e]&&he.texts[e].onboardingTour?he.texts[e].onboardingTour:t,n={};for(let a=0;a<cL.length;a+=1){const i=cL[a],s=ppe[i]||{title:i,body:""},l=t.steps&&t.steps[i],c=r.steps&&r.steps[i],u=c&&typeof c.title=="string"&&c.title||l&&typeof l.title=="string"&&l.title||(typeof s.title=="string"?s.title:i),f=c&&typeof c.body=="string"&&c.body||l&&typeof l.body=="string"&&l.body||(typeof s.body=="string"?s.body:""),d={...s&&typeof s=="object"?s:{},...l&&typeof l=="object"?l:{},...c&&typeof c=="object"?c:{},title:u,body:f};n[i]=d}const o=(()=>{const a=r&&typeof r.prefaceIndicator=="string"?r.prefaceIndicator.trim():"";if(a)return a;const i=t&&typeof t.prefaceIndicator=="string"?t.prefaceIndicator.trim():"";return i||"Welcome"})();return{...t,...r,prefaceIndicator:o,steps:n}}let Ke=A_();function jE(e,t){return Ke&&typeof Ke[e]=="string"?Ke[e]:t}function Ppe(){return[{key:"intro",highlight:null,preface:!0,size:"large"},{key:"userProfile",highlight:null,forceFloating:!0,size:"large"},{key:"unitsPreferences",highlight:null,forceFloating:!0,ensureSettings:{tabId:"settingsTab-general",autoOpen:!1},size:"large"},{key:"nameProject",highlight:"#setupName",focus:"#setupName"},{key:"saveProject",highlight:"#saveSetupBtn"},{key:"addCamera",highlight:"#cameraSelect"},{key:"addMonitoring",highlight:["#monitorSelectRow","#wirelessVideoRow","#fizFieldset"],focus:"#monitorSelect"},{key:"selectBattery",highlight:"#batterySelectRow"},{key:"resultsTotalDraw",ensureHeroCard:!0,highlight:["#heroMainStat","#metricCurrent144","#metricCurrent12"]},{key:"resultsBatteryPacks",ensureHeroCard:!0,highlight:["#metricRuntime","#metricBatteryCount"]},{key:"resultsChangeover",highlight:"#breakdownList"},{key:"resultsWarnings",highlight:["#pinWarning","#dtapWarning","#hotswapWarning"]},{key:"batteryComparison",highlight:"#batteryComparison"},{key:"runtimeFeedback",highlight:"#runtimeFeedbackBtn"},{key:"connectionDiagram",highlight:"#diagramArea"},{key:"connectionDiagramDetails",highlight:"#diagramArea"},{key:"editDeviceDataAdd",highlight:["#toggleDeviceManager","#addDeviceHeading","#addDeviceBtn"],focus:"#newName"},{key:"editDeviceDataReview",highlight:"#device-manager",focus:"#deviceListContainer .detail-toggle",ensureDeviceManager:!0},{key:"editDeviceDataEdit",highlight:"#device-manager",focus:"#deviceListContainer .edit-btn",ensureDeviceManager:!0,scrollToTop:!0},{key:"ownGearAccess",highlight:'#sideMenu [data-sidebar-action="open-own-gear"]',alternateHighlight:"#menuToggle",resolveHighlight:dpe,focus:'[data-sidebar-action="open-own-gear"]'},{key:"ownGearAddDevice",highlight:"#ownGearDialog",ensureOwnGear:!0,focus:"#ownGearName"},{key:"projectRequirementsAccess",highlight:"#generateGearListBtn",autoAdvance:!0},{key:"projectRequirementsBrief",highlight:"#projectRequirementsBriefSection",ensureProjectDialog:!0},{key:"projectRequirementsCrew",highlight:"#projectRequirementsCrewSection",ensureProjectDialog:!0},{key:"projectRequirementsLogistics",highlight:["#projectRequirementsCameraSection","#lensesHeading","#riggingHeading","#storageHeading","#matteboxFilterHeading","#monitoringHeading"],ensureProjectDialog:!0},{key:"generateGearAndRequirements",highlight:"#projectSubmit",focus:"#projectSubmit",ensureProjectDialog:!0},{key:"autoGearRulesAccess",highlight:"#settingsPanel-autoGear",ensureSettings:{tabId:"settingsTab-autoGear"}},{key:"autoGearRulesEdit",highlight:"#autoGearRulesList",ensureSettings:{tabId:"settingsTab-autoGear"}},{key:"autoGearRulesCreate",highlight:"#autoGearAddRule",ensureSettings:{tabId:"settingsTab-autoGear"},focus:"#autoGearAddRule"},{key:"gearList",highlight:"#gearListOutput"},{key:"exportImport",highlight:"#shareSetupBtn",alternateHighlight:"#applySharedLinkBtn"},{key:"overviewAndPrint",highlight:"#generateOverviewBtn"},{key:"help",highlight:"#helpButton",focus:"#helpButton"},{key:"settingsGeneral",highlight:"#settingsPanel-general",ensureSettings:{tabId:"settingsTab-general"}},{key:"settingsData",highlight:"#settingsPanel-data",ensureSettings:{tabId:"settingsTab-data"}},{key:"settingsBackup",highlight:"#settingsPanel-backup",ensureSettings:{tabId:"settingsTab-backup"}},{key:"completion",highlight:null}]}const Bpe=(function(){const t=Ppe();if(typeof Rn.freezeDeep=="function")try{return Rn.freezeDeep(t)}catch(r){Me("cine.features.onboardingTour could not freeze step config.",r)}if(typeof Object.freeze=="function")try{return Object.freeze(t)}catch{}return t})();function CS(){return Bpe}let Qn=CS(),Je=null,Du=null,gi=null,Ku=[],fL=!1,zr=null,qm=null,Km=null,kd=null,Va=null,Wm=null,Ui=null,Vh=null,am=null,ih=null,ul=null,yi=null,fr=null,Ip=null,kf=null,HE=null,La=null,Po=null,Qo=null,ZU=!1,Tk=null,dL=!1,wo=!1,sf=-1,pn=null,Nu=null,fd=null,Fu=!1,fl=null,qh=!1,dl=null,Ym=!1,io=null,Qm=!1,mn=null,Gy=null,Xm=null,Id=!1,qo=null,An=null,dd=null,Og=!1,pL=null,Kh=null,If=!1,Jm=null,$A=null,nB="floating",ez=0,Su=null;function Tu(e){return ez+=1,`onboarding-${e}-${ez}`}function sh(e){Po&&(Po.disabled=!!e,e?(Po.setAttribute("aria-disabled","true"),Po.classList.add("onboarding-next-disabled")):(Po.setAttribute("aria-disabled","false"),Po.classList.remove("onboarding-next-disabled")))}function Gpe(e,t){if(!Number.isFinite(e)||e<=0)return;const r=!!(t&&t.allowDecrease);if(Su===null){Su=e;return}if(e>Su){Su=e;return}r&&e<Su&&(Su=e)}function Mpe(e){if(!e)return!1;const t=typeof e.nodeName=="string"?e.nodeName.toLowerCase():"";if(t==="textarea")return!0;if(t==="input")switch(typeof e.type=="string"&&e.type?e.type.toLowerCase():"text"){case"button":case"checkbox":case"color":case"file":case"hidden":case"image":case"radio":case"range":case"reset":case"submit":return!1;default:return!0}if(e.isContentEditable)return!0;if(typeof e.getAttribute=="function"){const r=e.getAttribute("role");if(r==="textbox"||r==="searchbox")return!0;const n=e.getAttribute("contenteditable");if(n&&n.toLowerCase()!=="false")return!0}return!1}function m5(){if(typeof Kh=="function")try{Kh()}catch(e){Me("cine.features.onboardingTour could not detach active requirement.",e)}Kh=null,If=!1,sh(!1)}function g5(){if(typeof Jm=="function")try{Jm()}catch(e){Me("cine.features.onboardingTour could not detach active interaction.",e)}if(Jm=null,fr){for(;fr.firstChild;)fr.removeChild(fr.firstChild);fr.hidden=!0}}function y5(){if(typeof $A=="function")try{$A()}catch(e){Me("cine.features.onboardingTour could not detach step automation.",e)}$A=null}function _pe(e){if(!Po)return;const t=e?Tpe[e.key]:null;if(!t){If=!0,sh(!1),Kh=null;return}const r=typeof t.check=="function"?t.check():!1;if(If=r,sh(!r),r&&e&&e.autoAdvance){Xb();return}if(typeof t.attach!="function")return;const n=t.attach({complete(){!wo||pn!==e||If||(If=!0,sh(!1),e&&e.autoAdvance&&Xb())},incomplete(){!wo||pn!==e||(If&&(If=!1),sh(!0))}});Kh=typeof n=="function"?n:null}function Dpe(e){if(y5(),!!e){if(e.key==="editDeviceDataAdd")$A=ume();else if(e.key==="projectRequirementsAccess"){if(io||(io=W.getElementById("ownGearDialog")),io){if(typeof io.close=="function")try{io.close()}catch{}io.setAttribute("hidden",""),io.removeAttribute("open")}Ym=!1}}}function h5(){Nu!==null&&(he&&typeof he.cancelAnimationFrame=="function"?he.cancelAnimationFrame(Nu):clearTimeout(Nu),Nu=null)}function b5(){fd!==null&&(he&&typeof he.clearTimeout=="function"?he.clearTimeout(fd):clearTimeout(fd),fd=null)}function S5(){b5(),Je&&Je.classList&&typeof Je.classList.remove=="function"&&Je.classList.remove("onboarding-scroll-active")}function Npe(){if(!Je||!Je.classList||typeof Je.classList.add!="function")return;Je.classList.add("onboarding-scroll-active"),b5();const e=function(){fd=null,Je&&Je.classList&&typeof Je.classList.remove=="function"&&Je.classList.remove("onboarding-scroll-active")};he&&typeof he.setTimeout=="function"?fd=he.setTimeout(e,150):fd=setTimeout(e,150)}function Fpe(e){if(!e||!Je)return!1;if(typeof e.composedPath=="function")try{const r=e.composedPath();if(Array.isArray(r)){for(let n=0;n<r.length;n+=1)if(r[n]===Je)return!0}}catch(r){Me("cine.features.onboardingTour could not inspect scroll event composedPath.",r)}const t=e.target;if(t===Je)return!0;if(t&&typeof t.closest=="function")try{if(t.closest(`#${a5}`))return!0}catch(r){Me("cine.features.onboardingTour could not evaluate scroll event target.closest.",r)}if(Je&&typeof Je.contains=="function"&&t&&typeof t=="object")try{if(Je.contains(t))return!0}catch(r){Me("cine.features.onboardingTour encountered an error inspecting scroll event containment.",r)}return!1}function mL(e){wo&&(Npe(),!Fpe(e)&&Xc())}function C_(){const e=he&&typeof he.innerWidth=="number"?he.innerWidth:W&&W.documentElement&&W.documentElement.clientWidth||0,t=he&&typeof he.innerHeight=="number"?he.innerHeight:W&&W.documentElement&&W.documentElement.clientHeight||0;let r=0,n=0,o=e,a=t;if(Je&&typeof Je.getBoundingClientRect=="function"){const s=Je.getBoundingClientRect();s&&(typeof s.left=="number"&&(r=-s.left),typeof s.top=="number"&&(n=-s.top),typeof s.width=="number"&&s.width>0&&(o=s.width),typeof s.height=="number"&&s.height>0&&(a=s.height))}const i=he&&he.visualViewport;if(i){const s=!!(Je&&Je.classList&&typeof Je.classList.contains=="function"&&Je.classList.contains("onboarding-overlay--anchored")),l=typeof i.width=="number"&&i.width>0?i.width:null,c=typeof i.height=="number"&&i.height>0?i.height:null,u=typeof i.offsetLeft=="number"?i.offsetLeft:typeof i.pageLeft=="number"?i.pageLeft:0,f=typeof i.offsetTop=="number"?i.offsetTop:typeof i.pageTop=="number"?i.pageTop:0,d=Number.isFinite(u)?u:0,p=Number.isFinite(f)?f:0;s?(l!==null&&(o=Math.min(o,l)),c!==null&&(a=Math.min(a,c))):(r=-d,n=-p,l!==null&&(o=l),c!==null&&(a=c))}return{offsetLeft:r,offsetTop:n,viewportWidth:o,viewportHeight:a}}function v5(e,t,r){if(!zr)return;if(e!=="hero"){zr.style.removeProperty("--onboarding-card-hero-inline-size");return}const n=t||C_();if(!n||typeof n.viewportWidth!="number"){zr.style.removeProperty("--onboarding-card-hero-inline-size");return}const o=n.viewportWidth;if(!Number.isFinite(o)||o<=0){zr.style.removeProperty("--onboarding-card-hero-inline-size");return}const a=Number.isFinite(r)&&r>0?r:c5(),i=Math.max(0,epe*a),s=s5(o,a),l=o-s*2,c=o*tpe,u=[i,o];Number.isFinite(c)&&c>0&&u.push(c),Number.isFinite(l)&&l>0&&u.push(l);const f=u.filter(p=>Number.isFinite(p)&&p>0);if(f.length===0){zr.style.removeProperty("--onboarding-card-hero-inline-size");return}const d=Math.min(...f);zr.style.setProperty("--onboarding-card-hero-inline-size",`${d}px`)}function Xc(){if(!wo||Nu!==null)return;const e=function(){Nu=null,rme()};he&&typeof he.requestAnimationFrame=="function"?Nu=he.requestAnimationFrame(e):Nu=setTimeout(e,16)}function gL(){Xc()}function jpe(){if(dL)return;const e=he&&he.visualViewport;!e||typeof e.addEventListener!="function"||(e.addEventListener("resize",gL),e.addEventListener("scroll",gL),dL=!0)}function Hpe(){if(!dL)return;const e=he&&he.visualViewport;e&&typeof e.removeEventListener=="function"&&(e.removeEventListener("resize",gL),e.removeEventListener("scroll",gL)),dL=!1}function Upe(){if(Je&&Je.parentNode){Tg();return}Je=W.createElement("div"),Je.id=a5,Je.className="onboarding-overlay",Je.setAttribute("aria-hidden","true"),Je.style.pointerEvents="none",S5(),gi=W.createElement("div"),gi.className="onboarding-highlight",gi.setAttribute("aria-hidden","true"),Je.appendChild(gi),zr=W.createElement("section"),zr.className="onboarding-card",zr.setAttribute("data-placement","floating"),zr.setAttribute("role","dialog"),zr.setAttribute("aria-modal","false"),zr.tabIndex=-1;const e=W.createElement("div");e.className="onboarding-card-header",zr.appendChild(e),Vh=e,kd=W.createElement("p"),kd.className="onboarding-progress",e.appendChild(kd),Va=W.createElement("div"),Va.className="onboarding-progress-meter",Va.setAttribute("role","progressbar"),Va.setAttribute("aria-valuemin","0"),Va.setAttribute("aria-valuemax",String(Qn.length)),Va.setAttribute("aria-valuenow","0"),Va.setAttribute("aria-valuetext","");const t=W.createElement("div");t.className="onboarding-progress-track",Wm=W.createElement("div"),Wm.className="onboarding-progress-fill",t.appendChild(Wm),Va.appendChild(t),e.appendChild(Va),Qo=W.createElement("button"),Qo.type="button",Qo.className="button-link onboarding-skip",Qo.addEventListener("click",()=>{wo&&B5()}),e.appendChild(Qo),Ui=W.createElement("div"),Ui.className="onboarding-card-content",zr.appendChild(Ui),yi=W.createElement("p"),yi.className="onboarding-resume-hint",yi.hidden=!0,Ui.appendChild(yi),qm=W.createElement("h2"),qm.id="onboardingCardTitle",Ui.appendChild(qm),Km=W.createElement("p"),Km.id="onboardingCardBody",Ui.appendChild(Km),fr=W.createElement("div"),fr.className="onboarding-interaction",fr.hidden=!0,Ui.appendChild(fr),ih=W.createElement("div"),ih.className="onboarding-step-list-container",zr.appendChild(ih),ul=W.createElement("ol"),ul.className="onboarding-step-list",ul.setAttribute("role","list"),ul.addEventListener("click",bme),ih.appendChild(ul);const r=W.createElement("div");r.className="onboarding-card-actions",zr.appendChild(r),am=r,La=W.createElement("button"),La.type="button",La.className="onboarding-back-button secondary",La.addEventListener("click",()=>{wo&&L_()}),r.appendChild(La),Po=W.createElement("button"),Po.type="button",Po.className="onboarding-next-button primary",Po.addEventListener("click",()=>{wo&&Xb()}),r.appendChild(Po),Je.appendChild(zr),W.body.appendChild(Je),Du=W.body,Tg(),$pe()}function zpe(){if(h5(),oB(),S5(),Vpe(),Je&&Je.parentNode){if(Rg&&typeof Je.close=="function"&&Je.open)try{Je.close()}catch(e){Me("cine.features.onboardingTour could not close overlay dialog.",e)}Je.parentNode.removeChild(Je)}Je=null,Du=null,gi=null,zr=null,qm=null,Km=null,kd=null,Va=null,Wm=null,Ui=null,Vh=null,am=null,ih=null,ul=null,yi=null,fr=null,La=null,Po=null,Qo=null,Og=!1,pL=null,Jm=null,nB="floating",Su=null}function $pe(){!W||fL||(W.addEventListener("keydown",G5,!0),fL=!0)}function Vpe(){!W||!fL||(W.removeEventListener("keydown",G5,!0),fL=!1)}function qpe(e,t){const r=typeof Ke.stepIndicator=="string"?Ke.stepIndicator:"Step {current} of {total}",n=typeof e=="number"?e:-1,o=typeof t=="number"&&t>0?t:0,a=n>=0?n+1:0;return r.replace("{current}",String(a)).replace("{total}",String(o))}function Kpe(){return Ke&&typeof Ke.prefaceIndicator=="string"&&Ke.prefaceIndicator.trim()?Ke.prefaceIndicator.trim():"Welcome"}function E5(){const e=C5(pn);if(e&&typeof e.focus=="function"&&!e.hasAttribute("disabled"))try{e.focus({preventScroll:!0});return}catch{try{e.focus();return}catch{}}if(zr)try{zr.focus({preventScroll:!0})}catch{try{zr.focus()}catch{}}}function VA(e){if(typeof e=="string")return e?[e]:[];if(Array.isArray(e)){const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];typeof n=="string"&&n&&t.push(n)}return t}return[]}function Wpe(e,t){if(typeof e!="function")return null;try{return e()}catch(r){return Me(`cine.features.onboardingTour could not resolve ${t}.`,r),null}}function Ype(e){if(!Array.isArray(e)||e.length===0)return[];const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];if(!n)continue;const o=W.querySelector(n);o&&t.push(o)}return t}function TR(e){if(!e||typeof e.isConnected=="boolean"&&!e.isConnected)return!1;if(typeof e.getBoundingClientRect!="function")return!0;let t=null;try{t=e.getBoundingClientRect()}catch(o){return Me("cine.features.onboardingTour could not measure highlight target.",o),!1}if(!t)return!1;const r=Number.isFinite(t.width)?t.width:t.right-t.left,n=Number.isFinite(t.height)?t.height:t.bottom-t.top;if(Number.isFinite(r)&&r>0||Number.isFinite(n)&&n>0)return!0;if(typeof e.getClientRects=="function")try{const o=e.getClientRects();if(o&&o.length>0)for(let a=0;a<o.length;a+=1){const i=o[a],s=Number.isFinite(i.width)?i.width:i.right-i.left,l=Number.isFinite(i.height)?i.height:i.bottom-i.top;if(Number.isFinite(s)&&s>0||Number.isFinite(l)&&l>0)return!0}}catch(o){Me("cine.features.onboardingTour could not inspect highlight target rects.",o)}return!1}function Qpe(e){if(!Array.isArray(e)||e.length===0)return[];const t=[];for(let r=0;r<e.length;r+=1){const n=e[r];n&&TR(n)&&t.push(n)}return t}function A5(e){if(!e)return;const t=w_(e);if(!t||!t.length)return;let r=null;for(let n=0;n<t.length;n+=1)if(t[n]&&TR(t[n])){r=t[n];break}if(r||(r=t[0]),r&&typeof r.scrollIntoView=="function")try{r.scrollIntoView({behavior:"smooth",block:"center"})}catch(n){Me("cine.features.onboardingTour could not scroll to highlight element.",n)}}function w_(e){if(!e)return[];const t=[{value:e.resolveHighlight,label:"highlight resolver"},{value:e.highlight,label:"highlight"},{value:e.resolveAlternateHighlight,label:"alternate highlight resolver"},{value:e.alternateHighlight,label:"alternate highlight"}];let r=[];for(let n=0;n<t.length;n+=1){const o=t[n];if(!o.value)continue;const a=typeof o.value=="function"?Wpe(o.value,o.label):o.value,i=VA(a);if(!i.length)continue;const s=Ype(i),l=Qpe(s);if(l.length>0)return l;!r.length&&s.length>0&&(r=s)}return r}function Xpe(e){if(!W)return null;const t=Array.isArray(e)?e:[],r=W.getElementById(Jde),n=W.getElementById(Zde);for(let o=0;o<t.length;o+=1){const a=t[o];if(a){if(typeof a.closest=="function"){const i=a.closest("[data-onboarding-anchor]");if(i)return i;const s=a.closest("dialog");if(s)return s}if(r&&typeof r.contains=="function"&&r.contains(a))return r;if(n&&typeof n.contains=="function"&&n.contains(a))return n}}return W.body||null}function Jpe(e){if(!Je||!W){Du=e||Du;return}const t=e||W.body;if(!t)return;if(Du===t&&Je.parentNode===t){if(t===W.body)Je.classList.remove("onboarding-overlay--anchored"),Tg();else if(Je.classList.add("onboarding-overlay--anchored"),Rg&&lL(Je)&&!Je.open)try{Je.open=!0}catch{try{Je.setAttribute("open","")}catch{}}return}const r=t===W.body,n=Rg&&lL(Je);if(n&&Je.open&&!r&&typeof Je.close=="function")try{Je.close()}catch(o){Me("cine.features.onboardingTour could not reset overlay dialog state.",o)}if(Je.parentNode!==t)try{t.appendChild(Je)}catch(o){Me("cine.features.onboardingTour could not move overlay to anchor.",o)}if(Du=t,r){Je.classList.remove("onboarding-overlay--anchored"),Tg();return}if(Je.classList.add("onboarding-overlay--anchored"),n&&!Je.open)try{Je.open=!0}catch{try{Je.setAttribute("open","")}catch{}}}function C5(e){if(!e||e.ensureSettings&&e.ensureSettings.autoOpen!==!1&&(!fl||!fme()))return null;const t=w_(e);return t.length>0?t[0]:null}function oB(){if(!Array.isArray(Ku)){Ku=[];return}Ku=[]}const UE=12,Zpe=20,eme=20;function zE(e,t){return typeof e=="number"&&Number.isFinite(e)?Math.max(0,e):t}function tme(e){const t={top:UE,right:UE,bottom:UE,left:UE};if(!e||typeof e!="object")return t;const r=e.highlightPadding;if(typeof r=="number"&&Number.isFinite(r)){const n=Math.max(0,r);return{top:n,right:n,bottom:n,left:n}}return r&&typeof r=="object"?{top:zE(r.top,t.top),right:zE(r.right,t.right),bottom:zE(r.bottom,t.bottom),left:zE(r.left,t.left)}:t}function rme(){if(!gi)return;const e=w_(pn);if(Jpe(Xpe(e)),e.length===0){Ku.length>0&&oB(),gi.style.transform="scale(0)",gi.style.opacity="0",Wh(null,null);return}oB();for(let f=0;f<e.length;f+=1){const d=e[f];d&&Ku.push(d)}const t=e.reduce((f,d)=>{if(!d||typeof d.getBoundingClientRect!="function")return f;const p=d.getBoundingClientRect();return f?{top:Math.min(f.top,p.top),right:Math.max(f.right,p.right),bottom:Math.max(f.bottom,p.bottom),left:Math.min(f.left,p.left)}:{top:p.top,right:p.right,bottom:p.bottom,left:p.left}},null);if(!t){gi.style.transform="scale(0)",gi.style.opacity="0",Wh(e[0]||null,null);return}t.width=Math.max(0,t.right-t.left),t.height=Math.max(0,t.bottom-t.top);const r=tme(pn),n=Math.max(0,t.width+r.left+r.right),o=Math.max(0,t.height+r.top+r.bottom),{offsetLeft:a,offsetTop:i}=C_(),s=t.left+a-r.left,l=t.top+i-r.top,c=Number.isFinite(s)?s:0,u=Number.isFinite(l)?l:0;gi.style.width=`${n}px`,gi.style.height=`${o}px`,gi.style.transform=`translate(${c}px, ${u}px)`,gi.style.opacity="1",Wh(e[0]||null,t)}function Wh(e,t){if(!zr)return;const r=C_(),n=c5();v5(pn&&pn.size,r,n);const o=r&&typeof r.offsetLeft=="number"?r.offsetLeft:0,a=r&&typeof r.offsetTop=="number"?r.offsetTop:0,i=r&&typeof r.viewportWidth=="number"?r.viewportWidth:0,s=r&&typeof r.viewportHeight=="number"?r.viewportHeight:0,l=e||C5(pn),c=t||(l?l.getBoundingClientRect():null),u=!!(pn&&pn.forceFloating),f=zr.getBoundingClientRect(),d=he&&he.visualViewport,p=W&&W.activeElement?W.activeElement:null,h=Mpe(p),m=[];Number.isFinite(s)&&s>0&&m.push(s),he&&typeof he.innerHeight=="number"&&he.innerHeight>0&&m.push(he.innerHeight),W&&W.documentElement&&typeof W.documentElement.clientHeight=="number"&&W.documentElement.clientHeight>0&&m.push(W.documentElement.clientHeight);const g=m.length>0?Math.max(...m):null;Gpe(g,{allowDecrease:!h});const S=Su||g||s,y=d?Number.isFinite(d.offsetTop)?d.offsetTop:Number.isFinite(d.pageTop)?d.pageTop:0:0,E=Number.isFinite(y)?y:0,L=Number.isFinite(S)&&Number.isFinite(s)?S-s:0,v=h&&(L>rpe||E>npe),A=h&&p&&typeof p.getBoundingClientRect=="function"?p.getBoundingClientRect():null;let R=16;if(pn&&pn.size==="hero"){const H=s5(i,n);if(Number.isFinite(H)){const te=Math.max(8,H);R=Math.min(R,te)}}const I=R+Zpe,C=R+Math.max(8,R*.5)+eme,k=o+i,_=a+s,w=o+R,x=a+I,G=Math.max(w,k-f.width-R),T=Math.max(x,_-f.height-R);let P=a+Math.max(I,(s-f.height)/2),N=o+Math.max(R,(i-f.width)/2),q="floating";if(!u&&l&&c){const H=c,te=H.top+a,re=H.left+o,fe=re+H.width/2,Oe=te+H.height/2,Te=pn&&pn.cardOverlap?pn.cardOverlap:null,Ne=St=>typeof St!="number"||Number.isNaN(St)?0:Math.min(Math.max(St,0),.95),Ie=Te?Ne(Te.top):0,et=Te?Ne(Te.right):0,Ze=Te?Ne(Te.bottom):0,Ft=Te?Ne(Te.left):0,Ye=H.height*Ie,ct=H.width*et,Y=H.height*Ze,ee=H.width*Ft,Ae=Ie>0?R:C,ve=Ie>0?R:0,se=et>0?R:0,de=Ze>0?R:0,be=Ft>0?R:0,$e=[{name:"bottom",top:te+H.height+R-Y-de,left:fe-f.width/2,fits:te+H.height+R+f.height-Y-de<=_-R},{name:"top",top:te-f.height-Ae+Ye+ve,left:fe-f.width/2,fits:te-f.height-Ae+Ye+ve>=x},{name:"right",top:Oe-f.height/2,left:re+H.width+R-ct-se,fits:re+H.width+R+f.width-ct-se<=k-R},{name:"left",top:Oe-f.height/2,left:re-f.width-R+ee+be,fits:re-f.width-R+ee+be>=w}].map(St=>{const Tt=Math.min(Math.max(St.top,x),T),xt=Math.min(Math.max(St.left,w),G),ut=Math.abs(Tt-St.top)+Math.abs(xt-St.left);return{...St,clampedTop:Tt,clampedLeft:xt,overflow:ut}});let xe=$e.find(St=>St.fits);xe||(xe=$e.reduce((St,Tt)=>!St||Tt.overflow<St.overflow?Tt:St,null)),xe&&(P=xe.clampedTop,N=xe.clampedLeft,q=xe.name)}let Z=Math.min(Math.max(P,x),T),U=Math.min(Math.max(N,w),G),K=q;if(v&&A){const H=Math.max(8,R),te=A.top+a,re=te+A.height;if(Z+f.height>te-H&&Z<re+H){const Te=te-H,Ne=re+H,Ie=Math.max(0,Te-x),et=Math.max(0,_-Ne),Ze=Ae=>{const ve=Ae+f.height,se=Math.max(Ae,Te),de=Math.min(ve,Ne);return Math.max(0,de-se)},Ft=Math.max(x,Math.min(T,Te-f.height)),Ye=Math.min(T,Math.max(x,Ne)),ct=Ze(Ft),Y=Ze(Ye);let ee;Ie>et?ee=ct<=Y?Ft:Ye:et>Ie?ee=Y<=ct?Ye:Ft:ee=Y<ct?Ye:Ft,Z=Math.min(Math.max(ee,x),T),K="floating"}}zr.style.top=`${Z}px`,zr.style.left=`${U}px`,K!==nB&&(nB=K,zr.setAttribute("data-placement",K))}function nme(e){if(!e||!e.ensureSettings)return;const t=W.getElementById("settingsDialog");if(!t)return;const r=e.ensureSettings.autoOpen!==!1,n=typeof isDialogOpen=="function"?isDialogOpen(t):!t.hasAttribute("hidden");if(fl=t,!n&&r){const o=W.getElementById("settingsButton");if(o&&typeof o.click=="function")try{o.click(),Fu=!0}catch(a){Me("cine.features.onboardingTour could not trigger settings button click.",a)}if(!Fu){if(t.removeAttribute("hidden"),typeof openDialog=="function")try{openDialog(t)}catch(a){Me("cine.features.onboardingTour could not open settings dialog.",a)}else if(typeof t.showModal=="function")try{t.showModal()}catch(a){Me("cine.features.onboardingTour could not show modal settings dialog.",a)}Fu=!0}}else Fu=!1;if(e.ensureSettings.tabId&&typeof activateSettingsTab=="function")try{activateSettingsTab(e.ensureSettings.tabId)}catch(o){Me("cine.features.onboardingTour could not activate settings tab.",o)}}function ome(e){if(!e||!e.ensureContacts)return;dl||(dl=W.getElementById("contactsDialog"));const t=dl;if(!t||tz())return;qh=!0;const n=W.getElementById("openContactsBtn")||W.querySelector('[data-sidebar-action="open-contacts"]');if(n&&typeof n.click=="function")try{n.click()}catch(o){Me("cine.features.onboardingTour could not trigger contacts button click.",o)}if(!tz()){if(t.removeAttribute("hidden"),typeof openDialog=="function")try{openDialog(t);return}catch(o){Me("cine.features.onboardingTour could not open contacts dialog.",o)}if(typeof t.showModal=="function")try{t.showModal();return}catch(o){Me("cine.features.onboardingTour could not show contacts dialog.",o)}t.setAttribute("open","")}}function tz(){if(!dl)return!1;if(typeof isDialogOpen=="function")try{return isDialogOpen(dl)}catch(e){Me("cine.features.onboardingTour could not evaluate contacts dialog state.",e)}return!dl.hasAttribute("hidden")}function qb(){if(!dl||!qh){qh=!1;return}if(typeof closeDialog=="function")try{closeDialog(dl)}catch(e){Me("cine.features.onboardingTour could not close contacts dialog via closeDialog.",e)}else if(typeof dl.close=="function")try{dl.close()}catch(e){Me("cine.features.onboardingTour could not close contacts dialog.",e)}dl.setAttribute("hidden",""),qh=!1}function ame(e){if(!e||!e.ensureHeroCard)return;const t=W.getElementById("heroCard");t&&t.classList.contains("hidden")&&t.classList.remove("hidden")}function ime(e){if(!e||!e.ensureOwnGear)return;io||(io=W.getElementById("ownGearDialog"));const t=io;if(!t||Kb())return;Ym=!0;const r=W.querySelector('[data-sidebar-action="open-own-gear"]');if(r&&typeof r.click=="function")try{r.click()}catch(n){Me("cine.features.onboardingTour could not trigger own gear button click.",n)}if(!Kb()){if(t.removeAttribute("hidden"),typeof openDialog=="function")try{openDialog(t);return}catch(n){Me("cine.features.onboardingTour could not open own gear dialog.",n)}if(typeof t.showModal=="function")try{t.showModal();return}catch(n){Me("cine.features.onboardingTour could not show own gear dialog.",n)}t.setAttribute("open","")}}function Kb(){if(!io)return!1;if(typeof isDialogOpen=="function")try{return isDialogOpen(io)}catch(e){Me("cine.features.onboardingTour could not evaluate own gear dialog state.",e)}return!io.hasAttribute("hidden")}function Wb(){if(!io||!Ym){Ym=!1;return}if(typeof closeDialog=="function")try{closeDialog(io)}catch(e){Me("cine.features.onboardingTour could not close own gear dialog via closeDialog.",e)}else if(typeof io.close=="function")try{io.close()}catch(e){Me("cine.features.onboardingTour could not close own gear dialog.",e)}io.setAttribute("hidden",""),Ym=!1}function yL(){if(mn||(mn=W.getElementById("projectDialog")),!mn)return!1;if(typeof isDialogOpen=="function")try{return isDialogOpen(mn)}catch(r){Me("cine.features.onboardingTour could not evaluate project dialog state.",r)}const e=typeof mn.open=="boolean"?mn.open:null,t=typeof mn.hasAttribute=="function"?mn.hasAttribute("open"):!1;return e===null?t:e||t}function w5(e){if(!(!e||!e.ensureProjectDialog)&&(mn||(mn=W.getElementById("projectDialog")),!!mn)){if(yL()){Qm=!1;return}if(Qm=!0,Gy||(Gy=W.getElementById("generateGearListBtn")),Gy&&typeof Gy.click=="function")try{Gy.click();return}catch(t){Me("cine.features.onboardingTour could not trigger project dialog button.",t)}if(typeof he.openProjectDialogWithInfo=="function")try{he.openProjectDialogWithInfo();return}catch(t){Me("cine.features.onboardingTour could not open project dialog via helper.",t)}if(mn.removeAttribute("hidden"),typeof openDialog=="function")try{openDialog(mn);return}catch(t){Me("cine.features.onboardingTour could not open project dialog.",t)}if(typeof mn.showModal=="function")try{mn.showModal();return}catch(t){Me("cine.features.onboardingTour could not show project dialog.",t)}mn.setAttribute("open","")}}function sme(){if(Xm||(mn||(mn=W.getElementById("projectDialog")),!mn))return;const e=()=>{!wo||!pn||!pn.ensureProjectDialog||setTimeout(()=>{yL()||w5(pn)},50)};mn.addEventListener("close",e),mn.addEventListener("cancel",e);let t=null;if(typeof MutationObserver=="function")try{t=new MutationObserver(e),t.observe(mn,{attributes:!0,attributeFilter:["open","hidden","aria-hidden"]})}catch(r){Me("cine.features.onboardingTour could not observe project dialog visibility.",r),t=null}Xm=()=>{if(mn.removeEventListener("close",e),mn.removeEventListener("cancel",e),t)try{t.disconnect()}catch(r){Me("cine.features.onboardingTour could not detach project dialog observer.",r)}t=null,Xm=null}}function aB(){if(typeof Xm=="function")try{Xm()}catch(e){Me("cine.features.onboardingTour could not detach project dialog visibility monitor.",e)}Xm=null}function rz(){if(!mn||!Qm){Qm=!1;return}if(typeof closeDialog=="function")try{closeDialog(mn)}catch(e){Me("cine.features.onboardingTour could not close project dialog via closeDialog.",e)}else if(typeof mn.close=="function")try{mn.close()}catch(e){Me("cine.features.onboardingTour could not close project dialog.",e)}else mn.removeAttribute("open");Qm=!1}function im(){return qo||(qo=W.getElementById("device-manager")),qo?!qo.classList.contains("hidden"):!1}function lme(e){if(!e||!e.ensureDeviceManager||(qo||(qo=W.getElementById("device-manager")),!qo))return;if(im()){Id=!1;return}if(An||(An=W.getElementById("toggleDeviceManager")),Id=!0,An&&typeof An.click=="function")try{An.click()}catch(r){Me("cine.features.onboardingTour could not trigger device manager toggle.",r)}if(im())return;const t=he&&typeof he.showDeviceManagerSection=="function"?he.showDeviceManagerSection:null;if(t)try{t()}catch(r){Me("cine.features.onboardingTour could not open device manager via showDeviceManagerSection.",r)}im()||(qo.classList.remove("hidden"),An||(An=W.getElementById("toggleDeviceManager")),An&&An.setAttribute("aria-expanded","true"),im()||(Id=!1))}function Yb(){if(!Id){Id=!1;return}if(qo||(qo=W.getElementById("device-manager")),An||(An=W.getElementById("toggleDeviceManager")),An&&typeof An.click=="function")try{qo&&qo.classList.contains("hidden")||An.click()}catch(e){Me("cine.features.onboardingTour could not toggle device manager closed.",e)}if(im()){const e=he&&typeof he.hideDeviceManagerSection=="function"?he.hideDeviceManagerSection:null;if(e)try{e()}catch(t){Me("cine.features.onboardingTour could not close device manager via hideDeviceManagerSection.",t)}else qo&&(qo.classList.add("hidden"),An||(An=W.getElementById("toggleDeviceManager")),An&&An.setAttribute("aria-expanded","false"))}Id=!1}function cme(){if(!W)return!1;let e=null;try{e=W.getElementById("newName")}catch{e=null}if(!e||!TR(e))return!1;let t=!1;if(typeof e.focus=="function")try{e.focus({preventScroll:!0}),t=!0}catch{try{e.focus(),t=!0}catch{}}if(!t)return!1;if(typeof e.select=="function")try{return e.select(),!0}catch{}if(typeof e.setSelectionRange=="function")try{const r=typeof e.value=="string"?e.value.length:0;return e.setSelectionRange(0,r),!0}catch{}return!0}function ume(){if(!W)return null;qo||(qo=W.getElementById("device-manager")),An||(An=W.getElementById("toggleDeviceManager"));const e=()=>{im()&&cme()},t=()=>{typeof setTimeout=="function"?setTimeout(e,50):e()};let r=!1;An&&typeof An.addEventListener=="function"&&(An.addEventListener("click",t),r=!0);let n=null;if(qo&&typeof MutationObserver=="function")try{n=new MutationObserver(()=>{e()}),n.observe(qo,{attributes:!0,attributeFilter:["class","hidden"]})}catch(o){Me("cine.features.onboardingTour could not observe device manager visibility.",o),n=null}return e(),()=>{r&&An&&typeof An.removeEventListener=="function"&&An.removeEventListener("click",t),n&&n.disconnect()}}function fme(){if(!fl)return!1;if(typeof isDialogOpen=="function")try{return isDialogOpen(fl)}catch(e){Me("cine.features.onboardingTour could not evaluate settings dialog state.",e)}return!fl.hasAttribute("hidden")}function Qb(){if(fl&&Fu){if(typeof closeDialog=="function")try{closeDialog(fl)}catch(e){Me("cine.features.onboardingTour could not close settings dialog via closeDialog.",e)}else if(typeof fl.close=="function")try{fl.close()}catch(e){Me("cine.features.onboardingTour could not close settings dialog.",e)}fl.setAttribute("hidden",""),Fu=!1}}function L5(e){if(!e)return{title:"",body:""};const t=Ke.steps&&Ke.steps[e.key]?Ke.steps[e.key]:{title:e.key,body:""};return{title:typeof t.title=="string"?t.title:e.key,body:typeof t.body=="string"?t.body:""}}function R5(e){if(!yi)return;if(!Og||typeof e!="number"||e<0){yi.hidden=!0,yi.textContent="";return}const t=wR(Qn),r=wt&&Array.isArray(wt.completedSteps)?wt.completedSteps:[],n=new Set(r),o=LR(Qn,n),a=S_(Qn,e);if(a===null){const l=Ke.resumeHint||"";if(!l){yi.hidden=!0,yi.textContent="";return}yi.hidden=!1,yi.textContent=l;return}const s=(Ke.resumeHintDetailed||Ke.resumeHint||"Resuming where you left off.").replace("{current}",String(a+1)).replace("{total}",String(t)).replace("{completed}",String(Math.min(o,t)));yi.hidden=!1,yi.textContent=s}function T5(e){if(!ul)return;const t=typeof e=="number"&&e>=0?e:0,r=Qn.length,n={current:Ke.stepStatusCurrent||"Current step",complete:Ke.stepStatusComplete||"Completed",upcoming:Ke.stepStatusUpcoming||"Locked"},o=new Set(wt&&Array.isArray(wt.completedSteps)?wt.completedSteps:[]),a=pn?pn.key:Qn[t]&&Qn[t].key;ul.textContent="",typeof ul.setAttribute=="function"&&ul.setAttribute("aria-label",Ke.stepListAriaLabel||"Tutorial steps");for(let i=0;i<r;i+=1){const s=Qn[i],l=L5(s),c=W.createElement("li");c.className="onboarding-step-item",s&&typeof s.key=="string"&&s.key&&c.setAttribute("data-step-key",s.key),i<3&&(c.classList.add("onboarding-step-item--pinned"),c&&c.style&&typeof c.style.setProperty=="function"&&c.style.setProperty("--onboarding-step-pinned-index",String(i)));let u;s&&s.key===a?u="current":s&&o.has(s.key)?u="complete":u="upcoming",c.setAttribute("data-status",u);const f=W.createElement("button");f.type="button",f.className="onboarding-step-button",f.disabled=u==="upcoming",f.setAttribute("data-step-index",String(i)),f.setAttribute("aria-current",u==="current"?"step":"false");const d=l.title||s.key,p=n[u]||"";f.setAttribute("aria-label",p?`${d}. ${p}.`:d);const h=W.createElement("span");h.className="onboarding-step-title",h.textContent=d,f.appendChild(h);const m=W.createElement("span");m.className="onboarding-step-status",m.textContent=p,f.appendChild(m),c.appendChild(f),ul.appendChild(c)}}function nz(e){if(!e)return!1;const t=[],r=VA(e.focus);for(let s=0;s<r.length;s+=1){const l=r[s];t.indexOf(l)===-1&&t.push(l)}const n=VA(e.highlight);for(let s=0;s<n.length;s+=1){const l=n[s];t.indexOf(l)===-1&&t.push(l)}const o=VA(e.alternateHighlight);for(let s=0;s<o.length;s+=1){const l=o[s];t.indexOf(l)===-1&&t.push(l)}let a=null;for(let s=0;s<t.length;s+=1){const l=t[s];if(!l)continue;const c=W.querySelector(l);if(c&&typeof c.focus=="function"&&TR(c)){a=c;break}}if(!a)return!1;const i=()=>{try{a.focus({preventScroll:!0})}catch{try{a.focus()}catch{}}const s=a.ownerDocument&&a.ownerDocument.defaultView;if(!!(s&&(a instanceof s.HTMLInputElement||a instanceof s.HTMLTextAreaElement))&&typeof a.select=="function"&&a.value)try{a.select()}catch{}};return typeof queueMicrotask=="function"?queueMicrotask(i):setTimeout(i,0),!0}function Kl(e,t){if(!(!e||!t))try{const r=new Event(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(r)}catch(r){try{const n=W.createEvent("Event");n.initEvent(t,!0,!0),e.dispatchEvent(n)}catch(n){Me("cine.features.onboardingTour could not dispatch synthetic event.",n||r)}}}function O5(e){const t=typeof e=="string"?e.trim():"";if(!t)return!1;let r=!1;const n={};if(typeof he.callCoreFunctionIfAvailable=="function")try{he.callCoreFunctionIfAvailable("setLanguage",[t],{defaultValue:n})!==n&&(r=!0)}catch(o){Me("cine.features.onboardingTour could not route language preference via runtime bridge.",o)}if(!r&&typeof he.setLanguage=="function")try{const o=he.setLanguage(t);o&&typeof o.then=="function"&&o.catch(a=>{Me("cine.features.onboardingTour async language sync failed.",a)}),r=!0}catch(o){Me("cine.features.onboardingTour could not sync language preference.",o)}return r}function dme(e){if(!fr)return!1;const t=Ke&&Ke.steps&&Ke.steps.intro?Ke.steps.intro:{},r=t&&typeof t.hero=="object"?t.hero:{},n=Array.isArray(r.highlights)?r.highlights:[],o=typeof r.heading=="string"&&r.heading?r.heading:typeof t.title=="string"?t.title:"",a=typeof r.subheading=="string"?r.subheading:"",i=typeof r.summary=="string"?r.summary:"",s=typeof r.badgeIcon=="string"&&r.badgeIcon?r.badgeIcon:"",l=typeof r.badgeLabel=="string"?r.badgeLabel:"",c=typeof r.badgeDescription=="string"?r.badgeDescription:"",u=typeof r.languageLabel=="string"?r.languageLabel:"Language",f=typeof r.languageHint=="string"?r.languageHint:"",d=typeof r.offlineSummary=="string"?r.offlineSummary:"";fr.hidden=!1,fr.classList.add("onboarding-interaction--hero"),e(()=>{fr.classList.remove("onboarding-interaction--hero")});const p=W.createElement("div");p.className="onboarding-hero";let h=null;if(l||c){const T=W.createElement("li");T.className="onboarding-hero-highlight onboarding-hero-highlight--badge";const P=W.createElement("span");P.className="icon-glyph onboarding-hero-highlight-icon onboarding-hero-highlight-icon--badge",P.setAttribute("data-icon-font","uicons"),P.setAttribute("aria-hidden","true"),P.textContent=s,T.appendChild(P);const N=W.createElement("div");if(N.className="onboarding-hero-highlight-text onboarding-hero-highlight-text--badge",l){const q=W.createElement("span");q.className="onboarding-hero-highlight-badge-label",q.textContent=l,N.appendChild(q)}if(c){const q=W.createElement("span");q.className="onboarding-hero-highlight-badge-description",q.textContent=c,N.appendChild(q)}T.appendChild(N),h=T}if(o||a||i){const T=W.createElement("div");T.className="onboarding-hero-banner";const P=W.createElement("div");if(P.className="onboarding-hero-header",o){const N=W.createElement("h1");N.className="onboarding-hero-heading",N.textContent=o,P.appendChild(N)}if(a){const N=W.createElement("p");N.className="onboarding-hero-subheading",N.textContent=a,P.appendChild(N)}if(i){const N=W.createElement("p");N.className="onboarding-hero-summary",N.textContent=i,P.appendChild(N)}T.appendChild(P),p.appendChild(T)}if(n.length||h){const T=W.createElement("ul");T.className="onboarding-hero-highlights",h&&T.appendChild(h);for(let P=0;P<n.length;P+=1){const N=n[P]&&typeof n[P]=="object"?n[P]:{},q=W.createElement("li");q.className="onboarding-hero-highlight";const Z=W.createElement("span");Z.className="icon-glyph onboarding-hero-highlight-icon",Z.setAttribute("data-icon-font","uicons"),Z.setAttribute("aria-hidden","true"),Z.textContent=typeof N.icon=="string"&&N.icon?N.icon:"",q.appendChild(Z);const U=W.createElement("div");if(U.className="onboarding-hero-highlight-text",typeof N.title=="string"&&N.title){const K=W.createElement("h3");K.className="onboarding-hero-highlight-title",K.textContent=N.title,U.appendChild(K)}if(typeof N.body=="string"&&N.body){const K=W.createElement("p");K.className="onboarding-hero-highlight-body",K.textContent=N.body,U.appendChild(K)}q.appendChild(U),T.appendChild(q)}p.appendChild(T)}const m=W.createElement("div");m.className="onboarding-hero-language";const g=[],S=new Set,y=Tu("intro-language"),E=W.createElement("label");E.className="onboarding-hero-language-label",E.setAttribute("for",y),E.textContent=u,m.appendChild(E);const L=W.createElement("select");L.id=y,L.className="onboarding-field-select onboarding-hero-language-select";const v=T=>{const P=L.value;if(L.textContent="",!T)return;const N=T&&T.options?Array.from(T.options):[];if(N.length)for(let q=0;q<N.length;q+=1)L.appendChild(N[q].cloneNode(!0));else if(typeof T.value=="string"){const q=W.createElement("option");q.value=T.value,q.textContent=T.value||"",L.appendChild(q)}P&&(L.value=P)},A=()=>{for(let T=0;T<g.length;T+=1){const P=g[T];if(P&&typeof P.value=="string"&&P.value)return P.value}return""},R=()=>{if(!g.length)return;const T=g[0];if(T){const P=A()||L.value;v(T),P&&(L.value=P)}},I=()=>{const T={en:"English",de:"Deutsch",es:"Espaol",fr:"Franais",it:"Italiano"},P=[],N=new Set,q=Z=>{const U=typeof Z=="string"?Z.trim():"";!U||N.has(U)||(N.add(U),P.push({value:U,label:T[U]||U}))};if(he&&typeof he.texts=="object"&&he.texts)try{Object.keys(he.texts).forEach(q)}catch{}return Object.keys(T).forEach(q),P.length||q("en"),P},C=()=>{const T=L.value;L.textContent="";const P=I();for(let q=0;q<P.length;q+=1){const Z=W.createElement("option");Z.value=P[q].value,Z.textContent=P[q].label,L.appendChild(Z)}const N=T||RR();N&&(L.value=N)},k=()=>{const T=L.value,P=O5(T);for(let q=0;q<g.length;q+=1){const Z=g[q];Z&&(typeof Z.value=="string"&&Z.value!==T&&(Z.value=T),P||Kl(Z,"change"))}const N=()=>{try{R()}catch{}if(P)try{iB()}catch{}};if(he&&typeof he.requestAnimationFrame=="function")try{he.requestAnimationFrame(()=>{N()});return}catch{}if(he&&typeof he.queueMicrotask=="function")try{he.queueMicrotask(N);return}catch{}if(he&&typeof he.setTimeout=="function")try{he.setTimeout(N,0);return}catch{}N()};L.disabled=!1,L.removeAttribute("aria-disabled"),L.addEventListener("change",k),e(()=>{L.removeEventListener("change",k)});const _=()=>{R();try{iB()}catch{}},w=T=>{if(!T||S.has(T))return;S.add(T),g.push(T);const P=()=>{_()};T.addEventListener("change",P),T.addEventListener("input",P);let N=null;if(he&&he.MutationObserver&&typeof he.MutationObserver=="function")try{N=new he.MutationObserver(()=>{R()}),N.observe(T,{childList:!0})}catch{N=null}e(()=>{if(T.removeEventListener("change",P),T.removeEventListener("input",P),N)try{N.disconnect()}catch{}S.delete(T);const q=g.indexOf(T);q!==-1&&g.splice(q,1)}),R(),L.disabled=!1,L.removeAttribute("aria-disabled")},x=()=>{if(!W||typeof W.getElementById!="function")return;const T=W.getElementById("languageSelect");T&&w(T);const P=W.getElementById("settingsLanguage");P&&P!==T&&w(P)};x(),g.length||C();let G=null;if(he&&he.MutationObserver&&typeof he.MutationObserver=="function")try{G=new he.MutationObserver(T=>{let P=!1;if(T&&typeof T[Symbol.iterator]=="function"){for(const q of T)if(q.target!==L&&!L.contains(q.target)){P=!0;break}}else P=!0;if(!P)return;const N=g.length;x(),g.length?N||R():C()}),G.observe(W.documentElement||W,{childList:!0,subtree:!0})}catch{G=null}if(e(()=>{if(G)try{G.disconnect()}catch{}}),he&&typeof he.addEventListener=="function"){const T=()=>{R()};try{he.addEventListener("languagechange",T),e(()=>{try{he.removeEventListener("languagechange",T)}catch(P){}})}catch(P){Me("cine.features.onboardingTour could not observe language changes.",P)}}if(m.appendChild(L),f){const T=W.createElement("p");T.className="onboarding-hero-language-hint",T.textContent=f,m.appendChild(T)}if(p.insertBefore(m,p.firstChild||null),d){const T=W.createElement("p");T.className="onboarding-hero-offline",T.textContent=d,p.appendChild(T)}for(;fr.firstChild;)fr.removeChild(fr.firstChild);return fr.appendChild(p),!0}function pme(e){if(!fr)return!1;const t=W.getElementById("userProfileName"),r=W.getElementById("userProfileNameLabel"),n=W.getElementById("userProfileRole"),o=W.getElementById("userProfileRoleLabel"),a=W.getElementById("userProfilePhone"),i=W.getElementById("userProfilePhoneLabel"),s=W.getElementById("userProfileEmail"),l=W.getElementById("userProfileEmailLabel"),c=W.getElementById("userProfileAvatar"),u=W.getElementById("userProfileAvatarButton"),f=W.getElementById("userProfileAvatarButtonLabel"),d=W.getElementById("userProfileAvatarInput"),p=W.createDocumentFragment(),h=W.createElement("p");h.className="onboarding-resume-hint";const m=Ke&&typeof Ke.userProfileInteractionIntro=="string"?Ke.userProfileInteractionIntro:"Enter your crew details once. Each update syncs to Contacts instantly, stays cached offline and flows into exports so crews always know who owns the setup.";h.textContent=m,p.appendChild(h);const g=W.createElement("div");g.className="onboarding-avatar-group";const S=W.createElement("div");S.className="onboarding-avatar-preview",g.appendChild(S);const y=ee=>{const Ae=W.createElement("span");Ae.className="contact-card-avatar-initial",Ae.textContent=ee||"",S.appendChild(Ae)},E=()=>{const ee=t&&typeof t.value=="string"?t.value.trim():"";return ee?ee.charAt(0).toUpperCase():""},L=()=>{let ee=!1;for(;S.firstChild;)S.removeChild(S.firstChild);if(c){const Ae=c.querySelector(".contact-card-avatar-visual");if(Ae){const ve=Ae.querySelector("img");if(ve&&ve.src){const se=W.createElement("img");se.src=ve.src,se.alt="",S.appendChild(se),ee=!0}else{const se=Ae.textContent?Ae.textContent.trim():"";if(se){y(se.charAt(0).toUpperCase());return}}}}ee||y(E())},v=f&&typeof f.textContent=="string"?f.textContent.trim():"",A=Ke&&typeof Ke.userProfileAvatarAction=="string"?Ke.userProfileAvatarAction:"Add profile photo",R=Ke&&typeof Ke.userProfileAvatarEditAction=="string"?Ke.userProfileAvatarEditAction:"Edit photo",I=(()=>{const ee=RR(),Ae=he&&typeof he.texts=="object"?he.texts:{},ve=Ae&&typeof Ae[ee]=="object"?Ae[ee]:null,se=Ae&&typeof Ae.en=="object"?Ae.en:null,de=ve&&typeof ve.contacts=="object"?ve.contacts:null,be=se&&typeof se.contacts=="object"?se.contacts:null,ye=de&&typeof de.userProfileAvatarButton=="string"?de.userProfileAvatarButton.trim():"";return ye||(be&&typeof be.userProfileAvatarButton=="string"?be.userProfileAvatarButton.trim():"")})(),C=v?v.trim():"",k=ee=>ee?I&&ee.toLowerCase()===I.toLowerCase():!1,_=ee=>!C||k(C)?ee?R:A:C,w=()=>{if(u){const ee=S.querySelector("img")!==null;u.textContent=_(ee)}},x=typeof he.readAvatarFile=="function"?he.readAvatarFile:typeof he.localReadAvatarFile=="function"?he.localReadAvatarFile:null,G=typeof he.setAvatar=="function"?he.setAvatar:ee=>{if(typeof he.assignUserProfileState=="function"){let Ae="";if(typeof he.getUserProfileSnapshot=="function"){const ve=he.getUserProfileSnapshot();ve&&ve.name&&(Ae=ve.name)}he.assignUserProfileState({avatar:ee,name:Ae}),typeof he.persistUserProfileState=="function"&&he.persistUserProfileState()}};u&&(u.addEventListener("click",L),e(()=>{u.removeEventListener("click",L)}));const T=W.createElement("input");T.type="file",T.id="userProfileAvatarUploadProxy",T.style.opacity="0",T.style.position="absolute",T.style.width="1px",T.style.height="1px",T.style.pointerEvents="none",T.tabIndex=-1,T.setAttribute("aria-hidden","true"),T.addEventListener("change",ee=>{const Ae=ee.target.files&&ee.target.files[0];Ae&&typeof x=="function"&&x(Ae,ve=>{typeof G=="function"&&(G(ve),L(),w())})});const P=ee=>{ee.preventDefault(),ee.stopPropagation(),g.classList.add("onboarding-avatar-group--drag-over")},N=ee=>{ee.preventDefault(),ee.stopPropagation(),g.classList.remove("onboarding-avatar-group--drag-over")},q=ee=>{ee.preventDefault(),ee.stopPropagation(),g.classList.remove("onboarding-avatar-group--drag-over");const Ae=ee.dataTransfer&&ee.dataTransfer.files&&ee.dataTransfer.files[0];Ae&&typeof x=="function"&&x(Ae,ve=>{typeof G=="function"&&(G(ve),L(),w())})};g.addEventListener("dragenter",P),g.addEventListener("dragover",P),g.addEventListener("dragleave",N),g.addEventListener("drop",q),e(()=>{g.removeEventListener("dragenter",P),g.removeEventListener("dragover",P),g.removeEventListener("dragleave",N),g.removeEventListener("drop",q)}),p.appendChild(T),L();let Z=null;if(he.MutationObserver&&c)try{Z=new he.MutationObserver(()=>L()),Z.observe(c,{childList:!0,subtree:!0,attributes:!0}),e(()=>{try{Z.disconnect()}catch(ee){}})}catch{}const U=W.createElement("button");U.type="button",U.className="onboarding-avatar-action",U.textContent=_(!1);const K=()=>{if(T&&typeof T.click=="function")try{T.click();return}catch(ee){Me("cine.features.onboardingTour could not trigger avatar proxy input.",ee)}if(d&&typeof d.click=="function")try{d.click();return}catch(ee){Me("cine.features.onboardingTour could not trigger avatar input.",ee)}if(u&&typeof u.click=="function")try{u.click()}catch(ee){Me("cine.features.onboardingTour could not open avatar options.",ee)}};U.addEventListener("click",K),e(()=>{U.removeEventListener("click",K)}),g.appendChild(U),p.appendChild(g);let H=null;const te=ee=>{const{fieldKey:Ae,labelText:ve,placeholder:se,target:de,type:be,autocomplete:ye,onAfterSync:$e}=ee||{},xe=W.createElement("div");xe.className="onboarding-field-group";const St=Tu(Ae),Tt=W.createElement("label");Tt.className="onboarding-field-label",Tt.setAttribute("for",St),Tt.textContent=ve,xe.appendChild(Tt);const xt=be==="select",ut=xt?W.createElement("select"):W.createElement("input");ut.id=St,ut.className="onboarding-field-input",xt?ut.classList.add("onboarding-field-select"):(ut.type=be||"text",typeof se=="string"&&se&&(ut.placeholder=se),typeof ye=="string"&&ye&&(ut.autocomplete=ye));const Er=()=>{if(!xt)return;const Jt=de&&de.options?Array.from(de.options):[];if(ut.textContent="",Jt.length)Jt.forEach(rr=>{ut.appendChild(rr.cloneNode(!0))});else if(typeof se=="string"&&se){const rr=W.createElement("option");rr.value="",rr.textContent=se,ut.appendChild(rr)}ut.value=de&&typeof de.value=="string"?de.value:""};xt?Er():ut.value=de&&typeof de.value=="string"?de.value:"";const zt=()=>{de&&(xt?Er():ut.value!==de.value&&(ut.value=de.value||""),typeof $e=="function"&&$e("from"))},dr=()=>{if(de){if(xt){const Jt=ut.value;de.value!==Jt&&(de.value=Jt)}else de.value!==ut.value&&(de.value=ut.value);Kl(de,"input"),Kl(de,"change"),typeof $e=="function"&&$e("to")}};if(ut.addEventListener("input",dr),ut.addEventListener("change",dr),e(()=>{ut.removeEventListener("input",dr),ut.removeEventListener("change",dr)}),de){if(de.addEventListener("input",zt),de.addEventListener("change",zt),e(()=>{de.removeEventListener("input",zt),de.removeEventListener("change",zt)}),xt&&typeof MutationObserver=="function"){const Jt=new MutationObserver(zt);Jt.observe(de,{childList:!0}),e(()=>Jt.disconnect())}}else ut.disabled=!0,ut.setAttribute("aria-disabled","true");return xe.appendChild(ut),p.appendChild(xe),H||(H=ut),ut},re=r&&typeof r.textContent=="string"?r.textContent:"Display name";let fe="e.g. Alex Rivera";if(t&&typeof t.getAttribute=="function"){const ee=t.getAttribute("placeholder");typeof ee=="string"&&ee&&(fe=ee)}const Oe=te({fieldKey:"user-profile-name",labelText:re,placeholder:fe,target:t,type:"text",autocomplete:"name",onAfterSync:()=>L()}),Te=o&&typeof o.textContent=="string"?o.textContent:"Role or title";let Ne="Select role";if(n&&n.options&&n.options.length){const ee=n.options[0];ee&&ee.textContent&&(Ne=ee.textContent)}te({fieldKey:"user-profile-role",labelText:Te,placeholder:Ne,target:n,type:"select"});const Ie=i&&typeof i.textContent=="string"?i.textContent:"Phone number";let et="";if(a&&typeof a.getAttribute=="function"){const ee=a.getAttribute("placeholder");typeof ee=="string"&&ee&&(et=ee)}te({fieldKey:"user-profile-phone",labelText:Ie,placeholder:et,target:a,type:"tel",autocomplete:"tel"});const Ze=l&&typeof l.textContent=="string"?l.textContent:"Email address";let Ft="";if(s&&typeof s.getAttribute=="function"){const ee=s.getAttribute("placeholder");typeof ee=="string"&&ee&&(Ft=ee)}te({fieldKey:"user-profile-email",labelText:Ze,placeholder:Ft,target:s,type:"email",autocomplete:"email"});const Ye=W.createElement("p");Ye.className="onboarding-resume-hint";const ct=Ke&&typeof Ke.userProfileInteractionSkipHint=="string"?Ke.userProfileInteractionSkipHint:"Press Next when you are readyContacts in the sidebar always shows these saved details without resetting tutorial progress.";for(Ye.textContent=ct,p.appendChild(Ye);fr.firstChild;)fr.removeChild(fr.firstChild);fr.appendChild(p),fr.hidden=!1;const Y=H||Oe;if(Y&&typeof Y.focus=="function"){const ee=()=>{try{Y.focus({preventScroll:!0})}catch{try{Y.focus()}catch{}}};typeof queueMicrotask=="function"?queueMicrotask(ee):setTimeout(ee,0)}return!0}function mme(e,t){if(!fr)return!1;const r=W.createDocumentFragment(),n=W.getElementById("settingsLanguage"),o=(U,K)=>(Ke&&typeof Ke[U]=="string"?Ke[U].trim():"")||K;if(n){const U=W.createElement("div");U.className="onboarding-field-group";const K=Tu("language"),H=W.createElement("label");H.className="onboarding-field-label",H.setAttribute("for",K),H.textContent=o("unitsPreferencesLanguageLabel","Language");const te=W.createElement("select");te.id=K,te.className="onboarding-field-select";const re=Array.from(n.options||[]);if(re.length===0){const Te=W.createElement("option");Te.value=n.value||"en",Te.textContent=n.value||"English",te.appendChild(Te)}else for(let Te=0;Te<re.length;Te+=1){const Ne=re[Te],Ie=W.createElement("option");Ie.value=Ne.value,Ie.textContent=Ne.textContent||Ne.value,te.appendChild(Ie)}te.value=n.value||te.value;const fe=()=>{te.value!==n.value&&(te.value=n.value)},Oe=()=>{const Te=te.value,Ne=O5(Te);if(n.value!==Te&&(n.value=Te),Kl(n,"change"),!Ne)try{fe()}catch{}};te.addEventListener("change",Oe),e(()=>{te.removeEventListener("change",Oe)}),n.addEventListener("change",fe),e(()=>{n.removeEventListener("change",fe)}),U.appendChild(H),U.appendChild(te),r.appendChild(U)}const a=W.getElementById("settingsDarkMode"),i=W.createElement("div");i.className="onboarding-field-group";const s=Tu("theme"),l=W.createElement("label");l.className="onboarding-field-label",l.setAttribute("for",s),l.textContent=o("unitsPreferencesThemeLabel","Theme");const c=W.createElement("select");c.id=s,c.className="onboarding-field-select";const u=W.createElement("option");u.value="light",u.textContent=o("unitsPreferencesThemeLight","Light");const f=W.createElement("option");f.value="dark",f.textContent=o("unitsPreferencesThemeDark","Dark"),c.appendChild(u),c.appendChild(f);const d=he&&he.cineThemePreference?he.cineThemePreference:null;if(d&&typeof d.registerControl=="function"&&typeof d.getValue=="function"){try{const K=d.getValue();typeof K=="boolean"&&(c.value=K?"dark":"light")}catch(K){Me("cine.features.onboardingTour: theme bridge getValue failed.",K)}let U=null;try{U=d.registerControl(c,{type:"select"})}catch(K){Me("cine.features.onboardingTour: theme bridge registerControl failed.",K)}typeof U=="function"&&e(()=>{try{U()}catch(K){Me("cine.features.onboardingTour: theme bridge cleanup failed.",K)}})}else{c.value=a&&a.checked?"dark":"light";const U=()=>{const H=a&&a.checked?"dark":"light";c.value!==H&&(c.value=H)},K=()=>{if(!a)return;const H=c.value==="dark";a.checked!==H&&(a.checked=H,Kl(a,"change"))};c.addEventListener("change",K),e(()=>{c.removeEventListener("change",K)}),a&&(a.addEventListener("change",U),e(()=>{a.removeEventListener("change",U)}))}i.appendChild(l),i.appendChild(c),r.appendChild(i);const p=he&&he.cinePinkModePreference?he.cinePinkModePreference:null,h=W.getElementById("settingsPinkMode"),m=W.createElement("div");m.className="onboarding-field-group";const g=Tu("pink"),S=W.createElement("label");S.className="onboarding-field-label",S.setAttribute("for",g),S.textContent=o("unitsPreferencesPinkLabel","Pink mode accents");const y=W.createElement("select");y.id=g,y.className="onboarding-field-select";const E=W.createElement("option");E.value="disabled",E.textContent=o("unitsPreferencesPinkOff","Disabled");const L=W.createElement("option");if(L.value="enabled",L.textContent=o("unitsPreferencesPinkOn","Enabled"),y.appendChild(E),y.appendChild(L),p&&typeof p.registerControl=="function"&&typeof p.getValue=="function"){try{const K=p.getValue();typeof K=="boolean"&&(y.value=K?"enabled":"disabled")}catch(K){Me("cine.features.onboardingTour: pink bridge getValue failed.",K)}let U=null;try{U=p.registerControl(y,{type:"select"})}catch(K){Me("cine.features.onboardingTour: pink bridge registerControl failed.",K)}typeof U=="function"&&e(()=>{try{U()}catch(K){Me("cine.features.onboardingTour: pink bridge cleanup failed.",K)}})}else if(h){y.value=h.checked?"enabled":"disabled";const U=()=>{const H=y.value==="enabled";h.checked!==H&&(h.checked=H,Kl(h,"change"))},K=()=>{const H=h.checked?"enabled":"disabled";y.value!==H&&(y.value=H)};y.addEventListener("change",U),e(()=>{y.removeEventListener("change",U)}),h.addEventListener("change",K),e(()=>{h.removeEventListener("change",K)})}(p||h)&&(m.appendChild(S),m.appendChild(y),r.appendChild(m));const v=W.getElementById("settingsFocusScale");if(v){const U=W.createElement("div");U.className="onboarding-field-group";const K=Tu("focus-scale"),H=W.createElement("label");H.className="onboarding-field-label",H.setAttribute("for",K);const te=W.getElementById("settingsFocusScaleLabel");H.textContent=te&&typeof te.textContent=="string"?te.textContent:"Focus scale";const re=W.createElement("select");re.id=K,re.className="onboarding-field-select";const fe=Array.from(v.options||[]);if(fe.length===0){const Ne=W.createElement("option");Ne.value=v.value||"metric",Ne.textContent=v.value||"Metric",re.appendChild(Ne)}else for(let Ne=0;Ne<fe.length;Ne+=1){const Ie=fe[Ne],et=W.createElement("option");et.value=Ie.value,et.textContent=Ie.textContent||Ie.value,re.appendChild(et)}re.value=v.value||re.value;const Oe=()=>{re.value!==v.value&&(re.value=v.value)},Te=()=>{v.value!==re.value&&(v.value=re.value,Kl(v,"change"))};re.addEventListener("change",Te),e(()=>{re.removeEventListener("change",Te)}),v.addEventListener("change",Oe),e(()=>{v.removeEventListener("change",Oe)}),U.appendChild(H),U.appendChild(re),r.appendChild(U)}const A=W.getElementById("settingsTemperatureUnit");if(A){const U=W.createElement("div");U.className="onboarding-field-group";const K=Tu("units"),H=W.createElement("label");H.className="onboarding-field-label",H.setAttribute("for",K),H.textContent=o("unitsPreferencesUnitsLabel","Temperature units");const te=W.createElement("select");te.id=K,te.className="onboarding-field-select";const re=Array.from(A.options||[]);if(re.length===0){const Te=W.createElement("option");Te.value=A.value||"Celsius",Te.textContent=A.value||"Celsius",te.appendChild(Te)}else for(let Te=0;Te<re.length;Te+=1){const Ne=re[Te],Ie=W.createElement("option");Ie.value=Ne.value,Ie.textContent=Ne.textContent||Ne.value,te.appendChild(Ie)}te.value=A.value||te.value;const fe=()=>{te.value!==A.value&&(te.value=A.value)},Oe=()=>{A.value!==te.value&&(A.value=te.value,Kl(A,"change"))};te.addEventListener("change",Oe),e(()=>{te.removeEventListener("change",Oe)}),A.addEventListener("change",fe),e(()=>{A.removeEventListener("change",fe)}),U.appendChild(H),U.appendChild(te),r.appendChild(U)}const R=W.getElementById("storagePersistenceRequest"),I=W.createElement("p");I.className="onboarding-resume-hint",I.textContent=o("unitsPreferencesPersistenceHint","Request persistent storage so the browser keeps planner data even when space runs low."),r.appendChild(I);const C=W.createElement("div");C.className="onboarding-storage-status",C.setAttribute("role","status"),C.setAttribute("aria-live","polite"),C.setAttribute("data-state","checking");const k=W.createElement("span");k.className="onboarding-storage-icon",k.setAttribute("aria-hidden","true");const _=W.createElement("span");_.className="onboarding-storage-text",C.appendChild(k),C.appendChild(_),r.appendChild(C);const w=W.getElementById("storagePersistenceStatus"),x=U=>{if(!U||!he||typeof he.texts!="object")return"";const K=RR(),H=he.texts||{},te=H[K]&&typeof H[K]=="object"?H[K]:null,re=H.en&&typeof H.en=="object"?H.en:null,fe=te&&typeof te[U]=="string"?te[U]:null;if(fe&&fe.trim())return fe;const Oe=re&&typeof re[U]=="string"?re[U]:null;return Oe&&Oe.trim()?Oe:""},G=x("storagePersistenceStatusIdle")||I.textContent||"",T=(U,K)=>{const H=typeof U=="string"&&U?U:"checking";C.setAttribute("data-state",H),C.dataset.state=H;const te=typeof K=="string"&&K.trim()?K.trim():H==="checking"&&x("storagePersistenceStatusChecking")||G;_.textContent=te,te?C.removeAttribute("data-empty"):C.setAttribute("data-empty","true")},P=U=>{let K=U&&typeof U.state=="string"?U.state:null,H=U&&typeof U.message=="string"?U.message:null;w&&(!K&&typeof w.getAttribute=="function"&&(K=w.getAttribute("data-state")),!H&&typeof w.textContent=="string"&&(H=w.textContent.trim())),!w&&!H&&(H=x("storagePersistenceStatusChecking")||G),!w&&!K&&(K="checking"),T(K,H)};if(P(),w&&typeof w.addEventListener=="function"){const U=H=>{P(H&&H.detail?H.detail:null)};w.addEventListener("storagepersistencechange",U),e(()=>{w.removeEventListener("storagepersistencechange",U)});const K=he&&(he.MutationObserver||he.WebKitMutationObserver||he.MozMutationObserver);if(K){let H=null;try{H=new K(()=>{P()}),H.observe(w,{characterData:!0,childList:!0,subtree:!0,attributes:!0}),e(()=>{H&&typeof H.disconnect=="function"&&H.disconnect()})}catch(te){Me("cine.features.onboardingTour could not observe persistent storage status.",te),H&&typeof H.disconnect=="function"&&H.disconnect()}}}const N=W.createElement("div");N.className="onboarding-interaction-actions";const q=W.createElement("button");q.type="button",q.className="onboarding-interaction-button primary",q.textContent=o("unitsPreferencesPersistenceAction","Protect storage on this device"),q.disabled=!R;const Z=()=>{if(!R)return;const U=t&&t.ensureSettings&&t.ensureSettings.tabId?t.ensureSettings.tabId:"settingsTab-general";if(typeof activateSettingsTab=="function")try{activateSettingsTab("settingsTab-data")}catch(K){Me("cine.features.onboardingTour could not activate Data & Storage tab.",K)}try{R.click()}catch(K){Me("cine.features.onboardingTour could not request persistent storage.",K)}typeof activateSettingsTab=="function"&&setTimeout(()=>{try{activateSettingsTab(U)}catch(K){Me("cine.features.onboardingTour could not restore settings tab.",K)}},300)};for(q.addEventListener("click",Z),e(()=>{q.removeEventListener("click",Z)}),N.appendChild(q),r.appendChild(N);fr.firstChild;)fr.removeChild(fr.firstChild);return fr.appendChild(r),fr.hidden=!1,!0}function Ok(){const e=Jr("#crewContainer");if(!e)return null;let t=e.querySelector(".person-row");if(t)return t;const r=Jr("#addPersonBtn");if(r&&typeof r.click=="function")try{r.click(),t=e.querySelector(".person-row")}catch(n){Me("cine.features.onboardingTour could not auto-create crew row for proxy.",n)}return t||null}function xk(e,t,r){const n=Jr(e);if(!n)return null;let o=n.querySelector(".period-row");if(!o){const a=Jr(t);if(a&&typeof a.click=="function")try{a.click(),o=n.querySelector(".period-row")}catch(i){Me("cine.features.onboardingTour could not auto-create schedule row.",i)}}if(!o)return null;try{return o.querySelector(r)}catch(a){return Me("cine.features.onboardingTour could not resolve schedule field.",a),null}}function gme(e){const t=Jr("#storageNeedsContainer");if(!t)return null;const r=t.querySelector(".storage-row");if(r){const n=r.querySelector(e);if(n)return n}try{return t.querySelector(e)}catch(n){Me("cine.features.onboardingTour could not resolve storage proxy field.",n)}return null}const qA=[{key:"projectRequirementsBrief",fields:[{fieldKey:"project-brief-company",targetSelector:"#productionCompany",labelSelector:"#productionCompanyLabel"},{fieldKey:"project-brief-street",targetSelector:"#productionCompanyStreet",labelSelector:"#productionCompanyStreetLabel"},{fieldKey:"project-brief-city",targetSelector:"#productionCompanyCity",labelSelector:"#productionCompanyCityLabel"},{fieldKey:"project-brief-rental",targetSelector:"#rentalHouse",labelSelector:"#rentalHouseLabel"}]},{key:"projectRequirementsCrew",fields:[{fieldKey:"project-crew-role",resolveTarget:()=>{const e=Ok();return e?e.querySelector(".person-role-select"):null},fallbackLabel:"Crew role",type:"select"},{fieldKey:"project-crew-name",resolveTarget:()=>{const e=Ok();return e?e.querySelector(".person-name"):null},fallbackLabel:"Crew member name"},{fieldKey:"project-crew-phone",resolveTarget:()=>{const e=Ok();return e?e.querySelector(".person-phone"):null},fallbackLabel:"Crew phone"},{fieldKey:"project-crew-prep",resolveTarget:()=>xk("#prepContainer","#addPrepBtn",".prep-start"),labelSelector:"#prepLabel",inputType:"date"},{fieldKey:"project-crew-shoot",resolveTarget:()=>xk("#shootContainer","#addShootBtn",".shoot-start"),labelSelector:"#shootLabel",inputType:"date"},{fieldKey:"project-crew-return",resolveTarget:()=>xk("#returnContainer","#addReturnBtn",".return-start"),labelSelector:"#returnLabel",inputType:"date"}]},{key:"projectRequirementsLogistics",fields:[{fieldKey:"project-logistics-delivery",targetSelector:"#deliveryResolution",labelSelector:"#deliveryResolutionLabel",type:"select"},{fieldKey:"project-logistics-recording-rate",targetSelector:"#recordingFrameRate",labelSelector:"#recordingFrameRateLabel",inputType:"number"},{fieldKey:"project-logistics-lens",targetSelector:"#lensManufacturer",labelSelector:"#lensManufacturerLabel",type:"select"},{fieldKey:"project-logistics-storage",resolveTarget:()=>gme(".storage-quantity"),labelSelector:"#storageNeedsLabel",inputType:"number"},{fieldKey:"project-logistics-mattebox",targetSelector:"#mattebox",labelSelector:"#matteboxLabel",type:"select"},{fieldKey:"project-logistics-monitoring",targetSelector:"#monitoringConfiguration",labelSelector:"#monitoringConfigurationLabel",type:"select"}]}],x5=qA.map(e=>e.key);function k5(e){const t=W&&W.documentElement;if(!t)return;const r=e&&e.key;r&&x5.indexOf(r)!==-1?t.setAttribute("data-onboarding-project-dialog","project-requirements"):t.removeAttribute("data-onboarding-project-dialog")}function yme(e,t){if(!fr)return!1;const r=t&&t.key,n=qA.findIndex(v=>v.key===r);if(n===-1)return!1;const o=qA[n],a=W.createDocumentFragment(),i=Ke&&typeof Ke.stepIndicator=="string"?Ke.stepIndicator:"Step {current} of {total}",s=W.createElement("p");s.className="onboarding-resume-hint onboarding-step-indicator",s.textContent=i.replace("{current}",String(n+1)).replace("{total}",String(qA.length)),a.appendChild(s);const l=W.createElement("p");l.className="onboarding-resume-hint",l.textContent=Ke&&typeof Ke.projectRequirementsMiniIntro=="string"?Ke.projectRequirementsMiniIntro:"Fill these proxy fields while the Project Requirements dialog stays open.",a.appendChild(l);const c=Ke&&Ke.steps&&Ke.steps[r]&&typeof Ke.steps[r].body=="string"?Ke.steps[r].body.trim():"";if(c){const v=W.createElement("p");v.className="onboarding-resume-hint",v.textContent=c,a.appendChild(v)}const u=(v,A)=>{if(v&&typeof v.labelSelector=="string"&&v.labelSelector){const R=Jr(v.labelSelector);if(R&&typeof R.textContent=="string"){const I=R.textContent.trim();if(I)return I}}if(v&&typeof v.labelText=="string"&&v.labelText)return v.labelText;if(A){const R=typeof A.getAttribute=="function"?A.getAttribute("aria-label"):null;if(R&&R.trim())return R.trim();if(A.id)try{const I=`label[for="${A.id}"]`,C=W.querySelector(I);if(C&&typeof C.textContent=="string"){const k=C.textContent.trim();if(k)return k}}catch(I){Me("cine.features.onboardingTour could not resolve proxy label.",I)}if(typeof A.placeholder=="string"&&A.placeholder.trim())return A.placeholder.trim()}return v&&typeof v.fallbackLabel=="string"&&v.fallbackLabel?v.fallbackLabel:"Field"},f=(v,A)=>v&&typeof v.placeholder=="string"?v.placeholder:A&&typeof A.placeholder=="string"&&A.placeholder?A.placeholder:"",d=(v,A)=>{if(!A||(A.innerHTML="",!v))return;const R=v.options||[];for(let I=0;I<R.length;I+=1){const C=R[I];if(!C)continue;const k=W.createElement("option");k.value=C.value,k.textContent=C.textContent||C.value,v.multiple&&(k.selected=C.selected),A.appendChild(k)}v.multiple||(A.value=v.value||"")};let p=null;const h=v=>{const A=W.createElement("div");A.className="onboarding-field-group";const R=Tu(v?.fieldKey||"project-field"),I=W.createElement("label");I.className="onboarding-field-label",I.setAttribute("for",R);const C=typeof v?.resolveTarget=="function"?v.resolveTarget():typeof v?.targetSelector=="string"?Jr(v.targetSelector):null;I.textContent=u(v,C),A.appendChild(I);let k=null;const _=C&&typeof C.nodeName=="string"?C.nodeName.toLowerCase():null;if(v&&v.type==="select"||_==="select")k=W.createElement("select"),k.multiple=!!(C&&C.multiple),k.multiple&&C&&C.size&&(k.size=C.size),d(C,k);else if(v&&v.multiline||_==="textarea")k=W.createElement("textarea"),k.rows=v&&v.rows?v.rows:3;else{k=W.createElement("input");const T=v&&v.inputType?v.inputType:C&&C.type?C.type:"text";try{k.type=T}catch{k.type="text"}}k.id=R,k.className="onboarding-field-input";const w=f(v,C);if(w&&(k.placeholder=w),A.appendChild(k),a.appendChild(A),p||(p=k),!C)return k.disabled=!0,k.setAttribute("aria-disabled","true"),k;const x=()=>{if(C){if(k.tagName==="SELECT")if(d(C,k),C.multiple){const T=Array.from(C.selectedOptions||[]).map(P=>P.value);for(let P=0;P<k.options.length;P+=1){const N=k.options[P];N.selected=T.indexOf(N.value)!==-1}}else k.value!==C.value&&(k.value=C.value||"");else k.tagName==="TEXTAREA"?k.value!==C.value&&(k.value=C.value||""):(k.type,k.value=C.value||"");k.disabled=C.disabled,k.setAttribute("aria-disabled",C.disabled?"true":"false")}},G=()=>{if(C){if(k.tagName==="SELECT")if(C.multiple){const T=Array.from(k.selectedOptions||[]).map(N=>N.value),P=C.options||[];for(let N=0;N<P.length;N+=1){const q=P[N];q.selected=T.indexOf(q.value)!==-1}}else C.value!==k.value&&(C.value=k.value);else C.value!==k.value&&(C.value=k.value);Kl(C,"input"),Kl(C,"change")}};if(k.addEventListener("input",G),k.addEventListener("change",G),C.addEventListener("input",x),C.addEventListener("change",x),e(()=>{k.removeEventListener("input",G),k.removeEventListener("change",G),C.removeEventListener("input",x),C.removeEventListener("change",x)}),C.tagName&&C.tagName.toLowerCase()==="select"&&typeof MutationObserver=="function")try{const T=new MutationObserver(()=>{x()});T.observe(C,{childList:!0,subtree:!0}),e(()=>{T.disconnect()})}catch(T){Me("cine.features.onboardingTour could not observe select options.",T)}return x(),k};for(let v=0;v<o.fields.length;v+=1)try{h(o.fields[v])}catch(A){Me("cine.features.onboardingTour could not render project requirements proxy.",A)}const m=W.createElement("p");m.className="onboarding-resume-hint",m.textContent=Ke&&typeof Ke.projectRequirementsMiniOfflineHint=="string"?Ke.projectRequirementsMiniOfflineHint:"All entries save offline immediately. Use Back or Next here without losing work.",a.appendChild(m);const g=W.createElement("div");g.className="onboarding-inline-nav";const S=W.createElement("button");S.type="button",S.className="button onboarding-inline-button",S.textContent=Ke&&typeof Ke.backLabel=="string"?Ke.backLabel:"Back",S.disabled=n===0;const y=v=>{v.preventDefault(),S.disabled||L_()};S.addEventListener("click",y),e(()=>{S.removeEventListener("click",y)}),g.appendChild(S);const E=W.createElement("button");E.type="button",E.className="button onboarding-inline-button onboarding-inline-button--primary",E.textContent=Ke&&typeof Ke.nextLabel=="string"?Ke.nextLabel:"Next";const L=v=>{v.preventDefault(),Xb()};for(E.addEventListener("click",L),e(()=>{E.removeEventListener("click",L)}),g.appendChild(E),a.appendChild(g);fr.firstChild;)fr.removeChild(fr.firstChild);if(fr.appendChild(a),fr.hidden=!1,p&&typeof p.focus=="function"){const v=p,A=()=>{try{v.focus({preventScroll:!0})}catch{try{v.focus()}catch{}}};typeof queueMicrotask=="function"?queueMicrotask(A):setTimeout(A,0)}return e(()=>{for(;fr.firstChild;)fr.removeChild(fr.firstChild)}),!0}function hme(e){if(!fr)return;g5();const t=e&&e.key,r=!!(t&&t!=="intro"&&t!=="completion");fr.hidden=!0;const n=[],o=i=>{typeof i=="function"&&n.push(i)};if(t==="intro"?dme(o):t==="userProfile"?pme(o):t==="unitsPreferences"?mme(o,e):t&&x5.indexOf(t)!==-1?yme(o,e):!1){nz(e),Xc(),Jm=()=>{for(let i=0;i<n.length;i+=1)try{n[i]()}catch(s){Me("cine.features.onboardingTour could not detach custom interaction.",s)}n.length=0};return}r&&(nz(e),Xc()),Jm=null}function bme(e){if(!wo)return;const t=e&&e.target;if(!t)return;const r=typeof t.closest=="function"?t.closest(".onboarding-step-button"):t.classList&&t.classList.contains("onboarding-step-button")?t:null;if(!r||r.disabled)return;const n=parseInt(r.getAttribute("data-step-index"),10);Number.isNaN(n)||n>sf||OR(n)}function Sme(){if(!Qo||!am||am.contains(Qo))return;const e=Po&&am.contains(Po)?Po:null;am.insertBefore(Qo,e),Qo.classList.add("onboarding-skip--intro")}function vme(){!Qo||!Vh||Vh.contains(Qo)||(Vh.appendChild(Qo),Qo.classList.remove("onboarding-skip--intro"))}function I5(e,t){if(!zr)return;if(Ui)if(typeof Ui.scrollTo=="function"&&!Wde())try{Ui.scrollTo({top:0,behavior:"smooth"})}catch(u){Me("cine.features.onboardingTour could not smoothly reset card scroll.",u),Ui.scrollTop=0}else Ui.scrollTop=0;const r=wR(Qn),n=S_(Qn,t),o=L5(e),a=o.body,i=e&&typeof e.size=="string"&&e.size?e.size:"standard";zr.setAttribute("data-size",i),v5(i);const s=e&&typeof e.key=="string"?e.key:"";s?zr.setAttribute("data-step-key",s):zr.removeAttribute("data-step-key"),zr.setAttribute("aria-labelledby",qm.id),zr.setAttribute("aria-describedby",Km.id),qm.textContent=o.title||"",Km.textContent=a,e.key==="completion"?kd.textContent=Ke.completionIndicator||"":p5(e)?kd.textContent=Kpe():kd.textContent=qpe(n,r),P5(e,t),Qo.textContent=Ke.skipLabel||"Skip tutorial",La.textContent=Ke.backLabel||"Back";const l=s==="intro",c=s==="completion";c?Po.textContent=Ke.doneLabel||"Finish":l?Po.textContent=Ke.introStartLabel||"Start onboarding tour":Po.textContent=Ke.nextLabel||"Next",l?(La.disabled=!0,La.hidden=!0):(La.disabled=t<=0,La.hidden=t<=0),La.setAttribute("aria-hidden",La.hidden?"true":"false"),La.hidden?La.tabIndex=-1:La.removeAttribute("tabindex"),l?Sme():vme(),l?Qo.hidden=!1:c?Qo.hidden=!0:Qo.hidden=!1,R5(t),T5(t),hme(e)}function P5(e,t){if(!Va||!Wm)return;const r=wR(Qn),n=wt&&Array.isArray(wt.completedSteps)?wt.completedSteps:[],o=new Set(n),a=LR(Qn,o),i=S_(Qn,t);let s=a;typeof i=="number"&&(s=Math.max(s,i+1)),Wd(e)&&!o.has(e.key)&&(s=Math.max(s,Math.min(r,a+1))),e&&e.key==="completion"&&(s=r),s=Math.min(r,s);const l=r>0?Math.max(0,Math.min(1,s/r)):0;Wm.style.width=`${l*100}%`;const u=(Ke.progressValueLabel||"Completed {completed} of {total} steps").replace("{completed}",String(Math.min(a,r))).replace("{total}",String(r)),f=Ke.progressMeterLabel||"Tutorial progress";Va.setAttribute("aria-label",f),Va.setAttribute("aria-valuemax",String(r)),Va.setAttribute("aria-valuenow",String(s)),Va.setAttribute("aria-valuetext",u)}function OR(e){if(e<0||e>=Qn.length)return;const t=pn;m5(),g5(),y5();const r=Qn[e];t&&t.ensureSettings&&(!r.ensureSettings||r.ensureSettings.tabId!==t.ensureSettings.tabId)&&Qb(),t&&t.ensureContacts&&!r.ensureContacts&&qb(),t&&t.ensureOwnGear&&!r.ensureOwnGear&&Wb(),t&&t.ensureDeviceManager&&!r.ensureDeviceManager&&Yb(),t&&t.ensureProjectDialog&&!r.ensureProjectDialog&&rz(),k5(r),pn=r,sf=e,Fu=!1,r.ensureSettings?nme(r):t&&t.ensureSettings&&Qb(),r.ensureContacts?ome(r):t&&t.ensureContacts?qb():qh=!1,r.ensureOwnGear?ime(r):t&&t.ensureOwnGear?Wb():Ym=!1,r.ensureDeviceManager?lme(r):t&&t.ensureDeviceManager?Yb():Id=!1,r.ensureProjectDialog?(w5(r),sme()):t&&t.ensureProjectDialog?(rz(),aB()):(Qm=!1,aB()),r.ensureHeroCard&&ame(r),A5(r),I5(r,e),_pe(r),Dpe(r),Og&&pL!==null&&e!==pL&&(Og=!1,R5(e)),Xc(),setTimeout(()=>{Xc(),Wh()},50);const n={...wt,activeStep:r.key,completed:!1,skipped:!1};try{wt=cl(n)||Ya(n)}catch(o){Me("cine.features.onboardingTour could not update stored step state.",o),wt=Ya(n)}E5(),ru()}function Xb(){if(!wo)return;pn&&Eme(pn.key);const e=sf+1;if(e>=Qn.length){Ame();return}OR(e)}function L_(){if(!wo)return;const e=Math.max(0,sf-1);OR(e)}function Eme(e){if(!e)return;const t=wt&&Array.isArray(wt.completedSteps)?wt.completedSteps.slice():[];if(t.indexOf(e)!==-1)return;t.push(e);const r=Fg(),n={...wt,completedSteps:t,lastCompletedStep:e,lastCompletedAt:r};wt=cl(n)||Ya(n),T5(sf),P5(pn,sf),ru()}function B5(e){const t=jE("tutorialSkipTitle","Skip Tutorial"),r=jE("tutorialSkipMessage","Are you sure you want to skip the tutorial? You can restart it later from the Help menu."),n=jE("tutorialSkipConfirm","Skip"),o=jE("tutorialSkipCancel","Cancel"),a=he.cineShowConfirmDialog||(typeof window<"u"?window.cineShowConfirmDialog:null);if(typeof a=="function"){a({title:t,message:r,confirmLabel:n,cancelLabel:o,onConfirm:()=>{KA()}});return}if(!he.confirm){KA();return}const i=`${t}

${r}`.trim();let s=!1;try{s=he.confirm(`${i}

${n}/${o}`)}catch(l){Me("cine.features.onboardingTour could not show skip confirmation dialog.",l),s=!1}s&&KA()}function KA(){Qb(),qb(),Wb(),Yb(),M5(),AS(!0);const e={...wt,skipped:!0,completed:!1,activeStep:null};wt=cl(e)||Ya(e),ru()}function Ame(){Qb(),qb(),Wb(),Yb(),M5(),AS(!1);const e=Qn.map(a=>a.key),t=Fg(),r=e.length?e[e.length-1]:null,n={...wt,completed:!0,skipped:!1,activeStep:null,completedSteps:e,lastCompletedStep:r,lastCompletedAt:t};wt=cl(n)||Ya(n),ru()}function G5(e){if(!wo)return;const t=e&&e.key;if(!t)return;if(t==="Escape"){e.preventDefault(),B5();return}if(t==="ArrowRight"){e.preventDefault(),Xb();return}if(t==="ArrowLeft"){e.preventDefault(),L_();return}if(t!=="Tab")return;const r=[],n=new Set,o=f=>{f&&(n.has(f)||(n.add(f),r.push(f)))},a=qU(zr);for(let f=0;f<a.length;f+=1)o(a[f]);if(Array.isArray(Ku))for(let f=0;f<Ku.length;f+=1){const d=Ku[f],p=qU(d,!0);for(let h=0;h<p.length;h+=1)o(p[h])}const i=ipe(r);if(!i.length)return;const s=e.shiftKey?-1:1,l=W.activeElement;let c=i.indexOf(l);c===-1&&(c=s===1?-1:0),c=(c+s+i.length)%i.length,e.preventDefault();const u=i[c];if(u)try{u.focus({preventScroll:!0})}catch{u.focus()}}function Cme(){if(he&&typeof he.addEventListener=="function"&&(he.addEventListener("resize",Xc),he.addEventListener("scroll",mL,!0)),W&&typeof W.addEventListener=="function"&&(W.addEventListener("scroll",mL,!0),Rg&&W.addEventListener("toggle",u5,!0)),jpe(),W&&typeof W.getElementById=="function"&&typeof MutationObserver=="function"){const e=W.getElementById("sideMenu");if(e&&!dd)try{dd=new MutationObserver(()=>{Xc(),wo&&pn&&setTimeout(()=>{A5(pn)},100)}),dd.observe(e,{attributes:!0,attributeFilter:["class","hidden","aria-hidden"]})}catch(t){dd=null,Me("cine.features.onboardingTour could not observe side menu.",t)}}}function wme(){if(he&&typeof he.removeEventListener=="function"&&(he.removeEventListener("resize",Xc),he.removeEventListener("scroll",mL,!0)),W&&typeof W.removeEventListener=="function"&&(W.removeEventListener("scroll",mL,!0),Rg&&W.removeEventListener("toggle",u5,!0)),dd){try{dd.disconnect()}catch{}dd=null}Hpe()}function R_(e={}){const{resume:t=!1,focusStart:r=!0,allowSkipOverride:n=!1}=e||{};if(Upe(),Ke=A_(),Qn=CS(),wt=af(),wt&&wt.skipped&&!n){bL(wt,Qn);return}AS(!1),wt&&wt.skipped&&(wt=Ya({...wt,skipped:!1}));const o=new Set(wt&&Array.isArray(wt.completedSteps)?wt.completedSteps:[]);let a=t&&wt&&wt.activeStep?Qn.findIndex(s=>s.key===wt.activeStep):-1;a<0&&(a=Qn.findIndex(s=>s&&!o.has(s.key)));const i=a>=0?a:Qn.length-1;Je&&(Tg(),Je.classList.add("active"),Je.setAttribute("aria-hidden","false"),Je.style&&(Je.style.pointerEvents="none")),wo=!0,sf=-1,pn=null,Fu=!1,fl=null,Og=!!t,pL=Og?i:null,Cme(),OR(i),bL(wt,Qn),r&&E5()}function M5(){wo=!1,h5(),m5(),k5(null),aB(),wme(),Qb(),qb(),Wb(),Yb(),Je&&(Je.classList.remove("active"),Je.setAttribute("aria-hidden","true")),zpe()}function iB(){Ke=A_(),wo&&(I5(pn,sf),Wh()),ru()}function kk(){kf=null}function Ik(e){if(!e)return!1;if(hL(e))return!0;if(typeof e.querySelector=="function")try{if(e.querySelector(b_))return!0}catch{}return!1}function Lme(e){if(!(!Array.isArray(e)||!e.length))for(let t=0;t<e.length;t+=1){const r=e[t];if(r){if(r.type==="attributes"){if(Ik(r.target)){kk();return}}else if(r.type==="childList"){const n=r.addedNodes||[];for(let a=0;a<n.length;a+=1){const i=n[a];if(Ik(i)){kk();return}}const o=r.removedNodes||[];for(let a=0;a<o.length;a+=1){const i=o[a];if(Ik(i)){kk();return}}}}}}function Rme(){if(HE||typeof MutationObserver!="function"||!W)return;const e=W.body||W.documentElement;if(e)try{HE=new MutationObserver(Lme),HE.observe(e,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["data-onboarding-tour-trigger","id"]})}catch(t){Me("cine.features.onboardingTour could not observe help trigger mutations.",t),HE=null}}function hL(e){return e?typeof e.matches=="function"&&e.matches(b_)||typeof e.getAttribute=="function"&&e.getAttribute("data-onboarding-tour-trigger")!==null?!0:typeof e.id=="string"&&e.id===i5:!1}function Tme(e){let t=e;for(;t&&t!==W&&t!==W.body;){if(hL(t))return t;t=t.parentElement||t.parentNode||null}return hL(t)?t:null}function oz(e=!1){if(Rme(),!e&&Array.isArray(kf)&&kf.length>0){const o=[];for(let a=0;a<kf.length;a+=1){const i=kf[a];!i||typeof i.addEventListener!="function"||typeof i.isConnected=="boolean"&&!i.isConnected||hL(i)&&o.push(i)}if(o.length)return kf=o,o}const r=[],n=new Set;if(W&&typeof W.querySelectorAll=="function"){const o=W.querySelectorAll(b_);for(let a=0;a<o.length;a+=1){const i=o[a];!i||typeof i.addEventListener!="function"||n.has(i)||(n.add(i),r.push(i))}}if(W&&typeof W.getElementById=="function"){const o=W.getElementById(i5);o&&typeof o.addEventListener=="function"&&!n.has(o)&&r.push(o)}return kf=r,r}function Ome(){return Ip&&Ip.isConnected?Ip:!W||typeof W.getElementById!="function"?(Ip=null,null):(Ip=W.getElementById(Xde)||null,Ip)}function Pk(e){if(!e)return"";const t=Ke.steps&&Ke.steps[e];return t&&typeof t.title=="string"&&t.title?t.title:e}function xme(e){if(typeof e!="number"||Number.isNaN(e)||e<=0)return"";const t=Fg();if(!t)return"";const r=Math.max(0,t-e),n=60*1e3,o=60*n,a=24*o;if(r<45*1e3)return Ke.helpStatusTimeJustNow||"just now";if(r<90*1e3)return Ke.helpStatusTimeMinute||"1 minute ago";if(r<45*n){const l=Math.round(r/n);return(Ke.helpStatusTimeMinutes||"{count} minutes ago").replace("{count}",String(l))}if(r<90*n)return Ke.helpStatusTimeHour||"1 hour ago";if(r<22*o){const l=Math.round(r/o);return(Ke.helpStatusTimeHours||"{count} hours ago").replace("{count}",String(l))}if(r<36*o)return Ke.helpStatusTimeDay||"1 day ago";const i=Math.round(r/a);return(Ke.helpStatusTimeDays||"{count} days ago").replace("{count}",String(i))}function kme(e,t){const r=xme(t);return r?e?(Ke.helpStatusLastCompleted||"Last completed: {step} ({timeAgo}).").replace("{step}",e).replace("{timeAgo}",r):(Ke.helpStatusLastUpdated||"Last update: {timeAgo}.").replace("{timeAgo}",r):""}function bL(e,t){const r=Ome();if(!r)return;const n=Array.isArray(t)&&t.length?t:CS(),o=n.map(k=>k&&k.key).filter(Boolean),a=e||wt||E_(),i=a&&Array.isArray(a.completedSteps)?a.completedSteps:[],s=new Set;for(let k=0;k<i.length;k+=1){const _=i[k];typeof _=="string"&&o.indexOf(_)!==-1&&s.add(_)}const c=n.filter(Wd).length,u=Math.min(LR(n,s),c),f=a&&typeof a.activeStep=="string"?a.activeStep:null,d=f?o.indexOf(f):-1,p=gpe(n,s),h=p?p.key:null,m=h?Pk(h):"",g=d>=0?Pk(f):"",S=a&&typeof a.lastCompletedStep=="string"?a.lastCompletedStep:null,y=S&&o.indexOf(S)!==-1?Pk(S):"",E=a&&typeof a.lastCompletedAt=="number"?a.lastCompletedAt:null;let L="notStarted";a&&a.completed?L="completed":a&&a.skipped?L="skipped":d>=0?L="resume":u>0&&(L="inProgress");let v;L==="completed"?(v=Ke.helpStatusCompleted||"",v||(v="Tutorial complete. Replay any step anytime for a refresher.")):L==="skipped"?(v=Ke.helpStatusSkipped||"",v||(v="Tutorial skipped. Restart when you're readythe saved progress stays available offline.")):L==="resume"?(v=Ke.helpStatusResume||Ke.helpStatusInProgress||"",v||(v="Paused at {current}. {completed} of {total} steps already saved offline.")):L==="inProgress"?(v=Ke.helpStatusInProgress||"",v||(v="Progress saved offline: {completed} of {total} steps complete. Next: {next}.")):(v=Ke.helpStatusNotStarted||"",v||(v="Your guided tutorial progress will be saved offline as you go. Next: {next}."));const A={"{completed}":String(u),"{total}":String(c),"{next}":m||g||"","{current}":g||m||"","{step}":g||m||""};let R=v;const I=Object.keys(A);for(let k=0;k<I.length;k+=1){const _=I[k];R=R.split(_).join(A[_])}const C=kme(y,E);C&&(R=`${R} ${C}`.trim()),r.textContent=R,r.hidden=!R}function ru(){let e=oz();if(e.length||(e=oz(!0)),!e.length){bL();return}const t=wt||E_(),r=CS(),n=wR(r),o=t&&Array.isArray(t.completedSteps)?t.completedSteps:[],a=new Set(o),i=LR(r,a),s=Ke.resumeLabelWithProgress||Ke.resumeLabel;let l;t&&t.completed?l=Ke.restartLabel||Ke.startLabel||"Start guided tutorial":t&&t.activeStep?(s&&(l=s.replace("{completed}",String(Math.min(i,n))).replace("{total}",String(n))),l||(l=Ke.resumeLabel||Ke.startLabel||"Resume guided tutorial")):i>0?s&&(l=s.replace("{completed}",String(Math.min(i,n))).replace("{total}",String(n))):l=Ke.startLabel||"Start guided tutorial";const c=typeof Ke.startLabel=="string"&&Ke.startLabel.trim()?Ke.startLabel.trim():"Start guided tutorial",u=typeof l=="string"&&l.trim()?l.trim():c;for(let f=0;f<e.length;f+=1){const d=e[f];if(d&&(d.textContent=u,typeof d.setAttribute=="function"))try{d.setAttribute("aria-label",u)}catch{}}bL(t,r)}function Ime(e){e&&typeof e.preventDefault=="function"&&e.preventDefault();const t=()=>{wt=af();const o=!!(wt&&Array.isArray(wt.completedSteps)&&wt.completedSteps.length>0)&&!!(wt&&wt.activeStep);R_({resume:o,allowSkipOverride:!0})},r=W&&typeof W.getElementById=="function"?W.getElementById("helpDialog"):null;if(r&&typeof isDialogOpen=="function"&&typeof closeDialog=="function"&&isDialogOpen(r)){if(closeDialog(r),typeof r.setAttribute=="function")try{r.setAttribute("hidden","")}catch{}if(r&&typeof r=="object"&&"hidden"in r)try{r.hidden=!0}catch{}typeof he.requestAnimationFrame=="function"?he.requestAnimationFrame(()=>{he.requestAnimationFrame(t)}):setTimeout(t,0);return}t()}function Pme(){if(!ZU&&W&&typeof W.addEventListener=="function"){Tk||(Tk=e=>{Tme(e&&e.target)&&Ime(e)});try{W.addEventListener("click",Tk,!0),ZU=!0}catch(e){Me("cine.features.onboardingTour could not attach help trigger listener.",e)}}ru()}function SL(){if(!wo&&wt&&wt.activeStep&&!wt.completed&&!wt.skipped)return!(typeof wt.lastCompletedAt=="number"&&wt.lastCompletedAt>0&&Fg()-wt.lastCompletedAt>3600*1e3);if(!wt)return console.log("DEBUG: shouldAutoStart storedState:",JSON.stringify(wt)),!1;if(wt.completed){const t=new Set(Array.isArray(wt.completedSteps)?wt.completedSteps:[]);if(CS().every(o=>t.has(o.key)))return!1}return!(wt.skipped||f5()===!0)}function _5(){SL()&&setTimeout(()=>{if(wt=af(),!SL())return;const e=wt&&wt.activeStep;R_({resume:e,focusStart:!0,allowSkipOverride:!0})},600)}function az(){af(),Pme(),ru(),SL()&&_5()}W.readyState==="loading"?W.addEventListener("DOMContentLoaded",az,{once:!0}):az();function iz(){AS(!1),wt=cl({version:ys})||af(),ru(),!wo&&SL()&&_5()}he&&typeof he.addEventListener=="function"&&he.addEventListener("languagechange",iB);function Bme(){const e=new Set,t=h_(he);for(let r=0;r<t.length;r+=1){const n=t[r];if(!(!n||e.has(n))&&typeof n.addEventListener=="function")try{n.addEventListener("cameraPowerPlannerFactoryReset",iz),e.add(n)}catch(o){Me("cine.features.onboardingTour could not attach factory reset listener.",o)}}if(W&&typeof W.addEventListener=="function"&&!e.has(W))try{W.addEventListener("cameraPowerPlannerFactoryReset",iz),e.add(W)}catch(r){Me("cine.features.onboardingTour could not attach document factory reset listener.",r)}}if(W&&W.documentElement)try{typeof W.documentElement.hasAttribute=="function"&&W.documentElement.hasAttribute("data-onboarding-project-dialog")&&W.documentElement.removeAttribute("data-onboarding-project-dialog")}catch{}Bme();const sB=KU({start:R_,skip:KA,reset(){AS(!1),wt=cl({version:ys})||af(),ru()},getStatus(){const e=af();return KU(e)},isActive(){return wo}});Rn.registerOrQueueModule("cine.features.onboardingTour",sB,{category:"features",description:"Guided onboarding tutorial for Cine Power Planner workflows.",replace:!0,connections:["cineModuleBase","cineUi"]},e=>Me("Unable to register cine.features.onboardingTour module.",e),he,Rn.getModuleRegistry&&Rn.getModuleRegistry(he));if(typeof Rn.exposeGlobal=="function")Rn.exposeGlobal("cineFeaturesOnboardingTour",sB,he,{configurable:!0,enumerable:!1,writable:!1});else try{he.cineFeaturesOnboardingTour=sB}catch{}var Pd=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||{};function Gme(){for(var e=[Pd,Pd&&Pd.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null],t=0;t<e.length;t+=1){var r=e[t];if(!(!r||typeof r!="object"&&typeof r!="function")){if(typeof r.DEFAULT_LANGUAGE_SAFE=="string"&&r.DEFAULT_LANGUAGE_SAFE)return r.DEFAULT_LANGUAGE_SAFE;if(typeof r.CPP_DEFAULT_LANGUAGE_SAFE=="string"&&r.CPP_DEFAULT_LANGUAGE_SAFE)return r.CPP_DEFAULT_LANGUAGE_SAFE;if(r.cineCoreShared&&typeof r.cineCoreShared.DEFAULT_LANGUAGE_SAFE=="string"&&r.cineCoreShared.DEFAULT_LANGUAGE_SAFE)return r.cineCoreShared.DEFAULT_LANGUAGE_SAFE}}return null}function Mme(){var e=Gme();return e||(typeof navigator<"u"&&typeof navigator.language=="string"&&navigator.language?navigator.language.slice(0,2).toLowerCase():"en")}function sz(e,t){if(!(!e||typeof e!="object"&&typeof e!="function")){var r=function(n){if(typeof e[n]!="string"||!e[n])try{e[n]=t}catch{try{Object.defineProperty(e,n,{configurable:!0,enumerable:!1,writable:!0,value:t})}catch{}}};r("DEFAULT_LANGUAGE_SAFE"),r("CPP_DEFAULT_LANGUAGE_SAFE")}}function _me(){var e=Mme(),t=[Pd,Pd&&Pd.global,typeof globalThis<"u"?globalThis:null,typeof window<"u"?window:null,typeof self<"u"?self:null,typeof global<"u"?global:null];t.forEach(function(r){!r||typeof r!="object"&&typeof r!="function"||(sz(r,e),r.cineCoreShared&&typeof r.cineCoreShared=="object"&&sz(r.cineCoreShared,e))})}_me();var Dme=Object.freeze(["none","monitor","directorMonitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","fizHandUnit"]);function Nme(e){var t=e&&e.AUTO_GEAR_SELECTOR_TYPE_MAP&&typeof e.AUTO_GEAR_SELECTOR_TYPE_MAP=="object"?e.AUTO_GEAR_SELECTOR_TYPE_MAP:null,r=t&&Object.keys(t).length?t:Dme.reduce(function(a,i){return a[i.toLowerCase()]=i,a},Object.create(null)),n=e&&e.AUTO_GEAR_SELECTOR_TYPE_SET instanceof Set?e.AUTO_GEAR_SELECTOR_TYPE_SET:null,o=n&&n.size?n:new Set(Object.keys(r));return e&&typeof e=="object"&&(e.AUTO_GEAR_SELECTOR_TYPE_MAP||(e.AUTO_GEAR_SELECTOR_TYPE_MAP=r),e.AUTO_GEAR_SELECTOR_TYPE_SET||(e.AUTO_GEAR_SELECTOR_TYPE_SET=o)),{map:r,set:o}}var D5=Nme(Pd),Fme=D5.map,jme=D5.set;function xR(e){var t=e||"rule";return typeof crypto<"u"&&crypto.randomUUID?"".concat(t,"-").concat(crypto.randomUUID()):"".concat(t,"-").concat(Math.random().toString(36).slice(2),"-").concat(Date.now())}function T_(e){var t=parseInt(e,10);return Number.isFinite(t)&&t>0?t:1}function gu(e,t){var r={},n=r.collapseWhitespace,o=n===void 0?!0:n;if(typeof e=="number"&&Number.isFinite(e))return String(e);if(typeof e!="string")return"";var a=e.trim();return o?a.replace(/\s+/g," "):a}function N5(e){var t=typeof e=="string"?e.trim().toLowerCase():"";if(!t)return"none";var r=typeof AUTO_GEAR_SELECTOR_TYPE_SET<"u"&&AUTO_GEAR_SELECTOR_TYPE_SET||jme,n=typeof AUTO_GEAR_SELECTOR_TYPE_MAP<"u"&&AUTO_GEAR_SELECTOR_TYPE_MAP||Fme;return!r||!r.has(t)?"none":n&&n[t]||"none"}function F5(e,t,r){var n=gu(t);if(!n)return"";var o=$me(e,r?{selectorContext:r}:null);if(!o.length)return n;var a=o.find(function(i){return i.toLowerCase()===n.toLowerCase()});return a||n}var lz={focus:"monitor",handheld7:"monitor",combo15:"directorMonitor",director15:"directorMonitor"};function wS(e){var t={focus:"",handheld7:"",combo15:"",director15:""};return!e||typeof e!="object"||Object.keys(lz).forEach(function(r){var n=lz[r],o=F5(n,e[r]);t[r]=o}),t}function Hme(){if(DEVICE_GLOBAL_SCOPE&&DEVICE_GLOBAL_SCOPE.devices&&typeof DEVICE_GLOBAL_SCOPE.devices=="object")return DEVICE_GLOBAL_SCOPE.devices;try{return typeof devices<"u"&&devices&&typeof devices=="object"?devices:null}catch(e){if(e&&typeof e=="object"&&e.name==="ReferenceError")return null;throw e}}function Ume(e){if(typeof document>"u")return null;var t=AUTO_GEAR_TRIPOD_FIELD_IDS[e];return t?document.getElementById(t):null}function zme(e){if(!AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(e))return[];var t=Ume(e);if(!t||!t.options)return[];var r=Array.from(t.options),n=new Set,o=[];return r.forEach(function(a){if(a){var i=typeof a.value=="string"?a.value.trim():"",s=typeof a.textContent=="string"?a.textContent.trim():"",l=i||s;if(l){var c=l.toLowerCase();n.has(c)||(n.add(c),o.push({value:l,label:s||l}))}}}),o}function $me(e,t){var r=N5(e),n=Hme();if(!n||typeof n!="object")return[];if(r==="monitor"){var o=n&&n.monitors?n.monitors:null;return!o||typeof o!="object"?[]:Object.keys(o).filter(function(p){return p&&p!=="None"}).sort(localeSort)}if(r==="directorMonitor"){var a=n&&n.directorMonitors?n.directorMonitors:null;return!a||typeof a!="object"?[]:Object.keys(a).filter(function(p){return p&&p!=="None"}).sort(localeSort)}if(r==="fizHandUnit"){var i=typeof AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"?AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS:typeof globalThis<"u"&&typeof globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS=="object"?globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS:Object.create(null),s=typeof AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"?AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP:typeof globalThis<"u"&&typeof globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP=="object"?globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP:Object.create(null),l="";if(t&&typeof t=="object"){var c=t.selectorContext||t.context;typeof c=="string"&&(l=c.trim())}else typeof t=="string"&&(l=t.trim());var u=null;if(l&&(u=i[l]||null,!u)){var f=lh(l);f&&(i[f]?u=i[f]:s[f]&&i[s[f]]&&(u=i[s[f]]))}if(u&&Array.isArray(u.options))return u.options.slice();var d=[];return Object.values(i).forEach(function(p){!p||!Array.isArray(p.options)||p.options.forEach(function(h){!h||d.includes(h)||d.push(h)})}),d}return AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(r)?zme(r).map(function(p){return p.value}):[]}function Vme(e){return typeof e!="string"?!1:e.trim().toLowerCase()==="monitoring"}function qme(e){var t=[];if(!e||typeof e!="string")return{baseName:"",contexts:t};for(var r=e.trim(),n=/^(.*\([^()]*\)) \(([^()]+)\)$/,o=r.match(n);o;){var a=o[2].trim();if(/handheld\b/i.test(a)||/15-21"?$/.test(a))t.unshift(a),r=o[1].trim();else break;o=r.match(n)}return{baseName:r,contexts:t}}function lB(e){if(!e||typeof e!="object")return null;var t=gu(e.name),r=typeof e.ownGearId=="string"?e.ownGearId.trim():"",n=gu(e.ownGearLabel),o=gu(e.ownGearName),a=null;r&&(a=findAutoGearOwnGearById(r)||null);var i=a?.name||o||t;if(!i)return null;var s=qme(t||i),l=s.baseName,c=s.contexts,u=l||i,f=Array.isArray(e.contextNotes)?e.contextNotes.filter(function(I){return typeof I=="string"&&I.trim()}):[];f.forEach(function(I){var C=I.trim();C&&(c.includes(C)||c.push(C))});var d=gu(e.category),p=T_(e.quantity),h=typeof e.id=="string"&&e.id?e.id:xR("item"),m=gu(e.screenSize),g=N5(e.selectorType),S=typeof e.selectorContext=="string"?e.selectorContext.trim():"",y=F5(g,e.selectorDefault,S),E=!!e.selectorEnabled;g==="none"?E=!1:Vme(d)&&(E=!0);var L=gu(e.notes),v="",A="";if(a){if(v=a.id,A=a.name||"",u=a.name||u,!L&&typeof a.notes=="string"){var R=gu(a.notes);R&&(L=R)}}else r&&(v=r,A=n||o||u);return{id:h,name:u,category:d,quantity:p,screenSize:m,selectorType:g,selectorDefault:y,selectorEnabled:E,selectorContext:S,notes:L,contextNotes:c,ownGearId:v,ownGearLabel:A}}function ko(e){return Array.isArray(e)?Array.from(new Set(e.map(function(t){return typeof t=="string"?t.trim():""}).filter(Boolean))):[]}var Kme=new Set(["all","any","multiplier"]);function Wme(e){if(typeof e!="string")return"all";var t=e.trim().toLowerCase();return t?t==="or"?"any":t==="and"?"all":t==="any"?"any":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":Kme.has(t)?t:"all":"all"}var Yme=new Set(["all","any","or","none","multiplier"]),Qme={mattebox:"matteboxLogic",cameraHandle:"cameraHandleLogic",viewfinderExtension:"viewfinderExtensionLogic",deliveryResolution:"deliveryResolutionLogic",videoDistribution:"videoDistributionLogic",camera:"cameraLogic",ownGear:"ownGearLogic",monitor:"monitorLogic",tripodHeadBrand:"tripodHeadBrandLogic",tripodBowl:"tripodBowlLogic",tripodTypes:"tripodTypesLogic",tripodSpreader:"tripodSpreaderLogic",crewPresent:"crewPresentLogic",crewAbsent:"crewAbsentLogic",wireless:"wirelessLogic",motors:"motorsLogic",controllers:"controllersLogic",distance:"distanceLogic"};function Br(e){if(typeof e!="string")return"all";var t=e.trim().toLowerCase();return t?t==="or"?"or":t==="and"?"all":t==="any"?"any":t==="none"||t==="no"||t==="exclude"||t==="absent"?"none":t==="multiplier"||t==="multiply"||t==="multiplied"?"multiplier":Yme.has(t)?t:(typeof console<"u"&&typeof console.warn=="function"&&console.warn('Unknown auto gear condition logic joiner. Falling back to "all".',e),"all"):"all"}function Ho(e,t){if(!e||typeof e!="object")return"all";var r=Qme[t],n;if(r&&Object.prototype.hasOwnProperty.call(e,r)&&(n=e[r]),n==null){var o="".concat(t,"Mode");Object.prototype.hasOwnProperty.call(e,o)&&(n=e[o])}return n==null&&e.conditionLogic&&typeof e.conditionLogic=="object"&&(n=e.conditionLogic[t]),Br(n)}function Xme(e){var t=parseInt(e,10);return Number.isFinite(t)&&t>1?t:1}function Jme(e){return typeof e=="string"?e.trim():""}function Zme(e){if(!Array.isArray(e))return[];var t=ko(e),r=new Set,n=[];return t.forEach(function(o){var a=o.toLowerCase(),i=a==="__none__"||a==="none"?"__none__":o;!i||r.has(i)||(r.add(i),n.push(i))}),n}function lh(e){return typeof e=="string"?e.trim().toLowerCase():""}var ege=new Set(["minimum","maximum","every"]);function tge(e){if(typeof e!="string")return"minimum";var t=e.trim().toLowerCase();return t?ege.has(t)?t:t==="min"||t==="at least"?"minimum":t==="max"||t==="at most"?"maximum":t==="each"||t==="every"?"every":"minimum":"minimum"}function cB(e){if(typeof e=="number"&&Number.isFinite(e)){var t=Math.round(e);return t>0?t:null}if(typeof e=="string"){var r=e.trim();if(!r)return null;var n=Number.parseInt(r,10);return Number.isFinite(n)&&n>0?n:null}return null}function rge(e){if(!Array.isArray(e))return[];var t=new Set;return e.forEach(function(r){var n=cB(r);Number.isFinite(n)&&n>0&&t.add(n)}),Array.from(t).sort(function(r,n){return r-n})}function O_(e){var t,r,n,o,a,i,s,l,c;if(!e)return null;if(Array.isArray(e)){var u=rge(e);if(!u.length)return null;var f=u[u.length-1];return Number.isFinite(f)&&f>0?{mode:"minimum",value:f}:null}if(typeof e=="object"){var d=(o=(n=(r=(t=e.mode)!==null&&t!==void 0?t:e.type)!==null&&r!==void 0?r:e.comparison)!==null&&n!==void 0?n:e.condition)!==null&&o!==void 0?o:e.kind,p=tge(d),h=(c=(l=(s=(i=(a=e.value)!==null&&a!==void 0?a:e.count)!==null&&i!==void 0?i:e.days)!==null&&s!==void 0?s:e.minimum)!==null&&l!==void 0?l:e.maximum)!==null&&c!==void 0?c:e.frequency,m=cB(h);return Number.isFinite(m)&&m>0?{mode:p,value:m}:null}var g=cB(e);return Number.isFinite(g)&&g>0?{mode:"minimum",value:g}:null}function kR(e){if(!e||typeof e!="object")return null;var t=typeof e.id=="string"&&e.id?e.id:xR("rule"),r=typeof e.label=="string"?e.label.trim():"",n=!0;if(typeof e.enabled=="string"){var o=e.enabled.trim().toLowerCase();(o==="false"||o==="0")&&(n=!1)}else e.enabled===!1&&(n=!1);var a=!1;if(Array.isArray(e.always))a=e.always.some(function(be){if(typeof be=="string"){var ye=be.trim().toLowerCase();return!(!ye||ye==="false"||ye==="0")}return!!be});else if(typeof e.always=="string"){var i=e.always.trim().toLowerCase();a=i==="true"||i&&i!=="false"&&i!=="0"}else a=!!e.always;var s=ko(e.scenarios),l=Wme(e.scenarioLogic),c=1,u="";if(l==="multiplier"){c=Xme(e.scenarioMultiplier);var f=Jme(e.scenarioPrimary),d=lh(f);if(d){var p=s.find(function(be){return lh(be)===d});p?u=p:f&&(u=f,s.push(f))}!u&&s.length&&(u=s[0])}if(s=s.sort(function(be,ye){return be.localeCompare(ye)}),l==="multiplier"&&u){var h=lh(u),m=s.some(function(be){return lh(be)===h});m||(s.push(u),s.sort(function(be,ye){return be.localeCompare(ye)}))}var g=ko(e.mattebox).sort(function(be,ye){return be.localeCompare(ye)}),S=ko(e.cameraHandle).sort(function(be,ye){return be.localeCompare(ye)}),y=ko(e.viewfinderExtension).sort(function(be,ye){return be.localeCompare(ye)}),E=ko(e.deliveryResolution).sort(function(be,ye){return be.localeCompare(ye)}),L=Zme(e.videoDistribution).sort(function(be,ye){return be.localeCompare(ye)}),v=ko(e.camera).sort(function(be,ye){return be.localeCompare(ye)}),A=ko(e.ownGear).sort(function(be,ye){return be.localeCompare(ye)}),R=normalizeAutoGearCameraWeightCondition(e.cameraWeight),I=ko(e.monitor).sort(function(be,ye){return be.localeCompare(ye)}),C=ko(e.tripodHeadBrand).sort(function(be,ye){return be.localeCompare(ye)}),k=ko(e.tripodBowl).sort(function(be,ye){return be.localeCompare(ye)}),_=ko(e.tripodTypes).sort(function(be,ye){return be.localeCompare(ye)}),w=ko(e.tripodSpreader).sort(function(be,ye){return be.localeCompare(ye)}),x=ko(e.crewPresent).sort(function(be,ye){return be.localeCompare(ye)}),G=ko(e.crewAbsent).sort(function(be,ye){return be.localeCompare(ye)}),T=ko(e.wireless).sort(function(be,ye){return be.localeCompare(ye)}),P=ko(e.motors).sort(function(be,ye){return be.localeCompare(ye)}),N=ko(e.controllers).sort(function(be,ye){return be.localeCompare(ye)}),q=ko(e.distance).sort(function(be,ye){return be.localeCompare(ye)}),Z=O_(e.shootingDays),U=Ho(e,"mattebox"),K=Ho(e,"cameraHandle"),H=Ho(e,"viewfinderExtension"),te=Ho(e,"deliveryResolution"),re=Ho(e,"videoDistribution"),fe=Ho(e,"camera"),Oe=Ho(e,"ownGear"),Te=Ho(e,"monitor"),Ne=Ho(e,"tripodHeadBrand"),Ie=Ho(e,"tripodBowl"),et=Ho(e,"tripodTypes"),Ze=Ho(e,"tripodSpreader"),Ft=Ho(e,"crewPresent"),Ye=Ho(e,"crewAbsent"),ct=Ho(e,"wireless"),Y=Ho(e,"motors"),ee=Ho(e,"controllers"),Ae=Ho(e,"distance"),ve={};if(l&&l!=="all"&&(ve.scenarios=l),U&&U!=="all"&&(ve.mattebox=U),K&&K!=="all"&&(ve.cameraHandle=K),H&&H!=="all"&&(ve.viewfinderExtension=H),te&&te!=="all"&&(ve.deliveryResolution=te),re&&re!=="all"&&(ve.videoDistribution=re),fe&&fe!=="all"&&(ve.camera=fe),Oe&&Oe!=="all"&&(ve.ownGear=Oe),Te&&Te!=="all"&&(ve.monitor=Te),Ne&&Ne!=="all"&&(ve.tripodHeadBrand=Ne),Ie&&Ie!=="all"&&(ve.tripodBowl=Ie),et&&et!=="all"&&(ve.tripodTypes=et),Ze&&Ze!=="all"&&(ve.tripodSpreader=Ze),Ft&&Ft!=="all"&&(ve.crewPresent=Ft),Ye&&Ye!=="all"&&(ve.crewAbsent=Ye),ct&&ct!=="all"&&(ve.wireless=ct),Y&&Y!=="all"&&(ve.motors=Y),ee&&ee!=="all"&&(ve.controllers=ee),Ae&&Ae!=="all"&&(ve.distance=Ae),!a&&!s.length&&!Z&&!g.length&&!S.length&&!y.length&&!E.length&&!L.length&&!v.length&&!A.length&&!R&&!I.length&&!C.length&&!k.length&&!_.length&&!w.length&&!x.length&&!G.length&&!T.length&&!P.length&&!N.length&&!q.length)return null;var se=Array.isArray(e.add)?e.add.map(lB).filter(Boolean):[],de=Array.isArray(e.remove)?e.remove.map(lB).filter(Boolean):[];return!se.length&&!de.length?null:{id:t,label:r,always:a,scenarioLogic:l,scenarioPrimary:u,scenarioMultiplier:c,scenarios:s,mattebox:g,cameraHandle:S,viewfinderExtension:y,deliveryResolution:E,videoDistribution:L,camera:v,ownGear:A,cameraWeight:R,monitor:I,tripodHeadBrand:C,tripodBowl:k,tripodTypes:_,tripodSpreader:w,crewPresent:x,crewAbsent:G,wireless:T,motors:P,controllers:N,distance:q,shootingDays:Z,matteboxLogic:U,cameraHandleLogic:K,viewfinderExtensionLogic:H,deliveryResolutionLogic:te,videoDistributionLogic:re,cameraLogic:fe,ownGearLogic:Oe,monitorLogic:Te,tripodHeadBrandLogic:Ne,tripodBowlLogic:Ie,tripodTypesLogic:et,tripodSpreaderLogic:Ze,crewPresentLogic:Ft,crewAbsentLogic:Ye,wirelessLogic:ct,motorsLogic:Y,controllersLogic:ee,distanceLogic:Ae,conditionLogic:ve,add:se,remove:de,enabled:n}}function j5(e){var t=lB(e);if(!t)return{name:"",category:"",quantity:0,screenSize:"",selectorType:"none",selectorDefault:"",selectorEnabled:!1,notes:"",ownGearId:"",ownGearLabel:""};var r=t.name,n=t.category,o=t.quantity,a=t.screenSize,i=t.selectorType,s=t.selectorDefault,l=t.selectorEnabled,c=t.notes,u=t.ownGearId,f=t.ownGearLabel;return{name:r,category:n,quantity:T_(o),screenSize:a,selectorType:i,selectorDefault:s,selectorEnabled:l,notes:c,ownGearId:u,ownGearLabel:f}}function vL(e){var t=j5(e),r=t.name||"",n=t.category||"",o=T_(t.quantity),a=t.screenSize||"",i=t.selectorType||"none",s=t.selectorDefault||"",l=t.selectorEnabled?"1":"0",c=t.notes||"",u=t.ownGearId||"",f=t.ownGearLabel||"";return"".concat(r,"|").concat(n,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(s,"|").concat(c,"|").concat(u,"|").concat(f)}function nge(e){var t=kR(e);if(!t)return null;var r=function(n){return n.map(j5).sort(function(o,a){return vL(o).localeCompare(vL(a))})};return{label:t.label||"",always:t.always?1:0,scenarios:t.scenarios.slice().sort(function(n,o){return n.localeCompare(o)}),mattebox:t.mattebox.slice().sort(function(n,o){return n.localeCompare(o)}),cameraHandle:t.cameraHandle.slice().sort(function(n,o){return n.localeCompare(o)}),viewfinderExtension:t.viewfinderExtension.slice().sort(function(n,o){return n.localeCompare(o)}),deliveryResolution:t.deliveryResolution.slice().sort(function(n,o){return n.localeCompare(o)}),videoDistribution:t.videoDistribution.slice().sort(function(n,o){return n.localeCompare(o)}),camera:t.camera.slice().sort(function(n,o){return n.localeCompare(o)}),cameraWeight:t.cameraWeight?{operator:t.cameraWeight.operator,value:t.cameraWeight.value}:null,monitor:t.monitor.slice().sort(function(n,o){return n.localeCompare(o)}),tripodHeadBrand:t.tripodHeadBrand.slice().sort(function(n,o){return n.localeCompare(o)}),tripodBowl:t.tripodBowl.slice().sort(function(n,o){return n.localeCompare(o)}),tripodTypes:t.tripodTypes.slice().sort(function(n,o){return n.localeCompare(o)}),tripodSpreader:t.tripodSpreader.slice().sort(function(n,o){return n.localeCompare(o)}),crewPresent:t.crewPresent.slice().sort(function(n,o){return n.localeCompare(o)}),crewAbsent:t.crewAbsent.slice().sort(function(n,o){return n.localeCompare(o)}),wireless:t.wireless.slice().sort(function(n,o){return n.localeCompare(o)}),motors:t.motors.slice().sort(function(n,o){return n.localeCompare(o)}),controllers:t.controllers.slice().sort(function(n,o){return n.localeCompare(o)}),distance:t.distance.slice().sort(function(n,o){return n.localeCompare(o)}),shootingDays:O_(t.shootingDays),matteboxLogic:Br(t.matteboxLogic),cameraHandleLogic:Br(t.cameraHandleLogic),viewfinderExtensionLogic:Br(t.viewfinderExtensionLogic),deliveryResolutionLogic:Br(t.deliveryResolutionLogic),videoDistributionLogic:Br(t.videoDistributionLogic),cameraLogic:Br(t.cameraLogic),monitorLogic:Br(t.monitorLogic),tripodHeadBrandLogic:Br(t.tripodHeadBrandLogic),tripodBowlLogic:Br(t.tripodBowlLogic),tripodTypesLogic:Br(t.tripodTypesLogic),tripodSpreaderLogic:Br(t.tripodSpreaderLogic),crewPresentLogic:Br(t.crewPresentLogic),crewAbsentLogic:Br(t.crewAbsentLogic),wirelessLogic:Br(t.wirelessLogic),motorsLogic:Br(t.motorsLogic),controllersLogic:Br(t.controllersLogic),distanceLogic:Br(t.distanceLogic),conditionLogic:t.conditionLogic?Object.keys(t.conditionLogic).reduce(function(n,o){return n[o]=Br(t.conditionLogic[o]),n},{}):{},add:r(t.add),remove:r(t.remove),enabled:t.enabled?1:0}}function cz(e){var t=e&&e.always?"1":"0",r=Array.isArray(e.scenarios)?e.scenarios.join("|"):"",n=Array.isArray(e.mattebox)?e.mattebox.join("|"):"",o=Array.isArray(e.cameraHandle)?e.cameraHandle.join("|"):"",a=Array.isArray(e.viewfinderExtension)?e.viewfinderExtension.join("|"):"",i=Array.isArray(e.deliveryResolution)?e.deliveryResolution.join("|"):"",s=Array.isArray(e.videoDistribution)?e.videoDistribution.join("|"):"",l=Array.isArray(e.camera)?e.camera.join("|"):"",c=normalizeAutoGearCameraWeightCondition(e?.cameraWeight),u=c?"".concat(c.operator,":").concat(c.value):"",f=Array.isArray(e.monitor)?e.monitor.join("|"):"",d=Array.isArray(e.tripodHeadBrand)?e.tripodHeadBrand.join("|"):"",p=Array.isArray(e.tripodBowl)?e.tripodBowl.join("|"):"",h=Array.isArray(e.tripodTypes)?e.tripodTypes.join("|"):"",m=Array.isArray(e.tripodSpreader)?e.tripodSpreader.join("|"):"",g=Array.isArray(e.crewPresent)?e.crewPresent.join("|"):"",S=Array.isArray(e.crewAbsent)?e.crewAbsent.join("|"):"",y=Array.isArray(e.wireless)?e.wireless.join("|"):"",E=Array.isArray(e.motors)?e.motors.join("|"):"",L=Array.isArray(e.controllers)?e.controllers.join("|"):"",v=Array.isArray(e.distance)?e.distance.join("|"):"",A=O_(e?.shootingDays),R=A?"".concat(A.mode,":").concat(A.value):"",I=Br(e?.matteboxLogic),C=Br(e?.cameraHandleLogic),k=Br(e?.viewfinderExtensionLogic),_=Br(e?.deliveryResolutionLogic),w=Br(e?.videoDistributionLogic),x=Br(e?.cameraLogic),G=Br(e?.monitorLogic),T=Br(e?.tripodHeadBrandLogic),P=Br(e?.tripodBowlLogic),N=Br(e?.tripodTypesLogic),q=Br(e?.tripodSpreaderLogic),Z=Br(e?.crewPresentLogic),U=Br(e?.crewAbsentLogic),K=Br(e?.wirelessLogic),H=Br(e?.motorsLogic),te=Br(e?.controllersLogic),re=Br(e?.distanceLogic),fe=Array.isArray(e.add)?e.add.map(vL).join("|"):"",Oe=Array.isArray(e.remove)?e.remove.map(vL).join("|"):"";return"".concat(t,"|").concat(r,"|").concat(n,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(l,"|").concat(u,"|").concat(f,"|").concat(d,"|").concat(p,"|").concat(h,"|").concat(m,"|").concat(g,"|").concat(S,"|").concat(y,"|").concat(E,"|").concat(L,"|").concat(v,"|").concat(R,"|").concat(I,"|").concat(C,"|").concat(k,"|").concat(_,"|").concat(w,"|").concat(x,"|").concat(G,"|").concat(T,"|").concat(P,"|").concat(N,"|").concat(q,"|").concat(Z,"|").concat(U,"|").concat(K,"|").concat(H,"|").concat(te,"|").concat(re,"|").concat(e.label||"","|").concat(fe,"|").concat(Oe)}function oge(e){var t=(Array.isArray(e)?e:[]).map(nge).filter(Boolean).sort(function(r,n){return cz(r).localeCompare(cz(n))});return stableStringify(t)}function age(e){if(!e||typeof e!="object")return null;var t=typeof e.label=="string"?e.label.trim():"";if(!t)return null;var r=Array.isArray(e.rules)?e.rules:[],n=r.map(kR).filter(Boolean),o=typeof e.id=="string"&&e.id?e.id:xR("preset"),a=oge(n);return{id:o,label:t,rules:n,fingerprint:a}}function ige(e){if(!e||typeof e!="object")return null;var t=typeof e.createdAt=="string"?e.createdAt:null,r=t?Date.parse(t):NaN;if(!Number.isFinite(r))return null;var n=new Date(r).toISOString(),o=Array.isArray(e.rules)?e.rules:[],a=o.map(kR).filter(Boolean),i=o.length===0?[]:a,s=typeof e.id=="string"&&e.id?e.id:xR("backup"),l=wS(e.monitorDefaults),c=typeof e.note=="string"?e.note:"";return{id:s,createdAt:n,rules:i,monitorDefaults:l,note:c}}var sge="cameraPowerPlanner_autoGearBackupRetention",lge=36,Bk=1,cge=120,Yh=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||typeof global<"u"&&global||null;function Jb(e){if(!Yh)return null;var t=Yh[e];return typeof t=="number"&&Number.isFinite(t)?t:null}function uge(e,t,r){if(typeof e!="number"||!Number.isFinite(e))return null;var n=Math.round(e);return Number.isFinite(n)?n<t?t:n>r?r:n:null}function EL(){var e=Jb("AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE");if(e!==null)return Math.max(Bk,Math.round(e));var t=Jb("AUTO_GEAR_BACKUP_RETENTION_MIN");return t!==null?Math.max(Bk,Math.round(t)):Bk}function H5(){var e=Jb("AUTO_GEAR_BACKUP_RETENTION_MAX");return e!==null?Math.max(EL(),Math.round(e)):Math.max(EL(),cge)}function Zm(){for(var e=EL(),t=H5(),r=[Jb("AUTO_GEAR_BACKUP_RETENTION_DEFAULT"),Jb("AUTO_GEAR_BACKUP_RETENTION_DEFAULT_VALUE"),lge],n=0;n<r.length;n+=1){var o=r[n],a=uge(o,e,t);if(typeof a=="number")return a}return e}function U5(){if(Yh&&typeof Yh.AUTO_GEAR_BACKUP_RETENTION_KEY=="string"){var e=Yh.AUTO_GEAR_BACKUP_RETENTION_KEY.trim();if(e)return e}return sge}function z5(e){e===void 0&&(e=Zm());var t=[];if(typeof loadAutoGearBackups=="function")try{t=loadAutoGearBackups()}catch(o){console.warn("Failed to load automatic gear backups",o),t=[]}else if(typeof localStorage<"u")try{var r=localStorage.getItem(AUTO_GEAR_BACKUPS_KEY);t=r?JSON.parse(r):[]}catch(o){console.warn("Failed to read automatic gear backups from storage",o),t=[]}if(!Array.isArray(t))return[];var n=Bd(e);return t.map(ige).filter(Boolean).sort(function(o,a){return o.createdAt===a.createdAt?0:o.createdAt>a.createdAt?-1:1}).slice(0,n)}function fge(e){return e.sort(function(t,r){return t.label.localeCompare(r.label,void 0,{sensitivity:"base",numeric:!0})})}function dge(){var e=[];if(typeof loadAutoGearPresets=="function")try{e=loadAutoGearPresets()}catch(r){console.warn("Failed to load automatic gear presets",r),e=[]}else if(typeof localStorage<"u")try{var t=localStorage.getItem(AUTO_GEAR_PRESETS_KEY);e=t?JSON.parse(t):[]}catch(r){console.warn("Failed to read automatic gear presets from storage",r),e=[]}return Array.isArray(e)?fge(e.map(age).filter(Boolean)):[]}function pge(e){var t=Array.isArray(e)?e.map(function(r){return{id:r.id,label:r.label,rules:Array.isArray(r.rules)?r.rules:[]}}):[];if(typeof saveAutoGearPresets=="function")try{saveAutoGearPresets(t);return}catch(r){console.warn("Failed to save automatic gear presets",r)}if(!(typeof localStorage>"u"))try{localStorage.setItem(AUTO_GEAR_PRESETS_KEY,JSON.stringify(t))}catch(r){console.warn("Failed to persist automatic gear presets",r)}}function mge(){var e={};if(typeof loadAutoGearMonitorDefaults=="function")try{e=loadAutoGearMonitorDefaults()}catch(r){console.warn("Failed to load automatic gear monitor defaults",r),e={}}else if(typeof localStorage<"u")try{var t=localStorage.getItem(AUTO_GEAR_MONITOR_DEFAULTS_KEY);e=t?JSON.parse(t):{}}catch(r){console.warn("Failed to read automatic gear monitor defaults from storage",r),e={}}return wS(e)}function gge(e){var t=wS(e);if(typeof saveAutoGearMonitorDefaults=="function")try{return saveAutoGearMonitorDefaults(t),t}catch(r){console.warn("Failed to save automatic gear monitor defaults",r)}if(typeof localStorage>"u")return t;try{localStorage.setItem(AUTO_GEAR_MONITOR_DEFAULTS_KEY,JSON.stringify(t))}catch(r){console.warn("Failed to persist automatic gear monitor defaults",r)}return t}function yge(){if(typeof loadAutoGearActivePresetId=="function")try{var e=loadAutoGearActivePresetId();return typeof e=="string"?e:""}catch(r){return console.warn("Failed to load automatic gear active preset id",r),""}if(typeof localStorage>"u")return"";try{var t=localStorage.getItem(AUTO_GEAR_ACTIVE_PRESET_KEY);return typeof t=="string"?t:""}catch(r){return console.warn("Failed to read automatic gear active preset id from storage",r),""}}function hge(e){if(typeof saveAutoGearActivePresetId=="function")try{saveAutoGearActivePresetId(typeof e=="string"?e:"");return}catch(t){console.warn("Failed to save automatic gear active preset id",t)}if(!(typeof localStorage>"u"))try{e?localStorage.setItem(AUTO_GEAR_ACTIVE_PRESET_KEY,e):localStorage.removeItem(AUTO_GEAR_ACTIVE_PRESET_KEY)}catch(t){console.warn("Failed to persist automatic gear active preset id",t)}}function bge(){if(typeof loadAutoGearAutoPresetId=="function")try{var e=loadAutoGearAutoPresetId();return typeof e=="string"?e:""}catch(r){return console.warn("Failed to load automatic gear auto preset id",r),""}if(typeof localStorage>"u")return"";try{var t=localStorage.getItem(AUTO_GEAR_AUTO_PRESET_KEY);return typeof t=="string"?t:""}catch(r){return console.warn("Failed to read automatic gear auto preset id from storage",r),""}}function Sge(e){if(typeof saveAutoGearAutoPresetId=="function")try{saveAutoGearAutoPresetId(typeof e=="string"?e:"");return}catch(t){console.warn("Failed to save automatic gear auto preset id",t)}if(!(typeof localStorage>"u"))try{e?localStorage.setItem(AUTO_GEAR_AUTO_PRESET_KEY,e):localStorage.removeItem(AUTO_GEAR_AUTO_PRESET_KEY)}catch(t){console.warn("Failed to persist automatic gear auto preset id",t)}}function vge(){if(typeof loadAutoGearBackupVisibility=="function")try{return!!loadAutoGearBackupVisibility()}catch(e){return console.warn("Failed to load automatic gear backup visibility",e),!1}if(typeof localStorage>"u")return!1;try{return localStorage.getItem(AUTO_GEAR_BACKUP_VISIBILITY_KEY)==="1"}catch(e){return console.warn("Failed to read automatic gear backup visibility from storage",e),!1}}function Ege(e){var t=!!e;if(typeof saveAutoGearBackupVisibility=="function")try{saveAutoGearBackupVisibility(t);return}catch(r){console.warn("Failed to save automatic gear backup visibility",r)}if(!(typeof localStorage>"u"))try{t?localStorage.setItem(AUTO_GEAR_BACKUP_VISIBILITY_KEY,"1"):localStorage.removeItem(AUTO_GEAR_BACKUP_VISIBILITY_KEY)}catch(r){console.warn("Failed to persist automatic gear backup visibility",r)}}function Bd(e){var t=Number(e);if(!Number.isFinite(t))return Zm();var r=Math.round(t);if(!Number.isFinite(r))return Zm();var n=EL(),o=H5();return r<n?n:r>o?o:r}function Age(){if(typeof loadAutoGearBackupRetention=="function")try{return Bd(loadAutoGearBackupRetention())}catch(n){console.warn("Failed to load automatic gear backup retention",n)}if(typeof localStorage>"u")return Zm();try{var e=localStorage.getItem(U5());if(e==null)return Zm();try{var t=JSON.parse(e);return Bd(t)}catch(n){var r=Number(e);if(Number.isFinite(r))return Bd(r);throw n}}catch(n){return console.warn("Failed to read automatic gear backup retention from storage",n),Zm()}}function uB(e){var t=Bd(e);if(typeof saveAutoGearBackupRetention=="function")try{return saveAutoGearBackupRetention(t),!0}catch(r){console.warn("Failed to save automatic gear backup retention",r)}if(typeof localStorage>"u")return!1;try{return localStorage.setItem(U5(),JSON.stringify(t)),!0}catch(r){return console.warn("Failed to persist automatic gear backup retention",r),!1}}function fB(e){var t=Array.isArray(e)?e.map(function(n){return{id:n.id,createdAt:n.createdAt,rules:Array.isArray(n.rules)?n.rules:[],monitorDefaults:wS(n.monitorDefaults),note:typeof n.note=="string"?n.note:void 0}}):[];if(typeof saveAutoGearBackups=="function"){var r=saveAutoGearBackups(t);return Array.isArray(r)?r:t}if(typeof localStorage>"u")throw new Error("Storage unavailable");return localStorage.setItem(AUTO_GEAR_BACKUPS_KEY,JSON.stringify(t)),t}function $E(e,t){var r=[];typeof globalThis<"u"&&r.push(globalThis),typeof window<"u"&&r.push(window),typeof self<"u"&&r.push(self),typeof global<"u"&&r.push(global);for(var n=0;n<r.length;n+=1){var o=r[n];if(o&&Object.prototype.hasOwnProperty.call(o,e))return o[e]=t,!0}return!1}function Cge(e){var t=Bd(e),r=autoGearBackupRetention;if(t===r)return callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!0,trimmed:[],previousLimit:r};var n=autoGearBackups.slice(),o=[],a=uB(t);if(!a)return autoGearBackupRetentionInput&&(autoGearBackupRetentionInput.value=String(autoGearBackupRetention)),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!1,error:new Error("retention-persist-failed"),previousLimit:r};if($E("autoGearBackupRetention",t),autoGearBackups.length>t){var i=autoGearBackups.slice(0,t);o.push.apply(o,autoGearBackups.slice(t));try{var s=fB(i)||[],l=Array.isArray(s)?s:[];l.length<i.length&&o.push.apply(o,i.slice(l.length)),$E("autoGearBackups",l)}catch(c){console.warn("Failed to trim automatic gear backups to retention limit",c),$E("autoGearBackupRetention",r),uB(r);try{fB(n)}catch(u){console.warn("Failed to restore automatic gear backups after trim error",u)}return $E("autoGearBackups",z5(r)),callCoreFunctionIfAvailable("renderAutoGearBackupControls",[],{defer:!0}),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!1,error:c,previousLimit:r}}}return callCoreFunctionIfAvailable("renderAutoGearBackupControls",[],{defer:!0}),callCoreFunctionIfAvailable("renderAutoGearBackupRetentionControls",[],{defer:!0}),{success:!0,trimmed:o,previousLimit:r}}function wge(){var e=[];if(typeof loadAutoGearRules<"u"&&typeof loadAutoGearRules=="function")try{e=loadAutoGearRules()}catch(r){console.warn("Failed to load automatic gear rules",r),e=[]}else if(typeof localStorage<"u")try{var t=localStorage.getItem(AUTO_GEAR_RULES_KEY);e=t?JSON.parse(t):[]}catch(r){console.warn("Failed to load automatic gear rules",r),e=[]}return Array.isArray(e)?e.map(kR).filter(Boolean):[]}const Lge=Object.freeze(Object.defineProperty({__proto__:null,clampAutoGearBackupRetentionLimit:Bd,enforceAutoGearBackupRetentionLimit:Cge,normalizeAutoGearMonitorDefaults:wS,persistActiveAutoGearPresetId:hge,persistAutoGearAutoPresetId:Sge,persistAutoGearBackupRetention:uB,persistAutoGearBackupVisibility:Ege,persistAutoGearBackups:fB,persistAutoGearMonitorDefaults:gge,persistAutoGearPresets:pge,readActiveAutoGearPresetIdFromStorage:yge,readAutoGearAutoPresetIdFromStorage:bge,readAutoGearBackupRetentionFromStorage:Age,readAutoGearBackupVisibilityFromStorage:vge,readAutoGearBackupsFromStorage:z5,readAutoGearMonitorDefaultsFromStorage:mge,readAutoGearPresetsFromStorage:dge,readAutoGearRulesFromStorage:wge},Symbol.toStringTag,{value:"Module"})),Rge="1.0.52";function Tge(e){typeof window<"u"&&(window.APP_VERSION=e,window.CPP_APP_VERSION=e),typeof globalThis<"u"&&(globalThis.APP_VERSION=e,globalThis.CPP_APP_VERSION=e)}Tge(Rge);const Oge=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||self;if(xd&&typeof xd.bootstrap=="function")try{xd.bootstrap(Oge,{warnOnFailure:!0,throwOnFailure:!1}),console.log(" Runtime Guard bootstrapped via script.js")}catch(e){console.error("cineRuntimeGuard.bootstrap failed during startup.",e)}console.log("DEBUG: main.js parsing started");console.log(" Vite entry point (main.js) loaded");window.__viteMainLoaded=!0;console.log("[Vite] Entry point loaded successfully");console.log("[Vite] App version:","1.0.52");console.log("[Vite] Storage shim loaded:",Object.keys(X5).length,"exports");console.log("[Vite] Translations shim loaded:",Object.keys(J5).length,"exports");typeof window<"u"&&Object.assign(window,Lge);typeof window<"u"&&(window.rentalHouses=r3);function uz(){console.log("[Vite] Starting App Initialization..."),!window.devices||Object.keys(window.devices).length===0?console.warn("[Vite] Warning: Device database appears empty."):console.log("[Vite] Device database loaded:",Object.keys(window.devices).length,"categories");try{typeof window.populateProjectForm=="function"?(console.log("[Vite] Populating Project Form..."),window.populateProjectForm()):console.warn("[Vite] populateProjectForm not found."),typeof window.setupSideMenu=="function"&&window.setupSideMenu(),typeof window.setupResponsiveControls=="function"&&window.setupResponsiveControls(),typeof window.updateCalculations=="function"&&(console.log("[Vite] Running initial calculations..."),window.updateCalculations()),typeof window.cineAutoGearMonitoring=="object"&&typeof window.cineAutoGearMonitoring.refresh=="function"&&window.cineAutoGearMonitoring.refresh()}catch(e){console.error("[Vite] Initialization Error:",e)}console.log("[Vite] dispatching cine-loader-complete"),window.dispatchEvent(new CustomEvent("cine-loader-complete"))}typeof window<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{setTimeout(uz,50)}):setTimeout(uz,50));export{iye as a,Bge as i};
//# sourceMappingURL=main-C8GHSTtM.js.map
