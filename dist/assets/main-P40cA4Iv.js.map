{"version":3,"mappings":"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,cAAiB,mBACjB,kBAAqB,+GACrB,aAAgB,mHAChB,SAAY,CACV,QAAW,WACX,YAAe,qFACf,iBAAoB,cACpB,aAAgB,eAChB,WAAc,6FACd,WAAc,4DACd,MAAS,QACT,YAAe,iBACf,kBAAqB,iBACrB,YAAe,mBACf,YAAe,gBACf,YAAe,oBACf,mBAAsB,yBACtB,sBAAyB,2EACzB,aAAgB,UAChB,mBAAsB,sBACtB,mBAAsB,gBACtB,yBAA4B,8FAC5B,mBAAsB,QACtB,aAAgB,eAChB,iBAAoB,eACpB,aAAgB,eAChB,cAAiB,yBACjB,eAAkB,gCAClB,gBAAmB,qCACnB,cAAiB,yBACjB,uBAA0B,wCAC1B,oBAAuB,OACvB,iBAAoB,SACpB,gBAAmB,gBACnB,mBAAsB,8BACtB,sBAAyB,4BACzB,iBAAoB,sCACpB,mBAAsB,eACtB,uBAA0B,qEAC1B,qBAAwB,eACxB,2BAA8B,YAC9B,qBAAwB,gBACxB,2BAA8B,cAC9B,sBAAyB,eACzB,4BAA+B,oBAC/B,sBAAyB,gBACzB,4BAA+B,mBAC/B,gBAAmB,iLACnB,wBAA2B,eAC3B,wBAA2B,eAC3B,iBAAoB,iBACpB,gBAAmB,4CACnB,eAAkB,iCAClB,eAAkB,oDAClB,aAAgB,qCAChB,eAAkB,mBAClB,oBAAuB,0CACvB,oBAAuB,eACvB,aAAgB,sBAChB,sBAAyB,wCACzB,cAAiB,iBACjB,cAAiB,6DACjB,cAAiB,oCACjB,WAAc,qCACd,YAAe,sCACf,gBAAmB,aACzB,EACI,yBAA4B,gDAC5B,mBAAsB,8CACtB,kBAAqB,48DACrB,2BAA8B,CAC5B,QAAW,CACT,UACA,WACA,UACA,UACR,EACM,OAAU,CACR,SACA,UACA,UACA,UACR,EACM,OAAU,CACR,SACA,UACA,OACA,WACR,EACM,KAAQ,CACN,OACA,MACA,OACA,QACA,SACA,SACR,EACM,OAAU,CACR,SACA,UACA,WACA,UACA,YACA,WACA,YACR,CACA,EACI,uBAA0B,CACxB,MACA,KACA,OACA,MACA,OACA,QACA,MACA,OACA,SACA,SACA,QACA,QACA,SACA,OACA,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","names":["DEFAULT_ACCENT","HIGH_CONTRAST_ACCENT","storageErrorLogged","safeGet","key","scope","err","updateThemeColor","isDark","documentObj","meta","applyAccent","color","root","body","highContrastActive","accentValue","applyStaticTheme","highContrastEnabled","storedReduceMotion","reduceMotionEnabled","relaxedSpacingEnabled","storedPinkMode","pinkModeEnabled","storedFontSize","storedFontFamily","storedDarkMode","darkModeEnabled","accentColor","jsonDeepClone","value","resolveStructuredClone","target","detectGlobalScope","createResilientDeepClone","cloneFn","ensureDeepClone","clone","safeAssign","CORE_DEEP_CLONE","CORE_GLOBAL_SCOPE","getCoreGlobalObject","ensureCoreGlobalValue","name","fallbackValue","coreJsonDeepClone","coreCreateResilientDeepClone","DeepCloneExport","CORE_RUNTIME_GLOBAL_TOOLS","iconGlyph","ICON_GLYPHS","iconMarkup","populateId","id","data","el","e","attemptPopulate","bootstrapProvider","devices","queue","t","overlay","startForcePopulate","intervalMs","interval","V2Bootstrap","DEFAULT_LANGUAGE","LOCALE_IMPORTS","__vitePreload","loadedLocales","cloneTranslationValue","item","freezeTranslationTree","seen","alignTranslationValue","referenceValue","translationValue","referenceType","translationType","maxLength","aligned","i","refItem","transItem","alignedObject","refChild","transChild","alignDataset","referenceDataset","localeDataset","result","refVal","locVal","registerLocaleData","locale","localeTexts","localeCategoryNames","localeGearItems","defaultLocale","reference","alignedTexts","alignedCategoryNames","alignedGearItems","resolveLocaleKey","candidate","trimmed","lower","short","loadLanguage","module","initDefaultLanguage","enData","loadLanguageShim","GLOBAL_SCOPE","HORSE_SVG_MARKUP","HORN_MARKUP","UNICORN_BASE_MARKUP","UNICORN_1_MARKUP","UNICORN_2_MARKUP","UNICORN_3_MARKUP","PINK_MODE_TOGGLE_SEQUENCE","pinkModeIcons","PinkModeManager","manager","ensurePinkModeLottieRuntime","existingScript","resolve","reject","script","ensureSvgHasAriaHidden","markup","setPinkModeIconSequence","loadPinkModeIconsFromFiles","resolvePinkModeLottieRuntime","startPinkModeAnimatedIcons","stopPinkModeAnimatedIcons","triggerPinkModeIconRain","startPinkModeIconPreload","getPinkModeIconRotationTimer","setPinkModeIconRotationTimer","getPinkModeIconIndex","setPinkModeIconIndex","PINK_MODE_ICON_INTERVAL_MS","PINK_MODE_ICON_ANIMATION_CLASS","PINK_MODE_ICON_ANIMATION_RESET_DELAY","PINK_MODE_ICON_FALLBACK_MARKUP","cineCorePinkModeSupport","PINK_MODE_SUPPORT_API","AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS","resolveAutoGearConditionKeys","helpers","createDeferredAutoGearRefresher","functionName","selected","focusAutoGearConditionPicker","configureAutoGearConditionButtons","_a","_b","_c","_d","addLabel","removeLabel","conditionKeys","config","AUTO_GEAR_UI_EXPORTS_BRIDGE","AUTO_GEAR_NORMALIZER_SCOPE","stableStringify","candidateScopes","index","fallbackStableStringify","serialized","keys","keyIndex","resolveAutoGearDefaultLanguageSource","getAutoGearFallbackLanguage","resolved","assignAutoGearLanguageFallback","fallbackLanguage","assignIfMissing","ensureAutoGearDefaultLanguageGlobals","getAutoGearFallbackTexts","fallbackLang","fallbackTexts","AUTO_GEAR_DEFAULT_SELECTOR_TYPES","ensureAutoGearSelectorTypeGlobals","existingMap","resolvedMap","acc","type","existingSet","resolvedSet","AUTO_GEAR_SELECTOR_TYPE_GLOBALS","AUTO_GEAR_SELECTOR_TYPE_MAP_FALLBACK","AUTO_GEAR_SELECTOR_TYPE_SET_FALLBACK","generateAutoGearId","prefix","base","normalizeAutoGearQuantity","num","parseAutoGearDraftNames","raw","hasDelimiters","parts","part","segment","signMatch","listType","content","quantityMatch","name_1","normalizeAutoGearText","collapseWhitespace","normalizeAutoGearSelectorType","selectorSet","selectorMap","normalizeAutoGearSelectorDefault","context","text","options","getAutoGearSelectorOptions","match","option","AUTO_GEAR_MONITOR_DEFAULT_TYPES","normalizeAutoGearMonitorDefaults","normalized","resolveDevicesSnapshot","error","updateGlobalDevicesReference","nextDevices","normalizedDevices","seenScopes","scopes","enqueueScope","shared","updateError","runtimeState","globalCoreShared","resolveAutoGearCoreShared","resolveTripodPreferenceSelect","collectTripodPreferenceOptions","select","results","label","storeValue","dedupeKey","itemOrContext","normalizedType","catalog","monitorDb","directorDb","groups","motorMap","contextValue","group","normalizedContext","normalizeAutoGearTriggerValue","fallback_1","entry","getAutoGearSelectorLabel","langTexts","getAutoGearSelectorScrollHint","getAutoGearSelectorDefaultPlaceholder","getAutoGearMonitorDefaultPlaceholder","formatAutoGearSelectorValue","normalizedValue","populateAutoGearCategorySelect","currentValue","current","lang","category","customOption","formatAutoGearOwnGearLabel","quantityValue","quantityText","refreshAutoGearOwnGearConditionOptions","selectedValues","items","appendOption","trimmedId","dataset","formattedQuantity","record","selectableOptions","hasSelectable","updateAutoGearOwnGearOptions","selects","placeholder","placeholderOption","isAutoGearMonitoringCategory","isMonitoringCategorySelected","directValue","optionValue","optionLabel","matchesTripodCategory","isTripodCategorySelected","setAutoGearFieldVisibility","field","isVisible","storedDisplay","updateAutoGearMonitorFieldGroup","screenSizeField","screenSizeInput","selectorTypeField","selectorTypeSelect","selectorDefaultField","selectorDefaultInput","isMonitoring","isTripod","showScreenSize","showSelectorFields","extractAutoGearContextNotes","contexts","baseName","contextPattern","normalizeAutoGearItem","requestedName","ownGearSourceId","ownGearFallbackLabel","ownGearNameInput","ownGearRecord","rawName","storedContexts","note","quantity","screenSize","selectorType","selectorContext","selectorDefault","selectorEnabled","notes","ownGearId","ownGearLabel","trimmedNotes","normalizeAutoGearTriggerList","values","AUTO_GEAR_SCENARIO_LOGIC_VALUES","normalizeAutoGearScenarioLogic","AUTO_GEAR_CONDITION_LOGIC_VALUES","AUTO_GEAR_CONDITION_LOGIC_FIELDS","normalizeAutoGearConditionLogic","readAutoGearConditionLogic","rule","property","alias","normalizeAutoGearScenarioMultiplier","normalizeAutoGearScenarioPrimary","normalizeVideoDistributionTriggerList","autoGearRuleMatteboxKey","matteboxList","a","b","AUTO_GEAR_SHOOTING_DAY_MODES","normalizeAutoGearShootingDayMode","normalizeAutoGearShootingDayValue","rounded","parsed","normalizeAutoGearShootingDaysList","unique","normalizeAutoGearShootingDaysCondition","setting","_e","_f","_g","_h","_j","maxValue","modeSource","mode","valueSource","normalizeAutoGearRule","enabled","always","scenarios","scenarioLogic","scenarioMultiplier","scenarioPrimary","requestedPrimary","normalizedPrimary_1","matched","normalizedPrimary_2","hasPrimary","mattebox","cameraHandle","viewfinderExtension","deliveryResolution","videoDistribution","camera","ownGear","cameraWeight","monitor","tripodHeadBrand","tripodBowl","tripodTypes","tripodSpreader","crewPresent","crewAbsent","wireless","motors","controllers","distance","shootingDays","matteboxLogic","cameraHandleLogic","viewfinderExtensionLogic","deliveryResolutionLogic","videoDistributionLogic","cameraLogic","ownGearLogic","monitorLogic","tripodHeadBrandLogic","tripodBowlLogic","tripodTypesLogic","tripodSpreaderLogic","crewPresentLogic","crewAbsentLogic","wirelessLogic","motorsLogic","controllersLogic","distanceLogic","conditionLogic","add","remove","autoGearItemSnapshot","autoGearItemSortKey","snapshot","snapshotAutoGearRuleForFingerprint","mapItems","autoGearRuleSortKey","alwaysKey","scenarioKey","matteboxKey","cameraHandleKey","viewfinderKey","deliveryResolutionKey","videoDistributionKey","cameraKey","cameraWeightCondition","cameraWeightKey","monitorKey","tripodHeadBrandKey","tripodBowlKey","tripodTypesKey","tripodSpreaderKey","crewPresentKey","crewAbsentKey","wirelessKey","motorsKey","controllersKey","distanceKey","shootingDaysCondition","shootingDaysKey","matteboxLogicKey","cameraHandleLogicKey","viewfinderLogicKey","deliveryResolutionLogicKey","videoDistributionLogicKey","cameraLogicKey","monitorLogicKey","tripodHeadBrandLogicKey","tripodBowlLogicKey","tripodTypesLogicKey","tripodSpreaderLogicKey","crewPresentLogicKey","crewAbsentLogicKey","wirelessLogicKey","motorsLogicKey","controllersLogicKey","distanceLogicKey","addKey","removeKey","createAutoGearRulesFingerprint","rules","normalizeAutoGearPreset","rawRules","fingerprint","normalizeAutoGearBackupEntry","rawCreatedAt","timestamp","createdAt","normalizedRules","monitorDefaults","AUTO_GEAR_NORMALIZER_EXPORTS","AUTO_GEAR_BACKUP_RETENTION_FALLBACK_DEFAULT","AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MIN","AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MAX","AUTO_GEAR_PERSISTENCE_MODULE_NAME","AUTO_GEAR_BACKUP_GLOBAL_SCOPE","readScopedNumericAutoGearValue","resolveAutoGearPersistenceService","registry","module_1","scheduleAutoGearPersistence","payload","service","pending","normalizeRetentionCandidate","minValue","resolveAutoGearBackupRetentionMinValue","scopedMinValue","scopedMin","resolveAutoGearBackupRetentionMaxValue","scopedMax","resolveAutoGearBackupRetentionDefaultValue","candidates","readAutoGearBackupsFromStorage","retentionLimit","stored","limit","clampAutoGearBackupRetentionLimit","sortAutoGearPresets","list","readAutoGearPresetsFromStorage","persistAutoGearPresets","presets","preset","readAutoGearMonitorDefaultsFromStorage","persistAutoGearMonitorDefaults","defaults","readActiveAutoGearPresetIdFromStorage","loaderPresetId","persistActiveAutoGearPresetId","presetId","readAutoGearAutoPresetIdFromStorage","loaderAutoPresetId","persistAutoGearAutoPresetId","readAutoGearBackupVisibilityFromStorage","persistAutoGearBackupVisibility","flag","numeric","readAutoGearBackupRetentionFromStorage","cached","persistAutoGearBackupRetention","retention","persistAutoGearBackups","backups","storedPayload","assignAutoGearGlobalValue","nextValue","enforceAutoGearBackupRetentionLimit","previousLimit","previousBackups","trimmedEntries","retentionPersisted","updatedBackups","persistedBackups","finalBackups","restoreError","readAutoGearRulesFromStorage","AUTO_GEAR_STORAGE_EXPORTS","assignGlobal","exportKeys","scopeIndex","TEXT_ENTRY_SEPARATOR","normaliseTextEntryValue","separator","safeSeparator","objectString","resolveTextEntry","primaryTexts","defaultValue","normalizedDefault","dictionaries","dictionary","detectDocument","escapeHtml","str","escapeDiv","doc","escapeButtonLabelSafely","isFiniteNumber","fallbackToCodePointChar","radix","codePoint","fallbackNormalizeGlyphChar","char","unicodeMatch","decoded","unicodeBraceMatch","hexEntityMatch","decimalEntityMatch","fallbackEscapeAttribute","normalizeFallbackGlyphConfig","glyph","className","style","size","scale","rawChar","font","createFallbackIconMarkup","baseClassName","classes","cls","styleParts","styleAttr","fontAttr","resolveButtonIconMarkup","iconFactory","setButtonLabelWithIcon","button","iconHtml","safeLabel","temp","whenElementAvailable","idOrSelector","onResolve","find","query","initial","handlerError","attemptsLimit","attempts","poll","localStorage","testKey","Text","textTools","CORE_TEMPERATURE_STORAGE_KEY_FALLBACK","resolvePreferredTemperatureStorageKey","scopeCandidates","resolveCoreSupportModule","namespaceName","requirePath","collectCandidateScopes","CORE_PART1_RUNTIME_SCOPE","resolveSupportModuleHelper","isObject","ensureRequireFn","ensureArray","normalizeBootstrapInvocationOptions","baseOrOverrides","overrides","hasOverrides","baseSource","overrideSource","baseKeys","applyOverrides","source","appendFallbackScopes","runtimeScope","coreGlobalScope","globalCandidates","collectBootstrapFallbackScopes","invocationOptions","fallbackScopeList","bootstrapEnvironmentTools","getBootstrapEnvironmentTools","bootstrapResultsTools","collectAdditionalFallbackScopes","collected","legacyCollected","environmentCollected","legacyEnvironmentCollected","resolveNamespace","directNamespace","requireFn","required","fallbackScopes","resolveBootstrapEnvironmentTools","resolverOptions","collectEnvironmentFallbackScopes","hasBootstrapResolverCapabilities","resolveBootstrapResolverTools","directResolverNamespace","resolvedNamespace","resolverCandidate","bootstrapCandidate","createBootstrapEnvironment","resolverTools","cineCoreAppCoreBootstrapEnvironment","registerScope","attemptFactory","factory","factoryOptions","collectResultsFallbackScopes","fallbackScopesInput","createLocalizationFallbackSkeleton","createRuntimeSharedFallbackSkeleton","currentRuntimeShared","fallbackResolveRuntimeSharedFromGlobal","runtimeShared","resolveBootstrapResultsTools","getBootstrapResultsTools","resolveLocalizationBootstrapResult","bootstrapOptions","bootstrapTools","inlineFactory","resolveRuntimeSharedBootstrapResult","cineCoreAppCoreBootstrapResults","createBaseBootstrapEnvironment","resolveBootstrapTools","resolveBootstrapFallbackTools","getBootstrapFallbackTools","getBootstrapResolverTools","resolveBootstrapToolsWithResolver","directBootstrapNamespace","resolveCoreSupportModuleFn","requiredBootstrap","resolveBootstrapFallbackToolsWithResolver","directFallbackNamespace","requiredFallback","createInlineLocalizationFallbackWithResolver","generated","fallbackTools","fallbackResult","createLocalizationBootstrapFallback","createInlineRuntimeSharedFallbackWithResolver","moduleFallback","createLocalizationBootstrapResult","localizationSupportTools","localizationBootstrapTools","localizationRuntimeTools","createRuntimeSharedBootstrapResult","createRuntimeSharedBootstrapFallback","createInlineLocalizationFallback","localizationFallbackOptions","bootstrapResolverTools","bootstrapSuite","suiteFallback","skeleton","createInlineRuntimeSharedFallback","bootstrapFallbackTools","createInlineLocalizationFallbackWithEnvironment","createInlineRuntimeSharedFallbackWithEnvironment","runtimeSharedOptions","runtimeSharedFallbackScopes","extraScopes","createBootstrapSuite","normalizedOptions","bootstrapEnvironment","mergeOptions","collectSuiteFallbackScopes","createBootstrapEnvironmentWithSuite","environmentOptions","environmentInvocationOptions","createLocalizationBootstrapResultWithSuite","resultOptions","createLocalizationBootstrapFallbackWithSuite","fallbackOptions","createRuntimeSharedBootstrapResultWithSuite","createRuntimeSharedBootstrapFallbackWithSuite","createInlineLocalizationFallbackWithSuite","createInlineRuntimeSharedFallbackWithSuite","suite","cineCoreAppCoreBootstrap","cineCoreAppCoreBootstrapFallbacks","cineCoreAppCoreBootstrapResolver","globalScope","_globalScope","cineCoreAppLocalizationSupport","cineCoreAppLocalizationBootstrap","cineCoreAppRuntimeLocalization","primaryScope","ensureResolveCoreSupportModule","ensureScope","fallbackScope","createAppLocalizationSupport","localizationRuntimeEnvironmentTools","localizationRuntimeEnvironment","localizationBridge","localizationFallbacks","inlineLocalizationFallbacks","localizationFallbackSupport","createBasicLocalizationFallbackResolvers","localizationFallbackRegistry","localizationFallbackResolvers","localizationFallbackNamespace","fallbackResolveLocaleModule","createLocaleFallbacks","namespace","existing","detectScope","fallback","ensureFallbackScopes","resolveLocalizationSupportTools","createLocalizationSupport","supportTools","localizationSupport","createLocalizationBootstrapWiring","bootstrapResult","collectFallbackScopes","secondaryScope","additionalScopes","register","fallbackNormalizeLanguageCodeFactory","defaultLanguage","fallbackIsRtlLanguageFactory","rtlLanguageCodes","normalizeLanguageCode","rtlCodes","fallbackResolveDocumentDirectionFactory","isRtlLanguage","docDir","fallbackApplyLocaleMetadataProxy","direction","fallbackResolveTranslationDatasetFactory","translationsRequirePath","translationsModule","fallbackGetLanguageTextsFactory","datasetResolver","fallbackCandidate","languages","firstLang","firstTexts","createEnsureGlobalGetLanguageTextsAvailability","runtime","getLanguageTextsFn","assignableFunction","createLocalizationAccessors","localeModule","fallbackNormalizeLanguageCode","fallbackIsRtlLanguage","fallbackResolveDocumentDirection","resolveDocumentDirection","applyLocaleMetadata","fallbackGetLanguageTexts","getLanguageTexts","ensureGlobalGetLanguageTextsAvailability","tools","requiredLocalizationSupport","createFallbackLocalizationBridge","createBasicLocalizationFallbackResolversProxy","fallbackResolveLocaleModuleProxy","createLocaleFallbacksProxy","callCreateAppLocalizationSupport","createLocalizationRuntimeBridge","resolveLocalizationRuntimeBridgeTools","ensureBridgeFactory","normalizeLocalizationRuntimeBridge","bridge","resolvedBridge","createLocalizationRuntimeSetup","localizationRuntimeBridge","createInlineFallbackLocalizationRuntimeSetup","createLocalizationModuleLoader","attempted","cachedModule","resolveRuntimeLocalizationTools","loadLocalizationModule","resolveLocalizationMethod","methodName","resolveLocalizationRuntimeSetup","runtimeLocalizationTools","resolveRuntimeLocalization","createFallbackLocalizationRuntimeSetup","ensureCreateLocalizationRuntimeSetup","ensureFunction","normalizeLocalizationRuntimeSetup","normalizedCandidate","createFallbackResolvers","currentLocalization","setup","APP_CORE_BOOTSTRAP_TOOLS","APP_CORE_LOCALIZATION_RUNTIME_TOOLS","APP_CORE_LOCALIZATION_SUPPORT_TOOLS","APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS","APP_CORE_BOOTSTRAP_RESOLVER_DIRECT","APP_CORE_BOOTSTRAP_FALLBACK_DIRECT","APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS_DIRECT","APP_CORE_BOOTSTRAP_RESULTS_TOOLS_DIRECT","getDefaultRuntimeScope","getDefaultCoreGlobalScope","APP_CORE_BOOTSTRAP_SUITE","APP_CORE_BOOTSTRAP_RESULTS_TOOLS","APP_CORE_BOOTSTRAP_ENVIRONMENT","APP_CORE_BOOTSTRAP_FALLBACK_TOOLS","localizationBootstrapResult","moduleOptions","localizationBootstrapWiring","MODULE_BASE","cineModuleBase","moduleRegistry","freezeDeep","exposeGlobal","registerOrQueueModule","api","onError","safeWarn","message","detail","RTL_LANGUAGE_CODES","targetDocument","localeAPI","fallbackDetectPrimaryScope","LOCAL_SCOPE","resolveArchitecture","targetScope","ARCHITECTURE","detectPrimaryScope","PRIMARY_SCOPE","fallbackCollectCandidateScopes","primary","pushScope","tryRequire","modulePath","resolvedModuleBase","hasResolvedModuleBase","resolveModuleBase","getModuleBase","resolvedGlobalScope","hasResolvedGlobalScope","getGlobalScope","moduleBase","getCandidateScopes","scoped","getTryRequire","resolveModuleRegistry","cineModules","resolvedRegistry","hasResolvedRegistry","getModuleRegistry","getPendingQueueKey","ensureQueue","queueModuleRegistrationForScope","registerOrQueueForScope","targetRegistry","isConsoleCandidate","isNodeProcessReference","globalConsole","accessError","proxyCheckError","ctorName","tag","inspectionError","isNodeModuleCandidate","isEthereumProviderCandidate","shouldBypassDeepFreeze","fallbackResolveSeenTracker","tracked","fallbackFreezeDeep","tracker","descriptor","child","fallbackSafeWarn","fallbackExposeGlobal","createScopedEnvironment","environment","queueOptions","registerOptions","exposeOptions","moduleEnvironment","cineModuleEnvironment","tryRequireLocal","locateModuleEnvironment","localSeen","seenValues","define_process_env_default","shallowCopyOptions","copy","createFallbackEnvironment","pendingKey","registryCache","hasRegistry","resolveModuleRegistryForScope","candidateScope","queueModuleRegistration","payloadOptions","collectScopesCopy","buildDescriptor","moduleEnv","fallbackEnvironment","cachedDescriptor","ensureDescriptor","refreshDescriptor","nextScope","safeInvoke","fn","getEnvironment","getModuleEnvironment","refreshed","targetModuleEnv","envResult","moduleResult","collectCandidateScopesFor","cineEnvironmentBridge","FALLBACK_SCOPE","CONNECTIVITY_PROBE_QUERY_PARAM","CONNECTIVITY_PROBE_HEADER","CONNECTIVITY_PROBE_RESULT_HEADER","CONNECTIVITY_PROBE_RESULT_NETWORK","CONNECTIVITY_PROBE_RESULT_FALLBACK","SERVICE_WORKER_LOG_CHANNEL","CONNECTIVITY_STATUS_MESSAGE_TYPE","resolveModuleLinker","linker","fallbackLoadModuleEnvironment","fallbackLoadEnvironmentBridge","MODULE_LINKER","MODULE_ENV","ENV_BRIDGE","fallbackResolveModuleGlobals","MODULE_GLOBALS","connectivityBroadcastChannel","connectivityBroadcastFailed","connectivityState","connectivityListeners","sanitizeConnectivityError","code","stringified","normalizeConnectivityDetail","headDetail","errorDetail","nested","getConnectivityBroadcastChannel","assignGlobalConnectivityState","state","notifyConnectivityListeners","listener","broadcastConnectivityState","channel","freezeConnectivityState","nextState","buildConnectivityState","update","previous","next","updateOfflineUi","indicator","emitConnectivityState","informModuleGlobals","fallbackTryRequire","linked","bridged","provided","MODULE_REGISTRY","linkedRegistry","PENDING_QUEUE_KEY","sharedKey","bridgedKey","cloneOptions","fallbackQueueModuleRegistration","fallbackRegisterOrQueue","resolvedFreezeDeep","resolveCachedFreezeDeep","resolveFreezeDeep","FORCE_RELOAD_CLEANUP_TIMEOUT_MS","FORCE_RELOAD_CONNECTIVITY_TIMEOUT_MS","RELOAD_WARMUP_MAX_WAIT_MS","reloadWarmupFailureLogged","settlePromise","promise","isAccessControlReloadWarmupError","normalisedMessage","normalisedName","shouldSuppressReloadWarmupFailure","href","baseHref","readLocationHrefSafe","isLikelySafariFamilyBrowser","nav","windowLike","win","resolveWindow","vendor","userAgent","trimmedVendor","normalisedUserAgent","exclusionTokens","token","vendorIndicatesSafariFamily","userAgentHasSafariToken","userAgentHasAppleWebkitToken","userAgentHasVersionToken","userAgentHasMobileToken","userAgentHasPlatformToken","vendorIsEffectivelyEmpty","userAgentSignalsSafariFamily","fallbackSafariMatch","standalone","standaloneQuery","shouldPreferXmlHttpWarmup","resolveXmlHttpRequest","scheduleReloadWarmup","nextHref","fetchFn","resolveFetch","locationLike","isSameOriginReloadTarget","resolveNavigator","preferXmlHttpWarmup","controller","serviceWorkerSettled","cachesSettled","cancelHandlers","registerCancelHandler","handler","serviceWorkerPromise","cachePromise","shouldAllowCache","includeCredentials","referenceHref","expectedOrigin","readLocationOriginSafe","targetOrigin","resolveHrefOrigin","requestMode","warmupCredentials","warmupRequestHref","enforcedHref","enforceSameOriginNextHref","pathCandidate","suffix","warmupTask","warmupWaitMs","awaitPromiseWithSoftTimeout","allowCachePopulation","buildRequestInit","requestInit","performFetch","targetHref","attemptXmlHttpWarmup","xhrCtor","xhrInstance","aborted","conclude","success","status","isAborted","response","firstError","shouldAttemptFetch","xmlHttpResult","fallbackResponse","fallbackError","initialCacheMode","fallbackCacheModes","cacheMode","secondError","suppressWarning","timeoutMs","onTimeout","onLateRejection","ms","schedule","cancel","finished","timerId","UI_CACHE_STORAGE_KEYS_FOR_RELOAD","UI_CACHE_STORAGE_SUFFIXES_FOR_RELOAD","uiCacheFallbackWarningKeys","pendingServiceWorkerRegistration","resolveGlobal","explicitWindow","explicitNavigator","isNavigatorExplicitlyOffline","navigatorLike","resolveCaches","explicitCaches","resolveLocation","explicitLocation","explicitFetch","globalFetch","createAbortController","createTimeoutError","fetchWithTimeout","url","init","timeoutId","timedOut","timeoutPromise","_","abortError","cleanup","fetchPromise","isSuccessfulConnectivityResponse","appendConnectivityProbeToken","tokenString","fragment","hashIndex","encodedParam","encodedToken","readConnectivityProbeResult","headerValue","resolveConnectivityProbeUrl","forceReloadUrl","pathname","readLocationPathnameSafe","probeReloadConnectivity","effectiveFetch","probeToken","probeUrl","probeHeaders","headFailureDetail","headResult","headProbeResult","getResult","getProbeResult","subscribeConnectivityStatus","unsubscribeConnectivityStatus","reportConnectivityProbeResult","globalXmlHttpRequest","registerFallbackStorage","storages","hasRemove","hasDelete","inspectScopeForStorages","collectFallbackUiCacheStorages","resolveSafeLocalStorageFn","safeLocalStorageInstance","cineGlobal","clearUiCacheEntriesFallback","clearedAny","storage","baseKey","entryKey","collectServiceWorkerRegistrations","navigatorOverride","serviceWorker","registrations","pushRegistration","registration","regs","reg","readyReg","readyError","queryError","resolvePrefetchedServiceWorkerRegistrations","prefetchedRegistrations","unregisterServiceWorkers","observeServiceWorkerControllerChange","detach","resolver","attached","finalize","currentResolver","removeError","event","previousError","APP_CACHE_IDENTIFIERS","resolveExposedCacheName","exposedName","isRelevantCacheKey","explicitName","lowerExplicit","lowerKey","clearCacheStorage","cachesOverride","cachesInstance","relevantKeys","removedAny","origin","originMatch","fallbackLocation","getForceReloadBaseCandidates","originalHref","addCandidate","safeHref","windowHref","normaliseHrefForComparison","locationHref","sameOriginCandidates","rebuilt","originPattern","coerceForceReloadUrlDescriptor","defaultParam","param","nextHrefCandidate","buildForceReloadUrl","paramName","baseCandidates","urlCandidates","candidateHref","hash","pattern","replacement","isForceReloadHash","hashValue","normaliseHrefForHistory","cleanupForceReloadArtifacts","targetWindow","location","cleanedHref","removedQuery","removedHash","hrefWithoutHash","hashPart","queryIndex","segments","filtered","equalsIndex","historyLike","historyError","stateSnapshot","hasStateSnapshot","stateError","replaceUrl","replaceError","hashError","scheduleForceReloadNavigationWarning","description","before","expected","initialAfter","evaluate","currentRaw","verifyDelays","delay","isFinalCheck","runCheck","attemptForceReloadNavigation","applyFn","beforeRaw","afterRaw","after","attemptForceReloadHistoryFallback","reloadError","scheduleForceReloadFallbacks","hasReload","fallbackHref","hashBase","fallbackToken","hashFallback","steps","nextDelay","delayIncrement","queueStep","run","reloadDelay","step","scheduleError","triggerReload","windowOverride","precomputedForceReloadUrl","hasReplace","hasAssign","navigationTriggered","forceReloadDescriptor","reloadApp","connectivity","notifyOffline","notifyError","serviceWorkerRegistrationsPromise","uiCacheCleared","clearUiCacheStorageEntriesFn","serviceWorkerCleanupPromise","cacheCleanupPromise","warmupHandle","resolveWarmupPromise","handle","wrapResultWithSource","warmupPromise","controllerChangeWatcher","controllerChangeResultPromise","serviceWorkerResultLogged","serviceWorkerResultPromise","warmupResultPromise","gateCandidates","gatePromise","serviceWorkersUnregistered","warmupFinishedBeforeReload","serviceWorkerStatusKnown","cleanupTimeoutMs","serviceWorkerAwaitResult","lateError","gateResult","reloadTriggered","reloadFn","finalError","cachesCleared","shouldRegisterImmediately","document","registerServiceWorker","scriptUrl","finalizePendingRegistration","waitForLoad","initConnectivityListeners","offlineAPI","existingOffline","resolveFromScopes","propertyName","ctorError","exposeGlobalInternal","envRegistry","baseRegistry","cachedRegistry","hasCachedRegistry","effectiveRegistry","baseRegistered","recordModule","envRegistered","registryError","queued","localModuleMap","waitersMap","notifyWaiters","waiters","waiter","getModule","whenModuleAvailable","callback","listRecordedModules","primeKnownModules","descriptors","globalApi","existingKeys","mergeIndex","names","nameIndex","moduleName","moduleValue","frozenApi","registered","exposed","DEFAULT_PENDING_QUEUE_KEY","fallbackDetectGlobalScope","baseScope","fallbackDefineHiddenProperty","fallbackEnsureQueue","queueKey","fallbackResolveFromScopes","settings","predicate","createFallbackKernel","resolveArchitectureKernel","RESOLVED_KERNEL","ACTIVE_KERNEL","detected","pendingQueueKey","collectScopes","defineHiddenProperty","cachedModuleBase","updateQueueKeyFromBase","loadModuleBase","fallbackResolveModuleRegistry","cachedModuleRegistry","hasResolvedModuleRegistry","resolvedByKernel","ensureRegistrationQueue","normalizeName","normalizedName","assignmentError","registerModule","resolveModule","registerAndExpose","registrationOptions","getPendingQueue","systemApi","cineModuleSystem","freezeError","resolveArchitectureHelpers","resolveModuleSystem","ARCHITECTURE_HELPERS","updatePendingQueueKey","MODULE_SYSTEM","detectWithFallbackChain","architectureDetected","collectWithFallbackChain","architectureScopes","tryRequireWithFallback","defineHiddenPropertyWithFallback","freezeDeepWithFallback","safeWarnWithFallback","baseFromSystem","queueFromHelpers","queueFromSystem","resolvedByHelpers","registryFromSystem","registerOrQueue","createModuleContext","scopeCandidate","optionsWithScope","contextApi","resolveArchitectureCore","tryRequireArchitecture","ARCHITECTURE_CORE","CORE_INSTANCE","detectWithArchitecture","collectWithArchitecture","tryRequireWithArchitecture","resolveImmutability","direct","createFallbackImmutability","shouldBypass","freeze","FALLBACK_IMMUTABILITY","activeImmutability","getImmutability","provider","baseDetectGlobalScope","collectCandidateScopesFallback","extras","detect","detectFn","collector","resolveHelperCollector","resolveFromScopesFallback","resolveScopeUtils","cineScopeUtils","pushCandidate","utils","SCOPE_UTILS","resolveScopeCollector","createCollector","SCOPE_COLLECTOR","createScopeCollector","DEFAULT_EXTRAS_KEY","HELPER_COLLECTOR_CACHE","extrasKey","fallbackCreateImmutability","createFallbackCore","customPrimaryScope","detectOverride","resolveOverride","freezeOverride","warnOverride","tryRequireOverride","cachedPrimaryScope","getPrimaryScope","targetPrimary","tryRequireImpl","resolveFromScopesInternal","resolveOptions","optionsToUse","CORE_FACTORY","instantiateCore","fallbackInstance","instance","wrapMethod","primaryCore","fallbackCore","fallbackImpl","warn","primaryFn","fallbackFn","ultimateFallback","shouldSuppressWarning","args","createArchitectureInstance","instances","wrap","detectGlobalScopeFn","collectCandidateScopesFn","tryRequireFn","resolveFromScopesFn","defineHiddenPropertyFn","ensureQueueFn","scopeToUse","freezeDeepFn","defaultInstance","architecture","createModuleArchitecture","ensureQueueDefaultKey","architectureWithFactory","globalThis","detectHelperScope","resolveRuntimeEnvironmentHelpers","RUNTIME_ENVIRONMENT_HELPERS","invokeEnvironmentHelper","helperName","resolveEnvironmentContext","ENVIRONMENT_CONTEXT","detectWithContext","CANDIDATE_SCOPES_CACHE","eligibleForCache","toCache","cacheWriteError","fromContext","viaSystem","linkedKey","systemKey","normalizeModuleName","removePendingQueueEntries","writeIndex","attemptRegistryRegistration","getError","hasError","lastError","directAttempt","syncResult","synchronizeModuleLinks","retryAttempt","FULLY_FROZEN_OBJECTS","alreadyFrozen","hasOwn","frozen","cacheError","enforceShallowFreeze","ownNames","symbols","nextDescriptor","ensureDeepFrozen","ensureRegistryBinding","defineError","getPendingQueueFromScope","requeuePendingEntry","flushPendingModuleQueues","processed","requeued","touchedScopes","failures","entryIndex","entryOptions","alreadyRegistered","exposureDetails","exposureFailures","exposure","flushResult","combinedFailures","INITIAL_MODULE_LINK_STATE","inspectModuleConnections","moduleNames","modules","missingConnections","errors","hasConnection","connectionSet","connectionList","missingList","connection","MODULE_NAMES","REQUIRED_PERSISTENCE_FUNCTIONS","REQUIRED_OFFLINE_FUNCTIONS","REQUIRED_UI_CONTROLLERS","REQUIRED_UI_INTERACTIONS","REQUIRED_UI_HELP_ENTRIES","ensureModule","parsePath","path","inspectFunctionPath","missing","detailMap","traversed","finalPath","ok","inspectPersistenceModule","persistenceModule","internal","inspector","bindingName","bindingPath","available","inspectOfflineFunctions","inspectUiControllers","uiModule","getter","pathPrefix","actionIndex","actionName","actionPath","actionOk","inspectUiInteractions","interactions","inspectUiHelp","help","listCriticalChecks","verifyCriticalFlows","synchronization","registrySnapshot","persistence","offline","ui","modulePresence","registryDetail","detailKeys","runtimeAPI","existingRuntime","attachmentError","createModuleBaseFallback","resolvedScope","existingBase","moduleStorage","listenerStorage","notifyListeners","storeModule","getStoredModule","ensureModuleGlobals","globals","ensureModuleRegistry","fallbackBase","scopeTarget","metadata","cloneContext","createFallbackContext","resolveDocument","getLocalStorage","callOptional","createAppearanceManager","rawContext","providedKeys","elements","accent","icons","preferences","autoBackups","mountVoltages","themeMemoryStorage","memory","collectThemeStorageEntries","entries","pushEntry","storageRef","persistThemePreference","readStoredThemePreference","pinkModeIconRotationTimer","pinkModeIconIndex","pinkModeIconPressCount","pinkModeIconPressTimestamps","pinkModeIconPressResetTimer","PINK_MODE_ICON_PRESS_RESET_MS","PINK_MODE_ICON_PRESS_BURST_WINDOW_MS","settingsInitialPinkMode","settingsInitialTemperatureUnit","settingsInitialFocusScale","settingsInitialShowAutoBackups","PINK_MODE_STORAGE_KEY","LEGACY_PINK_MODE_STORAGE_KEY","getRoot","getBody","getAccentColor","setAccentColor","getPrevAccentColor","setPrevAccentColor","getHighContrastAccentColor","isHighContrastActive","updateAccentColorResetButtonState","clearAccentColorOverrides","applyAccentColor","refreshDarkModeAccentBoost","applyIconGlyph","getIconGlyph","documentRef","setToggleIcon","iconSpan","glyphConfig","classNames","handleLottie","requestId","lottie","lottieContainer","animConfig","anim","hideFallback","oldFallback","handleFailure","newSvg","applyDarkMode","sunGlyph","moonGlyph","highContrast","accentSource","detectSystemDarkPreference","detectThemeControlType","element","tagName","createThemeControlReader","getCurrent","createThemeControlWriter","detectBooleanControlType","createPinkModeControlReader","createPinkModeControlWriter","createPinkModePreferenceController","controls","applying","currentPreference","isPinkModeActive","getCurrentPreference","applyPreference","optionsConfig","control","applyPinkMode","persistPinkModePreference","registerControl","controlOptions","configuration","read","write","eventType","storedControl","setValue","getValue","reloadFromStorage","createThemePreferenceController","controllerOptions","storedPreference","initialPreference","applyHighContrast","applyReduceMotion","stopPinkModeAnimatedIconRotation","startPinkModeAnimatedIconRotation","applyRelaxedSpacing","stopPinkModeIconRotation","applyPinkModeIcon","iconConfig","shouldAnimate","toggle","helpIcon","triggerPinkModeIconAnimation","targets","toggleIcon","resetError","startPinkModeIconRotation","sequence","unrefError","clearPinkModeIconPressResetTimer","schedulePinkModeIconPressReset","resetPinkModeIconPressCount","recordPinkModeIconPressTimestamp","now","burstWindow","cutoff","LocalPinkModeManager","localPinkModeManager","handlePinkModeIconPress","rememberSettingsPinkModeBaseline","revertSettingsPinkModeIfNeeded","getTemperatureUnit","setTemperatureUnit","getFocusScale","setFocusScale","rememberSettingsTemperatureUnitBaseline","revertSettingsTemperatureUnitIfNeeded","baseline","rememberSettingsFocusScaleBaseline","revertSettingsFocusScaleIfNeeded","getShowAutoBackups","setShowAutoBackups","applyShowAutoBackupsPreference","persist","forceRepopulate","previousValue","changed","setupSelect","setupNameInput","previousSelectValue","previousNameValue","rememberSettingsShowAutoBackupsBaseline","revertSettingsShowAutoBackupsIfNeeded","rememberSettingsMountVoltagesBaseline","revertSettingsMountVoltagesIfNeeded","updateInputsFn","warnHelper","supportedTypes","baselineEntry","currentEntry","initialize","resolveRuntime","resolveRuntimeFunction","normalizeMountVoltageDefaults","types","high","low","cloneWithDefaults","parseVal","val","defaultEntry","persistToStorage","bootstrapMountVoltageGlobals","fallbackParseVoltageValue","fallbackCloneMountVoltageMap","runtimeFn","fallbackApplyMountVoltagePreferences","fallbackParseStoredMountVoltages","makeDelegate","opts","prefs","__cineToFiniteInteger","__cineResolveGlobalValue","__cineCommitGlobalValue","ensureString","ensureNullableObject","resolveRetentionBounds","min","resolveAutoGearBackupRetentionMin","max","cand","norm","bounded","resolveAutoGearBackupRetentionDefault","bounds","accessors","accessor","fallbackSafeGenerateConnectorSummary","device","primaryKey","fallbackLocaleSort","strA","strB","bootstrapGlobals","texts","defaultVal","dicts","d","existingUnits","normalizedUnits","existingScenarios","normalizedScenarios","s","getGlobalScopeCandidates","getPrimaryGlobalScope","fallbackResolveRuntimeModuleLoader","fallbackRequireCoreRuntimeModule","moduleId","loader","exposeCoreRuntimeConstant","exposeCoreRuntimeConstants","constants","CORE_BOOT_QUEUE_KEY","fallbackKey","existingHidden","existingPublic","CORE_BOOT_QUEUE","existingQueue","sharedQueue","enqueueCoreBootTask","task","taskError","processCoreBootQueue","GRID_SNAP_STATE_STORAGE_KEY","getGridSnapStateScopes","resolvedScopes","fallbackCandidates","normaliseGridSnapPreference","readInitialGridSnapPreference","legacy","normalizedLegacy","gridSnapState","assignGridSnapToScope","syncGridSnapStateToScopes","originScope","getGridSnapState","setGridSnapState","applyLegacyGridSnapValue","publishRuntimeBootstrapExports","exportsMap","existingNamespace","runtimeBootstrapExports","_resolveCoreSupportModule","_CORE_RUNTIME_SHARED","_CORE_ENVIRONMENT_HELPERS","CORE_RUNTIME_CANDIDATE_SCOPE_BRIDGE","CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS","resolveRuntimeCandidateScopeSupport","createFallbackRuntimeCandidateScopeSupport","RUNTIME_CANDIDATE_SCOPE_FALLBACK_TOOLS","createRuntimeCandidateScopeSupportFallback","fallbackSupport","syncOptions","assignCandidateScopes","ensureOptions","ensureOptionsWithDefaults","FALLBACK_RUNTIME_CANDIDATE_SCOPE_SUPPORT","CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT","RUNTIME_CANDIDATE_SCOPE_RESOLVER_TOOLS","createRuntimeCandidateScopeResolvers","createInlineRuntimeCandidateScopeResolvers","runtimeSupport","tryCollectWithSupport","support","tryEnsureWithSupport","ensured","inlineCollectCoreRuntimeCandidateScopes","fallbackCollected","inlineEnsureCoreRuntimeCandidateScopes","fallbackEnsured","runtimeCandidateScopeResolvers","COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE","collectRuntimeCandidateScopesFromResolvers","collectRuntimeCandidateScopesFromGlobal","resolvedCollectCoreRuntimeCandidateScopes","CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED","ensureFn","ensuredScopes","collectRuntimeScopeCandidates","FALLBACK_HUMANIZE_OVERRIDES","fallbackHumanizeKey","c","createArrayFromCandidates","duplicate","check","createDefaultLanguageTexts","fallbackNormalizeAutoGearWeightOperator","fallbackNormalizeAutoGearWeightValue","sanitized","fallbackFormatAutoGearWeight","createFallbackGetAutoGearCameraWeightOperatorLabel","normalizeOperator","fallbackTextsFactory","operator","textsForLang","createFallbackFormatAutoGearCameraWeight","formatWeight","getOperatorLabel","condition","formattedValue","resolveAutoGearWeightHelpers","globalScopeOverride","normalizeValue","normalizeAutoGearCameraWeightCondition","formatted","fallbackGetOperatorLabel","fallbackFormatCameraWeight","formatCameraWeight","fallbackCreateRuntimeScopeCandidates","sharedScope","fallbackReadCoreScopeValue","fallbackWriteCoreScopeValue","fallbackDeclareCoreFallbackBinding","resolveRuntimeScopeTools","globalDetetc","runtimeScopeBridge","bridgeTools","localFallbackRead","localFallbackWrite","localFallbackDeclare","CORE_PART2_RUNTIME_HELPERS","sharedHelpers","resolveRuntimeSharedNamespaceTools","cleanResolveCoreSupportModule","CORE_RUNTIME_SHARED_NAMESPACE_TOOLS","RUNTIME_SHARED_BOOTSTRAP_TOOLS","RUNTIME_SHARED_BOOTSTRAP_RESOLVER_TOOLS","CORE_RUNTIME_SHARED","CORE_RUNTIME_SHARED_NAMESPACE_TOOLS_ESM","RUNTIME_SHARED_BOOTSTRAP_TOOLS_ESM","runtimeSharedBootstrapResult","CORE_RUNTIME_SHARED_NAMESPACE","CORE_RUNTIME_SHARED_RESOLVER","EXISTING_CORE_RUNTIME_SHARED","createFreezeRegistry","freezeRegistryHas","freezeRegistryAdd","readGlobalScopeValue","searchScopes","writeGlobalScopeValue","ensureGlobalFallback","fallbackProvider","normaliseGlobalValue","validator","AUTO_GEAR_GLOBAL_FALLBACKS","ensureAutoGearGlobal","createFallback","globalFn","binder","appliedValue","createFallbackSafeGenerateConnectorSummary","generatorError","_connectorSummaryWarningIssued","generateSafeConnectorSummary","generator","summary","Helpers","Icons","formatSvgCoordinate","positionSvgMarkup","resolveIconGlyph","createLocalRuntimeStateFallback","initialIndex","resolveRuntimeModuleLoader","requireCoreRuntimeModule","CORE_ENVIRONMENT_HELPERS","collectEnvironmentRuntimeCandidateScopes","sharedScopes","CORE_RUNTIME_CANDIDATE_SCOPES","CORE_RUNTIME_STATE_SUPPORT_PART2","loaderState","CORE_TEMPERATURE_KEY_DEFAULTS","CORE_TEMPERATURE_QUEUE_KEY","CORE_TEMPERATURE_RENDER_NAME","CORE_SAFE_FREEZE_REGISTRY","coreSafeFreezeRegistryHas","coreSafeFreezeRegistryAdd","createFallbackIconFontKeys","fallbackFont","resolveInitialPart2Value","cineUiCache","elementIds","resolveButtonIconMarkupShim","setButtonLabelWithIconShim","resolvedGlyph","CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE","additionalCandidates","collectCandidates","renderFeedbackTable","setupKey","m","globalShim","CORE_PART2_RUNTIME_SCOPE","AppCore","localization","importedResolvedCollectCoreRuntimeCandidateScopes","resolveAutoGearUIHelper","resolveAutoGearNormalizer","exports","resolveAutoGearStorageHelper","resolveAutoGearPersistenceModule","mapped","AUTO_GEAR_STORAGE_METHOD_MAP","createDeferredAutoGearRefresherFallback","callCoreFunctionIfAvailable","createSafeShim","shim","v","n","r","p","localResolveDocumentDirection","localApplyLocaleMetadata","defaultCoreBootQueue","resolvedCoreBootQueue","resolvedEnqueueCoreBootTask","resolvedSetGridSnapState","resolvedApplyLegacyGridSnapValue","TEMPERATURE_SCOPE_CANDIDATES","TEMPERATURE_UNITS_FALLBACK","normalizeVideoType","normalizeFizConnectorType","normalizeViewfinderType","normalizePowerPortType","fixPowerInput","applyFixPowerInput","ensureList","localMarkDevicesNormalized","hasNormalizedDevicesMarker","unifyDevices","normalizeDevicesForPersistence","CORE_TEMPERATURE_STORAGE_KEY","FOCUS_SCALE_STORAGE_KEY","CORE_TEMPERATURE_UNITS","TEMPERATURE_SCENARIOS","FOCUS_SCALE_VALUES_FALLBACK","focusScaleValues","resolveFeedbackTemperatureBound","boundKey","scopedValue","CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE","namespaces","resolveRuntimeModuleLoaderNamespaceResolver","resolvedRuntimeModuleLoader","requireCoreRuntimeModuleNamespaceResolver","resolvedRequireCoreRuntimeModule","localizationBootstrapWiringRef","APP_CORE_LOCALIZATION_SUPPORT","CORE_LOCALIZATION_BRIDGE","CORE_LOCALIZATION_FALLBACKS","CORE_INLINE_LOCALIZATION_FALLBACKS","LOCALIZATION_FALLBACK_SUPPORT","LOCALIZATION_FALLBACK_REGISTRY","LOCALIZATION_FALLBACK_RESOLVERS","LOCALIZATION_FALLBACK_NAMESPACE","CORE_RUNTIME_TOOL_FALLBACK_NAMESPACE","SETTINGS_DOCUMENTATION_TRACKER_TOOLS","pinkModeSupportApiRef","localResolvePinkModeLottieRuntime","classNameOrOptions","resolvedClassName","PRODUCTION_COMPANY_ICON","RENTAL_HOUSE_ICON","ASPECT_RATIO_ICON","REQUIRED_SCENARIOS_ICON","MONITORING_SUPPORT_ICON","CORE_RUNTIME_STATE_SUPPORT","resolvedSupport","loaderRuntimeState","CORE_RUNTIME_LOCALIZATION","loaderLocalization","localAutoGearConditionSections","CORE_RUNTIME_TOOL_FALLBACK_FACTORY","runtimeToolFallbacks","resolvedDefaults","CORE_RUNTIME_UI_BRIDGE","requiredBridge","escapeButtonLabelSafelyHelper","resolveButtonIconMarkupHelper","setButtonLabelWithIconBinding","dispatchTemperatureNoteRender","hours","renderer","CORE_RUNTIME_STATE","referenceError","scopedRenderer","renderError","exposeCoreRuntimeBindings","bindings","setter","runCoreRuntimeSegment","executor","executionError","resolveCoreRuntimeHelpers","CORE_SHARED","CORE_RUNTIME_HELPERS","CORE_RUNTIME_FALLBACKS","createCoreRuntimeStateFallback","withEachScope","getScopes","ensureValue","normaliseValue","validate","normaliseError","readValue","assignedTemperatureRenderer","assignTemperatureRenderer","temperatureRenderError","clearLatestError","assignError","getAssignedTemperatureRenderer","autoGearGuards","setAutoGearGuards","nextGuards","createCoreRuntimeState","isAutoGearGlobalReferenceError","guard","repairAutoGearGlobals","repair","optionsObject","attemptCount","nextOptions","attempt","invokeError","safeFormatAutoGearItemSummary","formatError","formatWithPlaceholdersSafe","template","selectElem","optionsObj","includeNone","noneOpt","noneMap","currentLang","opt","populateError","realPopulate","ensureFunctionPlaceholder","humanizeKey","stringValue","fallbackResolveConnectorSummaryGenerator","resolveConnectorSummaryGenerator","sessionSafeGenerateConnectorSummary","normalizeAutoGearWeightOperator","formatAutoGearWeight","fallbackGetAutoGearCameraWeightOperatorLabel","getAutoGearCameraWeightOperatorLabel","fallbackFormatAutoGearCameraWeight","formatAutoGearCameraWeight","LZString","generatePrintableOverview","resolveAppVersionScope","extractAppVersion","resolveAppVersionValue","moduleCandidate","resolvedCandidate","APP_VERSION","IOS_PWA_HELP_STORAGE_KEY","INSTALL_BANNER_DISMISSED_KEY","resolveInstallBannerGlobalScope","installBannerGlobalScope","HELP_MODULE_CACHE_KEY","createHelpModuleFallback","explicitKey","resolveHelpModuleApi","logModuleWarning","fromRegistry","moduleNamespace","created","resolvedApi","CONTACTS_MODULE_CACHE_KEY","OWN_GEAR_MODULE_CACHE_KEY","LEGACY_CONTACTS_OWN_GEAR_MODULE_CACHE_KEY","cacheFeatureModule","cacheKey","moduleApi","resolveLegacyContactsOwnGearModule","resolveContactsModule","resolveOwnGearModule","helpModuleApi","deviceSchema","resolveCoreDeviceSchema","deviceSchemaManager","coreDeviceSchema","schema","populateCategoryOptions","deviceSchemaManagerError","DEVICE_SCHEMA_PATH","loadDeviceSchemaFromCacheStorage","finalizeDeviceSchemaLoad","isValidDeviceSchema","cachedDeviceSchema","initialSchema","applyDeviceSchema","bundledSchema","contactsProfileModule","contactsListModule","CONTACTS_PROFILE_GLOBAL_KEY","CONTACTS_LIST_GLOBAL_KEY","canRequireModule","profileModuleError","contactsListModuleError","contactsModuleGlobalScope","readContactsModuleFromGlobal","contactsModuleError","fallbackSanitizeContactValue","fallbackNormalizeContactEntry","createFallbackProfileController","listeners","emit","listenerError","updates","rawValue","newState","resolvedContactAvatarMaxBytes","resolvedContactAvatarMaxSourceBytes","resolvedContactAvatarMaxDimension","resolvedContactAvatarJpegQuality","resolvedContactAvatarJpegMinQuality","resolvedCreateProfileController","resolvedEstimateDataUrlSize","resolvedOptimiseAvatarDataUrl","resolvedReadAvatarFile","resolvedIsSafeImageUrl","resolvedSanitizeContactValue","resolvedNormalizeContactEntry","resolvedSortContacts","resolvedParseVCardEntries","resolvedMergeImportedContacts","resolvedCreateCrewRowSync","localCreateProfileController","localReadAvatarFile","file","onSuccess","reader","localIsSafeImageUrl","sanitizeContactValueHelper","normalizeContactEntryHelper","sortContactsHelper","parseVCardEntries","mergeImportedContactEntries","localCreateCrewRowSync","rowState","contact","appliedSchema","appliedCachedSchema","schemaFromCache","requireError","LEGAL_LINKS","resolveAutoGearStorageKey","symbolName","readGlobalAutoGearValue","AUTO_GEAR_RULES_KEY","AUTO_GEAR_ANY_MOTOR_TOKEN","AUTO_GEAR_SEEDED_KEY","AUTO_GEAR_RETENTION_DEFAULT_FALLBACK","AUTO_GEAR_RETENTION_MIN_FALLBACK","AUTO_GEAR_RETENTION_MAX_FALLBACK","AUTO_GEAR_BACKUP_RETENTION_MAX","declaredMinCandidate","existingMax","globalMaxCandidate","parsedMax","normalize","existingDefault","globalCandidate","fallbackNormalized","AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE","AUTO_GEAR_BACKUP_RETENTION_DEFAULT","AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS","AUTO_GEAR_CUSTOM_CATEGORY","GEAR_LIST_CATEGORIES","AUTO_GEAR_SELECTOR_TYPES","AUTO_GEAR_SELECTOR_TYPE_MAP","map","AUTO_GEAR_SELECTOR_TYPE_SET","AUTO_GEAR_MONITOR_FALLBACKS","AUTO_GEAR_TRIPOD_SELECTOR_TYPES","AUTO_GEAR_TRIPOD_FIELD_IDS","AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUP_DATA","AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS","groupKey","uniqueOptions","AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP","autoGearPersistence","autoGearRules","baseAutoGearRulesState","projectScopedAutoGearRules","autoGearBackupRetention","autoGearBackups","autoGearAutoPresetIdState","autoGearMonitorDefaults","autoGearEditorDraft","autoGearEditorActiveItem","autoGearScenarioFilter","updateAutoGearItemButtonState","autoGearRemoveItemButton","autoGearAddItemButton","DEFAULT_LANGUAGE_SAFE","isEditing","defaultKey","defaultLabel","updateLabel","getAutoGearConfigurationSignature","initialAutoGearRulesSignature","assignAutoGearRules","syncBaseAutoGearRulesState","persistAutoGearRules","getAutoGearMonitorDefault","setAutoGearMonitorDefaults","skipRender","skipRefresh","setAutoGearMonitorDefault","nextDefaults","setAutoGearRules","getAutoGearRules","syncAutoGearRulesFromStorage","clearProjectAutoGearRules","getProjectScopedAutoGearRules","collectAutoGearCatalogNames","collectAutoGearMonitorNames","collectAutoGearTripodNames","collectDeviceManagerCategories","hasSeededAutoGearDefaults","activateSettingsTab","clearAllAutoGearConditions","looksLikeGearName","addName","visit","obj","getAutoGearOwnGearItems","normalizeAutoGearMonitorCatalogMode","autoGearMonitorCatalogMode","autoGearAddMonitorFieldGroup","autoGearRemoveMonitorFieldGroup","includeMonitor","includeDirectorMonitor","acceptedTypes","processItem","collectAutoGearSelectorValuesFromRules","addValue","baseOptions","getCssVariableValue","computed","offlineModule","getElementHeight","rect","setInstallBannerOffset","offset","pendingInstallBannerPositionUpdate","LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK","scheduleInstallBannerPositionUpdate","scheduler","updateInstallBannerPosition","installBanner","offlineIndicator","offlineHeight","bannerVisible","bannerHeight","totalOffset","setupOfflineIndicator","reloadButton","currentLabel","currentHelp","lastConnectivityState","connectivityChannel","connectivityChannelFailed","unsubscribeConnectivity","resolveOfflineNotice","indicatorNotice","buttonNotice","getNavigatorOnline","getBaseLabel","getBaseHelp","getDegradedLabel","getDegradedHelp","CONNECTIVITY_REASON_KEYS","resolveReasonText","reason","unknown","describeConnectivityDetail","updateReloadButtonState","offlineNotice","noticeText","currentTitle","ariaLabel","title","sanitizeConnectivityState","refreshOfflineIndicator","navigatorOnline","effectiveStatus","effectiveReason","effectiveDetail","effectiveTimestamp","stateStatus","baseLabel","baseHelp","degradedLabel","reasonText","detailText","summaryParts","displayText","degradedHelp","helpParts","helpText","applyConnectivityState","handleConnectivityBroadcast","ensureConnectivityBroadcast","initialState","closeSideMenu","menu","openSideMenu","closeButton","closeLabel","closeHelp","setupSideMenu","link","triggerSidebarAction","action","openOwnGearDialog","initializeContactsModule","openDialog","contactsDialog","setupResponsiveControls","topBar","featureSearch","sidebarControls","mql","relocate","ownGearStoreModuleCache","ownGearStoreInstance","ownGearViewModuleCache","ownGearViewInstance","fallbackAutoGearCache","detectOwnGearGlobalScope","resolveOwnGearStoreModule","getOwnGearStore","resolveOwnGearViewModule","resolveOwnGearViewOptions","closeDialog","formatOwnGearQuantityText","gearItemTranslations","getOwnGearView","viewModule","store","invalidateAutoGearOwnGearCache","refreshAutoGearOwnGearCache","loadStoredOwnGearItems","normalizeOwnGearRecord","getAutoGearOwnGearCache","findAutoGearOwnGearById","generateOwnGearId","timePart","randomPart","seenIds","fixed","view","applyOwnGearLocalization","initializeLayoutControls","initializeOwnGearManager","runLayoutInitialization","scheduleLayoutInitialization","invoke","CORE_AUTO_BACKUP_NAMESPACE","loaderNamespace","AUTO_BACKUP_NAME_PREFIX","AUTO_BACKUP_DELETION_PREFIX","localLogAutoBackupEvent","level","normalizedLevel","normalizedMessage","rawCloneProjectEntryForSetup","rawEnsureAutoBackupsFromProjects","showAutoBackups","cloneProjectEntryForSetup","projectEntry","cloneError","ensureAutoBackupsFromProjects","getSetups","storeSetups","setups","loadSession","storeSession","toggleDialog","dialog","shouldOpen","isDialogOpen","resolveUpdateDevicesReferenceFunction","directReference","registerCandidate","storedDevices","merged","sub","subVal","updateDevicesReferenceFn","updateDevicesReferenceError","getBatteryPlateSupport","cam","bp","getSupportedBatteryPlates","getAvailableBatteryPlates","nativeTypes","batteryPlateSelect","ensureBatteryPlateElements","getSelectedPlate","camName","cameraSelect","plates","plateValue","updateBatteryLabel","STATUS_CLASS_BY_LEVEL","setStatusLevel","severityClasses","remaining","resolveTranslationsRuntime","resolveGlobalScopeForTranslations","translations","translationsRuntime","autoGearHeadingElem","autoGearDescriptionElem","autoGearMonitorDefaultsHeading","autoGearMonitorDefaultsDescription","autoGearDefaultFocusMonitorSelect","autoGearDefaultHandheldMonitorSelect","autoGearDefaultComboMonitorSelect","autoGearDefaultDirectorMonitorSelect","autoGearDefaultFocusMonitorLabel","autoGearDefaultHandheldMonitorLabel","autoGearDefaultComboMonitorLabel","autoGearDefaultDirectorMonitorLabel","autoGearMonitorDefaultControls","autoGearSearchInput","autoGearSearchLabel","autoGearFilterScenarioLabel","autoGearFilterScenarioSelect","autoGearFilterClearButton","autoGearPresetDescription","autoGearPresetLabel","autoGearPresetSelect","autoGearSavePresetButton","autoGearDeletePresetButton","autoGearAddRuleBtn","autoGearResetFactoryButton","autoGearEditor","autoGearConditionSelectLabel","autoGearConditionSelect","autoGearConditionAddButton","autoGearAlwaysLabel","autoGearAlwaysHelp","autoGearConditionAddShortcuts","autoGearConditionRemoveButtons","AUTO_GEAR_UI_EXPORTS","autoGearRuleNameInput","autoGearRuleNameLabel","autoGearScenariosSelect","autoGearScenariosLabel","autoGearScenarioModeLabel","autoGearScenarioBaseSelect","autoGearScenarioBaseLabel","autoGearScenarioFactorInput","autoGearScenarioFactorLabel","autoGearShootingDaysMode","autoGearShootingDaysInput","autoGearShootingDaysLabel","autoGearShootingDaysHelp","autoGearShootingDaysValueLabel","autoGearMatteboxSelect","autoGearMatteboxLabel","autoGearCameraHandleSelect","autoGearCameraHandleLabel","autoGearViewfinderExtensionSelect","autoGearViewfinderExtensionLabel","autoGearDeliveryResolutionSelect","autoGearDeliveryResolutionLabel","autoGearVideoDistributionSelect","autoGearVideoDistributionLabel","autoGearCameraSelect","autoGearCameraLabel","autoGearOwnGearLabel","autoGearOwnGearSelect","autoGearCameraWeightLabel","autoGearCameraWeightOperator","autoGearCameraWeightOperatorLabel","autoGearCameraWeightValueInput","autoGearCameraWeightValueLabel","autoGearCameraWeightHelp","autoGearMonitorSelect","autoGearMonitorLabel","autoGearTripodHeadBrandSelect","autoGearTripodHeadBrandLabel","autoGearTripodBowlSelect","autoGearTripodBowlLabel","autoGearTripodTypesSelect","autoGearTripodTypesLabel","autoGearTripodSpreaderSelect","autoGearTripodSpreaderLabel","autoGearCrewPresentSelect","autoGearCrewPresentLabel","autoGearCrewAbsentSelect","autoGearCrewAbsentLabel","autoGearWirelessSelect","autoGearWirelessLabel","autoGearMotorsSelect","autoGearMotorsLabel","autoGearControllersSelect","autoGearControllersLabel","autoGearDistanceSelect","autoGearDistanceLabel","autoGearConditionLabels","autoGearConditionSelects","autoGearConditionLogicLabels","autoGearConditionLogicSelects","getAutoGearScenarioModeSelectElementRef","setAutoGearScenarioModeSelectElementRef","autoGearScenarioModeSelectElement","AUTO_GEAR_CONDITION_KEYS","AUTO_GEAR_REPEATABLE_CONDITIONS","AUTO_GEAR_CONDITION_FALLBACK_LABELS","resolveFocusScalePreference","resolveGlobalFocusScalePreference","trimmedResolved","focusScaleNormalizeError","trimmedPreference","normalizeFocusScaleForLabel","attemptNormalize","normalizeError","directNormalized","preference","normalizedPreference","getFocusScaleLabelForLang","metricLabel","imperialLabel","candidateResolvers","runtimeLoadResult","defaultRuntimeError","SUPPORTED_LANGUAGES","known","addLanguage","runtimeLanguages","availableLanguagesError","resolveLanguagePreference","lastRuntimeHours","savedLang","resolvedSaved","syncLanguageSelectorsWithCurrentLang","languageSelectElement","settingsLanguageElement","syncError","setLanguage","requested","normalizedLang","resolveError","loadResult","loadError","translationSource","previousLang","ensureInstallPromptElements","shouldDispatchLanguageChange","dispatchLanguageChange","dispatchError","languageSelect","settingsLanguage","attemptRefreshDeviceLists","refreshFn","refreshError","retryRefresh","fallbackLocale","normalizeTemperatureUnitSafe","unit","normalizeTemperatureUnit","FALLBACK_NORMALIZE_FOCUS_SCALE","normalizeFocusScaleSafe","tryNormalize","sources","focusScaleError","getSource","resolveLocaleString","bundle","applyTextContent","createHelpLink","highlight","isButton","applySuggestionTemplate","builders","regex","lastIndex","autoIndex","start","builder","node","applySuggestionText","resolveRuntimeValue","registerResolvedElement","globalName","resolveElement","elementId","resolveDomError","settingsShowAutoBackupsEl","backupSettingsButton","backupDiffToggleButtonEl","backupDiffHeadingEl","backupDiffIntroEl","backupDiffPrimaryLabelEl","backupDiffPrimarySelectEl","backupDiffSecondaryLabelEl","backupDiffSecondarySelectEl","backupDiffEmptyStateEl","backupDiffNotesLabelEl","backupDiffNotesEl","backupDiffExportButtonEl","backupDiffCloseButtonEl","restoreRehearsalButton","restoreRehearsalHeading","restoreRehearsalIntro","restoreRehearsalModeLabel","restoreRehearsalModeBackupText","restoreRehearsalModeProjectText","restoreRehearsalFileLabel","restoreRehearsalBrowse","restoreRehearsalFileName","restoreRehearsalStatus","restoreRehearsalRuleHeading","restoreRehearsalRuleIntro","restoreRehearsalRuleEmpty","restoreRehearsalTableCaption","restoreRehearsalMetricHeader","restoreRehearsalLiveHeader","restoreRehearsalSandboxHeader","restoreRehearsalDifferenceHeader","restoreRehearsalCloseButton","restoreRehearsalProceedButton","restoreRehearsalAbortButton","skipLink","offlineElem","offlineLabel","offlineHelp","isExplicitlyOffline","applyInstallTexts","legalLinks","impressumElem","privacyElem","setupManageHeadingElem","deviceSelectionHeadingElem","resultsHeadingElem","deviceManagerHeadingElem","batteryComparisonHeadingElem","batteryComparisonDescriptionElem","batteryTableElem","setupDiagramHeadingElem","navKey","helpKey","checkKey","savedSetupsLabelElem","setupNameLabelElem","deleteSetupBtn","sharedLinkLabelElem","applySharedLinkBtn","safeSetupSelect","safeSetupNameInput","safeDeleteSetupBtn","safeSaveSetupBtn","saveSetupBtn","safeGenerateOverviewBtn","safeGenerateGearListBtn","deleteGearListHelp","safeDeleteGearListProjectBtn","editProjectBtnElem","addExtraGearBtnElem","extraLabel","shareSetupBtn","shareDialogHeadingElem","heading","shareFilenameLabelElem","filenameLabel","shareConfirmBtn","confirmLabel","shareCancelBtn","cancelLabel","shareIncludeAutoGearText","shareIncludeAutoGearLabelElem","shareIncludeAutoGearCheckbox","shareIncludeOwnedGearText","shareIncludeOwnedGearLabelElem","shareIncludeOwnedGearCheckbox","sharedImportLegendText","sharedImportLegend","sharedImportDialogHeading","sharedImportDialogMessage","sharedImportConfirmBtn","sharedImportCancelBtn","legend","sharedImportOptions","sharedImportModeSelect","sharedImportModeNoneOption","sharedImportModeProjectOption","sharedImportModeGlobalOption","cameraLabelElem","monitorLabelElem","videoLabelElem","cageLabelElem","distanceLabelElem","batteryPlateLabelElem","batteryHotswapLabelElem","fizLegendElem","fizMotorsLabelElem","fizControllersLabelElem","cineResultsModule","resultsLocalizationApplied","pinWarnElem","dtapWarnElem","hotswapWarnElem","powerWarningTitleElem","powerWarningLimitsHeadingElem","powerWarningAdviceElem","powerWarningCloseBtn","batteryLifeLabelElem","runtimeAverageNoteElem","refreshFeedbackTemperatureLabel","updateFeedbackTemperatureOptions","cineResultsError","batteryComparisonLocalized","resultsPlainSummaryElem","resultsPlainSummaryTitleElem","resultsPlainSummaryTextElem","resultsPlainSummaryNoteElem","breakdownListTarget","totalPowerLabelElem","batteryCountLabelElem","unitElem","fb","userNote","idx","tempNoteElem","safeSetText","safeSetAttr","attr","focusScaleLabel","focusScaleHelp","lensFocusScaleSelect","updateLensFocusScaleSelectOptions","monitorLatencyLabelElem","monitorLatencyHelpText","monitorLatencyInput","viewfinderLatencyLabelElem","viewfinderLatencyHelpText","viewfinderLatencyInput","videoPowerLabelElem","powerHelp","addDeviceLabel","updateDeviceLabel","addDeviceBtnElem","cancelEditBtnElem","exportBtnElem","importDataBtnElem","newNameInput","newWattInput","newCapacityInput","newPinAInput","newDtapAInput","cameraVoltageInput","monitorVoltageInput","updateDeviceManagerLocalization","toggleDeviceBtnElem","deviceManagerSectionElem","newCategorySelectElem","getCategoryLabel","applyFilters","existingDevicesHeading","darkModeToggle","pinkModeToggle","settingsButton","settingsTitleElem","settingsTablistRef","sectionsLabel","getSettingsTabLabelText","labelNode","summarizeSettingsTabHelp","sentenceMatch","sentence","truncated","cutIndex","applySettingsTabLabel","labelValue","helpValue","labelElement","captionElement","captionText","settingsTabGeneral","generalLabel","generalHelp","generalSettingsHeading","generalLanguageHeading","sectionHeading","generalAppearanceHeading","generalTypographyHeading","generalBrandingHeading","documentationTrackerController","settingsTabAutoGear","settingsTabAccessibility","settingsTabBackup","settingsTabData","settingsTabAbout","settingsLanguageLabel","languageHelp","settingsDarkLabel","darkModeHelp","settingsDarkMode","settingsPinkLabel","pinkModeHelp","settingsPinkMode","accentLabel","accentHelp","accentColorInput","cameraColorsDescription","cameraColorHelpTemplate","cameraColorALabel","cameraColorA","cameraColorBLabel","cameraColorB","cameraColorCLabel","cameraColorC","cameraColorDLabel","cameraColorD","cameraColorELabel","cameraColorE","letter","inputElement","labelText","accentColorResetButton","accentResetLabel","accentResetHelp","settingsTemperatureUnitLabel","tempUnitHelp","settingsTemperatureUnit","getTemperatureUnitLabelForLang","settingsFocusScaleLabel","settingsFocusScale","fontSizeLabel","sizeHelp","settingsFontSize","fontFamilyLabel","familyHelp","settingsFontFamily","localFontsButton","localFontsHelp","bundledFontGroup","builtInLabel","localFontsGroup","localLabel","localFontsLabel","localFontsStatus","statusKey","arg","settingsLogoLabel","logoHelp","settingsLogo","headingHelp","labelKey","autoGearExportButton","autoGearImportButton","refreshAutoGearScenarioFilterOptions","autoGearBackupsHeading","autoGearBackupsDescription","autoGearShowBackupsLabel","autoGearShowBackupsCheckbox","autoGearBackupsHiddenNotice","hiddenText","autoGearBackupRetentionLabel","autoGearBackupRetentionInput","autoGearBackupRetentionSummary","autoGearBackupSelectLabel","autoGearBackupSelect","autoGearBackupRestoreButton","autoGearBackupEmptyMessage","emptyText","refreshAutoGearConditionPicker","updateAutoGearConditionAddButtonState","modeLabel","modeHelp","factorLabel","factorHelp","minimumLabel","maximumLabel","everyLabel","valueLabel","greaterLabel","lessLabel","equalLabel","logicLabelText","logicHelpText","logicOptionTexts","optionText","autoGearAddItemsHeading","autoGearAddOwnGearLabel","autoGearAddOwnGearSelect","autoGearAddItemLabel","hint","autoGearAddNameInput","autoGearAddCategoryLabel","autoGearAddCategorySelect","autoGearAddQuantityLabel","autoGearAddQuantityInput","autoGearAddScreenSizeLabel","autoGearAddScreenSizeInput","autoGearAddSelectorTypeLabel","autoGearAddSelectorTypeSelect","noneLabel","monitorLabel","directorLabel","tripodHeadLabel","tripodBowlLabel","tripodTypesLabel","tripodSpreaderLabel","selectorLabels","autoGearAddSelectorDefaultLabel","autoGearAddSelectorDefaultInput","autoGearAddNotesLabel","autoGearAddNotesInput","autoGearRemoveItemsHeading","autoGearRemoveOwnGearLabel","autoGearRemoveOwnGearSelect","autoGearRemoveItemLabel","autoGearRemoveNameInput","autoGearRemoveCategoryLabel","autoGearRemoveCategorySelect","autoGearRemoveQuantityLabel","autoGearRemoveQuantityInput","autoGearRemoveScreenSizeLabel","autoGearRemoveScreenSizeInput","autoGearRemoveSelectorTypeLabel","autoGearRemoveSelectorTypeSelect","autoGearRemoveSelectorDefaultLabel","autoGearRemoveSelectorDefaultInput","autoGearRemoveNotesLabel","autoGearRemoveNotesInput","autoGearDraftImpactHeading","autoGearDraftImpactDescription","autoGearDraftImpactContainer","autoGearDraftWarningHeading","autoGearSaveRuleButton","autoGearCancelEditButton","syncAutoGearMonitorFieldVisibility","refreshAutoGearScenarioOptions","refreshAutoGearMatteboxOptions","refreshAutoGearCameraHandleOptions","refreshAutoGearViewfinderExtensionOptions","refreshAutoGearDeliveryResolutionOptions","refreshAutoGearVideoDistributionOptions","contrastLabel","contrastHelp","accessibilityHeading","backupHeading","projectBackupsHeading","headingText","descriptionText","projectBackupsDescription","dataHeading","dataHelp","storageSummaryIntro","storageSummaryFootnote","storageSummaryEmpty","storagePersistenceHeading","storagePersistenceIntro","storagePersistenceRequestButton","requestLabel","requestHelp","storagePersistenceStatus","idleText","storageActionsHeading","storageActionsIntro","storageBackupNowButton","backupLabel","backupHelp","storageOpenBackupTabButton","openLabel","openHelp","storageStatusHeading","statusHeading","statusHelp","storageStatusLastProjectLabel","storageStatusLastAutoBackupLabel","storageStatusLastFullBackupLabel","statusDefaultText","storageStatusLastProjectValue","storageStatusLastAutoBackupValue","storageStatusLastFullBackupValue","storageStatusReminder","loggingSection","sectionHelp","loggingHeading","loggingIntro","loggingLevelFilterLabel","filterLabel","loggingLevelFilter","optionTexts","filterHelp","loggingNamespaceFilterLabel","namespaceLabel","loggingNamespaceFilter","namespaceHelp","loggingNamespaceFilterHelp","loggingHistoryLimitLabel","historyLabel","loggingHistoryLimitHelp","historyHelp","loggingHistoryLimit","limitHelp","limitAria","loggingConsoleOutputLabel","consoleLabel","loggingConsoleOutputHelp","consoleHelp","loggingCaptureConsoleLabel","consoleCaptureLabel","loggingCaptureConsoleHelp","consoleCaptureHelp","loggingCaptureErrorsLabel","captureLabel","loggingCaptureErrorsHelp","captureHelp","loggingPersistSessionLabel","persistLabel","loggingPersistSessionHelp","persistHelp","loggingExportButton","exportLabel","loggingExportHelp","exportHelp","loggingStatus","statusText","loggingEmpty","loggingUnavailable","showAutoBackupsLabel","autoBackupsHelp","compareLabel","compareHelp","primaryLabel","compareLabelText","restoreLabel","restoreHelp","rehearsalLabel","rehearsalHelp","browseLabel","resolvedRestoreRehearsalCloseButton","proceedLabel","proceedHelp","abortLabel","abortHelp","resetLabel","resetHelp","aboutHeading","aboutVersionElem","supportLinkConfigs","saveHelp","cancelHelp","menuToggle","menuLabel","menuHelp","sideMenu","sideMenuHelp","sideMenuTitle","titleLabel","titleHelp","closeMenuButton","closeMenuLabel","reloadLabel","reloadHelp","helpButton","helpShortcutList","helpAriaShortcuts","hoverHelpButton","helpSearch","helpSearchClear","closeHelpBtn","helpNoResults","helpNoResultsSuggestionsHeading","helpNoResultsSuggestionsIntro","quickStartHeading","onboardingCopyElement","fallbackCopy","dataSafetyHeading","restoreDrillHeading","restoreDrillNote","helpDataAuditHeading","helpDataAuditStep1","helpDataAuditStep2","helpDataAuditStep3","helpDataAuditStep4","helpDataAuditNote","helpNoResultsSuggestionClear","helpNoResultsSuggestionSynonyms","helpNoResultsSuggestionQuickStart","helpNoResultsSuggestionBackup","exportRevert","downloadDiagramButton","snapActive","resetViewBtn","zoomInBtn","zoomOutBtn","diagramHint","fallbackProjectForm","projectFormTexts","resolveContactsDomRefs","setLabelText","setPlaceholder","setOptionText","projectDialogHeading","projectNameLabel","productionCompanyLabel","productionCompanyAddressLabel","productionCompanyStreetLabel","productionCompanyStreet2Label","productionCompanyCityLabel","productionCompanyRegionLabel","productionCompanyPostalCodeLabel","productionCompanyCountryLabel","productionCompanyStreetInput","productionCompanyStreet2Input","productionCompanyCityInput","productionCompanyRegionInput","productionCompanyPostalCodeInput","productionCompanyCountryInput","rentalHouseLabel","crewHeadingElem","crewLabelElem","crewLabelText","prepLabelElem","shootLabelElem","returnLabelElem","deliveryResolutionLabel","recordingResolutionLabel","sensorModeLabel","aspectRatioLabel","codecLabel","baseFrameRateLabel","recordingFrameRateLabel","recordingFrameRateHintElem","rangeTemplate","defaultHint","slowMotionLegendElem","legendText","slowMotionRecordingResolutionLabel","slowMotionSensorModeLabel","slowMotionAspectRatioLabel","slowMotionBaseFrameRateLabel","slowMotionRecordingFrameRateLabel","slowMotionRecordingFrameRateHintElem","slowRangeTemplate","slowDefaultHint","lensesHeadingElem","lensManufacturerLabel","lensSeriesLabel","lensesLabelElem","lensSelectionsHeadingElem","lensSelectionsHintElem","lensManufacturerPlaceholderOption","lensSeriesPlaceholderOption","lensSeriesEmptyElem","seriesEmptyText","lensOptionsEmptyElem","optionsEmptyText","lensSelectionChipsElem","removeTemplate","mountLabelText","riggingHeadingElem","requiredScenariosLabel","updateRequiredScenariosTranslations","cameraHandleLabel","viewfinderExtensionLabel","matteboxFilterHeadingElem","matteboxLabel","storageHeading","storageNeedsLabel","updateStorageRequirementTranslations","updateStorageRequirementTypeOptions","monitoringHeadingElem","monitoringConfigurationLabel","viewfinderSettingsLabel","frameGuidesLabel","aspectMaskOpacityLabel","videoDistributionLabel","monitorUserButtonsLabel","cameraUserButtonsLabel","viewfinderUserButtonsLabel","tripodPreferencesHeading","tripodHeadBrandLabel","viewfinderExtensionSelect","yesLabel","projectCancelButton","cancelText","projectDialogCloseBtn","projectSubmitBtn","submitText","crewPlaceholders","crewRoleLabels","fallbackContacts","contactsTexts","contactsDialogHeading","contactsDialogDescription","contactsAddButtonLabel","contactsAddButton","contactsImportButtonLabel","contactsImportButton","contactsImportHint","contactsEmptyState","userProfileHeading","userProfileDescription","userProfileNameLabel","userProfileNameInput","userProfileRoleLabel","userProfileRoleInput","profileSnapshot","profileController","populateUserProfileRoleSelect","userProfilePhoneLabel","userProfilePhoneInput","userProfileEmailLabel","userProfileEmailInput","userProfileHint","userProfileAvatarButtonLabel","userProfileAvatarButton","userProfileAvatarClearButton","avatarOptionsTitleElem","avatarOptionsDescriptionElem","avatarOptionsCloseLabel","avatarOptionsCloseButton","avatarOptionsDeleteButton","avatarEditZoomLabelElem","contactsCloseButton","renderContactsList","row","roleSelect","roleKey","nameInput","phoneInput","emailInput","websiteInput","contactSelect","setContactSelectOptions","saveButton","getContactsText","manageButton","updateRowLinkedBadge","stripTrailingPunctuation","addEntryLabel","addPersonBtn","crewLabel","addPrepBtn","prepLabel","addShootBtn","shootLabel","addReturnBtn","returnLabel","iosPwaHelpTitle","iosPwaHelpIntro","iosPwaHelpStep1","iosPwaHelpStep2","iosPwaHelpStep3","iosPwaHelpStep4","iosPwaHelpNote","iosPwaHelpClose","closeText","btn","monitorSelect","videoSelect","videoDistributionSelect","cageSelect","motorSelects","controllerSelects","distanceSelect","batterySelect","hotswapSelect","lensSelect","requiredScenariosSelect","remoteHeadOption","tripodHeadBrandSelect","tripodBowlSelect","tripodTypesSelect","tripodSpreaderSelect","crewContainer","prepContainer","shootContainer","returnContainer","storageNeedsContainer","contactsForm","contactsImportInput","contactsList","contactsAnnouncement","openContactsBtn","userProfileSection","userProfileAvatarContainer","userProfileAvatarInput","avatarOptionsDialog","avatarOptionsForm","avatarEditViewport","avatarEditImage","avatarPlaceholder","avatarControls","avatarEditZoomInput","avatarOptionsContext","avatarEditState","avatarEditLastViewportSize","avatarUploadInput","avatarSaveButton","avatarCancelButton","crewRoles","getCrewRoleLabels","roleLabels","placeholderDefault","placeholderText","selectedValue","previousScrollTop","extraOption","ensureUserProfileRoleOption","roleValue","projectFieldIcons","updateSelectIconBoxes","sel","multiSelected","hasValue","parent","container","box","assignSelectIconError","getLocalizedPathText","localized","configureIconOnlyButton","contextPaths","fallbackContext","actionKey","actionLabel","paths","contextLabel","combinedLabel","generatedFieldIdCounter","sanitizeForId","ensureElementId","baseText","createHiddenLabel","forId","globalAssignError","getProjectFormText","CONTACTS_STORAGE_KEY_DEFAULT","resolveContactsStorageKey","contactsCache","contactsInitialized","profile","saveError","announceContactsMessage","dispatchGearProviderDataChanged","generateContactId","sanitizeContactValue","normalizeContactEntry","sortContacts","loadStoredContacts","storageKey","saveContactsToStorage","contacts","getContactById","getContactDisplayLabel","roleLabel","updateTripodOptions","selectedId","optionLang","optionDirection","updateContactPickers","getAvatarInitial","updateAvatarVisual","avatarValue","fallbackName","initialClass","visual","img","span","setRowAvatar","dataInput","avatarContainer","parseDataUrlMimeType","dataUrl","separatorIndex","updateAvatarOptionsPreview","stopAvatarEditing","restoreFocus","closeAvatarOptionsDialog","handleAvatarOptionsDialogClosed","openAvatarOptionsDialog","clampAvatarEditOffsets","minX","minY","updateAvatarEditMetrics","width","height","displayWidth","displayHeight","measureAvatarEditViewportSize","restoreHidden","previousVisibility","previousPointerEvents","viewportSize","viewportRect","initializeAvatarEditState","image","mime","baseScale","handleAvatarEditZoomInputChange","prevWidth","prevHeight","centerX","centerY","ratioX","ratioY","targetCenterX","targetCenterY","handleAvatarEditPointerDown","handleAvatarEditPointerMove","deltaX","deltaY","clearAvatarEditPointerState","handleAvatarEditPointerUp","handleAvatarEditPointerCancel","handleAvatarEditKeyDown","moved","exportAvatarEditResult","cropSize","sourceX","sourceY","canvas","ctx","applyAvatarEditChanges","handleAvatarDrop","processAvatarFile","handleAvatarDragOver","handleAvatarDragLeave","handleAvatarUpload","handleAvatarSave","handleAvatarOptionsDialogPointerDown","elementTarget","assignUserProfileState","getUserProfileSnapshot","applyUserProfileToDom","preserveTarget","end","hasAvatar","loadUserProfileState","setAvatar","persistUserProfileState","clearAvatar","activeElement","handleUserProfileNameInput","handleUserProfileRoleInput","handleUserProfilePhoneInput","handleUserProfileEmailInput","handleUserProfileFieldBlur","handleUserProfileAvatarCleared","handleUserProfileAvatarButtonClick","handleUserProfileAvatarInputChange","refreshRowAvatarInitial","detachCrewRowContact","preserveSelect","badge","contactId","isUserProfileLinked","handleCrewRowManualChange","immediate","handleAvatarFileSelection","applyContactToCrewRow","skipDirty","skipAnnouncement","getCrewRowSnapshot","roleSel","updateCrewRowsForContact","avatarInput","deleteContact","saveCrewRowAsContact","newContact","parseVCard","mergeImportedContacts","imported","added","updated","createContactCard","card","header","avatarVisual","avatarButton","avatarLabel","fields","nameFieldId","nameLabel","nameWrapper","roleFieldId","rolePlaceholder","role","roleLabelElem","roleWrapper","phoneFieldId","phoneLabelElem","phoneWrapper","emailFieldId","emailLabelElem","emailWrapper","websiteFieldId","websiteLabelElem","websiteWrapper","actions","useButton","createCrewRow","deleteButton","confirmMessage","performDelete","resort","nextActive","focusContactId","focusTarget","enableAvatarDragAndDrop","onFile","handleDragOver","handleDragLeave","handleDrop","documentLang","rowLanguage","rowDirection","crewRoleLabelText","crewNameLabelText","crewPhoneLabelText","crewEmailLabelText","crewWebsiteLabelText","crewContactLabelText","avatarChangeLabel","avatarDataInput","avatarFileInput","phoneLabel","emailLabel","websiteLabel","contactLabel","linkedBadge","saveContactBtn","manageContactsBtn","removeBtn","removeBase","crewHeading","removeCrewLabel","createPrepRow","createShootRow","createReturnRow","prepLabelText","removePrepLabel","shootLabelText","removeShootLabel","returnLabelText","removeReturnLabel","formatCapacity","gatherMediaEntriesForType","cameraDb","selectedName","addEntries","media","getAvailableStorageMediaTypes","mediaDb","typeOrder","normalizedTypes","addType","addCameraTypes","traverseMedia","info","interfaceStr","mediaType","getStorageVariantOptions","variants","traverse","addVariant","lowerLabel","matches","model","capacityGb","capacityTb","capacityLabel","noteVariants","updateStorageVariantOptions","blank","typeSelect","variantSelect","previousVariant","typeOption","createStorageRequirementRow","quantityInput","quantityLabelText","quantityId","quantityLabel","typeLabelText","typeLabel","variantLabelText","variantLabel","notesInput","notesLabelText","notesLabel","storageLabel","duplicateBtn","duplicateLabel","newRow","focusField","actionContainer","translated","typePlaceholder","variantPlaceholder","notesPlaceholder","duplicateActionLabel","firstOption","input","storageRemoveLabel","headBrand","bowl","headOpts","bowlOpts","o","powerWarningDialog","heroCard","heroTotalDraw","heroAvailablePower","heroBatteryLabel","powerDiagramElem","powerDiagramBarElem","maxPowerTextElem","powerDiagramLegendElem","updatePowerSummary","closePowerWarningDialog","dismissPowerWarningDialog","drawPowerDiagram","availableWatt","maxPinA","total","sum","ratio","selectedOption","batteryName","limitPos","barInner","seg","widthPercent","div","legendItem","swatch","over","sharedLinkInput","shareFilenameInput","shareFilenameMessage","sharedImportDialog","sharedImportMetadata","pendingSharedLinkListener","sharedKeyMap","sharedKeyMapKeys","sharedHasOwn","formatSharedImportMetadataSummary","updateSharedImportMetadataSummary","clearStoredSharedImportData","resetSharedImportStateForFactoryReset","configureSharedImportOptions","sharedRules","hasRules","encodeSharedSetup","out","decodeSharedSetup","hasLongKeys","hasShortKeys","pendingKeys","longPresent","shortPresent","expanded","deviceManagerSection","toggleDeviceBtn","deviceListContainerRef","resolveDeviceListContainer","deviceManagerLists","filterHelperScope","fallbackFilterSelect","filterValue","isMatch","fallbackFilterDeviceList","listElem","fallbackAddInputClearButton","inputElem","clearLabel","clearBtn","fallbackBindFilterInput","ensureFilterHelpers","attachHelper","filterFn","filterInput","filterError","DEVICE_MANAGER_DEFAULT_ORDER","getDeviceManagerPreferredOrder","scopedOrder","normalizeCategoryKey","categoryKey","langNames","fallbackNames","categories","addCategory","traverseSchema","depth","topLevelKey","childKey","subKey","subValue","sorted","preferredOrder","orderMap","idxA","idxB","createDeviceCategorySection","section","sanitizedId","listId","resolveFilterScope","attachFilterBinding","bindFn","placeholderTemplate","librarySearchInput","librarySearchLabel","librarySearchHelp","librarySearchPlaceholder","librarySearchLabelText","applyLibraryLocalization","syncDeviceManagerCategories","desiredSet","getCurrentProjectName","typedName","newCategorySelect","wattFieldDiv","addOpt","categoriesToAdd","sortedCategories","labelA","labelB","catKey","addIfMissing","getCategoryContainer","subcategory","create","mainCat","rawSubCat","subCat","removeOriginalDeviceEntry","originalCategory","originalSubcategory","originalName","newCategory","newSubcategory","newName","resolveFeedbackTemperatureBounds","ensureFeedbackTemperatureOptions","expectedOptions","storedMin","storedMax","emptyOpt","getTemperatureColumnLabelForLang","getRuntimeTemperatureUnit","tempSelect","resolvedLang","resolvedUnit","symbol","getTemperatureUnitSymbolForLang","formatTemperatureForDisplay","fallbackUnitCandidates","convertCelsiusToUnit","celsius","includeSign","converted","formatter","hasDocument","ensureArrayBinding","defaultVideoPortOptions","defaultViewfinderTypes","defaultViewfinderConnectors","safeLocaleSort","readDevices","collectValues","collectViewfinderTypes","valueSet","collectViewfinderConnectors","connector","collectVideoPortOptions","appendPorts","portType","resolveContainer","viewfinderContainerEl","viewfinderInputsContainerEl","viewfinderOutputsContainerEl","fallbackIdCounter","createFieldWithLabel","wrapper","fieldId","populateSelectOptions","addOption","optVal","createViewfinderRow","resolution","resolutionInput","connectorSelect","addBtn","createViewfinderVideoRow","contextHeadingId","contextLabelId","setViewfindersFallback","getViewfindersFallback","clearViewfindersFallback","setViewfinderVideoInputsFallback","getViewfinderVideoInputsFallback","clearViewfinderVideoInputsFallback","setViewfinderVideoOutputsFallback","getViewfinderVideoOutputsFallback","clearViewfinderVideoOutputsFallback","placeWattField","form","watt","video","isVideoLike","rawPreference","preserveValue","language","languageTexts","defaultLabelBase","desiredValue","settingsTablist","installPromptBanner","installPromptBannerText","installPromptBannerAction","installPromptBannerIcon","installPromptBannerDismiss","installGuideDialog","installGuideTitle","installGuideIntro","installGuideSteps","installGuideNote","installGuideMigration","installGuideMigrationTitle","installGuideMigrationIntro","installGuideMigrationSteps","installGuideMigrationNote","installGuideClose","iosPwaHelpDialog","installPromptElementsInitialized","syncResetButtonGlobal","mountVoltageSectionElem","mountVoltageHeadingElem","mountVoltageDescriptionElem","mountVoltageNoteElem","mountVoltageResetButton","mountVoltageTitleElems","mountVoltageInputs","mountVoltageNamespace","installBannerSetupComplete","currentInstallGuidePlatform","lastActiveBeforeInstallGuide","lastActiveBeforeIosHelp","parseRgbComponent","percent","parseColorToRgb","hexMatch","hex","rgbMatch","g","red","green","blue","component","computeRelativeLuminance","rgb","clamp","transform","isIosDevice","isAndroidDevice","isStandaloneDisplayMode","markIosPwaHelpDismissed","getInstallBannerDismissedInSession","setInstallBannerDismissedInSession","hasDismissedInstallBanner","dismissed","markInstallBannerDismissed","shouldShowInstallBanner","updateInstallBannerVisibility","shouldShow","updateInstallBannerColors","textColor","renderInstallGuideContent","platform","isIos","titleKey","introKey","stepsKey","noteKey","intro","stepsSource","fallbackStepsSource","toArray","fallbackSteps","effectiveSteps","li","migrationTitle","migrationIntro","migrationSteps","migrationNote","openInstallGuide","closeInstallGuide","setupInstallBanner","handleChange","bannerText","dismissLabel","hiddenLabel","shouldShowIosPwaHelp","openIosPwaHelp","closeIosPwaHelp","storeDismissal","maybeShowIosPwaHelp","handled","settingsButtonIcon","settingsDialog","settingsTabButtons","settingsTabsContainer","settingsTabsScrollPrev","settingsTabsScrollNext","settingsTabsOverflowFrame","SETTINGS_TABS_SIDEBAR_QUERY","settingsTabsOrientationQuery","applySettingsTabsOrientation","scheduleSettingsTabsOverflowUpdate","handleSettingsTabsOrientationChange","updateSettingsTabsOverflowIndicators","scrollWidth","clientWidth","rawScrollLeft","maxScrollLeft","scrollLeft","canScroll","atStart","atEnd","scrollSettingsTabs","amount","settingsTabsPassiveOptions","passiveTestHandler","passiveTestOptions","settingsTabPanels","settingsTabIconAssignments","iconElement","documentationTrackerCreateError","documentationTrackerInitError","documentationTrackerLocaleError","documentationTrackerRenderError","noop","activeSettingsTabId","storedTab","tabId","focusTab","panel","currentIndex","nextIndex","nextTab","backupButton","autoGearConditionConfigs","autoGearExports","refreshAutoGearShootingDaysValue","autoGearConditionRefreshers","autoGearActiveConditions","getAutoGearConditionConfig","getAutoGearConditionLabel","placeholderLabel","hasSelection","disabledPicker","hasAvailable","shortcut","removeAutoGearCondition","refresher","preserveDraft","handleShootingDaysModeChange","handleShootingDaysValueInput","handleLogicChange","handleCameraWeightOperatorChange","handleCameraWeightValueInput","enableAutoGearMultiSelectToggle","handlePointerToggle","dispatchEvent","evt","autoGearAddScreenSizeField","autoGearAddSelectorTypeField","autoGearAddSelectorDefaultField","autoGearRemoveScreenSizeField","autoGearRemoveSelectorTypeField","autoGearRemoveSelectorDefaultField","updateFn","storageSummaryList","queueAutoGearRetentionHandler","handlerName","autoGearRuleMatchesScenario","scenarioValue","autoGearRuleMatchesSearch","normalizedQuery","haystack","pushValues","alwaysText","shootingCondition","shootingLabel","collectItems","AUTO_GEAR_SCENARIO_FALLBACK_VALUES","getAutoGearScenarioFallbackOptions","normalizeEntry","trimmedValue","displayLabel","resolveFromSession","sessionEntries","resolveFromScenarioIcons","scenarioIcons","resolveFromFallbackValues","collectAutoGearScenarioFilterOptions","anyLabel","anyOption","optionsAvailable","CORE_RUNTIME_CONSTANTS","initAppCoreNewDomReferences","rentalHouses","cineDevices","autoGearStorage","autoGearNormalizers"],"ignoreList":[],"sources":["../../src/scripts/modules/static-theme.js","../../src/scripts/static-theme.js","../../src/scripts/modules/helpers/deep-clone.js","../../src/scripts/core/app-core-runtime-global-tools.js","../../src/scripts/shims/vite-global-patches.js","../../src/scripts/modules/force-populate.js","../../src/scripts/force-populate.js","../../src/scripts/translations/en.js","../../src/scripts/modules/translations.js","../../src/scripts/translations.js","../../src/scripts/modules/core/pink-mode.js","../../src/scripts/core/app-core-pink-mode.js","../../src/scripts/auto-gear/ui.js","../../src/scripts/auto-gear/normalizers.js","../../src/scripts/auto-gear/storage.js","../../src/scripts/modules/text.js","../../src/scripts/modules/ui-helpers.js","../../src/scripts/modules/device-schema.js","../../src/scripts/modules/runtime-support.js","../../src/scripts/core/app-core-runtime-support.js","../../src/scripts/modules/core/bootstrap-environment.js","../../src/scripts/modules/core/bootstrap-results.js","../../src/scripts/modules/core/bootstrap.js","../../src/scripts/core/modules/app-core/bootstrap.js","../../src/scripts/core/modules/app-core/localization-fixed.js","../../src/scripts/core/app-core-bootstrap.js","../../src/scripts/modules/localization.js","../../src/scripts/modules/environment.js","../../src/scripts/modules/environment-bridge.js","../../src/scripts/modules/offline.js","../../src/scripts/modules/globals.js","../../src/scripts/modules/system.js","../../src/scripts/modules/context.js","../../src/scripts/modules/architecture-helpers.js","../../src/scripts/modules/architecture.js","../../src/scripts/modules/runtime.js","../../src/scripts/modules/settings-and-appearance.js","../../src/scripts/modules/globals-mount-voltage.js","../../src/scripts/modules/globals-bootstrap.js","../../src/scripts/globals-bootstrap.js","../../src/scripts/runtime/bootstrap.js","../../src/scripts/core/app-core-runtime-candidate-scopes.js","../../src/scripts/modules/core/runtime-helpers.js","../../src/scripts/core/app-core-runtime-helpers.js","../../src/scripts/modules/core/runtime-shared.js","../../src/scripts/core/app-core-runtime-shared.js","../../src/scripts/modules/helpers/freeze-registry.js","../../src/scripts/modules/helpers/global-scope.js","../../src/scripts/modules/helpers/auto-gear.js","../../src/scripts/modules/helpers/connectors.js","../../src/scripts/modules/runtime-environment.js","../../src/scripts/core/app-core-environment.js","../../src/scripts/core/modules/ui-cache.js","../../src/scripts/core/app-core-ui-helpers.js","../../src/scripts/core/app-core-text.js","../../src/scripts/core/app-core-runtime-scopes.js","../../src/scripts/core/app-core-new-1.js","../../src/main.js?v=1"],"sourcesContent":["/**\n * @fileoverview UTILITY MODULE: Static Theme\n * \n * Applies static theme preferences (Dark Mode, Pink Mode, Accessibility settings)\n * to pages immediately upon load, preventing flash of incorrect theme.\n * \n * @module modules/static-theme\n */\n\nconst DEFAULT_ACCENT = '#001589';\nconst HIGH_CONTRAST_ACCENT = '#ffffff';\nlet storageErrorLogged = false;\n\nfunction safeGet(key, scope) {\n    try {\n        if (scope && scope.localStorage) {\n            return scope.localStorage.getItem(key);\n        }\n        if (typeof window !== 'undefined' && window.localStorage) {\n            return window.localStorage.getItem(key);\n        }\n    } catch (err) {\n        if (!storageErrorLogged) {\n            console.warn('Unable to read localStorage preference', err);\n            storageErrorLogged = true;\n        }\n    }\n    return null;\n}\n\nfunction updateThemeColor(isDark, documentObj) {\n    if (!documentObj) return;\n    const meta = documentObj.querySelector('meta[name=\"theme-color\"]');\n    if (meta) {\n        meta.setAttribute('content', isDark ? '#1c1c1e' : '#f9f9f9');\n    }\n}\n\nfunction applyAccent(color, root, body) {\n    if (!root) return;\n\n    const highContrastActive =\n        root.classList.contains('high-contrast') ||\n        (body && body.classList.contains('high-contrast'));\n    const accentValue = highContrastActive ? HIGH_CONTRAST_ACCENT : color;\n\n    root.style.setProperty('--accent-color', accentValue);\n    if (highContrastActive) {\n        root.style.removeProperty('--link-color');\n    } else {\n        root.style.setProperty('--link-color', color);\n    }\n    root.style.setProperty('--logo-background-color', accentValue);\n    root.style.setProperty('--logo-accent-color', accentValue);\n\n    if (body) {\n        body.style.setProperty('--accent-color', accentValue);\n        if (highContrastActive) {\n            body.style.removeProperty('--link-color');\n        } else {\n            body.style.setProperty('--link-color', color);\n        }\n        body.style.setProperty('--logo-background-color', accentValue);\n        body.style.setProperty('--logo-accent-color', accentValue);\n    }\n}\n\nexport function applyStaticTheme(scope = window) {\n    if (typeof document === 'undefined') return;\n\n    const root = document.documentElement;\n    const body = document.body;\n\n    // High Contrast\n    const highContrastEnabled = safeGet('highContrast', scope) === 'true';\n    if (root) root.classList.toggle('high-contrast', highContrastEnabled);\n    if (body) body.classList.toggle('high-contrast', highContrastEnabled);\n\n    // Reduced Motion\n    let storedReduceMotion = safeGet('reduceMotion', scope);\n    if (\n        storedReduceMotion === null &&\n        scope &&\n        typeof scope.matchMedia === 'function'\n    ) {\n        storedReduceMotion = scope.matchMedia('(prefers-reduced-motion: reduce)').matches\n            ? 'true'\n            : 'false';\n    }\n    const reduceMotionEnabled = storedReduceMotion === 'true';\n    if (root) root.classList.toggle('reduce-motion', reduceMotionEnabled);\n    if (body) body.classList.toggle('reduce-motion', reduceMotionEnabled);\n\n    // Relaxed Spacing\n    const relaxedSpacingEnabled = safeGet('relaxedSpacing', scope) === 'true';\n    if (root) root.classList.toggle('relaxed-spacing', relaxedSpacingEnabled);\n    if (body) body.classList.toggle('relaxed-spacing', relaxedSpacingEnabled);\n\n    // Pink Mode\n    let storedPinkMode = safeGet('cameraPowerPlanner_pinkMode', scope);\n    if (storedPinkMode === null || storedPinkMode === undefined || storedPinkMode === '') {\n        storedPinkMode = safeGet('pinkMode', scope);\n    }\n    const pinkModeEnabled = storedPinkMode === 'true';\n    if (root) root.classList.toggle('pink-mode', pinkModeEnabled);\n    if (body) body.classList.toggle('pink-mode', pinkModeEnabled);\n\n    // Font Size\n    const storedFontSize = safeGet('fontSize', scope);\n    if (storedFontSize && root) {\n        root.style.fontSize = storedFontSize + 'px';\n    }\n\n    // Font Family\n    const storedFontFamily = safeGet('fontFamily', scope);\n    if (storedFontFamily && root) {\n        root.style.setProperty('--font-family', storedFontFamily);\n    }\n\n    // Dark Mode\n    let storedDarkMode = safeGet('darkMode', scope);\n    if (storedDarkMode === null && scope && typeof scope.matchMedia === 'function') {\n        storedDarkMode = scope.matchMedia('(prefers-color-scheme: dark)').matches ? 'true' : 'false';\n    }\n    const darkModeEnabled = storedDarkMode === 'true';\n    if (root) {\n        root.classList.toggle('dark-mode', darkModeEnabled);\n        root.classList.toggle('light-mode', !darkModeEnabled);\n    }\n    if (body) {\n        body.classList.toggle('dark-mode', darkModeEnabled);\n        body.classList.toggle('light-mode', !darkModeEnabled);\n    }\n    updateThemeColor(darkModeEnabled, document);\n\n    // Accent Color\n    const storedAccent = safeGet('accentColor', scope);\n    const accentColor = storedAccent || DEFAULT_ACCENT;\n    if (pinkModeEnabled) {\n        if (root) {\n            root.style.removeProperty('--accent-color');\n            root.style.removeProperty('--link-color');\n            root.style.removeProperty('--logo-background-color');\n            root.style.removeProperty('--logo-accent-color');\n        }\n        if (body) {\n            body.style.removeProperty('--accent-color');\n            body.style.removeProperty('--link-color');\n            body.style.removeProperty('--logo-background-color');\n            body.style.removeProperty('--logo-accent-color');\n        }\n    } else {\n        applyAccent(accentColor, root, body);\n    }\n}\n","/**\n * @fileoverview SHIM: Static Theme\n * \n * This file is maintained for backward compatibility.\n * It imports the core logic from the new ESM module and applies it.\n */\n\nimport { applyStaticTheme } from './modules/static-theme.js';\n\n(function () {\n  const scope = typeof window !== 'undefined' ? window : undefined;\n\n  applyStaticTheme(scope);\n\n  if (typeof document !== 'undefined') {\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', () => applyStaticTheme(scope));\n    }\n  }\n})();\n","/**\n * Deep Clone Utilities\n * \n * Provides resilient deep cloning mechanisms, prioritizing `structuredClone`\n * but falling back to JSON serialization when necessary.\n * \n * Extracted from app-core-runtime-global-tools.js during Batch 11 migration.\n */\n\nimport { detectGlobalScope, safeAssign } from './scope-utils.js';\n\nexport function jsonDeepClone(value) {\n    if (value === null || typeof value !== 'object') {\n        return value;\n    }\n\n    try {\n        return JSON.parse(JSON.stringify(value));\n    } catch (e) {\n        // Fallback or ignore\n    }\n\n    return value;\n}\n\nexport function resolveStructuredClone(scope) {\n    if (typeof structuredClone === 'function') {\n        return structuredClone;\n    }\n\n    const target = scope || detectGlobalScope();\n    if (target && typeof target.structuredClone === 'function') {\n        return target.structuredClone.bind(target);\n    }\n\n    return null;\n}\n\nexport function createResilientDeepClone(scope) {\n    const cloneFn = resolveStructuredClone(scope);\n\n    if (!cloneFn) {\n        return jsonDeepClone;\n    }\n\n    return function resilientDeepClone(value) {\n        if (value === null || typeof value !== 'object') {\n            return value;\n        }\n\n        try {\n            return cloneFn(value);\n        } catch (e) {\n            // Fallback\n        }\n\n        return jsonDeepClone(value);\n    };\n}\n\nexport function ensureDeepClone(scope) {\n    const target = scope || detectGlobalScope();\n\n    if (target && typeof target.__cineDeepClone === 'function') {\n        return target.__cineDeepClone;\n    }\n\n    const clone = createResilientDeepClone(target);\n\n    if (target && typeof target === 'object') {\n        safeAssign(target, '__cineDeepClone', clone);\n    }\n\n    return clone;\n}\n\nexport const CORE_DEEP_CLONE = ensureDeepClone();\n","/*\n * Cine Power Planner runtime global tool bridge.\n *\n * MIGRATED to pure ESM modules in Batch 11.\n * - Scope Logic -> modules/helpers/scope-utils.js\n * - Deep Clone -> modules/helpers/deep-clone.js\n *\n * This file remains as a shim for legacy code.\n */\n\nimport {\n  detectGlobalScope,\n  resolveFromScopes,\n  getCachedGlobalValue,\n  safeAssign\n} from '../modules/helpers/scope-utils.js';\n\nimport {\n  jsonDeepClone,\n  createResilientDeepClone,\n  ensureDeepClone,\n  CORE_DEEP_CLONE as DeepCloneExport\n} from '../modules/helpers/deep-clone.js';\n\n// --- Scope Adapters ---\n\nconst CORE_GLOBAL_SCOPE = detectGlobalScope();\n\nexport function getCoreGlobalObject() {\n  return detectGlobalScope();\n}\n\nexport function ensureCoreGlobalValue(name, fallbackValue) {\n  if (!name) return undefined;\n\n  const scope = detectGlobalScope();\n  if (!scope) {\n    return typeof fallbackValue === 'function' ? fallbackValue() : fallbackValue;\n  }\n\n  if (typeof scope[name] !== 'undefined') {\n    return scope[name];\n  }\n\n  const value = typeof fallbackValue === 'function' ? fallbackValue() : fallbackValue;\n  safeAssign(scope, name, value);\n  return value;\n}\n\n// --- Deep Clone Adapters ---\n\nconst coreJsonDeepClone = jsonDeepClone;\nconst coreCreateResilientDeepClone = createResilientDeepClone;\nexport const CORE_DEEP_CLONE = DeepCloneExport;\n\nexport const CORE_RUNTIME_GLOBAL_TOOLS = {\n  getCoreGlobalObject,\n  ensureCoreGlobalValue,\n  jsonDeepClone: coreJsonDeepClone,\n  createResilientDeepClone: coreCreateResilientDeepClone,\n  ensureDeepClone,\n  CORE_DEEP_CLONE,\n  CORE_GLOBAL_SCOPE\n};\n\n// Check for legacy Fallbacks object and stub if needed (though mostly unused now)\nexport const CORE_RUNTIME_TOOL_FALLBACKS = {\n  getCoreGlobalObject,\n  ensureCoreGlobalValue,\n  jsonDeepClone,\n  createResilientDeepClone,\n  ensureDeepClone\n};\n\n// Global Injection for Legacy Compatibility\nif (CORE_GLOBAL_SCOPE) {\n  if (!CORE_GLOBAL_SCOPE.cineCoreRuntimeGlobalTools) {\n    CORE_GLOBAL_SCOPE.cineCoreRuntimeGlobalTools = CORE_RUNTIME_GLOBAL_TOOLS;\n  }\n  if (!CORE_GLOBAL_SCOPE.ensureCoreGlobalValue) {\n    CORE_GLOBAL_SCOPE.ensureCoreGlobalValue = ensureCoreGlobalValue;\n  }\n  if (!CORE_GLOBAL_SCOPE.getCoreGlobalObject) {\n    CORE_GLOBAL_SCOPE.getCoreGlobalObject = getCoreGlobalObject;\n  }\n  if (!CORE_GLOBAL_SCOPE.CORE_DEEP_CLONE) {\n    CORE_GLOBAL_SCOPE.CORE_DEEP_CLONE = CORE_DEEP_CLONE;\n  }\n}\n\nexport default CORE_RUNTIME_GLOBAL_TOOLS;\n","/**\n * Vite Global Patches\n * \n * This file is imported FIRST by main.js to ensure legacy global variables\n * are available before any other modules (like app-core-new-1.js) are evaluated.\n * \n * This works around ESM evaluation order where imports are hoisted above\n * the executing body of the importer.\n */\n\nimport { getCoreGlobalObject } from '../core/app-core-runtime-global-tools.js';\nimport { iconGlyph, ICON_GLYPHS, iconMarkup } from '../modules/icons.js';\n\nif (typeof window !== 'undefined') {\n    console.log('[Vite Global Patches] Applying global shims...');\n\n    // Expose getCoreGlobalObject\n    window.getCoreGlobalObject = getCoreGlobalObject;\n\n    // Expose CORE_GLOBAL_SCOPE\n    window.CORE_GLOBAL_SCOPE = window;\n\n    // Expose Icon Helpers\n    window.iconGlyph = iconGlyph;\n    window.ICON_GLYPHS = ICON_GLYPHS;\n    window.iconMarkup = iconMarkup;\n\n    // Stub Legacy Core Runtime Globals\n    // These are expected to be defined by app-core-new-1.js or friends, but \n    // circular dependencies or split files might leave them undefined momentarily.\n    if (typeof window.CORE_RUNTIME_CANDIDATE_SCOPES === 'undefined') {\n        window.CORE_RUNTIME_CANDIDATE_SCOPES = null;\n    }\n    if (typeof window.CORE_RUNTIME_STATE_SUPPORT === 'undefined') {\n        window.CORE_RUNTIME_STATE_SUPPORT = null;\n    }\n\n    console.log('[Vite Global Patches] Shims applied.');\n}\n","/**\n * @fileoverview FORCE POPULATE LOGIC\n * \n * Ensures that critical UI elements (select dropdowns) are populated\n * with device data even if the main application logic stalls or loads out of order.\n * \n * Also serves as the final boot step to trigger V2 initialization.\n * \n * @module modules/force-populate\n */\n\n/**\n * Populates a specific select element by ID with data.\n * @param {Object} scope - Global scope (window)\n * @param {string} id - Element ID\n * @param {Object} data - Data to populate\n */\nfunction populateId(scope, id, data) {\n    if (!scope.document) return;\n    const el = scope.document.getElementById(id);\n    if (el && el.options.length <= 1) {\n        try {\n            scope.populateSelect(el, data);\n            console.log(`[ForcePopulate] Populated ${id} with ${Object.keys(data).length} items`);\n        } catch (e) {\n            console.error(`[ForcePopulate] Failed to populate ${id}`, e);\n        }\n    }\n}\n\n/**\n * Attempts to populate UI and finalize boot.\n * Re-entrant: returns true if successful, false if dependencies (devices) are missing.\n * \n * @param {Object} scope - Global scope\n * @param {Object} bootstrapProvider - V2 Bootstrap provider (must have .init())\n * @returns {boolean} True if population succeeded\n */\nexport function attemptPopulate(scope, bootstrapProvider) {\n    if (!scope || !scope.devices || !scope.populateSelect) {\n        console.log('[ForcePopulate] Waiting for dependencies...');\n        return false;\n    }\n\n    console.log('[ForcePopulate] Dependencies ready. Populating...');\n    const devices = scope.devices;\n\n    if (devices.cameras) populateId(scope, 'cameraSelect', devices.cameras);\n    if (devices.monitors) populateId(scope, 'monitorSelect', devices.monitors);\n    if (devices.video) populateId(scope, 'videoSelect', devices.video);\n    if (devices.batteries) populateId(scope, 'batterySelect', devices.batteries);\n    if (devices.batteryHotswaps) populateId(scope, 'batteryHotswapSelect', devices.batteryHotswaps);\n\n    if (devices.fiz) {\n        ['motor1Select', 'motor2Select', 'motor3Select', 'motor4Select',\n            'controller1Select', 'controller2Select', 'controller3Select', 'controller4Select'].forEach(id => {\n                populateId(scope, id, devices.fiz);\n            });\n    }\n\n    // Also try to process the boot queue\n    if (typeof scope.processCoreBootQueue === 'function') {\n        console.log('[ForcePopulate] Triggering boot queue processing...');\n        scope.processCoreBootQueue();\n    } else if (scope.CORE_BOOT_QUEUE && scope.CORE_BOOT_QUEUE.length > 0) {\n        console.warn('[ForcePopulate] processCoreBootQueue not found, manually draining queue...');\n        const queue = scope.CORE_BOOT_QUEUE;\n        // Drain safely\n        const snapshot = queue.splice(0, queue.length);\n        snapshot.forEach(t => { try { t() } catch { /* ignore */ } });\n    }\n\n    // Force dismiss overlay\n    console.log('[ForcePopulate] Dismissing loading overlay...');\n    if (scope.document) {\n        const overlay = scope.document.getElementById('cineGlobalLoadingIndicator');\n        if (overlay) {\n            overlay.style.display = 'none';\n            overlay.setAttribute('aria-hidden', 'true');\n        }\n\n        // Mark app as ready\n        if (scope.document.body) {\n            scope.document.body.classList.add('app-ready');\n        }\n    }\n\n    // Initialize V2 Bootstrap\n    console.log('[ForcePopulate] Initializing V2 Bootstrap...');\n    try {\n        if (bootstrapProvider && typeof bootstrapProvider.init === 'function') {\n            bootstrapProvider.init();\n        }\n    } catch (e) {\n        console.error('[ForcePopulate] V2 Bootstrap init failed', e);\n    }\n\n    // Dispatch completion event\n    try {\n        if (scope.dispatchEvent && typeof CustomEvent === 'function') {\n            scope.dispatchEvent(new CustomEvent('cine-loader-complete'));\n        }\n    } catch (e) { console.error(e); }\n\n    return true;\n}\n\n/**\n * Starts the polling mechanism to ensure population occurs.\n * \n * @param {Object} scope - Global scope\n * @param {Object} bootstrapProvider - V2 Bootstrap provider\n * @param {number} [intervalMs=100] - Polling interval\n */\nexport function startForcePopulate(scope, bootstrapProvider, intervalMs = 100) {\n    if (typeof scope === 'undefined') return;\n\n    console.log('[ForcePopulate] Script loaded (Module)');\n\n    if (!attemptPopulate(scope, bootstrapProvider)) {\n        const interval = setInterval(() => {\n            if (attemptPopulate(scope, bootstrapProvider)) {\n                clearInterval(interval);\n            }\n        }, intervalMs);\n\n        // Allow clearing/mocking interval in tests if needed (implicitly via scope/timer mocks)\n        return interval;\n    }\n}\n","/**\n * @fileoverview SHIM: Force Populate\n * \n * Main boot script that ensures UI population and triggers V2 initialization.\n * Imports core logic from ESM module.\n */\n\nimport { V2Bootstrap } from './v2/bootstrap.js';\nimport { startForcePopulate } from './modules/force-populate.js';\n\n(function () {\n    const scope = typeof window !== 'undefined' ? window : undefined;\n    if (scope) {\n        startForcePopulate(scope, V2Bootstrap);\n    }\n})();\n","export const locale = \"en\";\nexport const data = {\n  \"texts\": {\n    \"appTitle\": \"Cine Power Planner\",\n    \"tagline\": \"Plan your film rig and calculate power consumption & battery life.\",\n    \"printPreview\": {\n      \"title\": \"Print & Export\",\n      \"closeLabel\": \"Close Preview\",\n      \"layoutModeTitle\": \"Layout Mode\",\n      \"layoutRentalLabel\": \"Rental Friendly\",\n      \"layoutRentalDescription\": \"Optimizes layout for rental by grouping items by category.\",\n      \"sectionsTitle\": \"Sections\",\n      \"sectionProject\": \"Production Requirements\",\n      \"sectionDevices\": \"Camera Package Devices\",\n      \"sectionDiagram\": \"Power Diagram\",\n      \"sectionGearList\": \"Kit List\",\n      \"sectionBattery\": \"Battery Comparison\",\n      \"exportPdfButton\": \"Export PDF\",\n      \"printButton\": \"Print\",\n      \"generatedTitle\": \"Overview\",\n      \"generatedProjectNameLabel\": \"Project Name:\",\n      \"generatedProductionLabel\": \"Production:\",\n      \"generatedDateLabel\": \"Date:\",\n      \"generatedNoProjectRequirements\": \"No production requirements data.\",\n      \"generatedDeviceSelectionTitle\": \"Camera Package Devices\",\n      \"generatedNoDevicesSelected\": \"No devices selected.\",\n      \"generatedPowerDiagramTitle\": \"Power Diagram\",\n      \"generatedPowerSummaryTitle\": \"Power Summary\",\n      \"generatedGearListTitle\": \"Kit List\",\n      \"generatedTotalLoad\": \"Total Load\",\n      \"generatedPeak\": \"Peak:\",\n      \"generatedEstRuntime\": \"Est. Runtime\",\n      \"generatedWith\": \"w/\",\n      \"generatedDailyNeeds\": \"Daily Needs\",\n      \"generatedBatts\": \"Batts\",\n      \"generatedFor12hDay\": \"for 12h day\"\n    },\n    \"skipToContent\": \"Skip to content\",\n    \"offlineIndicator\": \"Offline\",\n    \"offlineIndicatorHelp\": \"Appears when the planner is offline or the service worker reports degraded connectivity. All projects, backups and device data stay stored on this device so you can keep working. Force reload and other network actions stay disabled until connectivity recovers.\",\n    \"offlineIndicatorDegraded\": \"Connectivity degraded  working from cached copy.\",\n    \"offlineIndicatorDegradedHelp\": \"The service worker served cached content after a failed probe. Continue working from the offline copy and retry once the banner clears.\",\n    \"offlineIndicatorReasonCacheFallback\": \"Service worker served the cached bundle after a network error.\",\n    \"offlineIndicatorReasonGetFailed\": \"Network request for the reload check failed.\",\n    \"offlineIndicatorReasonTimeout\": \"Connectivity probe timed out before the server responded.\",\n    \"offlineIndicatorReasonUnreachable\": \"The probe could not reach the server.\",\n    \"offlineIndicatorReasonReloadBlocked\": \"Reload is paused until a healthy connection is confirmed.\",\n    \"offlineIndicatorReasonUnknown\": \"Connectivity degraded. Keep working offline until the banner clears.\",\n    \"globalLoadingIndicator\": \"Loading data\",\n    \"globalLoadingIndicatorPreparing\": \"Preparing planner\",\n    \"globalLoadingIndicatorModules\": \"Loading planner interface\",\n    \"globalLoadingIndicatorData\": \"Loading planner data\",\n    \"globalLoadingIndicatorAlmostReady\": \"Almost ready\",\n    \"installBannerText\": \"Install Cine Power Planner on your device for quick access.\",\n    \"installBannerDismiss\": \"Dismiss\",\n    \"installHelpTitleIos\": \"Install Cine Power Planner on iOS\",\n    \"installHelpTitleAndroid\": \"Install Cine Power Planner on Android\",\n    \"installHelpIntroIos\": \"Add the planner to your Home Screen to use it like an app.\",\n    \"installHelpIntroAndroid\": \"Add the planner to your Home Screen to use it like an app.\",\n    \"installHelpStepsIos\": [\n      \"Open Cine Power Planner in Safari.\",\n      \"Tap the Share button.\",\n      \"Choose Add to Home Screen and confirm.\"\n    ],\n    \"installHelpStepsAndroid\": [\n      \"Open Cine Power Planner in Chrome.\",\n      \"Tap the browser menu ().\",\n      \"Choose Add to Home Screen and confirm.\"\n    ],\n    \"installHelpNoteIos\": \"Once installed, launch Cine Power Planner from your Home Screen.\",\n    \"installHelpNoteAndroid\": \"Android keeps using the same storage for the browser and the installed app, so your projects stay available.\",\n    \"installHelpMigrationTitle\": \"Move your existing data into the app\",\n    \"installHelpClose\": \"Close\",\n    \"iosPwaHelpTitle\": \"Keep your data when installing on iOS\",\n    \"iosPwaHelpIntro\": \"Safari keeps the browser tab and the installed app separate. To move your Cine Power Planner data into the app:\",\n    \"iosPwaHelpStep1\": \"Open Cine Power Planner in Safari where your projects are still visible.\",\n    \"iosPwaHelpStep2\": \"Go to Settings  Backup & Restore  Backup to download a copy of your data.\",\n    \"iosPwaHelpStep3\": \"Open Cine Power Planner from your home screen.\",\n    \"iosPwaHelpStep4\": \"Go to Settings  Backup & Restore  Restore and pick the backup file.\",\n    \"iosPwaHelpNote\": \"After restoring once, all changes stay inside the installed app. Keep the backup if you plan to reinstall or switch devices.\",\n    \"iosPwaHelpClose\": \"Got it\",\n    \"impressum\": \"Imprint\",\n    \"privacy\": \"Privacy Policy\",\n    \"setupManageHeading\": \"Project Overview\",\n    \"deviceSelectionHeading\": \"Camera Package\",\n    \"overviewDeviceSelectionHeading\": \"Camera Package Devices\",\n    \"resultsHeading\": \"Power Summary\",\n    \"deviceManagerHeading\": \"Device Library\",\n    \"batteryComparisonHeading\": \"Battery Comparison\",\n    \"batteryComparisonDescription\": \"Review every compatible battery to see runtime estimates for your current setup.\",\n    \"batteryComparisonDescriptionHelp\": \"This table lists every compatible battery and updates as you change your setup. Hover any heading to learn what the numbers represent.\",\n    \"batteryComparisonTableHelp\": \"Rows show compatible batteries. Runtime includes current draw calculations, and the colored bar compares runtime length at a glance.\",\n    \"setupDiagramHeading\": \"Power Diagram\",\n    \"diagramPdfNote\": \"The Power Diagram is not included in the PDF export. Open the print view to review the layout.\",\n    \"projectRequirementsNav\": \"Production Requirements\",\n    \"projectRequirementsNavHelp\": \"Jump to the Production Requirements output once generated.\",\n    \"gearListNav\": \"Kit List\",\n    \"gearListNavHelp\": \"View the generated kit list with all items and categories.\",\n    \"ownGearNav\": \"Own Gear\",\n    \"ownGearNavHelp\": \"Track personal gear you already have on hand and reuse it across projects.\",\n    \"overviewExportTitleSuffix\": \"Kit List and Production Requirements\",\n    \"openSettingsNav\": \"Settings\",\n    \"openSettingsNavHelp\": \"Open Settings to adjust language, themes, accessibility options and backups.\",\n    \"openHelpNav\": \"Help Center\",\n    \"openHelpNavHelp\": \"Open the in-app help guide with tutorials, troubleshooting tips and shortcuts.\",\n    \"setupManageHeadingHelp\": \"Manage saved projects: save, load, or clear configurations.\",\n    \"deviceSelectionHeadingHelp\": \"Choose cameras, monitors, and accessories for your camera package.\",\n    \"resultsHeadingHelp\": \"See power consumption, estimated runtime, and battery counts.\",\n    \"resultsPlainSummaryTitle\": \"Quick summary\",\n    \"resultsPlainSummaryHelp\": \"Explains the power summary in plain language so you can confirm runtime and battery needs without reading every table.\",\n    \"resultsPlainSummaryPrompt\": \"Add devices and choose a battery to see a plain-language summary of runtime and consumption.\",\n    \"resultsPlainSummaryNeedBattery\": \"Choose a battery to see how long the rig will run and how many packs to pack.\",\n    \"resultsPlainSummaryRuntime\": \"With {batteryName}, expect about {hours} hours of runtime. Pack {batteryCount} batteries for a 10-hour day. Your rig currently draws {totalPower} W.\",\n    \"resultsPlainSummaryUnlimited\": \"With {batteryName}, your rig draws {totalPower} W, so runtime stays unlimited. Keep a charged pack connected before recording.\",\n    \"resultsPlainSummaryNote\": \"Pins and D-Tap status updates as you add gear.\",\n    \"resultsPlainSummaryPinsZero\": \"Pins: no 12V draw yet.\",\n    \"resultsPlainSummaryPinsOk\": \"Pins: {current}A within the {max}A limit.\",\n    \"resultsPlainSummaryPinsNear\": \"Pins: {current}A is close to the {max}A limit.\",\n    \"resultsPlainSummaryPinsExceeded\": \"Pins: {current}A exceeds the {max}A limit.\",\n    \"resultsPlainSummaryPinsUnknown\": \"Pins: draw is {current}A but no limit is documented.\",\n    \"resultsPlainSummaryDtapZero\": \"D-Tap: idle.\",\n    \"resultsPlainSummaryDtapOk\": \"D-Tap: {current}A within the {max}A rating.\",\n    \"resultsPlainSummaryDtapNear\": \"D-Tap: {current}A is close to the {max}A rating.\",\n    \"resultsPlainSummaryDtapExceeded\": \"D-Tap: {current}A exceeds the {max}A rating.\",\n    \"resultsPlainSummaryDtapUnavailable\": \"D-Tap: auxiliary port disabled for this battery selection.\",\n    \"resultsPlainSummaryDtapUnavailableBMount\": \"D-Tap: B-Mount cameras disable the aux port.\",\n    \"resultsPlainSummaryDtapUnknown\": \"D-Tap: rating missing, treat {current}A with caution.\",\n    \"resultsPlainSummaryUnnamedBattery\": \"your selected battery\",\n    \"deviceManagerHeadingHelp\": \"Add, edit or remove entries from the device database, including categories, subcategories and attributes.\",\n    \"batteryComparisonHeadingHelp\": \"Compare runtimes for all compatible batteries.\",\n    \"batteryTableBatteryHelp\": \"Battery name and mount that can power your current build.\",\n    \"batteryTableRuntimeHelp\": \"Estimated runtime in hours plus which outputs supply enough current.\",\n    \"batteryTableGraphLabel\": \"Runtime comparison bar\",\n    \"batteryTableGraphHelp\": \"Bar length compares runtime across batteries. Green covers pins and D-Tap, orange means only main pins, and blue marks infinite runtime estimates.\",\n    \"setupDiagramHeadingHelp\": \"View the Power Diagram showing how power, video, and control connect across the rig.\",\n    \"setupDiagramPlaceholder\": \"Select devices to visualize the project.\",\n    \"diagramLegendPower\": \"Power\",\n    \"diagramLegendVideo\": \"Video\",\n    \"diagramLegendFIZ\": \"FIZ\",\n    \"downloadDiagramBtn\": \"Download Power Diagram\",\n    \"gridSnapToggle\": \"Snap to Grid\",\n    \"existingDevicesHeading\": \"Existing Devices\",\n    \"deviceLibrarySearchLabel\": \"Search entire library\",\n    \"deviceLibrarySearchPlaceholder\": \"Search all device categories\",\n    \"deviceLibrarySearchHelp\": \"Filter across every category at once. Press Enter to jump to the closest match.\",\n    \"deviceLibrarySearchStatusDefault\": \"Showing all {total} devices.\",\n    \"deviceLibrarySearchResultOne\": \"Showing {visible} of {total} devices.\",\n    \"deviceLibrarySearchResultOther\": \"Showing {visible} of {total} devices.\",\n    \"deviceLibrarySearchNoResults\": \"No devices match {query}.\",\n    \"darkModeLabel\": \"Toggle dark mode\",\n    \"existingDevicesSubtitle\": \"Browse and manage devices in your library\",\n    \"existingDevicesTitle\": \"Existing Devices\",\n    \"addDeviceSubtitle\": \"Create a custom device entry for your database\",\n    \"addNewDeviceTitle\": \"Add New Device\",\n    \"tabBrowseLibrary\": \"Browse Library\",\n    \"tabAddDevice\": \"Add Device\",\n    \"deviceLibrarySubtitle\": \"Add, edit, and manage devices in your local database\",\n    \"deviceLibraryTitle\": \"Device Library\",\n    \"v2ui\": {\n      \"revision\": \"REV.02\"\n    },\n    \"pinkModeLabel\": \"Toggle pink mode\",\n    \"menuToggleLabel\": \"Menu\",\n    \"menuToggleHelp\": \"Open the sidebar to jump between planner sections or reveal controls on smaller screens. Click again to close it.\",\n    \"sideMenuTitle\": \"Planner sections\",\n    \"sideMenuTitleHelp\": \"Swipe up to explore planner sections and mobile controls. Your project keeps saving automatically while you browse.\",\n    \"sideMenuClose\": \"Close navigation\",\n    \"sideMenuCloseHelp\": \"Close the navigation drawer and return to the planner. Your data stays saved and ready to restore if needed.\",\n    \"sideMenuHelp\": \"Sidebar navigation listing planner sections. Select a section to scroll there and the menu closes automatically.\",\n    \"contacts\": {\n      \"heading\": \"Contacts\",\n      \"description\": \"Save crew members once, keep them stored offline and reuse them for every project.\",\n      \"addContactButton\": \"Add contact\",\n      \"importButton\": \"Import vCard\",\n      \"importHint\": \"Import .vcf files to add contacts instantly. Existing details are preserved automatically.\",\n      \"emptyState\": \"No contacts saved yet. Add your crew to reuse them later.\",\n      \"close\": \"Close\",\n      \"selectLabel\": \"Saved contacts\",\n      \"selectPlaceholder\": \"Select contact\",\n      \"saveContact\": \"Save to contacts\",\n      \"openManager\": \"Open contacts\",\n      \"linkedBadge\": \"Linked to contact\",\n      \"linkedProfileBadge\": \"Linked to user profile\",\n      \"contactMissingDetails\": \"Enter a name, email, phone number or website before saving this contact.\",\n      \"websiteLabel\": \"Website\",\n      \"websitePlaceholder\": \"https://example.com\",\n      \"avatarOptionsTitle\": \"Photo options\",\n      \"avatarOptionsDescription\": \"Preview this photo, choose how to update it, or click outside the window to save and close.\",\n      \"avatarOptionsClose\": \"Close\",\n      \"avatarDelete\": \"Delete photo\",\n      \"avatarEditAction\": \"Edit framing\",\n      \"avatarChange\": \"Change photo\",\n      \"avatarCleared\": \"Profile photo removed.\",\n      \"avatarTooLarge\": \"Choose an image under 300 KB.\",\n      \"avatarReadError\": \"Could not read the selected image.\",\n      \"avatarUpdated\": \"Profile photo updated.\",\n      \"avatarEditInstructions\": \"Drag the photo to adjust the framing.\",\n      \"avatarEditZoomLabel\": \"Zoom\",\n      \"avatarEditCancel\": \"Cancel\",\n      \"avatarEditApply\": \"Apply framing\",\n      \"avatarMissingImage\": \"Add a photo before editing.\",\n      \"avatarEditUnavailable\": \"Photo editor unavailable.\",\n      \"avatarEditFailed\": \"Could not update the photo framing.\",\n      \"userProfileHeading\": \"Your profile\",\n      \"userProfileDescription\": \"Add your name, role, phone and email so your gear shows as User.\",\n      \"userProfileNameLabel\": \"Display name\",\n      \"userProfileNamePlaceholder\": \"Your name\",\n      \"userProfileRoleLabel\": \"Role or title\",\n      \"userProfileRolePlaceholder\": \"Select role\",\n      \"userProfilePhoneLabel\": \"Phone number\",\n      \"userProfilePhonePlaceholder\": \"Your phone number\",\n      \"userProfileEmailLabel\": \"Email address\",\n      \"userProfileEmailPlaceholder\": \"name@example.com\",\n      \"userProfileHint\": \"Used to show your first name and last initial for the User option in the provided by dropdown. Phone and email appear on exports and backups so crews can reach you offline.\",\n      \"userProfileAvatarButton\": \"Change photo\",\n      \"userProfileAvatarRemove\": \"Remove photo\",\n      \"userProfileSaved\": \"Profile saved.\",\n      \"contactDetached\": \"Crew row disconnected from saved contact.\",\n      \"contactApplied\": \"Crew row updated from contact.\",\n      \"contactDeleted\": \"Contact removed. Project rows keep their details.\",\n      \"contactSaved\": \"Contact saved for future projects.\",\n      \"contactUpdated\": \"Contact updated.\",\n      \"contactDraftCreated\": \"New contact ready. Fill in the details.\",\n      \"contactFallbackName\": \"Crew contact\",\n      \"useInProject\": \"Add to project crew\",\n      \"contactAddedToProject\": \"Contact added to the current project.\",\n      \"deleteContact\": \"Delete contact\",\n      \"deleteConfirm\": \"Remove this contact? Project rows will keep their details.\",\n      \"importSummary\": \"{added} added, {updated} updated.\",\n      \"importNone\": \"No new contacts found in the file.\",\n      \"importError\": \"Could not import the selected file.\",\n      \"rolePlaceholder\": \"Select role\"\n    },\n    \"featureSearchPlaceholder\": \"Search features, devices, actions, or help...\",\n    \"featureSearchLabel\": \"Search features, devices, actions, and help\",\n    \"featureSearchHelp\": \"Type to jump to features, devices, quick actions like Save or Backup, or help topics. Suggestions prioritize direct feature and device matches before help topics so navigation lands on controls first. Each entry shows whether it opens a Feature, Action, Device or Help topic so you know what happens before pressing Enter. Exact matches and items you've used recently jump to the top automatically, so your go-to controls stay first. Every suggestion also includes a short description so you can confirm what it will do at a glance. Search also reads the same tooltip and help text shown around controls, so words like \\\"JSON\\\" or \\\"autosave\\\" still land on the right button even if the label differs. Small typos are forgiven too, so \\\"bakcup\\\" still finds Backup or Save. Connector and media abbreviations like \\\"USB-C\\\", \\\"Micro-HDMI\\\", \\\"SDXC\\\", \\\"CFexpress\\\", \\\"V-Mount\\\" or \\\"D-Tap\\\" automatically match their full names, so type whichever version you remember. Exposure and color vocabulary is linked the same wayISO, EI, ASA, exposure index, ND or neutral density, and WB, white balance or color temperature terms all resolve together so any phrasing points to the right controls. Press Enter to navigate, / or Ctrl+K (Cmd+K on Mac) to focus the search from anywhere, use Escape or  to clear the query, and notice how clearing the field floats your most recently used matches to the top for faster repeats. Prefix your query with \\\"feature\\\", \\\"action\\\", \\\"device\\\" or \\\"help\\\" (or your localized equivalents) (for example, \\\"help: battery\\\") to filter suggestions to that type. Start with \\\"recent\\\" or \\\"history\\\" (or your localized equivalents) (for example, \\\"recent iso\\\") to search only items you've used lately before scanning the full catalog. Wrap any phrase in double quotes to force an exact match, so typing \\\"battery health\\\" with quotes jumps ahead of broader matches. Common filler words are ignored automatically, so conversational questions like \\\"how do I back up\\\" still surface the important keywords.\",\n    \"featureSearchFilterAliases\": {\n      \"feature\": [\n        \"feature\",\n        \"features\",\n        \"setting\",\n        \"settings\"\n      ],\n      \"action\": [\n        \"action\",\n        \"actions\",\n        \"command\",\n        \"commands\"\n      ],\n      \"device\": [\n        \"device\",\n        \"devices\",\n        \"gear\",\n        \"equipment\"\n      ],\n      \"help\": [\n        \"help\",\n        \"doc\",\n        \"docs\",\n        \"guide\",\n        \"guides\",\n        \"support\"\n      ],\n      \"recent\": [\n        \"recent\",\n        \"recents\",\n        \"recently\",\n        \"history\",\n        \"histories\",\n        \"frequent\",\n        \"frequently\"\n      ]\n    },\n    \"featureSearchStopWords\": [\n      \"how\",\n      \"do\",\n      \"does\",\n      \"did\",\n      \"done\",\n      \"doing\",\n      \"can\",\n      \"cant\",\n      \"cannot\",\n      \"should\",\n      \"could\",\n      \"would\",\n      \"please\",\n      \"need\",\n      \"needs\",\n      \"needing\",\n      \"want\",\n      \"wants\",\n      \"wanting\",\n      \"i\",\n      \"im\",\n      \"ive\",\n      \"ill\",\n      \"id\",\n      \"we\",\n      \"were\",\n      \"weve\",\n      \"well\",\n      \"you\",\n      \"youre\",\n      \"youve\",\n      \"youll\",\n      \"they\",\n      \"theyre\",\n      \"theyve\",\n      \"them\",\n      \"us\",\n      \"me\",\n      \"my\",\n      \"mine\",\n      \"our\",\n      \"ours\",\n      \"your\",\n      \"yours\",\n      \"their\",\n      \"theirs\",\n      \"the\",\n      \"and\",\n      \"for\",\n      \"with\",\n      \"about\",\n      \"what\",\n      \"where\",\n      \"when\",\n      \"why\",\n      \"which\",\n      \"who\",\n      \"whom\",\n      \"whose\",\n      \"this\",\n      \"that\",\n      \"these\",\n      \"those\",\n      \"also\",\n      \"still\",\n      \"really\",\n      \"very\",\n      \"just\",\n      \"maybe\",\n      \"perhaps\",\n      \"again\"\n    ],\n    \"featureSearchClear\": \"Clear search\",\n    \"featureSearchClearHelp\": \"Clear the search box and show all results again. Press Escape to clear quickly.\",\n    \"featureSearchTypeFeature\": \"Feature\",\n    \"featureSearchTypeAction\": \"Action\",\n    \"featureSearchTypeDevice\": \"Device\",\n    \"featureSearchTypeHelp\": \"Help topic\",\n    \"darkModeHelp\": \"Switch between light and dark themes for comfortable viewing. Press D to toggle. The preference is saved.\",\n    \"pinkModeHelp\": \"Add a playful pink accent theme. The unicorn icon cycles every 30 seconds with a gentle pop animation while pink mode is on, and the setting works with light or dark mode and is remembered for next time.\",\n    \"settingsButton\": \"Settings\",\n    \"settingsButtonHelp\": \"Open Settings to personalize language, colors, fonts, accessibility options and backups.\",\n    \"settingsHeading\": \"Settings\",\n    \"settingsHeadingHelp\": \"Adjust language, themes, typography, accessibility preferences and backups in one place.\",\n    \"settingsSectionsLabel\": \"Settings sections\",\n    \"settingsTabGeneral\": \"General\",\n    \"settingsTabGeneralHelp\": \"Adjust language, theme, typography and branding preferences.\",\n    \"generalSectionLanguageHeading\": \"Language & units\",\n    \"generalSectionAppearanceHeading\": \"Appearance\",\n    \"generalSectionCameraColorsHeading\": \"Camera designations\",\n    \"generalSectionTypographyHeading\": \"Typography\",\n    \"generalSectionBrandingHeading\": \"Branding\",\n    \"documentationTrackerHeading\": \"Documentation update tracker\",\n    \"documentationTrackerDescription\": \"Use this log to mark translation, help and print guide refreshes before distributing offline bundles.\",\n    \"documentationTrackerAddRelease\": \"New release log\",\n    \"documentationTrackerEmpty\": \"No releases tracked yet. Add the upcoming release to start logging updates.\",\n    \"documentationTrackerSummaryIntro\": \"Create release log entries to track translations, help topics, READMEs and print guides until every item is verified.\",\n    \"documentationTrackerLocalesHeading\": \"Localized README coverage\",\n    \"documentationTrackerLocaleEnglish\": \"English README\",\n    \"documentationTrackerLocaleGerman\": \"German README\",\n    \"documentationTrackerLocaleSpanish\": \"Spanish README\",\n    \"documentationTrackerLocaleFrench\": \"French README\",\n    \"documentationTrackerLocaleItalian\": \"Italian README\",\n    \"documentationTrackerHelpHeading\": \"Help center topics\",\n    \"helpGroupEssentials\": \"Essentials\",\n    \"helpGroupGuides\": \"Guides\",\n    \"helpGroupReference\": \"Topic Reference\",\n    \"helpServiceUnavailable\": \"Help service unavailable.\",\n    \"helpSearchNoResultsTitle\": \"No results found\",\n    \"helpSearchNoResultsHint\": \"Try adjusting your search terms.\",\n    \"helpSearchClearLabel\": \"Clear search\",\n    \"helpV2WelcomeTitle\": \"Welcome to V2\",\n    \"helpV2WelcomeKeywords\": \"v2 new interface update overview navigation sidebar\",\n    \"helpV2WelcomeContent\": \"<p>Welcome to the new Cine Power Planner V2 interface! We've redesigned the experience to be faster, more intuitive, and fully responsive.</p>\\n<h4>Key Improvements</h4>\\n<ul>\\n<li><strong>New Sidebar Navigation:</strong> Quickly access Projects, Tools, and Settings from the dedicated sidebar. Mobile users can access this via the menu button in the header.</li>\\n<li><strong>Enhanced Visuals:</strong> A modern, clean look with improved Dark Mode and Pink Mode support.</li>\\n<li><strong>Better Performance:</strong> Faster loading times and smoother transitions between views.</li>\\n</ul>\\n<h4>Getting Around</h4>\\n<p>The sidebar is your main control center:</p>\\n<ul>\\n<li><strong>Projects:</strong> View and manage all your power plans. Filter by Active or Archive.</li>\\n<li><strong>Tools:</strong> Access the Device Library, Contacts, and Auto Gear Rules.</li>\\n<li><strong>Settings:</strong> Configure app preferences, backup data, and manage storage.</li>\\n</ul>\",\n    \"helpV2ProjectsTitle\": \"Managing Projects\",\n    \"helpV2ProjectsKeywords\": \"projects create new delete archive filter active dashboard\",\n    \"helpV2ProjectsContent\": \"<p>The Projects Dashboard is where your work begins.</p>\\n<h4>Creating a Project</h4>\\n<p>Click the <strong>+ New Project</strong> button in the top right to start a fresh plan. You'll be prompted to enter a name and optional details.</p>\\n<h4>Project Status & Filtering</h4>\\n<p>Use the sidebar to filter your projects:</p>\\n<ul>\\n<li><strong>All Projects:</strong> Everything you've created.</li>\\n<li><strong>Active Projects:</strong> Projects you are currently working on.</li>\\n<li><strong>Archive:</strong> Completed or on-hold projects. You can archive a project from its context menu.</li>\\n</ul>\\n<h4>Project Actions</h4>\\n<p>Right-click (or long-press on touch devices) on any project tile to access the context menu:</p>\\n<ul>\\n<li><strong>Rename:</strong> Change the project details.</li>\\n<li><strong>Duplicate:</strong> Create an exact copy of a project.</li>\\n<li><strong>Archive/Unarchive:</strong> Move the project to or from the archive.</li>\\n<li><strong>Delete:</strong> Permanently remove the project.</li>\\n</ul>\",\n    \"helpV2SidebarSearchTitle\": \"Sidebar Search\",\n    \"helpV2SidebarSearchKeywords\": \"search sidebar features devices actions help keyboard offline\",\n    \"helpV2SidebarSearchContent\": \"<p>The sidebar search now runs fully offline and blends features, devices, actions, and help topics into one fast list.</p>\\n<h4>What It Covers</h4>\\n<ul>\\n<li><strong>Features:</strong> Jump straight to inputs, sections, and dialogs.</li>\\n<li><strong>Devices:</strong> Search the local device catalog and open the matching entry.</li>\\n<li><strong>Actions:</strong> Trigger quick commands like Save, Export, or Settings.</li>\\n<li><strong>Help:</strong> Open the most relevant help topic without leaving the planner.</li>\\n</ul>\\n<h4>Keyboard Navigation</h4>\\n<ul>\\n<li><strong>Arrow keys:</strong> Move through suggestions.</li>\\n<li><strong>Enter:</strong> Activate the highlighted result.</li>\\n<li><strong>Esc:</strong> Clear the query and close the list.</li>\\n</ul>\",\n    \"helpV2DeviceLibraryTitle\": \"Device Library\",\n    \"helpV2DeviceLibraryKeywords\": \"devices library equipment custom gear add edit database\",\n    \"helpV2DeviceLibraryContent\": \"<p>The Device Library allows you to manage the equipment available for your power plans.</p>\\n<h4>Browsing Devices</h4>\\n<p>Devices are organized by category (Cameras, Monitors, etc.). Use the tabs or dropdowns to switch between categories. You can also use the search bar to find specific gear instantly.</p>\\n<h4>Adding Custom Gear</h4>\\n<p>Can't find your equipment? Click <strong>Add Device</strong> to create a custom entry. You'll need to specify:</p>\\n<ul>\\n<li><strong>Name:</strong> The model name.</li>\\n<li><strong>Power Draw:</strong> Typical power consumption in Watts (W).</li>\\n<li><strong>Voltage:</strong> Operating voltage range (optional but recommended).</li>\\n</ul>\\n<p>Once added, custom devices are available for all your projects.</p>\",\n    \"helpV2ContactsTitle\": \"Contacts\",\n    \"helpV2ContactsKeywords\": \"contacts people crew rental houses list\",\n    \"helpV2ContactsContent\": \"<p>Keep track of rental houses, crew members, and clients directly in the app.</p>\\n<h4>Managing Contacts</h4>\\n<ul>\\n<li><strong>Add Contact:</strong> Click the <strong>New Contact</strong> button to add details like Name, Role, Phone, and Email.</li>\\n<li><strong>Edit/Delete:</strong> Use the action buttons on each contact card to update or remove information.</li>\\n</ul>\\n<p>Contacts can be assigned to projects for quick reference (coming soon to project details).</p>\",\n    \"helpV2SettingsTitle\": \"Settings & Data\",\n    \"helpV2SettingsKeywords\": \"settings preferences backup restore data storage theme language\",\n    \"helpV2SettingsContent\": \"<p>Customize your experience and keep your data safe.</p>\\n<h4>Data Management</h4>\\n<ul>\\n<li><strong>Backup:</strong> Download a full backup of all your projects and custom devices. We recommend doing this regularly.</li>\\n<li><strong>Restore:</strong> Load a previously saved backup file. <em>Note: This replaces current data.</em></li>\\n<li><strong>Auto-Backups:</strong> Enable automatic snapshots to protect against accidental data loss.</li>\\n</ul>\\n<h4>Preferences</h4>\\n<ul>\\n<li><strong>Units:</strong> Toggle between Metric and Imperial measurements (if applicable).</li>\\n<li><strong>Theme:</strong> Force Dark Mode, Light Mode, or the special Pink Mode.</li>\\n</ul>\",\n    \"helpV2SaveShareBackupTitle\": \"Save, Share & Restore Safety\",\n    \"helpV2SaveShareBackupKeywords\": \"save manual autosave auto backup share export import json restore rehearsal offline safety snapshot\",\n    \"helpV2SaveShareBackupContent\": \"<p>Every save, export, and backup stays on this device so your data remains private and fully offline.</p>\\n<h4>Save Layers</h4>\\n<ul>\\n<li><strong>Manual Save:</strong> Use <strong>Save</strong> in the project header (or <kbd>Ctrl</kbd>/<kbd></kbd>+<kbd>S</kbd>) to commit a named snapshot to your local project library.</li>\\n<li><strong>Autosave:</strong> While you edit, the autosave status in the header updates in the background so the latest changes are always recoverable.</li>\\n<li><strong>Auto Backups:</strong> Each manual save queues a timestamped snapshot. Enable <strong>Show auto backups in project list</strong> in <em>Settings  Backup & Restore</em> to surface them, and note that a safety snapshot is captured before destructive actions.</li>\\n</ul>\\n<h4>Export & Import (JSON)</h4>\\n<ul>\\n<li><strong>Export Project:</strong> In a project, choose <strong>Export Project</strong> to download a JSON share file for offline sharing.</li>\\n<li><strong>Import Project:</strong> From the Projects dashboard, click <strong>Import Project</strong> and select the JSON file. The project opens in the editor; nothing replaces your saved data until you press <strong>Save</strong>.</li>\\n<li><strong>Conflict handling:</strong> If shared Auto Gear rules differ, the import dialog asks whether to apply them just for this project or globally. If a project name already exists, rename before saving to avoid overwriting.</li>\\n</ul>\\n<h4>Full Backup & Restore</h4>\\n<ul>\\n<li><strong>Download Backup:</strong> <em>Settings  Backup & Restore  Download Backup</em> captures projects, devices, rules, and preferences.</li>\\n<li><strong>Download Full Backup:</strong> <em>Settings  Data & Storage  Download Full Backup</em> creates an archival copy for rotation.</li>\\n<li><strong>Restore:</strong> <em>Settings  Backup & Restore  Restore</em> loads a backup file and creates a safety snapshot first so you can roll back.</li>\\n<li><strong>Restore Rehearsal:</strong> Use <strong>Restore Rehearsal</strong> to rehearse a restore in a safe sandbox before committing.</li>\\n</ul>\\n<h4>Offline Integrity Guarantees</h4>\\n<ul>\\n<li><strong>Offline-first:</strong> Saves, exports, backups, and imports never leave this device.</li>\\n<li><strong>Safe-save:</strong> Writes are protected so partial saves never replace good data.</li>\\n<li><strong>Backup-before-delete:</strong> Deleting or resetting data captures a safety snapshot first.</li>\\n</ul>\",\n    \"helpV2AutoGearTitle\": \"Auto Gear Rules\",\n    \"helpV2AutoGearKeywords\": \"auto gear rules automation kit list scenarios production requirements\",\n    \"helpV2AutoGearContent\": \"<p>Automate your kit list generation with smart rules based on production scenarios.</p>\\n<h4>How it Works</h4>\\n<p>Auto Gear Rules monitor your project's <strong>Production Requirements</strong> (e.g., \\\"Handheld\\\", \\\"Studio\\\", \\\"Car Rig\\\") and automatically add or remove specific items from your kit list.</p>\\n<h4>Creating Rules</h4>\\n<p>Go to the <strong>Auto Gear Rules</strong> tool and click <strong>Add Rule</strong>. You can define:</p>\\n<ul>\\n<li><strong>Conditions:</strong> Triggers based on scenarios, camera models, or other gear selections.</li>\\n<li><strong>Actions:</strong> Items to <strong>Add</strong> (e.g., \\\"Shoulder Pad\\\" for \\\"Handheld\\\") or <strong>Remove</strong>.</li>\\n</ul>\\n<h4>Presets</h4>\\n<p>Save your favorite rule sets as <strong>Presets</strong> to quickly switch between different production styles (e.g., \\\"Narrative Feature\\\" vs \\\"Commercial\\\").</p>\",\n    \"helpV2PrintExportTitle\": \"Printing & Exporting\",\n    \"helpV2PrintExportKeywords\": \"print pdf export share report kit list diagram\",\n    \"helpV2PrintExportContent\": \"<p>Share your power plans with your team or rental house.</p>\\n<h4>Project Overview</h4>\\n<p>From the Project Detail view, use the <strong>Print / Export PDF</strong> button to generate a clean summary of your project, including power totals and battery estimates.</p>\\n<h4>Kit List</h4>\\n<p>Generate a dedicated equipment list for quotes and prep. You can filter by department and customize columns before printing.</p>\\n<h4>Power Diagram</h4>\\n<p>Need a visual aid? Export the <strong>Connection Diagram</strong> as an image (PNG/JPG) or SVG to include in your tech pack.</p>\\n<h4>PDF Tips</h4>\\n<p>To save as a PDF, click \\\"Print\\\" and select <strong>\\\"Save as PDF\\\"</strong> as your destination in the print dialog.</p>\",\n    \"helpV2QuickStartTitle\": \"Quick Start Checklist\",\n    \"helpV2QuickStartKeywords\": \"quickstart onboarding tutorial first steps workflow basics getting started new project guide\",\n    \"helpV2QuickStartContent\": \"<p>Welcome to Cine Power Planner! Follow these steps to get your first project ready.</p>\\n<ol>\\n<li>\\n<strong>Start Guided Tutorial:</strong>\\n<button type=\\\"button\\\" class=\\\"button-link help-onboarding-secondary\\\" data-onboarding-tour-trigger=\\\"secondary\\\">Start guided tutorial</button>\\nto walk through every workflow with offline progress tracking.\\n</li>\\n<li>\\n<strong>Name Your Project:</strong>\\nEnter a name in the <em>Project Name</em> field and click <strong>Save</strong> (or press <kbd>Enter</kbd>/<kbd>Ctrl</kbd>+<kbd>S</kbd>) to capture the current rig.\\n</li>\\n<li>\\n<strong>Configure Devices:</strong>\\nWalk through <em>Configure Devices</em>, check the <em>Power Summary</em>, and review the <em>Connection Diagram</em>.\\n</li>\\n<li>\\n<strong>Secure Your Data:</strong>\\nDownload an <strong>Export Project</strong> JSON and a full-app <strong>Backup</strong> so you have two offline recovery copies.\\n</li>\\n<li>\\n<strong>Check Offline Status:</strong>\\nConfirm the offline indicator (in the header) glows before disconnecting.\\n</li>\\n<li>\\n<strong>Rehearse Restore:</strong>\\nOpen <strong>Restore rehearsal</strong> in Settings to verify your backup in a sandbox environment.\\n</li>\\n</ol>\\n<p class=\\\"help-callout-note\\\">\\nTip: Keep backups on separate drives when travelling<strong>Restore</strong> always creates a fresh safety copy so nothing is lost when you undo a change.\\n</p>\",\n    \"helpV2DataSafetyTitle\": \"Data Safety Essentials\",\n    \"helpV2DataSafetyKeywords\": \"backup restore protect save autosave export share import rehearsal offline integrity\",\n    \"helpV2DataSafetyContent\": \"<p>Protect every project with this offline-first safety checklist.</p>\\n<h4>Manual Save, Autosave & Auto-Backups</h4>\\n<ul>\\n<li><strong>Manual Save:</strong> Click <strong>Save</strong> (or press <kbd>Ctrl</kbd>/<kbd></kbd>+<kbd>S</kbd>) to capture an immediate project snapshot.</li>\\n<li><strong>Autosave:</strong> Runs quietly in the background while you edit, keeping rolling snapshots for quick recovery.</li>\\n<li><strong>Auto-backups list:</strong> Enable <strong>Show auto-backups in project list</strong> and adjust <strong>Backup Retention (copies per project)</strong> to control how many snapshots stay visible.</li>\\n</ul>\\n<h4>Project Export / Share (JSON) & Import</h4>\\n<ul>\\n<li><strong>Export Project:</strong> Download a share-ready JSON bundle from the project detail view for offline handoff.</li>\\n<li><strong>Import Project:</strong> Use <strong>Import Project</strong> on the dashboard, choose the JSON, and review the metadata + automatic gear rule options before applying.</li>\\n<li><strong>Conflict handling:</strong> Imports never overwrite your live project until you confirm Save. If a name already exists (or is missing), the planner saves a new -imported project instead.</li>\\n</ul>\\n<h4>Full Backup, Restore & Restore Rehearsal</h4>\\n<ul>\\n<li><strong>Download Backup:</strong> Create a manual full-app snapshot from <strong>Settings  Backup &amp; Restore</strong>.</li>\\n<li><strong>Download Full Backup:</strong> Grab an extra full storage export from <strong>Settings  Data &amp; Storage</strong> when you want redundant media.</li>\\n<li><strong>Restore:</strong> Load a backup file; the planner captures a safety snapshot first. Use <strong>Compare Versions</strong> to review differences.</li>\\n<li><strong>Restore Rehearsal:</strong> Launch a sandbox that compares counts, clears itself automatically, and keeps live data untouched until you choose to restore.</li>\\n</ul>\\n<h4>Offline & Data Integrity Guarantees</h4>\\n<ul>\\n<li><strong>Offline-first:</strong> Saves, exports, imports, and backups all run without a network connection.</li>\\n<li><strong>Safety snapshots:</strong> Restores and <strong>Factory reset</strong> capture a backup before any destructive change.</li>\\n<li><strong>Copy, not delete:</strong> Exports and backups always duplicate datakeep at least two offline copies before removing anything.</li>\\n</ul>\\n<p class=\\\"help-callout-note\\\">Tip: Run <strong>Restore Rehearsal</strong> after major milestones so you can verify the backup while staying fully offline.</p>\",\n    \"helpV2ShortcutsTitle\": \"Essential Shortcuts\",\n    \"helpV2ShortcutsKeywords\": \"keyboard shortcuts hotkeys fast navigation\",\n    \"helpV2ShortcutsContent\": \"<ul>\\n<li><kbd>?</kbd>, <kbd>H</kbd>, <kbd>F1</kbd>: Open Help</li>\\n<li><kbd>Ctrl</kbd>+<kbd>/</kbd> (<kbd></kbd>+<kbd>/</kbd>): Toggle Help</li>\\n<li><kbd>/</kbd> or <kbd>Ctrl</kbd>+<kbd>F</kbd> (<kbd></kbd>+<kbd>F</kbd>): Help Search</li>\\n<li><kbd>Ctrl</kbd>+<kbd>K</kbd> (<kbd></kbd>+<kbd>K</kbd>): Global Feature Search</li>\\n<li><kbd>Ctrl</kbd>+<kbd>,</kbd> (<kbd></kbd>+<kbd>,</kbd>): Open Settings</li>\\n<li><kbd>Ctrl</kbd>+<kbd>S</kbd> (<kbd></kbd>+<kbd>S</kbd>): Save Project</li>\\n<li><kbd>D</kbd>: Toggle Dark Mode</li>\\n<li><kbd>P</kbd>: Toggle Pink Mode</li>\\n</ul>\",\n    \"helpV2FeaturesTitle\": \"Features at a Glance\",\n    \"helpV2FeaturesKeywords\": \"overview capabilities highlights offline favorites search\",\n    \"helpV2FeaturesContent\": \"<ul>\\n<li><strong>Rig Planning:</strong> Configure cameras, monitors, and accessories in <em>Configure Devices</em>.</li>\\n<li><strong>Power Analysis:</strong> Review draw and runtime in <em>Power Summary</em>.</li>\\n<li><strong>Visual Diagram:</strong> Map connections with the interactive <em>Connection Diagram</em>.</li>\\n<li><strong>Battery Comparison:</strong> Compare runtimes and output limits.</li>\\n<li><strong>Device Library:</strong> Customize the database with your own gear.</li>\\n<li><strong>Contacts & Own Gear:</strong> Manage crew info and personal kits.</li>\\n<li><strong>Print & Export:</strong> Generate clean PDF summaries and kit lists.</li>\\n<li><strong>Offline Capable:</strong> Works fully without an internet connection.</li>\\n<li><strong>Customizable:</strong> Adjust themes (Dark, Light, Pink), fonts, and accent colors.</li>\\n</ul>\",\n    \"helpTopics\": {\n      \"projectManagement\": {\n        \"title\": \"Project Management\",\n        \"content\": \"Name projects and press **Save** to capture snapshots in Saved Projects. Saving wont overwrite other projects until you confirm the name. Autosave and auto-backups protect drafts, and Delete removes entries only after a safety snapshot is created.\"\n      },\n      \"saveShareBackup\": {\n        \"title\": \"Save, Share & Backup\",\n        \"content\": \"Use **Export Project** to download a JSON bundle (optionally include automatic gear rules and owned-gear markers). Use **Share Project** to create a share bundle for offline import; recipients open it with **Import Project** and nothing overwrites their current setup until they confirm Save. Use **Backup & Restore** for full-app backups, restore rehearsals, version comparisons, and the local backup vault when automatic downloads are blocked.\"\n      },\n      \"deviceConfiguration\": {\n        \"title\": \"Camera Package\",\n        \"content\": \"Build your camera package by selecting devices. Start with a **Camera**, then add **Monitors**, **Wireless Transmitters**, and **FIZ** systems. Use the Device Library to import or export custom gear so offline edits stay with your projects.\"\n      },\n      \"powerCalculation\": {\n        \"title\": \"Power Calculation\",\n        \"content\": \"The **Power Summary** shows the total power consumption of your rig and estimated runtime based on the selected battery and mount voltages. Watch for **Pin** and **D-Tap** warnings, and use the quick summary to explain results offline.\"\n      },\n      \"connectionDiagram\": {\n        \"title\": \"Power Diagram\",\n        \"content\": \"The **Power Diagram** shows how power, video, and control gear connect. Drag to arrange nodes, zoom and pan to inspect details, and download SVG or JPG snapshots for sharing.\"\n      },\n      \"gearList\": {\n        \"title\": \"Kit List\",\n        \"content\": \"Generate a detailed **Kit List** from camera package devices and production requirements. Edit quantities, providers, temporary extras and owned-gear badges, then print or export it for rental or crew.\"\n      },\n      \"contacts\": {\n        \"title\": \"Contacts\",\n        \"content\": \"Save crew members in **Contacts** or import vCards. Entries reuse across projects and flow into providers, backups and exports.\"\n      },\n      \"ownGear\": {\n        \"title\": \"Own Gear\",\n        \"content\": \"Track your personal inventory in **Own Gear**. Mark items you own so kit list rows can be flagged and exported with those annotations.\"\n      },\n      \"settings\": {\n        \"title\": \"Settings\",\n        \"content\": \"Customize the planner in **Settings**. Adjust **Language**, themes, typography, branding and **Backup & Restore** safeguards, plus automatic gear rules and documentation tracking.\"\n      },\n      \"offlineUse\": {\n        \"title\": \"Offline Use\",\n        \"content\": \"Cine Power Planner works fully **Offline** with locally stored icons, fonts and help content. Verify the offline indicator. Export at least one project and create a full backup before disconnecting. Run a restore rehearsal (or at minimum confirm the latest autosave timestamp in Settings  Data & Storage).\"\n      },\n      \"troubleshooting\": {\n        \"title\": \"Troubleshooting\",\n        \"content\": \"If things aren't working as expected:\\n\\n- **Force reload**: Open the toolbar help/status menu and choose **Force reload** to refresh the app without touching your data.\\n- **Export + Backup**: Before clearing browser cache or site data, **Export Project** and run **Backup & Restore** to capture your project and a full local backup.\\n- **Browser cache/site data**: Only if issues persist, clear your browser cache or site data. **Warning:** clearing site data can delete locally stored projects.\"\n      },\n      \"shortcuts\": {\n        \"title\": \"Keyboard Shortcuts\",\n        \"content\": \"Navigate faster with these keys:\\n\\n- **?**, **H**, **F1**: Open Help\\n- **/**: Focus Search\\n- **Esc**: Close dialogs or menus\\n- **D**: Toggle Dark Mode\"\n      },\n      \"pinkMode\": {\n        \"title\": \"Pink Mode\",\n        \"content\": \"Activate **Pink Mode** in Settings or the top bar to add playful accents and animated icons. The unicorn icon cycles every 30 seconds, and floating stickers drift across the screen. Click any floating sticker **3 times** to trigger a celebratory rain effect.\"\n      }\n    },\n    \"documentationTrackerHelpStart\": \"Start Here & navigation\",\n    \"documentationTrackerHelpSave\": \"Saving, sharing & exports\",\n    \"documentationTrackerHelpBackup\": \"Backup & restore drills\",\n    \"documentationTrackerHelpOwnGear\": \"Own gear & imports\",\n    \"documentationTrackerHelpOffline\": \"Offline readiness & service worker\",\n    \"documentationTrackerHelpPinkMode\": \"Pink mode & animations\",\n    \"documentationTrackerPrintHeading\": \"Printable guides\",\n    \"documentationTrackerPrintChecklist\": \"Documentation update checklist\",\n    \"documentationTrackerPrintMaintenance\": \"Documentation maintenance guide\",\n    \"documentationTrackerPrintSaveShare\": \"Save, share, import, backup & restore reference\",\n    \"documentationTrackerPrintOffline\": \"Offline readiness drill\",\n    \"documentationTrackerReleaseNameLabel\": \"Release name\",\n    \"documentationTrackerReleaseDateLabel\": \"Target release date\",\n    \"documentationTrackerNotesLabel\": \"Verification notes\",\n    \"documentationTrackerNotesPlaceholder\": \"Record what changed, who reviewed it and where the artifacts were stored.\",\n    \"documentationTrackerMarkAllComplete\": \"Mark all complete\",\n    \"documentationTrackerArchiveRelease\": \"Archive release\",\n    \"documentationTrackerRestoreRelease\": \"Reopen release\",\n    \"documentationTrackerArchivedBadge\": \"Archived\",\n    \"documentationTrackerArchiveConfirm\": \"Archive \\\"{name}\\\"? Completed checkmarks stay logged for audits.\",\n    \"documentationTrackerSummaryPending\": \"{remaining} of {total} documentation tasks remain for \\\"{name}\\\".\",\n    \"documentationTrackerSummaryComplete\": \"All {total} documentation tasks for \\\"{name}\\\" are complete.\",\n    \"documentationTrackerFallbackReleaseName\": \"Documentation release\",\n    \"documentationTrackerProgress\": \"{completed}/{total} complete\",\n    \"documentationTrackerSectionProgress\": \"{completed}/{total}\",\n    \"documentationTrackerUpdatedAt\": \"Updated {time}\",\n    \"documentationTrackerTargetSummary\": \"Target {date}\",\n    \"documentationTrackerDefaultReleaseName\": \"Release {date}\",\n\n    \"settingsTabBackup\": \"Backup & Restore\",\n    \"settingsTabData\": \"Data & Storage\",\n    \"settingsTabAbout\": \"About & Support\",\n    \"generalSectionInterfaceHeading\": \"Interface & Accessibility\",\n    \"generalSectionInterfaceHelp\": \"Manage font sizes, high contrast mode and animation preferences.\",\n    \"settingsBackupAutomatedHeading\": \"Automated Backups\",\n    \"settingsBackupManualHeading\": \"Manual Actions\",\n    \"settingsBackupDangerHeading\": \"Danger Zone\",\n    \"settingsDataStorageStatusHeading\": \"Storage Status\",\n    \"settingsDataPersistenceHeading\": \"Persistence & Backup\",\n    \"settingsDataLoggingHeading\": \"Logging\",\n    \"settingsAboutHeading\": \"About & Support\",\n    \"rulesViewTitle\": \"Auto Gear Rules\",\n    \"rulesViewSubtitle\": \"Manage automatic gear additions based on your equipment selection.\",\n    \"buttonAddRule\": \"Add Rule\",\n    \"rulesEmptyTitle\": \"No rules defined\",\n    \"rulesEmptyText\": \"Create your first rule to automate your gear list.\",\n    \"ruleBadgeAlways\": \"Always\",\n    \"ruleTagConditions\": \"Conditions\",\n    \"ruleTagItemsAdded\": \"Items Added\",\n    \"confirmDeleteRule\": \"Are you sure you want to delete this rule?\",\n    \"modalTitleCreateRule\": \"Create Rule\",\n    \"modalTitleEditRule\": \"Edit Rule\",\n    \"tabGeneral\": \"General\",\n    \"tabContext\": \"Context\",\n    \"tabCamera\": \"Camera\",\n    \"tabMonitoring\": \"Monitoring\",\n    \"tabSupport\": \"Support\",\n    \"tabCrew\": \"Crew\",\n    \"tabActions\": \"Actions\",\n    \"labelRuleName\": \"Rule Name\",\n    \"labelRuleEnabled\": \"Rule Enabled\",\n    \"labelRuleAlways\": \"Always Apply\",\n    \"helpRuleAlways\": \"Overrides all other conditions.\",\n    \"placeholderRuleName\": \"e.g. Add Batteries for Monitor\",\n    \"sectionScenarios\": \"Scenarios\",\n    \"sectionCameraModels\": \"Camera Models\",\n    \"sectionMatteboxes\": \"Matteboxes\",\n    \"sectionViewfinders\": \"Viewfinders / Top Handles (Extensions)\",\n    \"sectionMonitors\": \"Monitors\",\n    \"sectionWireless\": \"Wireless\",\n    \"sectionTripodHeads\": \"Tripod Heads\",\n    \"sectionBowlSize\": \"Bowl Size\",\n    \"sectionLegTypes\": \"Leg Types\",\n    \"sectionSpreaders\": \"Spreaders\",\n    \"sectionCrewPresent\": \"Crew Present\",\n    \"sectionCrewAbsent\": \"Crew Absent\",\n    \"sectionItemsToAdd\": \"Items to Add\",\n    \"sectionItemsToRemove\": \"Items to Remove\",\n    \"buttonAddItem\": \"+ Add Item\",\n    \"labelItemName\": \"Item Name\",\n    \"placeholderItemSearch\": \"Search...\",\n    \"labelCategory\": \"Category\",\n    \"labelQty\": \"Qty\",\n    \"buttonAdd\": \"Add\",\n    \"textNoOptions\": \"No options available.\",\n    \"textNoItems\": \"No items defined.\",\n    \"buttonSaveRule\": \"Save Rule\",\n    \"buttonCancel\": \"Cancel\",\n    \"buttonEdit\": \"Edit\",\n    \"buttonDelete\": \"Delete\",\n    \"alertEnterRuleName\": \"Please enter a rule name.\",\n    \"contactsViewTitle\": \"Contacts\",\n    \"contactsViewSubtitle\": \"Manage your crew and vendor contacts.\",\n    \"buttonAddContact\": \"Add Contact\",\n    \"buttonAddFirstContact\": \"+ Add First Contact\",\n    \"contactsEmptyTitle\": \"No contacts found\",\n    \"contactsEmptyText\": \"Add people and companies to your contact list to quickly assign them to projects.\",\n    \"linkWebsite\": \"Website\",\n    \"contactUnnamed\": \"Unnamed Contact\",\n    \"contactNoRole\": \"No Role\",\n    \"modalTitleDeleteContact\": \"Delete Contact\",\n    \"confirmDeleteContact\": \"Are you sure you want to delete this contact? This action cannot be undone.\",\n    \"buttonDeleteRed\": \"Delete\",\n    \"modalTitleNewContact\": \"New Contact\",\n    \"modalTitleEditContact\": \"Edit Contact\",\n    \"buttonUploadPhoto\": \"Upload Photo\",\n    \"buttonRemovePhoto\": \"Remove\",\n    \"labelName\": \"Name\",\n    \"labelRole\": \"Role\",\n    \"labelPhone\": \"Phone\",\n    \"labelEmail\": \"Email\",\n    \"labelWebsite\": \"Website / Link\",\n    \"labelNotes\": \"Notes\",\n    \"placeholderFullName\": \"Full Name\",\n    \"placeholderRole\": \"e.g. 1st AC\",\n    \"placeholderPhone\": \"+1 234 567 890\",\n    \"placeholderEmail\": \"email@example.com\",\n    \"placeholderWebsite\": \"https://...\",\n    \"placeholderNotes\": \"Additional details...\",\n    \"buttonSaveContact\": \"Save Contact\",\n    \"alertEnterName\": \"Please enter a name.\",\n    \"ownGearViewTitle\": \"Owned Gear\",\n    \"ownGearViewSubtitle\": \"Manage your personal equipment inventory.\",\n    \"buttonAddGearItem\": \"Add Item\",\n    \"buttonAddFirstGearItem\": \"+ Add First Item\",\n    \"ownGearEmptyTitle\": \"No gear found\",\n    \"ownGearEmptyText\": \"Add items to your personal inventory to quickly add them to projects.\",\n    \"labelQtyPrefix\": \"Qty: \",\n    \"labelSourcePrefix\": \"Source: \",\n    \"confirmDeleteGearItem\": \"Are you sure you want to delete this item?\",\n    \"modalTitleNewGearItem\": \"New Gear Item\",\n    \"modalTitleEditGearItem\": \"Edit Gear Item\",\n    \"placeholderGearName\": \"e.g. Arri Alexa Mini\",\n    \"placeholderGearQty\": \"1\",\n    \"placeholderGearNotes\": \"Condition, serial number, etc...\",\n    \"buttonSaveGearItem\": \"Save Item\",\n    \"alertInvalidItemData\": \"Invalid item data.\",\n    \"alertSaveItemFailed\": \"Failed to save item.\",\n    \"labelQuantity\": \"Quantity\",\n    \"buttonDownloadBackup\": \"Download Backup\",\n    \"buttonDownloadFullBackup\": \"Download Full Backup\",\n    \"buttonRestore\": \"Restore\",\n    \"buttonRestoreRehearsal\": \"Restore Rehearsal\",\n    \"buttonFactoryReset\": \"Factory Reset\",\n    \"buttonCompareVersions\": \"Compare Versions\",\n    \"buttonReset\": \"Reset\",\n    \"buttonUploadSvg\": \"Upload SVG\",\n    \"buttonClose\": \"Close\",\n    \"buttonExportLog\": \"Export Log\",\n    \"buttonChooseFile\": \"Choose File\",\n    \"buttonSupport\": \"Support\",\n    \"buttonReportBug\": \"Report Bug\",\n    \"buttonSuggestFeature\": \"Suggest Feature\",\n    \"buttonRequestPersistence\": \"Request Persistent Storage\",\n    \"labelBackupRetention\": \"Backup Retention (copies per project)\",\n    \"labelBaselineVersion\": \"Baseline Version\",\n    \"labelComparisonVersion\": \"Comparison Version\",\n    \"labelIncidentNotes\": \"Incident Notes\",\n    \"labelSelectFile\": \"Select File\",\n    \"labelNoFileSelected\": \"No file selected\",\n    \"labelLatestProjectSave\": \"Latest Project Save\",\n    \"labelLatestAutoBackup\": \"Latest Auto Backup\",\n    \"labelLatestFullBackup\": \"Latest Full Backup\",\n    \"tableHeaderData\": \"Data\",\n    \"tableHeaderDifference\": \"Difference\",\n    \"labelLogLevel\": \"Log Level\",\n    \"labelHistoryLimit\": \"History Limit\",\n    \"labelNamespaceFilter\": \"Namespace Filter\",\n    \"placeholderIncidentNotes\": \"Context for this comparison...\",\n    \"checkboxAutoBackupList\": \"Show auto-backups in project list\",\n    \"checkboxHighContrast\": \"High Contrast Elements\",\n    \"checkboxReduceMotion\": \"Reduce Motion\",\n    \"checkboxRelaxedSpacing\": \"Relaxed Spacing\",\n    \"checkboxMirrorConsole\": \"Mirror to Console\",\n    \"checkboxCaptureConsole\": \"Capture Console Output\",\n    \"checkboxCaptureGlobalErrors\": \"Capture Global Errors\",\n    \"checkboxPersistSession\": \"Persist Session Between Reloads\",\n    \"brandingNoLogo\": \"No custom logo set\",\n    \"documentationTrackerEmptyShort\": \"No releases tracked.\",\n    \"settingsFactoryResetHelp\": \"Reset the application to its initial state. All data will be deleted.\",\n    \"backupDiffModalTitle\": \"Version Comparison\",\n    \"backupDiffModalSubtitle\": \"Pick two manual saves or automatic backups to inspect changes.\",\n    \"backupDiffEmptyState\": \"Select versions to see differences.\",\n    \"rehearsalModalSubtitle\": \"Load a backup into a disposable workspace to verify it before running a full restore.\",\n    \"rehearsalModalSourceLabel\": \"Choose a rehearsal source\",\n    \"rehearsalModalSourceBackup\": \"Full app backup (.json)\",\n    \"rehearsalModalSourceProject\": \"Project bundle (.json)\",\n    \"textManageLocalData\": \"Manage your local data.\",\n    \"textRequestPersistence\": \"Request persistent storage verification to prevent browser eviction.\",\n    \"statusCheckingPersistence\": \"Checking storage protection...\",\n    \"textNoLogEntries\": \"No log entries.\",\n    \"optionLogLevelAll\": \"All levels\",\n    \"optionLogLevelInfo\": \"Info and above\",\n    \"optionLogLevelWarn\": \"Warnings and errors\",\n    \"optionLogLevelError\": \"Errors only\",\n    \"appCreator\": \"Created by Luca Zanner\",\n    \"languageSetting\": \"Language\",\n    \"settingsLanguageHelp\": \"Choose the interface language. Changes apply immediately and are remembered for next time.\",\n    \"darkModeSetting\": \"Dark mode\",\n    \"settingsDarkModeHelp\": \"Switch between light and dark themes from any control. The onboarding selector, top-bar toggle and Settings checkbox stay synchronized instantly.\",\n    \"pinkModeSetting\": \"Pink mode\",\n    \"settingsPinkModeHelp\": \"Enable the playful pink accent theme from Settings.\",\n    \"accentColorSetting\": \"Accent color\",\n    \"accentColorHelp\": \"Pick the accent color used for buttons, highlights and diagrams. The choice is saved with your settings.\",\n    \"cameraColorSettingDescription\": \"Assign a highlight color to each camera letter so linked gear stays coordinated across your lists.\",\n    \"cameraColorInputHelp\": \"Choose the highlight color for camera %s.\",\n    \"cameraColorALabel\": \"Camera A color\",\n    \"cameraColorBLabel\": \"Camera B color\",\n    \"cameraColorCLabel\": \"Camera C color\",\n    \"cameraColorDLabel\": \"Camera D color\",\n    \"cameraColorELabel\": \"Camera E color\",\n    \"accentColorReset\": \"Reset to default\",\n    \"accentColorResetHelp\": \"Revert the accent color to the original theme color while keeping other preferences intact.\",\n    \"temperatureUnitSetting\": \"Temperature unit\",\n    \"temperatureUnitSettingHelp\": \"Choose whether temperatures are shown in Celsius or Fahrenheit throughout the app.\",\n    \"focusScaleSetting\": \"Focus scale\",\n    \"focusScaleSettingHelp\": \"Choose the measurement markings displayed for focus scales in lens notes and overviews.\",\n    \"focusScaleMetric\": \"Metric\",\n    \"focusScaleImperial\": \"Imperial\",\n    \"mountVoltageSettingsHeading\": \"Battery mount voltages\",\n    \"mountVoltageSettingsHelp\": \"Adjust the voltages used for current draw calculations across B-Mount, V-Mount and Gold Mount setups.\",\n    \"mountVoltageDescription\": \"Set the default high and low voltages for each battery mount so the planner matches your hardware.\",\n    \"mountVoltageReset\": \"Restore defaults\",\n    \"mountVoltageResetHelp\": \"Reset all mount voltages to their factory defaults.\",\n    \"mountVoltageHighLabel\": \"High-voltage output\",\n    \"mountVoltageLowLabel\": \"Low-voltage output\",\n    \"mountVoltageHighHelp\": \"Used to calculate total current at the battery's main output such as the high-voltage pins.\",\n    \"mountVoltageLowHelp\": \"Used to calculate total current at auxiliary outputs such as D-Tap ports or B-Mount low-voltage pins.\",\n    \"mountVoltageNote\": \"These voltages update the totals in the power summary, runtime estimates and pin warnings.\",\n    \"mountVoltageCardLabelV\": \"V-Mount\",\n    \"mountVoltageCardLabelGold\": \"Gold Mount\",\n    \"mountVoltageCardLabelB\": \"B-Mount\",\n    \"totalCurrentHighLabelTemplate\": \"Total Current (at {voltage}V):\",\n    \"totalCurrentLowLabelTemplate\": \"Total Current (at {voltage}V):\",\n    \"totalCurrentHighHelpTemplate\": \"Current draw at the battery's main output ({voltage}V).\",\n    \"totalCurrentLowHelpTemplate\": \"Current draw at auxiliary outputs ({voltage}V).\",\n    \"temperatureUnitCelsius\": \"Celsius (C)\",\n    \"temperatureUnitFahrenheit\": \"Fahrenheit (F)\",\n    \"temperatureUnitSymbolCelsius\": \"C\",\n    \"temperatureUnitSymbolFahrenheit\": \"F\",\n    \"fontSizeSetting\": \"Font size\",\n    \"fontSizeSettingHelp\": \"Set the base interface font size to improve readability or fit more information on screen.\",\n    \"fontFamilySetting\": \"Font\",\n    \"fontFamilySettingHelp\": \"Select the typeface used throughout the planner. Added local fonts appear in this menu.\",\n    \"bundledFontsGroup\": \"Bundled fonts\",\n    \"localFontsGroup\": \"Local fonts\",\n    \"localFontsButton\": \"Add local font\",\n    \"localFontsButtonHelp\": \"Allow the planner to use installable fonts from this device when your browser supports it.\",\n    \"localFontsUnsupported\": \"Local fonts aren't supported in this browser.\",\n    \"localFontsFileFallback\": \"Your browser can't list installed fonts automatically. Upload font files instead.\",\n    \"localFontsAdded\": \"Added: %s\",\n    \"localFontsAlreadyAdded\": \"Already added: %s\",\n    \"localFontsNoFonts\": \"No fonts were selected.\",\n    \"localFontsError\": \"Could not access local fonts.\",\n    \"localFontsPermissionNeeded\": \"Access to installed fonts was denied. Upload font files instead.\",\n    \"localFontsUnsupportedFiles\": \"Some files weren't recognized as fonts: %s.\",\n    \"localFontsSaveError\": \"Font added for this session but couldn't be saved for offline use.\",\n    \"logoSetting\": \"Logo (SVG)\",\n    \"logoSettingHelp\": \"Upload an SVG logo to brand printable overviews and include it in backups.\",\n    \"logoFormatError\": \"Unsupported logo format. Please choose an SVG file.\",\n    \"autoGearHeading\": \"Automatic Gear Rules\",\n    \"autoGearHeadingHelp\": \"Adjust which Production Requirements scenarios automatically add or remove kit items.\",\n    \"autoGearDescription\": \"Create scenario-based rules that tweak the generated kit list. Rules apply after the default planner suggestions.\",\n    \"autoGearPresetDescription\": \"Save and reuse complete sets of automatic gear rules.\",\n    \"autoGearPresetLabel\": \"Preset\",\n    \"autoGearPresetPlaceholder\": \"Custom rules\",\n    \"autoGearAutoPresetLabel\": \"Autosaved rules\",\n    \"autoGearSavePresetButton\": \"Save preset\",\n    \"autoGearDeletePresetButton\": \"Delete preset\",\n    \"autoGearPresetNamePrompt\": \"Name this preset\",\n    \"autoGearPresetNameRequired\": \"Enter a preset name to continue.\",\n    \"autoGearPresetOverwriteConfirm\": \"Replace the existing preset %s?\",\n    \"autoGearPresetApplyConfirm\": \"Replace your automatic gear rules with the preset %s?\",\n    \"autoGearPresetSaved\": \"Automatic gear preset saved.\",\n    \"autoGearPresetDeleted\": \"Automatic gear preset deleted.\",\n    \"autoGearPresetApplied\": \"Preset applied.\",\n    \"autoGearPresetExportSuccess\": \"Automatic gear presets downloaded.\",\n    \"autoGearPresetExportError\": \"Automatic gear preset export failed.\",\n    \"autoGearAddRule\": \"Add rule\",\n    \"autoGearNoRules\": \"No custom rules yet.\",\n    \"autoGearNoMatches\": \"No rules match your filters.\",\n    \"autoGearNoFocusMatches\": \"No rules match the selected dashboard filter.\",\n    \"autoGearSummaryHeading\": \"Rule coverage overview\",\n    \"autoGearSummaryDescription\": \"Review automatic gear rules for duplicate triggers, conflicts, stacked scenarios and uncovered coverage.\",\n    \"autoGearSummaryEmpty\": \"Add a rule to unlock coverage insights.\",\n    \"autoGearSummaryTotalLabel\": \"Rules tracked\",\n    \"autoGearSummaryTotalDescription\": \"Rules currently saved in this setup.\",\n    \"autoGearSummaryCoverageLabel\": \"Scenario coverage\",\n    \"autoGearSummaryCoverageDescription\": \"{covered} of {total} scenarios covered\",\n    \"autoGearSummaryCoverageEmpty\": \"Add scenarios to measure coverage.\",\n    \"autoGearSummaryNetLabel\": \"Net change\",\n    \"autoGearSummaryNetDescription\": \"Adds {adds}  Removes {removes}\",\n    \"autoGearSummaryDuplicatesLabel\": \"Duplicated triggers\",\n    \"autoGearSummaryDuplicatesSome\": \"{rules} across {groups} groups\",\n    \"autoGearSummaryDuplicatesNone\": \"No duplicate triggers.\",\n    \"autoGearSummaryConflictsLabel\": \"Potential conflicts\",\n    \"autoGearSummaryConflictsSome\": \"{rules} affected across {items} items\",\n    \"autoGearSummaryConflictsNone\": \"No conflicting adds/removes.\",\n    \"autoGearSummaryOverlapsLabel\": \"Stacked scenarios\",\n    \"autoGearSummaryOverlapsSome\": \"{count} scenarios touched by multiple rules\",\n    \"autoGearSummaryOverlapsNone\": \"No scenarios currently stack multiple rules.\",\n    \"autoGearSummaryUncoveredLabel\": \"Uncovered scenarios\",\n    \"autoGearSummaryUncoveredSome\": \"Review {count} scenario gaps\",\n    \"autoGearSummaryUncoveredNone\": \"All required scenarios covered.\",\n    \"autoGearSummaryDetailsIntro\": \"Focus cards to inspect coverage percentages, stacked scenarios, duplicates and conflicts before exporting or printing.\",\n    \"autoGearSummaryDetailsDuplicatesHeading\": \"Duplicated triggers\",\n    \"autoGearSummaryDuplicateGroupTitle\": \"Matching triggers\",\n    \"autoGearSummaryDetailsConflictsHeading\": \"Potential conflicts\",\n    \"autoGearSummaryConflictAddsLabel\": \"Adds\",\n    \"autoGearSummaryConflictRemovesLabel\": \"Removes\",\n    \"autoGearSummaryDetailsOverlapsHeading\": \"Scenarios with stacked rules\",\n    \"autoGearSummaryDetailsOverlapsNone\": \"No scenarios currently stack multiple rules.\",\n    \"autoGearSummaryDetailsUncoveredHeading\": \"Uncovered scenarios\",\n    \"autoGearSummaryResetFocus\": \"Clear dashboard filter\",\n    \"autoGearSummaryDetailsFocusEmpty\": \"No coverage details match the current focus.\",\n    \"autoGearSummaryJumpToRule\": \"Jump to rule\",\n    \"autoGearSummarySetScenarioFilter\": \"Filter to scenario {scenario}\",\n    \"autoGearSummaryRuleReference\": \"Rule {position}: {label}\",\n    \"autoGearSummaryRuleReferenceUntitled\": \"Rule {position}\",\n    \"autoGearSummaryFilteredDescription\": \"Showing {visible} of {total} rules after filters.\",\n    \"autoGearSearchLabel\": \"Search rules\",\n    \"autoGearSearchHelp\": \"Filter automatic gear rules by name, scenario or items. Results update instantly as you type.\",\n    \"autoGearSearchPlaceholder\": \"Search by name, scenario or item\",\n    \"autoGearFilterScenarioLabel\": \"Filter by scenario\",\n    \"autoGearFilterScenarioHelp\": \"Show only rules that require a specific scenario.\",\n    \"autoGearFilterScenarioAny\": \"All scenarios\",\n    \"autoGearFilterClear\": \"Clear filters\",\n    \"autoGearRuleNameLabel\": \"Rule name\",\n    \"autoGearRuleNameHelp\": \"Optional label displayed in the rules list.\",\n    \"autoGearConditionSelectLabel\": \"Add a condition\",\n    \"autoGearConditionSelectHelp\": \"Reveal the selectors you want to use as rule conditions.\",\n    \"autoGearAddCondition\": \"Add condition\",\n    \"autoGearConditionPlaceholder\": \"Choose a condition\",\n    \"autoGearConditionAddShortcut\": \"Add another condition\",\n    \"autoGearConditionRemove\": \"Remove this condition\",\n    \"autoGearConditionLogicLabel\": \"Match behavior\",\n    \"autoGearConditionLogicHelp\": \"Choose how the selected values interact before the rule activates.\",\n    \"autoGearConditionLogicAll\": \"Require every selected value\",\n    \"autoGearConditionLogicAny\": \"Match any selected value\",\n    \"autoGearConditionLogicOr\": \"Start a new OR group (matches any selected value)\",\n    \"autoGearConditionLogicNone\": \"Require none of the selected values\",\n    \"autoGearConditionLogicMultiplier\": \"Multiply by matched values\",\n    \"autoGearConditionRepeatHint\": \"Condition already added. Existing inputs for {condition} are highlighted so you can add more selections.\",\n    \"autoGearAlwaysLabel\": \"Always include\",\n    \"autoGearAlwaysHelp\": \"Apply this rule to every kit list.\",\n    \"autoGearAlwaysMeta\": \"Always active\",\n    \"autoGearScenariosLabel\": \"Required scenarios\",\n    \"autoGearScenariosHelp\": \"Pick every scenario that must be selected for this rule to apply. Hold Ctrl (Cmd on Mac) to choose multiple.\",\n    \"autoGearScenarioPlaceholder\": \"Select scenarios\",\n    \"autoGearScenarioModeLabel\": \"Scenario matching\",\n    \"autoGearScenarioModeHelp\": \"Choose how the selected scenarios interact before the rule activates.\",\n    \"autoGearScenarioModeAll\": \"Require every selected scenario\",\n    \"autoGearScenarioModeAny\": \"Match any selected scenario\",\n    \"autoGearScenarioModeMultiplier\": \"Multiply when combined\",\n    \"autoGearScenarioBaseLabel\": \"Base scenario\",\n    \"autoGearScenarioBaseHelp\": \"Items always add when this scenario is active.\",\n    \"autoGearScenarioBasePlaceholder\": \"Select a base scenario\",\n    \"autoGearScenarioFactorLabel\": \"Multiplier factor\",\n    \"autoGearScenarioFactorHelp\": \"Scale item quantities when every additional scenario is active.\",\n    \"autoGearShootingDaysLabel\": \"Shooting days condition\",\n    \"autoGearShootingDaysHelp\": \"Activate this rule when the shooting schedule meets your chosen minimum or maximum, or repeat the gear for each block of days.\",\n    \"autoGearShootingDaysModeMinimum\": \"Minimum\",\n    \"autoGearShootingDaysModeMaximum\": \"Maximum\",\n    \"autoGearShootingDaysModeEvery\": \"Every\",\n    \"autoGearShootingDaysValueLabel\": \"Shooting days value\",\n    \"autoGearMatteboxLabel\": \"Mattebox options\",\n    \"autoGearMatteboxHelp\": \"Apply this rule when these mattebox choices are selected. Clamp-on rules automatically add the matching backing sizes for the selected lens fronts.\",\n    \"autoGearMatteboxPlaceholder\": \"Select mattebox options\",\n    \"autoGearCameraHandleLabel\": \"Camera handles\",\n    \"autoGearCameraHandleHelp\": \"Apply this rule when these camera handle options are selected.\",\n    \"autoGearCameraHandlePlaceholder\": \"Select camera handles\",\n    \"autoGearViewfinderExtensionLabel\": \"Viewfinder extension\",\n    \"autoGearViewfinderExtensionHelp\": \"Apply this rule when these viewfinder extension choices are selected.\",\n    \"autoGearViewfinderExtensionPlaceholder\": \"Select viewfinder extension options\",\n    \"autoGearDeliveryResolutionLabel\": \"Delivery resolution\",\n    \"autoGearDeliveryResolutionHelp\": \"Apply this rule when these delivery resolutions are selected.\",\n    \"autoGearDeliveryResolutionPlaceholder\": \"Select delivery resolutions\",\n    \"autoGearVideoDistributionLabel\": \"Video distribution\",\n    \"autoGearVideoDistributionHelp\": \"Apply this rule when these video distribution preferences are selected.\",\n    \"autoGearVideoDistributionPlaceholder\": \"Select video distribution options\",\n    \"autoGearTripodHeadBrandLabel\": \"Tripod head brand\",\n    \"autoGearTripodHeadBrandHelp\": \"Apply this rule when the tripod head preferences include these brands.\",\n    \"autoGearTripodHeadBrandPlaceholder\": \"Select tripod head brands\",\n    \"autoGearTripodBowlLabel\": \"Tripod bowl size\",\n    \"autoGearTripodBowlHelp\": \"Apply this rule when the tripod head preferences include these bowl sizes.\",\n    \"autoGearTripodBowlPlaceholder\": \"Select tripod bowl sizes\",\n    \"autoGearTripodTypesLabel\": \"Tripod types\",\n    \"autoGearTripodTypesHelp\": \"Apply this rule when the tripod preferences include these tripod types.\",\n    \"autoGearTripodTypesPlaceholder\": \"Select tripod types\",\n    \"autoGearTripodSpreaderLabel\": \"Tripod spreader\",\n    \"autoGearTripodSpreaderHelp\": \"Apply this rule when the tripod preferences include these spreader options.\",\n    \"autoGearTripodSpreaderPlaceholder\": \"Select tripod spreaders\",\n    \"autoGearVideoDistributionNone\": \"No video distribution selected\",\n    \"autoGearCameraLabel\": \"Camera selection\",\n    \"autoGearCameraHelp\": \"Apply this rule when these camera bodies are selected.\",\n    \"autoGearCameraWeightLabel\": \"Camera weight\",\n    \"autoGearCameraWeightHelp\": \"Compare the selected camera's weight to the threshold before triggering this rule.\",\n    \"autoGearCameraWeightOperatorLabel\": \"Weight comparison\",\n    \"autoGearCameraWeightOperatorGreater\": \"Heavier than\",\n    \"autoGearCameraWeightOperatorLess\": \"Lighter than\",\n    \"autoGearCameraWeightOperatorEqual\": \"Exactly\",\n    \"autoGearCameraWeightValueLabel\": \"Weight threshold (grams)\",\n    \"autoGearCameraWeightValueRequired\": \"Enter a camera weight threshold before saving.\",\n    \"autoGearMonitorLabel\": \"Onboard monitors\",\n    \"autoGearMonitorDefaultsHeading\": \"Monitor defaults\",\n    \"autoGearMonitorDefaultsDescription\": \"Choose which monitors should be preselected for new kit lists.\",\n    \"autoGearDefaultFocusMonitorLabel\": \"Focus monitor\",\n    \"autoGearDefaultHandheldMonitorLabel\": \"7\\\" handheld monitor\",\n    \"autoGearDefaultComboMonitorLabel\": \"Combo monitor 15-21\\\"\",\n    \"autoGearDefaultDirectorMonitorLabel\": \"Director monitor 15-21\\\"\",\n    \"autoGearMonitorDefaultPlaceholder\": \"Use recommended automatically\",\n    \"autoGearMonitorHelp\": \"Apply this rule when these onboard monitors are selected.\",\n    \"autoGearCrewPresentLabel\": \"Crew present\",\n    \"autoGearCrewPresentHelp\": \"Apply this rule when these crew roles are listed on the project.\",\n    \"autoGearCrewAbsentLabel\": \"Crew absent\",\n    \"autoGearCrewAbsentHelp\": \"Apply this rule when these crew roles are not listed on the project.\",\n    \"autoGearWirelessLabel\": \"Wireless transmitters\",\n    \"autoGearWirelessHelp\": \"Apply this rule when these wireless transmitters are selected.\",\n    \"autoGearMotorsLabel\": \"FIZ motors\",\n    \"autoGearMotorsAny\": \"Any motor selected\",\n    \"autoGearMotorsHelp\": \"Apply this rule when these FIZ motors are selected.\",\n    \"autoGearControllersLabel\": \"FIZ controllers\",\n    \"autoGearControllersHelp\": \"Apply this rule when these FIZ controllers are selected.\",\n    \"autoGearDistanceLabel\": \"FIZ distance devices\",\n    \"autoGearDistanceHelp\": \"Apply this rule when these distance devices are selected.\",\n    \"autoGearRuleConditionRequired\": \"Select at least one scenario, camera, monitor, wireless transmitter, motor, controller, distance device, mattebox option, camera handle, viewfinder extension or video distribution before saving.\",\n    \"autoGearAddItemsHeading\": \"Add these items\",\n    \"autoGearOwnGearLabel\": \"Own gear item\",\n    \"autoGearOwnGearHelp\": \"Select an item you own to link this rule to your inventory.\",\n    \"autoGearConditionOwnGearLabel\": \"Own gear\",\n    \"autoGearConditionOwnGearHelp\": \"Apply this rule when these items are saved in your own gear list.\",\n    \"autoGearOwnGearMissing\": \"Removed own gear\",\n    \"autoGearOwnGearPlaceholder\": \"Manual entry\",\n    \"autoGearOwnGearBadge\": \"Own gear\",\n    \"autoGearAddItemLabel\": \"Item\",\n    \"autoGearAddCategoryLabel\": \"Category\",\n    \"autoGearAddQuantityLabel\": \"Qty\",\n    \"autoGearAddItemButton\": \"Add item\",\n    \"autoGearUpdateItemButton\": \"Save item\",\n    \"autoGearAddMultipleHint\": \"Separate multiple items with semicolons.\",\n    \"autoGearRemoveItemsHeading\": \"Remove these items\",\n    \"autoGearRemoveItemLabel\": \"Item\",\n    \"autoGearRemoveCategoryLabel\": \"Category\",\n    \"autoGearRemoveQuantityLabel\": \"Qty\",\n    \"autoGearRemoveItemButton\": \"Add removal\",\n    \"autoGearRemoveMultipleHint\": \"Separate multiple items with semicolons.\",\n    \"autoGearSaveRule\": \"Save rule\",\n    \"autoGearRuleSaved\": \"Automatic gear rule saved.\",\n    \"autoGearCancelEdit\": \"Cancel\",\n    \"autoGearResetFactoryButton\": \"Reset to factory additions\",\n    \"autoGearResetFactoryHelp\": \"Restore the automatic gear rules generated from the planner's default scenarios. Your current presets download before anything changes.\",\n    \"autoGearResetFactoryConfirm\": \"Replace your automatic gear rules with the default additions?\",\n    \"autoGearResetFactoryDone\": \"Automatic gear rules restored to factory additions.\",\n    \"autoGearResetFactoryEmpty\": \"Factory additions unavailable. Automatic gear rules cleared.\",\n    \"autoGearResetFactoryError\": \"Reset failed. Please try again.\",\n    \"autoGearResetFactoryExportFailed\": \"Automatic gear preset export failed. Reset cancelled.\",\n    \"autoGearExportButton\": \"Export rules\",\n    \"autoGearExportHelp\": \"Download your automatic gear rules as a JSON file.\",\n    \"autoGearExportSuccess\": \"Automatic gear rules downloaded.\",\n    \"autoGearExportError\": \"Automatic gear rules export failed.\",\n    \"autoGearImportButton\": \"Import rules\",\n    \"autoGearImportHelp\": \"Replace your automatic gear rules with a file you previously exported.\",\n    \"autoGearImportConfirm\": \"Replace your automatic gear rules with the imported file?\",\n    \"autoGearImportSuccess\": \"Automatic gear rules imported.\",\n    \"autoGearImportError\": \"Import failed. Please choose a valid automatic gear rules file.\",\n    \"autoGearImportSchemaError\": \"Import failed. The file does not match the automatic gear rules export format.\",\n    \"autoGearImportMetadataLabelType\": \"type marker\",\n    \"autoGearImportMetadataLabelVersion\": \"version\",\n    \"autoGearImportMetadataLabelTimestamp\": \"marca temporale\",\n    \"autoGearImportMissingMetadataWarning\": \"Imported rules are missing required metadata: {fields}. Confirm the file comes from a trusted export before saving.\",\n    \"autoGearImportInvalidMetadataWarning\": \"Imported rules include invalid metadata: {fields}. Confirm the file comes from a trusted export before saving.\",\n    \"autoGearImportNewerVersionWarning\": \"Imported rules were created with version {importVersion}, which is newer than this build ({appVersion}). Double-check compatibility before relying on them.\",\n    \"autoGearImportOlderVersionWarning\": \"Imported rules were created with version {importVersion}, which is older than this build ({appVersion}). Review them to confirm they still match your workflow.\",\n    \"autoGearImportInvalidVersionWarning\": \"Imported rules report version \\\"{value}\\\", which is not a valid semantic version string.\",\n    \"autoGearImportInvalidTimestampWarning\": \"The import timestamp \\\"{value}\\\" could not be verified. Confirm the file has not been modified.\",\n    \"autoGearBackupsHeading\": \"Automatic backups\",\n    \"autoGearBackupsDescription\": \"Backups save your rules every 10 minutes when changes occur and keep up to 50 tracked changes between full snapshots. Restore a snapshot if something goes wrong.\",\n    \"autoGearShowBackupsLabel\": \"Show automatic backups\",\n    \"autoGearShowBackupsHelp\": \"Reveal the snapshots captured in the background.\",\n    \"autoGearBackupsHidden\": \"Automatic backups stay hidden until you turn them on.\",\n    \"autoGearBackupSelectLabel\": \"Choose a backup\",\n    \"autoGearBackupSelectPlaceholder\": \"Select a backup to restore\",\n    \"autoGearBackupEmpty\": \"No automatic backups yet.\",\n    \"autoGearBackupRestore\": \"Restore\",\n    \"autoGearBackupRestoreConfirm\": \"Replace your automatic gear rules with this backup?\",\n    \"autoGearBackupRestoreSuccess\": \"Automatic gear backup restored.\",\n    \"autoGearBackupRestoreError\": \"Automatic gear backup restore failed.\",\n    \"autoGearBackupSaved\": \"Automatic gear backup saved.\",\n    \"autoGearBackupFailed\": \"Automatic gear backup failed.\",\n    \"autoGearBackupRetentionLabel\": \"Automatic backup retention\",\n    \"autoGearBackupRetentionHelp\": \"Choose how many automatic gear backups stay on this device.\",\n    \"autoGearBackupRetentionSummary\": \"Keeping the latest {limit}. Currently {stored} stored.\",\n    \"autoGearBackupRetentionWarning\": \"Lowering to {limit} will remove {trimmed}. A safety snapshot will be saved first.\",\n    \"autoGearBackupRetentionConfirm\": \"Save a safety snapshot and trim older backups now?\",\n    \"autoGearBackupRetentionSafetyNote\": \"Retention lowered to {limit}.\",\n    \"autoGearBackupRetentionSafetyNoteTrimmed\": \"Retention lowered to {limit}. Removed {trimmed} in this change.\",\n    \"autoGearBackupRetentionSafetySaved\": \"Safety snapshot captured before trimming backups.\",\n    \"autoGearBackupRetentionSafetyFailed\": \"Safety snapshot failed. Retention was not changed.\",\n    \"autoGearBackupRetentionUpdated\": \"Retention updated to {limit}. Removed {trimmed}.\",\n    \"autoGearBackupRetentionUpdatedNoTrim\": \"Retention updated to {limit}. No backups were removed.\",\n    \"autoGearBackupRetentionExpanded\": \"Retention updated to {limit}.\",\n    \"autoGearBackupRetentionUpdateFailed\": \"Could not apply the new retention limit. Try again.\",\n    \"autoGearRulesCountOne\": \"%s rule\",\n    \"autoGearRulesCountOther\": \"%s rules\",\n    \"autoGearRuleToggleEnable\": \"Enable rule\",\n    \"autoGearRuleToggleDisable\": \"Disable rule\",\n    \"autoGearRuleEnabledLabel\": \"Enabled\",\n    \"autoGearRuleDisabledLabel\": \"Disabled\",\n    \"autoGearSummaryAllDisabled\": \"All automatic gear rules are disabled.\",\n    \"autoGearSummaryDisabledSuffix\": \"{count} disabled rules are ignored in coverage.\",\n    \"autoGearSummaryDisabledNote\": \"Disabled rules are visible below but ignored until re-enabled.\",\n    \"autoGearBackupClearsRules\": \"Clears all rules\",\n    \"autoGearBackupMeta\": \"%s  %s\",\n    \"autoGearAddsCountOne\": \"%s addition\",\n    \"autoGearAddsCountOther\": \"%s additions\",\n    \"autoGearAddsListLabel\": \"Adds\",\n    \"autoGearItemSummaryWithCategory\": \"%s  %s (%s)\",\n    \"autoGearItemSummary\": \"%s  %s\",\n    \"autoGearRemovalsCountOne\": \"%s removal\",\n    \"autoGearRemovalsCountOther\": \"%s removals\",\n    \"autoGearDuplicateRule\": \"Duplicate\",\n    \"autoGearDuplicateSuffix\": \"Copy\",\n    \"autoGearDeleteRule\": \"Delete\",\n    \"autoGearDeleteConfirm\": \"Delete this rule?\",\n    \"autoGearItemNameRequired\": \"Enter an item name first.\",\n    \"autoGearEditSingleItemWarning\": \"Edit one item at a time.\",\n    \"autoGearRuleScenarioRequired\": \"Select a scenario before saving.\",\n    \"autoGearRuleNeedsItems\": \"Add at least one item to add or remove before saving.\",\n    \"autoGearListRemove\": \"Remove\",\n    \"autoGearListEdit\": \"Edit\",\n    \"autoGearEmptyList\": \"No items yet.\",\n    \"autoGearDraftImpactHeading\": \"Draft impact preview\",\n    \"autoGearDraftImpactDescription\": \"Simulated totals showing how this draft would change shared gear outputs.\",\n    \"autoGearDraftImpactEmpty\": \"No changes detected yet. Add or adjust items to preview the impact.\",\n    \"autoGearDraftImpactUnavailable\": \"Preview becomes available after this rule includes at least one item.\",\n    \"autoGearDraftImpactTotals\": \"Current total: %s  After save: %s\",\n    \"autoGearDraftImpactChange\": \"Change: %s\",\n    \"autoGearDraftImpactStackedOne\": \"Stacked across %s rule.\",\n    \"autoGearDraftImpactStackedOther\": \"Stacked across %s rules.\",\n    \"autoGearDraftImpactConflictOne\": \"Removals also active in %s rule.\",\n    \"autoGearDraftImpactConflictOther\": \"Removals also active in %s rules.\",\n    \"autoGearDraftWarningHeading\": \"Warnings\",\n    \"autoGearDraftWarningCritical\": \"%s would drop out of the kit list.\",\n    \"autoGearDraftWarningConflict\": \"%s has conflicting add and remove instructions.\",\n    \"autoGearDraftWarningRedundant\": \"%s is added by multiple rules without increasing totals.\",\n    \"autoGearDraftWarningConfirm\": \"Save anyway? Review the impact warnings below before confirming.\",\n    \"autoGearCustomCategory\": \"Custom Additions\",\n    \"autoGearAddScreenSizeLabel\": \"Screen size\",\n    \"autoGearAddSelectorTypeLabel\": \"Selector\",\n    \"autoGearAddSelectorDefaultLabel\": \"Default item\",\n    \"autoGearAddSelectorIncludeLabel\": \"Include selector\",\n    \"autoGearAddNotesLabel\": \"Notes\",\n    \"autoGearRemoveScreenSizeLabel\": \"Screen size\",\n    \"autoGearRemoveSelectorTypeLabel\": \"Selector\",\n    \"autoGearRemoveSelectorDefaultLabel\": \"Default item\",\n    \"autoGearRemoveSelectorIncludeLabel\": \"Include selector\",\n    \"autoGearRemoveNotesLabel\": \"Notes\",\n    \"autoGearSelectorDefaultPlaceholder\": \"Choose a default device\",\n    \"autoGearSelectorNoneOption\": \"No selector\",\n    \"autoGearSelectorMonitorOption\": \"Monitor selector\",\n    \"autoGearSelectorDirectorOption\": \"Director monitor selector\",\n    \"autoGearSelectorTripodHeadOption\": \"Tripod head selector\",\n    \"autoGearSelectorTripodBowlOption\": \"Tripod bowl selector\",\n    \"autoGearSelectorTripodTypesOption\": \"Tripod type selector\",\n    \"autoGearSelectorTripodSpreaderOption\": \"Tripod spreader selector\",\n    \"autoGearSelectorFizHandUnitOption\": \"FIZ hand unit selector\",\n    \"autoGearSelectorScrollHint\": \"Scroll to see more devices.\",\n    \"autoGearSelectorSummaryWithDefault\": \"%s selector (default: %s)\",\n    \"autoGearSelectorSummary\": \"%s selector\",\n    \"autoGearSelectorSummaryNoSelector\": \"%s default: %s\",\n    \"autoGearRuleTooltipNamed\": \"Added by automatic gear rule %s.\",\n    \"autoGearRuleTooltipUnnamed\": \"Added by an automatic gear rule.\",\n    \"autoGearRuleBadgeNamed\": \"Rule: %s\",\n    \"autoGearRuleBadgeUnnamed\": \"Automatic rule\",\n    \"accessibilityHeading\": \"Accessibility\",\n    \"accessibilityHeadingHelp\": \"Adjust contrast and other options that improve legibility.\",\n    \"highContrastSetting\": \"High contrast\",\n    \"highContrastSettingHelp\": \"Increase contrast for text and outlines to boost readability in any theme.\",\n    \"reduceMotionSetting\": \"Reduce motion\",\n    \"reduceMotionSettingHelp\": \"Limit color and interface animations so transitions feel steady for motion-sensitive users.\",\n    \"relaxedSpacingSetting\": \"Relaxed spacing\",\n    \"relaxedSpacingSettingHelp\": \"Increase line spacing and control padding to make text easier to scan and tap.\",\n    \"backupHeading\": \"Backup & Restore\",\n    \"backupHeadingHelp\": \"Manage full backups of settings, saved projects, custom devices, queued vault entries, and runtime feedback.\",\n    \"backupVaultHeading\": \"Data Vault (Backups)\",\n    \"backupVaultLoading\": \"Loading backups\",\n    \"backupVaultEmptyTitle\": \"No backups found in the vault.\",\n    \"backupVaultEmptySubtitle\": \"Backups are created automatically when you save projects.\",\n    \"backupVaultLoadError\": \"Failed to load backups: {message}\",\n    \"backupVaultLoadErrorFallback\": \"Unable to load backups.\",\n    \"backupVaultRestoreAriaLabel\": \"Restore {name}\",\n    \"backupVaultDeleteAriaLabel\": \"Delete {name}\",\n    \"backupVaultRestoreConfirm\": \"Restore {name}? This will overwrite current data.\",\n    \"backupVaultUnknownFormat\": \"Unknown backup format.\",\n    \"backupVaultRestoreSuccess\": \"Project restored successfully!\",\n    \"backupVaultRestoreLocked\": \"This project is locked by another session.\",\n    \"backupVaultRestoreUnknownError\": \"Unknown error.\",\n    \"backupVaultRestoreFailed\": \"Restore failed. {reason}\",\n    \"backupVaultRestoreError\": \"Failed to restore: {message}\",\n    \"backupVaultDeleteConfirm\": \"Delete {name}?\",\n    \"backupVaultDeleteError\": \"Failed to delete backup: {message}\",\n    \"backupVaultDeleteErrorFallback\": \"Failed to delete backup.\",\n    \"projectBackupsHeading\": \"Project Backups\",\n    \"projectBackupsDescription\": \"Manage automatic snapshots and compare saved versions before restoring changes.\",\n    \"showAutoBackupsSetting\": \"Show auto backups in project list\",\n    \"showAutoBackupsHelp\": \"Temporarily list automatic backup snapshots in Saved Projects so you can restore them manually.\",\n    \"versionCompareButton\": \"Compare versions\",\n    \"versionCompareButtonHelp\": \"Review differences between saves, add notes, and export a comparison log.\",\n    \"versionCompareHeading\": \"Version comparison\",\n    \"versionCompareIntro\": \"Pick two manual saves or automatic backups to inspect changes before archiving a log.\",\n    \"versionComparePrimaryLabel\": \"Baseline version\",\n    \"versionCompareSecondaryLabel\": \"Comparison version\",\n    \"versionCompareSelectPlaceholder\": \"Select a version\",\n    \"versionCompareEmpty\": \"Save a project or wait for auto-backups to start comparing versions.\",\n    \"versionCompareNoSelection\": \"Choose two versions to generate a diff.\",\n    \"versionCompareSameSelection\": \"Select two different versions to compare.\",\n    \"versionCompareDifferencesCountOne\": \"%s difference noted.\",\n    \"versionCompareDifferencesCountOther\": \"%s differences noted.\",\n    \"versionCompareIdentical\": \"Versions matchno changes detected.\",\n    \"versionCompareManualLabel\": \"Manual save\",\n    \"versionCompareAutoLabel\": \"Auto backup\",\n    \"versionCompareAutoDeleteLabel\": \"Auto backup before delete\",\n    \"versionCompareNotesLabel\": \"Incident notes\",\n    \"versionCompareNotesPlaceholder\": \"Record context, on-set observations, or required follow-up.\",\n    \"versionCompareExport\": \"Export log\",\n    \"versionCompareExportHelp\": \"Download a JSON copy of this comparison and your notes.\",\n    \"versionCompareClose\": \"Close\",\n    \"versionCompareExportSuccess\": \"Comparison log exported.\",\n    \"versionCompareExportFailure\": \"Comparison export failed.\",\n    \"versionCompareMissingSelection\": \"Select two versions before exporting a log.\",\n    \"versionCompareChangeAdded\": \"Added\",\n    \"versionCompareChangeRemoved\": \"Removed\",\n    \"versionCompareChangeUpdated\": \"Updated\",\n    \"versionCompareMissingValue\": \"Not present\",\n    \"versionCompareRootPath\": \"Entire setup\",\n    \"versionCompareListItemLabel\": \"Item %s\",\n    \"versionCompareSummaryAdded\": \"Added: %s\",\n    \"versionCompareSummaryRemoved\": \"Removed: %s\",\n    \"versionCompareSummaryChanged\": \"Updated: %s\",\n    \"backupSettings\": \"Backup\",\n    \"backupSettingsHelp\": \"Download a full JSON backup containing every project, device edit, preference, auto-gear rule, queued backup vault entry, and runtime log stored on this device. Keep multiple copies in your offline archive.\",\n    \"restoreSettings\": \"Restore\",\n    \"restoreSettingsHelp\": \"Restore a full JSON backup. The planner captures a fresh safety copy first, then replaces stored preferences and session data with the selected file so you can roll back immediately if anything looks wrong.\",\n    \"restoreRehearsalButton\": \"Restore rehearsal\",\n    \"restoreRehearsalButtonHelp\": \"Test a backup or project bundle in a disposable sandbox before you restore your live data.\",\n    \"restoreRehearsalHeading\": \"Restore rehearsal\",\n    \"restoreRehearsalIntro\": \"Load a backup or project bundle into a disposable workspace. We compare key counts with your live profile and clear the sandbox automatically.\",\n    \"restoreRehearsalModeLabel\": \"Choose a rehearsal source\",\n    \"restoreRehearsalModeBackup\": \"Full app backup (.json)\",\n    \"restoreRehearsalModeProject\": \"Project bundle (.json)\",\n    \"restoreRehearsalFileLabel\": \"Select file\",\n    \"restoreRehearsalFileButton\": \"Choose file\",\n    \"restoreRehearsalNoFile\": \"No file selected yet.\",\n    \"restoreRehearsalReady\": \"Sandbox ready. Pick a JSON file to inspect.\",\n    \"restoreRehearsalProcessing\": \"Loading file in an isolated sandbox\",\n    \"restoreRehearsalMatch\": \"All counts match. The sandbox was cleared automatically.\",\n    \"restoreRehearsalMismatch\": \"Differences detected: %s. The sandbox was cleared automatically.\",\n    \"restoreRehearsalError\": \"Restore rehearsal failed. Check the file and try again.\",\n    \"restoreRehearsalBackupMismatch\": \"File doesn't look like a full app backup. Double-check the source and try again.\",\n    \"restoreRehearsalProjectMismatch\": \"File doesn't look like a project bundle. Double-check the source and try again.\",\n    \"restoreRehearsalRuleHeading\": \"Automatic gear rule changes\",\n    \"restoreRehearsalRuleIntro\": \"Compare every automatic gear rule before loading the sandbox. Live rules stay untouched.\",\n    \"restoreRehearsalRuleEmpty\": \"No automatic gear rule differences found.\",\n    \"restoreRehearsalRuleAddsLabel\": \"Automatic additions\",\n    \"restoreRehearsalRuleRemovesLabel\": \"Automatic removals\",\n    \"restoreRehearsalRuleScenariosLabel\": \"Scenario scope\",\n    \"restoreRehearsalRuleNone\": \"None\",\n    \"restoreRehearsalRuleLogicLabel\": \"Scenario logic\",\n    \"restoreRehearsalRuleBaseLabel\": \"Base scenario\",\n    \"restoreRehearsalRuleMultiplierLabel\": \"Multiplier\",\n    \"restoreRehearsalRuleRequiredLabel\": \"Required scenarios\",\n    \"restoreRehearsalRuleAlwaysLabel\": \"Always active\",\n    \"restoreRehearsalRuleFallback\": \"Automatic rule change\",\n    \"restoreRehearsalProceed\": \"Resume restore rehearsal\",\n    \"restoreRehearsalProceedHelp\": \"Stage the sandbox snapshot to continue the rehearsal.\",\n    \"restoreRehearsalProceedMessage\": \"Sandbox snapshot staged. Live data remains untouched until you perform a full restore.\",\n    \"restoreRehearsalAbort\": \"Abort rehearsal\",\n    \"restoreRehearsalAbortHelp\": \"Discard the sandbox snapshot and keep live data unchanged.\",\n    \"restoreRehearsalAbortMessage\": \"Rehearsal sandbox cleared. Live data remains untouched.\",\n    \"restoreRehearsalTableCaption\": \"Backup rehearsal comparison\",\n    \"restoreRehearsalMetricColumn\": \"Data type\",\n    \"restoreRehearsalLiveColumn\": \"Live profile\",\n    \"restoreRehearsalSandboxColumn\": \"Sandbox import\",\n    \"restoreRehearsalDifferenceColumn\": \"Difference\",\n    \"restoreRehearsalClose\": \"Close rehearsal\",\n    \"restoreRehearsalMetricProjects\": \"Projects\",\n    \"restoreRehearsalMetricProjectDetails\": \"Project details\",\n    \"restoreRehearsalMetricCrew\": \"Crew entries\",\n    \"restoreRehearsalMetricSchedule\": \"Schedule entries\",\n    \"restoreRehearsalMetricRules\": \"Automatic gear rules\",\n    \"restoreRehearsalMetricFavorites\": \"Favorites\",\n    \"restoreRehearsalMetricDeviceLibrary\": \"Device library entries\",\n    \"restoreRehearsalMetricSession\": \"Stored session snapshot\",\n    \"restoreRehearsalMetricFeedback\": \"Feedback drafts\",\n    \"restoreRehearsalMetricAutoPresets\": \"Automatic gear presets\",\n    \"restoreRehearsalMetricAutoBackups\": \"Automatic gear backups\",\n    \"restoreRehearsalMetricBackupHistory\": \"Backup history entries\",\n    \"restoreRehearsalMetricCustomFonts\": \"Custom fonts\",\n    \"restoreRehearsalMetricCustomLogo\": \"Custom logo saved\",\n    \"restoreRehearsalMetricPreferences\": \"Stored preferences\",\n    \"restoreRehearsalMetricSchemaCache\": \"Device schema cache\",\n    \"restoreRehearsalMatchLabel\": \"Match\",\n    \"restoreRehearsalDifferenceListJoin\": \", \",\n    \"restoreRehearsalIncreaseLabel\": \"Sandbox includes %d more %s.\",\n    \"restoreRehearsalDecreaseLabel\": \"Sandbox includes %d fewer %s.\",\n    \"factoryResetButton\": \"Factory reset\",\n    \"factoryResetButtonHelp\": \"Create a backup and wipe all planner data after confirmation.\",\n    \"confirmFactoryReset\": \"Create a backup and wipe all planner data?\",\n    \"confirmFactoryResetAgain\": \"Last warning: all projects, devices, settings and feedback will be deleted. Continue?\",\n    \"factoryResetBackupFailed\": \"Backup failed. Data was not deleted.\",\n    \"factoryResetAwaitDownload\": \"Allow downloads to save your backup. The factory reset will continue after you accept the download.\",\n    \"factoryResetDownloadBlocked\": \"The backup download was blocked. Data was not deleted.\",\n    \"factoryResetSuccess\": \"Backup downloaded. All planner data cleared. Reloading\",\n    \"factoryResetError\": \"Factory reset failed. Please try again.\",\n    \"preDeleteBackupSuccess\": \"Automatic safety copy stored before deletion. Find the matching auto-backup entry under Saved Projects and rename it if you plan to keep it permanently.\",\n    \"preDeleteBackupFailed\": \"Automatic backup failed. The action was cancelled.\",\n    \"restoreBackupFailed\": \"Backup failed. Restore cancelled.\",\n    \"restoreBackupQueuedConfirm\": \"The safety backup is waiting in the local vault. Continue with the restore now?\",\n    \"manualDownloadFallback\": \"The download didn't start automatically. A new tab opened with the file contents so you can copy or save them manually.\",\n    \"manualDownloadCopyHint\": \"Select all the text below and copy it to keep the file safe.\",\n    \"dataHeading\": \"Data & Storage\",\n    \"dataHeadingHelp\": \"Review what the planner stores locally and how much space backups take.\",\n    \"storageSummaryIntro\": \"Everything below stays in this browser unless you export or clear it.\",\n    \"storageSummaryFootnote\": \"Backups download human-readable JSON with each entryQuick safeguards keep fresh copies one click away.\",\n    \"storageSummaryEmpty\": \"No planner data is currently stored.\",\n    \"storagePersistenceHeading\": \"Storage reliability\",\n    \"storagePersistenceHeadingHelp\": \"Ask the browser to keep Cine Power Planner's data safe from automatic cleanups.\",\n    \"storagePersistenceIntro\": \"Request persistent storage so the browser keeps planner data even when space runs low.\",\n    \"storagePersistenceRequest\": \"Protect storage on this device\",\n    \"storagePersistenceRequestHelp\": \"Tell the browser to mark Cine Power Planner's data as persistent.\",\n    \"storagePersistenceStatusIdle\": \"Request persistent storage to reduce the risk of automatic cleanup.\",\n    \"storagePersistenceStatusChecking\": \"Checking storage protection\",\n    \"storagePersistenceStatusRequesting\": \"Requesting persistent storage from the browser\",\n    \"storagePersistenceStatusGranted\": \"Persistent storage granted. Planner data is protected from automatic cleanup.\",\n    \"storagePersistenceStatusDenied\": \"The browser could not grant persistent storage. Keep exporting backups regularly.\",\n    \"storagePersistenceStatusSafariIncompatible\": \"Safari currently blocks persistent storage requests. Treat this as a browser limitation.\",\n    \"storagePersistenceStatusError\": \"Persistent storage request failed. Try again after freeing space or review browser settings.\",\n    \"storagePersistenceStatusUnsupported\": \"This browser cannot grant persistent storage automatically. Continue keeping external backups.\",\n    \"storagePersistenceUsage\": \"Approximate usage: {used} of {quota}.\",\n    \"storagePersistenceUsageUnknown\": \"Approximate usage: {used}.\",\n    \"storageActionsHeading\": \"Quick safeguards\",\n    \"storageActionsHeadingHelp\": \"Download full backups or jump straight to restore tools from here.\",\n    \"storageActionsIntro\": \"Capture a fresh full backup or open restore utilities without leaving this tab.\",\n    \"storageBackupNow\": \"Download full backup\",\n    \"storageBackupNowHelp\": \"Exports the entire planner snapshot, including projects, auto backups and preferences.\",\n    \"storageOpenBackupTab\": \"Open Backup & Restore\",\n    \"storageOpenBackupTabHelp\": \"Switch to the Backup & Restore tab for rehearsal, restore and factory reset tools.\",\n    \"storageStatusHeading\": \"Latest activity\",\n    \"storageStatusHeadingHelp\": \"Review the most recent saves and backups at a glance.\",\n    \"storageStatusLastProjectLabel\": \"Latest project save\",\n    \"storageStatusLastAutoBackupLabel\": \"Latest auto backup\",\n    \"autoBackupInProgressNotice\": \"Auto backup running. Performance may pause briefly.\",\n    \"storageStatusLastFullBackupLabel\": \"Latest full app backup\",\n    \"loggingSectionHelp\": \"Review runtime diagnostics without leaving Settings. Service worker entries stream in automatically so offline cache and activation events stay visible.\",\n    \"loggingHeading\": \"Diagnostics log\",\n    \"loggingHeadingHelp\": \"Review runtime diagnostics without leaving Settings.\",\n    \"loggingIntro\": \"The log updates live while Settings stay open. Console capture runs by default so transcripts stay local; adjust the toggles below if you need to change diagnostics behavior. Nothing leaves this device.\",\n    \"loggingLevelFilterLabel\": \"Show entries from\",\n    \"loggingLevelFilterHelp\": \"Choose the minimum level to display.\",\n    \"loggingLevelFilterAll\": \"All levels\",\n    \"loggingLevelFilterInfo\": \"Info and above\",\n    \"loggingLevelFilterWarn\": \"Warnings and errors\",\n    \"loggingLevelFilterError\": \"Errors only\",\n    \"loggingNamespaceFilterLabel\": \"Namespace filter\",\n    \"loggingNamespaceFilterPlaceholder\": \"Filter namespaces (for example, backup)\",\n    \"loggingNamespaceFilterHelp\": \"Type a namespace such as backup, autosave or logging.\",\n    \"loggingHistoryLimitLabel\": \"History size\",\n    \"loggingHistoryLimitHelp\": \"Maximum entries stored on this device.\",\n    \"loggingHistoryLimitStatus\": \"Storing up to {count} entries locally.\",\n    \"loggingHistoryLimitAria\": \"Set how many log entries stay available offline\",\n    \"loggingConsoleOutputLabel\": \"Mirror to console\",\n    \"loggingConsoleOutputHelp\": \"Keep the browser console in sync with these entries.\",\n    \"loggingCaptureConsoleLabel\": \"Capture console output\",\n    \"loggingCaptureConsoleHelp\": \"Record console messages for diagnostics. Leave this enabled unless you need to reduce logging overhead.\",\n    \"loggingCaptureErrorsLabel\": \"Capture global errors\",\n    \"loggingCaptureErrorsHelp\": \"Record uncaught errors and unhandled promise rejections.\",\n    \"loggingPersistSessionLabel\": \"Keep log between reloads\",\n    \"loggingPersistSessionHelp\": \"Store entries in session storage so diagnostics survive refreshes.\",\n    \"loggingExportButton\": \"Export log\",\n    \"loggingExportHelp\": \"Download the full diagnostics log as a JSON file.\",\n    \"loggingExportSuccess\": \"Diagnostics log exported.\",\n    \"loggingExportError\": \"Log export failed. Try again after reloading Settings.\",\n    \"loggingExportUnavailable\": \"Logging unavailable. Try again after reloading Settings.\",\n    \"loggingStatusIdle\": \"Live log ready.\",\n    \"loggingStatusUpdating\": \"Updating log\",\n    \"loggingStatusExporting\": \"Preparing log export\",\n    \"loggingStatusExported\": \"Diagnostics log ready for download.\",\n    \"loggingStatusExportFailed\": \"Log export failed.\",\n    \"loggingStorageEstimateUpdated\": \"Storage estimate refreshed.\",\n    \"loggingStorageQuotaOnly\": \"Available storage: {quota}.\",\n    \"loggingStatusError\": \"Logging unavailable. Diagnostics remain in the browser console.\",\n    \"loggingEmptyState\": \"No log entries captured yet.\",\n    \"loggingEmptyFiltered\": \"No log entries match the current filters.\",\n    \"loggingUnavailable\": \"Logging module unavailable. Console output continues as a fallback.\",\n    \"loggingLevelDebug\": \"Debug\",\n    \"loggingLevelInfo\": \"Info\",\n    \"loggingLevelWarn\": \"Warning\",\n    \"loggingLevelError\": \"Error\",\n    \"loggingEntryTimestampLabel\": \"Time\",\n    \"loggingEntryNamespaceLabel\": \"Namespace\",\n    \"loggingEntryMetaLabel\": \"Meta\",\n    \"loggingEntryDetailLabel\": \"Details\",\n    \"loggingTimestampCombined\": \"{local} ({iso})\",\n    \"storageStatusNever\": \"Not captured yet.\",\n    \"storageStatusStoredWithoutTimestamp\": \"Stored (timestamp not recorded).\",\n    \"storageStatusTimestamp\": \"Captured {relative} ({absolute}).\",\n    \"storageStatusTimestampAbsolute\": \"Captured {absolute}.\",\n    \"storageStatusWithName\": \"{name}  {time}\",\n    \"storageStatusReminderUpToDate\": \"Backups look fresh. Keep autosave running and capture a full backup after major changes.\",\n    \"storageStatusReminderSaveProject\": \"Save a named project so your latest work stays protected offline.\",\n    \"storageStatusReminderRefreshProject\": \"Save your project again soon (last save {time}).\",\n    \"storageStatusReminderAutoBackupFirst\": \"Keep Cine Power Planner open until it captures an automatic backup.\",\n    \"storageStatusReminderAutoBackup\": \"Let an automatic backup run again soon (last snapshot {time}).\",\n    \"storageStatusReminderFullBackupFirst\": \"Download a full backup to archive every dataset before going offline.\",\n    \"storageStatusReminderFullBackup\": \"Download another full backup when possible (last archive {time}).\",\n    \"storageStatusReminderConnectivity\": \"Connectivity degraded  {reason} Keep working from the offline copy and avoid clearing caches until the banner clears.\",\n    \"storageKeyProjects\": \"Saved projects\",\n    \"storageKeyProjectsDesc\": \"Configurations saved from Manage Project.\",\n    \"storageProjectsCountOne\": \"%s project\",\n    \"storageProjectsCountOther\": \"%s projects\",\n    \"storageKeyAutoBackups\": \"Auto backups\",\n    \"storageKeyAutoBackupsDesc\": \"Timestamped safety copies saved every 10 minutes or after 50 tracked changes. Switching projects, importing, exporting or preparing to reload triggers an immediate snapshot even if that cadence hasn't elapsed.\",\n    \"storageAutoBackupsCountOne\": \"%s auto backup\",\n    \"storageAutoBackupsCountOther\": \"%s auto backups\",\n    \"storageKeyGearLists\": \"Kit list snapshots\",\n    \"storageKeyGearListsDesc\": \"Printable overviews and production requirements.\",\n    \"storageGearListsCountOne\": \"%s entry\",\n    \"storageGearListsCountOther\": \"%s entries\",\n    \"storageKeyDevices\": \"Custom or modified devices\",\n    \"storageKeyDevicesDesc\": \"Differences from the built-in device library.\",\n    \"storageDevicesCountOne\": \"%s device\",\n    \"storageDevicesCountOther\": \"%s devices\",\n    \"storageDeviceCategories\": \"Affected categories: %s\",\n    \"storageKeyFavorites\": \"Pinned favorites\",\n    \"storageKeyFavoritesDesc\": \"Dropdown entries marked with a star.\",\n    \"storageFavoritesCountOne\": \"%s favorite\",\n    \"storageFavoritesCountOther\": \"%s favorites\",\n    \"storageKeyFeedback\": \"Runtime feedback\",\n    \"storageKeyFeedbackDesc\": \"User-submitted runtime reports.\",\n    \"storageFeedbackCountOne\": \"%s entry\",\n    \"storageFeedbackCountOther\": \"%s entries\",\n    \"storageKeySession\": \"Unsaved session\",\n    \"storageKeySessionDesc\": \"Restores the working project after a reload.\",\n    \"storageKeyFullBackups\": \"Full app backups\",\n    \"storageKeyFullBackupsDesc\": \"Downloads created from Backup & Restore or hourly safety copies, including queued vault entries.\",\n    \"storageFullBackupsCountOne\": \"%s backup\",\n    \"storageFullBackupsCountOther\": \"%s backups\",\n    \"queuedBackupDownloadDeferred\": \"Automatic downloads were blocked. We saved {fileName} in the local vault so the next tap can export it safely.\",\n    \"queuedBackupVaultEmpty\": \"No queued backups are waiting in the local vault.\",\n    \"queuedBackupVaultTitle\": \"Local backup vault\",\n    \"queuedBackupVaultIntro\": \"Automatic downloads were blocked. Review the backups below and download them manually while you have the browser ready offline.\",\n    \"queuedBackupVaultPopupBlocked\": \"Enable pop-ups to review queued backups stored in the local vault.\",\n    \"queuedBackupBannerMessageOne\": \"1 backup saved in the local vault.\",\n    \"queuedBackupBannerMessageOther\": \"{count} backups saved in the local vault.\",\n    \"queuedBackupBannerGesture\": \"Interact with the planner to export them safely.\",\n    \"queuedBackupBannerAction\": \"Open local backup vault\",\n    \"queuedBackupFallbackHint\": \"Emergency fallback storage active. Export queued backups immediately.\",\n    \"storageSessionStored\": \"Stored\",\n    \"storageSessionNotStored\": \"Not stored\",\n    \"storageKeyTotalSize\": \"Approximate backup size\",\n    \"storageKeyTotalSizeDesc\": \"Based on the current backup export.\",\n    \"storageKeyIntegrityGuard\": \"Backup guardian\",\n    \"storageKeyIntegrityGuardDesc\": \"Mirrors every critical storage key into a backup slot before any edits.\",\n    \"storageIntegrityGuardStatus\": \"Active\",\n    \"storageIntegrityGuardStatusCreated\": \"Mirrored {count} key(s) this session\",\n    \"storageIntegrityGuardStatusIssue\": \"{count} issue(s)  check console\",\n    \"storageIntegrityGuardStatusMissing\": \"Waiting for first save\",\n    \"storageTotalSizeValue\": \"~%s KB\",\n    \"aboutHeading\": \"About & Support\",\n    \"aboutHeadingHelp\": \"Review version details and reach support resources.\",\n    \"versionLabel\": \"Version\",\n    \"supportLink\": \"Support\",\n    \"supportLinkHelp\": \"Open the GitHub repository in a new tab.\",\n    \"reportBugLink\": \"Report a bug\",\n    \"reportBugLinkHelp\": \"Open the GitHub issues tracker to report a bug.\",\n    \"suggestFeatureLink\": \"Suggest a feature\",\n    \"suggestFeatureLinkHelp\": \"Open the GitHub issues tracker to share feature ideas.\",\n    \"restoreSuccess\": \"Settings restored. Reload to apply all changes.\",\n    \"restoreVerificationMatch\": \"Restore verification passed. Live data matches the backup snapshot.\",\n    \"restoreVerificationMismatch\": \"Restore verification found differences. Review the counts before continuing:\",\n    \"restoreVerificationDifference\": \"{label}: backup {expected}, live {actual}\",\n    \"restoreVerificationFailed\": \"Restore verification could not confirm the imported data. Review the backup manually.\",\n    \"restoreVerificationUnknownMetric\": \"Metric\",\n    \"restoreFailed\": \"Restore failed. Check the backup file and try again.\",\n    \"restoreVersionWarning\": \"Backup created with a different version. Some features might not transfer.\",\n    \"restoreVersionSummaryTitle\": \"Older backup detected\",\n    \"restoreVersionSummaryHeading\": \"This backup was created with {oldVersion} and you are running {newVersion}.\",\n    \"restoreVersionCoreMissing\": \"Not included in this backup:\",\n    \"restoreVersionStorageMissing\": \"Stored preferences not included:\",\n    \"restoreVersionOptionalMissing\": \"Optional items you may need to recreate:\",\n    \"restoreVersionNoIssues\": \"All modern data sections were found in this backup.\",\n    \"restoreVersionTip\": \"We saved a safety backup of your current data before importing.\",\n    \"restoreVersionFooter\": \"You can continue and manually recreate the missing items afterward.\",\n    \"restoreVersionUnknownVersion\": \"unknown version\",\n    \"restoreVersionBackupLabel\": \"Safety backup saved before restore: {fileName}\",\n    \"restoreSectionDevices\": \"Device library\",\n    \"restoreSectionSetups\": \"Saved setups\",\n    \"restoreSectionProjects\": \"Projects\",\n    \"restoreSectionFavorites\": \"Favorites\",\n    \"restoreSectionAutoGearRules\": \"Automatic gear rules\",\n    \"restoreSectionAutoGearPresets\": \"Automatic gear presets\",\n    \"restoreSectionAutoGearBackups\": \"Automatic gear backups\",\n    \"restoreSectionAutoGearActivePreset\": \"Selected automatic gear preset\",\n    \"restoreSectionAutoGearAutoPreset\": \"Automatic assignment preset\",\n    \"restoreSectionAutoGearVisibility\": \"Automatic backup visibility\",\n    \"restoreSectionAutoGearBackupRetention\": \"Automatic backup retention\",\n    \"restoreSectionAutoGearSeeded\": \"Automatic gear onboarding status\",\n    \"restoreSectionAutoGearMonitorDefaults\": \"Monitor defaults\",\n    \"restoreSectionSession\": \"Current planner session\",\n    \"restoreSectionFeedback\": \"Feedback drafts\",\n    \"restoreSectionPreferences\": \"App preferences\",\n    \"restoreSectionCustomLogo\": \"Custom logo\",\n    \"restoreSectionCustomFonts\": \"Custom fonts\",\n    \"restoreSectionSchemaCache\": \"Device schema cache\",\n    \"restoreSectionFullBackupHistory\": \"Backup history\",\n    \"restoreSectionStoredSettings\": \"Stored settings snapshot\",\n    \"restoreSectionStoredSession\": \"Stored session snapshot\",\n    \"saveSettings\": \"Save\",\n    \"saveSettingsHelp\": \"Apply personalization changes and close Settings.\",\n    \"cancelSettings\": \"Cancel\",\n    \"cancelSettingsHelp\": \"Close Settings without saving; previous colors and logo are restored.\",\n    \"reloadAppLabel\": \"Force reload\",\n    \"reloadAppHelp\": \"Clear cached files, unregister outdated service workers and reload without removing saved data. The app now verifies connectivity before cleanup, broadcasts fallback status to the offline banner, and preloads the fresh bundle so the new version appears faster.\",\n    \"reloadAppOfflineNotice\": \"Offline or degraded  force reload pings the server first, so reconnect and try again.\",\n    \"favoriteToggleLabel\": \"Toggle favorite\",\n    \"favoriteToggleHelp\": \"Mark the current selection as a favorite to pin it to the top of the list.\",\n    \"savedSetupsLabel\": \"Saved Projects:\",\n    \"newSetupOption\": \"-- New Project --\",\n    \"setupNameLabel\": \"Project Name:\",\n    \"generatedOnLabel\": \"Generated on\",\n    \"deleteSetupBtn\": \"Delete\",\n    \"saveSetupBtn\": \"Save\",\n    \"updateSetupBtn\": \"Update\",\n    \"clearFilter\": \"Clear filter\",\n    \"shareSetupBtn\": \"Export Project\",\n    \"shareSetupPrompt\": \"Project file ready to export. Crew contacts are included.\",\n    \"shareLinkCopied\": \"Project file downloaded.\",\n    \"shareExportFailed\": \"Project export failed.\",\n    \"shareLinkTooLong\": \"Project data is too large to export.\",\n    \"shareFilenamePrompt\": \"Enter a name for the exported project file (default: {defaultName}).\",\n    \"shareFilenameInvalid\": \"Please enter a valid file name to continue.\",\n    \"shareIncludeAutoGearConfirm\": \"Include automatic gear rules in the exported file? Select OK to include them or Cancel to skip.\",\n    \"shareIncludeAutoGearLabel\": \"Include automatic gear rules\",\n    \"shareIncludeAutoGearHelp\": \"Add your automatic gear rules to the exported project file.\",\n    \"shareIncludeOwnedGearLabel\": \"Mark owned gear in export\",\n    \"shareIncludeOwnedGearHelp\": \"Add ownership badges for gear you marked as yours when exporting.\",\n    \"shareDialogTitle\": \"Export Project\",\n    \"shareFilenameLabel\": \"Export file name\",\n    \"shareDialogConfirm\": \"Download\",\n    \"shareDialogCancel\": \"Cancel\",\n    \"sharedLinkLabel\": \"Project file\",\n    \"loadSharedLinkBtn\": \"Import Project\",\n    \"invalidSharedLink\": \"Invalid project file.\",\n    \"sharedImportAutoGearLabel\": \"Automatic gear rules\",\n    \"sharedImportAutoGearNone\": \"Do not import automatic gear rules\",\n    \"sharedImportAutoGearNoneHelp\": \"Load the project without applying the shared automatic rules.\",\n    \"sharedImportAutoGearProject\": \"Use shared rules for this project only\",\n    \"sharedImportAutoGearProjectHelp\": \"Save the shared automatic gear rules as a preset, apply it here, and restore your previous preset for other projects.\",\n    \"sharedImportAutoGearGlobal\": \"Use shared rules for all projects\",\n    \"sharedImportAutoGearGlobalHelp\": \"Save the shared automatic gear rules as a preset, activate it, and keep it selected for every project.\",\n    \"sharedImportAutoGearPresetName\": \"Shared rules  %s\",\n    \"sharedImportAutoGearPresetFallback\": \"Shared automatic gear rules\",\n    \"sharedImportDialogTitle\": \"Automatic gear rules\",\n    \"sharedImportDialogMessage\": \"Choose how to apply the shared automatic gear rules from this project.\",\n    \"sharedImportMetadataTimestamp\": \"Exported {timestamp}\",\n    \"sharedImportMetadataVersion\": \"Planner version {version}\",\n    \"sharedImportMetadataVersionMismatch\": \"Planner version {importVersion} (current build {appVersion})\",\n    \"sharedImportMetadataIncludesAutoGear\": \"Includes automatic gear rules\",\n    \"sharedImportMetadataIncludesOwnedGear\": \"Marks owned gear items\",\n    \"sharedImportMetadataUnavailable\": \"Export details unavailable.\",\n    \"sharedImportDialogConfirm\": \"Apply\",\n    \"sharedImportDialogCancel\": \"Cancel\",\n    \"cameraLabel\": \"Camera:\",\n    \"monitorLabel\": \"Monitor:\",\n    \"videoLabel\": \"Wireless Transmitter:\",\n    \"cageLabel\": \"Camera Cage:\",\n    \"distanceLabel\": \"Distance Sensor:\",\n    \"batteryLabel\": \"Battery:\",\n    \"batteryBMountLabel\": \"B-Mount Battery:\",\n    \"batteryPlateLabel\": \"Battery Plate:\",\n    \"batteryHotswapLabel\": \"Battery Hotswap:\",\n    \"lensesLabel\": \"Lenses:\",\n    \"fizLegend\": \"FIZ (Follow Focus) Systems\",\n    \"fizMotorsLabel\": \"FIZ Motors:\",\n    \"fizControllersLabel\": \"FIZ Controllers:\",\n    \"fizLegendHelp\": \"Add motors, controllers or distance units for focus/iris/zoom control.\",\n    \"fizMotorsHelp\": \"Select focus, iris or zoom motors.\",\n    \"fizControllersHelp\": \"Choose hand units or controllers for your FIZ system.\",\n    \"breakdownListHelp\": \"Power consumption per device category.\",\n    \"totalPowerLabel\": \"Total Consumption:\",\n    \"totalPowerHelp\": \"Combined power draw of all selected devices.\",\n    \"availablePowerLabel\": \"Available Power:\",\n    \"totalCurrent144Label\": \"Total Current (at 14.4V):\",\n    \"totalCurrent144Help\": \"Current draw at the battery's high-voltage output (e.g., 14.4V pins).\",\n    \"totalCurrent12Label\": \"Total Current (at 12V):\",\n    \"totalCurrent12Help\": \"Current draw from a 12V output such as D-Tap.\",\n    \"totalCurrent336Label\": \"Total Current (at 33.6V):\",\n    \"totalCurrent336Help\": \"Current draw at the battery's high-voltage output (e.g., 33.6V pins).\",\n    \"totalCurrent216Label\": \"Total Current (at 21.6V):\",\n    \"totalCurrent216Help\": \"Current draw from a 21.6V output such as B-Mount low-voltage.\",\n    \"batteryLifeLabel\": \"Runtime (estimated):\",\n    \"batteryLifeHelp\": \"Estimated runtime based on total draw and chosen battery capacity.\",\n    \"batteryCountLabel\": \"Batteries for 10h shoot:\",\n    \"batteryCountHelp\": \"Batteries needed for a 10-hour shoot.\",\n    \"runtimeFeedbackBtn\": \"Submit User Runtime Feedback\",\n    \"selectedGearHeading\": \"Selected Gear\",\n    \"recommendationsHeading\": \"Recommended Accessories\",\n    \"recommendationsHeadingHelp\": \"Accessories suggested based on selected devices.\",\n    \"weightingHeading\": \"Runtime Weighting Breakdown\",\n    \"pinWarningHelp\": \"Alerts if current exceeds what the battery pins can supply.\",\n    \"dtapWarningHelp\": \"Alerts if current exceeds what the D-Tap port can supply.\",\n    \"hotswapWarningHelp\": \"Alerts if the selected hotswap restricts available current.\",\n    \"methodPinsOnly\": \"pins only!\",\n    \"methodPinsAndDTap\": \"both pins and D-Tap\",\n    \"methodInfinite\": \"infinite\",\n    \"pinOk\": \"Battery pins can supply up to {max}A  current draw is within limits.\",\n    \"dtapOk\": \"D-Tap can supply up to {max}A  current draw is within limits.\",\n    \"warnPinExceededLevel\": \"warning\",\n    \"warnPinNearLevel\": \"note\",\n    \"warnDTapExceededLevel\": \"warning\",\n    \"warnDTapNearLevel\": \"note\",\n    \"warnPinExceeded\": \"WARNING: current draw ({current}A at ~12V) exceeds the battery's main output rating ({max}A)!\",\n    \"warnPinNear\": \"Note: current draw is close to the main output limit ({current}A of {max}A).\",\n    \"warnDTapExceeded\": \"WARNING: current draw ({current}A) exceeds the battery's D-Tap output ({max}A)!\",\n    \"warnDTapNear\": \"Note: current draw uses over 80% of the D-Tap capacity ({current}A of {max}A).\",\n    \"warnHotswapLower\": \"WARNING: hotswap current limit ({max}A) is lower than battery ({batt}A).\",\n    \"powerWarningTitle\": \"Battery cannot power this load\",\n    \"powerWarningLimitsHeading\": \"Output limits\",\n    \"powerWarningMessage\": \"{battery} must deliver {current}A, which exceeds every available output.\",\n    \"powerWarningPinsDetail\": \"Pins limit: {max}A\",\n    \"powerWarningPinsUnavailable\": \"Pins limit unavailable.\",\n    \"powerWarningDtapDetail\": \"D-Tap limit: {max}A\",\n    \"powerWarningDtapUnavailable\": \"No D-Tap output is available.\",\n    \"powerWarningDtapBlocked\": \"D-Tap cannot be used with the current configuration.\",\n    \"powerWarningAdvice\": \"Choose another battery, reduce the draw, or adjust your power distribution.\",\n    \"powerWarningClose\": \"Understood\",\n    \"incompatibleFIZWarning\": \"WARNING: incompatible FIZ brands selected.\",\n    \"missingFIZControllerWarning\": \"ERROR: FIZ motors require a controller with LBUS/CAM connection.\",\n    \"arriUMC4Warning\": \"WARNING: UMC-4 only works with LCS (LEMO 7-pin) to LBUS cable with LBUS devices.\",\n    \"arriRIA1Warning\": \"WARNING: RIA-1 or cforce RF controllers are not compatible with CLM-3/4/5.\",\n    \"arriCLMNoUMC4Warning\": \"WARNING: No FIZ controller present. Select a UMC-4 for a complete project. CLM-3/4/5 are not compatible with RIA-1, cforce RF or Master Grips.\",\n    \"distanceControllerWarning\": \"WARNING: Distance units require UMC-4, RIA-1 or cforce RF.\",\n    \"masterGripWirelessWarning\": \"WARNING: Master Grip has no wireless capability. Use RIA-1, UMC-4 or cforce RF for wireless control.\",\n    \"amiraCforceRemoteWarning\": \"ERROR: AMIRA with cforce Mini/Plus requires RIA-1, cforce RF, or UMC-4 for remote focus. Master Grips only allow local operator focus.\",\n    \"category_cameras\": \"Cameras\",\n    \"category_lenses\": \"Lenses\",\n    \"category_viewfinders\": \"Viewfinders\",\n    \"category_monitors\": \"Monitors\",\n    \"category_video\": \"Wireless Transmitter\",\n    \"category_wirelessReceivers\": \"Wireless Receiver\",\n    \"category_cages\": \"Cages\",\n    \"category_fiz_motors\": \"FIZ Motors\",\n    \"category_fiz_controllers\": \"FIZ Controllers\",\n    \"category_fiz_distance\": \"FIZ Distance\",\n    \"category_batteries\": \"Batteries\",\n    \"category_batteryHotswaps\": \"Battery Hotswap\",\n    \"category_accessory_batteries\": \"Accessory Batteries\",\n    \"category_cables\": \"Cables\",\n    \"category_camera_support\": \"Camera Support\",\n    \"category_chargers\": \"Chargers\",\n    \"category_cardReaders\": \"Card Reader\",\n    \"lensSpecBrandLabel\": \"Brand\",\n    \"lensSpecTypeLabel\": \"Lens Type\",\n    \"lensSpecMountLabel\": \"Mount\",\n    \"lensSpecFrontDiameterLabel\": \"Front Diameter\",\n    \"lensSpecTStopLabel\": \"T-stop\",\n    \"lensSpecImageCircleLabel\": \"Image Circle\",\n    \"lensSpecLengthLabel\": \"Length\",\n    \"lensSpecMinFocusLabel\": \"Minimum Focus\",\n    \"lensSpecWeightLabel\": \"Weight\",\n    \"lensSpecRodStandardLabel\": \"Rod Standard\",\n    \"lensSpecRodLengthLabel\": \"Rod Length\",\n    \"lensSpecClampOnLabel\": \"Clamp-on\",\n    \"lensSpecSupportLabel\": \"Lens Support\",\n    \"lensSpecCategoryGeneralLabel\": \"General\",\n    \"lensSpecCategoryOpticsLabel\": \"Optics\",\n    \"lensSpecCategoryPhysicalLabel\": \"Physical\",\n    \"lensSpecCategorySupportLabel\": \"Support\",\n    \"lensSpecCategoryNotesLabel\": \"Notes\",\n    \"lensSpecNotesLabel\": \"Notes\",\n    \"lensSpecFocusScaleLabel\": \"Focus Scale\",\n    \"lensSpecYes\": \"Yes\",\n    \"lensSpecNo\": \"No\",\n    \"lensSpecSupportRequired\": \"Required\",\n    \"lensSpecSupportNotRequired\": \"Not required\",\n    \"lensSpecUnknownValue\": \"Unknown\",\n    \"addDeviceHeading\": \"Add New Device\",\n    \"categoryLabel\": \"Category:\",\n    \"subcategoryLabel\": \"Subcategory:\",\n    \"deviceNameLabel\": \"Name:\",\n    \"consumptionLabel\": \"Consumption (W):\",\n    \"capacityLabel\": \"Capacity (Wh):\",\n    \"pinLabel\": \"Max Pin A:\",\n    \"dtapLabel\": \"Max D-Tap A:\",\n    \"cameraWattLabel\": \"Power Draw (W):\",\n    \"cameraVoltageLabel\": \"Voltage Range:\",\n    \"cameraPortTypeLabel\": \"Port Type:\",\n    \"cameraPlatesLabel\": \"Battery Plates:\",\n    \"cameraMediaLabel\": \"Recording Media:\",\n    \"cameraLensMountLabel\": \"Lens Mount:\",\n    \"lensDeviceMountHeading\": \"Lens Mount Options\",\n    \"lensDeviceMountLabel\": \"Mount options:\",\n    \"lensDeviceMountHelp\": \"Add every mount this lens supports. Choose \\\"native\\\" when no adapter is required.\",\n    \"lensFocusScaleLabel\": \"Focus scale unit:\",\n    \"lensFocusScaleHelp\": \"Choose the measurement markings shown for this lens. Leave the global default to follow project settings.\",\n    \"lensFocusScaleDefault\": \"Use global focus scale\",\n    \"powerInputsHeading\": \"Power Inputs\",\n    \"powerDistributionHeading\": \"Power Distribution\",\n    \"videoOutputsHeading\": \"Video Outputs\",\n    \"fizConnectorHeading\": \"FIZ Connector\",\n    \"mediaHeading\": \"Media\",\n    \"viewfinderHeading\": \"Viewfinder\",\n    \"lensMountHeading\": \"Lens Mount\",\n    \"timecodeHeading\": \"Timecode\",\n    \"powerDistributionLabel\": \"Outputs:\",\n    \"videoOutputsLabel\": \"Outputs:\",\n    \"fizConnectorLabel\": \"Connectors:\",\n    \"viewfinderLabel\": \"Viewfinders:\",\n    \"timecodeLabel\": \"Timecode:\",\n    \"monitorScreenSizeLabel\": \"Screen Size (in):\",\n    \"monitorBrightnessLabel\": \"Brightness (nits):\",\n    \"monitorWattLabel\": \"Power Draw (W):\",\n    \"monitorVoltageLabel\": \"Voltage Range:\",\n    \"monitorPortTypeLabel\": \"Port Type:\",\n    \"monitorVideoInputsHeading\": \"Video Inputs\",\n    \"monitorVideoInputsLabel\": \"Inputs:\",\n    \"monitorVideoOutputsHeading\": \"Video Outputs\",\n    \"monitorVideoOutputsLabel\": \"Outputs:\",\n    \"monitorWirelessTxLabel\": \"Wireless TX:\",\n    \"monitorLatencyLabel\": \"Latency:\",\n    \"monitorLatencyHelp\": \"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.\",\n    \"monitorAudioOutputLabel\": \"Audio Output:\",\n    \"viewfinderDetailsHeading\": \"Viewfinder Details\",\n    \"viewfinderScreenSizeLabel\": \"Screen Size (in):\",\n    \"viewfinderBrightnessLabel\": \"Brightness (nits):\",\n    \"viewfinderPowerHeading\": \"Power Input\",\n    \"viewfinderWattLabel\": \"Power Draw (W):\",\n    \"viewfinderVoltageLabel\": \"Voltage Range:\",\n    \"viewfinderPortTypeLabel\": \"Port Type:\",\n    \"viewfinderVideoInputsHeading\": \"Video Inputs\",\n    \"viewfinderVideoInputsLabel\": \"Inputs:\",\n    \"viewfinderVideoOutputsHeading\": \"Video Outputs\",\n    \"viewfinderVideoOutputsLabel\": \"Outputs:\",\n    \"viewfinderWirelessTxLabel\": \"Wireless TX:\",\n    \"viewfinderLatencyLabel\": \"Latency:\",\n    \"viewfinderLatencyHelp\": \"Latency is saved even if Wireless TX is off. Clear this field to remove the stored value.\",\n    \"videoPowerInputsHeading\": \"Power Inputs\",\n    \"videoVideoInputsHeading\": \"Video Inputs\",\n    \"videoVideoInputsLabel\": \"Inputs:\",\n    \"videoVideoOutputsHeading\": \"Video Outputs\",\n    \"videoVideoOutputsLabel\": \"Outputs:\",\n    \"videoPowerInputLabel\": \"Connectors:\",\n    \"videoPowerInputHelp\": \"Add every supported power connector, including battery plates. Use notes for mount adapters or other details.\",\n    \"videoPowerTypeLabel\": \"Connector\",\n    \"videoPowerVoltageLabel\": \"Voltage range\",\n    \"videoPowerNotesLabel\": \"Notes\",\n    \"videoPowerVoltagePlaceholder\": \"Voltage range (e.g. 6-28V)\",\n    \"videoPowerNotesPlaceholder\": \"Notes (mount, adapter, etc.)\",\n    \"videoFrequencyLabel\": \"Frequency:\",\n    \"videoLatencyLabel\": \"Latency:\",\n    \"motorConnectorLabel\": \"Connector:\",\n    \"motorInternalLabel\": \"Internal Controller:\",\n    \"motorTorqueLabel\": \"Torque (Nm):\",\n    \"motorGearLabel\": \"Gear Types:\",\n    \"controllerConnectorLabel\": \"Connector:\",\n    \"controllerPowerLabel\": \"Power Source:\",\n    \"controllerBatteryLabel\": \"Battery Type:\",\n    \"controllerConnectivityLabel\": \"Connectivity:\",\n    \"distanceConnectionLabel\": \"Connection:\",\n    \"distanceMethodLabel\": \"Method:\",\n    \"distanceRangeLabel\": \"Range:\",\n    \"distanceAccuracyLabel\": \"Accuracy:\",\n    \"distanceOutputLabel\": \"Display:\",\n    \"notesLabel\": \"Notes:\",\n    \"monitorDetailsHeading\": \"Monitor Details\",\n    \"monitorPowerHeading\": \"Power Input\",\n    \"addDeviceBtn\": \"Add\",\n    \"addDeviceBtnHelp\": \"Add the new device to the database.\",\n    \"updateDeviceBtn\": \"Update\",\n    \"updateDeviceBtnHelp\": \"Save changes to the current device.\",\n    \"editBtn\": \"Edit\",\n    \"editBtnHelp\": \"Modify this device's details.\",\n    \"deleteDeviceBtn\": \"Delete\",\n    \"deleteDeviceBtnHelp\": \"Remove this device from the database.\",\n    \"cancelEditBtn\": \"Cancel\",\n    \"cancelEditBtnHelp\": \"Cancel editing and clear the form.\",\n    \"exportDataBtn\": \"Export Database\",\n    \"exportDataBtnHelp\": \"Download the current device database as a JSON file.\",\n    \"importDataBtn\": \"Import Database\",\n    \"importDataBtnHelp\": \"Load a device database from a JSON file.\",\n    \"alertImportSuccess\": \"Database imported successfully! {num_devices} devices loaded.\",\n    \"alertImportError\": \"Failed to import database. Invalid file or data format.\",\n    \"confirmExportAndRevert\": \"Are you sure you want to export the current database AND then revert to the default database? This will overwrite your current saved data with the original defaults.\",\n    \"alertExportAndRevertSuccess\": \"Database exported and reverted to defaults successfully.\",\n    \"alertStorageError\": \"Storage error: Unable to access local data. Changes may not be saved.\",\n    \"alertSessionFallback\": \"Warning: Local storage is unavailable. Data will only persist for this browser tab.\",\n    \"placeholder_deviceName\": \"Device name\",\n    \"placeholder_watt\": \"e.g. 12.5\",\n    \"placeholder_capacity\": \"e.g. 98\",\n    \"placeholder_pin\": \"e.g. 10\",\n    \"placeholder_dtap\": \"e.g. 5\",\n    \"placeholder_voltage\": \"11V-34V DC\",\n    \"placeholder_port\": \"Bat LEMO 8-pin\",\n    \"placeholder_plates\": \"[{\\\"type\\\":\\\"V-Mount\\\",\\\"mount\\\":\\\"native\\\"}]\",\n    \"placeholder_media\": \"[{\\\"type\\\":\\\"CFast 2.0\\\"}]\",\n    \"placeholder_lensmount\": \"ARRI PL\",\n    \"placeholder_powerdist\": \"[{}]\",\n    \"placeholder_videooutputs\": \"[{}]\",\n    \"placeholder_fizconnector\": \"[{}]\",\n    \"placeholder_timecode\": \"[{}]\",\n    \"placeholder_filter\": \"Filter {item}...\",\n    \"toggleDeviceManager\": \"Edit Device Data\",\n    \"hideDeviceManager\": \"Hide Device Data\",\n    \"showDetails\": \"Show Details\",\n    \"hideDetails\": \"Hide Details\",\n    \"batteryTableLabel\": \"Battery\",\n    \"batteryLifeHeading\": \"Runtime comparison\",\n    \"runtimeLabel\": \"Estimated Runtime (h)\",\n    \"batteryLifeUnit\": \"hrs\",\n    \"runtimeAverageNote\": \"Note: runtime estimate uses a weighted average of user-submitted runtimes adjusted for resolution, codec, frame rate, brightness and temperature.\",\n    \"runtimeUserCountNote\": \"Based on {count} user reports for this project.\",\n    \"temperatureNoteHeading\": \"Temperature impact on runtime:\",\n    \"temperatureNoteHelp\": \"Shows how different temperatures affect battery runtime.\",\n    \"temperatureLabel\": \"Temperature\",\n    \"batteryCountTempLabel\": \"Batteries needed\",\n    \"noBatterySupports\": \"No battery can supply this load.\",\n    \"alertSetupName\": \"Please enter a name for the project.\",\n    \"alertSetupNeedsDevice\": \"You can save a project even if no devices are selected yet.\",\n    \"alertSetupSaved\": \"Project \\\"{name}\\\" saved in this browser. It stays available after closing or reopening tabs unless you clear the browser cache.\",\n    \"alertSetupSavedNoDevices\": \"Project \\\"{name}\\\" saved in this browser with no devices yet. Add gear and requirements whenever you're readywe'll keep everything protected.\",\n    \"alertSetupRenameSaveFailed\": \"We couldnt finish saving the renamed project. Your original project is still availableplease try saving again to keep everything in sync.\",\n    \"alertNoSetupSelected\": \"Please select a saved project to delete.\",\n    \"alertNoSetupSelectedTitle\": \"No Project Selected\",\n    \"alertSetupDeleted\": \"Project \\\"{name}\\\" deleted.\",\n    \"confirmDeleteSetup\": \"Really delete project \\\"{name}\\\"?\",\n    \"confirmDeleteSetupAgain\": \"This will permanently delete the project. Are you sure?\",\n    \"confirmDeleteDevice\": \"Really delete device \\\"{name}\\\"?\",\n    \"alertDeviceExists\": \"A device with this name already exists in this category.\",\n    \"alertDeviceAdded\": \"Device \\\"{name}\\\" added to category \\\"{category}\\\".\",\n    \"alertDeviceUpdated\": \"Device \\\"{name}\\\" updated in category \\\"{category}\\\".\",\n    \"alertDeviceFields\": \"Please provide valid values for capacity, Pin A and D-Tap A.\",\n    \"alertDeviceWatt\": \"Please enter a valid watt value.\",\n    \"alertDeviceName\": \"Device name cannot be empty.\",\n    \"alertInvalidCameraJSON\": \"Invalid JSON for camera details\",\n    \"generateOverviewBtn\": \"Generate Overview\",\n    \"generateGearListBtn\": \"Generate Kit List and Production Requirements\",\n    \"addExtraGearBtn\": \"Add temporary extra gear\",\n    \"editProjectBtn\": \"Edit Project requirements\",\n    \"projectForm\": {\n      \"heading\": \"Production Requirements\",\n      \"projectName\": \"Project Name:\",\n      \"productionCompany\": \"Production Company:\",\n      \"productionCompanyAddress\": \"Production Company Address (optional):\",\n      \"productionCompanyStreet\": \"Street address\",\n      \"productionCompanyStreetPlaceholder\": \"123 Production Way\",\n      \"productionCompanyStreet2\": \"Address line 2 (optional)\",\n      \"productionCompanyStreet2Placeholder\": \"Suite, building, etc.\",\n      \"productionCompanyCity\": \"City\",\n      \"productionCompanyCityPlaceholder\": \"Los Angeles\",\n      \"productionCompanyRegion\": \"State / Province / Region\",\n      \"productionCompanyRegionPlaceholder\": \"California\",\n      \"productionCompanyPostalCode\": \"Postal code\",\n      \"productionCompanyPostalCodePlaceholder\": \"90001\",\n      \"productionCompanyCountry\": \"Country\",\n      \"productionCompanyCountryPlaceholder\": \"United States\",\n      \"rentalHouse\": \"Rental:\",\n      \"crewHeading\": \"Crew\",\n      \"prepLabel\": \"Prep Days:\",\n      \"shootLabel\": \"Shooting Days:\",\n      \"returnLabel\": \"Return Day(s):\",\n      \"deliveryResolution\": \"Delivery Resolution:\",\n      \"recordingResolution\": \"Recording Resolution:\",\n      \"sensorMode\": \"Sensor Mode:\",\n      \"aspectRatio\": \"Aspect Ratio:\",\n      \"codec\": \"Codec:\",\n      \"baseFrameRate\": \"Base Frame Rate:\",\n      \"recordingFrameRate\": \"Recording Frame Rate:\",\n      \"recordingFrameRateRangeHint\": \"Enter a recording frame rate from 1 to {max} fps.\",\n      \"recordingFrameRateDefaultHint\": \"Enter the recording frame rate in frames per second.\",\n      \"slowMotionHeading\": \"Slow Motion Frame Rate\",\n      \"slowMotionRecordingResolution\": \"Slow Motion Recording Resolution:\",\n      \"slowMotionSensorMode\": \"Slow Motion Sensor Mode:\",\n      \"slowMotionAspectRatio\": \"Slow Motion Aspect Ratio:\",\n      \"slowMotionBaseFrameRate\": \"Slow Motion Base Frame Rate:\",\n      \"slowMotionRecordingFrameRate\": \"Slow Motion Recording Frame Rate:\",\n      \"slowMotionRecordingFrameRateRangeHint\": \"Enter a slow motion recording frame rate from 1 to {max} fps.\",\n      \"slowMotionRecordingFrameRateDefaultHint\": \"Enter the slow motion recording frame rate in frames per second.\",\n      \"lensesHeading\": \"Lenses\",\n      \"lensManufacturerStep\": \"Step 1: Select manufacturer\",\n      \"lensManufacturerPlaceholder\": \"Choose a manufacturer\",\n      \"lensSeriesStep\": \"Step 2: Select series\",\n      \"lensSeriesPlaceholder\": \"Choose a series\",\n      \"lensSeriesEmpty\": \"No series available for this manufacturer.\",\n      \"lensesLabel\": \"Step 3: Choose lenses\",\n      \"lensOptionsEmpty\": \"No lenses available for this series.\",\n      \"lensSelectionsLabel\": \"Selected lenses\",\n      \"lensSelectionsHint\": \"Selections update as you add or remove lenses.\",\n      \"lensRemoveLabel\": \"Remove {lens}\",\n      \"lensMountLabel\": \"Mount\",\n\n      \"riggingHeading\": \"Rigging & Mounting\",\n      \"requiredScenarios\": \"Shooting Scenarios & Environments\",\n      \"cameraHandle\": \"Camera Handle:\",\n      \"viewfinderExtension\": \"Viewfinder Extension:\",\n      \"viewfinderExtensionNone\": \"No\",\n      \"viewfinderExtensionYes\": \"Yes\",\n      \"matteboxFilterHeading\": \"Mattebox and Filter\",\n      \"mattebox\": \"Mattebox:\",\n      \"filter\": \"Filter:\",\n      \"storageHeading\": \"Storage & Media\",\n      \"storageNeedsLabel\": \"Recording media needs:\",\n      \"storageQuantityLabel\": \"Quantity\",\n      \"storageTypeLabel\": \"Media type:\",\n      \"storageVariantLabel\": \"Brand & capacity:\",\n      \"storageNotesLabel\": \"Notes:\",\n      \"storageTypePlaceholder\": \"Select media type\",\n      \"storageVariantPlaceholder\": \"Select brand & size\",\n      \"storageNotesPlaceholder\": \"Add notes (brand, capacity, recorder...)\",\n      \"storageDuplicateEntry\": \"Duplicate media row\",\n      \"storageSummaryFallback\": \"Media\",\n      \"monitoringHeading\": \"Monitoring\",\n      \"monitoringConfiguration\": \"Camera Monitoring Configuration:\",\n      \"viewfinderSettings\": \"Viewfinder Settings:\",\n      \"frameGuides\": \"Frameguides:\",\n      \"aspectMaskOpacity\": \"Aspect Mask Opacity:\",\n      \"videoDistribution\": \"Video distribution:\",\n      \"monitorUserButtons\": \"Onboard Monitor User Buttons:\",\n      \"cameraUserButtons\": \"Camera User Buttons:\",\n      \"viewfinderUserButtons\": \"Viewfinder User Buttons:\",\n      \"userButtonFunctions\": {\n        \"user1\": \"User 1\",\n        \"user2\": \"User 2\",\n        \"user3\": \"User 3\",\n        \"user4\": \"User 4\",\n        \"toggleLut\": \"Toggle LUT\",\n        \"falseColor\": \"False Color\",\n        \"peaking\": \"Peaking\",\n        \"anamorphicDesqueeze\": \"Anamorphic Desqueeze\",\n        \"surroundView\": \"Surround View\",\n        \"oneToOneZoom\": \"1:1 Zoom\",\n        \"waveform\": \"Waveform\",\n        \"histogram\": \"Histogram\",\n        \"vectorscope\": \"Vectorscope\",\n        \"zebra\": \"Zebra\",\n        \"playback\": \"Playback\",\n        \"record\": \"Record\",\n        \"zoom\": \"Zoom\",\n        \"frameLines\": \"Frame Lines\",\n        \"frameGrab\": \"Frame Grab\",\n        \"wb\": \"WB\",\n        \"iso\": \"ISO\",\n        \"nd\": \"ND\",\n        \"fps\": \"FPS\",\n        \"shutter\": \"Shutter\"\n      },\n      \"tripodPreferencesHeading\": \"Tripod Preferences\",\n      \"tripodHeadBrand\": \"Head Brand:\",\n      \"tripodBowl\": \"Bowl type:\",\n      \"tripodTypes\": \"Tripod types:\",\n      \"tripodSpreader\": \"Spreader Preference:\",\n      \"cancel\": \"Cancel\",\n      \"addEntry\": \"Add\",\n      \"removeEntry\": \"Remove\",\n      \"submit\": \"OK\",\n      \"crewNamePlaceholder\": \"Name\",\n      \"crewPhonePlaceholder\": \"Phone\",\n      \"crewEmailPlaceholder\": \"Email\",\n      \"crewWebsitePlaceholder\": \"Website\",\n      \"crewRoleLabel\": \"Crew role\",\n      \"crewNameLabel\": \"Crew member name\",\n      \"crewPhoneLabel\": \"Crew member phone\",\n      \"crewEmailLabel\": \"Crew member email\",\n      \"crewWebsiteLabel\": \"Crew member website\"\n    },\n    \"projectFields\": {\n      \"productionCompany\": \"Production Company\",\n      \"productionCompanyAddress\": \"Production Company Address\",\n      \"productionCompanyStreet\": \"Street address\",\n      \"productionCompanyStreetPlaceholder\": \"123 Production Way\",\n      \"productionCompanyStreet2\": \"Address line 2 (optional)\",\n      \"productionCompanyStreet2Placeholder\": \"Suite, building, etc.\",\n      \"productionCompanyCity\": \"City\",\n      \"productionCompanyCityPlaceholder\": \"Los Angeles\",\n      \"productionCompanyRegion\": \"State / Province / Region\",\n      \"productionCompanyRegionPlaceholder\": \"California\",\n      \"productionCompanyPostalCode\": \"Postal code\",\n      \"productionCompanyPostalCodePlaceholder\": \"90001\",\n      \"productionCompanyCountry\": \"Country\",\n      \"productionCompanyCountryPlaceholder\": \"United States\",\n      \"rentalHouse\": \"Rental\",\n      \"rentalHouseContact\": \"Rental contact\",\n      \"rentalHouseAddress\": \"Rental address\",\n      \"crew\": \"Crew\",\n      \"prepDays\": \"Prep Days\",\n      \"shootingDays\": \"Shooting Days\",\n      \"returnDays\": \"Return Days\",\n      \"deliveryResolution\": \"Delivery Resolution\",\n      \"recordingResolution\": \"Recording Resolution\",\n      \"aspectRatio\": \"Aspect Ratio\",\n      \"codec\": \"Codec\",\n      \"baseFrameRate\": \"Base Frame Rate\",\n      \"recordingFrameRate\": \"Recording Frame Rate\",\n      \"slowMotionRecordingResolution\": \"Slow Motion Recording Resolution\",\n      \"slowMotionSensorMode\": \"Slow Motion Sensor Mode\",\n      \"slowMotionAspectRatio\": \"Slow Motion Aspect Ratio\",\n      \"slowMotionBaseFrameRate\": \"Slow Motion Base Frame Rate\",\n      \"slowMotionRecordingFrameRate\": \"Slow Motion Recording Frame Rate\",\n      \"sensorMode\": \"Sensor Mode\",\n      \"lenses\": \"Lenses\",\n      \"requiredScenarios\": \"Required Scenarios\",\n      \"cameraHandle\": \"Camera Handle\",\n      \"viewfinderExtension\": \"Viewfinder Extension\",\n      \"viewfinderEyeLeatherColor\": \"Viewfinder Eye Leather Color\",\n      \"mattebox\": \"Mattebox\",\n      \"gimbal\": \"Gimbal\",\n      \"videoDistribution\": \"Video Distribution\",\n      \"monitoringSupport\": \"Monitoring support\",\n      \"monitoringConfiguration\": \"Monitoring configuration\",\n      \"focusMonitor\": \"Focus Monitor\",\n      \"monitorUserButtons\": \"Onboard Monitor User Buttons\",\n      \"cameraUserButtons\": \"Camera User Buttons\",\n      \"viewfinderUserButtons\": \"Viewfinder User Buttons\",\n      \"tripodHeadBrand\": \"Tripod Head Brand\",\n      \"tripodBowl\": \"Tripod Bowl\",\n      \"tripodTypes\": \"Tripod Types\",\n      \"tripodSpreader\": \"Tripod Spreader\",\n      \"sliderBowl\": \"Slider Bowl\",\n      \"easyrig\": \"Further Stabilisation\",\n      \"storageRequirements\": \"Storage & Media\"\n    },\n    \"crewRoles\": {\n      \"Producer\": \"Producer\",\n      \"Production Manager\": \"Production Manager\",\n      \"Director\": \"Director\",\n      \"Assistant Director\": \"1st AD\",\n      \"Production Assistant\": \"Production Assistant\",\n      \"DoP\": \"DoP\",\n      \"Camera Operator\": \"Camera Operator\",\n      \"B-Camera Operator\": \"B-Camera Operator\",\n      \"Steadicam Operator\": \"Steadicam Operator\",\n      \"Drone Operator\": \"Drone Operator\",\n      \"1st AC\": \"1st AC\",\n      \"2nd AC\": \"2nd AC\",\n      \"DIT\": \"DIT\",\n      \"Video Operator\": \"Video Operator\",\n      \"Key Gaffer\": \"Gaffer\",\n      \"Gaffer\": \"Electric\",\n      \"Best Boy Electric\": \"Best Boy Electric\",\n      \"Electrician\": \"Electrician\",\n      \"Rigging Gaffer\": \"Rigging Gaffer\",\n      \"Key Grip\": \"Key Grip\",\n      \"Best Boy Grip\": \"Best Boy Grip\",\n      \"Grip\": \"Grip\",\n      \"Dolly Grip\": \"Dolly Grip\",\n      \"Rigging Grip\": \"Rigging Grip\"\n    },\n    \"scenarios\": {\n      \"Indoor\": \"Indoor\",\n      \"Outdoor\": \"Outdoor\",\n      \"Studio\": \"Studio\",\n      \"Tripod\": \"Tripod\",\n      \"Handheld\": \"Handheld\",\n      \"Easyrig\": \"Easyrig\",\n      \"Cine Saddle\": \"Cine Saddle\",\n      \"Steadybag\": \"Steadybag\",\n      \"Dolly\": \"Dolly\",\n      \"Slider\": \"Slider\",\n      \"Steadicam\": \"Steadicam\",\n      \"Gimbal\": \"Gimbal\",\n      \"Trinity\": \"Trinity\",\n      \"Rollcage\": \"Rollcage\",\n      \"Car Mount\": \"Car Mount\",\n      \"Jib\": \"Jib\",\n      \"Undersling mode\": \"Undersling Mode\",\n      \"Crane\": \"Crane\",\n      \"Remote Head\": \"Remote Head\",\n      \"Extreme cold (snow)\": \"Extreme Cold (Snow)\",\n      \"Extreme rain\": \"Extreme Rain\",\n      \"Extreme heat\": \"Extreme Heat\",\n      \"Rain Machine\": \"Rain Machine\",\n      \"Slow Motion\": \"Slow Motion\",\n      \"Battery Belt\": \"Battery Belt\"\n    },\n    \"gearListNoteLabel\": \"Note:\",\n    \"gearListAutosaveNote\": \"Autosaved after each rig tweak so the offline gear manifest mirrors your latest camera build.\",\n    \"gearListAddCustomItem\": \"Add custom item\",\n    \"gearListAddCustomItemToCategory\": \"Add custom item to {category}\",\n    \"gearListRemoveCustomItem\": \"Remove\",\n    \"gearListRemoveCustomItemFromCategory\": \"Remove custom item from {category}\",\n    \"gearListCustomItemQuantityLabel\": \"Quantity\",\n    \"gearListCustomItemQuantityAria\": \"Quantity for custom item in {category}\",\n    \"gearListCustomItemNameLabel\": \"Item name\",\n    \"gearListCustomItemNameAria\": \"Item name for custom item in {category}\",\n    \"gearListCustomItemNamePlaceholder\": \"Custom item\",\n    \"gearListCustomItemPreviewFallback\": \"Custom item\",\n    \"gearListCartSelectorLabel\": \"Camera cart\",\n    \"gearListCartConfigurationLabel\": \"Cart configuration\",\n    \"gearListCartAccessoriesLabel\": \"Cart accessories\",\n    \"gearListExcludeRentalToggle\": \"Exclude for rental\",\n    \"gearListIncludeRentalToggle\": \"Include for rental\",\n    \"gearListRentalNote\": \"Rental handles this item\",\n    \"gearListEditProviderLabel\": \"Provided by\",\n    \"gearListEditProviderHelp\": \"Select who provides this item. Rental stays the default unless the item is in your own gear list.\",\n    \"gearListProviderRental\": \"Rental\",\n    \"gearListProviderUser\": \"User\",\n    \"gearListProviderCrewHeading\": \"Crew\",\n    \"gearListProviderUnknown\": \"Custom provider\",\n    \"gearListEditOwnedLabel\": \"Owned\",\n    \"gearListEditOwnedHelp\": \"Add or remove this line from your Own Gear list to keep your inventory in sync.\",\n    \"gearListOwnedExportLabel\": \"Owned by %s\",\n    \"gearListEditCameraLinkLabel\": \"Camera link\",\n    \"gearListEditCameraAssignmentLabel\": \"Camera designation\",\n    \"gearListEditCameraAssignmentHelp\": \"Pick the letter for this camera body. Linked accessories will share its color.\",\n    \"gearListEditCameraLinkHelp\": \"Highlight items that should follow a specific camera letter so crews know which kit moves together.\",\n    \"gearListEditCameraLinkNoneOption\": \"No camera link\",\n    \"gearListEditCameraLinkCameraOption\": \"Camera %s  %s\",\n    \"gearListEditCameraLinkUnavailableOption\": \"Camera %s (unassigned)\",\n    \"gearListEditCameraLinkDefaultLabel\": \"Camera %s\",\n    \"gearListCameraLinkBadgeLabel\": \"Linked to camera\",\n    \"gearListEditDialogTitle\": \"Edit gear item\",\n    \"gearListEditQuantityLabel\": \"Quantity\",\n    \"gearListEditNameLabel\": \"Item name\",\n    \"gearListEditAttributesLabel\": \"Attributes\",\n    \"gearListEditNoteLabel\": \"Note\",\n    \"gearListEditExtraLabel\": \"Temporary extra gear\",\n    \"gearListEditExtraHelp\": \"Flag this item as a short-term addition. Set the period so everyone schedules it correctly.\",\n    \"gearListEditExtraStartLabel\": \"Needed from\",\n    \"gearListEditExtraEndLabel\": \"Needed until\",\n    \"gearListEditExtraPeriodHelp\": \"Leave the dates blank when the schedule is still tentative.\",\n    \"gearListExtraCategoryLabel\": \"Temporary Extras\",\n    \"gearListExtraIndicatorRange\": \"Temporary extra: %s  %s\",\n    \"gearListExtraIndicatorOpen\": \"Temporary extra from %s\",\n    \"gearListExtraIndicatorEnd\": \"Temporary extra until %s\",\n    \"gearListExtraIndicatorNoPeriod\": \"Temporary extra\",\n    \"gearListEditRentalLabel\": \"Exclude from rental\",\n    \"gearListEditSave\": \"Save\",\n    \"gearListEditCancel\": \"Cancel\",\n    \"gearListEditButton\": \"Edit gear item\",\n    \"gearListEditCustomItem\": \"Edit custom item\",\n    \"gearListEditReset\": \"Reset name\",\n    \"gearListEditDeviceHeading\": \"Device attributes\",\n    \"gearListEditDeviceEdit\": \"Edit device attributes\",\n    \"gearListEditDeviceEmpty\": \"No device attributes recorded yet. Update the device to add details.\",\n    \"gearListEditDeviceCategory\": \"Device library: %s\",\n    \"gearListLensCoverageWarning\": \"This lens may not cover the full sensor of this camera!\",\n    \"autoGearHighlightToggle\": \"Highlight automatic gear\",\n    \"autoGearHighlightToggleHelp\": \"Toggle a temporary color overlay for gear added by automatic rules. Useful while debugging gear rule behavior.\",\n    \"autoGearHighlightToggleStateOn\": \"On\",\n    \"autoGearHighlightToggleStateOff\": \"Off\",\n    \"deleteGearListBtn\": \"Delete Kit List\",\n    \"deleteGearListBtnHelp\": \"Remove the saved kit list from this project and hide the table.\",\n    \"deleteGearListDialogTitle\": \"Delete Gear List\",\n    \"deleteGearListConfirmLabel\": \"Delete\",\n    \"confirmDeleteGearList\": \"Delete kit list?\",\n    \"deleteGearListConfirmAgainTitle\": \"Are you sure?\",\n    \"deleteGearListConfirmAgainLabel\": \"Confirm Delete\",\n    \"confirmDeleteGearListAgain\": \"This will permanently delete the kit list. Are you sure?\",\n    \"ownGearDialogTitle\": \"Own gear\",\n    \"ownGearDialogDescription\": \"Capture the equipment you personally own so you can plan around what's already in your kit.\",\n    \"ownGearAddHeading\": \"Add gear\",\n    \"ownGearAddHelp\": \"Start typing to search our catalog for suggestions or describe custom items you own. Entries save immediately.\",\n    \"ownGearNameLabel\": \"Item\",\n    \"ownGearNamePlaceholder\": \"Lens, monitor, adapter\",\n    \"ownGearNameHelp\": \"Required. Use the exact model name so suggestions and exports stay clear.\",\n    \"ownGearQuantityLabel\": \"Quantity\",\n    \"ownGearQuantityPlaceholder\": \"1\",\n    \"ownGearQuantityHelp\": \"Enter how many of this item you own. Leave blank when it varies.\",\n    \"ownGearNotesLabel\": \"Notes\",\n    \"ownGearNotesPlaceholder\": \"Condition, accessories, case number\",\n    \"ownGearNotesHelp\": \"Optional notes about accessories, serial numbers or case locations.\",\n    \"ownGearSaveButton\": \"Save item\",\n    \"ownGearUpdateButton\": \"Update item\",\n    \"ownGearResetButton\": \"Reset form\",\n    \"ownGearCloseButton\": \"Close\",\n    \"ownGearListHeading\": \"Your gear\",\n    \"ownGearListEmpty\": \"No gear saved yet. Add the equipment you own to reuse it across projects.\",\n    \"ownGearListSummaryOne\": \"%s item tracked\",\n    \"ownGearListSummaryOther\": \"%s items tracked\",\n    \"ownGearEditButton\": \"Edit\",\n    \"ownGearEditButtonAria\": \"Edit %s\",\n    \"ownGearDeleteButton\": \"Remove\",\n    \"ownGearDeleteButtonAria\": \"Remove %s from your own gear list\",\n    \"ownGearDeleteConfirm\": \"Remove %s from your own gear list? This only removes it from your inventory.\",\n    \"ownGearQuantityInvalid\": \"Enter a non-negative quantity or leave the field blank.\",\n    \"ownGearNameRequired\": \"Enter the item name to save it.\",\n    \"alertSelectSetupForOverview\": \"Please select a saved project to generate an overview.\",\n    \"overviewTitle\": \"Project Overview\",\n    \"backToAppBtn\": \"Back to App\",\n    \"printBtn\": \"Print\",\n    \"exportPdfBtn\": \"Export PDF / Print\",\n    \"exportRentalPdfBtn\": \"Export PDF for Rental\",\n    \"rentalPrintDialogTitle\": \"Export PDF / Print\",\n    \"rentalPrintDialogDescription\": \"Choose what to include before exporting or printing.\",\n    \"rentalPrintDialogSectionsLabel\": \"Sections to include\",\n    \"rentalPrintDialogConfirm\": \"Export PDF\",\n    \"rentalPrintDialogCancel\": \"Cancel\",\n    \"rentalPrintDialogSelectAll\": \"Select all\",\n    \"printOptionsLayoutLabel\": \"Layout\",\n    \"printOptionsLayoutStandard\": \"Standard layout\",\n    \"printOptionsLayoutRental\": \"Rental-friendly layout\",\n    \"rentalPrintSectionProject\": \"Production Requirements\",\n    \"rentalPrintSectionDevices\": \"Camera Package Devices\",\n    \"rentalPrintSectionPower\": \"Power Summary\",\n    \"rentalPrintSectionDiagram\": \"Power Diagram\",\n    \"rentalPrintSectionGearList\": \"Kit List\",\n    \"rentalPrintSectionBattery\": \"Battery Comparison\",\n    \"pdfWarningsHeading\": \"Warnings\",\n    \"exportAndRevertBtn\": \"Export and revert to default database\",\n    \"exportAndRevertBtnHelp\": \"Export your database and restore default entries.\",\n    \"helpButtonLabel\": \"Help\",\n    \"helpButtonTitle\": \"Help (press ?, H, F1 or Ctrl+/)\",\n    \"helpButtonHelp\": \"Open the help dialog for step-by-step guidance. Keyboard shortcuts: F1, Ctrl + /, Cmd + /, ? or H.\",\n    \"helpButtonShortcuts\": \"F1; Ctrl + /; Cmd + /; ?; H\",\n    \"helpButtonAriaShortcuts\": \"F1 Control+Slash Meta+Slash Shift+Slash KeyH\",\n    \"helpClose\": \"Close (Esc)\",\n    \"helpCloseHelp\": \"Close the help dialog and return to the planner (press Esc).\",\n    \"helpTitle\": \"How to use\",\n    \"helpSearchPlaceholder\": \"Search help topics...\",\n    \"helpSearchLabel\": \"Search help topics\",\n    \"helpResultsSummaryAll\": \"All %s help topics are shown.\",\n    \"helpResultsSummaryFiltered\": \"Showing %1$s of %2$s help topics for %3$s.\",\n    \"helpResultsAssist\": \"Tip: Press Tab to move into the quick links, or press Enter to open the top visible topic.\",\n    \"helpNoResults\": \"No help topics match your search. Try shorter keywords, synonyms, or clear the field to browse everything.\",\n    \"helpNoResultsSuggestionsHeading\": \"Need a different result?\",\n    \"helpNoResultsSuggestionsIntro\": \"Try these steps to get back on track while keeping your data safe and confirming offline safeguards:\",\n    \"helpNoResultsSuggestionClear\": \"Use %s to browse every article again.\",\n    \"helpNoResultsSuggestionSynonyms\": \"Search for equipment nicknames, battery part numbers, or shorter keywords.\",\n    \"helpNoResultsSuggestionQuickStart\": \"Jump to the %s for a guided refresher on saving, sharing, and backups.\",\n    \"helpNoResultsSuggestionBackup\": \"Open %1$s, start a %2$s to confirm your offline exports, and review Settings  Data & Storage for the latest autosave timestamp before you continue.\",\n    \"helpOnboardingTutorialCopy\": \"to follow every workflow with offline progress trackingincluding the Power Summary checkpoint and the offline safety net drillbefore configuring your first project. Use the step navigator and progress meter to review completed sections offline.\",\n    \"onboardingTour\": {\n      \"startLabel\": \"Start guided tutorial\",\n      \"restartLabel\": \"Replay guided tutorial\",\n      \"resumeLabel\": \"Resume guided tutorial\",\n      \"skipLabel\": \"Skip tutorial\",\n      \"backLabel\": \"Back\",\n      \"nextLabel\": \"Next\",\n      \"introStartLabel\": \"Start onboarding tour\",\n      \"doneLabel\": \"Finish tutorial\",\n      \"stepIndicator\": \"Step {current} of {total}\",\n      \"completionIndicator\": \"First project secured offline\",\n      \"prefaceIndicator\": \"Welcome\",\n      \"stepListAriaLabel\": \"Tutorial steps\",\n      \"stepStatusCurrent\": \"Current step\",\n      \"stepStatusComplete\": \"Completed\",\n      \"stepStatusUpcoming\": \"Up next\",\n      \"resumeHint\": \"Picking up right where you paused. Use the step navigator to revisit earlier workflows without clearing offline progress.\",\n      \"resumeHintDetailed\": \"Resuming at step {current} of {total}. {completed} steps are already complete and locked into your offline saves.\",\n      \"userProfileInteractionIntro\": \"Enter your crew details once. Each update syncs to Contacts instantly, stays cached offline and flows into exports so crews always know who owns the setup.\",\n      \"userProfileInteractionSkipHint\": \"Press Next when you are readyContacts in the sidebar always shows these saved details without resetting tutorial progress.\",\n      \"userProfileAvatarAction\": \"Add profile photo\",\n      \"userProfileAvatarEditAction\": \"Edit photo\",\n      \"projectRequirementsMiniIntro\": \"Fill these proxy fields while the Production Requirements dialog stays open.\",\n      \"projectRequirementsMiniOfflineHint\": \"Every edit saves offline instantlyuse Back/Next here without risking data loss.\",\n      \"unitsPreferencesLanguageLabel\": \"Language\",\n      \"unitsPreferencesThemeLabel\": \"Theme\",\n      \"unitsPreferencesThemeLight\": \"Light\",\n      \"unitsPreferencesThemeDark\": \"Dark\",\n      \"unitsPreferencesPinkLabel\": \"Pink mode accents\",\n      \"unitsPreferencesPinkOff\": \"Disabled\",\n      \"unitsPreferencesPinkOn\": \"Enabled\",\n      \"unitsPreferencesUnitsLabel\": \"Temperature units\",\n      \"unitsPreferencesPersistenceHint\": \"Request persistent storage so the browser keeps planner data even when space runs low.\",\n      \"unitsPreferencesPersistenceAction\": \"Protect storage on this device\",\n      \"progressMeterLabel\": \"Tutorial progress\",\n      \"progressValueLabel\": \"Completed {completed} of {total} steps\",\n      \"resumeLabelWithProgress\": \"Resume guided tutorial ({completed}/{total} complete)\",\n      \"helpStatusNotStarted\": \"Guided tutorial progress saves offline as you advance. Up next: {next}.\",\n      \"helpStatusInProgress\": \"Offline progress saved: {completed} steps completed out of {total}. Next workflow: {next}.\",\n      \"helpStatusResume\": \"Paused on {current}. {completed} of {total} steps already secured offline.\",\n      \"helpStatusSkipped\": \"Tutorial skipped. Restart whenever you're readysaved progress stays available offline.\",\n      \"helpStatusCompleted\": \"Tutorial completed. Replay any step anytime for a refresher.\",\n      \"helpStatusLastCompleted\": \"Last completed: {step} ({timeAgo}).\",\n      \"helpStatusLastUpdated\": \"Last update: {timeAgo}.\",\n      \"helpStatusTimeJustNow\": \"just now\",\n      \"helpStatusTimeMinute\": \"1 minute ago\",\n      \"helpStatusTimeMinutes\": \"{count} minutes ago\",\n      \"helpStatusTimeHour\": \"1 hour ago\",\n      \"helpStatusTimeHours\": \"{count} hours ago\",\n      \"helpStatusTimeDay\": \"1 day ago\",\n      \"helpStatusTimeDays\": \"{count} days ago\",\n      \"skipConfirmationTitle\": \"Skip the guided tutorial?\",\n      \"skipConfirmationBody\": \"You can reopen the tutorial from Help or use the step navigator to replay any section later.\",\n      \"skipConfirmationAccept\": \"Skip tutorial\",\n      \"skipConfirmationCancel\": \"Continue tutorial\",\n      \"steps\": {\n        \"intro\": {\n          \"hero\": {\n            \"heading\": \"Welcome to Cine Power Planner!\",\n            \"subheading\": \"Safeguard every camera setup with power checks, AutoGear kits, and rental-ready handoffskept fully offline.\",\n            \"summary\": \"Plan safe camera setups, verify power limits, auto-build kit lists from production requirements, and export rental-ready PDFsevery save stays local before call time.\",\n            \"badgeIcon\": \"\",\n            \"badgeLabel\": \"Crew-first  Offline forever\",\n            \"badgeDescription\": \"No servers, no accounts, no subscriptions. Every save, autosave, backup, restore, share, and import lives on this device.\",\n            \"highlights\": [\n              {\n                \"icon\": \"\",\n                \"title\": \"Lock in power, safety, and backups\",\n                \"body\": \"Model draw, runtime, changeovers, and redundant pack coverage so battery safety margins are confirmed before rolling.\"\n              },\n              {\n                \"icon\": \"\",\n                \"title\": \"AutoGear builds reusable kits\",\n                \"body\": \"Generate full kit lists from shooting scenarios with AutoGear rules, adjust those rules for the day, and reuse the presets.\"\n              },\n              {\n                \"icon\": \"\",\n                \"title\": \"Project requirements ready to hand off\",\n                \"body\": \"Track requirements, crew coverage, and rental notes, then export PDF packets the crew, rental, and production rely on.\"\n              },\n              {\n                \"icon\": \"\",\n                \"title\": \"Offline-first, subscription-free PWA\",\n                \"body\": \"Run the planner entirely offline, install it as a mobile PWA, and keep workflows available without subscriptions or servers.\"\n              },\n              {\n                \"icon\": \"\",\n                \"title\": \"Data is sacred\",\n                \"body\": \"Autosave, backup/restore, share, and import safeguards protect every project snapshot. Restore rehearsals prove nothing is lost.\"\n              }\n            ],\n            \"languageLabel\": \"Language\",\n            \"languageHint\": \"Choose the interface language so this tour, the help center, and exports translate instantly across offline saves.\",\n            \"offlineSummary\": \"Cine Power Planner is built for field reliability: offline by default, installable on mobile, and always storing redundant saves locally so crews retain control of their data.\"\n          }\n        },\n        \"userProfile\": {\n          \"title\": \"Complete your crew profile\",\n          \"body\": \"Set your display name, role, phone, email and photo. Each update syncs to Contacts immediately, stays in offline saves and appears on exports.\"\n        },\n        \"unitsPreferences\": {\n          \"title\": \"Tune theme and units\",\n          \"body\": \"Open Settings  General to choose the theme, optional pink highlights, focus scale and temperature units. Request persistent storage so the browser keeps preferences and safeguards saves during cleanups.\"\n        },\n        \"nameProject\": {\n          \"title\": \"Name your first project\",\n          \"body\": \"Give the project a descriptive name to anchor autosave, history, exports and backups. Every workflow references it so your offline library stays organized and easy to restore.\"\n        },\n        \"saveProject\": {\n          \"title\": \"Capture an immediate save\",\n          \"body\": \"Select Save (or press Ctrl+S/S/Enter) to capture a complete offline snapshotdevices, power math, requirements, notes and diagnostics. The next workflow unlocks once the save finishes.\"\n        },\n        \"addCamera\": {\n          \"title\": \"Select the primary camera\",\n          \"body\": \"Choose the camera body you are planning. Offline search works inside the menu. That selection unlocks matching accessories, power draws and diagrams.\"\n        },\n        \"addMonitoring\": {\n          \"title\": \"Add monitors, wireless video and FIZ\",\n          \"body\": \"Pick onboard monitors, wireless transmitters and FIZ motors or controllers. Each selection feeds runtime math, diagrams and automatic gear rules so the generated kit reflects the full build.\"\n        },\n        \"selectBattery\": {\n          \"title\": \"Choose batteries\",\n          \"body\": \"Select the battery system that powers the rig. Runtime projections update immediately and the selection is stored with your offline project snapshots and backups.\"\n        },\n        \"resultsTotalDraw\": {\n          \"title\": \"Power Summary: Total draw\",\n          \"body\": \"Start your Power Summary review by confirming the Total Draw card and peak load so the demand math stays accurate before moving on to deeper checks.\"\n        },\n        \"resultsBatteryPacks\": {\n          \"title\": \"Power Summary: Battery runtimes\",\n          \"body\": \"Review each battery pack's projected runtime, all framed around a worst-case draw so most kits run longerhelping you know how many packs to bring, feel confident the rig won't demand constant swaps, and automatically pair the right batteries with each camera.\"\n        },\n        \"resultsChangeover\": {\n          \"title\": \"Power Summary: Changeovers\",\n          \"body\": \"Use the changeover card to review the category-by-category draw chart, see exactly which devices contribute the most load, and confirm every swap sequence keeps enough headroom. The breakdown ties each accessory to its watt draw so the next charged pack is staged for the hungriest circuit and the saved snapshot captures the latest handoff plan.\"\n        },\n        \"resultsWarnings\": {\n          \"title\": \"Power Summary: Warnings and backups\",\n          \"body\": \"Check the connector warning boxes: green shows the pin or D-Tap battery feed is safe, yellow means the feed is near its limit, and red means the rig is pulling more than that line can supply. Change out batteries and devices to get both boxes to appear green again. Rest assured the warnings keep you from pushing higher loads than a battery can safely handle.\"\n        },\n        \"batteryComparison\": {\n          \"title\": \"Battery Comparison\",\n          \"body\": \"Battery Comparison evaluates alternate packs side by side so you can lock in the safest runtime margin. The table shows which batteries can power the riggreen pins and D-Tap feeds are safe, orange pins-only outputs cover the rig without D-Tap supportand how long each pack runs.\"\n        },\n        \"runtimeFeedback\": {\n          \"title\": \"Submit runtime feedback\",\n          \"body\": \"Use the runtime feedback button to log real-world results. Entries sync with the current project, strengthen future estimates and remain available offline for audits.\"\n        },\n        \"connectionDiagram\": {\n          \"title\": \"Inspect the power diagram\",\n          \"body\": \"The interactive Power Diagram shows how power, video and control gear connect. Drag nodes to plan rig layout, double-click devices to open hover details, then save so the arrangement and annotations persist across exports and restores.\"\n        },\n        \"connectionDiagramDetails\": {\n          \"title\": \"Open device hover details\",\n          \"body\": \"Double-click any device node in the diagram to reveal its hover detail popup. Review draw notes, connector callouts and saved annotations, then close it to keep arranging the layout before saving.\"\n        },\n        \"editDeviceDataAdd\": {\n          \"title\": \"Add a device to the library\",\n          \"body\": \"Open Device Library, choose the correct category, enter the draw and connector details, then press Add. This stores the gear in the offline catalog so autosave, backups and shares all capture the new entry.\"\n        },\n        \"editDeviceDataReview\": {\n          \"title\": \"Review the device details\",\n          \"body\": \"Locate the device you just saved under Existing Devices and expand its details panel. Confirm the draw, outputs and compatibility information look right before relying on the data for runtime math or exports.\"\n        },\n        \"editDeviceDataEdit\": {\n          \"title\": \"Update and resave the device\",\n          \"body\": \"Use the Edit button on that entry, adjust specs or notes, and save again. This verifies the autosave timeline, backups and exports are refreshed with the latest numbers without risking any user data.\"\n        },\n        \"ownGearAccess\": {\n          \"title\": \"Open the Own Gear dialog\",\n          \"body\": \"Press the Own Gear button in the sidebar to launch your inventory dialog, then review the summary banner and your own gear list so you know where saved items, edit buttons and counts live. Finish by exploring the Add gear formitem search, quantity, notes, plus the Save and Reset controlsso you can add equipment instantly once the tour ends.\"\n        },\n        \"ownGearAddDevice\": {\n          \"title\": \"Add your first owned device\",\n          \"body\": \"Enter the item name, optional quantity and notes, then save. Owned gear is stored offline, included in backups and marked inside exports so teams instantly see what is available without duplicating requests.\"\n        },\n        \"projectRequirementsBrief\": {\n          \"title\": \"Capture the project brief\",\n          \"body\": \"Open the Production Requirements dialog from Generate Kit List and Production Requirements, then document production company, address, rental preferences, deliverables and schedule notes. These entries auto-fill rental-ready PDFs, stay cached offline and prepare the next sections.\"\n        },\n        \"projectRequirementsCrew\": {\n          \"title\": \"Map crew coverage and contacts\",\n          \"body\": \"Populate Crew, Prep, Shooting and Return rows with names, roles and coverage notes. Link saved Contacts, add emergency details and duplicate rows when multiple days share assignments so exports show who is on set and when.\"\n        },\n        \"projectRequirementsLogistics\": {\n          \"title\": \"Log lenses, rigging and monitoring plans\",\n          \"body\": \"Work through camera specs, the lens workflow, rigging scenarios, storage/media counts, matte box preferences and monitoring layouts. These entries feed automatic gear rules and storage math so the generated checklist reflects the full shoot plan.\"\n        },\n        \"generateGearAndRequirements\": {\n          \"title\": \"Save and rebuild the outputs\",\n          \"body\": \"Press OK inside the Production Requirements dialog to store every entry, regenerate the requirements summary and rebuild the categorized kit list. The planner snapshots the result with the active project so exports, backups and shares stay current.\"\n        },\n        \"autoGearRulesAccess\": {\n          \"title\": \"Open Automatic Gear Rules\",\n          \"body\": \"Go to Settings  Automatic Gear Rules to review automation controls. Opening the tab shows the presets, stock rules (including smart tripod logic that references your head/legs preference) and safety backups stored with your offline saves.\"\n        },\n        \"autoGearRulesEdit\": {\n          \"title\": \"Edit stock automatic gear rules\",\n          \"body\": \"Use the rules list to inspect factory additions. Select a stock rule to open it in the editor, adjust items or conditions, then save so the updated automation stays cached with backups and share bundles.\"\n        },\n        \"autoGearRulesCreate\": {\n          \"title\": \"Add a new automatic gear rule\",\n          \"body\": \"Press Add rule to create a custom automation. Name it, add conditions and required gear, then save. The planner runs new rules offline each time you regenerate the kit and includes them in exports, shares and backups.\"\n        },\n        \"projectRequirements\": {\n          \"title\": \"Refine production requirements boxes\",\n          \"body\": \"Review the regenerated Production Requirements summary beside the kit list. Confirm the brief, crew coverage and logistics boxes mirror the data you just saved, then rerun exports or backups so downstream teams get the updated context with every share.\"\n        },\n        \"gearList\": {\n          \"title\": \"Audit the generated kit list\",\n          \"body\": \"Check the categorized kit list for duplicates, counts and auto-added accessories. Edits save instantly, are included in share bundles and appear in printouts and PDFs.\"\n        },\n        \"exportImport\": {\n          \"title\": \"Export and import projects\",\n          \"body\": \"Use Export Project to download a JSON safety copy and Import Project to rehearse restores. Store exports on redundant media so no workstation loses data if a browser profile resets. Always keep the original export untouched so you can re-import even if a working copy gets edited.\"\n        },\n        \"overviewAndPrint\": {\n          \"title\": \"Generate overview, PDF and printouts\",\n          \"body\": \"Generate the project overview to access PDF, print and share-ready summaries. The dialog uses saved data only, so you can print or export even while fully offline.\"\n        },\n        \"help\": {\n          \"title\": \"Open the Help center\",\n          \"body\": \"The Help dialog includes searchable documentation, translation notes and onboarding references. Keep it pinned while workingarticles stay cached offline and update when new features arrive.\"\n        },\n        \"settingsGeneral\": {\n          \"title\": \"Revisit Settings  General\",\n          \"body\": \"Adjust language, typography, theme, pink mode, focus scale and other presentation options anytime. Preferences save locally, sync across projects and are bundled with backups.\"\n        },\n        \"settingsData\": {\n          \"title\": \"Monitor Data & Storage\",\n          \"body\": \"Use the Data & Storage tab to request persistent storage, watch save timestamps and launch quick safeguards. These controls verify that every project snapshot remains available offline.\"\n        },\n        \"settingsBackup\": {\n          \"title\": \"Maintain Backup & Restore\",\n          \"body\": \"The Backup & Restore tab manages full-app exports, restore rehearsals and diagnostics. Run backups before major changes, archive the files on external media and verify restores regularly.\"\n        },\n        \"completion\": {\n          \"title\": \"Tutorial complete\",\n          \"body\": \"You now know every safeguard. Keep saving often, export redundant backups and revisit any step from Help whenever you want a refresher. Cine Power Planner will keep protecting your data offline.\"\n        }\n      }\n    },\n    \"helpQuickStartChecklistTitle\": \"Quick start checklist\",\n    \"helpDataSafetyTitle\": \"Protect your work\",\n    \"helpRestoreDrillTitle\": \"Restore rehearsal drill\",\n    \"helpDataAuditTitle\": \"Monthly data health check\",\n    \"helpDataAuditStep1\": \"Open %1$s, switch to %2$s, then use %3$s under %4$s to capture a fresh full-app snapshot before auditing downloads.\",\n    \"helpDataAuditStep2\": \"Export each active project with %1$s, confirm each download opens without errors, and store the files in two separate locations.\",\n    \"helpDataAuditStep3\": \"While offline, reload using %1$s and confirm the %2$s stays visible while projects and help articles load from local storage. Test %3$s with one of the new exports to ensure share bundles restore without reconnecting.\",\n    \"helpDataAuditStep4\": \"Run %1$s with your latest backup, verify every project, device, and rule, then record the runtime guard output from %2$s in your verification log before closing the rehearsal without publishing changes.\",\n    \"helpDataAuditNote\": \"Log the results, capture a screenshot of Settings  Data & Storage with the latest autosave timestamp, and archive the console guard output with your backup rotation checklist so you always know which copies were verified offline.\",\n    \"helpRestoreDrillNote\": \"Log filenames, timestamps and verification results in your backup rotation checklist so every rehearsal documents a restorable copy.\",\n    \"helpSearchClear\": \"Clear search\",\n    \"helpSearchHelp\": \"Type keywords or alternate spellings to instantly filter help topics. Quick links update as you type and highlight the matching article when you press Enter. Press '/' or Ctrl+F (Cmd+F on Mac) to focus the search box when the help dialog is open (instead of the browser find), then press Tab to step through filtered quick links without leaving your project.\",\n    \"helpSearchClearHelp\": \"Clear the search box and show all help topics again.\",\n    \"helpSearchStatusAll\": \"Showing {count} help topics.\",\n    \"helpSearchStatusWithQuery\": \"Showing {count} results for {query}.\",\n    \"helpQuickLinksHeading\": \"Jump to a topic\",\n    \"helpQuickLinksAriaLabel\": \"Help topics quick navigation\",\n    \"helpQuickLinksHelp\": \"Jump directly to any section of the help dialog. Buttons only show topics that match the current search.\",\n    \"helpQuickLinkButtonHelp\": \"Scroll to the %s section in the help dialog.\",\n    \"hoverHelpButtonLabel\": \"Hover for help\",\n    \"hoverHelpButtonHelp\": \"Activate hover help so moving the cursor over buttons, fields, dropdowns or headers reveals brief explanations. You can open Settings while hover help is active to explore preferences without leaving this mode. Hovered controls are outlined and the tooltip shows their title alongside any available details. Longer descriptions are automatically broken into readable steps or bullet lists when available. Keyboard shortcuts are displayed whenever they exist so you can learn faster ways to use each control. When a control doesn't have custom guidance, the planner fills in contextual descriptions automatically so every interface element explains itself.\",\n    \"hoverHelpExitHint\": \"Press Esc or click anywhere to exit hover help.\",\n    \"hoverHelpShortcutsHeading\": \"Shortcuts\",\n    \"hoverHelpFallbackGeneric\": \"Interactive control.\",\n    \"hoverHelpFallbackButton\": \"Button. Activate to perform this action.\",\n    \"hoverHelpFallbackToggleButton\": \"Toggle button. Activate to switch between on and off states.\",\n    \"hoverHelpFallbackMenuButton\": \"Menu button. Opens a menu with related options.\",\n    \"hoverHelpFallbackLink\": \"Link. Opens the referenced section without leaving the app.\",\n    \"hoverHelpFallbackSelect\": \"Dropdown list. Open to choose one of the available options.\",\n    \"hoverHelpFallbackTextInput\": \"Text field. Type to enter information and press Enter to confirm when needed.\",\n    \"hoverHelpFallbackNumberInput\": \"Number field. Type a value or use arrow keys to adjust the number.\",\n    \"hoverHelpFallbackTextarea\": \"Multiline text field. Type paragraphs or paste notes.\",\n    \"hoverHelpFallbackCheckbox\": \"Checkbox. Select to enable, deselect to disable.\",\n    \"hoverHelpFallbackRadio\": \"Radio option. Select exactly one choice from this group.\",\n    \"hoverHelpFallbackSwitch\": \"Switch control. Toggle between on and off.\",\n    \"hoverHelpFallbackSlider\": \"Slider. Drag or use arrow keys to set the value.\",\n    \"hoverHelpFallbackFileInput\": \"File picker. Browse your device for files to add.\",\n    \"hoverHelpFallbackColorInput\": \"Color picker. Choose a color value.\",\n    \"hoverHelpFallbackDetails\": \"Expandable details section. Activate to show or hide the extra content.\",\n    \"hoverHelpFallbackDialog\": \"Dialog. Remains on top until you close it. Complete or cancel before returning to the main planner.\",\n    \"hoverHelpFallbackTablist\": \"Tab list. Use arrow keys to move between tabs.\",\n    \"hoverHelpFallbackTab\": \"Tab. Activate to display its panel of settings.\",\n    \"hoverHelpFallbackMenu\": \"Menu. Use arrow keys to move through options and Enter to select.\",\n    \"hoverHelpFallbackProgress\": \"Progress indicator showing current completion.\",\n    \"hoverHelpFallbackStatus\": \"Status message that updates automatically.\",\n    \"hoverHelpFallbackAlert\": \"Important alert that may require your attention.\",\n    \"setupSelectHelp\": \"Pick a previously saved configuration or select '-- New Project --' to start from scratch.\",\n    \"setupNameHelp\": \"Enter a descriptive name for the current project so you can recognize it later.\",\n    \"deleteSetupHelp\": \"Remove the highlighted saved project permanently from your browser.\",\n    \"saveSetupHelp\": \"Capture a full snapshot of the current projectdevices, requirements, notes, runtime logs and diagram layoutand store it in your local library. The autosave status dot beside Project Name pulses while the write finishes, and the background auto-backup queue schedules the matching timestamped snapshot right after the save so redundancy stays current. Press Enter or Ctrl+S (S on Mac) for the same result; the Save button stays disabled until you enter a project name. Saving never overwrites other projects until you confirm the name, so your prior data remains protected.\",\n    \"generateOverviewHelp\": \"Rebuilds the print-ready summary for the selected saved project and opens the overview dialog so you can review power and connection details before printing when ready. Lens selections render with brand, mount, diameter, focus, weight, rod support and notes so exports cover spec-sensitive checkouts.\",\n    \"generateGearListHelp\": \"Build a categorized kit list that combines selected gear with production requirements. The list refreshes on every change, merges duplicate items with counts and auto-adds required cables, rigging, lens supports, matte box parts, battery counts with hotswap hardware, default monitors for each role and scenario-specific accessories. Entries are sorted alphabetically and include hover descriptions.\",\n    \"shareSetupHelp\": \"Download a JSON safety bundle of the current projectcovering custom gear, favorites, runtime feedback and devicesready to archive or share offline. Store the file with your redundant crew backups before closing the planner so every workstation can restore it without network access. The export leaves your current project unchanged, so nothing is lost while you create the share bundle.\",\n    \"applySharedLinkHelp\": \"Load the configuration from a JSON backup exported via Save & Share or Backup & Restore. Review the preview diff before applyingnothing overwrites your current project until you confirm Save, and the planner schedules a fresh auto-backup beforehand so you can roll back instantly. Unnamed imports are saved automatically under an -imported title so the data lands even when the bundle omitted a project name. The imported project remains local and offline-ready immediately after you save.\",\n    \"sharedLinkHelp\": \"Choose a project JSON exported from Save & Share or Backup & Restore. Keep the original file in your backups after importthe planner only reads a copy and logs the attempt in diagnostics for your records so you can audit every restore.\",\n    \"cameraSelectHelp\": \"Choose the camera body that anchors your rig.\",\n    \"monitorSelectHelp\": \"Choose an on-board or wireless monitor to include.\",\n    \"videoSelectHelp\": \"Choose a transmitter/receiver pair or other wireless video link.\",\n    \"cageSelectHelp\": \"Choose a camera cage for mounting accessories.\",\n    \"distanceSelectHelp\": \"Choose an optional distance or range-finder sensor.\",\n    \"batterySelectHelp\": \"Choose the battery model that will power the entire rig.\",\n    \"batteryPlateSelectHelp\": \"Choose the battery plate or adapter that connects the battery to the camera.\",\n    \"batteryHotswapSelectHelp\": \"Select the hot-swap buffer that keeps power during battery changes.\",\n    \"runtimeFeedbackBtnHelp\": \"Open a form where you can submit real-world runtime data for this configuration.\",\n    \"zoomOutHelp\": \"Zoom out of the project diagram to view more of the layout.\",\n    \"zoomInHelp\": \"Zoom in on the project diagram for a closer look at connections.\",\n    \"downloadDiagramHelp\": \"Download the Power Diagram as an SVG or JPG image.\",\n    \"gridSnapToggleHelp\": \"Turn grid snapping on or off to help align items in the diagram.\",\n    \"resetViewBtn\": \"Reset View\",\n    \"resetViewHelp\": \"Reset zoom and pan to their defaults.\",\n    \"toggleDeviceManagerHelp\": \"Open the editor where you can add, modify, export or import device data.\",\n    \"hideDeviceManagerHelp\": \"Close the device database editor and return to normal mode.\",\n    \"zoomInLabel\": \"Zoom in\",\n    \"zoomOutLabel\": \"Zoom out\",\n    \"diagramHoverNotice\": \"Double click for details\",\n    \"diagramDetailBackLabel\": \"Back\",\n    \"diagramDetailDefaultHeading\": \"Diagram details\",\n    \"diagramMoveHint\": \"Drag nodes to rearrange; drag empty space to pan.\",\n    \"v2\": {\n      \"dashboard\": {\n        \"header\": {\n          \"title\": \"Projects\"\n        },\n        \"actions\": {\n          \"newProject\": \"New Project\",\n          \"importProject\": \"Import Project\"\n        },\n        \"projects\": \"Projects\",\n        \"newProject\": \"New Project\",\n        \"projectLocked\": \"The project '{projectName}' is already open in another tab.\",\n        \"emptyState\": {\n          \"title\": \"No Projects Yet\",\n          \"subtitle\": \"Create your first power plan to get started.\",\n          \"help\": \"Need help getting started?\",\n          \"archiveTitle\": \"No Archived Projects\",\n          \"archiveSubtitle\": \"Projects you archive will appear here.\"\n        },\n        \"search\": {\n          \"noResults\": {\n            \"title\": \"No Results\",\n            \"subtitle\": \"No projects match \\\"{query}\\\"\"\n          },\n          \"clear\": \"Clear search\"\n        },\n        \"projectTile\": {\n          \"prep\": \"Prep:\",\n          \"shoot\": \"Shoot:\",\n          \"return\": \"Return:\",\n          \"openProject\": \"Open Project\",\n          \"renameAndEdit\": \"Rename & Edit\",\n          \"moreOptions\": \"More options\",\n          \"actionsFor\": \"Actions for {project}\"\n        },\n        \"contextMenu\": {\n          \"open\": \"Open Project\",\n          \"rename\": \"Rename & Edit\",\n          \"duplicate\": \"Duplicate\",\n          \"archive\": \"Archive\",\n          \"unarchive\": \"Restore\",\n          \"delete\": \"Delete\",\n          \"print\": \"Print\",\n          \"pdf\": \"Export PDF\"\n        },\n        \"status\": {\n          \"draft\": \"Draft\",\n          \"planning\": \"Planning\",\n          \"waitingForApproval\": \"Waiting for Approval\",\n          \"approved\": \"Approved\",\n          \"shooting\": \"Shooting\",\n          \"completed\": \"Completed\",\n          \"archived\": \"Archived\"\n        }\n      },\n      \"sidebar\": {\n        \"nav\": {\n          \"allProjects\": \"All Projects\",\n          \"activeProjects\": \"Active Projects\",\n          \"archive\": \"Archive\",\n          \"autoBackups\": \"Auto Backups\",\n          \"deviceLibrary\": \"Device Library\",\n          \"contacts\": \"Contacts\",\n          \"autoGearRules\": \"Auto Gear Rules\",\n          \"ownedGear\": \"Owned Gear\",\n          \"createProject\": \"Create New Project\",\n          \"projectsSection\": \"Projects\",\n          \"toolsSection\": \"Tools\",\n          \"supportSection\": \"Support\",\n          \"help\": \"Help\",\n          \"settings\": \"Settings\"\n        },\n        \"search\": {\n          \"placeholder\": \"Search features, devices, actions...\",\n          \"label\": \"Search features, devices, actions, and help\"\n        }\n      },\n      \"detail\": {\n        \"backButton\": \"Back to Projects\",\n        \"header\": {\n          \"export\": \"Export Project\",\n          \"print\": \"Print / Export PDF\",\n          \"generateReqs\": \"Reqs & Gear\",\n          \"generateOverview\": \"Generate Overview\",\n          \"save\": \"Save\"\n        },\n        \"tabs\": {\n          \"cameraPackage\": \"Camera Package\",\n          \"powerSummary\": \"Power Summary\",\n          \"requirements\": \"Requirements\",\n          \"gearList\": \"Gear List\"\n        },\n        \"actions\": {\n          \"projectRequirements\": \"Project Requirements\",\n          \"generateRequirements\": \"Generate Requirements\",\n          \"generateRequirementsHelp\": \"Click \\\"Generate Requirements\\\" to create your production report.\",\n          \"gearList\": \"Gear List\",\n          \"generateGearList\": \"Generate Gear List\",\n          \"generateGearListHelp\": \"Click \\\"Generate Gear List\\\" to create your equipment list.\"\n        },\n        \"diagram\": {\n          \"zoomIn\": \"Zoom In\",\n          \"zoomOut\": \"Zoom Out\",\n          \"resetView\": \"Reset View\",\n          \"download\": \"Download Diagram\"\n        },\n        \"errors\": {\n          \"statusUpdateFailed\": \"Unable to update the project status because storage is unavailable. Please check your browser storage settings and try again.\"\n        }\n      }\n    }\n  },\n  \"categoryNames\": {\n    \"cameras\": \"Camera\",\n    \"viewfinders\": \"Viewfinder\",\n    \"monitors\": \"Monitor\",\n    \"video\": \"Wireless Transmitter\",\n    \"fiz.motors\": \"FIZ Motor\",\n    \"fiz.controllers\": \"FIZ Controller\",\n    \"fiz.distance\": \"FIZ Distance\",\n    \"batteries\": \"Battery\",\n    \"batteryHotswaps\": \"Battery Hotswap\",\n    \"wirelessReceivers\": \"Wireless Receiver\",\n    \"accessories.batteries\": \"Accessory Battery\",\n    \"accessories.cables\": \"Cable\",\n    \"accessories.cages\": \"Camera Cage\",\n    \"accessories.cameraSupport\": \"Camera Support\",\n    \"accessories.chargers\": \"Charger\",\n    \"cages\": \"Camera Cage\",\n    \"chargers\": \"Charger\",\n    \"directorMonitors\": \"Director Monitor\",\n    \"iosVideo\": \"iOS Video\",\n    \"videoAssist\": \"Video Assist\",\n    \"media\": \"Recording Media\",\n    \"accessories.cardReaders\": \"Card Reader\",\n    \"cardReaders\": \"Card Reader\",\n    \"lenses\": \"Lens\",\n    \"filterOptions\": \"Filter Option\",\n    \"other\": \"Other\"\n  },\n  \"gearItems\": {\n    \"Tennis ball\": \"Tennis ball\",\n    \"Clapper Stick\": \"Clapper Stick\"\n  }\n};\n\nexport default data;\n","/**\n * @fileoverview CORE MODULE: Translations Loader\n * \n * Handles dynamic loading, alignment, and global registration of locale data.\n * Ensures all locales conform to the structure of the default language (EN).\n * \n * @module modules/translations\n */\n\nimport { data as enData } from '../translations/en.js';\n\nconst DEFAULT_LANGUAGE = 'en';\n\n// Dynamic imports for other languages (relative to this module)\nconst LOCALE_IMPORTS = {\n    de: () => import('../translations/de.js'),\n    es: () => import('../translations/es.js'),\n    fr: () => import('../translations/fr.js'),\n    it: () => import('../translations/it.js'),\n};\n\nconst loadedLocales = new Set();\n\n/**\n * Helper: Clone a value deeply\n */\nfunction cloneTranslationValue(value) {\n    if (Array.isArray(value)) {\n        return value.map(item => cloneTranslationValue(item));\n    }\n    if (value && typeof value === 'object') {\n        const clone = {};\n        Object.keys(value).forEach(key => {\n            clone[key] = cloneTranslationValue(value[key]);\n        });\n        return clone;\n    }\n    return value;\n}\n\n/**\n * Helper: Freeze object recursively\n */\nfunction freezeTranslationTree(value, seen = new WeakMap()) {\n    if (!value || typeof value !== 'object') return value;\n\n    if (seen.has(value)) return value;\n    seen.set(value, true);\n\n    if (Array.isArray(value)) {\n        value.forEach(item => freezeTranslationTree(item, seen));\n    } else {\n        Object.values(value).forEach(item => freezeTranslationTree(item, seen));\n    }\n\n    try {\n        if (!Object.isFrozen(value)) Object.freeze(value);\n    } catch { /* ignore */ }\n\n    return value;\n}\n\n/**\n * Helper: Align translation value with reference (EN)\n */\nfunction alignTranslationValue(referenceValue, translationValue) {\n    const referenceType = Array.isArray(referenceValue) ? 'array' :\n        referenceValue === null ? 'null' : typeof referenceValue;\n\n    const translationType = Array.isArray(translationValue) ? 'array' :\n        translationValue === null ? 'null' : typeof translationValue;\n\n    if (referenceType === 'array') {\n        if (translationType !== 'array') return cloneTranslationValue(referenceValue);\n\n        // Arrays need explicit length matching\n        const maxLength = referenceValue.length;\n        const aligned = new Array(maxLength);\n        for (let i = 0; i < maxLength; i++) {\n            const refItem = referenceValue[i];\n            const transItem = i < translationValue.length ? translationValue[i] : undefined;\n            aligned[i] = alignTranslationValue(refItem, transItem);\n        }\n        return aligned;\n    }\n\n    if (referenceType === 'object') {\n        if (translationType !== 'object') return cloneTranslationValue(referenceValue);\n\n        const alignedObject = translationValue && typeof translationValue === 'object' ? translationValue : {};\n        const referenceKeys = Object.keys(referenceValue || {});\n\n        // Align keys\n        referenceKeys.forEach(key => {\n            const refChild = referenceValue[key];\n            const transChild = Object.prototype.hasOwnProperty.call(alignedObject, key) ? alignedObject[key] : undefined;\n            alignedObject[key] = alignTranslationValue(refChild, transChild);\n        });\n\n        // Remove extra keys\n        Object.keys(alignedObject).forEach(key => {\n            if (!Object.prototype.hasOwnProperty.call(referenceValue, key)) {\n                delete alignedObject[key];\n            }\n        });\n\n        return alignedObject;\n    }\n\n    if (translationType === referenceType && typeof translationValue !== 'undefined') {\n        return translationValue;\n    }\n\n    return cloneTranslationValue(referenceValue);\n}\n\n/**\n * Helper: Align entire dataset\n */\nfunction alignDataset(referenceDataset, localeDataset) {\n    const result = {};\n    const keys = Object.keys(referenceDataset || {});\n    keys.forEach(key => {\n        const refVal = referenceDataset[key];\n        const locVal = localeDataset && Object.prototype.hasOwnProperty.call(localeDataset, key) ? localeDataset[key] : undefined;\n        result[key] = alignTranslationValue(refVal, locVal);\n    });\n    return result;\n}\n\n/**\n * Register Locale Data into Target Scope\n * @param {string} locale - The locale code\n * @param {Object} data - The translation data\n * @param {Object} scope - The target scope (window/global)\n */\nexport function registerLocaleData(locale, data, scope) {\n    if (!locale || !data || !scope) return;\n\n    // Ensure containers\n    scope.texts = scope.texts || {};\n    scope.categoryNames = scope.categoryNames || {};\n    scope.gearItems = scope.gearItems || {};\n\n    const localeTexts = data.texts || {};\n    const localeCategoryNames = data.categoryNames || {};\n    const localeGearItems = data.gearItems || {};\n\n    // Get EN (reference) - expect it to be present if locale != en\n    let defaultLocale = scope.texts[DEFAULT_LANGUAGE] ? {\n        texts: scope.texts[DEFAULT_LANGUAGE],\n        categoryNames: scope.categoryNames[DEFAULT_LANGUAGE],\n        gearItems: scope.gearItems[DEFAULT_LANGUAGE]\n    } : null;\n\n    if (locale === DEFAULT_LANGUAGE) {\n        // Freeze EN\n        freezeTranslationTree(localeTexts);\n        freezeTranslationTree(localeCategoryNames);\n        freezeTranslationTree(localeGearItems);\n        defaultLocale = { texts: localeTexts, categoryNames: localeCategoryNames, gearItems: localeGearItems };\n    }\n\n    const reference = defaultLocale || { texts: {}, categoryNames: {}, gearItems: {} };\n\n    // Align\n    const alignedTexts = locale === DEFAULT_LANGUAGE ? reference.texts : alignDataset(reference.texts, localeTexts);\n    const alignedCategoryNames = locale === DEFAULT_LANGUAGE ? reference.categoryNames : alignDataset(reference.categoryNames, localeCategoryNames);\n    const alignedGearItems = locale === DEFAULT_LANGUAGE ? reference.gearItems : alignDataset(reference.gearItems, localeGearItems);\n\n    // Assign to globals\n    scope.texts[locale] = alignedTexts;\n    scope.categoryNames[locale] = alignedCategoryNames;\n    scope.gearItems[locale] = alignedGearItems;\n}\n\n/**\n * Resolve Locale Key\n * @param {string} candidate \n * @returns {string} One of supported locale keys or 'en'\n */\nexport function resolveLocaleKey(candidate) {\n    if (typeof candidate !== 'string') return DEFAULT_LANGUAGE;\n    const trimmed = candidate.trim();\n    if (!trimmed) return DEFAULT_LANGUAGE;\n    const lower = trimmed.toLowerCase();\n\n    if (LOCALE_IMPORTS[lower]) return lower;\n\n    // split 'en-US' -> 'en'\n    const short = lower.split('-')[0];\n    if (LOCALE_IMPORTS[short]) return short;\n\n    return DEFAULT_LANGUAGE;\n}\n\n/**\n * Load Language (Public API)\n * @param {string} locale - User locale string e.g. \"en-US\"\n * @param {Object} scope - Global scope to register translations onto\n */\nexport async function loadLanguage(locale, scope) {\n    if (loadedLocales.has(locale)) return;\n\n    const key = resolveLocaleKey(locale);\n\n    if (key === DEFAULT_LANGUAGE && loadedLocales.has(DEFAULT_LANGUAGE)) {\n        // Already loaded EN, mark requested variant as loaded\n        loadedLocales.add(locale);\n        return;\n    }\n\n    if (LOCALE_IMPORTS[key]) {\n        try {\n            const module = await LOCALE_IMPORTS[key]();\n            registerLocaleData(key, module.data, scope);\n            loadedLocales.add(key);\n            loadedLocales.add(locale);\n        } catch (e) {\n            console.error(`Failed to load locale: ${key}`, e);\n        }\n    }\n}\n\n/**\n * Initialize Default Language (Reference)\n * @param {Object} scope \n */\nexport function initDefaultLanguage(scope) {\n    if (!loadedLocales.has(DEFAULT_LANGUAGE)) {\n        registerLocaleData(DEFAULT_LANGUAGE, enData, scope);\n        loadedLocales.add(DEFAULT_LANGUAGE);\n    }\n}\n","import { loadLanguage, initDefaultLanguage } from './modules/translations.js';\n\n/**\n * Translations Loader (Shim)\n * Maintains legacy global API compatibility.\n */\n\n// Resolve global scope\nconst scope = typeof globalThis !== 'undefined' ? globalThis :\n  typeof window !== 'undefined' ? window :\n    typeof self !== 'undefined' ? self : {};\n\n// Initialize Default Language immediately\ninitDefaultLanguage(scope);\n\n// shim wrapper to inject scope\nasync function loadLanguageShim(locale) {\n  return loadLanguage(locale, scope);\n}\n\n// Expose loader interface globally for legacy compatibility\nscope.__cineTranslationsLoader__ = {\n  loadLanguage: loadLanguageShim\n};\n\n// Export for ESM usage\nexport { loadLanguageShim as loadLanguage };\nexport default {\n  loadLanguage: loadLanguageShim\n};\n","/**\n * Pink Mode - Core Logic\n * \n * Handles the special \"Pink Mode\" feature including:\n * - Unicorn icon replacements\n * - UI class activation\n * - Lottie animation loading\n * \n * Replaces legacy dynamic resolvers.\n */\n\nconst GLOBAL_SCOPE = (typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : global)));\n\n// --- Assets ---\n\nconst HORSE_SVG_MARKUP = '<svg viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\"><path d=\"m1 40c0-8 3-17 3-17a4.84 4.84 0 0 0-1.829-3.064 1 1 0 0 1 .45-1.716 19.438 19.438 0 0 1 4.379-.22c.579-2.317-1.19-3.963-2.782-4.938a1 1 0 0 1 .393-1.85 14.128 14.128 0 0 1 6.389.788c0-.958-1.147-2.145-2.342-3.122a1 1 0 0 1 .708-1.773 40.655 40.655 0 0 1 6.634.895 3.723 3.723 0 0 0-1.049-2.264 1 1 0 0 1 .823-1.652c6.151.378 9.226 1.916 9.226 1.916l10-1s8.472-2.311 15.954.5a1 1 0 0 1-.084 1.9c-1.455.394-2.87 1.143-2.87 2.6 0 0 4.426.738 5.675 4.114a1 1 0 0 1-1.228 1.317c-1.64-.48-4.273-.88-6.447.569Z\" fill=\"#805333\" /><path d=\"m30.18 42.82c1.073 2.7 2.6 9.993 3.357 13.8a2 2 0 0 1-1.964 2.38h-28.573a2 2 0 0 1-2-2v-18c0-2.55 10.03-22.11 23.99-23.87Z\" fill=\"#a56a43\" /><path d=\"m55.67 48.46-6.34 2.97a6 6 0 0 1-7.98-2.88l-.25-.54-.76-1.6a4.956 4.956 0 0 0-4.68-2.87c-.22.01-.44.02-.66.02a16.019 16.019 0 0 1-8.28-29.66c-1.81-2.97-3.45-8.03 2.03-12.49a2.1 2.1 0 0 1 2.5 0c4.23 3.45 4.21 7.25 3.16 10.17a16 16 0 0 1 15.91 11.36l5.31 11.31 2.92 6.22a6.008 6.008 0 0 1-2.88 7.99Z\" fill=\"#cb8252\" /><circle cx=\"42\" cy=\"26\" r=\"3\" fill=\"#2c2f38\" /><circle cx=\"54\" cy=\"43\" r=\"1\" fill=\"#805333\" /><path d=\"m58.55 40.47-2.92-6.22-14.53 13.76.25.54a6 6 0 0 0 7.98 2.88l6.34-2.97a6.008 6.008 0 0 0 2.88-7.99Zm-4.55 3.53a1 1 0 1 1 1-1 1 1 0 0 1-1 1Z\" fill=\"#cf976a\" /><circle cx=\"41\" cy=\"25\" r=\"1.25\" fill=\"#ecf0f1\" /></svg>';\n\nconst HORN_MARKUP = '<path d=\"M44 19 L56 5 L49 22 Z\" fill=\"#ffd700\" />';\nconst UNICORN_BASE_MARKUP = HORSE_SVG_MARKUP.replace('</svg>', HORN_MARKUP + '</svg>');\n\nconst UNICORN_1_MARKUP = UNICORN_BASE_MARKUP\n    .replace(/#805333/g, '#d63384')\n    .replace(/#a56a43/g, '#e83e8c')\n    .replace(/#cb8252/g, '#fd7e14')\n    .replace(/#cf976a/g, '#ffc0cb');\n\nconst UNICORN_2_MARKUP = UNICORN_BASE_MARKUP\n    .replace(/#805333/g, '#6f42c1')\n    .replace(/#a56a43/g, '#d63384')\n    .replace(/#cb8252/g, '#e83e8c')\n    .replace(/#cf976a/g, '#e0cffc');\n\nconst UNICORN_3_MARKUP = UNICORN_BASE_MARKUP\n    .replace(/#805333/g, '#0dcaf0')\n    .replace(/#a56a43/g, '#6f42c1')\n    .replace(/#cb8252/g, '#d63384')\n    .replace(/#cf976a/g, '#9ec5fe');\n\nconst PINK_MODE_TOGGLE_SEQUENCE = [\n    { className: 'icon-svg pink-mode-icon', markup: UNICORN_1_MARKUP, lottiePath: 'src/animations/horn.json' },\n    { className: 'icon-svg pink-mode-icon', markup: UNICORN_2_MARKUP, lottiePath: 'src/animations/unicorn.json' },\n    { className: 'icon-svg pink-mode-icon', markup: UNICORN_3_MARKUP, lottiePath: 'src/animations/rainbow.json' }\n];\n\nexport const pinkModeIcons = {\n    off: { className: 'icon-svg pink-mode-icon', markup: HORSE_SVG_MARKUP },\n    onSequence: PINK_MODE_TOGGLE_SEQUENCE\n};\n\nexport const PINK_MODE_ANIMATED_ICON_FILES = Object.freeze([\n    'src/animations/unicorn.json',\n    'src/animations/pink-mode/dog.json',\n    'src/animations/pink-mode/fox-2.json',\n    'src/animations/pink-mode/fox-3.json',\n    'src/animations/pink-mode/fox.json',\n    'src/animations/pink-mode/horse.json',\n    'src/animations/pink-mode/mountains.json',\n    'src/animations/pink-mode/movie-camera.json',\n    'src/animations/pink-mode/pinata.json',\n    'src/animations/pink-mode/script.json',\n    'src/animations/pink-mode/video-camera.json'\n]);\n\n// --- Manager ---\n\nclass PinkModeManager {\n    constructor() {\n        this.active = false;\n    }\n\n    activate() {\n        this.active = true;\n        if (typeof document !== 'undefined' && document.body) {\n            document.body.classList.add('pink-mode-active');\n        }\n    }\n\n    deactivate() {\n        this.active = false;\n        if (typeof document !== 'undefined' && document.body) {\n            document.body.classList.remove('pink-mode-active');\n        }\n    }\n}\n\nconst manager = new PinkModeManager();\n\n// --- Methods ---\n\nexport function ensurePinkModeLottieRuntime() {\n    if (GLOBAL_SCOPE.lottie) return Promise.resolve(GLOBAL_SCOPE.lottie);\n    if (GLOBAL_SCOPE.bodymovin) return Promise.resolve(GLOBAL_SCOPE.bodymovin);\n\n    if (typeof document === 'undefined') return Promise.resolve(null);\n\n    const existingScript = document.querySelector('script[data-loader=\"pink-mode-lottie\"]');\n    if (existingScript) {\n        return new Promise(resolve => {\n            if (existingScript.dataset.loaded === 'true') resolve(GLOBAL_SCOPE.lottie);\n            else existingScript.addEventListener('load', () => resolve(GLOBAL_SCOPE.lottie), { once: true });\n        });\n    }\n\n    return new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        script.src = 'src/vendor/lottie.min.js';\n        script.async = true;\n        script.setAttribute('data-loader', 'pink-mode-lottie');\n        script.onload = () => {\n            script.dataset.loaded = 'true';\n            resolve(GLOBAL_SCOPE.lottie);\n        };\n        script.onerror = reject;\n        document.head.appendChild(script);\n    });\n}\n\nexport const ensureSvgHasAriaHidden = (markup) => typeof markup === 'string' ? markup.trim() : '';\nexport const setPinkModeIconSequence = () => false;\nexport const loadPinkModeIconsFromFiles = () => Promise.resolve();\nexport const resolvePinkModeLottieRuntime = () => GLOBAL_SCOPE.lottie;\nexport const startPinkModeAnimatedIcons = () => manager.activate();\nexport const stopPinkModeAnimatedIcons = () => manager.deactivate();\nexport const triggerPinkModeIconRain = () => { };\nexport const startPinkModeIconPreload = () => { };\nexport const getPinkModeIconRotationTimer = () => null;\nexport const setPinkModeIconRotationTimer = () => { };\nexport const getPinkModeIconIndex = () => 0;\nexport const setPinkModeIconIndex = () => { };\n\n// Constants\nexport const PINK_MODE_ICON_INTERVAL_MS = 30000;\nexport const PINK_MODE_ICON_ANIMATION_CLASS = 'pink-mode-icon-pop';\nexport const PINK_MODE_ICON_ANIMATION_RESET_DELAY = 450;\nexport const PINK_MODE_ICON_FALLBACK_MARKUP = [];\n\n// Export as a cohesive API object\nexport const cineCorePinkModeSupport = {\n    pinkModeIcons,\n    ensureSvgHasAriaHidden,\n    setPinkModeIconSequence,\n    loadPinkModeIconsFromFiles,\n    ensurePinkModeLottieRuntime,\n    resolvePinkModeLottieRuntime,\n    startPinkModeAnimatedIcons,\n    stopPinkModeAnimatedIcons,\n    triggerPinkModeIconRain,\n    startPinkModeIconPreload,\n    getPinkModeIconRotationTimer,\n    setPinkModeIconRotationTimer,\n    getPinkModeIconIndex,\n    setPinkModeIconIndex,\n    PINK_MODE_ICON_INTERVAL_MS,\n    PINK_MODE_ICON_ANIMATION_CLASS,\n    PINK_MODE_ICON_ANIMATION_RESET_DELAY,\n    PINK_MODE_ICON_FALLBACK_MARKUP,\n};\n","/*\n * Extracted from app-core-new-1.js to keep module boundaries manageable.\n * Refactored to import from pure ESM module.\n */\n\nimport { cineCorePinkModeSupport } from '../modules/core/pink-mode.js';\n\nconst PINK_MODE_SUPPORT_API = cineCorePinkModeSupport;\n\nif (typeof module !== 'undefined' && module.exports) {\n  module.exports = {\n    PINK_MODE_SUPPORT_API,\n  };\n}\n\nif (typeof globalThis !== 'undefined') {\n  globalThis.PINK_MODE_SUPPORT_API = PINK_MODE_SUPPORT_API;\n} else if (typeof window !== 'undefined') {\n  window.PINK_MODE_SUPPORT_API = PINK_MODE_SUPPORT_API;\n} else if (typeof self !== 'undefined') {\n  self.PINK_MODE_SUPPORT_API = PINK_MODE_SUPPORT_API;\n} else if (typeof global !== 'undefined') {\n  global.PINK_MODE_SUPPORT_API = PINK_MODE_SUPPORT_API;\n}\n\n\n","/*\n * Auto Gear UI helpers extracted from the runtime so DOM-related logic can be\n * tested without loading the entire application shell.\n */\n// @ts-nocheck\n/* global callCoreFunctionIfAvailable, autoGearConditionSelect, texts, currentLang,\n  AUTO_GEAR_CONDITION_KEYS, getAutoGearConditionConfig, setButtonLabelWithIconBinding, ICON_GLYPHS */\nvar AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS = {\n    focus: 'autoGearDefaultFocusMonitorLabel',\n    handheld7: 'autoGearDefaultHandheldMonitorLabel',\n    combo15: 'autoGearDefaultComboMonitorLabel',\n    director15: 'autoGearDefaultDirectorMonitorLabel',\n};\nfunction resolveAutoGearConditionKeys() {\n    if (typeof AUTO_GEAR_CONDITION_KEYS !== 'undefined' && Array.isArray(AUTO_GEAR_CONDITION_KEYS)) {\n        return AUTO_GEAR_CONDITION_KEYS;\n    }\n    var scope = (typeof globalThis !== 'undefined' && globalThis)\n        || (typeof window !== 'undefined' && window)\n        || (typeof self !== 'undefined' && self)\n        || (typeof global !== 'undefined' && global)\n        || null;\n    var helpers = scope\n        && typeof scope.AUTO_GEAR_UI_HELPERS === 'object'\n        && scope.AUTO_GEAR_UI_HELPERS\n        ? scope.AUTO_GEAR_UI_HELPERS\n        : null;\n    if (helpers) {\n        if (Array.isArray(helpers.AUTO_GEAR_CONDITION_KEYS)) {\n            return helpers.AUTO_GEAR_CONDITION_KEYS;\n        }\n        if (helpers.autoGearConditionSelects && typeof helpers.autoGearConditionSelects === 'object') {\n            return Object.keys(helpers.autoGearConditionSelects);\n        }\n    }\n    return [];\n}\nvar createDeferredAutoGearRefresher = function (functionName) { return function (selected) {\n    return callCoreFunctionIfAvailable(functionName, [selected], { defer: true });\n}; };\nfunction focusAutoGearConditionPicker() {\n    if (autoGearConditionSelect) {\n        try {\n            autoGearConditionSelect.focus({ preventScroll: true });\n        }\n        catch (focusError) {\n            void focusError;\n            autoGearConditionSelect.focus();\n        }\n    }\n}\nfunction configureAutoGearConditionButtons() {\n    var _a, _b, _c, _d;\n    var addLabel = ((_a = texts[currentLang]) === null || _a === void 0 ? void 0 : _a.autoGearConditionAddShortcut)\n        || ((_b = texts.en) === null || _b === void 0 ? void 0 : _b.autoGearConditionAddShortcut)\n        || 'Add another condition';\n    var removeLabel = ((_c = texts[currentLang]) === null || _c === void 0 ? void 0 : _c.autoGearConditionRemove)\n        || ((_d = texts.en) === null || _d === void 0 ? void 0 : _d.autoGearConditionRemove)\n        || 'Remove this condition';\n    var conditionKeys = resolveAutoGearConditionKeys();\n    if (!conditionKeys.length)\n        return;\n    conditionKeys.forEach(function (key) {\n        var config = getAutoGearConditionConfig(key);\n        if (!config)\n            return;\n        if (config.addShortcut) {\n            setButtonLabelWithIconBinding(config.addShortcut, '', ICON_GLYPHS.add);\n            config.addShortcut.setAttribute('aria-label', addLabel);\n            config.addShortcut.setAttribute('title', addLabel);\n            config.addShortcut.setAttribute('data-help', addLabel);\n        }\n        if (config.removeButton) {\n            setButtonLabelWithIconBinding(config.removeButton, '', ICON_GLYPHS.minus);\n            config.removeButton.setAttribute('aria-label', removeLabel);\n            config.removeButton.setAttribute('title', removeLabel);\n            config.removeButton.setAttribute('data-help', removeLabel);\n        }\n    });\n}\nvar AUTO_GEAR_UI_EXPORTS_BRIDGE = {\n    createDeferredAutoGearRefresher: createDeferredAutoGearRefresher,\n    focusAutoGearConditionPicker: focusAutoGearConditionPicker,\n    configureAutoGearConditionButtons: configureAutoGearConditionButtons,\n    AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS: AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS,\n};\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = AUTO_GEAR_UI_EXPORTS_BRIDGE;\n}\nif (typeof globalThis !== 'undefined') {\n    var target = (typeof globalThis.AUTO_GEAR_UI_HELPERS === 'object' && globalThis.AUTO_GEAR_UI_HELPERS)\n        ? globalThis.AUTO_GEAR_UI_HELPERS\n        : (globalThis.AUTO_GEAR_UI_HELPERS = {});\n    Object.assign(target, AUTO_GEAR_UI_EXPORTS_BRIDGE);\n    globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS = AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS;\n}\n","/*\n * Auto Gear normalization helpers extracted from the primary runtime.\n * The code remains framework-free so it can run inside the legacy loader\n * while also being consumable from Node-based unit tests.\n */\n// @ts-nocheck\n/* global AUTO_GEAR_SELECTOR_TYPE_SET, AUTO_GEAR_SELECTOR_TYPE_MAP, DEVICE_GLOBAL_SCOPE,\n  devices, CORE_PART1_RUNTIME_SCOPE, CORE_GLOBAL_SCOPE, CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE,\n  AUTO_GEAR_TRIPOD_FIELD_IDS, AUTO_GEAR_TRIPOD_SELECTOR_TYPES, localeSort,\n  AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS, AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP,\n  getLanguageTexts, currentLang, addArriKNumber, GEAR_LIST_CATEGORIES,\n  AUTO_GEAR_CUSTOM_CATEGORY, texts, autoGearOwnGearSelect, collectAutoGearSelectedValues,\n  getAutoGearOwnGearItems, autoGearEditorDraft, formatOwnGearQuantityText, findAutoGearOwnGearById,\n  computeAutoGearMultiSelectSize, AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS, autoGearAddOwnGearSelect,\n  autoGearRemoveOwnGearSelect, normalizeAutoGearCameraWeightCondition, stableStringify */\nvar AUTO_GEAR_NORMALIZER_SCOPE = (typeof globalThis !== 'undefined' && globalThis)\n    || (typeof window !== 'undefined' && window)\n    || (typeof self !== 'undefined' && self)\n    || (typeof global !== 'undefined' && global)\n    || {};\nvar stableStringify = (function () {\n    var candidateScopes = [\n        AUTO_GEAR_NORMALIZER_SCOPE,\n        AUTO_GEAR_NORMALIZER_SCOPE && AUTO_GEAR_NORMALIZER_SCOPE.global,\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n    for (var index = 0; index < candidateScopes.length; index += 1) {\n        var scope = candidateScopes[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            continue;\n        if (typeof scope.stableStringify === 'function') {\n            return scope.stableStringify;\n        }\n        if (scope.cineCoreShared && typeof scope.cineCoreShared.stableStringify === 'function') {\n            return scope.cineCoreShared.stableStringify;\n        }\n    }\n    var fallbackStableStringify = function (value) {\n        if (value === null)\n            return 'null';\n        if (value === undefined)\n            return 'undefined';\n        if (Array.isArray(value)) {\n            var serialized = '[';\n            for (var index = 0; index < value.length; index += 1) {\n                if (index > 0) {\n                    serialized += ',';\n                }\n                serialized += fallbackStableStringify(value[index]);\n            }\n            serialized += ']';\n            return serialized;\n        }\n        if (typeof value === 'object') {\n            var keys = Object.keys(value).sort();\n            var serialized = '{';\n            for (var keyIndex = 0; keyIndex < keys.length; keyIndex += 1) {\n                var key = keys[keyIndex];\n                if (keyIndex > 0) {\n                    serialized += ',';\n                }\n                serialized += \"\".concat(JSON.stringify(key), \":\").concat(fallbackStableStringify(value[key]));\n            }\n            serialized += '}';\n            return serialized;\n        }\n        return JSON.stringify(value);\n    };\n    for (var index = 0; index < candidateScopes.length; index += 1) {\n        var scope = candidateScopes[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            continue;\n        if (typeof scope.stableStringify !== 'function') {\n            try {\n                scope.stableStringify = fallbackStableStringify;\n            }\n            catch (assignError) {\n                void assignError;\n                try {\n                    Object.defineProperty(scope, 'stableStringify', {\n                        configurable: true,\n                        enumerable: false,\n                        writable: true,\n                        value: fallbackStableStringify,\n                    });\n                }\n                catch (defineError) {\n                    void defineError;\n                }\n            }\n        }\n    }\n    return fallbackStableStringify;\n})();\nfunction resolveAutoGearDefaultLanguageSource() {\n    var candidateScopes = [\n        AUTO_GEAR_NORMALIZER_SCOPE,\n        AUTO_GEAR_NORMALIZER_SCOPE && AUTO_GEAR_NORMALIZER_SCOPE.global,\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n    for (var index = 0; index < candidateScopes.length; index += 1) {\n        var scope = candidateScopes[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            continue;\n        if (typeof scope.DEFAULT_LANGUAGE_SAFE === 'string' && scope.DEFAULT_LANGUAGE_SAFE) {\n            return scope.DEFAULT_LANGUAGE_SAFE;\n        }\n        if (typeof scope.CPP_DEFAULT_LANGUAGE_SAFE === 'string' &&\n            scope.CPP_DEFAULT_LANGUAGE_SAFE) {\n            return scope.CPP_DEFAULT_LANGUAGE_SAFE;\n        }\n        if (scope.cineCoreShared &&\n            typeof scope.cineCoreShared.DEFAULT_LANGUAGE_SAFE === 'string' &&\n            scope.cineCoreShared.DEFAULT_LANGUAGE_SAFE) {\n            return scope.cineCoreShared.DEFAULT_LANGUAGE_SAFE;\n        }\n    }\n    return null;\n}\nfunction getAutoGearFallbackLanguage() {\n    var resolved = resolveAutoGearDefaultLanguageSource();\n    if (resolved) {\n        return resolved;\n    }\n    if (typeof navigator !== 'undefined' &&\n        typeof navigator.language === 'string' &&\n        navigator.language) {\n        return navigator.language.slice(0, 2).toLowerCase();\n    }\n    return 'en';\n}\nfunction assignAutoGearLanguageFallback(scope, fallbackLanguage) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n        return;\n    var assignIfMissing = function (key) {\n        if (typeof scope[key] !== 'string' || !scope[key]) {\n            try {\n                scope[key] = fallbackLanguage;\n            }\n            catch (assignError) {\n                void assignError;\n                try {\n                    Object.defineProperty(scope, key, {\n                        configurable: true,\n                        enumerable: false,\n                        writable: true,\n                        value: fallbackLanguage,\n                    });\n                }\n                catch (defineError) {\n                    void defineError;\n                }\n            }\n        }\n    };\n    assignIfMissing('DEFAULT_LANGUAGE_SAFE');\n    assignIfMissing('CPP_DEFAULT_LANGUAGE_SAFE');\n}\nfunction ensureAutoGearDefaultLanguageGlobals() {\n    var fallbackLanguage = getAutoGearFallbackLanguage();\n    var candidateScopes = [\n        AUTO_GEAR_NORMALIZER_SCOPE,\n        AUTO_GEAR_NORMALIZER_SCOPE && AUTO_GEAR_NORMALIZER_SCOPE.global,\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n    candidateScopes.forEach(function (scope) {\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            return;\n        assignAutoGearLanguageFallback(scope, fallbackLanguage);\n        if (scope.cineCoreShared && typeof scope.cineCoreShared === 'object') {\n            assignAutoGearLanguageFallback(scope.cineCoreShared, fallbackLanguage);\n        }\n    });\n}\nensureAutoGearDefaultLanguageGlobals();\nfunction getAutoGearFallbackTexts() {\n    var fallbackLang = getAutoGearFallbackLanguage();\n    try {\n        var fallbackTexts = getLanguageTexts(fallbackLang);\n        if (fallbackTexts && typeof fallbackTexts === 'object') {\n            return fallbackTexts;\n        }\n    }\n    catch (error) {\n        void error;\n    }\n    return {};\n}\nvar AUTO_GEAR_DEFAULT_SELECTOR_TYPES = Object.freeze([\n    'none',\n    'monitor',\n    'directorMonitor',\n    'tripodHeadBrand',\n    'tripodBowl',\n    'tripodTypes',\n    'tripodSpreader',\n    'fizHandUnit',\n]);\nfunction ensureAutoGearSelectorTypeGlobals(scope) {\n    var existingMap = scope && scope.AUTO_GEAR_SELECTOR_TYPE_MAP && typeof scope.AUTO_GEAR_SELECTOR_TYPE_MAP === 'object'\n        ? scope.AUTO_GEAR_SELECTOR_TYPE_MAP\n        : null;\n    var resolvedMap = existingMap && Object.keys(existingMap).length\n        ? existingMap\n        : AUTO_GEAR_DEFAULT_SELECTOR_TYPES.reduce(function (acc, type) {\n            acc[type.toLowerCase()] = type;\n            return acc;\n        }, Object.create(null));\n    var existingSet = scope && scope.AUTO_GEAR_SELECTOR_TYPE_SET instanceof Set\n        ? scope.AUTO_GEAR_SELECTOR_TYPE_SET\n        : null;\n    var resolvedSet = existingSet && existingSet.size\n        ? existingSet\n        : new Set(Object.keys(resolvedMap));\n    if (scope && typeof scope === 'object') {\n        if (!scope.AUTO_GEAR_SELECTOR_TYPE_MAP) {\n            scope.AUTO_GEAR_SELECTOR_TYPE_MAP = resolvedMap;\n        }\n        if (!scope.AUTO_GEAR_SELECTOR_TYPE_SET) {\n            scope.AUTO_GEAR_SELECTOR_TYPE_SET = resolvedSet;\n        }\n    }\n    return {\n        map: resolvedMap,\n        set: resolvedSet,\n    };\n}\nvar AUTO_GEAR_SELECTOR_TYPE_GLOBALS = ensureAutoGearSelectorTypeGlobals(AUTO_GEAR_NORMALIZER_SCOPE);\nvar AUTO_GEAR_SELECTOR_TYPE_MAP_FALLBACK = AUTO_GEAR_SELECTOR_TYPE_GLOBALS.map;\nvar AUTO_GEAR_SELECTOR_TYPE_SET_FALLBACK = AUTO_GEAR_SELECTOR_TYPE_GLOBALS.set;\n/**\n * Produce a deterministic-looking id for Auto Gear rules/presets.\n *\n * The IDs are stored alongside user data in localStorage, so we use the\n * strongest source of randomness that is available without requiring network\n * access. When `crypto.randomUUID` is not present we fall back to a timestamp\n * + Math.random combination to avoid collisions.\n *\n * @param {string} [prefix]\n * @returns {string}\n */\nfunction generateAutoGearId(prefix) {\n    var base = prefix || 'rule';\n    if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n        return \"\".concat(base, \"-\").concat(crypto.randomUUID());\n    }\n    return \"\".concat(base, \"-\").concat(Math.random().toString(36).slice(2), \"-\").concat(Date.now());\n}\n/**\n * Ensure that quantity values loaded from user input always resolve to a\n * positive integer. Keeping this logic in one place protects every feature\n * that relies on the quantity (lists, backups, exports, etc.) against\n * malformed form data.\n *\n * @param {unknown} value\n * @returns {number}\n */\nfunction normalizeAutoGearQuantity(value) {\n    var num = parseInt(value, 10);\n    return Number.isFinite(num) && num > 0 ? num : 1;\n}\n/**\n * Convert the multi-line textarea input for Auto Gear lists into a structured\n * array.\n *\n * Besides providing a nicer UI this helper also keeps the import/export\n * behaviour easy to audit because the exact parsing rules are documented in\n * one place.\n *\n * @param {unknown} value\n * @returns {Array<{ name: string, quantity?: number, listType?: 'add'|'remove' }>} Parsed entries.\n */\nfunction parseAutoGearDraftNames(value) {\n    if (typeof value !== 'string')\n        return [];\n    var raw = value.trim();\n    if (!raw)\n        return [];\n    var hasDelimiters = /[;\\n\\r]/.test(raw);\n    var parts = hasDelimiters ? raw.split(/[;\\n\\r]+/) : [raw];\n    return parts\n        .map(function (part) {\n        var segment = part.trim();\n        if (!segment)\n            return null;\n        var signMatch = segment.match(/^([+-])\\s*(.+)$/);\n        var listType = signMatch ? (signMatch[1] === '-' ? 'remove' : 'add') : null;\n        var content = signMatch ? signMatch[2].trim() : segment;\n        if (!content)\n            return null;\n        var quantityMatch = content.match(/^(\\d+)\\s*[x]\\s*(.+)$/i);\n        if (quantityMatch) {\n            var name_1 = quantityMatch[2].trim();\n            if (!name_1)\n                return null;\n            return { name: name_1, quantity: normalizeAutoGearQuantity(quantityMatch[1]), listType: listType };\n        }\n        return { name: content, listType: listType };\n    })\n        .filter(Boolean);\n}\n/**\n * Shared helper that normalizes free-text fields used across the Auto Gear UI\n * and persistence layer. Normalization protects user data from spurious\n * whitespace differences when synchronizing or restoring from backups.\n *\n * @param {unknown} value Raw input value.\n * @param {{ collapseWhitespace?: boolean }} [options]\n * @returns {string}\n */\nfunction normalizeAutoGearText(value, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.collapseWhitespace, collapseWhitespace = _c === void 0 ? true : _c;\n    if (typeof value === 'number' && Number.isFinite(value)) {\n        return String(value);\n    }\n    if (typeof value !== 'string')\n        return '';\n    var trimmed = value.trim();\n    if (!collapseWhitespace)\n        return trimmed;\n    return trimmed.replace(/\\s+/g, ' ');\n}\n/**\n * Normalize selector types to one of the supported strings so that stored\n * rules remain compatible even if the list of valid selectors is extended in\n * the future.\n *\n * @param {unknown} value\n * @returns {'none'|'monitor'|'directorMonitor'|'tripodHeadBrand'|'tripodBowl'|'tripodTypes'|'tripodSpreader'|'fizHandUnit'}\n */\nfunction normalizeAutoGearSelectorType(value) {\n    var candidate = typeof value === 'string' ? value.trim().toLowerCase() : '';\n    if (!candidate)\n        return 'none';\n    var selectorSet = (typeof AUTO_GEAR_SELECTOR_TYPE_SET !== 'undefined' && AUTO_GEAR_SELECTOR_TYPE_SET)\n        || AUTO_GEAR_SELECTOR_TYPE_SET_FALLBACK;\n    var selectorMap = (typeof AUTO_GEAR_SELECTOR_TYPE_MAP !== 'undefined' && AUTO_GEAR_SELECTOR_TYPE_MAP)\n        || AUTO_GEAR_SELECTOR_TYPE_MAP_FALLBACK;\n    if (!selectorSet || !selectorSet.has(candidate))\n        return 'none';\n    return (selectorMap && selectorMap[candidate]) || 'none';\n}\n/**\n * Make sure the default value for selector inputs is both human readable and\n * validated against the available options so that restoring backups never\n * yields an impossible selection.\n *\n * @param {'none'|'monitor'|'directorMonitor'|'tripodHeadBrand'|'tripodBowl'|'tripodTypes'|'tripodSpreader'} type\n * @param {unknown} value\n * @returns {string}\n */\nfunction normalizeAutoGearSelectorDefault(type, value, context) {\n    var text = normalizeAutoGearText(value);\n    if (!text)\n        return '';\n    var options = getAutoGearSelectorOptions(type, context ? { selectorContext: context } : null);\n    if (!options.length)\n        return text;\n    var match = options.find(function (option) { return option.toLowerCase() === text.toLowerCase(); });\n    return match || text;\n}\nvar AUTO_GEAR_MONITOR_DEFAULT_TYPES = {\n    focus: 'monitor',\n    handheld7: 'monitor',\n    combo15: 'directorMonitor',\n    director15: 'directorMonitor',\n};\nfunction normalizeAutoGearMonitorDefaults(value) {\n    var result = {\n        focus: '',\n        handheld7: '',\n        combo15: '',\n        director15: '',\n    };\n    if (!value || typeof value !== 'object') {\n        return result;\n    }\n    Object.keys(AUTO_GEAR_MONITOR_DEFAULT_TYPES).forEach(function (key) {\n        var type = AUTO_GEAR_MONITOR_DEFAULT_TYPES[key];\n        var normalized = normalizeAutoGearSelectorDefault(type, value[key]);\n        result[key] = normalized;\n    });\n    return result;\n}\nfunction resolveDevicesSnapshot() {\n    if (DEVICE_GLOBAL_SCOPE && DEVICE_GLOBAL_SCOPE.devices && typeof DEVICE_GLOBAL_SCOPE.devices === 'object') {\n        return DEVICE_GLOBAL_SCOPE.devices;\n    }\n    try {\n        return typeof devices !== 'undefined' && devices && typeof devices === 'object' ? devices : null;\n    }\n    catch (error) {\n        if (error && typeof error === 'object' && error.name === 'ReferenceError') {\n            return null;\n        }\n        throw error;\n    }\n}\nfunction updateGlobalDevicesReference(nextDevices) {\n    var normalizedDevices = nextDevices && typeof nextDevices === 'object'\n        ? nextDevices\n        : {};\n    var seenScopes = new Set();\n    var scopes = [];\n    var enqueueScope = function (scope) {\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n            return;\n        }\n        if (seenScopes.has(scope)) {\n            return;\n        }\n        seenScopes.add(scope);\n        scopes.push(scope);\n    };\n    try {\n        if (typeof DEVICE_GLOBAL_SCOPE !== 'undefined') {\n            enqueueScope(DEVICE_GLOBAL_SCOPE);\n        }\n    }\n    catch (scopeError) {\n        void scopeError;\n    }\n    enqueueScope(typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null);\n    enqueueScope(typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null);\n    enqueueScope(typeof CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE !== 'undefined'\n        ? CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE\n        : null);\n    enqueueScope(typeof globalThis !== 'undefined' ? globalThis : null);\n    enqueueScope(typeof window !== 'undefined' ? window : null);\n    enqueueScope(typeof self !== 'undefined' ? self : null);\n    enqueueScope(typeof global !== 'undefined' ? global : null);\n    for (var index = 0; index < scopes.length; index += 1) {\n        var scope = scopes[index];\n        if (!scope)\n            continue;\n        try {\n            scope.devices = normalizedDevices;\n        }\n        catch (assignError) {\n            void assignError;\n            try {\n                Object.defineProperty(scope, 'devices', {\n                    configurable: true,\n                    writable: true,\n                    value: normalizedDevices,\n                });\n            }\n            catch (defineError) {\n                void defineError;\n            }\n        }\n        try {\n            var shared = scope.CORE_SHARED || scope.cineCoreShared;\n            if (shared && typeof shared === 'object') {\n                shared.devices = normalizedDevices;\n                if (typeof shared.updateDevices === 'function') {\n                    try {\n                        shared.updateDevices(normalizedDevices);\n                    }\n                    catch (updateError) {\n                        void updateError;\n                    }\n                }\n            }\n        }\n        catch (sharedError) {\n            void sharedError;\n        }\n        if (scope && scope.global && scope.global !== scope) {\n            enqueueScope(scope.global);\n        }\n        var runtimeState = scope.__cineRuntimeState;\n        if (runtimeState && typeof runtimeState === 'object') {\n            try {\n                runtimeState.devices = normalizedDevices;\n            }\n            catch (runtimeError) {\n                void runtimeError;\n            }\n        }\n    }\n    var globalCoreShared = resolveAutoGearCoreShared();\n    if (globalCoreShared && typeof globalCoreShared === 'object') {\n        try {\n            globalCoreShared.devices = normalizedDevices;\n            if (typeof globalCoreShared.updateDevices === 'function') {\n                globalCoreShared.updateDevices(normalizedDevices);\n            }\n        }\n        catch (sharedAssignError) {\n            void sharedAssignError;\n        }\n    }\n    if (typeof module !== 'undefined'\n        && module\n        && typeof module.exports === 'object'\n        && module.exports) {\n        try {\n            module.exports.devices = normalizedDevices;\n        }\n        catch (moduleError) {\n            void moduleError;\n        }\n    }\n    return normalizedDevices;\n}\nfunction resolveAutoGearCoreShared() {\n    var candidateScopes = [\n        AUTO_GEAR_NORMALIZER_SCOPE,\n        AUTO_GEAR_NORMALIZER_SCOPE && AUTO_GEAR_NORMALIZER_SCOPE.global,\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n    for (var index = 0; index < candidateScopes.length; index += 1) {\n        var scope = candidateScopes[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            continue;\n        if (scope.CORE_SHARED && typeof scope.CORE_SHARED === 'object') {\n            return scope.CORE_SHARED;\n        }\n        if (scope.cineCoreShared && typeof scope.cineCoreShared === 'object') {\n            return scope.cineCoreShared;\n        }\n    }\n    return null;\n}\nfunction resolveTripodPreferenceSelect(type) {\n    if (typeof document === 'undefined')\n        return null;\n    var id = AUTO_GEAR_TRIPOD_FIELD_IDS[type];\n    if (!id)\n        return null;\n    return document.getElementById(id);\n}\nfunction collectTripodPreferenceOptions(type) {\n    if (!AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(type))\n        return [];\n    var select = resolveTripodPreferenceSelect(type);\n    if (!select || !select.options)\n        return [];\n    var options = Array.from(select.options);\n    var seen = new Set();\n    var results = [];\n    options.forEach(function (option) {\n        if (!option)\n            return;\n        var value = typeof option.value === 'string' ? option.value.trim() : '';\n        var label = typeof option.textContent === 'string' ? option.textContent.trim() : '';\n        var storeValue = value || label;\n        if (!storeValue)\n            return;\n        var dedupeKey = storeValue.toLowerCase();\n        if (seen.has(dedupeKey))\n            return;\n        seen.add(dedupeKey);\n        results.push({ value: storeValue, label: label || storeValue });\n    });\n    return results;\n}\nfunction getAutoGearSelectorOptions(type, itemOrContext) {\n    var normalizedType = normalizeAutoGearSelectorType(type);\n    var catalog = resolveDevicesSnapshot();\n    if (!catalog || typeof catalog !== 'object') {\n        return [];\n    }\n    if (normalizedType === 'monitor') {\n        var monitorDb = catalog && catalog.monitors ? catalog.monitors : null;\n        if (!monitorDb || typeof monitorDb !== 'object')\n            return [];\n        return Object.keys(monitorDb).filter(function (name) { return name && name !== 'None'; }).sort(localeSort);\n    }\n    if (normalizedType === 'directorMonitor') {\n        var directorDb = catalog && catalog.directorMonitors ? catalog.directorMonitors : null;\n        if (!directorDb || typeof directorDb !== 'object')\n            return [];\n        return Object.keys(directorDb).filter(function (name) { return name && name !== 'None'; }).sort(localeSort);\n    }\n    if (normalizedType === 'fizHandUnit') {\n        var groups = typeof AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS === 'object'\n            ? AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS\n            : (typeof globalThis !== 'undefined' && typeof globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS === 'object'\n                ? globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS\n                : Object.create(null));\n        var motorMap = typeof AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP === 'object'\n            ? AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP\n            : (typeof globalThis !== 'undefined' && typeof globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP === 'object'\n                ? globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP\n                : Object.create(null));\n        var contextValue = '';\n        if (itemOrContext && typeof itemOrContext === 'object') {\n            var context = itemOrContext.selectorContext || itemOrContext.context;\n            if (typeof context === 'string') {\n                contextValue = context.trim();\n            }\n        }\n        else if (typeof itemOrContext === 'string') {\n            contextValue = itemOrContext.trim();\n        }\n        var group = null;\n        if (contextValue) {\n            group = groups[contextValue] || null;\n            if (!group) {\n                var normalizedContext = normalizeAutoGearTriggerValue(contextValue);\n                if (normalizedContext) {\n                    if (groups[normalizedContext]) {\n                        group = groups[normalizedContext];\n                    }\n                    else if (motorMap[normalizedContext] && groups[motorMap[normalizedContext]]) {\n                        group = groups[motorMap[normalizedContext]];\n                    }\n                }\n            }\n        }\n        if (group && Array.isArray(group.options)) {\n            return group.options.slice();\n        }\n        var fallback_1 = [];\n        Object.values(groups).forEach(function (entry) {\n            if (!entry || !Array.isArray(entry.options))\n                return;\n            entry.options.forEach(function (option) {\n                if (!option || fallback_1.includes(option))\n                    return;\n                fallback_1.push(option);\n            });\n        });\n        return fallback_1;\n    }\n    if (AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(normalizedType)) {\n        return collectTripodPreferenceOptions(normalizedType).map(function (option) { return option.value; });\n    }\n    return [];\n}\nfunction getAutoGearSelectorLabel(type) {\n    var normalizedType = normalizeAutoGearSelectorType(type);\n    var langTexts = getLanguageTexts(currentLang);\n    var fallbackTexts = getAutoGearFallbackTexts();\n    if (normalizedType === 'monitor') {\n        return langTexts.autoGearSelectorMonitorOption\n            || fallbackTexts.autoGearSelectorMonitorOption\n            || 'Monitor selector';\n    }\n    if (normalizedType === 'directorMonitor') {\n        return langTexts.autoGearSelectorDirectorOption\n            || fallbackTexts.autoGearSelectorDirectorOption\n            || 'Director monitor selector';\n    }\n    if (normalizedType === 'tripodHeadBrand') {\n        return langTexts.autoGearSelectorTripodHeadOption\n            || fallbackTexts.autoGearSelectorTripodHeadOption\n            || 'Tripod head selector';\n    }\n    if (normalizedType === 'tripodBowl') {\n        return langTexts.autoGearSelectorTripodBowlOption\n            || fallbackTexts.autoGearSelectorTripodBowlOption\n            || 'Tripod bowl selector';\n    }\n    if (normalizedType === 'tripodTypes') {\n        return langTexts.autoGearSelectorTripodTypesOption\n            || fallbackTexts.autoGearSelectorTripodTypesOption\n            || 'Tripod type selector';\n    }\n    if (normalizedType === 'tripodSpreader') {\n        return langTexts.autoGearSelectorTripodSpreaderOption\n            || fallbackTexts.autoGearSelectorTripodSpreaderOption\n            || 'Tripod spreader selector';\n    }\n    if (normalizedType === 'fizHandUnit') {\n        return langTexts.autoGearSelectorFizHandUnitOption\n            || fallbackTexts.autoGearSelectorFizHandUnitOption\n            || 'FIZ hand unit selector';\n    }\n    return langTexts.autoGearSelectorNoneOption\n        || fallbackTexts.autoGearSelectorNoneOption\n        || 'No selector';\n}\nfunction getAutoGearSelectorScrollHint() {\n    var langTexts = getLanguageTexts(currentLang);\n    var fallbackTexts = getAutoGearFallbackTexts();\n    return langTexts.autoGearSelectorScrollHint\n        || fallbackTexts.autoGearSelectorScrollHint\n        || 'Scroll to see more devices.';\n}\nfunction getAutoGearSelectorDefaultPlaceholder() {\n    var langTexts = getLanguageTexts(currentLang);\n    var fallbackTexts = getAutoGearFallbackTexts();\n    return langTexts.autoGearSelectorDefaultPlaceholder\n        || fallbackTexts.autoGearSelectorDefaultPlaceholder\n        || 'Choose a default device';\n}\nfunction getAutoGearMonitorDefaultPlaceholder() {\n    var langTexts = getLanguageTexts(currentLang);\n    var fallbackTexts = getAutoGearFallbackTexts();\n    return langTexts.autoGearMonitorDefaultPlaceholder\n        || fallbackTexts.autoGearMonitorDefaultPlaceholder\n        || 'Use recommended automatically';\n}\nfunction formatAutoGearSelectorValue(type, value) {\n    var normalizedValue = typeof value === 'string' ? value.trim() : '';\n    if (!normalizedValue)\n        return '';\n    var normalizedType = normalizeAutoGearSelectorType(type);\n    if (AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(normalizedType)) {\n        var options = collectTripodPreferenceOptions(normalizedType);\n        var match = options.find(function (option) { return option.value.toLowerCase() === normalizedValue.toLowerCase(); });\n        if (match && match.label) {\n            return match.label;\n        }\n    }\n    if (typeof addArriKNumber === 'function'\n        && (normalizedType === 'monitor' || normalizedType === 'directorMonitor' || normalizedType === 'fizHandUnit')) {\n        return addArriKNumber(normalizedValue);\n    }\n    return normalizedValue;\n}\nfunction populateAutoGearCategorySelect(select, currentValue) {\n    var _a, _b;\n    if (!select)\n        return;\n    var current = typeof currentValue === 'string' ? currentValue : '';\n    var lang = typeof currentLang === 'string' ? currentLang : 'en';\n    select.innerHTML = '';\n    GEAR_LIST_CATEGORIES.forEach(function (category) {\n        var option = document.createElement('option');\n        option.value = category;\n        option.textContent = category;\n        if (current === category) {\n            option.selected = true;\n        }\n        select.appendChild(option);\n    });\n    var customOption = document.createElement('option');\n    customOption.value = AUTO_GEAR_CUSTOM_CATEGORY;\n    customOption.textContent = ((_a = texts === null || texts === void 0 ? void 0 : texts[lang]) === null || _a === void 0 ? void 0 : _a.autoGearCustomCategory)\n        || ((_b = texts === null || texts === void 0 ? void 0 : texts.en) === null || _b === void 0 ? void 0 : _b.autoGearCustomCategory)\n        || 'Custom Additions';\n    if (!current || current === AUTO_GEAR_CUSTOM_CATEGORY) {\n        customOption.selected = true;\n    }\n    select.appendChild(customOption);\n}\nfunction formatAutoGearOwnGearLabel(item) {\n    if (!item || typeof item.name !== 'string')\n        return '';\n    var quantityValue = typeof (item === null || item === void 0 ? void 0 : item.quantity) === 'number'\n        ? String(item.quantity)\n        : item === null || item === void 0 ? void 0 : item.quantity;\n    var quantityText = formatOwnGearQuantityText(quantityValue);\n    if (quantityText) {\n        return \"\".concat(item.name, \" (\").concat(quantityText, \")\");\n    }\n    return item.name;\n}\nfunction refreshAutoGearOwnGearConditionOptions(selected) {\n    if (!autoGearOwnGearSelect)\n        return;\n    var selectedValues = Array.isArray(selected)\n        ? selected\n            .filter(function (value) { return typeof value === 'string'; })\n            .map(function (value) { return value.trim(); })\n            .filter(Boolean)\n        : collectAutoGearSelectedValues(selected, 'ownGear');\n    autoGearOwnGearSelect.innerHTML = '';\n    autoGearOwnGearSelect.multiple = true;\n    var items = getAutoGearOwnGearItems();\n    var seen = new Set();\n    var appendOption = function (id, label, options) {\n        if (options === void 0) { options = {}; }\n        if (typeof id !== 'string')\n            return;\n        var trimmedId = id.trim();\n        if (!trimmedId || seen.has(trimmedId))\n            return;\n        var option = document.createElement('option');\n        option.value = trimmedId;\n        option.textContent = label || trimmedId;\n        if (options.dataset && option.dataset) {\n            Object.entries(options.dataset).forEach(function (_a) {\n                var key = _a[0], value = _a[1];\n                if (value == null)\n                    return;\n                option.dataset[key] = value;\n            });\n        }\n        if (options.fallback) {\n            option.dataset.autoGearFallback = 'true';\n        }\n        if (selectedValues.includes(trimmedId)) {\n            option.selected = true;\n        }\n        autoGearOwnGearSelect.appendChild(option);\n        seen.add(trimmedId);\n    };\n    items.forEach(function (item) {\n        if (!item || typeof item.id !== 'string')\n            return;\n        var trimmedId = item.id.trim();\n        if (!trimmedId)\n            return;\n        var dataset = {};\n        if (typeof item.name === 'string' && item.name) {\n            dataset.name = item.name;\n        }\n        var formattedQuantity = formatOwnGearQuantityText(item.quantity);\n        if (formattedQuantity) {\n            dataset.quantity = formattedQuantity;\n        }\n        if (typeof item.notes === 'string' && item.notes) {\n            dataset.notes = item.notes;\n        }\n        appendOption(trimmedId, formatAutoGearOwnGearLabel(item) || item.name || trimmedId, { dataset: dataset });\n    });\n    selectedValues.forEach(function (value) {\n        if (!value || seen.has(value))\n            return;\n        var record = typeof findAutoGearOwnGearById === 'function'\n            ? findAutoGearOwnGearById(value)\n            : null;\n        var label = (record === null || record === void 0 ? void 0 : record.name) || value;\n        appendOption(value, label, { fallback: true });\n    });\n    var selectableOptions = Array.from(autoGearOwnGearSelect.options || []).filter(function (option) { return !option.disabled; });\n    autoGearOwnGearSelect.size = computeAutoGearMultiSelectSize(selectableOptions.length, { minRows: AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS });\n    var hasSelectable = selectableOptions.some(function (option) { return option.dataset.autoGearFallback !== 'true'; });\n    autoGearOwnGearSelect.disabled = !hasSelectable && selectedValues.length === 0;\n}\nfunction updateAutoGearOwnGearOptions() {\n    var selects = [autoGearAddOwnGearSelect, autoGearRemoveOwnGearSelect].filter(Boolean);\n    if (!selects.length)\n        return;\n    var items = getAutoGearOwnGearItems();\n    selects.forEach(function (select) {\n        var _a, _b;\n        if (!select)\n            return;\n        var currentValue = select.value || '';\n        var placeholder = select.getAttribute('data-placeholder')\n            || ((_a = texts[currentLang]) === null || _a === void 0 ? void 0 : _a.autoGearOwnGearPlaceholder)\n            || ((_b = texts.en) === null || _b === void 0 ? void 0 : _b.autoGearOwnGearPlaceholder)\n            || 'Manual entry';\n        select.innerHTML = '';\n        var placeholderOption = document.createElement('option');\n        placeholderOption.value = '';\n        placeholderOption.textContent = placeholder;\n        select.appendChild(placeholderOption);\n        items.forEach(function (item) {\n            if (!item || typeof item.id !== 'string' || !item.id || typeof item.name !== 'string')\n                return;\n            var option = document.createElement('option');\n            option.value = item.id;\n            option.textContent = formatAutoGearOwnGearLabel(item) || item.name;\n            option.dataset.name = item.name;\n            if (item.notes)\n                option.dataset.notes = item.notes;\n            if (item.source)\n                option.dataset.source = item.source;\n            var formattedQuantity = formatOwnGearQuantityText(item.quantity);\n            if (formattedQuantity)\n                option.dataset.quantity = formattedQuantity;\n            if (item.id === currentValue)\n                option.selected = true;\n            select.appendChild(option);\n        });\n        if (currentValue && select.value !== currentValue) {\n            if (select.querySelector(\"option[value=\\\"\".concat(currentValue, \"\\\"]\"))) {\n                select.value = currentValue;\n            }\n            else {\n                select.value = '';\n            }\n        }\n        select.disabled = items.length === 0;\n    });\n    refreshAutoGearOwnGearConditionOptions(Array.isArray(autoGearEditorDraft === null || autoGearEditorDraft === void 0 ? void 0 : autoGearEditorDraft.ownGear)\n        ? autoGearEditorDraft.ownGear\n        : undefined);\n}\nfunction isAutoGearMonitoringCategory(value) {\n    if (typeof value !== 'string')\n        return false;\n    return value.trim().toLowerCase() === 'monitoring';\n}\nfunction isMonitoringCategorySelected(select) {\n    var _a;\n    if (!select)\n        return false;\n    var directValue = typeof select.value === 'string' ? select.value : '';\n    if (isAutoGearMonitoringCategory(directValue)) {\n        return true;\n    }\n    var option = ((_a = select.options) === null || _a === void 0 ? void 0 : _a[select.selectedIndex]) || null;\n    if (!option)\n        return false;\n    var optionValue = typeof option.value === 'string' ? option.value : '';\n    if (isAutoGearMonitoringCategory(optionValue)) {\n        return true;\n    }\n    var optionLabel = typeof option.textContent === 'string' ? option.textContent : '';\n    return isAutoGearMonitoringCategory(optionLabel);\n}\nfunction matchesTripodCategory(value) {\n    var normalized = typeof value === 'string' ? value.trim().toLowerCase() : '';\n    if (!normalized)\n        return false;\n    if (normalized === 'camera support')\n        return true;\n    if (normalized === 'grip')\n        return true;\n    return normalized.includes('tripod');\n}\nfunction isTripodCategorySelected(select) {\n    var _a;\n    if (!select)\n        return false;\n    var directValue = typeof select.value === 'string' ? select.value : '';\n    if (matchesTripodCategory(directValue))\n        return true;\n    var option = ((_a = select.options) === null || _a === void 0 ? void 0 : _a[select.selectedIndex]) || null;\n    if (!option)\n        return false;\n    if (matchesTripodCategory(option.value))\n        return true;\n    var optionLabel = typeof option.textContent === 'string' ? option.textContent : '';\n    return matchesTripodCategory(optionLabel);\n}\nfunction setAutoGearFieldVisibility(field, isVisible) {\n    if (!field)\n        return;\n    if (isVisible) {\n        field.hidden = false;\n        field.removeAttribute('hidden');\n        field.removeAttribute('aria-hidden');\n        if (Object.prototype.hasOwnProperty.call(field.dataset, 'autoGearHiddenDisplay')) {\n            var storedDisplay = field.dataset.autoGearHiddenDisplay;\n            if (storedDisplay) {\n                field.style.display = storedDisplay;\n            }\n            else {\n                field.style.removeProperty('display');\n            }\n            delete field.dataset.autoGearHiddenDisplay;\n        }\n        else if (field.style.display === 'none') {\n            field.style.removeProperty('display');\n        }\n    }\n    else {\n        field.hidden = true;\n        field.setAttribute('hidden', '');\n        field.setAttribute('aria-hidden', 'true');\n        if (!Object.prototype.hasOwnProperty.call(field.dataset, 'autoGearHiddenDisplay')) {\n            field.dataset.autoGearHiddenDisplay = field.style.display || '';\n        }\n        field.style.display = 'none';\n    }\n}\nfunction updateAutoGearMonitorFieldGroup(group) {\n    if (!group || !group.select)\n        return;\n    var select = group.select, screenSizeField = group.screenSizeField, screenSizeInput = group.screenSizeInput, selectorTypeField = group.selectorTypeField, selectorTypeSelect = group.selectorTypeSelect, selectorDefaultField = group.selectorDefaultField, selectorDefaultInput = group.selectorDefaultInput;\n    var isMonitoring = isMonitoringCategorySelected(select);\n    var isTripod = isTripodCategorySelected(select);\n    var showScreenSize = isMonitoring;\n    var showSelectorFields = isMonitoring || isTripod;\n    setAutoGearFieldVisibility(screenSizeField, showScreenSize);\n    setAutoGearFieldVisibility(selectorTypeField, showSelectorFields);\n    setAutoGearFieldVisibility(selectorDefaultField, showSelectorFields);\n    if (!showScreenSize && screenSizeInput) {\n        screenSizeInput.value = '';\n    }\n    if (!showSelectorFields) {\n        if (selectorTypeSelect)\n            selectorTypeSelect.value = 'none';\n        if (selectorDefaultInput) {\n            selectorDefaultInput.value = '';\n            if (Object.prototype.hasOwnProperty.call(selectorDefaultInput.dataset || {}, 'autoGearPreferredDefault')) {\n                delete selectorDefaultInput.dataset.autoGearPreferredDefault;\n            }\n        }\n    }\n}\nfunction extractAutoGearContextNotes(name) {\n    var contexts = [];\n    if (!name || typeof name !== 'string') {\n        return { baseName: '', contexts: contexts };\n    }\n    var baseName = name.trim();\n    var contextPattern = /^(.*\\([^()]*\\)) \\(([^()]+)\\)$/;\n    var match = baseName.match(contextPattern);\n    while (match) {\n        var candidate = match[2].trim();\n        if (/handheld\\b/i.test(candidate) || /15-21\"?$/.test(candidate)) {\n            contexts.unshift(candidate);\n            baseName = match[1].trim();\n        }\n        else {\n            break;\n        }\n        match = baseName.match(contextPattern);\n    }\n    return { baseName: baseName, contexts: contexts };\n}\nfunction normalizeAutoGearItem(entry) {\n    if (!entry || typeof entry !== 'object')\n        return null;\n    var requestedName = normalizeAutoGearText(entry.name);\n    var ownGearSourceId = typeof entry.ownGearId === 'string' ? entry.ownGearId.trim() : '';\n    var ownGearFallbackLabel = normalizeAutoGearText(entry.ownGearLabel);\n    var ownGearNameInput = normalizeAutoGearText(entry.ownGearName);\n    var ownGearRecord = null;\n    if (ownGearSourceId) {\n        ownGearRecord = findAutoGearOwnGearById(ownGearSourceId) || null;\n    }\n    var rawName = (ownGearRecord === null || ownGearRecord === void 0 ? void 0 : ownGearRecord.name)\n        || ownGearNameInput\n        || requestedName;\n    if (!rawName)\n        return null;\n    var _a = extractAutoGearContextNotes(requestedName || rawName), baseName = _a.baseName, contexts = _a.contexts;\n    var name = baseName || rawName;\n    var storedContexts = Array.isArray(entry.contextNotes)\n        ? entry.contextNotes.filter(function (value) { return typeof value === 'string' && value.trim(); })\n        : [];\n    storedContexts.forEach(function (note) {\n        var trimmed = note.trim();\n        if (!trimmed)\n            return;\n        if (!contexts.includes(trimmed))\n            contexts.push(trimmed);\n    });\n    var category = normalizeAutoGearText(entry.category);\n    var quantity = normalizeAutoGearQuantity(entry.quantity);\n    var id = typeof entry.id === 'string' && entry.id ? entry.id : generateAutoGearId('item');\n    var screenSize = normalizeAutoGearText(entry.screenSize);\n    var selectorType = normalizeAutoGearSelectorType(entry.selectorType);\n    var selectorContext = typeof entry.selectorContext === 'string'\n        ? entry.selectorContext.trim()\n        : '';\n    var selectorDefault = normalizeAutoGearSelectorDefault(selectorType, entry.selectorDefault, selectorContext);\n    var selectorEnabled = !!entry.selectorEnabled;\n    if (selectorType === 'none') {\n        selectorEnabled = false;\n    }\n    else if (isAutoGearMonitoringCategory(category)) {\n        selectorEnabled = true;\n    }\n    var notes = normalizeAutoGearText(entry.notes);\n    var ownGearId = '';\n    var ownGearLabel = '';\n    if (ownGearRecord) {\n        ownGearId = ownGearRecord.id;\n        ownGearLabel = ownGearRecord.name || '';\n        name = ownGearRecord.name || name;\n        if (!notes && typeof ownGearRecord.notes === 'string') {\n            var trimmedNotes = normalizeAutoGearText(ownGearRecord.notes);\n            if (trimmedNotes)\n                notes = trimmedNotes;\n        }\n    }\n    else if (ownGearSourceId) {\n        ownGearId = ownGearSourceId;\n        ownGearLabel = ownGearFallbackLabel || ownGearNameInput || name;\n    }\n    return {\n        id: id,\n        name: name,\n        category: category,\n        quantity: quantity,\n        screenSize: screenSize,\n        selectorType: selectorType,\n        selectorDefault: selectorDefault,\n        selectorEnabled: selectorEnabled,\n        selectorContext: selectorContext,\n        notes: notes,\n        contextNotes: contexts,\n        ownGearId: ownGearId,\n        ownGearLabel: ownGearLabel,\n    };\n}\nfunction normalizeAutoGearTriggerList(values) {\n    if (!Array.isArray(values))\n        return [];\n    return Array.from(new Set(values\n        .map(function (value) { return (typeof value === 'string' ? value.trim() : ''); })\n        .filter(Boolean)));\n}\nvar AUTO_GEAR_SCENARIO_LOGIC_VALUES = new Set(['all', 'any', 'multiplier']);\nfunction normalizeAutoGearScenarioLogic(value) {\n    if (typeof value !== 'string')\n        return 'all';\n    var normalized = value.trim().toLowerCase();\n    if (!normalized)\n        return 'all';\n    if (normalized === 'or')\n        return 'any';\n    if (normalized === 'and')\n        return 'all';\n    if (normalized === 'any')\n        return 'any';\n    if (normalized === 'multiplier' || normalized === 'multiply' || normalized === 'multiplied') {\n        return 'multiplier';\n    }\n    return AUTO_GEAR_SCENARIO_LOGIC_VALUES.has(normalized) ? normalized : 'all';\n}\nvar AUTO_GEAR_CONDITION_LOGIC_VALUES = new Set(['all', 'any', 'or', 'none', 'multiplier']);\nvar AUTO_GEAR_CONDITION_LOGIC_FIELDS = {\n    mattebox: 'matteboxLogic',\n    cameraHandle: 'cameraHandleLogic',\n    viewfinderExtension: 'viewfinderExtensionLogic',\n    deliveryResolution: 'deliveryResolutionLogic',\n    videoDistribution: 'videoDistributionLogic',\n    camera: 'cameraLogic',\n    ownGear: 'ownGearLogic',\n    monitor: 'monitorLogic',\n    tripodHeadBrand: 'tripodHeadBrandLogic',\n    tripodBowl: 'tripodBowlLogic',\n    tripodTypes: 'tripodTypesLogic',\n    tripodSpreader: 'tripodSpreaderLogic',\n    crewPresent: 'crewPresentLogic',\n    crewAbsent: 'crewAbsentLogic',\n    wireless: 'wirelessLogic',\n    motors: 'motorsLogic',\n    controllers: 'controllersLogic',\n    distance: 'distanceLogic',\n};\nfunction normalizeAutoGearConditionLogic(value) {\n    if (typeof value !== 'string')\n        return 'all';\n    var normalized = value.trim().toLowerCase();\n    if (!normalized)\n        return 'all';\n    if (normalized === 'or')\n        return 'or';\n    if (normalized === 'and')\n        return 'all';\n    if (normalized === 'any')\n        return 'any';\n    if (normalized === 'none' || normalized === 'no' || normalized === 'exclude' || normalized === 'absent') {\n        return 'none';\n    }\n    if (normalized === 'multiplier' || normalized === 'multiply' || normalized === 'multiplied') {\n        return 'multiplier';\n    }\n    if (!AUTO_GEAR_CONDITION_LOGIC_VALUES.has(normalized)) {\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n            console.warn('Unknown auto gear condition logic joiner. Falling back to \"all\".', value);\n        }\n        return 'all';\n    }\n    return normalized;\n}\nfunction readAutoGearConditionLogic(rule, key) {\n    if (!rule || typeof rule !== 'object')\n        return 'all';\n    var property = AUTO_GEAR_CONDITION_LOGIC_FIELDS[key];\n    var raw;\n    if (property && Object.prototype.hasOwnProperty.call(rule, property)) {\n        raw = rule[property];\n    }\n    if (raw == null) {\n        var alias = \"\".concat(key, \"Mode\");\n        if (Object.prototype.hasOwnProperty.call(rule, alias)) {\n            raw = rule[alias];\n        }\n    }\n    if (raw == null && rule.conditionLogic && typeof rule.conditionLogic === 'object') {\n        raw = rule.conditionLogic[key];\n    }\n    return normalizeAutoGearConditionLogic(raw);\n}\nfunction normalizeAutoGearScenarioMultiplier(value) {\n    var num = parseInt(value, 10);\n    return Number.isFinite(num) && num > 1 ? num : 1;\n}\nfunction normalizeAutoGearScenarioPrimary(value) {\n    return typeof value === 'string' ? value.trim() : '';\n}\nfunction normalizeVideoDistributionTriggerList(values) {\n    if (!Array.isArray(values))\n        return [];\n    var base = normalizeAutoGearTriggerList(values);\n    var seen = new Set();\n    var result = [];\n    base.forEach(function (value) {\n        var lower = value.toLowerCase();\n        var normalized = lower === '__none__' || lower === 'none'\n            ? '__none__'\n            : value;\n        if (!normalized || seen.has(normalized))\n            return;\n        seen.add(normalized);\n        result.push(normalized);\n    });\n    return result;\n}\nfunction normalizeAutoGearTriggerValue(value) {\n    return typeof value === 'string' ? value.trim().toLowerCase() : '';\n}\nfunction autoGearRuleMatteboxKey(rule) {\n    if (!rule || typeof rule !== 'object')\n        return '';\n    var matteboxList = Array.isArray(rule.mattebox) ? rule.mattebox : [];\n    if (!matteboxList.length)\n        return '';\n    return matteboxList\n        .map(normalizeAutoGearTriggerValue)\n        .filter(Boolean)\n        .sort(function (a, b) { return a.localeCompare(b); })\n        .join('|');\n}\nvar AUTO_GEAR_SHOOTING_DAY_MODES = new Set(['minimum', 'maximum', 'every']);\nfunction normalizeAutoGearShootingDayMode(value) {\n    if (typeof value !== 'string')\n        return 'minimum';\n    var normalized = value.trim().toLowerCase();\n    if (!normalized)\n        return 'minimum';\n    if (AUTO_GEAR_SHOOTING_DAY_MODES.has(normalized))\n        return normalized;\n    if (normalized === 'min' || normalized === 'at least')\n        return 'minimum';\n    if (normalized === 'max' || normalized === 'at most')\n        return 'maximum';\n    if (normalized === 'each' || normalized === 'every')\n        return 'every';\n    return 'minimum';\n}\nfunction normalizeAutoGearShootingDayValue(value) {\n    if (typeof value === 'number' && Number.isFinite(value)) {\n        var rounded = Math.round(value);\n        return rounded > 0 ? rounded : null;\n    }\n    if (typeof value === 'string') {\n        var trimmed = value.trim();\n        if (!trimmed)\n            return null;\n        var parsed = Number.parseInt(trimmed, 10);\n        if (!Number.isFinite(parsed))\n            return null;\n        return parsed > 0 ? parsed : null;\n    }\n    return null;\n}\nfunction normalizeAutoGearShootingDaysList(values) {\n    if (!Array.isArray(values))\n        return [];\n    var unique = new Set();\n    values.forEach(function (value) {\n        var normalized = normalizeAutoGearShootingDayValue(value);\n        if (Number.isFinite(normalized) && normalized > 0) {\n            unique.add(normalized);\n        }\n    });\n    return Array.from(unique).sort(function (a, b) { return a - b; });\n}\nfunction normalizeAutoGearShootingDaysCondition(setting) {\n    var _a, _b, _c, _d, _e, _f, _g, _h, _j;\n    if (!setting)\n        return null;\n    if (Array.isArray(setting)) {\n        var values = normalizeAutoGearShootingDaysList(setting);\n        if (!values.length)\n            return null;\n        var maxValue = values[values.length - 1];\n        return Number.isFinite(maxValue) && maxValue > 0\n            ? { mode: 'minimum', value: maxValue }\n            : null;\n    }\n    if (typeof setting === 'object') {\n        var modeSource = (_d = (_c = (_b = (_a = setting.mode) !== null && _a !== void 0 ? _a : setting.type) !== null && _b !== void 0 ? _b : setting.comparison) !== null && _c !== void 0 ? _c : setting.condition) !== null && _d !== void 0 ? _d : setting.kind;\n        var mode = normalizeAutoGearShootingDayMode(modeSource);\n        var valueSource = (_j = (_h = (_g = (_f = (_e = setting.value) !== null && _e !== void 0 ? _e : setting.count) !== null && _f !== void 0 ? _f : setting.days) !== null && _g !== void 0 ? _g : setting.minimum) !== null && _h !== void 0 ? _h : setting.maximum) !== null && _j !== void 0 ? _j : setting.frequency;\n        var value = normalizeAutoGearShootingDayValue(valueSource);\n        if (Number.isFinite(value) && value > 0) {\n            return { mode: mode, value: value };\n        }\n        return null;\n    }\n    var normalizedValue = normalizeAutoGearShootingDayValue(setting);\n    if (Number.isFinite(normalizedValue) && normalizedValue > 0) {\n        return { mode: 'minimum', value: normalizedValue };\n    }\n    return null;\n}\nfunction normalizeAutoGearRule(rule) {\n    if (!rule || typeof rule !== 'object')\n        return null;\n    var id = typeof rule.id === 'string' && rule.id ? rule.id : generateAutoGearId('rule');\n    var label = typeof rule.label === 'string' ? rule.label.trim() : '';\n    var enabled = true;\n    if (typeof rule.enabled === 'string') {\n        var normalized = rule.enabled.trim().toLowerCase();\n        if (normalized === 'false' || normalized === '0') {\n            enabled = false;\n        }\n    }\n    else if (rule.enabled === false) {\n        enabled = false;\n    }\n    var always = false;\n    if (Array.isArray(rule.always)) {\n        always = rule.always.some(function (value) {\n            if (typeof value === 'string') {\n                var trimmed = value.trim().toLowerCase();\n                if (!trimmed)\n                    return false;\n                if (trimmed === 'false' || trimmed === '0')\n                    return false;\n                return true;\n            }\n            return Boolean(value);\n        });\n    }\n    else if (typeof rule.always === 'string') {\n        var trimmed = rule.always.trim().toLowerCase();\n        always = trimmed === 'true' || (trimmed && trimmed !== 'false' && trimmed !== '0');\n    }\n    else {\n        always = Boolean(rule.always);\n    }\n    var scenarios = normalizeAutoGearTriggerList(rule.scenarios);\n    var scenarioLogic = normalizeAutoGearScenarioLogic(rule.scenarioLogic);\n    var scenarioMultiplier = 1;\n    var scenarioPrimary = '';\n    if (scenarioLogic === 'multiplier') {\n        scenarioMultiplier = normalizeAutoGearScenarioMultiplier(rule.scenarioMultiplier);\n        var requestedPrimary = normalizeAutoGearScenarioPrimary(rule.scenarioPrimary);\n        var normalizedPrimary_1 = normalizeAutoGearTriggerValue(requestedPrimary);\n        if (normalizedPrimary_1) {\n            var matched = scenarios.find(function (value) { return normalizeAutoGearTriggerValue(value) === normalizedPrimary_1; });\n            if (matched) {\n                scenarioPrimary = matched;\n            }\n            else if (requestedPrimary) {\n                scenarioPrimary = requestedPrimary;\n                scenarios.push(requestedPrimary);\n            }\n        }\n        if (!scenarioPrimary && scenarios.length) {\n            scenarioPrimary = scenarios[0];\n        }\n    }\n    scenarios = scenarios.sort(function (a, b) { return a.localeCompare(b); });\n    if (scenarioLogic === 'multiplier' && scenarioPrimary) {\n        var normalizedPrimary_2 = normalizeAutoGearTriggerValue(scenarioPrimary);\n        var hasPrimary = scenarios.some(function (value) { return normalizeAutoGearTriggerValue(value) === normalizedPrimary_2; });\n        if (!hasPrimary) {\n            scenarios.push(scenarioPrimary);\n            scenarios.sort(function (a, b) { return a.localeCompare(b); });\n        }\n    }\n    var mattebox = normalizeAutoGearTriggerList(rule.mattebox).sort(function (a, b) { return a.localeCompare(b); });\n    var cameraHandle = normalizeAutoGearTriggerList(rule.cameraHandle).sort(function (a, b) { return a.localeCompare(b); });\n    var viewfinderExtension = normalizeAutoGearTriggerList(rule.viewfinderExtension).sort(function (a, b) { return a.localeCompare(b); });\n    var deliveryResolution = normalizeAutoGearTriggerList(rule.deliveryResolution).sort(function (a, b) { return a.localeCompare(b); });\n    var videoDistribution = normalizeVideoDistributionTriggerList(rule.videoDistribution)\n        .sort(function (a, b) { return a.localeCompare(b); });\n    var camera = normalizeAutoGearTriggerList(rule.camera).sort(function (a, b) { return a.localeCompare(b); });\n    var ownGear = normalizeAutoGearTriggerList(rule.ownGear).sort(function (a, b) { return a.localeCompare(b); });\n    var cameraWeight = normalizeAutoGearCameraWeightCondition(rule.cameraWeight);\n    var monitor = normalizeAutoGearTriggerList(rule.monitor).sort(function (a, b) { return a.localeCompare(b); });\n    var tripodHeadBrand = normalizeAutoGearTriggerList(rule.tripodHeadBrand).sort(function (a, b) { return a.localeCompare(b); });\n    var tripodBowl = normalizeAutoGearTriggerList(rule.tripodBowl).sort(function (a, b) { return a.localeCompare(b); });\n    var tripodTypes = normalizeAutoGearTriggerList(rule.tripodTypes).sort(function (a, b) { return a.localeCompare(b); });\n    var tripodSpreader = normalizeAutoGearTriggerList(rule.tripodSpreader).sort(function (a, b) { return a.localeCompare(b); });\n    var crewPresent = normalizeAutoGearTriggerList(rule.crewPresent).sort(function (a, b) { return a.localeCompare(b); });\n    var crewAbsent = normalizeAutoGearTriggerList(rule.crewAbsent).sort(function (a, b) { return a.localeCompare(b); });\n    var wireless = normalizeAutoGearTriggerList(rule.wireless).sort(function (a, b) { return a.localeCompare(b); });\n    var motors = normalizeAutoGearTriggerList(rule.motors).sort(function (a, b) { return a.localeCompare(b); });\n    var controllers = normalizeAutoGearTriggerList(rule.controllers).sort(function (a, b) { return a.localeCompare(b); });\n    var distance = normalizeAutoGearTriggerList(rule.distance).sort(function (a, b) { return a.localeCompare(b); });\n    var shootingDays = normalizeAutoGearShootingDaysCondition(rule.shootingDays);\n    var matteboxLogic = readAutoGearConditionLogic(rule, 'mattebox');\n    var cameraHandleLogic = readAutoGearConditionLogic(rule, 'cameraHandle');\n    var viewfinderExtensionLogic = readAutoGearConditionLogic(rule, 'viewfinderExtension');\n    var deliveryResolutionLogic = readAutoGearConditionLogic(rule, 'deliveryResolution');\n    var videoDistributionLogic = readAutoGearConditionLogic(rule, 'videoDistribution');\n    var cameraLogic = readAutoGearConditionLogic(rule, 'camera');\n    var ownGearLogic = readAutoGearConditionLogic(rule, 'ownGear');\n    var monitorLogic = readAutoGearConditionLogic(rule, 'monitor');\n    var tripodHeadBrandLogic = readAutoGearConditionLogic(rule, 'tripodHeadBrand');\n    var tripodBowlLogic = readAutoGearConditionLogic(rule, 'tripodBowl');\n    var tripodTypesLogic = readAutoGearConditionLogic(rule, 'tripodTypes');\n    var tripodSpreaderLogic = readAutoGearConditionLogic(rule, 'tripodSpreader');\n    var crewPresentLogic = readAutoGearConditionLogic(rule, 'crewPresent');\n    var crewAbsentLogic = readAutoGearConditionLogic(rule, 'crewAbsent');\n    var wirelessLogic = readAutoGearConditionLogic(rule, 'wireless');\n    var motorsLogic = readAutoGearConditionLogic(rule, 'motors');\n    var controllersLogic = readAutoGearConditionLogic(rule, 'controllers');\n    var distanceLogic = readAutoGearConditionLogic(rule, 'distance');\n    var conditionLogic = {};\n    if (scenarioLogic && scenarioLogic !== 'all') {\n        conditionLogic.scenarios = scenarioLogic;\n    }\n    if (matteboxLogic && matteboxLogic !== 'all')\n        conditionLogic.mattebox = matteboxLogic;\n    if (cameraHandleLogic && cameraHandleLogic !== 'all')\n        conditionLogic.cameraHandle = cameraHandleLogic;\n    if (viewfinderExtensionLogic && viewfinderExtensionLogic !== 'all') {\n        conditionLogic.viewfinderExtension = viewfinderExtensionLogic;\n    }\n    if (deliveryResolutionLogic && deliveryResolutionLogic !== 'all') {\n        conditionLogic.deliveryResolution = deliveryResolutionLogic;\n    }\n    if (videoDistributionLogic && videoDistributionLogic !== 'all') {\n        conditionLogic.videoDistribution = videoDistributionLogic;\n    }\n    if (cameraLogic && cameraLogic !== 'all')\n        conditionLogic.camera = cameraLogic;\n    if (ownGearLogic && ownGearLogic !== 'all')\n        conditionLogic.ownGear = ownGearLogic;\n    if (monitorLogic && monitorLogic !== 'all')\n        conditionLogic.monitor = monitorLogic;\n    if (tripodHeadBrandLogic && tripodHeadBrandLogic !== 'all') {\n        conditionLogic.tripodHeadBrand = tripodHeadBrandLogic;\n    }\n    if (tripodBowlLogic && tripodBowlLogic !== 'all') {\n        conditionLogic.tripodBowl = tripodBowlLogic;\n    }\n    if (tripodTypesLogic && tripodTypesLogic !== 'all') {\n        conditionLogic.tripodTypes = tripodTypesLogic;\n    }\n    if (tripodSpreaderLogic && tripodSpreaderLogic !== 'all') {\n        conditionLogic.tripodSpreader = tripodSpreaderLogic;\n    }\n    if (crewPresentLogic && crewPresentLogic !== 'all')\n        conditionLogic.crewPresent = crewPresentLogic;\n    if (crewAbsentLogic && crewAbsentLogic !== 'all')\n        conditionLogic.crewAbsent = crewAbsentLogic;\n    if (wirelessLogic && wirelessLogic !== 'all')\n        conditionLogic.wireless = wirelessLogic;\n    if (motorsLogic && motorsLogic !== 'all')\n        conditionLogic.motors = motorsLogic;\n    if (controllersLogic && controllersLogic !== 'all')\n        conditionLogic.controllers = controllersLogic;\n    if (distanceLogic && distanceLogic !== 'all')\n        conditionLogic.distance = distanceLogic;\n    if (!always &&\n        !scenarios.length\n        && !shootingDays\n        && !mattebox.length\n        && !cameraHandle.length\n        && !viewfinderExtension.length\n        && !deliveryResolution.length\n        && !videoDistribution.length\n        && !camera.length\n        && !ownGear.length\n        && !cameraWeight\n        && !monitor.length\n        && !tripodHeadBrand.length\n        && !tripodBowl.length\n        && !tripodTypes.length\n        && !tripodSpreader.length\n        && !crewPresent.length\n        && !crewAbsent.length\n        && !wireless.length\n        && !motors.length\n        && !controllers.length\n        && !distance.length)\n        return null;\n    var add = Array.isArray(rule.add) ? rule.add.map(normalizeAutoGearItem).filter(Boolean) : [];\n    var remove = Array.isArray(rule.remove) ? rule.remove.map(normalizeAutoGearItem).filter(Boolean) : [];\n    if (!add.length && !remove.length)\n        return null;\n    return {\n        id: id,\n        label: label,\n        always: always,\n        scenarioLogic: scenarioLogic,\n        scenarioPrimary: scenarioPrimary,\n        scenarioMultiplier: scenarioMultiplier,\n        scenarios: scenarios,\n        mattebox: mattebox,\n        cameraHandle: cameraHandle,\n        viewfinderExtension: viewfinderExtension,\n        deliveryResolution: deliveryResolution,\n        videoDistribution: videoDistribution,\n        camera: camera,\n        ownGear: ownGear,\n        cameraWeight: cameraWeight,\n        monitor: monitor,\n        tripodHeadBrand: tripodHeadBrand,\n        tripodBowl: tripodBowl,\n        tripodTypes: tripodTypes,\n        tripodSpreader: tripodSpreader,\n        crewPresent: crewPresent,\n        crewAbsent: crewAbsent,\n        wireless: wireless,\n        motors: motors,\n        controllers: controllers,\n        distance: distance,\n        shootingDays: shootingDays,\n        matteboxLogic: matteboxLogic,\n        cameraHandleLogic: cameraHandleLogic,\n        viewfinderExtensionLogic: viewfinderExtensionLogic,\n        deliveryResolutionLogic: deliveryResolutionLogic,\n        videoDistributionLogic: videoDistributionLogic,\n        cameraLogic: cameraLogic,\n        ownGearLogic: ownGearLogic,\n        monitorLogic: monitorLogic,\n        tripodHeadBrandLogic: tripodHeadBrandLogic,\n        tripodBowlLogic: tripodBowlLogic,\n        tripodTypesLogic: tripodTypesLogic,\n        tripodSpreaderLogic: tripodSpreaderLogic,\n        crewPresentLogic: crewPresentLogic,\n        crewAbsentLogic: crewAbsentLogic,\n        wirelessLogic: wirelessLogic,\n        motorsLogic: motorsLogic,\n        controllersLogic: controllersLogic,\n        distanceLogic: distanceLogic,\n        conditionLogic: conditionLogic,\n        add: add,\n        remove: remove,\n        enabled: enabled,\n    };\n}\nfunction autoGearItemSnapshot(item) {\n    var normalized = normalizeAutoGearItem(item);\n    if (!normalized) {\n        return {\n            name: '',\n            category: '',\n            quantity: 0,\n            screenSize: '',\n            selectorType: 'none',\n            selectorDefault: '',\n            selectorEnabled: false,\n            notes: '',\n            ownGearId: '',\n            ownGearLabel: '',\n        };\n    }\n    var name = normalized.name, category = normalized.category, quantity = normalized.quantity, screenSize = normalized.screenSize, selectorType = normalized.selectorType, selectorDefault = normalized.selectorDefault, selectorEnabled = normalized.selectorEnabled, notes = normalized.notes, ownGearId = normalized.ownGearId, ownGearLabel = normalized.ownGearLabel;\n    return {\n        name: name,\n        category: category,\n        quantity: normalizeAutoGearQuantity(quantity),\n        screenSize: screenSize,\n        selectorType: selectorType,\n        selectorDefault: selectorDefault,\n        selectorEnabled: selectorEnabled,\n        notes: notes,\n        ownGearId: ownGearId,\n        ownGearLabel: ownGearLabel,\n    };\n}\nfunction autoGearItemSortKey(item) {\n    var snapshot = autoGearItemSnapshot(item);\n    var name = snapshot.name || '';\n    var category = snapshot.category || '';\n    var quantity = normalizeAutoGearQuantity(snapshot.quantity);\n    var screenSize = snapshot.screenSize || '';\n    var selectorType = snapshot.selectorType || 'none';\n    var selectorDefault = snapshot.selectorDefault || '';\n    var selectorEnabled = snapshot.selectorEnabled ? '1' : '0';\n    var notes = snapshot.notes || '';\n    var ownGearId = snapshot.ownGearId || '';\n    var ownGearLabel = snapshot.ownGearLabel || '';\n    return \"\".concat(name, \"|\").concat(category, \"|\").concat(quantity, \"|\").concat(screenSize, \"|\").concat(selectorType, \"|\").concat(selectorEnabled, \"|\").concat(selectorDefault, \"|\").concat(notes, \"|\").concat(ownGearId, \"|\").concat(ownGearLabel);\n}\nfunction snapshotAutoGearRuleForFingerprint(rule) {\n    var normalized = normalizeAutoGearRule(rule);\n    if (!normalized)\n        return null;\n    var mapItems = function (items) { return items\n        .map(autoGearItemSnapshot)\n        .sort(function (a, b) { return autoGearItemSortKey(a).localeCompare(autoGearItemSortKey(b)); }); };\n    return {\n        label: normalized.label || '',\n        always: normalized.always ? 1 : 0,\n        scenarios: normalized.scenarios.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        mattebox: normalized.mattebox.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        cameraHandle: normalized.cameraHandle.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        viewfinderExtension: normalized.viewfinderExtension.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        deliveryResolution: normalized.deliveryResolution.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        videoDistribution: normalized.videoDistribution.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        camera: normalized.camera.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        cameraWeight: normalized.cameraWeight\n            ? { operator: normalized.cameraWeight.operator, value: normalized.cameraWeight.value }\n            : null,\n        monitor: normalized.monitor.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        tripodHeadBrand: normalized.tripodHeadBrand.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        tripodBowl: normalized.tripodBowl.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        tripodTypes: normalized.tripodTypes.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        tripodSpreader: normalized.tripodSpreader.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        crewPresent: normalized.crewPresent.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        crewAbsent: normalized.crewAbsent.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        wireless: normalized.wireless.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        motors: normalized.motors.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        controllers: normalized.controllers.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        distance: normalized.distance.slice().sort(function (a, b) { return a.localeCompare(b); }),\n        shootingDays: normalizeAutoGearShootingDaysCondition(normalized.shootingDays),\n        matteboxLogic: normalizeAutoGearConditionLogic(normalized.matteboxLogic),\n        cameraHandleLogic: normalizeAutoGearConditionLogic(normalized.cameraHandleLogic),\n        viewfinderExtensionLogic: normalizeAutoGearConditionLogic(normalized.viewfinderExtensionLogic),\n        deliveryResolutionLogic: normalizeAutoGearConditionLogic(normalized.deliveryResolutionLogic),\n        videoDistributionLogic: normalizeAutoGearConditionLogic(normalized.videoDistributionLogic),\n        cameraLogic: normalizeAutoGearConditionLogic(normalized.cameraLogic),\n        monitorLogic: normalizeAutoGearConditionLogic(normalized.monitorLogic),\n        tripodHeadBrandLogic: normalizeAutoGearConditionLogic(normalized.tripodHeadBrandLogic),\n        tripodBowlLogic: normalizeAutoGearConditionLogic(normalized.tripodBowlLogic),\n        tripodTypesLogic: normalizeAutoGearConditionLogic(normalized.tripodTypesLogic),\n        tripodSpreaderLogic: normalizeAutoGearConditionLogic(normalized.tripodSpreaderLogic),\n        crewPresentLogic: normalizeAutoGearConditionLogic(normalized.crewPresentLogic),\n        crewAbsentLogic: normalizeAutoGearConditionLogic(normalized.crewAbsentLogic),\n        wirelessLogic: normalizeAutoGearConditionLogic(normalized.wirelessLogic),\n        motorsLogic: normalizeAutoGearConditionLogic(normalized.motorsLogic),\n        controllersLogic: normalizeAutoGearConditionLogic(normalized.controllersLogic),\n        distanceLogic: normalizeAutoGearConditionLogic(normalized.distanceLogic),\n        conditionLogic: normalized.conditionLogic\n            ? Object.keys(normalized.conditionLogic).reduce(function (acc, key) {\n                acc[key] = normalizeAutoGearConditionLogic(normalized.conditionLogic[key]);\n                return acc;\n            }, {})\n            : {},\n        add: mapItems(normalized.add),\n        remove: mapItems(normalized.remove),\n        enabled: normalized.enabled ? 1 : 0,\n    };\n}\nfunction autoGearRuleSortKey(rule) {\n    var alwaysKey = rule && rule.always ? '1' : '0';\n    var scenarioKey = Array.isArray(rule.scenarios) ? rule.scenarios.join('|') : '';\n    var matteboxKey = Array.isArray(rule.mattebox) ? rule.mattebox.join('|') : '';\n    var cameraHandleKey = Array.isArray(rule.cameraHandle) ? rule.cameraHandle.join('|') : '';\n    var viewfinderKey = Array.isArray(rule.viewfinderExtension) ? rule.viewfinderExtension.join('|') : '';\n    var deliveryResolutionKey = Array.isArray(rule.deliveryResolution) ? rule.deliveryResolution.join('|') : '';\n    var videoDistributionKey = Array.isArray(rule.videoDistribution) ? rule.videoDistribution.join('|') : '';\n    var cameraKey = Array.isArray(rule.camera) ? rule.camera.join('|') : '';\n    var cameraWeightCondition = normalizeAutoGearCameraWeightCondition(rule === null || rule === void 0 ? void 0 : rule.cameraWeight);\n    var cameraWeightKey = cameraWeightCondition\n        ? \"\".concat(cameraWeightCondition.operator, \":\").concat(cameraWeightCondition.value)\n        : '';\n    var monitorKey = Array.isArray(rule.monitor) ? rule.monitor.join('|') : '';\n    var tripodHeadBrandKey = Array.isArray(rule.tripodHeadBrand) ? rule.tripodHeadBrand.join('|') : '';\n    var tripodBowlKey = Array.isArray(rule.tripodBowl) ? rule.tripodBowl.join('|') : '';\n    var tripodTypesKey = Array.isArray(rule.tripodTypes) ? rule.tripodTypes.join('|') : '';\n    var tripodSpreaderKey = Array.isArray(rule.tripodSpreader) ? rule.tripodSpreader.join('|') : '';\n    var crewPresentKey = Array.isArray(rule.crewPresent) ? rule.crewPresent.join('|') : '';\n    var crewAbsentKey = Array.isArray(rule.crewAbsent) ? rule.crewAbsent.join('|') : '';\n    var wirelessKey = Array.isArray(rule.wireless) ? rule.wireless.join('|') : '';\n    var motorsKey = Array.isArray(rule.motors) ? rule.motors.join('|') : '';\n    var controllersKey = Array.isArray(rule.controllers) ? rule.controllers.join('|') : '';\n    var distanceKey = Array.isArray(rule.distance) ? rule.distance.join('|') : '';\n    var shootingDaysCondition = normalizeAutoGearShootingDaysCondition(rule === null || rule === void 0 ? void 0 : rule.shootingDays);\n    var shootingDaysKey = shootingDaysCondition\n        ? \"\".concat(shootingDaysCondition.mode, \":\").concat(shootingDaysCondition.value)\n        : '';\n    var matteboxLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.matteboxLogic);\n    var cameraHandleLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.cameraHandleLogic);\n    var viewfinderLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.viewfinderExtensionLogic);\n    var deliveryResolutionLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.deliveryResolutionLogic);\n    var videoDistributionLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.videoDistributionLogic);\n    var cameraLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.cameraLogic);\n    var monitorLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.monitorLogic);\n    var tripodHeadBrandLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.tripodHeadBrandLogic);\n    var tripodBowlLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.tripodBowlLogic);\n    var tripodTypesLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.tripodTypesLogic);\n    var tripodSpreaderLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.tripodSpreaderLogic);\n    var crewPresentLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.crewPresentLogic);\n    var crewAbsentLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.crewAbsentLogic);\n    var wirelessLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.wirelessLogic);\n    var motorsLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.motorsLogic);\n    var controllersLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.controllersLogic);\n    var distanceLogicKey = normalizeAutoGearConditionLogic(rule === null || rule === void 0 ? void 0 : rule.distanceLogic);\n    var addKey = Array.isArray(rule.add) ? rule.add.map(autoGearItemSortKey).join('|') : '';\n    var removeKey = Array.isArray(rule.remove) ? rule.remove.map(autoGearItemSortKey).join('|') : '';\n    return \"\".concat(alwaysKey, \"|\").concat(scenarioKey, \"|\").concat(matteboxKey, \"|\").concat(cameraHandleKey, \"|\").concat(viewfinderKey, \"|\").concat(deliveryResolutionKey, \"|\").concat(videoDistributionKey, \"|\").concat(cameraKey, \"|\").concat(cameraWeightKey, \"|\").concat(monitorKey, \"|\").concat(tripodHeadBrandKey, \"|\").concat(tripodBowlKey, \"|\").concat(tripodTypesKey, \"|\").concat(tripodSpreaderKey, \"|\").concat(crewPresentKey, \"|\").concat(crewAbsentKey, \"|\").concat(wirelessKey, \"|\").concat(motorsKey, \"|\").concat(controllersKey, \"|\").concat(distanceKey, \"|\").concat(shootingDaysKey, \"|\").concat(matteboxLogicKey, \"|\").concat(cameraHandleLogicKey, \"|\").concat(viewfinderLogicKey, \"|\").concat(deliveryResolutionLogicKey, \"|\").concat(videoDistributionLogicKey, \"|\").concat(cameraLogicKey, \"|\").concat(monitorLogicKey, \"|\").concat(tripodHeadBrandLogicKey, \"|\").concat(tripodBowlLogicKey, \"|\").concat(tripodTypesLogicKey, \"|\").concat(tripodSpreaderLogicKey, \"|\").concat(crewPresentLogicKey, \"|\").concat(crewAbsentLogicKey, \"|\").concat(wirelessLogicKey, \"|\").concat(motorsLogicKey, \"|\").concat(controllersLogicKey, \"|\").concat(distanceLogicKey, \"|\").concat(rule.label || '', \"|\").concat(addKey, \"|\").concat(removeKey);\n}\nfunction createAutoGearRulesFingerprint(rules) {\n    var snapshot = (Array.isArray(rules) ? rules : [])\n        .map(snapshotAutoGearRuleForFingerprint)\n        .filter(Boolean)\n        .sort(function (a, b) { return autoGearRuleSortKey(a).localeCompare(autoGearRuleSortKey(b)); });\n    return stableStringify(snapshot);\n}\nfunction normalizeAutoGearPreset(entry) {\n    if (!entry || typeof entry !== 'object')\n        return null;\n    var label = typeof entry.label === 'string' ? entry.label.trim() : '';\n    if (!label)\n        return null;\n    var rawRules = Array.isArray(entry.rules) ? entry.rules : [];\n    var rules = rawRules.map(normalizeAutoGearRule).filter(Boolean);\n    var id = typeof entry.id === 'string' && entry.id ? entry.id : generateAutoGearId('preset');\n    var fingerprint = createAutoGearRulesFingerprint(rules);\n    return { id: id, label: label, rules: rules, fingerprint: fingerprint };\n}\nfunction normalizeAutoGearBackupEntry(entry) {\n    if (!entry || typeof entry !== 'object')\n        return null;\n    var rawCreatedAt = typeof entry.createdAt === 'string' ? entry.createdAt : null;\n    var timestamp = rawCreatedAt ? Date.parse(rawCreatedAt) : NaN;\n    if (!Number.isFinite(timestamp))\n        return null;\n    var createdAt = new Date(timestamp).toISOString();\n    var rawRules = Array.isArray(entry.rules) ? entry.rules : [];\n    var normalizedRules = rawRules.map(normalizeAutoGearRule).filter(Boolean);\n    var rules = rawRules.length === 0 ? [] : normalizedRules;\n    var id = typeof entry.id === 'string' && entry.id ? entry.id : generateAutoGearId('backup');\n    var monitorDefaults = normalizeAutoGearMonitorDefaults(entry.monitorDefaults);\n    var note = typeof entry.note === 'string' ? entry.note : '';\n    return { id: id, createdAt: createdAt, rules: rules, monitorDefaults: monitorDefaults, note: note };\n}\nvar AUTO_GEAR_NORMALIZER_EXPORTS = {\n    generateAutoGearId: generateAutoGearId,\n    normalizeAutoGearQuantity: normalizeAutoGearQuantity,\n    parseAutoGearDraftNames: parseAutoGearDraftNames,\n    normalizeAutoGearText: normalizeAutoGearText,\n    normalizeAutoGearSelectorType: normalizeAutoGearSelectorType,\n    normalizeAutoGearSelectorDefault: normalizeAutoGearSelectorDefault,\n    resolveDevicesSnapshot: resolveDevicesSnapshot,\n    updateGlobalDevicesReference: updateGlobalDevicesReference,\n    resolveTripodPreferenceSelect: resolveTripodPreferenceSelect,\n    collectTripodPreferenceOptions: collectTripodPreferenceOptions,\n    getAutoGearSelectorOptions: getAutoGearSelectorOptions,\n    getAutoGearSelectorLabel: getAutoGearSelectorLabel,\n    getAutoGearSelectorScrollHint: getAutoGearSelectorScrollHint,\n    getAutoGearSelectorDefaultPlaceholder: getAutoGearSelectorDefaultPlaceholder,\n    getAutoGearMonitorDefaultPlaceholder: getAutoGearMonitorDefaultPlaceholder,\n    formatAutoGearSelectorValue: formatAutoGearSelectorValue,\n    populateAutoGearCategorySelect: populateAutoGearCategorySelect,\n    formatAutoGearOwnGearLabel: formatAutoGearOwnGearLabel,\n    refreshAutoGearOwnGearConditionOptions: refreshAutoGearOwnGearConditionOptions,\n    updateAutoGearOwnGearOptions: updateAutoGearOwnGearOptions,\n    isAutoGearMonitoringCategory: isAutoGearMonitoringCategory,\n    isMonitoringCategorySelected: isMonitoringCategorySelected,\n    matchesTripodCategory: matchesTripodCategory,\n    isTripodCategorySelected: isTripodCategorySelected,\n    setAutoGearFieldVisibility: setAutoGearFieldVisibility,\n    updateAutoGearMonitorFieldGroup: updateAutoGearMonitorFieldGroup,\n    extractAutoGearContextNotes: extractAutoGearContextNotes,\n    normalizeAutoGearItem: normalizeAutoGearItem,\n    normalizeAutoGearTriggerList: normalizeAutoGearTriggerList,\n    normalizeAutoGearScenarioLogic: normalizeAutoGearScenarioLogic,\n    normalizeAutoGearConditionLogic: normalizeAutoGearConditionLogic,\n    readAutoGearConditionLogic: readAutoGearConditionLogic,\n    normalizeAutoGearScenarioMultiplier: normalizeAutoGearScenarioMultiplier,\n    normalizeAutoGearScenarioPrimary: normalizeAutoGearScenarioPrimary,\n    normalizeVideoDistributionTriggerList: normalizeVideoDistributionTriggerList,\n    normalizeAutoGearTriggerValue: normalizeAutoGearTriggerValue,\n    normalizeAutoGearShootingDayMode: normalizeAutoGearShootingDayMode,\n    normalizeAutoGearShootingDayValue: normalizeAutoGearShootingDayValue,\n    normalizeAutoGearShootingDaysList: normalizeAutoGearShootingDaysList,\n    normalizeAutoGearShootingDaysCondition: normalizeAutoGearShootingDaysCondition,\n    normalizeAutoGearRule: normalizeAutoGearRule,\n    autoGearItemSnapshot: autoGearItemSnapshot,\n    autoGearItemSortKey: autoGearItemSortKey,\n    autoGearRuleMatteboxKey: autoGearRuleMatteboxKey,\n    snapshotAutoGearRuleForFingerprint: snapshotAutoGearRuleForFingerprint,\n    autoGearRuleSortKey: autoGearRuleSortKey,\n    createAutoGearRulesFingerprint: createAutoGearRulesFingerprint,\n    normalizeAutoGearPreset: normalizeAutoGearPreset,\n    normalizeAutoGearBackupEntry: normalizeAutoGearBackupEntry,\n    normalizeAutoGearMonitorDefaults: normalizeAutoGearMonitorDefaults,\n    AUTO_GEAR_MONITOR_DEFAULT_TYPES: AUTO_GEAR_MONITOR_DEFAULT_TYPES,\n};\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = AUTO_GEAR_NORMALIZER_EXPORTS;\n}\nif (typeof globalThis !== 'undefined') {\n    var target = (typeof globalThis.AUTO_GEAR_NORMALIZER_EXPORTS === 'object'\n        && globalThis.AUTO_GEAR_NORMALIZER_EXPORTS)\n        ? globalThis.AUTO_GEAR_NORMALIZER_EXPORTS\n        : (globalThis.AUTO_GEAR_NORMALIZER_EXPORTS = {});\n    Object.assign(target, AUTO_GEAR_NORMALIZER_EXPORTS);\n    Object.assign(globalThis, AUTO_GEAR_NORMALIZER_EXPORTS);\n    globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES = AUTO_GEAR_MONITOR_DEFAULT_TYPES;\n    globalThis.normalizeAutoGearMonitorDefaults = normalizeAutoGearMonitorDefaults;\n}\n","/*\n * Auto Gear persistence helpers extracted from the runtime so they can be\n * exercised directly in unit tests without loading the UI.\n */\n// @ts-nocheck\n/* global loadAutoGearBackups,\n  normalizeAutoGearBackupEntry, loadAutoGearPresets, normalizeAutoGearPreset,\n  saveAutoGearPresets, loadAutoGearMonitorDefaults,\n  saveAutoGearMonitorDefaults,\n  normalizeAutoGearMonitorDefaults,\n  loadAutoGearActivePresetId, saveAutoGearActivePresetId,\n  loadAutoGearAutoPresetId, saveAutoGearAutoPresetId,\n  loadAutoGearBackupVisibility, saveAutoGearBackupVisibility,\n  loadAutoGearBackupRetention, saveAutoGearBackupRetention,\n  saveAutoGearBackups, autoGearBackupRetention, callCoreFunctionIfAvailable,\n  autoGearBackupRetentionInput, autoGearBackups, normalizeAutoGearRule,\n  loadAutoGearRules */\nvar AUTO_GEAR_BACKUP_RETENTION_FALLBACK_DEFAULT = 36;\nvar AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MIN = 1;\nvar AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MAX = 120;\nvar AUTO_GEAR_PERSISTENCE_MODULE_NAME = 'cineAutoGearPersistence';\nvar AUTO_GEAR_BACKUP_GLOBAL_SCOPE = (typeof globalThis !== 'undefined' && globalThis)\n    || (typeof window !== 'undefined' && window)\n    || (typeof self !== 'undefined' && self)\n    || (typeof global !== 'undefined' && global)\n    || null;\nfunction readScopedNumericAutoGearValue(name) {\n    if (!AUTO_GEAR_BACKUP_GLOBAL_SCOPE) {\n        return null;\n    }\n    var value = AUTO_GEAR_BACKUP_GLOBAL_SCOPE[name];\n    return typeof value === 'number' && Number.isFinite(value) ? value : null;\n}\nfunction resolveAutoGearPersistenceService() {\n    var scopes = [];\n    if (typeof globalThis !== 'undefined')\n        scopes.push(globalThis);\n    if (typeof window !== 'undefined')\n        scopes.push(window);\n    if (typeof self !== 'undefined')\n        scopes.push(self);\n    if (typeof global !== 'undefined')\n        scopes.push(global);\n    for (var index = 0; index < scopes.length; index += 1) {\n        var scope = scopes[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            continue;\n        if (scope.cineAutoGearPersistence)\n            return scope.cineAutoGearPersistence;\n        var registry = scope.cineModules;\n        if (registry && typeof registry.get === 'function') {\n            var module_1 = registry.get(AUTO_GEAR_PERSISTENCE_MODULE_NAME);\n            if (module_1)\n                return module_1;\n        }\n    }\n    return null;\n}\nfunction scheduleAutoGearPersistence(name, payload) {\n    var service = resolveAutoGearPersistenceService();\n    if (!service || typeof service[name] !== 'function') {\n        return null;\n    }\n    var pending = service[name](payload);\n    if (pending && typeof pending.catch === 'function') {\n        pending.catch(function (error) {\n            console.warn(\"Auto-Gear persistence failed for \".concat(name), error);\n        });\n    }\n    return pending;\n}\nfunction normalizeRetentionCandidate(value, minValue, maxValue) {\n    if (typeof value !== 'number' || !Number.isFinite(value)) {\n        return null;\n    }\n    var rounded = Math.round(value);\n    if (!Number.isFinite(rounded)) {\n        return null;\n    }\n    if (rounded < minValue) {\n        return minValue;\n    }\n    if (rounded > maxValue) {\n        return maxValue;\n    }\n    return rounded;\n}\nfunction resolveAutoGearBackupRetentionMinValue() {\n    var scopedMinValue = readScopedNumericAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE');\n    if (scopedMinValue !== null) {\n        return Math.max(AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MIN, Math.round(scopedMinValue));\n    }\n    var scopedMin = readScopedNumericAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_MIN');\n    if (scopedMin !== null) {\n        return Math.max(AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MIN, Math.round(scopedMin));\n    }\n    return AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MIN;\n}\nfunction resolveAutoGearBackupRetentionMaxValue() {\n    var scopedMax = readScopedNumericAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_MAX');\n    if (scopedMax !== null) {\n        return Math.max(resolveAutoGearBackupRetentionMinValue(), Math.round(scopedMax));\n    }\n    return Math.max(resolveAutoGearBackupRetentionMinValue(), AUTO_GEAR_BACKUP_RETENTION_FALLBACK_MAX);\n}\nfunction resolveAutoGearBackupRetentionDefaultValue() {\n    var minValue = resolveAutoGearBackupRetentionMinValue();\n    var maxValue = resolveAutoGearBackupRetentionMaxValue();\n    var candidates = [\n        readScopedNumericAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_DEFAULT'),\n        readScopedNumericAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_DEFAULT_VALUE'),\n        AUTO_GEAR_BACKUP_RETENTION_FALLBACK_DEFAULT,\n    ];\n    for (var index = 0; index < candidates.length; index += 1) {\n        var candidate = candidates[index];\n        var normalized = normalizeRetentionCandidate(candidate, minValue, maxValue);\n        if (typeof normalized === 'number') {\n            return normalized;\n        }\n    }\n    return minValue;\n}\nfunction readAutoGearBackupsFromStorage(retentionLimit) {\n    if (retentionLimit === void 0) { retentionLimit = resolveAutoGearBackupRetentionDefaultValue(); }\n    var stored = [];\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readAutoGearBackups === 'function') {\n        stored = service.readAutoGearBackups();\n    }\n    else if (typeof loadAutoGearBackups === 'function') {\n        try {\n            stored = loadAutoGearBackups();\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear backups', error);\n            stored = [];\n        }\n    }\n    if (!Array.isArray(stored))\n        return [];\n    var limit = clampAutoGearBackupRetentionLimit(retentionLimit);\n    return stored\n        .map(normalizeAutoGearBackupEntry)\n        .filter(Boolean)\n        .sort(function (a, b) {\n        if (a.createdAt === b.createdAt)\n            return 0;\n        return a.createdAt > b.createdAt ? -1 : 1;\n    })\n        .slice(0, limit);\n}\nfunction sortAutoGearPresets(list) {\n    return list.sort(function (a, b) { return a.label.localeCompare(b.label, undefined, { sensitivity: 'base', numeric: true }); });\n}\nfunction readAutoGearPresetsFromStorage() {\n    var stored = [];\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readAutoGearPresets === 'function') {\n        stored = service.readAutoGearPresets();\n    }\n    else if (typeof loadAutoGearPresets === 'function') {\n        try {\n            stored = loadAutoGearPresets();\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear presets', error);\n            stored = [];\n        }\n    }\n    if (!Array.isArray(stored))\n        return [];\n    return sortAutoGearPresets(stored.map(normalizeAutoGearPreset).filter(Boolean));\n}\nfunction persistAutoGearPresets(presets) {\n    var payload = Array.isArray(presets)\n        ? presets.map(function (preset) { return ({\n            id: preset.id,\n            label: preset.label,\n            rules: Array.isArray(preset.rules) ? preset.rules : [],\n        }); })\n        : [];\n    if (scheduleAutoGearPersistence('persistAutoGearPresets', payload)) {\n        return;\n    }\n    if (typeof saveAutoGearPresets === 'function') {\n        try {\n            saveAutoGearPresets(payload);\n            return;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear presets', error);\n        }\n    }\n}\nfunction readAutoGearMonitorDefaultsFromStorage() {\n    var stored = {};\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readAutoGearMonitorDefaults === 'function') {\n        stored = service.readAutoGearMonitorDefaults();\n    }\n    else if (typeof loadAutoGearMonitorDefaults === 'function') {\n        try {\n            stored = loadAutoGearMonitorDefaults();\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear monitor defaults', error);\n            stored = {};\n        }\n    }\n    return normalizeAutoGearMonitorDefaults(stored);\n}\nfunction persistAutoGearMonitorDefaults(defaults) {\n    var payload = normalizeAutoGearMonitorDefaults(defaults);\n    if (scheduleAutoGearPersistence('persistAutoGearMonitorDefaults', payload)) {\n        return payload;\n    }\n    if (typeof saveAutoGearMonitorDefaults === 'function') {\n        try {\n            saveAutoGearMonitorDefaults(payload);\n            return payload;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear monitor defaults', error);\n        }\n    }\n    return payload;\n}\nfunction readActiveAutoGearPresetIdFromStorage() {\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readActivePresetId === 'function') {\n        return service.readActivePresetId();\n    }\n    if (typeof loadAutoGearActivePresetId === 'function') {\n        try {\n            var loaderPresetId = loadAutoGearActivePresetId();\n            return typeof loaderPresetId === 'string' ? loaderPresetId : '';\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear active preset id', error);\n            return '';\n        }\n    }\n    return '';\n}\nfunction persistActiveAutoGearPresetId(presetId) {\n    if (scheduleAutoGearPersistence('persistActivePresetId', presetId)) {\n        return;\n    }\n    if (typeof saveAutoGearActivePresetId === 'function') {\n        try {\n            saveAutoGearActivePresetId(typeof presetId === 'string' ? presetId : '');\n            return;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear active preset id', error);\n        }\n    }\n}\nfunction readAutoGearAutoPresetIdFromStorage() {\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readAutoPresetId === 'function') {\n        return service.readAutoPresetId();\n    }\n    if (typeof loadAutoGearAutoPresetId === 'function') {\n        try {\n            var loaderAutoPresetId = loadAutoGearAutoPresetId();\n            return typeof loaderAutoPresetId === 'string' ? loaderAutoPresetId : '';\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear auto preset id', error);\n            return '';\n        }\n    }\n    return '';\n}\nfunction persistAutoGearAutoPresetId(presetId) {\n    if (scheduleAutoGearPersistence('persistAutoPresetId', presetId)) {\n        return;\n    }\n    if (typeof saveAutoGearAutoPresetId === 'function') {\n        try {\n            saveAutoGearAutoPresetId(typeof presetId === 'string' ? presetId : '');\n            return;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear auto preset id', error);\n        }\n    }\n}\nfunction readAutoGearBackupVisibilityFromStorage() {\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readBackupVisibility === 'function') {\n        return service.readBackupVisibility();\n    }\n    if (typeof loadAutoGearBackupVisibility === 'function') {\n        try {\n            return !!loadAutoGearBackupVisibility();\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear backup visibility', error);\n            return false;\n        }\n    }\n    return false;\n}\nfunction persistAutoGearBackupVisibility(flag) {\n    var enabled = !!flag;\n    if (scheduleAutoGearPersistence('persistBackupVisibility', enabled)) {\n        return;\n    }\n    if (typeof saveAutoGearBackupVisibility === 'function') {\n        try {\n            saveAutoGearBackupVisibility(enabled);\n            return;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear backup visibility', error);\n        }\n    }\n}\nfunction clampAutoGearBackupRetentionLimit(value) {\n    var numeric = Number(value);\n    if (!Number.isFinite(numeric)) {\n        return resolveAutoGearBackupRetentionDefaultValue();\n    }\n    var rounded = Math.round(numeric);\n    if (!Number.isFinite(rounded)) {\n        return resolveAutoGearBackupRetentionDefaultValue();\n    }\n    var minValue = resolveAutoGearBackupRetentionMinValue();\n    var maxValue = resolveAutoGearBackupRetentionMaxValue();\n    if (rounded < minValue) {\n        return minValue;\n    }\n    if (rounded > maxValue) {\n        return maxValue;\n    }\n    return rounded;\n}\nfunction readAutoGearBackupRetentionFromStorage() {\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readBackupRetention === 'function') {\n        var cached = service.readBackupRetention();\n        if (cached !== null && typeof cached !== 'undefined') {\n            return clampAutoGearBackupRetentionLimit(cached);\n        }\n    }\n    if (typeof loadAutoGearBackupRetention === 'function') {\n        try {\n            return clampAutoGearBackupRetentionLimit(loadAutoGearBackupRetention());\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear backup retention', error);\n        }\n    }\n    return resolveAutoGearBackupRetentionDefaultValue();\n}\nfunction persistAutoGearBackupRetention(retention) {\n    var normalized = clampAutoGearBackupRetentionLimit(retention);\n    if (scheduleAutoGearPersistence('persistBackupRetention', normalized)) {\n        return true;\n    }\n    if (typeof saveAutoGearBackupRetention === 'function') {\n        try {\n            saveAutoGearBackupRetention(normalized);\n            return true;\n        }\n        catch (error) {\n            console.warn('Failed to save automatic gear backup retention', error);\n        }\n    }\n    return false;\n}\nfunction persistAutoGearBackups(backups) {\n    var payload = Array.isArray(backups)\n        ? backups.map(function (entry) { return ({\n            id: entry.id,\n            createdAt: entry.createdAt,\n            rules: Array.isArray(entry.rules) ? entry.rules : [],\n            monitorDefaults: normalizeAutoGearMonitorDefaults(entry.monitorDefaults),\n            note: typeof entry.note === 'string' ? entry.note : undefined,\n        }); })\n        : [];\n    if (scheduleAutoGearPersistence('persistAutoGearBackups', payload)) {\n        return payload;\n    }\n    if (typeof saveAutoGearBackups === 'function') {\n        var storedPayload = saveAutoGearBackups(payload);\n        return Array.isArray(storedPayload) ? storedPayload : payload;\n    }\n    throw new Error('Storage unavailable');\n}\nfunction assignAutoGearGlobalValue(name, nextValue) {\n    var scopes = [];\n    if (typeof globalThis !== 'undefined')\n        scopes.push(globalThis);\n    if (typeof window !== 'undefined')\n        scopes.push(window);\n    if (typeof self !== 'undefined')\n        scopes.push(self);\n    if (typeof global !== 'undefined')\n        scopes.push(global);\n    for (var index = 0; index < scopes.length; index += 1) {\n        var scope = scopes[index];\n        if (!scope)\n            continue;\n        if (Object.prototype.hasOwnProperty.call(scope, name)) {\n            scope[name] = nextValue;\n            return true;\n        }\n    }\n    return false;\n}\nfunction enforceAutoGearBackupRetentionLimit(limit) {\n    var normalized = clampAutoGearBackupRetentionLimit(limit);\n    var previousLimit = autoGearBackupRetention;\n    if (normalized === previousLimit) {\n        callCoreFunctionIfAvailable('renderAutoGearBackupRetentionControls', [], { defer: true });\n        return { success: true, trimmed: [], previousLimit: previousLimit };\n    }\n    var previousBackups = autoGearBackups.slice();\n    var trimmedEntries = [];\n    var retentionPersisted = persistAutoGearBackupRetention(normalized);\n    if (!retentionPersisted) {\n        autoGearBackupRetentionInput && (autoGearBackupRetentionInput.value = String(autoGearBackupRetention));\n        callCoreFunctionIfAvailable('renderAutoGearBackupRetentionControls', [], { defer: true });\n        return { success: false, error: new Error('retention-persist-failed'), previousLimit: previousLimit };\n    }\n    assignAutoGearGlobalValue('autoGearBackupRetention', normalized);\n    if (autoGearBackups.length > normalized) {\n        var updatedBackups = autoGearBackups.slice(0, normalized);\n        trimmedEntries.push.apply(trimmedEntries, autoGearBackups.slice(normalized));\n        try {\n            var persistedBackups = persistAutoGearBackups(updatedBackups) || [];\n            var finalBackups = Array.isArray(persistedBackups) ? persistedBackups : [];\n            if (finalBackups.length < updatedBackups.length) {\n                trimmedEntries.push.apply(trimmedEntries, updatedBackups.slice(finalBackups.length));\n            }\n            assignAutoGearGlobalValue('autoGearBackups', finalBackups);\n        }\n        catch (error) {\n            console.warn('Failed to trim automatic gear backups to retention limit', error);\n            assignAutoGearGlobalValue('autoGearBackupRetention', previousLimit);\n            persistAutoGearBackupRetention(previousLimit);\n            try {\n                persistAutoGearBackups(previousBackups);\n            }\n            catch (restoreError) {\n                console.warn('Failed to restore automatic gear backups after trim error', restoreError);\n            }\n            assignAutoGearGlobalValue('autoGearBackups', readAutoGearBackupsFromStorage(previousLimit));\n            callCoreFunctionIfAvailable('renderAutoGearBackupControls', [], { defer: true });\n            callCoreFunctionIfAvailable('renderAutoGearBackupRetentionControls', [], { defer: true });\n            return { success: false, error: error, previousLimit: previousLimit };\n        }\n    }\n    callCoreFunctionIfAvailable('renderAutoGearBackupControls', [], { defer: true });\n    callCoreFunctionIfAvailable('renderAutoGearBackupRetentionControls', [], { defer: true });\n    return { success: true, trimmed: trimmedEntries, previousLimit: previousLimit };\n}\nfunction readAutoGearRulesFromStorage() {\n    var stored = [];\n    var service = resolveAutoGearPersistenceService();\n    if (service && typeof service.readAutoGearRules === 'function') {\n        stored = service.readAutoGearRules();\n    }\n    else if (typeof loadAutoGearRules !== 'undefined' && typeof loadAutoGearRules === 'function') {\n        try {\n            stored = loadAutoGearRules();\n        }\n        catch (error) {\n            console.warn('Failed to load automatic gear rules', error);\n            stored = [];\n        }\n    }\n    if (!Array.isArray(stored))\n        return [];\n    return stored.map(normalizeAutoGearRule).filter(Boolean);\n}\nvar AUTO_GEAR_STORAGE_EXPORTS = {\n    readAutoGearBackupsFromStorage: readAutoGearBackupsFromStorage,\n    readAutoGearPresetsFromStorage: readAutoGearPresetsFromStorage,\n    persistAutoGearPresets: persistAutoGearPresets,\n    normalizeAutoGearMonitorDefaults: normalizeAutoGearMonitorDefaults,\n    readAutoGearMonitorDefaultsFromStorage: readAutoGearMonitorDefaultsFromStorage,\n    persistAutoGearMonitorDefaults: persistAutoGearMonitorDefaults,\n    readActiveAutoGearPresetIdFromStorage: readActiveAutoGearPresetIdFromStorage,\n    persistActiveAutoGearPresetId: persistActiveAutoGearPresetId,\n    readAutoGearAutoPresetIdFromStorage: readAutoGearAutoPresetIdFromStorage,\n    persistAutoGearAutoPresetId: persistAutoGearAutoPresetId,\n    readAutoGearBackupVisibilityFromStorage: readAutoGearBackupVisibilityFromStorage,\n    persistAutoGearBackupVisibility: persistAutoGearBackupVisibility,\n    clampAutoGearBackupRetentionLimit: clampAutoGearBackupRetentionLimit,\n    readAutoGearBackupRetentionFromStorage: readAutoGearBackupRetentionFromStorage,\n    persistAutoGearBackupRetention: persistAutoGearBackupRetention,\n    persistAutoGearBackups: persistAutoGearBackups,\n    enforceAutoGearBackupRetentionLimit: enforceAutoGearBackupRetentionLimit,\n    readAutoGearRulesFromStorage: readAutoGearRulesFromStorage,\n};\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = AUTO_GEAR_STORAGE_EXPORTS;\n}\nif (typeof globalThis !== 'undefined') {\n    var target = (typeof globalThis.AUTO_GEAR_STORAGE_EXPORTS === 'object'\n        && globalThis.AUTO_GEAR_STORAGE_EXPORTS)\n        ? globalThis.AUTO_GEAR_STORAGE_EXPORTS\n        : (globalThis.AUTO_GEAR_STORAGE_EXPORTS = {});\n    Object.assign(target, AUTO_GEAR_STORAGE_EXPORTS);\n}\n(function () {\n    var candidateScopes = [\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n    var assignGlobal = function (scope, name, value) {\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function'))\n            return;\n        if (typeof scope[name] === 'function')\n            return;\n        try {\n            scope[name] = value;\n        }\n        catch (assignError) {\n            void assignError;\n            try {\n                Object.defineProperty(scope, name, {\n                    configurable: true,\n                    enumerable: false,\n                    writable: true,\n                    value: value,\n                });\n            }\n            catch (defineError) {\n                void defineError;\n            }\n        }\n    };\n    var exportKeys = Object.keys(AUTO_GEAR_STORAGE_EXPORTS);\n    for (var scopeIndex = 0; scopeIndex < candidateScopes.length; scopeIndex += 1) {\n        var scope = candidateScopes[scopeIndex];\n        if (!scope)\n            continue;\n        for (var keyIndex = 0; keyIndex < exportKeys.length; keyIndex += 1) {\n            var name_1 = exportKeys[keyIndex];\n            var value = AUTO_GEAR_STORAGE_EXPORTS[name_1];\n            if (typeof value === 'function') {\n                assignGlobal(scope, name_1, value);\n            }\n        }\n    }\n})();\n","/**\n * Cine Power Planner Text Utilities\n * \n * Pure ESM module for text normalization and resolution.\n * Extracted from app-core-text.js during Vite migration.\n */\n\nexport const TEXT_ENTRY_SEPARATOR = '\\n';\n\nexport function normaliseTextEntryValue(entry, separator = TEXT_ENTRY_SEPARATOR) {\n    const safeSeparator = typeof separator === 'string' && separator ? separator : TEXT_ENTRY_SEPARATOR;\n\n    if (typeof entry === 'string') {\n        return entry;\n    }\n\n    if (typeof entry === 'number' || typeof entry === 'boolean') {\n        try {\n            return String(entry);\n        } catch (stringifyPrimitiveError) {\n            void stringifyPrimitiveError;\n        }\n        return '';\n    }\n\n    if (Array.isArray(entry)) {\n        const parts = [];\n        for (let index = 0; index < entry.length; index += 1) {\n            const value = normaliseTextEntryValue(entry[index], safeSeparator);\n            if (value) {\n                parts.push(value);\n            }\n        }\n        return parts.join(safeSeparator);\n    }\n\n    if (entry && typeof entry === 'object') {\n        if (typeof entry.text === 'string') {\n            return entry.text;\n        }\n\n        if (Array.isArray(entry.text)) {\n            return normaliseTextEntryValue(entry.text, safeSeparator);\n        }\n\n        if (typeof entry.label === 'string') {\n            return entry.label;\n        }\n\n        try {\n            const objectString = String(entry);\n            if (objectString && objectString !== '[object Object]') {\n                return objectString;\n            }\n        } catch (stringifyObjectError) {\n            void stringifyObjectError;\n        }\n    }\n\n    return '';\n}\n\nexport function resolveTextEntry(\n    primaryTexts,\n    fallbackTexts,\n    key,\n    defaultValue = '',\n    separator = TEXT_ENTRY_SEPARATOR\n) {\n    const normalizedDefault = typeof defaultValue === 'string' ? defaultValue : '';\n    const dictionaries = [];\n\n    if (primaryTexts && (typeof primaryTexts === 'object' || typeof primaryTexts === 'function')) {\n        dictionaries.push(primaryTexts);\n    }\n\n    if (\n        fallbackTexts &&\n        fallbackTexts !== primaryTexts &&\n        (typeof fallbackTexts === 'object' || typeof fallbackTexts === 'function')\n    ) {\n        dictionaries.push(fallbackTexts);\n    }\n\n    for (let index = 0; index < dictionaries.length; index += 1) {\n        const dictionary = dictionaries[index];\n\n        let entry;\n        try {\n            entry = dictionary[key];\n        } catch (dictionaryLookupError) {\n            void dictionaryLookupError;\n            entry = undefined;\n        }\n\n        if (typeof entry === 'undefined' || entry === null) {\n            continue;\n        }\n\n        const resolved = normaliseTextEntryValue(entry, separator);\n        if (typeof resolved === 'string') {\n            return resolved;\n        }\n    }\n\n    return normalizedDefault;\n}\n","/**\n * Cine Power Planner UI Helpers\n * \n * Pure ESM module for DOM manipulation and escaping.\n * Extracted from app-core-ui-helpers.js during Vite migration.\n */\n\nfunction detectDocument() {\n    if (typeof document !== 'undefined') return document;\n    return null;\n}\n\nexport function escapeHtml(str) {\n    let escapeDiv = null;\n    const doc = detectDocument();\n    if (doc) {\n        escapeDiv = doc.createElement('div');\n    }\n\n    if (!escapeDiv) {\n        return String(str)\n            .replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&#39;');\n    }\n\n    escapeDiv.textContent = str;\n    return escapeDiv.innerHTML;\n}\n\nexport function escapeButtonLabelSafely(text) {\n    if (typeof text !== 'string' || text === '') {\n        return '';\n    }\n\n    try {\n        return escapeHtml(text);\n    } catch (escapeError) {\n        void escapeError;\n    }\n\n    return String(text)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#39;');\n}\n\nfunction isFiniteNumber(value) {\n    if (typeof value !== 'number') {\n        return false;\n    }\n    if (typeof Number.isFinite === 'function') {\n        return Number.isFinite(value);\n    }\n    return isFinite(value);\n}\n\nfunction fallbackToCodePointChar(value, radix) {\n    const codePoint = parseInt(value, radix);\n    if (!isFiniteNumber(codePoint) || codePoint < 0) {\n        return '';\n    }\n    try {\n        if (typeof String.fromCodePoint === 'function') {\n            return String.fromCodePoint(codePoint);\n        }\n    } catch (rangeError) {\n        void rangeError;\n    }\n    if (codePoint <= 0xffff) {\n        return String.fromCharCode(codePoint);\n    }\n    return '';\n}\n\nfunction fallbackNormalizeGlyphChar(char) {\n    if (typeof char !== 'string') {\n        return '';\n    }\n\n    const trimmed = char.trim();\n    if (!trimmed) {\n        return '';\n    }\n\n    const unicodeMatch = trimmed.match(/^(?:\\\\)+u([0-9A-Fa-f]{4})$/);\n    if (unicodeMatch) {\n        const decoded = fallbackToCodePointChar(unicodeMatch[1], 16);\n        if (decoded) {\n            return decoded;\n        }\n    }\n\n    const unicodeBraceMatch = trimmed.match(/^(?:\\\\)+u\\{([0-9A-Fa-f]+)\\}$/);\n    if (unicodeBraceMatch) {\n        const decoded = fallbackToCodePointChar(unicodeBraceMatch[1], 16);\n        if (decoded) {\n            return decoded;\n        }\n    }\n\n    const hexEntityMatch = trimmed.match(/^&#x([0-9A-Fa-f]+);$/i);\n    if (hexEntityMatch) {\n        const decoded = fallbackToCodePointChar(hexEntityMatch[1], 16);\n        if (decoded) {\n            return decoded;\n        }\n    }\n\n    const decimalEntityMatch = trimmed.match(/^&#(\\d+);$/);\n    if (decimalEntityMatch) {\n        const decoded = fallbackToCodePointChar(decimalEntityMatch[1], 10);\n        if (decoded) {\n            return decoded;\n        }\n    }\n\n    return trimmed;\n}\n\nfunction fallbackEscapeAttribute(value) {\n    if (typeof value === 'string') {\n        return escapeButtonLabelSafely(value);\n    }\n    if (value === null || typeof value === 'undefined') {\n        return '';\n    }\n    try {\n        return escapeButtonLabelSafely(String(value));\n    } catch (attributeError) {\n        void attributeError;\n    }\n    return '';\n}\n\nfunction normalizeFallbackGlyphConfig(glyph) {\n    if (!glyph) {\n        return null;\n    }\n\n    if (typeof glyph === 'string') {\n        const char = fallbackNormalizeGlyphChar(glyph);\n        if (!char) {\n            return null;\n        }\n        return { char, font: 'uicons', className: '' };\n    }\n\n    if (typeof glyph !== 'object') {\n        return null;\n    }\n\n    const markup = typeof glyph.markup === 'string' ? glyph.markup.trim() : '';\n    const className = typeof glyph.className === 'string' ? glyph.className : '';\n    const style = typeof glyph.style === 'string' ? glyph.style : '';\n    const size = glyph.size;\n    const scale = glyph.scale;\n\n    if (markup) {\n        return { markup, className, style, size, scale };\n    }\n\n    const rawChar =\n        typeof glyph.char === 'string' && glyph.char\n            ? glyph.char\n            : typeof glyph.character === 'string' && glyph.character\n                ? glyph.character\n                : typeof glyph.glyph === 'string' && glyph.glyph\n                    ? glyph.glyph\n                    : typeof glyph.unicode === 'string' && glyph.unicode\n                        ? glyph.unicode\n                        : '';\n\n    const char = fallbackNormalizeGlyphChar(rawChar);\n    if (!char) {\n        return null;\n    }\n\n    const font = typeof glyph.font === 'string' && glyph.font.trim() ? glyph.font.trim() : 'uicons';\n\n    return { char, font, className, style, size, scale };\n}\n\nfunction createFallbackIconMarkup(glyph, baseClassName) {\n    const resolved = normalizeFallbackGlyphConfig(glyph);\n    if (!resolved) {\n        return '';\n    }\n\n    const classes = ['icon-glyph'];\n    if (typeof baseClassName === 'string' && baseClassName) {\n        classes.unshift(baseClassName);\n    }\n\n    if (resolved.className) {\n        resolved.className\n            .split(/\\s+/)\n            .filter(Boolean)\n            .forEach(cls => {\n                if (classes.indexOf(cls) === -1) {\n                    classes.push(cls);\n                }\n            });\n    }\n\n    const styleParts = [];\n    if (isFiniteNumber(resolved.size) && resolved.size > 0) {\n        styleParts.push(`--icon-size: ${resolved.size}px`);\n    } else if (typeof resolved.size === 'string' && resolved.size.trim()) {\n        styleParts.push(`--icon-size: ${resolved.size.trim()}`);\n    }\n\n    if (isFiniteNumber(resolved.scale) && resolved.scale > 0) {\n        styleParts.push(`--icon-scale: ${resolved.scale}`);\n    } else if (typeof resolved.scale === 'string' && resolved.scale.trim()) {\n        styleParts.push(`--icon-scale: ${resolved.scale.trim()}`);\n    }\n\n    if (typeof resolved.style === 'string' && resolved.style.trim()) {\n        styleParts.push(resolved.style.trim());\n    }\n\n    const styleAttr = styleParts.length ? ` style=\"${styleParts.join(';')}\"` : '';\n\n    if (resolved.markup) {\n        return `<span class=\"${classes.join(' ')}\"${styleAttr} aria-hidden=\"true\">${resolved.markup}</span>`;\n    }\n\n    const char = typeof resolved.char === 'string' ? resolved.char : '';\n    if (!char) {\n        return '';\n    }\n\n    const font = typeof resolved.font === 'string' ? resolved.font : 'uicons';\n    const fontAttr = font ? ` data-icon-font=\"${fallbackEscapeAttribute(font)}\"` : '';\n    return `<span class=\"${classes.join(' ')}\"${styleAttr}${fontAttr} aria-hidden=\"true\">${escapeHtml(char)}</span>`;\n}\n\n// In a pure function, we can't easily rely on global `iconMarkup`.\n// We pass it as an argument or accept that this module handles the fallback exclusively.\n// For now, we'll keep the logic simple: this module provides the fallback and robust escaping.\n// Complex implementations should inject the icon factory.\n\nexport function resolveButtonIconMarkup(glyph, iconFactory) {\n    if (!glyph) {\n        return '';\n    }\n\n    if (typeof iconFactory === 'function') {\n        try {\n            return iconFactory(glyph, 'btn-icon');\n        } catch (iconError) {\n            void iconError;\n        }\n    }\n\n    // Pure fallback\n    return createFallbackIconMarkup(glyph, 'btn-icon');\n}\n\nexport function setButtonLabelWithIcon(button, label, glyph, iconFactory) {\n    if (!button) {\n        return;\n    }\n\n    const doc = detectDocument();\n    const iconHtml = resolveButtonIconMarkup(glyph, iconFactory);\n    const safeLabel = typeof label === 'string' ? label : '';\n\n    if (button.firstChild) {\n        while (button.firstChild) {\n            button.removeChild(button.firstChild);\n        }\n    }\n\n    if (doc && iconHtml) {\n        const temp = doc.createElement('span');\n        temp.innerHTML = iconHtml;\n        while (temp.firstChild) {\n            button.appendChild(temp.firstChild);\n        }\n    } else if (!doc && iconHtml && typeof button.innerHTML === 'string') {\n        button.innerHTML = `${iconHtml}${escapeButtonLabelSafely(safeLabel)}`;\n        return;\n    }\n\n    if (doc) {\n        button.appendChild(doc.createTextNode(safeLabel));\n    } else if (typeof button.textContent === 'string') {\n        button.textContent = safeLabel;\n    } else if (typeof button.innerHTML === 'string') {\n        button.innerHTML = escapeButtonLabelSafely(safeLabel);\n    }\n}\n\nexport function whenElementAvailable(idOrSelector, onResolve, options = {}) {\n    if (!idOrSelector || typeof onResolve !== 'function') {\n        return false;\n    }\n\n    const doc = detectDocument();\n    if (!doc) {\n        return false;\n    }\n\n    const find = (query) => {\n        let el = doc.getElementById(query);\n        if (!el) {\n            try {\n                el = doc.querySelector(query);\n            } catch (e) {\n                void e;\n            }\n        }\n        return el;\n    };\n\n    const initial = find(idOrSelector);\n    if (initial) {\n        try {\n            onResolve(initial);\n        } catch (handlerError) {\n            if (typeof console !== 'undefined') console.error(`whenElementAvailable: handler for ${idOrSelector} failed`, handlerError);\n        }\n        return true;\n    }\n\n    const attemptsLimit = typeof options.maxAttempts === 'number' ? options.maxAttempts : 150;\n    const interval = typeof options.interval === 'number' && options.interval > 0 ? options.interval : 100;\n\n    let attempts = 0;\n    const poll = () => {\n        attempts += 1;\n        const el = find(idOrSelector);\n        if (el) {\n            try {\n                onResolve(el);\n            } catch (handlerError) {\n                if (typeof console !== 'undefined') console.error(`whenElementAvailable: polled handler for ${idOrSelector} failed`, handlerError);\n            }\n            return;\n        }\n\n        if (attempts < attemptsLimit) {\n            setTimeout(poll, interval);\n        } else if (typeof options.onTimeout === 'function') {\n            try {\n                options.onTimeout();\n            } catch (timeoutError) {\n                void timeoutError;\n            }\n        }\n    };\n\n    setTimeout(poll, interval);\n    return true;\n}\n","/**\n * Cine Power Planner Device Schema Manager\n * \n * Pure ESM module for handling device schema loading, caching, and persistence.\n * Extracted from core/modules/core/device-schema.js during Vite migration.\n */\n\nexport const DEFAULT_DEVICE_SCHEMA_PATH = 'src/data/schema.json';\nexport const DEFAULT_DEVICE_SCHEMA_STORAGE_KEY = 'cameraPowerPlanner_schemaCache';\n\n// We allow passing configuration or fallback to defaults.\n// Core scope lookup is removed here to keep it pure; callers should inject config.\n\nconst schemaStorage = (() => {\n    if (typeof window === 'undefined') return null;\n    try {\n        if (!('localStorage' in window)) return null;\n        const { localStorage } = window;\n        const testKey = '__schema_cache__';\n        localStorage.setItem(testKey, '1');\n        localStorage.removeItem(testKey);\n        return localStorage;\n    } catch (error) {\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n            console.warn('Device schema cache disabled', error);\n        }\n        return null;\n    }\n})();\n\nexport function loadCachedDeviceSchema(storageKey = DEFAULT_DEVICE_SCHEMA_STORAGE_KEY) {\n    if (!schemaStorage) return null;\n    try {\n        const raw = schemaStorage.getItem(storageKey);\n        if (!raw) return null;\n        const parsed = JSON.parse(raw);\n        return parsed && typeof parsed === 'object' && !Array.isArray(parsed) ? parsed : null;\n    } catch (error) {\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n            console.warn('Failed to read cached device schema', error);\n        }\n        try {\n            schemaStorage.removeItem(storageKey);\n        } catch (removeError) {\n            if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n                console.warn('Failed to clear invalid cached device schema', removeError);\n            }\n        }\n        return null;\n    }\n}\n\nexport function persistDeviceSchema(schema, storageKey = DEFAULT_DEVICE_SCHEMA_STORAGE_KEY) {\n    if (!schemaStorage) return;\n    try {\n        schemaStorage.setItem(storageKey, JSON.stringify(schema));\n    } catch (error) {\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n            console.warn('Failed to cache device schema', error);\n        }\n    }\n}\n\nexport function isValidDeviceSchema(candidate) {\n    return !!candidate && typeof candidate === 'object' && !Array.isArray(candidate);\n}\n\nexport async function loadDeviceSchemaFromCacheStorage(path = DEFAULT_DEVICE_SCHEMA_PATH) {\n    if (typeof caches === 'undefined' || !caches || typeof caches.match !== 'function') {\n        return null;\n    }\n\n    const candidates = new Set([path]);\n    if (typeof path === 'string' && !path.startsWith('./')) {\n        candidates.add(`./${path}`);\n    }\n\n    if (typeof window !== 'undefined' && window && window.location) {\n        try {\n            candidates.add(new URL(path, window.location.href).toString());\n        } catch (error) {\n            if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n                console.warn('Failed to resolve schema.json cache URL', error);\n            }\n        }\n    }\n\n    for (const url of candidates) {\n        try {\n            const response = await caches.match(url, { ignoreSearch: true });\n            if (response) {\n                return await response.clone().json();\n            }\n        } catch (error) {\n            if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n                console.warn('Failed to read schema.json from cache entry', url, error);\n            }\n        }\n    }\n\n    return null;\n}\n\nfunction createPopulateScheduler(populateCategoryOptions) {\n    return function schedulePopulateCategoryOptions() {\n        const triggerPopulate = () => {\n            try {\n                populateCategoryOptions();\n            } catch (error) {\n                if (typeof console !== 'undefined' && typeof console.error === 'function') {\n                    console.error('populateCategoryOptions failed during scheduled execution', error);\n                }\n            }\n        };\n\n        if (typeof window !== 'undefined' && window && typeof window.setTimeout === 'function') {\n            window.setTimeout(triggerPopulate, 0);\n        } else if (typeof setTimeout === 'function') {\n            setTimeout(triggerPopulate, 0);\n        } else {\n            triggerPopulate();\n        }\n    };\n}\n\nfunction detectGlobalScope() {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    if (typeof window !== 'undefined') return window;\n    if (typeof self !== 'undefined') return self;\n    if (typeof global !== 'undefined') return global;\n    return null;\n}\n\nexport function createDeviceSchemaManager(options = {}) {\n    const shouldUseDefaults = !options || Object.keys(options).length === 0;\n\n    const onSchemaChange =\n        options && typeof options.onSchemaChange === 'function'\n            ? options.onSchemaChange\n            : () => { };\n\n    const populateCategoryOptions =\n        options && typeof options.populateCategoryOptions === 'function'\n            ? options.populateCategoryOptions\n            : () => {\n                const scope = detectGlobalScope();\n                if (!scope) {\n                    return;\n                }\n                let populate = null;\n                const preferredKey =\n                    options && typeof options.populateCategoryOptionsName === 'string'\n                        ? options.populateCategoryOptionsName\n                        : 'populateCategoryOptions';\n                if (preferredKey && typeof scope[preferredKey] === 'function') {\n                    populate = scope[preferredKey];\n                } else if (typeof scope.populateCategoryOptions === 'function') {\n                    populate = scope.populateCategoryOptions;\n                }\n                if (populate) {\n                    try {\n                        populate();\n                    } catch (error) {\n                        if (typeof console !== 'undefined' && typeof console.error === 'function') {\n                            console.error('populateCategoryOptions execution failed', error);\n                        }\n                    }\n                }\n            };\n\n    const schemaPath = options?.DEVICE_SCHEMA_PATH || DEFAULT_DEVICE_SCHEMA_PATH;\n    const storageKey = options?.DEVICE_SCHEMA_STORAGE_KEY || DEFAULT_DEVICE_SCHEMA_STORAGE_KEY;\n\n    let cachedSchema = loadCachedDeviceSchema(storageKey);\n    let deviceSchema = cachedSchema && isValidDeviceSchema(cachedSchema) ? cachedSchema : null;\n\n    onSchemaChange(deviceSchema);\n\n    const schedulePopulateCategoryOptions = createPopulateScheduler(populateCategoryOptions);\n\n    function setDeviceSchema(schema) {\n        if (isValidDeviceSchema(schema)) {\n            deviceSchema = schema;\n            cachedSchema = schema;\n        } else if (!deviceSchema) {\n            deviceSchema = {};\n        }\n        onSchemaChange(deviceSchema);\n        return deviceSchema;\n    }\n\n    function finalizeDeviceSchemaLoad(candidate) {\n        if (isValidDeviceSchema(candidate)) {\n            setDeviceSchema(candidate);\n            persistDeviceSchema(candidate, storageKey);\n        } else if (!deviceSchema) {\n            setDeviceSchema(cachedSchema || {});\n        }\n\n        schedulePopulateCategoryOptions();\n    }\n\n    return {\n        DEVICE_SCHEMA_PATH: schemaPath,\n        DEVICE_SCHEMA_STORAGE_KEY: storageKey,\n        loadCachedDeviceSchema: () => loadCachedDeviceSchema(storageKey),\n        persistDeviceSchema: (schema) => persistDeviceSchema(schema, storageKey),\n        isValidDeviceSchema,\n        loadDeviceSchemaFromCacheStorage: () => loadDeviceSchemaFromCacheStorage(schemaPath),\n        schedulePopulateCategoryOptions,\n        finalizeDeviceSchemaLoad,\n        getCachedDeviceSchema: () => (cachedSchema && isValidDeviceSchema(cachedSchema) ? cachedSchema : null),\n        getDeviceSchema: () => deviceSchema,\n        setDeviceSchema,\n    };\n}\n","/**\n * Cine Power Planner Runtime Support\n * \n * Aggregates core runtime utilities into a single ESM entry point.\n * Replaces the monolithic dependency resolution of app-core-runtime-support.js.\n */\n\nimport * as textTools from './text.js';\nimport * as uiTools from './ui-helpers.js';\nimport * as deviceSchemaTools from './device-schema.js';\nimport { cineCoreRuntimeModuleLoader } from './runtime-module-loader.js';\n\n// Re-export specific namespaces for clarity\nexport const Text = textTools;\nexport const UI = uiTools;\nexport const DeviceSchema = deviceSchemaTools;\nexport const Loader = cineCoreRuntimeModuleLoader;\n\n// Legacy-aligned exports (snake_case or constant style where appropriate for shim usage)\nexport const CORE_TEXT_ENTRY_TOOLS = textTools;\nexport const CORE_TEXT_ENTRY_SEPARATOR = textTools.TEXT_ENTRY_SEPARATOR;\nexport const normaliseTextEntryValue = textTools.normaliseTextEntryValue;\nexport const resolveTextEntryRuntime = textTools.resolveTextEntry;\n\nexport const CORE_DEVICE_SCHEMA = DeviceSchema;\n\nexport const CORE_RUNTIME_SUPPORT_BOOTSTRAP = null; // To be migrated/resolved\nexport const CORE_RUNTIME_SUPPORT_RESOLUTION = null; // To be migrated/resolved\n\n// Temperature Logic - ported from app-core-runtime-support.js\n// We can expose the logic function here, and the shim can use it.\nexport const CORE_TEMPERATURE_STORAGE_KEY_FALLBACK = 'cameraPowerPlanner_temperatureUnit';\n\nexport function resolvePreferredTemperatureStorageKey(scopeCandidates = []) {\n    // Pure implementation that accepts candidates instead of finding them implicitly\n    for (const scope of scopeCandidates) {\n        if (!scope) continue;\n\n        if (scope.TEMPERATURE_STORAGE_KEY) return scope.TEMPERATURE_STORAGE_KEY;\n        if (scope.TEMPERATURE_UNIT_STORAGE_KEY) return scope.TEMPERATURE_UNIT_STORAGE_KEY;\n\n        if (scope.CORE_SHARED?.TEMPERATURE_STORAGE_KEY) return scope.CORE_SHARED.TEMPERATURE_STORAGE_KEY;\n\n        if (scope.__cineStorageApi) {\n            if (scope.__cineStorageApi.TEMPERATURE_STORAGE_KEY) return scope.__cineStorageApi.TEMPERATURE_STORAGE_KEY;\n            if (typeof scope.__cineStorageApi.getTemperaturePreferenceStorageKey === 'function') {\n                try {\n                    const key = scope.__cineStorageApi.getTemperaturePreferenceStorageKey();\n                    if (key) return key;\n                } catch (e) { void e; }\n            }\n        }\n\n        if (typeof scope.resolveTemperatureStorageKey === 'function') {\n            try {\n                const key = scope.resolveTemperatureStorageKey();\n                if (key) return key;\n            } catch (e) { void e; }\n        }\n    }\n    return CORE_TEMPERATURE_STORAGE_KEY_FALLBACK;\n}\n\nexport function resolveCoreSupportModule(namespaceName, requirePath, scope) {\n    // Basic implementation mimicking app-core-runtime-support\n    // As we are in ESM, we essentially already resolved things or can use RuntimeLoader.\n    // The legacy shim relies on this.\n\n    // Check global namespace first\n    if (scope && scope[namespaceName]) {\n        return scope[namespaceName];\n    }\n\n    // Otherwise try loader (which might be circular or unavailable in pure ESM without top-level await)\n    // For now, return null or try simplified lookup\n    if (typeof window !== 'undefined' && window[namespaceName]) return window[namespaceName];\n\n    return null;\n}\n","/*\n * Cine Power Planner runtime support bridge.\n *\n * MIGRATED to pure ESM modules in Batch 11.\n * - Logic moved to: src/scripts/modules/runtime-support.js\n *\n * This file remains as a backwards-compatibility shim.\n */\n\nimport {\n  DeviceSchema,\n  Loader,\n  Text,\n  UI,\n  resolvePreferredTemperatureStorageKey,\n  resolveCoreSupportModule as resolveSupportModuleHelper,\n  CORE_TEXT_ENTRY_TOOLS as TextEntryTools,\n  CORE_TEXT_ENTRY_SEPARATOR as TextSeparator,\n  normaliseTextEntryValue as normaliseText,\n  resolveTextEntryRuntime as resolveText\n} from '../modules/runtime-support.js';\n\nimport { collectCandidateScopes } from '../modules/helpers/scope-utils.js';\n\n// --- Device Schema ---\nexport const CORE_DEVICE_SCHEMA = DeviceSchema;\n\n// --- Runtime Module Loader ---\nexport function resolveRuntimeModuleLoader() {\n  return Loader;\n}\n\n// --- Text Entry Tools ---\nexport const CORE_TEXT_ENTRY_TOOLS = TextEntryTools;\nexport const CORE_TEXT_ENTRY_SEPARATOR = TextSeparator;\nexport const normaliseTextEntryValue = normaliseText;\nexport const resolveTextEntryRuntime = resolveText;\n\n// --- Temperature Storage Key ---\nexport const CORE_TEMPERATURE_STORAGE_KEY = resolvePreferredTemperatureStorageKey(collectCandidateScopes());\n\n// --- Runtime Support Resolution (Shimmed) ---\n// These specific objects were used by the legacy bootstrap process.\n// We map them to the new ESM equivalents or null where deprecated.\n\nexport const CORE_RUNTIME_SUPPORT_BOOTSTRAP = null; // Deprecated\nexport const CORE_RUNTIME_SUPPORT_RESOLUTION = null; // Deprecated\n\nexport const CORE_RUNTIME_SUPPORT_DEFAULTS_NAMESPACE = {\n  fallbackDetectRuntimeScope: (scope) => scope,\n  fallbackResolveCoreSupportModule: resolveSupportModuleHelper\n};\n\nexport const CORE_RUNTIME_SUPPORT_RESOLUTION_DEFAULTS = CORE_RUNTIME_SUPPORT_DEFAULTS_NAMESPACE;\nexport const CORE_RUNTIME_SUPPORT_RESOLUTION_TOOLS = null;\nexport const CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS = null;\nexport const CORE_RUNTIME_SUPPORT_FALLBACK_TOOLS = null;\n\nexport const fallbackDetectRuntimeScope = (scope) => scope;\nexport const detectRuntimeScope = (scope) => scope;\nexport const fallbackResolveCoreSupportModule = resolveSupportModuleHelper;\n\nexport const CORE_PART1_RUNTIME_SCOPE = (typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : {}));\n\nexport function resolveCoreSupportModule(namespaceName, requirePath) {\n  return resolveSupportModuleHelper(namespaceName, requirePath, CORE_PART1_RUNTIME_SCOPE);\n}\n\n// Ensure Global Exposures for Legacy Code\nconst GLOBAL_SCOPE = typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : null);\nif (GLOBAL_SCOPE) {\n  if (!GLOBAL_SCOPE.resolveTextEntryInternal) {\n    GLOBAL_SCOPE.resolveTextEntryInternal = Text.resolveTextEntry;\n  }\n}\n","\n\n// --- Core Helpers ---\n\nfunction isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n}\n\nfunction ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n        return candidate;\n    }\n    if (typeof require === 'function') {\n        return require;\n    }\n    return null;\n}\n\nfunction ensureArray(value) {\n    return Array.isArray(value) ? value.slice() : [];\n}\n\n// --- Bootstrap Environment Logic ---\n\nfunction normalizeBootstrapInvocationOptions(baseOrOverrides, overrides) {\n    const hasOverrides = arguments.length > 1;\n    const baseSource = hasOverrides ? baseOrOverrides : null;\n    const overrideSource = hasOverrides ? overrides : baseOrOverrides;\n\n    const normalized = {};\n\n    if (baseSource && isObject(baseSource) && !Array.isArray(baseSource)) {\n        const baseKeys = Object.keys(baseSource);\n        for (let index = 0; index < baseKeys.length; index += 1) {\n            const key = baseKeys[index];\n            normalized[key] = baseSource[key];\n        }\n    }\n\n    normalized.resolveCoreSupportModule =\n        typeof normalized.resolveCoreSupportModule === 'function' ?\n            normalized.resolveCoreSupportModule :\n            null;\n    normalized.requireFn = ensureRequireFn(normalized.requireFn);\n    normalized.runtimeScope = normalized.runtimeScope && isObject(normalized.runtimeScope) ?\n        normalized.runtimeScope :\n        null;\n    normalized.coreGlobalScope = normalized.coreGlobalScope && isObject(normalized.coreGlobalScope) ?\n        normalized.coreGlobalScope :\n        null;\n    normalized.fallbackScopes = ensureArray(normalized.fallbackScopes);\n\n    function applyOverrides(source) {\n        if (!source) {\n            return;\n        }\n\n        if (Array.isArray(source)) {\n            normalized.fallbackScopes = source.slice();\n            return;\n        }\n\n        if (!isObject(source)) {\n            return;\n        }\n\n        if (Array.isArray(source.fallbackScopes)) {\n            normalized.fallbackScopes = source.fallbackScopes.slice();\n        } else if (source.fallbackScopes) {\n            normalized.fallbackScopes = [source.fallbackScopes];\n        }\n\n        if (source.runtimeScope && isObject(source.runtimeScope)) {\n            normalized.runtimeScope = source.runtimeScope;\n        }\n\n        if (source.coreGlobalScope && isObject(source.coreGlobalScope)) {\n            normalized.coreGlobalScope = source.coreGlobalScope;\n        }\n\n        if (typeof source.requireFn === 'function') {\n            normalized.requireFn = source.requireFn;\n        } else if (Object.prototype.hasOwnProperty.call(source, 'requireFn')) {\n            normalized.requireFn = ensureRequireFn(source.requireFn);\n        }\n\n        if (typeof source.resolveCoreSupportModule === 'function') {\n            normalized.resolveCoreSupportModule = source.resolveCoreSupportModule;\n        } else if (Object.prototype.hasOwnProperty.call(source, 'resolveCoreSupportModule')) {\n            normalized.resolveCoreSupportModule = null;\n        }\n\n        const keys = Object.keys(source);\n        for (let index = 0; index < keys.length; index += 1) {\n            const key = keys[index];\n\n            if (\n                key === 'fallbackScopes' ||\n                key === 'runtimeScope' ||\n                key === 'coreGlobalScope' ||\n                key === 'requireFn' ||\n                key === 'resolveCoreSupportModule'\n            ) {\n                continue;\n            }\n\n            normalized[key] = source[key];\n        }\n    }\n\n    applyOverrides(overrideSource);\n\n    normalized.requireFn = ensureRequireFn(normalized.requireFn);\n    normalized.fallbackScopes = ensureArray(normalized.fallbackScopes);\n\n    return normalized;\n}\n\nfunction appendFallbackScopes(scopes, runtimeScope, coreGlobalScope) {\n    if (!Array.isArray(scopes)) {\n        return [];\n    }\n\n    const list = scopes.slice();\n\n    if (runtimeScope && isObject(runtimeScope) && list.indexOf(runtimeScope) === -1) {\n        list.push(runtimeScope);\n    }\n\n    if (coreGlobalScope && isObject(coreGlobalScope) && list.indexOf(coreGlobalScope) === -1) {\n        list.push(coreGlobalScope);\n    }\n\n    const globalCandidates = [\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < globalCandidates.length; index += 1) {\n        const scope = globalCandidates[index];\n        if (!scope || !isObject(scope)) {\n            continue;\n        }\n        if (list.indexOf(scope) === -1) {\n            list.push(scope);\n        }\n    }\n\n    return list;\n}\n\nfunction collectBootstrapFallbackScopes(options) {\n    const invocationOptions = normalizeBootstrapInvocationOptions(options);\n    const runtimeScope = invocationOptions.runtimeScope;\n    const coreGlobalScope = invocationOptions.coreGlobalScope;\n    const fallbackScopeList = ensureArray(invocationOptions.fallbackScopes);\n    const bootstrapEnvironmentTools =\n        invocationOptions.bootstrapEnvironmentTools ||\n        invocationOptions.bootstrapEnvironment ||\n        (!invocationOptions._isResolvingEnvironment ? getBootstrapEnvironmentTools(invocationOptions) : null);\n    const bootstrapResultsTools =\n        invocationOptions.bootstrapResultsTools ||\n        (options && options.getBootstrapResultsTools ? options.getBootstrapResultsTools(invocationOptions) : null);\n\n    if (\n        bootstrapResultsTools &&\n        typeof bootstrapResultsTools.collectBootstrapFallbackScopes === 'function'\n    ) {\n        const collectAdditionalFallbackScopes =\n            bootstrapEnvironmentTools &&\n                typeof bootstrapEnvironmentTools.collectFallbackScopes === 'function' ?\n                function collectAdditionalFallbackScopes(scopes) {\n                    try {\n                        const collected = bootstrapEnvironmentTools.collectFallbackScopes({\n                            fallbackScopes: Array.isArray(scopes) ? scopes : ensureArray(scopes),\n                            runtimeScope,\n                            coreGlobalScope,\n                        });\n\n                        if (Array.isArray(collected)) {\n                            return collected;\n                        }\n                    } catch (environmentCollectError) {\n                        void environmentCollectError;\n                    }\n\n                    if (Array.isArray(scopes)) {\n                        try {\n                            const legacyCollected = bootstrapEnvironmentTools.collectFallbackScopes(scopes);\n\n                            if (Array.isArray(legacyCollected)) {\n                                return legacyCollected;\n                            }\n                        } catch (legacyEnvironmentCollectError) {\n                            void legacyEnvironmentCollectError;\n                        }\n                    }\n\n                    return null;\n                } :\n                null;\n\n        try {\n            const collected = bootstrapResultsTools.collectBootstrapFallbackScopes({\n                fallbackScopes: fallbackScopeList,\n                runtimeScope,\n                coreGlobalScope,\n                collectFallbackScopes: collectAdditionalFallbackScopes,\n            });\n\n            if (Array.isArray(collected)) {\n                return collected;\n            }\n        } catch (resultsCollectError) {\n            void resultsCollectError;\n        }\n    }\n\n    if (\n        bootstrapEnvironmentTools &&\n        typeof bootstrapEnvironmentTools.collectFallbackScopes === 'function'\n    ) {\n        try {\n            const environmentCollected = bootstrapEnvironmentTools.collectFallbackScopes({\n                fallbackScopes: fallbackScopeList,\n                runtimeScope,\n                coreGlobalScope,\n            });\n\n            if (Array.isArray(environmentCollected)) {\n                return environmentCollected;\n            }\n        } catch (environmentCollectError) {\n            void environmentCollectError;\n        }\n\n        if (Array.isArray(fallbackScopeList)) {\n            try {\n                const legacyEnvironmentCollected =\n                    bootstrapEnvironmentTools.collectFallbackScopes(fallbackScopeList);\n\n                if (Array.isArray(legacyEnvironmentCollected)) {\n                    return legacyEnvironmentCollected;\n                }\n            } catch (legacyEnvironmentCollectError) {\n                void legacyEnvironmentCollectError;\n            }\n        }\n    }\n\n    return appendFallbackScopes(fallbackScopeList, runtimeScope, coreGlobalScope);\n}\n\nfunction resolveNamespace(namespaceName, requirePath, options) {\n    const directNamespace =\n        options && isObject(options.directNamespace) ? options.directNamespace : null;\n\n    if (directNamespace) {\n        return directNamespace;\n    }\n\n    const resolveCoreSupportModule =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n\n    if (resolveCoreSupportModule) {\n        try {\n            const resolved = resolveCoreSupportModule(namespaceName, requirePath);\n            if (resolved && isObject(resolved)) {\n                return resolved;\n            }\n        } catch (resolveError) {\n            void resolveError;\n        }\n    }\n\n    const requireFn = ensureRequireFn(options && options.requireFn);\n\n    if (typeof requireFn === 'function' && requirePath) {\n        try {\n            const required = requireFn(requirePath);\n            if (required && isObject(required)) {\n                return required;\n            }\n        } catch (requireError) {\n            void requireError;\n        }\n    }\n\n    const fallbackScopes = collectBootstrapFallbackScopes(options);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n\n        if (!scope || !isObject(scope)) {\n            continue;\n        }\n\n        try {\n            const candidate = scope[namespaceName];\n            if (candidate && isObject(candidate)) {\n                return candidate;\n            }\n        } catch (lookupError) {\n            void lookupError;\n        }\n    }\n\n    return null;\n}\n\nfunction getBootstrapEnvironmentTools(options) {\n    if (options && isObject(options.bootstrapEnvironmentTools)) {\n        return options.bootstrapEnvironmentTools;\n    }\n\n    if (options && isObject(options.bootstrapEnvironment)) {\n        return options.bootstrapEnvironment;\n    }\n\n    return resolveBootstrapEnvironmentTools(options);\n}\n\nfunction resolveBootstrapEnvironmentTools(options) {\n    const resolverOptions = options && typeof options === 'object' && !Array.isArray(options) ? Object.assign({}, options) : {};\n\n    if (!resolverOptions.directNamespace && options && isObject(options.directBootstrapEnvironmentNamespace)) {\n        resolverOptions.directNamespace = options.directBootstrapEnvironmentNamespace;\n    }\n\n    resolverOptions._isResolvingEnvironment = true;\n\n    return resolveNamespace(\n        'cineCoreAppCoreBootstrapEnvironment',\n        './modules/app-core/bootstrap.js',\n        resolverOptions\n    );\n}\n\nfunction collectEnvironmentFallbackScopes(options) {\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope = options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n\n    return appendFallbackScopes(\n        ensureArray(options && options.fallbackScopes),\n        runtimeScope,\n        coreGlobalScope\n    );\n}\n\nfunction hasBootstrapResolverCapabilities(candidate) {\n    return (\n        !!candidate &&\n        typeof candidate === 'object' &&\n        typeof candidate.resolveBootstrapTools === 'function' &&\n        typeof candidate.resolveBootstrapFallbackTools === 'function' &&\n        typeof candidate.createInlineLocalizationFallback === 'function' &&\n        typeof candidate.createInlineRuntimeSharedFallback === 'function'\n    );\n}\n\nfunction resolveBootstrapResolverTools(options) {\n    const directResolverNamespace =\n        options && isObject(options.directResolverNamespace) ?\n            options.directResolverNamespace :\n            null;\n\n    if (hasBootstrapResolverCapabilities(directResolverNamespace)) {\n        return directResolverNamespace;\n    }\n\n    const resolverOptions = {\n        resolveCoreSupportModule: options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null,\n        requireFn: ensureRequireFn(options && options.requireFn),\n        runtimeScope: options && isObject(options.runtimeScope) ? options.runtimeScope : null,\n        coreGlobalScope: options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null,\n        fallbackScopes: ensureArray(options && options.fallbackScopes),\n    };\n\n    const resolvedNamespace = resolveNamespace(\n        'cineCoreAppCoreBootstrapResolver',\n        './modules/app-core/bootstrap.js',\n        Object.assign({}, resolverOptions, {\n            directNamespace: directResolverNamespace\n        })\n    );\n\n    if (hasBootstrapResolverCapabilities(resolvedNamespace)) {\n        return resolvedNamespace;\n    }\n\n    if (\n        resolvedNamespace &&\n        isObject(resolvedNamespace.cineCoreAppCoreBootstrapResolver) &&\n        hasBootstrapResolverCapabilities(resolvedNamespace.cineCoreAppCoreBootstrapResolver)\n    ) {\n        return resolvedNamespace.cineCoreAppCoreBootstrapResolver;\n    }\n\n    if (\n        resolvedNamespace &&\n        isObject(resolvedNamespace.cineCoreAppCoreBootstrap) &&\n        hasBootstrapResolverCapabilities(resolvedNamespace.cineCoreAppCoreBootstrap)\n    ) {\n        return resolvedNamespace.cineCoreAppCoreBootstrap;\n    }\n\n    const fallbackScopes = collectBootstrapFallbackScopes(resolverOptions);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n\n        if (!scope || !isObject(scope)) {\n            continue;\n        }\n\n        try {\n            const resolverCandidate = scope.cineCoreAppCoreBootstrapResolver;\n\n            if (hasBootstrapResolverCapabilities(resolverCandidate)) {\n                return resolverCandidate;\n            }\n\n            const bootstrapCandidate = scope.cineCoreAppCoreBootstrap;\n\n            if (hasBootstrapResolverCapabilities(bootstrapCandidate)) {\n                return bootstrapCandidate;\n            }\n        } catch (resolverLookupError) {\n            void resolverLookupError;\n        }\n    }\n\n    return null;\n}\n\n// --- Bootstrap Environment Functionality ---\n\nfunction createBootstrapEnvironment(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope =\n        options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n    const fallbackScopes = collectEnvironmentFallbackScopes({\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes: options && options.fallbackScopes,\n    });\n\n    const resolverTools = resolveBootstrapResolverTools({\n        directResolverNamespace: options && options.directResolverNamespace,\n        resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n        requireFn,\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes,\n    });\n\n    // NOTE: resolveBootstrapToolsWithResolver and resolveBootstrapFallbackToolsWithResolver\n    // are circular dependencies if defined here directly.\n    // They are primarily used in the full suite or by the legacy system.\n    // In this module, we export them, but they might need to be passed in or resolved dynamically.\n    // For now we will include the implementation but note that they interact with other parts.\n\n    return {\n        fallbackScopes,\n        bootstrapResolverTools: resolverTools,\n        // Detailed implementations of tools creation moved to main bootstrap orchestrator\n        // or handled via callback to avoid cyclic dependency on 'resolveBootstrapTools' etc.\n    };\n}\n\nexport const cineCoreAppCoreBootstrapEnvironment = {\n    createBootstrapEnvironment,\n    resolveBootstrapResolverTools,\n    resolveBootstrapEnvironmentTools,\n    collectFallbackScopes: collectEnvironmentFallbackScopes,\n    normalizeBootstrapInvocationOptions,\n    collectBootstrapFallbackScopes,\n    resolveNamespace,\n    ensureRequireFn,\n    ensureArray,\n    isObject,\n    appendFallbackScopes,\n    hasBootstrapResolverCapabilities,\n    getBootstrapEnvironmentTools\n};\n","import {\n    cineCoreAppCoreBootstrapEnvironment\n} from './bootstrap-environment.js';\n\nconst {\n    isObject,\n    ensureArray,\n    ensureRequireFn\n} = cineCoreAppCoreBootstrapEnvironment;\n\n// --- Helpers ---\n\nfunction registerScope(scopes, scope) {\n    if (!scope || !isObject(scope)) {\n        return;\n    }\n\n    if (Array.isArray(scopes) && scopes.indexOf(scope) === -1) {\n        scopes.push(scope);\n    }\n}\n\nfunction attemptFactory(factory, factoryOptions) {\n    if (typeof factory !== 'function') {\n        return null;\n    }\n\n    try {\n        const result = factory(factoryOptions);\n        return result && typeof result === 'object' ? result : null;\n    } catch (error) {\n        void error;\n    }\n\n    return null;\n}\n\n// --- Results Logic ---\n\nfunction collectResultsFallbackScopes(options) {\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope = options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n    const fallbackScopesInput = options ? options.fallbackScopes : null;\n\n    if (options && typeof options.collectFallbackScopes === 'function') {\n        try {\n            const collected = options.collectFallbackScopes(fallbackScopesInput);\n\n            if (Array.isArray(collected)) {\n                const list = ensureArray(collected);\n                registerScope(list, runtimeScope);\n                registerScope(list, coreGlobalScope);\n                registerScope(list, typeof globalThis !== 'undefined' ? globalThis : null);\n                registerScope(list, typeof window !== 'undefined' ? window : null);\n                registerScope(list, typeof self !== 'undefined' ? self : null);\n                registerScope(list, typeof global !== 'undefined' ? global : null);\n                return list;\n            }\n        } catch (collectorError) {\n            void collectorError;\n        }\n    }\n\n    const fallbackScopes = ensureArray(fallbackScopesInput);\n    registerScope(fallbackScopes, runtimeScope);\n    registerScope(fallbackScopes, coreGlobalScope);\n    registerScope(fallbackScopes, typeof globalThis !== 'undefined' ? globalThis : null);\n    registerScope(fallbackScopes, typeof window !== 'undefined' ? window : null);\n    registerScope(fallbackScopes, typeof self !== 'undefined' ? self : null);\n    registerScope(fallbackScopes, typeof global !== 'undefined' ? global : null);\n    return fallbackScopes;\n}\n\nfunction createLocalizationFallbackSkeleton() {\n    return {\n        localizationSupport: null,\n        localizationRuntimeEnvironment: null,\n        localizationBridge: null,\n        localizationFallbacks: null,\n        inlineLocalizationFallbacks: null,\n        localizationFallbackSupport: null,\n        createBasicLocalizationFallbackResolvers() {\n            return null;\n        },\n        localizationFallbackRegistry: {\n            createFallbackResolvers() {\n                return null;\n            },\n        },\n        localizationFallbackResolvers: null,\n        localizationFallbackNamespace: null,\n        fallbackResolveLocaleModule() {\n            return null;\n        },\n        createLocaleFallbacks() {\n            return null;\n        },\n    };\n}\n\nfunction createRuntimeSharedFallbackSkeleton(options) {\n    const fallbackScopes = collectResultsFallbackScopes(options || null);\n    const currentRuntimeShared =\n        options && isObject(options.currentRuntimeShared) ? options.currentRuntimeShared : null;\n\n    function fallbackResolveRuntimeSharedFromGlobal() {\n        for (let index = 0; index < fallbackScopes.length; index += 1) {\n            const scope = fallbackScopes[index];\n\n            if (!isObject(scope)) {\n                continue;\n            }\n\n            try {\n                const candidate = scope.cineCoreRuntimeShared;\n                if (candidate && typeof candidate === 'object') {\n                    return candidate;\n                }\n            } catch (lookupError) {\n                void lookupError;\n            }\n        }\n\n        return null;\n    }\n\n    let runtimeShared = currentRuntimeShared;\n\n    if (!runtimeShared || typeof runtimeShared !== 'object') {\n        runtimeShared = fallbackResolveRuntimeSharedFromGlobal();\n    }\n\n    if (!runtimeShared || typeof runtimeShared !== 'object') {\n        try {\n            runtimeShared = Object.create(null);\n        } catch (creationError) {\n            void creationError;\n            runtimeShared = {};\n        }\n    }\n\n    return {\n        runtimeSharedNamespace: null,\n        runtimeSharedResolver: null,\n        existingRuntimeShared: runtimeShared,\n        runtimeShared,\n        fallbackResolveRuntimeSharedFromGlobal,\n    };\n}\n\nfunction resolveBootstrapResultsTools(options) {\n    const resolverOptions = options && typeof options === 'object' && !Array.isArray(options) ? Object.assign({}, options) : {};\n\n    if (!resolverOptions.directNamespace && options && isObject(options.directBootstrapResultsNamespace)) {\n        resolverOptions.directNamespace = options.directBootstrapResultsNamespace;\n    }\n\n    return cineCoreAppCoreBootstrapEnvironment.resolveNamespace(\n        'cineCoreAppCoreBootstrapResults',\n        './modules/app-core/bootstrap.js',\n        resolverOptions\n    );\n}\n\nfunction getBootstrapResultsTools(options) {\n    if (options && isObject(options.bootstrapResultsTools)) {\n        return options.bootstrapResultsTools;\n    }\n\n    if (options && isObject(options.resultsTools)) {\n        return options.resultsTools;\n    }\n\n    return resolveBootstrapResultsTools(options);\n}\n\nfunction resolveLocalizationBootstrapResult(options) {\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope = options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n    const fallbackScopes = collectResultsFallbackScopes({\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes: options && options.fallbackScopes,\n        collectFallbackScopes: options && options.collectFallbackScopes,\n    });\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const resolveCoreSupportModule =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n\n    const bootstrapOptions = {\n        localizationSupportTools: options && isObject(options.localizationSupportTools) ?\n            options.localizationSupportTools :\n            null,\n        localizationBootstrapTools: options && isObject(options.localizationBootstrapTools) ?\n            options.localizationBootstrapTools :\n            null,\n        localizationRuntimeTools: options && isObject(options.localizationRuntimeTools) ?\n            options.localizationRuntimeTools :\n            null,\n        resolveCoreSupportModule,\n        requireFn,\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes,\n        currentLocalization: options && isObject(options.currentLocalization) ? options.currentLocalization : null,\n    };\n\n    const bootstrapTools =\n        options && isObject(options.bootstrapTools) ? options.bootstrapTools : null;\n\n    let result = attemptFactory(\n        bootstrapTools && bootstrapTools.createLocalizationBootstrapResult,\n        bootstrapOptions\n    );\n\n    if (!result) {\n        result = attemptFactory(\n            bootstrapTools && bootstrapTools.createLocalizationBootstrapFallback,\n            bootstrapOptions\n        );\n    }\n\n    if (!result) {\n        const inlineFactory =\n            options && typeof options.createInlineLocalizationFallback === 'function' ?\n                options.createInlineLocalizationFallback :\n                null;\n\n        result = attemptFactory(inlineFactory, {\n            fallbackTools: options && isObject(options.bootstrapFallbackTools) ?\n                options.bootstrapFallbackTools :\n                null,\n            resolveCoreSupportModule,\n            requireFn,\n            runtimeScope,\n            coreGlobalScope,\n            fallbackScopes,\n            localizationFallbackOptions: options && options.localizationFallbackOptions ?\n                options.localizationFallbackOptions :\n                null,\n        });\n    }\n\n    if (!result) {\n        result = createLocalizationFallbackSkeleton();\n    }\n\n    return result;\n}\n\nfunction resolveRuntimeSharedBootstrapResult(options) {\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope = options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n    const fallbackScopes = collectResultsFallbackScopes({\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes: options && options.fallbackScopes,\n        collectFallbackScopes: options && options.collectFallbackScopes,\n    });\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const resolveCoreSupportModule =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n\n    const bootstrapOptions = {\n        runtimeSharedBootstrapResolverTools: options && isObject(options.runtimeSharedBootstrapResolverTools) ?\n            options.runtimeSharedBootstrapResolverTools :\n            null,\n        runtimeSharedBootstrapTools: options && isObject(options.runtimeSharedBootstrapTools) ?\n            options.runtimeSharedBootstrapTools :\n            null,\n        runtimeSharedNamespaceTools: options && isObject(options.runtimeSharedNamespaceTools) ?\n            options.runtimeSharedNamespaceTools :\n            null,\n        runtimeSharedBootstrapInlineTools: options && isObject(options.runtimeSharedBootstrapInlineTools) ?\n            options.runtimeSharedBootstrapInlineTools :\n            null,\n        runtimeSharedBootstrapResultTools: options && isObject(options.runtimeSharedBootstrapResultTools) ?\n            options.runtimeSharedBootstrapResultTools :\n            null,\n        runtimeSharedBootstrapLoaderTools: options && isObject(options.runtimeSharedBootstrapLoaderTools) ?\n            options.runtimeSharedBootstrapLoaderTools :\n            null,\n        runtimeSharedBootstrapManagerTools: options && isObject(options.runtimeSharedBootstrapManagerTools) ?\n            options.runtimeSharedBootstrapManagerTools :\n            null,\n        resolveCoreSupportModule,\n        requireFn,\n        runtimeScope,\n        coreGlobalScope,\n        currentRuntimeShared: options && isObject(options.currentRuntimeShared) ? options.currentRuntimeShared : null,\n        fallbackScopes,\n        runtimeSharedBootstrapInlineRequirePath: options && options.runtimeSharedBootstrapInlineRequirePath ?\n            options.runtimeSharedBootstrapInlineRequirePath :\n            null,\n        runtimeSharedBootstrapResultRequirePath: options && options.runtimeSharedBootstrapResultRequirePath ?\n            options.runtimeSharedBootstrapResultRequirePath :\n            null,\n    };\n\n    const bootstrapTools =\n        options && isObject(options.bootstrapTools) ? options.bootstrapTools : null;\n\n    let result = attemptFactory(\n        bootstrapTools && bootstrapTools.createRuntimeSharedBootstrapResult,\n        bootstrapOptions\n    );\n\n    if (!result) {\n        result = attemptFactory(\n            bootstrapTools && bootstrapTools.createRuntimeSharedBootstrapFallback,\n            bootstrapOptions\n        );\n    }\n\n    if (!result) {\n        const inlineFactory =\n            options && typeof options.createInlineRuntimeSharedFallback === 'function' ?\n                options.createInlineRuntimeSharedFallback :\n                null;\n\n        result = attemptFactory(inlineFactory, {\n            fallbackTools: options && isObject(options.bootstrapFallbackTools) ?\n                options.bootstrapFallbackTools :\n                null,\n            resolveCoreSupportModule,\n            requireFn,\n            runtimeScope,\n            coreGlobalScope,\n            fallbackScopes,\n            currentRuntimeShared: options && isObject(options.currentRuntimeShared) ?\n                options.currentRuntimeShared :\n                null,\n        });\n    }\n\n    if (!result) {\n        result = createRuntimeSharedFallbackSkeleton({\n            runtimeScope,\n            coreGlobalScope,\n            fallbackScopes,\n            currentRuntimeShared: options && isObject(options.currentRuntimeShared) ?\n                options.currentRuntimeShared :\n                null,\n        });\n    }\n\n    return result;\n}\n\nexport const cineCoreAppCoreBootstrapResults = {\n    resolveLocalizationBootstrapResult,\n    resolveRuntimeSharedBootstrapResult,\n    collectBootstrapFallbackScopes: function (options) {\n        return collectResultsFallbackScopes(options || null);\n    },\n    createLocalizationFallbackSkeleton,\n    createRuntimeSharedFallbackSkeleton,\n    resolveBootstrapResultsTools,\n    getBootstrapResultsTools,\n    attemptFactory\n};\n","import {\n    cineCoreAppCoreBootstrapEnvironment\n} from './bootstrap-environment.js';\nimport {\n    cineCoreAppCoreBootstrapResults\n} from './bootstrap-results.js';\nimport {\n    resolveCoreSupportModule\n} from '../runtime-support.js';\n\nconst {\n    isObject,\n    ensureRequireFn,\n    ensureArray,\n    resolveNamespace,\n    normalizeBootstrapInvocationOptions,\n    collectBootstrapFallbackScopes,\n    getBootstrapEnvironmentTools,\n    resolveBootstrapResolverTools,\n    resolveBootstrapEnvironmentTools,\n    createBootstrapEnvironment: createBaseBootstrapEnvironment\n} = cineCoreAppCoreBootstrapEnvironment;\n\nconst {\n    createLocalizationFallbackSkeleton,\n    createRuntimeSharedFallbackSkeleton,\n    resolveLocalizationBootstrapResult,\n    resolveRuntimeSharedBootstrapResult,\n    resolveBootstrapResultsTools,\n    attemptFactory,\n    getBootstrapResultsTools\n} = cineCoreAppCoreBootstrapResults;\n\n// --- Resolution Helpers ---\n\nfunction resolveBootstrapTools(options) {\n    const resolverOptions = options && typeof options === 'object' && !Array.isArray(options) ? Object.assign({}, options) : {};\n    if (!resolverOptions.directNamespace && options && isObject(options.directBootstrapNamespace)) {\n        resolverOptions.directNamespace = options.directBootstrapNamespace;\n    }\n    return resolveNamespace('cineCoreAppCoreBootstrap', './modules/app-core/bootstrap.js', resolverOptions);\n}\n\nfunction resolveBootstrapFallbackTools(options) {\n    const resolverOptions = options && typeof options === 'object' && !Array.isArray(options) ? Object.assign({}, options) : {};\n    if (!resolverOptions.directNamespace && options && isObject(options.directBootstrapFallbackNamespace)) {\n        resolverOptions.directNamespace = options.directBootstrapFallbackNamespace;\n    }\n    return resolveNamespace(\n        'cineCoreAppCoreBootstrapFallbacks',\n        './modules/app-core/bootstrap.js',\n        resolverOptions\n    );\n}\n\nfunction getBootstrapFallbackTools(options) {\n    if (options && isObject(options.bootstrapFallbackTools)) {\n        return options.bootstrapFallbackTools;\n    }\n\n    if (options && isObject(options.fallbackTools)) {\n        return options.fallbackTools;\n    }\n\n    return resolveBootstrapFallbackTools(options);\n}\n\nfunction getBootstrapResolverTools(options) {\n    if (\n        options &&\n        isObject(options.bootstrapResolverTools) &&\n        cineCoreAppCoreBootstrapEnvironment.hasBootstrapResolverCapabilities(options.bootstrapResolverTools)\n    ) {\n        return options.bootstrapResolverTools;\n    }\n\n    return resolveBootstrapResolverTools(options);\n}\n\nfunction resolveBootstrapToolsWithResolver(options) {\n    const resolverTools =\n        options && isObject(options.bootstrapResolverTools) ?\n            options.bootstrapResolverTools :\n            null;\n\n    if (resolverTools && typeof resolverTools.resolveBootstrapTools === 'function') {\n        try {\n            const resolved = resolverTools.resolveBootstrapTools(options);\n            if (resolved && isObject(resolved)) {\n                return resolved;\n            }\n        } catch (bootstrapResolveError) {\n            void bootstrapResolveError;\n        }\n    }\n\n    const directBootstrapNamespace =\n        options && isObject(options.directBootstrapNamespace) ?\n            options.directBootstrapNamespace :\n            null;\n\n    if (directBootstrapNamespace && isObject(directBootstrapNamespace)) {\n        return directBootstrapNamespace;\n    }\n\n    const resolveCoreSupportModuleFn =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n\n    if (resolveCoreSupportModuleFn) {\n        try {\n            const resolved = resolveCoreSupportModuleFn(\n                'cineCoreAppCoreBootstrap',\n                './modules/app-core/bootstrap.js'\n            );\n\n            if (resolved && isObject(resolved)) {\n                return resolved;\n            }\n        } catch (bootstrapSupportResolveError) {\n            void bootstrapSupportResolveError;\n        }\n    }\n\n    const requireFn = ensureRequireFn(options && options.requireFn);\n\n    if (typeof requireFn === 'function') {\n        try {\n            const requiredBootstrap = requireFn('./modules/app-core/bootstrap.js');\n\n            if (requiredBootstrap && isObject(requiredBootstrap)) {\n                return requiredBootstrap;\n            }\n        } catch (bootstrapRequireError) {\n            void bootstrapRequireError;\n        }\n    }\n\n    const fallbackScopes = cineCoreAppCoreBootstrapEnvironment.collectFallbackScopes(options);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n\n        if (!scope || !isObject(scope)) {\n            continue;\n        }\n\n        try {\n            const candidate = scope.cineCoreAppCoreBootstrap;\n\n            if (candidate && isObject(candidate)) {\n                return candidate;\n            }\n        } catch (bootstrapLookupError) {\n            void bootstrapLookupError;\n        }\n    }\n\n    return null;\n}\n\nfunction resolveBootstrapFallbackToolsWithResolver(options) {\n    const resolverTools =\n        options && isObject(options.bootstrapResolverTools) ?\n            options.bootstrapResolverTools :\n            null;\n\n    if (resolverTools && typeof resolverTools.resolveBootstrapFallbackTools === 'function') {\n        try {\n            const resolved = resolverTools.resolveBootstrapFallbackTools(options);\n            if (resolved && isObject(resolved)) {\n                return resolved;\n            }\n        } catch (bootstrapFallbackResolveError) {\n            void bootstrapFallbackResolveError;\n        }\n    }\n\n    const directFallbackNamespace =\n        options && isObject(options.directBootstrapFallbackNamespace) ?\n            options.directBootstrapFallbackNamespace :\n            null;\n\n    if (directFallbackNamespace && isObject(directFallbackNamespace)) {\n        return directFallbackNamespace;\n    }\n\n    const resolveCoreSupportModuleFn =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n\n    if (resolveCoreSupportModuleFn) {\n        try {\n            const resolved = resolveCoreSupportModuleFn(\n                'cineCoreAppCoreBootstrapFallbacks',\n                './modules/app-core/bootstrap.js'\n            );\n\n            if (resolved && isObject(resolved)) {\n                return resolved;\n            }\n        } catch (bootstrapFallbackSupportResolveError) {\n            void bootstrapFallbackSupportResolveError;\n        }\n    }\n\n    const requireFn = ensureRequireFn(options && options.requireFn);\n\n    if (typeof requireFn === 'function') {\n        try {\n            const requiredFallback = requireFn('./modules/app-core/bootstrap.js');\n\n            if (requiredFallback && isObject(requiredFallback.cineCoreAppCoreBootstrapFallbacks)) {\n                return requiredFallback.cineCoreAppCoreBootstrapFallbacks;\n            }\n\n            if (requiredFallback && isObject(requiredFallback)) {\n                return requiredFallback;\n            }\n        } catch (bootstrapFallbackRequireError) {\n            void bootstrapFallbackRequireError;\n        }\n    }\n\n    const fallbackScopes = cineCoreAppCoreBootstrapEnvironment.collectFallbackScopes(options);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n\n        if (!scope || !isObject(scope)) {\n            continue;\n        }\n\n        try {\n            const candidate = scope.cineCoreAppCoreBootstrapFallbacks;\n\n            if (candidate && isObject(candidate)) {\n                return candidate;\n            }\n        } catch (bootstrapFallbackLookupError) {\n            void bootstrapFallbackLookupError;\n        }\n    }\n\n    return null;\n}\n\n// --- Fallback Creation ---\n\nfunction createInlineLocalizationFallbackWithResolver(options) {\n    const resolverTools =\n        options && isObject(options.bootstrapResolverTools) ?\n            options.bootstrapResolverTools :\n            null;\n\n    if (resolverTools && typeof resolverTools.createInlineLocalizationFallback === 'function') {\n        try {\n            const generated = resolverTools.createInlineLocalizationFallback(options);\n\n            if (generated && isObject(generated)) {\n                return generated;\n            }\n        } catch (localizationFallbackResolveError) {\n            void localizationFallbackResolveError;\n        }\n    }\n\n    const fallbackTools = options && isObject(options.fallbackTools) ? options.fallbackTools : null;\n\n    if (\n        fallbackTools &&\n        typeof fallbackTools.createLocalizationBootstrapFallback === 'function'\n    ) {\n        try {\n            const fallbackResult = fallbackTools.createLocalizationBootstrapFallback(options);\n\n            if (fallbackResult && isObject(fallbackResult)) {\n                return fallbackResult;\n            }\n        } catch (localizationFallbackError) {\n            void localizationFallbackError;\n        }\n    }\n\n    return createLocalizationBootstrapFallback();\n}\n\nfunction createInlineRuntimeSharedFallbackWithResolver(options) {\n    const resolverTools =\n        options && isObject(options.bootstrapResolverTools) ?\n            options.bootstrapResolverTools :\n            null;\n\n    if (resolverTools && typeof resolverTools.createInlineRuntimeSharedFallback === 'function') {\n        try {\n            const generated = resolverTools.createInlineRuntimeSharedFallback(options);\n\n            if (generated && isObject(generated)) {\n                return generated;\n            }\n        } catch (runtimeSharedFallbackResolveError) {\n            void runtimeSharedFallbackResolveError;\n        }\n    }\n\n    const fallbackTools = options && isObject(options.fallbackTools) ? options.fallbackTools : null;\n\n    if (\n        fallbackTools &&\n        typeof fallbackTools.createRuntimeSharedBootstrapFallback === 'function'\n    ) {\n        try {\n            const moduleFallback = fallbackTools.createRuntimeSharedBootstrapFallback(options);\n\n            if (moduleFallback && isObject(moduleFallback)) {\n                return moduleFallback;\n            }\n        } catch (runtimeSharedFallbackError) {\n            void runtimeSharedFallbackError;\n        }\n    }\n\n    const fallbackScopes = cineCoreAppCoreBootstrapEnvironment.collectFallbackScopes(options);\n\n    function fallbackResolveRuntimeSharedFromGlobal() {\n        for (let index = 0; index < fallbackScopes.length; index += 1) {\n            const scope = fallbackScopes[index];\n\n            if (!scope || !isObject(scope)) {\n                continue;\n            }\n\n            try {\n                const candidate = scope.cineCoreRuntimeShared;\n\n                if (candidate && isObject(candidate)) {\n                    return candidate;\n                }\n            } catch (runtimeSharedLookupError) {\n                void runtimeSharedLookupError;\n            }\n        }\n\n        return null;\n    }\n\n    let runtimeShared =\n        options && isObject(options.currentRuntimeShared) ?\n            options.currentRuntimeShared :\n            null;\n\n    if (!runtimeShared) {\n        runtimeShared = fallbackResolveRuntimeSharedFromGlobal();\n    }\n\n    if (!runtimeShared || typeof runtimeShared !== 'object') {\n        try {\n            runtimeShared = Object.create(null);\n        } catch (runtimeSharedCreationError) {\n            void runtimeSharedCreationError;\n            runtimeShared = {};\n        }\n    }\n\n    return {\n        runtimeSharedNamespace: null,\n        runtimeSharedResolver: null,\n        existingRuntimeShared: runtimeShared,\n        runtimeShared,\n        fallbackResolveRuntimeSharedFromGlobal,\n    };\n}\n\n// --- Result Creation ---\n\nfunction createLocalizationBootstrapResult(options) {\n    const localizationSupportTools =\n        options && isObject(options.localizationSupportTools) ?\n            options.localizationSupportTools :\n            null;\n    const localizationBootstrapTools =\n        options && isObject(options.localizationBootstrapTools) ?\n            options.localizationBootstrapTools :\n            null;\n    const localizationRuntimeTools =\n        options && isObject(options.localizationRuntimeTools) ?\n            options.localizationRuntimeTools :\n            null;\n    const resolveCoreSupportModuleFn =\n        options && typeof options.resolveCoreSupportModule === 'function' ?\n            options.resolveCoreSupportModule :\n            null;\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = options && isObject(options.runtimeScope) ? options.runtimeScope : null;\n    const coreGlobalScope =\n        options && isObject(options.coreGlobalScope) ? options.coreGlobalScope : null;\n    const fallbackScopes = cineCoreAppCoreBootstrapEnvironment.appendFallbackScopes(\n        ensureArray(options && options.fallbackScopes),\n        runtimeScope,\n        coreGlobalScope\n    );\n\n    const resolverOptions = {\n        localizationSupportTools,\n        resolveCoreSupportModule: resolveCoreSupportModuleFn,\n        requireFn,\n        runtimeScope,\n        coreGlobalScope,\n        fallbackScopes,\n    };\n\n    let result = attemptFactory(\n        localizationBootstrapTools &&\n        localizationBootstrapTools.createLocalizationBootstrapResult,\n        resolverOptions\n    );\n\n    if (!result) {\n        result = attemptFactory(localizationRuntimeTools && localizationRuntimeTools.resolveRuntimeLocalization, {\n            currentLocalization: options && options.currentLocalization,\n            resolveCoreSupportModule: resolveCoreSupportModuleFn,\n            requireFn,\n            runtimeScope,\n            coreGlobalScope,\n            fallbackScopes,\n        });\n    }\n\n    if (!result) {\n        result = attemptFactory(\n            localizationRuntimeTools &&\n            localizationRuntimeTools.createFallbackLocalizationRuntimeSetup, {\n            currentLocalization: options && options.currentLocalization,\n            resolveCoreSupportModule: resolveCoreSupportModuleFn,\n            requireFn,\n            runtimeScope,\n            coreGlobalScope,\n            fallbackScopes,\n        }\n        );\n    }\n\n    if (!result) {\n        result = createLocalizationBootstrapFallback();\n    }\n\n    return result;\n}\n\nfunction createRuntimeSharedBootstrapResult(options) {\n    // Basic implementation delegating to resolve logic, as primary complexity resides there.\n    // If strict parity with missing lines 1500-2000 is required, this is a best-effort reconstruction\n    // based on the pattern of createLocalizationBootstrapResult.\n\n    const result = resolveRuntimeSharedBootstrapResult(options);\n    if (result) return result;\n\n    return createRuntimeSharedBootstrapFallback(options);\n}\n\nfunction createLocalizationBootstrapFallback() {\n    return createLocalizationFallbackSkeleton();\n}\n\nfunction createRuntimeSharedBootstrapFallback(options) {\n    return createRuntimeSharedFallbackSkeleton(options);\n}\n\nfunction createInlineLocalizationFallback(options) {\n    const invocationOptions = normalizeBootstrapInvocationOptions(options);\n    const bootstrapEnvironmentTools =\n        invocationOptions.bootstrapEnvironmentTools ||\n        invocationOptions.bootstrapEnvironment ||\n        getBootstrapEnvironmentTools(invocationOptions);\n    const bootstrapResultsTools =\n        invocationOptions.bootstrapResultsTools ||\n        getBootstrapResultsTools(invocationOptions);\n    const localizationFallbackOptions =\n        invocationOptions.localizationFallbackOptions || null;\n\n    const resolverOptions = normalizeBootstrapInvocationOptions(invocationOptions, {\n        bootstrapEnvironmentTools,\n        bootstrapEnvironment: bootstrapEnvironmentTools,\n        bootstrapResultsTools,\n        fallbackScopes: invocationOptions.fallbackScopes,\n    });\n    const fallbackScopes = collectBootstrapFallbackScopes(resolverOptions);\n    resolverOptions.fallbackScopes = fallbackScopes;\n\n    const bootstrapResolverTools =\n        invocationOptions.bootstrapResolverTools || getBootstrapResolverTools(resolverOptions);\n    const fallbackTools =\n        invocationOptions.bootstrapFallbackTools ||\n        invocationOptions.fallbackTools ||\n        getBootstrapFallbackTools(resolverOptions);\n    const bootstrapSuite =\n        invocationOptions.bootstrapSuite && isObject(invocationOptions.bootstrapSuite) ?\n            invocationOptions.bootstrapSuite :\n            null;\n\n    if (\n        bootstrapResolverTools &&\n        typeof bootstrapResolverTools.createInlineLocalizationFallback === 'function'\n    ) {\n        try {\n            const generated = bootstrapResolverTools.createInlineLocalizationFallback({\n                fallbackTools,\n                resolveCoreSupportModule: invocationOptions.resolveCoreSupportModule,\n                requireFn: invocationOptions.requireFn,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                fallbackScopes,\n                localizationFallbackOptions,\n            });\n\n            if (generated && isObject(generated)) {\n                return generated;\n            }\n        } catch (localizationFallbackResolveError) {\n            void localizationFallbackResolveError;\n        }\n    }\n\n    if (\n        bootstrapSuite &&\n        typeof bootstrapSuite.createLocalizationBootstrapFallback === 'function'\n    ) {\n        try {\n            const suiteFallback = bootstrapSuite.createLocalizationBootstrapFallback({\n                fallbackScopes,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                localizationFallbackOptions,\n            });\n\n            if (suiteFallback && isObject(suiteFallback)) {\n                return suiteFallback;\n            }\n        } catch (suiteLocalizationFallbackError) {\n            void suiteLocalizationFallbackError;\n        }\n    }\n\n    if (fallbackTools && typeof fallbackTools.createLocalizationBootstrapFallback === 'function') {\n        try {\n            const fallbackResult = fallbackTools.createLocalizationBootstrapFallback({\n                resolveCoreSupportModule: invocationOptions.resolveCoreSupportModule,\n                requireFn: invocationOptions.requireFn,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                fallbackScopes,\n                localizationFallbackOptions,\n            });\n\n            if (fallbackResult && isObject(fallbackResult)) {\n                return fallbackResult;\n            }\n        } catch (localizationFallbackError) {\n            void localizationFallbackError;\n        }\n    }\n\n    if (\n        bootstrapResultsTools &&\n        typeof bootstrapResultsTools.createLocalizationFallbackSkeleton === 'function'\n    ) {\n        try {\n            const skeleton = bootstrapResultsTools.createLocalizationFallbackSkeleton();\n            if (skeleton && isObject(skeleton)) {\n                return skeleton;\n            }\n        } catch (localizationSkeletonError) {\n            void localizationSkeletonError;\n        }\n    }\n\n    return createLocalizationBootstrapFallback();\n}\n\nfunction createInlineRuntimeSharedFallback(options) {\n    const invocationOptions = normalizeBootstrapInvocationOptions(options);\n    const bootstrapEnvironmentTools =\n        invocationOptions.bootstrapEnvironmentTools ||\n        invocationOptions.bootstrapEnvironment ||\n        getBootstrapEnvironmentTools(invocationOptions);\n    const bootstrapResultsTools =\n        invocationOptions.bootstrapResultsTools ||\n        getBootstrapResultsTools(invocationOptions);\n\n    const resolverOptions = normalizeBootstrapInvocationOptions(invocationOptions, {\n        bootstrapEnvironmentTools,\n        bootstrapEnvironment: bootstrapEnvironmentTools,\n        bootstrapResultsTools,\n        fallbackScopes: invocationOptions.fallbackScopes,\n    });\n    const fallbackScopes = collectBootstrapFallbackScopes(resolverOptions);\n    resolverOptions.fallbackScopes = fallbackScopes;\n\n    const bootstrapResolverTools =\n        invocationOptions.bootstrapResolverTools || getBootstrapResolverTools(resolverOptions);\n    const fallbackTools =\n        invocationOptions.bootstrapFallbackTools ||\n        invocationOptions.fallbackTools ||\n        getBootstrapFallbackTools(resolverOptions);\n    const bootstrapSuite =\n        invocationOptions.bootstrapSuite && isObject(invocationOptions.bootstrapSuite) ?\n            invocationOptions.bootstrapSuite :\n            null;\n\n    if (\n        bootstrapResolverTools &&\n        typeof bootstrapResolverTools.createInlineRuntimeSharedFallback === 'function'\n    ) {\n        try {\n            const generated = bootstrapResolverTools.createInlineRuntimeSharedFallback({\n                fallbackTools,\n                resolveCoreSupportModule: invocationOptions.resolveCoreSupportModule,\n                requireFn: invocationOptions.requireFn,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                fallbackScopes,\n                currentRuntimeShared: invocationOptions.currentRuntimeShared,\n            });\n\n            if (generated && isObject(generated)) {\n                return generated;\n            }\n        } catch (runtimeSharedFallbackResolveError) {\n            void runtimeSharedFallbackResolveError;\n        }\n    }\n\n    if (\n        bootstrapSuite &&\n        typeof bootstrapSuite.createRuntimeSharedBootstrapFallback === 'function'\n    ) {\n        try {\n            const suiteFallback = bootstrapSuite.createRuntimeSharedBootstrapFallback({\n                fallbackScopes,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                currentRuntimeShared: invocationOptions.currentRuntimeShared,\n            });\n\n            if (suiteFallback && isObject(suiteFallback)) {\n                return suiteFallback;\n            }\n        } catch (suiteRuntimeSharedFallbackError) {\n            void suiteRuntimeSharedFallbackError;\n        }\n    }\n\n    if (fallbackTools && typeof fallbackTools.createRuntimeSharedBootstrapFallback === 'function') {\n        try {\n            const fallbackResult = fallbackTools.createRuntimeSharedBootstrapFallback({\n                resolveCoreSupportModule: invocationOptions.resolveCoreSupportModule,\n                requireFn: invocationOptions.requireFn,\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                fallbackScopes,\n                currentRuntimeShared: invocationOptions.currentRuntimeShared,\n            });\n\n            if (fallbackResult && isObject(fallbackResult)) {\n                return fallbackResult;\n            }\n        } catch (runtimeSharedFallbackError) {\n            void runtimeSharedFallbackError;\n        }\n    }\n\n    if (\n        bootstrapResultsTools &&\n        typeof bootstrapResultsTools.createRuntimeSharedFallbackSkeleton === 'function'\n    ) {\n        try {\n            const skeleton = bootstrapResultsTools.createRuntimeSharedFallbackSkeleton({\n                runtimeScope: invocationOptions.runtimeScope,\n                coreGlobalScope: invocationOptions.coreGlobalScope,\n                fallbackScopes,\n                currentRuntimeShared: invocationOptions.currentRuntimeShared,\n            });\n            if (skeleton && isObject(skeleton)) {\n                return skeleton;\n            }\n        } catch (runtimeSharedSkeletonError) {\n            void runtimeSharedSkeletonError;\n        }\n    }\n\n    return createRuntimeSharedBootstrapFallback(invocationOptions);\n}\n\n// --- Extended Bootstrap Environment ---\n\n\nfunction createBootstrapEnvironment(options) {\n    // Delegates to base environment creation but adds specific resolvers\n    const result = createBaseBootstrapEnvironment(options);\n\n    const {\n        fallbackScopes,\n        bootstrapResolverTools\n    } = result;\n\n    const bootstrapTools = resolveBootstrapToolsWithResolver({\n        directBootstrapNamespace: options && options.directBootstrapNamespace,\n        bootstrapResolverTools,\n        resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n        requireFn: options && options.requireFn,\n        runtimeScope: options && options.runtimeScope,\n        coreGlobalScope: options && options.coreGlobalScope,\n        fallbackScopes,\n    });\n\n    const bootstrapFallbackTools = resolveBootstrapFallbackToolsWithResolver({\n        directBootstrapFallbackNamespace: options && options.directBootstrapFallbackNamespace,\n        bootstrapResolverTools,\n        resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n        requireFn: options && options.requireFn,\n        runtimeScope: options && options.runtimeScope,\n        coreGlobalScope: options && options.coreGlobalScope,\n        fallbackScopes,\n    });\n\n    function createInlineLocalizationFallbackWithEnvironment() {\n        return createInlineLocalizationFallbackWithResolver({\n            bootstrapResolverTools,\n            fallbackTools: bootstrapFallbackTools,\n            resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n            requireFn: options && options.requireFn,\n            runtimeScope: options && options.runtimeScope,\n            coreGlobalScope: options && options.coreGlobalScope,\n            fallbackScopes,\n        });\n    }\n\n    function createInlineRuntimeSharedFallbackWithEnvironment(runtimeSharedOptions) {\n        const runtimeSharedFallbackScopes =\n            runtimeSharedOptions && runtimeSharedOptions.fallbackScopes ?\n                runtimeSharedOptions.fallbackScopes :\n                fallbackScopes;\n\n        return createInlineRuntimeSharedFallbackWithResolver({\n            bootstrapResolverTools,\n            fallbackTools: bootstrapFallbackTools,\n            resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n            requireFn: options && options.requireFn,\n            runtimeScope: options && options.runtimeScope,\n            coreGlobalScope: options && options.coreGlobalScope,\n            fallbackScopes: runtimeSharedFallbackScopes,\n            currentRuntimeShared: runtimeSharedOptions && isObject(runtimeSharedOptions.currentRuntimeShared) ?\n                runtimeSharedOptions.currentRuntimeShared :\n                null,\n        });\n    }\n\n    function collectAdditionalFallbackScopes(extraScopes) {\n        return cineCoreAppCoreBootstrapEnvironment.collectFallbackScopes({\n            runtimeScope: options && options.runtimeScope,\n            coreGlobalScope: options && options.coreGlobalScope,\n            fallbackScopes: extraScopes,\n        });\n    }\n\n    return {\n        fallbackScopes,\n        bootstrapResolverTools,\n        bootstrapTools,\n        bootstrapFallbackTools,\n        createInlineLocalizationFallback: createInlineLocalizationFallbackWithEnvironment,\n        createInlineRuntimeSharedFallback: createInlineRuntimeSharedFallbackWithEnvironment,\n        collectFallbackScopes: collectAdditionalFallbackScopes,\n    };\n}\n\nfunction createBootstrapSuite(options) {\n    const normalizedOptions = normalizeBootstrapInvocationOptions(options);\n    const bootstrapEnvironmentTools =\n        normalizedOptions.bootstrapEnvironmentTools ||\n        normalizedOptions.bootstrapEnvironment ||\n        getBootstrapEnvironmentTools(normalizedOptions);\n    const bootstrapResultsTools =\n        normalizedOptions.bootstrapResultsTools ||\n        getBootstrapResultsTools(normalizedOptions);\n\n    const bootstrapEnvironment = createBootstrapEnvironment(normalizedOptions);\n    const {\n        bootstrapTools,\n        bootstrapFallbackTools,\n        bootstrapResolverTools\n    } =\n        bootstrapEnvironment;\n\n    function mergeOptions(overrides) {\n        return normalizeBootstrapInvocationOptions(normalizedOptions, overrides);\n    }\n\n    function collectSuiteFallbackScopes(scopes) {\n        return bootstrapEnvironment.collectFallbackScopes(scopes);\n    }\n\n    function createBootstrapEnvironmentWithSuite(environmentOptions) {\n        const environmentInvocationOptions = mergeOptions(environmentOptions);\n        return createBootstrapEnvironment(environmentInvocationOptions);\n    }\n\n    function createLocalizationBootstrapResultWithSuite(resultOptions) {\n        const invocationOptions = mergeOptions(resultOptions);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(resultOptions);\n\n        if (!invocationOptions.bootstrapTools && bootstrapTools) {\n            invocationOptions.bootstrapTools = bootstrapTools;\n        }\n\n        if (!invocationOptions.bootstrapFallbackTools && bootstrapFallbackTools) {\n            invocationOptions.bootstrapFallbackTools = bootstrapFallbackTools;\n        }\n\n        if (\n            bootstrapResultsTools &&\n            typeof bootstrapResultsTools.resolveLocalizationBootstrapResult === 'function'\n        ) {\n            try {\n                const resolved = bootstrapResultsTools.resolveLocalizationBootstrapResult(invocationOptions);\n\n                if (resolved && isObject(resolved)) {\n                    return resolved;\n                }\n            } catch (localizationResolveError) {\n                void localizationResolveError;\n            }\n        }\n\n        return resolveLocalizationBootstrapResult(invocationOptions);\n    }\n\n    function createLocalizationBootstrapFallbackWithSuite(fallbackOptions) {\n        const invocationOptions = mergeOptions(fallbackOptions);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(fallbackOptions);\n\n        if (fallbackOptions && fallbackOptions.createInlineLocalizationFallback) {\n            invocationOptions.createInlineLocalizationFallback =\n                fallbackOptions.createInlineLocalizationFallback;\n        } else {\n            invocationOptions.createInlineLocalizationFallback =\n                bootstrapEnvironment.createInlineLocalizationFallback;\n        }\n\n        if (\n            bootstrapResultsTools &&\n            typeof bootstrapResultsTools.createLocalizationFallbackSkeleton === 'function'\n        ) {\n            try {\n                const skeleton = bootstrapResultsTools.createLocalizationFallbackSkeleton(invocationOptions);\n                if (skeleton && isObject(skeleton)) {\n                    return skeleton;\n                }\n            } catch (localizationSkeletonError) {\n                void localizationSkeletonError;\n            }\n        }\n\n        return createInlineLocalizationFallback(invocationOptions);\n    }\n\n    function createRuntimeSharedBootstrapResultWithSuite(resultOptions) {\n        const invocationOptions = mergeOptions(resultOptions);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(resultOptions);\n\n        if (!invocationOptions.bootstrapTools && bootstrapTools) {\n            invocationOptions.bootstrapTools = bootstrapTools;\n        }\n\n        if (!invocationOptions.bootstrapFallbackTools && bootstrapFallbackTools) {\n            invocationOptions.bootstrapFallbackTools = bootstrapFallbackTools;\n        }\n\n        if (!invocationOptions.createInlineRuntimeSharedFallback) {\n            invocationOptions.createInlineRuntimeSharedFallback =\n                (bootstrapEnvironmentTools &&\n                    typeof bootstrapEnvironmentTools.createInlineRuntimeSharedFallback === 'function' ?\n                    bootstrapEnvironmentTools.createInlineRuntimeSharedFallback :\n                    null) ||\n                (bootstrapTools && typeof bootstrapTools.createInlineRuntimeSharedFallback === 'function' ?\n                    bootstrapTools.createInlineRuntimeSharedFallback :\n                    createInlineRuntimeSharedFallback);\n        }\n\n        if (\n            bootstrapResultsTools &&\n            typeof bootstrapResultsTools.resolveRuntimeSharedBootstrapResult === 'function'\n        ) {\n            try {\n                const resolved = bootstrapResultsTools.resolveRuntimeSharedBootstrapResult(invocationOptions);\n\n                if (resolved && isObject(resolved)) {\n                    return resolved;\n                }\n            } catch (runtimeSharedResolveError) {\n                void runtimeSharedResolveError;\n            }\n        }\n\n        return resolveRuntimeSharedBootstrapResult(invocationOptions);\n    }\n\n    function createRuntimeSharedBootstrapFallbackWithSuite(fallbackOptions) {\n        const invocationOptions = mergeOptions(fallbackOptions);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(fallbackOptions);\n\n        if (\n            bootstrapResultsTools &&\n            typeof bootstrapResultsTools.createRuntimeSharedFallbackSkeleton === 'function'\n        ) {\n            try {\n                const skeleton = bootstrapResultsTools.createRuntimeSharedFallbackSkeleton(invocationOptions);\n\n                if (skeleton && isObject(skeleton)) {\n                    return skeleton;\n                }\n            } catch (runtimeSharedFallbackSkeletonError) {\n                void runtimeSharedFallbackSkeletonError;\n            }\n        }\n\n        if (\n            bootstrapFallbackTools &&\n            typeof bootstrapFallbackTools.createRuntimeSharedBootstrapFallback === 'function'\n        ) {\n            try {\n                const generated = bootstrapFallbackTools.createRuntimeSharedBootstrapFallback(invocationOptions);\n\n                if (generated && isObject(generated)) {\n                    return generated;\n                }\n            } catch (runtimeSharedFallbackError) {\n                void runtimeSharedFallbackError;\n            }\n        }\n\n        return createRuntimeSharedBootstrapFallback(invocationOptions);\n    }\n\n    function createInlineLocalizationFallbackWithSuite(options) {\n        const invocationOptions = mergeOptions(options);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(options);\n\n        if (!invocationOptions.fallbackTools && bootstrapFallbackTools) {\n            invocationOptions.fallbackTools = bootstrapFallbackTools;\n        }\n\n        return createInlineLocalizationFallback(invocationOptions);\n    }\n\n    function createInlineRuntimeSharedFallbackWithSuite(options) {\n        const invocationOptions = mergeOptions(options);\n        invocationOptions.fallbackScopes = collectSuiteFallbackScopes(options);\n\n        if (!invocationOptions.fallbackTools && bootstrapFallbackTools) {\n            invocationOptions.fallbackTools = bootstrapFallbackTools;\n        }\n\n        return createInlineRuntimeSharedFallback(invocationOptions);\n    }\n\n    const suite = {\n        bootstrapTools,\n        bootstrapFallbackTools,\n        bootstrapEnvironmentTools,\n        bootstrapResultsTools,\n        collectBootstrapFallbackScopes: collectSuiteFallbackScopes,\n        createBootstrapEnvironment: createBootstrapEnvironmentWithSuite,\n        createLocalizationBootstrapResult: createLocalizationBootstrapResultWithSuite,\n        createLocalizationBootstrapFallback: createLocalizationBootstrapFallbackWithSuite,\n        createRuntimeSharedBootstrapResult: createRuntimeSharedBootstrapResultWithSuite,\n        createRuntimeSharedBootstrapFallback: createRuntimeSharedBootstrapFallbackWithSuite,\n        createInlineLocalizationFallback: createInlineLocalizationFallbackWithSuite,\n        createInlineRuntimeSharedFallback: createInlineRuntimeSharedFallbackWithSuite,\n        resolveBootstrapTools,\n        resolveBootstrapFallbackTools,\n        resolveBootstrapEnvironmentTools,\n        resolveBootstrapResultsTools,\n    };\n\n    try {\n        suite.bootstrapEnvironment = createBootstrapEnvironmentWithSuite(\n            normalizedOptions.bootstrapEnvironmentOptions || null\n        );\n    } catch (bootstrapEnvironmentError) {\n        void bootstrapEnvironmentError;\n        suite.bootstrapEnvironment = null;\n    }\n\n    return suite;\n}\n\nexport const cineCoreAppCoreBootstrap = {\n    createLocalizationBootstrapResult,\n    createLocalizationBootstrapFallback,\n    createRuntimeSharedBootstrapResult,\n    createRuntimeSharedBootstrapFallback,\n    normalizeBootstrapInvocationOptions,\n    collectBootstrapFallbackScopes,\n    resolveBootstrapTools,\n    resolveBootstrapFallbackTools,\n    resolveBootstrapEnvironmentTools,\n    resolveBootstrapResultsTools,\n    createInlineLocalizationFallback,\n    createInlineRuntimeSharedFallback,\n    createBootstrapSuite,\n    resolveBootstrapResolverTools,\n    createBootstrapEnvironment,\n};\n","import { cineCoreAppCoreBootstrap } from '../../../modules/core/bootstrap.js';\nimport { cineCoreAppCoreBootstrapEnvironment } from '../../../modules/core/bootstrap-environment.js';\nimport { cineCoreAppCoreBootstrapResults } from '../../../modules/core/bootstrap-results.js';\nimport { safeAssign } from '../../../modules/helpers/scope-utils.js';\n\nexport { cineCoreAppCoreBootstrap };\nexport { cineCoreAppCoreBootstrapEnvironment };\nexport { cineCoreAppCoreBootstrapResults };\n\nexport const cineCoreAppCoreBootstrapFallbacks = {\n  createLocalizationBootstrapFallback: cineCoreAppCoreBootstrap.createLocalizationBootstrapFallback,\n  createRuntimeSharedBootstrapFallback: cineCoreAppCoreBootstrap.createRuntimeSharedBootstrapFallback\n};\n\nexport const cineCoreAppCoreBootstrapResolver = {\n  resolveBootstrapTools: cineCoreAppCoreBootstrap.resolveBootstrapTools,\n  resolveBootstrapFallbackTools: cineCoreAppCoreBootstrap.resolveBootstrapFallbackTools,\n  resolveBootstrapEnvironmentTools: cineCoreAppCoreBootstrap.resolveBootstrapEnvironmentTools,\n  resolveBootstrapResultsTools: cineCoreAppCoreBootstrap.resolveBootstrapResultsTools,\n  resolveBootstrapResolverTools: cineCoreAppCoreBootstrap.resolveBootstrapResolverTools,\n  createInlineLocalizationFallback: cineCoreAppCoreBootstrap.createInlineLocalizationFallback,\n  createInlineRuntimeSharedFallback: cineCoreAppCoreBootstrap.createInlineRuntimeSharedFallback,\n  createBootstrapSuite: cineCoreAppCoreBootstrap.createBootstrapSuite,\n  normalizeBootstrapInvocationOptions: cineCoreAppCoreBootstrap.normalizeBootstrapInvocationOptions,\n  collectBootstrapFallbackScopes: cineCoreAppCoreBootstrap.collectBootstrapFallbackScopes\n};\n\n// Global Injection for backward compatibility\n(function injectGlobals() {\n  const globalScope =\n    (typeof globalThis !== 'undefined' && globalThis) ||\n    (typeof window !== 'undefined' && window) ||\n    (typeof self !== 'undefined' && self) ||\n    (typeof global !== 'undefined' && global) ||\n    {};\n\n  safeAssign(globalScope, 'cineCoreAppCoreBootstrap', cineCoreAppCoreBootstrap);\n  safeAssign(globalScope, 'cineCoreAppCoreBootstrapFallbacks', cineCoreAppCoreBootstrapFallbacks);\n  safeAssign(globalScope, 'cineCoreAppCoreBootstrapEnvironment', cineCoreAppCoreBootstrapEnvironment);\n  safeAssign(globalScope, 'cineCoreAppCoreBootstrapResults', cineCoreAppCoreBootstrapResults);\n  safeAssign(globalScope, 'cineCoreAppCoreBootstrapResolver', cineCoreAppCoreBootstrapResolver);\n})();\n\n","/*\n * Aggregates the modern app core localisation helpers into a single module.\n *\n * The refactor previously split the legacy app-core localisation section into\n * several files so the massive diff stayed readable. We are now consolidating\n * those helpers again so that the refactor can continue in smaller, coherent\n * chunks. Keeping the logic together ensures the translation bridge, runtime\n * fallbacks and offline safeguards remain perfectly aligned. This file simply\n * concatenates the previous modules verbatim so behaviour stays identical while\n * reducing the number of moving parts we need to keep in sync.\n */\n\n// ES Module exports - expose the global namespace objects for ES module imports\n// [Agent Fix] Moved to top to avoid ReferenceError/TDZ issues\nconst _globalScope = typeof globalThis !== 'undefined' ? globalThis :\n  typeof window !== 'undefined' ? window :\n    typeof self !== 'undefined' ? self :\n      typeof global !== 'undefined' ? global : {};\n\n// Ensure globals are initialized immediately so exports are valid\n_globalScope.cineCoreAppLocalizationSupport = _globalScope.cineCoreAppLocalizationSupport || {};\n_globalScope.cineCoreAppLocalizationBootstrap = _globalScope.cineCoreAppLocalizationBootstrap || {};\n_globalScope.cineCoreAppRuntimeLocalization = _globalScope.cineCoreAppRuntimeLocalization || {};\n_globalScope.cineCoreAppLocalizationAccessors = _globalScope.cineCoreAppLocalizationAccessors || {};\n\nexport const cineCoreAppLocalizationSupport = _globalScope.cineCoreAppLocalizationSupport;\nexport const cineCoreAppLocalizationBootstrap = _globalScope.cineCoreAppLocalizationBootstrap;\nexport const cineCoreAppRuntimeLocalization = _globalScope.cineCoreAppRuntimeLocalization;\nexport const cineCoreAppLocalizationAccessors = _globalScope.cineCoreAppLocalizationAccessors;\n\n/*\n * Centralises the localisation bootstrap logic used by the modern runtime.\n *\n * The previous monolithic app core contained a large block of setup code that\n * resolved the localisation runtime environment, fallbacks and helper\n * factories. As part of the ongoing refactor we expose that logic as a\n * dedicated helper module so the main runtime file can stay leaner while the\n * behaviour remains identical.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectGlobalScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const globalScope = detectGlobalScope(runtimeScope);\n\n    if (\n      isObject(globalScope) &&\n      typeof globalScope.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return globalScope.resolveCoreSupportModule.bind(globalScope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      isObject(globalScope) &&\n      globalScope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof globalScope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        .resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return globalScope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          globalScope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return function unresolvedSupportModule() {\n      return null;\n    };\n  }\n\n  function ensureScope(candidate, fallbackScope) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectGlobalScope(fallbackScope);\n  }\n\n  function createAppLocalizationSupport(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const localizationRuntimeEnvironmentTools = resolveCoreSupportModule(\n      'cineCoreLocalizationRuntimeEnvironment',\n      '../core/localization-runtime-environment.js'\n    );\n\n    const localizationRuntimeEnvironment =\n      localizationRuntimeEnvironmentTools &&\n        typeof localizationRuntimeEnvironmentTools.createLocalizationRuntimeEnvironment ===\n        'function'\n        ? localizationRuntimeEnvironmentTools.createLocalizationRuntimeEnvironment({\n          resolveCoreSupportModule,\n          requireFn,\n          runtimeScope,\n          coreGlobalScope,\n        })\n        : null;\n\n    const localizationBridge =\n      localizationRuntimeEnvironment &&\n        isObject(localizationRuntimeEnvironment.coreLocalizationBridge)\n        ? localizationRuntimeEnvironment.coreLocalizationBridge\n        : null;\n\n    const localizationFallbacks =\n      localizationRuntimeEnvironment &&\n        isObject(localizationRuntimeEnvironment.coreLocalizationFallbacks)\n        ? localizationRuntimeEnvironment.coreLocalizationFallbacks\n        : null;\n\n    const inlineLocalizationFallbacks =\n      localizationRuntimeEnvironment &&\n        isObject(localizationRuntimeEnvironment.coreInlineLocalizationFallbacks)\n        ? localizationRuntimeEnvironment.coreInlineLocalizationFallbacks\n        : null;\n\n    const localizationFallbackSupport =\n      localizationRuntimeEnvironment &&\n        typeof localizationRuntimeEnvironment.localizationFallbackSupport !== 'undefined'\n        ? localizationRuntimeEnvironment.localizationFallbackSupport\n        : null;\n\n    const createBasicLocalizationFallbackResolvers =\n      localizationRuntimeEnvironment &&\n        typeof localizationRuntimeEnvironment.createBasicLocalizationFallbackResolvers ===\n        'function'\n        ? localizationRuntimeEnvironment.createBasicLocalizationFallbackResolvers\n        : function createBasicLocalizationFallbackResolversProxy() {\n          return null;\n        };\n\n    const localizationFallbackRegistry =\n      localizationRuntimeEnvironment &&\n        isObject(localizationRuntimeEnvironment.localizationFallbackRegistry)\n        ? localizationRuntimeEnvironment.localizationFallbackRegistry\n        : {\n          createFallbackResolvers(fallbackOptions) {\n            return createBasicLocalizationFallbackResolvers(fallbackOptions);\n          },\n        };\n\n    const localizationFallbackResolvers =\n      localizationRuntimeEnvironment &&\n        isObject(localizationRuntimeEnvironment.localizationFallbackResolvers)\n        ? localizationRuntimeEnvironment.localizationFallbackResolvers\n        : localizationFallbackRegistry &&\n          typeof localizationFallbackRegistry.createFallbackResolvers === 'function'\n          ? localizationFallbackRegistry.createFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          })\n          : createBasicLocalizationFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          });\n\n    const localizationFallbackNamespace =\n      localizationRuntimeEnvironment &&\n        typeof localizationRuntimeEnvironment.localizationFallbackNamespace !== 'undefined'\n        ? localizationRuntimeEnvironment.localizationFallbackNamespace\n        : null;\n\n    const fallbackResolveLocaleModule =\n      localizationRuntimeEnvironment &&\n        typeof localizationRuntimeEnvironment.fallbackResolveLocaleModule === 'function'\n        ? localizationRuntimeEnvironment.fallbackResolveLocaleModule\n        : function fallbackResolveLocaleModuleProxy() {\n          return null;\n        };\n\n    const createLocaleFallbacks =\n      localizationRuntimeEnvironment &&\n        typeof localizationRuntimeEnvironment.createLocaleFallbacks === 'function'\n        ? localizationRuntimeEnvironment.createLocaleFallbacks\n        : function createLocaleFallbacksProxy() {\n          return null;\n        };\n\n    return {\n      localizationRuntimeEnvironment,\n      localizationBridge,\n      localizationFallbacks,\n      inlineLocalizationFallbacks,\n      localizationFallbackSupport,\n      createBasicLocalizationFallbackResolvers,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers,\n      localizationFallbackNamespace,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n    };\n  }\n\n  const namespace = {\n    createAppLocalizationSupport,\n  };\n\n  const globalScope = detectGlobalScope();\n  const namespaceName = 'cineCoreAppLocalizationSupport';\n  const existing = isObject(globalScope) && isObject(globalScope[namespaceName])\n    ? globalScope[namespaceName]\n    : {};\n\n  for (const key of Object.keys(namespace)) {\n    existing[key] = namespace[key];\n  }\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Centralises the localisation bootstrap wiring for the modern runtime. The\n * original app-core file contained an enormous sequence of guards and\n * fallbacks; this module now owns that logic so the core orchestrator can stay\n * readable while we continue the multi-step refactor. The resolver keeps every\n * existing safeguard intact so localisation continues to function offline and\n * during backup restores.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureScope(candidate, fallback) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectScope(fallback);\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const scope = ensureScope(runtimeScope);\n\n    if (scope && typeof scope.resolveCoreSupportModule === 'function') {\n      try {\n        return scope.resolveCoreSupportModule.bind(scope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      scope &&\n      scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return function unresolvedSupportModule() {\n      return null;\n    };\n  }\n\n  function registerScope(scopes, scope) {\n    if (!isObject(scope)) {\n      return;\n    }\n\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  function ensureFallbackScopes(candidateScopes, runtimeScope, coreGlobalScope) {\n    const scopes = Array.isArray(candidateScopes) ? candidateScopes.slice() : [];\n    registerScope(scopes, runtimeScope);\n    registerScope(scopes, coreGlobalScope);\n    registerScope(scopes, typeof globalThis !== 'undefined' ? globalThis : null);\n    registerScope(scopes, typeof window !== 'undefined' ? window : null);\n    registerScope(scopes, typeof self !== 'undefined' ? self : null);\n    registerScope(scopes, typeof global !== 'undefined' ? global : null);\n    return scopes;\n  }\n\n  function resolveLocalizationSupportTools(options) {\n    if (options && isObject(options.localizationSupportTools)) {\n      return options.localizationSupportTools;\n    }\n\n    const resolveCoreSupportModule =\n      options && typeof options.resolveCoreSupportModule === 'function'\n        ? options.resolveCoreSupportModule\n        : null;\n\n    if (resolveCoreSupportModule) {\n      try {\n        const resolved = resolveCoreSupportModule(\n          'cineCoreAppLocalizationSupport',\n          './modules/app-core/localization-fixed.js'\n        );\n        if (isObject(resolved)) {\n          return resolved;\n        }\n      } catch (localizationSupportResolveError) {\n        void localizationSupportResolveError;\n      }\n    }\n\n    const requireFn = ensureRequireFn(options && options.requireFn);\n\n    if (typeof requireFn === 'function') {\n      try {\n        const required = requireFn('./modules/app-core/localization-fixed.js');\n        if (isObject(required)) {\n          return required;\n        }\n      } catch (localizationSupportRequireError) {\n        void localizationSupportRequireError;\n      }\n    }\n\n    const fallbackScopes = ensureFallbackScopes(\n      options && options.fallbackScopes,\n      options && options.runtimeScope,\n      options && options.coreGlobalScope\n    );\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppLocalizationSupport;\n        if (isObject(candidate)) {\n          return candidate;\n        }\n      } catch (localizationSupportLookupError) {\n        void localizationSupportLookupError;\n      }\n    }\n\n    return null;\n  }\n\n  function createLocalizationSupport(options) {\n    const supportTools = resolveLocalizationSupportTools(options);\n\n    if (\n      supportTools &&\n      typeof supportTools.createAppLocalizationSupport === 'function'\n    ) {\n      try {\n        return supportTools.createAppLocalizationSupport({\n          resolveCoreSupportModule: options && options.resolveCoreSupportModule,\n          requireFn: options && options.requireFn,\n          runtimeScope: options && options.runtimeScope,\n          coreGlobalScope: options && options.coreGlobalScope,\n        });\n      } catch (localizationSupportError) {\n        void localizationSupportError;\n      }\n    }\n\n    return null;\n  }\n\n  function createLocalizationBootstrapResult(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const fallbackScopes = ensureFallbackScopes(\n      options && options.fallbackScopes,\n      runtimeScope,\n      coreGlobalScope\n    );\n\n    const localizationSupport = createLocalizationSupport({\n      localizationSupportTools: options && options.localizationSupportTools,\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n      fallbackScopes,\n    });\n\n    const localizationRuntimeEnvironment =\n      localizationSupport && localizationSupport.localizationRuntimeEnvironment\n        ? localizationSupport.localizationRuntimeEnvironment\n        : null;\n\n    const localizationBridge =\n      localizationSupport && localizationSupport.localizationBridge\n        ? localizationSupport.localizationBridge\n        : null;\n\n    const localizationFallbacks =\n      localizationSupport && localizationSupport.localizationFallbacks\n        ? localizationSupport.localizationFallbacks\n        : null;\n\n    const inlineLocalizationFallbacks =\n      localizationSupport && localizationSupport.inlineLocalizationFallbacks\n        ? localizationSupport.inlineLocalizationFallbacks\n        : null;\n\n    const localizationFallbackSupport =\n      localizationSupport &&\n        typeof localizationSupport.localizationFallbackSupport !== 'undefined'\n        ? localizationSupport.localizationFallbackSupport\n        : null;\n\n    const createBasicLocalizationFallbackResolvers =\n      localizationSupport &&\n        typeof localizationSupport.createBasicLocalizationFallbackResolvers === 'function'\n        ? localizationSupport.createBasicLocalizationFallbackResolvers\n        : function createBasicLocalizationFallbackResolversProxy() {\n          return null;\n        };\n\n    const localizationFallbackRegistry =\n      localizationSupport && localizationSupport.localizationFallbackRegistry\n        ? localizationSupport.localizationFallbackRegistry\n        : {\n          createFallbackResolvers(fallbackOptions) {\n            return createBasicLocalizationFallbackResolvers(fallbackOptions);\n          },\n        };\n\n    const localizationFallbackResolvers =\n      localizationSupport && localizationSupport.localizationFallbackResolvers\n        ? localizationSupport.localizationFallbackResolvers\n        : localizationFallbackRegistry &&\n          typeof localizationFallbackRegistry.createFallbackResolvers === 'function'\n          ? localizationFallbackRegistry.createFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          })\n          : createBasicLocalizationFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          });\n\n    const localizationFallbackNamespace =\n      localizationSupport &&\n        typeof localizationSupport.localizationFallbackNamespace !== 'undefined'\n        ? localizationSupport.localizationFallbackNamespace\n        : null;\n\n    const fallbackResolveLocaleModule =\n      localizationSupport &&\n        typeof localizationSupport.fallbackResolveLocaleModule === 'function'\n        ? localizationSupport.fallbackResolveLocaleModule\n        : function fallbackResolveLocaleModuleProxy() {\n          return null;\n        };\n\n    const createLocaleFallbacks =\n      localizationSupport &&\n        typeof localizationSupport.createLocaleFallbacks === 'function'\n        ? localizationSupport.createLocaleFallbacks\n        : function createLocaleFallbacksProxy() {\n          return null;\n        };\n\n    return {\n      localizationSupport,\n      localizationRuntimeEnvironment,\n      localizationBridge,\n      localizationFallbacks,\n      inlineLocalizationFallbacks,\n      localizationFallbackSupport,\n      createBasicLocalizationFallbackResolvers,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers,\n      localizationFallbackNamespace,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n    };\n  }\n\n  function createLocalizationBootstrapWiring(options) {\n    const bootstrapResult =\n      options && isObject(options.localizationBootstrapResult)\n        ? options.localizationBootstrapResult\n        : null;\n\n    const localizationSupport =\n      bootstrapResult && isObject(bootstrapResult.localizationSupport)\n        ? bootstrapResult.localizationSupport\n        : null;\n\n    const localizationRuntimeEnvironment =\n      bootstrapResult && isObject(bootstrapResult.localizationRuntimeEnvironment)\n        ? bootstrapResult.localizationRuntimeEnvironment\n        : null;\n\n    const localizationBridge =\n      bootstrapResult && isObject(bootstrapResult.localizationBridge)\n        ? bootstrapResult.localizationBridge\n        : null;\n\n    const localizationFallbacks =\n      bootstrapResult && isObject(bootstrapResult.localizationFallbacks)\n        ? bootstrapResult.localizationFallbacks\n        : null;\n\n    const inlineLocalizationFallbacks =\n      bootstrapResult && isObject(bootstrapResult.inlineLocalizationFallbacks)\n        ? bootstrapResult.inlineLocalizationFallbacks\n        : null;\n\n    const localizationFallbackSupport =\n      bootstrapResult &&\n        typeof bootstrapResult.localizationFallbackSupport !== 'undefined'\n        ? bootstrapResult.localizationFallbackSupport\n        : null;\n\n    const createBasicLocalizationFallbackResolvers =\n      bootstrapResult &&\n        typeof bootstrapResult.createBasicLocalizationFallbackResolvers === 'function'\n        ? bootstrapResult.createBasicLocalizationFallbackResolvers\n        : function createBasicLocalizationFallbackResolversProxy() {\n          return null;\n        };\n\n    const localizationFallbackRegistry =\n      bootstrapResult && isObject(bootstrapResult.localizationFallbackRegistry)\n        ? bootstrapResult.localizationFallbackRegistry\n        : {\n          createFallbackResolvers(fallbackOptions) {\n            return createBasicLocalizationFallbackResolvers(fallbackOptions);\n          },\n        };\n\n    const localizationFallbackResolvers =\n      bootstrapResult && isObject(bootstrapResult.localizationFallbackResolvers)\n        ? bootstrapResult.localizationFallbackResolvers\n        : localizationFallbackRegistry &&\n          typeof localizationFallbackRegistry.createFallbackResolvers === 'function'\n          ? localizationFallbackRegistry.createFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          })\n          : createBasicLocalizationFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          });\n\n    const localizationFallbackNamespace =\n      bootstrapResult &&\n        typeof bootstrapResult.localizationFallbackNamespace !== 'undefined'\n        ? bootstrapResult.localizationFallbackNamespace\n        : null;\n\n    const fallbackResolveLocaleModule =\n      bootstrapResult &&\n        typeof bootstrapResult.fallbackResolveLocaleModule === 'function'\n        ? bootstrapResult.fallbackResolveLocaleModule\n        : function fallbackResolveLocaleModuleProxy() {\n          return null;\n        };\n\n    const createLocaleFallbacks =\n      bootstrapResult && typeof bootstrapResult.createLocaleFallbacks === 'function'\n        ? bootstrapResult.createLocaleFallbacks\n        : function createLocaleFallbacksProxy() {\n          return null;\n        };\n\n    return {\n      localizationBootstrapResult: bootstrapResult,\n      localizationSupport,\n      localizationRuntimeEnvironment,\n      localizationBridge,\n      localizationFallbacks,\n      inlineLocalizationFallbacks,\n      localizationFallbackSupport,\n      createBasicLocalizationFallbackResolvers,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers,\n      localizationFallbackNamespace,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n    };\n  }\n\n  const namespace = {\n    createLocalizationBootstrapResult,\n    createLocalizationBootstrapWiring,\n  };\n\n  const globalScope = detectScope();\n  const namespaceName = 'cineCoreAppLocalizationBootstrap';\n  const existing =\n    isObject(globalScope) && isObject(globalScope[namespaceName])\n      ? globalScope[namespaceName]\n      : {};\n\n  Object.assign(existing, namespace);\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Provides localisation helper accessors for the modern Cine Power Planner runtime.\n *\n * The logic used to live directly in the monolithic app core file. Extracting it\n * into this dedicated helper keeps the orchestration lean while preserving every\n * fallback that protects offline usage, localisation data and translation safety.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function collectFallbackScopes(primaryScope, secondaryScope, additionalScopes) {\n    const scopes = [];\n    const seen = typeof Set === 'function' ? new Set() : null;\n\n    function register(scope) {\n      if (!isObject(scope)) {\n        return;\n      }\n\n      if (seen) {\n        if (seen.has(scope)) {\n          return;\n        }\n\n        seen.add(scope);\n        scopes.push(scope);\n        return;\n      }\n\n      if (scopes.indexOf(scope) !== -1) {\n        return;\n      }\n\n      scopes.push(scope);\n    }\n\n    register(primaryScope);\n    register(secondaryScope);\n\n    if (Array.isArray(additionalScopes)) {\n      for (let index = 0; index < additionalScopes.length; index += 1) {\n        register(additionalScopes[index]);\n      }\n    }\n\n    register(typeof globalThis !== 'undefined' ? globalThis : null);\n    register(typeof window !== 'undefined' ? window : null);\n    register(typeof self !== 'undefined' ? self : null);\n    register(typeof global !== 'undefined' ? global : null);\n\n    return scopes;\n  }\n\n  function fallbackNormalizeLanguageCodeFactory(defaultLanguage) {\n    const fallbackLang =\n      typeof defaultLanguage === 'string' && defaultLanguage ? defaultLanguage : 'en';\n\n    return function fallbackNormalizeLanguageCodeProxy(lang) {\n      if (!lang) {\n        return fallbackLang;\n      }\n\n      try {\n        const normalized = String(lang).trim().toLowerCase();\n        return normalized || fallbackLang;\n      } catch (languageNormalizeError) {\n        void languageNormalizeError;\n      }\n\n      return fallbackLang;\n    };\n  }\n\n  function fallbackIsRtlLanguageFactory(rtlLanguageCodes, normalizeLanguageCode) {\n    const rtlCodes =\n      Array.isArray(rtlLanguageCodes) && rtlLanguageCodes.length\n        ? rtlLanguageCodes\n        : ['ar', 'fa', 'he', 'ur'];\n\n    return function fallbackIsRtlLanguageProxy(lang) {\n      const normalized = normalizeLanguageCode(lang);\n      const base = normalized.split('-')[0];\n      return rtlCodes.indexOf(base) !== -1;\n    };\n  }\n\n  function fallbackResolveDocumentDirectionFactory(normalizeLanguageCode, isRtlLanguage) {\n    return function fallbackResolveDocumentDirectionProxy(lang) {\n      if (typeof document !== 'undefined' && document && document.documentElement) {\n        try {\n          const docDir = document.documentElement.getAttribute('dir');\n          if (docDir) {\n            return docDir;\n          }\n        } catch (resolveDirectionError) {\n          void resolveDirectionError;\n        }\n      }\n\n      return isRtlLanguage(lang) ? 'rtl' : 'ltr';\n    };\n  }\n\n  function fallbackApplyLocaleMetadataProxy(target, lang, direction) {\n    if (!target) {\n      return;\n    }\n\n    if (lang) {\n      try {\n        target.lang = lang;\n      } catch (setLangError) {\n        void setLangError;\n      }\n    }\n\n    if (direction) {\n      try {\n        target.dir = direction;\n      } catch (setDirError) {\n        void setDirError;\n      }\n    }\n  }\n\n  function fallbackResolveTranslationDatasetFactory(\n    fallbackScopes,\n    requireFn,\n    translationsRequirePath\n  ) {\n    return function fallbackResolveTranslationDataset() {\n      for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n        if (!isObject(scope)) {\n          continue;\n        }\n\n        const dataset = scope.texts;\n        if (isObject(dataset)) {\n          return dataset;\n        }\n      }\n\n      if (typeof requireFn === 'function') {\n        try {\n          const translationsModule = requireFn(translationsRequirePath);\n          if (\n            isObject(translationsModule) &&\n            isObject(translationsModule.texts)\n          ) {\n            return translationsModule.texts;\n          }\n        } catch (translationRequireError) {\n          void translationRequireError;\n        }\n      }\n\n      return {};\n    };\n  }\n\n  function fallbackGetLanguageTextsFactory(datasetResolver, defaultLanguage) {\n    const fallbackLang =\n      typeof defaultLanguage === 'string' && defaultLanguage ? defaultLanguage : 'en';\n\n    return function fallbackGetLanguageTextsProxy(lang) {\n      const dataset = datasetResolver();\n\n      let normalized = null;\n      if (typeof lang === 'string' && lang) {\n        try {\n          normalized = String(lang).trim().toLowerCase();\n        } catch (normalizeError) {\n          void normalizeError;\n          normalized = null;\n        }\n      }\n\n      let resolved =\n        normalized && Object.prototype.hasOwnProperty.call(dataset, normalized)\n          ? normalized\n          : '';\n\n      if (!resolved && normalized) {\n        const base = normalized.split('-')[0];\n        if (base && Object.prototype.hasOwnProperty.call(dataset, base)) {\n          resolved = base;\n        }\n      }\n\n      if (!resolved) {\n        resolved = fallbackLang;\n      }\n\n      const candidate =\n        dataset && resolved && isObject(dataset[resolved]) ? dataset[resolved] : null;\n      if (candidate) {\n        return candidate;\n      }\n\n      if (resolved !== fallbackLang) {\n        const fallbackCandidate =\n          dataset && isObject(dataset[fallbackLang]) ? dataset[fallbackLang] : null;\n        if (fallbackCandidate) {\n          return fallbackCandidate;\n        }\n      }\n\n      if (dataset && isObject(dataset.en)) {\n        return dataset.en;\n      }\n\n      const languages = dataset ? Object.keys(dataset) : [];\n      if (languages.length) {\n        const firstLang = languages[0];\n        const firstTexts = dataset[firstLang];\n        if (isObject(firstTexts)) {\n          return firstTexts;\n        }\n      }\n\n      return {};\n    };\n  }\n\n  function createEnsureGlobalGetLanguageTextsAvailability(runtime, fallbackScopes) {\n    return function ensureGlobalGetLanguageTextsAvailability(getLanguageTextsFn) {\n      if (\n        runtime &&\n        typeof runtime.ensureGlobalGetLanguageTextsAvailability === 'function'\n      ) {\n        try {\n          runtime.ensureGlobalGetLanguageTextsAvailability();\n          return;\n        } catch (ensureError) {\n          void ensureError;\n        }\n      }\n\n      const assignableFunction =\n        typeof getLanguageTextsFn === 'function'\n          ? getLanguageTextsFn\n          : function defaultGetLanguageTexts() {\n            return {};\n          };\n\n      for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n        if (!isObject(scope)) {\n          continue;\n        }\n\n        if (typeof scope.getLanguageTexts !== 'function') {\n          try {\n            scope.getLanguageTexts = assignableFunction;\n          } catch (assignError) {\n            void assignError;\n          }\n        }\n      }\n    };\n  }\n\n  function createLocalizationAccessors(options) {\n    const runtime = isObject(options && options.coreLocalizationRuntime)\n      ? options.coreLocalizationRuntime\n      : null;\n    const localizationBridge = isObject(options && options.coreLocalizationBridge)\n      ? options.coreLocalizationBridge\n      : null;\n    const runtimeScope = options && options.corePartRuntimeScope;\n    const coreGlobalScope = options && options.coreGlobalScope;\n    const additionalScopes = options && options.additionalLocalizationScopes;\n    const fallbackResolveLocaleModule =\n      options && typeof options.fallbackResolveLocaleModule === 'function'\n        ? options.fallbackResolveLocaleModule\n        : null;\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const translationsRequirePath =\n      options && typeof options.translationsRequirePath === 'string' && options.translationsRequirePath\n        ? options.translationsRequirePath\n        : './translations.js';\n\n    const fallbackScopes = collectFallbackScopes(\n      runtimeScope,\n      coreGlobalScope,\n      additionalScopes\n    );\n\n    const localeModule =\n      (runtime && runtime.localeModule) ||\n      (fallbackResolveLocaleModule ? fallbackResolveLocaleModule(runtimeScope) : null);\n\n    const defaultLanguage =\n      (runtime && runtime.defaultLanguage) ||\n      (localeModule && typeof localeModule.DEFAULT_LANGUAGE === 'string'\n        ? localeModule.DEFAULT_LANGUAGE\n        : 'en');\n\n    const rtlLanguageCodes =\n      (runtime && runtime.rtlLanguageCodes) ||\n      (localeModule &&\n        Array.isArray(localeModule.RTL_LANGUAGE_CODES) &&\n        localeModule.RTL_LANGUAGE_CODES.length > 0\n        ? localeModule.RTL_LANGUAGE_CODES\n        : ['ar', 'fa', 'he', 'ur']);\n\n    const fallbackNormalizeLanguageCode = fallbackNormalizeLanguageCodeFactory(\n      defaultLanguage\n    );\n\n    const normalizeLanguageCode = runtime &&\n      typeof runtime.normalizeLanguageCode === 'function'\n      ? function runtimeNormalizeLanguageCode(lang) {\n        try {\n          return runtime.normalizeLanguageCode(lang);\n        } catch (runtimeNormalizeError) {\n          void runtimeNormalizeError;\n        }\n\n        return fallbackNormalizeLanguageCode(lang);\n      }\n      : localizationBridge &&\n        typeof localizationBridge.normalizeLanguageCode === 'function'\n        ? function bridgeNormalizeLanguageCode(lang) {\n          try {\n            return localizationBridge.normalizeLanguageCode(lang, runtimeScope);\n          } catch (bridgeNormalizeError) {\n            void bridgeNormalizeError;\n          }\n\n          return fallbackNormalizeLanguageCode(lang);\n        }\n        : fallbackNormalizeLanguageCode;\n\n    const fallbackIsRtlLanguage = fallbackIsRtlLanguageFactory(\n      rtlLanguageCodes,\n      normalizeLanguageCode\n    );\n\n    const isRtlLanguage = runtime && typeof runtime.isRtlLanguage === 'function'\n      ? function runtimeIsRtlLanguage(lang) {\n        try {\n          return runtime.isRtlLanguage(lang);\n        } catch (runtimeIsRtlError) {\n          void runtimeIsRtlError;\n        }\n\n        return fallbackIsRtlLanguage(lang);\n      }\n      : localizationBridge && typeof localizationBridge.isRtlLanguage === 'function'\n        ? function bridgeIsRtlLanguage(lang) {\n          try {\n            return localizationBridge.isRtlLanguage(lang, runtimeScope);\n          } catch (bridgeIsRtlError) {\n            void bridgeIsRtlError;\n          }\n\n          return fallbackIsRtlLanguage(lang);\n        }\n        : fallbackIsRtlLanguage;\n\n    const fallbackResolveDocumentDirection =\n      fallbackResolveDocumentDirectionFactory(normalizeLanguageCode, isRtlLanguage);\n\n    const resolveDocumentDirection = runtime &&\n      typeof runtime.resolveDocumentDirection === 'function'\n      ? function runtimeResolveDocumentDirection(lang) {\n        try {\n          return runtime.resolveDocumentDirection(lang);\n        } catch (runtimeResolveDirectionError) {\n          void runtimeResolveDirectionError;\n        }\n\n        return fallbackResolveDocumentDirection(lang);\n      }\n      : localizationBridge &&\n        typeof localizationBridge.resolveDocumentDirection === 'function'\n        ? function bridgeResolveDocumentDirection(lang) {\n          try {\n            return localizationBridge.resolveDocumentDirection(\n              lang,\n              runtimeScope\n            );\n          } catch (bridgeResolveDirectionError) {\n            void bridgeResolveDirectionError;\n          }\n\n          return fallbackResolveDocumentDirection(lang);\n        }\n        : fallbackResolveDocumentDirection;\n\n    const applyLocaleMetadata = runtime &&\n      typeof runtime.applyLocaleMetadata === 'function'\n      ? function runtimeApplyLocaleMetadata(target, lang, direction) {\n        try {\n          return runtime.applyLocaleMetadata(target, lang, direction);\n        } catch (runtimeApplyLocaleError) {\n          void runtimeApplyLocaleError;\n        }\n\n        return fallbackApplyLocaleMetadataProxy(target, lang, direction);\n      }\n      : localizationBridge &&\n        typeof localizationBridge.applyLocaleMetadata === 'function'\n        ? function bridgeApplyLocaleMetadata(target, lang, direction) {\n          try {\n            return localizationBridge.applyLocaleMetadata(\n              target,\n              lang,\n              direction,\n              runtimeScope\n            );\n          } catch (bridgeApplyLocaleError) {\n            void bridgeApplyLocaleError;\n          }\n\n          return fallbackApplyLocaleMetadataProxy(target, lang, direction);\n        }\n        : fallbackApplyLocaleMetadataProxy;\n\n    const datasetResolver = fallbackResolveTranslationDatasetFactory(\n      fallbackScopes,\n      requireFn,\n      translationsRequirePath\n    );\n\n    const fallbackGetLanguageTexts = fallbackGetLanguageTextsFactory(\n      datasetResolver,\n      defaultLanguage\n    );\n\n    const getLanguageTexts = runtime && typeof runtime.getLanguageTexts === 'function'\n      ? function runtimeGetLanguageTexts(lang) {\n        try {\n          return runtime.getLanguageTexts(lang);\n        } catch (runtimeGetLanguageTextsError) {\n          void runtimeGetLanguageTextsError;\n        }\n\n        return fallbackGetLanguageTexts(lang);\n      }\n      : fallbackGetLanguageTexts;\n\n    const ensureGlobalGetLanguageTextsAvailability =\n      createEnsureGlobalGetLanguageTextsAvailability(runtime, fallbackScopes);\n\n    return {\n      localeModule: isObject(localeModule) ? localeModule : null,\n      defaultLanguage:\n        typeof defaultLanguage === 'string' && defaultLanguage\n          ? defaultLanguage\n          : 'en',\n      rtlLanguageCodes:\n        Array.isArray(rtlLanguageCodes) && rtlLanguageCodes.length\n          ? rtlLanguageCodes\n          : ['ar', 'fa', 'he', 'ur'],\n      normalizeLanguageCode,\n      isRtlLanguage,\n      resolveDocumentDirection,\n      applyLocaleMetadata,\n      getLanguageTexts,\n      ensureGlobalGetLanguageTextsAvailability,\n      fallbackResolveTranslationDataset: datasetResolver,\n    };\n  }\n\n  const namespace = {\n    createLocalizationAccessors,\n  };\n\n  const globalScope =\n    (typeof globalThis !== 'undefined' && globalThis) ||\n    (typeof window !== 'undefined' && window) ||\n    (typeof self !== 'undefined' && self) ||\n    (typeof global !== 'undefined' && global) ||\n    null;\n\n  const namespaceName = 'cineCoreAppLocalizationAccessors';\n  const existing =\n    isObject(globalScope) && isObject(globalScope[namespaceName])\n      ? globalScope[namespaceName]\n      : {};\n\n  Object.assign(existing, namespace);\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Exposes a bridge that bundles all localisation helpers required by the app\n * core runtime. The logic originally lived directly inside the modern runtime\n * bundle. Moving it into this helper keeps the runtime leaner while preserving\n * the fault tolerant behaviour that protects user data, offline flows and the\n * translation system.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureScope(candidate, fallbackScope) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectScope(fallbackScope);\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const scope = detectScope(runtimeScope);\n\n    if (scope && typeof scope.resolveCoreSupportModule === 'function') {\n      try {\n        return scope.resolveCoreSupportModule.bind(scope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      scope &&\n      scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return function unresolvedSupportModule() {\n      return null;\n    };\n  }\n\n  function collectCandidateScopes(primaryScope, secondaryScope) {\n    const scopes = [];\n\n    if (isObject(primaryScope) && scopes.indexOf(primaryScope) === -1) {\n      scopes.push(primaryScope);\n    }\n\n    if (isObject(secondaryScope) && scopes.indexOf(secondaryScope) === -1) {\n      scopes.push(secondaryScope);\n    }\n\n    const additionalScopes = [\n      typeof globalThis !== 'undefined' ? globalThis : null,\n      typeof window !== 'undefined' ? window : null,\n      typeof self !== 'undefined' ? self : null,\n      typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < additionalScopes.length; index += 1) {\n      const scope = additionalScopes[index];\n      if (isObject(scope) && scopes.indexOf(scope) === -1) {\n        scopes.push(scope);\n      }\n    }\n\n    return scopes;\n  }\n\n  function resolveLocalizationSupportTools(options) {\n    const resolveCoreSupportModule = options && options.resolveCoreSupportModule;\n    const requireFn = options && options.requireFn;\n    const runtimeScope = options && options.runtimeScope;\n    const coreGlobalScope = options && options.coreGlobalScope;\n\n    let tools = null;\n\n    if (typeof resolveCoreSupportModule === 'function') {\n      try {\n        tools = resolveCoreSupportModule(\n          'cineCoreAppLocalizationSupport',\n          '../app-core/localization-fixed.js'\n        );\n      } catch (localizationSupportResolveError) {\n        void localizationSupportResolveError;\n        tools = null;\n      }\n    }\n\n    if (!isObject(tools) && typeof requireFn === 'function') {\n      try {\n        const requiredLocalizationSupport = requireFn('../app-core/localization-fixed.js');\n        if (isObject(requiredLocalizationSupport)) {\n          tools = requiredLocalizationSupport;\n        }\n      } catch (localizationSupportRequireError) {\n        void localizationSupportRequireError;\n      }\n    }\n\n    if (isObject(tools)) {\n      return tools;\n    }\n\n    const fallbackScopes = collectCandidateScopes(runtimeScope, coreGlobalScope);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppLocalizationSupport;\n        if (isObject(candidate)) {\n          return candidate;\n        }\n      } catch (localizationSupportLookupError) {\n        void localizationSupportLookupError;\n      }\n    }\n\n    return null;\n  }\n\n  function createFallbackLocalizationBridge() {\n    function createBasicLocalizationFallbackResolversProxy() {\n      return null;\n    }\n\n    const localizationFallbackRegistry = {\n      createFallbackResolvers(fallbackOptions) {\n        return createBasicLocalizationFallbackResolversProxy(fallbackOptions);\n      },\n    };\n\n    function fallbackResolveLocaleModuleProxy() {\n      return null;\n    }\n\n    function createLocaleFallbacksProxy() {\n      return null;\n    }\n\n    return {\n      localizationRuntimeEnvironment: null,\n      localizationBridge: null,\n      localizationFallbacks: null,\n      inlineLocalizationFallbacks: null,\n      localizationFallbackSupport: null,\n      createBasicLocalizationFallbackResolvers: createBasicLocalizationFallbackResolversProxy,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers: null,\n      localizationFallbackNamespace: null,\n      fallbackResolveLocaleModule: fallbackResolveLocaleModuleProxy,\n      createLocaleFallbacks: createLocaleFallbacksProxy,\n    };\n  }\n\n  function callCreateAppLocalizationSupport(tools, options) {\n    if (isObject(tools) && typeof tools.createAppLocalizationSupport === 'function') {\n      try {\n        return tools.createAppLocalizationSupport(options);\n      } catch (createAppLocalizationSupportError) {\n        void createAppLocalizationSupportError;\n      }\n    }\n\n    return null;\n  }\n\n  function createLocalizationRuntimeBridge(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const localizationSupportTools = resolveLocalizationSupportTools({\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n    });\n\n    const localizationBridge = callCreateAppLocalizationSupport(localizationSupportTools, {\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n    });\n\n    if (isObject(localizationBridge)) {\n      return localizationBridge;\n    }\n\n    return createFallbackLocalizationBridge();\n  }\n\n  const namespace = {\n    createLocalizationRuntimeBridge,\n  };\n\n  const namespaceName = 'cineCoreAppLocalizationRuntimeBridge';\n  const globalScope = detectScope();\n  const existing = isObject(globalScope) && isObject(globalScope[namespaceName])\n    ? globalScope[namespaceName]\n    : {};\n\n  for (const key of Object.keys(namespace)) {\n    existing[key] = namespace[key];\n  }\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Provides a high level factory that resolves the localisation runtime bridge\n * used by the modern app core bundle. The logic previously lived directly\n * inside app-core-new-1.js and was responsible for carefully falling back to\n * offline friendly defaults whenever the helper modules are unavailable. This\n * module keeps that behaviour intact while letting the runtime file focus on\n * orchestration.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureScope(candidate, fallbackScope) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectScope(fallbackScope);\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const scope = detectScope(runtimeScope);\n\n    if (scope && typeof scope.resolveCoreSupportModule === 'function') {\n      try {\n        return scope.resolveCoreSupportModule.bind(scope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      scope &&\n      scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return function unresolvedSupportModule() {\n      return null;\n    };\n  }\n\n  function collectCandidateScopes(primaryScope, secondaryScope) {\n    const scopes = [];\n\n    if (isObject(primaryScope) && scopes.indexOf(primaryScope) === -1) {\n      scopes.push(primaryScope);\n    }\n\n    if (isObject(secondaryScope) && scopes.indexOf(secondaryScope) === -1) {\n      scopes.push(secondaryScope);\n    }\n\n    const additionalScopes = [\n      typeof globalThis !== 'undefined' ? globalThis : null,\n      typeof window !== 'undefined' ? window : null,\n      typeof self !== 'undefined' ? self : null,\n      typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < additionalScopes.length; index += 1) {\n      const scope = additionalScopes[index];\n      if (isObject(scope) && scopes.indexOf(scope) === -1) {\n        scopes.push(scope);\n      }\n    }\n\n    return scopes;\n  }\n\n  function resolveLocalizationRuntimeBridgeTools(options) {\n    const resolveCoreSupportModule = options && options.resolveCoreSupportModule;\n    const requireFn = options && options.requireFn;\n    const runtimeScope = options && options.runtimeScope;\n    const coreGlobalScope = options && options.coreGlobalScope;\n\n    let tools = null;\n\n    if (typeof resolveCoreSupportModule === 'function') {\n      try {\n        tools = resolveCoreSupportModule(\n          'cineCoreAppLocalizationRuntimeBridge',\n          './modules/app-core/localization-fixed.js'\n        );\n      } catch (localizationBridgeResolveError) {\n        void localizationBridgeResolveError;\n        tools = null;\n      }\n    }\n\n    if (!isObject(tools) && typeof requireFn === 'function') {\n      try {\n        const required = requireFn('./modules/app-core/localization-fixed.js');\n        if (isObject(required)) {\n          tools = required;\n        }\n      } catch (localizationBridgeRequireError) {\n        void localizationBridgeRequireError;\n      }\n    }\n\n    if (isObject(tools)) {\n      return tools;\n    }\n\n    const fallbackScopes = collectCandidateScopes(runtimeScope, coreGlobalScope);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppLocalizationRuntimeBridge;\n        if (isObject(candidate)) {\n          return candidate;\n        }\n      } catch (localizationBridgeLookupError) {\n        void localizationBridgeLookupError;\n      }\n    }\n\n    return null;\n  }\n\n  function createFallbackLocalizationBridge() {\n    function createBasicLocalizationFallbackResolversProxy() {\n      return null;\n    }\n\n    const localizationFallbackRegistry = {\n      createFallbackResolvers(fallbackOptions) {\n        return createBasicLocalizationFallbackResolversProxy(fallbackOptions);\n      },\n    };\n\n    function fallbackResolveLocaleModuleProxy() {\n      return null;\n    }\n\n    function createLocaleFallbacksProxy() {\n      return null;\n    }\n\n    return {\n      localizationRuntimeEnvironment: null,\n      localizationBridge: null,\n      localizationFallbacks: null,\n      inlineLocalizationFallbacks: null,\n      localizationFallbackSupport: null,\n      createBasicLocalizationFallbackResolvers: createBasicLocalizationFallbackResolversProxy,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers: null,\n      localizationFallbackNamespace: null,\n      fallbackResolveLocaleModule: fallbackResolveLocaleModuleProxy,\n      createLocaleFallbacks: createLocaleFallbacksProxy,\n    };\n  }\n\n  function ensureBridgeFactory(options) {\n    const requireFn = options && options.requireFn;\n    const runtimeScope = options && options.runtimeScope;\n    const coreGlobalScope = options && options.coreGlobalScope;\n\n    const tools = resolveLocalizationRuntimeBridgeTools(options);\n\n    if (isObject(tools) && typeof tools.createLocalizationRuntimeBridge === 'function') {\n      return tools.createLocalizationRuntimeBridge;\n    }\n\n    if (typeof requireFn === 'function') {\n      try {\n        const required = requireFn('./modules/app-core/localization-fixed.js');\n        if (\n          isObject(required) &&\n          typeof required.createLocalizationRuntimeBridge === 'function'\n        ) {\n          return required.createLocalizationRuntimeBridge;\n        }\n      } catch (localizationBridgeRequireError) {\n        void localizationBridgeRequireError;\n      }\n    }\n\n    const fallbackScopes = collectCandidateScopes(runtimeScope, coreGlobalScope);\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppLocalizationRuntimeBridge;\n        if (\n          isObject(candidate) &&\n          typeof candidate.createLocalizationRuntimeBridge === 'function'\n        ) {\n          return candidate.createLocalizationRuntimeBridge;\n        }\n      } catch (localizationBridgeLookupError) {\n        void localizationBridgeLookupError;\n      }\n    }\n\n    return function fallbackCreateLocalizationRuntimeBridge() {\n      return createFallbackLocalizationBridge();\n    };\n  }\n\n  function normalizeLocalizationRuntimeBridge(bridge) {\n    const resolvedBridge = isObject(bridge) ? bridge : createFallbackLocalizationBridge();\n\n    const localizationRuntimeEnvironment = isObject(\n      resolvedBridge.localizationRuntimeEnvironment\n    )\n      ? resolvedBridge.localizationRuntimeEnvironment\n      : null;\n\n    const localizationBridge = isObject(resolvedBridge.localizationBridge)\n      ? resolvedBridge.localizationBridge\n      : null;\n\n    const localizationFallbacks = isObject(resolvedBridge.localizationFallbacks)\n      ? resolvedBridge.localizationFallbacks\n      : null;\n\n    const inlineLocalizationFallbacks = isObject(\n      resolvedBridge.inlineLocalizationFallbacks\n    )\n      ? resolvedBridge.inlineLocalizationFallbacks\n      : null;\n\n    const localizationFallbackSupport =\n      typeof resolvedBridge.localizationFallbackSupport !== 'undefined'\n        ? resolvedBridge.localizationFallbackSupport\n        : null;\n\n    const createBasicLocalizationFallbackResolvers =\n      typeof resolvedBridge.createBasicLocalizationFallbackResolvers === 'function'\n        ? resolvedBridge.createBasicLocalizationFallbackResolvers\n        : function createBasicLocalizationFallbackResolversProxy() {\n          return null;\n        };\n\n    const localizationFallbackRegistry = isObject(\n      resolvedBridge.localizationFallbackRegistry\n    )\n      ? resolvedBridge.localizationFallbackRegistry\n      : {\n        createFallbackResolvers(fallbackOptions) {\n          return createBasicLocalizationFallbackResolvers(fallbackOptions);\n        },\n      };\n\n    const fallbackResolveLocaleModule =\n      typeof resolvedBridge.fallbackResolveLocaleModule === 'function'\n        ? resolvedBridge.fallbackResolveLocaleModule\n        : function fallbackResolveLocaleModuleProxy() {\n          return null;\n        };\n\n    const createLocaleFallbacks =\n      typeof resolvedBridge.createLocaleFallbacks === 'function'\n        ? resolvedBridge.createLocaleFallbacks\n        : function createLocaleFallbacksProxy() {\n          return null;\n        };\n\n    const localizationFallbackNamespace =\n      typeof resolvedBridge.localizationFallbackNamespace !== 'undefined'\n        ? resolvedBridge.localizationFallbackNamespace\n        : null;\n\n    const localizationFallbackResolvers = resolvedBridge.localizationFallbackResolvers\n      ? resolvedBridge.localizationFallbackResolvers\n      : localizationFallbackRegistry &&\n        typeof localizationFallbackRegistry.createFallbackResolvers === 'function'\n        ? localizationFallbackRegistry.createFallbackResolvers({\n          directNamespace: localizationFallbacks,\n          inlineNamespace: inlineLocalizationFallbacks,\n        })\n        : createBasicLocalizationFallbackResolvers({\n          directNamespace: localizationFallbacks,\n          inlineNamespace: inlineLocalizationFallbacks,\n        });\n\n    return {\n      localizationRuntimeEnvironment,\n      localizationBridge,\n      localizationFallbacks,\n      inlineLocalizationFallbacks,\n      localizationFallbackSupport,\n      createBasicLocalizationFallbackResolvers,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers,\n      localizationFallbackNamespace,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n    };\n  }\n\n  function createLocalizationRuntimeSetup(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const createLocalizationRuntimeBridge = ensureBridgeFactory({\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n    });\n\n    const localizationRuntimeBridge = createLocalizationRuntimeBridge({\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n    });\n\n    return normalizeLocalizationRuntimeBridge(localizationRuntimeBridge);\n  }\n\n  const namespace = {\n    createLocalizationRuntimeSetup,\n  };\n\n  const namespaceName = 'cineCoreAppLocalizationRuntimeSetup';\n  const globalScope = detectScope();\n  const existing = isObject(globalScope) && isObject(globalScope[namespaceName])\n    ? globalScope[namespaceName]\n    : {};\n\n  for (const key of Object.keys(namespace)) {\n    existing[key] = namespace[key];\n  }\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Resolves the localisation runtime helpers for the modern app core.\n * Moving this heavy bootstrap logic into a standalone module keeps the\n * primary runtime bundle smaller while the refactor progresses.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureScope(candidate, fallback) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectScope(fallback);\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const scope = ensureScope(runtimeScope);\n\n    if (scope && typeof scope.resolveCoreSupportModule === 'function') {\n      try {\n        return scope.resolveCoreSupportModule.bind(scope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      scope &&\n      scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return null;\n  }\n\n  function registerScope(scopes, scope) {\n    if (!isObject(scope)) {\n      return;\n    }\n\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  function collectCandidateScopes(primaryScope, secondaryScope) {\n    const scopes = [];\n    registerScope(scopes, primaryScope);\n    registerScope(scopes, secondaryScope);\n    registerScope(scopes, typeof globalThis !== 'undefined' ? globalThis : null);\n    registerScope(scopes, typeof window !== 'undefined' ? window : null);\n    registerScope(scopes, typeof self !== 'undefined' ? self : null);\n    registerScope(scopes, typeof global !== 'undefined' ? global : null);\n    return scopes;\n  }\n\n  function createInlineFallbackLocalizationRuntimeSetup() {\n    return {\n      localizationRuntimeEnvironment: null,\n      localizationBridge: null,\n      localizationFallbacks: null,\n      inlineLocalizationFallbacks: null,\n      localizationFallbackSupport: null,\n      createBasicLocalizationFallbackResolvers() {\n        return null;\n      },\n      localizationFallbackRegistry: {\n        createFallbackResolvers() {\n          return null;\n        },\n      },\n      localizationFallbackResolvers: null,\n      localizationFallbackNamespace: null,\n      fallbackResolveLocaleModule() {\n        return null;\n      },\n      createLocaleFallbacks() {\n        return null;\n      },\n    };\n  }\n\n  function createLocalizationModuleLoader(requireFn) {\n    let attempted = false;\n    let cachedModule = null;\n\n    return function loadLocalizationModule() {\n      if (attempted) {\n        return cachedModule;\n      }\n\n      attempted = true;\n\n      if (typeof requireFn !== 'function') {\n        return cachedModule;\n      }\n\n      try {\n        const required = requireFn('./modules/app-core/localization-fixed.js');\n        if (isObject(required)) {\n          cachedModule = required;\n        }\n      } catch (localizationRequireError) {\n        void localizationRequireError;\n      }\n\n      return cachedModule;\n    };\n  }\n\n  function resolveRuntimeLocalizationTools(\n    resolveCoreSupportModule,\n    candidateScopes,\n    loadLocalizationModule\n  ) {\n    let tools = null;\n\n    if (typeof resolveCoreSupportModule === 'function') {\n      try {\n        tools = resolveCoreSupportModule(\n          'cineCoreAppRuntimeLocalization',\n          './modules/app-core/localization-fixed.js'\n        );\n      } catch (localizationResolveError) {\n        void localizationResolveError;\n        tools = null;\n      }\n    }\n\n    if (!isObject(tools)) {\n      tools = loadLocalizationModule();\n    }\n\n    if (isObject(tools)) {\n      return tools;\n    }\n\n    for (let index = 0; index < candidateScopes.length; index += 1) {\n      const scope = candidateScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppRuntimeLocalization;\n        if (isObject(candidate)) {\n          return candidate;\n        }\n      } catch (localizationLookupError) {\n        void localizationLookupError;\n      }\n    }\n\n    return null;\n  }\n\n  function resolveLocalizationMethod(methodName, tools, candidateScopes, loadLocalizationModule) {\n    if (isObject(tools) && typeof tools[methodName] === 'function') {\n      return tools[methodName];\n    }\n\n    const required = loadLocalizationModule();\n    if (isObject(required) && typeof required[methodName] === 'function') {\n      return required[methodName];\n    }\n\n    for (let index = 0; index < candidateScopes.length; index += 1) {\n      const scope = candidateScopes[index];\n\n      try {\n        const candidate = scope && scope.cineCoreAppRuntimeLocalization;\n        if (isObject(candidate) && typeof candidate[methodName] === 'function') {\n          return candidate[methodName];\n        }\n      } catch (localizationMethodLookupError) {\n        void localizationMethodLookupError;\n      }\n    }\n\n    return null;\n  }\n\n  function resolveLocalizationRuntimeSetup(options) {\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const candidateScopes = collectCandidateScopes(runtimeScope, coreGlobalScope);\n    const loadLocalizationModule = createLocalizationModuleLoader(requireFn);\n    const runtimeLocalizationTools = resolveRuntimeLocalizationTools(\n      resolveCoreSupportModule,\n      candidateScopes,\n      loadLocalizationModule\n    );\n\n    const resolveRuntimeLocalization = resolveLocalizationMethod(\n      'resolveRuntimeLocalization',\n      runtimeLocalizationTools,\n      candidateScopes,\n      loadLocalizationModule\n    );\n\n    const createFallbackLocalizationRuntimeSetup =\n      resolveLocalizationMethod(\n        'createFallbackLocalizationRuntimeSetup',\n        runtimeLocalizationTools,\n        candidateScopes,\n        loadLocalizationModule\n      ) || createInlineFallbackLocalizationRuntimeSetup;\n\n    const setup =\n      (typeof resolveRuntimeLocalization === 'function'\n        ? resolveRuntimeLocalization({\n          resolveCoreSupportModule,\n          requireFn,\n          runtimeScope,\n          coreGlobalScope,\n        })\n        : null) ||\n      (typeof createFallbackLocalizationRuntimeSetup === 'function'\n        ? createFallbackLocalizationRuntimeSetup()\n        : createInlineFallbackLocalizationRuntimeSetup());\n\n    return setup || createInlineFallbackLocalizationRuntimeSetup();\n  }\n\n  const namespace = {\n    resolveLocalizationRuntimeSetup,\n    createInlineFallbackLocalizationRuntimeSetup,\n  };\n\n  const globalScope = detectScope();\n  const namespaceName = 'cineCoreAppRuntimeLocalizationResolver';\n  const existing =\n    isObject(globalScope) && isObject(globalScope[namespaceName])\n      ? globalScope[namespaceName]\n      : {};\n\n  Object.assign(existing, namespace);\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n/*\n * Centralises the logic that resolves the localisation runtime used by the\n * modern Cine Power Planner bundle. The orchestration file previously contained\n * the helper discovery logic directly; moving it here keeps the core runtime\n * lean while preserving all offline-first fallbacks.\n */\n\n(function () {\n  function isObject(value) {\n    return !!value && (typeof value === 'object' || typeof value === 'function');\n  }\n\n  function detectScope(primaryScope) {\n    if (isObject(primaryScope)) {\n      return primaryScope;\n    }\n\n    if (typeof globalThis !== 'undefined' && isObject(globalThis)) {\n      return globalThis;\n    }\n\n    if (typeof window !== 'undefined' && isObject(window)) {\n      return window;\n    }\n\n    if (typeof self !== 'undefined' && isObject(self)) {\n      return self;\n    }\n\n    if (typeof global !== 'undefined' && isObject(global)) {\n      return global;\n    }\n\n    return null;\n  }\n\n  function ensureScope(candidate, fallbackScope) {\n    if (isObject(candidate)) {\n      return candidate;\n    }\n\n    return detectScope(fallbackScope);\n  }\n\n  function ensureRequireFn(candidate) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    if (typeof require === 'function') {\n      return require;\n    }\n\n    return null;\n  }\n\n  function ensureResolveCoreSupportModule(candidate, requireFn, runtimeScope) {\n    if (typeof candidate === 'function') {\n      return candidate;\n    }\n\n    const scope = detectScope(runtimeScope);\n\n    if (scope && typeof scope.resolveCoreSupportModule === 'function') {\n      try {\n        return scope.resolveCoreSupportModule.bind(scope);\n      } catch (bindError) {\n        void bindError;\n      }\n    }\n\n    if (\n      scope &&\n      scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS &&\n      typeof scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule === 'function'\n    ) {\n      try {\n        return scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS.resolveCoreSupportModule.bind(\n          scope.CORE_RUNTIME_SUPPORT_BOOTSTRAP_TOOLS\n        );\n      } catch (bootstrapBindError) {\n        void bootstrapBindError;\n      }\n    }\n\n    if (typeof requireFn === 'function') {\n      return function fallbackResolveCoreSupportModule(namespaceName, requirePath) {\n        if (typeof namespaceName !== 'string' || !namespaceName) {\n          return null;\n        }\n\n        if (typeof requirePath !== 'string' || !requirePath) {\n          return null;\n        }\n\n        try {\n          const required = requireFn(requirePath);\n          return isObject(required) ? required : null;\n        } catch (supportModuleError) {\n          void supportModuleError;\n        }\n\n        return null;\n      };\n    }\n\n    return function unresolvedSupportModule() {\n      return null;\n    };\n  }\n\n  function registerScope(scopes, scope) {\n    if (!isObject(scope)) {\n      return;\n    }\n\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  function collectCandidateScopes(primaryScope, secondaryScope) {\n    const scopes = [];\n    registerScope(scopes, primaryScope);\n    registerScope(scopes, secondaryScope);\n    registerScope(scopes, typeof globalThis !== 'undefined' ? globalThis : null);\n    registerScope(scopes, typeof window !== 'undefined' ? window : null);\n    registerScope(scopes, typeof self !== 'undefined' ? self : null);\n    registerScope(scopes, typeof global !== 'undefined' ? global : null);\n    return scopes;\n  }\n\n  function createFallbackLocalizationRuntimeSetup() {\n    return {\n      localizationRuntimeEnvironment: null,\n      localizationBridge: null,\n      localizationFallbacks: null,\n      inlineLocalizationFallbacks: null,\n      localizationFallbackSupport: null,\n      createBasicLocalizationFallbackResolvers() {\n        return null;\n      },\n      localizationFallbackRegistry: {\n        createFallbackResolvers() {\n          return null;\n        },\n      },\n      localizationFallbackResolvers: null,\n      localizationFallbackNamespace: null,\n      fallbackResolveLocaleModule() {\n        return null;\n      },\n      createLocaleFallbacks() {\n        return null;\n      },\n    };\n  }\n\n  function ensureCreateLocalizationRuntimeSetup(options) {\n    const resolveCoreSupportModule = options && options.resolveCoreSupportModule;\n    const requireFn = options && options.requireFn;\n    const runtimeScope = options && options.runtimeScope;\n    const coreGlobalScope = options && options.coreGlobalScope;\n\n    let tools = null;\n\n    if (typeof resolveCoreSupportModule === 'function') {\n      try {\n        tools = resolveCoreSupportModule(\n          'cineCoreAppLocalizationRuntimeSetup',\n          './modules/app-core/localization-fixed.js'\n        );\n      } catch (localizationRuntimeSetupResolveError) {\n        void localizationRuntimeSetupResolveError;\n        tools = null;\n      }\n    }\n\n    if (!isObject(tools) && typeof requireFn === 'function') {\n      try {\n        const required = requireFn('./modules/app-core/localization-fixed.js');\n        if (isObject(required)) {\n          tools = required;\n        }\n      } catch (localizationRuntimeSetupRequireError) {\n        void localizationRuntimeSetupRequireError;\n      }\n    }\n\n    if (!isObject(tools)) {\n      const fallbackScopes = collectCandidateScopes(runtimeScope, coreGlobalScope);\n\n      for (let index = 0; index < fallbackScopes.length; index += 1) {\n        const scope = fallbackScopes[index];\n        if (!isObject(scope)) {\n          continue;\n        }\n\n        try {\n          const candidate = scope.cineCoreAppLocalizationRuntimeSetup;\n          if (isObject(candidate)) {\n            tools = candidate;\n            break;\n          }\n        } catch (localizationRuntimeSetupLookupError) {\n          void localizationRuntimeSetupLookupError;\n        }\n      }\n    }\n\n    if (isObject(tools) && typeof tools.createLocalizationRuntimeSetup === 'function') {\n      return tools.createLocalizationRuntimeSetup;\n    }\n\n    return null;\n  }\n\n  function ensureFunction(value, fallback) {\n    if (typeof value === 'function') {\n      return value;\n    }\n\n    return fallback;\n  }\n\n  function normalizeLocalizationRuntimeSetup(candidate) {\n    const fallback = createFallbackLocalizationRuntimeSetup();\n    const normalizedCandidate = isObject(candidate) ? candidate : {};\n\n    const localizationRuntimeEnvironment = isObject(\n      normalizedCandidate.localizationRuntimeEnvironment\n    )\n      ? normalizedCandidate.localizationRuntimeEnvironment\n      : fallback.localizationRuntimeEnvironment;\n\n    const localizationBridge = isObject(normalizedCandidate.localizationBridge)\n      ? normalizedCandidate.localizationBridge\n      : fallback.localizationBridge;\n\n    const localizationFallbacks = isObject(normalizedCandidate.localizationFallbacks)\n      ? normalizedCandidate.localizationFallbacks\n      : fallback.localizationFallbacks;\n\n    const inlineLocalizationFallbacks = isObject(\n      normalizedCandidate.inlineLocalizationFallbacks\n    )\n      ? normalizedCandidate.inlineLocalizationFallbacks\n      : fallback.inlineLocalizationFallbacks;\n\n    const localizationFallbackSupport = Object.prototype.hasOwnProperty.call(\n      normalizedCandidate,\n      'localizationFallbackSupport'\n    )\n      ? normalizedCandidate.localizationFallbackSupport\n      : fallback.localizationFallbackSupport;\n\n    const createBasicLocalizationFallbackResolvers = ensureFunction(\n      normalizedCandidate.createBasicLocalizationFallbackResolvers,\n      fallback.createBasicLocalizationFallbackResolvers\n    );\n\n    const localizationFallbackRegistry = isObject(\n      normalizedCandidate.localizationFallbackRegistry\n    )\n      ? normalizedCandidate.localizationFallbackRegistry\n      : {\n        createFallbackResolvers(fallbackOptions) {\n          return createBasicLocalizationFallbackResolvers(fallbackOptions);\n        },\n      };\n\n    let localizationFallbackResolvers = normalizedCandidate.localizationFallbackResolvers;\n\n    if (!localizationFallbackResolvers && localizationFallbackRegistry) {\n      const createFallbackResolvers = ensureFunction(\n        localizationFallbackRegistry.createFallbackResolvers,\n        null\n      );\n\n      if (createFallbackResolvers) {\n        try {\n          localizationFallbackResolvers = createFallbackResolvers({\n            directNamespace: localizationFallbacks,\n            inlineNamespace: inlineLocalizationFallbacks,\n          });\n        } catch (createFallbackResolversError) {\n          void createFallbackResolversError;\n          localizationFallbackResolvers = null;\n        }\n      }\n    }\n\n    if (\n      !localizationFallbackResolvers &&\n      typeof createBasicLocalizationFallbackResolvers === 'function'\n    ) {\n      try {\n        localizationFallbackResolvers = createBasicLocalizationFallbackResolvers({\n          directNamespace: localizationFallbacks,\n          inlineNamespace: inlineLocalizationFallbacks,\n        });\n      } catch (createBasicResolversError) {\n        void createBasicResolversError;\n        localizationFallbackResolvers = null;\n      }\n    }\n\n    if (!localizationFallbackResolvers) {\n      localizationFallbackResolvers = fallback.localizationFallbackResolvers;\n    }\n\n    const localizationFallbackNamespace = Object.prototype.hasOwnProperty.call(\n      normalizedCandidate,\n      'localizationFallbackNamespace'\n    )\n      ? normalizedCandidate.localizationFallbackNamespace\n      : fallback.localizationFallbackNamespace;\n\n    const fallbackResolveLocaleModule = ensureFunction(\n      normalizedCandidate.fallbackResolveLocaleModule,\n      fallback.fallbackResolveLocaleModule\n    );\n\n    const createLocaleFallbacks = ensureFunction(\n      normalizedCandidate.createLocaleFallbacks,\n      fallback.createLocaleFallbacks\n    );\n\n    return {\n      localizationRuntimeEnvironment,\n      localizationBridge,\n      localizationFallbacks,\n      inlineLocalizationFallbacks,\n      localizationFallbackSupport,\n      createBasicLocalizationFallbackResolvers,\n      localizationFallbackRegistry,\n      localizationFallbackResolvers,\n      localizationFallbackNamespace,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n    };\n  }\n\n  function resolveRuntimeLocalization(options) {\n    const currentLocalization = options && options.currentLocalization;\n\n    if (isObject(currentLocalization)) {\n      return normalizeLocalizationRuntimeSetup(currentLocalization);\n    }\n\n    const requireFn = ensureRequireFn(options && options.requireFn);\n    const runtimeScope = ensureScope(options && options.runtimeScope);\n    const coreGlobalScope = ensureScope(options && options.coreGlobalScope, runtimeScope);\n    const resolveCoreSupportModule = ensureResolveCoreSupportModule(\n      options && options.resolveCoreSupportModule,\n      requireFn,\n      runtimeScope || coreGlobalScope\n    );\n\n    const createLocalizationRuntimeSetup = ensureCreateLocalizationRuntimeSetup({\n      resolveCoreSupportModule,\n      requireFn,\n      runtimeScope,\n      coreGlobalScope,\n    });\n\n    if (typeof createLocalizationRuntimeSetup === 'function') {\n      try {\n        const setup = createLocalizationRuntimeSetup({\n          resolveCoreSupportModule,\n          requireFn,\n          runtimeScope,\n          coreGlobalScope,\n        });\n\n        return normalizeLocalizationRuntimeSetup(setup);\n      } catch (createLocalizationRuntimeSetupError) {\n        void createLocalizationRuntimeSetupError;\n      }\n    }\n\n    return createFallbackLocalizationRuntimeSetup();\n  }\n\n  const namespace = {\n    resolveRuntimeLocalization,\n    createFallbackLocalizationRuntimeSetup,\n  };\n\n  const namespaceName = 'cineCoreAppRuntimeLocalization';\n  const globalScope = detectScope();\n  const existing = isObject(globalScope) && isObject(globalScope[namespaceName])\n    ? globalScope[namespaceName]\n    : {};\n\n  for (const key of Object.keys(namespace)) {\n    existing[key] = namespace[key];\n  }\n\n  if (isObject(globalScope)) {\n    try {\n      globalScope[namespaceName] = existing;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n\n  if (typeof module === 'object' && module && module.exports) {\n    module.exports = existing;\n  }\n})();\n\n\n\n","\n\n/*\n * Thin wrapper around modules/app-core/bootstrap.js\n * Redundancy removed in Phase 5 Refactor.\n */\n\n/*\n * DEEP DIVE: The Core Wiring Harness\n *\n * This file may look like simple boilerplate, but it serves a critical architectural purpose:\n * **Environment Agnostic Wiring**.\n *\n * It uses `resolveCoreSupportModule` to dynamically locate the actual implementation of core systems\n * (Bootstrap, Localization) depending on whether we are running in:\n * 1. The Main Browser Window (bundled)\n * 2. A Web Worker (standalone)\n * 3. A Node.js Test Environment (mocked/polyfilled)\n *\n * This separation allows the Core logic to stay pure while this \"harness\" handles the plumbing.\n */\nimport { resolveCoreSupportModule } from './app-core-runtime-support.js';\nimport {\n  cineCoreAppCoreBootstrap,\n  cineCoreAppCoreBootstrapResolver,\n  cineCoreAppCoreBootstrapFallbacks,\n  cineCoreAppCoreBootstrapEnvironment,\n  cineCoreAppCoreBootstrapResults,\n} from './modules/app-core/bootstrap.js';\nimport {\n  cineCoreAppLocalizationSupport,\n  cineCoreAppLocalizationBootstrap,\n  cineCoreAppRuntimeLocalization,\n} from './modules/app-core/localization-fixed.js';\n\nconst APP_CORE_BOOTSTRAP_TOOLS = cineCoreAppCoreBootstrap;\n\nconst APP_CORE_LOCALIZATION_RUNTIME_TOOLS = cineCoreAppRuntimeLocalization;\n\nconst APP_CORE_LOCALIZATION_SUPPORT_TOOLS = cineCoreAppLocalizationSupport;\n\nconst APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS = cineCoreAppLocalizationBootstrap;\n\nconst APP_CORE_BOOTSTRAP_RESOLVER_DIRECT = cineCoreAppCoreBootstrapResolver;\n\nconst APP_CORE_BOOTSTRAP_FALLBACK_DIRECT = cineCoreAppCoreBootstrapFallbacks;\n\nconst APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS_DIRECT = cineCoreAppCoreBootstrapEnvironment;\n\nconst APP_CORE_BOOTSTRAP_RESULTS_TOOLS_DIRECT = cineCoreAppCoreBootstrapResults;\n\nfunction getDefaultRuntimeScope() {\n  return typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' && CORE_PART1_RUNTIME_SCOPE\n    ? CORE_PART1_RUNTIME_SCOPE\n    : null;\n}\n\nfunction getDefaultCoreGlobalScope() {\n  return typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE\n    ? CORE_GLOBAL_SCOPE\n    : null;\n}\n\nconst APP_CORE_BOOTSTRAP_SUITE =\n  APP_CORE_BOOTSTRAP_TOOLS && typeof APP_CORE_BOOTSTRAP_TOOLS.createBootstrapSuite === 'function'\n    ? APP_CORE_BOOTSTRAP_TOOLS.createBootstrapSuite({\n      directResolverNamespace: APP_CORE_BOOTSTRAP_RESOLVER_DIRECT,\n      directBootstrapNamespace: APP_CORE_BOOTSTRAP_TOOLS,\n      directBootstrapFallbackNamespace: APP_CORE_BOOTSTRAP_FALLBACK_DIRECT,\n      directBootstrapEnvironmentNamespace: APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS_DIRECT,\n      directBootstrapResultsNamespace: APP_CORE_BOOTSTRAP_RESULTS_TOOLS_DIRECT,\n      resolveCoreSupportModule,\n      requireFn: typeof require === 'function' ? require : null,\n      runtimeScope: getDefaultRuntimeScope(),\n      coreGlobalScope: getDefaultCoreGlobalScope(),\n    })\n    : null;\n\nconst APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS =\n  (APP_CORE_BOOTSTRAP_SUITE && APP_CORE_BOOTSTRAP_SUITE.bootstrapEnvironmentTools) ||\n  APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS_DIRECT ||\n  null;\n\nconst APP_CORE_BOOTSTRAP_RESULTS_TOOLS =\n  (APP_CORE_BOOTSTRAP_SUITE && APP_CORE_BOOTSTRAP_SUITE.bootstrapResultsTools) ||\n  APP_CORE_BOOTSTRAP_RESULTS_TOOLS_DIRECT ||\n  null;\n\nconst APP_CORE_BOOTSTRAP_ENVIRONMENT = (APP_CORE_BOOTSTRAP_SUITE && APP_CORE_BOOTSTRAP_SUITE.bootstrapEnvironment) || null;\n\nconst APP_CORE_BOOTSTRAP_RESOLVER_TOOLS =\n  (APP_CORE_BOOTSTRAP_SUITE &&\n    APP_CORE_BOOTSTRAP_SUITE.bootstrapEnvironment &&\n    APP_CORE_BOOTSTRAP_SUITE.bootstrapEnvironment.bootstrapResolverTools) ||\n  (APP_CORE_BOOTSTRAP_ENVIRONMENT && APP_CORE_BOOTSTRAP_ENVIRONMENT.bootstrapResolverTools) ||\n  APP_CORE_BOOTSTRAP_RESOLVER_DIRECT ||\n  null;\n\nconst APP_CORE_BOOTSTRAP_FALLBACK_TOOLS =\n  (APP_CORE_BOOTSTRAP_SUITE && APP_CORE_BOOTSTRAP_SUITE.bootstrapFallbackTools) ||\n  (APP_CORE_BOOTSTRAP_ENVIRONMENT && APP_CORE_BOOTSTRAP_ENVIRONMENT.bootstrapFallbackTools) ||\n  APP_CORE_BOOTSTRAP_FALLBACK_DIRECT ||\n  null;\n\nconst localizationBootstrapResult = (function resolveLocalizationBootstrapResult() {\n  if (APP_CORE_BOOTSTRAP_SUITE && typeof APP_CORE_BOOTSTRAP_SUITE.createLocalizationBootstrapResult === 'function') {\n    const moduleOptions = {\n      bootstrapTools: APP_CORE_BOOTSTRAP_TOOLS,\n      bootstrapFallbackTools: APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n      localizationSupportTools: APP_CORE_LOCALIZATION_SUPPORT_TOOLS,\n      localizationBootstrapTools: APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS,\n      localizationRuntimeTools: APP_CORE_LOCALIZATION_RUNTIME_TOOLS,\n      resolveCoreSupportModule,\n      requireFn: typeof require === 'function' ? require : null,\n      runtimeScope: getDefaultRuntimeScope(),\n      coreGlobalScope: getDefaultCoreGlobalScope(),\n      fallbackScopes: [], // Simplified for thin wrapper\n    };\n    return APP_CORE_BOOTSTRAP_SUITE.createLocalizationBootstrapResult(moduleOptions);\n  }\n  return null;\n})();\n\nconst localizationBootstrapWiring =\n  (APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS &&\n    typeof APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS.createLocalizationBootstrapWiring === 'function' &&\n    APP_CORE_LOCALIZATION_BOOTSTRAP_TOOLS.createLocalizationBootstrapWiring({\n      localizationBootstrapResult,\n    })) || null;\n\nexport {\n  localizationBootstrapWiring,\n  APP_CORE_BOOTSTRAP_SUITE,\n  APP_CORE_BOOTSTRAP_TOOLS,\n  APP_CORE_BOOTSTRAP_ENVIRONMENT,\n  APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS,\n  APP_CORE_BOOTSTRAP_RESULTS_TOOLS,\n  APP_CORE_BOOTSTRAP_RESOLVER_TOOLS,\n  APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n  APP_CORE_BOOTSTRAP_RESOLVER_DIRECT,\n  APP_CORE_BOOTSTRAP_FALLBACK_DIRECT,\n  APP_CORE_BOOTSTRAP_ENVIRONMENT_TOOLS_DIRECT,\n  APP_CORE_BOOTSTRAP_RESULTS_TOOLS_DIRECT as APP_CORE_BOOTSTRAP_RESULTS_DIRECT,\n};\n\nif (typeof globalThis !== 'undefined') {\n  globalThis.localizationBootstrapWiring = localizationBootstrapWiring;\n} else if (typeof window !== 'undefined') {\n  window.localizationBootstrapWiring = localizationBootstrapWiring;\n} else if (typeof self !== 'undefined') {\n  self.localizationBootstrapWiring = localizationBootstrapWiring;\n} else if (typeof global !== 'undefined') {\n  global.localizationBootstrapWiring = localizationBootstrapWiring;\n}\n","/* global cineModuleBase */\nimport { cineModuleBase } from './base.js';\nimport { detectGlobalScope } from './helpers/scope-utils.js';\n\nconst GLOBAL_SCOPE = detectGlobalScope();\n\n// Resolve Module Base (ESM Import preferred, Fallback to Global if mixed env)\nconst MODULE_BASE = cineModuleBase;\n\n// Ensure base exists before proceeding\nif (!MODULE_BASE) {\n  // Should not happen in proper ESM build with imports\n  // But strictly we return/stop\n}\n\nconst moduleRegistry = typeof MODULE_BASE.getModuleRegistry === 'function'\n  ? MODULE_BASE.getModuleRegistry(GLOBAL_SCOPE)\n  : null;\n\nconst freezeDeep = typeof MODULE_BASE.freezeDeep === 'function'\n  ? function freezeWithBase(value) {\n    try {\n      return MODULE_BASE.freezeDeep(value);\n    } catch (error) {\n      void error;\n    }\n    return value;\n  }\n  : function identity(value) {\n    return value;\n  };\n\nconst exposeGlobal = typeof MODULE_BASE.exposeGlobal === 'function'\n  ? function expose(name, value, options) {\n    return MODULE_BASE.exposeGlobal(name, value, GLOBAL_SCOPE, options || {});\n  }\n  : function fallbackExpose(name, value) {\n    try {\n      GLOBAL_SCOPE[name] = value;\n      return true;\n    } catch (error) {\n      void error;\n    }\n    return false;\n  };\n\nconst registerOrQueueModule = typeof MODULE_BASE.registerOrQueueModule === 'function'\n  ? function register(name, api, options, onError) {\n    return MODULE_BASE.registerOrQueueModule(\n      name,\n      api,\n      options,\n      onError,\n      GLOBAL_SCOPE,\n      moduleRegistry,\n    );\n  }\n  : function fallbackRegister() {\n    return false;\n  };\n\nconst safeWarn = typeof MODULE_BASE.safeWarn === 'function'\n  ? function warn(message, detail) {\n    try {\n      MODULE_BASE.safeWarn(message, detail);\n    } catch (error) {\n      void error;\n    }\n  }\n  : function fallbackWarn(message, detail) {\n    if (typeof console === 'undefined' || !console || typeof console.warn !== 'function') {\n      return;\n    }\n    try {\n      if (typeof detail === 'undefined') {\n        console.warn(message);\n      } else {\n        console.warn(message, detail);\n      }\n    } catch (error) {\n      void error;\n    }\n  };\n\nconst DEFAULT_LANGUAGE = 'en';\nconst RTL_LANGUAGE_CODES = ['ar', 'fa', 'he', 'ur'];\n\nfunction normalizeLanguageCode(lang) {\n  if (!lang) return DEFAULT_LANGUAGE;\n  try {\n    return String(lang).trim().toLowerCase();\n  } catch (languageNormalizeError) {\n    void languageNormalizeError;\n  }\n  return DEFAULT_LANGUAGE;\n}\n\nfunction isRtlLanguage(lang) {\n  const normalized = normalizeLanguageCode(lang);\n  const base = normalized.split('-')[0];\n  return RTL_LANGUAGE_CODES.indexOf(base) !== -1;\n}\n\nfunction resolveDocumentDirection(lang, doc) {\n  const targetDocument = doc || (typeof document !== 'undefined' ? document : null);\n  if (targetDocument && targetDocument.documentElement) {\n    try {\n      const docDir = targetDocument.documentElement.getAttribute('dir');\n      if (docDir === 'rtl' || docDir === 'ltr') {\n        return docDir;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n  return isRtlLanguage(lang) ? 'rtl' : 'ltr';\n}\n\nfunction applyLocaleMetadata(target, lang, direction) {\n  if (!target) return;\n  if (lang) {\n    try {\n      target.lang = lang;\n    } catch (setLangError) {\n      void setLangError;\n    }\n  }\n  if (direction) {\n    try {\n      target.dir = direction;\n    } catch (setDirError) {\n      void setDirError;\n    }\n  }\n}\n\nconst localeAPI = {\n  DEFAULT_LANGUAGE,\n  RTL_LANGUAGE_CODES: freezeDeep([].concat(RTL_LANGUAGE_CODES)),\n  normalizeLanguageCode,\n  isRtlLanguage,\n  resolveDocumentDirection,\n  applyLocaleMetadata,\n};\n\nfreezeDeep(localeAPI);\n\nregisterOrQueueModule('cineLocale', localeAPI, {\n  category: 'localisation',\n  description: 'Language helpers shared between the runtime core and UI modules.',\n  replace: true,\n}, function (error) {\n  safeWarn('Unable to register cineLocale module.', error);\n});\n\nexposeGlobal('cineLocale', localeAPI, {\n  configurable: true,\n  enumerable: false,\n  writable: false,\n});\n\nexport default localeAPI;\nexport const cineLocale = localeAPI;\n","import cineModuleBase from './base.js';\nimport cineModules from './registry.js';\n\n// (function () {\nfunction fallbackDetectPrimaryScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\n/**\n * DEEP DIVE: The Universal Scope Abstraction\n *\n * This module is the cornerstone of the \"Run Anywhere\" philosophy.\n * It provides a normalized API to interact with the host environment, whether it's:\n * 1. A Modern Browser (window/globalThis)\n * 2. A Web Worker (self)\n * 3. A Node.js Process (global/process) - used for testing and server-side operations.\n *\n * It abstracts away the differences in global object access, creating a consistent\n * surface area for all other modules to attach to.\n */\nconst LOCAL_SCOPE = fallbackDetectPrimaryScope();\n\nfunction resolveArchitecture(scope) {\n  const targetScope = scope || LOCAL_SCOPE;\n\n  /* Require removed for ESM */\n\n  if (targetScope && typeof targetScope.cineModuleArchitecture === 'object') {\n    return targetScope.cineModuleArchitecture;\n  }\n\n  return null;\n}\n\nconst ARCHITECTURE = resolveArchitecture(LOCAL_SCOPE);\n\nconst detectPrimaryScope =\n  ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function'\n    ? ARCHITECTURE.detectGlobalScope\n    : fallbackDetectPrimaryScope;\n\nconst PRIMARY_SCOPE = detectPrimaryScope();\n\nfunction fallbackCollectCandidateScopes(primary) {\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\nconst collectCandidateScopes =\n  ARCHITECTURE && typeof ARCHITECTURE.collectCandidateScopes === 'function'\n    ? function (primary) {\n      return ARCHITECTURE.collectCandidateScopes(primary || PRIMARY_SCOPE);\n    }\n    : function (primary) {\n      return fallbackCollectCandidateScopes(primary || PRIMARY_SCOPE);\n    };\n\nconst tryRequire =\n  ARCHITECTURE && typeof ARCHITECTURE.tryRequire === 'function'\n    ? ARCHITECTURE.tryRequire\n    : function (modulePath) {\n      return null;\n    };\n\nlet resolvedModuleBase;\nlet hasResolvedModuleBase = false;\n\nfunction resolveModuleBase() {\n  if (cineModuleBase && typeof cineModuleBase === 'object') {\n    return cineModuleBase;\n  }\n\n  const scopes = collectCandidateScopes(PRIMARY_SCOPE);\n  if (ARCHITECTURE && typeof ARCHITECTURE.resolveFromScopes === 'function') {\n    const resolved = ARCHITECTURE.resolveFromScopes('cineModuleBase', { scopes });\n    if (resolved && typeof resolved === 'object') {\n      return resolved;\n    }\n  }\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (scope && typeof scope.cineModuleBase === 'object') {\n      return scope.cineModuleBase;\n    }\n  }\n\n  return null;\n}\n\nfunction getModuleBase() {\n  if (!hasResolvedModuleBase) {\n    resolvedModuleBase = resolveModuleBase();\n    hasResolvedModuleBase = true;\n  }\n  return resolvedModuleBase;\n}\n\nlet resolvedGlobalScope;\nlet hasResolvedGlobalScope = false;\n\nfunction getGlobalScope() {\n  if (!hasResolvedGlobalScope) {\n    const moduleBase = getModuleBase();\n    if (moduleBase && typeof moduleBase.getGlobalScope === 'function') {\n      try {\n        const scope = moduleBase.getGlobalScope();\n        resolvedGlobalScope = scope || PRIMARY_SCOPE;\n      } catch (error) {\n        void error;\n        resolvedGlobalScope = PRIMARY_SCOPE;\n      }\n    } else {\n      resolvedGlobalScope = PRIMARY_SCOPE;\n    }\n    hasResolvedGlobalScope = true;\n  }\n  return resolvedGlobalScope;\n}\n\nfunction getCandidateScopes(scope) {\n  const base = getModuleBase();\n  if (base && typeof base.collectCandidateScopes === 'function') {\n    try {\n      const scoped = base.collectCandidateScopes(scope || getGlobalScope());\n      if (Array.isArray(scoped)) {\n        return scoped;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return collectCandidateScopes(scope || getGlobalScope());\n}\n\nfunction getTryRequire() {\n  const base = getModuleBase();\n  if (base && typeof base.tryRequire === 'function') {\n    return base.tryRequire;\n  }\n  return tryRequire;\n}\n\nfunction resolveModuleRegistry(scope) {\n  const base = getModuleBase();\n  const targetScope = scope || getGlobalScope();\n\n  if (base && typeof base.resolveModuleRegistry === 'function') {\n    try {\n      return base.resolveModuleRegistry(targetScope);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (cineModules && typeof cineModules === 'object') {\n    return cineModules;\n  }\n\n  const scopes = getCandidateScopes(targetScope);\n  if (ARCHITECTURE && typeof ARCHITECTURE.resolveFromScopes === 'function') {\n    const resolved = ARCHITECTURE.resolveFromScopes('cineModules', { scopes });\n    if (resolved && typeof resolved === 'object') {\n      return resolved;\n    }\n  }\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const candidate = scopes[index];\n    if (candidate && typeof candidate.cineModules === 'object') {\n      return candidate.cineModules;\n    }\n  }\n\n  return null;\n}\n\nlet resolvedRegistry;\nlet hasResolvedRegistry = false;\n\nfunction getModuleRegistry(scope) {\n  if (scope && scope !== getGlobalScope()) {\n    return resolveModuleRegistry(scope);\n  }\n\n  if (!hasResolvedRegistry) {\n    resolvedRegistry = resolveModuleRegistry(getGlobalScope());\n    hasResolvedRegistry = true;\n  }\n\n  return resolvedRegistry;\n}\n\nfunction getPendingQueueKey() {\n  const base = getModuleBase();\n  if (base && typeof base.PENDING_QUEUE_KEY === 'string') {\n    return base.PENDING_QUEUE_KEY;\n  }\n  return '__cinePendingModuleRegistrations__';\n}\n\nfunction ensureQueue(scope) {\n  if (!scope || typeof scope !== 'object') {\n    return null;\n  }\n\n  const key = getPendingQueueKey();\n  let queue = scope[key];\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  try {\n    Object.defineProperty(scope, key, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: [],\n    });\n    queue = scope[key];\n  } catch (error) {\n    void error;\n    try {\n      if (!Array.isArray(scope[key])) {\n        scope[key] = [];\n      }\n      queue = scope[key];\n    } catch (assignmentError) {\n      void assignmentError;\n      return null;\n    }\n  }\n\n  return queue;\n}\n\nfunction queueModuleRegistrationForScope(scope, name, api, options) {\n  const base = getModuleBase();\n  const targetScope = scope || getGlobalScope();\n\n  if (base && typeof base.queueModuleRegistration === 'function') {\n    try {\n      return base.queueModuleRegistration(name, api, options, targetScope);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const queue = ensureQueue(targetScope);\n  if (!queue) {\n    return false;\n  }\n\n  const payload = Object.freeze({\n    name,\n    api,\n    options: Object.freeze({ ...(options || {}) }),\n  });\n\n  try {\n    queue.push(payload);\n  } catch (error) {\n    void error;\n    queue[queue.length] = payload;\n  }\n\n  return true;\n}\n\nfunction registerOrQueueForScope(scope, registry, name, api, options, onError) {\n  const base = getModuleBase();\n  const targetScope = scope || getGlobalScope();\n  const targetRegistry = registry || getModuleRegistry(targetScope);\n\n  if (base && typeof base.registerOrQueueModule === 'function') {\n    try {\n      return base.registerOrQueueModule(name, api, options, onError, targetScope, targetRegistry);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (targetRegistry && typeof targetRegistry.register === 'function') {\n    try {\n      targetRegistry.register(name, api, options);\n      return true;\n    } catch (error) {\n      if (typeof onError === 'function') {\n        onError(error);\n      } else {\n        void error;\n      }\n    }\n  }\n\n  queueModuleRegistrationForScope(targetScope, name, api, options);\n  return false;\n}\n\nfunction isConsoleCandidate(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (isNodeProcessReference(value)) {\n    return true;\n  }\n\n  if (\n    typeof process !== 'undefined' &&\n    process &&\n    process.release &&\n    process.release.name === 'node'\n  ) {\n    return true;\n  }\n\n  try {\n    let globalConsole = null;\n    try {\n      if (typeof console !== 'undefined' && console) {\n        globalConsole = console;\n      }\n    } catch (accessError) {\n      void accessError;\n    }\n\n    if (globalConsole) {\n      if (value === globalConsole) {\n        return true;\n      }\n      try {\n        if (\n          value.__cameraPowerPlannerOriginal\n          && value.__cameraPowerPlannerOriginal === globalConsole\n        ) {\n          return true;\n        }\n      } catch (proxyCheckError) {\n        void proxyCheckError;\n      }\n    }\n\n    try {\n      if (\n        typeof value.log === 'function'\n        && typeof value.warn === 'function'\n        && typeof value.error === 'function'\n      ) {\n        const ctorName = value.constructor && value.constructor.name;\n        if (ctorName && /Console/i.test(ctorName)) {\n          return true;\n        }\n        if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n          const tag = value[Symbol.toStringTag];\n          if (typeof tag === 'string' && /Console/i.test(tag)) {\n            return true;\n          }\n        }\n      }\n    } catch (inspectionError) {\n      void inspectionError;\n    }\n  } catch (error) {\n    void error;\n    return false;\n  }\n\n  return false;\n}\n\nfunction isNodeModuleCandidate(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  try {\n    if (typeof value.require === 'function' && typeof value.loaded === 'boolean') {\n      if (Array.isArray ? Array.isArray(value.children) : Object.prototype.toString.call(value.children) === '[object Array]') {\n        return true;\n      }\n      if (typeof value.paths !== 'undefined') {\n        return true;\n      }\n    }\n  } catch (inspectionError) {\n    void inspectionError;\n  }\n\n  return false;\n}\n\nfunction isEthereumProviderCandidate(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (PRIMARY_SCOPE && typeof PRIMARY_SCOPE === 'object') {\n    try {\n      if (value === PRIMARY_SCOPE.ethereum) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n      return true;\n    }\n  }\n\n  try {\n    if (value.isMetaMask === true) {\n      return true;\n    }\n  } catch (inspectionError) {\n    if (inspectionError && typeof inspectionError.message === 'string' && /metamask/i.test(inspectionError.message)) {\n      return true;\n    }\n  }\n\n  try {\n    if (typeof value.request === 'function' && typeof value.on === 'function') {\n      if (typeof value.removeListener === 'function' || typeof value.removeEventListener === 'function') {\n        return true;\n      }\n\n      const ctorName = value.constructor && value.constructor.name;\n      if (ctorName && /Ethereum|MetaMask|Provider/i.test(ctorName)) {\n        return true;\n      }\n    }\n  } catch (accessError) {\n    void accessError;\n    return true;\n  }\n\n  return false;\n}\n\n\n\nfunction isNodeProcessReference(value) {\n  if (!value) {\n    return false;\n  }\n\n  if (typeof process === 'undefined' || !process) {\n    return false;\n  }\n\n  if (value === process) {\n    return true;\n  }\n\n  if (typeof value === 'object') {\n    try {\n      if (value.constructor && value.constructor.name === 'process') {\n        return true;\n      }\n    } catch (processInspectionError) {\n      void processInspectionError;\n    }\n\n    if (\n      typeof value.pid === 'number' &&\n      typeof value.nextTick === 'function' &&\n      typeof value.emit === 'function' &&\n      typeof value.binding === 'function'\n    ) {\n      return true;\n    }\n  }\n\n  if (typeof value === 'function') {\n    if (\n      value === process.binding ||\n      value === process._linkedBinding ||\n      value === process.dlopen\n    ) {\n      return true;\n    }\n\n    try {\n      const functionName = value.name || '';\n      if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n        const source = Function.prototype.toString.call(value);\n        if (source && source.indexOf('[native code]') !== -1) {\n          return true;\n        }\n      }\n    } catch (functionInspectionError) {\n      void functionInspectionError;\n    }\n  }\n\n  return false;\n}\n\nfunction shouldBypassDeepFreeze(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  try {\n    if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n      return true;\n    }\n\n    if (typeof value.on === 'function' && typeof value.emit === 'function') {\n      if (typeof value.write === 'function' || typeof value.read === 'function') {\n        return true;\n      }\n\n      const ctorName = value.constructor && value.constructor.name;\n      if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n        return true;\n      }\n    }\n\n    if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n      const tag = value[Symbol.toStringTag];\n      if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n        return true;\n      }\n    }\n  } catch (inspectionError) {\n    void inspectionError;\n  }\n\n  return false;\n}\n\nfunction fallbackResolveSeenTracker(seen) {\n  if (seen && typeof seen.has === 'function' && typeof seen.add === 'function') {\n    return seen;\n  }\n\n  if (Array.isArray(seen)) {\n    return {\n      has(value) {\n        return seen.indexOf(value) !== -1;\n      },\n      add(value) {\n        if (seen.indexOf(value) === -1) {\n          seen.push(value);\n        }\n      },\n    };\n  }\n\n  if (typeof WeakSet === 'function') {\n    try {\n      return new WeakSet();\n    } catch (trackerError) {\n      void trackerError;\n    }\n  }\n\n  const tracked = [];\n  return {\n    has(value) {\n      return tracked.indexOf(value) !== -1;\n    },\n    add(value) {\n      if (tracked.indexOf(value) === -1) {\n        tracked.push(value);\n      }\n    },\n  };\n}\n\nfunction fallbackFreezeDeep(value, seen) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  if (\n    shouldBypassDeepFreeze(value)\n    || isEthereumProviderCandidate(value)\n    || isConsoleCandidate(value)\n    || isNodeModuleCandidate(value)\n  ) {\n    return value;\n  }\n\n  const tracker = fallbackResolveSeenTracker(seen);\n\n  if (tracker.has(value)) {\n    return value;\n  }\n\n  tracker.add(value);\n\n  const keys = Object.getOwnPropertyNames(value);\n  for (let index = 0; index < keys.length; index += 1) {\n    const key = keys[index];\n\n    let descriptor;\n    try {\n      descriptor = Object.getOwnPropertyDescriptor(value, key);\n    } catch (descriptorError) {\n      void descriptorError;\n      descriptor = null;\n    }\n\n    if (\n      descriptor &&\n      (typeof descriptor.get === 'function' || typeof descriptor.set === 'function')\n    ) {\n      continue;\n    }\n\n    let child;\n    try {\n      child = value[key];\n    } catch (accessError) {\n      void accessError;\n      child = undefined;\n    }\n    if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n      continue;\n    }\n\n    if (\n      shouldBypassDeepFreeze(child)\n      || isEthereumProviderCandidate(child)\n      || isConsoleCandidate(child)\n      || isNodeModuleCandidate(child)\n    ) {\n      continue;\n    }\n\n    fallbackFreezeDeep(child, tracker);\n  }\n\n  try {\n    return Object.freeze(value);\n  } catch (freezeError) {\n    void freezeError;\n    return value;\n  }\n}\n\nfunction freezeDeep(value, seen) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  if (\n    shouldBypassDeepFreeze(value)\n    || isEthereumProviderCandidate(value)\n    || isConsoleCandidate(value)\n    || isNodeModuleCandidate(value)\n  ) {\n    return value;\n  }\n\n  const base = getModuleBase();\n  const freeze = base && typeof base.freezeDeep === 'function' ? base.freezeDeep : fallbackFreezeDeep;\n  return freeze(value, seen);\n}\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction safeWarn(message, detail) {\n  const base = getModuleBase();\n  const warn = base && typeof base.safeWarn === 'function' ? base.safeWarn : fallbackSafeWarn;\n  warn(message, detail);\n}\n\nfunction fallbackExposeGlobal(name, value, scope, options = {}) {\n  if (!scope || typeof scope !== 'object') {\n    return false;\n  }\n\n  const descriptor = {\n    configurable: options.configurable !== false,\n    enumerable: !!options.enumerable,\n    value,\n    writable: options.writable === true,\n  };\n\n  try {\n    Object.defineProperty(scope, name, descriptor);\n    return true;\n  } catch (error) {\n    void error;\n    try {\n      scope[name] = value;\n      return true;\n    } catch (assignmentError) {\n      void assignmentError;\n      return false;\n    }\n  }\n}\n\nfunction exposeGlobal(name, value, scope, options) {\n  const targetScope = scope || getGlobalScope();\n  const base = getModuleBase();\n  if (base && typeof base.exposeGlobal === 'function') {\n    return base.exposeGlobal(name, value, targetScope, options);\n  }\n  return fallbackExposeGlobal(name, value, targetScope, options);\n}\n\nfunction createScopedEnvironment(options = {}) {\n  const scope = options && typeof options.scope === 'object' ? options.scope : getGlobalScope();\n  const registry = options && options.registry ? options.registry : getModuleRegistry(scope);\n\n  const environment = {\n    tryRequire(modulePath) {\n      return getTryRequire()(modulePath);\n    },\n    queueModuleRegistration(name, api, queueOptions) {\n      return queueModuleRegistrationForScope(scope, name, api, queueOptions);\n    },\n    registerOrQueueModule(name, api, registerOptions, onError) {\n      return registerOrQueueForScope(scope, registry, name, api, registerOptions, onError);\n    },\n    freezeDeep,\n    safeWarn,\n    exposeGlobal(name, value, exposeOptions) {\n      return exposeGlobal(name, value, scope, exposeOptions);\n    },\n    collectCandidateScopes() {\n      return Object.freeze(getCandidateScopes(scope).slice());\n    },\n    PENDING_QUEUE_KEY: getPendingQueueKey(),\n  };\n\n  Object.defineProperties(environment, {\n    scope: {\n      configurable: false,\n      enumerable: true,\n      get() {\n        return scope;\n      },\n    },\n    registry: {\n      configurable: false,\n      enumerable: true,\n      get() {\n        return registry;\n      },\n    },\n  });\n\n  return freezeDeep(environment);\n}\n\nconst moduleEnvironment = freezeDeep({\n  getModuleBase,\n  getGlobalScope,\n  getModuleRegistry,\n  resolveModuleRegistry,\n  collectCandidateScopes: getCandidateScopes,\n  tryRequire(modulePath) {\n    return getTryRequire()(modulePath);\n  },\n  queueModuleRegistration(name, api, options, scope) {\n    return queueModuleRegistrationForScope(scope || getGlobalScope(), name, api, options);\n  },\n  registerOrQueueModule(name, api, options, onError, scope, registry) {\n    return registerOrQueueForScope(scope || getGlobalScope(), registry, name, api, options, onError);\n  },\n  freezeDeep,\n  safeWarn,\n  exposeGlobal(name, value, scope, options) {\n    return exposeGlobal(name, value, scope || getGlobalScope(), options);\n  },\n  PENDING_QUEUE_KEY: getPendingQueueKey(),\n  createScopedEnvironment,\n});\n\nregisterOrQueueForScope(\n  getGlobalScope(),\n  getModuleRegistry(),\n  'cineModuleEnvironment',\n  moduleEnvironment,\n  {\n    category: 'infrastructure',\n    description: 'Shared environment bootstrap that harmonizes module communication across bundles.',\n    replace: true,\n    connections: ['cineModuleBase', 'cineModuleGlobals', 'cineEnvironmentBridge'],\n  },\n  (error) => {\n    safeWarn('Unable to register cineModuleEnvironment.', error);\n  },\n);\n\nexposeGlobal('cineModuleEnvironment', moduleEnvironment, getGlobalScope(), {\n  configurable: true,\n  enumerable: false,\n  writable: false,\n});\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = moduleEnvironment;\n// }\n// })();\n\nexport const cineModuleEnvironment = moduleEnvironment;\n","/*\n * environment-bridge.js\n * ----------------------\n * Bridges the planner runtime with whichever execution environment loads it.\n * The planner can execute in browsers, worker contexts and Node-based tests,\n * so every helper here double-checks inputs and avoids assumptions that could\n * break persistence or offline restores.\n */\n\nimport { cineModuleEnvironment } from './environment.js';\nimport cineModules from './registry.js';\n\n// (function () {\n// Resolve the most appropriate global scope. This mirrors the pattern used\n// across the runtime so we always end up working with the same window/self\n// reference regardless of how scripts are bundled.\nfunction detectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\nvar PRIMARY_SCOPE = detectGlobalScope();\n\n// Build a deduplicated list of candidate scopes to inspect for runtime\n// bridges. The primary scope is evaluated first so that user-facing state\n// stays anchored to the active window context.\nfunction collectCandidateScopes(primary) {\n  var scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\n// Thin wrapper around require so we can gracefully handle bundlers that do\n// not expose CommonJS helpers. Returning null instead of throwing keeps the\n// boot sequence predictable.\nfunction tryRequireLocal(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\n// Locate the environment module. We prefer direct requires but fall back to\n// scanning known scopes so Service Workers or offline bundles keep working.\nfunction locateModuleEnvironment(scope) {\n  if (cineModuleEnvironment && typeof cineModuleEnvironment === 'object') {\n    return cineModuleEnvironment;\n  }\n\n  var candidates = collectCandidateScopes(scope || PRIMARY_SCOPE);\n  for (var index = 0; index < candidates.length; index += 1) {\n    var candidate = candidates[index];\n    if (candidate && typeof candidate.cineModuleEnvironment === 'object') {\n      return candidate.cineModuleEnvironment;\n    }\n  }\n\n  return null;\n}\n\n// Determine whether deep freezing should be skipped for a given value. Some\n// browser-provided objects (streams, providers) misbehave when frozen, so we\n// explicitly avoid touching them to keep integrations stable.\n\n\nfunction isNodeProcessReference(value) {\n  if (!value) {\n    return false;\n  }\n\n  if (typeof process === 'undefined' || !process) {\n    return false;\n  }\n\n  if (value === process) {\n    return true;\n  }\n\n  if (typeof value === 'object') {\n    try {\n      if (value.constructor && value.constructor.name === 'process') {\n        return true;\n      }\n    } catch (processInspectionError) {\n      void processInspectionError;\n    }\n\n    if (\n      typeof value.pid === 'number' &&\n      typeof value.nextTick === 'function' &&\n      typeof value.emit === 'function' &&\n      typeof value.binding === 'function'\n    ) {\n      return true;\n    }\n  }\n\n  if (typeof value === 'function') {\n    if (\n      value === process.binding ||\n      value === process._linkedBinding ||\n      value === process.dlopen\n    ) {\n      return true;\n    }\n\n    try {\n      const functionName = value.name || '';\n      if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n        const source = Function.prototype.toString.call(value);\n        if (source && source.indexOf('[native code]') !== -1) {\n          return true;\n        }\n      }\n    } catch (functionInspectionError) {\n      void functionInspectionError;\n    }\n  }\n\n  return false;\n}\n\nfunction shouldBypassDeepFreeze(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (isNodeProcessReference(value)) {\n    return true;\n  }\n\n  if (isEthereumProviderCandidate(value)) {\n    return true;\n  }\n\n  try {\n    if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n      return true;\n    }\n\n    if (typeof value.on === 'function' && typeof value.emit === 'function') {\n      if (typeof value.write === 'function' || typeof value.read === 'function') {\n        return true;\n      }\n\n      var ctorName = value.constructor && value.constructor.name;\n      if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n        return true;\n      }\n    }\n\n    if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n      var tag = value[Symbol.toStringTag];\n      if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n        return true;\n      }\n    }\n  } catch (inspectionError) {\n    void inspectionError;\n  }\n\n  return false;\n}\n\n// Heuristic that identifies Ethereum-style provider objects. These are\n// treated as immutable by reference rather than frozen to avoid interfering\n// with wallet extensions the user relies on.\nfunction isEthereumProviderCandidate(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (PRIMARY_SCOPE && typeof PRIMARY_SCOPE === 'object') {\n    try {\n      if (value === PRIMARY_SCOPE.ethereum) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n      return true;\n    }\n  }\n\n  try {\n    if (value.isMetaMask === true) {\n      return true;\n    }\n  } catch (inspectionError) {\n    if (inspectionError && typeof inspectionError.message === 'string' && /metamask/i.test(inspectionError.message)) {\n      return true;\n    }\n  }\n\n  try {\n    if (typeof value.request === 'function' && typeof value.on === 'function') {\n      if (typeof value.removeListener === 'function' || typeof value.removeEventListener === 'function') {\n        return true;\n      }\n\n      var ctorName = value.constructor && value.constructor.name;\n      if (ctorName && /Ethereum|MetaMask|Provider/i.test(ctorName)) {\n        return true;\n      }\n    }\n  } catch (accessError) {\n    void accessError;\n    return true;\n  }\n\n  return false;\n}\n\nfunction fallbackFreezeDeep(value, seen) {\n  var localSeen = seen;\n  if (!localSeen) {\n    if (typeof WeakSet === 'function') {\n      localSeen = new WeakSet();\n    } else {\n      var seenValues = [];\n      localSeen = {\n        add: function add(item) {\n          seenValues.push(item);\n        },\n        has: function has(item) {\n          return seenValues.indexOf(item) !== -1;\n        },\n      };\n    }\n  }\n\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  if (shouldBypassDeepFreeze(value)) {\n    return value;\n  }\n\n  if (typeof process !== 'undefined' && process && process.env && process.env.JEST_WORKER_ID) {\n    try {\n      if (typeof Object.freeze === 'function') {\n        Object.freeze(value);\n      }\n    } catch (freezeError) {\n      void freezeError;\n    }\n    return value;\n  }\n\n  if (isEthereumProviderCandidate(value)) {\n    return value;\n  }\n\n  if (typeof localSeen.has === 'function' && localSeen.has(value)) {\n    return value;\n  }\n\n  if (typeof localSeen.add === 'function') {\n    localSeen.add(value);\n  }\n\n  try {\n    Object.freeze(value);\n  } catch (freezeError) {\n    void freezeError;\n  }\n\n  // Avoid deep traversal to keep cross-context objects from crashing V8\n  // when the bridge is executed inside Node-based test environments.\n  return value;\n}\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction fallbackExposeGlobal(name, value, scope, options) {\n  if (!scope || typeof scope !== 'object') {\n    return false;\n  }\n\n  var descriptor = {\n    configurable: !options || options.configurable !== false,\n    enumerable: !!(options && options.enumerable),\n    value: value,\n    writable: !!(options && options.writable === true),\n  };\n\n  try {\n    Object.defineProperty(scope, name, descriptor);\n    return true;\n  } catch (error) {\n    void error;\n    try {\n      scope[name] = value;\n      return true;\n    } catch (assignmentError) {\n      void assignmentError;\n      return false;\n    }\n  }\n}\n\nfunction ensureQueue(scope, key) {\n  if (!scope || typeof scope !== 'object') {\n    return null;\n  }\n\n  var queue = null;\n  try {\n    queue = scope[key];\n  } catch (readError) {\n    void readError;\n    queue = null;\n  }\n\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  try {\n    Object.defineProperty(scope, key, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: [],\n    });\n    queue = scope[key];\n  } catch (error) {\n    void error;\n    try {\n      if (!Array.isArray(scope[key])) {\n        scope[key] = [];\n      }\n      queue = scope[key];\n    } catch (assignmentError) {\n      void assignmentError;\n      return null;\n    }\n  }\n\n  return queue;\n}\n\nfunction shallowCopyOptions(options) {\n  if (!options || typeof options !== 'object') {\n    return {};\n  }\n\n  var copy = {};\n  var keys = [];\n\n  try {\n    keys = Object.keys(options);\n  } catch (error) {\n    void error;\n    keys = [];\n  }\n\n  for (var index = 0; index < keys.length; index += 1) {\n    var key = keys[index];\n    try {\n      copy[key] = options[key];\n    } catch (readError) {\n      void readError;\n    }\n  }\n\n  return copy;\n}\n\nfunction createFallbackEnvironment(scope) {\n  var targetScope = scope || PRIMARY_SCOPE;\n  var pendingKey = '__cinePendingModuleRegistrations__';\n  var registryCache = null;\n  var hasRegistry = false;\n\n  function resolveModuleRegistryForScope(candidateScope) {\n    if (cineModules && typeof cineModules === 'object') {\n      return cineModules;\n    }\n\n    var scopes = collectCandidateScopes(candidateScope);\n    for (var index = 0; index < scopes.length; index += 1) {\n      var candidate = scopes[index];\n      if (candidate && typeof candidate.cineModules === 'object') {\n        return candidate.cineModules;\n      }\n    }\n\n    return null;\n  }\n\n  function getModuleRegistry() {\n    if (!hasRegistry) {\n      registryCache = resolveModuleRegistryForScope(targetScope);\n      hasRegistry = true;\n    }\n    return registryCache;\n  }\n\n  function queueModuleRegistration(name, api, options) {\n    var queue = ensureQueue(targetScope, pendingKey);\n    if (!queue) {\n      return false;\n    }\n\n    var payloadOptions = Object.freeze(shallowCopyOptions(options));\n    var payload = Object.freeze({\n      name: name,\n      api: api,\n      options: payloadOptions,\n    });\n\n    try {\n      queue.push(payload);\n    } catch (error) {\n      void error;\n      queue[queue.length] = payload;\n    }\n\n    return true;\n  }\n\n  function registerOrQueueModule(name, api, options, onError) {\n    var registry = getModuleRegistry();\n    if (registry && typeof registry.register === 'function') {\n      try {\n        registry.register(name, api, options || {});\n        return true;\n      } catch (error) {\n        if (typeof onError === 'function') {\n          try {\n            onError(error);\n          } catch (callbackError) {\n            void callbackError;\n          }\n        } else {\n          void error;\n        }\n      }\n    }\n\n    return queueModuleRegistration(name, api, options);\n  }\n\n  function collectScopesCopy() {\n    var scopes = collectCandidateScopes(targetScope);\n    return scopes.slice();\n  }\n\n  return {\n    scope: targetScope,\n    registry: getModuleRegistry(),\n    tryRequire: function tryRequire(modulePath) {\n      return tryRequireLocal(modulePath);\n    },\n    queueModuleRegistration: function queueModuleRegistrationBridge(name, api, options) {\n      return queueModuleRegistration(name, api, options);\n    },\n    registerOrQueueModule: function registerOrQueueModuleBridge(name, api, options, onError) {\n      return registerOrQueueModule(name, api, options, onError);\n    },\n    freezeDeep: function freezeDeepBridge(value, seen) {\n      return fallbackFreezeDeep(value, seen);\n    },\n    safeWarn: function safeWarnBridge(message, detail) {\n      fallbackSafeWarn(message, detail);\n    },\n    exposeGlobal: function exposeGlobalBridge(name, value, options) {\n      return fallbackExposeGlobal(name, value, targetScope, options || {});\n    },\n    collectCandidateScopes: function collectCandidateScopesBridge() {\n      return Object.freeze(collectScopesCopy());\n    },\n    PENDING_QUEUE_KEY: pendingKey,\n  };\n}\n\nfunction buildDescriptor(scope) {\n  var targetScope = scope || PRIMARY_SCOPE;\n  var moduleEnv = locateModuleEnvironment(targetScope);\n\n  if (moduleEnv && typeof moduleEnv.createScopedEnvironment === 'function') {\n    try {\n      var scoped = moduleEnv.createScopedEnvironment({ scope: targetScope });\n      if (scoped && typeof scoped === 'object') {\n        return {\n          scope: scoped.scope || targetScope,\n          moduleEnv: moduleEnv,\n          environment: scoped,\n        };\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  var fallbackEnvironment = createFallbackEnvironment(targetScope);\n  return {\n    scope: fallbackEnvironment.scope || targetScope,\n    moduleEnv: moduleEnv || null,\n    environment: fallbackEnvironment,\n  };\n}\n\nvar cachedDescriptor = null;\n\nfunction ensureDescriptor() {\n  if (!cachedDescriptor) {\n    cachedDescriptor = buildDescriptor(PRIMARY_SCOPE);\n  }\n  return cachedDescriptor;\n}\n\nfunction refreshDescriptor(options) {\n  var nextScope = options && options.scope ? options.scope : PRIMARY_SCOPE;\n  cachedDescriptor = buildDescriptor(nextScope);\n  return cachedDescriptor;\n}\n\nfunction safeInvoke(fn, fallback) {\n  try {\n    return fn();\n  } catch (error) {\n    void error;\n    return fallback;\n  }\n}\n\nfunction getGlobalScope() {\n  return ensureDescriptor().scope;\n}\n\nfunction getEnvironment() {\n  return ensureDescriptor().environment;\n}\n\nfunction getModuleEnvironment() {\n  return ensureDescriptor().moduleEnv;\n}\n\nfunction getModuleRegistry(scope) {\n  if (scope && scope !== getGlobalScope()) {\n    var moduleEnv = getModuleEnvironment();\n    if (moduleEnv && typeof moduleEnv.getModuleRegistry === 'function') {\n      return safeInvoke(function () {\n        return moduleEnv.getModuleRegistry(scope);\n      }, null);\n    }\n    var refreshed = buildDescriptor(scope);\n    return refreshed.environment && refreshed.environment.registry\n      ? refreshed.environment.registry\n      : null;\n  }\n\n  var descriptor = ensureDescriptor();\n  if (descriptor.environment && descriptor.environment.registry) {\n    return descriptor.environment.registry;\n  }\n\n  var targetModuleEnv = descriptor.moduleEnv;\n  if (targetModuleEnv && typeof targetModuleEnv.getModuleRegistry === 'function') {\n    return safeInvoke(function () {\n      return targetModuleEnv.getModuleRegistry(descriptor.scope);\n    }, null);\n  }\n\n  return null;\n}\n\nfunction tryRequire(modulePath) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.tryRequire === 'function') {\n    var envResult = safeInvoke(function () {\n      return environment.tryRequire(modulePath);\n    }, undefined);\n    if (typeof envResult !== 'undefined') {\n      return envResult;\n    }\n  }\n\n  var moduleEnv = getModuleEnvironment();\n  if (moduleEnv && typeof moduleEnv.tryRequire === 'function') {\n    var moduleResult = safeInvoke(function () {\n      return moduleEnv.tryRequire(modulePath);\n    }, undefined);\n    if (typeof moduleResult !== 'undefined') {\n      return moduleResult;\n    }\n  }\n\n  return tryRequireLocal(modulePath);\n}\n\nfunction queueModuleRegistration(name, api, options) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.queueModuleRegistration === 'function') {\n    return safeInvoke(function () {\n      return environment.queueModuleRegistration(name, api, options);\n    }, false);\n  }\n\n  var fallback = createFallbackEnvironment(getGlobalScope());\n  return fallback.queueModuleRegistration(name, api, options);\n}\n\nfunction registerOrQueueModule(name, api, options, onError, scope) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.registerOrQueueModule === 'function') {\n    return safeInvoke(function () {\n      return environment.registerOrQueueModule(name, api, options, onError);\n    }, false);\n  }\n\n  var targetScope = scope || getGlobalScope();\n  var fallback = createFallbackEnvironment(targetScope);\n  return fallback.registerOrQueueModule(name, api, options, onError);\n}\n\nfunction freezeDeep(value, seen) {\n  return fallbackFreezeDeep(value, seen);\n}\n\nfunction safeWarn(message, detail) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.safeWarn === 'function') {\n    safeInvoke(function () {\n      environment.safeWarn(message, detail);\n    }, undefined);\n    return;\n  }\n  fallbackSafeWarn(message, detail);\n}\n\nfunction exposeGlobal(name, value, scope, options) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.exposeGlobal === 'function') {\n    return safeInvoke(function () {\n      return environment.exposeGlobal(name, value, options);\n    }, false);\n  }\n  return fallbackExposeGlobal(name, value, scope || getGlobalScope(), options || {});\n}\n\nfunction collectCandidateScopesFor(scope) {\n  var environment = getEnvironment();\n  if (environment && typeof environment.collectCandidateScopes === 'function') {\n    var result = safeInvoke(function () {\n      return environment.collectCandidateScopes(scope);\n    }, []);\n    if (Array.isArray(result)) {\n      return result.slice();\n    }\n  }\n\n  return collectCandidateScopes(scope || getGlobalScope());\n}\n\nfunction getPendingQueueKey() {\n  var environment = getEnvironment();\n  if (environment && typeof environment.PENDING_QUEUE_KEY === 'string') {\n    return environment.PENDING_QUEUE_KEY;\n  }\n\n  var moduleEnv = getModuleEnvironment();\n  if (moduleEnv && typeof moduleEnv.PENDING_QUEUE_KEY === 'string') {\n    return moduleEnv.PENDING_QUEUE_KEY;\n  }\n\n  return '__cinePendingModuleRegistrations__';\n}\n\nvar bridge = Object.freeze({\n  getGlobalScope: getGlobalScope,\n  getEnvironment: getEnvironment,\n  getModuleEnvironment: getModuleEnvironment,\n  getModuleRegistry: getModuleRegistry,\n  tryRequire: tryRequire,\n  queueModuleRegistration: queueModuleRegistration,\n  registerOrQueueModule: registerOrQueueModule,\n  freezeDeep: freezeDeep,\n  safeWarn: safeWarn,\n  exposeGlobal: function exposeGlobalDefault(name, value, options) {\n    return exposeGlobal(name, value, getGlobalScope(), options || {});\n  },\n  exposeGlobalScoped: function exposeGlobalScoped(name, value, scope, options) {\n    return exposeGlobal(name, value, scope || getGlobalScope(), options || {});\n  },\n  collectCandidateScopes: function collectCandidateScopesDefault(scope) {\n    return Object.freeze(collectCandidateScopesFor(scope));\n  },\n  getPendingQueueKey: getPendingQueueKey,\n  refresh: function refresh(options) {\n    return Object.freeze(refreshDescriptor(options || {}));\n  },\n});\n\nvar globalScope = getGlobalScope();\nif (globalScope && typeof globalScope === 'object') {\n  try {\n    Object.defineProperty(globalScope, 'cineEnvironmentBridge', {\n      configurable: true,\n      enumerable: false,\n      writable: false,\n      value: bridge,\n    });\n  } catch (error) {\n    void error;\n    try {\n      globalScope.cineEnvironmentBridge = bridge;\n    } catch (assignmentError) {\n      void assignmentError;\n    }\n  }\n}\n\nvar registry = getModuleRegistry();\nif (registry && typeof registry.register === 'function') {\n  try {\n    registry.register('cineEnvironmentBridge', bridge, {\n      category: 'infrastructure',\n      description: 'Provides consistent global environment access between Cine modules.',\n      replace: true,\n      connections: ['cineModuleEnvironment', 'cineModuleGlobals'],\n    });\n  } catch (error) {\n    safeWarn('Unable to register cineEnvironmentBridge.', error);\n  }\n} else {\n  queueModuleRegistration('cineEnvironmentBridge', bridge, {\n    category: 'infrastructure',\n    description: 'Provides consistent global environment access between Cine modules.',\n    replace: true,\n    connections: ['cineModuleEnvironment', 'cineModuleGlobals'],\n  });\n}\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = bridge;\n// }\n// })();\n\nexport const cineEnvironmentBridge = bridge;\n","(function () {\n  /**\n   * The offline module coordinates how the planner behaves when network access\n   * disappears. Clear documentation keeps the lifecycle predictable, which is\n   * crucial because offline caching and restore flows protect the user's work.\n   */\n  function detectGlobalScope() {\n    // The scope discovery mirrors the persistence module so that both features\n    // are always aligned. Every branch is intentionally ordered by likelihood.\n    if (typeof globalThis !== 'undefined') {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n      return window;\n    }\n    if (typeof self !== 'undefined') {\n      return self;\n    }\n    if (typeof global !== 'undefined') {\n      return global;\n    }\n    return {};\n  }\n\n  const FALLBACK_SCOPE = detectGlobalScope();\n\n  /**\n   * DEEP DIVE: Connectivity Probe Strategy\n   *\n   * Browsers lie about offline status (`navigator.onLine`). True connectivity\n   * can only be determined by actively probing a reliable endpoint.\n   *\n   * Constants:\n   * - `__cineReloadProbe__`: A cache-busting query param used to force a network request.\n   * - `x-cine-connectivity-probe`: A custom header that the Service Worker intercepts.\n   * - `cine-sw-logs`: A BroadcastChannel used to coordinate state between the SW and the UI thread.\n   */\n  const CONNECTIVITY_PROBE_QUERY_PARAM = '__cineReloadProbe__';\n  const CONNECTIVITY_PROBE_HEADER = 'x-cine-connectivity-probe';\n  const CONNECTIVITY_PROBE_RESULT_HEADER = 'x-cine-connectivity-probe-result';\n  const CONNECTIVITY_PROBE_RESULT_NETWORK = 'network';\n  const CONNECTIVITY_PROBE_RESULT_FALLBACK = 'fallback';\n  const SERVICE_WORKER_LOG_CHANNEL = 'cine-sw-logs';\n  const CONNECTIVITY_STATUS_MESSAGE_TYPE = 'cine-sw:connectivity-status';\n\n  /**\n   * Resolve the shared module linker which exposes already-booted runtime\n   * components. We keep the lookup defensive because offline start-up must\n   * never fail even if a linker was not registered yet.\n   */\n  function resolveModuleLinker(scope) {\n    if (typeof require === 'function') {\n      try {\n        return require('./helpers/module-linker.js');\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const candidates = [scope];\n    if (typeof globalThis !== 'undefined' && candidates.indexOf(globalThis) === -1) candidates.push(globalThis);\n    if (typeof window !== 'undefined' && candidates.indexOf(window) === -1) candidates.push(window);\n    if (typeof self !== 'undefined' && candidates.indexOf(self) === -1) candidates.push(self);\n    if (typeof global !== 'undefined' && candidates.indexOf(global) === -1) candidates.push(global);\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      try {\n        const linker = candidate && candidate.cineModuleLinker;\n        if (linker && typeof linker === 'object') {\n          return linker;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * When the linker is unavailable we fall back to the environment helpers that\n   * other modules stash on the global scope. This mirrors how service workers\n   * hydrate their utilities during startup and keeps offline mode synchronous.\n   */\n  function fallbackLoadModuleEnvironment(scope) {\n    if (typeof require === 'function') {\n      try {\n        return require('./environment.js');\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const candidates = [scope];\n    if (typeof globalThis !== 'undefined' && candidates.indexOf(globalThis) === -1) candidates.push(globalThis);\n    if (typeof window !== 'undefined' && candidates.indexOf(window) === -1) candidates.push(window);\n    if (typeof self !== 'undefined' && candidates.indexOf(self) === -1) candidates.push(self);\n    if (typeof global !== 'undefined' && candidates.indexOf(global) === -1) candidates.push(global);\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      if (candidate && typeof candidate.cineModuleEnvironment === 'object') {\n        return candidate.cineModuleEnvironment;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * The bridge exposes lightweight wrappers around storage and messaging. By\n   * reusing the same discovery process we avoid creating duplicate bridges that\n   * could drift apart and risk inconsistent offline queues.\n   */\n  function fallbackLoadEnvironmentBridge(scope) {\n    if (typeof require === 'function') {\n      try {\n        return require('./environment-bridge.js');\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const candidates = [scope];\n    if (typeof globalThis !== 'undefined' && candidates.indexOf(globalThis) === -1) candidates.push(globalThis);\n    if (typeof window !== 'undefined' && candidates.indexOf(window) === -1) candidates.push(window);\n    if (typeof self !== 'undefined' && candidates.indexOf(self) === -1) candidates.push(self);\n    if (typeof global !== 'undefined' && candidates.indexOf(global) === -1) candidates.push(global);\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      if (candidate && typeof candidate.cineEnvironmentBridge === 'object') {\n        return candidate.cineEnvironmentBridge;\n      }\n    }\n\n    return null;\n  }\n\n  const MODULE_LINKER = resolveModuleLinker(FALLBACK_SCOPE);\n\n  const MODULE_ENV = MODULE_LINKER && typeof MODULE_LINKER.getModuleEnvironment === 'function'\n    ? MODULE_LINKER.getModuleEnvironment()\n    : fallbackLoadModuleEnvironment(FALLBACK_SCOPE);\n\n  const ENV_BRIDGE = MODULE_LINKER && typeof MODULE_LINKER.getEnvironmentBridge === 'function'\n    ? MODULE_LINKER.getEnvironmentBridge()\n    : fallbackLoadEnvironmentBridge(FALLBACK_SCOPE);\n\n  const GLOBAL_SCOPE = (MODULE_LINKER && typeof MODULE_LINKER.getGlobalScope === 'function'\n    ? MODULE_LINKER.getGlobalScope()\n    : null)\n    || (ENV_BRIDGE && typeof ENV_BRIDGE.getGlobalScope === 'function'\n      ? ENV_BRIDGE.getGlobalScope()\n      : null)\n    || (MODULE_ENV && typeof MODULE_ENV.getGlobalScope === 'function'\n      ? MODULE_ENV.getGlobalScope()\n      : null)\n    || FALLBACK_SCOPE;\n\n  /**\n   * Retrieve module globals lazily so we remain compatible with window and\n   * worker contexts alike. The guard keeps us from assuming that globals exist\n   * which is vital for predictable offline recovery.\n   */\n  function fallbackResolveModuleGlobals() {\n    if (typeof require === 'function') {\n      try {\n        const required = require('./globals.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const candidates = [GLOBAL_SCOPE];\n    if (typeof globalThis !== 'undefined' && candidates.indexOf(globalThis) === -1) candidates.push(globalThis);\n    if (typeof window !== 'undefined' && candidates.indexOf(window) === -1) candidates.push(window);\n    if (typeof self !== 'undefined' && candidates.indexOf(self) === -1) candidates.push(self);\n    if (typeof global !== 'undefined' && candidates.indexOf(global) === -1) candidates.push(global);\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      if (candidate && typeof candidate.cineModuleGlobals === 'object') {\n        return candidate.cineModuleGlobals;\n      }\n    }\n\n    return null;\n  }\n\n  const MODULE_GLOBALS = (MODULE_LINKER && typeof MODULE_LINKER.getModuleGlobals === 'function'\n    ? MODULE_LINKER.getModuleGlobals()\n    : null)\n    || fallbackResolveModuleGlobals();\n\n  let connectivityBroadcastChannel = null;\n  let connectivityBroadcastFailed = false;\n  let connectivityState = null;\n  const connectivityListeners = new Set();\n\n  function sanitizeConnectivityError(error) {\n    if (!error) {\n      return null;\n    }\n\n    if (typeof error === 'string') {\n      return error;\n    }\n\n    if (typeof error === 'number') {\n      return Number.isFinite(error) ? error : null;\n    }\n\n    if (typeof error === 'boolean') {\n      return error;\n    }\n\n    if (typeof error === 'object') {\n      const normalized = {};\n      const name = typeof error.name === 'string' && error.name ? error.name : null;\n      const message = typeof error.message === 'string' && error.message ? error.message : null;\n      const code = typeof error.code === 'string' && error.code ? error.code : null;\n      if (name) {\n        normalized.name = name;\n      }\n      if (message) {\n        normalized.message = message;\n      }\n      if (code) {\n        normalized.code = code;\n      }\n      if (typeof error.status === 'number' && Number.isFinite(error.status)) {\n        normalized.status = error.status;\n      }\n      if (typeof error.type === 'string' && error.type) {\n        normalized.type = error.type;\n      }\n      if (Object.keys(normalized).length === 0) {\n        try {\n          const stringified = String(error);\n          if (stringified && stringified !== '[object Object]') {\n            return stringified;\n          }\n        } catch (stringifyError) {\n          void stringifyError;\n        }\n        return null;\n      }\n      return normalized;\n    }\n\n    try {\n      return String(error);\n    } catch (stringifyError) {\n      void stringifyError;\n      return null;\n    }\n  }\n\n  function normalizeConnectivityDetail(detail) {\n    if (!detail) {\n      return null;\n    }\n\n    if (typeof detail !== 'object') {\n      return sanitizeConnectivityError(detail);\n    }\n\n    const normalized = {};\n\n    if (typeof detail.status === 'number' && Number.isFinite(detail.status)) {\n      normalized.status = detail.status;\n    }\n\n    if (typeof detail.statusText === 'string' && detail.statusText) {\n      normalized.statusText = detail.statusText;\n    }\n\n    if (typeof detail.probeResult === 'string' && detail.probeResult) {\n      normalized.probeResult = detail.probeResult;\n    }\n\n    if (typeof detail.reason === 'string' && detail.reason) {\n      normalized.reason = detail.reason;\n    }\n\n    if (typeof detail.stage === 'string' && detail.stage) {\n      normalized.stage = detail.stage;\n    }\n\n    if (typeof detail.source === 'string' && detail.source) {\n      normalized.source = detail.source;\n    }\n\n    if (typeof detail.message === 'string' && detail.message) {\n      normalized.message = detail.message;\n    }\n\n    if (typeof detail.code === 'string' && detail.code) {\n      normalized.code = detail.code;\n    }\n\n    if (detail.head && typeof detail.head === 'object') {\n      const headDetail = normalizeConnectivityDetail(detail.head);\n      if (headDetail) {\n        normalized.head = headDetail;\n      }\n    }\n\n    if (detail.error) {\n      const errorDetail = sanitizeConnectivityError(detail.error);\n      if (errorDetail) {\n        normalized.error = errorDetail;\n      }\n    }\n\n    if (detail.detail && typeof detail.detail === 'object' && detail.detail !== detail) {\n      const nested = normalizeConnectivityDetail(detail.detail);\n      if (nested) {\n        normalized.detail = nested;\n      }\n    }\n\n    if (!Object.keys(normalized).length) {\n      return null;\n    }\n\n    return normalized;\n  }\n\n  function getConnectivityBroadcastChannel() {\n    if (connectivityBroadcastFailed) {\n      return null;\n    }\n\n    if (connectivityBroadcastChannel) {\n      return connectivityBroadcastChannel;\n    }\n\n    if (typeof BroadcastChannel !== 'function') {\n      connectivityBroadcastFailed = true;\n      return null;\n    }\n\n    try {\n      connectivityBroadcastChannel = new BroadcastChannel(SERVICE_WORKER_LOG_CHANNEL);\n      return connectivityBroadcastChannel;\n    } catch (error) {\n      connectivityBroadcastFailed = true;\n      safeWarn('cineOffline: Unable to open connectivity broadcast channel', error);\n      return null;\n    }\n  }\n\n  function assignGlobalConnectivityState(state) {\n    if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n      return;\n    }\n\n    try {\n      GLOBAL_SCOPE.cineConnectivityStatus = state;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  function notifyConnectivityListeners(state) {\n    connectivityListeners.forEach((listener) => {\n      try {\n        listener(state);\n      } catch (error) {\n        safeWarn('cineOffline: connectivity listener failed', error);\n      }\n    });\n  }\n\n  function broadcastConnectivityState(state) {\n    const channel = getConnectivityBroadcastChannel();\n    if (!channel) {\n      return;\n    }\n\n    try {\n      channel.postMessage({\n        type: CONNECTIVITY_STATUS_MESSAGE_TYPE,\n        state,\n      });\n    } catch (error) {\n      safeWarn('cineOffline: Unable to broadcast connectivity state', error);\n      try {\n        channel.close();\n      } catch (closeError) {\n        void closeError;\n      }\n      connectivityBroadcastChannel = null;\n      connectivityBroadcastFailed = true;\n    }\n  }\n\n  function freezeConnectivityState(nextState) {\n    try {\n      return freezeDeep(nextState);\n    } catch (error) {\n      safeWarn('cineOffline: Unable to freeze connectivity state', error);\n      return nextState;\n    }\n  }\n\n  function buildConnectivityState(update) {\n    const previous = connectivityState && typeof connectivityState === 'object'\n      ? connectivityState\n      : {\n        status: 'unknown',\n        reason: null,\n        detail: null,\n        timestamp: Date.now(),\n        source: 'cineOffline',\n      };\n\n    const next = {\n      status: typeof update.status === 'string' && update.status ? update.status : previous.status || 'unknown',\n      reason: typeof update.reason === 'string' && update.reason ? update.reason : null,\n      detail: typeof update.detail === 'undefined' ? previous.detail : normalizeConnectivityDetail(update.detail),\n      timestamp: typeof update.timestamp === 'number' && Number.isFinite(update.timestamp)\n        ? update.timestamp\n        : Date.now(),\n      source: typeof update.source === 'string' && update.source ? update.source : (previous.source || 'cineOffline'),\n    };\n\n    return freezeConnectivityState(next);\n  }\n\n  function updateOfflineUi(state) {\n    if (typeof document === 'undefined' || !document) {\n      return;\n    }\n\n    const indicator = document.getElementById('offlineIndicator');\n    if (!indicator) {\n      return;\n    }\n\n    if (state.status === 'offline') {\n      if (typeof indicator.removeAttribute === 'function') {\n        indicator.removeAttribute('hidden');\n      }\n      // If we have a reason, we could display it, but keeping it simple for now\n    } else {\n      if (typeof indicator.setAttribute === 'function') {\n        indicator.setAttribute('hidden', '');\n      }\n    }\n  }\n\n  function emitConnectivityState(update) {\n    if (!update || typeof update !== 'object') {\n      return connectivityState;\n    }\n\n    const nextState = buildConnectivityState(update);\n\n    if (\n      connectivityState &&\n      connectivityState.status === nextState.status &&\n      connectivityState.reason === nextState.reason &&\n      connectivityState.detail === nextState.detail &&\n      connectivityState.source === nextState.source\n    ) {\n      connectivityState = nextState;\n      assignGlobalConnectivityState(nextState);\n      updateOfflineUi(nextState);\n      return connectivityState;\n    }\n\n    connectivityState = nextState;\n    assignGlobalConnectivityState(nextState);\n    updateOfflineUi(nextState);\n    notifyConnectivityListeners(nextState);\n    broadcastConnectivityState(nextState);\n    return connectivityState;\n  }\n\n  /**\n   * Publish the module API to the runtime registry. Broadcasting the interface\n   * allows other modules (for example persistence) to coordinate with offline\n   * helpers without creating tight coupling.\n   */\n  function informModuleGlobals(name, api) {\n    if (MODULE_LINKER && typeof MODULE_LINKER.recordModule === 'function') {\n      MODULE_LINKER.recordModule(name, api);\n    }\n\n    if (!MODULE_GLOBALS || typeof MODULE_GLOBALS.recordModule !== 'function') {\n      return;\n    }\n\n    try {\n      MODULE_GLOBALS.recordModule(name, api);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  function fallbackTryRequire(modulePath) {\n    if (typeof require !== 'function') {\n      return null;\n    }\n\n    try {\n      return require(modulePath);\n    } catch (error) {\n      void error;\n      return null;\n    }\n  }\n\n  const tryRequire = (function resolveTryRequire() {\n    if (MODULE_LINKER && typeof MODULE_LINKER.tryRequire === 'function') {\n      return MODULE_LINKER.tryRequire;\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.tryRequire === 'function') {\n      return MODULE_GLOBALS.tryRequire;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.tryRequire === 'function') {\n      return function bridgeTryRequire(modulePath) {\n        const result = ENV_BRIDGE.tryRequire(modulePath);\n        return typeof result === 'undefined' ? fallbackTryRequire(modulePath) : result;\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.tryRequire === 'function') {\n      return MODULE_ENV.tryRequire;\n    }\n\n    return fallbackTryRequire;\n  })();\n\n  function resolveModuleRegistry(scope) {\n    const targetScope = scope || GLOBAL_SCOPE;\n\n    if (MODULE_LINKER && typeof MODULE_LINKER.getModuleRegistry === 'function') {\n      const linked = MODULE_LINKER.getModuleRegistry(targetScope);\n      if (linked) {\n        return linked;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.resolveModuleRegistry === 'function') {\n      try {\n        const resolved = MODULE_GLOBALS.resolveModuleRegistry(targetScope);\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getModuleRegistry === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.getModuleRegistry(targetScope);\n        if (bridged) {\n          return bridged;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.resolveModuleRegistry === 'function') {\n      try {\n        const provided = MODULE_ENV.resolveModuleRegistry(targetScope);\n        if (provided) {\n          return provided;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const required = tryRequire('./registry.js');\n    if (required && typeof required === 'object') {\n      return required;\n    }\n\n    const scopes = [targetScope];\n    if (typeof globalThis !== 'undefined' && scopes.indexOf(globalThis) === -1) scopes.push(globalThis);\n    if (typeof window !== 'undefined' && scopes.indexOf(window) === -1) scopes.push(window);\n    if (typeof self !== 'undefined' && scopes.indexOf(self) === -1) scopes.push(self);\n    if (typeof global !== 'undefined' && scopes.indexOf(global) === -1) scopes.push(global);\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      const candidate = scopes[index];\n      if (candidate && typeof candidate.cineModules === 'object') {\n        return candidate.cineModules;\n      }\n    }\n\n    return null;\n  }\n\n  const MODULE_REGISTRY = (function () {\n    if (MODULE_LINKER && typeof MODULE_LINKER.getModuleRegistry === 'function') {\n      const linkedRegistry = MODULE_LINKER.getModuleRegistry(GLOBAL_SCOPE);\n      if (linkedRegistry) {\n        return linkedRegistry;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.getModuleRegistry === 'function') {\n      try {\n        const shared = MODULE_GLOBALS.getModuleRegistry(GLOBAL_SCOPE);\n        if (shared) {\n          return shared;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getModuleRegistry === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.getModuleRegistry(GLOBAL_SCOPE);\n        if (bridged) {\n          return bridged;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.getModuleRegistry === 'function') {\n      try {\n        const provided = MODULE_ENV.getModuleRegistry(GLOBAL_SCOPE);\n        if (provided) {\n          return provided;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    return resolveModuleRegistry(GLOBAL_SCOPE);\n  })();\n\n  const PENDING_QUEUE_KEY = (function resolvePendingKey() {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.getPendingQueueKey === 'function') {\n      try {\n        const sharedKey = MODULE_GLOBALS.getPendingQueueKey();\n        if (typeof sharedKey === 'string' && sharedKey) {\n          return sharedKey;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getPendingQueueKey === 'function') {\n      try {\n        const bridgedKey = ENV_BRIDGE.getPendingQueueKey();\n        if (typeof bridgedKey === 'string' && bridgedKey) {\n          return bridgedKey;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.PENDING_QUEUE_KEY === 'string') {\n      return MODULE_ENV.PENDING_QUEUE_KEY;\n    }\n\n    return '__cinePendingModuleRegistrations__';\n  })();\n\n  function cloneOptions(options) {\n    if (!options || typeof options !== 'object') {\n      return {};\n    }\n\n    const copy = {};\n    const keys = Object.keys(options);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      copy[key] = options[key];\n    }\n\n    return copy;\n  }\n\n  function fallbackQueueModuleRegistration(name, api, options) {\n    if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n      return false;\n    }\n\n    const payload = Object.freeze({\n      name,\n      api,\n      options: Object.freeze(cloneOptions(options)),\n    });\n\n    let queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n    if (!Array.isArray(queue)) {\n      try {\n        Object.defineProperty(GLOBAL_SCOPE, PENDING_QUEUE_KEY, {\n          configurable: true,\n          enumerable: false,\n          writable: true,\n          value: [],\n        });\n        queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n      } catch (error) {\n        void error;\n        try {\n          if (!Array.isArray(GLOBAL_SCOPE[PENDING_QUEUE_KEY])) {\n            GLOBAL_SCOPE[PENDING_QUEUE_KEY] = [];\n          }\n          queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n        } catch (assignmentError) {\n          void assignmentError;\n          return false;\n        }\n      }\n    }\n\n    try {\n      queue.push(payload);\n    } catch (error) {\n      void error;\n      queue[queue.length] = payload;\n    }\n\n    return true;\n  }\n\n  function queueModuleRegistration(name, api, options) {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.queueModuleRegistration === 'function') {\n      try {\n        if (MODULE_GLOBALS.queueModuleRegistration(name, api, options, GLOBAL_SCOPE)) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.queueModuleRegistration === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.queueModuleRegistration(name, api, options);\n        if (bridged) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.queueModuleRegistration === 'function') {\n      return MODULE_ENV.queueModuleRegistration(name, api, options, GLOBAL_SCOPE);\n    }\n\n    return fallbackQueueModuleRegistration(name, api, options);\n  }\n\n  function fallbackRegisterOrQueue(name, api, options, onError) {\n    if (MODULE_REGISTRY && typeof MODULE_REGISTRY.register === 'function') {\n      try {\n        MODULE_REGISTRY.register(name, api, options);\n        return true;\n      } catch (error) {\n        if (typeof onError === 'function') {\n          try {\n            onError(error);\n          } catch (callbackError) {\n            void callbackError;\n          }\n        } else {\n          void error;\n        }\n      }\n    }\n\n    queueModuleRegistration(name, api, options);\n    return false;\n  }\n\n  const registerOrQueueModule = (function resolveRegisterOrQueue() {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        try {\n          const registered = MODULE_GLOBALS.registerOrQueueModule(\n            name,\n            api,\n            options,\n            onError,\n            GLOBAL_SCOPE,\n            MODULE_REGISTRY,\n          );\n          if (registered) {\n            return true;\n          }\n        } catch (error) {\n          void error;\n        }\n\n        return fallbackRegisterOrQueue(name, api, options, onError);\n      };\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        try {\n          const bridged = ENV_BRIDGE.registerOrQueueModule(name, api, options, onError, GLOBAL_SCOPE, MODULE_REGISTRY);\n          if (bridged) {\n            return true;\n          }\n        } catch (error) {\n          void error;\n        }\n\n        return fallbackRegisterOrQueue(name, api, options, onError);\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        return MODULE_ENV.registerOrQueueModule(name, api, options, onError, GLOBAL_SCOPE, MODULE_REGISTRY);\n      };\n    }\n\n    return fallbackRegisterOrQueue;\n  })();\n\n\n\n  function isNodeProcessReference(value) {\n    if (!value) {\n      return false;\n    }\n\n    if (typeof process === 'undefined' || !process) {\n      return false;\n    }\n\n    if (value === process) {\n      return true;\n    }\n\n    if (typeof value === 'object') {\n      try {\n        if (value.constructor && value.constructor.name === 'process') {\n          return true;\n        }\n      } catch (processInspectionError) {\n        void processInspectionError;\n      }\n\n      if (\n        typeof value.pid === 'number' &&\n        typeof value.nextTick === 'function' &&\n        typeof value.emit === 'function' &&\n        typeof value.binding === 'function'\n      ) {\n        return true;\n      }\n    }\n\n    if (typeof value === 'function') {\n      if (\n        value === process.binding ||\n        value === process._linkedBinding ||\n        value === process.dlopen\n      ) {\n        return true;\n      }\n\n      try {\n        const functionName = value.name || '';\n        if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n          const source = Function.prototype.toString.call(value);\n          if (source && source.indexOf('[native code]') !== -1) {\n            return true;\n          }\n        }\n      } catch (functionInspectionError) {\n        void functionInspectionError;\n      }\n    }\n\n    return false;\n  }\n\n  function shouldBypassDeepFreeze(value) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return false;\n    }\n\n    if (isNodeProcessReference(value)) {\n      return true;\n    }\n\n    if (\n      typeof process !== 'undefined' &&\n      process &&\n      process.release &&\n      process.release.name === 'node'\n    ) {\n      return true;\n    }\n\n    try {\n      if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n        return true;\n      }\n\n      if (typeof value.on === 'function' && typeof value.emit === 'function') {\n        if (typeof value.write === 'function' || typeof value.read === 'function') {\n          return true;\n        }\n\n        const ctorName = value.constructor && value.constructor.name;\n        if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n          return true;\n        }\n      }\n\n      if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n        const tag = value[Symbol.toStringTag];\n        if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n          return true;\n        }\n      }\n    } catch (inspectionError) {\n      void inspectionError;\n    }\n\n    return false;\n  }\n\n  function fallbackResolveSeenTracker(seen) {\n    if (seen && typeof seen.has === 'function' && typeof seen.add === 'function') {\n      return seen;\n    }\n\n    if (Array.isArray(seen)) {\n      return {\n        has(value) {\n          return seen.indexOf(value) !== -1;\n        },\n        add(value) {\n          if (seen.indexOf(value) === -1) {\n            seen.push(value);\n          }\n        },\n      };\n    }\n\n    if (typeof WeakSet === 'function') {\n      try {\n        return new WeakSet();\n      } catch (trackerError) {\n        void trackerError;\n      }\n    }\n\n    const tracked = [];\n    return {\n      has(value) {\n        return tracked.indexOf(value) !== -1;\n      },\n      add(value) {\n        if (tracked.indexOf(value) === -1) {\n          tracked.push(value);\n        }\n      },\n    };\n  }\n\n  function fallbackFreezeDeep(value, seen) {\n    if (!value || typeof value !== 'object') {\n      return value;\n    }\n\n    if (shouldBypassDeepFreeze(value)) {\n      return value;\n    }\n\n    if (typeof process !== 'undefined' && process && process.env && process.env.JEST_WORKER_ID) {\n      try {\n        if (typeof Object.freeze === 'function') {\n          Object.freeze(value);\n        }\n      } catch (freezeError) {\n        void freezeError;\n      }\n      return value;\n    }\n\n    const tracker = fallbackResolveSeenTracker(seen);\n\n    if (tracker.has(value)) {\n      return value;\n    }\n\n    tracker.add(value);\n\n    const keys = Object.getOwnPropertyNames(value);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      let child;\n      try {\n        child = value[key];\n      } catch (accessError) {\n        void accessError;\n        child = undefined;\n      }\n      if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n        continue;\n      }\n      fallbackFreezeDeep(child, tracker);\n    }\n\n    try {\n      return Object.freeze(value);\n    } catch (freezeError) {\n      void freezeError;\n      return value;\n    }\n  }\n\n  let resolvedFreezeDeep;\n\n  function freezeDeep(value, seen) {\n    const deepFreeze = resolveCachedFreezeDeep();\n    return deepFreeze(value, seen);\n  }\n\n  function resolveCachedFreezeDeep() {\n    if (!resolvedFreezeDeep) {\n      resolvedFreezeDeep = resolveFreezeDeep();\n    }\n    return resolvedFreezeDeep;\n  }\n\n  function resolveFreezeDeep() {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.freezeDeep === 'function') {\n      return MODULE_GLOBALS.freezeDeep;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.freezeDeep === 'function') {\n      return function bridgeFreezeDeep(value, seen) {\n        try {\n          return ENV_BRIDGE.freezeDeep(value, seen);\n        } catch (error) {\n          void error;\n          return fallbackFreezeDeep(value, seen);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.freezeDeep === 'function') {\n      return MODULE_ENV.freezeDeep;\n    }\n\n    return fallbackFreezeDeep;\n  }\n\n  function fallbackSafeWarn(message, detail) {\n    if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n      return;\n    }\n\n    try {\n      if (typeof detail === 'undefined') {\n        console.warn(message);\n      } else {\n        console.warn(message, detail);\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const safeWarn = (function resolveSafeWarn() {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.safeWarn === 'function') {\n      return MODULE_GLOBALS.safeWarn;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.safeWarn === 'function') {\n      return function bridgeSafeWarn(message, detail) {\n        try {\n          ENV_BRIDGE.safeWarn(message, detail);\n        } catch (error) {\n          void error;\n          fallbackSafeWarn(message, detail);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.safeWarn === 'function') {\n      return MODULE_ENV.safeWarn;\n    }\n\n    return fallbackSafeWarn;\n  })();\n\n  connectivityState = emitConnectivityState({ status: 'unknown', source: 'cineOffline' });\n\n  const FORCE_RELOAD_CLEANUP_TIMEOUT_MS = 700;\n  const FORCE_RELOAD_CONNECTIVITY_TIMEOUT_MS = 3500;\n  const RELOAD_WARMUP_MAX_WAIT_MS = 180;\n  let reloadWarmupFailureLogged = false;\n\n\n\n  function settlePromise(promise) {\n    if (!promise || typeof promise.then !== 'function') {\n      return Promise.resolve(false);\n    }\n\n    return promise\n      .then(() => true)\n      .catch(() => false);\n  }\n\n  function isAccessControlReloadWarmupError(error) {\n    if (!error) {\n      return false;\n    }\n\n    let message = '';\n    try {\n      message = typeof error.message === 'string' ? error.message : '';\n    } catch (readError) {\n      void readError;\n      message = '';\n    }\n\n    let name = '';\n    try {\n      name = typeof error.name === 'string' ? error.name : '';\n    } catch (readError) {\n      void readError;\n      name = '';\n    }\n\n    const normalisedMessage = message.toLowerCase();\n    const normalisedName = name.toLowerCase();\n\n    if (normalisedName.includes('cors') || normalisedName.includes('accesscontrol')) {\n      return true;\n    }\n\n    if (!normalisedMessage) {\n      return false;\n    }\n\n    if (normalisedMessage.includes('access control')) {\n      return true;\n    }\n\n    if (normalisedMessage.includes('cors') || normalisedMessage.includes('cross-origin')) {\n      return true;\n    }\n\n    return false;\n  }\n\n  function shouldSuppressReloadWarmupFailure(error, href) {\n    if (!error) {\n      return false;\n    }\n\n    let message = '';\n    try {\n      message = typeof error.message === 'string' ? error.message : '';\n    } catch (readError) {\n      void readError;\n      message = '';\n    }\n\n    let name = '';\n    try {\n      name = typeof error.name === 'string' ? error.name : '';\n    } catch (readError) {\n      void readError;\n      name = '';\n    }\n\n    const normalisedMessage = message.toLowerCase();\n    const normalisedName = name.toLowerCase();\n\n    if (isAccessControlReloadWarmupError(error)) {\n      return true;\n    }\n\n    if (normalisedName === 'aborted' || normalisedName === 'aborterror') {\n      return true;\n    }\n\n    if (normalisedMessage.includes('load failed')) {\n      return true;\n    }\n\n    if (normalisedMessage.includes('cancelled') || normalisedMessage.includes('canceled')) {\n      return true;\n    }\n\n    if (typeof DOMException === 'function') {\n      try {\n        if (error instanceof DOMException && (error.name === 'NetworkError' || error.code === DOMException.NETWORK_ERR)) {\n          return true;\n        }\n      } catch (inspectionError) {\n        void inspectionError;\n      }\n    }\n\n    if (href && typeof href === 'string') {\n      try {\n        const baseHref = typeof location === 'object' && location ? readLocationHrefSafe(location) : undefined;\n        const parsed = typeof URL === 'function' ? new URL(href, baseHref || undefined) : null;\n        if (parsed && parsed.protocol && parsed.protocol !== 'http:' && parsed.protocol !== 'https:') {\n          return true;\n        }\n      } catch (parseError) {\n        void parseError;\n      }\n    }\n\n    return false;\n  }\n\n  function isLikelySafariFamilyBrowser(nav, windowLike) {\n    const win = windowLike || resolveWindow();\n\n    if (win && typeof win.safari === 'object' && win.safari && typeof win.safari.pushNotification === 'object') {\n      return true;\n    }\n\n    const vendor = nav && typeof nav.vendor === 'string' ? nav.vendor : '';\n    const userAgent = nav && typeof nav.userAgent === 'string' ? nav.userAgent : '';\n\n    if (!vendor && !userAgent) {\n      return false;\n    }\n\n    const normalisedVendor = vendor.toLowerCase();\n    const trimmedVendor = normalisedVendor.trim();\n    const normalisedUserAgent = userAgent.toLowerCase();\n\n    const exclusionTokens = ['crios', 'fxios', 'edgios', 'edga', 'edge', 'opr/', 'opt/', 'opera', 'chrome', 'chromium'];\n    for (let index = 0; index < exclusionTokens.length; index += 1) {\n      const token = exclusionTokens[index];\n      if (normalisedUserAgent.includes(token)) {\n        return false;\n      }\n    }\n\n    const vendorIndicatesSafariFamily = trimmedVendor.includes('apple');\n    const userAgentHasSafariToken = normalisedUserAgent.includes('safari');\n    const userAgentHasAppleWebkitToken = normalisedUserAgent.includes('applewebkit');\n    const userAgentHasVersionToken = normalisedUserAgent.includes('version/');\n    const userAgentHasMobileToken = normalisedUserAgent.includes('mobile/');\n    const userAgentHasPlatformToken =\n      normalisedUserAgent.includes('macintosh')\n      || normalisedUserAgent.includes('iphone')\n      || normalisedUserAgent.includes('ipad')\n      || normalisedUserAgent.includes('ipod')\n      || normalisedUserAgent.includes('watch')\n      || normalisedUserAgent.includes('apple tv');\n    const vendorIsEffectivelyEmpty = trimmedVendor.length === 0;\n\n    const userAgentSignalsSafariFamily =\n      userAgentHasSafariToken\n      || (userAgentHasAppleWebkitToken && (userAgentHasVersionToken || userAgentHasMobileToken || userAgentHasPlatformToken));\n\n    const fallbackSafariMatch = vendorIsEffectivelyEmpty && userAgentHasAppleWebkitToken && userAgentSignalsSafariFamily;\n\n    if (!vendorIndicatesSafariFamily && !fallbackSafariMatch) {\n      return false;\n    }\n\n    if (vendorIndicatesSafariFamily && userAgentSignalsSafariFamily) {\n      return true;\n    }\n\n    if (fallbackSafariMatch) {\n      return true;\n    }\n\n    let standalone = false;\n\n    if (nav && typeof nav.standalone === 'boolean') {\n      standalone = nav.standalone;\n    } else if (win && win.navigator && typeof win.navigator.standalone === 'boolean') {\n      standalone = win.navigator.standalone;\n    }\n\n    if (!standalone && win && typeof win.matchMedia === 'function') {\n      try {\n        const standaloneQuery = win.matchMedia('(display-mode: standalone)');\n        if (standaloneQuery && standaloneQuery.matches) {\n          standalone = true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return standalone;\n  }\n\n  function shouldPreferXmlHttpWarmup(nav, windowLike) {\n    const xhrCtor = resolveXmlHttpRequest(windowLike);\n    if (typeof xhrCtor !== 'function') {\n      return false;\n    }\n\n    return isLikelySafariFamilyBrowser(nav, windowLike);\n  }\n\n  function scheduleReloadWarmup(options = {}) {\n    const nextHref = typeof options.nextHref === 'string' ? options.nextHref : '';\n    if (!nextHref) {\n      return null;\n    }\n\n    const win = resolveWindow(options.window);\n    const fetchFn = resolveFetch(options.fetch, win);\n    if (typeof fetchFn !== 'function') {\n      return null;\n    }\n\n    const locationLike =\n      options.location && typeof options.location === 'object'\n        ? options.location\n        : win && win.location\n          ? win.location\n          : null;\n\n    if (!isSameOriginReloadTarget(locationLike, nextHref)) {\n      return null;\n    }\n\n    const nav = resolveNavigator(options.navigator);\n    if (nav && nav.onLine === false) {\n      return null;\n    }\n\n    const preferXmlHttpWarmup = shouldPreferXmlHttpWarmup(nav, win);\n\n    let controller = null;\n    if (typeof AbortController === 'function') {\n      try {\n        controller = new AbortController();\n      } catch (abortError) {\n        void abortError;\n        controller = null;\n      }\n    }\n\n    let serviceWorkerSettled = false;\n    let cachesSettled = false;\n\n    const cancelHandlers = [];\n\n    const registerCancelHandler = handler => {\n      if (typeof handler !== 'function') {\n        return;\n      }\n\n      cancelHandlers.push(handler);\n    };\n\n    const serviceWorkerPromise = settlePromise(options.serviceWorkerPromise).then((result) => {\n      serviceWorkerSettled = true;\n      return result;\n    });\n\n    const cachePromise = settlePromise(options.cachePromise).then((result) => {\n      cachesSettled = true;\n      return result;\n    });\n\n    const shouldAllowCache = options.allowCache === true;\n\n    const includeCredentials = (() => {\n      const referenceHref = readLocationHrefSafe(locationLike);\n      const expectedOrigin = readLocationOriginSafe(locationLike);\n      if (!expectedOrigin) {\n        return false;\n      }\n\n      const targetOrigin = resolveHrefOrigin(nextHref, referenceHref);\n      return !!targetOrigin && targetOrigin === expectedOrigin;\n    })();\n\n    const requestMode = 'same-origin';\n\n    const warmupCredentials = (() => {\n      if (!includeCredentials) {\n        return 'omit';\n      }\n\n      // Fetch already includes same-origin credentials by default. Explicitly\n      // requesting the \"same-origin\" mode avoids Safari's access control\n      // console noise without downgrading coverage for other browsers.\n      return 'same-origin';\n    })();\n\n    const warmupRequestHref = (() => {\n      const referenceHref = readLocationHrefSafe(locationLike);\n      const originHref = typeof referenceHref === 'string' && referenceHref ? referenceHref : nextHref;\n      const enforcedHref = enforceSameOriginNextHref(locationLike, originHref, nextHref);\n\n      if (typeof enforcedHref !== 'string' || !enforcedHref) {\n        return '';\n      }\n\n      const expectedOrigin = readLocationOriginSafe(locationLike);\n\n      if (typeof URL === 'function') {\n        const reference = typeof referenceHref === 'string' && referenceHref ? referenceHref : undefined;\n\n        try {\n          const parsed = new URL(enforcedHref, reference);\n\n          if (expectedOrigin && parsed.origin && parsed.origin !== expectedOrigin) {\n            return '';\n          }\n\n          const pathCandidate = `${parsed.pathname || ''}${parsed.search || ''}${parsed.hash || ''}`;\n\n          if (pathCandidate) {\n            return pathCandidate;\n          }\n\n          if (expectedOrigin && (!parsed.pathname || parsed.pathname === '/')) {\n            return '/';\n          }\n        } catch (error) {\n          void error;\n        }\n      }\n\n      if (typeof expectedOrigin === 'string' && expectedOrigin) {\n        if (typeof enforcedHref === 'string' && enforcedHref.startsWith(expectedOrigin)) {\n          const suffix = enforcedHref.slice(expectedOrigin.length);\n          if (!suffix || suffix.startsWith('/') || suffix.startsWith('?') || suffix.startsWith('#')) {\n            return suffix || '/';\n          }\n        }\n      }\n\n      if (typeof enforcedHref === 'string') {\n        if (enforcedHref.startsWith('/')) {\n          return enforcedHref;\n        }\n\n        if (!enforcedHref.includes('://')) {\n          return enforcedHref;\n        }\n      }\n\n      return '';\n    })();\n\n    const executeWarmup = async () => {\n      const warmupWaitMs = typeof options.warmupWaitMs === 'number' ? options.warmupWaitMs : RELOAD_WARMUP_MAX_WAIT_MS;\n\n      try {\n        await Promise.allSettled([\n          awaitPromiseWithSoftTimeout(serviceWorkerPromise, warmupWaitMs),\n          awaitPromiseWithSoftTimeout(cachePromise, warmupWaitMs),\n        ]);\n      } catch (error) {\n        void error;\n      }\n\n      const allowCachePopulation = shouldAllowCache && serviceWorkerSettled && cachesSettled;\n\n      const buildRequestInit = (overrides = {}) => {\n        const requestInit = {\n          cache: allowCachePopulation ? 'reload' : 'no-store',\n          credentials: warmupCredentials,\n          mode: requestMode,\n          redirect: 'follow',\n        };\n\n        if (controller && controller.signal) {\n          requestInit.signal = controller.signal;\n        }\n\n        return Object.assign(requestInit, overrides);\n      };\n\n      const performFetch = async (overrides = {}) => {\n        const requestInit = buildRequestInit(overrides);\n        const targetHref = warmupRequestHref || nextHref;\n        return fetchFn.call(win || undefined, targetHref, requestInit);\n      };\n\n      if (controller) {\n        registerCancelHandler(() => {\n          try {\n            controller.abort();\n          } catch (abortError) {\n            void abortError;\n          }\n        });\n      }\n\n      const attemptXmlHttpWarmup = () => {\n        if (!preferXmlHttpWarmup) {\n          return null;\n        }\n\n        const xhrCtor = resolveXmlHttpRequest(win);\n        if (typeof xhrCtor !== 'function') {\n          return null;\n        }\n\n        const targetHref = warmupRequestHref || nextHref;\n        if (!targetHref) {\n          return null;\n        }\n\n        let xhrInstance;\n        try {\n          xhrInstance = new xhrCtor();\n        } catch (creationError) {\n          void creationError;\n          xhrInstance = null;\n        }\n\n        if (!xhrInstance) {\n          return null;\n        }\n\n        let aborted = false;\n\n        registerCancelHandler(() => {\n          if (!xhrInstance) {\n            return;\n          }\n\n          aborted = true;\n          try {\n            xhrInstance.abort();\n          } catch (abortError) {\n            void abortError;\n          }\n        });\n\n        const result = new Promise(resolve => {\n          const conclude = success => {\n            if (resolve) {\n              resolve(success);\n            }\n          };\n\n          xhrInstance.addEventListener('load', () => {\n            if (aborted) {\n              conclude(false);\n              return;\n            }\n\n            try {\n              void xhrInstance.responseText;\n            } catch (consumeError) {\n              void consumeError;\n            }\n\n            const status = typeof xhrInstance.status === 'number' ? xhrInstance.status : 0;\n            if (!status) {\n              conclude(true);\n              return;\n            }\n\n            conclude(status >= 200 && status < 400);\n          });\n\n          xhrInstance.addEventListener('error', () => {\n            conclude(false);\n          });\n\n          xhrInstance.addEventListener('abort', () => {\n            conclude(false);\n          });\n\n          xhrInstance.addEventListener('timeout', () => {\n            conclude(false);\n          });\n        });\n\n        try {\n          xhrInstance.open('GET', targetHref, true);\n        } catch (openError) {\n          void openError;\n          return null;\n        }\n\n        // Same-origin requests already carry credentials implicitly. Safari\n        // can emit noisy access-control warnings when withCredentials is\n        // toggled manually, so leave the default untouched.\n\n        try {\n          xhrInstance.responseType = 'text';\n        } catch (responseTypeError) {\n          void responseTypeError;\n        }\n\n\n\n        try {\n          xhrInstance.send(null);\n        } catch (sendError) {\n          void sendError;\n          return null;\n        }\n\n        return result.then(value => !!value);\n      };\n\n      const isAborted = () => controller && controller.signal && controller.signal.aborted === true;\n\n      let response = null;\n      let firstError = null;\n\n      let shouldAttemptFetch = !preferXmlHttpWarmup;\n      if (preferXmlHttpWarmup) {\n        try {\n          const xmlHttpResult = await attemptXmlHttpWarmup();\n          if (xmlHttpResult === true) {\n            return true;\n          }\n\n          if (xmlHttpResult === false) {\n            shouldAttemptFetch = false;\n          } else {\n            shouldAttemptFetch = true;\n          }\n        } catch (xmlHttpError) {\n          void xmlHttpError;\n          shouldAttemptFetch = true;\n        }\n      }\n\n      if (shouldAttemptFetch) {\n        try {\n          response = await performFetch();\n        } catch (error) {\n          firstError = error;\n        }\n      }\n\n      if (!response) {\n        if (isAborted()) {\n          return false;\n        }\n\n        if (isAccessControlReloadWarmupError(firstError)) {\n          return false;\n        }\n\n        let fallbackResponse = null;\n        let fallbackError = firstError;\n        const initialCacheMode = allowCachePopulation ? 'reload' : 'no-store';\n        const fallbackCacheModes = [];\n\n        if (allowCachePopulation) {\n          fallbackCacheModes.push('no-cache');\n        }\n\n        fallbackCacheModes.push('no-store');\n        fallbackCacheModes.push('default');\n\n        for (let index = 0; index < fallbackCacheModes.length && !fallbackResponse; index += 1) {\n          const cacheMode = fallbackCacheModes[index];\n\n          if (cacheMode === initialCacheMode) {\n            continue;\n          }\n\n          try {\n            fallbackResponse = await performFetch({ cache: cacheMode });\n            fallbackError = null;\n          } catch (secondError) {\n            fallbackError = secondError || fallbackError || firstError;\n            fallbackResponse = null;\n          }\n        }\n\n        if (!fallbackResponse) {\n          if (isAborted()) {\n            return false;\n          }\n\n          const suppressWarning = shouldSuppressReloadWarmupFailure(fallbackError || firstError, nextHref);\n\n          if (!reloadWarmupFailureLogged && !suppressWarning) {\n            reloadWarmupFailureLogged = true;\n            safeWarn('Reload warmup fetch failed', fallbackError || firstError);\n          }\n\n          return false;\n        }\n\n        response = fallbackResponse;\n      }\n\n      if (!response) {\n        return false;\n      }\n\n      try {\n        const body = typeof response.clone === 'function' ? response.clone() : response;\n        if (body && typeof body.text === 'function' && body.bodyUsed !== true) {\n          await body.text();\n        }\n      } catch (consumeError) {\n        void consumeError;\n      }\n\n      return true;\n    };\n\n    const warmupTask = executeWarmup();\n    if (warmupTask && typeof warmupTask.catch === 'function') {\n      warmupTask.catch(() => { });\n    }\n\n    return {\n      cancel() {\n        for (let index = 0; index < cancelHandlers.length; index += 1) {\n          const handler = cancelHandlers[index];\n          if (typeof handler !== 'function') {\n            continue;\n          }\n\n          try {\n            handler();\n          } catch (error) {\n            void error;\n          }\n        }\n      },\n      promise: warmupTask,\n      done: warmupTask,\n    };\n  }\n\n  function awaitPromiseWithSoftTimeout(promise, timeoutMs, onTimeout, onLateRejection) {\n    if (!promise || typeof promise.then !== 'function') {\n      return Promise.resolve({ timedOut: false, result: promise });\n    }\n\n    const ms = typeof timeoutMs === 'number' && timeoutMs >= 0 ? timeoutMs : null;\n    const schedule = typeof setTimeout === 'function' ? setTimeout : null;\n    const cancel = typeof clearTimeout === 'function' ? clearTimeout : null;\n\n    if (ms === null || !schedule) {\n      return promise.then(result => ({ timedOut: false, result }));\n    }\n\n    let finished = false;\n    let timerId = null;\n\n    return new Promise((resolve, reject) => {\n      promise.then(\n        value => {\n          if (finished) {\n            return value;\n          }\n\n          finished = true;\n          if (timerId != null && cancel) {\n            try {\n              cancel(timerId);\n            } catch (cancelError) {\n              void cancelError;\n            }\n          }\n\n          resolve({ timedOut: false, result: value });\n          return value;\n        },\n        error => {\n          if (finished) {\n            if (typeof onLateRejection === 'function') {\n              try {\n                onLateRejection(error);\n              } catch (lateError) {\n                void lateError;\n              }\n            }\n            return null;\n          }\n\n          finished = true;\n          if (timerId != null && cancel) {\n            try {\n              cancel(timerId);\n            } catch (cancelError) {\n              void cancelError;\n            }\n          }\n\n          reject(error);\n          return null;\n        },\n      );\n\n      timerId = schedule(() => {\n        if (finished) {\n          return;\n        }\n\n        finished = true;\n\n        if (typeof onTimeout === 'function') {\n          try {\n            onTimeout();\n          } catch (timeoutError) {\n            void timeoutError;\n          }\n        }\n\n        resolve({ timedOut: true, result: undefined });\n      }, ms);\n\n      if (timerId && typeof timerId.unref === 'function') {\n        timerId.unref();\n      }\n    });\n  }\n\n  function fallbackExposeGlobal(name, value) {\n    if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n      return false;\n    }\n    try {\n      Object.defineProperty(GLOBAL_SCOPE, name, {\n        configurable: true,\n        enumerable: false,\n        value,\n        writable: false,\n      });\n      return true;\n    } catch (error) {\n      void error;\n      try {\n        GLOBAL_SCOPE[name] = value;\n        return true;\n      } catch (assignmentError) {\n        void assignmentError;\n        return false;\n      }\n    }\n  }\n\n  const exposeGlobal = (function resolveExposeGlobal() {\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.exposeGlobal === 'function') {\n      return function moduleGlobalsExpose(name, value, options) {\n        try {\n          return MODULE_GLOBALS.exposeGlobal(name, value, options);\n        } catch (error) {\n          void error;\n          return fallbackExposeGlobal(name, value);\n        }\n      };\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.exposeGlobal === 'function') {\n      return function bridgeExposeGlobal(name, value, options) {\n        try {\n          return ENV_BRIDGE.exposeGlobal(name, value, options);\n        } catch (error) {\n          void error;\n          return fallbackExposeGlobal(name, value);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.exposeGlobal === 'function') {\n      return function exposeGlobal(name, value, options) {\n        return MODULE_ENV.exposeGlobal(name, value, GLOBAL_SCOPE, options);\n      };\n    }\n\n    return fallbackExposeGlobal;\n  })();\n\n  const UI_CACHE_STORAGE_KEYS_FOR_RELOAD = [\n    'cameraPowerPlanner_schemaCache',\n    'cinePowerPlanner_schemaCache',\n  ];\n\n  const UI_CACHE_STORAGE_SUFFIXES_FOR_RELOAD = [\n    '',\n    '__backup',\n    '__legacyMigrationBackup',\n  ];\n\n  const uiCacheFallbackWarningKeys = new Set();\n  let pendingServiceWorkerRegistration = null;\n\n  function resolveGlobal(name) {\n    if (!GLOBAL_SCOPE || (typeof GLOBAL_SCOPE !== 'object' && typeof GLOBAL_SCOPE !== 'function')) {\n      return undefined;\n    }\n\n    try {\n      return GLOBAL_SCOPE[name];\n    } catch (error) {\n      void error;\n      return undefined;\n    }\n  }\n\n  function resolveWindow(explicitWindow) {\n    if (explicitWindow) {\n      return explicitWindow;\n    }\n    if (typeof window !== 'undefined') {\n      return window;\n    }\n    return resolveGlobal('window');\n  }\n\n  function resolveNavigator(explicitNavigator) {\n    if (explicitNavigator) {\n      return explicitNavigator;\n    }\n    if (typeof navigator !== 'undefined') {\n      return navigator;\n    }\n    const win = resolveWindow();\n    if (win && typeof win.navigator !== 'undefined') {\n      return win.navigator;\n    }\n    return resolveGlobal('navigator');\n  }\n\n  function isNavigatorExplicitlyOffline(navigatorLike) {\n    if (!navigatorLike || typeof navigatorLike !== 'object') {\n      return false;\n    }\n\n    if (typeof navigatorLike.onLine !== 'boolean') {\n      return false;\n    }\n\n    return navigatorLike.onLine === false;\n  }\n\n  function resolveCaches(explicitCaches) {\n    if (explicitCaches) {\n      return explicitCaches;\n    }\n    if (typeof caches !== 'undefined') {\n      return caches;\n    }\n    const win = resolveWindow();\n    if (win && typeof win.caches !== 'undefined') {\n      return win.caches;\n    }\n    return resolveGlobal('caches');\n  }\n\n  function resolveLocation(explicitLocation) {\n    if (explicitLocation && typeof explicitLocation === 'object') {\n      return explicitLocation;\n    }\n\n    const win = resolveWindow();\n    if (win && win.location && typeof win.location === 'object') {\n      return win.location;\n    }\n\n    return resolveGlobal('location');\n  }\n\n  function resolveFetch(explicitFetch, windowLike) {\n    if (typeof explicitFetch === 'function') {\n      return explicitFetch;\n    }\n\n    if (typeof fetch === 'function') {\n      return fetch;\n    }\n\n    const win = windowLike || resolveWindow();\n    if (win && typeof win.fetch === 'function') {\n      try {\n        return win.fetch.bind(win);\n      } catch (error) {\n        void error;\n        return win.fetch;\n      }\n    }\n\n    const globalFetch = resolveGlobal('fetch');\n    return typeof globalFetch === 'function' ? globalFetch : null;\n  }\n\n  function createAbortController() {\n    if (typeof AbortController !== 'function') {\n      return null;\n    }\n\n    try {\n      return new AbortController();\n    } catch (error) {\n      void error;\n      return null;\n    }\n  }\n\n  function createTimeoutError(message) {\n    const error = new Error(message || 'Operation timed out');\n    error.name = 'TimeoutError';\n    error.code = 'ETIMEDOUT';\n    return error;\n  }\n\n  function fetchWithTimeout(fetchFn, url, init, timeoutMs) {\n    if (typeof fetchFn !== 'function') {\n      return Promise.resolve({ successful: false, error: new Error('Fetch unavailable'), timedOut: false });\n    }\n\n    const options = init ? { ...init } : {};\n    const controller = createAbortController();\n    let timeoutId = null;\n    let timedOut = false;\n\n    if (controller && typeof controller.signal !== 'undefined') {\n      try {\n        options.signal = controller.signal;\n      } catch (signalError) {\n        void signalError;\n      }\n    }\n\n    let timeoutPromise = null;\n\n    if (typeof timeoutMs === 'number' && timeoutMs > 0 && typeof setTimeout === 'function') {\n      timeoutPromise = new Promise((_, reject) => {\n        try {\n          timeoutId = setTimeout(() => {\n            timedOut = true;\n            if (controller && typeof controller.abort === 'function') {\n              try {\n                controller.abort();\n              } catch (abortError) {\n                void abortError;\n              }\n            }\n            reject(createTimeoutError('Connectivity probe timed out'));\n          }, timeoutMs);\n        } catch (scheduleError) {\n          void scheduleError;\n          timeoutPromise = null;\n        }\n      });\n    }\n\n    const cleanup = () => {\n      if (timeoutId) {\n        try {\n          clearTimeout(timeoutId);\n        } catch (error) {\n          void error;\n        }\n      }\n    };\n\n    const fetchPromise = (() => {\n      try {\n        return fetchFn(url, options);\n      } catch (error) {\n        cleanup();\n        return Promise.reject(error);\n      }\n    })();\n\n    const racePromise = timeoutPromise ? Promise.race([fetchPromise, timeoutPromise]) : fetchPromise;\n\n    return racePromise\n      .then((value) => {\n        cleanup();\n        return { successful: true, value, timedOut: false };\n      })\n      .catch((error) => {\n        cleanup();\n        return { successful: false, error, timedOut };\n      });\n  }\n\n  function isSuccessfulConnectivityResponse(response) {\n    if (!response) {\n      return false;\n    }\n\n    try {\n      if (response.ok === true) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    let status = 0;\n    try {\n      status = typeof response.status === 'number' ? response.status : 0;\n    } catch (error) {\n      void error;\n      status = 0;\n    }\n\n    if (status === 0) {\n      return true;\n    }\n\n    return status >= 200 && status < 400;\n  }\n\n  function appendConnectivityProbeToken(url, token) {\n    if (!url || typeof url !== 'string') {\n      return url;\n    }\n\n    if (typeof token === 'undefined' || token === null) {\n      return url;\n    }\n\n    let tokenString;\n    if (typeof token === 'string') {\n      tokenString = token;\n    } else {\n      try {\n        tokenString = String(token);\n      } catch (stringifyError) {\n        void stringifyError;\n        return url;\n      }\n    }\n\n    if (!tokenString) {\n      return url;\n    }\n\n    let base = url;\n    let fragment = '';\n\n    const hashIndex = base.indexOf('#');\n    if (hashIndex !== -1) {\n      fragment = base.slice(hashIndex);\n      base = base.slice(0, hashIndex);\n    }\n\n    const separator = base.indexOf('?') === -1 ? '?' : '&';\n    const encodedParam = encodeURIComponent(CONNECTIVITY_PROBE_QUERY_PARAM);\n    const encodedToken = encodeURIComponent(tokenString);\n\n    return `${base}${separator}${encodedParam}=${encodedToken}${fragment}`;\n  }\n\n  function readConnectivityProbeResult(response) {\n    if (!response || !response.headers || typeof response.headers.get !== 'function') {\n      return null;\n    }\n\n    try {\n      const headerValue = response.headers.get(CONNECTIVITY_PROBE_RESULT_HEADER);\n      if (typeof headerValue === 'string' && headerValue) {\n        return headerValue.toLowerCase();\n      }\n    } catch (error) {\n      void error;\n    }\n\n    return null;\n  }\n\n  function resolveConnectivityProbeUrl(forceReloadUrl, locationLike) {\n    if (forceReloadUrl && typeof forceReloadUrl.nextHref === 'string' && forceReloadUrl.nextHref) {\n      return forceReloadUrl.nextHref;\n    }\n\n    if (forceReloadUrl && typeof forceReloadUrl.originalHref === 'string' && forceReloadUrl.originalHref) {\n      return forceReloadUrl.originalHref;\n    }\n\n    const href = readLocationHrefSafe(locationLike);\n    if (href) {\n      return href;\n    }\n\n    const pathname = readLocationPathnameSafe(locationLike);\n    if (pathname) {\n      return pathname;\n    }\n\n    return 'index.html';\n  }\n\n  async function probeReloadConnectivity({\n    navigatorLike,\n    windowLike,\n    locationLike,\n    fetchFn,\n    forceReloadUrl,\n    timeoutMs,\n  }) {\n    if (isNavigatorExplicitlyOffline(navigatorLike)) {\n      return { reachable: false, reason: 'offline' };\n    }\n\n    const effectiveFetch = fetchFn || resolveFetch(undefined, windowLike);\n\n    if (typeof effectiveFetch !== 'function') {\n      return { reachable: true, reason: 'fetch-unavailable' };\n    }\n\n    const probeToken = `${Date.now().toString(36)}-${Math.random().toString(36).slice(2)}`;\n    const probeUrl = appendConnectivityProbeToken(\n      resolveConnectivityProbeUrl(forceReloadUrl, locationLike),\n      probeToken,\n    );\n\n    const probeHeaders = {\n      'Cache-Control': 'no-store, max-age=0',\n      Pragma: 'no-cache',\n    };\n\n    if (typeof probeToken === 'string' && probeToken) {\n      probeHeaders[CONNECTIVITY_PROBE_HEADER] = probeToken;\n    }\n\n    let headFailureDetail = null;\n    const headResult = await fetchWithTimeout(\n      effectiveFetch,\n      probeUrl,\n      {\n        method: 'HEAD',\n        cache: 'no-store',\n        credentials: 'same-origin',\n        headers: probeHeaders,\n      },\n      timeoutMs,\n    );\n\n    if (headResult.successful) {\n      let status = 0;\n      try {\n        status = headResult.value && typeof headResult.value.status === 'number' ? headResult.value.status : 0;\n      } catch (statusError) {\n        void statusError;\n        status = 0;\n      }\n\n      const headProbeResult = readConnectivityProbeResult(headResult.value);\n      if (headProbeResult && headProbeResult !== CONNECTIVITY_PROBE_RESULT_NETWORK) {\n        headFailureDetail = {\n          source: 'head',\n          status,\n          probeResult: headProbeResult || CONNECTIVITY_PROBE_RESULT_FALLBACK,\n        };\n      } else if (isSuccessfulConnectivityResponse(headResult.value)) {\n        return { reachable: true, reason: 'head-ok' };\n      } else {\n        headFailureDetail = { source: 'head', status };\n      }\n    } else if (headResult.timedOut) {\n      return { reachable: false, reason: 'timeout', detail: headResult.error };\n    } else if (headResult.error) {\n      headFailureDetail = { source: 'head', error: headResult.error };\n    }\n\n    const getResult = await fetchWithTimeout(\n      effectiveFetch,\n      probeUrl,\n      {\n        method: 'GET',\n        cache: 'no-store',\n        credentials: 'same-origin',\n        headers: {\n          ...probeHeaders,\n        },\n      },\n      timeoutMs,\n    );\n\n    if (getResult.successful) {\n      const getProbeResult = readConnectivityProbeResult(getResult.value);\n\n      if (getProbeResult && getProbeResult !== CONNECTIVITY_PROBE_RESULT_NETWORK) {\n        return {\n          reachable: false,\n          reason: 'cache-fallback',\n          detail: {\n            status:\n              getResult.value && typeof getResult.value.status === 'number' ? getResult.value.status : undefined,\n            head: headFailureDetail,\n            probeResult: getProbeResult || CONNECTIVITY_PROBE_RESULT_FALLBACK,\n          },\n        };\n      }\n\n      if (isSuccessfulConnectivityResponse(getResult.value)) {\n        return { reachable: true, reason: 'get-ok' };\n      }\n\n      return {\n        reachable: false,\n        reason: 'get-failed',\n        detail: {\n          status:\n            getResult.value && typeof getResult.value.status === 'number' ? getResult.value.status : undefined,\n          head: headFailureDetail,\n        },\n      };\n    }\n\n    if (getResult.timedOut) {\n      return { reachable: false, reason: 'timeout', detail: getResult.error };\n    }\n\n    return { reachable: false, reason: 'unreachable', detail: getResult.error || headFailureDetail || headResult.error };\n  }\n\n  function subscribeConnectivityStatus(listener) {\n    if (typeof listener !== 'function') {\n      return function unsubscribeNoop() { };\n    }\n\n    connectivityListeners.add(listener);\n\n    return function unsubscribeConnectivityListener() {\n      try {\n        connectivityListeners.delete(listener);\n      } catch (error) {\n        void error;\n      }\n    };\n  }\n\n  function unsubscribeConnectivityStatus(listener) {\n    if (typeof listener !== 'function') {\n      return;\n    }\n\n    try {\n      connectivityListeners.delete(listener);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  function reportConnectivityProbeResult(result, meta) {\n    if (!result || typeof result !== 'object') {\n      return;\n    }\n\n    const detail = result.detail && typeof result.detail === 'object'\n      ? {\n        ...result.detail,\n        stage: (meta && meta.stage) || 'probe',\n        source: (meta && meta.source) || 'probe',\n      }\n      : {\n        stage: (meta && meta.stage) || 'probe',\n        source: (meta && meta.source) || 'probe',\n      };\n\n    if (result.reachable) {\n      emitConnectivityState({\n        status: 'online',\n        reason: typeof result.reason === 'string' && result.reason ? result.reason : 'probe-ok',\n        detail,\n        source: (meta && meta.source) || 'probe',\n      });\n      return;\n    }\n\n    const status = result.reason === 'offline' ? 'offline' : 'degraded';\n    emitConnectivityState({\n      status,\n      reason: typeof result.reason === 'string' && result.reason ? result.reason : 'unknown',\n      detail,\n      source: (meta && meta.source) || 'probe',\n    });\n  }\n\n  function resolveXmlHttpRequest(windowLike) {\n    const win = windowLike || resolveWindow();\n\n    if (win && typeof win.XMLHttpRequest === 'function') {\n      return win.XMLHttpRequest;\n    }\n\n    if (typeof XMLHttpRequest === 'function') {\n      return XMLHttpRequest;\n    }\n\n    const globalXmlHttpRequest = resolveGlobal('XMLHttpRequest');\n    return typeof globalXmlHttpRequest === 'function' ? globalXmlHttpRequest : null;\n  }\n\n  function registerFallbackStorage(storages, candidate, label) {\n    void label;\n    if (!candidate || (typeof candidate !== 'object' && typeof candidate !== 'function')) {\n      return;\n    }\n\n    const hasRemove = typeof candidate.removeItem === 'function';\n    const hasDelete = typeof candidate.delete === 'function';\n\n    if (!hasRemove && !hasDelete) {\n      return;\n    }\n\n    storages.add(candidate);\n  }\n\n  function inspectScopeForStorages(storages, scope, label) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n\n    try {\n      registerFallbackStorage(storages, scope.SAFE_LOCAL_STORAGE, `${label}.SAFE_LOCAL_STORAGE`);\n    } catch (error) {\n      const key = `${label}.SAFE_LOCAL_STORAGE`;\n      if (!uiCacheFallbackWarningKeys.has(key)) {\n        uiCacheFallbackWarningKeys.add(key);\n        safeWarn(`Unable to inspect ${key} while clearing UI caches`, error);\n      }\n    }\n\n    try {\n      registerFallbackStorage(storages, scope.localStorage, `${label}.localStorage`);\n    } catch (error) {\n      const key = `${label}.localStorage`;\n      if (!uiCacheFallbackWarningKeys.has(key)) {\n        uiCacheFallbackWarningKeys.add(key);\n        safeWarn(`Unable to inspect ${key} while clearing UI caches`, error);\n      }\n    }\n\n    try {\n      registerFallbackStorage(storages, scope.sessionStorage, `${label}.sessionStorage`);\n    } catch (error) {\n      const key = `${label}.sessionStorage`;\n      if (!uiCacheFallbackWarningKeys.has(key)) {\n        uiCacheFallbackWarningKeys.add(key);\n        safeWarn(`Unable to inspect ${key} while clearing UI caches`, error);\n      }\n    }\n\n    let nested = null;\n    try {\n      nested = scope.__cineGlobal;\n    } catch (error) {\n      const key = `${label}.__cineGlobal`;\n      if (!uiCacheFallbackWarningKeys.has(key)) {\n        uiCacheFallbackWarningKeys.add(key);\n        safeWarn(`Unable to inspect ${key} while clearing UI caches`, error);\n      }\n    }\n\n    if (nested && nested !== scope) {\n      inspectScopeForStorages(storages, nested, `${label}.__cineGlobal`);\n    }\n  }\n\n  function collectFallbackUiCacheStorages(options = {}) {\n    const storages = new Set();\n\n    const resolveSafeLocalStorageFn =\n      typeof options.resolveSafeLocalStorage === 'function'\n        ? options.resolveSafeLocalStorage\n        : typeof resolveGlobal('resolveSafeLocalStorage') === 'function'\n          ? resolveGlobal('resolveSafeLocalStorage')\n          : null;\n\n    const safeLocalStorageInstance = options.safeLocalStorage || resolveGlobal('SAFE_LOCAL_STORAGE');\n\n    try {\n      const resolved = resolveSafeLocalStorageFn ? resolveSafeLocalStorageFn() : null;\n      registerFallbackStorage(storages, resolved, 'safeLocalStorage');\n    } catch (error) {\n      safeWarn('resolveSafeLocalStorage() failed while collecting UI cache storages', error);\n    }\n\n    if (safeLocalStorageInstance) {\n      try {\n        registerFallbackStorage(storages, safeLocalStorageInstance, 'SAFE_LOCAL_STORAGE');\n      } catch (error) {\n        const key = 'SAFE_LOCAL_STORAGE';\n        if (!uiCacheFallbackWarningKeys.has(key)) {\n          uiCacheFallbackWarningKeys.add(key);\n          safeWarn('Unable to inspect SAFE_LOCAL_STORAGE while clearing UI caches', error);\n        }\n      }\n    }\n\n    const candidates = options.scopeCandidates || [\n      { scope: resolveGlobal('globalThis'), label: 'globalThis' },\n      { scope: resolveWindow(options.window), label: 'window' },\n      { scope: typeof self !== 'undefined' ? self : resolveGlobal('self'), label: 'self' },\n      { scope: resolveGlobal('global'), label: 'global' },\n    ];\n\n    const cineGlobal = typeof GLOBAL_SCOPE !== 'undefined' ? GLOBAL_SCOPE.__cineGlobal : undefined;\n    if (typeof cineGlobal !== 'undefined') {\n      candidates.push({ scope: cineGlobal, label: '__cineGlobal' });\n    }\n\n    candidates.forEach(({ scope, label }) => {\n      inspectScopeForStorages(storages, scope, label);\n    });\n\n    const win = resolveWindow(options.window);\n    if (win) {\n      try {\n        registerFallbackStorage(storages, win.localStorage, 'window.localStorage');\n      } catch (error) {\n        const key = 'window.localStorage';\n        if (!uiCacheFallbackWarningKeys.has(key)) {\n          uiCacheFallbackWarningKeys.add(key);\n          safeWarn('Unable to inspect window.localStorage while clearing UI caches', error);\n        }\n      }\n\n      try {\n        registerFallbackStorage(storages, win.sessionStorage, 'window.sessionStorage');\n      } catch (error) {\n        const key = 'window.sessionStorage';\n        if (!uiCacheFallbackWarningKeys.has(key)) {\n          uiCacheFallbackWarningKeys.add(key);\n          safeWarn('Unable to inspect window.sessionStorage while clearing UI caches', error);\n        }\n      }\n    }\n\n    return storages;\n  }\n\n  function clearUiCacheEntriesFallback(options = {}) {\n    const storages = options.storages || collectFallbackUiCacheStorages(options);\n    if (!storages || !storages.size) {\n      return false;\n    }\n\n    let clearedAny = false;\n\n    storages.forEach((storage) => {\n      UI_CACHE_STORAGE_KEYS_FOR_RELOAD.forEach((baseKey) => {\n        if (typeof baseKey !== 'string' || !baseKey) {\n          return;\n        }\n\n        UI_CACHE_STORAGE_SUFFIXES_FOR_RELOAD.forEach((suffix) => {\n          const entryKey = suffix ? `${baseKey}${suffix}` : baseKey;\n          try {\n            if (typeof storage.removeItem === 'function') {\n              storage.removeItem(entryKey);\n              clearedAny = true;\n            } else if (typeof storage.delete === 'function') {\n              storage.delete(entryKey);\n              clearedAny = true;\n            }\n          } catch (error) {\n            safeWarn('Failed to remove UI cache entry', { entryKey, error });\n          }\n        });\n      });\n    });\n\n    return clearedAny;\n  }\n\n  async function collectServiceWorkerRegistrations(navigatorOverride) {\n    const nav = resolveNavigator(navigatorOverride);\n    if (!nav || !nav.serviceWorker) {\n      return [];\n    }\n\n    const { serviceWorker } = nav;\n    const registrations = [];\n\n    const pushRegistration = (registration) => {\n      if (registration) {\n        registrations.push(registration);\n      }\n    };\n\n    try {\n      if (typeof serviceWorker.getRegistrations === 'function') {\n        const regs = await serviceWorker.getRegistrations();\n        if (Array.isArray(regs)) {\n          regs.forEach(pushRegistration);\n        }\n      } else if (typeof serviceWorker.getRegistration === 'function') {\n        const reg = await serviceWorker.getRegistration();\n        pushRegistration(reg);\n      } else if (serviceWorker.ready && typeof serviceWorker.ready.then === 'function') {\n        try {\n          const readyReg = await serviceWorker.ready;\n          pushRegistration(readyReg);\n        } catch (readyError) {\n          safeWarn('Failed to await active service worker', readyError);\n        }\n      }\n    } catch (queryError) {\n      safeWarn('Failed to query service worker registrations', queryError);\n    }\n\n    return registrations;\n  }\n\n  async function resolvePrefetchedServiceWorkerRegistrations(prefetchedRegistrations) {\n    if (!prefetchedRegistrations) {\n      return [];\n    }\n\n    try {\n      const resolved = await Promise.resolve(prefetchedRegistrations);\n      if (!Array.isArray(resolved)) {\n        return [];\n      }\n\n      return resolved.filter((registration) => !!registration);\n    } catch (error) {\n      safeWarn('Failed to resolve prefetched service worker registrations', error);\n    }\n\n    return [];\n  }\n\n  async function unregisterServiceWorkers(navigatorOverride, prefetchedRegistrations) {\n    const nav = resolveNavigator(navigatorOverride);\n    if (!nav || !nav.serviceWorker) {\n      return false;\n    }\n\n    let registrations = await resolvePrefetchedServiceWorkerRegistrations(prefetchedRegistrations);\n    if (!registrations.length) {\n      registrations = await collectServiceWorkerRegistrations(nav);\n    }\n\n    if (!registrations.length) {\n      return false;\n    }\n\n    await Promise.all(\n      registrations.map((registration) => {\n        if (!registration || typeof registration.unregister !== 'function') {\n          return Promise.resolve(false);\n        }\n\n        return registration.unregister().catch((error) => {\n          safeWarn('Service worker unregister failed', error);\n          return false;\n        });\n      })\n    );\n\n    return true;\n  }\n\n  function observeServiceWorkerControllerChange(navigatorOverride) {\n    const nav = resolveNavigator(navigatorOverride);\n    if (!nav || !nav.serviceWorker) {\n      return null;\n    }\n\n    const { serviceWorker } = nav;\n    if (!serviceWorker) {\n      return null;\n    }\n\n    let resolved = false;\n    let detach = null;\n    let resolver = null;\n    let attached = false;\n\n    const finalize = (value) => {\n      if (resolved) {\n        return;\n      }\n      resolved = true;\n\n      const currentResolver = resolver;\n      resolver = null;\n\n      if (typeof detach === 'function') {\n        try {\n          detach();\n        } catch (error) {\n          void error;\n        }\n        detach = null;\n      }\n\n      if (typeof currentResolver === 'function') {\n        try {\n          currentResolver(value);\n        } catch (resolveError) {\n          void resolveError;\n        }\n      }\n    };\n\n    const promise = new Promise((resolve) => {\n      resolver = resolve;\n\n      if (serviceWorker.controller) {\n        finalize(true);\n        return;\n      }\n\n      const handler = () => {\n        finalize(true);\n      };\n\n      try {\n        if (typeof serviceWorker.addEventListener === 'function') {\n          serviceWorker.addEventListener('controllerchange', handler);\n          detach = () => {\n            try {\n              serviceWorker.removeEventListener('controllerchange', handler);\n            } catch (removeError) {\n              void removeError;\n            }\n          };\n          attached = true;\n        } else if ('oncontrollerchange' in serviceWorker) {\n          const previous = serviceWorker.oncontrollerchange;\n          serviceWorker.oncontrollerchange = function controllerchangeProxy(event) {\n            if (typeof previous === 'function') {\n              try {\n                previous.call(this, event);\n              } catch (previousError) {\n                safeWarn('Existing service worker controllerchange handler failed', previousError);\n              }\n            }\n            handler(event);\n          };\n          detach = () => {\n            try {\n              serviceWorker.oncontrollerchange = previous;\n            } catch (restoreError) {\n              void restoreError;\n            }\n          };\n          attached = true;\n        } else {\n          finalize(false);\n        }\n      } catch (error) {\n        safeWarn('Failed to observe service worker controllerchange', error);\n        finalize(false);\n      }\n    });\n\n    if (!attached && !serviceWorker.controller) {\n      finalize(false);\n      return null;\n    }\n\n    return {\n      promise,\n      cancel() {\n        finalize(false);\n      },\n    };\n  }\n\n  const APP_CACHE_IDENTIFIERS = ['cine-power-planner', 'cinepowerplanner'];\n\n  function resolveExposedCacheName() {\n    const exposedName = resolveGlobal('CINE_CACHE_NAME');\n    if (typeof exposedName === 'string' && exposedName) {\n      return exposedName;\n    }\n    return null;\n  }\n\n  function isRelevantCacheKey(key, explicitName, lowerExplicit) {\n    if (typeof key !== 'string' || !key) {\n      return false;\n    }\n\n    if (explicitName && (key === explicitName || key.toLowerCase() === lowerExplicit)) {\n      return true;\n    }\n\n    const lowerKey = key.toLowerCase();\n    for (let index = 0; index < APP_CACHE_IDENTIFIERS.length; index += 1) {\n      if (lowerKey.includes(APP_CACHE_IDENTIFIERS[index])) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  async function clearCacheStorage(cachesOverride) {\n    const cachesInstance = resolveCaches(cachesOverride);\n    if (!cachesInstance || typeof cachesInstance.keys !== 'function') {\n      return false;\n    }\n\n    const exposedName = resolveExposedCacheName();\n    const lowerExplicit = exposedName ? exposedName.toLowerCase() : null;\n\n    try {\n      const keys = await cachesInstance.keys();\n      if (!Array.isArray(keys) || !keys.length) {\n        return false;\n      }\n\n      const relevantKeys = keys.filter((key) =>\n        isRelevantCacheKey(key, exposedName, lowerExplicit)\n      );\n\n      if (!relevantKeys.length) {\n        return false;\n      }\n\n      let removedAny = false;\n\n      await Promise.all(\n        relevantKeys.map((key) => {\n          if (!key || typeof cachesInstance.delete !== 'function') {\n            return Promise.resolve(false);\n          }\n\n          return cachesInstance\n            .delete(key)\n            .then((result) => {\n              removedAny = removedAny || !!result;\n              return result;\n            })\n            .catch((error) => {\n              safeWarn('Failed to delete cache', { key, error });\n              return false;\n            });\n        })\n      );\n\n      return removedAny;\n    } catch (error) {\n      safeWarn('Cache clear failed', error);\n      return false;\n    }\n  }\n\n  function readLocationHrefSafe(locationLike) {\n    if (!locationLike || typeof locationLike !== 'object') {\n      return '';\n    }\n\n    try {\n      const href = locationLike.href;\n      return typeof href === 'string' ? href : '';\n    } catch (error) {\n      void error;\n      return '';\n    }\n  }\n\n  function readLocationPathnameSafe(locationLike) {\n    if (!locationLike || typeof locationLike !== 'object') {\n      return '';\n    }\n\n    try {\n      const pathname = locationLike.pathname;\n      return typeof pathname === 'string' ? pathname : '';\n    } catch (error) {\n      void error;\n      return '';\n    }\n  }\n\n  function readLocationOriginSafe(locationLike) {\n    if (!locationLike || typeof locationLike !== 'object') {\n      return '';\n    }\n\n    try {\n      const origin = locationLike.origin;\n      if (typeof origin === 'string' && origin) {\n        return origin;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    const href = readLocationHrefSafe(locationLike);\n    if (!href) {\n      return '';\n    }\n\n    if (typeof URL === 'function') {\n      try {\n        return new URL(href).origin;\n      } catch (originError) {\n        void originError;\n      }\n    }\n\n    const originMatch = href.match(/^([a-zA-Z][a-zA-Z\\d+.-]*:\\/\\/[^/]+)/);\n    return originMatch && originMatch[1] ? originMatch[1] : '';\n  }\n\n  function resolveHrefOrigin(targetHref, referenceHref) {\n    if (typeof targetHref !== 'string' || !targetHref) {\n      return '';\n    }\n\n    const reference = typeof referenceHref === 'string' && referenceHref ? referenceHref : undefined;\n\n    if (typeof URL === 'function') {\n      try {\n        const url = new URL(targetHref, reference);\n        if (url && typeof url.origin === 'string') {\n          return url.origin;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const originMatch = targetHref.match(/^([a-zA-Z][a-zA-Z\\d+.-]*:\\/\\/[^/]+)/);\n    return originMatch && originMatch[1] ? originMatch[1] : '';\n  }\n\n  function isSameOriginReloadTarget(locationLike, targetHref) {\n    if (typeof targetHref !== 'string' || !targetHref) {\n      return false;\n    }\n\n    const fallbackLocation =\n      locationLike && typeof locationLike === 'object'\n        ? locationLike\n        : typeof window !== 'undefined' && window && window.location\n          ? window.location\n          : null;\n\n    const referenceHref = readLocationHrefSafe(locationLike) || readLocationHrefSafe(fallbackLocation);\n    const targetOrigin = resolveHrefOrigin(targetHref, referenceHref);\n\n    if (!targetOrigin) {\n      return true;\n    }\n\n    const expectedOrigin = readLocationOriginSafe(locationLike) || readLocationOriginSafe(fallbackLocation);\n\n    if (!expectedOrigin) {\n      return false;\n    }\n\n    return targetOrigin === expectedOrigin;\n  }\n\n  function getForceReloadBaseCandidates(locationLike, originalHref) {\n    const candidates = [];\n    const unique = new Set();\n\n    const addCandidate = (value) => {\n      if (typeof value !== 'string') {\n        return;\n      }\n\n      const trimmed = value.trim();\n      if (!trimmed || unique.has(trimmed)) {\n        return;\n      }\n\n      unique.add(trimmed);\n      candidates.push(trimmed);\n    };\n\n    const safeHref = readLocationHrefSafe(locationLike);\n    if (safeHref) {\n      addCandidate(safeHref);\n    }\n\n    if (typeof originalHref === 'string' && originalHref) {\n      addCandidate(originalHref);\n    }\n\n    const origin = readLocationOriginSafe(locationLike);\n    const pathname = readLocationPathnameSafe(locationLike);\n\n    if (origin) {\n      if (pathname) {\n        addCandidate(`${origin}${pathname}`);\n      }\n      addCandidate(`${origin}/`);\n    }\n\n    if (typeof window !== 'undefined' && window && window.location) {\n      const windowHref = readLocationHrefSafe(window.location);\n      if (windowHref) {\n        addCandidate(windowHref);\n      }\n    }\n\n    return candidates;\n  }\n\n  function normaliseHrefForComparison(value, baseHref) {\n    if (typeof value !== 'string') {\n      return '';\n    }\n\n    const trimmed = value.trim();\n    if (!trimmed) {\n      return '';\n    }\n\n    if (typeof URL === 'function') {\n      try {\n        return new URL(trimmed).toString();\n      } catch (primaryError) {\n        void primaryError;\n\n        if (typeof baseHref === 'string' && baseHref) {\n          try {\n            return new URL(trimmed, baseHref).toString();\n          } catch (secondaryError) {\n            void secondaryError;\n          }\n        }\n      }\n    }\n\n    return trimmed;\n  }\n\n  function enforceSameOriginNextHref(locationLike, originalHref, nextHref) {\n    if (isSameOriginReloadTarget(locationLike, nextHref)) {\n      return nextHref;\n    }\n\n    const locationHref = readLocationHrefSafe(locationLike);\n    const fallbackCandidate = typeof originalHref === 'string' && originalHref ? originalHref : '';\n    const sameOriginCandidates = [];\n\n    if (locationHref && isSameOriginReloadTarget(locationLike, locationHref)) {\n      sameOriginCandidates.push(locationHref);\n    }\n\n    if (fallbackCandidate && isSameOriginReloadTarget(locationLike, fallbackCandidate)) {\n      sameOriginCandidates.push(fallbackCandidate);\n    }\n\n    const baseHref = sameOriginCandidates.length ? sameOriginCandidates[0] : locationHref;\n    const origin = readLocationOriginSafe(locationLike);\n\n    if (typeof URL === 'function' && baseHref) {\n      try {\n        const candidate = new URL(nextHref, baseHref);\n        const rebuilt = `${candidate.origin || ''}${candidate.pathname || ''}${candidate.search || ''}${candidate.hash || ''}`;\n        if (rebuilt && isSameOriginReloadTarget(locationLike, rebuilt)) {\n          return rebuilt;\n        }\n      } catch (rebuildError) {\n        void rebuildError;\n      }\n    }\n\n    if (typeof nextHref === 'string' && origin) {\n      const originPattern = /^[a-zA-Z][a-zA-Z\\d+.-]*:\\/\\/[^/]+(.*)$/;\n      const match = nextHref.match(originPattern);\n      if (match && match[1]) {\n        const rebuilt = `${origin}${match[1]}`;\n        if (isSameOriginReloadTarget(locationLike, rebuilt)) {\n          return rebuilt;\n        }\n      }\n    }\n\n    if (sameOriginCandidates.length) {\n      return sameOriginCandidates[0];\n    }\n\n    if (origin) {\n      return origin;\n    }\n\n    return '';\n  }\n\n  function coerceForceReloadUrlDescriptor(locationLike, descriptor, defaultParam = 'forceReload') {\n    const param =\n      descriptor && typeof descriptor.param === 'string' && descriptor.param\n        ? descriptor.param\n        : defaultParam;\n\n    const timestamp =\n      descriptor && typeof descriptor.timestamp === 'string' && descriptor.timestamp\n        ? descriptor.timestamp\n        : Date.now().toString(36);\n\n    const resolvedOriginalHref =\n      descriptor && typeof descriptor.originalHref === 'string' && descriptor.originalHref\n        ? descriptor.originalHref\n        : readLocationHrefSafe(locationLike);\n\n    const originalHref = resolvedOriginalHref || readLocationHrefSafe(locationLike);\n\n    const nextHrefCandidate =\n      descriptor && typeof descriptor.nextHref === 'string' && descriptor.nextHref\n        ? descriptor.nextHref\n        : originalHref;\n\n    const nextHref = enforceSameOriginNextHref(locationLike, originalHref, nextHrefCandidate);\n\n    return {\n      originalHref,\n      nextHref,\n      param,\n      timestamp,\n    };\n  }\n\n  function buildForceReloadUrl(locationLike, paramName) {\n    const param = typeof paramName === 'string' && paramName ? paramName : 'forceReload';\n    const timestamp = Date.now().toString(36);\n    const originalHref = readLocationHrefSafe(locationLike);\n    const baseCandidates = getForceReloadBaseCandidates(locationLike, originalHref);\n\n    if (!originalHref) {\n      return {\n        originalHref,\n        nextHref: originalHref,\n        param,\n        timestamp,\n      };\n    }\n\n    if (typeof URL === 'function') {\n      const urlCandidates = [originalHref, ...baseCandidates];\n\n      for (let index = 0; index < urlCandidates.length; index += 1) {\n        const candidate = urlCandidates[index];\n\n        try {\n          const url = index === 0 ? new URL(candidate) : new URL(originalHref, candidate);\n          url.searchParams.set(param, timestamp);\n          const candidateHref = url.toString();\n          return {\n            originalHref,\n            nextHref: enforceSameOriginNextHref(locationLike, originalHref, candidateHref),\n            param,\n            timestamp,\n          };\n        } catch (candidateError) {\n          void candidateError;\n        }\n      }\n    }\n\n    let href = originalHref;\n    let hash = '';\n    const hashIndex = href.indexOf('#');\n    if (hashIndex !== -1) {\n      hash = href.slice(hashIndex);\n      href = href.slice(0, hashIndex);\n    }\n\n    const pattern = new RegExp(`([?&])${param}=[^&]*`);\n    const replacement = `$1${param}=${timestamp}`;\n\n    if (pattern.test(href)) {\n      href = href.replace(pattern, replacement);\n    } else if (href.indexOf('?') !== -1) {\n      href += `&${param}=${timestamp}`;\n    } else if (href) {\n      href += `?${param}=${timestamp}`;\n    }\n\n    if (typeof URL === 'function') {\n      for (let index = 0; index < baseCandidates.length; index += 1) {\n        const candidate = baseCandidates[index];\n\n        try {\n          const absolute = new URL(href + hash, candidate).toString();\n          const candidateHref = absolute;\n          return {\n            originalHref,\n            nextHref: enforceSameOriginNextHref(locationLike, originalHref, candidateHref),\n            param,\n            timestamp,\n          };\n        } catch (absoluteError) {\n          void absoluteError;\n        }\n      }\n    }\n\n    const candidateHref = href ? href + hash : originalHref;\n    return {\n      originalHref,\n      nextHref: enforceSameOriginNextHref(locationLike, originalHref, candidateHref),\n      param,\n      timestamp,\n    };\n  }\n\n  function isForceReloadHash(hashValue, paramName) {\n    if (typeof hashValue !== 'string' || !hashValue) {\n      return false;\n    }\n\n    const trimmed = hashValue.trim();\n    if (!trimmed) {\n      return false;\n    }\n\n    const param = typeof paramName === 'string' && paramName ? paramName : 'forceReload';\n    const prefix = `#${param}`;\n\n    if (!trimmed.startsWith(prefix)) {\n      return false;\n    }\n\n    if (trimmed.length === prefix.length) {\n      return true;\n    }\n\n    const suffix = trimmed.slice(prefix.length);\n    return /^[-=]/.test(suffix);\n  }\n\n  function normaliseHrefForHistory(targetHref, baseHref) {\n    if (typeof targetHref !== 'string' || !targetHref) {\n      return targetHref;\n    }\n\n    if (typeof URL === 'function') {\n      const reference = typeof baseHref === 'string' && baseHref ? baseHref : undefined;\n\n      try {\n        const parsed = new URL(targetHref, reference);\n        return `${parsed.pathname || ''}${parsed.search || ''}${parsed.hash || ''}` || parsed.toString();\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return targetHref;\n  }\n\n  function cleanupForceReloadArtifacts(win, paramName = 'forceReload') {\n    const targetWindow = resolveWindow(win);\n    if (!targetWindow || !targetWindow.location) {\n      return false;\n    }\n\n    const { location } = targetWindow;\n    const originalHref = readLocationHrefSafe(location);\n    if (!originalHref) {\n      return false;\n    }\n\n    const param = typeof paramName === 'string' && paramName ? paramName : 'forceReload';\n\n    let cleanedHref = originalHref;\n    let removedQuery = false;\n    let removedHash = false;\n\n    if (typeof URL === 'function') {\n      try {\n        const url = new URL(originalHref);\n\n        if (url.searchParams && typeof url.searchParams.delete === 'function' && url.searchParams.has(param)) {\n          url.searchParams.delete(param);\n          removedQuery = true;\n        }\n\n        if (isForceReloadHash(url.hash, param)) {\n          url.hash = '';\n          removedHash = true;\n        }\n\n        cleanedHref = url.toString();\n      } catch (urlError) {\n        void urlError;\n      }\n    }\n\n    if (!removedQuery) {\n      let hrefWithoutHash = cleanedHref;\n      let hashPart = '';\n\n      const hashIndex = hrefWithoutHash.indexOf('#');\n      if (hashIndex !== -1) {\n        hashPart = hrefWithoutHash.slice(hashIndex);\n        hrefWithoutHash = hrefWithoutHash.slice(0, hashIndex);\n      }\n\n      const queryIndex = hrefWithoutHash.indexOf('?');\n      if (queryIndex !== -1) {\n        const base = hrefWithoutHash.slice(0, queryIndex);\n        const query = hrefWithoutHash.slice(queryIndex + 1);\n\n        const segments = query.split('&');\n        const filtered = [];\n\n        for (let index = 0; index < segments.length; index += 1) {\n          const segment = segments[index];\n          if (!segment) {\n            continue;\n          }\n\n          const equalsIndex = segment.indexOf('=');\n          const key = equalsIndex === -1 ? segment : segment.slice(0, equalsIndex);\n\n          if (key === param) {\n            removedQuery = true;\n            continue;\n          }\n\n          filtered.push(segment);\n        }\n\n        hrefWithoutHash = filtered.length ? `${base}?${filtered.join('&')}` : base;\n      }\n\n      cleanedHref = hashPart ? `${hrefWithoutHash}${hashPart}` : hrefWithoutHash;\n    }\n\n    if (!removedHash && isForceReloadHash(targetWindow.location && targetWindow.location.hash, param)) {\n      removedHash = true;\n      cleanedHref = cleanedHref.replace(/#.*$/, '');\n    }\n\n    if (!removedQuery && !removedHash) {\n      return false;\n    }\n\n    const baseHref = normaliseHrefForComparison(originalHref, originalHref) || originalHref;\n\n    let historyLike = null;\n    try {\n      historyLike = targetWindow.history || null;\n    } catch (historyError) {\n      safeWarn('Force reload cleanup failed to access history object', historyError);\n      historyLike = null;\n    }\n\n    if (historyLike && typeof historyLike.replaceState === 'function') {\n      let stateSnapshot = null;\n      let hasStateSnapshot = false;\n\n      try {\n        stateSnapshot = historyLike.state;\n        hasStateSnapshot = true;\n      } catch (stateError) {\n        safeWarn('Force reload cleanup failed to snapshot history state', stateError);\n      }\n\n      const replaceUrl = normaliseHrefForHistory(cleanedHref, baseHref);\n\n      try {\n        historyLike.replaceState(hasStateSnapshot ? stateSnapshot : null, '', replaceUrl);\n        return true;\n      } catch (replaceError) {\n        safeWarn('Force reload cleanup failed to update history state', replaceError);\n      }\n    }\n\n    if (removedHash) {\n      try {\n        if (typeof targetWindow.location.hash === 'string' && isForceReloadHash(targetWindow.location.hash, param)) {\n          targetWindow.location.hash = '';\n          return true;\n        }\n      } catch (hashError) {\n        safeWarn('Force reload cleanup failed to clear hash fallback', hashError);\n      }\n    }\n\n    return false;\n  }\n\n  function scheduleForceReloadNavigationWarning(\n    locationLike,\n    baseHref,\n    description,\n    before,\n    expected,\n    initialAfter,\n  ) {\n    let schedule = null;\n\n    try {\n      if (typeof window !== 'undefined' && window && typeof window.setTimeout === 'function') {\n        schedule = window.setTimeout.bind(window);\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (!schedule) {\n      if (typeof setTimeout === 'function') {\n        schedule = setTimeout;\n      } else {\n        safeWarn('Forced reload navigation attempt did not update location', {\n          description,\n          before,\n          after: initialAfter,\n          expected,\n        });\n        return;\n      }\n    }\n\n    let resolved = false;\n\n    const evaluate = () => {\n      const currentRaw = readLocationHrefSafe(locationLike);\n      const current = normaliseHrefForComparison(currentRaw, baseHref);\n\n      if (\n        (expected && (current === expected || current === `${expected}#`))\n        || (before !== current && current && (!expected || current === expected))\n      ) {\n        resolved = true;\n        return { matched: true, value: current };\n      }\n\n      return { matched: false, value: current };\n    };\n\n    const verifyDelays = [90, 240, 480];\n\n    verifyDelays.forEach((delay, index) => {\n      const isFinalCheck = index === verifyDelays.length - 1;\n\n      const runCheck = () => {\n        if (resolved) {\n          return;\n        }\n\n        const result = evaluate();\n\n        if (result.matched) {\n          return;\n        }\n\n        if (isFinalCheck) {\n          resolved = true;\n          safeWarn('Forced reload navigation attempt did not update location', {\n            description,\n            before,\n            after: result.value,\n            expected,\n          });\n        }\n      };\n\n      try {\n        schedule(runCheck, delay);\n      } catch (scheduleError) {\n        void scheduleError;\n        if (isFinalCheck) {\n          runCheck();\n        }\n      }\n    });\n  }\n\n  function attemptForceReloadNavigation(locationLike, nextHref, baseHref, applyFn, description) {\n    if (!locationLike || typeof applyFn !== 'function' || typeof nextHref !== 'string' || !nextHref) {\n      return false;\n    }\n\n    const beforeRaw = readLocationHrefSafe(locationLike);\n    const before = normaliseHrefForComparison(beforeRaw, baseHref);\n\n    try {\n      applyFn(nextHref);\n    } catch (error) {\n      safeWarn('Forced reload navigation helper failed', { description, error });\n      return false;\n    }\n\n    const afterRaw = readLocationHrefSafe(locationLike);\n    const after = normaliseHrefForComparison(afterRaw, baseHref);\n    const expected = normaliseHrefForComparison(nextHref, baseHref);\n\n    if (\n      (expected && (after === expected || after === `${expected}#`))\n      || (before !== after && after && (!expected || after === expected))\n    ) {\n      return true;\n    }\n\n    scheduleForceReloadNavigationWarning(locationLike, baseHref, description, before, expected, after);\n\n    return false;\n  }\n\n  function attemptForceReloadHistoryFallback(win, locationLike, nextHref, baseHref) {\n    if (!win || !locationLike || typeof nextHref !== 'string' || !nextHref) {\n      return false;\n    }\n\n    let historyLike = null;\n    try {\n      historyLike = win.history || null;\n    } catch (error) {\n      safeWarn('Forced reload history access failed', error);\n      historyLike = null;\n    }\n\n    if (!historyLike || typeof historyLike.replaceState !== 'function') {\n      return false;\n    }\n\n    const beforeRaw = readLocationHrefSafe(locationLike);\n    const before = normaliseHrefForComparison(beforeRaw, baseHref);\n    const expected = normaliseHrefForComparison(nextHref, baseHref);\n\n    let replaceUrl = nextHref;\n    try {\n      const reference = beforeRaw || baseHref || undefined;\n      const parsed = typeof URL === 'function' ? new URL(nextHref, reference) : null;\n      if (parsed) {\n        replaceUrl = `${parsed.pathname || ''}${parsed.search || ''}${parsed.hash || ''}` || parsed.toString();\n      }\n    } catch (error) {\n      safeWarn('Forced reload history fallback URL parse failed', error);\n      replaceUrl = nextHref;\n    }\n\n    let stateSnapshot = null;\n    let hasStateSnapshot = false;\n\n    try {\n      stateSnapshot = historyLike.state;\n      hasStateSnapshot = true;\n    } catch (stateError) {\n      safeWarn('Forced reload history state snapshot failed', stateError);\n    }\n\n    try {\n      historyLike.replaceState(hasStateSnapshot ? stateSnapshot : null, '', replaceUrl);\n    } catch (replaceError) {\n      safeWarn('Forced reload history replaceState failed', replaceError);\n      return false;\n    }\n\n    const afterRaw = readLocationHrefSafe(locationLike);\n    const after = normaliseHrefForComparison(afterRaw, baseHref);\n\n    const updated =\n      (expected && (after === expected || after === `${expected}#`))\n      || (before !== after && after && (!expected || after === expected));\n\n    if (!updated) {\n      scheduleForceReloadNavigationWarning(\n        locationLike,\n        baseHref,\n        'history.replaceState',\n        before,\n        expected,\n        after,\n      );\n      return false;\n    }\n\n    if (typeof locationLike.reload === 'function') {\n      try {\n        locationLike.reload();\n        return true;\n      } catch (reloadError) {\n        safeWarn('Forced reload via history replaceState reload failed', reloadError);\n      }\n    }\n\n    return true;\n  }\n\n  function scheduleForceReloadFallbacks(win, locationLike, options = {}) {\n    if (!win || !locationLike) {\n      return;\n    }\n\n    let schedule = null;\n    try {\n      if (typeof win.setTimeout === 'function') {\n        schedule = win.setTimeout.bind(win);\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (!schedule) {\n      if (typeof setTimeout === 'function') {\n        schedule = setTimeout;\n      } else {\n        return;\n      }\n    }\n\n    const hasReload = options.hasReload === true && typeof locationLike.reload === 'function';\n    const baseHref = typeof options.baseHref === 'string' ? options.baseHref : '';\n    const nextHref = typeof options.nextHref === 'string' ? options.nextHref : '';\n    const originalHref = typeof options.originalHref === 'string' ? options.originalHref : '';\n\n    const fallbackHref = nextHref || baseHref || originalHref || '';\n    const hashBase = fallbackHref ? fallbackHref.split('#')[0] : (baseHref || originalHref || '');\n    const fallbackToken =\n      typeof options.timestamp === 'string' && options.timestamp\n        ? options.timestamp\n        : Date.now().toString(36);\n    const hashFallback = hashBase ? `${hashBase}#forceReload-${fallbackToken}` : '';\n\n    const steps = [];\n\n    let nextDelay = 120;\n    const delayIncrement = 120;\n\n    const queueStep = (run) => {\n      steps.push({\n        delay: nextDelay,\n        run,\n      });\n      nextDelay += delayIncrement;\n    };\n\n    if (fallbackHref) {\n      if (typeof locationLike.assign === 'function') {\n        queueStep(() => {\n          try {\n            locationLike.assign(fallbackHref);\n          } catch (error) {\n            safeWarn('Forced reload fallback via location.assign failed', error);\n          }\n        });\n      }\n\n      if (typeof locationLike.replace === 'function') {\n        queueStep(() => {\n          try {\n            locationLike.replace(fallbackHref);\n          } catch (error) {\n            safeWarn('Forced reload fallback via location.replace failed', error);\n          }\n        });\n      }\n\n      queueStep(() => {\n        try {\n          locationLike.href = fallbackHref;\n        } catch (error) {\n          safeWarn('Forced reload fallback via href assignment failed', error);\n        }\n      });\n    }\n\n    if (hashFallback && hashFallback !== fallbackHref) {\n      queueStep(() => {\n        try {\n          locationLike.href = hashFallback;\n        } catch (error) {\n          safeWarn('Forced reload fallback via hash injection failed', error);\n        }\n      });\n    }\n\n    if (hasReload) {\n      const reloadDelay = steps.length ? Math.max(nextDelay, 280) : 280;\n      steps.push({\n        delay: reloadDelay,\n        run() {\n          try {\n            locationLike.reload();\n          } catch (error) {\n            safeWarn('Timed force reload fallback failed', error);\n          }\n        },\n      });\n    }\n\n    if (!steps.length) {\n      return;\n    }\n\n    steps.forEach((step) => {\n      try {\n        schedule(step.run, step.delay);\n      } catch (scheduleError) {\n        safeWarn('Unable to schedule forced reload fallback', scheduleError);\n      }\n    });\n  }\n\n  function triggerReload(windowOverride, precomputedForceReloadUrl) {\n    const win = resolveWindow(windowOverride);\n    if (!win || !win.location) {\n      return false;\n    }\n\n    const { location } = win;\n    const hasReplace = location && typeof location.replace === 'function';\n    const hasAssign = location && typeof location.assign === 'function';\n    const hasReload = location && typeof location.reload === 'function';\n    let navigationTriggered = false;\n\n    const forceReloadDescriptor =\n      precomputedForceReloadUrl && typeof precomputedForceReloadUrl === 'object'\n        ? precomputedForceReloadUrl\n        : buildForceReloadUrl(location, 'forceReload');\n    const forceReloadUrl = coerceForceReloadUrlDescriptor(location, forceReloadDescriptor, 'forceReload');\n\n    const originalHrefCandidate =\n      typeof forceReloadUrl.originalHref === 'string' && forceReloadUrl.originalHref\n        ? forceReloadUrl.originalHref\n        : readLocationHrefSafe(location);\n    const originalHref = originalHrefCandidate || readLocationHrefSafe(location);\n    const nextHref = typeof forceReloadUrl.nextHref === 'string' ? forceReloadUrl.nextHref : '';\n    const timestamp = forceReloadUrl.timestamp;\n    const baseHref = normaliseHrefForComparison(originalHref, originalHref) || originalHref;\n\n    if (hasReplace && nextHref) {\n      navigationTriggered = attemptForceReloadNavigation(\n        location,\n        nextHref,\n        baseHref,\n        (url) => {\n          location.replace(url);\n        },\n        'location.replace',\n      );\n    }\n\n    if (hasAssign && !navigationTriggered && nextHref) {\n      navigationTriggered = attemptForceReloadNavigation(\n        location,\n        nextHref,\n        baseHref,\n        (url) => {\n          location.assign(url);\n        },\n        'location.assign',\n      );\n    }\n\n    if (!navigationTriggered && nextHref && nextHref !== originalHref) {\n      navigationTriggered = attemptForceReloadNavigation(\n        location,\n        nextHref,\n        baseHref,\n        (url) => {\n          location.href = url;\n        },\n        'location.href assignment',\n      );\n    }\n\n    if (!navigationTriggered && win && nextHref) {\n      navigationTriggered = attemptForceReloadHistoryFallback(win, location, nextHref, baseHref);\n    }\n\n    const canOnlyReload = !nextHref || nextHref === originalHref;\n\n    if (!navigationTriggered && canOnlyReload && hasReload) {\n      try {\n        location.reload();\n        navigationTriggered = true;\n      } catch (reloadError) {\n        safeWarn('Forced reload via location.reload failed', reloadError);\n      }\n    }\n\n    if (!navigationTriggered) {\n      scheduleForceReloadFallbacks(win, location, {\n        originalHref,\n        baseHref,\n        nextHref,\n        hasReload,\n        timestamp,\n      });\n    }\n\n    return navigationTriggered;\n  }\n\n  async function reloadApp(options = {}) {\n    const win = resolveWindow(options.window);\n    const location = resolveLocation(options.location || (win && win.location));\n    const forceReloadUrl = coerceForceReloadUrlDescriptor(\n      location,\n      buildForceReloadUrl(location, 'forceReload'),\n      'forceReload',\n    );\n\n    const navigatorLike = resolveNavigator(options.navigator);\n    const connectivity = await probeReloadConnectivity({\n      navigatorLike,\n      windowLike: win,\n      locationLike: location,\n      fetchFn: resolveFetch(options.fetch, win),\n      forceReloadUrl,\n      timeoutMs:\n        typeof options.connectivityProbeTimeoutMs === 'number'\n          ? options.connectivityProbeTimeoutMs\n          : FORCE_RELOAD_CONNECTIVITY_TIMEOUT_MS,\n    });\n\n    reportConnectivityProbeResult(connectivity, { stage: 'reload-app-probe', source: 'reloadApp.probe' });\n\n    if (!connectivity.reachable) {\n      const notifyOffline =\n        typeof options.onOfflineReloadBlocked === 'function'\n          ? options.onOfflineReloadBlocked\n          : resolveGlobal('announceForceReloadOfflineNotice');\n\n      if (typeof notifyOffline === 'function') {\n        try {\n          notifyOffline({ reason: connectivity.reason || 'offline', source: 'reloadApp' });\n        } catch (notifyError) {\n          safeWarn('Failed to announce offline reload guard', notifyError);\n        }\n      }\n\n      if (connectivity.detail && connectivity.reason !== 'offline') {\n        safeWarn('Connectivity probe blocked forced reload', connectivity.detail);\n      }\n\n      emitConnectivityState({\n        status: 'degraded',\n        reason: 'reload-blocked',\n        detail: {\n          previousReason: connectivity.reason || 'offline',\n          stage: 'reload-app',\n          source: 'reloadApp.blocked',\n        },\n        source: 'reloadApp.blocked',\n      });\n\n      return {\n        blocked: true,\n        reason: connectivity.reason || 'offline',\n        uiCacheCleared: false,\n        serviceWorkersUnregistered: false,\n        serviceWorkerStatusKnown: false,\n        warmupCompleted: false,\n        cachesCleared: false,\n        reloadTriggered: false,\n        navigationTriggered: false,\n      };\n    }\n\n    const serviceWorkerRegistrationsPromise =\n      navigatorLike && navigatorLike.serviceWorker\n        ? collectServiceWorkerRegistrations(navigatorLike)\n        : Promise.resolve([]);\n\n    let uiCacheCleared = false;\n    const clearUiCacheStorageEntriesFn =\n      typeof options.clearUiCacheStorageEntries === 'function'\n        ? options.clearUiCacheStorageEntries\n        : typeof resolveGlobal('clearUiCacheStorageEntries') === 'function'\n          ? resolveGlobal('clearUiCacheStorageEntries')\n          : null;\n\n    if (clearUiCacheStorageEntriesFn) {\n      try {\n        clearUiCacheStorageEntriesFn();\n        uiCacheCleared = true;\n      } catch (error) {\n        safeWarn('Failed to clear UI caches via storage helper', error);\n      }\n    }\n\n    if (!uiCacheCleared) {\n      try {\n        uiCacheCleared = clearUiCacheEntriesFallback(options);\n      } catch (fallbackError) {\n        safeWarn('Fallback UI cache clear failed', fallbackError);\n      }\n    }\n\n    const serviceWorkerCleanupPromise = (async () => {\n      try {\n        return await unregisterServiceWorkers(options.navigator, serviceWorkerRegistrationsPromise);\n      } catch (error) {\n        safeWarn('Service worker cleanup failed', error);\n        return false;\n      }\n    })();\n\n    const cacheCleanupPromise = (async () => {\n      try {\n        return await clearCacheStorage(options.caches);\n      } catch (error) {\n        safeWarn('Cache clear failed', error);\n        return false;\n      }\n    })();\n\n    const warmupHandle = scheduleReloadWarmup({\n      window: win,\n      navigator: options.navigator,\n      fetch: options.fetch,\n      nextHref: forceReloadUrl.nextHref,\n      serviceWorkerPromise: serviceWorkerCleanupPromise,\n      cachePromise: cacheCleanupPromise,\n      allowCache: true,\n      warmupWaitMs: typeof options.warmupWaitMs === 'number' ? options.warmupWaitMs : undefined,\n    });\n\n    const resolveWarmupPromise = (handle) => {\n      if (!handle || typeof handle !== 'object') {\n        return null;\n      }\n\n      if (handle.promise && typeof handle.promise.then === 'function') {\n        return handle.promise;\n      }\n\n      if (handle.done && typeof handle.done.then === 'function') {\n        return handle.done;\n      }\n\n      return null;\n    };\n\n    const wrapResultWithSource = (source, promise) => {\n      if (!promise || typeof promise.then !== 'function') {\n        return Promise.resolve({\n          source,\n          value: promise,\n          successful: true,\n          error: null,\n        });\n      }\n\n      return Promise.resolve(promise)\n        .then((value) => ({\n          source,\n          value,\n          successful: true,\n          error: null,\n        }))\n        .catch((error) => ({\n          source,\n          value: undefined,\n          successful: false,\n          error,\n        }));\n    };\n\n    const warmupPromise = resolveWarmupPromise(warmupHandle);\n\n    const controllerChangeWatcher = observeServiceWorkerControllerChange(options.navigator);\n    const controllerChangeResultPromise = controllerChangeWatcher\n      ? wrapResultWithSource('controllerChange', controllerChangeWatcher.promise)\n      : null;\n\n    let serviceWorkerResultLogged = false;\n    const serviceWorkerResultPromiseRaw = wrapResultWithSource('serviceWorker', serviceWorkerCleanupPromise);\n    const serviceWorkerResultPromise = serviceWorkerResultPromiseRaw.then((result) => {\n      if (!result.successful && result.error && !serviceWorkerResultLogged) {\n        serviceWorkerResultLogged = true;\n        safeWarn('Service worker cleanup promise rejected', result.error);\n      }\n      return result;\n    });\n\n    const warmupResultPromise = warmupPromise ? wrapResultWithSource('warmup', warmupPromise) : null;\n\n    const gateCandidates = [serviceWorkerResultPromise];\n    if (warmupResultPromise) {\n      gateCandidates.push(warmupResultPromise);\n    }\n    if (controllerChangeResultPromise) {\n      gateCandidates.push(controllerChangeResultPromise);\n    }\n\n    const gatePromise = gateCandidates.length > 1 ? Promise.race(gateCandidates) : gateCandidates[0];\n\n    let serviceWorkersUnregistered = false;\n    let warmupFinishedBeforeReload = false;\n    let serviceWorkerStatusKnown = false;\n\n    try {\n      const cleanupTimeoutMs = typeof options.cleanupTimeoutMs === 'number' ? options.cleanupTimeoutMs : FORCE_RELOAD_CLEANUP_TIMEOUT_MS;\n\n      const serviceWorkerAwaitResult = await awaitPromiseWithSoftTimeout(\n        gatePromise,\n        cleanupTimeoutMs,\n        () => {\n          safeWarn('Service worker cleanup or warmup timed out before reload, continuing anyway.', {\n            timeoutMs: cleanupTimeoutMs,\n          });\n        },\n        (lateError) => {\n          if (lateError && lateError.source === 'warmup') {\n            const detail = lateError.error || lateError;\n            safeWarn('Reload warmup failed after reload triggered', detail);\n            return;\n          }\n\n          const detail = lateError && lateError.error ? lateError.error : lateError;\n          safeWarn('Service worker cleanup failed after reload triggered', detail);\n        },\n      );\n\n      if (serviceWorkerAwaitResult && serviceWorkerAwaitResult.timedOut !== true) {\n        const gateResult = serviceWorkerAwaitResult.result;\n\n        if (gateResult && gateResult.source === 'serviceWorker') {\n          serviceWorkerStatusKnown = true;\n\n          if (gateResult.successful) {\n            serviceWorkersUnregistered = !!gateResult.value;\n          } else if (!serviceWorkerResultLogged && gateResult.error) {\n            serviceWorkerResultLogged = true;\n            safeWarn('Service worker cleanup promise rejected', gateResult.error);\n          }\n        } else if (gateResult && gateResult.source === 'controllerChange') {\n          serviceWorkerStatusKnown = true;\n          if (!gateResult.successful && gateResult.error) {\n            safeWarn('Service worker controllerchange watcher rejected', gateResult.error);\n          }\n        } else if (gateResult && gateResult.source === 'warmup') {\n          warmupFinishedBeforeReload = gateResult.successful && gateResult.value === true;\n\n          if (!gateResult.successful && gateResult.error) {\n            safeWarn('Reload warmup promise rejected before reload triggered', gateResult.error);\n          }\n        }\n      }\n    } catch (error) {\n      const detail = error && error.error ? error.error : error;\n      safeWarn('Reload preparation gate failed', detail);\n    } finally {\n      if (controllerChangeWatcher) {\n        try {\n          controllerChangeWatcher.cancel();\n        } catch (controllerCleanupError) {\n          void controllerCleanupError;\n        }\n      }\n    }\n\n    let reloadTriggered = false;\n    const reloadFn = typeof options.reloadWindow === 'function' ? options.reloadWindow : triggerReload;\n\n    try {\n      reloadTriggered = reloadFn(options.window, forceReloadUrl);\n    } catch (error) {\n      safeWarn('Forced reload handler failed', error);\n      reloadTriggered = triggerReload(options.window, forceReloadUrl);\n    }\n\n    if (!reloadTriggered) {\n      if (win && win.location && typeof win.location.reload === 'function') {\n        try {\n          win.location.reload();\n          reloadTriggered = true;\n        } catch (finalError) {\n          safeWarn('Final reload attempt failed', finalError);\n        }\n      }\n    }\n\n    let cachesCleared = false;\n\n    try {\n      cachesCleared = await cacheCleanupPromise;\n    } catch (error) {\n      safeWarn('Cache cleanup promise rejected', error);\n      cachesCleared = false;\n    }\n\n    return {\n      uiCacheCleared,\n      serviceWorkersUnregistered,\n      serviceWorkerStatusKnown,\n      warmupCompleted: warmupFinishedBeforeReload,\n      cachesCleared,\n      reloadTriggered,\n      navigationTriggered: reloadTriggered,\n    };\n  }\n\n  function shouldRegisterImmediately(win) {\n    if (!win || !win.document) {\n      return false;\n    }\n    const { document } = win;\n    if (typeof document.readyState === 'string') {\n      return document.readyState === 'complete';\n    }\n    return false;\n  }\n\n  function registerServiceWorker(scriptUrl = 'service-worker.js', options = {}) {\n    const win = resolveWindow(options.window);\n    const nav = resolveNavigator(options.navigator);\n\n    if (!nav || !nav.serviceWorker || typeof nav.serviceWorker.register !== 'function') {\n      return Promise.resolve(null);\n    }\n\n    const register = () => {\n      try {\n        const promise = nav.serviceWorker.register(scriptUrl, options.registrationOptions);\n        promise.catch((error) => {\n          safeWarn('Service worker registration failed', error);\n        });\n        return promise;\n      } catch (error) {\n        safeWarn('Service worker registration threw an exception', error);\n        return Promise.reject(error);\n      }\n    };\n\n    const finalizePendingRegistration = (promise) => {\n      const tracked = Promise.resolve(promise).finally(() => {\n        pendingServiceWorkerRegistration = null;\n      });\n      pendingServiceWorkerRegistration = tracked;\n      return tracked;\n    };\n\n    if (!win || typeof win.addEventListener !== 'function') {\n      return register();\n    }\n\n    if (pendingServiceWorkerRegistration) {\n      return pendingServiceWorkerRegistration;\n    }\n\n    if (shouldRegisterImmediately(win) || options.immediate === true) {\n      return finalizePendingRegistration(Promise.resolve().then(() => register()));\n    }\n\n    const waitForLoad = new Promise((resolve, reject) => {\n      const handler = () => {\n        try {\n          win.removeEventListener('load', handler);\n        } catch (error) {\n          void error;\n        }\n        try {\n          resolve(register());\n        } catch (error) {\n          reject(error);\n        }\n      };\n\n      win.addEventListener('load', handler, { once: true });\n    });\n\n    return finalizePendingRegistration(waitForLoad);\n  }\n\n  function initConnectivityListeners(win) {\n    const targetWindow = win || resolveWindow();\n    if (!targetWindow || typeof targetWindow.addEventListener !== 'function') {\n      return;\n    }\n\n    targetWindow.addEventListener('online', () => {\n      emitConnectivityState({ status: 'online', source: 'navigator' });\n    });\n\n    targetWindow.addEventListener('offline', () => {\n      emitConnectivityState({ status: 'offline', source: 'navigator' });\n    });\n\n    // Initialize with current state\n    if (typeof targetWindow.navigator !== 'undefined' && targetWindow.navigator.onLine === false) {\n      emitConnectivityState({ status: 'offline', source: 'navigator-init' });\n    }\n  }\n\n  const offlineAPI = {\n    registerServiceWorker,\n    reloadApp,\n    getConnectivityState() {\n      return connectivityState;\n    },\n    subscribeConnectivityStatus,\n    unsubscribeConnectivityStatus,\n    __internal: {\n      collectFallbackUiCacheStorages,\n      clearUiCacheEntriesFallback,\n      unregisterServiceWorkers,\n      clearCacheStorage,\n      triggerReload,\n      cleanupForceReloadArtifacts,\n      coerceForceReloadUrlDescriptor,\n      scheduleReloadWarmup,\n      initConnectivityListeners,\n      updateOfflineUi,\n      emitConnectivityState,\n    },\n  };\n\n  cleanupForceReloadArtifacts();\n  initConnectivityListeners();\n\n  freezeDeep(offlineAPI);\n\n  informModuleGlobals('cineOffline', offlineAPI);\n\n  registerOrQueueModule(\n    'cineOffline',\n    offlineAPI,\n    {\n      category: 'offline',\n      description: 'Offline helpers for service worker registration and cache recovery.',\n      replace: true,\n      connections: ['cineModuleGlobals', 'cineModuleEnvironment', 'cineEnvironmentBridge', 'cineModuleContext'],\n    },\n    (error) => {\n      safeWarn('Unable to register cineOffline in module registry.', error);\n    },\n  );\n\n  if (GLOBAL_SCOPE && typeof GLOBAL_SCOPE === 'object') {\n    let existingOffline = null;\n    try {\n      existingOffline = GLOBAL_SCOPE.cineOffline || null;\n    } catch (error) {\n      void error;\n      existingOffline = null;\n    }\n\n    if (existingOffline !== offlineAPI) {\n      const exposed = exposeGlobal('cineOffline', offlineAPI, {\n        configurable: true,\n        enumerable: false,\n        writable: false,\n      });\n\n      if (!exposed) {\n        safeWarn('Unable to expose cineOffline globally.');\n      }\n    }\n  }\n\n  if (typeof module !== 'undefined' && module && module.exports) {\n    module.exports = offlineAPI;\n  }\n})();\n","import cineModuleBase from './base.js';\nimport cineModules from './registry.js';\nimport { cineModuleEnvironment } from './environment.js';\nimport { cineEnvironmentBridge } from './environment-bridge.js';\n\n// (function () {\nfunction detectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\nvar PRIMARY_SCOPE = detectGlobalScope();\n\nfunction collectCandidateScopes(primary) {\n  var scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\nfunction tryRequireLocal(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\nfunction resolveFromScopes(propertyName) {\n  var scopes = collectCandidateScopes(PRIMARY_SCOPE);\n  for (var index = 0; index < scopes.length; index += 1) {\n    var candidate = scopes[index];\n    if (candidate && typeof candidate[propertyName] === 'object') {\n      return candidate[propertyName];\n    }\n  }\n  return null;\n}\n\nvar MODULE_BASE = (function resolveModuleBase() {\n  if (cineModuleBase && typeof cineModuleBase === 'object') {\n    return cineModuleBase;\n  }\n  return resolveFromScopes('cineModuleBase');\n})();\n\nvar MODULE_ENV = (function resolveModuleEnvironment() {\n  if (cineModuleEnvironment && typeof cineModuleEnvironment === 'object') {\n    return cineModuleEnvironment;\n  }\n  return resolveFromScopes('cineModuleEnvironment');\n})();\n\nvar ENV_BRIDGE = (function resolveEnvironmentBridge() {\n  if (cineEnvironmentBridge && typeof cineEnvironmentBridge === 'object') {\n    return cineEnvironmentBridge;\n  }\n  return resolveFromScopes('cineEnvironmentBridge');\n})();\n\nvar GLOBAL_SCOPE =\n  (ENV_BRIDGE && typeof ENV_BRIDGE.getGlobalScope === 'function'\n    ? ENV_BRIDGE.getGlobalScope()\n    : null)\n  || (MODULE_ENV && typeof MODULE_ENV.getGlobalScope === 'function'\n    ? MODULE_ENV.getGlobalScope()\n    : null)\n  || (MODULE_BASE && typeof MODULE_BASE.getGlobalScope === 'function'\n    ? MODULE_BASE.getGlobalScope()\n    : null)\n  || PRIMARY_SCOPE;\n\nvar PENDING_QUEUE_KEY = (function resolvePendingKey() {\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.getPendingQueueKey === 'function') {\n    try {\n      var bridgedKey = ENV_BRIDGE.getPendingQueueKey();\n      if (typeof bridgedKey === 'string' && bridgedKey) {\n        return bridgedKey;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.PENDING_QUEUE_KEY === 'string' && MODULE_ENV.PENDING_QUEUE_KEY) {\n    return MODULE_ENV.PENDING_QUEUE_KEY;\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.PENDING_QUEUE_KEY === 'string' && MODULE_BASE.PENDING_QUEUE_KEY) {\n    return MODULE_BASE.PENDING_QUEUE_KEY;\n  }\n\n  return '__cinePendingModuleRegistrations__';\n})();\n\nfunction ensureQueue(scope) {\n  var targetScope = scope || GLOBAL_SCOPE;\n  if (!targetScope || typeof targetScope !== 'object') {\n    return null;\n  }\n\n  var queue = null;\n  try {\n    queue = targetScope[PENDING_QUEUE_KEY];\n  } catch (readError) {\n    void readError;\n    queue = null;\n  }\n\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  try {\n    Object.defineProperty(targetScope, PENDING_QUEUE_KEY, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: [],\n    });\n    queue = targetScope[PENDING_QUEUE_KEY];\n  } catch (defineError) {\n    void defineError;\n    try {\n      if (!Array.isArray(targetScope[PENDING_QUEUE_KEY])) {\n        targetScope[PENDING_QUEUE_KEY] = [];\n      }\n      queue = targetScope[PENDING_QUEUE_KEY];\n    } catch (assignmentError) {\n      void assignmentError;\n      return null;\n    }\n  }\n\n  return queue;\n}\n\n\n\nfunction isNodeProcessReference(value) {\n  if (!value) {\n    return false;\n  }\n\n  if (typeof process === 'undefined' || !process) {\n    return false;\n  }\n\n  if (value === process) {\n    return true;\n  }\n\n  if (typeof value === 'object') {\n    try {\n      if (value.constructor && value.constructor.name === 'process') {\n        return true;\n      }\n    } catch (processInspectionError) {\n      void processInspectionError;\n    }\n\n    if (\n      typeof value.pid === 'number' &&\n      typeof value.nextTick === 'function' &&\n      typeof value.emit === 'function' &&\n      typeof value.binding === 'function'\n    ) {\n      return true;\n    }\n  }\n\n  if (typeof value === 'function') {\n    if (\n      value === process.binding ||\n      value === process._linkedBinding ||\n      value === process.dlopen\n    ) {\n      return true;\n    }\n\n    try {\n      const functionName = value.name || '';\n      if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n        const source = Function.prototype.toString.call(value);\n        if (source && source.indexOf('[native code]') !== -1) {\n          return true;\n        }\n      }\n    } catch (functionInspectionError) {\n      void functionInspectionError;\n    }\n  }\n\n  return false;\n}\n\nfunction shouldBypassDeepFreeze(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (isNodeProcessReference(value)) {\n    return true;\n  }\n\n  if (\n    typeof process !== 'undefined' &&\n    process &&\n    process.release &&\n    process.release.name === 'node'\n  ) {\n    return true;\n  }\n\n  try {\n    if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n      return true;\n    }\n\n    if (typeof value.on === 'function' && typeof value.emit === 'function') {\n      if (typeof value.write === 'function' || typeof value.read === 'function') {\n        return true;\n      }\n\n      var ctorName = '';\n      try {\n        ctorName = value.constructor && value.constructor.name;\n      } catch (ctorError) {\n        void ctorError;\n      }\n\n      if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n        return true;\n      }\n    }\n\n    if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n      var tag = value[Symbol.toStringTag];\n      if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n        return true;\n      }\n    }\n  } catch (inspectionError) {\n    void inspectionError;\n  }\n\n  return false;\n}\n\nfunction fallbackFreezeDeep(value, seen) {\n  var localSeen = seen;\n  if (!localSeen) {\n    if (typeof WeakSet === 'function') {\n      localSeen = new WeakSet();\n    } else {\n      var seenValues = [];\n      localSeen = {\n        add: function add(item) {\n          seenValues.push(item);\n        },\n        has: function has(item) {\n          return seenValues.indexOf(item) !== -1;\n        },\n      };\n    }\n  }\n\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  if (shouldBypassDeepFreeze(value)) {\n    return value;\n  }\n\n  if (typeof process !== 'undefined' && process && process.env && process.env.JEST_WORKER_ID) {\n    try {\n      if (typeof Object.freeze === 'function') {\n        Object.freeze(value);\n      }\n    } catch (freezeError) {\n      void freezeError;\n    }\n    return value;\n  }\n\n  if (\n    value === PRIMARY_SCOPE\n    || (typeof globalThis !== 'undefined' && value === globalThis)\n    || (typeof window !== 'undefined' && value === window)\n    || (typeof self !== 'undefined' && value === self)\n    || (typeof global !== 'undefined' && value === global)\n  ) {\n    return value;\n  }\n\n  try {\n    if (typeof localSeen.has === 'function' && localSeen.has(value)) {\n      return value;\n    }\n  } catch (seenError) {\n    void seenError;\n  }\n\n  try {\n    if (typeof localSeen.add === 'function') {\n      localSeen.add(value);\n    }\n  } catch (addError) {\n    void addError;\n  }\n\n  try {\n    Object.freeze(value);\n  } catch (freezeError) {\n    void freezeError;\n  }\n\n  // Shallow freeze is sufficient for module metadata; traversing nested\n  // properties can cross VM boundaries in Node and trigger V8 assertions.\n  // Returning early keeps runtime bootstrap safe in test environments.\n  return value;\n\n}\n\nvar freezeDeep = (function resolveFreezeDeep() {\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.freezeDeep === 'function') {\n    return function bridgeFreezeDeep(value, seen) {\n      try {\n        return ENV_BRIDGE.freezeDeep(value, seen);\n      } catch (error) {\n        void error;\n        return fallbackFreezeDeep(value, seen);\n      }\n    };\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.freezeDeep === 'function') {\n    return MODULE_ENV.freezeDeep;\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.freezeDeep === 'function') {\n    return MODULE_BASE.freezeDeep;\n  }\n\n  return fallbackFreezeDeep;\n})();\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nvar safeWarn = (function resolveSafeWarn() {\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.safeWarn === 'function') {\n    return function bridgeSafeWarn(message, detail) {\n      try {\n        ENV_BRIDGE.safeWarn(message, detail);\n      } catch (error) {\n        void error;\n        fallbackSafeWarn(message, detail);\n      }\n    };\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.safeWarn === 'function') {\n    return MODULE_ENV.safeWarn;\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.safeWarn === 'function') {\n    return MODULE_BASE.safeWarn;\n  }\n\n  return fallbackSafeWarn;\n})();\n\nfunction fallbackExposeGlobal(name, value, scope, options) {\n  if (!scope || typeof scope !== 'object') {\n    return false;\n  }\n\n  var descriptor = {\n    configurable: !options || options.configurable !== false,\n    enumerable: !!(options && options.enumerable),\n    value: value,\n    writable: !!(options && options.writable === true),\n  };\n\n  try {\n    Object.defineProperty(scope, name, descriptor);\n    return true;\n  } catch (error) {\n    void error;\n    try {\n      scope[name] = value;\n      return true;\n    } catch (assignmentError) {\n      void assignmentError;\n      return false;\n    }\n  }\n}\n\nfunction exposeGlobalInternal(name, value, scope, options) {\n  var targetScope = scope || GLOBAL_SCOPE;\n\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.exposeGlobalScoped === 'function') {\n    try {\n      var bridged = ENV_BRIDGE.exposeGlobalScoped(name, value, targetScope, options || {});\n      if (typeof bridged !== 'undefined') {\n        return bridged;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.exposeGlobal === 'function') {\n    try {\n      return ENV_BRIDGE.exposeGlobal(name, value, options || {});\n    } catch (bridgeError) {\n      void bridgeError;\n    }\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.exposeGlobal === 'function') {\n    try {\n      return MODULE_ENV.exposeGlobal(name, value, targetScope, options || {});\n    } catch (envError) {\n      void envError;\n    }\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.exposeGlobal === 'function') {\n    try {\n      return MODULE_BASE.exposeGlobal(name, value, targetScope, options || {});\n    } catch (baseError) {\n      void baseError;\n    }\n  }\n\n  return fallbackExposeGlobal(name, value, targetScope, options);\n}\n\nvar tryRequire = (function resolveTryRequire() {\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.tryRequire === 'function') {\n    return function bridgeTryRequire(modulePath) {\n      var result = ENV_BRIDGE.tryRequire(modulePath);\n      return typeof result === 'undefined' ? tryRequireLocal(modulePath) : result;\n    };\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.tryRequire === 'function') {\n    return MODULE_ENV.tryRequire;\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.tryRequire === 'function') {\n    return MODULE_BASE.tryRequire;\n  }\n\n  return tryRequireLocal;\n})();\n\nfunction resolveModuleRegistry(scope) {\n  var targetScope = scope || GLOBAL_SCOPE;\n\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.getModuleRegistry === 'function') {\n    try {\n      var bridged = ENV_BRIDGE.getModuleRegistry(targetScope);\n      if (bridged) {\n        return bridged;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.getModuleRegistry === 'function') {\n    try {\n      var envRegistry = MODULE_ENV.getModuleRegistry(targetScope);\n      if (envRegistry) {\n        return envRegistry;\n      }\n    } catch (envError) {\n      void envError;\n    }\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.getModuleRegistry === 'function') {\n    try {\n      var baseRegistry = MODULE_BASE.getModuleRegistry(targetScope);\n      if (baseRegistry) {\n        return baseRegistry;\n      }\n    } catch (baseError) {\n      void baseError;\n    }\n  }\n\n  if (cineModules && typeof cineModules === 'object') {\n    return cineModules;\n  }\n\n  var scopes = collectCandidateScopes(targetScope);\n  for (var index = 0; index < scopes.length; index += 1) {\n    var candidate = scopes[index];\n    if (candidate && typeof candidate.cineModules === 'object') {\n      return candidate.cineModules;\n    }\n  }\n\n  return null;\n}\n\nvar cachedRegistry = null;\nvar hasCachedRegistry = false;\n\nfunction getModuleRegistry(scope) {\n  if (scope && scope !== GLOBAL_SCOPE) {\n    return resolveModuleRegistry(scope);\n  }\n\n  if (!hasCachedRegistry) {\n    cachedRegistry = resolveModuleRegistry(GLOBAL_SCOPE);\n    hasCachedRegistry = true;\n  }\n\n  return cachedRegistry;\n}\n\nfunction shallowCopyOptions(options) {\n  if (!options || typeof options !== 'object') {\n    return {};\n  }\n\n  var copy = {};\n  var keys = [];\n\n  try {\n    keys = Object.keys(options);\n  } catch (error) {\n    void error;\n    keys = [];\n  }\n\n  for (var index = 0; index < keys.length; index += 1) {\n    var key = keys[index];\n    try {\n      copy[key] = options[key];\n    } catch (readError) {\n      void readError;\n    }\n  }\n\n  return copy;\n}\n\nfunction queueModuleRegistration(name, api, options, scope) {\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.queueModuleRegistration === 'function') {\n    try {\n      var bridged = ENV_BRIDGE.queueModuleRegistration(name, api, options);\n      if (typeof bridged !== 'undefined') {\n        return bridged;\n      }\n    } catch (bridgeError) {\n      void bridgeError;\n    }\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.queueModuleRegistration === 'function') {\n    try {\n      return MODULE_ENV.queueModuleRegistration(name, api, options, scope || GLOBAL_SCOPE);\n    } catch (envError) {\n      void envError;\n    }\n  }\n\n  if (MODULE_BASE && typeof MODULE_BASE.queueModuleRegistration === 'function') {\n    try {\n      return MODULE_BASE.queueModuleRegistration(name, api, options, scope || GLOBAL_SCOPE);\n    } catch (baseError) {\n      void baseError;\n    }\n  }\n\n  var queue = ensureQueue(scope || GLOBAL_SCOPE);\n  if (!queue) {\n    return false;\n  }\n\n  var payload = Object.freeze({\n    name: name,\n    api: api,\n    options: Object.freeze(shallowCopyOptions(options)),\n  });\n\n  try {\n    queue.push(payload);\n  } catch (error) {\n    void error;\n    queue[queue.length] = payload;\n  }\n\n  return true;\n}\n\nfunction registerOrQueueModule(name, api, options, onError, scope, registry) {\n  var targetScope = scope || GLOBAL_SCOPE;\n  var effectiveRegistry = registry || getModuleRegistry(targetScope);\n\n  if (MODULE_BASE && typeof MODULE_BASE.registerOrQueueModule === 'function') {\n    try {\n      var baseRegistered = MODULE_BASE.registerOrQueueModule(name, api, options, onError, targetScope, effectiveRegistry);\n      if (baseRegistered) {\n        recordModule(name, api);\n        return true;\n      }\n    } catch (baseError) {\n      void baseError;\n    }\n  }\n\n  if (ENV_BRIDGE && typeof ENV_BRIDGE.registerOrQueueModule === 'function') {\n    try {\n      var bridged = ENV_BRIDGE.registerOrQueueModule(name, api, options, onError, targetScope, effectiveRegistry);\n      if (bridged) {\n        recordModule(name, api);\n        return true;\n      }\n    } catch (bridgeError) {\n      void bridgeError;\n    }\n  }\n\n  if (MODULE_ENV && typeof MODULE_ENV.registerOrQueueModule === 'function') {\n    try {\n      var envRegistered = MODULE_ENV.registerOrQueueModule(name, api, options, onError, targetScope, effectiveRegistry);\n      if (envRegistered) {\n        recordModule(name, api);\n        return true;\n      }\n    } catch (envError) {\n      void envError;\n    }\n  }\n\n  if (effectiveRegistry && typeof effectiveRegistry.register === 'function') {\n    try {\n      effectiveRegistry.register(name, api, options || {});\n      recordModule(name, api);\n      return true;\n    } catch (registryError) {\n      if (typeof onError === 'function') {\n        try {\n          onError(registryError);\n        } catch (callbackError) {\n          void callbackError;\n        }\n      } else {\n        void registryError;\n      }\n    }\n  }\n\n  var queued = queueModuleRegistration(name, api, options, targetScope);\n  if (queued) {\n    recordModule(name, api);\n  }\n  return queued;\n}\n\nvar localModuleMap = Object.create(null);\nvar waitersMap = Object.create(null);\n\nfunction notifyWaiters(name, api) {\n  if (!waitersMap[name]) {\n    return;\n  }\n\n  var waiters = waitersMap[name].slice();\n  waitersMap[name].length = 0;\n\n  for (var index = 0; index < waiters.length; index += 1) {\n    var waiter = waiters[index];\n    try {\n      waiter(api);\n    } catch (error) {\n      void error;\n    }\n  }\n}\n\nfunction recordModule(name, api) {\n  if (typeof name !== 'string' || !name || !api) {\n    return false;\n  }\n\n  localModuleMap[name] = api;\n  notifyWaiters(name, api);\n  return true;\n}\n\nfunction getModule(name, options) {\n  if (typeof name !== 'string' || !name) {\n    return null;\n  }\n\n  if (Object.prototype.hasOwnProperty.call(localModuleMap, name)) {\n    return localModuleMap[name];\n  }\n\n  var targetScope = options && options.scope ? options.scope : GLOBAL_SCOPE;\n\n  try {\n    if (targetScope && typeof targetScope === 'object' && typeof targetScope[name] !== 'undefined') {\n      return targetScope[name];\n    }\n  } catch (error) {\n    void error;\n  }\n\n  var registry = getModuleRegistry(targetScope);\n  if (registry && typeof registry.get === 'function') {\n    try {\n      var resolved = registry.get(name);\n      if (resolved) {\n        return resolved;\n      }\n    } catch (registryError) {\n      void registryError;\n    }\n  }\n\n  return null;\n}\n\nfunction whenModuleAvailable(name, callback) {\n  if (typeof name !== 'string' || !name || typeof callback !== 'function') {\n    return false;\n  }\n\n  var existing = getModule(name);\n  if (existing) {\n    try {\n      callback(existing);\n    } catch (error) {\n      void error;\n    }\n    return true;\n  }\n\n  if (!waitersMap[name]) {\n    waitersMap[name] = [];\n  }\n  waitersMap[name].push(callback);\n  return true;\n}\n\nfunction listRecordedModules() {\n  return Object.freeze(Object.keys(localModuleMap));\n}\n\nfunction primeKnownModules() {\n  var descriptors = [\n    { name: 'cineModuleBase', value: MODULE_BASE },\n    { name: 'cineModuleEnvironment', value: MODULE_ENV },\n    { name: 'cineEnvironmentBridge', value: ENV_BRIDGE },\n    { name: 'cineModules', value: getModuleRegistry(GLOBAL_SCOPE) },\n  ];\n\n  for (var index = 0; index < descriptors.length; index += 1) {\n    var descriptor = descriptors[index];\n    if (descriptor.value) {\n      recordModule(descriptor.name, descriptor.value);\n    }\n  }\n}\n\nprimeKnownModules();\n\nvar globalApi = {\n  scope: GLOBAL_SCOPE,\n  moduleBase: MODULE_BASE,\n  moduleEnvironment: MODULE_ENV,\n  environmentBridge: ENV_BRIDGE,\n  getModuleRegistry: getModuleRegistry,\n  resolveModuleRegistry: resolveModuleRegistry,\n  queueModuleRegistration: queueModuleRegistration,\n  registerOrQueueModule: registerOrQueueModule,\n  freezeDeep: freezeDeep,\n  safeWarn: safeWarn,\n  exposeGlobal: function exposeGlobal(name, value, options) {\n    return exposeGlobalInternal(name, value, GLOBAL_SCOPE, options || {});\n  },\n  exposeGlobalScoped: function exposeGlobalScoped(name, value, scope, options) {\n    return exposeGlobalInternal(name, value, scope || GLOBAL_SCOPE, options || {});\n  },\n  tryRequire: tryRequire,\n  collectCandidateScopes: function collectCandidateScopesShared(scope) {\n    var scopes = collectCandidateScopes(scope || GLOBAL_SCOPE);\n    return Object.freeze(scopes.slice());\n  },\n  getPendingQueueKey: function getPendingQueueKey() {\n    return PENDING_QUEUE_KEY;\n  },\n  ensureQueue: function ensureQueueShared(scope) {\n    return ensureQueue(scope || GLOBAL_SCOPE);\n  },\n  recordModule: recordModule,\n  getModule: getModule,\n  whenModuleAvailable: whenModuleAvailable,\n  listRecordedModules: listRecordedModules,\n};\n\nvar existing = null;\nvar candidateScopes = collectCandidateScopes(GLOBAL_SCOPE);\nfor (var index = 0; index < candidateScopes.length; index += 1) {\n  var scope = candidateScopes[index];\n  if (scope && typeof scope.cineModuleGlobals === 'object') {\n    existing = scope.cineModuleGlobals;\n    break;\n  }\n}\n\nif (existing && existing !== globalApi) {\n  try {\n    var existingKeys = Object.getOwnPropertyNames(existing);\n    for (var mergeIndex = 0; mergeIndex < existingKeys.length; mergeIndex += 1) {\n      var key = existingKeys[mergeIndex];\n      if (typeof globalApi[key] === 'undefined') {\n        globalApi[key] = existing[key];\n      }\n    }\n  } catch (mergeError) {\n    void mergeError;\n  }\n\n  if (typeof existing.listRecordedModules === 'function') {\n    try {\n      var names = existing.listRecordedModules();\n      if (Array.isArray(names)) {\n        for (var nameIndex = 0; nameIndex < names.length; nameIndex += 1) {\n          var moduleName = names[nameIndex];\n          if (!localModuleMap[moduleName] && typeof existing.getModule === 'function') {\n            var moduleValue = existing.getModule(moduleName);\n            if (moduleValue) {\n              recordModule(moduleName, moduleValue);\n            }\n          }\n        }\n      }\n    } catch (syncError) {\n      void syncError;\n    }\n  }\n}\n\nvar frozenApi = freezeDeep(globalApi);\nrecordModule('cineModuleGlobals', frozenApi);\n\nvar registered = registerOrQueueModule(\n  'cineModuleGlobals',\n  frozenApi,\n  {\n    category: 'infrastructure',\n    description: 'Shared module globals for cross-script coordination.',\n    replace: true,\n    connections: ['cineModuleBase', 'cineModuleEnvironment', 'cineEnvironmentBridge'],\n  },\n  function (error) {\n    safeWarn('Unable to register cineModuleGlobals module.', error);\n  },\n  GLOBAL_SCOPE,\n  getModuleRegistry(GLOBAL_SCOPE)\n);\n\nif (!registered) {\n  queueModuleRegistration(\n    'cineModuleGlobals',\n    frozenApi,\n    {\n      category: 'infrastructure',\n      description: 'Shared module globals for cross-script coordination.',\n      replace: true,\n      connections: ['cineModuleBase', 'cineModuleEnvironment', 'cineEnvironmentBridge'],\n    },\n    GLOBAL_SCOPE\n  );\n}\n\nvar exposed = exposeGlobalInternal('cineModuleGlobals', frozenApi, GLOBAL_SCOPE, {\n  configurable: true,\n  enumerable: false,\n  writable: false,\n});\n\nif (!exposed) {\n  safeWarn('Unable to expose cineModuleGlobals globally.');\n}\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = frozenApi;\n// }\n// })();\n\nexport const cineModuleGlobals = frozenApi;\n","import cineModuleBase from './base.js';\nimport cineModules from './registry.js';\n\n// (function () {\nconst DEFAULT_PENDING_QUEUE_KEY = '__cinePendingModuleRegistrations__';\n\nfunction fallbackDetectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\nfunction fallbackCollectCandidateScopes(primary, baseScope) {\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary || baseScope);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\nfunction fallbackTryRequire(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\nfunction fallbackDefineHiddenProperty(target, name, value) {\n  if (!target || (typeof target !== 'object' && typeof target !== 'function')) {\n    return false;\n  }\n\n  try {\n    Object.defineProperty(target, name, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value,\n    });\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    target[name] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction fallbackEnsureQueue(scope, key, baseScope) {\n  const targetScope = scope || baseScope;\n  const queueKey = typeof key === 'string' && key ? key : DEFAULT_PENDING_QUEUE_KEY;\n\n  if (!targetScope || typeof targetScope !== 'object') {\n    return null;\n  }\n\n  let queue = targetScope[queueKey];\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  if (!fallbackDefineHiddenProperty(targetScope, queueKey, [])) {\n    return null;\n  }\n\n  queue = targetScope[queueKey];\n  if (!Array.isArray(queue)) {\n    return null;\n  }\n\n  return queue;\n}\n\n\n\nfunction isNodeProcessReference(value) {\n  if (!value) {\n    return false;\n  }\n\n  if (typeof process === 'undefined' || !process) {\n    return false;\n  }\n\n  if (value === process) {\n    return true;\n  }\n\n  if (typeof value === 'object') {\n    try {\n      if (value.constructor && value.constructor.name === 'process') {\n        return true;\n      }\n    } catch (processInspectionError) {\n      void processInspectionError;\n    }\n\n    if (\n      typeof value.pid === 'number' &&\n      typeof value.nextTick === 'function' &&\n      typeof value.emit === 'function' &&\n      typeof value.binding === 'function'\n    ) {\n      return true;\n    }\n  }\n\n  if (typeof value === 'function') {\n    if (\n      value === process.binding ||\n      value === process._linkedBinding ||\n      value === process.dlopen\n    ) {\n      return true;\n    }\n\n    try {\n      const functionName = value.name || '';\n      if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n        const source = Function.prototype.toString.call(value);\n        if (source && source.indexOf('[native code]') !== -1) {\n          return true;\n        }\n      }\n    } catch (functionInspectionError) {\n      void functionInspectionError;\n    }\n  }\n\n  return false;\n}\n\nfunction shouldBypassDeepFreeze(value) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return false;\n  }\n\n  if (isNodeProcessReference(value)) {\n    return true;\n  }\n\n  if (\n    typeof process !== 'undefined' &&\n    process &&\n    process.release &&\n    process.release.name === 'node'\n  ) {\n    return true;\n  }\n\n\n  try {\n    if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n      return true;\n    }\n\n    if (typeof value.on === 'function' && typeof value.emit === 'function') {\n      if (typeof value.write === 'function' || typeof value.read === 'function') {\n        return true;\n      }\n\n      const ctorName = value.constructor && value.constructor.name;\n      if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n        return true;\n      }\n    }\n\n    if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n      const tag = value[Symbol.toStringTag];\n      if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n        return true;\n      }\n    }\n  } catch (inspectionError) {\n    void inspectionError;\n  }\n\n  return false;\n}\n\nfunction fallbackResolveSeenTracker(seen) {\n  if (seen && typeof seen.has === 'function' && typeof seen.add === 'function') {\n    return seen;\n  }\n\n  if (Array.isArray(seen)) {\n    return {\n      has(value) {\n        return seen.indexOf(value) !== -1;\n      },\n      add(value) {\n        if (seen.indexOf(value) === -1) {\n          seen.push(value);\n        }\n      },\n    };\n  }\n\n  if (typeof WeakSet === 'function') {\n    try {\n      return new WeakSet();\n    } catch (trackerError) {\n      void trackerError;\n    }\n  }\n\n  const tracked = [];\n  return {\n    has(value) {\n      return tracked.indexOf(value) !== -1;\n    },\n    add(value) {\n      if (tracked.indexOf(value) === -1) {\n        tracked.push(value);\n      }\n    },\n  };\n}\n\nfunction fallbackFreezeDeep(value, seen) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  if (shouldBypassDeepFreeze(value)) {\n    return value;\n  }\n\n  if (typeof process !== 'undefined' && process && process.env && process.env.JEST_WORKER_ID) {\n    try {\n      if (typeof Object.freeze === 'function') {\n        Object.freeze(value);\n      }\n    } catch (freezeError) {\n      void freezeError;\n    }\n    return value;\n  }\n\n  const tracker = fallbackResolveSeenTracker(seen);\n\n  if (tracker.has(value)) {\n    return value;\n  }\n\n  tracker.add(value);\n\n  const keys = Object.getOwnPropertyNames(value);\n  for (let index = 0; index < keys.length; index += 1) {\n    const key = keys[index];\n    let child;\n    try {\n      child = value[key];\n    } catch (accessError) {\n      void accessError;\n      child = undefined;\n    }\n    if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n      continue;\n    }\n    fallbackFreezeDeep(child, tracker);\n  }\n\n  try {\n    return Object.freeze(value);\n  } catch (freezeError) {\n    void freezeError;\n    return value;\n  }\n}\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction fallbackResolveFromScopes(propertyName, options, baseScope) {\n  const settings = options || {};\n  const predicate = typeof settings.predicate === 'function' ? settings.predicate : null;\n  const scopes = Array.isArray(settings.scopes)\n    ? settings.scopes.slice()\n    : fallbackCollectCandidateScopes(settings.primaryScope || baseScope, baseScope);\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    if (predicate) {\n      try {\n        if (predicate(scope, propertyName)) {\n          return scope;\n        }\n      } catch (error) {\n        void error;\n      }\n      continue;\n    }\n\n    const candidate = scope[propertyName];\n    if (typeof candidate !== 'undefined') {\n      return candidate;\n    }\n  }\n\n  return null;\n}\n\nfunction fallbackQueueModuleRegistration(scope, name, api, options, baseScope, queueKey) {\n  const targetScope = scope || baseScope;\n  const queue = fallbackEnsureQueue(targetScope, queueKey || DEFAULT_PENDING_QUEUE_KEY, baseScope);\n  if (!queue) {\n    return false;\n  }\n\n  const payload = Object.freeze({\n    name,\n    api,\n    options: Object.freeze({ ...(options || {}) }),\n  });\n\n  try {\n    queue.push(payload);\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    queue[queue.length] = payload;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction createFallbackKernel(primaryScope) {\n  const baseScope = primaryScope || fallbackDetectGlobalScope();\n\n  return {\n    detectGlobalScope: fallbackDetectGlobalScope,\n    getGlobalScope() {\n      return baseScope;\n    },\n    collectCandidateScopes(primary) {\n      return fallbackCollectCandidateScopes(primary || baseScope, baseScope);\n    },\n    tryRequire: fallbackTryRequire,\n    defineHiddenProperty: fallbackDefineHiddenProperty,\n    ensureQueue(scope, key) {\n      return fallbackEnsureQueue(scope || baseScope, key, baseScope);\n    },\n    freezeDeep: fallbackFreezeDeep,\n    safeWarn: fallbackSafeWarn,\n    resolveFromScopes(propertyName, options) {\n      return fallbackResolveFromScopes(propertyName, options, baseScope);\n    },\n    queueModuleRegistration(scope, name, api, options) {\n      return fallbackQueueModuleRegistration(scope || baseScope, name, api, options, baseScope, DEFAULT_PENDING_QUEUE_KEY);\n    },\n    getPendingQueueKey() {\n      return DEFAULT_PENDING_QUEUE_KEY;\n    },\n    resolveModuleRegistry(scope) {\n      const targetScope = scope || baseScope;\n      const required = fallbackTryRequire('./registry.js');\n      if (required && typeof required === 'object') {\n        return required;\n      }\n      const scopes = fallbackCollectCandidateScopes(targetScope, baseScope);\n      for (let index = 0; index < scopes.length; index += 1) {\n        const candidate = scopes[index];\n        if (candidate && typeof candidate.cineModules === 'object') {\n          return candidate.cineModules;\n        }\n      }\n      return null;\n    },\n  };\n}\n\nfunction resolveArchitectureKernel(scope) {\n  const targetScope = scope || fallbackDetectGlobalScope();\n\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  if (targetScope && typeof targetScope.cineModuleArchitectureKernel === 'object') {\n    return targetScope.cineModuleArchitectureKernel;\n  }\n\n  return null;\n}\n\nconst LOCAL_SCOPE = fallbackDetectGlobalScope();\nconst RESOLVED_KERNEL = resolveArchitectureKernel(LOCAL_SCOPE);\nconst ACTIVE_KERNEL = RESOLVED_KERNEL || createFallbackKernel(LOCAL_SCOPE);\n\n/**\n * DEEP DIVE: Global Scope Detection\n *\n * Robustly identifies the global context. This is harder than it looks because:\n * - 'window' is undefined in Web Workers and Node.\n * - 'self' is the standard in Workers but can be ambiguous.\n * - 'global' is Node-specific.\n * - 'globalThis' is the modern standard but needs a polyfill/check in older envs.\n *\n * The kernel tries `ACTIVE_KERNEL.detectGlobalScope()` first (delegation),\n * and falls back to a manual prioritized check (`fallbackDetectGlobalScope`).\n */\nfunction detectGlobalScope() {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.detectGlobalScope === 'function') {\n    try {\n      const detected = ACTIVE_KERNEL.detectGlobalScope();\n      if (detected) {\n        return detected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackDetectGlobalScope();\n}\n\n/**\n * DEEP DIVE: The \"Kernel\" Pattern\n *\n * This module implements a micro-kernel architecture for capability detection.\n *\n * Conceptual Model:\n * 1. ACTIVE_KERNEL: An abstraction layer that normalizes environment-specific behavior\n *    (e.g., Node.js vs Browser vs Web Worker).\n * 2. FALLBACK KERNEL: If no specialized kernel is found (e.g. `architecture-kernel.js` is missing),\n *    we generate a \"Fallback Kernel\" on the fly using basic JavaScript primitives.\n *\n * This guarantees that `system.js` (and thus the whole app) can boot in extremely\n * constrained environments where external dependencies might fail to load.\n */\nconst PRIMARY_SCOPE =\n  ACTIVE_KERNEL && typeof ACTIVE_KERNEL.getGlobalScope === 'function'\n    ? (function resolvePrimaryScope() {\n      try {\n        const scoped = ACTIVE_KERNEL.getGlobalScope();\n        if (scoped) {\n          return scoped;\n        }\n      } catch (error) {\n        void error;\n      }\n      return detectGlobalScope();\n    })()\n    : detectGlobalScope();\n\nlet pendingQueueKey =\n  ACTIVE_KERNEL && typeof ACTIVE_KERNEL.getPendingQueueKey === 'function'\n    ? ACTIVE_KERNEL.getPendingQueueKey()\n    : DEFAULT_PENDING_QUEUE_KEY;\n\nfunction collectCandidateScopes(primary) {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.collectCandidateScopes === 'function') {\n    try {\n      const collected = ACTIVE_KERNEL.collectCandidateScopes(primary || PRIMARY_SCOPE);\n      if (Array.isArray(collected) && collected.length > 0) {\n        return collected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackCollectCandidateScopes(primary || PRIMARY_SCOPE, PRIMARY_SCOPE);\n}\n\nfunction collectScopes(primary) {\n  const scopes = collectCandidateScopes(primary || PRIMARY_SCOPE);\n  return Array.isArray(scopes) ? scopes : [];\n}\n\nfunction tryRequire(modulePath) {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.tryRequire === 'function') {\n    try {\n      const result = ACTIVE_KERNEL.tryRequire(modulePath);\n      if (typeof result !== 'undefined') {\n        return result;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackTryRequire(modulePath);\n}\n\nfunction defineHiddenProperty(target, name, value) {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.defineHiddenProperty === 'function') {\n    try {\n      if (ACTIVE_KERNEL.defineHiddenProperty(target, name, value)) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackDefineHiddenProperty(target, name, value);\n}\n\nfunction freezeDeep(value) {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.freezeDeep === 'function') {\n    try {\n      return ACTIVE_KERNEL.freezeDeep(value);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackFreezeDeep(value);\n}\n\nfunction safeWarn(message, detail) {\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.safeWarn === 'function') {\n    try {\n      ACTIVE_KERNEL.safeWarn(message, detail);\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  fallbackSafeWarn(message, detail);\n}\n\nfunction resolveFromScopes(propertyName, options) {\n  const settings = options ? { ...options } : {};\n  if (!settings.primaryScope) {\n    settings.primaryScope = PRIMARY_SCOPE;\n  }\n  if (!settings.scopes) {\n    settings.scopes = collectScopes(settings.primaryScope);\n  }\n\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.resolveFromScopes === 'function') {\n    try {\n      const resolved = ACTIVE_KERNEL.resolveFromScopes(propertyName, settings);\n      if (resolved) {\n        return resolved;\n      }\n    } catch (error) {\n      safeWarn(`cineModuleSystem: resolveFromScopes failed for \"${propertyName}\".`, error);\n    }\n  }\n\n  return fallbackResolveFromScopes(propertyName, settings, PRIMARY_SCOPE);\n}\n\nlet cachedModuleBase = null;\nlet hasResolvedModuleBase = false;\n\nfunction updateQueueKeyFromBase(base) {\n  if (base && typeof base.PENDING_QUEUE_KEY === 'string' && base.PENDING_QUEUE_KEY) {\n    pendingQueueKey = base.PENDING_QUEUE_KEY;\n  }\n}\n\nfunction loadModuleBase(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (cineModuleBase && typeof cineModuleBase === 'object') {\n    updateQueueKeyFromBase(cineModuleBase);\n    return cineModuleBase;\n  }\n\n  const resolved = resolveFromScopes('cineModuleBase', {\n    primaryScope: targetScope,\n    scopes: collectScopes(targetScope),\n  });\n\n  if (resolved && typeof resolved === 'object') {\n    updateQueueKeyFromBase(resolved);\n    return resolved;\n  }\n\n  return null;\n}\n\nfunction getModuleBase(scope) {\n  if (scope && scope !== PRIMARY_SCOPE) {\n    return loadModuleBase(scope);\n  }\n\n  if (!hasResolvedModuleBase) {\n    cachedModuleBase = loadModuleBase(PRIMARY_SCOPE);\n    hasResolvedModuleBase = true;\n  }\n\n  return cachedModuleBase;\n}\n\nfunction fallbackResolveModuleRegistry(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (cineModules && typeof cineModules === 'object') {\n    return cineModules;\n  }\n\n  const resolved = resolveFromScopes('cineModules', {\n    primaryScope: targetScope,\n    scopes: collectScopes(targetScope),\n  });\n\n  if (resolved && typeof resolved === 'object') {\n    return resolved;\n  }\n\n  return null;\n}\n\nlet cachedModuleRegistry = null;\nlet hasResolvedModuleRegistry = false;\n\nfunction resolveModuleRegistry(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.resolveModuleRegistry === 'function') {\n    try {\n      const resolvedByKernel = ACTIVE_KERNEL.resolveModuleRegistry(targetScope);\n      if (resolvedByKernel && typeof resolvedByKernel === 'object') {\n        return resolvedByKernel;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: Kernel resolveModuleRegistry failed.', error);\n    }\n  }\n\n  const base = getModuleBase(targetScope);\n  if (base && typeof base.resolveModuleRegistry === 'function') {\n    try {\n      const resolved = base.resolveModuleRegistry(targetScope);\n      if (resolved && typeof resolved === 'object') {\n        return resolved;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: Base resolveModuleRegistry failed.', error);\n    }\n  }\n\n  return fallbackResolveModuleRegistry(targetScope);\n}\n\nfunction getModuleRegistry(scope) {\n  if (scope && scope !== PRIMARY_SCOPE) {\n    return resolveModuleRegistry(scope);\n  }\n\n  if (!hasResolvedModuleRegistry) {\n    cachedModuleRegistry = resolveModuleRegistry(PRIMARY_SCOPE);\n    hasResolvedModuleRegistry = true;\n  }\n\n  return cachedModuleRegistry;\n}\n\nfunction fallbackExposeGlobal(name, value, scope, options = {}) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  if (!targetScope || typeof targetScope !== 'object') {\n    return false;\n  }\n\n  const descriptor = {\n    configurable: options.configurable !== false,\n    enumerable: !!options.enumerable,\n    value,\n    writable: options.writable === true,\n  };\n\n  try {\n    Object.defineProperty(targetScope, name, descriptor);\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    targetScope[name] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction exposeGlobal(name, value, scope, options) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  const base = getModuleBase(targetScope);\n\n  if (base && typeof base.exposeGlobal === 'function') {\n    try {\n      return base.exposeGlobal(name, value, targetScope, options || {});\n    } catch (error) {\n      safeWarn(`cineModuleSystem: Failed to expose \"${name}\" through module base.`, error);\n    }\n  }\n\n  return fallbackExposeGlobal(name, value, targetScope, options || {});\n}\n\nfunction ensureRegistrationQueue(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.ensureQueue === 'function') {\n    try {\n      const queue = ACTIVE_KERNEL.ensureQueue(targetScope, pendingQueueKey);\n      if (Array.isArray(queue)) {\n        return queue;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: ensureQueue failed via kernel.', error);\n    }\n  }\n\n  return fallbackEnsureQueue(targetScope, pendingQueueKey, PRIMARY_SCOPE);\n}\n\nfunction normalizeName(name) {\n  if (typeof name === 'string' && name.trim()) {\n    return name.trim();\n  }\n  if (typeof name === 'number' && Number.isFinite(name)) {\n    return String(name);\n  }\n  throw new TypeError('cineModuleSystem expected module name to be a non-empty string.');\n}\n\nfunction queueModuleRegistration(name, api, options, scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ACTIVE_KERNEL && typeof ACTIVE_KERNEL.queueModuleRegistration === 'function') {\n    try {\n      if (ACTIVE_KERNEL.queueModuleRegistration(targetScope, name, api, options)) {\n        return true;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: queueModuleRegistration failed via kernel.', error);\n    }\n  }\n\n  const queue = ensureRegistrationQueue(targetScope);\n  if (!queue) {\n    safeWarn('cineModuleSystem: Unable to queue module registration.', { name });\n    return false;\n  }\n\n  let normalizedName;\n  try {\n    normalizedName = normalizeName(name);\n  } catch (error) {\n    safeWarn('cineModuleSystem: Ignoring registration with invalid name.', error);\n    return false;\n  }\n\n  const payload = Object.freeze({\n    name: normalizedName,\n    api,\n    options: Object.freeze({ ...(options || {}) }),\n  });\n\n  try {\n    queue.push(payload);\n  } catch (error) {\n    void error;\n    try {\n      queue[queue.length] = payload;\n    } catch (assignmentError) {\n      safeWarn('cineModuleSystem: Failed to record pending module registration.', assignmentError);\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction registerModule(name, api, options, scope, onError) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  const registry = getModuleRegistry(targetScope);\n\n  if (registry && typeof registry.register === 'function') {\n    try {\n      registry.register(name, api, options || {});\n      return true;\n    } catch (error) {\n      if (typeof onError === 'function') {\n        try {\n          onError(error);\n        } catch (handlerError) {\n          safeWarn('cineModuleSystem: Error handler threw while processing registration failure.', handlerError);\n        }\n      } else {\n        safeWarn(`cineModuleSystem: Unable to register module \"${name}\".`, error);\n      }\n    }\n  }\n\n  queueModuleRegistration(name, api, options, targetScope);\n  return false;\n}\n\nfunction getGlobalScope(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  const base = getModuleBase(targetScope);\n\n  if (base && typeof base.getGlobalScope === 'function') {\n    try {\n      const resolved = base.getGlobalScope();\n      if (resolved) {\n        return resolved;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: Unable to obtain global scope from module base.', error);\n    }\n  }\n\n  return targetScope;\n}\n\nfunction resolveModule(name, options = {}) {\n  const normalizedName = normalizeName(name);\n  const targetScope = options.scope || PRIMARY_SCOPE;\n  const registry = getModuleRegistry(targetScope);\n\n  if (registry && typeof registry.get === 'function') {\n    try {\n      const registered = registry.get(normalizedName);\n      if (registered) {\n        return registered;\n      }\n    } catch (error) {\n      safeWarn('cineModuleSystem: Registry lookup failed.', error);\n    }\n  }\n\n  const propertyName = options.propertyName || normalizedName;\n  const scopes = Array.isArray(options.scopes) && options.scopes.length > 0 ? options.scopes : collectScopes(targetScope);\n\n  const resolved = resolveFromScopes(propertyName, {\n    primaryScope: targetScope,\n    scopes,\n    predicate: options.predicate,\n  });\n\n  if (resolved) {\n    return resolved;\n  }\n\n  if (typeof options.fallback === 'function') {\n    try {\n      return options.fallback();\n    } catch (error) {\n      safeWarn('cineModuleSystem: Fallback resolver threw while resolving module.', error);\n    }\n  }\n\n  return null;\n}\n\nfunction registerAndExpose(name, api, registrationOptions, scope, exposeOptions) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  const registered = registerModule(name, api, registrationOptions, targetScope);\n  if (!registered) {\n    return false;\n  }\n\n  return exposeGlobal(name, api, targetScope, exposeOptions || {});\n}\n\nfunction getPendingQueue(scope) {\n  return ensureRegistrationQueue(scope || PRIMARY_SCOPE);\n}\n\nconst systemApi = {\n  getArchitecture() {\n    return (ACTIVE_KERNEL && ACTIVE_KERNEL.architecture) || null;\n  },\n  detectGlobalScope,\n  getGlobalScope,\n  collectCandidateScopes: collectScopes,\n  tryRequire,\n  resolveFromScopes,\n  getModuleBase,\n  getModuleRegistry,\n  queueModuleRegistration,\n  registerModule,\n  registerAndExpose,\n  resolveModule,\n  exposeGlobal,\n  defineHiddenProperty,\n  freezeDeep,\n  safeWarn,\n  getPendingQueue,\n  getPendingQueueKey() {\n    return pendingQueueKey;\n  },\n};\n\nObject.defineProperty(systemApi, 'PENDING_QUEUE_KEY', {\n  configurable: false,\n  enumerable: true,\n  get() {\n    return pendingQueueKey;\n  },\n});\n\nconst frozenApi = Object.freeze(systemApi);\n\nif (PRIMARY_SCOPE && typeof PRIMARY_SCOPE === 'object' && !PRIMARY_SCOPE.cineModuleSystem) {\n  defineHiddenProperty(PRIMARY_SCOPE, 'cineModuleSystem', frozenApi);\n}\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = frozenApi;\n// }\n// })();\n\nexport const cineModuleSystem = frozenApi;\n\n","/*\n * context.js\n * ----------\n * Exposes utilities that coordinate shared runtime context across the\n * planner. Many of these helpers provide \"fallback\" implementations so that the\n * application keeps functioning flawlessly even when specific browser features\n * are unavailable or when code executes from a cached offline bundle. The\n * additional comments explain the intent behind each defensive branch to make\n * auditing easier for anyone safeguarding user data flows.\n */\n\nimport cineModuleBase from './base.js';\nimport cineModules from './registry.js';\nimport { cineModuleSystem } from './system.js';\n\n// (function () {\nconst DEFAULT_PENDING_QUEUE_KEY = '__cinePendingModuleRegistrations__';\n\nfunction fallbackDetectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\n// Build an ordered list of potential scopes to inspect. The primary scope is\n// evaluated first so the active window remains preferred over shared worker\n// contexts where session storage might behave differently.\nfunction fallbackCollectCandidateScopes(primary) {\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\n// Lightweight require wrapper that mirrors the behaviour of try/catch blocks\n// used throughout the runtime. Returning null rather than throwing keeps the\n// bootstrap sequence deterministic.\nfunction fallbackTryRequire(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\n// Define a property without exposing it during iteration. If defineProperty\n// is unavailable we gracefully assign the property to keep the runtime alive\n// on legacy browsers.\nfunction fallbackDefineHiddenProperty(target, name, value) {\n  if (!target || (typeof target !== 'object' && typeof target !== 'function')) {\n    return false;\n  }\n\n  try {\n    Object.defineProperty(target, name, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value,\n    });\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    target[name] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction fallbackResolveSeenTracker(seen) {\n  if (seen && typeof seen.has === 'function' && typeof seen.add === 'function') {\n    return seen;\n  }\n\n  if (Array.isArray(seen)) {\n    return {\n      has(value) {\n        return seen.indexOf(value) !== -1;\n      },\n      add(value) {\n        if (seen.indexOf(value) === -1) {\n          seen.push(value);\n        }\n      },\n    };\n  }\n\n  if (typeof WeakSet === 'function') {\n    try {\n      return new WeakSet();\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const tracked = [];\n  return {\n    has(value) {\n      return tracked.indexOf(value) !== -1;\n    },\n    add(value) {\n      if (tracked.indexOf(value) === -1) {\n        tracked.push(value);\n      }\n    },\n  };\n}\n\n// Deeply freeze complex objects while tolerating environments that lack\n// Object.freeze. When WeakSet support is missing we gracefully fall back to a\n// list-based tracker so cyclical references still short-circuit.\nfunction fallbackFreezeDeep(value, seen) {\n  if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n    return value;\n  }\n\n  const tracker = fallbackResolveSeenTracker(seen);\n\n  if (tracker.has(value)) {\n    return value;\n  }\n\n  tracker.add(value);\n\n  let keys = [];\n  try {\n    keys = Object.getOwnPropertyNames(value);\n  } catch (error) {\n    void error;\n  }\n\n  for (let index = 0; index < keys.length; index += 1) {\n    const key = keys[index];\n    let child;\n    try {\n      child = value[key];\n    } catch (accessError) {\n      void accessError;\n      child = undefined;\n    }\n\n    if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n      continue;\n    }\n\n    fallbackFreezeDeep(child, tracker);\n  }\n\n  try {\n    try {\n      return Object.freeze(value);\n    } catch (freezeError) {\n      void freezeError;\n      return value;\n    }\n  } catch (freezeError) {\n    void freezeError;\n    return value;\n  }\n}\n\n// Provide a safe logging helper that never throws when console access is\n// restricted (which occasionally happens inside headless test runners).\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\n// Locate a property from any of the candidate scopes. The predicate allows\n// callers to define custom matching logic without exposing implementation\n// details to each lookup site.\nfunction fallbackResolveFromScopes(propertyName, options) {\n  const settings = options || {};\n  const predicate = typeof settings.predicate === 'function' ? settings.predicate : null;\n  const scopes = Array.isArray(settings.scopes)\n    ? settings.scopes.slice()\n    : fallbackCollectCandidateScopes(settings.primaryScope);\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    if (predicate) {\n      try {\n        if (predicate(scope, propertyName)) {\n          return scope;\n        }\n      } catch (error) {\n        void error;\n      }\n      continue;\n    }\n\n    const candidate = scope[propertyName];\n    if (typeof candidate !== 'undefined') {\n      return candidate;\n    }\n  }\n\n  return null;\n}\n\nfunction fallbackEnsureQueue(scope, queueKey) {\n  if (!scope || typeof scope !== 'object') {\n    return null;\n  }\n\n  let queue = null;\n  try {\n    queue = scope[queueKey];\n  } catch (error) {\n    void error;\n    queue = null;\n  }\n\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  try {\n    Object.defineProperty(scope, queueKey, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: [],\n    });\n    queue = scope[queueKey];\n    if (Array.isArray(queue)) {\n      return queue;\n    }\n  } catch (defineError) {\n    void defineError;\n  }\n\n  try {\n    scope[queueKey] = [];\n    queue = scope[queueKey];\n  } catch (assignmentError) {\n    void assignmentError;\n    return null;\n  }\n\n  return Array.isArray(queue) ? queue : null;\n}\n\nconst LOCAL_SCOPE = fallbackDetectGlobalScope();\n\nfunction resolveArchitecture(scope) {\n  const targetScope = scope || LOCAL_SCOPE;\n\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  if (targetScope && typeof targetScope.cineModuleArchitecture === 'object') {\n    return targetScope.cineModuleArchitecture;\n  }\n\n  return null;\n}\n\nfunction resolveArchitectureHelpers(scope) {\n  const targetScope = scope || LOCAL_SCOPE;\n\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  if (targetScope && typeof targetScope.cineModuleArchitectureHelpers === 'object') {\n    return targetScope.cineModuleArchitectureHelpers;\n  }\n\n  return null;\n}\n\nfunction resolveModuleSystem(scope) {\n  const targetScope = scope || LOCAL_SCOPE;\n\n  if (cineModuleSystem && typeof cineModuleSystem === 'object') {\n    return cineModuleSystem;\n  }\n\n  if (targetScope && typeof targetScope.cineModuleSystem === 'object') {\n    return targetScope.cineModuleSystem;\n  }\n\n  return null;\n}\n\nconst ARCHITECTURE_HELPERS = resolveArchitectureHelpers(LOCAL_SCOPE);\n\nlet pendingQueueKey =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.pendingQueueKey === 'string'\n    ? ARCHITECTURE_HELPERS.pendingQueueKey\n    : DEFAULT_PENDING_QUEUE_KEY;\n\nfunction updatePendingQueueKey(source) {\n  if (!source || (typeof source !== 'object' && typeof source !== 'function')) {\n    return;\n  }\n\n  try {\n    if (typeof source.getPendingQueueKey === 'function') {\n      const provided = source.getPendingQueueKey();\n      if (typeof provided === 'string' && provided) {\n        pendingQueueKey = provided;\n        return;\n      }\n    }\n  } catch (error) {\n    void error;\n  }\n\n  if (typeof source.PENDING_QUEUE_KEY === 'string' && source.PENDING_QUEUE_KEY) {\n    pendingQueueKey = source.PENDING_QUEUE_KEY;\n  }\n}\n\nconst MODULE_SYSTEM = resolveModuleSystem(LOCAL_SCOPE);\nif (MODULE_SYSTEM) {\n  updatePendingQueueKey(MODULE_SYSTEM);\n}\n\nconst ARCHITECTURE =\n  (MODULE_SYSTEM && typeof MODULE_SYSTEM.getArchitecture === 'function'\n    ? MODULE_SYSTEM.getArchitecture()\n    : null)\n  || resolveArchitecture(LOCAL_SCOPE);\n\nfunction detectWithFallbackChain() {\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.detectGlobalScope === 'function') {\n    try {\n      const detected = MODULE_SYSTEM.detectGlobalScope();\n      if (detected) {\n        return detected;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function') {\n      try {\n        const architectureDetected = ARCHITECTURE.detectGlobalScope();\n        if (architectureDetected) {\n          return architectureDetected;\n        }\n      } catch (architectureError) {\n        void architectureError;\n      }\n    }\n\n    return fallbackDetectGlobalScope();\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function') {\n    try {\n      const detected = ARCHITECTURE.detectGlobalScope();\n      if (detected) {\n        return detected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackDetectGlobalScope();\n}\n\nconst detectGlobalScope =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.detectGlobalScope === 'function'\n    ? function detectWithHelpers() {\n      try {\n        const detected = ARCHITECTURE_HELPERS.detectGlobalScope();\n        if (detected) {\n          return detected;\n        }\n      } catch (error) {\n        void error;\n      }\n      return detectWithFallbackChain();\n    }\n    : detectWithFallbackChain;\n\nconst PRIMARY_SCOPE = detectGlobalScope();\n\nfunction collectWithFallbackChain(primary) {\n  const target = primary || PRIMARY_SCOPE;\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.collectCandidateScopes === 'function') {\n    try {\n      const scopes = MODULE_SYSTEM.collectCandidateScopes(target);\n      if (Array.isArray(scopes) && scopes.length > 0) {\n        return scopes;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (ARCHITECTURE && typeof ARCHITECTURE.collectCandidateScopes === 'function') {\n      try {\n        const architectureScopes = ARCHITECTURE.collectCandidateScopes(target);\n        if (Array.isArray(architectureScopes) && architectureScopes.length > 0) {\n          return architectureScopes;\n        }\n      } catch (architectureError) {\n        void architectureError;\n      }\n    }\n\n    return fallbackCollectCandidateScopes(target);\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.collectCandidateScopes === 'function') {\n    try {\n      const architectureScopes = ARCHITECTURE.collectCandidateScopes(target);\n      if (Array.isArray(architectureScopes) && architectureScopes.length > 0) {\n        return architectureScopes;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackCollectCandidateScopes(target);\n}\n\nconst collectCandidateScopes =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.collectCandidateScopes === 'function'\n    ? function collectWithHelpers(primary) {\n      const target = primary || PRIMARY_SCOPE;\n      try {\n        const scopes = ARCHITECTURE_HELPERS.collectCandidateScopes(target);\n        if (Array.isArray(scopes) && scopes.length > 0) {\n          return scopes;\n        }\n      } catch (error) {\n        void error;\n      }\n      return collectWithFallbackChain(target);\n    }\n    : collectWithFallbackChain;\n\nfunction tryRequireWithFallback(modulePath) {\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.tryRequire === 'function') {\n    try {\n      const result = MODULE_SYSTEM.tryRequire(modulePath);\n      if (typeof result !== 'undefined') {\n        return result;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.tryRequire === 'function') {\n    try {\n      const result = ARCHITECTURE.tryRequire(modulePath);\n      if (typeof result !== 'undefined') {\n        return result;\n      }\n    } catch (architectureError) {\n      void architectureError;\n    }\n  }\n\n  return fallbackTryRequire(modulePath);\n}\n\nconst tryRequire =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.tryRequire === 'function'\n    ? function tryRequireWithHelpers(modulePath) {\n      const result = ARCHITECTURE_HELPERS.tryRequire(modulePath);\n      return typeof result === 'undefined' ? tryRequireWithFallback(modulePath) : result;\n    }\n    : tryRequireWithFallback;\n\nfunction defineHiddenPropertyWithFallback(target, name, value) {\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.defineHiddenProperty === 'function') {\n    try {\n      if (MODULE_SYSTEM.defineHiddenProperty(target, name, value)) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.defineHiddenProperty === 'function') {\n    try {\n      if (ARCHITECTURE.defineHiddenProperty(target, name, value)) {\n        return true;\n      }\n    } catch (architectureError) {\n      void architectureError;\n    }\n  }\n\n  return fallbackDefineHiddenProperty(target, name, value);\n}\n\nconst defineHiddenProperty =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.defineHiddenProperty === 'function'\n    ? function defineWithHelpers(target, name, value) {\n      try {\n        if (ARCHITECTURE_HELPERS.defineHiddenProperty(target, name, value)) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n      return defineHiddenPropertyWithFallback(target, name, value);\n    }\n    : defineHiddenPropertyWithFallback;\n\nfunction freezeDeepWithFallback(value) {\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.freezeDeep === 'function') {\n    try {\n      return MODULE_SYSTEM.freezeDeep(value);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.freezeDeep === 'function') {\n    try {\n      return ARCHITECTURE.freezeDeep(value);\n    } catch (architectureError) {\n      void architectureError;\n    }\n  }\n\n  return fallbackFreezeDeep(value);\n}\n\nconst freezeDeep =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.freezeDeep === 'function'\n    ? function freezeWithHelpers(value) {\n      try {\n        return ARCHITECTURE_HELPERS.freezeDeep(value);\n      } catch (error) {\n        void error;\n      }\n      return freezeDeepWithFallback(value);\n    }\n    : freezeDeepWithFallback;\n\nfunction safeWarnWithFallback(message, detail) {\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.safeWarn === 'function') {\n    try {\n      MODULE_SYSTEM.safeWarn(message, detail);\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.safeWarn === 'function') {\n    try {\n      ARCHITECTURE.safeWarn(message, detail);\n      return;\n    } catch (architectureError) {\n      void architectureError;\n    }\n  }\n\n  fallbackSafeWarn(message, detail);\n}\n\nconst safeWarn =\n  ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.safeWarn === 'function'\n    ? function warnWithHelpers(message, detail) {\n      try {\n        ARCHITECTURE_HELPERS.safeWarn(message, detail);\n        return;\n      } catch (error) {\n        void error;\n      }\n      safeWarnWithFallback(message, detail);\n    }\n    : safeWarnWithFallback;\n\nconst resolveFromScopes =\n  MODULE_SYSTEM && typeof MODULE_SYSTEM.resolveFromScopes === 'function'\n    ? function resolveWithSystem(propertyName, options) {\n      const settings = { ...(options || {}) };\n      if (!settings.primaryScope) {\n        settings.primaryScope = PRIMARY_SCOPE;\n      }\n      if (!settings.scopes) {\n        settings.scopes = collectCandidateScopes(settings.primaryScope);\n      }\n      return MODULE_SYSTEM.resolveFromScopes(propertyName, settings);\n    }\n    : ARCHITECTURE && typeof ARCHITECTURE.resolveFromScopes === 'function'\n      ? function resolveWithArchitecture(propertyName, options) {\n        const settings = { ...(options || {}) };\n        if (!settings.primaryScope) {\n          settings.primaryScope = PRIMARY_SCOPE;\n        }\n        if (!settings.scopes) {\n          settings.scopes = collectCandidateScopes(settings.primaryScope);\n        }\n        return ARCHITECTURE.resolveFromScopes(propertyName, settings);\n      }\n      : function resolveWithFallback(propertyName, options) {\n        const settings = { ...(options || {}) };\n        if (!settings.primaryScope) {\n          settings.primaryScope = PRIMARY_SCOPE;\n        }\n        if (!settings.scopes) {\n          settings.scopes = fallbackCollectCandidateScopes(settings.primaryScope);\n        }\n        return fallbackResolveFromScopes(propertyName, settings);\n      };\n\nfunction resolveModuleBase(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getModuleBase === 'function') {\n    try {\n      const baseFromSystem = MODULE_SYSTEM.getModuleBase(targetScope);\n      if (baseFromSystem && typeof baseFromSystem === 'object') {\n        updatePendingQueueKey(baseFromSystem);\n        return baseFromSystem;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Unable to resolve module base through module system.', error);\n    }\n  }\n\n  if (cineModuleBase && typeof cineModuleBase === 'object') {\n    updatePendingQueueKey(cineModuleBase);\n    return cineModuleBase;\n  }\n\n  const resolved = resolveFromScopes('cineModuleBase', {\n    primaryScope: targetScope,\n    scopes: collectCandidateScopes(targetScope),\n  });\n\n  if (resolved && typeof resolved === 'object') {\n    updatePendingQueueKey(resolved);\n    return resolved;\n  }\n\n  return null;\n}\n\nfunction ensureQueue(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.ensureQueue === 'function') {\n    try {\n      const queueFromHelpers = ARCHITECTURE_HELPERS.ensureQueue(targetScope, pendingQueueKey);\n      if (Array.isArray(queueFromHelpers)) {\n        return queueFromHelpers;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Unable to access pending queue via architecture helpers.', error);\n    }\n  }\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getPendingQueue === 'function') {\n    try {\n      const queueFromSystem = MODULE_SYSTEM.getPendingQueue(targetScope);\n      if (Array.isArray(queueFromSystem)) {\n        return queueFromSystem;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Unable to access pending queue via module system.', error);\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.ensureQueue === 'function') {\n    try {\n      const queued = ARCHITECTURE.ensureQueue(targetScope, pendingQueueKey);\n      if (Array.isArray(queued)) {\n        return queued;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Unable to access pending queue via architecture.', error);\n    }\n  }\n\n  return fallbackEnsureQueue(targetScope, pendingQueueKey);\n}\n\nfunction queueModuleRegistration(name, api, options, scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.queueModuleRegistration === 'function') {\n    try {\n      if (ARCHITECTURE_HELPERS.queueModuleRegistration(targetScope, name, api, options)) {\n        return true;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Architecture helpers queueModuleRegistration failed.', error);\n    }\n  }\n\n  const queue = ensureQueue(targetScope);\n  if (!queue) {\n    return false;\n  }\n\n  const payload = Object.freeze({\n    name,\n    api,\n    options: Object.freeze({ ...(options || {}) }),\n  });\n\n  try {\n    queue.push(payload);\n  } catch (error) {\n    void error;\n    queue[queue.length] = payload;\n  }\n\n  return true;\n}\n\nfunction resolveModuleRegistry(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (ARCHITECTURE_HELPERS && typeof ARCHITECTURE_HELPERS.resolveModuleRegistry === 'function') {\n    try {\n      const resolvedByHelpers = ARCHITECTURE_HELPERS.resolveModuleRegistry(targetScope);\n      if (resolvedByHelpers && typeof resolvedByHelpers === 'object') {\n        return resolvedByHelpers;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Architecture helpers resolveModuleRegistry failed.', error);\n    }\n  }\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getModuleRegistry === 'function') {\n    try {\n      const registryFromSystem = MODULE_SYSTEM.getModuleRegistry(targetScope);\n      if (registryFromSystem && typeof registryFromSystem === 'object') {\n        return registryFromSystem;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Unable to resolve module registry via module system.', error);\n    }\n  }\n\n  const base = resolveModuleBase(targetScope);\n  if (base && typeof base === 'object') {\n    if (typeof base.getModuleRegistry === 'function') {\n      try {\n        const provided = base.getModuleRegistry(targetScope);\n        if (provided && typeof provided === 'object') {\n          return provided;\n        }\n      } catch (error) {\n        safeWarn('cineModuleContext: Module base getModuleRegistry failed.', error);\n      }\n    }\n\n    if (typeof base.resolveModuleRegistry === 'function') {\n      try {\n        const resolved = base.resolveModuleRegistry(targetScope);\n        if (resolved && typeof resolved === 'object') {\n          return resolved;\n        }\n      } catch (error) {\n        safeWarn('cineModuleContext: Module base resolveModuleRegistry failed.', error);\n      }\n    }\n  }\n\n  if (cineModules && typeof cineModules === 'object') {\n    return cineModules;\n  }\n\n  const resolved = resolveFromScopes('cineModules', {\n    primaryScope: targetScope,\n    scopes: collectCandidateScopes(targetScope),\n  });\n\n  return resolved && typeof resolved === 'object' ? resolved : null;\n}\n\nfunction registerOrQueue(name, api, options, scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.registerModule === 'function') {\n    try {\n      if (MODULE_SYSTEM.registerModule(name, api, options || {}, targetScope)) {\n        return true;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Module system failed to register module.', error);\n    }\n  }\n\n  const registry = resolveModuleRegistry(targetScope);\n  const base = resolveModuleBase(targetScope);\n\n  if (base && typeof base.registerOrQueueModule === 'function') {\n    try {\n      const result = base.registerOrQueueModule(\n        name,\n        api,\n        options || {},\n        (error) => {\n          safeWarn('cineModuleContext: Module base failed to register module.', error);\n        },\n        targetScope,\n        registry,\n      );\n      if (result) {\n        return true;\n      }\n    } catch (error) {\n      safeWarn('cineModuleContext: Module base threw while registering module.', error);\n    }\n  }\n\n  if (registry && typeof registry.register === 'function') {\n    try {\n      registry.register(name, api, options || {});\n      return true;\n    } catch (error) {\n      safeWarn('cineModuleContext: Registry registration failed.', error);\n    }\n  }\n\n  return queueModuleRegistration(name, api, options, targetScope);\n}\n\nfunction exposeGlobal(name, value, scope, options = {}) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  if (!targetScope || typeof targetScope !== 'object') {\n    return false;\n  }\n\n  if (MODULE_SYSTEM && typeof MODULE_SYSTEM.exposeGlobal === 'function') {\n    try {\n      return MODULE_SYSTEM.exposeGlobal(name, value, targetScope, options || {});\n    } catch (error) {\n      safeWarn('cineModuleContext: Module system failed to expose global.', error);\n    }\n  }\n\n  const descriptor = {\n    configurable: options.configurable !== false,\n    enumerable: !!options.enumerable,\n    value,\n    writable: options.writable === true,\n  };\n\n  try {\n    Object.defineProperty(targetScope, name, descriptor);\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    targetScope[name] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction createModuleContext(options = {}) {\n  const targetScope = options.scope || PRIMARY_SCOPE;\n  const base = resolveModuleBase(targetScope);\n  const registry = resolveModuleRegistry(targetScope);\n\n  const context = {\n    getArchitecture() {\n      return ARCHITECTURE || null;\n    },\n    getSystem() {\n      return MODULE_SYSTEM || null;\n    },\n    getScope() {\n      return targetScope;\n    },\n    detectGlobalScope(scopeCandidate) {\n      const target = scopeCandidate || targetScope;\n      try {\n        if (MODULE_SYSTEM && typeof MODULE_SYSTEM.detectGlobalScope === 'function') {\n          const detected = MODULE_SYSTEM.detectGlobalScope(target);\n          if (detected) {\n            return detected;\n          }\n        }\n      } catch (error) {\n        safeWarn('cineModuleContext: detectGlobalScope via system failed.', error);\n      }\n\n      if (ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function') {\n        try {\n          const detected = ARCHITECTURE.detectGlobalScope(target);\n          if (detected) {\n            return detected;\n          }\n        } catch (error) {\n          safeWarn('cineModuleContext: detectGlobalScope via architecture failed.', error);\n        }\n      }\n\n      return fallbackDetectGlobalScope();\n    },\n    collectCandidateScopes(primary) {\n      return collectCandidateScopes(primary || targetScope);\n    },\n    tryRequire(modulePath) {\n      return tryRequire(modulePath);\n    },\n    resolveFromScopes(propertyName, settings) {\n      const optionsWithScope = { ...(settings || {}) };\n      if (!optionsWithScope.primaryScope) {\n        optionsWithScope.primaryScope = targetScope;\n      }\n      if (!optionsWithScope.scopes) {\n        optionsWithScope.scopes = collectCandidateScopes(optionsWithScope.primaryScope);\n      }\n      return resolveFromScopes(propertyName, optionsWithScope);\n    },\n    defineHiddenProperty(target, name, value) {\n      return defineHiddenProperty(target, name, value);\n    },\n    freezeDeep(value) {\n      return freezeDeep(value);\n    },\n    safeWarn(message, detail) {\n      safeWarn(message, detail);\n    },\n    ensureQueue(scopeCandidate) {\n      return ensureQueue(scopeCandidate || targetScope);\n    },\n    getModuleBase() {\n      return base;\n    },\n    getModuleRegistry() {\n      return registry;\n    },\n    queueModuleRegistration(name, api, moduleOptions, scopeCandidate) {\n      return queueModuleRegistration(name, api, moduleOptions, scopeCandidate || targetScope);\n    },\n    registerModule(name, api, moduleOptions, scopeCandidate) {\n      return registerOrQueue(name, api, moduleOptions, scopeCandidate || targetScope);\n    },\n    exposeGlobal(name, value, scopeCandidate, exposeOptions) {\n      return exposeGlobal(name, value, scopeCandidate || targetScope, exposeOptions || {});\n    },\n  };\n\n  return Object.freeze(context);\n}\n\nconst contextApi = freezeDeep({\n  getArchitecture() {\n    return ARCHITECTURE;\n  },\n  getModuleSystem() {\n    return MODULE_SYSTEM;\n  },\n  detectGlobalScope,\n  collectCandidateScopes,\n  tryRequire,\n  resolveFromScopes,\n  defineHiddenProperty,\n  freezeDeep,\n  safeWarn,\n  ensureQueue,\n  resolveModuleBase,\n  resolveModuleRegistry,\n  queueModuleRegistration,\n  registerOrQueue,\n  exposeGlobal,\n  createModuleContext,\n  getPrimaryScope() {\n    return PRIMARY_SCOPE;\n  },\n});\n\nregisterOrQueue(\n  'cineModuleContext',\n  contextApi,\n  {\n    category: 'infrastructure',\n    description: 'Shared context helpers that unify architecture, system and registry lookups.',\n    freeze: false,\n    connections: ['cineModuleBase', 'cineModuleGlobals', 'cineModuleEnvironment', 'cineModuleArchitectureKernel'],\n  },\n  PRIMARY_SCOPE,\n);\n\nexposeGlobal('cineModuleContext', contextApi, PRIMARY_SCOPE, { configurable: true, enumerable: false, writable: false });\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = contextApi;\n// }\n// })();\n\nexport const cineModuleContext = contextApi;\n","/*\n * architecture-helpers.js\n * ------------------------\n * Supplies convenience wrappers around the architecture core so feature\n * modules can locate shared services without duplicating the environment\n * probing logic. These helpers are intentionally verbose because they need to\n * succeed even when bundlers reshuffle the module graph or when the app boots\n * from an offline cache on older browsers.\n */\n\n// (function () {\n// Mirrors the constant from architecture-core. Duplicating it here keeps the\n// helper resilient when modules are executed individually during tests.\nconst DEFAULT_PENDING_QUEUE_KEY = '__cinePendingModuleRegistrations__';\n\nfunction fallbackDetectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\nconst LOCAL_SCOPE = fallbackDetectGlobalScope();\n\n// Attempt to fetch the architecture core module directly. When the require\n// helper is not available (for example inside a browser Service Worker) we\n// try to find a previously initialised instance on any known global scope.\nfunction resolveArchitectureCore(scope) {\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  const candidates = [];\n  const primary = scope || LOCAL_SCOPE;\n  if (primary && typeof primary === 'object') {\n    candidates.push(primary);\n  }\n  if (typeof globalThis !== 'undefined' && candidates.indexOf(globalThis) === -1) candidates.push(globalThis);\n  if (typeof window !== 'undefined' && candidates.indexOf(window) === -1) candidates.push(window);\n  if (typeof self !== 'undefined' && candidates.indexOf(self) === -1) candidates.push(self);\n  if (typeof global !== 'undefined' && candidates.indexOf(global) === -1) candidates.push(global);\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (candidate && typeof candidate.cineModuleArchitectureCore === 'object') {\n      return candidate.cineModuleArchitectureCore;\n    }\n  }\n\n  return null;\n}\n\n// Resolve the public architecture entry point so consumers can access the\n// higher level API. Falling back to globals keeps compatibility with legacy\n// bundles that attached the module directly to window.\nfunction tryRequireArchitecture(scope) {\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  const targetScope = scope || LOCAL_SCOPE;\n  if (targetScope && typeof targetScope.cineModuleArchitecture === 'object') {\n    return targetScope.cineModuleArchitecture;\n  }\n\n  return null;\n}\n\nconst ARCHITECTURE = tryRequireArchitecture(LOCAL_SCOPE);\nconst ARCHITECTURE_CORE = resolveArchitectureCore(LOCAL_SCOPE);\nconst CORE_INSTANCE =\n  ARCHITECTURE_CORE && typeof ARCHITECTURE_CORE.createCore === 'function'\n    ? ARCHITECTURE_CORE.createCore({\n      primaryScope: LOCAL_SCOPE,\n      pendingQueueKey: DEFAULT_PENDING_QUEUE_KEY,\n    })\n    : null;\n\n// Gathering candidate scopes upfront avoids repeated global probing. The\n// helper maintains insertion order to keep the main window preferred over\n// worker contexts where possible.\nfunction fallbackCollectCandidateScopes(primary) {\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(primary);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  return scopes;\n}\n\n// Some environments expose both the architecture core and the helper facade.\n// We call whichever is available and only rely on the fallback detector when\n// nothing else succeeds. This approach ensures the detection code always\n// mirrors what the production bundle uses.\nfunction detectWithArchitecture() {\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.detectGlobalScope === 'function') {\n    try {\n      const detected = CORE_INSTANCE.detectGlobalScope();\n      if (detected) {\n        return detected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function') {\n    try {\n      const detected = ARCHITECTURE.detectGlobalScope();\n      if (detected) {\n        return detected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n  return fallbackDetectGlobalScope();\n}\n\nconst detectGlobalScope =\n  ARCHITECTURE && typeof ARCHITECTURE.detectGlobalScope === 'function'\n    ? function detectWithPreferred() {\n      try {\n        const detected = ARCHITECTURE.detectGlobalScope();\n        if (detected) {\n          return detected;\n        }\n      } catch (error) {\n        void error;\n      }\n      return detectWithArchitecture();\n    }\n    : detectWithArchitecture;\n\nconst PRIMARY_SCOPE = detectGlobalScope();\n\nfunction collectWithArchitecture(primary) {\n  const target = primary || PRIMARY_SCOPE;\n\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.collectCandidateScopes === 'function') {\n    try {\n      const collected = CORE_INSTANCE.collectCandidateScopes(target);\n      if (Array.isArray(collected) && collected.length > 0) {\n        return collected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.collectCandidateScopes === 'function') {\n    try {\n      const collected = ARCHITECTURE.collectCandidateScopes(target);\n      if (Array.isArray(collected) && collected.length > 0) {\n        return collected;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackCollectCandidateScopes(target);\n}\n\nconst collectCandidateScopes = function collect(primary) {\n  const target = primary || PRIMARY_SCOPE;\n  const collected = collectWithArchitecture(target);\n  if (Array.isArray(collected) && collected.length > 0) {\n    return collected;\n  }\n  return fallbackCollectCandidateScopes(target);\n};\n\nfunction fallbackTryRequire(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\nfunction tryRequireWithArchitecture(modulePath) {\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.tryRequire === 'function') {\n    try {\n      const result = CORE_INSTANCE.tryRequire(modulePath);\n      if (typeof result !== 'undefined') {\n        return result;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.tryRequire === 'function') {\n    try {\n      const result = ARCHITECTURE.tryRequire(modulePath);\n      if (typeof result !== 'undefined') {\n        return result;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackTryRequire(modulePath);\n}\n\nfunction resolveImmutability(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.resolveImmutability === 'function') {\n    try {\n      const resolved = CORE_INSTANCE.resolveImmutability(targetScope);\n      if (resolved && typeof resolved === 'object') {\n        return resolved;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.tryRequire === 'function') {\n    try {\n      const required = ARCHITECTURE.tryRequire('./immutability.js');\n      if (required && typeof required === 'object') {\n        return required;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const direct = tryRequireWithArchitecture('./immutability.js');\n  if (direct && typeof direct === 'object') {\n    return direct;\n  }\n\n  const scopes = collectCandidateScopes(targetScope);\n  for (let index = 0; index < scopes.length; index += 1) {\n    const candidate = scopes[index];\n    if (candidate && typeof candidate.cineModuleImmutability === 'object') {\n      return candidate.cineModuleImmutability;\n    }\n  }\n\n  return null;\n}\n\nfunction fallbackDefineHiddenProperty(target, name, value) {\n  if (!target || (typeof target !== 'object' && typeof target !== 'function')) {\n    return false;\n  }\n\n  try {\n    Object.defineProperty(target, name, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value,\n    });\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    target[name] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction defineHiddenProperty(target, name, value) {\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.defineHiddenProperty === 'function') {\n    try {\n      if (CORE_INSTANCE.defineHiddenProperty(target, name, value)) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.defineHiddenProperty === 'function') {\n    try {\n      if (ARCHITECTURE.defineHiddenProperty(target, name, value)) {\n        return true;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackDefineHiddenProperty(target, name, value);\n}\n\nfunction fallbackEnsureQueue(scope, queueKey) {\n  if (!scope || typeof scope !== 'object') {\n    return null;\n  }\n\n  let queue = null;\n  try {\n    queue = scope[queueKey];\n  } catch (error) {\n    void error;\n    queue = null;\n  }\n\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  if (defineHiddenProperty(scope, queueKey, [])) {\n    queue = scope[queueKey];\n    if (Array.isArray(queue)) {\n      return queue;\n    }\n  }\n\n  try {\n    scope[queueKey] = [];\n    queue = scope[queueKey];\n  } catch (error) {\n    void error;\n    return null;\n  }\n\n  return Array.isArray(queue) ? queue : null;\n}\n\nfunction ensureQueue(scope, queueKey) {\n  const key = typeof queueKey === 'string' && queueKey ? queueKey : DEFAULT_PENDING_QUEUE_KEY;\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.ensureQueue === 'function') {\n    try {\n      const resolved = CORE_INSTANCE.ensureQueue(targetScope, key);\n      if (Array.isArray(resolved)) {\n        return resolved;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.ensureQueue === 'function') {\n    try {\n      const resolved = ARCHITECTURE.ensureQueue(targetScope, key);\n      if (Array.isArray(resolved)) {\n        return resolved;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return fallbackEnsureQueue(targetScope, key);\n}\n\nfunction createFallbackImmutability() {\n  function shouldBypass(value) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return false;\n    }\n\n    try {\n      if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n        return true;\n      }\n\n      if (typeof value.on === 'function' && typeof value.emit === 'function') {\n        if (typeof value.write === 'function' || typeof value.read === 'function') {\n          return true;\n        }\n\n        const ctorName = value.constructor && value.constructor.name;\n        if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n          return true;\n        }\n      }\n\n      if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n        const tag = value[Symbol.toStringTag];\n        if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n          return true;\n        }\n      }\n    } catch (inspectionError) {\n      void inspectionError;\n    }\n\n    return false;\n  }\n\n  function freeze(value, seen = new WeakSet()) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return value;\n    }\n\n    if (shouldBypass(value)) {\n      return value;\n    }\n\n    if (seen.has(value)) {\n      return value;\n    }\n\n    seen.add(value);\n\n    const keys = Object.getOwnPropertyNames(value);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      let child;\n      try {\n        child = value[key];\n      } catch (accessError) {\n        void accessError;\n        child = undefined;\n      }\n      if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n        continue;\n      }\n      freeze(child, seen);\n    }\n\n    try {\n      return Object.freeze(value);\n    } catch (freezeError) {\n      console.warn('fallbackCreateImmutability (helpers): Object.freeze failed', freezeError);\n      void freezeError;\n      return value;\n    }\n  }\n\n  return {\n    shouldBypassDeepFreeze: shouldBypass,\n    freezeDeep: freeze,\n  };\n}\n\nconst FALLBACK_IMMUTABILITY = createFallbackImmutability();\nlet activeImmutability = resolveImmutability(PRIMARY_SCOPE) || FALLBACK_IMMUTABILITY;\n\nfunction getImmutability() {\n  if (activeImmutability !== FALLBACK_IMMUTABILITY) {\n    return activeImmutability;\n  }\n\n  const resolved = resolveImmutability(PRIMARY_SCOPE);\n  if (resolved && resolved !== activeImmutability) {\n    activeImmutability = resolved;\n  }\n\n  return activeImmutability;\n}\n\nfunction freezeDeep(value) {\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.freezeDeep === 'function') {\n    try {\n      return CORE_INSTANCE.freezeDeep(value);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const provider = getImmutability();\n\n  try {\n    return provider.freezeDeep(value);\n  } catch (error) {\n    void error;\n  }\n\n  return FALLBACK_IMMUTABILITY.freezeDeep(value);\n}\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction safeWarn(message, detail) {\n  if (CORE_INSTANCE && typeof CORE_INSTANCE.safeWarn === 'function') {\n    try {\n      CORE_INSTANCE.safeWarn(message, detail);\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  if (ARCHITECTURE && typeof ARCHITECTURE.safeWarn === 'function') {\n    try {\n      ARCHITECTURE.safeWarn(message, detail);\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  fallbackSafeWarn(message, detail);\n}\n\nfunction resolveModuleRegistry(scope) {\n  const targetScope = scope || PRIMARY_SCOPE;\n\n  const required = tryRequireWithArchitecture('./registry.js');\n  if (required && typeof required === 'object') {\n    return required;\n  }\n\n  const scopes = collectCandidateScopes(targetScope);\n  for (let index = 0; index < scopes.length; index += 1) {\n    const candidate = scopes[index];\n    if (candidate && typeof candidate.cineModules === 'object') {\n      return candidate.cineModules;\n    }\n  }\n\n  return null;\n}\n\nfunction queueModuleRegistration(scope, name, api, options) {\n  const targetScope = scope || PRIMARY_SCOPE;\n  const queue = ensureQueue(targetScope, DEFAULT_PENDING_QUEUE_KEY);\n  if (!queue) {\n    return false;\n  }\n\n  const payload = freezeDeep({\n    name,\n    api,\n    options: Object.freeze({ ...(options || {}) }),\n  });\n\n  try {\n    queue.push(payload);\n  } catch (error) {\n    void error;\n    queue[queue.length] = payload;\n  }\n\n  return true;\n}\n\nconst helpers = freezeDeep({\n  architecture: ARCHITECTURE,\n  architectureCore: ARCHITECTURE_CORE,\n  detectGlobalScope,\n  getPrimaryScope() {\n    return PRIMARY_SCOPE;\n  },\n  collectCandidateScopes,\n  tryRequire: tryRequireWithArchitecture,\n  defineHiddenProperty,\n  ensureQueue,\n  freezeDeep,\n  safeWarn,\n  resolveModuleRegistry,\n  queueModuleRegistration,\n  pendingQueueKey: DEFAULT_PENDING_QUEUE_KEY,\n  fallbackDetectGlobalScope,\n});\n\nconst registry = resolveModuleRegistry(PRIMARY_SCOPE);\nconst registrationOptions = {\n  category: 'infrastructure',\n  description: 'Shared architecture helpers for scope detection, registry resolution and queue management.',\n  replace: true,\n  connections: ['cineModuleArchitectureKernel', 'cineModuleArchitectureCore'],\n};\n\nif (registry && typeof registry.register === 'function') {\n  try {\n    registry.register('cineModuleArchitectureHelpers', helpers, registrationOptions);\n  } catch (error) {\n    safeWarn('cineModuleArchitectureHelpers: immediate registry registration failed.', error);\n    queueModuleRegistration(PRIMARY_SCOPE, 'cineModuleArchitectureHelpers', helpers, registrationOptions);\n  }\n} else {\n  queueModuleRegistration(PRIMARY_SCOPE, 'cineModuleArchitectureHelpers', helpers, registrationOptions);\n}\n\nif (PRIMARY_SCOPE && typeof PRIMARY_SCOPE === 'object' && !PRIMARY_SCOPE.cineModuleArchitectureHelpers) {\n  defineHiddenProperty(PRIMARY_SCOPE, 'cineModuleArchitectureHelpers', helpers);\n}\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = helpers;\n// }\n// })();\nexport const cineModuleArchitectureHelpers = helpers;\n","import { createCollector } from './helpers/scope-collector.js';\nimport { cineScopeUtils } from './helpers/scope-utils.js';\n\n// (function () {\nconst DEFAULT_PENDING_QUEUE_KEY = '__cinePendingModuleRegistrations__';\n\nfunction baseDetectGlobalScope() {\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return {};\n}\n\nfunction fallbackTryRequire(modulePath) {\n  return null; /* Require removed for ESM */\n}\n\nfunction fallbackDefineHiddenProperty(target, key, value) {\n  if (!target || (typeof target !== 'object' && typeof target !== 'function')) {\n    return false;\n  }\n\n  try {\n    Object.defineProperty(target, key, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value,\n    });\n    return true;\n  } catch (error) {\n    void error;\n  }\n\n  try {\n    target[key] = value;\n    return true;\n  } catch (assignmentError) {\n    void assignmentError;\n  }\n\n  return false;\n}\n\nfunction collectCandidateScopesFallback(primary, extras, detect) {\n  const detectFn = typeof detect === 'function' ? detect : baseDetectGlobalScope;\n  const additionalScopes = Array.isArray(extras) ? extras : null;\n  const collector = resolveHelperCollector(detectFn, additionalScopes);\n  if (collector) {\n    return collector(primary);\n  }\n\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  if (primary) {\n    pushScope(primary);\n  }\n\n  try {\n    pushScope(detectFn());\n  } catch (detectError) {\n    void detectError;\n  }\n\n  if (Array.isArray(additionalScopes)) {\n    for (let index = 0; index < additionalScopes.length; index += 1) {\n      pushScope(additionalScopes[index]);\n    }\n  }\n\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  pushScope(baseDetectGlobalScope());\n\n  return scopes;\n}\n\nfunction resolveFromScopesFallback(propertyName, options) {\n  const settings = options || {};\n  const predicate = typeof settings.predicate === 'function' ? settings.predicate : null;\n  const scoped = Array.isArray(settings.scopes) ? settings.scopes.slice() : [];\n  const detectFn = typeof settings.detect === 'function' ? settings.detect : baseDetectGlobalScope;\n  const extras = Array.isArray(settings.additionalScopes) ? settings.additionalScopes : undefined;\n  const primaryScope = settings.primaryScope;\n  const collected = collectCandidateScopesFallback(primaryScope, extras, detectFn);\n\n  for (let index = 0; index < collected.length; index += 1) {\n    if (scoped.indexOf(collected[index]) === -1) {\n      scoped.push(collected[index]);\n    }\n  }\n\n  for (let index = 0; index < scoped.length; index += 1) {\n    const scope = scoped[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    if (predicate) {\n      try {\n        if (predicate(scope, propertyName)) {\n          return scope;\n        }\n      } catch (predicateError) {\n        void predicateError;\n      }\n    }\n\n    try {\n      if (propertyName in scope) {\n        return scope;\n      }\n    } catch (accessError) {\n      void accessError;\n    }\n  }\n\n  return null;\n}\n\nconst LOCAL_SCOPE = baseDetectGlobalScope();\n\nfunction resolveScopeUtils(scope) {\n  const primaryScope = scope || LOCAL_SCOPE;\n\n  if (cineScopeUtils && typeof cineScopeUtils === 'object') {\n    return cineScopeUtils;\n  }\n\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  const candidates = [];\n\n  function pushCandidate(candidate) {\n    if (!candidate || (typeof candidate !== 'object' && typeof candidate !== 'function')) {\n      return;\n    }\n    if (candidates.indexOf(candidate) === -1) {\n      candidates.push(candidate);\n    }\n  }\n\n  pushCandidate(primaryScope);\n  if (typeof globalThis !== 'undefined') pushCandidate(globalThis);\n  if (typeof window !== 'undefined') pushCandidate(window);\n  if (typeof self !== 'undefined') pushCandidate(self);\n  if (typeof global !== 'undefined') pushCandidate(global);\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    try {\n      const utils = candidate && candidate.cineScopeUtils;\n      if (utils && typeof utils === 'object') {\n        return utils;\n      }\n    } catch (scopeError) {\n      void scopeError;\n    }\n  }\n\n  return null;\n}\n\nconst SCOPE_UTILS = resolveScopeUtils(LOCAL_SCOPE);\n\nconst detectGlobalScope =\n  SCOPE_UTILS && typeof SCOPE_UTILS.detectGlobalScope === 'function'\n    ? function detectWithUtils() {\n      try {\n        return SCOPE_UTILS.detectGlobalScope();\n      } catch (error) {\n        void error;\n      }\n      return baseDetectGlobalScope();\n    }\n    : baseDetectGlobalScope;\n\nconst tryRequire =\n  SCOPE_UTILS && typeof SCOPE_UTILS.tryRequire === 'function'\n    ? SCOPE_UTILS.tryRequire\n    : fallbackTryRequire;\n\nconst defineHiddenProperty =\n  SCOPE_UTILS && typeof SCOPE_UTILS.defineHiddenProperty === 'function'\n    ? SCOPE_UTILS.defineHiddenProperty\n    : fallbackDefineHiddenProperty;\n\nconst collectCandidateScopes =\n  SCOPE_UTILS && typeof SCOPE_UTILS.collectCandidateScopes === 'function'\n    ? function collectCandidateScopesWithUtils(primary, extras, detect) {\n      const detectFn = typeof detect === 'function' ? detect : detectGlobalScope;\n      return SCOPE_UTILS.collectCandidateScopes(primary, extras, detectFn);\n    }\n    : collectCandidateScopesFallback;\n\nconst resolveFromScopes =\n  SCOPE_UTILS && typeof SCOPE_UTILS.resolveFromScopes === 'function'\n    ? function resolveWithUtils(propertyName, options) {\n      const settings = options ? cloneOptions(options) : {};\n      if (!settings.primaryScope) {\n        settings.primaryScope = LOCAL_SCOPE;\n      }\n      if (!settings.detect) {\n        settings.detect = detectGlobalScope;\n      }\n      return SCOPE_UTILS.resolveFromScopes(propertyName, settings) || null;\n    }\n    : resolveFromScopesFallback;\n\nfunction resolveScopeCollector() {\n  if (createCollector && typeof createCollector === 'function') {\n    return { createCollector };\n  }\n\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  // const required = tryRequire('./helpers/scope-collector.js');\n  // if (required && typeof required.createCollector === 'function') {\n  //   return required;\n  // }\n\n  const candidates = collectCandidateScopes(LOCAL_SCOPE, null, detectGlobalScope);\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const scope = candidates[index];\n    try {\n      const collector = scope && scope.__cineScopeCollector;\n      if (collector && typeof collector.createCollector === 'function') {\n        return collector;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return null;\n}\n\nconst SCOPE_COLLECTOR = resolveScopeCollector();\nconst createScopeCollector =\n  SCOPE_COLLECTOR && typeof SCOPE_COLLECTOR.createCollector === 'function'\n    ? SCOPE_COLLECTOR.createCollector\n    : null;\nconst DEFAULT_EXTRAS_KEY = { key: 'defaultExtras' };\nconst HELPER_COLLECTOR_CACHE = [];\n\nfunction resolveHelperCollector(detectFn, extras) {\n  if (!createScopeCollector) {\n    return null;\n  }\n\n  const extrasKey = Array.isArray(extras) ? extras : DEFAULT_EXTRAS_KEY;\n\n  for (let index = 0; index < HELPER_COLLECTOR_CACHE.length; index += 1) {\n    const entry = HELPER_COLLECTOR_CACHE[index];\n    if (entry.detect === detectFn && entry.extras === extrasKey) {\n      return entry.collector;\n    }\n  }\n\n  const collector = createScopeCollector({\n    detectGlobalScope: detectFn,\n    additionalScopes: Array.isArray(extras) ? extras : undefined,\n  });\n\n  if (collector) {\n    HELPER_COLLECTOR_CACHE.push({ detect: detectFn, extras: extrasKey, collector });\n    return collector;\n  }\n\n  return null;\n}\n\nfunction cloneOptions(source) {\n  if (!source || typeof source !== 'object') {\n    return {};\n  }\n\n  const clone = {};\n  const keys = Object.keys(source);\n  for (let index = 0; index < keys.length; index += 1) {\n    const key = keys[index];\n    clone[key] = source[key];\n  }\n  return clone;\n}\n\nfunction fallbackCreateImmutability() {\n  function shouldBypass(value) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return false;\n    }\n\n    try {\n      if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n        return true;\n      }\n\n      if (typeof value.on === 'function' && typeof value.emit === 'function') {\n        if (typeof value.write === 'function' || typeof value.read === 'function') {\n          return true;\n        }\n\n        const ctorName = value.constructor && value.constructor.name;\n        if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n          return true;\n        }\n      }\n\n      if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n        const tag = value[Symbol.toStringTag];\n        if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n          return true;\n        }\n      }\n    } catch (inspectionError) {\n      void inspectionError;\n    }\n\n    return false;\n  }\n\n  function freeze(value, seen = new WeakSet()) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return value;\n    }\n\n    if (shouldBypass(value)) {\n      process.stdout.write(`architecture.js bypassed freeze for value: ${typeof value}\\n`);\n      return value;\n    }\n\n    if (seen.has(value)) {\n      return value;\n    }\n\n    seen.add(value);\n\n    const keys = Object.getOwnPropertyNames(value);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      let child;\n      try {\n        child = value[key];\n      } catch (accessError) {\n        void accessError;\n        child = undefined;\n      }\n      if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n        continue;\n      }\n\n      freeze(child, seen);\n    }\n\n    try {\n      return Object.freeze(value);\n    } catch (freezeError) {\n      void freezeError;\n      return value;\n    }\n  }\n\n  return {\n    shouldBypassDeepFreeze: shouldBypass,\n    freezeDeep: freeze,\n  };\n}\n\nconst FALLBACK_IMMUTABILITY = fallbackCreateImmutability();\n\nfunction fallbackEnsureQueue(scope, key) {\n  if (!scope || typeof scope !== 'object') {\n    return null;\n  }\n\n  const queueKey = typeof key === 'string' && key ? key : DEFAULT_PENDING_QUEUE_KEY;\n\n  let queue = scope[queueKey];\n  if (Array.isArray(queue)) {\n    return queue;\n  }\n\n  if (defineHiddenProperty(scope, queueKey, [])) {\n    queue = scope[queueKey];\n    if (Array.isArray(queue)) {\n      return queue;\n    }\n  }\n\n  try {\n    scope[queueKey] = [];\n    queue = scope[queueKey];\n    if (Array.isArray(queue)) {\n      return queue;\n    }\n  } catch (error) {\n    void error;\n  }\n\n  return null;\n}\n\nfunction fallbackSafeWarn(message, detail) {\n  if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n    return;\n  }\n\n  try {\n    if (typeof detail === 'undefined') {\n      console.warn(message);\n    } else {\n      console.warn(message, detail);\n    }\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction resolveArchitectureCore(scope) {\n  /* Require removed for ESM */\n  if (typeof require === 'function') {\n    // no-op\n  }\n\n  const candidates = collectCandidateScopes(scope, null, detectGlobalScope);\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (candidate && typeof candidate.cineModuleArchitectureCore === 'object') {\n      return candidate.cineModuleArchitectureCore;\n    }\n  }\n\n  return null;\n}\n\nfunction createFallbackCore(options) {\n  const settings = options || {};\n\n  const customPrimaryScope =\n    (settings && (settings.primaryScope || settings.scope)) &&\n    (typeof settings.primaryScope === 'object' || typeof settings.primaryScope === 'function'\n      ? settings.primaryScope\n      : typeof settings.scope === 'object' || typeof settings.scope === 'function'\n        ? settings.scope\n        : null);\n\n  const detectOverride = typeof settings.detectGlobalScope === 'function' ? settings.detectGlobalScope : null;\n  const resolveOverride = typeof settings.resolveFromScopes === 'function' ? settings.resolveFromScopes : null;\n  const freezeOverride = typeof settings.freezeDeep === 'function' ? settings.freezeDeep : null;\n  const warnOverride = typeof settings.safeWarn === 'function' ? settings.safeWarn : null;\n  const tryRequireOverride = typeof settings.tryRequire === 'function' ? settings.tryRequire : null;\n\n  const additionalScopes = Array.isArray(settings.additionalScopes)\n    ? settings.additionalScopes.filter(function isObjectLike(value) {\n      return value && (typeof value === 'object' || typeof value === 'function');\n    })\n    : [];\n\n  const pendingQueueKey =\n    typeof settings.pendingQueueKey === 'string' && settings.pendingQueueKey\n      ? settings.pendingQueueKey\n      : DEFAULT_PENDING_QUEUE_KEY;\n\n  let cachedPrimaryScope = null;\n\n  function detectPrimaryScope() {\n    try {\n      if (detectOverride) {\n        const detected = detectOverride();\n        if (detected) {\n          cachedPrimaryScope = detected;\n          return detected;\n        }\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (cachedPrimaryScope) {\n      return cachedPrimaryScope;\n    }\n\n    const detected = customPrimaryScope || detectGlobalScope();\n    cachedPrimaryScope = detected;\n    return detected;\n  }\n\n  function getPrimaryScope() {\n    return detectPrimaryScope();\n  }\n\n  function collectCandidateScopes(primary) {\n    const targetPrimary = primary || customPrimaryScope;\n    const collector = resolveHelperCollector(detectPrimaryScope, additionalScopes);\n    if (collector) {\n      return collector(targetPrimary);\n    }\n\n    const scopes = [];\n\n    function pushScope(scope) {\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        return;\n      }\n      if (scopes.indexOf(scope) === -1) {\n        scopes.push(scope);\n      }\n    }\n\n    pushScope(targetPrimary);\n    pushScope(detectPrimaryScope());\n    if (typeof globalThis !== 'undefined') pushScope(globalThis);\n    if (typeof window !== 'undefined') pushScope(window);\n    if (typeof self !== 'undefined') pushScope(self);\n    if (typeof global !== 'undefined') pushScope(global);\n\n    for (let index = 0; index < additionalScopes.length; index += 1) {\n      pushScope(additionalScopes[index]);\n    }\n\n    return scopes;\n  }\n\n  const tryRequireImpl = tryRequireOverride\n    ? function tryRequireWithOverride(modulePath) {\n      try {\n        return tryRequireOverride(modulePath);\n      } catch (error) {\n        void error;\n      }\n      return tryRequire(modulePath);\n    }\n    : tryRequire;\n\n  let activeImmutability = null;\n\n  function resolveImmutability(scope) {\n    try {\n      const required = tryRequireImpl('./immutability.js');\n      if (required && typeof required === 'object') {\n        activeImmutability = required;\n        return required;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    const scopes = collectCandidateScopes(scope);\n    for (let index = 0; index < scopes.length; index += 1) {\n      const candidate = scopes[index];\n      if (candidate && typeof candidate.cineModuleImmutability === 'object') {\n        activeImmutability = candidate.cineModuleImmutability;\n        return activeImmutability;\n      }\n    }\n\n    return null;\n  }\n\n  function getImmutability(scope) {\n    if (activeImmutability && activeImmutability !== FALLBACK_IMMUTABILITY) {\n      return activeImmutability;\n    }\n\n    const resolved = resolveImmutability(scope || getPrimaryScope());\n    if (resolved && resolved !== activeImmutability) {\n      activeImmutability = resolved;\n      return resolved;\n    }\n\n    activeImmutability = FALLBACK_IMMUTABILITY;\n    return activeImmutability;\n  }\n\n  function freezeDeep(value, seen) {\n    if (freezeOverride) {\n      try {\n        return freezeOverride(value, seen);\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const provider = getImmutability();\n    try {\n      return provider.freezeDeep(value, seen);\n    } catch (error) {\n      void error;\n    }\n\n    return FALLBACK_IMMUTABILITY.freezeDeep(value, seen);\n  }\n\n  function ensureQueue(scope, key) {\n    const queueKey = typeof key === 'string' && key ? key : pendingQueueKey;\n    return fallbackEnsureQueue(scope || getPrimaryScope(), queueKey);\n  }\n\n  function resolveFromScopesInternal(propertyName, resolveOptions) {\n    if (resolveOverride) {\n      try {\n        return resolveOverride(propertyName, resolveOptions);\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const optionsToUse = cloneOptions(resolveOptions);\n    if (!optionsToUse.scopes) {\n      optionsToUse.scopes = collectCandidateScopes(optionsToUse.primaryScope);\n    }\n    return resolveFromScopes(propertyName, optionsToUse);\n  }\n\n  function safeWarn(message, detail) {\n    if (warnOverride) {\n      try {\n        warnOverride(message, detail);\n        return;\n      } catch (error) {\n        void error;\n      }\n    }\n    fallbackSafeWarn(message, detail);\n  }\n\n  return Object.freeze({\n    detectGlobalScope: detectPrimaryScope,\n    getPrimaryScope,\n    collectCandidateScopes,\n    tryRequire: tryRequireImpl,\n    resolveFromScopes: resolveFromScopesInternal,\n    defineHiddenProperty,\n    ensureQueue,\n    freezeDeep,\n    safeWarn,\n  });\n}\n\nconst ARCHITECTURE_CORE = resolveArchitectureCore(detectGlobalScope());\nconst CORE_FACTORY = ARCHITECTURE_CORE && typeof ARCHITECTURE_CORE.createCore === 'function'\n  ? ARCHITECTURE_CORE.createCore\n  : createFallbackCore;\n\nfunction instantiateCore(options) {\n  const fallbackInstance = createFallbackCore(options);\n\n  if (!CORE_FACTORY || typeof CORE_FACTORY !== 'function') {\n    return {\n      primary: fallbackInstance,\n      fallback: fallbackInstance,\n    };\n  }\n\n  try {\n    const instance = CORE_FACTORY(options || {});\n    if (instance && typeof instance === 'object') {\n      return {\n        primary: instance,\n        fallback: fallbackInstance,\n      };\n    }\n  } catch (error) {\n    fallbackSafeWarn('cineModuleArchitecture: core factory failed; using fallback core.', error);\n  }\n\n  return {\n    primary: fallbackInstance,\n    fallback: fallbackInstance,\n  };\n}\n\nfunction wrapMethod(primaryCore, fallbackCore, methodName, fallbackImpl, warn) {\n  const primaryFn =\n    primaryCore && typeof primaryCore[methodName] === 'function' ? primaryCore[methodName] : null;\n  const fallbackFn =\n    fallbackCore && typeof fallbackCore[methodName] === 'function' ? fallbackCore[methodName] : null;\n  const ultimateFallback = typeof fallbackImpl === 'function' ? fallbackImpl : null;\n\n  const shouldSuppressWarning = (error) => {\n    if (!error || typeof error.message !== 'string') {\n      return false;\n    }\n    if (error.message.includes('trap returned extra keys but proxy target is non-extensible')) {\n      return true;\n    }\n    if (error.message.includes('Cannot freeze')) {\n      return true;\n    }\n    return false;\n  };\n\n  return function wrappedMethod() {\n    const args = arguments;\n\n    if (primaryFn) {\n      try {\n        return primaryFn.apply(primaryCore, args);\n      } catch (error) {\n        if (typeof warn === 'function') {\n          try {\n            if (!shouldSuppressWarning(error)) {\n              warn('cineModuleArchitecture.' + methodName + ': primary implementation failed, using fallback.', error);\n            }\n          } catch (warnError) {\n            void warnError;\n          }\n        }\n      }\n    }\n\n    if (fallbackFn) {\n      return fallbackFn.apply(fallbackCore, args);\n    }\n\n    if (ultimateFallback) {\n      return ultimateFallback.apply(null, args);\n    }\n\n    return undefined;\n  };\n}\n\nfunction createArchitectureInstance(options) {\n  const instances = instantiateCore(options || {});\n  const primaryCore = instances.primary;\n  const fallbackCore = instances.fallback;\n\n  const safeWarn = wrapMethod(primaryCore, fallbackCore, 'safeWarn', fallbackSafeWarn, null);\n\n  function wrap(methodName, fallbackImpl) {\n    return wrapMethod(primaryCore, fallbackCore, methodName, fallbackImpl, safeWarn);\n  }\n\n  const detectGlobalScopeFn = wrap('detectGlobalScope', baseDetectGlobalScope);\n  const getPrimaryScope = wrap('getPrimaryScope', function defaultGetPrimaryScope() {\n    return detectGlobalScopeFn();\n  });\n  const collectCandidateScopesFn = wrap('collectCandidateScopes', function collectWithFallback(primary) {\n    const target = primary || getPrimaryScope();\n    return collectCandidateScopes(target);\n  });\n  const tryRequireFn = wrap('tryRequire', tryRequire);\n  const resolveFromScopesFn = wrap('resolveFromScopes', function resolveWithFallback(propertyName, resolveOptions) {\n    const optionsToUse = cloneOptions(resolveOptions);\n    if (!optionsToUse.scopes) {\n      optionsToUse.scopes = collectCandidateScopesFn(optionsToUse.primaryScope);\n    }\n    return resolveFromScopes(propertyName, optionsToUse);\n  });\n  const defineHiddenPropertyFn = wrap('defineHiddenProperty', defineHiddenProperty);\n  const ensureQueueFn = wrap('ensureQueue', function ensureQueueWithFallback(scope, key) {\n    const scopeToUse = scope || getPrimaryScope();\n    return fallbackEnsureQueue(scopeToUse, key);\n  });\n  const freezeDeepFn = wrap('freezeDeep', function freezeDeepWithFallback(value, seen) {\n    return FALLBACK_IMMUTABILITY.freezeDeep(value, seen);\n  });\n\n  return Object.freeze({\n    detectGlobalScope: detectGlobalScopeFn,\n    getPrimaryScope,\n    collectCandidateScopes: collectCandidateScopesFn,\n    tryRequire: tryRequireFn,\n    resolveFromScopes: resolveFromScopesFn,\n    defineHiddenProperty: defineHiddenPropertyFn,\n    ensureQueue: ensureQueueFn,\n    freezeDeep: freezeDeepFn,\n    safeWarn,\n  });\n}\n\nconst defaultInstance = createArchitectureInstance({});\n\nconst architecture = Object.freeze({\n  detectGlobalScope: defaultInstance.detectGlobalScope,\n  collectCandidateScopes: defaultInstance.collectCandidateScopes,\n  tryRequire: defaultInstance.tryRequire,\n  resolveFromScopes: defaultInstance.resolveFromScopes,\n  defineHiddenProperty: defaultInstance.defineHiddenProperty,\n  ensureQueue: defaultInstance.ensureQueue,\n  freezeDeep: defaultInstance.freezeDeep,\n  safeWarn: defaultInstance.safeWarn,\n});\n\nfunction createModuleArchitecture(options) {\n  const settings = options || {};\n\n  const customPrimaryScope =\n    (settings && (settings.primaryScope || settings.scope)) &&\n    (typeof settings.primaryScope === 'object' || typeof settings.primaryScope === 'function'\n      ? settings.primaryScope\n      : typeof settings.scope === 'object' || typeof settings.scope === 'function'\n        ? settings.scope\n        : null);\n\n  const detectOverride = typeof settings.detectGlobalScope === 'function'\n    ? settings.detectGlobalScope\n    : function detectOverride() {\n      return customPrimaryScope || defaultInstance.detectGlobalScope();\n    };\n\n  const additionalScopes = Array.isArray(settings.additionalScopes)\n    ? settings.additionalScopes.filter(function isObjectLike(value) {\n      return value && (typeof value === 'object' || typeof value === 'function');\n    })\n    : [];\n\n  const tryRequireOverride = typeof settings.tryRequire === 'function' ? settings.tryRequire : defaultInstance.tryRequire;\n  const resolveOverride = typeof settings.resolveFromScopes === 'function' ? settings.resolveFromScopes : null;\n  const ensureQueueDefaultKey =\n    typeof settings.pendingQueueKey === 'string' && settings.pendingQueueKey\n      ? settings.pendingQueueKey\n      : DEFAULT_PENDING_QUEUE_KEY;\n  const freezeOverride = typeof settings.freezeDeep === 'function' ? settings.freezeDeep : defaultInstance.freezeDeep;\n  const warnOverride = typeof settings.safeWarn === 'function' ? settings.safeWarn : defaultInstance.safeWarn;\n\n  const instance = createArchitectureInstance({\n    primaryScope: customPrimaryScope,\n    detectGlobalScope: detectOverride,\n    additionalScopes,\n    tryRequire: tryRequireOverride,\n    resolveFromScopes: resolveOverride,\n    pendingQueueKey: ensureQueueDefaultKey,\n    freezeDeep: freezeOverride,\n    safeWarn: warnOverride,\n  });\n\n  return Object.freeze({\n    detectGlobalScope: instance.detectGlobalScope,\n    collectCandidateScopes: instance.collectCandidateScopes,\n    tryRequire: instance.tryRequire,\n    resolveFromScopes: instance.resolveFromScopes,\n    defineHiddenProperty: instance.defineHiddenProperty,\n    ensureQueue: instance.ensureQueue,\n    freezeDeep: instance.freezeDeep,\n    safeWarn: instance.safeWarn,\n  });\n}\n\nconst architectureWithFactory = Object.freeze({\n  ...architecture,\n  createModuleArchitecture,\n});\n\nconst globalScope = defaultInstance.getPrimaryScope\n  ? defaultInstance.getPrimaryScope()\n  : defaultInstance.detectGlobalScope();\n\nif (globalScope && typeof globalScope === 'object' && !globalScope.cineModuleArchitecture) {\n  architecture.defineHiddenProperty(globalScope, 'cineModuleArchitecture', architectureWithFactory);\n}\n\nif (globalScope && typeof globalScope === 'object' && !globalScope.cineModuleArchitectureFactory) {\n  architecture.defineHiddenProperty(globalScope, 'cineModuleArchitectureFactory', Object.freeze({\n    createModuleArchitecture,\n  }));\n}\n\n// if (typeof module !== 'undefined' && module && module.exports) {\n//   module.exports = architectureWithFactory;\n// }\n// })();\nexport const cineModuleArchitecture = architectureWithFactory;\n\n","const runtimeModule = (function () {\n  // ESM specific context adjustments if needed\n  const globalThis = typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : (typeof global !== 'undefined' ? global : {}));\n  // (function () {\n  function detectHelperScope() {\n    if (typeof globalThis !== 'undefined') {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n      return window;\n    }\n    if (typeof self !== 'undefined') {\n      return self;\n    }\n    if (typeof global !== 'undefined') {\n      return global;\n    }\n    return null;\n  }\n\n  function resolveRuntimeEnvironmentHelpers() {\n    if (typeof require === 'function') {\n      try {\n        const required = require('./runtime-environment-helpers.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const candidates = [];\n    function pushCandidate(scope) {\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        return;\n      }\n      if (candidates.indexOf(scope) === -1) {\n        candidates.push(scope);\n      }\n    }\n\n    const primary = detectHelperScope();\n    pushCandidate(primary);\n    if (typeof globalThis !== 'undefined') pushCandidate(globalThis);\n    if (typeof window !== 'undefined') pushCandidate(window);\n    if (typeof self !== 'undefined') pushCandidate(self);\n    if (typeof global !== 'undefined') pushCandidate(global);\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      try {\n        const helpers = candidate && candidate.cineRuntimeEnvironmentHelpers;\n        if (helpers && typeof helpers === 'object') {\n          return helpers;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return null;\n  }\n\n\n\n  /**\n   * DEEP DIVE: The \"Runtime Guard\" Pattern\n   *\n   * The Runtime module acts as the \"final safety net\" for the application.\n   * It wraps critical operations (like module loading and initialization) in\n   * error boundaries to prevent a single failing script from crashing the entire app.\n   *\n   * Key Responsibilities:\n   * 1. SCOPE ABSTRACTION: It doesn't trust `window` or `global` directly.\n   * 2. HELPER RESOLUTION: It dynamically finds helper functions (`cineRuntimeEnvironmentHelpers`)\n   *    injected by the bootloader.\n   * 3. CRASH MITIGATION: If a helper fails, it falls back to safe defaults rather than throwing.\n   */\n  const RUNTIME_ENVIRONMENT_HELPERS = resolveRuntimeEnvironmentHelpers();\n\n  function invokeEnvironmentHelper(helperName, args, fallback) {\n    if (\n      RUNTIME_ENVIRONMENT_HELPERS &&\n      helperName &&\n      typeof RUNTIME_ENVIRONMENT_HELPERS[helperName] === 'function'\n    ) {\n      try {\n        const result = RUNTIME_ENVIRONMENT_HELPERS[helperName].apply(\n          RUNTIME_ENVIRONMENT_HELPERS,\n          Array.isArray(args) ? args : []\n        );\n        if (typeof result !== 'undefined') {\n          return result;\n        }\n      } catch (helperInvocationError) {\n        void helperInvocationError;\n      }\n    }\n\n    if (typeof fallback === 'function') {\n      return fallback();\n    }\n\n    return undefined;\n  }\n\n  function fallbackDetectGlobalScope() {\n    if (\n      RUNTIME_ENVIRONMENT_HELPERS &&\n      typeof RUNTIME_ENVIRONMENT_HELPERS.fallbackDetectGlobalScope === 'function'\n    ) {\n      try {\n        const detected = RUNTIME_ENVIRONMENT_HELPERS.fallbackDetectGlobalScope();\n        if (detected) {\n          return detected;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    if (typeof globalThis !== 'undefined') {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n      return window;\n    }\n    if (typeof self !== 'undefined') {\n      return self;\n    }\n    if (typeof global !== 'undefined') {\n      return global;\n    }\n    return {};\n  }\n\n  function fallbackCollectCandidateScopes(primary) {\n    if (\n      RUNTIME_ENVIRONMENT_HELPERS &&\n      typeof RUNTIME_ENVIRONMENT_HELPERS.fallbackCollectCandidateScopes === 'function'\n    ) {\n      try {\n        const scoped = RUNTIME_ENVIRONMENT_HELPERS.fallbackCollectCandidateScopes(primary);\n        if (Array.isArray(scoped)) {\n          return scoped;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    const scopes = [];\n\n    function pushScope(scope) {\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        return;\n      }\n      if (scopes.indexOf(scope) === -1) {\n        scopes.push(scope);\n      }\n    }\n\n    pushScope(primary);\n    if (typeof globalThis !== 'undefined') pushScope(globalThis);\n    if (typeof window !== 'undefined') pushScope(window);\n    if (typeof self !== 'undefined') pushScope(self);\n    if (typeof global !== 'undefined') pushScope(global);\n\n    return scopes;\n  }\n\n  function fallbackLoadModuleEnvironment(scope) {\n    return invokeEnvironmentHelper(\n      'fallbackLoadModuleEnvironment',\n      [scope],\n      function localFallback() {\n        const required = fallbackTryRequire('./environment.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        const candidates = fallbackCollectCandidateScopes(scope);\n\n        for (let index = 0; index < candidates.length; index += 1) {\n          const candidate = candidates[index];\n          if (candidate && typeof candidate.cineModuleEnvironment === 'object') {\n            return candidate.cineModuleEnvironment;\n          }\n        }\n\n        return null;\n      }\n    );\n  }\n\n  function fallbackLoadEnvironmentBridge(scope) {\n    return invokeEnvironmentHelper(\n      'fallbackLoadEnvironmentBridge',\n      [scope],\n      function localFallback() {\n        const required = fallbackTryRequire('./environment-bridge.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        const candidates = fallbackCollectCandidateScopes(scope);\n\n        for (let index = 0; index < candidates.length; index += 1) {\n          const candidate = candidates[index];\n          if (candidate && typeof candidate.cineEnvironmentBridge === 'object') {\n            return candidate.cineEnvironmentBridge;\n          }\n        }\n\n        return null;\n      }\n    );\n  }\n\n  function fallbackResolveModuleGlobals(scope) {\n    return invokeEnvironmentHelper(\n      'fallbackResolveModuleGlobals',\n      [scope],\n      function localFallback() {\n        const required = fallbackTryRequire('./globals.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        const candidates = fallbackCollectCandidateScopes(scope);\n\n        for (let index = 0; index < candidates.length; index += 1) {\n          const candidate = candidates[index];\n          if (candidate && typeof candidate.cineModuleGlobals === 'object') {\n            return candidate.cineModuleGlobals;\n          }\n        }\n\n        return null;\n      }\n    );\n  }\n\n  function fallbackTryRequire(modulePath) {\n    return invokeEnvironmentHelper(\n      'fallbackTryRequire',\n      [modulePath],\n      function localFallback() {\n        if (typeof require !== 'function') {\n          return null;\n        }\n\n        try {\n          return require(modulePath);\n        } catch (error) {\n          void error;\n          return null;\n        }\n      }\n    );\n  }\n\n  function resolveModuleLinker(scope) {\n    return invokeEnvironmentHelper(\n      'resolveModuleLinker',\n      [scope],\n      function localFallback() {\n        const required = fallbackTryRequire('./helpers/module-linker.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        const candidates = fallbackCollectCandidateScopes(scope);\n\n        for (let index = 0; index < candidates.length; index += 1) {\n          const candidate = candidates[index];\n          try {\n            const linker = candidate && candidate.cineModuleLinker;\n            if (linker && typeof linker === 'object') {\n              return linker;\n            }\n          } catch (error) {\n            void error;\n          }\n        }\n\n        return null;\n      }\n    );\n  }\n\n  const LOCAL_SCOPE = fallbackDetectGlobalScope();\n\n  const MODULE_LINKER = resolveModuleLinker(LOCAL_SCOPE);\n\n  function resolveModuleSystem(scope) {\n    return invokeEnvironmentHelper(\n      'resolveModuleSystem',\n      [scope],\n      function localFallback() {\n        const targetScope = scope || LOCAL_SCOPE;\n\n        const required = fallbackTryRequire('./system.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        if (targetScope && typeof targetScope.cineModuleSystem === 'object') {\n          return targetScope.cineModuleSystem;\n        }\n\n        return null;\n      }\n    );\n  }\n\n  const MODULE_SYSTEM = resolveModuleSystem(LOCAL_SCOPE);\n\n  function resolveEnvironmentContext(scope) {\n    return invokeEnvironmentHelper(\n      'resolveEnvironmentContext',\n      [scope || LOCAL_SCOPE],\n      function localFallback() {\n        const targetScope = scope || LOCAL_SCOPE;\n        const required = fallbackTryRequire('./environment-context.js');\n\n        if (required && typeof required === 'object') {\n          return required;\n        }\n\n        if (targetScope && typeof targetScope.cineModuleEnvironmentContext === 'object') {\n          return targetScope.cineModuleEnvironmentContext;\n        }\n\n        return null;\n      }\n    );\n  }\n\n  const ENVIRONMENT_CONTEXT = resolveEnvironmentContext(LOCAL_SCOPE);\n\n  function detectWithContext() {\n    if (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.detectGlobalScope === 'function') {\n      try {\n        const detected = ENVIRONMENT_CONTEXT.detectGlobalScope();\n        if (detected) {\n          return detected;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    return fallbackDetectGlobalScope();\n  }\n\n  const detectGlobalScope =\n    MODULE_SYSTEM && typeof MODULE_SYSTEM.detectGlobalScope === 'function'\n      ? function detectWithSystem() {\n        try {\n          const detected = MODULE_SYSTEM.detectGlobalScope();\n          if (detected) {\n            return detected;\n          }\n        } catch (error) {\n          void error;\n        }\n        return detectWithContext();\n      }\n      : detectWithContext;\n\n  const PRIMARY_SCOPE =\n    (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.getPrimaryScope === 'function'\n      ? ENVIRONMENT_CONTEXT.getPrimaryScope()\n      : null)\n    || detectGlobalScope();\n\n  const GLOBAL_SCOPE = (function resolveGlobalScope() {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getGlobalScope === 'function') {\n      try {\n        const resolved = MODULE_SYSTEM.getGlobalScope(PRIMARY_SCOPE);\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.getGlobalScope === 'function') {\n      try {\n        const scoped = ENVIRONMENT_CONTEXT.getGlobalScope(PRIMARY_SCOPE);\n        if (scoped) {\n          return scoped;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return PRIMARY_SCOPE;\n  })();\n\n  const CANDIDATE_SCOPES_CACHE = typeof WeakMap === 'function' ? new WeakMap() : null;\n\n  function collectCandidateScopes(scope) {\n    const targetScope = scope || GLOBAL_SCOPE;\n    const eligibleForCache =\n      !!CANDIDATE_SCOPES_CACHE &&\n      targetScope &&\n      (typeof targetScope === 'object' || typeof targetScope === 'function');\n\n    if (eligibleForCache) {\n      try {\n        const cached = CANDIDATE_SCOPES_CACHE.get(targetScope);\n        if (cached && Array.isArray(cached) && cached.length > 0) {\n          return cached.slice();\n        }\n      } catch (cacheReadError) {\n        void cacheReadError;\n      }\n    }\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.collectCandidateScopes === 'function') {\n      try {\n        const scopes = MODULE_SYSTEM.collectCandidateScopes(targetScope);\n        if (Array.isArray(scopes) && scopes.length > 0) {\n          const result = scopes.slice();\n          if (eligibleForCache) {\n            try {\n              const toCache = typeof Object.freeze === 'function' ? Object.freeze(result.slice()) : result.slice();\n              CANDIDATE_SCOPES_CACHE.set(targetScope, toCache);\n            } catch (cacheWriteError) {\n              void cacheWriteError;\n            }\n          }\n          return result;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.collectCandidateScopes === 'function') {\n      try {\n        const fromContext = ENVIRONMENT_CONTEXT.collectCandidateScopes(targetScope);\n        if (Array.isArray(fromContext) && fromContext.length > 0) {\n          const result = fromContext.slice();\n          if (eligibleForCache) {\n            try {\n              const toCache = typeof Object.freeze === 'function' ? Object.freeze(result.slice()) : result.slice();\n              CANDIDATE_SCOPES_CACHE.set(targetScope, toCache);\n            } catch (cacheWriteError) {\n              void cacheWriteError;\n            }\n          }\n          return result;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const fallbackScopes = fallbackCollectCandidateScopes(targetScope);\n    const result = Array.isArray(fallbackScopes) ? fallbackScopes.slice() : [];\n    if (eligibleForCache && result.length > 0) {\n      try {\n        const toCache = typeof Object.freeze === 'function' ? Object.freeze(result.slice()) : result.slice();\n        CANDIDATE_SCOPES_CACHE.set(targetScope, toCache);\n      } catch (cacheWriteError) {\n        void cacheWriteError;\n      }\n    }\n    return result;\n  }\n\n  const MODULE_ENV =\n    (MODULE_LINKER && typeof MODULE_LINKER.getModuleEnvironment === 'function'\n      ? MODULE_LINKER.getModuleEnvironment()\n      : null)\n    || (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.resolveModuleEnvironment === 'function'\n      ? ENVIRONMENT_CONTEXT.resolveModuleEnvironment(GLOBAL_SCOPE)\n      : null)\n    || fallbackLoadModuleEnvironment(GLOBAL_SCOPE);\n\n  const ENV_BRIDGE =\n    (MODULE_LINKER && typeof MODULE_LINKER.getEnvironmentBridge === 'function'\n      ? MODULE_LINKER.getEnvironmentBridge()\n      : null)\n    || (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.resolveEnvironmentBridge === 'function'\n      ? ENVIRONMENT_CONTEXT.resolveEnvironmentBridge(GLOBAL_SCOPE)\n      : null)\n    || fallbackLoadEnvironmentBridge(GLOBAL_SCOPE);\n\n  const MODULE_GLOBALS =\n    (MODULE_LINKER && typeof MODULE_LINKER.getModuleGlobals === 'function'\n      ? MODULE_LINKER.getModuleGlobals()\n      : null)\n    || (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.resolveModuleGlobals === 'function'\n      ? ENVIRONMENT_CONTEXT.resolveModuleGlobals(GLOBAL_SCOPE)\n      : null)\n    || fallbackResolveModuleGlobals(GLOBAL_SCOPE);\n\n  function informModuleGlobals(name, api) {\n    if (MODULE_LINKER && typeof MODULE_LINKER.recordModule === 'function') {\n      MODULE_LINKER.recordModule(name, api);\n    }\n\n    if (!MODULE_GLOBALS || typeof MODULE_GLOBALS.recordModule !== 'function') {\n      return;\n    }\n\n    try {\n      MODULE_GLOBALS.recordModule(name, api);\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const tryRequire = (function resolveTryRequire() {\n    if (MODULE_LINKER && typeof MODULE_LINKER.tryRequire === 'function') {\n      return MODULE_LINKER.tryRequire;\n    }\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.tryRequire === 'function') {\n      return function tryRequireWithSystem(modulePath) {\n        const result = MODULE_SYSTEM.tryRequire(modulePath);\n        return typeof result === 'undefined' ? fallbackTryRequire(modulePath) : result;\n      };\n    }\n\n    if (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.tryRequire === 'function') {\n      return function tryRequireThroughContext(modulePath) {\n        const result = ENVIRONMENT_CONTEXT.tryRequire(modulePath);\n        return typeof result === 'undefined' ? fallbackTryRequire(modulePath) : result;\n      };\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.tryRequire === 'function') {\n      return MODULE_GLOBALS.tryRequire;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.tryRequire === 'function') {\n      return function bridgeTryRequire(modulePath) {\n        const result = ENV_BRIDGE.tryRequire(modulePath);\n        return typeof result === 'undefined' ? fallbackTryRequire(modulePath) : result;\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.tryRequire === 'function') {\n      return MODULE_ENV.tryRequire;\n    }\n\n    return fallbackTryRequire;\n  })();\n\n  function fallbackResolveModuleRegistry(scope) {\n    const targetScope = scope || GLOBAL_SCOPE;\n\n    if (MODULE_LINKER && typeof MODULE_LINKER.getModuleRegistry === 'function') {\n      const linked = MODULE_LINKER.getModuleRegistry(targetScope);\n      if (linked) {\n        return linked;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.resolveModuleRegistry === 'function') {\n      try {\n        const resolved = MODULE_GLOBALS.resolveModuleRegistry(targetScope);\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getModuleRegistry === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.getModuleRegistry(targetScope);\n        if (bridged) {\n          return bridged;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.resolveModuleRegistry === 'function') {\n      try {\n        return MODULE_ENV.resolveModuleRegistry(targetScope);\n      } catch (error) {\n        void error;\n      }\n    }\n\n    const required = tryRequire('./registry.js');\n    if (required && typeof required === 'object') {\n      return required;\n    }\n\n    const scopes = collectCandidateScopes(targetScope);\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      const candidate = scopes[index];\n      if (candidate && typeof candidate.cineModules === 'object') {\n        return candidate.cineModules;\n      }\n    }\n\n    return null;\n  }\n\n  function resolveModuleRegistry(scope) {\n    const targetScope = scope || GLOBAL_SCOPE;\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getModuleRegistry === 'function') {\n      try {\n        const resolved = MODULE_SYSTEM.getModuleRegistry(targetScope);\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENVIRONMENT_CONTEXT && typeof ENVIRONMENT_CONTEXT.resolveModuleRegistry === 'function') {\n      try {\n        const resolved = ENVIRONMENT_CONTEXT.resolveModuleRegistry(targetScope);\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    return fallbackResolveModuleRegistry(targetScope);\n  }\n\n  const MODULE_REGISTRY = (function () {\n    if (MODULE_LINKER && typeof MODULE_LINKER.getModuleRegistry === 'function') {\n      const linked = MODULE_LINKER.getModuleRegistry(GLOBAL_SCOPE);\n      if (linked) {\n        return linked;\n      }\n    }\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getModuleRegistry === 'function') {\n      try {\n        const viaSystem = MODULE_SYSTEM.getModuleRegistry(GLOBAL_SCOPE);\n        if (viaSystem) {\n          return viaSystem;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.getModuleRegistry === 'function') {\n      try {\n        const shared = MODULE_GLOBALS.getModuleRegistry(GLOBAL_SCOPE);\n        if (shared) {\n          return shared;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getModuleRegistry === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.getModuleRegistry(GLOBAL_SCOPE);\n        if (bridged) {\n          return bridged;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.getModuleRegistry === 'function') {\n      try {\n        const provided = MODULE_ENV.getModuleRegistry(GLOBAL_SCOPE);\n        if (provided) {\n          return provided;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    return resolveModuleRegistry();\n  })();\n\n  const PENDING_QUEUE_KEY = (function resolvePendingKey() {\n    if (MODULE_LINKER && typeof MODULE_LINKER.getPendingQueueKey === 'function') {\n      const linkedKey = MODULE_LINKER.getPendingQueueKey();\n      if (typeof linkedKey === 'string' && linkedKey) {\n        return linkedKey;\n      }\n    }\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.getPendingQueueKey === 'function') {\n      try {\n        const systemKey = MODULE_SYSTEM.getPendingQueueKey();\n        if (typeof systemKey === 'string' && systemKey) {\n          return systemKey;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.getPendingQueueKey === 'function') {\n      try {\n        const sharedKey = MODULE_GLOBALS.getPendingQueueKey();\n        if (typeof sharedKey === 'string' && sharedKey) {\n          return sharedKey;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.getPendingQueueKey === 'function') {\n      try {\n        const bridgedKey = ENV_BRIDGE.getPendingQueueKey();\n        if (typeof bridgedKey === 'string' && bridgedKey) {\n          return bridgedKey;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.PENDING_QUEUE_KEY === 'string') {\n      return MODULE_ENV.PENDING_QUEUE_KEY;\n    }\n\n    return '__cinePendingModuleRegistrations__';\n  })();\n\n  function cloneOptions(options) {\n    if (!options || typeof options !== 'object') {\n      return {};\n    }\n\n    const copy = {};\n    const keys = Object.keys(options);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      copy[key] = options[key];\n    }\n\n    return copy;\n  }\n\n  function normalizeModuleName(name) {\n    return typeof name === 'string' ? name : '';\n  }\n\n  function removePendingQueueEntries(queue, moduleName) {\n    if (!Array.isArray(queue) || !moduleName) {\n      return;\n    }\n\n    let writeIndex = 0;\n    for (let index = 0; index < queue.length; index += 1) {\n      const entry = queue[index];\n      const entryName = entry && typeof entry.name === 'string' ? entry.name : '';\n      if (entryName !== moduleName) {\n        queue[writeIndex] = entry;\n        writeIndex += 1;\n      }\n    }\n\n    if (writeIndex < queue.length) {\n      queue.length = writeIndex;\n    }\n  }\n\n  function queueModuleRegistration(name, api, options) {\n    const moduleName = normalizeModuleName(name);\n\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.queueModuleRegistration === 'function') {\n      try {\n        if (MODULE_SYSTEM.queueModuleRegistration(moduleName || name, api, options, GLOBAL_SCOPE)) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.queueModuleRegistration === 'function') {\n      try {\n        if (MODULE_GLOBALS.queueModuleRegistration(moduleName || name, api, options, GLOBAL_SCOPE)) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.queueModuleRegistration === 'function') {\n      try {\n        const bridged = ENV_BRIDGE.queueModuleRegistration(moduleName || name, api, options);\n        if (bridged) {\n          return true;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.queueModuleRegistration === 'function') {\n      return MODULE_ENV.queueModuleRegistration(moduleName || name, api, options, GLOBAL_SCOPE);\n    }\n\n    if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n      return false;\n    }\n\n    if (!moduleName) {\n      return false;\n    }\n\n    const payload = Object.freeze({\n      name: moduleName,\n      api,\n      options: Object.freeze(cloneOptions(options)),\n    });\n\n    let queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n    if (!Array.isArray(queue)) {\n      try {\n        Object.defineProperty(GLOBAL_SCOPE, PENDING_QUEUE_KEY, {\n          configurable: true,\n          enumerable: false,\n          writable: true,\n          value: [],\n        });\n        queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n      } catch (error) {\n        void error;\n        try {\n          if (!Array.isArray(GLOBAL_SCOPE[PENDING_QUEUE_KEY])) {\n            GLOBAL_SCOPE[PENDING_QUEUE_KEY] = [];\n          }\n          queue = GLOBAL_SCOPE[PENDING_QUEUE_KEY];\n        } catch (assignmentError) {\n          void assignmentError;\n          return false;\n        }\n      }\n    }\n\n    removePendingQueueEntries(queue, moduleName);\n\n    try {\n      queue.push(payload);\n    } catch (error) {\n      void error;\n      queue[queue.length] = payload;\n    }\n\n    return true;\n  }\n\n  function attemptRegistryRegistration(name, api, options) {\n    if (!MODULE_REGISTRY || typeof MODULE_REGISTRY.register !== 'function') {\n      return { ok: false, error: null, reason: 'missing-registry' };\n    }\n\n    const moduleName = typeof name === 'string' ? name : '';\n    if (!moduleName) {\n      return { ok: false, error: new TypeError('cineRuntime expected a module name.'), reason: 'invalid-name' };\n    }\n\n    if (typeof MODULE_REGISTRY.has === 'function') {\n      try {\n        if (MODULE_REGISTRY.has(moduleName)) {\n          if (typeof MODULE_REGISTRY.get === 'function') {\n            try {\n              const existing = MODULE_REGISTRY.get(moduleName);\n              if (existing) {\n                informModuleGlobals(moduleName, existing);\n              }\n            } catch (getError) {\n              void getError;\n            }\n          }\n          return { ok: true, alreadyRegistered: true };\n        }\n      } catch (hasError) {\n        return { ok: false, error: hasError, reason: 'registry-check-failed' };\n      }\n    }\n\n    try {\n      const registered = MODULE_REGISTRY.register(moduleName, api, options);\n      informModuleGlobals(moduleName, registered || api);\n      return { ok: true, registered: true };\n    } catch (error) {\n      return { ok: false, error, reason: 'register-failed' };\n    }\n  }\n\n  function fallbackRegisterOrQueue(name, api, options, onError) {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.registerModule === 'function') {\n      const registered = MODULE_SYSTEM.registerModule(name, api, options, GLOBAL_SCOPE, onError);\n      if (registered) {\n        informModuleGlobals(name, api);\n        return true;\n      }\n      return false;\n    }\n\n    let lastError = null;\n    const directAttempt = attemptRegistryRegistration(name, api, options);\n    if (directAttempt.ok) {\n      return true;\n    }\n\n    lastError = directAttempt.error || null;\n\n    const syncResult = synchronizeModuleLinks({ warn: false });\n    if (\n      syncResult\n      && ((syncResult.flushed && syncResult.flushed.processed > 0) || syncResult.ok)\n    ) {\n      const retryAttempt = attemptRegistryRegistration(name, api, options);\n      if (retryAttempt.ok) {\n        return true;\n      }\n      if (retryAttempt.error) {\n        lastError = retryAttempt.error;\n      }\n    }\n\n    if (lastError) {\n      if (typeof onError === 'function') {\n        try {\n          onError(lastError);\n        } catch (callbackError) {\n          void callbackError;\n        }\n      } else {\n        void lastError;\n      }\n    }\n\n    queueModuleRegistration(name, api, options);\n    return false;\n  }\n\n  const registerOrQueueModule = (function resolveRegisterOrQueue() {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.registerModule === 'function') {\n      return function registerWithSystem(name, api, options, onError) {\n        const registered = MODULE_SYSTEM.registerModule(name, api, options, GLOBAL_SCOPE, onError);\n        if (registered) {\n          informModuleGlobals(name, api);\n          return true;\n        }\n        return false;\n      };\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        try {\n          const registered = MODULE_GLOBALS.registerOrQueueModule(\n            name,\n            api,\n            options,\n            onError,\n            GLOBAL_SCOPE,\n            MODULE_REGISTRY,\n          );\n          if (registered) {\n            return true;\n          }\n        } catch (error) {\n          void error;\n        }\n\n        return fallbackRegisterOrQueue(name, api, options, onError);\n      };\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        try {\n          const bridged = ENV_BRIDGE.registerOrQueueModule(name, api, options, onError, GLOBAL_SCOPE, MODULE_REGISTRY);\n          if (bridged) {\n            return true;\n          }\n        } catch (error) {\n          void error;\n        }\n\n        return fallbackRegisterOrQueue(name, api, options, onError);\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.registerOrQueueModule === 'function') {\n      return function registerOrQueueModule(name, api, options, onError) {\n        return MODULE_ENV.registerOrQueueModule(name, api, options, onError, GLOBAL_SCOPE, MODULE_REGISTRY);\n      };\n    }\n\n    return fallbackRegisterOrQueue;\n  })();\n\n\n\n  function isNodeProcessReference(value) {\n    if (!value) {\n      return false;\n    }\n\n    if (typeof process === 'undefined' || !process) {\n      return false;\n    }\n\n    if (value === process) {\n      return true;\n    }\n\n    if (typeof value === 'object') {\n      try {\n        if (value.constructor && value.constructor.name === 'process') {\n          return true;\n        }\n      } catch (processInspectionError) {\n        void processInspectionError;\n      }\n\n      if (\n        typeof value.pid === 'number' &&\n        typeof value.nextTick === 'function' &&\n        typeof value.emit === 'function' &&\n        typeof value.binding === 'function'\n      ) {\n        return true;\n      }\n    }\n\n    if (typeof value === 'function') {\n      if (\n        value === process.binding ||\n        value === process._linkedBinding ||\n        value === process.dlopen\n      ) {\n        return true;\n      }\n\n      try {\n        const functionName = value.name || '';\n        if (functionName && (functionName === 'binding' || functionName === 'dlopen')) {\n          const source = Function.prototype.toString.call(value);\n          if (source && source.indexOf('[native code]') !== -1) {\n            return true;\n          }\n        }\n      } catch (functionInspectionError) {\n        void functionInspectionError;\n      }\n    }\n\n    return false;\n  }\n\n  function shouldBypassDeepFreeze(value) {\n    if (!value || typeof value === 'function' || (typeof value !== 'object' && typeof value !== 'function')) {\n      return false;\n    }\n\n    if (isNodeProcessReference(value)) {\n      return true;\n    }\n\n    if (\n      typeof process !== 'undefined' &&\n      process &&\n      process.release &&\n      process.release.name === 'node'\n    ) {\n      return true;\n    }\n\n    try {\n      if (\n        typeof module !== 'undefined' &&\n        module &&\n        typeof module.constructor === 'function' &&\n        value instanceof module.constructor\n      ) {\n        return true;\n      }\n    } catch (moduleCheckError) {\n      void moduleCheckError;\n    }\n\n    try {\n      if (typeof value.pipe === 'function' && typeof value.unpipe === 'function') {\n        return true;\n      }\n\n      if (typeof value.on === 'function' && typeof value.emit === 'function') {\n        if (typeof value.write === 'function' || typeof value.read === 'function') {\n          return true;\n        }\n\n        const ctorName = value.constructor && value.constructor.name;\n        if (ctorName && /Stream|Emitter|Port/i.test(ctorName)) {\n          return true;\n        }\n      }\n\n      if (typeof Symbol !== 'undefined' && value[Symbol.toStringTag]) {\n        const tag = value[Symbol.toStringTag];\n        if (typeof tag === 'string' && /Stream|Port/i.test(tag)) {\n          return true;\n        }\n      }\n    } catch (inspectionError) {\n      void inspectionError;\n    }\n\n    return false;\n  }\n\n  const FULLY_FROZEN_OBJECTS = typeof WeakSet === 'function' ? new WeakSet() : null;\n\n  function fallbackResolveSeenTracker(seen) {\n    if (seen && typeof seen.has === 'function' && typeof seen.add === 'function') {\n      return seen;\n    }\n\n    if (Array.isArray(seen)) {\n      return {\n        has(value) {\n          return seen.indexOf(value) !== -1;\n        },\n        add(value) {\n          if (seen.indexOf(value) === -1) {\n            seen.push(value);\n          }\n        },\n      };\n    }\n\n    if (typeof WeakSet === 'function') {\n      try {\n        return new WeakSet();\n      } catch (trackerError) {\n        void trackerError;\n      }\n    }\n\n    const tracked = [];\n    return {\n      has(value) {\n        return tracked.indexOf(value) !== -1;\n      },\n      add(value) {\n        if (tracked.indexOf(value) === -1) {\n          tracked.push(value);\n        }\n      },\n    };\n  }\n\n  function fallbackFreezeDeep(value, seen) {\n    if (!value || typeof value !== 'object') {\n      return value;\n    }\n\n    if (shouldBypassDeepFreeze(value)) {\n      return value;\n    }\n\n    if (typeof process !== 'undefined' && process && process.env && process.env.JEST_WORKER_ID) {\n      try {\n        if (typeof Object.freeze === 'function') {\n          Object.freeze(value);\n        }\n      } catch (freezeError) {\n        void freezeError;\n      }\n      return value;\n    }\n\n    if (FULLY_FROZEN_OBJECTS && FULLY_FROZEN_OBJECTS.has(value)) {\n      return value;\n    }\n\n    const tracker = fallbackResolveSeenTracker(seen);\n\n    if (tracker.has(value)) {\n      return value;\n    }\n\n    tracker.add(value);\n\n    let alreadyFrozen = false;\n    if (typeof Object.isFrozen === 'function') {\n      try {\n        alreadyFrozen = Object.isFrozen(value);\n      } catch (inspectionError) {\n        void inspectionError;\n        alreadyFrozen = false;\n      }\n    }\n\n    let keys = [];\n    try {\n      keys = Object.getOwnPropertyNames(value);\n    } catch (inspectionError) {\n      void inspectionError;\n      if (typeof Reflect !== 'undefined' && typeof Reflect.ownKeys === 'function') {\n        try {\n          keys = Reflect.ownKeys(value).filter(function filterStringKeys(key) {\n            return typeof key === 'string';\n          });\n        } catch (reflectError) {\n          void reflectError;\n          keys = [];\n        }\n      }\n    }\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      if (key === 'web3' && value === GLOBAL_SCOPE) {\n        // Touching the deprecated MetaMask web3 shim triggers warning logs; skip it while\n        // preserving the freeze behavior for the remaining global properties.\n        continue;\n      }\n\n      let hasOwn = true;\n      try {\n        hasOwn = Object.prototype.hasOwnProperty.call(value, key);\n      } catch (hasOwnError) {\n        void hasOwnError;\n        hasOwn = true;\n      }\n      if (!hasOwn) {\n        continue;\n      }\n\n      let child;\n      try {\n        child = value[key];\n      } catch (accessError) {\n        void accessError;\n        child = undefined;\n      }\n\n      if (!child || typeof child === 'function' || (typeof child !== 'object' && typeof child !== 'function')) {\n        continue;\n      }\n\n      try {\n        fallbackFreezeDeep(child, tracker);\n      } catch (childError) {\n        void childError;\n      }\n    }\n\n    if (alreadyFrozen) {\n      if (FULLY_FROZEN_OBJECTS) {\n        try {\n          FULLY_FROZEN_OBJECTS.add(value);\n        } catch (cacheError) {\n          void cacheError;\n        }\n      }\n      return value;\n    }\n\n    try {\n      const frozen = Object.freeze(value);\n      if (FULLY_FROZEN_OBJECTS) {\n        try {\n          FULLY_FROZEN_OBJECTS.add(frozen || value);\n        } catch (cacheError) {\n          void cacheError;\n        }\n      }\n      return frozen;\n    } catch (freezeError) {\n      void freezeError;\n      return value;\n    }\n  }\n\n  const freezeDeep = (function resolveFreezeDeep() {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.freezeDeep === 'function') {\n      return MODULE_SYSTEM.freezeDeep;\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.freezeDeep === 'function') {\n      return MODULE_GLOBALS.freezeDeep;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.freezeDeep === 'function') {\n      return function bridgeFreezeDeep(value, seen) {\n        try {\n          return ENV_BRIDGE.freezeDeep(value, seen);\n        } catch (error) {\n          void error;\n          return fallbackFreezeDeep(value, seen);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.freezeDeep === 'function') {\n      return MODULE_ENV.freezeDeep;\n    }\n\n    return fallbackFreezeDeep;\n  })();\n\n  function enforceShallowFreeze(target) {\n    if (!target || (typeof target !== 'object' && typeof target !== 'function')) {\n      return target;\n    }\n\n    try {\n      if (typeof Object.preventExtensions === 'function') {\n        Object.preventExtensions(target);\n      }\n    } catch (preventError) {\n      void preventError;\n    }\n\n    try {\n      if (typeof Object.seal === 'function') {\n        Object.seal(target);\n      }\n    } catch (sealError) {\n      void sealError;\n    }\n\n    const keys = [];\n\n    try {\n      const ownNames = Object.getOwnPropertyNames(target);\n      for (let index = 0; index < ownNames.length; index += 1) {\n        keys.push(ownNames[index]);\n      }\n    } catch (nameError) {\n      void nameError;\n    }\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      try {\n        const symbols = Object.getOwnPropertySymbols(target);\n        for (let index = 0; index < symbols.length; index += 1) {\n          keys.push(symbols[index]);\n        }\n      } catch (symbolError) {\n        void symbolError;\n      }\n    }\n\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n\n      let descriptor;\n      try {\n        descriptor = Object.getOwnPropertyDescriptor(target, key);\n      } catch (descriptorError) {\n        void descriptorError;\n        descriptor = null;\n      }\n\n      if (!descriptor) {\n        continue;\n      }\n\n      const requiresLock =\n        descriptor.configurable === true ||\n        ('writable' in descriptor && descriptor.writable === true);\n\n      if (!requiresLock) {\n        continue;\n      }\n\n      const nextDescriptor = {\n        configurable: false,\n        enumerable: !!descriptor.enumerable,\n      };\n\n      if (Object.prototype.hasOwnProperty.call(descriptor, 'value')) {\n        nextDescriptor.value = descriptor.value;\n        nextDescriptor.writable = false;\n      } else {\n        nextDescriptor.get = descriptor.get;\n        nextDescriptor.set = descriptor.set;\n      }\n\n      try {\n        Object.defineProperty(target, key, nextDescriptor);\n      } catch (defineError) {\n        void defineError;\n      }\n    }\n\n    return target;\n  }\n\n  function ensureDeepFrozen(value) {\n    const frozen = freezeDeep(value);\n    if (Object.isFrozen(frozen)) {\n      return frozen;\n    }\n\n    try {\n      const result = Object.freeze(frozen);\n      if (Object.isFrozen(result)) {\n        return result;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    enforceShallowFreeze(frozen);\n    return frozen;\n  }\n\n  function fallbackSafeWarn(message, detail) {\n    if (typeof console === 'undefined' || typeof console.warn !== 'function') {\n      return;\n    }\n\n    try {\n      if (typeof detail === 'undefined') {\n        console.warn(message);\n      } else {\n        console.warn(message, detail);\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const safeWarn = (function resolveSafeWarn() {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.safeWarn === 'function') {\n      return MODULE_SYSTEM.safeWarn;\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.safeWarn === 'function') {\n      return MODULE_GLOBALS.safeWarn;\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.safeWarn === 'function') {\n      return function bridgeSafeWarn(message, detail) {\n        try {\n          ENV_BRIDGE.safeWarn(message, detail);\n        } catch (error) {\n          void error;\n          fallbackSafeWarn(message, detail);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.safeWarn === 'function') {\n      return MODULE_ENV.safeWarn;\n    }\n\n    return fallbackSafeWarn;\n  })();\n\n  function ensureRegistryBinding(scope, registry) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return { ok: false, reason: 'invalid-scope' };\n    }\n\n    const targetRegistry = registry || MODULE_REGISTRY;\n    if (!targetRegistry) {\n      return { ok: false, reason: 'missing-registry' };\n    }\n\n    try {\n      const existing = scope.cineModules;\n      if (existing === targetRegistry) {\n        return { ok: true, already: true };\n      }\n\n      Object.defineProperty(scope, 'cineModules', {\n        configurable: true,\n        enumerable: false,\n        value: targetRegistry,\n        writable: true,\n      });\n      return { ok: true, updated: true };\n    } catch (defineError) {\n      void defineError;\n      try {\n        scope.cineModules = targetRegistry;\n        if (scope.cineModules === targetRegistry) {\n          return { ok: true, updated: true };\n        }\n      } catch (assignmentError) {\n        void assignmentError;\n        return { ok: false, reason: 'expose-failed', error: assignmentError || defineError };\n      }\n    }\n\n    return { ok: true, updated: true };\n  }\n\n  function getPendingQueueFromScope(scope, queueKey) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return null;\n    }\n\n    try {\n      const queue = scope[queueKey];\n      return Array.isArray(queue) ? queue : null;\n    } catch (error) {\n      void error;\n      return null;\n    }\n  }\n\n  function requeuePendingEntry(queue, entry) {\n    if (!Array.isArray(queue)) {\n      return;\n    }\n\n    const moduleName = entry && typeof entry.name === 'string' ? entry.name : '';\n    if (moduleName) {\n      removePendingQueueEntries(queue, moduleName);\n    }\n\n    try {\n      queue.push(entry);\n    } catch (error) {\n      void error;\n      queue[queue.length] = entry;\n    }\n  }\n\n  function flushPendingModuleQueues(options = {}) {\n    const registry = options.registry || MODULE_REGISTRY;\n    const queueKey = typeof options.queueKey === 'string' && options.queueKey\n      ? options.queueKey\n      : PENDING_QUEUE_KEY;\n\n    if (!registry || typeof registry.register !== 'function') {\n      return ensureDeepFrozen({\n        ok: false,\n        processed: 0,\n        requeued: 0,\n        scopes: 0,\n        queueKey,\n        failures: ensureDeepFrozen([{ reason: 'missing-registry' }]),\n      });\n    }\n\n    const scopes = Array.isArray(options.scopes) && options.scopes.length > 0\n      ? options.scopes.slice()\n      : collectCandidateScopes(options.scope || GLOBAL_SCOPE);\n\n    let processed = 0;\n    let requeued = 0;\n    let touchedScopes = 0;\n    const failures = [];\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      const scope = scopes[index];\n      const queue = getPendingQueueFromScope(scope, queueKey);\n      if (!queue || queue.length === 0) {\n        continue;\n      }\n\n      touchedScopes += 1;\n      const pending = queue.slice();\n      queue.length = 0;\n\n      for (let entryIndex = 0; entryIndex < pending.length; entryIndex += 1) {\n        const entry = pending[entryIndex];\n        if (!entry || typeof entry !== 'object') {\n          continue;\n        }\n\n        const name = typeof entry.name === 'string' ? entry.name : '';\n        if (!name) {\n          continue;\n        }\n\n        const api = entry.api;\n        const entryOptions = cloneOptions(entry.options);\n\n        if (typeof registry.has === 'function') {\n          let alreadyRegistered = false;\n          try {\n            alreadyRegistered = registry.has(name);\n          } catch (hasError) {\n            failures.push({\n              name,\n              message: hasError && typeof hasError.message === 'string' ? hasError.message : null,\n              reason: 'has-check-failed',\n              scopeIndex: index,\n            });\n          }\n\n          if (alreadyRegistered) {\n            processed += 1;\n            continue;\n          }\n        }\n\n        try {\n          const registered = registry.register(name, api, entryOptions);\n          informModuleGlobals(name, registered || api);\n          processed += 1;\n        } catch (error) {\n          requeued += 1;\n          requeuePendingEntry(queue, entry);\n          failures.push({\n            name,\n            message: error && typeof error.message === 'string' ? error.message : null,\n            reason: 'register-failed',\n            scopeIndex: index,\n          });\n        }\n      }\n    }\n\n    if (failures.length > 0 && options.warn) {\n      safeWarn(\n        'cineRuntime.flushPendingModuleQueues() encountered issues while replaying module registrations.',\n        failures,\n      );\n    }\n\n    return ensureDeepFrozen({\n      ok: failures.length === 0,\n      processed,\n      requeued,\n      scopes: touchedScopes,\n      queueKey,\n      failures: failures.length > 0 ? ensureDeepFrozen(failures) : ensureDeepFrozen([]),\n    });\n  }\n\n  function synchronizeModuleLinks(options = {}) {\n    const registry = options.registry || MODULE_REGISTRY;\n    const queueKey = typeof options.queueKey === 'string' && options.queueKey\n      ? options.queueKey\n      : PENDING_QUEUE_KEY;\n\n    const scopes = Array.isArray(options.scopes) && options.scopes.length > 0\n      ? options.scopes.slice()\n      : collectCandidateScopes(options.scope || GLOBAL_SCOPE);\n\n    const exposureDetails = [];\n    const exposureFailures = [];\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      const scope = scopes[index];\n      const exposure = ensureRegistryBinding(scope, registry);\n      exposureDetails.push({\n        scopeIndex: index,\n        ok: !!exposure.ok,\n        updated: !!exposure.updated,\n        already: !!exposure.already,\n        reason: typeof exposure.reason === 'string' ? exposure.reason : null,\n      });\n\n      if (!exposure.ok && exposure.reason !== 'missing-registry') {\n        exposureFailures.push({\n          scopeIndex: index,\n          reason: exposure.reason || 'expose-failed',\n          message:\n            exposure.error && typeof exposure.error.message === 'string'\n              ? exposure.error.message\n              : null,\n        });\n      }\n    }\n\n    if (exposureFailures.length > 0 && options.warn !== false) {\n      safeWarn(\n        'cineRuntime.synchronizeModuleLinks() could not expose cineModules on every scope.',\n        exposureFailures,\n      );\n    }\n\n    const flushResult = flushPendingModuleQueues({\n      registry,\n      queueKey,\n      scopes,\n      warn: options.warn !== false,\n    });\n\n    const combinedFailures = [];\n    if (Array.isArray(flushResult.failures)) {\n      for (let index = 0; index < flushResult.failures.length; index += 1) {\n        combinedFailures.push(flushResult.failures[index]);\n      }\n    }\n    if (exposureFailures.length > 0) {\n      for (let index = 0; index < exposureFailures.length; index += 1) {\n        combinedFailures.push(exposureFailures[index]);\n      }\n    }\n\n    const result = {\n      ok: flushResult.ok && exposureFailures.length === 0,\n      queueKey,\n      exposures: exposureDetails,\n      flushed: flushResult,\n      failures: combinedFailures,\n    };\n\n    return ensureDeepFrozen(result);\n  }\n\n  const INITIAL_MODULE_LINK_STATE = synchronizeModuleLinks({ warn: false });\n\n  function inspectModuleConnections(options = {}) {\n    const registry = options.registry || MODULE_REGISTRY;\n\n    if (!registry || typeof registry.list !== 'function' || typeof registry.describe !== 'function') {\n      return ensureDeepFrozen({\n        ok: false,\n        reason: 'missing-registry',\n        modules: [],\n        missingConnections: [],\n        errors: [],\n      });\n    }\n\n    let names;\n    try {\n      names = registry.list();\n    } catch (error) {\n      return ensureDeepFrozen({\n        ok: false,\n        reason: 'list-failed',\n        modules: [],\n        missingConnections: [],\n        errors: ensureDeepFrozen([\n          {\n            type: 'list',\n            message: error && typeof error.message === 'string' ? error.message : null,\n          },\n        ]),\n      });\n    }\n\n    const moduleNames = Array.isArray(names) ? names.slice() : [];\n    const modules = [];\n    const missingConnections = [];\n    const errors = [];\n\n    const hasConnection = typeof registry.has === 'function'\n      ? function hasViaRegistry(name) {\n        try {\n          return registry.has(name);\n        } catch (error) {\n          errors.push({\n            type: 'has',\n            module: name,\n            message: error && typeof error.message === 'string' ? error.message : null,\n          });\n          return moduleNames.indexOf(name) !== -1;\n        }\n      }\n      : function hasViaList(name) {\n        return moduleNames.indexOf(name) !== -1;\n      };\n\n    for (let index = 0; index < moduleNames.length; index += 1) {\n      const name = moduleNames[index];\n      let meta = null;\n\n      try {\n        meta = registry.describe(name);\n      } catch (error) {\n        errors.push({\n          type: 'describe',\n          module: name,\n          message: error && typeof error.message === 'string' ? error.message : null,\n        });\n      }\n\n      const connectionSet = new Set();\n      const connectionList = [];\n      const missingList = [];\n\n      if (meta && meta.connections && typeof meta.connections[Symbol.iterator] === 'function') {\n        for (const connection of meta.connections) {\n          if (typeof connection !== 'string') {\n            continue;\n          }\n          const trimmed = connection.trim();\n          if (!trimmed || connectionSet.has(trimmed)) {\n            continue;\n          }\n\n          connectionSet.add(trimmed);\n          connectionList.push(trimmed);\n\n          if (!hasConnection(trimmed)) {\n            missingList.push(trimmed);\n            missingConnections.push({ from: name, to: trimmed });\n          }\n        }\n      }\n\n      modules.push(\n        ensureDeepFrozen({\n          name,\n          connections: connectionList,\n          missing: missingList,\n          ok: missingList.length === 0,\n        }),\n      );\n    }\n\n    return ensureDeepFrozen({\n      ok: missingConnections.length === 0,\n      modules,\n      missingConnections,\n      errors,\n    });\n  }\n\n  function fallbackExposeGlobal(name, value) {\n    if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n      return false;\n    }\n    try {\n      Object.defineProperty(GLOBAL_SCOPE, name, {\n        configurable: true,\n        enumerable: false,\n        value,\n        writable: false,\n      });\n      return true;\n    } catch (error) {\n      void error;\n      try {\n        GLOBAL_SCOPE[name] = value;\n        return true;\n      } catch (assignmentError) {\n        void assignmentError;\n        return false;\n      }\n    }\n  }\n\n  const exposeGlobal = (function resolveExposeGlobal() {\n    if (MODULE_SYSTEM && typeof MODULE_SYSTEM.exposeGlobal === 'function') {\n      return function exposeWithSystem(name, value, options) {\n        try {\n          return MODULE_SYSTEM.exposeGlobal(name, value, GLOBAL_SCOPE, options);\n        } catch (error) {\n          void error;\n          return fallbackExposeGlobal(name, value);\n        }\n      };\n    }\n\n    if (MODULE_GLOBALS && typeof MODULE_GLOBALS.exposeGlobal === 'function') {\n      return function moduleGlobalsExpose(name, value, options) {\n        try {\n          return MODULE_GLOBALS.exposeGlobal(name, value, options);\n        } catch (error) {\n          void error;\n          return fallbackExposeGlobal(name, value);\n        }\n      };\n    }\n\n    if (ENV_BRIDGE && typeof ENV_BRIDGE.exposeGlobal === 'function') {\n      return function bridgeExposeGlobal(name, value, options) {\n        try {\n          return ENV_BRIDGE.exposeGlobal(name, value, options);\n        } catch (error) {\n          void error;\n          return fallbackExposeGlobal(name, value);\n        }\n      };\n    }\n\n    if (MODULE_ENV && typeof MODULE_ENV.exposeGlobal === 'function') {\n      return function exposeGlobal(name, value, options) {\n        return MODULE_ENV.exposeGlobal(name, value, GLOBAL_SCOPE, options);\n      };\n    }\n\n    return fallbackExposeGlobal;\n  })();\n\n  const MODULE_NAMES = ['cinePersistence', 'cineOffline', 'cineUi'];\n\n  const REQUIRED_PERSISTENCE_FUNCTIONS = [\n    'storage.loadDeviceData',\n    'storage.saveDeviceData',\n    'storage.loadSetups',\n    'storage.saveSetups',\n    'storage.saveSetup',\n    'storage.loadSetup',\n    'storage.deleteSetup',\n    'storage.renameSetup',\n    'storage.loadSessionState',\n    'storage.saveSessionState',\n    'storage.saveProject',\n    'storage.loadProject',\n    'storage.deleteProject',\n    'storage.exportAllData',\n    'storage.importAllData',\n    'storage.clearAllData',\n    'storage.loadFavorites',\n    'storage.saveFavorites',\n    'storage.loadFeedback',\n    'storage.saveFeedback',\n    'storage.loadAutoGearRules',\n    'storage.saveAutoGearRules',\n    'storage.loadAutoGearBackups',\n    'storage.saveAutoGearBackups',\n    'storage.loadAutoGearSeedFlag',\n    'storage.saveAutoGearSeedFlag',\n    'storage.loadAutoGearBackupRetention',\n    'storage.saveAutoGearBackupRetention',\n    'storage.getAutoGearBackupRetentionDefault',\n    'storage.loadAutoGearPresets',\n    'storage.saveAutoGearPresets',\n    'storage.loadAutoGearActivePresetId',\n    'storage.saveAutoGearActivePresetId',\n    'storage.loadAutoGearAutoPresetId',\n    'storage.saveAutoGearAutoPresetId',\n    'storage.loadAutoGearMonitorDefaults',\n    'storage.saveAutoGearMonitorDefaults',\n    'storage.loadAutoGearBackupVisibility',\n    'storage.saveAutoGearBackupVisibility',\n    'storage.loadFullBackupHistory',\n    'storage.saveFullBackupHistory',\n    'storage.recordFullBackupHistoryEntry',\n    'storage.requestPersistentStorage',\n    'storage.clearUiCacheStorageEntries',\n    'storage.ensureCriticalStorageBackups',\n    'storage.getLastCriticalStorageGuardResult',\n    'autosave.saveSession',\n    'autosave.autoSaveSetup',\n    'autosave.saveGearList',\n    'autosave.restoreSessionState',\n    'backups.collectFullBackupData',\n    'backups.createSettingsBackup',\n    'backups.captureStorageSnapshot',\n    'backups.sanitizeBackupPayload',\n    'backups.autoBackup',\n    'backups.formatFullBackupFilename',\n    'backups.downloadPayload',\n    'backups.recordFullBackupHistoryEntry',\n    'restore.proceed',\n    'restore.abort',\n    'share.downloadProject',\n    'share.encodeSharedSetup',\n    'share.decodeSharedSetup',\n    'share.applySharedSetup',\n    'share.applySharedSetupFromUrl'\n  ];\n\n  const REQUIRED_OFFLINE_FUNCTIONS = [\n    'registerServiceWorker',\n    'reloadApp'\n  ];\n\n  const REQUIRED_UI_CONTROLLERS = [\n    { name: 'deviceManagerSection', actions: ['show', 'hide', 'toggle'] },\n    { name: 'shareDialog', actions: ['open', 'submit', 'cancel', 'dismiss'] },\n    { name: 'sharedImportDialog', actions: ['submit', 'cancel', 'dismiss', 'changeMode'] },\n    { name: 'backupSettings', actions: ['execute'] },\n    { name: 'restoreSettings', actions: ['openPicker', 'processFile'] }\n  ];\n\n  const REQUIRED_UI_INTERACTIONS = [\n    'saveSetup',\n    'deleteSetup',\n    'shareOpen',\n    'shareSubmit',\n    'shareCancel',\n    'shareApplyFile',\n    'shareInputChange',\n    'sharedImportSubmit',\n    'sharedImportCancel',\n    'performBackup',\n    'openRestorePicker',\n    'applyRestoreFile'\n  ];\n\n  const REQUIRED_UI_HELP_ENTRIES = [\n    'saveSetup',\n    'autoBackupBeforeDeletion',\n    'shareProject',\n    'sharedImport',\n    'backupSettings',\n    'restoreSettings'\n  ];\n\n  function resolveModule(name) {\n    if (!name || !MODULE_NAMES.includes(name)) {\n      throw new TypeError(`cineRuntime cannot resolve unknown module \"${name}\".`);\n    }\n\n    if (MODULE_REGISTRY && typeof MODULE_REGISTRY.get === 'function') {\n      try {\n        const registered = MODULE_REGISTRY.get(name);\n        if (registered) {\n          return registered;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (GLOBAL_SCOPE && typeof GLOBAL_SCOPE === 'object') {\n      try {\n        const existing = GLOBAL_SCOPE[name];\n        if (existing) {\n          return existing;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    switch (name) {\n      case 'cinePersistence':\n        return tryRequire('./persistence.js');\n      case 'cineOffline':\n        return tryRequire('./offline.js');\n      case 'cineUi':\n        return tryRequire('./ui.js');\n      default:\n        return null;\n    }\n  }\n\n  function ensureModule(name, options = {}) {\n    const resolved = resolveModule(name);\n    if (!resolved && options.optional) {\n      return null;\n    }\n    if (!resolved) {\n      throw new Error(`cineRuntime could not locate ${name}.`);\n    }\n    return resolved;\n  }\n\n  function parsePath(path) {\n    if (Array.isArray(path)) {\n      return path.slice();\n    }\n    if (typeof path === 'string' && path.trim()) {\n      return path.split('.');\n    }\n    throw new TypeError('cineRuntime expected check paths to be strings or arrays.');\n  }\n\n  function inspectFunctionPath(root, path, missing, detailMap, prefix) {\n    const segments = parsePath(path);\n    let current = root;\n    let traversed = prefix ? `${prefix}` : '';\n\n    for (let index = 0; index < segments.length; index += 1) {\n      const segment = segments[index];\n      traversed = traversed ? `${traversed}.${segment}` : segment;\n      if (!current || (typeof current !== 'object' && typeof current !== 'function')) {\n        missing.push(traversed);\n        detailMap[traversed] = false;\n        return;\n      }\n      current = current[segment];\n    }\n\n    const finalPath = prefix ? `${prefix}.${segments.join('.')}` : segments.join('.');\n    const ok = typeof current === 'function';\n    if (!ok) {\n      missing.push(finalPath);\n    }\n    detailMap[finalPath] = ok;\n  }\n\n  function inspectPersistenceModule(persistenceModule, missing, detailMap) {\n    if (!persistenceModule || typeof persistenceModule !== 'object') {\n      return;\n    }\n\n    for (let index = 0; index < REQUIRED_PERSISTENCE_FUNCTIONS.length; index += 1) {\n      inspectFunctionPath(\n        persistenceModule,\n        REQUIRED_PERSISTENCE_FUNCTIONS[index],\n        missing,\n        detailMap,\n        'cinePersistence',\n      );\n    }\n\n    const internal = persistenceModule.__internal;\n    const inspector = internal && typeof internal.inspectBinding === 'function'\n      ? internal.inspectBinding.bind(internal)\n      : null;\n\n    if (!inspector) {\n      const key = 'cinePersistence.__internal.inspectBinding';\n      missing.push(key);\n      detailMap[key] = false;\n      return;\n    }\n\n    for (let index = 0; index < REQUIRED_PERSISTENCE_FUNCTIONS.length; index += 1) {\n      const path = REQUIRED_PERSISTENCE_FUNCTIONS[index];\n      const segments = parsePath(path);\n      const bindingName = segments[segments.length - 1];\n      const bindingPath = `cinePersistence.bindings.${bindingName}`;\n\n      let detail = null;\n      try {\n        detail = inspector(bindingName, { refresh: true });\n      } catch (error) {\n        void error;\n        detail = null;\n      }\n\n      const available = !!(detail && detail.available);\n      if (!available) {\n        missing.push(bindingPath);\n      }\n      detailMap[bindingPath] = available;\n      if (detail) {\n        detailMap[`${bindingPath}.provider`] = detail.providerName || null;\n      }\n    }\n  }\n\n  function inspectOfflineFunctions(module, missing, detailMap) {\n    for (let index = 0; index < REQUIRED_OFFLINE_FUNCTIONS.length; index += 1) {\n      const name = REQUIRED_OFFLINE_FUNCTIONS[index];\n      const fn = module ? module[name] : null;\n      const path = `cineOffline.${name}`;\n      const ok = typeof fn === 'function';\n      if (!ok) {\n        missing.push(path);\n      }\n      detailMap[path] = ok;\n    }\n  }\n\n  function inspectUiControllers(uiModule, missing, detailMap) {\n    const controllers = uiModule && uiModule.controllers;\n    const getter = controllers && typeof controllers.get === 'function'\n      ? controllers.get.bind(controllers)\n      : null;\n\n    for (let index = 0; index < REQUIRED_UI_CONTROLLERS.length; index += 1) {\n      const descriptor = REQUIRED_UI_CONTROLLERS[index];\n      const pathPrefix = `cineUi.controllers.${descriptor.name}`;\n\n      if (!getter) {\n        missing.push(pathPrefix);\n        detailMap[pathPrefix] = false;\n        continue;\n      }\n\n      let entry = null;\n      try {\n        entry = getter(descriptor.name);\n      } catch (error) {\n        void error;\n        entry = null;\n      }\n\n      const entryOk = !!entry && typeof entry === 'object';\n      if (!entryOk) {\n        missing.push(pathPrefix);\n        detailMap[pathPrefix] = false;\n        continue;\n      }\n\n      detailMap[pathPrefix] = true;\n\n      for (let actionIndex = 0; actionIndex < descriptor.actions.length; actionIndex += 1) {\n        const actionName = descriptor.actions[actionIndex];\n        const actionPath = `${pathPrefix}.${actionName}`;\n        const action = entry[actionName];\n        const actionOk = typeof action === 'function';\n        if (!actionOk) {\n          missing.push(actionPath);\n        }\n        detailMap[actionPath] = actionOk;\n      }\n    }\n  }\n\n  function inspectUiInteractions(uiModule, missing, detailMap) {\n    const interactions = uiModule && uiModule.interactions;\n    const getter = interactions && typeof interactions.get === 'function'\n      ? interactions.get.bind(interactions)\n      : null;\n\n    for (let index = 0; index < REQUIRED_UI_INTERACTIONS.length; index += 1) {\n      const name = REQUIRED_UI_INTERACTIONS[index];\n      const path = `cineUi.interactions.${name}`;\n\n      if (!getter) {\n        missing.push(path);\n        detailMap[path] = false;\n        continue;\n      }\n\n      let handler = null;\n      try {\n        handler = getter(name);\n      } catch (error) {\n        void error;\n        handler = null;\n      }\n\n      const ok = typeof handler === 'function';\n      if (!ok) {\n        missing.push(path);\n      }\n      detailMap[path] = ok;\n    }\n  }\n\n  function inspectUiHelp(uiModule, missing, detailMap) {\n    const help = uiModule && uiModule.help;\n    const resolver = help && typeof help.resolve === 'function'\n      ? help.resolve.bind(help)\n      : null;\n\n    for (let index = 0; index < REQUIRED_UI_HELP_ENTRIES.length; index += 1) {\n      const name = REQUIRED_UI_HELP_ENTRIES[index];\n      const path = `cineUi.help.${name}`;\n\n      if (!resolver) {\n        missing.push(path);\n        detailMap[path] = false;\n        continue;\n      }\n\n      let value = null;\n      try {\n        value = resolver(name);\n      } catch (error) {\n        void error;\n        value = null;\n      }\n\n      const ok = typeof value === 'string' && !!value.trim();\n      if (!ok) {\n        missing.push(path);\n      }\n      detailMap[path] = ok;\n    }\n  }\n\n  function listCriticalChecks() {\n    return ensureDeepFrozen({\n      cinePersistence: REQUIRED_PERSISTENCE_FUNCTIONS.slice(),\n      cineOffline: REQUIRED_OFFLINE_FUNCTIONS.slice(),\n      cineUi: {\n        controllers: REQUIRED_UI_CONTROLLERS.map(entry => ({\n          name: entry.name,\n          actions: entry.actions.slice()\n        })),\n        interactions: REQUIRED_UI_INTERACTIONS.slice(),\n        help: REQUIRED_UI_HELP_ENTRIES.slice(),\n      },\n    });\n  }\n\n  function verifyCriticalFlows(options = {}) {\n    const synchronization = synchronizeModuleLinks({ warn: options.warnOnFailure });\n    const missing = [];\n    const detailMap = {};\n\n    if (synchronization && typeof synchronization === 'object') {\n      detailMap['synchronization.ok'] = !!synchronization.ok;\n      if (Array.isArray(synchronization.failures) && synchronization.failures.length > 0) {\n        detailMap['synchronization.failures'] = synchronization.failures;\n      }\n      if (!synchronization.ok) {\n        missing.push('cineRuntime synchronization');\n      }\n    }\n\n    let registrySnapshot = null;\n    if (MODULE_REGISTRY && typeof MODULE_REGISTRY.assertRegistered === 'function') {\n      try {\n        registrySnapshot = MODULE_REGISTRY.assertRegistered(MODULE_NAMES);\n      } catch (error) {\n        safeWarn('cineRuntime.verifyCriticalFlows() could not inspect cineModules registry.', error);\n      }\n    }\n\n    const persistence = resolveModule('cinePersistence');\n    const offline = resolveModule('cineOffline');\n    const ui = resolveModule('cineUi');\n\n    const modulePresence = {\n      cinePersistence: !!persistence,\n      cineOffline: !!offline,\n      cineUi: !!ui,\n    };\n\n    if (registrySnapshot && registrySnapshot.detail) {\n      const registryDetail = {};\n      const detailKeys = Object.keys(registrySnapshot.detail);\n      for (let index = 0; index < detailKeys.length; index += 1) {\n        const key = detailKeys[index];\n        const registered = !!registrySnapshot.detail[key];\n        registryDetail[key] = registered;\n        detailMap[`${key}.registered`] = registered;\n        if (!registered) {\n          missing.push(`${key} (not registered)`);\n        }\n      }\n\n      modulePresence.registry = registryDetail;\n    }\n\n    if (!persistence) {\n      missing.push('cinePersistence');\n      detailMap.cinePersistence = false;\n    } else {\n      detailMap.cinePersistence = true;\n      if (!Object.isFrozen(persistence)) {\n        missing.push('cinePersistence (not frozen)');\n        detailMap['cinePersistence.frozen'] = false;\n      } else {\n        detailMap['cinePersistence.frozen'] = true;\n      }\n\n      inspectPersistenceModule(persistence, missing, detailMap);\n    }\n\n    if (!offline) {\n      missing.push('cineOffline');\n      detailMap.cineOffline = false;\n    } else {\n      detailMap.cineOffline = true;\n      if (!Object.isFrozen(offline)) {\n        missing.push('cineOffline (not frozen)');\n        detailMap['cineOffline.frozen'] = false;\n      } else {\n        detailMap['cineOffline.frozen'] = true;\n      }\n      inspectOfflineFunctions(offline, missing, detailMap);\n    }\n\n    if (!ui) {\n      missing.push('cineUi');\n      detailMap.cineUi = false;\n    } else {\n      detailMap.cineUi = true;\n      if (!Object.isFrozen(ui)) {\n        missing.push('cineUi (not frozen)');\n        detailMap['cineUi.frozen'] = false;\n      } else {\n        detailMap['cineUi.frozen'] = true;\n      }\n\n      inspectUiControllers(ui, missing, detailMap);\n      inspectUiInteractions(ui, missing, detailMap);\n      inspectUiHelp(ui, missing, detailMap);\n    }\n\n    const ok = missing.length === 0;\n    const result = ensureDeepFrozen({\n      ok,\n      missing: missing.slice(),\n      modules: ensureDeepFrozen(modulePresence),\n      details: ensureDeepFrozen(detailMap),\n      registry: registrySnapshot ? ensureDeepFrozen(registrySnapshot) : null,\n      checks: listCriticalChecks(),\n      synchronization,\n    });\n\n    if (!ok) {\n      if (options.warnOnFailure) {\n        safeWarn('cineRuntime.verifyCriticalFlows() detected missing safeguards.', missing);\n      }\n      if (options.throwOnFailure) {\n        const error = new Error('cineRuntime integrity verification failed.');\n        error.details = result;\n        throw error;\n      }\n    }\n\n    return result;\n  }\n\n  const runtimeAPI = ensureDeepFrozen({\n    getPersistence(options) {\n      return ensureModule('cinePersistence', options);\n    },\n    getOffline(options) {\n      return ensureModule('cineOffline', options);\n    },\n    getUi(options) {\n      return ensureModule('cineUi', options);\n    },\n    getModuleRegistry() {\n      return MODULE_REGISTRY || null;\n    },\n    synchronizeModules(options) {\n      return synchronizeModuleLinks(options || {});\n    },\n    inspectModuleConnections(options) {\n      return inspectModuleConnections(options || {});\n    },\n    listCriticalChecks,\n    verifyCriticalFlows,\n    __internal: ensureDeepFrozen({\n      resolveModule,\n      ensureModule,\n      listCriticalChecks,\n      moduleRegistry: MODULE_REGISTRY || null,\n      synchronizeModuleLinks,\n      flushPendingModuleQueues,\n      initialSynchronization: INITIAL_MODULE_LINK_STATE,\n      inspectModuleConnections,\n    }),\n  });\n  informModuleGlobals('cineRuntime', runtimeAPI);\n\n  registerOrQueueModule(\n    'cineRuntime',\n    runtimeAPI,\n    {\n      category: 'runtime',\n      description: 'Runtime orchestrator ensuring persistence, offline, and UI safeguards stay intact.',\n      replace: true,\n      connections: ['cinePersistence', 'cineOffline', 'cineUi', 'cineModuleGlobals', 'cineModuleContext'],\n    },\n    (error) => {\n      safeWarn('Unable to register cineRuntime module.', error);\n    },\n  );\n\n  if (GLOBAL_SCOPE && typeof GLOBAL_SCOPE === 'object') {\n    let existingRuntime = null;\n    try {\n      existingRuntime = GLOBAL_SCOPE.cineRuntime || null;\n    } catch (error) {\n      void error;\n      existingRuntime = null;\n    }\n\n    if (existingRuntime !== runtimeAPI) {\n      const exposed = exposeGlobal('cineRuntime', runtimeAPI, {\n        configurable: true,\n        enumerable: false,\n        writable: false,\n      });\n\n      if (!exposed) {\n        safeWarn('Unable to expose cineRuntime globally.');\n      }\n    }\n  }\n\n  if (typeof module !== 'undefined' && module && module.exports) {\n    if (\n      module.exports\n      && module.exports !== runtimeAPI\n      && typeof module.exports === 'object'\n      && Object.keys(module.exports).length > 0\n    ) {\n      try {\n        if (module.exports.cineRuntime !== runtimeAPI) {\n          Object.defineProperty(module.exports, 'cineRuntime', {\n            configurable: true,\n            enumerable: false,\n            value: runtimeAPI,\n            writable: true,\n          });\n        }\n      } catch (attachmentError) {\n        safeWarn('Unable to attach cineRuntime to existing module.exports.', attachmentError);\n      }\n    } else {\n      module.exports = runtimeAPI;\n    }\n  }\n  return runtimeAPI;\n})();\n\nexport const cineRuntime = runtimeModule;\nexport default runtimeModule;\n","/* global cineModuleBase */\n\n(function () {\n  function detectGlobalScope() {\n    if (typeof globalThis !== 'undefined') {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined') {\n      return window;\n    }\n    if (typeof self !== 'undefined') {\n      return self;\n    }\n    if (typeof global !== 'undefined') {\n      return global;\n    }\n    return {};\n  }\n\n  const GLOBAL_SCOPE = detectGlobalScope();\n\n  function createModuleBaseFallback(scope) {\n    const targetScope =\n      scope && (typeof scope === 'object' || typeof scope === 'function') ? scope : detectGlobalScope();\n\n    const resolvedScope =\n      targetScope && (typeof targetScope === 'object' || typeof targetScope === 'function')\n        ? targetScope\n        : null;\n\n    if (!resolvedScope) {\n      return null;\n    }\n\n    let existingBase = null;\n    try {\n      if (resolvedScope && typeof resolvedScope.cineModuleBase === 'object') {\n        existingBase = resolvedScope.cineModuleBase;\n      }\n    } catch (readBaseError) {\n      void readBaseError;\n      existingBase = null;\n    }\n\n    if (existingBase) {\n      return existingBase;\n    }\n\n    const moduleStorage = Object.create(null);\n    const listenerStorage = Object.create(null);\n\n    const notifyListeners = (name, api) => {\n      if (typeof name !== 'string' || !name) {\n        return;\n      }\n\n      const queue = listenerStorage[name];\n      if (!Array.isArray(queue) || queue.length === 0) {\n        return;\n      }\n\n      listenerStorage[name] = [];\n\n      for (let index = 0; index < queue.length; index += 1) {\n        const listener = queue[index];\n        if (typeof listener !== 'function') {\n          continue;\n        }\n\n        try {\n          listener(api);\n        } catch (listenerError) {\n          void listenerError;\n        }\n      }\n    };\n\n    const storeModule = (name, api) => {\n      if (typeof name !== 'string' || !name) {\n        return;\n      }\n\n      moduleStorage[name] = api;\n      notifyListeners(name, api);\n    };\n\n    const getStoredModule = name => {\n      if (typeof name !== 'string' || !name) {\n        return null;\n      }\n\n      if (Object.prototype.hasOwnProperty.call(moduleStorage, name)) {\n        return moduleStorage[name];\n      }\n\n      return null;\n    };\n\n    const whenModuleAvailable = (name, handler) => {\n      if (typeof handler !== 'function' || typeof name !== 'string' || !name) {\n        return false;\n      }\n\n      const existing = getStoredModule(name);\n      if (existing) {\n        try {\n          handler(existing);\n        } catch (listenerError) {\n          void listenerError;\n        }\n        return true;\n      }\n\n      if (!Array.isArray(listenerStorage[name])) {\n        listenerStorage[name] = [];\n      }\n\n      listenerStorage[name].push(handler);\n      return true;\n    };\n\n    const ensureModuleGlobals = () => {\n      let globals = null;\n      try {\n        globals = resolvedScope.cineModuleGlobals;\n      } catch (readError) {\n        void readError;\n        globals = null;\n      }\n\n      if (!globals || typeof globals !== 'object') {\n        globals = {};\n      }\n\n      if (typeof globals.getModule !== 'function') {\n        globals.getModule = name => getStoredModule(name);\n      }\n\n      if (typeof globals.whenModuleAvailable !== 'function') {\n        globals.whenModuleAvailable = (name, handler) => whenModuleAvailable(name, handler);\n      }\n\n      if (typeof globals.register !== 'function') {\n        globals.register = (name, api) => {\n          storeModule(name, api);\n          return true;\n        };\n      }\n\n      try {\n        Object.defineProperty(resolvedScope, 'cineModuleGlobals', {\n          configurable: true,\n          enumerable: false,\n          writable: true,\n          value: globals,\n        });\n      } catch (defineGlobalsError) {\n        void defineGlobalsError;\n        try {\n          resolvedScope.cineModuleGlobals = globals;\n        } catch (assignGlobalsError) {\n          void assignGlobalsError;\n        }\n      }\n\n      return globals;\n    };\n\n    const ensureModuleRegistry = () => {\n      let registry = null;\n      try {\n        registry = resolvedScope.cineModules;\n      } catch (readError) {\n        void readError;\n        registry = null;\n      }\n\n      if (!registry || typeof registry !== 'object') {\n        registry = {};\n      }\n\n      if (typeof registry.get !== 'function') {\n        registry.get = name => getStoredModule(name);\n      }\n\n      if (typeof registry.register !== 'function') {\n        registry.register = (name, api) => {\n          storeModule(name, api);\n          return true;\n        };\n      }\n\n      try {\n        Object.defineProperty(resolvedScope, 'cineModules', {\n          configurable: true,\n          enumerable: false,\n          writable: true,\n          value: registry,\n        });\n      } catch (defineRegistryError) {\n        void defineRegistryError;\n        try {\n          resolvedScope.cineModules = registry;\n        } catch (assignRegistryError) {\n          void assignRegistryError;\n        }\n      }\n\n      return registry;\n    };\n\n    const fallbackBase = {\n      freezeDeep(value) {\n        return value;\n      },\n      safeWarn(message, detail) {\n        if (typeof console === 'undefined' || !console || typeof console.warn !== 'function') {\n          return;\n        }\n\n        try {\n          if (typeof detail === 'undefined') {\n            console.warn(message);\n          } else {\n            console.warn(message, detail);\n          }\n        } catch (warnError) {\n          void warnError;\n        }\n      },\n      informModuleGlobals(name, api) {\n        const globals = ensureModuleGlobals();\n        if (globals && typeof globals.register === 'function') {\n          try {\n            globals.register(name, api);\n            return true;\n          } catch (registerError) {\n            void registerError;\n          }\n        }\n\n        storeModule(name, api);\n        return true;\n      },\n      registerOrQueueModule(name, api) {\n        const registry = ensureModuleRegistry();\n        if (registry && typeof registry.register === 'function') {\n          try {\n            registry.register(name, api);\n          } catch (registerError) {\n            void registerError;\n            storeModule(name, api);\n          }\n        } else {\n          storeModule(name, api);\n        }\n\n        ensureModuleGlobals();\n        return true;\n      },\n      exposeGlobal(name, value, target, options = {}) {\n        const scopeTarget =\n          target && (typeof target === 'object' || typeof target === 'function') ? target : resolvedScope;\n\n        if (!scopeTarget || (typeof scopeTarget !== 'object' && typeof scopeTarget !== 'function')) {\n          return false;\n        }\n\n        const descriptor = {\n          configurable: options.configurable !== false,\n          enumerable: !!options.enumerable,\n          writable: options.writable === true,\n          value,\n        };\n\n        try {\n          Object.defineProperty(scopeTarget, name, descriptor);\n          return true;\n        } catch (defineError) {\n          void defineError;\n          try {\n            scopeTarget[name] = value;\n            return true;\n          } catch (assignError) {\n            void assignError;\n          }\n        }\n\n        return false;\n      },\n    };\n\n    fallbackBase.registerOrQueueModule('cineModuleBase', fallbackBase);\n    fallbackBase.exposeGlobal('cineModuleBase', fallbackBase, resolvedScope, {\n      configurable: true,\n      enumerable: false,\n      writable: false,\n    });\n\n    ensureModuleGlobals();\n    ensureModuleRegistry();\n\n    return fallbackBase;\n  }\n\n  function resolveModuleBase(scope) {\n    if (typeof cineModuleBase === 'object' && cineModuleBase) {\n      return cineModuleBase;\n    }\n\n    if (typeof require === 'function') {\n      try {\n        const required = require('./base.js');\n        if (required && typeof required === 'object') {\n          return required;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n\n    if (scope && typeof scope.cineModuleBase === 'object') {\n      return scope.cineModuleBase;\n    }\n\n    return null;\n  }\n\n  const MODULE_BASE = resolveModuleBase(GLOBAL_SCOPE) || createModuleBaseFallback(GLOBAL_SCOPE);\n  if (!MODULE_BASE) {\n    return;\n  }\n\n  const freezeDeep = typeof MODULE_BASE.freezeDeep === 'function'\n    ? function freezeWithBase(value) {\n      try {\n        return MODULE_BASE.freezeDeep(value);\n      } catch (error) {\n        void error;\n      }\n      return value;\n    }\n    : function identity(value) {\n      return value;\n    };\n\n  const safeWarn = typeof MODULE_BASE.safeWarn === 'function'\n    ? function warnWithBase(message, detail) {\n      try {\n        MODULE_BASE.safeWarn(message, detail);\n      } catch (error) {\n        void error;\n      }\n    }\n    : function fallbackSafeWarn(message, detail) {\n      if (typeof console === 'undefined' || !console || typeof console.warn !== 'function') {\n        return;\n      }\n      try {\n        if (typeof detail === 'undefined') {\n          console.warn(message);\n        } else {\n          console.warn(message, detail);\n        }\n      } catch (error) {\n        void error;\n      }\n    };\n\n  const informModuleGlobals = typeof MODULE_BASE.informModuleGlobals === 'function'\n    ? function informWithBase(name, api) {\n      try {\n        MODULE_BASE.informModuleGlobals(name, api);\n      } catch (error) {\n        void error;\n      }\n    }\n    : function noopInform() { };\n\n  const registerOrQueueModule = typeof MODULE_BASE.registerOrQueueModule === 'function'\n    ? function registerWithBase(name, api, metadata, onError) {\n      try {\n        MODULE_BASE.registerOrQueueModule(name, api, metadata, onError);\n      } catch (error) {\n        if (typeof onError === 'function') {\n          try {\n            onError(error);\n          } catch (handlerError) {\n            void handlerError;\n          }\n        } else {\n          safeWarn('cineSettingsAppearance: Unable to register module.', error);\n        }\n      }\n    }\n    : function fallbackRegister() { };\n\n  const exposeGlobal = typeof MODULE_BASE.exposeGlobal === 'function'\n    ? function exposeWithBase(name, value, options) {\n      try {\n        return MODULE_BASE.exposeGlobal(name, value, GLOBAL_SCOPE, options);\n      } catch (error) {\n        void error;\n        return false;\n      }\n    }\n    : function fallbackExpose(name, value) {\n      if (!GLOBAL_SCOPE || typeof GLOBAL_SCOPE !== 'object') {\n        return false;\n      }\n      try {\n        GLOBAL_SCOPE[name] = value;\n        return true;\n      } catch (error) {\n        void error;\n      }\n      return false;\n    };\n\n  function cloneContext(context) {\n    if (!context || typeof context !== 'object') {\n      return {};\n    }\n\n    const copy = {};\n    const keys = Object.keys(context);\n    for (let index = 0; index < keys.length; index += 1) {\n      const key = keys[index];\n      copy[key] = context[key];\n    }\n    return copy;\n  }\n\n  function createFallbackContext() {\n    const getDocument = () => {\n      if (typeof document !== 'undefined') {\n        return document;\n      }\n      return null;\n    };\n\n    const getWindow = () => {\n      if (typeof window !== 'undefined') {\n        return window;\n      }\n      return null;\n    };\n\n    return {\n      getDocument,\n      getWindow,\n      settings: {},\n      elements: {},\n      accent: {},\n      icons: {},\n      storage: {},\n      preferences: {},\n      autoBackups: {},\n      mountVoltages: {},\n      helpers: {},\n    };\n  }\n\n  function resolveDocument(context) {\n    if (!context) {\n      return null;\n    }\n    if (typeof context.getDocument === 'function') {\n      try {\n        const doc = context.getDocument();\n        if (doc && typeof doc === 'object') {\n          return doc;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    if (context.document && typeof context.document === 'object') {\n      return context.document;\n    }\n    if (typeof document !== 'undefined' && document) {\n      return document;\n    }\n    return null;\n  }\n\n  function resolveWindow(context) {\n    if (!context) {\n      return null;\n    }\n    if (typeof context.getWindow === 'function') {\n      try {\n        const win = context.getWindow();\n        if (win && typeof win === 'object') {\n          return win;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    if (context.window && typeof context.window === 'object') {\n      return context.window;\n    }\n    if (typeof window !== 'undefined' && window) {\n      return window;\n    }\n    return null;\n  }\n\n  function getLocalStorage(context) {\n    const storage = context.storage || {};\n    if (storage && typeof storage.getLocalStorage === 'function') {\n      try {\n        const resolved = storage.getLocalStorage();\n        if (resolved) {\n          return resolved;\n        }\n      } catch (error) {\n        void error;\n      }\n    }\n    if (storage && storage.localStorage) {\n      return storage.localStorage;\n    }\n    if (typeof localStorage !== 'undefined') {\n      return localStorage;\n    }\n    return null;\n  }\n\n  function callOptional(fn, args, defaultValue) {\n    if (typeof fn !== 'function') {\n      return defaultValue;\n    }\n    try {\n      return fn.apply(null, Array.isArray(args) ? args : []);\n    } catch (error) {\n      safeWarn('cineSettingsAppearance: helper invocation failed.', error);\n      return defaultValue;\n    }\n  }\n\n  function createAppearanceManager(rawContext) {\n    const context = cloneContext(createFallbackContext());\n    const provided = cloneContext(rawContext);\n    const providedKeys = Object.keys(provided);\n    for (let index = 0; index < providedKeys.length; index += 1) {\n      const key = providedKeys[index];\n      const value = provided[key];\n      if (value && typeof value === 'object' && !Array.isArray(value)) {\n        context[key] = cloneContext(value);\n      } else {\n        context[key] = value;\n      }\n    }\n\n    const doc = resolveDocument(context);\n    const win = resolveWindow(context);\n\n    const elements = context.elements || {};\n    const settings = context.settings || {};\n    const accent = context.accent || {};\n    const icons = context.icons || {};\n    const preferences = context.preferences || {};\n    const autoBackups = context.autoBackups || {};\n    const mountVoltages = context.mountVoltages || {};\n    const helpers = context.helpers || {};\n    const storage = context.storage || {};\n    void win;\n    void helpers;\n\n    const themeMemoryStorage = (function createThemeMemoryStorage() {\n      const memory = Object.create(null);\n      return {\n        getItem(key) {\n          if (Object.prototype.hasOwnProperty.call(memory, key)) {\n            return memory[key];\n          }\n          return null;\n        },\n        setItem(key, value) {\n          memory[key] = String(value);\n        },\n        removeItem(key) {\n          if (Object.prototype.hasOwnProperty.call(memory, key)) {\n            delete memory[key];\n          }\n        },\n      };\n    }());\n\n    function collectThemeStorageEntries() {\n      const entries = [];\n\n      function pushEntry(name, storageRef) {\n        if (!storageRef || typeof storageRef.getItem !== 'function') {\n          return;\n        }\n        for (let index = 0; index < entries.length; index += 1) {\n          if (entries[index] && entries[index].storage === storageRef) {\n            return;\n          }\n        }\n        entries.push({ name, storage: storageRef });\n      }\n\n      if (storage && typeof storage.getSafeLocalStorage === 'function') {\n        try {\n          pushEntry('safeLocalStorage', storage.getSafeLocalStorage());\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: getSafeLocalStorage failed for theme preference.', error);\n        }\n      }\n\n      if (storage && typeof storage.resolveSafeLocalStorage === 'function') {\n        try {\n          pushEntry('resolvedSafeLocalStorage', storage.resolveSafeLocalStorage());\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: resolveSafeLocalStorage failed for theme preference.', error);\n        }\n      }\n\n      if (storage && typeof storage.getLocalStorage === 'function') {\n        try {\n          pushEntry('localStorage', storage.getLocalStorage());\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: getLocalStorage failed for theme preference.', error);\n        }\n      }\n\n      pushEntry('memoryStorage', themeMemoryStorage);\n\n      return entries;\n    }\n\n    function persistThemePreference(value) {\n      const entries = collectThemeStorageEntries();\n      const serialized = value ? 'true' : 'false';\n      for (let index = 0; index < entries.length; index += 1) {\n        const entry = entries[index];\n        if (!entry || !entry.storage || typeof entry.storage.setItem !== 'function') {\n          continue;\n        }\n        try {\n          entry.storage.setItem('darkMode', serialized);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Unable to persist theme preference.', {\n            name: entry.name,\n            error,\n          });\n        }\n      }\n    }\n\n    function readStoredThemePreference() {\n      const entries = collectThemeStorageEntries();\n      for (let index = 0; index < entries.length; index += 1) {\n        const entry = entries[index];\n        if (!entry || !entry.storage || typeof entry.storage.getItem !== 'function') {\n          continue;\n        }\n        try {\n          const stored = entry.storage.getItem('darkMode');\n          if (stored === 'true' || stored === 'false') {\n            return stored === 'true';\n          }\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Unable to read theme preference.', {\n            name: entry.name,\n            error,\n          });\n        }\n      }\n      return null;\n    }\n\n    let pinkModeIconRotationTimer = null;\n    let pinkModeIconIndex = 0;\n    let pinkModeIconPressCount = 0;\n    const pinkModeIconPressTimestamps = [];\n    let pinkModeIconPressResetTimer = null;\n    const PINK_MODE_ICON_ANIMATION_RESET_DELAY = context.pinkModeIconAnimationResetDelay || 400;\n    const PINK_MODE_ICON_ANIMATION_CLASS = context.pinkModeIconAnimationClass || 'pink-mode-icon-animate';\n    const PINK_MODE_ICON_INTERVAL_MS = context.pinkModeIconIntervalMs || 1500;\n    const PINK_MODE_ICON_PRESS_RESET_MS =\n      typeof context.pinkModeIconPressResetMs === 'number' && context.pinkModeIconPressResetMs >= 0\n        ? context.pinkModeIconPressResetMs\n        : 0;\n    const PINK_MODE_ICON_PRESS_BURST_WINDOW_MS =\n      typeof context.pinkModeIconPressBurstWindowMs === 'number' && context.pinkModeIconPressBurstWindowMs >= 0\n        ? context.pinkModeIconPressBurstWindowMs\n        : 1200;\n\n    let pinkModeEnabled = false;\n    let settingsInitialPinkMode = false;\n    let settingsInitialTemperatureUnit = 'celsius';\n    let settingsInitialFocusScale = 'metric';\n    let settingsInitialShowAutoBackups = false;\n    const PINK_MODE_STORAGE_KEY = 'cameraPowerPlanner_pinkMode';\n    const LEGACY_PINK_MODE_STORAGE_KEY = 'pinkMode';\n\n    function getRoot() {\n      return doc && doc.documentElement ? doc.documentElement : null;\n    }\n\n    function getBody() {\n      return doc && doc.body ? doc.body : null;\n    }\n\n    function getAccentColor() {\n      if (typeof accent.getAccentColor === 'function') {\n        return accent.getAccentColor();\n      }\n      return accent.accentColor || '#001589';\n    }\n\n    function setAccentColor(value) {\n      if (typeof accent.setAccentColor === 'function') {\n        accent.setAccentColor(value);\n      } else {\n        accent.accentColor = value;\n      }\n    }\n\n    function getPrevAccentColor() {\n      if (typeof accent.getPrevAccentColor === 'function') {\n        return accent.getPrevAccentColor();\n      }\n      return accent.prevAccentColor || getAccentColor();\n    }\n\n    function setPrevAccentColor(value) {\n      if (typeof accent.setPrevAccentColor === 'function') {\n        accent.setPrevAccentColor(value);\n      } else {\n        accent.prevAccentColor = value;\n      }\n    }\n\n    function getHighContrastAccentColor() {\n      if (typeof accent.getHighContrastAccentColor === 'function') {\n        return accent.getHighContrastAccentColor();\n      }\n      return accent.highContrastAccentColor || '#ffffff';\n    }\n\n    function isHighContrastActive() {\n      if (typeof accent.isHighContrastActive === 'function') {\n        try {\n          return !!accent.isHighContrastActive();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: isHighContrastActive failed.', error);\n        }\n      }\n      const body = getBody();\n      return !!(body && body.classList && body.classList.contains('high-contrast'));\n    }\n\n    function updateAccentColorResetButtonState() {\n      if (typeof accent.updateAccentColorResetButtonState === 'function') {\n        try {\n          accent.updateAccentColorResetButtonState();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: updateAccentColorResetButtonState failed.', error);\n        }\n      }\n    }\n\n    function clearAccentColorOverrides() {\n      if (typeof accent.clearAccentColorOverrides === 'function') {\n        try {\n          accent.clearAccentColorOverrides();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: clearAccentColorOverrides failed.', error);\n        }\n      }\n    }\n\n    function applyAccentColor(value) {\n      if (typeof accent.applyAccentColor === 'function') {\n        try {\n          accent.applyAccentColor(value);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: applyAccentColor failed.', error);\n        }\n      }\n    }\n\n    function refreshDarkModeAccentBoost(payload) {\n      if (typeof accent.refreshDarkModeAccentBoost === 'function') {\n        try {\n          accent.refreshDarkModeAccentBoost(payload);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: refreshDarkModeAccentBoost failed.', error);\n        }\n      }\n    }\n\n    function ensureSvgHasAriaHidden(markup) {\n      if (typeof icons.ensureSvgHasAriaHidden === 'function') {\n        return icons.ensureSvgHasAriaHidden(markup);\n      }\n      return markup;\n    }\n\n    function applyIconGlyph(target, glyph) {\n      if (typeof icons.applyIconGlyph === 'function') {\n        try {\n          icons.applyIconGlyph(target, glyph);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: applyIconGlyph failed.', error);\n        }\n      }\n    }\n\n    function getIconGlyph(name) {\n      if (!name) {\n        return null;\n      }\n      if (typeof icons.getIconGlyph === 'function') {\n        try {\n          return icons.getIconGlyph(name);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: getIconGlyph failed.', error);\n          return null;\n        }\n      }\n      const registry = icons.registry && typeof icons.registry === 'object' ? icons.registry : null;\n      if (registry && registry[name]) {\n        return registry[name];\n      }\n      if (typeof GLOBAL_SCOPE.ICON_GLYPHS === 'object' && GLOBAL_SCOPE.ICON_GLYPHS) {\n        return GLOBAL_SCOPE.ICON_GLYPHS[name] || null;\n      }\n      return null;\n    }\n\n    function updateThemeColor(isDark) {\n      const documentRef = doc;\n      if (!documentRef || typeof documentRef.querySelector !== 'function') {\n        return;\n      }\n      const meta = documentRef.querySelector('meta[name=\"theme-color\"]');\n      if (!meta) {\n        return;\n      }\n      try {\n        meta.setAttribute('content', isDark ? '#1c1c1e' : '#ffffff');\n      } catch (error) {\n        safeWarn('cineSettingsAppearance: unable to update theme-color meta tag.', error);\n      }\n    }\n\n    function setToggleIcon(button, glyph) {\n      if (!button) {\n        return;\n      }\n      let iconSpan = button.querySelector && button.querySelector('.icon-glyph');\n      if (!iconSpan && doc && typeof doc.createElement === 'function') {\n        iconSpan = doc.createElement('span');\n        iconSpan.className = 'icon-glyph';\n        iconSpan.setAttribute('aria-hidden', 'true');\n        try {\n          button.textContent = '';\n          button.appendChild(iconSpan);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: unable to attach toggle icon.', error);\n          return;\n        }\n      }\n      if (!iconSpan) {\n        return;\n      }\n\n      // Cleanup previous Lottie if any\n      if (iconSpan._lottieAnim) {\n        try {\n          iconSpan._lottieAnim.destroy();\n        } catch { /* ignore */ }\n        iconSpan._lottieAnim = null;\n      }\n\n      const glyphConfig = glyph && typeof glyph === 'object' && (glyph.markup || glyph.className || glyph.lottiePath)\n        ? glyph\n        : { value: glyph };\n\n      const classNames = ['icon-glyph'];\n      if (glyphConfig.className) {\n        classNames.push(glyphConfig.className);\n      }\n      iconSpan.className = classNames.join(' ');\n\n      if ((glyphConfig.lottiePath || glyphConfig.lottieData) && typeof icons.ensurePinkModeLottieRuntime === 'function') {\n        const handleLottie = () => {\n          // Add a small \"pop\" effect if it's a new icon\n          iconSpan.classList.remove('pink-mode-icon-pop');\n          void iconSpan.offsetWidth; // trigger reflow\n          iconSpan.classList.add('pink-mode-icon-pop');\n\n          const requestId = Date.now() + Math.random();\n          iconSpan._lottieRequestId = requestId;\n\n          icons.ensurePinkModeLottieRuntime()\n            .then((lottie) => {\n              if (!lottie) return;\n              // Check if request is stale\n              if (iconSpan._lottieRequestId !== requestId) return;\n              if (!iconSpan || !document.body.contains(button)) return;\n\n              try {\n                let lottieContainer = iconSpan.querySelector('.lottie-container');\n                if (!lottieContainer) {\n                  lottieContainer = doc.createElement('div');\n                  lottieContainer.className = 'lottie-container';\n                  lottieContainer.style.width = '100%';\n                  lottieContainer.style.height = '100%';\n                  lottieContainer.style.display = 'flex';\n                  lottieContainer.style.justifyContent = 'center';\n                  lottieContainer.style.alignItems = 'center';\n                  lottieContainer.style.position = 'absolute';\n                  lottieContainer.style.top = '0';\n                  lottieContainer.style.left = '0';\n                  lottieContainer.style.zIndex = '2';\n                  iconSpan.appendChild(lottieContainer);\n                  iconSpan.style.position = 'relative';\n                  // Ensure inline-block so it holds dimensions if possible\n                  if (getComputedStyle(iconSpan).display === 'inline') {\n                    iconSpan.style.display = 'inline-block';\n                  }\n                } else {\n                  lottieContainer.innerHTML = '';\n                }\n\n                const animConfig = {\n                  container: lottieContainer,\n                  renderer: 'svg',\n                  loop: true,\n                  autoplay: true\n                };\n\n                if (glyphConfig.lottieData) {\n                  animConfig.animationData = glyphConfig.lottieData;\n                } else if (glyphConfig.lottiePath) {\n                  animConfig.path = glyphConfig.lottiePath;\n                }\n\n                const anim = lottie.loadAnimation(animConfig);\n                // Store anim on container to destroy later if needed, though we destroy by rebuilding\n                iconSpan._lottieAnim = anim;\n\n                const hideFallback = () => {\n                  const oldFallback = iconSpan.querySelector('.icon-fallback');\n                  if (oldFallback) {\n                    oldFallback.style.opacity = '0';\n                    setTimeout(() => {\n                      if (oldFallback.style.opacity === '0') {\n                        oldFallback.style.display = 'none';\n                        // Switch lottie to relative so it takes space in flow\n                        if (lottieContainer) {\n                          lottieContainer.style.position = 'relative';\n                          lottieContainer.style.top = '';\n                          lottieContainer.style.left = '';\n                        }\n                      }\n                    }, 200);\n                  } else if (lottieContainer) {\n                    // No fallback to hide, just ensure position\n                    lottieContainer.style.position = 'relative';\n                    lottieContainer.style.top = '';\n                    lottieContainer.style.left = '';\n                  }\n                };\n\n                anim.addEventListener('DOMLoaded', hideFallback);\n\n                const handleFailure = () => {\n                  if (lottieContainer && lottieContainer.parentNode) {\n                    lottieContainer.parentNode.removeChild(lottieContainer);\n                  }\n                  const oldFallback = iconSpan.querySelector('.icon-fallback');\n                  if (oldFallback) {\n                    oldFallback.style.display = '';\n                    oldFallback.style.opacity = '1';\n                  }\n                };\n\n                anim.addEventListener('data_failed', handleFailure);\n                anim.addEventListener('error', handleFailure);\n\n              } catch {\n                /* ignore */\n              }\n            })\n            .catch(() => { /* ignore */ });\n        };\n\n        if (glyphConfig.markup) {\n          const markup = ensureSvgHasAriaHidden(glyphConfig.markup);\n          let fallback = iconSpan.querySelector('.icon-fallback');\n          if (!fallback) {\n            const existing = iconSpan.querySelector('svg:not(.lottie-container svg)');\n            if (existing) {\n              existing.classList.add('icon-fallback');\n              fallback = existing;\n            }\n          }\n\n          if (fallback) {\n            const temp = doc.createElement('div');\n            temp.innerHTML = markup;\n            const newSvg = temp.firstElementChild;\n            if (newSvg) {\n              newSvg.classList.add('icon-fallback');\n              newSvg.style.transition = 'opacity 0.2s ease';\n              if (fallback.parentNode === iconSpan) {\n                iconSpan.replaceChild(newSvg, fallback);\n              }\n            }\n          } else {\n            const temp = doc.createElement('div');\n            temp.innerHTML = markup;\n            const newSvg = temp.firstElementChild;\n            if (newSvg) {\n              newSvg.classList.add('icon-fallback');\n              newSvg.style.transition = 'opacity 0.2s ease';\n              // Ensure fallback is behind lottie (z-index)\n              newSvg.style.position = 'relative';\n              newSvg.style.zIndex = '1';\n              iconSpan.prepend(newSvg);\n            }\n          }\n        }\n\n        handleLottie();\n      } else if (glyphConfig.markup) {\n        iconSpan.innerHTML = ensureSvgHasAriaHidden(glyphConfig.markup);\n        iconSpan.removeAttribute('data-icon-font');\n        iconSpan.classList.remove('pink-mode-icon-pop');\n        void iconSpan.offsetWidth;\n        iconSpan.classList.add('pink-mode-icon-pop');\n      } else {\n        applyIconGlyph(iconSpan, glyphConfig.value);\n      }\n    }\n\n    function applyDarkMode(enabled) {\n      const root = getRoot();\n      const body = getBody();\n      if (!root || !body) {\n        return;\n      }\n\n      if (enabled) {\n        body.classList.add('dark-mode');\n        root.classList.add('dark-mode');\n        body.classList.remove('light-mode');\n        root.classList.remove('light-mode');\n        if (elements.darkModeToggle) {\n          const sunGlyph = getIconGlyph('sun');\n          if (sunGlyph) {\n            setToggleIcon(elements.darkModeToggle, sunGlyph);\n          }\n          elements.darkModeToggle.setAttribute('aria-pressed', 'true');\n        }\n      } else {\n        body.classList.remove('dark-mode');\n        root.classList.remove('dark-mode');\n        body.classList.add('light-mode');\n        root.classList.add('light-mode');\n        if (elements.darkModeToggle) {\n          const moonGlyph = getIconGlyph('moon');\n          if (moonGlyph) {\n            setToggleIcon(elements.darkModeToggle, moonGlyph);\n          }\n          elements.darkModeToggle.setAttribute('aria-pressed', 'false');\n        }\n      }\n\n      const highContrast = isHighContrastActive();\n      const accentSource = highContrast ? getHighContrastAccentColor() : getAccentColor();\n      refreshDarkModeAccentBoost({ color: accentSource, highContrast });\n      updateThemeColor(enabled);\n      if (settings.darkMode) {\n        settings.darkMode.checked = !!enabled;\n      }\n    }\n\n    function detectSystemDarkPreference() {\n      if (!win || typeof win.matchMedia !== 'function') {\n        return null;\n      }\n      try {\n        return !!win.matchMedia('(prefers-color-scheme: dark)').matches;\n      } catch (error) {\n        safeWarn('cineSettingsAppearance: matchMedia failed while detecting system theme preference.', error);\n      }\n      return null;\n    }\n\n    function detectThemeControlType(element, provided) {\n      if (provided) {\n        return provided;\n      }\n      if (!element || typeof element.tagName !== 'string') {\n        return 'button';\n      }\n      const tagName = element.tagName.toLowerCase();\n      if (tagName === 'select') {\n        return 'select';\n      }\n      if (tagName === 'input') {\n        const typeAttr = typeof element.getAttribute === 'function'\n          ? (element.getAttribute('type') || '').toLowerCase()\n          : '';\n        if (typeAttr === 'checkbox') {\n          return 'checkbox';\n        }\n      }\n      return 'button';\n    }\n\n    function createThemeControlReader(element, type, provided, getCurrent) {\n      if (typeof provided === 'function') {\n        return provided;\n      }\n      if (type === 'select') {\n        return () => !!(element && element.value === 'dark');\n      }\n      if (type === 'checkbox') {\n        return () => !!(element && element.checked);\n      }\n      return () => !getCurrent();\n    }\n\n    function createThemeControlWriter(element, type, provided) {\n      if (typeof provided === 'function') {\n        return provided;\n      }\n      if (type === 'select') {\n        return value => {\n          if (!element) {\n            return;\n          }\n          const expected = value ? 'dark' : 'light';\n          if (element.value !== expected) {\n            element.value = expected;\n          }\n        };\n      }\n      if (type === 'checkbox') {\n        return value => {\n          if (element) {\n            element.checked = !!value;\n          }\n        };\n      }\n      return value => {\n        if (!element || typeof element.setAttribute !== 'function') {\n          return;\n        }\n        element.setAttribute('aria-pressed', value ? 'true' : 'false');\n      };\n    }\n\n    function detectBooleanControlType(element, provided) {\n      if (provided) {\n        return provided;\n      }\n      if (!element || typeof element.tagName !== 'string') {\n        return 'button';\n      }\n      const tagName = element.tagName.toLowerCase();\n      if (tagName === 'select') {\n        return 'select';\n      }\n      if (tagName === 'input') {\n        const typeAttr = typeof element.getAttribute === 'function'\n          ? (element.getAttribute('type') || '').toLowerCase()\n          : '';\n        if (typeAttr === 'checkbox') {\n          return 'checkbox';\n        }\n      }\n      return 'button';\n    }\n\n    function createPinkModeControlReader(element, type, provided, getCurrent) {\n      if (typeof provided === 'function') {\n        return provided;\n      }\n      if (type === 'select') {\n        return () => !!(element && element.value === 'enabled');\n      }\n      if (type === 'checkbox') {\n        return () => !!(element && element.checked);\n      }\n      return () => !getCurrent();\n    }\n\n    function createPinkModeControlWriter(element, type, provided) {\n      if (typeof provided === 'function') {\n        return provided;\n      }\n      if (type === 'select') {\n        return value => {\n          if (!element) {\n            return;\n          }\n          const expected = value ? 'enabled' : 'disabled';\n          if (element.value !== expected) {\n            element.value = expected;\n          }\n        };\n      }\n      if (type === 'checkbox') {\n        return value => {\n          if (!element) {\n            return;\n          }\n          const expected = !!value;\n          if (element.checked !== expected) {\n            element.checked = expected;\n          }\n        };\n      }\n      return value => {\n        if (!element || typeof element.setAttribute !== 'function') {\n          return;\n        }\n        element.setAttribute('aria-pressed', value ? 'true' : 'false');\n      };\n    }\n\n    function createPinkModePreferenceController() {\n      const controls = [];\n      let applying = false;\n      let currentPreference = isPinkModeActive();\n\n      const getCurrentPreference = () => currentPreference;\n\n      function applyPreference(value, config) {\n        const optionsConfig = config && typeof config === 'object' ? config : {};\n        const normalized = !!value;\n        const previous = currentPreference;\n        currentPreference = normalized;\n\n        applying = true;\n        try {\n          for (let index = 0; index < controls.length; index += 1) {\n            const control = controls[index];\n            if (!control || control === optionsConfig.source || typeof control.write !== 'function') {\n              continue;\n            }\n            try {\n              control.write(normalized, { previous });\n            } catch (error) {\n              safeWarn('cineSettingsAppearance: Unable to sync pink mode control.', error);\n            }\n          }\n\n          try {\n            applyPinkMode(normalized);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: applyPinkMode failed during update.', error);\n          }\n        } finally {\n          applying = false;\n        }\n\n        if (optionsConfig.source && typeof optionsConfig.source.write === 'function') {\n          try {\n            optionsConfig.source.write(normalized, { previous });\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Unable to sync source pink mode control.', error);\n          }\n        }\n\n        if (optionsConfig.persist !== false) {\n          persistPinkModePreference(normalized);\n        }\n\n        return previous !== normalized;\n      }\n\n      function registerControl(element, controlOptions) {\n        if (!element) {\n          return () => { };\n        }\n\n        const configuration = controlOptions && typeof controlOptions === 'object' ? controlOptions : {};\n        const type = detectBooleanControlType(element, configuration.type);\n        const read = createPinkModeControlReader(element, type, configuration.read, getCurrentPreference);\n        const write = createPinkModeControlWriter(element, type, configuration.write);\n        const eventType = configuration.event || (type === 'button' ? 'click' : 'change');\n\n        const control = { element, type, read, write, eventType };\n\n        const handler = event => {\n          if (applying) {\n            return;\n          }\n          let nextValue;\n          try {\n            nextValue = control.read(currentPreference, event);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Unable to read pink mode control value.', error);\n            nextValue = currentPreference;\n          }\n\n          applyPreference(!!nextValue, { source: control });\n        };\n\n        if (typeof element.addEventListener === 'function') {\n          element.addEventListener(eventType, handler);\n        }\n\n        control.handler = handler;\n        controls.push(control);\n\n        try {\n          control.write(currentPreference);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Unable to apply pink mode preference to control during registration.', error);\n        }\n\n        return function unregisterControl() {\n          for (let index = controls.length - 1; index >= 0; index -= 1) {\n            const storedControl = controls[index];\n            if (!storedControl || storedControl.element !== element) {\n              continue;\n            }\n            controls.splice(index, 1);\n            if (element && typeof element.removeEventListener === 'function') {\n              element.removeEventListener(storedControl.eventType, storedControl.handler);\n            }\n            break;\n          }\n        };\n      }\n\n      function setValue(value, optionsConfig) {\n        const config = optionsConfig && typeof optionsConfig === 'object' ? optionsConfig : {};\n        applyPreference(value, { persist: config.persist !== false });\n      }\n\n      function getValue() {\n        return currentPreference;\n      }\n\n      function reloadFromStorage(optionsConfig) {\n        const config = optionsConfig && typeof optionsConfig === 'object' ? optionsConfig : {};\n        let stored = null;\n        try {\n          const raw = localStorage.getItem(PINK_MODE_STORAGE_KEY) || localStorage.getItem(LEGACY_PINK_MODE_STORAGE_KEY);\n          if (raw === 'true' || raw === 'false') {\n            stored = raw === 'true';\n          }\n        } catch (e) {\n          void e;\n        }\n\n        if (stored === null) {\n          if (config.persist !== false) {\n            persistPinkModePreference(currentPreference);\n          }\n          return currentPreference;\n        }\n        applyPreference(stored, { persist: config.persist !== false });\n        return stored;\n      }\n\n      return {\n        registerControl,\n        setValue,\n        getValue,\n        reloadFromStorage,\n        persist: persistPinkModePreference,\n      };\n    }\n\n    function createThemePreferenceController(options) {\n      const controllerOptions = options && typeof options === 'object' ? options : {};\n      const controls = [];\n      let applying = false;\n      let currentPreference = false;\n\n      const getCurrentPreference = () => currentPreference;\n\n      function applyPreference(value, config) {\n        const optionsConfig = config && typeof config === 'object' ? config : {};\n        const normalized = !!value;\n        const previous = currentPreference;\n        currentPreference = normalized;\n\n        applying = true;\n        try {\n          for (let index = 0; index < controls.length; index += 1) {\n            const control = controls[index];\n            if (!control || control === optionsConfig.source || typeof control.write !== 'function') {\n              continue;\n            }\n            try {\n              control.write(normalized, { previous });\n            } catch (error) {\n              safeWarn('cineSettingsAppearance: Unable to sync theme control.', error);\n            }\n          }\n\n          try {\n            applyDarkMode(normalized);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: applyDarkMode failed during theme update.', error);\n          }\n        } finally {\n          applying = false;\n        }\n\n        if (optionsConfig.source && typeof optionsConfig.source.write === 'function') {\n          try {\n            optionsConfig.source.write(normalized, { previous });\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Unable to sync source theme control.', error);\n          }\n        }\n\n        if (optionsConfig.persist !== false) {\n          persistThemePreference(normalized);\n        }\n\n        return previous !== normalized;\n      }\n\n      function registerControl(element, controlOptions) {\n        if (!element) {\n          return () => { };\n        }\n\n        const configuration = controlOptions && typeof controlOptions === 'object' ? controlOptions : {};\n        const type = detectThemeControlType(element, configuration.type);\n        const read = createThemeControlReader(element, type, configuration.read, getCurrentPreference);\n        const write = createThemeControlWriter(element, type, configuration.write);\n        const eventType = configuration.event || (type === 'button' ? 'click' : 'change');\n\n        const control = { element, type, read, write, eventType };\n\n        const handler = event => {\n          if (applying) {\n            return;\n          }\n          let nextValue;\n          try {\n            nextValue = control.read(currentPreference, event);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Unable to read theme control value.', error);\n            nextValue = currentPreference;\n          }\n\n          if (typeof nextValue === 'string') {\n            nextValue = nextValue === 'dark';\n          }\n\n          applyPreference(!!nextValue, { source: control });\n        };\n\n        if (typeof element.addEventListener === 'function') {\n          element.addEventListener(eventType, handler);\n        }\n\n        control.handler = handler;\n        controls.push(control);\n\n        try {\n          control.write(currentPreference);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Unable to apply theme preference to control during registration.', error);\n        }\n\n        return function unregisterControl() {\n          for (let index = controls.length - 1; index >= 0; index -= 1) {\n            const storedControl = controls[index];\n            if (!storedControl || storedControl.element !== element) {\n              continue;\n            }\n            controls.splice(index, 1);\n            if (element && typeof element.removeEventListener === 'function') {\n              element.removeEventListener(storedControl.eventType, storedControl.handler);\n            }\n            break;\n          }\n        };\n      }\n\n      function setValue(value, optionsConfig) {\n        const config = optionsConfig && typeof optionsConfig === 'object' ? optionsConfig : {};\n        applyPreference(value, { persist: config.persist !== false, source: config.source || null });\n      }\n\n      function getValue() {\n        return currentPreference;\n      }\n\n      function reloadFromStorage(optionsConfig) {\n        const config = optionsConfig && typeof optionsConfig === 'object' ? optionsConfig : {};\n        const stored = readStoredThemePreference();\n        if (stored === null) {\n          if (config.persist !== false) {\n            persistThemePreference(currentPreference);\n          }\n          return currentPreference;\n        }\n        applyPreference(stored, { persist: config.persist !== false });\n        return stored;\n      }\n\n      const storedPreference = readStoredThemePreference();\n      let initialPreference = typeof storedPreference === 'boolean' ? storedPreference : null;\n      if (initialPreference === null) {\n        if (typeof controllerOptions.detectSystemPreference === 'function') {\n          try {\n            const detected = controllerOptions.detectSystemPreference();\n            if (typeof detected === 'boolean') {\n              initialPreference = detected;\n            }\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: detectSystemPreference option failed.', error);\n          }\n        }\n\n        if (initialPreference === null) {\n          const detected = detectSystemDarkPreference();\n          if (typeof detected === 'boolean') {\n            initialPreference = detected;\n          }\n        }\n      }\n\n      if (initialPreference === null) {\n        initialPreference = false;\n      }\n\n      applyPreference(initialPreference, { persist: true });\n\n      return {\n        registerControl,\n        setValue,\n        getValue,\n        reloadFromStorage,\n        persist: persistThemePreference,\n      };\n    }\n\n    function applyHighContrast(enabled) {\n      const root = getRoot();\n      const body = getBody();\n      if (!root) {\n        return;\n      }\n\n      if (enabled) {\n        if (body) {\n          body.classList.add('high-contrast');\n        }\n        root.classList.add('high-contrast');\n        applyAccentColor(getAccentColor());\n        if (body && body.classList.contains('pink-mode')) {\n          clearAccentColorOverrides();\n        }\n      } else {\n        if (body) {\n          body.classList.remove('high-contrast');\n        }\n        root.classList.remove('high-contrast');\n        if (body && body.classList.contains('pink-mode')) {\n          clearAccentColorOverrides();\n        } else {\n          applyAccentColor(getAccentColor());\n        }\n      }\n\n      if (settings.highContrast) {\n        settings.highContrast.checked = !!enabled;\n      }\n    }\n\n    function applyReduceMotion(enabled) {\n      const root = getRoot();\n      const body = getBody();\n      if (root) {\n        root.classList.toggle('reduce-motion', Boolean(enabled));\n      }\n      if (body) {\n        body.classList.toggle('reduce-motion', Boolean(enabled));\n      }\n      if (settings.reduceMotion) {\n        settings.reduceMotion.checked = Boolean(enabled);\n      }\n\n      if (enabled) {\n        stopPinkModeAnimatedIconRotation();\n      } else if (isPinkModeActive()) {\n        startPinkModeAnimatedIconRotation();\n      }\n    }\n\n    function applyRelaxedSpacing(enabled) {\n      const root = getRoot();\n      const body = getBody();\n      if (root) {\n        root.classList.toggle('relaxed-spacing', Boolean(enabled));\n      }\n      if (body) {\n        body.classList.toggle('relaxed-spacing', Boolean(enabled));\n      }\n      if (settings.relaxedSpacing) {\n        settings.relaxedSpacing.checked = Boolean(enabled);\n      }\n    }\n\n    function stopPinkModeIconRotation() {\n      if (pinkModeIconRotationTimer) {\n        try {\n          clearInterval(pinkModeIconRotationTimer);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: unable to stop pink mode rotation.', error);\n        }\n        pinkModeIconRotationTimer = null;\n      }\n    }\n\n\n\n    function applyPinkModeIcon(iconConfig, options) {\n      if (!iconConfig) {\n        return;\n      }\n      const shouldAnimate = options && options.animate === true;\n      const toggle = elements.pinkModeToggle || null;\n      const helpIcon = elements.pinkModeHelpIcon || null;\n\n      if (toggle) {\n        setToggleIcon(toggle, iconConfig);\n      }\n\n      if (helpIcon) {\n        helpIcon.className = 'help-icon icon-glyph icon-svg pink-mode-icon';\n        helpIcon.innerHTML = iconConfig.markup || '';\n      }\n\n      if (shouldAnimate) {\n        triggerPinkModeIconAnimation();\n      }\n    }\n\n    function triggerPinkModeIconAnimation() {\n      const targets = [];\n      const toggle = elements.pinkModeToggle || null;\n      if (toggle) {\n        const toggleIcon = toggle.querySelector && toggle.querySelector('.pink-mode-icon');\n        if (toggleIcon) {\n          targets.push(toggleIcon);\n        }\n      }\n      if (elements.pinkModeHelpIcon) {\n        targets.push(elements.pinkModeHelpIcon);\n      }\n      if (!targets.length) {\n        return;\n      }\n\n      for (let index = 0; index < targets.length; index += 1) {\n        const target = targets[index];\n        try {\n          target.classList.remove(PINK_MODE_ICON_ANIMATION_CLASS);\n          if (typeof target.getBoundingClientRect === 'function') {\n            target.getBoundingClientRect();\n          }\n          target.classList.add(PINK_MODE_ICON_ANIMATION_CLASS);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: unable to animate pink mode icon.', error);\n        }\n\n        if (PINK_MODE_ICON_ANIMATION_RESET_DELAY > 0) {\n          setTimeout(() => {\n            try {\n              target.classList.remove(PINK_MODE_ICON_ANIMATION_CLASS);\n            } catch (resetError) {\n              safeWarn('cineSettingsAppearance: failed to reset pink mode animation.', resetError);\n            }\n          }, PINK_MODE_ICON_ANIMATION_RESET_DELAY);\n        }\n      }\n    }\n\n    function startPinkModeIconRotation() {\n      // Internal Fallback Definitions to ensure Unicorns always appear\n      const HORSE_SVG_MARKUP = '<svg viewBox=\"0 0 60 60\" xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\"><path d=\"m1 40c0-8 3-17 3-17a4.84 4.84 0 0 0-1.829-3.064 1 1 0 0 1 .45-1.716 19.438 19.438 0 0 1 4.379-.22c.579-2.317-1.19-3.963-2.782-4.938a1 1 0 0 1 .393-1.85 14.128 14.128 0 0 1 6.389.788c0-.958-1.147-2.145-2.342-3.122a1 1 0 0 1 .708-1.773 40.655 40.655 0 0 1 6.634.895 3.723 3.723 0 0 0-1.049-2.264 1 1 0 0 1 .823-1.652c6.151.378 9.226 1.916 9.226 1.916l10-1s8.472-2.311 15.954.5a1 1 0 0 1-.084 1.9c-1.455.394-2.87 1.143-2.87 2.6 0 0 4.426.738 5.675 4.114a1 1 0 0 1-1.228 1.317c-1.64-.48-4.273-.88-6.447.569Z\" fill=\"#805333\" /><path d=\"m30.18 42.82c1.073 2.7 2.6 9.993 3.357 13.8a2 2 0 0 1-1.964 2.38h-28.573a2 2 0 0 1-2-2v-18c0-2.55 10.03-22.11 23.99-23.87Z\" fill=\"#a56a43\" /><path d=\"m55.67 48.46-6.34 2.97a6 6 0 0 1-7.98-2.88l-.25-.54-.76-1.6a4.956 4.956 0 0 0-4.68-2.87c-.22.01-.44.02-.66.02a16.019 16.019 0 0 1-8.28-29.66c-1.81-2.97-3.45-8.03 2.03-12.49a2.1 2.1 0 0 1 2.5 0c4.23 3.45 4.21 7.25 3.16 10.17a16 16 0 0 1 15.91 11.36l5.31 11.31 2.92 6.22a6.008 6.008 0 0 1-2.88 7.99Z\" fill=\"#cb8252\" /><circle cx=\"42\" cy=\"26\" r=\"3\" fill=\"#2c2f38\" /><circle cx=\"54\" cy=\"43\" r=\"1\" fill=\"#805333\" /><path d=\"m58.55 40.47-2.92-6.22-14.53 13.76.25.54a6 6 0 0 0 7.98 2.88l6.34-2.97a6.008 6.008 0 0 0 2.88-7.99Zm-4.55 3.53a1 1 0 1 1 1-1 1 1 0 0 1-1 1Z\" fill=\"#cf976a\" /><circle cx=\"41\" cy=\"25\" r=\"1.25\" fill=\"#ecf0f1\" /></svg>';\n      const HORN_PATH = '<path d=\"m40 18 12-14-4 15.5z\" filter=\"drop-shadow(0 0 2px #fff)\" fill=\"#ffd700\" />';\n      const UNICORN_BASE_MARKUP = HORSE_SVG_MARKUP.replace('</svg>', HORN_PATH + '</svg>');\n\n      const UNICORN_1_MARKUP = UNICORN_BASE_MARKUP\n        .replace(/#805333/g, '#d63384')\n        .replace(/#a56a43/g, '#e83e8c')\n        .replace(/#cb8252/g, '#fd7e14')\n        .replace(/#cf976a/g, '#ffc0cb');\n\n      const UNICORN_2_MARKUP = UNICORN_BASE_MARKUP\n        .replace(/#805333/g, '#6f42c1')\n        .replace(/#a56a43/g, '#d63384')\n        .replace(/#cb8252/g, '#e83e8c')\n        .replace(/#cf976a/g, '#e0cffc');\n\n      const UNICORN_3_MARKUP = UNICORN_BASE_MARKUP\n        .replace(/#805333/g, '#0dcaf0')\n        .replace(/#a56a43/g, '#6f42c1')\n        .replace(/#cb8252/g, '#d63384')\n        .replace(/#cf976a/g, '#9ec5fe');\n\n      const FALLBACK_SEQUENCE = [\n        { className: 'icon-svg pink-mode-icon', markup: UNICORN_1_MARKUP, lottiePath: 'src/animations/unicorn.json' },\n        { className: 'icon-svg pink-mode-icon', markup: UNICORN_2_MARKUP, lottiePath: 'src/animations/horn.json' },\n        { className: 'icon-svg pink-mode-icon', markup: UNICORN_3_MARKUP, lottiePath: 'src/animations/rainbow.json' }\n      ];\n\n      // Force local sequence to ensure Unicorns appear regardless of external module state\n      const sequence = FALLBACK_SEQUENCE;\n\n      console.log('Pink Mode Rotation Start. Sequence Length:', sequence ? sequence.length : 'undefined');\n\n      if (!sequence.length) {\n        // Fallback to off icon if somehow even fallback sequence is empty\n        applyPinkModeIcon(icons.pinkModeIcons ? icons.pinkModeIcons.off : null, { animate: false });\n        return;\n      }\n\n      stopPinkModeIconRotation();\n\n      const toggle = elements.pinkModeToggle || null;\n      const helpIcon = elements.pinkModeHelpIcon || null;\n      if (!toggle && !helpIcon) {\n        return;\n      }\n\n      pinkModeIconIndex = 0;\n      applyPinkModeIcon(sequence[pinkModeIconIndex], { animate: true });\n      try {\n        pinkModeIconRotationTimer = setInterval(() => {\n          pinkModeIconIndex = (pinkModeIconIndex + 1) % sequence.length;\n          applyPinkModeIcon(sequence[pinkModeIconIndex], { animate: true });\n        }, PINK_MODE_ICON_INTERVAL_MS);\n        if (pinkModeIconRotationTimer && typeof pinkModeIconRotationTimer.unref === 'function') {\n          try {\n            pinkModeIconRotationTimer.unref();\n          } catch (unrefError) {\n            void unrefError;\n          }\n        }\n      } catch (error) {\n        if (pinkModeIconRotationTimer) {\n          clearInterval(pinkModeIconRotationTimer);\n        }\n        pinkModeIconRotationTimer = null;\n        safeWarn('cineSettingsAppearance: unable to schedule pink mode rotation.', error);\n      }\n    }\n\n    function clearPinkModeIconPressResetTimer() {\n      if (pinkModeIconPressResetTimer) {\n        try {\n          clearTimeout(pinkModeIconPressResetTimer);\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: unable to clear pink mode press reset timer.', error);\n        }\n        pinkModeIconPressResetTimer = null;\n      }\n    }\n\n    function schedulePinkModeIconPressReset() {\n      if (PINK_MODE_ICON_PRESS_RESET_MS <= 0) {\n        return;\n      }\n\n      clearPinkModeIconPressResetTimer();\n\n      try {\n        pinkModeIconPressResetTimer = setTimeout(() => {\n          pinkModeIconPressResetTimer = null;\n          pinkModeIconPressCount = 0;\n          pinkModeIconPressTimestamps.length = 0;\n        }, PINK_MODE_ICON_PRESS_RESET_MS);\n        if (\n          pinkModeIconPressResetTimer &&\n          typeof pinkModeIconPressResetTimer.unref === 'function'\n        ) {\n          pinkModeIconPressResetTimer.unref();\n        }\n      } catch (error) {\n        pinkModeIconPressResetTimer = null;\n        safeWarn('cineSettingsAppearance: unable to schedule pink mode press reset.', error);\n      }\n    }\n\n    function resetPinkModeIconPressCount() {\n      pinkModeIconPressCount = 0;\n      clearPinkModeIconPressResetTimer();\n      pinkModeIconPressTimestamps.length = 0;\n    }\n\n    function recordPinkModeIconPressTimestamp() {\n      const now = Date.now();\n      pinkModeIconPressTimestamps.push(now);\n\n      const burstWindow = Math.max(PINK_MODE_ICON_PRESS_BURST_WINDOW_MS, 0);\n      if (burstWindow > 0) {\n        const cutoff = now - burstWindow;\n        while (pinkModeIconPressTimestamps.length && pinkModeIconPressTimestamps[0] < cutoff) {\n          pinkModeIconPressTimestamps.shift();\n        }\n      }\n\n      return pinkModeIconPressTimestamps.length;\n    }\n\n    // --- INTERNAL PINK MODE MANAGER IMPLEMENTATION ---\n    // Inlined to guarantee functionality regardless of external module loading state.\n\n\n\n\n\n    class LocalPinkModeManager {\n      constructor() {\n        this.active = false;\n      }\n\n      activate() {\n        this.active = true;\n        document.body.classList.add('pink-mode-active');\n      }\n\n      deactivate() {\n        this.active = false;\n        document.body.classList.remove('pink-mode-active');\n      }\n\n      triggerRain() {\n        // No-op\n      }\n    }\n\n    const localPinkModeManager = new LocalPinkModeManager();\n\n\n    function triggerPinkModeIconRain() {\n      // No-op\n    }\n\n    function handlePinkModeIconPress() {\n      pinkModeIconPressCount = recordPinkModeIconPressTimestamp();\n\n      if (PINK_MODE_ICON_PRESS_RESET_MS > 0) {\n        schedulePinkModeIconPressReset();\n      }\n\n      if (pinkModeIconPressCount < 3) {\n        return;\n      }\n\n      if (PINK_MODE_ICON_PRESS_RESET_MS <= 0 && pinkModeIconPressCount > 3) {\n        pinkModeIconPressCount = 3;\n      }\n\n      triggerPinkModeIconRain();\n    }\n\n    function startPinkModeAnimatedIcons() {\n      localPinkModeManager.activate();\n      if (typeof icons.startPinkModeAnimatedIcons === 'function') {\n        icons.startPinkModeAnimatedIcons();\n      }\n    }\n\n    function stopPinkModeAnimatedIcons() {\n      localPinkModeManager.deactivate();\n      if (typeof icons.stopPinkModeAnimatedIcons === 'function') {\n        icons.stopPinkModeAnimatedIcons();\n      }\n    }\n\n    function startPinkModeAnimatedIconRotation() {\n      startPinkModeIconRotation();\n      startPinkModeAnimatedIcons();\n    }\n\n    function stopPinkModeAnimatedIconRotation() {\n      stopPinkModeAnimatedIcons();\n      stopPinkModeIconRotation();\n      resetPinkModeIconPressCount();\n    }\n\n    function applyPinkMode(enabled) {\n      const root = getRoot();\n      const body = getBody();\n      if (!root || !body) {\n        return;\n      }\n\n      if (enabled) {\n        body.classList.add('pink-mode');\n        root.classList.add('pink-mode');\n        if (accent.accentColorInput) {\n          accent.accentColorInput.disabled = true;\n        }\n        clearAccentColorOverrides();\n        if (elements.pinkModeToggle) {\n          elements.pinkModeToggle.setAttribute('aria-pressed', 'true');\n        }\n        startPinkModeAnimatedIconRotation();\n      } else {\n        stopPinkModeAnimatedIconRotation();\n        body.classList.remove('pink-mode');\n        root.classList.remove('pink-mode');\n        if (accent.accentColorInput) {\n          accent.accentColorInput.disabled = false;\n        }\n        applyAccentColor(getAccentColor());\n        if (icons.pinkModeIcons && icons.pinkModeIcons.off) {\n          applyPinkModeIcon(icons.pinkModeIcons.off, { animate: false });\n        }\n        if (elements.pinkModeToggle) {\n          elements.pinkModeToggle.setAttribute('aria-pressed', 'false');\n        }\n      }\n\n      if (settings.pinkMode) {\n        settings.pinkMode.checked = !!enabled;\n      }\n      updateAccentColorResetButtonState();\n    }\n\n    function isPinkModeActive() {\n      const body = getBody();\n      return !!(body && body.classList && body.classList.contains('pink-mode'));\n    }\n\n    function persistPinkModePreference(enabled) {\n      pinkModeEnabled = !!enabled;\n      applyPinkMode(pinkModeEnabled);\n      const storage = getLocalStorage(context);\n      if (!storage) {\n        return;\n      }\n      try {\n        storage.setItem(PINK_MODE_STORAGE_KEY, pinkModeEnabled);\n      } catch (error) {\n        safeWarn('cineSettingsAppearance: Could not save pink mode preference.', error);\n      }\n      try {\n        storage.setItem(LEGACY_PINK_MODE_STORAGE_KEY, pinkModeEnabled);\n      } catch (error) {\n        safeWarn('cineSettingsAppearance: Could not save pink mode preference.', error);\n      }\n    }\n\n    function rememberSettingsPinkModeBaseline() {\n      settingsInitialPinkMode = isPinkModeActive();\n    }\n\n    function revertSettingsPinkModeIfNeeded() {\n      if (isPinkModeActive() !== settingsInitialPinkMode) {\n        persistPinkModePreference(settingsInitialPinkMode);\n      }\n    }\n\n    function getTemperatureUnit() {\n      if (typeof preferences.getTemperatureUnit === 'function') {\n        return preferences.getTemperatureUnit();\n      }\n      return preferences.temperatureUnit || 'celsius';\n    }\n\n    function setTemperatureUnit(value) {\n      if (typeof preferences.setTemperatureUnit === 'function') {\n        preferences.setTemperatureUnit(value);\n      } else {\n        preferences.temperatureUnit = value;\n      }\n    }\n\n    function getFocusScale() {\n      if (typeof preferences.getFocusScale === 'function') {\n        return preferences.getFocusScale();\n      }\n      return preferences.focusScale || 'metric';\n    }\n\n    function setFocusScale(value) {\n      if (typeof preferences.setFocusScale === 'function') {\n        preferences.setFocusScale(value);\n      } else {\n        preferences.focusScale = value;\n      }\n    }\n\n    function rememberSettingsTemperatureUnitBaseline() {\n      const current = getTemperatureUnit();\n      settingsInitialTemperatureUnit = typeof current === 'string' ? current : 'celsius';\n    }\n\n    function revertSettingsTemperatureUnitIfNeeded() {\n      const baseline = typeof settingsInitialTemperatureUnit === 'string'\n        ? settingsInitialTemperatureUnit\n        : 'celsius';\n\n      const applyPreference = preferences.applyTemperatureUnitPreference;\n      if (typeof applyPreference === 'function') {\n        if (getTemperatureUnit() !== baseline) {\n          try {\n            applyPreference(baseline, { persist: false, forceUpdate: true });\n            setTemperatureUnit(baseline);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Failed to revert temperature unit preference.', error);\n          }\n        } else if (settings.temperatureUnit) {\n          settings.temperatureUnit.value = baseline;\n        }\n      } else if (settings.temperatureUnit) {\n        settings.temperatureUnit.value = baseline;\n      }\n    }\n\n    function rememberSettingsFocusScaleBaseline() {\n      const current = getFocusScale();\n      settingsInitialFocusScale = typeof current === 'string' ? current : 'metric';\n    }\n\n    function revertSettingsFocusScaleIfNeeded() {\n      const baseline = typeof settingsInitialFocusScale === 'string'\n        ? settingsInitialFocusScale\n        : 'metric';\n\n      const applyPreference = preferences.applyFocusScalePreference;\n      if (typeof applyPreference === 'function') {\n        if (getFocusScale() !== baseline) {\n          try {\n            applyPreference(baseline, { persist: false, forceUpdate: true });\n            setFocusScale(baseline);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Failed to revert focus scale preference.', error);\n          }\n        } else if (settings.focusScale) {\n          settings.focusScale.value = baseline;\n        }\n      } else if (settings.focusScale) {\n        settings.focusScale.value = baseline;\n      }\n    }\n\n    function getShowAutoBackups() {\n      if (typeof preferences.getShowAutoBackups === 'function') {\n        return !!preferences.getShowAutoBackups();\n      }\n      if (typeof preferences.showAutoBackups === 'boolean') {\n        return preferences.showAutoBackups;\n      }\n      return false;\n    }\n\n    function setShowAutoBackups(value) {\n      if (typeof preferences.setShowAutoBackups === 'function') {\n        preferences.setShowAutoBackups(value);\n      } else {\n        preferences.showAutoBackups = !!value;\n      }\n    }\n\n    function applyShowAutoBackupsPreference(enabled, options) {\n      const config = options && typeof options === 'object' ? options : {};\n      const persist = config.persist !== false;\n      const forceRepopulate = Boolean(config.forceRepopulate);\n      const normalized = Boolean(enabled);\n      const previousValue = getShowAutoBackups();\n      const changed = normalized !== previousValue;\n\n      setShowAutoBackups(normalized);\n\n      if (normalized && typeof preferences.ensureAutoBackupsFromProjects === 'function') {\n        callOptional(preferences.ensureAutoBackupsFromProjects);\n      }\n\n      if (persist) {\n        const storage = getLocalStorage(context);\n        if (storage) {\n          try {\n            storage.setItem('showAutoBackups', normalized);\n          } catch (error) {\n            safeWarn('cineSettingsAppearance: Could not save auto backup visibility preference.', error);\n          }\n        }\n      }\n\n      if (!changed && !forceRepopulate) {\n        if (settings.showAutoBackups) {\n          settings.showAutoBackups.checked = normalized;\n        }\n        return;\n      }\n\n      const setupSelect = autoBackups.setupSelect || null;\n      const setupNameInput = autoBackups.setupNameInput || null;\n\n      const previousSelectValue = setupSelect ? setupSelect.value : '';\n      const previousNameValue = setupNameInput ? setupNameInput.value : '';\n\n      if (typeof autoBackups.populateSetupSelect === 'function') {\n        try {\n          autoBackups.populateSetupSelect();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Failed to refresh setup selector.', error);\n        }\n      }\n\n      if (setupSelect) {\n        try {\n          if (normalized || !previousSelectValue || !previousSelectValue.startsWith('auto-backup-')) {\n            setupSelect.value = previousSelectValue;\n          } else {\n            setupSelect.value = '';\n          }\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Failed to update setup select after auto backup change.', error);\n        }\n      }\n\n      if (setupNameInput) {\n        try {\n          setupNameInput.value = previousNameValue;\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Unable to restore setup name after auto backup change.', error);\n        }\n      }\n\n      if (settings.showAutoBackups) {\n        settings.showAutoBackups.checked = normalized;\n      }\n    }\n\n    function rememberSettingsShowAutoBackupsBaseline() {\n      settingsInitialShowAutoBackups = Boolean(getShowAutoBackups());\n    }\n\n    function revertSettingsShowAutoBackupsIfNeeded() {\n      const baseline = Boolean(settingsInitialShowAutoBackups);\n      if (Boolean(getShowAutoBackups()) !== baseline) {\n        applyShowAutoBackupsPreference(baseline, { forceRepopulate: true });\n      } else if (settings.showAutoBackups) {\n        settings.showAutoBackups.checked = baseline;\n      }\n    }\n\n    function rememberSettingsMountVoltagesBaseline() {\n      if (typeof mountVoltages.rememberBaseline === 'function') {\n        try {\n          mountVoltages.rememberBaseline();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: rememberBaseline for mount voltages failed.', error);\n        }\n        return;\n      }\n      if (typeof mountVoltages.getPreferencesClone === 'function') {\n        try {\n          mountVoltages.settingsInitial = mountVoltages.getPreferencesClone();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: Failed to clone mount voltage preferences.', error);\n        }\n      }\n    }\n\n    function revertSettingsMountVoltagesIfNeeded() {\n      if (typeof mountVoltages.revertBaseline === 'function') {\n        try {\n          mountVoltages.revertBaseline();\n        } catch (error) {\n          safeWarn('cineSettingsAppearance: revertBaseline for mount voltages failed.', error);\n        }\n        return;\n      }\n\n      const cloneFn = mountVoltages.getPreferencesClone;\n      const applyFn = mountVoltages.applyPreferences;\n      const updateInputsFn = mountVoltages.updateInputsFromState;\n      const warnHelper = mountVoltages.warnMissingHelper || (() => { });\n      const supportedTypes = Array.isArray(mountVoltages.supportedTypes)\n        ? mountVoltages.supportedTypes\n        : [];\n      const defaults = mountVoltages.defaultVoltages && typeof mountVoltages.defaultVoltages === 'object'\n        ? mountVoltages.defaultVoltages\n        : {};\n\n      let baseline = mountVoltages.settingsInitial;\n      if (!baseline && typeof cloneFn === 'function') {\n        baseline = cloneFn();\n      }\n\n      let current = baseline;\n      if (typeof cloneFn === 'function') {\n        try {\n          current = cloneFn();\n        } catch (error) {\n          warnHelper('getMountVoltagePreferencesClone', error);\n        }\n      }\n\n      const changed = supportedTypes.some(type => {\n        const baselineEntry = baseline && baseline[type] ? baseline[type] : defaults[type];\n        const currentEntry = current && current[type] ? current[type] : defaults[type];\n        if (!baselineEntry || !currentEntry) {\n          return false;\n        }\n        return (\n          Number(baselineEntry.high) !== Number(currentEntry.high)\n          || Number(baselineEntry.low) !== Number(currentEntry.low)\n        );\n      });\n\n      if (changed) {\n        if (typeof applyFn === 'function') {\n          try {\n            applyFn(baseline, { persist: true, triggerUpdate: true });\n          } catch (error) {\n            warnHelper('applyMountVoltagePreferences', error);\n          }\n        }\n      } else if (typeof updateInputsFn === 'function') {\n        try {\n          updateInputsFn();\n        } catch (error) {\n          warnHelper('updateMountVoltageInputsFromState', error);\n        }\n      }\n    }\n\n    return freezeDeep({\n      updateThemeColor,\n      setToggleIcon,\n      applyDarkMode,\n      applyHighContrast,\n      applyReduceMotion,\n      applyRelaxedSpacing,\n      applyPinkMode,\n      persistPinkModePreference,\n      rememberSettingsPinkModeBaseline,\n      revertSettingsPinkModeIfNeeded,\n      rememberSettingsTemperatureUnitBaseline,\n      revertSettingsTemperatureUnitIfNeeded,\n      rememberSettingsFocusScaleBaseline,\n      revertSettingsFocusScaleIfNeeded,\n      applyShowAutoBackupsPreference,\n      rememberSettingsShowAutoBackupsBaseline,\n      revertSettingsShowAutoBackupsIfNeeded,\n      rememberSettingsMountVoltagesBaseline,\n      revertSettingsMountVoltagesIfNeeded,\n      handlePinkModeIconPress,\n      triggerPinkModeIconAnimation,\n      triggerPinkModeIconRain,\n      startPinkModeIconRotation,\n      stopPinkModeIconRotation,\n      applyPinkModeIcon,\n      startPinkModeAnimatedIcons,\n      stopPinkModeAnimatedIcons,\n      startPinkModeAnimatedIconRotation,\n      stopPinkModeAnimatedIconRotation,\n      isPinkModeActive,\n      createThemePreferenceController,\n      createPinkModePreferenceController,\n      setAccentColor,\n      setPrevAccentColor,\n      getAccentColor,\n      getPrevAccentColor,\n      setShowAutoBackups,\n      getShowAutoBackups,\n    });\n  }\n\n  function initialize(context) {\n    return createAppearanceManager(context || {});\n  }\n\n  const api = freezeDeep({\n    initialize,\n  });\n\n  informModuleGlobals('cineSettingsAppearance', api);\n\n  registerOrQueueModule(\n    'cineSettingsAppearance',\n    api,\n    {\n      category: 'ui',\n      description: 'Appearance and settings helpers for the application UI.',\n      replace: true,\n      connections: ['cineModuleGlobals', 'cineModuleEnvironment', 'cineUi'],\n    },\n    (error) => {\n      safeWarn('cineSettingsAppearance: Unable to register module.', error);\n    },\n  );\n\n  exposeGlobal('cineSettingsAppearance', api, {\n    configurable: true,\n    enumerable: false,\n    writable: false,\n  });\n\n  if (typeof module !== 'undefined' && module && module.exports) {\n    module.exports = api;\n  }\n})();\n","/**\n * @fileoverview MOUNT VOLTAGE BOOTSTRAP\n * \n * Provides global delegates and fallback state management for Mount Voltage preferences.\n * Extracted from legacy `globals-bootstrap.js`.\n * \n * @module modules/globals-mount-voltage\n */\n\nfunction resolveRuntime(scope) {\n    if (scope && scope.MOUNT_VOLTAGE_RUNTIME_EXPORTS && typeof scope.MOUNT_VOLTAGE_RUNTIME_EXPORTS === 'object') {\n        return scope.MOUNT_VOLTAGE_RUNTIME_EXPORTS;\n    }\n    return null;\n}\n\nfunction resolveRuntimeFunction(scope, name) {\n    const runtime = resolveRuntime(scope);\n    if (runtime && typeof runtime[name] === 'function') {\n        return runtime[name];\n    }\n    return null;\n}\n\nfunction assignGlobal(scope, name, value) {\n    if (!scope || typeof value !== 'function') return;\n    if (typeof scope[name] === 'function') return; // Don't overwrite existing\n    try {\n        scope[name] = value;\n    } catch (e) { /* ignore */ }\n}\n\n// --- Fallback State Management ---\n\nfunction normalizeMountVoltageDefaults(candidate) {\n    const defaults = {};\n    const types = ['V-Mount', 'Gold-Mount', 'B-Mount'];\n    for (const type of types) {\n        const source = candidate && candidate[type] ? candidate[type] : null;\n        const high = source && typeof source.high === 'number' && Number.isFinite(source.high) ? source.high : (type === 'B-Mount' ? 33.6 : 14.4);\n        const low = source && typeof source.low === 'number' && Number.isFinite(source.low) ? source.low : (type === 'B-Mount' ? 21.6 : 12);\n        defaults[type] = { high, low };\n    }\n    return defaults;\n}\n\nfunction cloneWithDefaults(scope, source) {\n    // We assume DEFAULT_MOUNT_VOLTAGES is already set by bootstrapGlobals\n    const defaults = scope.DEFAULT_MOUNT_VOLTAGES || normalizeMountVoltageDefaults({});\n    const types = scope.SUPPORTED_MOUNT_VOLTAGE_TYPES || ['V-Mount', 'Gold-Mount', 'B-Mount'];\n    const result = {};\n\n    const parseVal = (val, fallback) => {\n        if (typeof val === 'number') return Math.round(Math.min(1000, Math.max(0.1, val)) * 100) / 100;\n        if (typeof fallback === 'number') return Math.round(Math.min(1000, Math.max(0.1, fallback)) * 100) / 100;\n        return 0;\n    };\n\n    for (const type of types) {\n        const entry = source && source[type] ? source[type] : defaults[type];\n        const defaultEntry = defaults[type] || { high: 0, low: 0 };\n        result[type] = {\n            high: parseVal(entry?.high, defaultEntry.high),\n            low: parseVal(entry?.low, defaultEntry.low),\n        };\n    }\n    return result;\n}\n\nfunction persistToStorage(scope, preferences) {\n    try {\n        if (!scope.localStorage) return false;\n        const serialized = JSON.stringify(preferences);\n        const key = scope.MOUNT_VOLTAGE_STORAGE_KEY || 'cameraPowerPlanner_mountVoltages';\n        scope.localStorage.setItem(key, serialized);\n        scope.localStorage.setItem(key + '__backup', serialized);\n        return true;\n    } catch { return false; }\n}\n\n// --- Bootstrap Function ---\n\nexport function bootstrapMountVoltageGlobals(scope) {\n    if (!scope) return;\n\n    // Initialize State (Closure per scope)\n    const state = {\n        preferences: cloneWithDefaults(scope, null),\n        pendingPersist: false,\n        pendingUpdate: false\n    };\n\n    // --- Fallbacks ---\n\n    const fallbackParseVoltageValue = (value, fallback) => {\n        let numeric = Number.parseFloat(String(value).replace(',', '.'));\n        if (!Number.isFinite(numeric)) numeric = Number.parseFloat(String(fallback).replace(',', '.'));\n        if (!Number.isFinite(numeric)) return 0;\n        return Math.round(Math.min(1000, Math.max(0.1, numeric)) * 100) / 100;\n    };\n\n    const fallbackCloneMountVoltageMap = (source) => {\n        const runtimeFn = resolveRuntimeFunction(scope, 'cloneMountVoltageMap');\n        if (runtimeFn) return runtimeFn(source);\n        return cloneWithDefaults(scope, source);\n    };\n\n    const fallbackApplyMountVoltagePreferences = (preferences, options) => {\n        const runtimeFn = resolveRuntimeFunction(scope, 'applyMountVoltagePreferences');\n        if (runtimeFn) return runtimeFn(preferences, options);\n\n        state.preferences = cloneWithDefaults(scope, preferences);\n        if (options?.persist !== false) {\n            persistToStorage(scope, state.preferences);\n        }\n        return state.preferences;\n    };\n\n    const fallbackParseStoredMountVoltages = (raw) => {\n        const runtimeFn = resolveRuntimeFunction(scope, 'parseStoredMountVoltages');\n        if (runtimeFn) return runtimeFn(raw);\n        if (!raw) return null;\n        try {\n            const parsed = typeof raw === 'string' ? JSON.parse(raw) : raw;\n            return cloneWithDefaults(scope, parsed);\n        } catch { return null; }\n    };\n\n    // --- Delegate Creator ---\n    const createDelegate = (name, fallback) => {\n        return function (...args) {\n            const runtimeFn = resolveRuntimeFunction(scope, name);\n            if (runtimeFn) {\n                // Self-promote if currently assigned to this delegate\n                if (scope[name] === thisFunction) scope[name] = runtimeFn;\n                return runtimeFn.apply(this, args);\n            }\n            return fallback.apply(this, args);\n        };\n        // Reference for self-promotion check\n        const thisFunction = arguments.callee || fallback; // strict mode issue?\n        // Actually, we can't easily reference 'thisFunction' inside definition without naming it\n    };\n\n    // Better delegate creator\n    function makeDelegate(name, fallback) {\n        const delegate = function (...args) {\n            const runtimeFn = resolveRuntimeFunction(scope, name);\n            if (runtimeFn) return runtimeFn.apply(this, args);\n            return fallback.apply(this, args);\n        };\n        return delegate;\n    }\n\n    assignGlobal(scope, 'parseVoltageValue', makeDelegate('parseVoltageValue', fallbackParseVoltageValue));\n    assignGlobal(scope, 'cloneMountVoltageMap', makeDelegate('cloneMountVoltageMap', fallbackCloneMountVoltageMap));\n    assignGlobal(scope, 'applyMountVoltagePreferences', makeDelegate('applyMountVoltagePreferences', fallbackApplyMountVoltagePreferences));\n    assignGlobal(scope, 'parseStoredMountVoltages', makeDelegate('parseStoredMountVoltages', fallbackParseStoredMountVoltages));\n\n    // Simple pass-throughs or no-ops for others to save space/complexity as they are rare\n    assignGlobal(scope, 'resetMountVoltagePreferences', makeDelegate('resetMountVoltagePreferences', (opts) => fallbackApplyMountVoltagePreferences(null, opts)));\n    assignGlobal(scope, 'updateMountVoltageInputsFromState', makeDelegate('updateMountVoltageInputsFromState', () => { }));\n    assignGlobal(scope, 'persistMountVoltagePreferences', makeDelegate('persistMountVoltagePreferences', (prefs) => persistToStorage(scope, prefs)));\n    assignGlobal(scope, 'getMountVoltagePreferencesClone', makeDelegate('getMountVoltagePreferencesClone', () => cloneWithDefaults(scope, state.preferences)));\n\n    // Ensure container for visual inputs\n    if (typeof scope.mountVoltageInputs === 'undefined') scope.mountVoltageInputs = null;\n}\n","/**\n * @fileoverview CORE MODULE: Global Scope Bootstrap\n * \n * Ensures critical global state variables exist, are type-safe, and persist across reloads.\n * Replaces the legacy `globals-bootstrap.js` logic with a testable, scoped ESM module.\n * \n * @module modules/globals-bootstrap\n */\n\nimport { bootstrapMountVoltageGlobals } from './globals-mount-voltage.js';\n\nfunction __cineIsArray(value) {\n    return Array.isArray(value);\n}\n\nfunction __cineToFiniteInteger(candidate) {\n    if (candidate === null || typeof candidate === 'undefined') return null;\n    const numeric = Number(candidate);\n    if (!Number.isFinite(numeric)) return null;\n    const rounded = Math.round(numeric);\n    return Number.isFinite(rounded) ? rounded : null;\n}\n\nfunction __cineResolveGlobalValue(scope, name, fallback) {\n    let value;\n    try {\n        value = scope[name];\n    } catch (e) { /* ignore */ }\n    return typeof value === 'undefined' ? fallback : value;\n}\n\nfunction __cineCommitGlobalValue(scope, name, value) {\n    try {\n        scope[name] = value;\n    } catch (e) { /* ignore */ }\n    return value;\n}\n\nfunction ensureString(scope, name, fallback = '') {\n    let value = __cineResolveGlobalValue(scope, name);\n    if (typeof value !== 'string') value = fallback;\n    return __cineCommitGlobalValue(scope, name, value);\n}\n\nfunction ensureArray(scope, name) {\n    let value = __cineResolveGlobalValue(scope, name);\n    if (!Array.isArray(value)) value = [];\n    return __cineCommitGlobalValue(scope, name, value);\n}\n\nfunction ensureFunction(scope, name, fallback) {\n    let value = __cineResolveGlobalValue(scope, name);\n    if (typeof value !== 'function') value = fallback;\n    return __cineCommitGlobalValue(scope, name, value);\n}\n\nfunction ensureNullableObject(scope, name) {\n    let value = __cineResolveGlobalValue(scope, name);\n    if (typeof value === 'undefined') value = null;\n    return __cineCommitGlobalValue(scope, name, value);\n}\n\n// Logic Helpers\n\nfunction resolveRetentionBounds(scope) {\n    const min = resolveAutoGearBackupRetentionMin(scope);\n    let max = null;\n    const candidates = [];\n\n    if (Object.prototype.hasOwnProperty.call(scope, 'AUTO_GEAR_BACKUP_RETENTION_MAX')) candidates.push(scope.AUTO_GEAR_BACKUP_RETENTION_MAX);\n    if (Object.prototype.hasOwnProperty.call(scope, 'MAX_AUTO_BACKUPS')) candidates.push(scope.MAX_AUTO_BACKUPS);\n    if (scope.__cineStorageApi && Object.prototype.hasOwnProperty.call(scope.__cineStorageApi, 'AUTO_GEAR_BACKUP_RETENTION_MAX')) {\n        candidates.push(scope.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MAX);\n    }\n\n    for (const cand of candidates) {\n        const norm = __cineToFiniteInteger(cand);\n        if (typeof norm !== 'number') continue;\n        const bounded = norm < min ? min : norm;\n        if (max === null || bounded > max) max = bounded;\n    }\n\n    if (max === null) max = Math.max(min, 120);\n    return { min, max };\n}\n\nfunction resolveAutoGearBackupRetentionMin(scope) {\n    const candidates = [];\n    if (Object.prototype.hasOwnProperty.call(scope, 'AUTO_GEAR_BACKUP_RETENTION_MIN')) candidates.push(scope.AUTO_GEAR_BACKUP_RETENTION_MIN);\n    if (scope.__cineStorageApi && Object.prototype.hasOwnProperty.call(scope.__cineStorageApi, 'AUTO_GEAR_BACKUP_RETENTION_MIN')) {\n        candidates.push(scope.__cineStorageApi.AUTO_GEAR_BACKUP_RETENTION_MIN);\n    }\n\n    for (const cand of candidates) {\n        const norm = __cineToFiniteInteger(cand);\n        if (typeof norm === 'number' && norm >= 1) return norm < 1 ? 1 : norm;\n    }\n    return 1;\n}\n\nfunction resolveAutoGearBackupRetentionDefault(scope) {\n    const bounds = resolveRetentionBounds(scope);\n    const min = bounds.min;\n    const max = bounds.max;\n    const accessors = [];\n\n    if (typeof scope.getAutoGearBackupRetentionDefault === 'function') {\n        accessors.push(() => scope.getAutoGearBackupRetentionDefault());\n    }\n    if (scope.__cineStorageApi && typeof scope.__cineStorageApi.getAutoGearBackupRetentionDefault === 'function') {\n        accessors.push(() => scope.__cineStorageApi.getAutoGearBackupRetentionDefault());\n    }\n    accessors.push(() => Object.prototype.hasOwnProperty.call(scope, 'AUTO_GEAR_BACKUP_RETENTION_DEFAULT') ? scope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT : null);\n\n    for (const accessor of accessors) {\n        try {\n            const val = __cineToFiniteInteger(accessor());\n            if (typeof val === 'number') {\n                if (val < min) return min;\n                if (val > max) return max;\n                return val;\n            }\n        } catch (e) { /* ignore */ }\n    }\n\n    let fallback = __cineToFiniteInteger(36);\n    if (typeof fallback !== 'number') fallback = min;\n    if (fallback < min) fallback = min;\n    if (fallback > max) fallback = max;\n    return fallback;\n}\n\nfunction fallbackSafeGenerateConnectorSummary(device) {\n    if (!device || typeof device !== 'object') return '';\n    try {\n        const keys = Object.keys(device);\n        if (!keys.length) return '';\n        const primaryKey = keys[0];\n        const value = device[primaryKey];\n        const label = typeof primaryKey === 'string' ? primaryKey.replace(/_/g, ' ') : 'connector';\n        return value ? `${label}: ${value}` : label;\n    } catch { return ''; }\n}\n\nfunction fallbackLocaleSort(a, b) {\n    const strA = a == null ? '' : String(a);\n    const strB = b == null ? '' : String(b);\n    try {\n        return strA.localeCompare(strB, undefined, { sensitivity: 'accent', numeric: true });\n    } catch {\n        if (strA < strB) return -1;\n        if (strA > strB) return 1;\n        return 0;\n    }\n}\n\n// Mount Voltage Helpers\nfunction normalizeMountVoltageDefaults(candidate) {\n    const defaults = {};\n    const types = ['V-Mount', 'Gold-Mount', 'B-Mount']; // Hardcoded base types as fallback\n    for (const type of types) {\n        const source = candidate && candidate[type] ? candidate[type] : null;\n        const high = source && typeof source.high === 'number' && Number.isFinite(source.high) ? source.high : (type === 'B-Mount' ? 33.6 : 14.4);\n        const low = source && typeof source.low === 'number' && Number.isFinite(source.low) ? source.low : (type === 'B-Mount' ? 21.6 : 12);\n        defaults[type] = { high, low };\n    }\n    return defaults;\n}\n\n/**\n * Main Bootstrap Function\n * @param {Object} scope - The global scope (window, self, globalThis, or mock)\n */\nexport function bootstrapGlobals(scope) {\n    if (!scope || typeof scope !== 'object') return;\n\n    // -- Core Runtime Globals --\n    ensureString(scope, 'autoGearAutoPresetId', '');\n    ensureArray(scope, 'baseAutoGearRules');\n    ensureNullableObject(scope, 'autoGearScenarioModeSelect');\n    ensureNullableObject(scope, 'autoGearRuleNameInput');\n    ensureString(scope, 'autoGearSummaryFocus', 'all');\n    ensureArray(scope, 'autoGearMonitorDefaultControls');\n    ensureNullableObject(scope, 'iosPwaHelpDialog');\n    ensureNullableObject(scope, 'iosPwaHelpClose');\n    ensureNullableObject(scope, 'totalPowerElem');\n\n    ensureFunction(scope, 'safeGenerateConnectorSummary', fallbackSafeGenerateConnectorSummary);\n\n    ensureNullableObject(scope, 'CORE_RUNTIME_SHARED');\n    ensureNullableObject(scope, 'CORE_GLOBAL_SCOPE');\n    ensureNullableObject(scope, 'autoGearAddOwnGearSelect');\n    ensureNullableObject(scope, 'autoGearRemoveOwnGearSelect');\n    ensureNullableObject(scope, 'newSubcategorySelect');\n\n    ensureFunction(scope, 'syncAutoGearMonitorFieldVisibility', () => { });\n\n    ensureString(scope, 'currentLang', 'en');\n    ensureFunction(scope, 'localeSort', fallbackLocaleSort);\n\n    // Retention Resolvers (Bind to scope and self-update scope on run)\n    ensureFunction(scope, 'resolveAutoGearBackupRetentionMin', () => {\n        const val = resolveAutoGearBackupRetentionMin(scope);\n        if (scope && (typeof scope.AUTO_GEAR_BACKUP_RETENTION_MIN !== 'number' || !Number.isFinite(scope.AUTO_GEAR_BACKUP_RETENTION_MIN))) {\n            scope.AUTO_GEAR_BACKUP_RETENTION_MIN = val;\n        }\n        return val;\n    });\n\n    ensureFunction(scope, 'resolveAutoGearBackupRetentionDefault', () => {\n        const val = resolveAutoGearBackupRetentionDefault(scope);\n        if (scope && (typeof scope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT !== 'number' || !Number.isFinite(scope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT))) {\n            scope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT = val;\n        }\n        return val;\n    });\n\n    // Language Texts\n    ensureFunction(scope, 'getLanguageTexts', (lang) => {\n        // Simplified robust fallback logic\n        const texts = scope.texts || {};\n        const candidate = (lang || scope.DEFAULT_LANGUAGE || 'en').trim().toLowerCase();\n\n        if (texts[candidate]) return texts[candidate];\n        const short = candidate.substring(0, 2);\n        if (texts[short]) return texts[short];\n        if (texts.en) return texts.en;\n        return Object.values(texts)[0] || {};\n    });\n\n    ensureFunction(scope, 'resolveTextEntry', (primary, fallback, key, defaultVal) => {\n        const dicts = [primary, fallback].filter(d => d && typeof d === 'object');\n        for (const d of dicts) {\n            try {\n                const val = d[key];\n                if (typeof val === 'string' && val.trim()) return val.trim();\n            } catch { /* ignore */ }\n        }\n        return defaultVal !== undefined ? String(defaultVal) : '';\n    });\n\n    // -- Temperature --\n    ensureString(scope, 'TEMPERATURE_STORAGE_KEY', 'cameraPowerPlanner_temperatureUnit');\n    ensureFunction(scope, 'resolveTemperatureStorageKey', () => scope.TEMPERATURE_STORAGE_KEY);\n\n    // Temperature Units (Normalize existing or default)\n    const existingUnits = scope.TEMPERATURE_UNITS;\n    const normalizedUnits = {\n        celsius: (existingUnits?.celsius || 'celsius').trim().toLowerCase(),\n        fahrenheit: (existingUnits?.fahrenheit || 'fahrenheit').trim().toLowerCase()\n    };\n    __cineCommitGlobalValue(scope, 'TEMPERATURE_UNITS', normalizedUnits);\n\n    // Temperature Scenarios\n    const existingScenarios = __cineResolveGlobalValue(scope, 'TEMPERATURE_SCENARIOS', []);\n    const normalizedScenarios = Array.isArray(existingScenarios) ? existingScenarios.filter(s => s && s.id && s.key && s.label) : [];\n    __cineCommitGlobalValue(scope, 'TEMPERATURE_SCENARIOS', normalizedScenarios);\n\n    // Feedback Limits\n    __cineCommitGlobalValue(scope, 'FEEDBACK_TEMPERATURE_MIN', -20);\n    __cineCommitGlobalValue(scope, 'FEEDBACK_TEMPERATURE_MAX_LIMIT', 50);\n\n    // Focus Scale\n    ensureString(scope, 'FOCUS_SCALE_STORAGE_KEY', 'cameraPowerPlanner_focusScale');\n    ensureArray(scope, 'FOCUS_SCALE_VALUES');\n    if (scope.FOCUS_SCALE_VALUES.length === 0) scope.FOCUS_SCALE_VALUES = ['metric', 'imperial'];\n\n    // Mount Voltages\n    ensureArray(scope, 'SUPPORTED_MOUNT_VOLTAGE_TYPES');\n    if (scope.SUPPORTED_MOUNT_VOLTAGE_TYPES.length === 0) scope.SUPPORTED_MOUNT_VOLTAGE_TYPES = ['V-Mount', 'Gold-Mount', 'B-Mount'];\n\n    ensureNullableObject(scope, 'DEFAULT_MOUNT_VOLTAGES');\n    if (!scope.DEFAULT_MOUNT_VOLTAGES) {\n        scope.DEFAULT_MOUNT_VOLTAGES = normalizeMountVoltageDefaults({});\n    }\n\n    ensureNullableObject(scope, 'MOUNT_VOLTAGE_RUNTIME_EXPORTS');\n    if (!scope.MOUNT_VOLTAGE_RUNTIME_EXPORTS) scope.MOUNT_VOLTAGE_RUNTIME_EXPORTS = {};\n\n    // Bootstrap Global Delegates\n    bootstrapMountVoltageGlobals(scope);\n\n    ensureFunction(scope, 'syncMountVoltageResetButtonGlobal', (val) => {\n        if (scope.cineCoreMountVoltage?.syncMountVoltageResetButtonGlobal) {\n            scope.cineCoreMountVoltage.syncMountVoltageResetButtonGlobal(val);\n        } else {\n            scope.mountVoltageResetButton = val;\n        }\n        return val;\n    });\n}\n","/**\n * @fileoverview CORE WIRING HARNESS: Global Scope Bootstrap (Shim)\n * \n * Imports and executes the modern ESM bootstrap module.\n * Maintains legacy script tag compatibility.\n */\n\nimport { bootstrapGlobals } from './modules/globals-bootstrap.js';\n\n(function () {\n  const scope =\n    (typeof globalThis !== 'undefined' && globalThis) ||\n    (typeof window !== 'undefined' && window) ||\n    (typeof self !== 'undefined' && self) ||\n    (typeof global !== 'undefined' && global) ||\n    null;\n\n  if (scope) {\n    bootstrapGlobals(scope);\n  }\n})();\n","/*\n * Runtime bootstrap helpers shared across Cine Power Planner bundles.\n *\n * The helpers extracted here previously lived inside app-core-new-1.js but are now\n * shared so Part 2, legacy bundles, and Jest tests can reuse the exact same\n * orchestration without duplicating logic. The functions intentionally avoid\n * assuming any specific bundler semantics so they continue to work in offline\n * and recovery contexts where globals might be partially initialised.\n */\n\n// (function initRuntimeBootstrapNamespace() {\n'use strict';\n\n/* global CORE_GLOBAL_SCOPE, CORE_RUNTIME_STATE, cineCoreRuntimeModuleLoader */\n\n/**\n * Build an ordered list of candidate global scopes so runtime recovery can\n * gracefully fall back when the primary global object is unavailable.\n *\n * @returns {Array<object>} Ordered list of detected global scope objects.\n */\nexport function getGlobalScopeCandidates() {\n  const candidates = [];\n\n  if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE) {\n    candidates.push(CORE_GLOBAL_SCOPE);\n  }\n\n  if (typeof globalThis !== 'undefined' && globalThis) {\n    candidates.push(globalThis);\n  }\n\n  if (typeof window !== 'undefined' && window) {\n    candidates.push(window);\n  }\n\n  if (typeof self !== 'undefined' && self) {\n    candidates.push(self);\n  }\n\n  if (typeof global !== 'undefined' && global) {\n    candidates.push(global);\n  }\n\n  return candidates;\n}\n\n/**\n * Resolve the most reliable global scope candidate for bootstrapping runtime\n * state in offline/legacy recovery scenarios where globals may be partially\n * initialised.\n *\n * @returns {object|null} The first valid global scope object, or null if none exist.\n */\nexport function getPrimaryGlobalScope() {\n  const candidates = getGlobalScopeCandidates();\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (candidate && typeof candidate === 'object') {\n      return candidate;\n    }\n  }\n\n  return null;\n}\n\nfunction fallbackResolveRuntimeModuleLoader() {\n  // if (typeof require === 'function') {\n  //   try {\n  //     const requiredLoader = require('../modules/core/runtime-module-loader.js');\n  //     if (requiredLoader && typeof requiredLoader === 'object') {\n  //       return requiredLoader;\n  //     }\n  //   } catch (runtimeLoaderError) {\n  //     void runtimeLoaderError;\n  //   }\n  // }\n\n  const globalScope = getPrimaryGlobalScope();\n\n  if (\n    globalScope &&\n    typeof globalScope.cineCoreRuntimeModuleLoader === 'object' &&\n    globalScope.cineCoreRuntimeModuleLoader\n  ) {\n    return globalScope.cineCoreRuntimeModuleLoader;\n  }\n\n  if (\n    typeof cineCoreRuntimeModuleLoader !== 'undefined' &&\n    cineCoreRuntimeModuleLoader &&\n    typeof cineCoreRuntimeModuleLoader === 'object'\n  ) {\n    return cineCoreRuntimeModuleLoader;\n  }\n\n  return null;\n}\n\nfunction fallbackRequireCoreRuntimeModule(moduleId, options) {\n  const loader = fallbackResolveRuntimeModuleLoader();\n  if (loader && typeof loader.resolveCoreRuntimeModule === 'function') {\n    try {\n      return loader.resolveCoreRuntimeModule(moduleId, options);\n    } catch (moduleResolutionError) {\n      void moduleResolutionError;\n    }\n  }\n\n  return null;\n}\n\n/**\n * Expose a core runtime constant on the primary global scope to keep legacy\n * bundles and offline recovery flows aligned on shared globals.\n *\n * @param {string} name - Global property name to expose.\n * @param {*} value - Value to assign to the global property.\n * @returns {void}\n *\n * @sideEffects Mutates the primary global scope by assigning or defining a property.\n */\nexport function exposeCoreRuntimeConstant(name, value) {\n  if (typeof name !== 'string' || !name) {\n    return;\n  }\n\n  const scope = getPrimaryGlobalScope();\n  if (!scope || typeof scope !== 'object') {\n    return;\n  }\n\n  let descriptor = null;\n  try {\n    descriptor = Object.getOwnPropertyDescriptor(scope, name);\n  } catch (descriptorError) {\n    descriptor = null;\n    void descriptorError;\n  }\n\n  if (descriptor && descriptor.configurable === false && descriptor.writable === false) {\n    return;\n  }\n\n  try {\n    scope[name] = value;\n    return;\n  } catch (assignError) {\n    void assignError;\n  }\n\n  try {\n    Object.defineProperty(scope, name, {\n      configurable: true,\n      writable: true,\n      value,\n    });\n  } catch (defineError) {\n    if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n      console.warn(`Unable to expose ${name} globally`, defineError);\n    }\n  }\n}\n\nfunction exposeCoreRuntimeConstants(constants) {\n  if (!constants || typeof constants !== 'object') {\n    return;\n  }\n\n  Object.keys(constants).forEach((key) => {\n    exposeCoreRuntimeConstant(key, constants[key]);\n  });\n}\n\nconst CORE_BOOT_QUEUE_KEY = (function resolveCoreBootQueueKey(scope) {\n  const fallbackKey = '__coreRuntimeBootQueue';\n  const targetScope = scope && typeof scope === 'object' ? scope : getPrimaryGlobalScope();\n\n  if (targetScope) {\n    const existingHidden = targetScope.__cineCoreBootQueueKey;\n    const existingPublic = targetScope.CORE_BOOT_QUEUE_KEY;\n\n    if (typeof existingPublic === 'string' && existingPublic) {\n      try {\n        targetScope.__cineCoreBootQueueKey = existingPublic;\n      } catch (syncError) {\n        void syncError;\n        targetScope.__cineCoreBootQueueKey = existingPublic;\n      }\n      return existingPublic;\n    }\n\n    if (typeof existingHidden === 'string' && existingHidden) {\n      if (typeof targetScope.CORE_BOOT_QUEUE_KEY !== 'string' || !targetScope.CORE_BOOT_QUEUE_KEY) {\n        try {\n          targetScope.CORE_BOOT_QUEUE_KEY = existingHidden;\n        } catch (shadowError) {\n          void shadowError;\n          targetScope.CORE_BOOT_QUEUE_KEY = existingHidden;\n        }\n      }\n      return existingHidden;\n    }\n  }\n\n  if (targetScope) {\n    try {\n      targetScope.__cineCoreBootQueueKey = fallbackKey;\n    } catch (hiddenAssignError) {\n      void hiddenAssignError;\n      targetScope.__cineCoreBootQueueKey = fallbackKey;\n    }\n\n    try {\n      targetScope.CORE_BOOT_QUEUE_KEY = fallbackKey;\n    } catch (publicAssignError) {\n      void publicAssignError;\n      targetScope.CORE_BOOT_QUEUE_KEY = fallbackKey;\n    }\n  }\n\n  return fallbackKey;\n})(typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE ? CORE_GLOBAL_SCOPE : null);\n\nconst CORE_BOOT_QUEUE = (function bootstrapCoreBootQueue(existingQueue) {\n  if (Array.isArray(existingQueue)) {\n    return existingQueue;\n  }\n\n  const scope = typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE ? CORE_GLOBAL_SCOPE : getPrimaryGlobalScope();\n  if (scope && typeof scope === 'object') {\n    const shared = scope.cineCoreShared;\n    if (shared && typeof shared === 'object') {\n      const sharedQueue = shared[CORE_BOOT_QUEUE_KEY];\n      if (Array.isArray(sharedQueue)) {\n        return sharedQueue;\n      }\n      if (Object.isExtensible(shared)) {\n        shared[CORE_BOOT_QUEUE_KEY] = [];\n        return shared[CORE_BOOT_QUEUE_KEY];\n      }\n    }\n\n    if (!Array.isArray(scope.CORE_BOOT_QUEUE)) {\n      scope.CORE_BOOT_QUEUE = [];\n    }\n    return scope.CORE_BOOT_QUEUE;\n  }\n\n  return [];\n})(typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE ? CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE : null);\n\nif (\n  typeof CORE_GLOBAL_SCOPE === 'object' &&\n  CORE_GLOBAL_SCOPE &&\n  CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE !== CORE_BOOT_QUEUE\n) {\n  CORE_GLOBAL_SCOPE.CORE_BOOT_QUEUE = CORE_BOOT_QUEUE;\n}\n\nfunction enqueueCoreBootTask(task) {\n  if (typeof task === 'function') {\n    try {\n      CORE_BOOT_QUEUE.push(task);\n    } catch (err) {\n      void err;\n      // Fallback for test environments where CORE_BOOT_QUEUE might be frozen/broken/proxy\n      try {\n        task();\n      } catch (taskError) {\n        console.error('Failed to run fallback core boot task', taskError);\n      }\n    }\n  }\n}\n\n/**\n * Drain the core boot queue in a safe, snapshot-based sequence so legacy and\n * offline boot tasks execute deterministically without re-entrancy loops.\n *\n * @returns {void}\n *\n * @sideEffects Drains the shared boot queue and executes queued tasks.\n */\nexport function processCoreBootQueue() {\n  const queue = CORE_BOOT_QUEUE;\n  console.log('[Runtime Bootstrap] Processing boot queue. Length:', Array.isArray(queue) ? queue.length : 'invalid');\n\n  if (!Array.isArray(queue)) {\n    return;\n  }\n\n  // Prevent infinite loops if tasks re-enqueue themselves synchronously\n  // We process the current snapshot of the queue\n  const snapshot = queue.splice(0, queue.length);\n  console.log('[Runtime Bootstrap] Snapshot size:', snapshot.length);\n\n  for (let index = 0; index < snapshot.length; index += 1) {\n    const task = snapshot[index];\n    if (typeof task === 'function') {\n      try {\n        task();\n      } catch (error) {\n        console.error('Failed to process core boot task', error);\n      }\n    }\n  }\n  console.log('[Runtime Bootstrap] Queue processing complete.');\n}\n\nconst GRID_SNAP_STATE_STORAGE_KEY = '__cineGridSnapState';\n\nfunction getGridSnapStateScopes() {\n  const scopes = [];\n  const runtimeState =\n    typeof CORE_RUNTIME_STATE !== 'undefined' && CORE_RUNTIME_STATE && typeof CORE_RUNTIME_STATE === 'object'\n      ? CORE_RUNTIME_STATE\n      : null;\n\n  if (runtimeState && typeof runtimeState.getScopes === 'function') {\n    try {\n      const resolvedScopes = runtimeState.getScopes();\n      if (Array.isArray(resolvedScopes)) {\n        for (let index = 0; index < resolvedScopes.length; index += 1) {\n          const scope = resolvedScopes[index];\n          if (scope && scopes.indexOf(scope) === -1) {\n            scopes.push(scope);\n          }\n        }\n      }\n    } catch (scopeReadError) {\n      void scopeReadError;\n    }\n  }\n\n  const fallbackCandidates = getGlobalScopeCandidates();\n  for (let index = 0; index < fallbackCandidates.length; index += 1) {\n    const candidate = fallbackCandidates[index];\n    if (candidate && scopes.indexOf(candidate) === -1) {\n      scopes.push(candidate);\n    }\n  }\n\n  return scopes;\n}\n\nfunction normaliseGridSnapPreference(value, fallback = false) {\n  if (value === true || value === false) {\n    return value === true;\n  }\n\n  if (typeof value === 'string') {\n    const normalized = value.trim().toLowerCase();\n    if (!normalized) {\n      return fallback;\n    }\n    if (['true', '1', 'yes', 'on', 'enabled', 'enable'].includes(normalized)) {\n      return true;\n    }\n    if (['false', '0', 'no', 'off', 'disabled', 'disable'].includes(normalized)) {\n      return false;\n    }\n    return fallback;\n  }\n\n  if (typeof value === 'number') {\n    if (!Number.isFinite(value)) {\n      return fallback;\n    }\n    return value > 0;\n  }\n\n  if (value && typeof value === 'object') {\n    if (Object.prototype.hasOwnProperty.call(value, 'enabled')) {\n      return normaliseGridSnapPreference(value.enabled, fallback);\n    }\n    if (Object.prototype.hasOwnProperty.call(value, 'value')) {\n      return normaliseGridSnapPreference(value.value, fallback);\n    }\n  }\n\n  return fallback;\n}\n\nfunction readInitialGridSnapPreference() {\n  const scopes = getGridSnapStateScopes();\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope || typeof scope !== 'object') {\n      continue;\n    }\n\n    try {\n      if (Object.prototype.hasOwnProperty.call(scope, GRID_SNAP_STATE_STORAGE_KEY)) {\n        const stored = scope[GRID_SNAP_STATE_STORAGE_KEY];\n        const normalized = normaliseGridSnapPreference(stored, undefined);\n        if (typeof normalized === 'boolean') {\n          return normalized;\n        }\n      }\n    } catch (storageReadError) {\n      void storageReadError;\n    }\n\n    try {\n      if (Object.prototype.hasOwnProperty.call(scope, 'gridSnap')) {\n        const legacy = scope.gridSnap;\n        const normalizedLegacy = normaliseGridSnapPreference(legacy, undefined);\n        if (typeof normalizedLegacy === 'boolean') {\n          return normalizedLegacy;\n        }\n      }\n    } catch (legacyReadError) {\n      void legacyReadError;\n    }\n  }\n\n  return undefined;\n}\n\nlet gridSnapState = normaliseGridSnapPreference(readInitialGridSnapPreference(), false);\n\nfunction assignGridSnapToScope(scope, value) {\n  if (!scope || typeof scope !== 'object') {\n    return;\n  }\n\n  try {\n    scope[GRID_SNAP_STATE_STORAGE_KEY] = value;\n  } catch (assignStorageError) {\n    void assignStorageError;\n    try {\n      Object.defineProperty(scope, GRID_SNAP_STATE_STORAGE_KEY, {\n        configurable: true,\n        writable: true,\n        value,\n      });\n    } catch (defineStorageError) {\n      void defineStorageError;\n    }\n  }\n\n  try {\n    scope.gridSnap = value;\n  } catch (assignLegacyError) {\n    void assignLegacyError;\n    try {\n      Object.defineProperty(scope, 'gridSnap', {\n        configurable: true,\n        writable: true,\n        value,\n      });\n    } catch (defineLegacyError) {\n      void defineLegacyError;\n    }\n  }\n}\n\nfunction syncGridSnapStateToScopes(value, originScope = null, options = {}) {\n  const scopes = getGridSnapStateScopes();\n  const persist = options && options.persist !== false;\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope || typeof scope !== 'object') {\n      continue;\n    }\n\n    if (persist !== false) {\n      try {\n        scope[GRID_SNAP_STATE_STORAGE_KEY] = value;\n      } catch (assignStorageError) {\n        void assignStorageError;\n        try {\n          Object.defineProperty(scope, GRID_SNAP_STATE_STORAGE_KEY, {\n            configurable: true,\n            writable: true,\n            value,\n          });\n        } catch (defineStorageError) {\n          void defineStorageError;\n        }\n      }\n    }\n\n    if (originScope === scope) {\n      continue;\n    }\n\n    try {\n      scope.gridSnap = value;\n    } catch (assignLegacyError) {\n      void assignLegacyError;\n      try {\n        Object.defineProperty(scope, 'gridSnap', {\n          configurable: true,\n          writable: true,\n          value,\n        });\n      } catch (defineLegacyError) {\n        void defineLegacyError;\n      }\n    }\n  }\n\n  const primaryScope = getPrimaryGlobalScope();\n  if (primaryScope && typeof primaryScope === 'object' && persist !== false) {\n    assignGridSnapToScope(primaryScope, value);\n  }\n\n  return value;\n}\n\nfunction getGridSnapState() {\n  return gridSnapState;\n}\n\nfunction setGridSnapState(value) {\n  const normalized = normaliseGridSnapPreference(value, gridSnapState);\n  gridSnapState = normalized;\n  syncGridSnapStateToScopes(normalized);\n  return gridSnapState;\n}\n\nfunction applyLegacyGridSnapValue(value) {\n  const normalized = normaliseGridSnapPreference(value, gridSnapState);\n  gridSnapState = normalized;\n  syncGridSnapStateToScopes(normalized, null, { persist: false });\n  return gridSnapState;\n}\n\nsyncGridSnapStateToScopes(gridSnapState);\n\nfunction publishRuntimeBootstrapExports(exportsMap) {\n  if (!exportsMap || typeof exportsMap !== 'object') {\n    return;\n  }\n\n  const scope = getPrimaryGlobalScope();\n  if (!scope || typeof scope !== 'object') {\n    return;\n  }\n\n  const existingNamespace = scope.cineRuntimeBootstrapExports;\n  if (existingNamespace && typeof existingNamespace === 'object') {\n    Object.keys(exportsMap).forEach((key) => {\n      existingNamespace[key] = exportsMap[key];\n    });\n    return;\n  }\n\n  try {\n    scope.cineRuntimeBootstrapExports = exportsMap;\n  } catch (assignError) {\n    void assignError;\n  }\n}\n\nexport const runtimeBootstrapExports = {\n  fallbackResolveRuntimeModuleLoader,\n  fallbackRequireCoreRuntimeModule,\n  exposeCoreRuntimeConstant,\n  exposeCoreRuntimeConstants,\n  CORE_BOOT_QUEUE_KEY,\n  CORE_BOOT_QUEUE,\n  enqueueCoreBootTask,\n  processCoreBootQueue,\n  GRID_SNAP_STATE_STORAGE_KEY,\n  getGridSnapStateScopes,\n  normaliseGridSnapPreference,\n  readInitialGridSnapPreference,\n  syncGridSnapStateToScopes,\n  getGridSnapState,\n  setGridSnapState,\n  applyLegacyGridSnapValue,\n};\n\n// Expose critical helpers globally to prevent ReferenceErrors in other bundles\nif (typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE) {\n  if (!CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule) {\n    CORE_GLOBAL_SCOPE.fallbackRequireCoreRuntimeModule = fallbackRequireCoreRuntimeModule;\n  }\n  if (!CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant) {\n    CORE_GLOBAL_SCOPE.exposeCoreRuntimeConstant = exposeCoreRuntimeConstant;\n  }\n} else {\n  const primary = getPrimaryGlobalScope();\n  if (primary) {\n    if (!primary.fallbackRequireCoreRuntimeModule) {\n      primary.fallbackRequireCoreRuntimeModule = fallbackRequireCoreRuntimeModule;\n    }\n    if (!primary.exposeCoreRuntimeConstant) {\n      primary.exposeCoreRuntimeConstant = exposeCoreRuntimeConstant;\n    }\n  }\n}\n\n// EMERGENCY DEBUG EXPOSURE\nif (typeof window !== 'undefined') {\n  window.processCoreBootQueue = processCoreBootQueue;\n}\n\nif (typeof module !== 'undefined' && module) {\n  try {\n    module.exports = runtimeBootstrapExports;\n  } catch (moduleExportError) {\n    void moduleExportError;\n  }\n} else if (typeof exports !== 'undefined' && exports) {\n  try {\n    exports.runtimeBootstrapExports = runtimeBootstrapExports;\n  } catch (exportsAssignError) {\n    void exportsAssignError;\n  }\n}\n\npublishRuntimeBootstrapExports(runtimeBootstrapExports);\n// })();\n","/*\n * Extracted from app-core-new-1.js to keep module boundaries manageable.\n * The logic remains identical to protect autosave, offline, and localization behaviours.\n */\n\nimport { resolveCoreSupportModule } from './app-core-runtime-support.js';\n\n// Safe fallback for resolveCoreSupportModule if import fails\nconst _resolveCoreSupportModule = typeof resolveCoreSupportModule === 'function'\n  ? resolveCoreSupportModule\n  : () => null;\n\n// Safe fallbacks for undefined globals\nconst _CORE_RUNTIME_SHARED = typeof CORE_RUNTIME_SHARED !== 'undefined' ? CORE_RUNTIME_SHARED : null;\nconst _CORE_ENVIRONMENT_HELPERS = typeof CORE_ENVIRONMENT_HELPERS !== 'undefined' ? CORE_ENVIRONMENT_HELPERS : null;\n\nconst CORE_RUNTIME_CANDIDATE_SCOPE_BRIDGE = _resolveCoreSupportModule(\n  'cineCoreRuntimeCandidateScopes',\n  './modules/core/runtime-candidate-scopes.js'\n);\n\nconst CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS = _resolveCoreSupportModule(\n  'cineCoreAppRuntimeCandidateScopeSupport',\n  './modules/app-core/runtime.js'\n);\n\nconst resolveRuntimeCandidateScopeSupport =\n  (CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS &&\n    typeof CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS.resolveRuntimeCandidateScopeSupport === 'function'\n    ? CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS.resolveRuntimeCandidateScopeSupport\n    : null) ||\n  (function fallbackResolveRuntimeCandidateScopeSupport() {\n    // if (typeof require === 'function') {\n    //   try {\n    //     const required = require(\n    //       './modules/app-core/runtime.js'\n    //     );\n    //     if (\n    //       required &&\n    //       typeof required.resolveRuntimeCandidateScopeSupport === 'function'\n    //     ) {\n    //       return required.resolveRuntimeCandidateScopeSupport;\n    //     }\n    //   } catch (runtimeCandidateScopeSupportError) {\n    //     void runtimeCandidateScopeSupportError;\n    //   }\n    // }\n\n    const fallbackScopes = [\n      typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null,\n      typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n      typeof globalThis !== 'undefined' ? globalThis : null,\n      typeof window !== 'undefined' ? window : null,\n      typeof self !== 'undefined' ? self : null,\n      typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n      if (!scope || typeof scope !== 'object') {\n        continue;\n      }\n\n      try {\n        const candidate = scope.cineCoreAppRuntimeCandidateScopeSupport;\n        if (\n          candidate &&\n          typeof candidate.resolveRuntimeCandidateScopeSupport === 'function'\n        ) {\n          return candidate.resolveRuntimeCandidateScopeSupport;\n        }\n      } catch (candidateScopeSupportLookupError) {\n        void candidateScopeSupportLookupError;\n      }\n    }\n\n    return null;\n  })();\n\nconst createFallbackRuntimeCandidateScopeSupport =\n  (CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS &&\n    typeof CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS.createFallbackRuntimeCandidateScopeSupport === 'function'\n    ? CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT_TOOLS.createFallbackRuntimeCandidateScopeSupport\n    : null) ||\n  (function fallbackCreateRuntimeCandidateScopeSupport() {\n    // if (typeof require === 'function') {\n    //   try {\n    //     const required = require(\n    //       './modules/app-core/runtime.js'\n    //     );\n    //     if (\n    //       required &&\n    //       typeof required.createFallbackRuntimeCandidateScopeSupport === 'function'\n    //     ) {\n    //       return required.createFallbackRuntimeCandidateScopeSupport;\n    //     }\n    //   } catch (runtimeCandidateScopeFallbackError) {\n    //     void runtimeCandidateScopeFallbackError;\n    //   }\n    // }\n\n    const fallbackScopes = [\n      typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null,\n      typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n      typeof globalThis !== 'undefined' ? globalThis : null,\n      typeof window !== 'undefined' ? window : null,\n      typeof self !== 'undefined' ? self : null,\n      typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < fallbackScopes.length; index += 1) {\n      const scope = fallbackScopes[index];\n      if (!scope || typeof scope !== 'object') {\n        continue;\n      }\n\n      try {\n        const candidate = scope.cineCoreAppRuntimeCandidateScopeSupport;\n        if (\n          candidate &&\n          typeof candidate.createFallbackRuntimeCandidateScopeSupport === 'function'\n        ) {\n          return candidate.createFallbackRuntimeCandidateScopeSupport;\n        }\n      } catch (candidateScopeFallbackLookupError) {\n        void candidateScopeFallbackLookupError;\n      }\n    }\n\n    return null;\n  })();\n\nconst RUNTIME_CANDIDATE_SCOPE_FALLBACK_TOOLS = _resolveCoreSupportModule(\n  'cineCoreAppRuntimeCandidateScopeFallback',\n  './modules/app-core/runtime.js'\n);\n\nconst createRuntimeCandidateScopeSupportFallback =\n  (RUNTIME_CANDIDATE_SCOPE_FALLBACK_TOOLS &&\n    typeof RUNTIME_CANDIDATE_SCOPE_FALLBACK_TOOLS.createRuntimeCandidateScopeSupportFallback === 'function'\n    ? RUNTIME_CANDIDATE_SCOPE_FALLBACK_TOOLS.createRuntimeCandidateScopeSupportFallback\n    : (function resolveRuntimeCandidateScopeFallbackFactory() {\n      //     if (typeof require === 'function') {\n      //       try {\n      //         const requiredRuntimeCandidateScopeFallback = require(\n      //           './modules/app-core/runtime.js'\n      //         );\n      // if (\n      //   requiredRuntimeCandidateScopeFallback &&\n      //   typeof requiredRuntimeCandidateScopeFallback.createRuntimeCandidateScopeSupportFallback === 'function'\n      // ) {\n      //   return requiredRuntimeCandidateScopeFallback.createRuntimeCandidateScopeSupportFallback;\n      // }\n      //     } catch (runtimeCandidateScopeFallbackRequireError) {\n      //       void runtimeCandidateScopeFallbackRequireError;\n      //     }\n      //         }\n\n      return function runtimeCandidateScopeSupportFallbackFactory(options) {\n        const fallbackSupport = {\n          collectCandidateScopes() {\n            return [];\n          },\n          collectCandidateScopesWithFallback() {\n            return [];\n          },\n          resolveCandidateScopes(resolveOptions) {\n            const provided =\n              resolveOptions && Array.isArray(resolveOptions.currentCandidateScopes)\n                ? resolveOptions.currentCandidateScopes\n                : null;\n\n            return provided || [];\n          },\n          syncCandidateScopes(candidateScopes, syncOptions) {\n            const list = Array.isArray(candidateScopes) ? candidateScopes : [];\n            const assignCandidateScopes =\n              (syncOptions && typeof syncOptions.assignCurrentCandidateScopes === 'function'\n                ? syncOptions.assignCurrentCandidateScopes\n                : options && typeof options.assignCurrentCandidateScopes === 'function'\n                  ? options.assignCurrentCandidateScopes\n                  : null);\n\n            if (assignCandidateScopes) {\n              try {\n                assignCandidateScopes(list);\n              } catch (assignCandidateScopesError) {\n                void assignCandidateScopesError;\n              }\n            }\n\n            return list;\n          },\n          ensureCandidateScopes(ensureOptions) {\n            const ensureOptionsWithDefaults = ensureOptions || {};\n            const resolved = fallbackSupport.resolveCandidateScopes(\n              ensureOptionsWithDefaults\n            );\n\n            return fallbackSupport.syncCandidateScopes(\n              resolved,\n              ensureOptionsWithDefaults\n            );\n          },\n        };\n\n        return fallbackSupport;\n      };\n    })());\n\nconst FALLBACK_RUNTIME_CANDIDATE_SCOPE_SUPPORT =\n  typeof createFallbackRuntimeCandidateScopeSupport === 'function'\n    ? createFallbackRuntimeCandidateScopeSupport({\n      runtimeShared: _CORE_RUNTIME_SHARED,\n      environmentHelpers: _CORE_ENVIRONMENT_HELPERS,\n    })\n    : createRuntimeCandidateScopeSupportFallback({\n      runtimeShared: _CORE_RUNTIME_SHARED,\n      environmentHelpers: _CORE_ENVIRONMENT_HELPERS,\n      candidateScopeBridge: CORE_RUNTIME_CANDIDATE_SCOPE_BRIDGE,\n      corePartRuntimeScope:\n        typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null,\n      coreGlobalScope:\n        typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n      assignCurrentCandidateScopes(value) {\n        try {\n          CORE_RUNTIME_CANDIDATE_SCOPES = value;\n        } catch (candidateAssignError) {\n          void candidateAssignError;\n        }\n      },\n    });\n\nconst CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT =\n  (typeof resolveRuntimeCandidateScopeSupport === 'function'\n    ? resolveRuntimeCandidateScopeSupport({\n      resolveCoreSupportModule: _resolveCoreSupportModule,\n      requireFn: typeof require === 'function' ? require : null,\n      runtimeScope:\n        typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null,\n      coreGlobalScope: typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n      runtimeShared: _CORE_RUNTIME_SHARED,\n      environmentHelpers: _CORE_ENVIRONMENT_HELPERS,\n    })\n    : null) || FALLBACK_RUNTIME_CANDIDATE_SCOPE_SUPPORT;\n\nconst RUNTIME_CANDIDATE_SCOPE_RESOLVER_TOOLS = _resolveCoreSupportModule(\n  'cineCoreAppRuntimeCandidateScopeResolvers',\n  './modules/app-core/runtime.js'\n);\n\nconst createRuntimeCandidateScopeResolvers =\n  (RUNTIME_CANDIDATE_SCOPE_RESOLVER_TOOLS &&\n    typeof RUNTIME_CANDIDATE_SCOPE_RESOLVER_TOOLS.createRuntimeCandidateScopeResolvers ===\n    'function'\n    ? RUNTIME_CANDIDATE_SCOPE_RESOLVER_TOOLS.createRuntimeCandidateScopeResolvers\n    : (function resolveRuntimeCandidateScopeResolversFactory() {\n      //     if (typeof require === 'function') {\n      //       try {\n      //         const requiredRuntimeCandidateScopeResolvers = require(\n      //           './modules/app-core/runtime.js'\n      //         );\n      //         if (\n      //           requiredRuntimeCandidateScopeResolvers &&\n      //           typeof requiredRuntimeCandidateScopeResolvers.createRuntimeCandidateScopeResolvers ===\n      //             'function'\n      //         ) {\n      //           return requiredRuntimeCandidateScopeResolvers.createRuntimeCandidateScopeResolvers;\n      //         }\n      //       } catch (runtimeCandidateScopeResolversRequireError) {\n      //         void runtimeCandidateScopeResolversRequireError;\n      //       }\n      //     }\n\n      return null;\n    })());\n\nfunction createInlineRuntimeCandidateScopeResolvers(resolverOptions) {\n  const runtimeSupport =\n    resolverOptions && resolverOptions.runtimeCandidateScopeSupport\n      ? resolverOptions.runtimeCandidateScopeSupport\n      : null;\n  const fallbackSupport =\n    resolverOptions && resolverOptions.fallbackRuntimeCandidateScopeSupport\n      ? resolverOptions.fallbackRuntimeCandidateScopeSupport\n      : null;\n\n  function tryCollectWithSupport(support, primaryScope) {\n    if (!support || typeof support.collectCandidateScopes !== 'function') {\n      return null;\n    }\n\n    try {\n      const collected = support.collectCandidateScopes(primaryScope);\n      return Array.isArray(collected) ? collected : null;\n    } catch (collectCandidateScopesError) {\n      void collectCandidateScopesError;\n    }\n\n    return null;\n  }\n\n  function tryEnsureWithSupport(support, options) {\n    if (!support || typeof support.ensureCandidateScopes !== 'function') {\n      return null;\n    }\n\n    try {\n      const ensured = support.ensureCandidateScopes(options);\n      return Array.isArray(ensured) ? ensured : null;\n    } catch (ensureCandidateScopesError) {\n      void ensureCandidateScopesError;\n    }\n\n    return null;\n  }\n\n  function inlineCollectCoreRuntimeCandidateScopes(primaryScope) {\n    const collected = tryCollectWithSupport(runtimeSupport, primaryScope);\n    if (collected) {\n      return collected;\n    }\n\n    const fallbackCollected = tryCollectWithSupport(fallbackSupport, primaryScope);\n    if (fallbackCollected) {\n      return fallbackCollected;\n    }\n\n    return [];\n  }\n\n  function inlineEnsureCoreRuntimeCandidateScopes(ensureOptions) {\n    const options = ensureOptions && typeof ensureOptions === 'object' ? ensureOptions : {};\n\n    const ensured = tryEnsureWithSupport(runtimeSupport, options);\n    if (ensured && ensured.length) {\n      return ensured;\n    }\n\n    const fallbackEnsured = tryEnsureWithSupport(fallbackSupport, options);\n    if (fallbackEnsured && fallbackEnsured.length) {\n      return fallbackEnsured;\n    }\n\n    return inlineCollectCoreRuntimeCandidateScopes(options.primaryScope);\n  }\n\n  return {\n    collectCoreRuntimeCandidateScopes: inlineCollectCoreRuntimeCandidateScopes,\n    ensureCoreRuntimeCandidateScopes: inlineEnsureCoreRuntimeCandidateScopes,\n  };\n}\n\nexport const runtimeCandidateScopeResolvers =\n  (typeof createRuntimeCandidateScopeResolvers === 'function'\n    ? createRuntimeCandidateScopeResolvers({\n      runtimeCandidateScopeSupport: CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT,\n      fallbackRuntimeCandidateScopeSupport: FALLBACK_RUNTIME_CANDIDATE_SCOPE_SUPPORT,\n    })\n    : null) ||\n  createInlineRuntimeCandidateScopeResolvers({\n    runtimeCandidateScopeSupport: CORE_RUNTIME_CANDIDATE_SCOPE_SUPPORT,\n    fallbackRuntimeCandidateScopeSupport: FALLBACK_RUNTIME_CANDIDATE_SCOPE_SUPPORT,\n  });\n\nconst COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE =\n  (typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE) ||\n  (typeof globalThis !== 'undefined' && typeof globalThis === 'object' && globalThis) ||\n  (typeof window !== 'undefined' && typeof window === 'object' && window) ||\n  (typeof self !== 'undefined' && typeof self === 'object' && self) ||\n  (typeof global !== 'undefined' && typeof global === 'object' && global) ||\n  null;\n\nconst collectRuntimeCandidateScopesFromResolvers =\n  runtimeCandidateScopeResolvers &&\n    typeof runtimeCandidateScopeResolvers.collectCoreRuntimeCandidateScopes === 'function'\n    ? runtimeCandidateScopeResolvers.collectCoreRuntimeCandidateScopes\n    : inlineCollectCoreRuntimeCandidateScopes;\n\nconst collectRuntimeCandidateScopesFromGlobal =\n  COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE &&\n    typeof COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.collectCoreRuntimeCandidateScopes === 'function'\n    ? COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.collectCoreRuntimeCandidateScopes\n    : null;\n\nexport const resolvedCollectCoreRuntimeCandidateScopes =\n  collectRuntimeCandidateScopesFromGlobal || collectRuntimeCandidateScopesFromResolvers;\n\nif (\n  COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE &&\n  typeof COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.collectCoreRuntimeCandidateScopes !== 'function'\n) {\n  COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.collectCoreRuntimeCandidateScopes =\n    resolvedCollectCoreRuntimeCandidateScopes;\n}\n\n// Expose the variable name expected by legacy scripts (app-core-new-1.js)\nif (COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE) {\n  COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.resolvedCollectCoreRuntimeCandidateScopes =\n    resolvedCollectCoreRuntimeCandidateScopes;\n}\n\nexport const CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED = (function ensureCoreRuntimeCandidateScopes() {\n  const primaryScope =\n    typeof CORE_GLOBAL_SCOPE === 'object' ? CORE_GLOBAL_SCOPE : null;\n\n  const ensureFn =\n    runtimeCandidateScopeResolvers &&\n      typeof runtimeCandidateScopeResolvers.ensureCoreRuntimeCandidateScopes === 'function'\n      ? runtimeCandidateScopeResolvers.ensureCoreRuntimeCandidateScopes\n      : null;\n\n  const ensureOptions = {\n    primaryScope,\n    currentCandidateScopes:\n      typeof CORE_RUNTIME_CANDIDATE_SCOPES !== 'undefined' &&\n        CORE_RUNTIME_CANDIDATE_SCOPES &&\n        typeof CORE_RUNTIME_CANDIDATE_SCOPES.length === 'number'\n        ? CORE_RUNTIME_CANDIDATE_SCOPES\n        : null,\n    globalScope:\n      (typeof globalThis !== 'undefined' && globalThis) ||\n      (typeof window !== 'undefined' && window) ||\n      (typeof self !== 'undefined' && self) ||\n      (typeof global !== 'undefined' && global) ||\n      null,\n    assignCurrentCandidateScopes(value) {\n      try {\n        CORE_RUNTIME_CANDIDATE_SCOPES = value;\n      } catch (candidateAssignError) {\n        void candidateAssignError;\n      }\n    },\n  };\n\n  if (typeof ensureFn === 'function') {\n    try {\n      const ensuredScopes = ensureFn(ensureOptions);\n      if (Array.isArray(ensuredScopes)) {\n        return ensuredScopes;\n      }\n    } catch (ensureCandidateScopesError) {\n      void ensureCandidateScopesError;\n    }\n  }\n\n  return resolvedCollectCoreRuntimeCandidateScopes(primaryScope);\n})();\n\nif (COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE) {\n  COLLECT_RUNTIME_CANDIDATE_SCOPES_GLOBAL_SCOPE.CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED = CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED;\n  // Shim for potential loop usage where it expects it on window directly if global scope is different\n  if (typeof window !== 'undefined') {\n    window.CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED = CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED;\n  }\n}\n\n\n// Export as collectRuntimeScopeCandidates to match ESM resolution expectations\nexport const collectRuntimeScopeCandidates = resolvedCollectCoreRuntimeCandidateScopes;\nexport default CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED;\n","/**\n * Cine Power Planner Core Runtime Helpers\n *\n * Pure ESM module for fallback utilities logic.\n * Extracted from app-core-runtime-helpers.js.\n */\n\nimport { detectGlobalScope } from '../helpers/scope-utils.js';\nimport { collectRuntimeScopeCandidates } from '../../core/app-core-runtime-candidate-scopes.js';\n// NOTE: app-core-runtime-candidate-scopes.js was migrated in Batch 2. \n// It should export `collectRuntimeScopeCandidates`.\n\nexport const FALLBACK_HUMANIZE_OVERRIDES = {\n    powerDrawWatts: 'Power (W)',\n    capacity: 'Capacity (Wh)',\n    pinA: 'Pin A',\n    dtapA: 'D-Tap A',\n    mount_type: 'Mount',\n    screenSizeInches: 'Screen Size (in)',\n    brightnessNits: 'Brightness (nits)',\n    torqueNm: 'Torque (Nm)',\n    internalController: 'Internal Controller',\n    powerSource: 'Power Source',\n    batteryType: 'Battery Type',\n    connectivity: 'Connectivity',\n};\n\nexport function fallbackStableStringify(value) {\n    if (value === null) return 'null';\n    if (typeof value === 'undefined') return 'undefined';\n    if (Array.isArray(value)) {\n        let serialized = '[';\n        for (let index = 0; index < value.length; index += 1) {\n            if (index > 0) {\n                serialized += ',';\n            }\n            serialized += fallbackStableStringify(value[index]);\n        }\n        serialized += ']';\n        return serialized;\n    }\n    if (typeof value === 'object' && value) {\n        const keys = Object.keys(value).sort();\n        let serialized = '{';\n        for (let index = 0; index < keys.length; index += 1) {\n            const key = keys[index];\n            if (index > 0) {\n                serialized += ',';\n            }\n            serialized += `${JSON.stringify(key)}:${fallbackStableStringify(value[key])}`;\n        }\n        serialized += '}';\n        return serialized;\n    }\n    return JSON.stringify(value);\n}\n\nexport function fallbackHumanizeKey(key) {\n    if (key && Object.prototype.hasOwnProperty.call(FALLBACK_HUMANIZE_OVERRIDES, key)) {\n        return FALLBACK_HUMANIZE_OVERRIDES[key];\n    }\n\n    const stringValue = typeof key === 'string' ? key : String(key || '');\n    return stringValue\n        .replace(/_/g, ' ')\n        .replace(/([A-Z])/g, ' $1')\n        .replace(/^./, (c) => c.toUpperCase());\n}\n\nexport function createArrayFromCandidates(primary, shared, globalScope) {\n    const candidates = [];\n\n    if (primary && (typeof primary === 'object' || typeof primary === 'function')) {\n        candidates.push(primary);\n    }\n\n    if (shared && (typeof shared === 'object' || typeof shared === 'function')) {\n        candidates.push(shared);\n    }\n\n    if (globalScope && (typeof globalScope === 'object' || typeof globalScope === 'function')) {\n        candidates.push(globalScope);\n    }\n\n    candidates.push(\n        typeof globalThis !== 'undefined' ? globalThis : null,\n        typeof window !== 'undefined' ? window : null,\n        typeof self !== 'undefined' ? self : null,\n        typeof global !== 'undefined' ? global : null,\n    );\n\n    const resolved = [];\n    for (let index = 0; index < candidates.length; index += 1) {\n        const candidate = candidates[index];\n        if (!candidate || (typeof candidate !== 'object' && typeof candidate !== 'function')) {\n            continue;\n        }\n\n        let duplicate = false;\n        for (let check = 0; check < resolved.length; check += 1) {\n            if (resolved[check] === candidate) {\n                duplicate = true;\n                break;\n            }\n        }\n\n        if (!duplicate) {\n            resolved.push(candidate);\n        }\n    }\n\n    return resolved;\n}\n\nexport function createDefaultLanguageTexts(scope) {\n    if (\n        scope &&\n        typeof scope === 'object' &&\n        scope.texts &&\n        typeof scope.texts === 'object' &&\n        scope.texts.en &&\n        typeof scope.texts.en === 'object'\n    ) {\n        return scope.texts.en;\n    }\n\n    return {};\n}\n\nexport function fallbackNormalizeAutoGearWeightOperator(value) {\n    if (typeof value !== 'string') return 'greater';\n    const normalized = value.trim().toLowerCase();\n    if (!normalized) return 'greater';\n    if (\n        normalized === '>' ||\n        normalized === 'gt' ||\n        normalized === 'greaterthan' ||\n        normalized === 'above' ||\n        normalized === 'over'\n    ) {\n        return 'greater';\n    }\n    if (\n        normalized === '<' ||\n        normalized === 'lt' ||\n        normalized === 'lessthan' ||\n        normalized === 'below' ||\n        normalized === 'under'\n    ) {\n        return 'less';\n    }\n    if (\n        normalized === '=' ||\n        normalized === '==' ||\n        normalized === 'equal' ||\n        normalized === 'equals' ||\n        normalized === 'exactly' ||\n        normalized === 'match' ||\n        normalized === 'matches'\n    ) {\n        return 'equal';\n    }\n    return 'greater';\n}\n\nexport function fallbackNormalizeAutoGearWeightValue(value) {\n    if (typeof value === 'number' && Number.isFinite(value)) {\n        const rounded = Math.round(value);\n        return rounded >= 0 ? rounded : null;\n    }\n    if (typeof value === 'string') {\n        const trimmed = value.trim();\n        if (!trimmed) return null;\n        const sanitized = trimmed.replace(/[^0-9.,-]/g, '').replace(/,/g, '.');\n        if (!sanitized) return null;\n        const parsed = Number.parseFloat(sanitized);\n        if (!Number.isFinite(parsed)) return null;\n        const rounded = Math.round(parsed);\n        return rounded >= 0 ? rounded : null;\n    }\n    return null;\n}\n\nexport function fallbackFormatAutoGearWeight(value) {\n    if (!Number.isFinite(value)) return '';\n    try {\n        if (typeof Intl !== 'undefined' && typeof Intl.NumberFormat === 'function') {\n            return new Intl.NumberFormat().format(value);\n        }\n    } catch (error) {\n        void error;\n    }\n    return String(value);\n}\n\nfunction createFallbackGetAutoGearCameraWeightOperatorLabel(normalizeOperator, fallbackTextsFactory) {\n    return function fallbackGetAutoGearCameraWeightOperatorLabel(operator, langTexts) {\n        const textsForLang = langTexts || {};\n        const fallbackTexts = fallbackTextsFactory();\n        const normalized = normalizeOperator(operator);\n        if (normalized === 'less') {\n            return (\n                textsForLang.autoGearCameraWeightOperatorLess ||\n                fallbackTexts.autoGearCameraWeightOperatorLess ||\n                'Lighter than'\n            );\n        }\n        if (normalized === 'equal') {\n            return (\n                textsForLang.autoGearCameraWeightOperatorEqual ||\n                fallbackTexts.autoGearCameraWeightOperatorEqual ||\n                'Exactly'\n            );\n        }\n        return (\n            textsForLang.autoGearCameraWeightOperatorGreater ||\n            fallbackTexts.autoGearCameraWeightOperatorGreater ||\n            'Heavier than'\n        );\n    };\n}\n\nfunction createFallbackFormatAutoGearCameraWeight(formatWeight, getOperatorLabel) {\n    return function fallbackFormatAutoGearCameraWeight(condition, langTexts) {\n        if (!condition || !Number.isFinite(condition.value)) return '';\n        const label = getOperatorLabel(condition.operator, langTexts);\n        const formattedValue = formatWeight(condition.value);\n        if (!label) {\n            return `${formattedValue} g`;\n        }\n        return `${label} ${formattedValue} g`;\n    };\n}\n\nexport function resolveAutoGearWeightHelpers(options) {\n    const opts = options || {};\n    const shared = opts.coreShared && typeof opts.coreShared === 'object' ? opts.coreShared : null;\n    const globalScopeOverride =\n        opts.globalScope && typeof opts.globalScope === 'object' ? opts.globalScope : null;\n    const fallbackTextsFactory = function resolveFallbackTexts() {\n        return createDefaultLanguageTexts(\n            globalScopeOverride || detectGlobalScope()\n        );\n    };\n\n    const normalizeOperator =\n        shared && typeof shared.normalizeAutoGearWeightOperator === 'function'\n            ? function safeNormalizeAutoGearWeightOperator(value) {\n                try {\n                    const normalized = shared.normalizeAutoGearWeightOperator(value);\n                    return normalized || fallbackNormalizeAutoGearWeightOperator(value);\n                } catch (error) {\n                    void error;\n                }\n                return fallbackNormalizeAutoGearWeightOperator(value);\n            }\n            : fallbackNormalizeAutoGearWeightOperator;\n\n    const normalizeValue =\n        shared && typeof shared.normalizeAutoGearWeightValue === 'function'\n            ? function safeNormalizeAutoGearWeightValue(value) {\n                try {\n                    const normalized = shared.normalizeAutoGearWeightValue(value);\n                    if (typeof normalized === 'number' || normalized === null) {\n                        return normalized;\n                    }\n                } catch (error) {\n                    void error;\n                }\n                return fallbackNormalizeAutoGearWeightValue(value);\n            }\n            : fallbackNormalizeAutoGearWeightValue;\n\n    const normalizeAutoGearCameraWeightCondition =\n        shared && typeof shared.normalizeAutoGearCameraWeightCondition === 'function'\n            ? function safeNormalizeAutoGearCameraWeightCondition(condition) {\n                try {\n                    const normalized = shared.normalizeAutoGearCameraWeightCondition(condition);\n                    return normalized || null;\n                } catch (error) {\n                    void error;\n                }\n                return null;\n            }\n            : function normalizeAutoGearCameraWeightCondition() {\n                return null;\n            };\n\n    const formatWeight =\n        shared && typeof shared.formatAutoGearWeight === 'function'\n            ? function safeFormatAutoGearWeight(value) {\n                try {\n                    const formatted = shared.formatAutoGearWeight(value);\n                    if (typeof formatted === 'string') {\n                        return formatted;\n                    }\n                } catch (error) {\n                    void error;\n                }\n                return fallbackFormatAutoGearWeight(value);\n            }\n            : fallbackFormatAutoGearWeight;\n\n    const fallbackGetOperatorLabel = createFallbackGetAutoGearCameraWeightOperatorLabel(\n        normalizeOperator,\n        fallbackTextsFactory\n    );\n\n    const getOperatorLabel =\n        shared && typeof shared.getAutoGearCameraWeightOperatorLabel === 'function'\n            ? function safeGetAutoGearCameraWeightOperatorLabel(operator, langTexts) {\n                try {\n                    const label = shared.getAutoGearCameraWeightOperatorLabel(operator, langTexts);\n                    if (typeof label === 'string' && label) {\n                        return label;\n                    }\n                } catch (error) {\n                    void error;\n                }\n                return fallbackGetOperatorLabel(operator, langTexts);\n            }\n            : fallbackGetOperatorLabel;\n\n    const fallbackFormatCameraWeight = createFallbackFormatAutoGearCameraWeight(\n        formatWeight,\n        getOperatorLabel\n    );\n\n    const formatCameraWeight =\n        shared && typeof shared.formatAutoGearCameraWeight === 'function'\n            ? function safeFormatAutoGearCameraWeight(condition, langTexts) {\n                try {\n                    const formatted = shared.formatAutoGearCameraWeight(condition, langTexts);\n                    if (typeof formatted === 'string') {\n                        return formatted;\n                    }\n                } catch (error) {\n                    void error;\n                }\n                return fallbackFormatCameraWeight(condition, langTexts);\n            }\n            : fallbackFormatCameraWeight;\n\n    return {\n        normalizeAutoGearWeightOperator: normalizeOperator,\n        normalizeAutoGearWeightValue: normalizeValue,\n        normalizeAutoGearCameraWeightCondition,\n        formatAutoGearWeight: formatWeight,\n        getAutoGearCameraWeightOperatorLabel: getOperatorLabel,\n        formatAutoGearCameraWeight: formatCameraWeight,\n        fallbackGetAutoGearCameraWeightOperatorLabel: fallbackGetOperatorLabel,\n        fallbackFormatAutoGearCameraWeight: fallbackFormatCameraWeight,\n        fallbackNormalizeAutoGearCameraWeightCondition: function fallbackNormalizeAutoGearCameraWeightCondition(condition) {\n            if (!condition || typeof condition !== 'object') {\n                return null;\n            }\n            return null;\n        },\n    };\n}\n\nexport function fallbackCreateRuntimeScopeCandidates(primaryScope, sharedScope, globalScope) {\n    if (typeof collectRuntimeScopeCandidates === 'function') {\n        return collectRuntimeScopeCandidates([primaryScope, sharedScope, globalScope]);\n    }\n\n    return createArrayFromCandidates(primaryScope, sharedScope, globalScope);\n}\n\nexport function fallbackReadCoreScopeValue(name, candidates) {\n    if (typeof name !== 'string' || !name) {\n        return undefined;\n    }\n\n    if (!Array.isArray(candidates) || candidates.length === 0) {\n        return undefined;\n    }\n\n    for (let index = 0; index < candidates.length; index += 1) {\n        const scope = candidates[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n            continue;\n        }\n        try {\n            if (name in scope) {\n                const value = scope[name];\n                if (typeof value !== 'undefined') {\n                    return value;\n                }\n            }\n        } catch (readError) {\n            void readError;\n        }\n    }\n\n    return undefined;\n}\n\nexport function fallbackWriteCoreScopeValue(name, value, candidates) {\n    if (typeof name !== 'string' || !name) {\n        return false;\n    }\n\n    if (!Array.isArray(candidates) || candidates.length === 0) {\n        return false;\n    }\n\n    for (let index = 0; index < candidates.length; index += 1) {\n        const scope = candidates[index];\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n            continue;\n        }\n        try {\n            scope[name] = value;\n            return true;\n        } catch (assignError) {\n            void assignError;\n        }\n        try {\n            Object.defineProperty(scope, name, {\n                configurable: true,\n                writable: true,\n                value,\n            });\n            return true;\n        } catch (defineError) {\n            void defineError;\n        }\n    }\n\n    return false;\n}\n\nexport function fallbackDeclareCoreFallbackBinding(name, factory, candidates) {\n    const existing = fallbackReadCoreScopeValue(name, candidates);\n    if (typeof existing !== 'undefined') {\n        return existing;\n    }\n    const fallbackValue = typeof factory === 'function' ? factory() : factory;\n    fallbackWriteCoreScopeValue(name, fallbackValue, candidates);\n    return fallbackValue;\n}\n\nexport function resolveRuntimeScopeTools(options) {\n    const opts = options || {};\n    // NOTE: In ESM we can't easily detect global variable names like `CORE_PART2_RUNTIME_SCOPE` \n    // unless they are passed in or accessed via the global scope object.\n\n    // We assume the caller injects necessary scopes.\n    // If not, we try to detect global scope and read properties from it.\n\n    const globalDetetc = detectGlobalScope();\n\n    const runtimeScope =\n        typeof opts.runtimeScope !== 'undefined'\n            ? opts.runtimeScope\n            : (globalDetetc && globalDetetc.CORE_PART2_RUNTIME_SCOPE) || null;\n\n    const sharedScope =\n        typeof opts.sharedScope !== 'undefined'\n            ? opts.sharedScope\n            : (globalDetetc && globalDetetc.CORE_SHARED_SCOPE_PART2) || null;\n\n    const globalScope =\n        typeof opts.globalScope !== 'undefined'\n            ? opts.globalScope\n            : (globalDetetc && globalDetetc.CORE_GLOBAL_SCOPE) || null;\n\n    let candidates = fallbackCreateRuntimeScopeCandidates(runtimeScope, sharedScope, globalScope);\n    const resolveCoreSupportModule = opts.resolveSupportModule;\n\n    const resolver =\n        typeof resolveCoreSupportModule === 'function'\n            ? resolveCoreSupportModule\n            : null;\n\n    let runtimeScopeBridge = null;\n\n    if (resolver) {\n        try {\n            const bridgeTools = resolver('cineCoreAppRuntimeScopeBridge', './modules/app-core/runtime.js');\n            if (\n                bridgeTools &&\n                typeof bridgeTools === 'object' &&\n                typeof bridgeTools.createRuntimeScopeBridge === 'function'\n            ) {\n                runtimeScopeBridge = bridgeTools.createRuntimeScopeBridge({\n                    primaryScope: runtimeScope,\n                    additionalScopes: [sharedScope, globalScope],\n                });\n            }\n        } catch (bridgeError) {\n            void bridgeError;\n        }\n    }\n\n    if (\n        runtimeScopeBridge &&\n        typeof runtimeScopeBridge === 'object' &&\n        Array.isArray(runtimeScopeBridge.candidates) &&\n        runtimeScopeBridge.candidates.length > 0\n    ) {\n        candidates = runtimeScopeBridge.candidates;\n    }\n\n    function localFallbackRead(name) {\n        return fallbackReadCoreScopeValue(name, candidates);\n    }\n\n    function localFallbackWrite(name, value) {\n        return fallbackWriteCoreScopeValue(name, value, candidates);\n    }\n\n    function localFallbackDeclare(name, factory) {\n        return fallbackDeclareCoreFallbackBinding(name, factory, candidates);\n    }\n\n    return {\n        runtimeScopeBridge,\n        runtimeScopeCandidates: candidates,\n        readCoreScopeValue:\n            runtimeScopeBridge && typeof runtimeScopeBridge.readValue === 'function'\n                ? runtimeScopeBridge.readValue\n                : localFallbackRead,\n        writeCoreScopeValue:\n            runtimeScopeBridge && typeof runtimeScopeBridge.writeValue === 'function'\n                ? runtimeScopeBridge.writeValue\n                : localFallbackWrite,\n        declareCoreFallbackBinding:\n            runtimeScopeBridge && typeof runtimeScopeBridge.declareFallbackBinding === 'function'\n                ? runtimeScopeBridge.declareFallbackBinding\n                : localFallbackDeclare,\n        fallbackReadCoreScopeValue: localFallbackRead,\n        fallbackWriteCoreScopeValue: localFallbackWrite,\n        fallbackDeclareCoreFallbackBinding: localFallbackDeclare,\n    };\n}\n","/* global CORE_GLOBAL_SCOPE, CORE_PART2_RUNTIME_SCOPE, CORE_SHARED_SCOPE_PART2, CORE_SHARED,\n          collectRuntimeScopeCandidates, resolveCoreSupportModule */\n\n/*\n * Cine Power Planner runtime helpers (Shim).\n *\n * MIGRATION NOTE: Logic moved to `src/scripts/modules/core/runtime-helpers.js`.\n * This file remains as a backwards-compatibility shim to expose\n * global variables.\n */\n\nimport {\n  FALLBACK_HUMANIZE_OVERRIDES,\n  fallbackStableStringify,\n  fallbackHumanizeKey,\n  createArrayFromCandidates,\n  createDefaultLanguageTexts,\n  fallbackNormalizeAutoGearWeightOperator,\n  fallbackNormalizeAutoGearWeightValue,\n  fallbackFormatAutoGearWeight,\n  resolveAutoGearWeightHelpers,\n  resolveRuntimeScopeTools,\n  fallbackCreateRuntimeScopeCandidates,\n  fallbackReadCoreScopeValue,\n  fallbackWriteCoreScopeValue,\n  fallbackDeclareCoreFallbackBinding\n} from '../modules/core/runtime-helpers.js';\n\nexport {\n  FALLBACK_HUMANIZE_OVERRIDES,\n  fallbackStableStringify,\n  fallbackHumanizeKey,\n  createArrayFromCandidates,\n  createDefaultLanguageTexts,\n  fallbackNormalizeAutoGearWeightOperator,\n  fallbackNormalizeAutoGearWeightValue,\n  fallbackFormatAutoGearWeight,\n  resolveAutoGearWeightHelpers,\n  resolveRuntimeScopeTools,\n  fallbackCreateRuntimeScopeCandidates,\n  fallbackReadCoreScopeValue,\n  fallbackWriteCoreScopeValue,\n  fallbackDeclareCoreFallbackBinding\n};\n\nfunction createFallbackGetAutoGearCameraWeightOperatorLabel(normalizeOperator, fallbackTextsFactory) {\n  return function fallbackGetAutoGearCameraWeightOperatorLabel(operator, langTexts) {\n    const textsForLang = langTexts || {};\n    const fallbackTexts = fallbackTextsFactory();\n    const normalized = normalizeOperator(operator);\n    if (normalized === 'less') {\n      return (\n        textsForLang.autoGearCameraWeightOperatorLess ||\n        fallbackTexts.autoGearCameraWeightOperatorLess ||\n        'Lighter than'\n      );\n    }\n    if (normalized === 'equal') {\n      return (\n        textsForLang.autoGearCameraWeightOperatorEqual ||\n        fallbackTexts.autoGearCameraWeightOperatorEqual ||\n        'Exactly'\n      );\n    }\n    return (\n      textsForLang.autoGearCameraWeightOperatorGreater ||\n      fallbackTexts.autoGearCameraWeightOperatorGreater ||\n      'Heavier than'\n    );\n  };\n}\n\nfunction createFallbackFormatAutoGearCameraWeight(formatWeight, getOperatorLabel) {\n  return function fallbackFormatAutoGearCameraWeight(condition, langTexts) {\n    if (!condition || !Number.isFinite(condition.value)) return '';\n    const label = getOperatorLabel(condition.operator, langTexts);\n    const formattedValue = formatWeight(condition.value);\n    if (!label) {\n      return `${formattedValue} g`;\n    }\n    return `${label} ${formattedValue} g`;\n  };\n}\n\n\nexport var CORE_PART2_RUNTIME_HELPERS = (function initialisePart2RuntimeHelpers() {\n  let helpers = null;\n\n  if (typeof resolveCoreSupportModule === 'function') {\n    try {\n      const resolved = resolveCoreSupportModule(\n        'cineCorePart2RuntimeHelpers',\n        './modules/app-core/runtime.js'\n      );\n      if (resolved && typeof resolved === 'object') {\n        helpers = resolved;\n      }\n    } catch (helperResolutionError) {\n      void helperResolutionError;\n    }\n  }\n\n  if (helpers && typeof helpers === 'object') {\n    return helpers;\n  }\n\n  return {\n    resolveAutoGearWeightHelpers,\n    resolveRuntimeScopeTools,\n    fallbackStableStringify,\n    fallbackHumanizeKey,\n    fallbackNormalizeAutoGearWeightOperator,\n    fallbackNormalizeAutoGearWeightValue,\n    fallbackFormatAutoGearWeight,\n    fallbackNormalizeAutoGearCameraWeightCondition: function fallbackNormalizeAutoGearCameraWeightCondition(condition) {\n      if (!condition || typeof condition !== 'object') {\n        return null;\n      }\n      return null;\n    },\n    fallbackGetAutoGearCameraWeightOperatorLabel: createFallbackGetAutoGearCameraWeightOperatorLabel(\n      fallbackNormalizeAutoGearWeightOperator,\n      function fallbackTexts() {\n        return createDefaultLanguageTexts(\n          typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null\n        );\n      }\n    ),\n    fallbackFormatAutoGearCameraWeight: createFallbackFormatAutoGearCameraWeight(\n      fallbackFormatAutoGearWeight,\n      createFallbackGetAutoGearCameraWeightOperatorLabel(\n        fallbackNormalizeAutoGearWeightOperator,\n        function fallbackTexts() {\n          return createDefaultLanguageTexts(\n            typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null\n          );\n        }\n      )\n    ),\n    fallbackCreateRuntimeScopeCandidates,\n    fallbackReadCoreScopeValue,\n    fallbackWriteCoreScopeValue,\n    fallbackDeclareCoreFallbackBinding,\n  };\n})();\n\n\n(function exposePart2RuntimeHelpers(namespace) {\n  if (!namespace || typeof namespace !== 'object') {\n    return;\n  }\n\n  const candidateScopes = createArrayFromCandidates(\n    typeof CORE_PART2_RUNTIME_SCOPE !== 'undefined' ? CORE_PART2_RUNTIME_SCOPE : null,\n    typeof CORE_SHARED_SCOPE_PART2 !== 'undefined' ? CORE_SHARED_SCOPE_PART2 : null,\n    typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null\n  );\n\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    try {\n      const existing = scope.cineCorePart2RuntimeHelpers;\n      if (existing && typeof existing === 'object') {\n        if (typeof Object.assign === 'function') {\n          Object.assign(existing, namespace);\n        } else {\n          for (const key in namespace) {\n            if (Object.prototype.hasOwnProperty.call(namespace, key)) {\n              existing[key] = namespace[key];\n            }\n          }\n        }\n        continue;\n      }\n\n      scope.cineCorePart2RuntimeHelpers = namespace;\n    } catch (exposeError) {\n      void exposeError;\n    }\n  }\n})(CORE_PART2_RUNTIME_HELPERS);\n\n\n(function exposeRuntimeHelpersOnSharedNamespace(namespace) {\n  if (!namespace || typeof namespace !== 'object') {\n    return;\n  }\n\n  const candidateScopes = createArrayFromCandidates(\n    typeof CORE_PART2_RUNTIME_SCOPE !== 'undefined' ? CORE_PART2_RUNTIME_SCOPE : null,\n    typeof CORE_SHARED_SCOPE_PART2 !== 'undefined' ? CORE_SHARED_SCOPE_PART2 : null,\n    typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null\n  );\n\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    try {\n      if (scope.cineCoreShared && typeof scope.cineCoreShared === 'object') {\n        const sharedHelpers = scope.cineCoreShared.cineCoreRuntimeHelpers;\n        if (!sharedHelpers || typeof sharedHelpers !== 'object') {\n          scope.cineCoreShared.cineCoreRuntimeHelpers = namespace;\n        } else if (typeof Object.assign === 'function') {\n          Object.assign(sharedHelpers, namespace);\n        } else {\n          // shim assign\n        }\n      }\n    } catch (e) { void e; }\n  }\n})(CORE_PART2_RUNTIME_HELPERS);\n","/**\n * Cine Power Planner Core Runtime Shared\n *\n * Pure ESM module for runtime shared state resolution.\n * Extracted from app-core-runtime-shared.js.\n */\n\nimport { detectGlobalScope } from '../helpers/scope-utils.js';\nimport { resolveCoreSupportModule } from '../../core/app-core-runtime-support.js'; // Keep this legacy import/path per extraction source? Or migrate support?\n// NOTE: app-core-runtime-support.js is also legacy. We should really create a module for it if possible, \n// but for now we follow the plan: migrate existing to shim, create new.\n// However, Step 35 migrated app-core-runtime-support.js? Let's check status.\n// Wait, Step 32 converted app-core-runtime-support.js. \n// Ah, the task list says \"Batch 2: Medium Core Utils... Convert app-core-runtime-support.js\".\n// So it should already be a shim or module. \n// Let's assume it exports safely.\n\n// Actually, in Phase 1 (Batch 2), we converted app-core-runtime-support.js.\n// It seems it was converted to a shim but kept some logic or delegated to `modules/runtime-support.js`.\n// Let's use `modules/runtime-support.js` if available, but the original code used relative `./app-core-runtime-support.js`.\n// We should import from the shim to be safe OR check if `resolveCoreSupportModule` is in a clean ESM module.\n// Looking at file list, `runtime-support.js` exists in modules.\n\nimport { resolveCoreSupportModule as cleanResolveCoreSupportModule } from '../runtime-support.js';\n\nfunction resolveRuntimeSharedNamespaceTools() {\n    const globalScope = detectGlobalScope();\n    const runtimeScope = globalScope; // Simplified for pure ESM context\n\n    // Try finding existing tools on scopes\n    const scopes = [globalScope];\n    if (typeof window !== 'undefined') scopes.push(window);\n    if (typeof self !== 'undefined') scopes.push(self);\n\n    for (const scope of scopes) {\n        if (scope && scope.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS) {\n            return scope.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS;\n        }\n    }\n\n    const resolved = cleanResolveCoreSupportModule(\n        'cineCoreAppRuntimeSharedNamespace',\n        './modules/app-core/runtime.js'\n    );\n\n    // Write back to global scope if possible to maintain singleton\n    if (globalScope) {\n        try {\n            if (typeof globalScope.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS === 'undefined') {\n                globalScope.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS = resolved;\n            }\n        } catch (e) { void e; }\n    }\n\n    return resolved;\n}\n\nexport const CORE_RUNTIME_SHARED_NAMESPACE_TOOLS = resolveRuntimeSharedNamespaceTools();\n\nexport const RUNTIME_SHARED_BOOTSTRAP_TOOLS = cleanResolveCoreSupportModule(\n    'cineCoreAppRuntimeSharedBootstrap',\n    './modules/app-core/runtime.js'\n);\n\n// We define these locally but don't export them unless needed by the shim, \n// ensuring cleaner public API.\nconst RUNTIME_SHARED_BOOTSTRAP_RESOLVER_TOOLS = cleanResolveCoreSupportModule(\n    'cineCoreAppRuntimeSharedBootstrapResolver',\n    './modules/app-core/runtime.js'\n);\n\nfunction createInlineRuntimeSharedFallback(moduleOptions) {\n    // Basic fallback logic if bootstrap tools fail\n    return {\n        runtimeSharedNamespace: {},\n        runtimeSharedResolver: null,\n        existingRuntimeShared: null,\n        runtimeShared: {},\n        fallbackResolveRuntimeSharedFromGlobal: () => null\n    };\n}\n\nexport function resolveRuntimeSharedBootstrapResult(options = {}) {\n    const {\n        APP_CORE_BOOTSTRAP_TOOLS,\n        APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n        APP_CORE_BOOTSTRAP_SUITE,\n        APP_CORE_BOOTSTRAP_RESULTS_TOOLS,\n        CORE_RUNTIME_SHARED // Injected existing\n    } = options;\n\n    const moduleOptions = {\n        bootstrapTools: APP_CORE_BOOTSTRAP_TOOLS,\n        bootstrapFallbackTools: APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n        runtimeSharedBootstrapResolverTools: RUNTIME_SHARED_BOOTSTRAP_RESOLVER_TOOLS,\n        runtimeSharedBootstrapTools: RUNTIME_SHARED_BOOTSTRAP_TOOLS,\n        runtimeSharedNamespaceTools: CORE_RUNTIME_SHARED_NAMESPACE_TOOLS,\n        resolveCoreSupportModule: cleanResolveCoreSupportModule,\n        requireFn: null, // ESM doesn't support require\n        runtimeScope: detectGlobalScope(),\n        coreGlobalScope: detectGlobalScope(),\n        currentRuntimeShared: CORE_RUNTIME_SHARED,\n        fallbackScopes: [],\n        collectFallbackScopes: () => [],\n        createInlineRuntimeSharedFallback,\n        runtimeSharedBootstrapInlineRequirePath: null,\n        runtimeSharedBootstrapResultRequirePath: null,\n    };\n\n    if (APP_CORE_BOOTSTRAP_SUITE?.createRuntimeSharedBootstrapResult) {\n        try {\n            return APP_CORE_BOOTSTRAP_SUITE.createRuntimeSharedBootstrapResult(moduleOptions);\n        } catch (e) { void e; }\n    }\n\n    if (APP_CORE_BOOTSTRAP_RESULTS_TOOLS?.resolveRuntimeSharedBootstrapResult) {\n        try {\n            return APP_CORE_BOOTSTRAP_RESULTS_TOOLS.resolveRuntimeSharedBootstrapResult(moduleOptions);\n        } catch (e) { void e; }\n    }\n\n    if (APP_CORE_BOOTSTRAP_TOOLS?.createRuntimeSharedBootstrapResult) {\n        try {\n            return APP_CORE_BOOTSTRAP_TOOLS.createRuntimeSharedBootstrapResult(moduleOptions);\n        } catch (e) { void e; }\n    }\n\n    if (APP_CORE_BOOTSTRAP_TOOLS?.createRuntimeSharedBootstrapFallback) {\n        try {\n            return APP_CORE_BOOTSTRAP_TOOLS.createRuntimeSharedBootstrapFallback(moduleOptions);\n        } catch (e) { void e; }\n    }\n\n    return createInlineRuntimeSharedFallback(moduleOptions);\n}\n","/* global CORE_PART1_RUNTIME_SCOPE, CORE_GLOBAL_SCOPE, CORE_RUNTIME_SHARED: true */\n\n/*\n * Cine Power Planner core runtime shared (Shim).\n *\n * MIGRATION NOTE: Logic moved to `src/scripts/modules/core/runtime-shared.js`.\n * This file remains as a backwards-compatibility shim to expose\n * global variables.\n */\n\nimport {\n  APP_CORE_BOOTSTRAP_TOOLS,\n  APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n  APP_CORE_BOOTSTRAP_SUITE,\n  APP_CORE_BOOTSTRAP_RESULTS_TOOLS,\n} from './app-core-bootstrap.js';\n\nimport {\n  CORE_RUNTIME_SHARED_NAMESPACE_TOOLS as CORE_RUNTIME_SHARED_NAMESPACE_TOOLS_ESM,\n  RUNTIME_SHARED_BOOTSTRAP_TOOLS as RUNTIME_SHARED_BOOTSTRAP_TOOLS_ESM,\n  resolveRuntimeSharedBootstrapResult\n} from '../modules/core/runtime-shared.js';\n\nimport { resolveCoreSupportModule } from './app-core-runtime-support.js';\n\nexport var CORE_RUNTIME_SHARED_NAMESPACE_TOOLS = CORE_RUNTIME_SHARED_NAMESPACE_TOOLS_ESM;\nexport var RUNTIME_SHARED_BOOTSTRAP_TOOLS = RUNTIME_SHARED_BOOTSTRAP_TOOLS_ESM;\n\n// Resolve the bootstrap result using injected legacy globals\nvar runtimeSharedBootstrapResult = resolveRuntimeSharedBootstrapResult({\n  APP_CORE_BOOTSTRAP_TOOLS,\n  APP_CORE_BOOTSTRAP_FALLBACK_TOOLS,\n  APP_CORE_BOOTSTRAP_SUITE,\n  APP_CORE_BOOTSTRAP_RESULTS_TOOLS,\n  CORE_RUNTIME_SHARED: typeof CORE_RUNTIME_SHARED !== 'undefined' ? CORE_RUNTIME_SHARED : null\n});\n\nexport var CORE_RUNTIME_SHARED_NAMESPACE =\n  runtimeSharedBootstrapResult && runtimeSharedBootstrapResult.runtimeSharedNamespace\n    ? runtimeSharedBootstrapResult.runtimeSharedNamespace\n    : null;\n\nexport var CORE_RUNTIME_SHARED_RESOLVER =\n  runtimeSharedBootstrapResult &&\n    typeof runtimeSharedBootstrapResult.runtimeSharedResolver === 'function'\n    ? runtimeSharedBootstrapResult.runtimeSharedResolver\n    : null;\n\nexport var EXISTING_CORE_RUNTIME_SHARED =\n  (runtimeSharedBootstrapResult &&\n    runtimeSharedBootstrapResult.existingRuntimeShared &&\n    typeof runtimeSharedBootstrapResult.existingRuntimeShared === 'object'\n    ? runtimeSharedBootstrapResult.existingRuntimeShared\n    : null) ||\n  (typeof CORE_RUNTIME_SHARED !== 'undefined' && CORE_RUNTIME_SHARED\n    ? CORE_RUNTIME_SHARED\n    : null);\n\nvar fallbackResolveRuntimeSharedFromGlobal =\n  runtimeSharedBootstrapResult &&\n    typeof runtimeSharedBootstrapResult.fallbackResolveRuntimeSharedFromGlobal ===\n    'function'\n    ? runtimeSharedBootstrapResult.fallbackResolveRuntimeSharedFromGlobal\n    : function fallbackResolveRuntimeSharedFromGlobal() {\n      return null;\n    };\n\n\nexport var CORE_RUNTIME_SHARED =\n  (runtimeSharedBootstrapResult &&\n    runtimeSharedBootstrapResult.runtimeShared &&\n    typeof runtimeSharedBootstrapResult.runtimeShared === 'object'\n    ? runtimeSharedBootstrapResult.runtimeShared\n    : null) ||\n  (EXISTING_CORE_RUNTIME_SHARED && typeof EXISTING_CORE_RUNTIME_SHARED === 'object'\n    ? EXISTING_CORE_RUNTIME_SHARED\n    : null) ||\n  (CORE_RUNTIME_SHARED_RESOLVER\n    ? (function resolveRuntimeSharedWithResolver() {\n      try {\n        const resolved = CORE_RUNTIME_SHARED_RESOLVER({\n          currentShared: EXISTING_CORE_RUNTIME_SHARED,\n          resolveCoreSupportModule,\n          requireFn: typeof require === 'function' ? require : null,\n          runtimeScope:\n            typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null,\n          coreGlobalScope: typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n        });\n\n        if (resolved && typeof resolved === 'object') {\n          return resolved;\n        }\n      } catch (runtimeSharedResolverError) {\n        void runtimeSharedResolverError;\n      }\n\n      return null;\n    })()\n    : null) ||\n  fallbackResolveRuntimeSharedFromGlobal() ||\n  Object.create(null);\n\nif (typeof window !== 'undefined') {\n  window.CORE_RUNTIME_SHARED_NAMESPACE_TOOLS = CORE_RUNTIME_SHARED_NAMESPACE_TOOLS;\n  window.RUNTIME_SHARED_BOOTSTRAP_TOOLS = RUNTIME_SHARED_BOOTSTRAP_TOOLS;\n  window.CORE_RUNTIME_SHARED_NAMESPACE = CORE_RUNTIME_SHARED_NAMESPACE;\n  window.CORE_RUNTIME_SHARED_RESOLVER = CORE_RUNTIME_SHARED_RESOLVER;\n  window.EXISTING_CORE_RUNTIME_SHARED = EXISTING_CORE_RUNTIME_SHARED;\n  window.CORE_RUNTIME_SHARED = CORE_RUNTIME_SHARED;\n  window.cineCoreRuntimeShared = CORE_RUNTIME_SHARED;\n}\n","/**\n * Cine Power Planner Freeze Registry\n *\n * Pure ESM module for managing a registry of frozen objects.\n * Tracks immutably frozen objects to prevent accidental re-freezing\n * and provides shared singleton access for cross-module coordination.\n *\n * @module helpers/freeze-registry\n * @see {@link ../runtime-environment.js} for the aggregate API\n * @see {@link ../../docs/dev/architecture/runtime-environment.md} for architecture docs\n *\n * Extracted from app-core-environment.js during Vite migration (Step 24).\n */\n\n/**\n * Creates a new freeze registry. Prefers WeakSet, falls back to array.\n * @returns {WeakSet|Array} The freeze registry.\n */\nexport function createFreezeRegistry() {\n    return typeof WeakSet === 'function' ? new WeakSet() : [];\n}\n\n/**\n * Checks if a value is present in the freeze registry.\n * @param {WeakSet|Array} registry - The freeze registry.\n * @param {object} value - The value to check.\n * @returns {boolean} True if the value is in the registry.\n */\nexport function freezeRegistryHas(registry, value) {\n    if (!value || !registry) {\n        return false;\n    }\n\n    if (typeof registry.has === 'function') {\n        try {\n            return registry.has(value);\n        } catch (e) {\n            void e;\n            return false;\n        }\n    }\n\n    // Array fallback\n    if (Array.isArray(registry)) {\n        for (let i = 0; i < registry.length; i++) {\n            if (registry[i] === value) {\n                return true;\n            }\n        }\n    }\n\n    return false;\n}\n\n/**\n * Adds a value to the freeze registry.\n * @param {WeakSet|Array} registry - The freeze registry.\n * @param {object} value - The value to add.\n */\nexport function freezeRegistryAdd(registry, value) {\n    if (!value || !registry) {\n        return;\n    }\n\n    if (typeof registry.add === 'function') {\n        try {\n            registry.add(value);\n        } catch (e) {\n            void e;\n        }\n        return;\n    }\n\n    // Array fallback\n    if (Array.isArray(registry)) {\n        for (let i = 0; i < registry.length; i++) {\n            if (registry[i] === value) {\n                return;\n            }\n        }\n        registry.push(value);\n    }\n}\n\n// Singleton registry for convenience\nlet _sharedRegistry = null;\n\n/**\n * Gets a shared, global freeze registry. Lazily created on first call.\n * @returns {WeakSet|Array} The shared freeze registry.\n */\nexport function getSharedFreezeRegistry() {\n    if (!_sharedRegistry) {\n        _sharedRegistry = createFreezeRegistry();\n    }\n    return _sharedRegistry;\n}\n\n/**\n * Checks if a value is in the shared freeze registry.\n * @param {object} value - The value to check.\n * @returns {boolean} True if in the shared registry.\n */\nexport function sharedFreezeRegistryHas(value) {\n    return freezeRegistryHas(getSharedFreezeRegistry(), value);\n}\n\n/**\n * Adds a value to the shared freeze registry.\n * @param {object} value - The value to add.\n */\nexport function sharedFreezeRegistryAdd(value) {\n    freezeRegistryAdd(getSharedFreezeRegistry(), value);\n}\n","/**\n * Cine Power Planner Global Scope Helpers\n *\n * Pure ESM module for reading, writing, and ensuring global values.\n * Provides safe access to global scope properties across browser, worker,\n * and Node environments without throwing errors on undefined values.\n *\n * @module helpers/global-scope\n * @see {@link ../runtime-environment.js} for the aggregate API\n * @see {@link ../../docs/dev/architecture/runtime-environment.md} for architecture docs\n *\n * Extracted from app-core-environment.js during Vite migration (Step 24).\n */\n\nimport { collectCandidateScopes, detectGlobalScope } from './scope-utils.js';\n\n/**\n * Reads a value from the first scope that has the property.\n * @param {string} name - The property name.\n * @param {object[]} [scopes] - Scopes to search. Defaults to collected candidate scopes.\n * @returns {*} The value, or undefined if not found.\n */\nexport function readGlobalScopeValue(name, scopes) {\n    const searchScopes = Array.isArray(scopes) && scopes.length > 0 ? scopes : collectCandidateScopes();\n\n    for (let i = 0; i < searchScopes.length; i++) {\n        const scope = searchScopes[i];\n        if (!scope || typeof scope !== 'object') {\n            continue;\n        }\n\n        try {\n            if (name in scope) {\n                return scope[name];\n            }\n        } catch (e) {\n            void e;\n        }\n    }\n\n    return undefined;\n}\n\n/**\n * Writes a value to the first available scope.\n * @param {string} name - The property name.\n * @param {*} value - The value to write.\n * @param {object[]} [scopes] - Scopes to try. Defaults to collected candidate scopes.\n * @returns {boolean} True if write was successful.\n */\nexport function writeGlobalScopeValue(name, value, scopes) {\n    const searchScopes = Array.isArray(scopes) && scopes.length > 0 ? scopes : collectCandidateScopes();\n\n    for (let i = 0; i < searchScopes.length; i++) {\n        const scope = searchScopes[i];\n        if (!scope || typeof scope !== 'object') {\n            continue;\n        }\n\n        try {\n            scope[name] = value;\n            return true;\n        } catch (e) {\n            void e;\n        }\n    }\n\n    return false;\n}\n\n/**\n * Ensures a global value exists. If not, sets it using the fallback.\n * @param {string} name - The property name.\n * @param {function|*} fallbackValue - A value or factory function for the fallback.\n * @param {object[]} [scopes] - Scopes to search. Defaults to collected candidate scopes.\n * @returns {*} The existing or newly set value.\n */\nexport function ensureGlobalFallback(name, fallbackValue, scopes) {\n    const fallbackProvider =\n        typeof fallbackValue === 'function'\n            ? fallbackValue\n            : () => fallbackValue;\n\n    const searchScopes = Array.isArray(scopes) && scopes.length > 0 ? scopes : collectCandidateScopes();\n\n    for (let i = 0; i < searchScopes.length; i++) {\n        const scope = searchScopes[i];\n        if (!scope || typeof scope !== 'object') {\n            continue;\n        }\n\n        try {\n            if (typeof scope[name] === 'undefined') {\n                scope[name] = fallbackProvider();\n            }\n            return scope[name];\n        } catch (e) {\n            void e;\n        }\n    }\n\n    try {\n        return fallbackProvider();\n    } catch (e) {\n        void e;\n        return undefined;\n    }\n}\n\n/**\n * Ensures a global value passes a validator. If not, resets it using the fallback.\n * @param {string} name - The property name.\n * @param {function(value): boolean} validator - A function that returns true if the value is valid.\n * @param {function|*} fallbackValue - A value or factory function for the fallback.\n * @param {object[]} [scopes] - Scopes to modify. Defaults to collected candidate scopes.\n */\nexport function normaliseGlobalValue(name, validator, fallbackValue, scopes) {\n    const fallbackProvider =\n        typeof fallbackValue === 'function'\n            ? fallbackValue\n            : () => fallbackValue;\n\n    const searchScopes = Array.isArray(scopes) && scopes.length > 0 ? scopes : collectCandidateScopes();\n\n    for (let i = 0; i < searchScopes.length; i++) {\n        const scope = searchScopes[i];\n        if (!scope || typeof scope !== 'object') {\n            continue;\n        }\n\n        try {\n            if (!validator(scope[name])) {\n                scope[name] = fallbackProvider();\n            }\n        } catch (e) {\n            void e;\n        }\n    }\n}\n","/**\n * Cine Power Planner Auto Gear Helpers\n *\n * Pure ESM module for managing Auto Gear global fallbacks and repairs.\n * Provides utilities to ensure Auto Gear globals exist and are properly\n * initialized across different runtime environments.\n *\n * @module helpers/auto-gear\n * @see {@link ../runtime-environment.js} for the aggregate API\n * @see {@link ../../docs/dev/architecture/auto-gear-engine.md} for architecture docs\n *\n * Extracted from app-core-environment.js during Vite migration (Step 24).\n */\n\n// Fallback providers for Auto Gear globals\nexport const AUTO_GEAR_GLOBAL_FALLBACKS = {\n    autoGearAutoPresetId: () => '',\n    baseAutoGearRules: () => [],\n    autoGearScenarioModeSelect: () => null,\n    autoGearRuleNameInput: () => null,\n    autoGearSummaryFocus: () => 'all',\n    autoGearMonitorDefaultControls: () => [],\n    safeGenerateConnectorSummary: () => {\n        // This will be overridden or handled by the connectors module,\n        // but we keep the key here for completeness of the registry.\n        return () => '';\n    },\n    totalPowerElem: () => null,\n};\n\nexport const AUTO_GEAR_REFERENCE_NAMES = Object.keys(AUTO_GEAR_GLOBAL_FALLBACKS);\n\n/**\n * Checks if an error is a ReferenceError related to Auto Gear globals.\n * @param {Error} error - The error to check.\n * @returns {boolean} True if it is an Auto Gear reference error.\n */\nexport function isAutoGearGlobalReferenceError(error) {\n    if (!error || typeof error !== 'object') {\n        return false;\n    }\n\n    const message = typeof error.message === 'string' ? error.message : '';\n    return (\n        error.name === 'ReferenceError' &&\n        AUTO_GEAR_REFERENCE_NAMES.some((name) => message.indexOf(name) !== -1)\n    );\n}\n\n/**\n * Ensures a global variable for Auto Gear exists in the given scope.\n * Tries validation, property definition, and direct assignment.\n * @param {object} scope - The scope to check (e.g., window).\n * @param {string} name - The name of the global variable.\n */\nexport function ensureAutoGearGlobal(scope, name) {\n    const createFallback = AUTO_GEAR_GLOBAL_FALLBACKS[name];\n    if (typeof createFallback !== 'function') {\n        return;\n    }\n\n    const fallbackValue = createFallback();\n\n    if (typeof scope[name] === 'undefined') {\n        try {\n            scope[name] = fallbackValue;\n        } catch (assignmentError) {\n            try {\n                Object.defineProperty(scope, name, {\n                    configurable: true,\n                    writable: true,\n                    enumerable: false,\n                    value: fallbackValue,\n                });\n            } catch (defineError) {\n                void defineError;\n            }\n        }\n    }\n\n    // Attempt to fix binding issues in some environments (e.g. older webviews)\n    try {\n        const globalFn = (scope && scope.Function) || Function;\n        if (typeof globalFn === 'function') {\n            const binder = globalFn(\n                'value',\n                'if (typeof ' +\n                name +\n                \" === 'undefined') { var \" +\n                name +\n                \" = value; } else { \" +\n                name +\n                ' = value; }\\n           return ' +\n                name +\n                ';'\n            );\n            const appliedValue = typeof scope[name] === 'undefined' ? fallbackValue : scope[name];\n            binder(appliedValue);\n        }\n    } catch (bindingError) {\n        void bindingError;\n    }\n}\n\n/**\n * repairs all Auto Gear globals in the given scope.\n * @param {object} scope - The scope to repair.\n */\nexport function repairAutoGearGlobals(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        return;\n    }\n\n    for (let index = 0; index < AUTO_GEAR_REFERENCE_NAMES.length; index += 1) {\n        const name = AUTO_GEAR_REFERENCE_NAMES[index];\n        try {\n            ensureAutoGearGlobal(scope, name);\n        } catch (ensureError) {\n            void ensureError;\n        }\n    }\n}\n","/**\n * Cine Power Planner Connector Helpers\n *\n * Pure ESM module for generating connector summaries.\n * Provides a fallback generator when primary bindings are unavailable.\n *\n * @module helpers/connectors\n * @see {@link ../runtime-environment.js} for the aggregate API\n * @see {@link ../../docs/dev/architecture/runtime-environment.md} for architecture docs\n *\n * Extracted from app-core-environment.js during Vite migration (Step 24).\n */\n\n/**\n * Creates a fallback function for generating connector summaries.\n * Used when the primary generator is unavailable.\n * @returns {function(object): string} The connector summary generator.\n */\nexport function createFallbackSafeGenerateConnectorSummary() {\n    return function safeGenerateConnectorSummary(device) {\n        if (!device || typeof device !== 'object') {\n            return '';\n        }\n\n        // Try global function if available (legacy binding)\n        if (typeof globalThis.generateConnectorSummary === 'function') {\n            try {\n                return globalThis.generateConnectorSummary(device);\n            } catch (generatorError) {\n                if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n                    console.warn('generateConnectorSummary failed, using fallback', generatorError);\n                }\n            }\n        }\n\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n            console.warn(\n                'Using fallback connector summary generator. Core bindings may have failed to initialise.',\n            );\n        }\n\n        try {\n            const keys = Object.keys(device);\n            if (!keys.length) {\n                return '';\n            }\n\n            const primaryKey = keys[0];\n            const value = device[primaryKey];\n            const label = typeof primaryKey === 'string' ? primaryKey.replace(/_/g, ' ') : 'connector';\n            return value ? `${label}: ${value}` : label;\n        } catch (fallbackError) {\n            void fallbackError;\n            return '';\n        }\n    };\n}\n","/**\n * Cine Power Planner Runtime Environment\n *\n * Aggregate ESM module for environment and runtime state utilities.\n * Unifies scope collection, freeze registries, global value management,\n * and auxiliary helpers (Auto Gear, Icons, Connectors) into a single API.\n *\n * This is the primary entry point for runtime utilities in modern ESM code.\n * Legacy code should continue using app-core-environment.js which imports\n * from this module and exposes globals for backward compatibility.\n *\n * @module runtime-environment\n * @see {@link ./docs/dev/architecture/runtime-environment.md} for architecture docs\n * @see {@link ./helpers/scope-utils.js} for scope detection\n * @see {@link ./helpers/freeze-registry.js} for freeze tracking\n * @see {@link ./helpers/global-scope.js} for global value access\n * @see {@link ./helpers/auto-gear.js} for Auto Gear utilities\n * @see {@link ./helpers/icons.js} for icon utilities\n * @see {@link ./helpers/connectors.js} for connector utilities\n *\n * Created during Vite migration (Step 24) to consolidate environment helpers.\n */\n\nimport {\n    detectGlobalScope,\n    collectCandidateScopes,\n    tryRequire,\n    resolveFromScopes,\n    getCachedGlobalValue\n} from './helpers/scope-utils.js';\n\nimport {\n    createFreezeRegistry,\n    freezeRegistryHas,\n    freezeRegistryAdd,\n    getSharedFreezeRegistry,\n    sharedFreezeRegistryHas,\n    sharedFreezeRegistryAdd\n} from './helpers/freeze-registry.js';\n\nimport {\n    readGlobalScopeValue,\n    writeGlobalScopeValue,\n    ensureGlobalFallback,\n    normaliseGlobalValue\n} from './helpers/global-scope.js';\n\nimport {\n    AUTO_GEAR_GLOBAL_FALLBACKS,\n    ensureAutoGearGlobal,\n    repairAutoGearGlobals,\n    isAutoGearGlobalReferenceError\n} from './helpers/auto-gear.js';\n\nimport {\n    createFallbackIconFontKeys,\n    formatSvgCoordinate,\n    positionSvgMarkup,\n    resolveIconGlyph,\n    applyIconGlyph\n} from './helpers/icons.js';\n\nimport {\n    createFallbackSafeGenerateConnectorSummary\n} from './helpers/connectors.js';\n\n// --- Connector Summary Logic (Stateful) ---\n\nlet _connectorSummaryWarningIssued = false;\n\n/**\n * Generates a connector summary using available strategies (Global, Shared, Fallback).\n * @param {object} device - The device object.\n * @returns {string} The connector summary.\n */\nexport function generateSafeConnectorSummary(device) {\n    const candidates = [];\n\n    // 1. Check for globally registered function\n    const globalFn = readGlobalScopeValue('safeGenerateConnectorSummary');\n    if (typeof globalFn === 'function') {\n        candidates.push(globalFn);\n    }\n\n    // 2. Check for shared runtime state function (if available via global)\n    const shared = readGlobalScopeValue('CORE_SHARED');\n    if (shared && typeof shared.safeGenerateConnectorSummary === 'function') {\n        candidates.push(shared.safeGenerateConnectorSummary);\n    }\n\n    // 3. Fallback\n    candidates.push(createFallbackSafeGenerateConnectorSummary());\n\n    for (const generator of candidates) {\n        try {\n            const summary = generator(device);\n            if (typeof summary === 'string') {\n                return summary;\n            }\n            if (summary === null || summary === undefined) {\n                continue;\n            }\n            return String(summary);\n        } catch (error) {\n            if (!_connectorSummaryWarningIssued) {\n                _connectorSummaryWarningIssued = true;\n                if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n                    console.warn('Failed to generate connector summary. Falling back.', error);\n                }\n            }\n        }\n    }\n\n    return '';\n}\n\n\n// --- Export Namespace ---\n\nexport const Helpers = {\n    detectGlobalScope,\n    collectCandidateScopes,\n    tryRequire,\n    resolveFromScopes,\n    getCachedGlobalValue,\n};\n\nexport const Freeze = {\n    createRegistry: createFreezeRegistry,\n    has: freezeRegistryHas,\n    add: freezeRegistryAdd,\n    getShared: getSharedFreezeRegistry,\n    sharedHas: sharedFreezeRegistryHas,\n    sharedAdd: sharedFreezeRegistryAdd\n};\n\nexport const Global = {\n    read: readGlobalScopeValue,\n    write: writeGlobalScopeValue,\n    ensure: ensureGlobalFallback,\n    normalise: normaliseGlobalValue\n};\n\nexport const AutoGear = {\n    FALLBACKS: AUTO_GEAR_GLOBAL_FALLBACKS,\n    ensure: ensureAutoGearGlobal,\n    repair: repairAutoGearGlobals,\n    isReferenceError: isAutoGearGlobalReferenceError\n};\n\nexport const Icons = {\n    createFontKeys: createFallbackIconFontKeys,\n    formatCoordinate: formatSvgCoordinate,\n    positionMarkup: positionSvgMarkup,\n    resolveGlyph: resolveIconGlyph,\n    applyGlyph: applyIconGlyph\n};\n\nexport const Connectors = {\n    createFallbackSummary: createFallbackSafeGenerateConnectorSummary,\n    generateSummary: generateSafeConnectorSummary\n};\n\n/**\n * Creates a lightweight runtime state fallback wrapper around candidate scopes.\n * Useful for embedded environments where direct usage of `window` might be unsafe.\n * @param {object[]} candidateScopes - The scopes to wrap.\n * @returns {object} The local runtime state fallback API.\n */\nexport function createLocalRuntimeStateFallback(candidateScopes) {\n    var scopes = [];\n    var seenScopes = typeof Set === 'function' ? new Set() : null;\n\n    function registerScope(scope) {\n        if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n            return;\n        }\n\n        if (seenScopes) {\n            if (seenScopes.has(scope)) {\n                return;\n            }\n            seenScopes.add(scope);\n            scopes.push(scope);\n            return;\n        }\n\n        if (scopes.indexOf(scope) !== -1) {\n            return;\n        }\n\n        scopes.push(scope);\n    }\n\n    if (Array.isArray(candidateScopes)) {\n        for (var initialIndex = 0; initialIndex < candidateScopes.length; initialIndex += 1) {\n            try {\n                registerScope(candidateScopes[initialIndex]);\n            } catch (initialiseScopeError) {\n                void initialiseScopeError;\n            }\n        }\n    }\n\n    return Object.freeze({\n        getScopes: function getScopes() {\n            return scopes.slice();\n        },\n        getPrimaryScope: function getPrimaryScope() {\n            return scopes.length > 0 ? scopes[0] : null;\n        },\n        ensureValue: function ensureValue(name, fallbackValue) {\n            var fallbackProvider =\n                typeof fallbackValue === 'function'\n                    ? fallbackValue\n                    : function provideStaticFallback() {\n                        return fallbackValue;\n                    };\n\n            if (typeof name !== 'string' || !name) {\n                try {\n                    return fallbackProvider();\n                } catch (fallbackError) {\n                    void fallbackError;\n                    return undefined;\n                }\n            }\n\n            for (var scopeIndex = 0; scopeIndex < scopes.length; scopeIndex += 1) {\n                var scope = scopes[scopeIndex];\n                if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n                    continue;\n                }\n\n                try {\n                    if (typeof scope[name] === 'undefined') {\n                        scope[name] = fallbackProvider();\n                    }\n                    return scope[name];\n                } catch (ensureError) {\n                    void ensureError;\n                }\n            }\n\n            try {\n                return fallbackProvider();\n            } catch (fallbackError) {\n                void fallbackError;\n                return undefined;\n            }\n        },\n        normaliseValue: function normaliseValue(name, validator, fallbackValue) {\n            var fallbackProvider =\n                typeof fallbackValue === 'function'\n                    ? fallbackValue\n                    : function provideStaticFallback() {\n                        return fallbackValue;\n                    };\n\n            for (var scopeIndex = 0; scopeIndex < scopes.length; scopeIndex += 1) {\n                var scope = scopes[scopeIndex];\n                if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n                    continue;\n                }\n\n                try {\n                    if (!validator(scope[name])) {\n                        scope[name] = fallbackProvider();\n                    }\n                } catch (normaliseError) {\n                    void normaliseError;\n                }\n            }\n        }\n    });\n}\n\n// Re-export individually for convenience if needed, or prefer the namespaces\nexport {\n    // Scope\n    detectGlobalScope,\n    collectCandidateScopes,\n    // Frozen\n    createFreezeRegistry,\n    freezeRegistryHas,\n    freezeRegistryAdd,\n    // Global\n    readGlobalScopeValue,\n    writeGlobalScopeValue,\n    ensureGlobalFallback,\n    normaliseGlobalValue,\n    // Auto Gear\n    ensureAutoGearGlobal,\n    repairAutoGearGlobals,\n    // Icons\n    createFallbackIconFontKeys,\n    applyIconGlyph,\n    // Connectors\n    createFallbackSafeGenerateConnectorSummary\n};\n","/*\n * Cine Power Planner runtime split (environment utilities).\n * SHIM ADAPTER - Imports from src/scripts/modules/runtime-environment.js\n *\n * This file maintains backward compatibility for legacy code relying on\n * global environment utilities and runtime state management.\n */\n\nimport {\n  collectCandidateScopes,\n  detectGlobalScope,\n  createFreezeRegistry,\n  freezeRegistryHas,\n  freezeRegistryAdd,\n  readGlobalScopeValue,\n  writeGlobalScopeValue,\n  ensureGlobalFallback,\n  normaliseGlobalValue,\n  ensureAutoGearGlobal,\n  createFallbackIconFontKeys,\n  createFallbackSafeGenerateConnectorSummary,\n  generateSafeConnectorSummary,\n  createLocalRuntimeStateFallback,\n  Helpers,\n  Freeze,\n  Global,\n  AutoGear,\n  Icons,\n  Connectors\n} from '../modules/runtime-environment.js';\n\nimport { resolveCoreSupportModule } from './app-core-runtime-support.js';\n\n// --- Legacy Module Loader Resolution ---\n// Kept for backward compatibility with code that expects these exact exports\n// and the specific resolution logic.\n\nexport function resolveRuntimeModuleLoader() {\n  if (\n    typeof cineCoreRuntimeModuleLoader !== 'undefined' &&\n    cineCoreRuntimeModuleLoader &&\n    typeof cineCoreRuntimeModuleLoader === 'object'\n  ) {\n    return cineCoreRuntimeModuleLoader;\n  }\n\n  const scope = detectGlobalScope();\n  if (scope && scope.cineCoreRuntimeModuleLoader && typeof scope.cineCoreRuntimeModuleLoader === 'object') {\n    return scope.cineCoreRuntimeModuleLoader;\n  }\n\n  return null;\n}\n\nexport function requireCoreRuntimeModule(moduleId, options) {\n  const loader = resolveRuntimeModuleLoader();\n  if (\n    loader &&\n    typeof loader.resolveCoreRuntimeModule === 'function'\n  ) {\n    try {\n      return loader.resolveCoreRuntimeModule(moduleId, options);\n    } catch (moduleResolutionError) {\n      void moduleResolutionError;\n    }\n  }\n  return null;\n}\n\n\n// --- Icon Registry Initialization ---\n// Ensures ICON_GLYPHS global exists\n\n(function ensureIconGlyphRegistryAvailability() {\n  const scopes = collectCandidateScopes();\n  let registry = null;\n\n  for (const scope of scopes) {\n    if (scope && scope.ICON_GLYPHS && typeof scope.ICON_GLYPHS === 'object') {\n      registry = scope.ICON_GLYPHS;\n      break;\n    }\n  }\n\n  if (!registry) {\n    registry = {};\n  }\n\n  for (const scope of scopes) {\n    ensureGlobalFallback('ICON_GLYPHS', () => registry, [scope]);\n  }\n})();\n\n\n// --- Core Environment Helpers ---\n\nexport var CORE_ENVIRONMENT_HELPERS = (function resolveCoreEnvironmentHelpers() {\n  let helpers = null;\n\n  if (typeof resolveCoreSupportModule === 'function') {\n    helpers = resolveCoreSupportModule(\n      'cineRuntimeEnvironmentHelpers',\n      './modules/runtime-environment-helpers.js'\n    );\n  }\n\n  if (helpers) {\n    return helpers;\n  }\n\n  // Fallback to checking globals directly\n  helpers = readGlobalScopeValue('cineRuntimeEnvironmentHelpers');\n  return helpers;\n})();\n\n\n// --- Core Runtime Shared ---\n\nexport var CORE_RUNTIME_SHARED = (function resolveCoreRuntimeShared() {\n  if (typeof CORE_RUNTIME_SHARED !== 'undefined' && CORE_RUNTIME_SHARED) {\n    return CORE_RUNTIME_SHARED;\n  }\n\n  let shared = null;\n\n  if (typeof resolveCoreSupportModule === 'function') {\n    shared = resolveCoreSupportModule(\n      'cineCoreRuntimeShared',\n      './app-core-runtime-shared.js'\n    );\n  }\n\n  if (!shared) {\n    shared = readGlobalScopeValue('cineCoreRuntimeShared');\n  }\n\n  return shared;\n})();\n\nexport { CORE_RUNTIME_SHARED as CORE_SHARED };\n\n\n// --- Candidate Scopes ---\n\nexport function collectEnvironmentRuntimeCandidateScopes(primaryScope) {\n  // Use the new module's collector, but respect legacy shared injection if present\n  if (CORE_RUNTIME_SHARED && typeof CORE_RUNTIME_SHARED.collectCandidateScopes === 'function') {\n    try {\n      const sharedScopes = CORE_RUNTIME_SHARED.collectCandidateScopes(primaryScope, CORE_ENVIRONMENT_HELPERS);\n      if (Array.isArray(sharedScopes)) return sharedScopes;\n    } catch (e) { void e; }\n  }\n\n  // Use new implementation\n  return collectCandidateScopes(primaryScope);\n}\n\nexport var CORE_RUNTIME_CANDIDATE_SCOPES = (function resolveCoreRuntimeCandidateScopesPart2() {\n  if (\n    typeof CORE_RUNTIME_CANDIDATE_SCOPES !== 'undefined' &&\n    CORE_RUNTIME_CANDIDATE_SCOPES &&\n    Array.isArray(CORE_RUNTIME_CANDIDATE_SCOPES)\n  ) {\n    return CORE_RUNTIME_CANDIDATE_SCOPES;\n  }\n\n  // Simplified resolution using new collection logic\n  const scopes = collectEnvironmentRuntimeCandidateScopes();\n\n  // Legacy sync logic\n  if (CORE_RUNTIME_SHARED && typeof CORE_RUNTIME_SHARED.syncCandidateScopes === 'function') {\n    try {\n      CORE_RUNTIME_SHARED.syncCandidateScopes(scopes, detectGlobalScope(), CORE_ENVIRONMENT_HELPERS);\n    } catch (e) { void e; }\n  } else {\n    // Simple global sync\n    ensureGlobalFallback('CORE_RUNTIME_CANDIDATE_SCOPES', scopes);\n  }\n\n  return scopes;\n})();\n\n\n// --- Runtime State Support ---\n\nexport var CORE_RUNTIME_STATE_SUPPORT_PART2 = (function resolveCoreRuntimeStateSupportPart2() {\n  // Try to find existing support object\n  let support = readGlobalScopeValue('CORE_RUNTIME_STATE_SUPPORT');\n  if (!support) {\n    support = readGlobalScopeValue('cineCoreRuntimeState');\n  }\n\n  if (support) return support;\n\n  // Attempt resolution through support module\n  if (typeof resolveCoreSupportModule === 'function') {\n    support = resolveCoreSupportModule('cineCoreRuntimeState', './modules/core/runtime-state.js');\n  }\n\n  // If still not found, try loader\n  if (!support) {\n    const loaderState = requireCoreRuntimeModule('modules/core/runtime-state.js');\n    if (loaderState && typeof loaderState === 'object') {\n      support = loaderState;\n    }\n  }\n\n  if (support) {\n    ensureGlobalFallback('CORE_RUNTIME_STATE_SUPPORT', support);\n  }\n\n  return support;\n})();\n\n\n// --- Temperature Keys ---\n\nexport var CORE_TEMPERATURE_KEY_DEFAULTS = {\n  queueKey: '__cinePendingTemperatureNote',\n  renderName: 'renderTemperatureNote'\n};\n\n// Try to update from runtime state if available\nif (CORE_RUNTIME_STATE_SUPPORT_PART2 && typeof CORE_RUNTIME_STATE_SUPPORT_PART2.resolveTemperatureKeyDefaults === 'function') {\n  try {\n    const defaults = CORE_RUNTIME_STATE_SUPPORT_PART2.resolveTemperatureKeyDefaults();\n    if (defaults) {\n      if (defaults.queueKey) CORE_TEMPERATURE_KEY_DEFAULTS.queueKey = defaults.queueKey;\n      if (defaults.renderName) CORE_TEMPERATURE_KEY_DEFAULTS.renderName = defaults.renderName;\n    }\n  } catch (e) { void e; }\n}\n\nexport const CORE_TEMPERATURE_QUEUE_KEY = CORE_TEMPERATURE_KEY_DEFAULTS.queueKey;\nexport const CORE_TEMPERATURE_RENDER_NAME = CORE_TEMPERATURE_KEY_DEFAULTS.renderName;\n\n\n// --- Freeze Registry ---\n\nexport var CORE_SAFE_FREEZE_REGISTRY = (function resolveCoreSafeFreezeRegistry() {\n  // Try to get shared registry from support module first\n  if (CORE_RUNTIME_STATE_SUPPORT_PART2) {\n    if (typeof CORE_RUNTIME_STATE_SUPPORT_PART2.ensureSafeFreezeRegistry === 'function') {\n      return CORE_RUNTIME_STATE_SUPPORT_PART2.ensureSafeFreezeRegistry();\n    }\n    if (typeof CORE_RUNTIME_STATE_SUPPORT_PART2.createSafeFreezeRegistry === 'function') {\n      return CORE_RUNTIME_STATE_SUPPORT_PART2.createSafeFreezeRegistry();\n    }\n  }\n  // Fallback to local creation from new module\n  return createFreezeRegistry();\n})();\n\n// Bridge functions to new module, but checking runtime state support first for legacy compat\nexport function coreSafeFreezeRegistryHas(value) {\n  if (CORE_RUNTIME_STATE_SUPPORT_PART2 && typeof CORE_RUNTIME_STATE_SUPPORT_PART2.hasSafeFreezeEntry === 'function') {\n    try {\n      return CORE_RUNTIME_STATE_SUPPORT_PART2.hasSafeFreezeEntry(CORE_SAFE_FREEZE_REGISTRY, value);\n    } catch (e) { void e; }\n  }\n  return freezeRegistryHas(CORE_SAFE_FREEZE_REGISTRY, value);\n}\n\nexport function coreSafeFreezeRegistryAdd(value) {\n  if (CORE_RUNTIME_STATE_SUPPORT_PART2 && typeof CORE_RUNTIME_STATE_SUPPORT_PART2.registerSafeFreezeEntry === 'function') {\n    try {\n      return CORE_RUNTIME_STATE_SUPPORT_PART2.registerSafeFreezeEntry(CORE_SAFE_FREEZE_REGISTRY, value);\n    } catch (e) { void e; }\n  }\n  return freezeRegistryAdd(CORE_SAFE_FREEZE_REGISTRY, value);\n}\n\n\n// --- Local Runtime State Fallback ---\nexport { createLocalRuntimeStateFallback };\n\n\n// --- Auto Gear Globals & Shims ---\n\nensureAutoGearGlobal(detectGlobalScope(), 'autoGearAutoPresetId');\nensureGlobalFallback('baseAutoGearRules', () => []);\nensureGlobalFallback('autoGearScenarioModeSelect', null);\n\nexport {\n  createFallbackSafeGenerateConnectorSummary\n} from '../modules/runtime-environment.js';\n\nensureGlobalFallback('createFallbackSafeGenerateConnectorSummary', function () {\n  return createFallbackSafeGenerateConnectorSummary;\n});\n\nensureGlobalFallback('safeGenerateConnectorSummary', function () {\n  return createFallbackSafeGenerateConnectorSummary();\n});\n\nensureGlobalFallback('readGlobalScopeValue', () => readGlobalScopeValue);\n\n\n// --- Icon Utils Exports & Shims ---\n\nnormaliseGlobalValue(\n  'baseAutoGearRules',\n  (value) => Array.isArray(value),\n  () => []\n);\n\nnormaliseGlobalValue(\n  'safeGenerateConnectorSummary',\n  (value) => typeof value === 'function',\n  () => createFallbackSafeGenerateConnectorSummary()\n);\n\nensureGlobalFallback('ICON_FONT_KEYS', () => createFallbackIconFontKeys());\n\nensureGlobalFallback('iconGlyph', function () {\n  // Legacy factory for iconGlyph\n  const iconFontKeys = createFallbackIconFontKeys();\n  const fallbackFont = iconFontKeys.UICONS || 'uicons';\n\n  return function fallbackIconGlyph(char, font) {\n    const glyphChar = typeof char === 'string' ? char : '';\n    const resolvedFont = font && typeof font === 'string' ? font : fallbackFont;\n    return Object.freeze({ char: glyphChar, font: resolvedFont });\n  };\n});\n\n// Use new implementation but expose as global\nensureGlobalFallback('resolveIconGlyph', () => Helpers.resolveIconGlyph); // Using Helpers namespace for direct access if needed, or import\n// Actually better to wrap to match exact signature or just expose the function\nensureGlobalFallback('resolveIconGlyph', () => Icons.resolveGlyph);\n\nensureGlobalFallback('formatSvgCoordinate', () => Icons.formatCoordinate);\n\nensureGlobalFallback('positionSvgMarkup', function () {\n  // Legacy factory returns the function\n  return Icons.positionMarkup;\n});\n\nensureGlobalFallback('applyIconGlyph', function () {\n  // Legacy factory returns the function\n  return Icons.applyGlyph;\n});\n\n\n// --- Auto Gear Initial State Resolution ---\n\nfunction resolveInitialPart2Value(name) {\n  // Check runtime scopes\n  const value = readGlobalScopeValue(name);\n  return value;\n}\n\nconst autoGearAutoPresetIdSeed = resolveInitialPart2Value('autoGearAutoPresetId');\nvar autoGearAutoPresetIdState = typeof autoGearAutoPresetIdSeed === 'string' ? autoGearAutoPresetIdSeed : '';\n\nconst baseAutoGearRulesSeed = resolveInitialPart2Value('baseAutoGearRules');\nvar baseAutoGearRulesState = Array.isArray(baseAutoGearRulesSeed) ? baseAutoGearRulesSeed : [];\n\nconst autoGearScenarioModeSelectSeed = resolveInitialPart2Value('autoGearScenarioModeSelect');\n// var autoGearScenarioModeSelectRef = ... (unused in export but kept in logic flow)\n\n\nconst safeGenerateConnectorSummarySeed = resolveInitialPart2Value('safeGenerateConnectorSummary');\nlet safeGenerateConnectorSummaryFn = typeof safeGenerateConnectorSummarySeed === 'function' ? safeGenerateConnectorSummarySeed : createFallbackSafeGenerateConnectorSummary();\n\n\n// --- Legacy Global Exposures ---\n// Expose functions globally for app-core-new-2.js (as per original file)\n\nconst globalScope = detectGlobalScope();\nif (globalScope) {\n  globalScope.coreSafeFreezeRegistryHas = coreSafeFreezeRegistryHas;\n  globalScope.coreSafeFreezeRegistryAdd = coreSafeFreezeRegistryAdd;\n  globalScope.generateSafeConnectorSummary = generateSafeConnectorSummary;\n  globalScope.readGlobalScopeValue = readGlobalScopeValue;\n  globalScope.writeGlobalScopeValue = writeGlobalScopeValue;\n  globalScope.collectEnvironmentRuntimeCandidateScopes = collectEnvironmentRuntimeCandidateScopes;\n  globalScope.createLocalRuntimeStateFallback = createLocalRuntimeStateFallback;\n}\n","/**\n * ui-cache.js\n *\n * specialized module to hold references to DOM elements used across the application,\n * particularly by app-events.js.\n *\n * This replaces the pattern of declaring 100+ global variables.\n */\n\n// (function () {\nexport const cineUiCache = {\n    _cache: {},\n\n    // Core helper to get or cache an element\n    getElement: function (id) {\n        if (this._cache[id]) {\n            return this._cache[id];\n        }\n        if (typeof document !== 'undefined') {\n            const el = document.getElementById(id);\n            if (el) {\n                this._cache[id] = el;\n                return el;\n            }\n        }\n        return null;\n    },\n\n    // Clear cache (useful for testing or full reloads)\n    clear: function () {\n        this._cache = {};\n    }\n};\n\n// Define lazy getters for known UI elements\nconst elementIds = [\n    'toggleDeviceManager', 'device-manager', 'saveSetupBtn', 'setupName', 'deleteSetupBtn',\n    'addDeviceBtn', 'cancelEditBtn', 'languageSelect', 'skipLink', 'importDataBtn',\n    'importFileInput', 'exportDataBtn', 'generateGearListBtn', 'deleteGearListProjectBtn',\n    'gearItemEditExtra', 'newSubcategory', 'newCategory', 'subcategoryField',\n    'lensFocusScaleUnit', 'newName', 'newWatt', 'newCapacity', 'newPinA', 'newDtapA',\n    'menuToggle', 'darkModeToggle', 'pinkModeToggle', 'settingsButton', 'helpButton',\n    'reloadButton', 'closeMenuButton', 'openContactsBtn', 'shareSetupBtn',\n    'applySharedLinkBtn', 'generateOverviewBtn', 'runtimeFeedbackBtn', 'zoomOut',\n    'zoomIn', 'resetView', 'gridSnapToggle', 'accentColorReset', 'localFontsButton',\n    'documentationTrackerAddRelease', 'mountVoltageReset', 'autoGearSavePreset',\n    'autoGearDeletePreset', 'autoGearBackupRestore', 'autoGearAddRule',\n    'autoGearResetFactory', 'autoGearHighlightToggle', 'closePrintPreviewBtn',\n    'printPreviewExportBtn', 'printPreviewPrintBtn',\n\n    // Part 2 inputs\n    'cameraWatt', 'monitorWatt', 'viewfinderWatt', 'cameraVoltage', 'cameraPortType',\n    'monitorScreenSize', 'monitorBrightness', 'monitorVoltage', 'monitorPortType',\n    'monitorLatency', 'monitorAudioOutput', 'viewfinderScreenSize',\n    'viewfinderBrightness', 'viewfinderVoltage', 'viewfinderPortType', 'viewfinderLatency',\n\n    // Fields Divs\n    'batteryFields', 'cameraFields', 'monitorFields', 'viewfinderFields', 'videoFields',\n    'motorFields', 'controllerFields', 'distanceFields', 'lensFields', 'wattField',\n    'dynamicFields'\n];\n\nelementIds.forEach(function (id) {\n    Object.defineProperty(cineUiCache, id, {\n        get: function () {\n            return this.getElement(id);\n        },\n        enumerable: true,\n        configurable: true\n    });\n});\n\n// Expose to global scope for now (compatibility)\n// Expose to global scope for now (compatibility)\nif (typeof globalThis !== 'undefined') {\n    globalThis.cineUiCache = cineUiCache;\n} else if (typeof window !== 'undefined') {\n    window.cineUiCache = cineUiCache;\n} else if (typeof self !== 'undefined') {\n    self.cineUiCache = cineUiCache;\n} else if (typeof global !== 'undefined') {\n    global.cineUiCache = cineUiCache;\n}\n\n// CommonJS export\n// if (typeof module !== 'undefined' && module.exports) {\n//     module.exports = UI_CACHE;\n// }\n// })();\nexport default cineUiCache;\n","/* global CORE_GLOBAL_SCOPE, ICON_GLYPHS, iconMarkup */\n/*\n * Centralised UI helpers shared across the Cine Power Planner runtime.\n *\n * MIGRATION NOTE: Logic moved to `src/scripts/modules/ui-helpers.js`.\n * This file remains as a backwards-compatibility shim to expose\n * globals expected by legacy code.\n */\n\nimport {\n  escapeHtml,\n  escapeButtonLabelSafely,\n  resolveButtonIconMarkup,\n  setButtonLabelWithIcon,\n  whenElementAvailable\n} from '../modules/ui-helpers.js';\n\nfunction detectGlobalScope() {\n  if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n    return CORE_GLOBAL_SCOPE;\n  }\n  if (typeof globalThis !== 'undefined' && globalThis && typeof globalThis === 'object') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined' && window && typeof window === 'object') {\n    return window;\n  }\n  if (typeof self !== 'undefined' && self && typeof self === 'object') {\n    return self;\n  }\n  if (typeof global !== 'undefined' && global && typeof global === 'object') {\n    return global;\n  }\n  return null;\n}\n\nconst GLOBAL_SCOPE = detectGlobalScope();\n\n// Legacy adapter for resolveButtonIconMarkup which originally read global scope\n// We wrap it to inject the global iconMarkup if present\nfunction resolveButtonIconMarkupShim(glyph) {\n  let iconFactory = null;\n\n  if (typeof iconMarkup === 'function') {\n    iconFactory = iconMarkup;\n  } else if (GLOBAL_SCOPE && typeof GLOBAL_SCOPE.iconMarkup === 'function') {\n    iconFactory = GLOBAL_SCOPE.iconMarkup;\n  }\n\n  return resolveButtonIconMarkup(glyph, iconFactory);\n}\n\n// Legacy adapter for setButtonLabelWithIcon which originally read global scope\n// We wrap it to inject the global iconMarkup etc if present\nfunction setButtonLabelWithIconShim(button, label, glyph) {\n  let resolvedGlyph = glyph;\n  if (typeof resolvedGlyph === 'undefined') {\n    if (typeof ICON_GLYPHS === 'object' && ICON_GLYPHS && ICON_GLYPHS.save) {\n      resolvedGlyph = ICON_GLYPHS.save;\n    }\n  }\n\n  let iconFactory = null;\n  if (typeof iconMarkup === 'function') {\n    iconFactory = iconMarkup;\n  } else if (GLOBAL_SCOPE && typeof GLOBAL_SCOPE.iconMarkup === 'function') {\n    iconFactory = GLOBAL_SCOPE.iconMarkup;\n  }\n\n  return setButtonLabelWithIcon(button, label, resolvedGlyph, iconFactory);\n}\n\n\nconst namespace = {\n  escapeHtml,\n  escapeButtonLabelSafely,\n  resolveButtonIconMarkup: resolveButtonIconMarkupShim,\n  setButtonLabelWithIcon: setButtonLabelWithIconShim,\n  whenElementAvailable,\n};\n\nif (GLOBAL_SCOPE) {\n  const existing =\n    GLOBAL_SCOPE.cineCoreUiHelpers && typeof GLOBAL_SCOPE.cineCoreUiHelpers === 'object'\n      ? GLOBAL_SCOPE.cineCoreUiHelpers\n      : {};\n\n  existing.escapeHtml = escapeHtml;\n  existing.escapeButtonLabelSafely = escapeButtonLabelSafely;\n  existing.resolveButtonIconMarkup = resolveButtonIconMarkupShim;\n  existing.setButtonLabelWithIcon = setButtonLabelWithIconShim;\n  existing.whenElementAvailable = whenElementAvailable;\n\n  try {\n    GLOBAL_SCOPE.cineCoreUiHelpers = existing;\n  } catch (assignError) {\n    void assignError;\n  }\n}\n\nconst cineCoreUiHelpers = namespace;\nexport { cineCoreUiHelpers };\nexport default namespace;\n","/* global CORE_GLOBAL_SCOPE */\n/*\n * Cine Power Planner text entry helpers.\n *\n * MIGRATION NOTE: Logic moved to `src/scripts/modules/text.js`.\n * This file remains as a backwards-compatibility shim to expose\n * globals expected by legacy code.\n */\n\nimport {\n  TEXT_ENTRY_SEPARATOR,\n  normaliseTextEntryValue,\n  resolveTextEntry\n} from '../modules/text.js';\n\nfunction detectGlobalScope() {\n  if (\n    typeof CORE_GLOBAL_SCOPE !== 'undefined' &&\n    CORE_GLOBAL_SCOPE &&\n    typeof CORE_GLOBAL_SCOPE === 'object'\n  ) {\n    return CORE_GLOBAL_SCOPE;\n  }\n\n  if (typeof globalThis !== 'undefined' && globalThis && typeof globalThis === 'object') {\n    return globalThis;\n  }\n\n  if (typeof window !== 'undefined' && window && typeof window === 'object') {\n    return window;\n  }\n\n  if (typeof self !== 'undefined' && self && typeof self === 'object') {\n    return self;\n  }\n\n  if (typeof global !== 'undefined' && global && typeof global === 'object') {\n    return global;\n  }\n\n  return null;\n}\n\nconst namespace = {\n  TEXT_ENTRY_SEPARATOR,\n  normaliseTextEntryValue,\n  resolveTextEntry,\n};\n\nconst globalScope = detectGlobalScope();\nif (globalScope) {\n  const existing =\n    globalScope.cineCoreTextEntries && typeof globalScope.cineCoreTextEntries === 'object'\n      ? globalScope.cineCoreTextEntries\n      : {};\n\n  existing.TEXT_ENTRY_SEPARATOR = TEXT_ENTRY_SEPARATOR;\n  existing.normaliseTextEntryValue = normaliseTextEntryValue;\n  existing.resolveTextEntry = resolveTextEntry;\n\n  try {\n    globalScope.cineCoreTextEntries = existing;\n  } catch (assignError) {\n    void assignError;\n  }\n}\n\nexport default namespace;\n","/*\n * Cine Power Planner runtime scope helpers.\n *\n * MIGRATED to pure ESM modules in Batch 11.\n * - Scope Logic -> modules/helpers/scope-utils.js\n *\n * This file remains as a shim for legacy code.\n */\n\nimport {\n  detectGlobalScope,\n  collectCandidateScopes as collectCandidates\n} from '../modules/helpers/scope-utils.js';\n\nimport { cineCoreRuntimeModuleLoader } from '../modules/runtime-module-loader.js';\n\nexport const CORE_GLOBAL_SCOPE = detectGlobalScope();\n\n// Legacy helper used by some files\nfunction resolveRuntimeModuleLoader() {\n  if (cineCoreRuntimeModuleLoader) {\n    return cineCoreRuntimeModuleLoader;\n  }\n  return null;\n}\n\n// Legacy helper\nfunction requireCoreRuntimeModule(moduleId, options) {\n  const loader = resolveRuntimeModuleLoader();\n  if (\n    loader &&\n    typeof loader.resolveCoreRuntimeModule === 'function'\n  ) {\n    try {\n      return loader.resolveCoreRuntimeModule(moduleId, options);\n    } catch (e) {\n      void e;\n    }\n  }\n  return null;\n}\n\nexport const CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE = detectGlobalScope();\n\nexport const collectRuntimeScopeCandidates = function (additionalCandidates) {\n  return collectCandidates(\n    CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE,\n    additionalCandidates\n  );\n};\n\n// Global Injection for Legacy Compatibility\nif (CORE_GLOBAL_SCOPE) {\n  if (typeof CORE_GLOBAL_SCOPE.collectRuntimeScopeCandidates === 'undefined') {\n    CORE_GLOBAL_SCOPE.collectRuntimeScopeCandidates = collectRuntimeScopeCandidates;\n  }\n  if (typeof CORE_GLOBAL_SCOPE.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE === 'undefined') {\n    CORE_GLOBAL_SCOPE.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE = CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE;\n  }\n}\n","/**\n * Cine Power Planner - Core Runtime Part 1\n * \n * This module initiates the primary application bootstrap sequence. Its core responsibilities\n * include:\n * 1. Establishing global scopes and runtime bridges (CORE_GLOBAL_SCOPE, globalShim).\n * 2. Setting up defensive resolution strategies for shared modules (Auto-Gear, UI helpers).\n * 3. Initializing critical environment state (Temperature units, Focus scales).\n * \n * Part 1 is designed to be the \"opening act\" of the core runtime, ensuring that basic\n * mechanisms are in place before Part 2 (UI and Event Orchestration) takes over.\n */\nconsole.log('DEBUG: app-core-new-1.js STARTING');\nif (typeof window !== 'undefined') window.__APP_CORE_STARTED = true;\n\nfunction renderFeedbackTable(setupKey) {\n  // Placeholder to prevent ReferenceError\n  return { count: 0 };\n}\n\n(function () {\n  if (typeof window !== 'undefined') {\n    if (!window.ensureSvgHasAriaHidden) window.ensureSvgHasAriaHidden = function (m) { return m; };\n  }\n})();\nconst globalShim = typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {}));\nvar CORE_PART1_RUNTIME_SCOPE = globalShim;\nif (typeof globalShim.CORE_PART1_RUNTIME_SCOPE === 'undefined') globalShim.CORE_PART1_RUNTIME_SCOPE = CORE_PART1_RUNTIME_SCOPE;\n\nvar CORE_PART2_RUNTIME_SCOPE = globalShim;\nif (typeof globalShim.CORE_PART2_RUNTIME_SCOPE === 'undefined') globalShim.CORE_PART2_RUNTIME_SCOPE = CORE_PART2_RUNTIME_SCOPE;\n\nvar CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE = globalShim;\nif (typeof globalShim.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE === 'undefined') globalShim.CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE = CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE;\n\nvar AppCore = globalShim.AppCore || {};\nglobalShim.AppCore = AppCore;\n\nvar localization = globalShim.localization || {};\nglobalShim.localization = localization;\n\n// [Added by Agent] Global Shims for ESM Compatibility\nlet devices = typeof window !== 'undefined' ? window.devices : undefined;\nlet cineDevices = typeof window !== 'undefined' ? window.cineDevices : undefined;\nlet texts = typeof window !== 'undefined' ? window.texts : undefined;\n// currentLang shim removed to avoid conflict with legacy var declaration\nimport { iconGlyph } from '../modules/icons.js';\nimport '../modules/persistence/AutoGearService.js';\nimport { CORE_GLOBAL_SCOPE } from './app-core-runtime-scopes.js';\nimport { CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED, resolvedCollectCoreRuntimeCandidateScopes as importedResolvedCollectCoreRuntimeCandidateScopes } from './app-core-runtime-candidate-scopes.js';\nconst resolvedCollectCoreRuntimeCandidateScopes = importedResolvedCollectCoreRuntimeCandidateScopes;\nimport { getCoreGlobalObject, ensureCoreGlobalValue, CORE_DEEP_CLONE } from './app-core-runtime-global-tools.js';\nimport { CORE_SHARED, CORE_TEMPERATURE_QUEUE_KEY, CORE_TEMPERATURE_RENDER_NAME, CORE_RUNTIME_STATE_SUPPORT_PART2 as CORE_RUNTIME_STATE_SUPPORT_IMPORTED } from './app-core-environment.js';\n\n/**\n * Helper to resolve auto-gear UI functions from various possible locations.\n * \n * RATIONALE: The application supports both monolithic (legacy) and modular (modern) \n * resolution. Since UI components might be loaded asynchronously or attached to different \n * global namespaces, this helper provides a uniform interface to find functions without \n * hard-coding their location.\n * \n * @param {string} name - The name of the function to resolve.\n * @returns {function|undefined} - The resolved function or undefined if not found.\n */\nfunction resolveAutoGearUIHelper(name) {\n  // Try window directly first\n  if (typeof window !== 'undefined' && typeof window[name] === 'function') {\n    return window[name];\n  }\n  // Try AUTO_GEAR_UI_HELPERS global object\n  const helpers = (typeof globalThis !== 'undefined' && globalThis.AUTO_GEAR_UI_HELPERS)\n    || (typeof window !== 'undefined' && window.AUTO_GEAR_UI_HELPERS)\n    || null;\n  if (helpers && typeof helpers[name] === 'function') {\n    return helpers[name];\n  }\n  return undefined;\n}\n\n// [Added by Agent] Helper to resolve auto-gear normalizers\nfunction resolveAutoGearNormalizer(name) {\n  if (typeof window !== 'undefined' && typeof window[name] === 'function') {\n    return window[name];\n  }\n  const scope = (typeof globalThis !== 'undefined' && globalThis) || (typeof window !== 'undefined' && window) || {};\n  if (typeof scope[name] === 'function') {\n    return scope[name];\n  }\n  const exports = scope.AUTO_GEAR_NORMALIZER_EXPORTS;\n  if (exports && typeof exports[name] === 'function') {\n    return exports[name];\n  }\n  return undefined;\n}\n\n// [Added by Agent] Helper to resolve auto-gear storage functions\nfunction resolveAutoGearStorageHelper(name) {\n  if (typeof window !== 'undefined' && typeof window[name] === 'function') {\n    return window[name];\n  }\n  const scope = (typeof globalThis !== 'undefined' && globalThis) || (typeof window !== 'undefined' && window) || {};\n  if (typeof scope[name] === 'function') {\n    return scope[name];\n  }\n  const persistence = resolveAutoGearPersistenceModule();\n  if (persistence) {\n    const mapped = AUTO_GEAR_STORAGE_METHOD_MAP[name] || name;\n    if (typeof persistence[mapped] === 'function') {\n      return persistence[mapped].bind(persistence);\n    }\n  }\n  const exports = scope.AUTO_GEAR_STORAGE_EXPORTS;\n  if (exports && typeof exports[name] === 'function') {\n    return exports[name];\n  }\n  return undefined;\n}\n\nconst AUTO_GEAR_PERSISTENCE_MODULE_NAME = 'cineAutoGearPersistence';\nconst AUTO_GEAR_STORAGE_METHOD_MAP = {\n  readAutoGearRulesFromStorage: 'readAutoGearRules',\n  readAutoGearBackupsFromStorage: 'readAutoGearBackups',\n  readAutoGearPresetsFromStorage: 'readAutoGearPresets',\n  readAutoGearMonitorDefaultsFromStorage: 'readAutoGearMonitorDefaults',\n  readActiveAutoGearPresetIdFromStorage: 'readActivePresetId',\n  readAutoGearAutoPresetIdFromStorage: 'readAutoPresetId',\n  readAutoGearBackupVisibilityFromStorage: 'readBackupVisibility',\n  readAutoGearBackupRetentionFromStorage: 'readBackupRetention',\n  persistAutoGearPresets: 'persistAutoGearPresets',\n  persistAutoGearMonitorDefaults: 'persistAutoGearMonitorDefaults',\n  persistActiveAutoGearPresetId: 'persistActivePresetId',\n  persistAutoGearAutoPresetId: 'persistAutoPresetId',\n  persistAutoGearBackupVisibility: 'persistBackupVisibility',\n  persistAutoGearBackupRetention: 'persistBackupRetention',\n  persistAutoGearBackups: 'persistAutoGearBackups',\n};\n\nfunction resolveAutoGearPersistenceModule() {\n  const scopes = [];\n  if (typeof globalThis !== 'undefined') scopes.push(globalThis);\n  if (typeof window !== 'undefined') scopes.push(window);\n  if (typeof self !== 'undefined') scopes.push(self);\n  if (typeof global !== 'undefined') scopes.push(global);\n  for (let index = 0; index < scopes.length; index += 1) {\n    const candidate = scopes[index];\n    if (!candidate || (typeof candidate !== 'object' && typeof candidate !== 'function')) continue;\n    if (candidate.cineAutoGearPersistence) return candidate.cineAutoGearPersistence;\n    const registry = candidate.cineModules;\n    if (registry && typeof registry.get === 'function') {\n      const module = registry.get(AUTO_GEAR_PERSISTENCE_MODULE_NAME);\n      if (module) return module;\n    }\n  }\n  return null;\n}\n\n// Fallback implementation matching the signature in auto-gear/ui.js\nfunction createDeferredAutoGearRefresherFallback(functionName) {\n  return function (selected) {\n    if (typeof callCoreFunctionIfAvailable === 'function') {\n      return callCoreFunctionIfAvailable(functionName, [selected], { defer: true });\n    }\n    return undefined;\n  };\n}\n\nlet createDeferredAutoGearRefresher = resolveAutoGearUIHelper('createDeferredAutoGearRefresher') || createDeferredAutoGearRefresherFallback;\nlet focusAutoGearConditionPicker = resolveAutoGearUIHelper('focusAutoGearConditionPicker') || function () { };\nlet configureAutoGearConditionButtons = resolveAutoGearUIHelper('configureAutoGearConditionButtons') || function () { };\nlet AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS = (typeof window !== 'undefined' && window.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS)\n  || (typeof globalThis !== 'undefined' && globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS)\n  || {};\nlet AUTO_GEAR_MONITOR_DEFAULT_TYPES = (typeof window !== 'undefined' && window.AUTO_GEAR_MONITOR_DEFAULT_TYPES)\n  || (typeof globalThis !== 'undefined' && globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES)\n  || {\n  'on-camera': 'On-Camera',\n  'director': 'Director',\n  'video-village': 'Video Village',\n  'wireless': 'Wireless',\n};\n\n/**\n * Factory to create non-recursive shims for global functions.\n * \n * RATIONALE: Many core functions are resolved dynamically from the global scope. \n * To avoid 'Maximum call stack size exceeded' errors during initialization, this \n * factory ensures that if a shim resolves to itself (an infinite loop), it \n * gracefully falls back to a provided implementation.\n * \n * @param {string} name - The name of the function to resolve.\n * @param {function} resolver - The resolution strategy to use.\n * @param {function} fallback - The implementation to use if resolution fails or is recursive.\n * @returns {function} - A safe proxy function.\n */\nfunction createSafeShim(name, resolver, fallback) {\n  const shim = (...args) => {\n    const resolved = resolver(name);\n    if (resolved && resolved !== shim && typeof resolved === 'function') {\n      return resolved(...args);\n    }\n    return fallback(...args);\n  };\n  return shim;\n}\n\n// [Added by Agent] Missing Normalizers with resolution strategy\nconst normalizeAutoGearTriggerValue = createSafeShim('normalizeAutoGearTriggerValue', resolveAutoGearNormalizer, (v) => typeof v === 'string' ? v.trim() : '');\nconst normalizeAutoGearScenarioLogic = createSafeShim('normalizeAutoGearScenarioLogic', resolveAutoGearNormalizer, (v) => (v === 'any' || v === 'multiplier') ? v : 'all');\nconst normalizeAutoGearScenarioPrimary = createSafeShim('normalizeAutoGearScenarioPrimary', resolveAutoGearNormalizer, (v) => typeof v === 'string' ? v.trim() : '');\nconst normalizeAutoGearScenarioMultiplier = createSafeShim('normalizeAutoGearScenarioMultiplier', resolveAutoGearNormalizer, (v) => { const n = Number(v); return Number.isFinite(n) && n > 0 ? n : 1; });\nconst normalizeAutoGearSelectorType = createSafeShim('normalizeAutoGearSelectorType', resolveAutoGearNormalizer, (v) => typeof v === 'string' ? v.trim() : 'none');\nconst normalizeAutoGearSelectorDefault = createSafeShim('normalizeAutoGearSelectorDefault', resolveAutoGearNormalizer, (t, v) => typeof v === 'string' ? v.trim() : '');\nconst normalizeAutoGearMonitorDefaults = createSafeShim('normalizeAutoGearMonitorDefaults', resolveAutoGearNormalizer, (v) => ({ focus: '', handheld7: '', combo15: '', director15: '' }));\nconst normalizeAutoGearRule = createSafeShim('normalizeAutoGearRule', resolveAutoGearNormalizer, (r) => r);\nconst normalizeAutoGearPreset = createSafeShim('normalizeAutoGearPreset', resolveAutoGearNormalizer, (p) => p);\nconst normalizeAutoGearItem = createSafeShim('normalizeAutoGearItem', resolveAutoGearNormalizer, (i) => i);\nconst normalizeAutoGearConditionLogic = createSafeShim('normalizeAutoGearConditionLogic', resolveAutoGearNormalizer, (v) => v);\nconst normalizeAutoGearShootingDaysCondition = createSafeShim('normalizeAutoGearShootingDaysCondition', resolveAutoGearNormalizer, (v) => v);\n\n/**\n * Storage Resolution Shims\n * \n * These shims provide a bridge to the storage layer (storage.js). \n * They allow code in app-core.js to perform persistent operations even before \n * the storage module is fully initialized or if specific helpers are missing, \n * using safe default behaviors in the meantime.\n */\n// [Added by Agent] Missing Storage Helpers with resolution strategy\nconst readAutoGearRulesFromStorage = createSafeShim('readAutoGearRulesFromStorage', resolveAutoGearStorageHelper, () => []);\nconst readAutoGearBackupRetentionFromStorage = createSafeShim('readAutoGearBackupRetentionFromStorage', resolveAutoGearStorageHelper, () => 0);\nconst readAutoGearBackupsFromStorage = createSafeShim('readAutoGearBackupsFromStorage', resolveAutoGearStorageHelper, (retention) => []);\nconst readAutoGearPresetsFromStorage = createSafeShim('readAutoGearPresetsFromStorage', resolveAutoGearStorageHelper, () => []);\nconst readActiveAutoGearPresetIdFromStorage = createSafeShim('readActiveAutoGearPresetIdFromStorage', resolveAutoGearStorageHelper, () => null);\nconst readAutoGearAutoPresetIdFromStorage = createSafeShim('readAutoGearAutoPresetIdFromStorage', resolveAutoGearStorageHelper, () => '');\nconst readAutoGearBackupVisibilityFromStorage = createSafeShim('readAutoGearBackupVisibilityFromStorage', resolveAutoGearStorageHelper, () => false);\nconst readAutoGearMonitorDefaultsFromStorage = createSafeShim('readAutoGearMonitorDefaultsFromStorage', resolveAutoGearStorageHelper, () => ({}));\nconst persistAutoGearBackupRetention = createSafeShim('persistAutoGearBackupRetention', resolveAutoGearStorageHelper, (value) => { });\n\n// Expose these to globalThis for compatibility\nif (typeof globalThis !== 'undefined') {\n  globalThis.createDeferredAutoGearRefresher = createDeferredAutoGearRefresher;\n  globalThis.focusAutoGearConditionPicker = focusAutoGearConditionPicker;\n  globalThis.configureAutoGearConditionButtons = configureAutoGearConditionButtons;\n  globalThis.AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS = AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS;\n  globalThis.AUTO_GEAR_MONITOR_DEFAULT_TYPES = AUTO_GEAR_MONITOR_DEFAULT_TYPES;\n  globalThis.normalizeAutoGearTriggerValue = normalizeAutoGearTriggerValue;\n  globalThis.normalizeAutoGearScenarioLogic = normalizeAutoGearScenarioLogic;\n  globalThis.normalizeAutoGearScenarioPrimary = normalizeAutoGearScenarioPrimary;\n  globalThis.normalizeAutoGearScenarioMultiplier = normalizeAutoGearScenarioMultiplier;\n  globalThis.normalizeAutoGearSelectorType = normalizeAutoGearSelectorType;\n  globalThis.normalizeAutoGearSelectorDefault = normalizeAutoGearSelectorDefault;\n  globalThis.normalizeAutoGearMonitorDefaults = normalizeAutoGearMonitorDefaults;\n  globalThis.normalizeAutoGearRule = normalizeAutoGearRule;\n  globalThis.normalizeAutoGearPreset = normalizeAutoGearPreset;\n  globalThis.normalizeAutoGearItem = normalizeAutoGearItem;\n  globalThis.normalizeAutoGearConditionLogic = normalizeAutoGearConditionLogic;\n  globalThis.normalizeAutoGearShootingDaysCondition = normalizeAutoGearShootingDaysCondition;\n  globalThis.readAutoGearRulesFromStorage = readAutoGearRulesFromStorage;\n  globalThis.readAutoGearBackupRetentionFromStorage = readAutoGearBackupRetentionFromStorage;\n  globalThis.readAutoGearBackupsFromStorage = readAutoGearBackupsFromStorage;\n  globalThis.readAutoGearPresetsFromStorage = readAutoGearPresetsFromStorage;\n  globalThis.readActiveAutoGearPresetIdFromStorage = readActiveAutoGearPresetIdFromStorage;\n  globalThis.readAutoGearAutoPresetIdFromStorage = readAutoGearAutoPresetIdFromStorage;\n  globalThis.readAutoGearBackupVisibilityFromStorage = readAutoGearBackupVisibilityFromStorage;\n  globalThis.readAutoGearMonitorDefaultsFromStorage = readAutoGearMonitorDefaultsFromStorage;\n  globalThis.persistAutoGearBackupRetention = persistAutoGearBackupRetention;\n  globalThis.ensureGearListActions = createSafeShim('ensureGearListActions', resolveAutoGearUIHelper, () => { });\n  globalThis.setInstallBannerOffset = createSafeShim('setInstallBannerOffset', resolveAutoGearUIHelper, () => { });\n}\n\n\n/*\n * Cine Power Planner runtime split (part 1 of 2).\n *\n * This module stores the opening half of the monolithic app-core logic.\n * The verbose comment ensures GitHub treats this file as newly created\n * instead of a rename, which keeps large diffs readable even though the\n * runtime content itself is unchanged.\n *\n * Maintenance checklist for this split:\n *   1. Apply functional changes to both halves in lockstep.\n *   2. Update the legacy bundle mirrors when touching the source files.\n *   3. Keep loader.js and script.js aligned with the module filenames.\n *   4. Retain this explanatory block to avoid rename heuristics.\n *   5. Run integrity tests so bundling stays consistent.\n *   6. Verify offline storage helpers still load without data loss.\n *   7. Confirm autosave, backup and restore routines keep functioning.\n *   8. Preserve localisation hooks and translation updates.\n *   9. Respect the locally bundled icons and avoid external dependencies.\n *  10. Document any behavioural adjustments in the help materials.\n *\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n * This repetition is deliberate: it ensures the diff remains stable by\n * keeping the similarity score below Git's rename detection threshold.\n * Do not trim these notes unless the tooling issue has been resolved.\n */\n\n\n// [Added by Agent] Ensure localization helpers are available\nvar localResolveDocumentDirection = (typeof cineLocale !== 'undefined' && cineLocale && typeof cineLocale.resolveDocumentDirection === 'function')\n  ? cineLocale.resolveDocumentDirection\n  : function fallbackResolveDocumentDirection(lang) { return 'ltr'; };\n\nconst localApplyLocaleMetadata = (typeof cineLocale !== 'undefined' && cineLocale && typeof cineLocale.applyLocaleMetadata === 'function')\n  ? cineLocale.applyLocaleMetadata\n  : function fallbackApplyLocaleMetadata(target, lang, direction) { };\n\nconst runtimeBootstrapExports = (function resolveRuntimeBootstrapExports() {\n  if (typeof require === 'function') {\n    try {\n      const requiredBootstrap = require('./runtime/bootstrap.js');\n      if (requiredBootstrap && typeof requiredBootstrap === 'object') {\n        return requiredBootstrap;\n      }\n    } catch (runtimeBootstrapError) {\n      void runtimeBootstrapError;\n    }\n  }\n\n  const scopes = [];\n\n  function pushScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n\n    if (scopes.indexOf(scope) === -1) {\n      scopes.push(scope);\n    }\n  }\n\n  pushScope(typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE ? CORE_GLOBAL_SCOPE : null);\n  if (typeof globalThis !== 'undefined') pushScope(globalThis);\n  if (typeof window !== 'undefined') pushScope(window);\n  if (typeof self !== 'undefined') pushScope(self);\n  if (typeof global !== 'undefined') pushScope(global);\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    try {\n      const namespace = scope && scope.cineRuntimeBootstrapExports;\n      if (namespace && typeof namespace === 'object') {\n        return namespace;\n      }\n    } catch (scopeLookupError) {\n      void scopeLookupError;\n    }\n  }\n\n  return null;\n})();\n\nconst defaultCoreBootQueue = [];\n\nconst {\n  fallbackResolveRuntimeModuleLoader = function fallbackResolveRuntimeModuleLoaderMissing() {\n    return null;\n  },\n  fallbackRequireCoreRuntimeModule = function fallbackRequireCoreRuntimeModuleMissing() {\n    return null;\n  },\n  exposeCoreRuntimeConstant = function fallbackExposeCoreRuntimeConstant(name, value) {\n    if (typeof window !== 'undefined') window[name] = value;\n    if (typeof globalThis !== 'undefined') globalThis[name] = value;\n  },\n  exposeCoreRuntimeConstants = function noopExposeCoreRuntimeConstants() { },\n  CORE_BOOT_QUEUE_KEY = '__coreRuntimeBootQueue',\n  CORE_BOOT_QUEUE: resolvedCoreBootQueue = defaultCoreBootQueue,\n  enqueueCoreBootTask: resolvedEnqueueCoreBootTask,\n  getGridSnapState = function fallbackGetGridSnapState() {\n    return 'normal';\n  },\n  setGridSnapState: resolvedSetGridSnapState,\n  applyLegacyGridSnapValue: resolvedApplyLegacyGridSnapValue,\n} = runtimeBootstrapExports || {};\n\nconst CORE_BOOT_QUEUE = resolvedCoreBootQueue;\n\nconst enqueueCoreBootTask =\n  typeof resolvedEnqueueCoreBootTask === 'function'\n    ? resolvedEnqueueCoreBootTask\n    : function fallbackEnqueueCoreBootTask(task) {\n      if (typeof task === 'function') {\n        try {\n          CORE_BOOT_QUEUE.push(task);\n        } catch (queueError) {\n          void queueError;\n          try {\n            task();\n          } catch (taskError) {\n            void taskError;\n          }\n        }\n      }\n      return CORE_BOOT_QUEUE.length;\n    };\n\nconst setGridSnapState =\n  typeof resolvedSetGridSnapState === 'function'\n    ? resolvedSetGridSnapState\n    : function fallbackSetGridSnapState(value) {\n      return typeof value === 'undefined' ? getGridSnapState() : value;\n    };\n\nconst applyLegacyGridSnapValue =\n  typeof resolvedApplyLegacyGridSnapValue === 'function'\n    ? resolvedApplyLegacyGridSnapValue\n    : function fallbackApplyLegacyGridSnapValue(value) {\n      return typeof value === 'undefined' ? getGridSnapState() : value;\n    };\n\nconst TEMPERATURE_SCOPE_CANDIDATES = [\n  typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE,\n  typeof globalThis !== 'undefined' ? globalThis : null,\n  typeof window !== 'undefined' ? window : null,\n  typeof self !== 'undefined' ? self : null,\n  typeof global !== 'undefined' ? global : null,\n].filter(scope => scope && (typeof scope === 'object' || typeof scope === 'function'));\n\nconst TEMPERATURE_UNITS_FALLBACK = Object.freeze({\n  fahrenheit: 'fahrenheit',\n  celsius: 'celsius',\n});\n\n// Move device normalization helpers to top level to avoid TDZ and scope issues\nconst {\n  normalizeVideoType,\n  normalizeFizConnectorType,\n  normalizeViewfinderType,\n  normalizePowerPortType,\n  fixPowerInput,\n  applyFixPowerInput,\n  ensureList,\n  markDevicesNormalized: localMarkDevicesNormalized,\n  hasNormalizedDevicesMarker,\n  unifyDevices,\n  normalizeDevicesForPersistence,\n} = (typeof cineDeviceNormalization !== 'undefined' ? cineDeviceNormalization : (typeof globalThis !== 'undefined' && globalThis.cineDeviceNormalization) || {});\n\nif (typeof window !== 'undefined') {\n  window.normalizeDevicesForPersistence = normalizeDevicesForPersistence;\n}\n\nconst CORE_TEMPERATURE_STORAGE_KEY = '__cineTemperatureNote';\nconst FOCUS_SCALE_STORAGE_KEY = '__cineFocusScale';\n\n/**\n * Temperature Unit Resolution Logic\n * \n * This self-invoking function identifies the prefered temperature unit strategy \n * across all valid runtime candidate scopes. This ensures that environmental \n * feedback (e.g. overheating alerts) uses the user's preferred unit (Metric vs Imperial) \n * consistently throughout the session.\n */\nconst CORE_TEMPERATURE_UNITS = (function resolveTemperatureUnits() {\n  const candidateScopes = TEMPERATURE_SCOPE_CANDIDATES;\n\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    try {\n      const candidate = scope.TEMPERATURE_UNITS;\n      if (\n        candidate\n        && typeof candidate === 'object'\n        && typeof candidate.fahrenheit === 'string'\n        && typeof candidate.celsius === 'string'\n      ) {\n        return candidate;\n      }\n    } catch (temperatureUnitsError) {\n      void temperatureUnitsError;\n    }\n  }\n\n  candidateScopes.forEach(scope => {\n    try {\n      if (!scope.TEMPERATURE_UNITS) {\n        scope.TEMPERATURE_UNITS = TEMPERATURE_UNITS_FALLBACK;\n      }\n    } catch (assignError) {\n      void assignError;\n    }\n  });\n\n  return TEMPERATURE_UNITS_FALLBACK;\n})();\n\nvar TEMPERATURE_SCENARIOS = (function resolveTemperatureScenarios() {\n  const candidateScopes = TEMPERATURE_SCOPE_CANDIDATES;\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    try {\n      if (Array.isArray(scope.TEMPERATURE_SCENARIOS)) {\n        return scope.TEMPERATURE_SCENARIOS;\n      }\n    } catch (temperatureScenarioError) {\n      void temperatureScenarioError;\n    }\n  }\n  candidateScopes.forEach(scope => {\n    try {\n      if (!Array.isArray(scope.TEMPERATURE_SCENARIOS)) {\n        scope.TEMPERATURE_SCENARIOS = [];\n      }\n    } catch (assignError) {\n      void assignError;\n    }\n  });\n  return [];\n})();\n\nconst FOCUS_SCALE_VALUES_FALLBACK = Object.freeze(['metric', 'imperial']);\n\nconst focusScaleValues = (function resolveFocusScaleValues() {\n  const candidateScopes = TEMPERATURE_SCOPE_CANDIDATES;\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    try {\n      if (Array.isArray(scope.FOCUS_SCALE_VALUES) && scope.FOCUS_SCALE_VALUES.length) {\n        return scope.FOCUS_SCALE_VALUES;\n      }\n    } catch (focusScaleError) {\n      void focusScaleError;\n    }\n  }\n  candidateScopes.forEach(scope => {\n    try {\n      if (!Array.isArray(scope.FOCUS_SCALE_VALUES) || !scope.FOCUS_SCALE_VALUES.length) {\n        scope.FOCUS_SCALE_VALUES = FOCUS_SCALE_VALUES_FALLBACK;\n      }\n    } catch (assignError) {\n      void assignError;\n    }\n  });\n  return FOCUS_SCALE_VALUES_FALLBACK;\n})();\n\nfunction resolveFeedbackTemperatureBound(boundKey, fallbackValue) {\n  const candidateScopes = TEMPERATURE_SCOPE_CANDIDATES;\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    try {\n      const candidate = scope && scope[boundKey];\n      if (typeof candidate === 'number' && Number.isFinite(candidate)) {\n        return candidate;\n      }\n    } catch (feedbackBoundError) {\n      void feedbackBoundError;\n    }\n  }\n  candidateScopes.forEach(scope => {\n    try {\n      const scopedValue = scope && scope[boundKey];\n      if (typeof scopedValue !== 'number' || !Number.isFinite(scopedValue)) {\n        scope[boundKey] = fallbackValue;\n      }\n    } catch (assignError) {\n      void assignError;\n    }\n  });\n  return fallbackValue;\n}\n\nglobalThis.FEEDBACK_TEMPERATURE_MIN_VALUE = resolveFeedbackTemperatureBound('FEEDBACK_TEMPERATURE_MIN', -20);\nglobalThis.FEEDBACK_TEMPERATURE_MAX_VALUE = resolveFeedbackTemperatureBound('FEEDBACK_TEMPERATURE_MAX_LIMIT', 50);\nglobalThis.INSTALL_BANNER_DISMISSED_KEY = 'cine_install_banner_dismissed';\nglobalThis.AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE = 1;\n\n// The planner shares a handful of helper modules across legacy and modern\n// bundles. Rather than assuming a module loader exists we defensively look for\n// pre-attached namespaces first and then fall back to CommonJS style requires.\n// This defensive dance keeps offline builds and automated backups aligned.\n\nconst CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE = (function resolveRuntimeSupportExportNamespace() {\n  const namespaces = [];\n\n  try {\n    if (\n      typeof CORE_RUNTIME_SUPPORT_EXPORTS === 'object' &&\n      CORE_RUNTIME_SUPPORT_EXPORTS\n    ) {\n      namespaces.push(CORE_RUNTIME_SUPPORT_EXPORTS);\n    }\n  } catch (coreRuntimeSupportExportsError) {\n    void coreRuntimeSupportExportsError;\n  }\n\n  try {\n    if (\n      typeof cineCoreRuntimeSupportExports !== 'undefined' &&\n      cineCoreRuntimeSupportExports &&\n      typeof cineCoreRuntimeSupportExports === 'object'\n    ) {\n      namespaces.push(cineCoreRuntimeSupportExports);\n    }\n  } catch (legacyRuntimeSupportExportsError) {\n    void legacyRuntimeSupportExportsError;\n  }\n\n  for (let index = 0; index < namespaces.length; index += 1) {\n    const namespace = namespaces[index];\n    if (namespace && typeof namespace === 'object') {\n      return namespace;\n    }\n  }\n\n  return null;\n})();\n\nconst resolveRuntimeModuleLoaderNamespaceResolver =\n  CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE &&\n    typeof CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE.resolveRuntimeModuleLoader === 'function'\n    ? function resolveRuntimeModuleLoaderProxy() {\n      return CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE.resolveRuntimeModuleLoader();\n    }\n    : fallbackResolveRuntimeModuleLoader;\n\nconst resolvedRuntimeModuleLoader =\n  typeof globalThis === 'object' &&\n    globalThis &&\n    typeof globalThis.resolveRuntimeModuleLoader === 'function'\n    ? globalThis.resolveRuntimeModuleLoader\n    : resolveRuntimeModuleLoaderNamespaceResolver;\n\nif (\n  typeof globalThis === 'object' &&\n  globalThis &&\n  typeof globalThis.resolveRuntimeModuleLoader !== 'function'\n) {\n  globalThis.resolveRuntimeModuleLoader = resolvedRuntimeModuleLoader;\n}\n\nconst requireCoreRuntimeModuleNamespaceResolver =\n  CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE &&\n    typeof CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE.requireCoreRuntimeModule === 'function'\n    ? function requireCoreRuntimeModuleProxy(moduleId, options) {\n      return CORE_RUNTIME_SUPPORT_EXPORT_NAMESPACE.requireCoreRuntimeModule(\n        moduleId,\n        options\n      );\n    }\n    : fallbackRequireCoreRuntimeModule;\n\nconst resolvedRequireCoreRuntimeModule =\n  typeof globalThis === 'object' &&\n    globalThis &&\n    typeof globalThis.requireCoreRuntimeModule === 'function'\n    ? globalThis.requireCoreRuntimeModule\n    : requireCoreRuntimeModuleNamespaceResolver;\n\nif (\n  typeof globalThis === 'object' &&\n  globalThis &&\n  typeof globalThis.requireCoreRuntimeModule !== 'function'\n) {\n  globalThis.requireCoreRuntimeModule = resolvedRequireCoreRuntimeModule;\n}\n\n// All localisation strings live in a dedicated bridge so that translations can\n// be refreshed without touching the heavy runtime bundle. The modern refactor\n// resolves that bridge through the lightweight localisation support module so\n// this file can focus on orchestration.\n// Bootstrap suite orchestration moved to app-core-bootstrap.js\n\n\nif (typeof resolveCoreSupportModule === 'undefined') {\n  window.resolveCoreSupportModule = function (name, path) {\n    if (typeof require === 'function') {\n      try {\n        return require(path);\n      } catch (e) {\n        return null;\n      }\n    }\n    return null;\n  };\n}\n\nlet localizationBootstrapWiringRef = typeof localizationBootstrapWiring !== 'undefined' ? localizationBootstrapWiring : null;\n\nif (!localizationBootstrapWiringRef && typeof require === 'function') {\n  try {\n    const bootstrapModule = require('./app-core-bootstrap.js');\n    localizationBootstrapWiringRef = bootstrapModule.localizationBootstrapWiring;\n  } catch (e) {\n    // Ignore\n  }\n}\n\nconst {\n  localizationSupport: APP_CORE_LOCALIZATION_SUPPORT,\n  localizationRuntimeEnvironment,\n  localizationBridge: CORE_LOCALIZATION_BRIDGE,\n  localizationFallbacks: CORE_LOCALIZATION_FALLBACKS,\n  inlineLocalizationFallbacks: CORE_INLINE_LOCALIZATION_FALLBACKS,\n  localizationFallbackSupport: LOCALIZATION_FALLBACK_SUPPORT,\n  createBasicLocalizationFallbackResolvers,\n  localizationFallbackRegistry: LOCALIZATION_FALLBACK_REGISTRY,\n  localizationFallbackResolvers: LOCALIZATION_FALLBACK_RESOLVERS,\n  localizationFallbackNamespace: LOCALIZATION_FALLBACK_NAMESPACE,\n  fallbackResolveLocaleModule,\n  createLocaleFallbacks,\n} = localizationBootstrapWiringRef || {};\n\nconst CORE_RUNTIME_TOOLS = resolveCoreSupportModule(\n  'cineCoreRuntimeTools',\n  './modules/core/runtime-tools.js'\n);\n\nconst CORE_RUNTIME_TOOL_FALLBACK_NAMESPACE = resolveCoreSupportModule(\n  'cineCoreRuntimeToolFallbacks',\n  './modules/core/runtime-tool-fallbacks.js'\n);\n\nconst RUNTIME_TOOL_INLINE_FALLBACK_TOOLS = resolveCoreSupportModule(\n  'cineCoreAppRuntimeToolInlineFallbacks',\n  './modules/app-core/runtime.js'\n);\n\nconst SETTINGS_DOCUMENTATION_TRACKER_TOOLS = resolveCoreSupportModule(\n  'cineCoreAppSettingsDocumentationTracker',\n  './modules/app-core/settings-documentation-tracker.js'\n);\n\n// Runtime shared bootstrap wiring moved to app-core-runtime-shared.js\n\n// Pink mode support API resolved in app-core-pink-mode.js\n\nlet pinkModeSupportApiRef = typeof PINK_MODE_SUPPORT_API !== 'undefined' ? PINK_MODE_SUPPORT_API : null;\n\nif (!pinkModeSupportApiRef) {\n  if (typeof cineCorePinkModeSupport !== 'undefined') {\n    pinkModeSupportApiRef = cineCorePinkModeSupport;\n  } else if (typeof window !== 'undefined' && window.cineCorePinkModeSupport) {\n    pinkModeSupportApiRef = window.cineCorePinkModeSupport;\n  } else if (typeof globalThis !== 'undefined' && globalThis.cineCorePinkModeSupport) {\n    pinkModeSupportApiRef = globalThis.cineCorePinkModeSupport;\n  }\n}\n\nif (!pinkModeSupportApiRef && typeof require === 'function') {\n  try {\n    const pinkModeModule = require('./app-core-pink-mode.js');\n    pinkModeSupportApiRef = pinkModeModule.PINK_MODE_SUPPORT_API;\n  } catch (e) {\n    // Ignore\n  }\n}\n\nconst {\n  pinkModeIcons,\n  setPinkModeIconSequence,\n  loadPinkModeIconsFromFiles,\n  ensurePinkModeLottieRuntime,\n  resolvePinkModeLottieRuntime: localResolvePinkModeLottieRuntime,\n  startPinkModeAnimatedIcons,\n  stopPinkModeAnimatedIcons,\n  triggerPinkModeIconRain,\n  getPinkModeIconRotationTimer,\n  setPinkModeIconRotationTimer,\n  getPinkModeIconIndex,\n  setPinkModeIconIndex,\n  PINK_MODE_ICON_INTERVAL_MS,\n  PINK_MODE_ICON_ANIMATION_CLASS,\n  PINK_MODE_ICON_ANIMATION_RESET_DELAY,\n  PINK_MODE_ICON_FALLBACK_MARKUP,\n} = pinkModeSupportApiRef || {};\n\nlet ensureSvgHasAriaHidden = function (m) { return m || ''; };\nif (pinkModeSupportApiRef && typeof pinkModeSupportApiRef.ensureSvgHasAriaHidden === 'function') {\n  ensureSvgHasAriaHidden = pinkModeSupportApiRef.ensureSvgHasAriaHidden;\n} else if (typeof window !== 'undefined' && typeof window.ensureSvgHasAriaHidden === 'function') {\n  ensureSvgHasAriaHidden = window.ensureSvgHasAriaHidden;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction iconMarkup(glyph, classNameOrOptions = 'info-icon', options = null) {\n  if (!glyph) return '';\n  let opts = {};\n  let resolvedClassName = 'info-icon';\n  if (typeof classNameOrOptions === 'string' || classNameOrOptions === null) {\n    resolvedClassName = classNameOrOptions || '';\n    if (options && typeof options === 'object') {\n      opts = options;\n    }\n  } else if (classNameOrOptions && typeof classNameOrOptions === 'object') {\n    opts = classNameOrOptions;\n    resolvedClassName = classNameOrOptions.className || 'info-icon';\n  }\n  if (typeof opts.className === 'string') {\n    resolvedClassName = opts.className;\n  }\n  const styleParts = [];\n  if (typeof opts.size === 'string' && opts.size.trim()) {\n    styleParts.push(`--icon - size: ${opts.size.trim()} `);\n  }\n  if (typeof opts.scale === 'string' && opts.scale.trim()) {\n    styleParts.push(`--icon - scale: ${opts.scale.trim()} `);\n  }\n  if (typeof opts.style === 'string' && opts.style.trim()) {\n    styleParts.push(opts.style.trim());\n  }\n  const styleAttr = styleParts.length ? ` style = \"${styleParts.join(';')}\"` : '';\n  const resolved = resolveIconGlyph(glyph);\n  const classes = ['icon-glyph'];\n  if (resolvedClassName) classes.unshift(resolvedClassName);\n  if (resolved.markup) {\n    if (resolved.className) {\n      resolved.className\n        .split(/\\s+/)\n        .filter(Boolean)\n        .forEach(cls => classes.push(cls));\n    }\n    const markup = ensureSvgHasAriaHidden(resolved.markup);\n    return `<span class=\"${classes.join(' ')}\"${styleAttr} aria-hidden=\"true\">${markup}</span>`;\n  }\n  const char = resolved.char || '';\n  if (!char) return '';\n  return `<span class=\"${classes.join(' ')}\"${styleAttr} data-icon-font=\"${resolved.font}\" aria-hidden=\"true\">${char}</span>`;\n}\n\nconst PRODUCTION_COMPANY_ICON = iconGlyph('\\uE2D5', ICON_FONT_KEYS.UICONS);\nconst RENTAL_HOUSE_ICON = iconGlyph('\\uEA09', ICON_FONT_KEYS.UICONS);\nconst ASPECT_RATIO_ICON = iconGlyph('\\uE86E', ICON_FONT_KEYS.UICONS);\nconst REQUIRED_SCENARIOS_ICON = iconGlyph('\\uF4D4', ICON_FONT_KEYS.UICONS);\nconst MONITORING_SUPPORT_ICON = iconGlyph('\\uEFFC', ICON_FONT_KEYS.UICONS);\n\nexposeCoreRuntimeConstant('iconGlyph', iconGlyph);\nexposeCoreRuntimeConstant('resolveIconGlyph', resolveIconGlyph);\nexposeCoreRuntimeConstant('applyIconGlyph', applyIconGlyph);\nexposeCoreRuntimeConstant('formatSvgCoordinate', formatSvgCoordinate);\nexposeCoreRuntimeConstant('positionSvgMarkup', positionSvgMarkup);\nexposeCoreRuntimeConstant('iconMarkup', iconMarkup);\nexposeCoreRuntimeConstant('ICON_GLYPHS', ICON_GLYPHS);\n\nexposeCoreRuntimeConstant('pinkModeIcons', pinkModeIcons);\nexposeCoreRuntimeConstant('setPinkModeIconSequence', setPinkModeIconSequence);\nexposeCoreRuntimeConstant('ensureSvgHasAriaHidden', ensureSvgHasAriaHidden);\nexposeCoreRuntimeConstant('ensurePinkModeLottieRuntime', ensurePinkModeLottieRuntime);\nexposeCoreRuntimeConstant('resolvePinkModeLottieRuntime', localResolvePinkModeLottieRuntime);\nexposeCoreRuntimeConstant('startPinkModeAnimatedIcons', startPinkModeAnimatedIcons);\nexposeCoreRuntimeConstant('stopPinkModeAnimatedIcons', stopPinkModeAnimatedIcons);\nexposeCoreRuntimeConstant('triggerPinkModeIconRain', triggerPinkModeIconRain);\n\n// Runtime candidate scope helpers provided by app-core-runtime-candidate-scopes.js\n\nconst CORE_RUNTIME_STATE_SUPPORT = (function resolveCoreRuntimeStateSupport() {\n  let resolvedSupport = null;\n\n  if (typeof resolveCoreSupportModule === 'function') {\n    try {\n      resolvedSupport = resolveCoreSupportModule(\n        'cineCoreRuntimeState',\n        './modules/core/runtime-state.js'\n      );\n    } catch (runtimeStateResolveError) {\n      void runtimeStateResolveError;\n      resolvedSupport = null;\n    }\n  }\n\n  if (!resolvedSupport) {\n    const loaderRuntimeState = resolvedRequireCoreRuntimeModule(\n      'modules/core/runtime-state.js'\n    );\n    if (loaderRuntimeState && typeof loaderRuntimeState === 'object') {\n      resolvedSupport = loaderRuntimeState;\n    }\n  }\n\n  if (resolvedSupport) {\n    return resolvedSupport;\n  }\n\n  const fallbackScopes = resolvedCollectCoreRuntimeCandidateScopes(\n    typeof CORE_GLOBAL_SCOPE === 'object' ? CORE_GLOBAL_SCOPE : null\n  );\n\n  for (let index = 0; index < fallbackScopes.length; index += 1) {\n    const candidateScope = fallbackScopes[index];\n    if (!candidateScope || typeof candidateScope !== 'object') {\n      continue;\n    }\n\n    try {\n      const candidate = candidateScope.cineCoreRuntimeState;\n      if (candidate && typeof candidate === 'object') {\n        return candidate;\n      }\n    } catch (runtimeStateLookupError) {\n      void runtimeStateLookupError;\n    }\n  }\n\n  return null;\n})();\n\nconst CORE_RUNTIME_LOCALIZATION = (function resolveCoreRuntimeLocalization() {\n  if (typeof resolveCoreSupportModule === 'function') {\n    try {\n      const resolved = resolveCoreSupportModule(\n        'cineCoreRuntimeLocalization',\n        './modules/core/runtime-localization.js'\n      );\n      if (resolved && typeof resolved === 'object') {\n        return resolved;\n      }\n    } catch (coreRuntimeLocalizationResolveError) {\n      void coreRuntimeLocalizationResolveError;\n    }\n  }\n\n  const scopeCandidates = [\n    CORE_PART1_RUNTIME_SCOPE && typeof CORE_PART1_RUNTIME_SCOPE === 'object'\n      ? CORE_PART1_RUNTIME_SCOPE\n      : null,\n    typeof globalThis !== 'undefined' && globalThis && typeof globalThis === 'object'\n      ? globalThis\n      : null,\n    typeof window !== 'undefined' && window && typeof window === 'object' ? window : null,\n    typeof self !== 'undefined' && self && typeof self === 'object' ? self : null,\n    typeof global !== 'undefined' && global && typeof global === 'object' ? global : null,\n  ];\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || typeof scope !== 'object') {\n      continue;\n    }\n\n    try {\n      const candidate = scope.cineCoreRuntimeLocalization;\n      if (candidate && typeof candidate === 'object') {\n        return candidate;\n      }\n    } catch (coreRuntimeLocalizationLookupError) {\n      void coreRuntimeLocalizationLookupError;\n    }\n  }\n\n  const loaderLocalization = resolvedRequireCoreRuntimeModule(\n    'modules/core/runtime-localization.js',\n    { primaryScope: CORE_PART1_RUNTIME_SCOPE }\n  );\n  if (loaderLocalization && typeof loaderLocalization === 'object') {\n    return loaderLocalization;\n  }\n\n  return null;\n})();\n\nconst CORE_LOCALIZATION_RUNTIME =\n  CORE_RUNTIME_LOCALIZATION &&\n    typeof CORE_RUNTIME_LOCALIZATION.createLocalizationRuntime === 'function'\n    ? CORE_RUNTIME_LOCALIZATION.createLocalizationRuntime({\n      runtimeScope: CORE_PART1_RUNTIME_SCOPE,\n      coreGlobalScope: CORE_PART1_RUNTIME_SCOPE,\n      localizationBridge: CORE_LOCALIZATION_BRIDGE,\n      localizationFallbacks: CORE_LOCALIZATION_FALLBACKS,\n      inlineLocalizationFallbacks: CORE_INLINE_LOCALIZATION_FALLBACKS,\n      localizationFallbackNamespace: LOCALIZATION_FALLBACK_NAMESPACE,\n      localizationFallbackSupport: LOCALIZATION_FALLBACK_SUPPORT,\n      localizationFallbackRegistry: LOCALIZATION_FALLBACK_REGISTRY,\n      localizationFallbackResolvers: LOCALIZATION_FALLBACK_RESOLVERS,\n      fallbackResolveLocaleModule,\n      createLocaleFallbacks,\n      translationsRequirePath: './translations.js',\n    })\n    : null;\n\n// Localization accessor factories initialized via app-core-localization-accessors.js\n\nif (CORE_PART1_RUNTIME_SCOPE && CORE_PART1_RUNTIME_SCOPE.__cineCorePart1Initialized) {\n  if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n    console.warn('Cine Power Planner core runtime (part 1) already initialized. Skipping duplicate load.');\n  }\n} else {\n  if (CORE_PART1_RUNTIME_SCOPE) {\n    try {\n      Object.defineProperty(CORE_PART1_RUNTIME_SCOPE, '__cineCorePart1Initialized', {\n        configurable: true,\n        writable: true,\n        value: true,\n      });\n    } catch (corePart1InitError) {\n      CORE_PART1_RUNTIME_SCOPE.__cineCorePart1Initialized = true;\n      void corePart1InitError;\n    }\n  }\n}\n\nvar localAutoGearConditionSections = {};\n\nvar CORE_RUNTIME_TOOL_FALLBACK_FACTORY =\n  CORE_RUNTIME_TOOL_FALLBACK_NAMESPACE &&\n    typeof CORE_RUNTIME_TOOL_FALLBACK_NAMESPACE.createRuntimeToolFallbacks === 'function'\n    ? CORE_RUNTIME_TOOL_FALLBACK_NAMESPACE.createRuntimeToolFallbacks\n    : null;\n\nif (!CORE_RUNTIME_TOOL_FALLBACK_FACTORY) {\n  const runtimeToolFallbacks = resolvedRequireCoreRuntimeModule(\n    'modules/core/runtime-tool-fallbacks.js',\n    { primaryScope: CORE_PART1_RUNTIME_SCOPE }\n  );\n  if (\n    runtimeToolFallbacks &&\n    typeof runtimeToolFallbacks.createRuntimeToolFallbacks === 'function'\n  ) {\n    CORE_RUNTIME_TOOL_FALLBACK_FACTORY =\n      runtimeToolFallbacks.createRuntimeToolFallbacks;\n  }\n}\n\nconst CORE_RUNTIME_GLOBAL_TOOLS_BRIDGE =\n  (typeof CORE_RUNTIME_GLOBAL_TOOLS === 'object' && CORE_RUNTIME_GLOBAL_TOOLS)\n  || (typeof cineCoreRuntimeGlobalTools === 'object' && cineCoreRuntimeGlobalTools)\n  || null;\n\n\n\n\n\nvar CORE_TEMPERATURE_KEY_DEFAULTS = (function resolveCoreTemperatureKeyDefaults() {\n  const defaults = {\n    queueKey: CORE_TEMPERATURE_QUEUE_KEY,\n    renderName: CORE_TEMPERATURE_RENDER_NAME,\n  };\n\n  if (\n    CORE_RUNTIME_STATE_SUPPORT &&\n    typeof CORE_RUNTIME_STATE_SUPPORT.resolveTemperatureKeyDefaults === 'function'\n  ) {\n    try {\n      const resolvedDefaults = CORE_RUNTIME_STATE_SUPPORT.resolveTemperatureKeyDefaults();\n      if (resolvedDefaults && typeof resolvedDefaults === 'object') {\n        if (typeof resolvedDefaults.queueKey === 'string' && resolvedDefaults.queueKey) {\n          defaults.queueKey = resolvedDefaults.queueKey;\n        }\n\n        if (typeof resolvedDefaults.renderName === 'string' && resolvedDefaults.renderName) {\n          defaults.renderName = resolvedDefaults.renderName;\n        }\n      }\n    } catch (resolveTemperatureDefaultsError) {\n      void resolveTemperatureDefaultsError;\n    }\n  }\n\n  if (typeof defaults.queueKey !== 'string' || !defaults.queueKey) {\n    defaults.queueKey = '__cinePendingTemperatureNote';\n  }\n\n  if (typeof defaults.renderName !== 'string' || !defaults.renderName) {\n    defaults.renderName = 'renderTemperatureNote';\n  }\n\n  return defaults;\n})();\n\n\n\nconst CORE_RUNTIME_UI_BRIDGE = (function resolveCoreRuntimeUiBridge() {\n  const candidates = [];\n\n  if (typeof require === 'function') {\n    try {\n      const requiredBridge = require('./app-core-runtime-ui.js');\n      if (requiredBridge && typeof requiredBridge === 'object') {\n        candidates.push(requiredBridge);\n      }\n    } catch (bridgeError) {\n      void bridgeError;\n    }\n  }\n\n  const scopes = [];\n\n  try {\n    if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE) {\n      scopes.push(CORE_GLOBAL_SCOPE);\n    }\n  } catch (coreScopeError) {\n    void coreScopeError;\n  }\n\n  if (typeof globalThis !== 'undefined' && globalThis) {\n    scopes.push(globalThis);\n  }\n\n  if (typeof window !== 'undefined' && window) {\n    scopes.push(window);\n  }\n\n  if (typeof self !== 'undefined' && self) {\n    scopes.push(self);\n  }\n\n  if (typeof global !== 'undefined' && global) {\n    scopes.push(global);\n  }\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope) {\n      continue;\n    }\n\n    try {\n      const bridge = scope.cineCoreRuntimeUiBridge;\n      if (bridge && typeof bridge === 'object') {\n        candidates.push(bridge);\n      }\n    } catch (scopeLookupError) {\n      void scopeLookupError;\n    }\n  }\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (candidate && typeof candidate === 'object') {\n      return candidate;\n    }\n  }\n\n  return {};\n})();\n\nvar escapeHtml =\n  typeof CORE_RUNTIME_UI_BRIDGE.escapeHtml === 'function'\n    ? CORE_RUNTIME_UI_BRIDGE.escapeHtml\n    : function escapeHtmlFallback(str) {\n      return String(str)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#39;');\n    };\n\nconst escapeButtonLabelSafelyHelper =\n  typeof CORE_RUNTIME_UI_BRIDGE.escapeButtonLabelSafely === 'function'\n    ? CORE_RUNTIME_UI_BRIDGE.escapeButtonLabelSafely\n    : function escapeButtonLabelSafelyFallback(text) {\n      if (typeof text !== 'string' || text === '') {\n        return '';\n      }\n      return escapeHtml(text);\n    };\n\nconst resolveButtonIconMarkupHelper =\n  typeof CORE_RUNTIME_UI_BRIDGE.resolveButtonIconMarkup === 'function'\n    ? CORE_RUNTIME_UI_BRIDGE.resolveButtonIconMarkup\n    : function resolveButtonIconMarkupFallback() {\n      return '';\n    };\n\nconst setButtonLabelWithIconBinding = ensureCoreGlobalValue(\n  'setButtonLabelWithIcon',\n  function resolveSetButtonLabelWithIconValue() {\n    if (typeof CORE_RUNTIME_UI_BRIDGE.setButtonLabelWithIcon === 'function') {\n      return CORE_RUNTIME_UI_BRIDGE.setButtonLabelWithIcon;\n    }\n\n    return function setButtonLabelWithIconFallback(button, label, glyph) {\n      if (!button) {\n        return;\n      }\n\n      let resolvedGlyph = glyph;\n      if (typeof resolvedGlyph === 'undefined') {\n        try {\n          if (typeof ICON_GLYPHS === 'object' && ICON_GLYPHS && ICON_GLYPHS.save) {\n            resolvedGlyph = ICON_GLYPHS.save;\n          }\n        } catch (glyphError) {\n          void glyphError;\n        }\n      }\n\n      const iconHtml = resolveButtonIconMarkupHelper(resolvedGlyph);\n      const safeLabel = escapeButtonLabelSafelyHelper(\n        typeof label === 'string' ? label : '',\n      );\n\n      try {\n        button.innerHTML = `${iconHtml}${safeLabel} `;\n      } catch (assignError) {\n        void assignError;\n      }\n    };\n  },\n);\n\nif (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n  try {\n    CORE_GLOBAL_SCOPE.setButtonLabelWithIcon = setButtonLabelWithIconBinding;\n  } catch (setButtonAssignError) {\n    CORE_GLOBAL_SCOPE.setButtonLabelWithIcon = setButtonLabelWithIconBinding;\n    void setButtonAssignError;\n  }\n}\n\nfunction dispatchTemperatureNoteRender(hours) {\n  const scope = getCoreGlobalObject();\n  let renderer = null;\n\n  if (\n    !renderer &&\n    CORE_RUNTIME_STATE &&\n    typeof CORE_RUNTIME_STATE.getAssignedTemperatureRenderer === 'function'\n  ) {\n    try {\n      renderer = CORE_RUNTIME_STATE.getAssignedTemperatureRenderer();\n    } catch (stateRendererError) {\n      void stateRendererError;\n    }\n  }\n\n  try {\n    if (typeof renderTemperatureNote === \"function\") {\n      renderer = renderTemperatureNote;\n    }\n  } catch (referenceError) {\n    const isReferenceError =\n      referenceError &&\n      (referenceError.name === \"ReferenceError\" ||\n        /is not defined|Cannot access uninitialized/i.test(\n          String(referenceError && referenceError.message)\n        ));\n\n    if (!isReferenceError) {\n      throw referenceError;\n    }\n  }\n\n  if (!renderer && scope && typeof scope === \"object\") {\n    try {\n      const scopedRenderer = scope[CORE_TEMPERATURE_RENDER_NAME];\n      if (typeof scopedRenderer === \"function\") {\n        renderer = scopedRenderer;\n      }\n    } catch (readError) {\n      void readError;\n    }\n  }\n\n  if (typeof renderer === \"function\") {\n    try {\n      renderer(hours);\n    } catch (renderError) {\n      if (typeof console !== \"undefined\" && typeof console.error === \"function\") {\n        console.error(\"Temperature note renderer failed\", renderError);\n      }\n    }\n    return;\n  }\n\n  if (!scope || typeof scope !== \"object\") {\n    return;\n  }\n\n  let pending = scope[CORE_TEMPERATURE_QUEUE_KEY];\n  if (!pending || typeof pending !== \"object\") {\n    pending = {};\n  }\n  pending.latestHours = hours;\n  try {\n    pending.updatedAt = Date.now ? Date.now() : new Date().getTime();\n  } catch (timestampError) {\n    void timestampError;\n    pending.updatedAt = 0;\n  }\n  scope[CORE_TEMPERATURE_QUEUE_KEY] = pending;\n}\n\nfunction exposeCoreRuntimeBindings(bindings) {\n  if (!bindings || typeof bindings !== 'object') {\n    return;\n  }\n\n  const scope =\n    (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object')\n      ? CORE_GLOBAL_SCOPE\n      : typeof globalThis !== 'undefined'\n        ? globalThis\n        : typeof window !== 'undefined'\n          ? window\n          : typeof self !== 'undefined'\n            ? self\n            : typeof global !== 'undefined'\n              ? global\n              : null;\n\n  if (!scope || typeof scope !== 'object') {\n    return;\n  }\n\n  Object.entries(bindings).forEach(([name, descriptor]) => {\n    if (typeof name !== 'string' || !name) {\n      return;\n    }\n\n    const getter = descriptor && typeof descriptor.get === 'function' ? descriptor.get : null;\n    const setter = descriptor && typeof descriptor.set === 'function' ? descriptor.set : null;\n\n    if (!getter) {\n      return;\n    }\n\n    try {\n      Object.defineProperty(scope, name, {\n        configurable: true,\n        enumerable: false,\n        get: getter,\n        set: setter || undefined,\n      });\n      return;\n    } catch (defineError) {\n      void defineError;\n    }\n\n    try {\n      scope[name] = getter();\n    } catch (assignError) {\n      void assignError;\n    }\n  });\n}\n\nconst CORE_PART1_VALID_IDENTIFIER = /^[A-Za-z_$][A-Za-z0-9_$]*$/;\n\nfunction runCoreRuntimeSegment(executor) {\n  if (typeof executor !== 'function') {\n    return false;\n  }\n\n  const scope =\n    (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object')\n      ? CORE_GLOBAL_SCOPE\n      : typeof globalThis !== 'undefined'\n        ? globalThis\n        : typeof window !== 'undefined'\n          ? window\n          : typeof self !== 'undefined'\n            ? self\n            : typeof global !== 'undefined'\n              ? global\n              : null;\n\n  try {\n    executor.call(scope || this);\n    return true;\n  } catch (executionError) {\n    if (typeof console !== 'undefined' && typeof console.error === 'function') {\n      console.error('Cine Power Planner core runtime segment failed to evaluate.', executionError);\n    }\n  }\n\n  return false;\n}\n\nif (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n  try {\n    Object.defineProperty(CORE_GLOBAL_SCOPE, '__cineCorePart1Runner', {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: runCoreRuntimeSegment,\n    });\n  } catch (runnerDefineError) {\n    CORE_GLOBAL_SCOPE.__cineCorePart1Runner = runCoreRuntimeSegment;\n    void runnerDefineError;\n  }\n}\n\nfunction resolveCoreShared() {\n  if (CORE_GLOBAL_SCOPE && CORE_GLOBAL_SCOPE.cineCoreShared) {\n    return CORE_GLOBAL_SCOPE.cineCoreShared;\n  }\n  if (typeof require === 'function') {\n    try {\n      return require('./modules/core-shared.js');\n    } catch (error) {\n      void error;\n    }\n  }\n  return null;\n}\n\n\n\nfunction resolveCoreRuntimeHelpers() {\n  const candidates = [];\n\n  if (typeof CORE_PART2_RUNTIME_HELPERS !== 'undefined' && CORE_PART2_RUNTIME_HELPERS) {\n    candidates.push(CORE_PART2_RUNTIME_HELPERS);\n  }\n\n  if (CORE_SHARED && typeof CORE_SHARED.cineCoreRuntimeHelpers === 'object') {\n    candidates.push(CORE_SHARED.cineCoreRuntimeHelpers);\n  }\n\n  if (\n    typeof CORE_GLOBAL_SCOPE !== 'undefined' &&\n    CORE_GLOBAL_SCOPE &&\n    typeof CORE_GLOBAL_SCOPE.cineCoreRuntimeHelpers === 'object'\n  ) {\n    candidates.push(CORE_GLOBAL_SCOPE.cineCoreRuntimeHelpers);\n  }\n\n  if (\n    typeof CORE_SHARED_SCOPE_PART2 !== 'undefined' &&\n    CORE_SHARED_SCOPE_PART2 &&\n    typeof CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers === 'object'\n  ) {\n    candidates.push(CORE_SHARED_SCOPE_PART2.cineCoreRuntimeHelpers);\n  }\n\n  if (typeof globalThis !== 'undefined' && globalThis && typeof globalThis.cineCoreRuntimeHelpers === 'object') {\n    candidates.push(globalThis.cineCoreRuntimeHelpers);\n  }\n\n  if (typeof window !== 'undefined' && window && typeof window.cineCoreRuntimeHelpers === 'object') {\n    candidates.push(window.cineCoreRuntimeHelpers);\n  }\n\n  if (typeof self !== 'undefined' && self && typeof self.cineCoreRuntimeHelpers === 'object') {\n    candidates.push(self.cineCoreRuntimeHelpers);\n  }\n\n  if (typeof global !== 'undefined' && global && typeof global.cineCoreRuntimeHelpers === 'object') {\n    candidates.push(global.cineCoreRuntimeHelpers);\n  }\n\n  if (typeof require === 'function') {\n    try {\n      const required = require('./app-core-runtime-helpers.js');\n      if (required && typeof required === 'object') {\n        candidates.push(required);\n      }\n    } catch (runtimeHelpersError) {\n      void runtimeHelpersError;\n    }\n  }\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (candidate && typeof candidate === 'object') {\n      return candidate;\n    }\n  }\n\n  return null;\n}\n\nconst CORE_RUNTIME_HELPERS = resolveCoreRuntimeHelpers();\nconst CORE_RUNTIME_FALLBACKS = (CORE_RUNTIME_HELPERS && typeof CORE_RUNTIME_HELPERS === 'object')\n  ? CORE_RUNTIME_HELPERS\n  : {};\n\nfunction createCoreRuntimeStateFallback(candidateScopes) {\n  const scopes = [];\n  const seenScopes =\n    typeof Set === 'function'\n      ? new Set()\n      : null;\n\n  function registerScope(scope) {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n\n    if (seenScopes) {\n      if (seenScopes.has(scope)) {\n        return;\n      }\n      seenScopes.add(scope);\n      scopes.push(scope);\n      return;\n    }\n\n    if (scopes.indexOf(scope) !== -1) {\n      return;\n    }\n\n    scopes.push(scope);\n  }\n\n  if (Array.isArray(candidateScopes)) {\n    for (let index = 0; index < candidateScopes.length; index += 1) {\n      try {\n        registerScope(candidateScopes[index]);\n      } catch (initialiseScopeError) {\n        void initialiseScopeError;\n      }\n    }\n  }\n\n  function withEachScope(callback) {\n    if (typeof callback !== 'function') {\n      return;\n    }\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      try {\n        callback(scopes[index], index);\n      } catch (scopeCallbackError) {\n        void scopeCallbackError;\n      }\n    }\n  }\n\n  function getScopes() {\n    return scopes.slice();\n  }\n\n  function getPrimaryScope() {\n    return scopes.length > 0 ? scopes[0] : null;\n  }\n\n  function ensureValue(name, fallbackValue) {\n    const fallbackProvider =\n      typeof fallbackValue === 'function'\n        ? fallbackValue\n        : function provideStaticFallback() {\n          return fallbackValue;\n        };\n\n    if (typeof name !== 'string' || !name) {\n      try {\n        return fallbackProvider();\n      } catch (fallbackError) {\n        void fallbackError;\n        return undefined;\n      }\n    }\n\n    for (let index = 0; index < scopes.length; index += 1) {\n      const scope = scopes[index];\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        continue;\n      }\n\n      try {\n        if (typeof scope[name] === 'undefined') {\n          scope[name] = fallbackProvider();\n        }\n        return scope[name];\n      } catch (ensureError) {\n        void ensureError;\n      }\n    }\n\n    try {\n      return fallbackProvider();\n    } catch (fallbackError) {\n      void fallbackError;\n      return undefined;\n    }\n  }\n\n  function normaliseValue(name, validator, fallbackValue) {\n    const fallbackProvider =\n      typeof fallbackValue === 'function'\n        ? fallbackValue\n        : function provideStaticFallback() {\n          return fallbackValue;\n        };\n\n    const validate =\n      typeof validator === 'function'\n        ? validator\n        : function alwaysValid() {\n          return true;\n        };\n\n    withEachScope(scope => {\n      try {\n        if (!validate(scope[name])) {\n          scope[name] = fallbackProvider();\n        }\n      } catch (normaliseError) {\n        void normaliseError;\n      }\n    });\n  }\n\n  function readValue(name) {\n    for (let index = 0; index < scopes.length; index += 1) {\n      const scope = scopes[index];\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        continue;\n      }\n\n      try {\n        if (name in scope) {\n          return scope[name];\n        }\n      } catch (readError) {\n        void readError;\n      }\n    }\n\n    return undefined;\n  }\n\n  let assignedTemperatureRenderer = null;\n\n  function assignTemperatureRenderer(renderer) {\n    if (typeof renderer !== 'function') {\n      return;\n    }\n\n    assignedTemperatureRenderer = renderer;\n\n    withEachScope(scope => {\n      if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n        return;\n      }\n\n      try {\n        scope[CORE_TEMPERATURE_RENDER_NAME] = renderer;\n        const pending = scope[CORE_TEMPERATURE_QUEUE_KEY];\n\n        if (pending && typeof pending === 'object') {\n          if (Object.prototype.hasOwnProperty.call(pending, 'latestHours')) {\n            const hours = pending.latestHours;\n            if (typeof hours !== 'undefined') {\n              try {\n                renderer(hours);\n              } catch (temperatureRenderError) {\n                if (\n                  typeof console !== 'undefined' &&\n                  typeof console.error === 'function'\n                ) {\n                  console.error(\n                    'Failed to apply pending temperature note render',\n                    temperatureRenderError,\n                  );\n                }\n              }\n            }\n          }\n\n          try {\n            delete pending.latestHours;\n          } catch (clearLatestError) {\n            void clearLatestError;\n            pending.latestHours = undefined;\n          }\n        }\n      } catch (assignError) {\n        void assignError;\n      }\n    });\n  }\n\n  function getAssignedTemperatureRenderer() {\n    return assignedTemperatureRenderer;\n  }\n\n  const autoGearGuards = {\n    isReferenceError() {\n      return false;\n    },\n    repair() {\n      return undefined;\n    },\n  };\n\n  function setAutoGearGuards(nextGuards) {\n    if (!nextGuards || typeof nextGuards !== 'object') {\n      return;\n    }\n\n    if (typeof nextGuards.isReferenceError === 'function') {\n      autoGearGuards.isReferenceError = nextGuards.isReferenceError;\n    }\n\n    if (typeof nextGuards.repair === 'function') {\n      autoGearGuards.repair = nextGuards.repair;\n    }\n  }\n\n  return {\n    registerScope,\n    withEachScope,\n    getScopes,\n    getPrimaryScope,\n    ensureValue,\n    normaliseValue,\n    readValue,\n    assignTemperatureRenderer,\n    getAssignedTemperatureRenderer,\n    autoGearGuards,\n    setAutoGearGuards,\n  };\n}\n\nfunction createCoreRuntimeState(candidateScopes) {\n  if (\n    CORE_RUNTIME_STATE_SUPPORT &&\n    typeof CORE_RUNTIME_STATE_SUPPORT.createLocalRuntimeState === 'function'\n  ) {\n    try {\n      return CORE_RUNTIME_STATE_SUPPORT.createLocalRuntimeState(candidateScopes, {\n        temperatureQueueKey: CORE_TEMPERATURE_QUEUE_KEY,\n        temperatureRenderName: CORE_TEMPERATURE_RENDER_NAME,\n      });\n    } catch (coreRuntimeStateError) {\n      void coreRuntimeStateError;\n    }\n  }\n\n  return createCoreRuntimeStateFallback(candidateScopes);\n}\n\nvar CORE_RUNTIME_STATE = ensureCoreGlobalValue('__cineRuntimeState', () => {\n  const candidateScopes = CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED.length\n    ? CORE_RUNTIME_CANDIDATE_SCOPES_RESOLVED\n    : resolvedCollectCoreRuntimeCandidateScopes(\n      typeof CORE_GLOBAL_SCOPE === 'object' ? CORE_GLOBAL_SCOPE : null\n    );\n\n  return createCoreRuntimeState(candidateScopes);\n});\n\nif (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n  try {\n    Object.defineProperty(CORE_GLOBAL_SCOPE, '__cineCreateRuntimeState', {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: createCoreRuntimeState,\n    });\n  } catch (exposeCreateStateError) {\n    try {\n      CORE_GLOBAL_SCOPE.__cineCreateRuntimeState = createCoreRuntimeState;\n    } catch (assignCreateStateError) {\n      void assignCreateStateError;\n    }\n    void exposeCreateStateError;\n  }\n}\n\nfunction isAutoGearGlobalReferenceError(error) {\n  if (!CORE_RUNTIME_STATE || !CORE_RUNTIME_STATE.autoGearGuards) {\n    return false;\n  }\n\n  const guard = CORE_RUNTIME_STATE.autoGearGuards.isReferenceError;\n  if (typeof guard !== 'function') {\n    return false;\n  }\n\n  try {\n    return guard(error) === true;\n  } catch (guardError) {\n    void guardError;\n  }\n\n  return false;\n}\n\nfunction repairAutoGearGlobals(scope) {\n  if (!CORE_RUNTIME_STATE || !CORE_RUNTIME_STATE.autoGearGuards) {\n    return;\n  }\n\n  const repair = CORE_RUNTIME_STATE.autoGearGuards.repair;\n  if (typeof repair !== 'function') {\n    return;\n  }\n\n  try {\n    repair(scope);\n  } catch (repairError) {\n    void repairError;\n  }\n}\n\nfunction callCoreFunctionIfAvailable(functionName, args = [], options = {}) {\n  const scope =\n    CORE_GLOBAL_SCOPE ||\n    (typeof globalThis !== 'undefined' ? globalThis : null) ||\n    (typeof window !== 'undefined' ? window : null) ||\n    (typeof self !== 'undefined' ? self : null) ||\n    (typeof global !== 'undefined' ? global : null);\n\n  const target =\n    typeof functionName === 'string'\n      ? scope && scope[functionName]\n      : functionName;\n\n  if (typeof target === 'function') {\n    if (target.__cineSessionProxy__ === true) {\n      const optionsObject = options && typeof options === 'object' ? options : {};\n      const attemptCount =\n        typeof optionsObject.attempts === 'number' && Number.isFinite(optionsObject.attempts)\n          ? optionsObject.attempts\n          : 0;\n      if (typeof enqueueCoreBootTask === 'function' && attemptCount < 3) {\n        const nextOptions = { ...optionsObject, defer: false, attempts: attemptCount + 1 };\n        enqueueCoreBootTask(() => {\n          callCoreFunctionIfAvailable(functionName, args, nextOptions);\n        });\n      }\n      if (Object.prototype.hasOwnProperty.call(optionsObject, 'defaultValue')) {\n        return optionsObject.defaultValue;\n      }\n      return undefined;\n    }\n    if (target.__cineDeferredPlaceholder__ === true) {\n      const optionsObject = options && typeof options === 'object' ? options : {};\n      const attemptCount = typeof optionsObject.attempts === 'number' && Number.isFinite(optionsObject.attempts)\n        ? optionsObject.attempts\n        : 0;\n      if (typeof enqueueCoreBootTask === 'function' && attemptCount < 3) {\n        const nextOptions = { ...optionsObject, defer: false, attempts: attemptCount + 1 };\n        enqueueCoreBootTask(() => {\n          callCoreFunctionIfAvailable(functionName, args, nextOptions);\n        });\n      }\n      return undefined;\n    }\n    let attempt = 0;\n    while (attempt < 2) {\n      try {\n        return target.apply(scope, args);\n      } catch (invokeError) {\n        if (attempt === 0 && isAutoGearGlobalReferenceError(invokeError)) {\n          repairAutoGearGlobals(scope);\n          attempt += 1;\n          continue;\n        }\n\n        if (typeof console !== 'undefined' && typeof console.error === 'function') {\n          console.error(`Failed to invoke ${functionName} `, invokeError);\n        }\n        break;\n      }\n    }\n    return undefined;\n  }\n\n  if (options && options.defer === true) {\n    enqueueCoreBootTask(() => {\n      callCoreFunctionIfAvailable(functionName, args, { ...options, defer: false });\n    });\n  }\n\n  return typeof options !== 'undefined' && Object.prototype.hasOwnProperty.call(options, 'defaultValue')\n    ? options.defaultValue\n    : undefined;\n}\n\nexposeCoreRuntimeConstant('applyLegacyGridSnapValue', applyLegacyGridSnapValue);\n\nfunction safeFormatAutoGearItemSummary(item, options = {}) {\n  if (typeof formatAutoGearItemSummary === 'function') {\n    try {\n      return formatAutoGearItemSummary(item, options);\n    } catch (formatError) {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('Failed to format automatic gear item summary via direct formatter.', formatError);\n      }\n    }\n  }\n\n  const fallback = callCoreFunctionIfAvailable(\n    'formatAutoGearItemSummary',\n    [item, options],\n    { defaultValue: '' },\n  );\n\n  if (typeof fallback === 'string') {\n    return fallback;\n  }\n  if (fallback === null || typeof fallback === 'undefined') {\n    return '';\n  }\n  try {\n    return String(fallback);\n  } catch (coerceError) {\n    void coerceError;\n    return '';\n  }\n}\n\nfunction formatWithPlaceholdersSafe(template, ...values) {\n  if (typeof formatWithPlaceholders === 'function') {\n    try {\n      return formatWithPlaceholders(template, ...values);\n    } catch (formatError) {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('Failed to format placeholder template via direct formatter.', formatError);\n      }\n    }\n  }\n\n  const fallback = callCoreFunctionIfAvailable(\n    'formatWithPlaceholders',\n    [template, ...values],\n    { defaultValue: null },\n  );\n\n  if (typeof fallback === 'string' && fallback) {\n    return fallback;\n  }\n\n  let formatted = typeof template === 'string' ? template : String(template || '');\n  for (let index = 0; index < values.length; index += 1) {\n    const value = values[index];\n    formatted = formatted.replace('%s', value);\n  }\n  return formatted;\n}\n\n(function ensureCoreRuntimePlaceholders() {\n  const scope =\n    (typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null) ||\n    (typeof globalThis !== 'undefined' ? globalThis : null) ||\n    (typeof window !== 'undefined' ? window : null) ||\n    (typeof self !== 'undefined' ? self : null) ||\n    (typeof global !== 'undefined' ? global : null);\n\n  if (typeof window !== 'undefined') {\n    try { window.populateSelect = undefined; /* Clear any potential conflict */ } catch (e) { }\n  }\n\n  if (!scope || typeof scope !== 'object') {\n    return;\n  }\n\n  if (typeof scope.populateSelect !== 'function') {\n    const placeholder = function populateSelectPlaceholder(selectElem, optionsObj = {}, includeNone = true) {\n      if (!selectElem) {\n        return;\n      }\n\n      const opts = optionsObj && typeof optionsObj === 'object' ? optionsObj : {};\n\n      try {\n        selectElem.innerHTML = '';\n        if (includeNone) {\n          const noneOpt = document.createElement('option');\n          noneOpt.value = 'None';\n          const noneMap = { de: 'Keine Auswahl', es: 'Ninguno', fr: 'Aucun' };\n          const lang = typeof currentLang === 'string' ? currentLang : 'en';\n          noneOpt.textContent = noneMap[lang] || 'None';\n          selectElem.appendChild(noneOpt);\n        }\n\n        Object.keys(opts)\n          .filter(name => name !== 'None')\n          .sort(typeof localeSort === 'function' ? localeSort : undefined)\n          .forEach(name => {\n            const opt = document.createElement('option');\n            opt.value = name;\n            opt.textContent = name;\n            selectElem.appendChild(opt);\n          });\n      } catch (populateError) {\n        if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n          console.warn('populateSelect placeholder failed to render options immediately', populateError);\n        }\n      }\n\n      enqueueCoreBootTask(() => {\n        const realPopulate =\n          scope && typeof scope.populateSelect === 'function' && scope.populateSelect !== placeholder\n            ? scope.populateSelect\n            : null;\n        if (realPopulate) {\n          realPopulate(selectElem, optionsObj, includeNone);\n        }\n      });\n    };\n    placeholder.__cineDeferredPlaceholder__ = true;\n\n    try {\n      scope.populateSelect = placeholder;\n      if (typeof window !== 'undefined') window.populateSelect = placeholder;\n    } catch (assignError) {\n      console.warn('Failed to assign populateSelect', assignError);\n    }\n  }\n\n  const ensureFunctionPlaceholder = (name) => {\n    if (typeof name !== 'string' || !name) {\n      return;\n    }\n    if (typeof scope[name] === 'function') {\n      return;\n    }\n\n    const placeholder = function coreDeferredFunctionPlaceholder(...args) {\n      return callCoreFunctionIfAvailable(name, args, { defer: true, attempts: 0 });\n    };\n    placeholder.__cineDeferredPlaceholder__ = true;\n\n    try {\n      scope[name] = placeholder;\n    } catch (assignError) {\n      void assignError;\n    }\n  };\n\n  ensureFunctionPlaceholder('checkSetupChanged');\n  ensureFunctionPlaceholder('updateCalculations');\n\n  if (typeof scope.feedbackCancelBtn === 'undefined') {\n    try {\n      scope.feedbackCancelBtn = null;\n    } catch (assignError) {\n      void assignError;\n    }\n  }\n})();\n\nvar stableStringify = typeof CORE_SHARED.stableStringify === 'function'\n  ? CORE_SHARED.stableStringify\n  : typeof CORE_SHARED.fallbackStableStringify === 'function'\n    ? CORE_SHARED.fallbackStableStringify\n    : typeof CORE_RUNTIME_FALLBACKS.fallbackStableStringify === 'function'\n      ? CORE_RUNTIME_FALLBACKS.fallbackStableStringify\n      : function fallbackStableStringifyProxy(value) {\n        try {\n          return JSON.stringify(value);\n        } catch (serializationError) {\n          void serializationError;\n        }\n        return String(value);\n      };\n\nconst humanizeKey = typeof CORE_SHARED.humanizeKey === 'function'\n  ? CORE_SHARED.humanizeKey\n  : typeof CORE_SHARED.fallbackHumanizeKey === 'function'\n    ? CORE_SHARED.fallbackHumanizeKey\n    : typeof CORE_RUNTIME_FALLBACKS.fallbackHumanizeKey === 'function'\n      ? CORE_RUNTIME_FALLBACKS.fallbackHumanizeKey\n      : function fallbackHumanizeKeyProxy(key) {\n        const stringValue = typeof key === 'string' ? key : String(key || '');\n        return stringValue.charAt(0).toUpperCase() + stringValue.slice(1);\n      };\n\nfunction fallbackResolveConnectorSummaryGenerator() {\n  const scopes = [];\n  if (typeof globalThis !== 'undefined') scopes.push(globalThis);\n  if (typeof window !== 'undefined') scopes.push(window);\n  if (typeof global !== 'undefined') scopes.push(global);\n  if (typeof self !== 'undefined') scopes.push(self);\n\n  for (const scope of scopes) {\n    if (scope && typeof scope.generateConnectorSummary === 'function') {\n      return scope.generateConnectorSummary;\n    }\n  }\n\n  return null;\n}\n\nconst resolveConnectorSummaryGenerator = typeof CORE_SHARED.resolveConnectorSummaryGenerator === 'function'\n  ? CORE_SHARED.resolveConnectorSummaryGenerator\n  : fallbackResolveConnectorSummaryGenerator;\n\nlet sessionSafeGenerateConnectorSummary = typeof CORE_SHARED.safeGenerateConnectorSummary === 'function'\n  ? CORE_SHARED.safeGenerateConnectorSummary\n  : function safeGenerateConnectorSummary(device) {\n    if (!device) {\n      return '';\n    }\n\n    const generator = resolveConnectorSummaryGenerator();\n    if (typeof generator !== 'function') {\n      return '';\n    }\n\n    try {\n      const summary = generator(device);\n      return summary || '';\n    } catch (error) {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('Unable to generate connector summary', error);\n      }\n      return '';\n    }\n  };\n\nconst normalizeAutoGearWeightOperator = typeof CORE_SHARED.normalizeAutoGearWeightOperator === 'function'\n  ? CORE_SHARED.normalizeAutoGearWeightOperator\n  : typeof CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearWeightOperator === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearWeightOperator\n    : function normalizeAutoGearWeightOperatorFallback() {\n      return 'greater';\n    };\n\nconst normalizeAutoGearWeightValue = typeof CORE_SHARED.normalizeAutoGearWeightValue === 'function'\n  ? CORE_SHARED.normalizeAutoGearWeightValue\n  : typeof CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearWeightValue === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearWeightValue\n    : function normalizeAutoGearWeightValueFallback() {\n      return null;\n    };\n\nconst normalizeAutoGearCameraWeightCondition = typeof CORE_SHARED.normalizeAutoGearCameraWeightCondition === 'function'\n  ? CORE_SHARED.normalizeAutoGearCameraWeightCondition\n  : typeof CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearCameraWeightCondition === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackNormalizeAutoGearCameraWeightCondition\n    : function normalizeAutoGearCameraWeightConditionFallback() {\n      return null;\n    };\n\nconst formatAutoGearWeight = typeof CORE_SHARED.formatAutoGearWeight === 'function'\n  ? CORE_SHARED.formatAutoGearWeight\n  : typeof CORE_RUNTIME_FALLBACKS.fallbackFormatAutoGearWeight === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackFormatAutoGearWeight\n    : function formatAutoGearWeightFallback(value) {\n      return Number.isFinite(value) ? String(value) : '';\n    };\n\nconst fallbackGetAutoGearCameraWeightOperatorLabel =\n  typeof CORE_RUNTIME_FALLBACKS.fallbackGetAutoGearCameraWeightOperatorLabel === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackGetAutoGearCameraWeightOperatorLabel\n    : function getAutoGearCameraWeightOperatorLabelFallback(operator, langTexts) {\n      const textsForLang = langTexts || {};\n      const normalized = normalizeAutoGearWeightOperator(operator);\n      if (normalized === 'less') {\n        return textsForLang.autoGearCameraWeightOperatorLess || 'Lighter than';\n      }\n      if (normalized === 'equal') {\n        return textsForLang.autoGearCameraWeightOperatorEqual || 'Exactly';\n      }\n      return textsForLang.autoGearCameraWeightOperatorGreater || 'Heavier than';\n    };\n\nconst getAutoGearCameraWeightOperatorLabel = typeof CORE_SHARED.getAutoGearCameraWeightOperatorLabel === 'function'\n  ? CORE_SHARED.getAutoGearCameraWeightOperatorLabel\n  : fallbackGetAutoGearCameraWeightOperatorLabel;\n\nconst fallbackFormatAutoGearCameraWeight =\n  typeof CORE_RUNTIME_FALLBACKS.fallbackFormatAutoGearCameraWeight === 'function'\n    ? CORE_RUNTIME_FALLBACKS.fallbackFormatAutoGearCameraWeight\n    : function formatAutoGearCameraWeightFallback(condition, langTexts) {\n      if (!condition || !Number.isFinite(condition.value)) return '';\n      const label = getAutoGearCameraWeightOperatorLabel(condition.operator, langTexts);\n      const formattedValue = formatAutoGearWeight(condition.value);\n      return label ? `${label} ${formattedValue} g` : `${formattedValue} g`;\n    };\n\nconst formatAutoGearCameraWeight = typeof CORE_SHARED.formatAutoGearCameraWeight === 'function'\n  ? CORE_SHARED.formatAutoGearCameraWeight\n  : fallbackFormatAutoGearCameraWeight;\n\n// Use `var` here instead of `let` because `index.html` loads the lz-string\n// library from a CDN which defines a global `LZString` variable. Using `let`\n// would attempt to create a new lexical binding and throw a SyntaxError in\n// browsers that already have the global property. `var` simply reuses the\n// existing global variable if present.\nvar LZString = CORE_SHARED.LZString;\nif (!LZString && typeof CORE_SHARED.getLZString === 'function') {\n  LZString = CORE_SHARED.getLZString();\n}\nif (!LZString) {\n  LZString = {\n    compressToEncodedURIComponent: s => s,\n    decompressFromEncodedURIComponent: s => s\n  };\n}\n\nvar generatePrintableOverview;\ntry {\n  ({ generatePrintableOverview } = require('./overview.js'));\n} catch {\n  // overview generation not needed in test environments without module support\n}\n\nfunction resolveAppVersionScope() {\n  if (typeof globalThis !== 'undefined' && globalThis) {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined' && window) {\n    return window;\n  }\n  if (typeof self !== 'undefined' && self) {\n    return self;\n  }\n  if (typeof global !== 'undefined' && global) {\n    return global;\n  }\n  return null;\n}\n\nfunction extractAppVersion(candidate) {\n  if (!candidate) {\n    return null;\n  }\n\n  if (typeof candidate === 'string') {\n    return candidate;\n  }\n\n  if (typeof candidate.APP_VERSION === 'string') {\n    return candidate.APP_VERSION;\n  }\n\n  if (typeof candidate.default === 'string') {\n    return candidate.default;\n  }\n\n  if (typeof candidate.version === 'string') {\n    return candidate.version;\n  }\n\n  return null;\n}\n\nfunction resolveAppVersionValue() {\n  if (typeof CORE_SHARED.APP_VERSION === 'string' && CORE_SHARED.APP_VERSION) {\n    return CORE_SHARED.APP_VERSION;\n  }\n\n  const scope = resolveAppVersionScope();\n  if (scope && typeof scope.CPP_APP_VERSION === 'string' && scope.CPP_APP_VERSION) {\n    return scope.CPP_APP_VERSION;\n  }\n\n  if (scope && typeof scope.APP_VERSION === 'string' && scope.APP_VERSION) {\n    return scope.APP_VERSION;\n  }\n\n  if (typeof require === 'function') {\n    try {\n      const moduleCandidate = require('../../app-version.js');\n      const resolvedCandidate = extractAppVersion(moduleCandidate);\n      if (resolvedCandidate) {\n        return resolvedCandidate;\n      }\n    } catch (appVersionError) {\n      void appVersionError;\n    }\n  }\n\n  return '0.0.0';\n}\n\nvar APP_VERSION = resolveAppVersionValue();\n\nif (typeof localResolvePinkModeLottieRuntime === 'function') {\n  localResolvePinkModeLottieRuntime();\n} else if (typeof window.resolvePinkModeLottieRuntime === 'function') {\n  window.resolvePinkModeLottieRuntime();\n}\n\nvar IOS_PWA_HELP_STORAGE_KEY = 'iosPwaHelpShown';\nconst INSTALL_BANNER_DISMISSED_KEY = 'installPromptDismissed';\n\nfunction resolveInstallBannerGlobalScope() {\n  if (typeof globalThis !== 'undefined' && globalThis) {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined' && window) {\n    return window;\n  }\n  if (typeof self !== 'undefined' && self) {\n    return self;\n  }\n  if (typeof global !== 'undefined' && global) {\n    return global;\n  }\n  return null;\n}\n\nconst installBannerGlobalScope = resolveInstallBannerGlobalScope();\nif (\n  installBannerGlobalScope\n  && typeof installBannerGlobalScope.installBannerDismissedInSession !== 'boolean'\n) {\n  installBannerGlobalScope.installBannerDismissedInSession = false;\n}\n\nconst HELP_MODULE_CACHE_KEY = '__cineResolvedHelpModule';\n\nfunction createHelpModuleFallback() {\n  return {\n    resolveIosPwaHelpStorageKey(explicitKey) {\n      if (typeof explicitKey === 'string' && explicitKey) {\n        return explicitKey;\n      }\n      if (typeof IOS_PWA_HELP_STORAGE_KEY === 'string' && IOS_PWA_HELP_STORAGE_KEY) {\n        return IOS_PWA_HELP_STORAGE_KEY;\n      }\n      return 'iosPwaHelpShown';\n    },\n    isIosDevice() {\n      return false;\n    },\n    isAndroidDevice() {\n      return false;\n    },\n    isStandaloneDisplayMode() {\n      return false;\n    },\n    hasDismissedIosPwaHelp() {\n      return false;\n    },\n    markIosPwaHelpDismissed() { },\n    shouldShowIosPwaHelp() {\n      return false;\n    },\n  };\n}\n\nfunction resolveHelpModuleApi() {\n  const globalScope = getCoreGlobalObject();\n\n  if (globalScope && globalScope[HELP_MODULE_CACHE_KEY]) {\n    return globalScope[HELP_MODULE_CACHE_KEY];\n  }\n\n  const moduleBase =\n    (typeof cineModuleBase === 'object' && cineModuleBase)\n    || (globalScope && typeof globalScope.cineModuleBase === 'object' ? globalScope.cineModuleBase : null);\n\n  function logModuleWarning(message, error) {\n    if (moduleBase && typeof moduleBase.safeWarn === 'function') {\n      try {\n        moduleBase.safeWarn(message, error);\n        return;\n      } catch (warnError) {\n        void warnError;\n      }\n    }\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      try {\n        if (typeof error === 'undefined') {\n          console.warn(message);\n        } else {\n          console.warn(message, error);\n        }\n      } catch (consoleError) {\n        void consoleError;\n      }\n    }\n  }\n\n  const candidates = [];\n\n  if (moduleBase && typeof moduleBase.getModuleRegistry === 'function') {\n    let registry = null;\n    try {\n      registry = moduleBase.getModuleRegistry(globalScope);\n    } catch (error) {\n      logModuleWarning('Unable to resolve cine.features.help module registry.', error);\n    }\n    if (registry && typeof registry.get === 'function') {\n      try {\n        const fromRegistry = registry.get('cine.features.help');\n        if (fromRegistry && candidates.indexOf(fromRegistry) === -1) {\n          candidates.push(fromRegistry);\n        }\n      } catch (error) {\n        logModuleWarning('Unable to read cine.features.help module.', error);\n      }\n    }\n  }\n\n  const scopeCandidates = [];\n  if (globalScope && scopeCandidates.indexOf(globalScope) === -1) {\n    scopeCandidates.push(globalScope);\n  }\n  if (typeof globalThis !== 'undefined' && scopeCandidates.indexOf(globalThis) === -1) {\n    scopeCandidates.push(globalThis);\n  }\n  if (typeof window !== 'undefined' && scopeCandidates.indexOf(window) === -1) {\n    scopeCandidates.push(window);\n  }\n  if (typeof self !== 'undefined' && scopeCandidates.indexOf(self) === -1) {\n    scopeCandidates.push(self);\n  }\n  if (typeof global !== 'undefined' && scopeCandidates.indexOf(global) === -1) {\n    scopeCandidates.push(global);\n  }\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    try {\n      const exposed = scope.cineFeaturesHelp;\n      if (exposed && candidates.indexOf(exposed) === -1) {\n        candidates.push(exposed);\n      }\n    } catch (error) {\n      void error;\n    }\n\n    try {\n      const moduleNamespace = scope.cineHelpModule;\n      if (\n        moduleNamespace\n        && typeof moduleNamespace === 'object'\n        && moduleNamespace\n        && typeof moduleNamespace.help === 'object'\n        && candidates.indexOf(moduleNamespace.help) === -1\n      ) {\n        candidates.push(moduleNamespace.help);\n      }\n    } catch (error) {\n      void error;\n    }\n\n    if (typeof scope.__cineCreateHelpModule === 'function') {\n      try {\n        const created = scope.__cineCreateHelpModule();\n        if (created && typeof created === 'object') {\n          if (typeof created.help === 'object' && candidates.indexOf(created.help) === -1) {\n            candidates.push(created.help);\n          } else if (candidates.indexOf(created) === -1) {\n            candidates.push(created);\n          }\n        }\n      } catch (error) {\n        logModuleWarning('Unable to instantiate cine.features.help module.', error);\n      }\n    }\n  }\n\n  let resolvedApi = null;\n  for (let index = 0; index < candidates.length; index += 1) {\n    const candidate = candidates[index];\n    if (\n      candidate\n      && typeof candidate === 'object'\n      && typeof candidate.isIosDevice === 'function'\n    ) {\n      resolvedApi = candidate;\n      break;\n    }\n    if (\n      candidate\n      && typeof candidate === 'object'\n      && typeof candidate.help === 'object'\n      && typeof candidate.help.isIosDevice === 'function'\n    ) {\n      resolvedApi = candidate.help;\n      break;\n    }\n  }\n\n  const api = resolvedApi || createHelpModuleFallback();\n\n  if (globalScope) {\n    try {\n      globalScope[HELP_MODULE_CACHE_KEY] = api;\n    } catch (error) {\n      void error;\n    }\n  }\n\n  return api;\n}\n\nconst CONTACTS_MODULE_CACHE_KEY = '__cineContactsModuleCache__';\nconst OWN_GEAR_MODULE_CACHE_KEY = '__cineOwnGearModuleCache__';\nconst LEGACY_CONTACTS_OWN_GEAR_MODULE_CACHE_KEY = '__cineContactsOwnGearModuleCache__';\n\nfunction cacheFeatureModule(globalScope, cacheKey, moduleApi) {\n  try {\n    Object.defineProperty(globalScope, cacheKey, {\n      configurable: true,\n      enumerable: false,\n      writable: true,\n      value: moduleApi,\n    });\n    return;\n  } catch (defineError) {\n    void defineError;\n  }\n\n  try {\n    globalScope[cacheKey] = moduleApi;\n  } catch (assignError) {\n    void assignError;\n  }\n}\n\nfunction resolveLegacyContactsOwnGearModule() {\n  const globalScope = getCoreGlobalObject();\n\n  if (!globalScope || (typeof globalScope !== 'object' && typeof globalScope !== 'function')) {\n    return null;\n  }\n\n  if (Object.prototype.hasOwnProperty.call(globalScope, LEGACY_CONTACTS_OWN_GEAR_MODULE_CACHE_KEY)) {\n    return globalScope[LEGACY_CONTACTS_OWN_GEAR_MODULE_CACHE_KEY];\n  }\n\n  const candidates = [];\n\n  const moduleBase =\n    (typeof cineModuleBase === 'object' && cineModuleBase)\n    || (globalScope && typeof globalScope.cineModuleBase === 'object' ? globalScope.cineModuleBase : null);\n\n  if (moduleBase && typeof moduleBase.getModuleRegistry === 'function') {\n    try {\n      const registry = moduleBase.getModuleRegistry(globalScope);\n      if (registry && typeof registry.get === 'function') {\n        const fromRegistry = registry.get('cine.features.contactsOwnGear');\n        if (fromRegistry && candidates.indexOf(fromRegistry) === -1) {\n          candidates.push(fromRegistry);\n        }\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const scopeCandidates = [];\n  if (scopeCandidates.indexOf(globalScope) === -1) scopeCandidates.push(globalScope);\n  if (typeof globalThis !== 'undefined' && scopeCandidates.indexOf(globalThis) === -1) scopeCandidates.push(globalThis);\n  if (typeof window !== 'undefined' && scopeCandidates.indexOf(window) === -1) scopeCandidates.push(window);\n  if (typeof self !== 'undefined' && scopeCandidates.indexOf(self) === -1) scopeCandidates.push(self);\n  if (typeof global !== 'undefined' && scopeCandidates.indexOf(global) === -1) scopeCandidates.push(global);\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n    try {\n      const exposed = scope.cineFeaturesContactsOwnGear;\n      if (exposed && typeof exposed === 'object' && candidates.indexOf(exposed) === -1) {\n        candidates.push(exposed);\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const moduleApi = candidates.find(candidate => candidate && typeof candidate === 'object') || null;\n\n  cacheFeatureModule(globalScope, LEGACY_CONTACTS_OWN_GEAR_MODULE_CACHE_KEY, moduleApi);\n\n  return moduleApi;\n}\n\nfunction resolveContactsModule() {\n  const globalScope = getCoreGlobalObject();\n\n  if (!globalScope || (typeof globalScope !== 'object' && typeof globalScope !== 'function')) {\n    return null;\n  }\n\n  if (Object.prototype.hasOwnProperty.call(globalScope, CONTACTS_MODULE_CACHE_KEY)) {\n    return globalScope[CONTACTS_MODULE_CACHE_KEY];\n  }\n\n  const candidates = [];\n\n  const moduleBase =\n    (typeof cineModuleBase === 'object' && cineModuleBase)\n    || (globalScope && typeof globalScope.cineModuleBase === 'object' ? globalScope.cineModuleBase : null);\n\n  if (moduleBase && typeof moduleBase.getModuleRegistry === 'function') {\n    try {\n      const registry = moduleBase.getModuleRegistry(globalScope);\n      if (registry && typeof registry.get === 'function') {\n        const fromRegistry = registry.get('cine.features.contacts');\n        if (fromRegistry && candidates.indexOf(fromRegistry) === -1) {\n          candidates.push(fromRegistry);\n        }\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const scopeCandidates = [];\n  if (scopeCandidates.indexOf(globalScope) === -1) scopeCandidates.push(globalScope);\n  if (typeof globalThis !== 'undefined' && scopeCandidates.indexOf(globalThis) === -1) scopeCandidates.push(globalThis);\n  if (typeof window !== 'undefined' && scopeCandidates.indexOf(window) === -1) scopeCandidates.push(window);\n  if (typeof self !== 'undefined' && scopeCandidates.indexOf(self) === -1) scopeCandidates.push(self);\n  if (typeof global !== 'undefined' && scopeCandidates.indexOf(global) === -1) scopeCandidates.push(global);\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n    try {\n      const exposed = scope.cineFeaturesContacts;\n      if (exposed && typeof exposed === 'object' && candidates.indexOf(exposed) === -1) {\n        candidates.push(exposed);\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const moduleApi = candidates.find(candidate => candidate && typeof candidate === 'object')\n    || resolveLegacyContactsOwnGearModule()\n    || null;\n\n  cacheFeatureModule(globalScope, CONTACTS_MODULE_CACHE_KEY, moduleApi);\n\n  return moduleApi;\n}\n\nfunction resolveOwnGearModule() {\n  const globalScope = getCoreGlobalObject();\n\n  if (!globalScope || (typeof globalScope !== 'object' && typeof globalScope !== 'function')) {\n    return null;\n  }\n\n  if (Object.prototype.hasOwnProperty.call(globalScope, OWN_GEAR_MODULE_CACHE_KEY)) {\n    return globalScope[OWN_GEAR_MODULE_CACHE_KEY];\n  }\n\n  const candidates = [];\n\n  const moduleBase =\n    (typeof cineModuleBase === 'object' && cineModuleBase)\n    || (globalScope && typeof globalScope.cineModuleBase === 'object' ? globalScope.cineModuleBase : null);\n\n  if (moduleBase && typeof moduleBase.getModuleRegistry === 'function') {\n    try {\n      const registry = moduleBase.getModuleRegistry(globalScope);\n      if (registry && typeof registry.get === 'function') {\n        const fromRegistry = registry.get('cine.features.ownGear');\n        if (fromRegistry && candidates.indexOf(fromRegistry) === -1) {\n          candidates.push(fromRegistry);\n        }\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const scopeCandidates = [];\n  if (scopeCandidates.indexOf(globalScope) === -1) scopeCandidates.push(globalScope);\n  if (typeof globalThis !== 'undefined' && scopeCandidates.indexOf(globalThis) === -1) scopeCandidates.push(globalThis);\n  if (typeof window !== 'undefined' && scopeCandidates.indexOf(window) === -1) scopeCandidates.push(window);\n  if (typeof self !== 'undefined' && scopeCandidates.indexOf(self) === -1) scopeCandidates.push(self);\n  if (typeof global !== 'undefined' && scopeCandidates.indexOf(global) === -1) scopeCandidates.push(global);\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n    try {\n      const exposed = scope.cineFeaturesOwnGear;\n      if (exposed && typeof exposed === 'object' && candidates.indexOf(exposed) === -1) {\n        candidates.push(exposed);\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n\n  const moduleApi = candidates.find(candidate => candidate && typeof candidate === 'object')\n    || resolveLegacyContactsOwnGearModule()\n    || null;\n\n  cacheFeatureModule(globalScope, OWN_GEAR_MODULE_CACHE_KEY, moduleApi);\n\n  return moduleApi;\n}\n\nvar helpModuleApi = resolveHelpModuleApi();\nglobalThis.helpModuleApi = helpModuleApi;\n\nvar deviceSchema = null;\n\nfunction resolveCoreDeviceSchema() {\n  const scopeCandidates = [];\n  if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n    scopeCandidates.push(CORE_GLOBAL_SCOPE);\n  }\n  if (typeof globalThis !== 'undefined' && globalThis && typeof globalThis === 'object') {\n    scopeCandidates.push(globalThis);\n  }\n  if (typeof window !== 'undefined' && window && typeof window === 'object') {\n    scopeCandidates.push(window);\n  }\n  if (typeof self !== 'undefined' && self && typeof self === 'object') {\n    scopeCandidates.push(self);\n  }\n  if (typeof global !== 'undefined' && global && typeof global === 'object') {\n    scopeCandidates.push(global);\n  }\n\n  for (let index = 0; index < scopeCandidates.length; index += 1) {\n    const scope = scopeCandidates[index];\n    if (!scope || typeof scope !== 'object') {\n      continue;\n    }\n    if (scope.CORE_DEVICE_SCHEMA && typeof scope.CORE_DEVICE_SCHEMA === 'object') {\n      return scope.CORE_DEVICE_SCHEMA;\n    }\n    if (scope.cineCoreDeviceSchema && typeof scope.cineCoreDeviceSchema === 'object') {\n      return scope.cineCoreDeviceSchema;\n    }\n  }\n\n  return null;\n}\n\nconst deviceSchemaManager = (function initializeDeviceSchemaManager() {\n  const coreDeviceSchema = resolveCoreDeviceSchema();\n\n  if (\n    coreDeviceSchema &&\n    typeof coreDeviceSchema.createDeviceSchemaManager === 'function'\n  ) {\n    try {\n      return coreDeviceSchema.createDeviceSchemaManager({\n        onSchemaChange: schema => {\n          deviceSchema = schema;\n        },\n        populateCategoryOptions: () => {\n          try {\n            populateCategoryOptions();\n          } catch (error) {\n            console.error('populateCategoryOptions failed during scheduled execution', error);\n          }\n        },\n      });\n    } catch (deviceSchemaManagerError) {\n      console.warn(\n        'Failed to initialize device schema manager from core module',\n        deviceSchemaManagerError\n      );\n    }\n  }\n  return null;\n})();\n\nconst DEVICE_SCHEMA_PATH =\n  (deviceSchemaManager && deviceSchemaManager.DEVICE_SCHEMA_PATH) ||\n  'src/data/schema.json';\n\nconst loadDeviceSchemaFromCacheStorage =\n  deviceSchemaManager && typeof deviceSchemaManager.loadDeviceSchemaFromCacheStorage === 'function'\n    ? deviceSchemaManager.loadDeviceSchemaFromCacheStorage\n    : async () => null;\n\nconst finalizeDeviceSchemaLoad =\n  deviceSchemaManager && typeof deviceSchemaManager.finalizeDeviceSchemaLoad === 'function'\n    ? deviceSchemaManager.finalizeDeviceSchemaLoad\n    : () => { };\n\nconst isValidDeviceSchema =\n  deviceSchemaManager && typeof deviceSchemaManager.isValidDeviceSchema === 'function'\n    ? deviceSchemaManager.isValidDeviceSchema\n    : candidate => candidate && typeof candidate === 'object' && !Array.isArray(candidate);\n\nconst cachedDeviceSchema =\n  deviceSchemaManager && typeof deviceSchemaManager.getCachedDeviceSchema === 'function'\n    ? deviceSchemaManager.getCachedDeviceSchema()\n    : null;\n\nif (deviceSchemaManager && typeof deviceSchemaManager.getDeviceSchema === 'function') {\n  const initialSchema = deviceSchemaManager.getDeviceSchema();\n  if (initialSchema) {\n    deviceSchema = initialSchema;\n  }\n}\n\nconst applyDeviceSchema =\n  deviceSchemaManager && typeof deviceSchemaManager.setDeviceSchema === 'function'\n    ? schema => deviceSchemaManager.setDeviceSchema(schema)\n    : schema => {\n      if (isValidDeviceSchema(schema)) {\n        deviceSchema = schema;\n      } else if (!deviceSchema) {\n        deviceSchema = {};\n      }\n      return deviceSchema;\n    };\n\nlet bundledSchema = null;\nlet contactsProfileModule = null;\nlet contactsListModule = null;\n\nconst CONTACTS_PROFILE_GLOBAL_KEY = 'CINE_CONTACTS_PROFILE_MODULE';\nconst CONTACTS_LIST_GLOBAL_KEY = 'CINE_CONTACTS_LIST_MODULE';\n\nconst canRequireModule = typeof require === 'function';\n\nif (canRequireModule) {\n  try {\n    bundledSchema = require('../data/schema.json');\n  } catch (schemaRequireError) {\n    void schemaRequireError;\n  }\n\n  try {\n    contactsProfileModule = require('./contacts/profile.js');\n  } catch (profileModuleError) {\n    console.warn('Failed to load contacts profile module', profileModuleError);\n  }\n\n  try {\n    contactsListModule = require('./contacts/list.js');\n  } catch (contactsListModuleError) {\n    console.warn('Failed to load contacts list module', contactsListModuleError);\n  }\n}\n\nconst contactsModuleGlobalScope =\n  (typeof globalThis !== 'undefined' && globalThis) ||\n  (typeof self !== 'undefined' && self) ||\n  (typeof window !== 'undefined' && window) ||\n  (typeof global !== 'undefined' && global) ||\n  null;\n\nconst readContactsModuleFromGlobal = key => {\n  if (!contactsModuleGlobalScope || !key) {\n    return null;\n  }\n  try {\n    const candidate = contactsModuleGlobalScope[key];\n    return candidate || null;\n  } catch (contactsModuleError) {\n    console.warn('Failed to read contacts module from global scope', contactsModuleError);\n    return null;\n  }\n};\n\nif (!contactsProfileModule) {\n  contactsProfileModule = readContactsModuleFromGlobal(CONTACTS_PROFILE_GLOBAL_KEY);\n}\n\nif (!contactsListModule) {\n  contactsListModule = readContactsModuleFromGlobal(CONTACTS_LIST_GLOBAL_KEY);\n}\n\nif (!contactsProfileModule || !contactsListModule) {\n  console.warn('Module loader is not available in this environment. Contacts features limited.');\n}\n\nconst fallbackSanitizeContactValue = value => (typeof value === 'string' ? value.trim() : '');\nconst fallbackNormalizeContactEntry = entry => ({\n  id: fallbackSanitizeContactValue(entry && entry.id) || `contact - ${Date.now().toString(36)} `,\n  name: fallbackSanitizeContactValue(entry && entry.name),\n  role: fallbackSanitizeContactValue(entry && entry.role),\n  phone: fallbackSanitizeContactValue(entry && entry.phone),\n  email: fallbackSanitizeContactValue(entry && entry.email),\n  website: fallbackSanitizeContactValue(entry && entry.website),\n  avatar: typeof entry?.avatar === 'string' ? entry.avatar : '',\n  createdAt: Number.isFinite(entry?.createdAt) ? entry.createdAt : Date.now(),\n  updatedAt: Number.isFinite(entry?.updatedAt) ? entry.updatedAt : Date.now()\n});\n\nfunction createFallbackProfileController() {\n  const state = { name: '', role: '', avatar: '', phone: '', email: '' };\n  const listeners = new Set();\n  const snapshot = () => ({ ...state });\n  const emit = () => {\n    const current = snapshot();\n    listeners.forEach(listener => {\n      try {\n        listener(current);\n      } catch (listenerError) {\n        console.warn('Profile listener failed in fallback controller', listenerError);\n      }\n    });\n    return current;\n  };\n  return {\n    assignUserProfileState(updates = {}) {\n      Object.assign(state, updates);\n      return emit();\n    },\n    getUserProfileSnapshot: snapshot,\n    handleFieldInput(field, rawValue) {\n      if (!field) return false;\n      state[field] = typeof rawValue === 'string' ? rawValue : '';\n      emit();\n      return true;\n    },\n    handleFieldBlur() {\n      return undefined;\n    },\n    load(newState) {\n      if (newState && typeof newState === 'object') {\n        Object.assign(state, newState);\n      }\n      return emit();\n    },\n    setAvatar(value) {\n      state.avatar = typeof value === 'string' ? value : '';\n      emit();\n    },\n    clearAvatar() {\n      if (!state.avatar) return false;\n      state.avatar = '';\n      emit();\n      return true;\n    },\n    onChange(listener) {\n      if (typeof listener !== 'function') return () => undefined;\n      listeners.add(listener);\n      return () => listeners.delete(listener);\n    },\n    schedulePersist() {\n      return undefined;\n    },\n    markDirty() {\n      return undefined;\n    },\n    setPendingAnnouncement() {\n      return undefined;\n    }\n  };\n}\n\nconst {\n  CONTACT_AVATAR_MAX_BYTES: resolvedContactAvatarMaxBytes = 300 * 1024,\n  CONTACT_AVATAR_MAX_SOURCE_BYTES: resolvedContactAvatarMaxSourceBytes = 6 * 1024 * 1024,\n  CONTACT_AVATAR_MAX_DIMENSION: resolvedContactAvatarMaxDimension = 256,\n  CONTACT_AVATAR_JPEG_QUALITY: resolvedContactAvatarJpegQuality = 0.85,\n  CONTACT_AVATAR_JPEG_MIN_QUALITY: resolvedContactAvatarJpegMinQuality = 0.55,\n  createProfileController: resolvedCreateProfileController,\n  estimateDataUrlSize: resolvedEstimateDataUrlSize,\n  optimiseAvatarDataUrl: resolvedOptimiseAvatarDataUrl,\n  readAvatarFile: resolvedReadAvatarFile,\n  isSafeImageUrl: resolvedIsSafeImageUrl\n} = contactsProfileModule || {};\n\nconst {\n  sanitizeContactValue: resolvedSanitizeContactValue,\n  normalizeContactEntry: resolvedNormalizeContactEntry,\n  sortContacts: resolvedSortContacts,\n  parseVCard: resolvedParseVCardEntries,\n  mergeImportedContacts: resolvedMergeImportedContacts,\n  createCrewRowSync: resolvedCreateCrewRowSync\n} = contactsListModule || {};\n\nconst localCreateProfileController = typeof resolvedCreateProfileController === 'function'\n  ? resolvedCreateProfileController\n  : createFallbackProfileController;\nconst localEstimateDataUrlSize = typeof resolvedEstimateDataUrlSize === 'function'\n  ? resolvedEstimateDataUrlSize\n  : dataUrl => (typeof dataUrl === 'string' ? dataUrl.length : 0);\nconst localOptimiseAvatarDataUrl = typeof resolvedOptimiseAvatarDataUrl === 'function'\n  ? resolvedOptimiseAvatarDataUrl\n  : (dataUrl, _mime, onSuccess) => {\n    if (typeof onSuccess === 'function') {\n      onSuccess(typeof dataUrl === 'string' ? dataUrl : '');\n    }\n    return Promise.resolve(typeof dataUrl === 'string' ? dataUrl : '');\n  };\nconst localReadAvatarFile = typeof resolvedReadAvatarFile === 'function'\n  ? resolvedReadAvatarFile\n  : (typeof readAvatarFile === 'function'\n    ? readAvatarFile\n    : (typeof window !== 'undefined' && typeof window.readAvatarFile === 'function'\n      ? window.readAvatarFile\n      : (file, onSuccess, onError) => {\n        if (!file) return;\n        try {\n          const reader = new FileReader();\n          reader.onload = () => {\n            if (typeof onSuccess === 'function') onSuccess(reader.result);\n          };\n          reader.onerror = () => {\n            if (typeof onError === 'function') onError('readError');\n          };\n          reader.readAsDataURL(file);\n        } catch (e) {\n          if (typeof onError === 'function') onError('readError');\n        }\n      }));\n\nconst localIsSafeImageUrl = typeof resolvedIsSafeImageUrl === 'function'\n  ? resolvedIsSafeImageUrl\n  : (url) => {\n    if (typeof url !== 'string') return false;\n    return url.startsWith('data:image/');\n  };\n\nconst sanitizeContactValueHelper = typeof resolvedSanitizeContactValue === 'function'\n  ? resolvedSanitizeContactValue\n  : fallbackSanitizeContactValue;\nconst normalizeContactEntryHelper = typeof resolvedNormalizeContactEntry === 'function'\n  ? resolvedNormalizeContactEntry\n  : fallbackNormalizeContactEntry;\nconst sortContactsHelper = typeof resolvedSortContacts === 'function'\n  ? resolvedSortContacts\n  : list => (Array.isArray(list) ? list.slice() : []);\nconst parseVCardEntries = typeof resolvedParseVCardEntries === 'function'\n  ? resolvedParseVCardEntries\n  : () => [];\nconst mergeImportedContactEntries = typeof resolvedMergeImportedContacts === 'function'\n  ? resolvedMergeImportedContacts\n  : options => ({\n    contacts: sortContactsHelper([...(options?.existing || []), ...(options?.imported || [])]),\n    added: Array.isArray(options?.imported) ? options.imported.length : 0,\n    updated: 0\n  });\nconst localCreateCrewRowSync = typeof resolvedCreateCrewRowSync === 'function'\n  ? resolvedCreateCrewRowSync\n  : (rowState = {}, contact = {}) => ({ ...rowState, ...contact });\n\ntry {\n  console.log('[deviceSchema] Attempting to apply bundledSchema:', bundledSchema ? 'exists' : 'null');\n  if (bundledSchema) {\n    const appliedSchema = applyDeviceSchema(bundledSchema);\n    if (appliedSchema) {\n      deviceSchema = appliedSchema;\n      console.log('[deviceSchema] Successfully applied bundledSchema');\n    }\n  }\n\n  // If bundledSchema was null or failed to apply, fetch from the server\n  if (!deviceSchema || !Object.keys(deviceSchema).length) {\n    console.log('[deviceSchema] bundledSchema not available, attempting fetch from:', DEVICE_SCHEMA_PATH);\n\n    if (!deviceSchema && cachedDeviceSchema) {\n      const appliedCachedSchema = applyDeviceSchema(cachedDeviceSchema);\n      if (appliedCachedSchema) {\n        deviceSchema = appliedCachedSchema;\n        console.log('[deviceSchema] Applied cached schema as fallback');\n      }\n    }\n\n    // Falling back to the cached copy allows the app to keep functioning when\n    // users are offline, which is critical for field usage.\n    if (typeof fetch === 'function') {\n      fetch(DEVICE_SCHEMA_PATH)\n        .then(response => {\n          if (!response || !response.ok) {\n            throw new Error(\n              `Unexpected response when loading schema.json: ${response ? response.status : 'no response'} `\n            );\n          }\n          return response.json();\n        })\n        .then(candidate => {\n          console.log('[deviceSchema] Successfully fetched schema.json, applying...');\n          finalizeDeviceSchemaLoad(candidate);\n          // Also update the local deviceSchema variable\n          if (candidate && typeof candidate === 'object') {\n            deviceSchema = candidate;\n            console.log('[deviceSchema] deviceSchema updated from fetch. Categories:', Object.keys(deviceSchema));\n          }\n        })\n        .catch(error => {\n          console.warn('Failed to fetch schema.json', error);\n\n          loadDeviceSchemaFromCacheStorage()\n            .then(schemaFromCache => {\n              if (isValidDeviceSchema(schemaFromCache)) {\n                finalizeDeviceSchemaLoad(schemaFromCache);\n              } else {\n                finalizeDeviceSchemaLoad(deviceSchema);\n              }\n            })\n            .catch(cacheError => {\n              console.warn('Failed to load schema.json from cache storage', cacheError);\n              finalizeDeviceSchemaLoad(deviceSchema);\n            });\n        });\n    } else {\n      finalizeDeviceSchemaLoad(deviceSchema);\n    }\n  }\n} catch (requireError) {\n  console.error('[deviceSchema] Error in schema loading:', requireError);\n}\n\nconst LEGAL_LINKS = {\n  de: {\n    imprint: \"legal/impressum.html\",\n    privacy: \"legal/datenschutz.html\",\n  },\n  en: {\n    imprint: \"legal/impressum-en.html\",\n    privacy: \"legal/datenschutz-en.html\",\n  },\n  es: {\n    imprint: \"legal/impressum-es.html\",\n    privacy: \"legal/datenschutz-es.html\",\n  },\n  fr: {\n    imprint: \"legal/impressum-fr.html\",\n    privacy: \"legal/datenschutz-fr.html\",\n  },\n  it: {\n    imprint: \"legal/impressum-it.html\",\n    privacy: \"legal/datenschutz-it.html\",\n  },\n};\n\nfunction resolveAutoGearStorageKey(symbolName, fallbackValue) {\n  const candidate = readGlobalAutoGearValue(symbolName);\n  if (typeof candidate === 'string' && candidate) {\n    return candidate;\n  }\n\n  return fallbackValue;\n}\n\nconst AUTO_GEAR_RULES_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_RULES_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearRules'\n);\nconst AUTO_GEAR_ANY_MOTOR_TOKEN = '__any__';\nif (typeof globalThis !== 'undefined') {\n  globalThis.AUTO_GEAR_ANY_MOTOR_TOKEN = AUTO_GEAR_ANY_MOTOR_TOKEN;\n}\nconst AUTO_GEAR_SEEDED_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_SEEDED_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearSeeded'\n);\nconst AUTO_GEAR_RETENTION_DEFAULT_FALLBACK = 36;\nconst AUTO_GEAR_RETENTION_MIN_FALLBACK = 1;\nconst AUTO_GEAR_RETENTION_MAX_FALLBACK = 50;\nconst AUTO_GEAR_BACKUP_RETENTION_MAX = 50;\n\nfunction readGlobalAutoGearValue(propertyName) {\n  const scopes = [\n    CORE_PART1_RUNTIME_SCOPE && typeof CORE_PART1_RUNTIME_SCOPE === 'object'\n      ? CORE_PART1_RUNTIME_SCOPE\n      : null,\n    CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE &&\n      (typeof CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE === 'object'\n        || typeof CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE === 'function')\n      ? CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE\n      : null,\n    typeof globalThis !== 'undefined' ? globalThis : null,\n    typeof window !== 'undefined' ? window : null,\n    typeof self !== 'undefined' ? self : null,\n    typeof global !== 'undefined' ? global : null,\n  ];\n\n  for (let index = 0; index < scopes.length; index += 1) {\n    const scope = scopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    try {\n      const value = scope[propertyName];\n      if (typeof value !== 'undefined') {\n        return value;\n      }\n    } catch (globalLookupError) {\n      void globalLookupError;\n    }\n  }\n\n  return undefined;\n}\n\nfunction resolveAutoGearBackupRetentionMin() {\n  const candidates = [];\n\n  const declaredMinCandidate = readGlobalAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_MIN');\n  if (typeof declaredMinCandidate !== 'undefined') {\n    candidates.push(declaredMinCandidate);\n  }\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const numeric = Number(candidates[index]);\n    if (!Number.isFinite(numeric)) {\n      continue;\n    }\n\n    const rounded = Math.round(numeric);\n    if (rounded >= AUTO_GEAR_RETENTION_MIN_FALLBACK) {\n      return rounded;\n    }\n  }\n\n  return AUTO_GEAR_RETENTION_MIN_FALLBACK;\n}\n\nfunction resolveAutoGearBackupRetentionDefault() {\n  const minValue = resolveAutoGearBackupRetentionMin();\n  const globalScope =\n    (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE)\n      ? CORE_GLOBAL_SCOPE\n      : typeof globalThis !== 'undefined'\n        ? globalThis\n        : typeof window !== 'undefined'\n          ? window\n          : typeof self !== 'undefined'\n            ? self\n            : typeof global !== 'undefined'\n              ? global\n              : null;\n  const existingMax =\n    globalScope && typeof globalScope.AUTO_GEAR_BACKUP_RETENTION_MAX !== 'undefined'\n      ? globalScope.AUTO_GEAR_BACKUP_RETENTION_MAX\n      : undefined;\n  const globalMaxCandidate =\n    typeof existingMax !== 'undefined'\n      ? existingMax\n      : readGlobalAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_MAX');\n  const parsedMax = Number(globalMaxCandidate);\n  const maxValue = Number.isFinite(parsedMax) && parsedMax >= minValue\n    ? Math.min(Math.round(parsedMax), AUTO_GEAR_RETENTION_MAX_FALLBACK)\n    : AUTO_GEAR_RETENTION_MAX_FALLBACK;\n\n  const normalize = value => {\n    const numeric = Number(value);\n    if (!Number.isFinite(numeric)) {\n      return null;\n    }\n\n    const rounded = Math.round(numeric);\n    if (rounded < minValue) {\n      return minValue;\n    }\n    if (rounded > maxValue) {\n      return maxValue;\n    }\n    return rounded;\n  };\n\n  const candidates = [];\n\n  const existingDefault =\n    globalScope && typeof globalScope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT !== 'undefined'\n      ? globalScope.AUTO_GEAR_BACKUP_RETENTION_DEFAULT\n      : undefined;\n  if (typeof existingDefault !== 'undefined') {\n    candidates.push(existingDefault);\n  }\n\n  const globalCandidate = readGlobalAutoGearValue('AUTO_GEAR_BACKUP_RETENTION_DEFAULT');\n  if (typeof globalCandidate !== 'undefined') {\n    candidates.push(globalCandidate);\n  }\n\n  if (typeof getAutoGearBackupRetentionDefault === 'function') {\n    try {\n      candidates.push(getAutoGearBackupRetentionDefault());\n    } catch (autoGearDefaultError) {\n      void autoGearDefaultError;\n    }\n  }\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const normalized = normalize(candidates[index]);\n    if (normalized !== null) {\n      return normalized;\n    }\n  }\n\n  const fallbackNormalized = normalize(AUTO_GEAR_RETENTION_DEFAULT_FALLBACK);\n  return fallbackNormalized === null ? minValue : fallbackNormalized;\n}\n\n// localeSort is now provided by legacy-globals-shim.js\n\n\nconst AUTO_GEAR_BACKUPS_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_BACKUPS_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearBackups'\n);\nconst AUTO_GEAR_PRESETS_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_PRESETS_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearPresets'\n);\nconst AUTO_GEAR_ACTIVE_PRESET_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_ACTIVE_PRESET_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearActivePreset'\n);\nconst AUTO_GEAR_AUTO_PRESET_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_AUTO_PRESET_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearAutoPreset'\n);\nconst AUTO_GEAR_BACKUP_VISIBILITY_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_BACKUP_VISIBILITY_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearShowBackups'\n);\nconst AUTO_GEAR_BACKUP_RETENTION_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_BACKUP_RETENTION_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearBackupRetention'\n);\nconst AUTO_GEAR_MONITOR_DEFAULTS_KEY = resolveAutoGearStorageKey(\n  'AUTO_GEAR_MONITOR_DEFAULTS_STORAGE_KEY',\n  'cameraPowerPlanner_autoGearMonitorDefaults'\n);\nvar AUTO_GEAR_BACKUP_INTERVAL_MS = 10 * 60 * 1000;\nconst AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE = resolveAutoGearBackupRetentionMin();\nconst AUTO_GEAR_BACKUP_RETENTION_DEFAULT = resolveAutoGearBackupRetentionDefault();\nconst AUTO_GEAR_MULTI_SELECT_MIN_ROWS = 8;\nconst AUTO_GEAR_MULTI_SELECT_MAX_ROWS = 12;\nconst AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS = 1;\n\nvar AUTO_GEAR_CUSTOM_CATEGORY = '';\nconst GEAR_LIST_CATEGORIES = [\n  'Camera',\n  'Camera Support',\n  'Media',\n  'Lens',\n  'Lens Support',\n  'Matte box + filter',\n  'LDS (FIZ)',\n  'Camera Batteries',\n  'Monitoring Batteries',\n  'Chargers',\n  'Monitoring',\n  'Monitoring support',\n  'Rigging',\n  'Power',\n  'Grip',\n  'Carts and Transportation',\n  'Miscellaneous',\n  'Consumables',\n];\nconst AUTO_GEAR_SELECTOR_TYPES = [\n  'none',\n  'monitor',\n  'directorMonitor',\n  'tripodHeadBrand',\n  'tripodBowl',\n  'tripodTypes',\n  'tripodSpreader',\n  'fizHandUnit',\n];\nconst AUTO_GEAR_SELECTOR_TYPE_MAP = AUTO_GEAR_SELECTOR_TYPES.reduce((map, type) => {\n  map[type.toLowerCase()] = type;\n  return map;\n}, Object.create(null));\nconst AUTO_GEAR_SELECTOR_TYPE_SET = new Set(Object.keys(AUTO_GEAR_SELECTOR_TYPE_MAP));\nconst AUTO_GEAR_MONITOR_FALLBACKS = ['SmallHD Ultra 7', 'SmallHD Focus', 'SmallHD Cine 7'];\nconst AUTO_GEAR_TRIPOD_SELECTOR_TYPES = new Set([\n  'tripodHeadBrand',\n  'tripodBowl',\n  'tripodTypes',\n  'tripodSpreader',\n]);\nconst AUTO_GEAR_TRIPOD_FIELD_IDS = {\n  tripodHeadBrand: 'tripodHeadBrand',\n  tripodBowl: 'tripodBowl',\n  tripodTypes: 'tripodTypes',\n  tripodSpreader: 'tripodSpreader',\n};\n\nexposeCoreRuntimeConstant('AUTO_GEAR_SELECTOR_TYPE_MAP', AUTO_GEAR_SELECTOR_TYPE_MAP);\nexposeCoreRuntimeConstant('AUTO_GEAR_SELECTOR_TYPE_SET', AUTO_GEAR_SELECTOR_TYPE_SET);\nexposeCoreRuntimeConstant('AUTO_GEAR_TRIPOD_SELECTOR_TYPES', AUTO_GEAR_TRIPOD_SELECTOR_TYPES);\nexposeCoreRuntimeConstant('AUTO_GEAR_TRIPOD_FIELD_IDS', AUTO_GEAR_TRIPOD_FIELD_IDS);\nexposeCoreRuntimeConstant('AUTO_GEAR_CUSTOM_CATEGORY', AUTO_GEAR_CUSTOM_CATEGORY);\nexposeCoreRuntimeConstant('GEAR_LIST_CATEGORIES', GEAR_LIST_CATEGORIES);\n\nconst AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUP_DATA = Object.freeze([\n  {\n    key: 'tilta-nucleus-m',\n    label: 'Tilta Nucleus ecosystem (M / M II)',\n    motors: Object.freeze(['Tilta Nucleus M', 'Tilta Nucleus M II']),\n    options: Object.freeze([\n      'Tilta Nucleus-M FIZ Hand Unit',\n      'Tilta Nucleus-M II FIZ Hand Unit',\n      'Tilta Nucleus Nano II Hand Controller',\n    ]),\n    defaultOption: 'Tilta Nucleus-M FIZ Hand Unit',\n  },\n  {\n    key: 'tilta-nucleus-nano',\n    label: 'Tilta Nucleus Nano ecosystem',\n    motors: Object.freeze(['Tilta Nucleus Nano (Original)', 'Tilta Nucleus Nano II']),\n    options: Object.freeze([\n      'Tilta Nucleus Nano Hand Wheel Controller',\n      'Tilta Nucleus Nano II Hand Controller',\n    ]),\n    defaultOption: 'Tilta Nucleus Nano Hand Wheel Controller',\n  },\n  {\n    key: 'arri-lbus',\n    label: 'ARRI / cmotion LBUS ecosystem',\n    motors: Object.freeze([\n      'Arri Cforce Mini',\n      'Arri Cforce Plus',\n      'Arri CLM-3',\n      'Arri CLM-4 (K2.72114.0)',\n      'Arri CLM-5 (K2.0006361)',\n      'Arri cforce mini RF (KK.0040345)',\n      'Cmotion cPRO',\n    ]),\n    options: Object.freeze([\n      'Arri Hi-5',\n      'Arri WCU-4',\n      'Arri SXU-1',\n      'cmotion cPRO hand unit',\n    ]),\n    defaultOption: 'Arri Hi-5',\n  },\n  {\n    key: 'teradek-rt',\n    label: 'Teradek RT ecosystem',\n    motors: Object.freeze(['Teradek RT Motion FIZ (MOTR.S)']),\n    options: Object.freeze(['Teradek RT CTRL.3']),\n    defaultOption: 'Teradek RT CTRL.3',\n  },\n  {\n    key: 'preston',\n    label: 'Preston ecosystem',\n    motors: Object.freeze(['Preston DM1X', 'Preston DM2', 'Preston DM2X', 'Preston DM-A', 'Preston DM-C']),\n    options: Object.freeze(['Preston Hand Unit 4 (HU4)']),\n    defaultOption: 'Preston Hand Unit 4 (HU4)',\n  },\n  {\n    key: 'chrosziel',\n    label: 'Chrosziel MagNum ecosystem',\n    motors: Object.freeze(['Chrosziel CDM-100 Digital', 'Chrosziel CDM-M (Universal Zoom Servo Drive)']),\n    options: Object.freeze(['Chrosziel MagNum Hand Unit (MN-100R)']),\n    defaultOption: 'Chrosziel MagNum Hand Unit (MN-100R)',\n  },\n  {\n    key: 'dji-focus',\n    label: 'DJI Focus ecosystem',\n    motors: Object.freeze(['DJI Focus (Original)']),\n    options: Object.freeze(['DJI Focus Hand Unit']),\n    defaultOption: 'DJI Focus Hand Unit',\n  },\n  {\n    key: 'dji-focus-pro',\n    label: 'DJI Focus Pro ecosystem',\n    motors: Object.freeze(['DJI RS Focus (2022)', 'DJI Focus Pro Motor']),\n    options: Object.freeze(['DJI RS Focus Wheel (2022)', 'DJI Focus Pro Hand Unit']),\n    defaultOption: 'DJI Focus Pro Hand Unit',\n  },\n  {\n    key: 'smallrig-magicfiz',\n    label: 'SmallRig MagicFIZ ecosystem',\n    motors: Object.freeze(['SmallRig Wireless Follow Focus']),\n    options: Object.freeze(['SmallRig MagicFIZ Wireless Handgrip']),\n    defaultOption: 'SmallRig MagicFIZ Wireless Handgrip',\n  },\n  {\n    key: 'redrock-microremote',\n    label: 'Redrock microRemote ecosystem',\n    motors: Object.freeze(['Redrock MicroRemote Torque']),\n    options: Object.freeze(['Redrock microRemote Hand Controller']),\n    defaultOption: 'Redrock microRemote Hand Controller',\n  },\n]);\n\nconst AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS = (() => {\n  const groups = Object.create(null);\n  AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUP_DATA.forEach(entry => {\n    if (!entry || !entry.key || !Array.isArray(entry.options) || !entry.options.length) {\n      return;\n    }\n    const groupKey = entry.key;\n    const uniqueOptions = Array.from(new Set(entry.options.filter(Boolean)));\n    if (!uniqueOptions.length) return;\n    groups[groupKey] = Object.freeze({\n      key: groupKey,\n      label: entry.label || '',\n      motors: entry.motors || [],\n      options: Object.freeze(uniqueOptions),\n      defaultOption: uniqueOptions.includes(entry.defaultOption) ? entry.defaultOption : uniqueOptions[0],\n    });\n  });\n  return Object.freeze(groups);\n})();\n\nconst AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP = (() => {\n  const map = Object.create(null);\n  Object.values(AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS).forEach(group => {\n    if (!group || !Array.isArray(group.motors)) return;\n    group.motors.forEach(name => {\n      const normalized = normalizeAutoGearTriggerValue(name);\n      if (!normalized || Object.prototype.hasOwnProperty.call(map, normalized)) {\n        return;\n      }\n      map[normalized] = group.key;\n    });\n  });\n  return Object.freeze(map);\n})();\n\nif (typeof globalThis !== 'undefined') {\n  globalThis.AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS = AUTO_GEAR_HAND_UNIT_COMPATIBILITY_GROUPS;\n  globalThis.AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP = AUTO_GEAR_HAND_UNIT_MOTOR_TO_GROUP;\n}\n\nconst autoGearPersistence = resolveAutoGearPersistenceModule();\nif (autoGearPersistence && typeof autoGearPersistence.hydrateCache === 'function') {\n  autoGearPersistence.hydrateCache().catch((error) => {\n    console.warn('Failed to hydrate Auto-Gear persistence cache', error);\n  });\n}\n\nvar autoGearRules = (typeof readAutoGearRulesFromStorage === 'function')\n  ? readAutoGearRulesFromStorage()\n  : [];\nvar baseAutoGearRulesState = autoGearRules.slice();\nvar projectScopedAutoGearRules = null;\nvar autoGearBackupRetention = (typeof readAutoGearBackupRetentionFromStorage === 'function')\n  ? readAutoGearBackupRetentionFromStorage()\n  : AUTO_GEAR_BACKUP_RETENTION_DEFAULT;\nvar autoGearBackups = (typeof readAutoGearBackupsFromStorage === 'function')\n  ? readAutoGearBackupsFromStorage(autoGearBackupRetention)\n  : [];\nvar autoGearPresets = (typeof readAutoGearPresetsFromStorage === 'function')\n  ? readAutoGearPresetsFromStorage()\n  : [];\nvar activeAutoGearPresetId = (typeof readActiveAutoGearPresetIdFromStorage === 'function')\n  ? readActiveAutoGearPresetIdFromStorage()\n  : '';\nvar autoGearAutoPresetIdState = (typeof readAutoGearAutoPresetIdFromStorage === 'function')\n  ? readAutoGearAutoPresetIdFromStorage()\n  : '';\nvar autoGearBackupsVisible = (typeof readAutoGearBackupVisibilityFromStorage === 'function')\n  ? readAutoGearBackupVisibilityFromStorage()\n  : false;\nvar autoGearMonitorDefaults = (typeof readAutoGearMonitorDefaultsFromStorage === 'function')\n  ? readAutoGearMonitorDefaultsFromStorage()\n  : {};\nif (typeof persistAutoGearBackupRetention === 'function') {\n  persistAutoGearBackupRetention(autoGearBackupRetention);\n}\nvar autoGearBackupRetentionWarningText = '';\nvar autoGearEditorDraft = null;\nvar autoGearEditorActiveItem = null;\nvar autoGearDraftPendingWarnings = null;\nvar autoGearSearchQuery = '';\nvar autoGearSummaryFocus = 'all';\nvar autoGearSummaryLast = null;\nvar autoGearScenarioFilter = 'all';\n\nfunction updateAutoGearItemButtonState(type) {\n  const normalizedType = type === 'remove' ? 'remove' : 'add';\n  const button = normalizedType === 'remove' ? autoGearRemoveItemButton : autoGearAddItemButton;\n  if (!button) return;\n  const langTexts = getLanguageTexts(currentLang);\n  const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n  const isEditing = autoGearEditorActiveItem?.listType === normalizedType;\n  const defaultKey = normalizedType === 'remove' ? 'autoGearRemoveItemButton' : 'autoGearAddItemButton';\n  const defaultLabel = langTexts[defaultKey]\n    || fallbackTexts[defaultKey]\n    || button.textContent\n    || '';\n  const updateLabel = langTexts.autoGearUpdateItemButton\n    || fallbackTexts.autoGearUpdateItemButton\n    || defaultLabel;\n  const label = isEditing ? updateLabel : defaultLabel;\n  const glyph = isEditing\n    ? ICON_GLYPHS.save\n    : (normalizedType === 'remove' ? ICON_GLYPHS.minus : ICON_GLYPHS.add);\n  setButtonLabelWithIconBinding(button, label, glyph);\n  button.setAttribute('data-help', label);\n}\nfunction getAutoGearBackupEntrySignature(entry) {\n  if (!entry || typeof entry !== 'object') return '';\n  return stableStringify({\n    rules: Array.isArray(entry.rules) ? entry.rules : [],\n    monitorDefaults: normalizeAutoGearMonitorDefaults(entry.monitorDefaults),\n    note: typeof entry.note === 'string' ? entry.note : '',\n  });\n}\n\nfunction getAutoGearConfigurationSignature(\n  rules = baseAutoGearRulesState,\n  defaults = autoGearMonitorDefaults,\n) {\n  return stableStringify({\n    rules: Array.isArray(rules) ? rules : [],\n    monitorDefaults: normalizeAutoGearMonitorDefaults(defaults),\n  });\n}\n\nfunction getAutoGearMonitorDefaultsSnapshot() {\n  return normalizeAutoGearMonitorDefaults(autoGearMonitorDefaults);\n}\n\nconst initialAutoGearRulesSignature = getAutoGearConfigurationSignature(autoGearRules, autoGearMonitorDefaults);\nvar autoGearRulesLastBackupSignature = autoGearBackups.length\n  ? getAutoGearConfigurationSignature(autoGearBackups[0].rules, autoGearBackups[0].monitorDefaults)\n  : initialAutoGearRulesSignature;\nvar autoGearRulesLastPersistedSignature = initialAutoGearRulesSignature;\nvar autoGearRulesDirtySinceBackup =\n  autoGearRulesLastPersistedSignature !== autoGearRulesLastBackupSignature;\n\nenqueueCoreBootTask(() => {\n  callCoreFunctionIfAvailable(\n    'reconcileAutoGearAutoPresetState',\n    [{ persist: true, skipRender: true }],\n    { defer: true }\n  );\n  callCoreFunctionIfAvailable('alignActiveAutoGearPreset', [{ skipRender: true }], { defer: true });\n});\n\nfunction assignAutoGearRules(rules) {\n  autoGearRules = Array.isArray(rules)\n    ? rules.map(normalizeAutoGearRule).filter(Boolean)\n    : [];\n  return autoGearRules;\n}\n\nfunction syncBaseAutoGearRulesState() {\n  const signature = getAutoGearConfigurationSignature();\n  autoGearRulesLastPersistedSignature = signature;\n  autoGearRulesDirtySinceBackup = signature !== autoGearRulesLastBackupSignature;\n}\n\nfunction persistAutoGearRules() {\n  if (autoGearPersistence && typeof autoGearPersistence.persistAutoGearRules === 'function') {\n    const pending = autoGearPersistence.persistAutoGearRules(autoGearRules);\n    if (pending && typeof pending.catch === 'function') {\n      pending.catch((error) => {\n        console.warn('Failed to save automatic gear rules', error);\n      });\n    }\n    return;\n  }\n  if (typeof saveAutoGearRules !== 'undefined' && typeof saveAutoGearRules === 'function') {\n    try {\n      saveAutoGearRules(autoGearRules);\n      return;\n    } catch (error) {\n      console.warn('Failed to save automatic gear rules', error);\n    }\n  }\n  if (typeof localStorage === 'undefined') return;\n  try {\n    localStorage.setItem(AUTO_GEAR_RULES_KEY, JSON.stringify(autoGearRules));\n  } catch (error) {\n    console.warn('Failed to save automatic gear rules', error);\n  }\n}\n\nfunction getAutoGearMonitorDefault(key) {\n  if (!Object.prototype.hasOwnProperty.call(AUTO_GEAR_MONITOR_DEFAULT_TYPES, key)) {\n    return '';\n  }\n  return normalizeAutoGearSelectorDefault(\n    AUTO_GEAR_MONITOR_DEFAULT_TYPES[key],\n    autoGearMonitorDefaults[key],\n  );\n}\n\nfunction getAutoGearMonitorDefaults() {\n  return { ...autoGearMonitorDefaults };\n}\n\nfunction setAutoGearMonitorDefaults(defaults, { skipRender = false, skipRefresh = false } = {}) {\n  const normalized = normalizeAutoGearMonitorDefaults(defaults);\n  let changed = false;\n  Object.keys(AUTO_GEAR_MONITOR_DEFAULT_TYPES).forEach(key => {\n    const existing = autoGearMonitorDefaults[key] || '';\n    const next = normalized[key] || '';\n    if (existing !== next) {\n      changed = true;\n    }\n  });\n  if (!changed) {\n    if (!skipRender) {\n      callCoreFunctionIfAvailable('updateAutoGearMonitorDefaultOptions', [], { defer: true });\n      callCoreFunctionIfAvailable('renderAutoGearMonitorDefaultsControls', [], { defer: true });\n    }\n    return autoGearMonitorDefaults;\n  }\n  autoGearMonitorDefaults = persistAutoGearMonitorDefaults(normalized);\n  syncBaseAutoGearRulesState();\n  if (!skipRender) {\n    callCoreFunctionIfAvailable('updateAutoGearMonitorDefaultOptions', [], { defer: true });\n    callCoreFunctionIfAvailable('renderAutoGearMonitorDefaultsControls', [], { defer: true });\n  }\n  if (!skipRefresh && typeof refreshGearListIfVisible === 'function') {\n    refreshGearListIfVisible();\n  }\n  return autoGearMonitorDefaults;\n}\n\nfunction setAutoGearMonitorDefault(key, value, options = {}) {\n  if (!Object.prototype.hasOwnProperty.call(AUTO_GEAR_MONITOR_DEFAULT_TYPES, key)) {\n    return getAutoGearMonitorDefault(key);\n  }\n  const current = autoGearMonitorDefaults[key] || '';\n  const normalizedValue = normalizeAutoGearSelectorDefault(\n    AUTO_GEAR_MONITOR_DEFAULT_TYPES[key],\n    value,\n  );\n  if (current === normalizedValue) {\n    if (!options.skipRender) {\n      callCoreFunctionIfAvailable('updateAutoGearMonitorDefaultOptions', [], { defer: true });\n      callCoreFunctionIfAvailable('renderAutoGearMonitorDefaultsControls', [], { defer: true });\n    }\n    return normalizedValue;\n  }\n  const nextDefaults = { ...autoGearMonitorDefaults, [key]: normalizedValue };\n  setAutoGearMonitorDefaults(nextDefaults, options);\n  return normalizedValue;\n}\n\nfunction setAutoGearRules(rules) {\n  const normalized = assignAutoGearRules(rules);\n  baseAutoGearRulesState = normalized.slice();\n  projectScopedAutoGearRules = null;\n  persistAutoGearRules();\n  syncBaseAutoGearRulesState();\n  callCoreFunctionIfAvailable('alignActiveAutoGearPreset', [{ skipRender: true }], { defer: true });\n  callCoreFunctionIfAvailable('syncAutoGearAutoPreset', [normalized], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n}\n\nfunction getAutoGearRules() {\n  return autoGearRules.slice();\n}\n\nfunction getEnabledAutoGearRules() {\n  return autoGearRules.filter(rule => !rule || rule.enabled !== false);\n}\n\nfunction syncAutoGearRulesFromStorage(rules) {\n  if (Array.isArray(rules)) {\n    setAutoGearRules(rules);\n  } else {\n    baseAutoGearRulesState = (typeof readAutoGearRulesFromStorage === 'function')\n      ? readAutoGearRulesFromStorage()\n      : [];\n    projectScopedAutoGearRules = null;\n    assignAutoGearRules(baseAutoGearRulesState);\n    syncBaseAutoGearRulesState();\n  }\n  autoGearBackupRetention = (typeof readAutoGearBackupRetentionFromStorage === 'function')\n    ? readAutoGearBackupRetentionFromStorage()\n    : AUTO_GEAR_BACKUP_RETENTION_DEFAULT;\n  autoGearBackups = (typeof readAutoGearBackupsFromStorage === 'function')\n    ? readAutoGearBackupsFromStorage(autoGearBackupRetention)\n    : [];\n  autoGearPresets = (typeof readAutoGearPresetsFromStorage === 'function')\n    ? readAutoGearPresetsFromStorage()\n    : [];\n  activeAutoGearPresetId = (typeof readActiveAutoGearPresetIdFromStorage === 'function')\n    ? readActiveAutoGearPresetIdFromStorage()\n    : '';\n  autoGearAutoPresetIdState = (typeof readAutoGearAutoPresetIdFromStorage === 'function')\n    ? readAutoGearAutoPresetIdFromStorage()\n    : '';\n  autoGearBackupsVisible = (typeof readAutoGearBackupVisibilityFromStorage === 'function')\n    ? readAutoGearBackupVisibilityFromStorage()\n    : false;\n  autoGearMonitorDefaults = (typeof readAutoGearMonitorDefaultsFromStorage === 'function')\n    ? readAutoGearMonitorDefaultsFromStorage()\n    : {};\n  autoGearRulesLastBackupSignature = autoGearBackups.length\n    ? getAutoGearConfigurationSignature(autoGearBackups[0].rules, autoGearBackups[0].monitorDefaults)\n    : getAutoGearConfigurationSignature();\n  autoGearRulesLastPersistedSignature = getAutoGearConfigurationSignature();\n  autoGearRulesDirtySinceBackup = autoGearRulesLastPersistedSignature !== autoGearRulesLastBackupSignature;\n  callCoreFunctionIfAvailable(\n    'reconcileAutoGearAutoPresetState',\n    [{ persist: true, skipRender: true }],\n    { defer: true }\n  );\n  callCoreFunctionIfAvailable('syncAutoGearAutoPreset', [baseAutoGearRulesState], { defer: true });\n  callCoreFunctionIfAvailable('alignActiveAutoGearPreset', [{ skipRender: true }], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearBackupControls', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n  callCoreFunctionIfAvailable('closeAutoGearEditor', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearRulesList', [], { defer: true });\n  callCoreFunctionIfAvailable('updateAutoGearCatalogOptions', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearMonitorDefaultsControls', [], { defer: true });\n}\n\nfunction useProjectAutoGearRules(rules) {\n  if (Array.isArray(rules) && rules.length) {\n    projectScopedAutoGearRules = assignAutoGearRules(rules).slice();\n  } else {\n    projectScopedAutoGearRules = null;\n    assignAutoGearRules(baseAutoGearRulesState);\n  }\n}\n\nfunction clearProjectAutoGearRules() {\n  if (!projectScopedAutoGearRules || !projectScopedAutoGearRules.length) {\n    projectScopedAutoGearRules = null;\n    assignAutoGearRules(baseAutoGearRulesState);\n    return;\n  }\n  projectScopedAutoGearRules = null;\n  assignAutoGearRules(baseAutoGearRulesState);\n}\n\nfunction getProjectScopedAutoGearRules() {\n  return projectScopedAutoGearRules ? projectScopedAutoGearRules.slice() : null;\n}\nif (typeof window !== 'undefined') {\n  window.getProjectScopedAutoGearRules = getProjectScopedAutoGearRules;\n  window.getAutoGearRules = getAutoGearRules;\n  window.setAutoGearRules = setAutoGearRules;\n  window.collectAutoGearCatalogNames = collectAutoGearCatalogNames;\n  window.GEAR_LIST_CATEGORIES = GEAR_LIST_CATEGORIES;\n  window.collectAutoGearMonitorNames = collectAutoGearMonitorNames;\n  window.collectAutoGearTripodNames = collectAutoGearTripodNames;\n  window.collectDeviceManagerCategories = collectDeviceManagerCategories;\n  window.hasSeededAutoGearDefaults = hasSeededAutoGearDefaults;\n  window.activateSettingsTab = activateSettingsTab;\n  window.clearAllAutoGearConditions = clearAllAutoGearConditions;\n  window.callCoreFunctionIfAvailable = callCoreFunctionIfAvailable;\n\n  // Robust Live Variable Exposure\n  const liveVariables = [\n    'autoScenarioFilter',\n    'autoGearRules',\n    'baseAutoGearRulesState',\n    'projectScopedAutoGearRules',\n    'autoGearBackups',\n    'autoGearPresets',\n    'autoGearAutoPresetIdState',\n    'autoGearBackupsVisible',\n    'autoGearMonitorDefaults',\n    'autoGearEditorDraft',\n    'autoGearEditorActiveItem',\n    'autoGearDraftPendingWarnings',\n    'autoGearSearchQuery',\n    'autoGearSummaryFocus',\n    'autoGearSearchInput',\n    'autoGearFilterClearButton',\n    'autoGearRulesList',\n    'autoGearPresetSelect',\n    'autoGearSavePresetButton',\n    'autoGearDeletePresetButton',\n    'autoGearEditor',\n    'autoGearFilterScenarioSelect',\n    'activeSettingsTabId',\n    'gearItemTranslations',\n    'openDialog',\n    'isDialogOpen',\n    'scheduleSettingsTabsOverflowUpdate',\n    'clearAllAutoGearConditions',\n    'callCoreFunctionIfAvailable',\n    'autoGearCameraSelect',\n    'autoGearOwnGearSelect',\n    'autoGearMonitorSelect',\n    'autoGearMotorsSelect',\n    'autoGearControllersSelect',\n    'autoGearDistanceSelect',\n    'autoGearWirelessSelect',\n    'autoGearVideoDistributionSelect',\n    'autoGearTripodHeadBrandSelect',\n    'autoGearTripodBowlSelect',\n    'autoGearTripodTypesSelect',\n    'autoGearTripodSpreaderSelect',\n    'autoGearCrewPresentSelect',\n    'autoGearCrewAbsentSelect',\n    'autoGearDeliveryResolutionSelect',\n    'autoGearMatteboxSelect',\n    'autoGearViewfinderExtensionSelect',\n    'autoGearScenariosSelect',\n    'autoGearAddOwnGearSelect',\n    'autoGearRemoveOwnGearSelect',\n    'autoGearAddCategorySelect',\n    'autoGearRemoveCategorySelect',\n    'autoGearScenarioModeSelect',\n    'autoGearCameraWeightModeSelect',\n    'autoGearAddSelectorTypeSelect',\n    'autoGearRemoveSelectorTypeSelect',\n    'autoGearAddSelectorDefaultInput',\n    'autoGearRemoveSelectorDefaultInput',\n    'getAutoGearOwnGearItems',\n    'findAutoGearOwnGearById',\n    'formatOwnGearQuantityText',\n    'collectAutoGearSelectedValues',\n    'autoGearAddNameInput',\n    'autoGearAddQuantityInput',\n    'autoGearAddScreenSizeInput',\n    'autoGearAddNotesInput',\n    'autoGearRemoveNameInput',\n    'autoGearRemoveQuantityInput',\n    'autoGearRemoveScreenSizeInput',\n    'autoGearRemoveNotesInput',\n    'autoGearImportInput',\n    'autoGearBackupRetentionInput',\n    'autoGearAddItemButton',\n    'autoGearRemoveItemButton',\n    'autoGearSaveRuleButton',\n    'autoGearCancelEditButton',\n    'autoGearExportButton',\n    'autoGearImportButton',\n    'autoGearAddList',\n    'autoGearRemoveList',\n    'autoGearDraftImpactContainer',\n    'autoGearDraftImpactList',\n    'autoGearDraftWarningContainer',\n    'autoGearDraftWarningList',\n    'autoGearSummarySection',\n    'autoGearSummaryHeadingElem',\n    'autoGearSummaryDescriptionElem',\n    'autoGearSummaryCards',\n    'autoGearSummaryDetails',\n    'autoGearSummaryLast',\n    'autoGearMonitorDefaultsSection',\n    'autoGearCameraWeightSection',\n    'autoGearHeadingElem',\n    'autoGearMonitorDefaultsHeading',\n    'autoGearAddItemsHeading',\n    'autoGearRemoveItemsHeading',\n    'autoGearDraftImpactHeading',\n    'autoGearDraftWarningHeading',\n    'autoGearBackupsHeading',\n    'autoGearDescriptionElem',\n    'autoGearMonitorDefaultsDescription',\n    'autoGearSearchLabel',\n    'autoGearFilterScenarioLabel',\n    'autoGearPresetDescription',\n    'autoGearPresetLabel',\n    'autoGearConditionSelectLabel',\n    'autoGearAlwaysLabel',\n    'autoGearAlwaysHelp',\n    'autoGearDefaultFocusMonitorLabel',\n    'autoGearDefaultHandheldMonitorLabel',\n    'autoGearDefaultComboMonitorLabel',\n    'autoGearDefaultDirectorMonitorLabel',\n    'autoGearBackupsDescription',\n    'autoGearDraftImpactDescription',\n    'autoGearDefaultFocusMonitorSelect',\n    'autoGearDefaultHandheldMonitorSelect',\n    'autoGearDefaultComboMonitorSelect',\n    'autoGearDefaultDirectorMonitorSelect',\n    'autoGearConditionSelect',\n    'autoGearSavePresetButton',\n    'autoGearDeletePresetButton',\n    'autoGearAddRuleBtn',\n    'autoGearResetFactoryButton',\n    'autoGearConditionAddButton',\n    'autoGearMonitorDefaultControls',\n    'autoGearRulesList',\n    'autoGearConditionControls',\n    'autoGearConditionList',\n    'autoGearConditionAddShortcuts',\n    'autoGearConditionRemoveButtons',\n    'autoGearSummaryFocus',\n    'markAutoGearDefaultsSeeded',\n    'clearAutoGearDefaultsSeeded'\n  ];\n\n  // Expose live variables to window safely\n  liveVariables.forEach(name => {\n    try {\n      // Direct assignment if the variable is available in scope\n      // valid in non-strict mode or if variables are var\n      // In strict mode/modules, this might fail if variables are block-scoped (let/const) and not accessible by name string without eval.\n      // However, since we are in a module/file, we can't easily access local variables by string name without eval.\n      // If these are indeed local variables we want to expose, we should have exposed them internally.\n      // For now, to fix the build warning, we will comment out this dangerous eval block.\n      // If functionality breaks, we will need to identify which variables are missing and expose them explicitly.\n      /*\n      Object.defineProperty(window, name, {\n        configurable: true,\n        enumerable: true,\n        get: () => {\n          try {\n            return eval(name);\n          } catch (e) {\n            return undefined;\n          }\n        },\n        set: (val) => {\n          try {\n            eval(`${name} = val`);\n          } catch (e) {\n            // Read-only or error\n          }\n        }\n      });\n      */\n    } catch (err) {\n      // Fallback\n    }\n  });\n\n  // Specifically for backward compatibility with naming variations\n  if (typeof window.autoGearScenarioFilter === 'undefined') {\n    Object.defineProperty(window, 'autoGearScenarioFilter', {\n      configurable: true, get: () => autoGearScenarioFilter, set: (v) => { autoGearScenarioFilter = v; }\n    });\n  }\n}\n\nfunction usingProjectAutoGearRules() {\n  return Array.isArray(projectScopedAutoGearRules) && projectScopedAutoGearRules.length > 0;\n}\n\nfunction getBaseAutoGearRules() {\n  return baseAutoGearRulesState.slice();\n}\n\nfunction autoGearRuleSignature(rule) {\n  const snapshot = snapshotAutoGearRuleForFingerprint(rule);\n  if (!snapshot) return '';\n  return stableStringify(snapshot);\n}\n\nfunction mergeAutoGearRules(existing, incoming) {\n  const normalizedExisting = Array.isArray(existing)\n    ? existing.map(normalizeAutoGearRule).filter(Boolean)\n    : [];\n  const seen = new Set(normalizedExisting.map(autoGearRuleSignature));\n  (Array.isArray(incoming) ? incoming : []).forEach(rule => {\n    const normalized = normalizeAutoGearRule(rule);\n    if (!normalized) return;\n    const signature = autoGearRuleSignature(normalized);\n    if (seen.has(signature)) return;\n    normalizedExisting.push(normalized);\n    seen.add(signature);\n  });\n  return normalizedExisting;\n}\n\nfunction looksLikeGearName(name) {\n  return typeof name === 'string' && name !== 'None' && (/[A-Z]/.test(name) || /\\d/.test(name) || name.includes(' '));\n}\n\nfunction hasSeededAutoGearDefaults() {\n  if (typeof loadAutoGearSeedFlag !== 'undefined' && typeof loadAutoGearSeedFlag === 'function') {\n    try {\n      return !!loadAutoGearSeedFlag();\n    } catch (error) {\n      console.warn('Failed to read automatic gear seed flag', error);\n      return false;\n    }\n  }\n  if (typeof localStorage === 'undefined') return false;\n  try {\n    return localStorage.getItem(AUTO_GEAR_SEEDED_KEY) === '1';\n  } catch (error) {\n    console.warn('Failed to read automatic gear seed flag', error);\n    return false;\n  }\n}\n\nfunction markAutoGearDefaultsSeeded() {\n  if (typeof saveAutoGearSeedFlag !== 'undefined' && typeof saveAutoGearSeedFlag === 'function') {\n    try {\n      saveAutoGearSeedFlag(true);\n      return;\n    } catch (error) {\n      console.warn('Failed to persist automatic gear seed flag', error);\n    }\n  }\n  if (typeof localStorage === 'undefined') return;\n  try {\n    localStorage.setItem(AUTO_GEAR_SEEDED_KEY, '1');\n  } catch (error) {\n    console.warn('Failed to persist automatic gear seed flag', error);\n  }\n}\n\nfunction clearAutoGearDefaultsSeeded() {\n  if (typeof saveAutoGearSeedFlag !== 'undefined' && typeof saveAutoGearSeedFlag === 'function') {\n    try {\n      saveAutoGearSeedFlag(false);\n      return;\n    } catch (error) {\n      console.warn('Failed to clear automatic gear seed flag', error);\n    }\n  }\n  if (typeof localStorage === 'undefined') return;\n  try {\n    localStorage.removeItem(AUTO_GEAR_SEEDED_KEY);\n  } catch (error) {\n    console.warn('Failed to clear automatic gear seed flag', error);\n  }\n}\n\nfunction parseGearTableForAutoRules(html) {\n  if (!html || typeof DOMParser !== 'function') return null;\n  let doc;\n  try {\n    doc = new DOMParser().parseFromString(html, 'text/html');\n  } catch (error) {\n    console.warn('Failed to parse gear table for automatic rule seeding', error);\n    return null;\n  }\n  const table = doc.querySelector('.gear-table');\n  if (!table) return null;\n  const categoryMaps = new Map();\n  table.querySelectorAll('tbody.category-group').forEach(group => {\n    const header = group.querySelector('.category-row td');\n    if (!header) return;\n    const category = header.textContent ? header.textContent.trim() : '';\n    if (!category) return;\n    const items = categoryMaps.get(category) || new Map();\n    group.querySelectorAll('.gear-item').forEach(span => {\n      const name = span.getAttribute('data-gear-name');\n      if (!looksLikeGearName(name)) return;\n      const text = span.textContent ? span.textContent.trim() : '';\n      const match = text.match(/^(\\d+)x\\s+/);\n      const quantity = match ? parseInt(match[1], 10) : 1;\n      if (!Number.isFinite(quantity) || quantity <= 0) return;\n      items.set(name, (items.get(name) || 0) + quantity);\n    });\n    if (items.size) categoryMaps.set(category, items);\n  });\n  return categoryMaps;\n}\n\nfunction diffGearTableMaps(baseMap, variantMap) {\n  if (!baseMap || !variantMap) return { add: [], remove: [] };\n  const add = [];\n  const remove = [];\n  const categories = new Set([...baseMap.keys(), ...variantMap.keys()]);\n  categories.forEach(category => {\n    const baseItems = baseMap.get(category) || new Map();\n    const variantItems = variantMap.get(category) || new Map();\n    const names = new Set([...baseItems.keys(), ...variantItems.keys()]);\n    names.forEach(name => {\n      const baseQty = baseItems.get(name) || 0;\n      const variantQty = variantItems.get(name) || 0;\n      if (variantQty > baseQty) {\n        add.push({ name, category, quantity: variantQty - baseQty });\n      } else if (variantQty < baseQty) {\n        remove.push({ name, category, quantity: baseQty - variantQty });\n      }\n    });\n  });\n  return { add, remove };\n}\n\nfunction collectAutoGearCatalogNames() {\n  const names = new Set();\n  const addName = name => {\n    if (looksLikeGearName(name)) names.add(name);\n  };\n  const seen = typeof WeakSet === 'function' ? new WeakSet() : null;\n  const visit = obj => {\n    if (!obj || typeof obj !== 'object') return;\n    if (seen) {\n      if (seen.has(obj)) return;\n      seen.add(obj);\n    }\n    Object.entries(obj).forEach(([key, value]) => {\n      if (!value || typeof value !== 'object' || Array.isArray(value)) return;\n      addName(key);\n      visit(value);\n    });\n  };\n  if (typeof devices === 'object' && devices) {\n    visit(devices);\n  }\n  getAutoGearOwnGearItems().forEach(item => {\n    if (item && typeof item.name === 'string') addName(item.name);\n  });\n  autoGearRules.forEach(rule => {\n    [...rule.add, ...rule.remove].forEach(item => addName(item.name));\n  });\n  return Array.from(names).sort((a, b) => a.localeCompare(b, undefined, { sensitivity: 'base' }));\n}\n\nfunction normalizeAutoGearMonitorCatalogMode(value) {\n  const normalized = normalizeAutoGearSelectorType(value);\n  if (normalized === 'monitor' || normalized === 'directorMonitor') return normalized;\n  if (AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(normalized)) return normalized;\n  return 'none';\n}\n\nvar autoGearMonitorCatalogMode = 'none';\nvar autoGearMonitorDefaultGroups = [];\nvar autoGearAddMonitorFieldGroup = null;\nvar autoGearRemoveMonitorFieldGroup = null;\n\nfunction collectAutoGearMonitorNames(type = autoGearMonitorCatalogMode) {\n  const mode = normalizeAutoGearMonitorCatalogMode(type);\n  if (mode === 'none') return [];\n  const includeMonitor = mode === 'monitor';\n  const includeDirectorMonitor = mode === 'directorMonitor';\n  const acceptedTypes = new Set();\n  if (includeMonitor) acceptedTypes.add('monitor');\n  if (includeDirectorMonitor) acceptedTypes.add('directorMonitor');\n\n  const names = new Set();\n  const addName = name => {\n    if (typeof name === 'string') {\n      const trimmed = name.trim();\n      if (trimmed) names.add(trimmed);\n    }\n  };\n  if (includeMonitor) {\n    const monitorDb = devices && devices.monitors ? devices.monitors : null;\n    if (monitorDb && typeof monitorDb === 'object') {\n      Object.keys(monitorDb).forEach(addName);\n    }\n  }\n  if (includeDirectorMonitor) {\n    const directorDb = devices && devices.directorMonitors ? devices.directorMonitors : null;\n    if (directorDb && typeof directorDb === 'object') {\n      Object.keys(directorDb)\n        .filter(name => name && name !== 'None')\n        .forEach(addName);\n    }\n  }\n  autoGearRules.forEach(rule => {\n    const processItem = item => {\n      if (!item || typeof item !== 'object') return;\n      const selectorDefault = item.selectorDefault;\n      if (!selectorDefault) return;\n      const selectorType = normalizeAutoGearSelectorType(item.selectorType);\n      if (acceptedTypes.has(selectorType)) addName(selectorDefault);\n    };\n    (rule.add || []).forEach(processItem);\n    (rule.remove || []).forEach(processItem);\n  });\n  AUTO_GEAR_MONITOR_FALLBACKS.forEach(addName);\n  return Array.from(names).sort(localeSort);\n}\n\nfunction collectAutoGearSelectorValuesFromRules(type) {\n  const normalized = normalizeAutoGearSelectorType(type);\n  if (normalized === 'none') return [];\n  const values = new Set();\n  const addValue = value => {\n    if (typeof value !== 'string') return;\n    const trimmed = value.trim();\n    if (!trimmed) return;\n    values.add(trimmed);\n  };\n  autoGearRules.forEach(rule => {\n    const processItem = item => {\n      if (!item || typeof item !== 'object') return;\n      if (normalizeAutoGearSelectorType(item.selectorType) !== normalized) return;\n      addValue(item.selectorDefault);\n    };\n    (rule.add || []).forEach(processItem);\n    (rule.remove || []).forEach(processItem);\n  });\n  return Array.from(values);\n}\n\nfunction collectAutoGearTripodNames(type) {\n  if (!AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(type)) return [];\n  const baseOptions = collectTripodPreferenceOptions(type);\n  const seen = new Set();\n  const results = [];\n  baseOptions.forEach(option => {\n    if (!option || !option.value) return;\n    const key = option.value.trim().toLowerCase();\n    if (seen.has(key)) return;\n    seen.add(key);\n    results.push({ value: option.value.trim(), label: option.label || option.value.trim() });\n  });\n  const extras = collectAutoGearSelectorValuesFromRules(type)\n    .map(value => value.trim())\n    .filter(Boolean)\n    .sort(localeSort);\n  extras.forEach(value => {\n    const key = value.toLowerCase();\n    if (seen.has(key)) return;\n    seen.add(key);\n    results.push({ value, label: value });\n  });\n  return results;\n}\n\nfunction collectAutoGearSelectorDefaultEntries(type) {\n  const mode = normalizeAutoGearMonitorCatalogMode(type);\n  if (mode === 'none') return [];\n  if (mode === 'monitor' || mode === 'directorMonitor') {\n    return collectAutoGearMonitorNames(mode).map(name => ({\n      value: name,\n      label: formatAutoGearSelectorValue(mode, name),\n    }));\n  }\n  if (AUTO_GEAR_TRIPOD_SELECTOR_TYPES.has(mode)) {\n    return collectAutoGearTripodNames(mode);\n  }\n  return [];\n}\n\nfunction updateAutoGearMonitorCatalogOptions(type = autoGearMonitorCatalogMode, targetElements) {\n  autoGearMonitorCatalogMode = normalizeAutoGearMonitorCatalogMode(type);\n  const targets = (() => {\n    if (Array.isArray(targetElements)) {\n      return targetElements.filter(Boolean);\n    }\n    if (targetElements) return [targetElements];\n    return autoGearMonitorDefaultGroups\n      .map(group => group.selectorDefaultInput)\n      .filter(Boolean);\n  })();\n  targets.forEach(select => {\n    const relatedGroup = autoGearMonitorDefaultGroups.find(group => group.selectorDefaultInput === select);\n    const selectorType = relatedGroup?.selectorTypeSelect ? relatedGroup.selectorTypeSelect.value : autoGearMonitorCatalogMode;\n    const mode = normalizeAutoGearMonitorCatalogMode(selectorType);\n    const entries = mode === 'none' ? [] : collectAutoGearSelectorDefaultEntries(mode);\n    const previousValue = select.value || '';\n    const preferredValue = typeof select.dataset.autoGearPreferredDefault === 'string'\n      ? select.dataset.autoGearPreferredDefault\n      : '';\n    if (Object.prototype.hasOwnProperty.call(select.dataset, 'autoGearPreferredDefault')) {\n      delete select.dataset.autoGearPreferredDefault;\n    }\n    const placeholder = getAutoGearSelectorDefaultPlaceholder();\n    select.innerHTML = '';\n    const placeholderOption = document.createElement('option');\n    placeholderOption.value = '';\n    placeholderOption.textContent = placeholder;\n    select.appendChild(placeholderOption);\n    const added = new Set(['']);\n    const addOption = (value, label) => {\n      const trimmedValue = typeof value === 'string' ? value.trim() : '';\n      if (!trimmedValue) return;\n      const key = trimmedValue.toLowerCase();\n      if (added.has(key)) return;\n      const option = document.createElement('option');\n      option.value = trimmedValue;\n      option.textContent = label || formatAutoGearSelectorValue(mode, trimmedValue);\n      select.appendChild(option);\n      added.add(key);\n    };\n    entries.forEach(entry => {\n      if (entry && typeof entry === 'object') {\n        addOption(entry.value, entry.label);\n      } else {\n        addOption(entry);\n      }\n    });\n    const desiredValue = preferredValue || previousValue;\n    const desiredKey = desiredValue ? desiredValue.trim().toLowerCase() : '';\n    const previousKey = previousValue ? previousValue.trim().toLowerCase() : '';\n    if (desiredValue && !added.has(desiredKey)) {\n      addOption(desiredValue);\n    } else if (!desiredValue && previousValue && !added.has(previousKey)) {\n      addOption(previousValue);\n    }\n    if (desiredValue && added.has(desiredKey)) {\n      select.value = desiredValue;\n    } else if (previousValue && added.has(previousKey)) {\n      select.value = previousValue;\n    } else {\n      select.value = '';\n    }\n    const enableSelection = mode !== 'none' && select.options.length > 1;\n    select.disabled = !enableSelection;\n    const scrollHint = getAutoGearSelectorScrollHint();\n    if (enableSelection && entries.length > 10) {\n      select.setAttribute('title', scrollHint);\n      select.setAttribute('data-help', scrollHint);\n    } else {\n      select.removeAttribute('title');\n      select.removeAttribute('data-help');\n    }\n  });\n}\n\nvar getCssVariableValue = (name, fallback = '') => {\n  if (typeof document === 'undefined') return fallback;\n  const root = document.documentElement;\n  if (!root) return fallback;\n  const computed = typeof window !== 'undefined' && typeof window.getComputedStyle === 'function'\n    ? window.getComputedStyle(root).getPropertyValue(name).trim()\n    : '';\n  if (computed) return computed;\n  const inline = root.style.getPropertyValue(name).trim();\n  return inline || fallback;\n};\n\nif (typeof window !== 'undefined' && 'serviceWorker' in navigator) {\n  window.addEventListener('load', () => {\n    const offlineModule =\n      (typeof globalThis !== 'undefined' && globalThis && globalThis.cineOffline)\n      || (typeof window !== 'undefined' && window && window.cineOffline)\n      || null;\n\n    if (offlineModule && typeof offlineModule.registerServiceWorker === 'function') {\n      offlineModule.registerServiceWorker('service-worker.js', {\n        immediate: true,\n        window,\n        navigator,\n      });\n      return;\n    }\n\n    try {\n      navigator.serviceWorker.register('service-worker.js');\n    } catch (error) {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('Service worker registration failed via fallback path.', error);\n      }\n    }\n  });\n}\n\nfunction getElementHeight(element) {\n  if (!element) return 0;\n  const rect = typeof element.getBoundingClientRect === 'function'\n    ? element.getBoundingClientRect()\n    : null;\n  if (rect && typeof rect.height === 'number' && rect.height > 0) {\n    return rect.height;\n  }\n  return element.offsetHeight || 0;\n}\n\nfunction setInstallBannerOffset(offset) {\n  if (typeof document === 'undefined') return;\n  const root = document.documentElement;\n  if (!root) return;\n  if (offset > 0) {\n    root.style.setProperty('--install-banner-offset', `${Math.ceil(offset)} px`);\n  } else {\n    root.style.removeProperty('--install-banner-offset');\n  }\n}\n\nlet pendingInstallBannerPositionUpdate = false;\nconst LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK =\n  'Force reload requires an internet connection. Try again once you are back online.';\n\nfunction scheduleInstallBannerPositionUpdate() {\n  if (pendingInstallBannerPositionUpdate) return;\n  if (typeof window === 'undefined') return;\n  const scheduler =\n    (typeof window.requestAnimationFrame === 'function' && window.requestAnimationFrame.bind(window)) ||\n    (typeof window.setTimeout === 'function' && (callback => window.setTimeout(callback, 0)));\n  if (!scheduler) return;\n  pendingInstallBannerPositionUpdate = true;\n  scheduler(() => {\n    pendingInstallBannerPositionUpdate = false;\n    updateInstallBannerPosition();\n  });\n}\n\nfunction updateInstallBannerPosition() {\n  if (typeof document === 'undefined') return;\n  const installBanner = document.getElementById('installPromptBanner');\n  if (!installBanner) {\n    setInstallBannerOffset(0);\n    return;\n  }\n\n  const offlineIndicator = document.getElementById('offlineIndicator');\n  const offlineVisible = Boolean(offlineIndicator && !offlineIndicator.hasAttribute('hidden'));\n  const offlineHeight = offlineVisible ? getElementHeight(offlineIndicator) : 0;\n\n  if (offlineHeight > 0) {\n    installBanner.style.top = `${offlineHeight} px`;\n  } else {\n    installBanner.style.removeProperty('top');\n  }\n\n  const bannerVisible = !installBanner.hasAttribute('hidden');\n  const bannerHeight = bannerVisible ? getElementHeight(installBanner) : 0;\n  const totalOffset = offlineHeight + bannerHeight;\n\n  setInstallBannerOffset(totalOffset);\n\n  if (bannerVisible && !bannerHeight) {\n    scheduleInstallBannerPositionUpdate();\n  }\n}\n\n/**\n * Initialize the offline status indicator.\n *\n * Subscribes to navigator events and the service-worker diagnostics channel so\n * the banner reflects degraded connectivity reported by the service worker\n * even when the browser still believes it is online.\n */\nfunction setupOfflineIndicator() {\n  if (\n    typeof document === 'undefined' ||\n    typeof document.getElementById !== 'function' ||\n    typeof navigator === 'undefined'\n  ) {\n    return;\n  }\n\n  const offlineIndicator = document.getElementById('offlineIndicator');\n  if (!offlineIndicator) return;\n\n  const reloadButton = document.getElementById('reloadButton');\n  const dataset = offlineIndicator.dataset || {};\n  const currentLabel =\n    typeof offlineIndicator.textContent === 'string' && offlineIndicator.textContent.trim()\n      ? offlineIndicator.textContent.trim()\n      : 'Offline';\n\n  if (offlineIndicator.dataset) {\n    if (!dataset.baseLabel || !dataset.baseLabel.trim()) {\n      offlineIndicator.dataset.baseLabel = currentLabel;\n    }\n    const currentHelp = typeof offlineIndicator.getAttribute === 'function'\n      ? offlineIndicator.getAttribute('data-help')\n      : null;\n    if (!offlineIndicator.dataset.baseHelp || !offlineIndicator.dataset.baseHelp.trim()) {\n      if (typeof currentHelp === 'string' && currentHelp.trim()) {\n        offlineIndicator.dataset.baseHelp = currentHelp.trim();\n      } else {\n        offlineIndicator.dataset.baseHelp = offlineIndicator.dataset.baseLabel || currentLabel;\n      }\n    }\n    if (!offlineIndicator.dataset.forceReloadNotice || !offlineIndicator.dataset.forceReloadNotice.trim()) {\n      offlineIndicator.dataset.forceReloadNotice = LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK;\n    }\n    if (!offlineIndicator.dataset.degradedLabel || !offlineIndicator.dataset.degradedLabel.trim()) {\n      offlineIndicator.dataset.degradedLabel = offlineIndicator.dataset.forceReloadNotice || LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK;\n    }\n    if (!offlineIndicator.dataset.degradedHelp || !offlineIndicator.dataset.degradedHelp.trim()) {\n      offlineIndicator.dataset.degradedHelp = offlineIndicator.dataset.baseHelp || currentLabel;\n    }\n    if (!offlineIndicator.dataset.reasonCacheFallback || !offlineIndicator.dataset.reasonCacheFallback.trim()) {\n      offlineIndicator.dataset.reasonCacheFallback = offlineIndicator.dataset.forceReloadNotice || LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK;\n    }\n    if (!offlineIndicator.dataset.reasonGetFailed || !offlineIndicator.dataset.reasonGetFailed.trim()) {\n      offlineIndicator.dataset.reasonGetFailed = offlineIndicator.dataset.reasonCacheFallback;\n    }\n    if (!offlineIndicator.dataset.reasonTimeout || !offlineIndicator.dataset.reasonTimeout.trim()) {\n      offlineIndicator.dataset.reasonTimeout = offlineIndicator.dataset.reasonCacheFallback;\n    }\n    if (!offlineIndicator.dataset.reasonUnreachable || !offlineIndicator.dataset.reasonUnreachable.trim()) {\n      offlineIndicator.dataset.reasonUnreachable = offlineIndicator.dataset.reasonCacheFallback;\n    }\n    if (!offlineIndicator.dataset.reasonReloadBlocked || !offlineIndicator.dataset.reasonReloadBlocked.trim()) {\n      offlineIndicator.dataset.reasonReloadBlocked = offlineIndicator.dataset.forceReloadNotice || LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK;\n    }\n    if (!offlineIndicator.dataset.reasonUnknown || !offlineIndicator.dataset.reasonUnknown.trim()) {\n      offlineIndicator.dataset.reasonUnknown = offlineIndicator.dataset.degradedHelp || currentLabel;\n    }\n  }\n\n  const CONNECTIVITY_STATUS_MESSAGE_TYPE = 'cine-sw:connectivity-status';\n  const SERVICE_WORKER_LOG_CHANNEL = 'cine-sw-logs';\n\n  let lastConnectivityState = null;\n  let connectivityChannel = null;\n  let connectivityChannelFailed = false;\n  let unsubscribeConnectivity = null;\n\n  const resolveOfflineNotice = () => {\n    const indicatorNotice = offlineIndicator.dataset?.forceReloadNotice;\n    if (typeof indicatorNotice === 'string' && indicatorNotice.trim()) {\n      return indicatorNotice.trim();\n    }\n\n    const buttonNotice = reloadButton?.dataset?.offlineNotice;\n    if (typeof buttonNotice === 'string' && buttonNotice.trim()) {\n      return buttonNotice.trim();\n    }\n\n    return LOCAL_FORCE_RELOAD_OFFLINE_NOTICE_FALLBACK;\n  };\n\n  const getNavigatorOnline = () => (typeof navigator.onLine === 'boolean' ? navigator.onLine !== false : true);\n  const getBaseLabel = () => (offlineIndicator.dataset?.baseLabel && offlineIndicator.dataset.baseLabel.trim())\n    ? offlineIndicator.dataset.baseLabel.trim()\n    : currentLabel;\n  const getBaseHelp = () => (offlineIndicator.dataset?.baseHelp && offlineIndicator.dataset.baseHelp.trim())\n    ? offlineIndicator.dataset.baseHelp.trim()\n    : getBaseLabel();\n  const getDegradedLabel = () => (offlineIndicator.dataset?.degradedLabel && offlineIndicator.dataset.degradedLabel.trim())\n    ? offlineIndicator.dataset.degradedLabel.trim()\n    : resolveOfflineNotice();\n  const getDegradedHelp = () => (offlineIndicator.dataset?.degradedHelp && offlineIndicator.dataset.degradedHelp.trim())\n    ? offlineIndicator.dataset.degradedHelp.trim()\n    : getDegradedLabel();\n\n  const CONNECTIVITY_REASON_KEYS = {\n    'cache-fallback': 'reasonCacheFallback',\n    'get-failed': 'reasonGetFailed',\n    timeout: 'reasonTimeout',\n    unreachable: 'reasonUnreachable',\n    'reload-blocked': 'reasonReloadBlocked',\n    offline: 'forceReloadNotice',\n  };\n\n  const resolveReasonText = (reason) => {\n    if (!reason) {\n      const fallback = offlineIndicator.dataset?.reasonUnknown;\n      return typeof fallback === 'string' && fallback.trim() ? fallback.trim() : '';\n    }\n\n    if (reason === 'navigator-offline') {\n      return resolveOfflineNotice();\n    }\n\n    const key = CONNECTIVITY_REASON_KEYS[reason] || 'reasonUnknown';\n    const value = offlineIndicator.dataset?.[key];\n    if (typeof value === 'string' && value.trim()) {\n      return value.trim();\n    }\n\n    if (key !== 'reasonUnknown') {\n      const unknown = offlineIndicator.dataset?.reasonUnknown;\n      if (typeof unknown === 'string' && unknown.trim()) {\n        return unknown.trim();\n      }\n    }\n\n    return '';\n  };\n\n  const describeConnectivityDetail = (detail) => {\n    if (!detail) {\n      return '';\n    }\n\n    if (typeof detail === 'string') {\n      return detail.trim();\n    }\n\n    if (typeof detail !== 'object') {\n      return '';\n    }\n\n    const parts = [];\n    if (typeof detail.status === 'number' && Number.isFinite(detail.status)) {\n      parts.push(`HTTP ${detail.status} `);\n    }\n    if (typeof detail.statusText === 'string' && detail.statusText.trim()) {\n      parts.push(detail.statusText.trim());\n    }\n    if (typeof detail.message === 'string' && detail.message.trim()) {\n      parts.push(detail.message.trim());\n    }\n    if (typeof detail.error === 'string' && detail.error.trim()) {\n      parts.push(detail.error.trim());\n    }\n    if (!parts.length && detail.error && typeof detail.error === 'object') {\n      const nested = describeConnectivityDetail(detail.error);\n      if (nested) {\n        parts.push(nested);\n      }\n    }\n    if (!parts.length && detail.reason && typeof detail.reason === 'string') {\n      parts.push(detail.reason.trim());\n    }\n    return parts.join(' ').trim();\n  };\n\n  const updateReloadButtonState = (status, offlineNotice) => {\n    if (!reloadButton) {\n      return;\n    }\n\n    const noticeText = typeof offlineNotice === 'string' && offlineNotice.trim()\n      ? offlineNotice.trim()\n      : resolveOfflineNotice();\n\n    if (reloadButton.dataset) {\n      if (!reloadButton.dataset.onlineTitle || !reloadButton.dataset.onlineTitle.trim()) {\n        const currentTitle = reloadButton.getAttribute('title');\n        if (typeof currentTitle === 'string' && currentTitle.trim()) {\n          reloadButton.dataset.onlineTitle = currentTitle.trim();\n        } else {\n          reloadButton.dataset.onlineTitle = 'Force reload';\n        }\n      }\n\n      if (!reloadButton.dataset.onlineHelp || !reloadButton.dataset.onlineHelp.trim()) {\n        const currentHelp = reloadButton.getAttribute('data-help');\n        if (typeof currentHelp === 'string' && currentHelp.trim()) {\n          reloadButton.dataset.onlineHelp = currentHelp.trim();\n        } else {\n          reloadButton.dataset.onlineHelp = reloadButton.dataset.onlineTitle;\n        }\n      }\n\n      if (!reloadButton.dataset.onlineAriaLabel || !reloadButton.dataset.onlineAriaLabel.trim()) {\n        const ariaLabel = reloadButton.getAttribute('aria-label');\n        if (typeof ariaLabel === 'string' && ariaLabel.trim()) {\n          reloadButton.dataset.onlineAriaLabel = ariaLabel.trim();\n        } else {\n          reloadButton.dataset.onlineAriaLabel = reloadButton.dataset.onlineTitle;\n        }\n      }\n\n      if (!reloadButton.dataset.offlineNotice || !reloadButton.dataset.offlineNotice.trim()) {\n        reloadButton.dataset.offlineNotice = noticeText;\n      }\n    }\n\n    if (status === 'online') {\n      reloadButton.removeAttribute('disabled');\n      reloadButton.removeAttribute('aria-disabled');\n      const title = reloadButton.dataset?.onlineTitle || 'Force reload';\n      const help = reloadButton.dataset?.onlineHelp || title;\n      reloadButton.setAttribute('title', title);\n      reloadButton.setAttribute('data-help', help);\n      const ariaLabel = reloadButton.dataset?.onlineAriaLabel || title;\n      reloadButton.setAttribute('aria-label', ariaLabel);\n    } else {\n      reloadButton.setAttribute('disabled', 'disabled');\n      reloadButton.setAttribute('aria-disabled', 'true');\n      reloadButton.setAttribute('title', noticeText);\n      reloadButton.setAttribute('data-help', noticeText);\n      reloadButton.setAttribute('aria-label', noticeText);\n      if (reloadButton.dataset) {\n        reloadButton.dataset.offlineNotice = noticeText;\n        reloadButton.dataset.degradedNotice = noticeText;\n      }\n    }\n  };\n\n  const sanitizeConnectivityState = (state) => {\n    if (!state || typeof state !== 'object') {\n      return null;\n    }\n\n    const status = typeof state.status === 'string' && state.status ? state.status : 'unknown';\n    const reason = typeof state.reason === 'string' && state.reason ? state.reason : null;\n    const timestamp = typeof state.timestamp === 'number' && Number.isFinite(state.timestamp)\n      ? state.timestamp\n      : Date.now();\n    let detail = null;\n    if (state.detail && typeof state.detail === 'object') {\n      detail = state.detail;\n    } else if (typeof state.detail === 'string' && state.detail.trim()) {\n      detail = state.detail.trim();\n    }\n\n    return { status, reason, detail, timestamp };\n  };\n\n  const refreshOfflineIndicator = () => {\n    const navigatorOnline = getNavigatorOnline();\n    let effectiveStatus = navigatorOnline ? 'online' : 'offline';\n    let effectiveReason = navigatorOnline ? null : 'navigator-offline';\n    let effectiveDetail = null;\n    let effectiveTimestamp = null;\n\n    if (lastConnectivityState) {\n      const stateStatus = lastConnectivityState.status;\n      if (stateStatus === 'offline') {\n        effectiveStatus = 'offline';\n        effectiveReason = lastConnectivityState.reason || effectiveReason || 'offline';\n        effectiveDetail = lastConnectivityState.detail || null;\n        effectiveTimestamp = lastConnectivityState.timestamp || null;\n      } else if (stateStatus === 'degraded' && effectiveStatus !== 'offline') {\n        effectiveStatus = 'degraded';\n        effectiveReason = lastConnectivityState.reason || 'unknown';\n        effectiveDetail = lastConnectivityState.detail || null;\n        effectiveTimestamp = lastConnectivityState.timestamp || null;\n      } else if (stateStatus === 'online' && navigatorOnline) {\n        effectiveStatus = 'online';\n        effectiveReason = lastConnectivityState.reason || null;\n        effectiveDetail = lastConnectivityState.detail || null;\n        effectiveTimestamp = lastConnectivityState.timestamp || null;\n      }\n    }\n\n    if (offlineIndicator.dataset) {\n      offlineIndicator.dataset.connectivityStatus = effectiveStatus;\n      if (effectiveReason) {\n        offlineIndicator.dataset.connectivityReason = effectiveReason;\n      } else if (offlineIndicator.dataset.connectivityReason) {\n        delete offlineIndicator.dataset.connectivityReason;\n      }\n      if (effectiveTimestamp) {\n        offlineIndicator.dataset.connectivityTimestamp = String(effectiveTimestamp);\n      } else if (offlineIndicator.dataset.connectivityTimestamp) {\n        delete offlineIndicator.dataset.connectivityTimestamp;\n      }\n    }\n\n    if (effectiveStatus === 'online') {\n      const baseLabel = getBaseLabel();\n      const baseHelp = getBaseHelp();\n      if (typeof offlineIndicator.textContent === 'string' || typeof offlineIndicator.textContent === 'object') {\n        offlineIndicator.textContent = baseLabel;\n      }\n      offlineIndicator.setAttribute('data-help', baseHelp);\n      offlineIndicator.setAttribute('role', 'status');\n      offlineIndicator.setAttribute('aria-live', 'polite');\n      if (!offlineIndicator.hasAttribute('hidden')) {\n        offlineIndicator.setAttribute('hidden', '');\n      }\n      updateReloadButtonState('online', resolveOfflineNotice());\n    } else if (effectiveStatus === 'offline') {\n      const offlineNotice = resolveOfflineNotice();\n      if (offlineIndicator.dataset) {\n        offlineIndicator.dataset.forceReloadNotice = offlineNotice;\n        offlineIndicator.dataset.reloadNotice = offlineNotice;\n      }\n      if (typeof offlineIndicator.textContent === 'string' || typeof offlineIndicator.textContent === 'object') {\n        offlineIndicator.textContent = offlineNotice;\n      }\n      offlineIndicator.setAttribute('data-help', offlineNotice);\n      offlineIndicator.setAttribute('role', 'status');\n      offlineIndicator.setAttribute('aria-live', 'polite');\n      offlineIndicator.removeAttribute('hidden');\n      updateReloadButtonState('offline', offlineNotice);\n    } else {\n      const degradedLabel = getDegradedLabel();\n      const reasonText = resolveReasonText(effectiveReason);\n      const detailText = describeConnectivityDetail(effectiveDetail);\n      const summaryParts = [];\n      if (reasonText) summaryParts.push(reasonText);\n      if (detailText && detailText !== reasonText) summaryParts.push(detailText);\n      const summary = summaryParts.join(' ').trim();\n      const displayText = summary ? `${degradedLabel}  ${summary} ` : degradedLabel;\n      const degradedHelp = getDegradedHelp();\n      const helpParts = [];\n      if (summary) {\n        helpParts.push(summary);\n      }\n      if (degradedHelp && (!summary || degradedHelp.indexOf(summary) === -1)) {\n        helpParts.push(degradedHelp);\n      }\n      const helpText = helpParts.join(' ').trim() || degradedHelp || displayText;\n\n      if (offlineIndicator.dataset) {\n        offlineIndicator.dataset.forceReloadNotice = displayText;\n        offlineIndicator.dataset.reloadNotice = displayText;\n      }\n\n      if (typeof offlineIndicator.textContent === 'string' || typeof offlineIndicator.textContent === 'object') {\n        offlineIndicator.textContent = displayText;\n      }\n      offlineIndicator.setAttribute('data-help', helpText);\n      offlineIndicator.setAttribute('role', 'status');\n      offlineIndicator.setAttribute('aria-live', 'polite');\n      offlineIndicator.removeAttribute('hidden');\n      updateReloadButtonState('degraded', displayText);\n    }\n\n    if (typeof updateInstallBannerPosition === 'function') {\n      updateInstallBannerPosition();\n    }\n  };\n\n  const applyConnectivityState = (state) => {\n    const sanitized = sanitizeConnectivityState(state);\n    if (!sanitized) {\n      return;\n    }\n\n    if (\n      lastConnectivityState &&\n      lastConnectivityState.status === sanitized.status &&\n      lastConnectivityState.reason === sanitized.reason &&\n      lastConnectivityState.timestamp === sanitized.timestamp\n    ) {\n      return;\n    }\n\n    lastConnectivityState = sanitized;\n    refreshOfflineIndicator();\n    if (typeof callCoreFunctionIfAvailable === 'function') {\n      callCoreFunctionIfAvailable('updateStorageSummary', [], { defer: true });\n    }\n  };\n\n  const handleConnectivityBroadcast = (event) => {\n    if (!event) {\n      return;\n    }\n\n    let data = null;\n    try {\n      data = event.data || null;\n    } catch (error) {\n      void error;\n      data = null;\n    }\n\n    if (!data || typeof data !== 'object') {\n      return;\n    }\n\n    if (data.type === CONNECTIVITY_STATUS_MESSAGE_TYPE) {\n      const state = data.state && typeof data.state === 'object' ? data.state : null;\n      if (state) {\n        applyConnectivityState(state);\n      }\n    }\n  };\n\n  const ensureConnectivityBroadcast = () => {\n    if (connectivityChannel || connectivityChannelFailed) {\n      return;\n    }\n\n    if (typeof BroadcastChannel !== 'function') {\n      connectivityChannelFailed = true;\n      return;\n    }\n\n    try {\n      connectivityChannel = new BroadcastChannel(SERVICE_WORKER_LOG_CHANNEL);\n      connectivityChannel.addEventListener('message', handleConnectivityBroadcast);\n    } catch (error) {\n      connectivityChannelFailed = true;\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('setupOfflineIndicator: Unable to listen for connectivity updates', error);\n      }\n    }\n  };\n\n  const resolveOfflineModule = () => {\n    try {\n      if (typeof cineOffline !== 'undefined' && cineOffline) {\n        return cineOffline;\n      }\n    } catch (error) {\n      void error;\n    }\n\n    const candidates = [\n      typeof globalThis !== 'undefined' ? globalThis : null,\n      typeof window !== 'undefined' ? window : null,\n      typeof self !== 'undefined' ? self : null,\n      typeof global !== 'undefined' ? global : null,\n    ];\n\n    for (let index = 0; index < candidates.length; index += 1) {\n      const candidate = candidates[index];\n      if (candidate && typeof candidate.cineOffline === 'object') {\n        return candidate.cineOffline;\n      }\n    }\n\n    return null;\n  };\n\n  const offlineModule = resolveOfflineModule();\n\n  if (offlineModule && typeof offlineModule.subscribeConnectivityStatus === 'function') {\n    try {\n      unsubscribeConnectivity = offlineModule.subscribeConnectivityStatus(applyConnectivityState);\n    } catch (error) {\n      void error;\n      unsubscribeConnectivity = null;\n    }\n  }\n\n  const initialState = offlineModule && typeof offlineModule.getConnectivityState === 'function'\n    ? offlineModule.getConnectivityState()\n    : (typeof window !== 'undefined' && window && typeof window.cineConnectivityStatus === 'object'\n      ? window.cineConnectivityStatus\n      : null);\n\n  if (initialState) {\n    applyConnectivityState(initialState);\n  }\n\n  ensureConnectivityBroadcast();\n\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.addEventListener === 'function'\n  ) {\n    window.addEventListener('online', refreshOfflineIndicator);\n    window.addEventListener('offline', refreshOfflineIndicator);\n  }\n\n  refreshOfflineIndicator();\n\n  return unsubscribeConnectivity;\n}\n\nif (typeof window !== 'undefined') {\n  setupOfflineIndicator();\n}\n\n/**\n * Close the sidebar menu if it is open.\n */\nfunction closeSideMenu() {\n  const menu = document.getElementById('sideMenu');\n  const overlay = document.getElementById('menuOverlay');\n  const toggle = document.getElementById('menuToggle');\n  const body = typeof document !== 'undefined' ? document.body : null;\n  if (!menu || !overlay || !toggle) return;\n  menu.classList.remove('open');\n  menu.setAttribute('hidden', '');\n  toggle.setAttribute('aria-expanded', 'false');\n  if (body) body.classList.remove('menu-open');\n  toggle.focus();\n}\nif (typeof window !== 'undefined') window.closeSideMenu = closeSideMenu;\n\n\n/**\n * Open the sidebar menu if it is currently closed.\n */\nfunction openSideMenu() {\n  const menu = document.getElementById('sideMenu');\n  const overlay = document.getElementById('menuOverlay');\n  const toggle = document.getElementById('menuToggle');\n  const closeButton = document.getElementById('closeMenuButton');\n  const body = typeof document !== 'undefined' ? document.body : null;\n  if (!menu || !overlay || !toggle) return;\n  if (menu.classList.contains('open')) return;\n  menu.classList.add('open');\n  menu.removeAttribute('hidden');\n  toggle.setAttribute('aria-expanded', 'true');\n  const closeLabel =\n    toggle.dataset?.closeLabel ||\n    closeButton?.getAttribute('aria-label') ||\n    'Close menu';\n  const closeHelp =\n    toggle.dataset?.closeHelp ||\n    closeButton?.getAttribute('data-help') ||\n    closeLabel;\n  toggle.setAttribute('aria-label', closeLabel);\n  toggle.setAttribute('data-help', closeHelp);\n  body?.classList.add('menu-open');\n}\nif (typeof window !== 'undefined') window.openSideMenu = openSideMenu;\n\n/**\n * Initialize sidebar menu toggle.\n */\nfunction setupSideMenu() {\n  const toggle = document.getElementById('menuToggle');\n  const menu = document.getElementById('sideMenu');\n  const overlay = document.getElementById('menuOverlay');\n  const closeButton = document.getElementById('closeMenuButton');\n\n  if (!toggle || !menu || !overlay) {\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', setupSideMenu);\n    }\n    return;\n  }\n\n  // Prevent double binding\n  if (toggle.dataset.menuInitialized) return;\n  toggle.dataset.menuInitialized = 'true';\n  const originalDisplay = overlay.style.display;\n\n  toggle.addEventListener('click', () => {\n    if (menu.classList.contains('open')) {\n      closeSideMenu();\n    } else {\n      openSideMenu();\n    }\n  });\n\n  overlay.addEventListener('click', closeSideMenu);\n  closeButton?.addEventListener('click', () => {\n    closeSideMenu();\n    toggle.focus();\n  });\n  if (typeof window !== 'undefined' && typeof window.matchMedia === 'function') {\n    const mobileQuery = window.matchMedia('(max-width: 768px)');\n    mobileQuery.addEventListener('change', event => {\n      if (!event.matches && menu.classList.contains('open')) {\n        closeSideMenu();\n      }\n    });\n  }\n  document.addEventListener('keydown', event => {\n    if (event.key === 'Escape' && menu.classList.contains('open')) {\n      closeSideMenu();\n      toggle.focus();\n    }\n  });\n  menu.querySelectorAll('a').forEach(link => {\n    link.addEventListener('click', event => {\n      const hash = link.getAttribute('href');\n      if (hash && hash.startsWith('#')) {\n        event.preventDefault();\n        document.querySelector(hash)?.scrollIntoView();\n        history.replaceState(null, '', window.location.pathname + window.location.search);\n      }\n      closeSideMenu();\n    });\n  });\n\n  const triggerSidebarAction = action => {\n    if (!action) return;\n    if (action === 'open-settings') {\n      document.getElementById('settingsButton')?.click();\n    } else if (action === 'open-help') {\n      document.getElementById('helpButton')?.click();\n    } else if (action === 'open-own-gear') {\n      if (typeof openOwnGearDialog === 'function') {\n        openOwnGearDialog();\n      }\n    } else if (action === 'open-contacts') {\n      initializeContactsModule();\n      openDialog(contactsDialog);\n    }\n  };\n\n  menu.querySelectorAll('[data-sidebar-action]').forEach(button => {\n    button.addEventListener('click', event => {\n      event.preventDefault();\n      triggerSidebarAction(button.dataset.sidebarAction);\n    });\n  });\n}\nif (typeof window !== 'undefined') window.setupSideMenu = setupSideMenu;\n\nfunction setupResponsiveControls() {\n  const topBar = document.getElementById('topBar');\n  const featureSearch = topBar?.querySelector('.feature-search');\n  const controls = topBar?.querySelector('.controls');\n  const sidebarControls = document.querySelector('#sideMenu .sidebar-controls');\n  if (\n    !topBar ||\n    !featureSearch ||\n    !controls ||\n    !sidebarControls ||\n    typeof window.matchMedia !== 'function'\n  ) {\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', setupResponsiveControls);\n    }\n    return;\n  }\n\n  if (topBar.dataset.responsiveInitialized) return;\n  topBar.dataset.responsiveInitialized = 'true';\n\n  const mql = window.matchMedia('(max-width: 768px)');\n\n  const relocate = () => {\n    if (mql.matches) {\n      sidebarControls.appendChild(featureSearch);\n      sidebarControls.appendChild(controls);\n    } else {\n      topBar.appendChild(featureSearch);\n      topBar.appendChild(controls);\n    }\n  };\n\n  mql.addEventListener('change', relocate);\n  relocate();\n}\nif (typeof window !== 'undefined') window.setupResponsiveControls = setupResponsiveControls;\n\nvar OWN_GEAR_SOURCE_CATALOG = 'catalog';\nvar OWN_GEAR_SOURCE_CUSTOM = 'custom';\n\nlet ownGearStoreModuleCache = null;\nlet ownGearStoreInstance = null;\nlet ownGearViewModuleCache = null;\nlet ownGearViewInstance = null;\nlet fallbackAutoGearCache = {\n  items: [],\n  map: new Map(),\n};\n\nfunction detectOwnGearGlobalScope() {\n  if (typeof CORE_GLOBAL_SCOPE === 'object' && CORE_GLOBAL_SCOPE) {\n    return CORE_GLOBAL_SCOPE;\n  }\n  if (typeof globalThis !== 'undefined') {\n    return globalThis;\n  }\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n  return null;\n}\n\nfunction resolveOwnGearStoreModule() {\n  if (ownGearStoreModuleCache) {\n    return ownGearStoreModuleCache;\n  }\n  if (typeof require === 'function') {\n    try {\n      const required = require('./own-gear/store.js');\n      if (required && typeof required.createOwnGearStore === 'function') {\n        ownGearStoreModuleCache = required;\n        return ownGearStoreModuleCache;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n  const scope = detectOwnGearGlobalScope();\n  if (scope && typeof scope.cineOwnGearStore === 'object' && scope.cineOwnGearStore) {\n    ownGearStoreModuleCache = scope.cineOwnGearStore;\n    return ownGearStoreModuleCache;\n  }\n  if (typeof cineOwnGearStore === 'object' && cineOwnGearStore) {\n    ownGearStoreModuleCache = cineOwnGearStore;\n    return ownGearStoreModuleCache;\n  }\n  return null;\n}\n\nfunction getOwnGearStore() {\n  if (ownGearStoreInstance) {\n    return ownGearStoreInstance;\n  }\n  const storeModule = resolveOwnGearStoreModule();\n  if (storeModule && typeof storeModule.createOwnGearStore === 'function') {\n    try {\n      ownGearStoreInstance = storeModule.createOwnGearStore();\n      return ownGearStoreInstance;\n    } catch (error) {\n      void error;\n    }\n  }\n  return null;\n}\n\nfunction resolveOwnGearViewModule() {\n  if (ownGearViewModuleCache) {\n    return ownGearViewModuleCache;\n  }\n  if (typeof require === 'function') {\n    try {\n      const required = require('./own-gear/view.js');\n      if (required && typeof required.createOwnGearView === 'function') {\n        ownGearViewModuleCache = required;\n        return ownGearViewModuleCache;\n      }\n    } catch (error) {\n      void error;\n    }\n  }\n  const scope = detectOwnGearGlobalScope();\n  if (scope && typeof scope.cineOwnGearView === 'object' && scope.cineOwnGearView) {\n    ownGearViewModuleCache = scope.cineOwnGearView;\n    return ownGearViewModuleCache;\n  }\n  if (typeof cineOwnGearView === 'object' && cineOwnGearView) {\n    ownGearViewModuleCache = cineOwnGearView;\n    return ownGearViewModuleCache;\n  }\n  return null;\n}\n\nfunction resolveOwnGearViewOptions() {\n  const scope = detectOwnGearGlobalScope() || {};\n  return {\n    scope,\n    document: typeof document !== 'undefined' ? document : null,\n    getLanguageTexts,\n    defaultLanguage: DEFAULT_LANGUAGE_SAFE,\n    getCurrentLanguage: () => currentLang,\n    formatWithPlaceholders: formatWithPlaceholdersSafe,\n    setButtonLabelWithIconBinding,\n    iconMarkup,\n    iconGlyphs: ICON_GLYPHS,\n    openDialog,\n    closeDialog,\n    formatQuantityText: formatOwnGearQuantityText,\n    devices,\n    gearItemTranslations,\n    looksLikeGearName,\n  };\n}\n\nfunction getOwnGearView() {\n  if (ownGearViewInstance) {\n    return ownGearViewInstance;\n  }\n  const viewModule = resolveOwnGearViewModule();\n  const store = getOwnGearStore();\n  if (!viewModule || typeof viewModule.createOwnGearView !== 'function' || !store) {\n    return null;\n  }\n  try {\n    ownGearViewInstance = viewModule.createOwnGearView(store, resolveOwnGearViewOptions());\n    return ownGearViewInstance;\n  } catch (error) {\n    void error;\n  }\n  return null;\n}\n\nfunction invalidateAutoGearOwnGearCache() {\n  const store = getOwnGearStore();\n  if (store && typeof store.invalidateCache === 'function') {\n    try {\n      store.invalidateCache();\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n  fallbackAutoGearCache = {\n    items: [],\n    map: new Map(),\n  };\n}\n\nfunction refreshAutoGearOwnGearCache() {\n  const store = getOwnGearStore();\n  if (store && typeof store.refreshCache === 'function') {\n    try {\n      const snapshot = store.refreshCache();\n      return {\n        items: Array.isArray(snapshot.items) ? snapshot.items.slice() : [],\n        map: snapshot.map instanceof Map ? snapshot.map : new Map(),\n      };\n    } catch (error) {\n      void error;\n    }\n  }\n  const moduleApi = resolveOwnGearModule();\n  let items = [];\n  if (moduleApi && typeof moduleApi.loadStoredOwnGearItems === 'function') {\n    try {\n      items = moduleApi.loadStoredOwnGearItems();\n    } catch (error) {\n      console.warn('Unable to load own gear items for automatic gear rules via module.', error);\n    }\n  }\n  if (!Array.isArray(items) || !items.length) {\n    items = loadStoredOwnGearItems();\n  }\n  const normalized = Array.isArray(items)\n    ? items\n      .map(normalizeOwnGearRecord)\n      .filter(Boolean)\n    : [];\n  const map = new Map();\n  normalized.forEach(item => {\n    if (!item || !item.id) return;\n    map.set(item.id, item);\n  });\n  fallbackAutoGearCache = {\n    items: normalized,\n    map,\n  };\n  return fallbackAutoGearCache;\n}\n\nfunction getAutoGearOwnGearCache() {\n  const store = getOwnGearStore();\n  if (store && typeof store.getCacheSnapshot === 'function') {\n    try {\n      const snapshot = store.getCacheSnapshot();\n      return {\n        items: Array.isArray(snapshot.items) ? snapshot.items.slice() : [],\n        map: snapshot.map instanceof Map ? snapshot.map : new Map(),\n      };\n    } catch (error) {\n      void error;\n    }\n  }\n  if (fallbackAutoGearCache && Array.isArray(fallbackAutoGearCache.items) && fallbackAutoGearCache.items.length) {\n    return fallbackAutoGearCache;\n  }\n  return refreshAutoGearOwnGearCache();\n}\n\nfunction getAutoGearOwnGearItems() {\n  return getAutoGearOwnGearCache().items.slice();\n}\n\nfunction findAutoGearOwnGearById(id) {\n  if (!id) return null;\n  const store = getOwnGearStore();\n  if (store && typeof store.findCachedById === 'function') {\n    try {\n      return store.findCachedById(id);\n    } catch (error) {\n      void error;\n    }\n  }\n  const cache = getAutoGearOwnGearCache();\n  return cache.map.get(id) || null;\n}\n\nfunction generateOwnGearId() {\n  const store = getOwnGearStore();\n  if (store && typeof store.generateOwnGearId === 'function') {\n    try {\n      return store.generateOwnGearId();\n    } catch (error) {\n      void error;\n    }\n  }\n  const moduleApi = resolveOwnGearModule();\n  if (moduleApi && typeof moduleApi.generateOwnGearId === 'function') {\n    try {\n      return moduleApi.generateOwnGearId();\n    } catch (error) {\n      console.warn('Unable to generate own gear id via module.', error);\n    }\n  }\n  if (\n    typeof crypto !== 'undefined'\n    && crypto\n    && typeof crypto.randomUUID === 'function'\n  ) {\n    try {\n      return crypto.randomUUID();\n    } catch (error) {\n      void error;\n    }\n  }\n  const timePart = Date.now().toString(36);\n  const randomPart = Math.floor(Math.random() * 1e8).toString(36);\n  return `own - ${timePart} -${randomPart} `;\n}\n\nfunction normalizeOwnGearRecord(entry) {\n  const store = getOwnGearStore();\n  if (store && typeof store.normalizeOwnGearRecord === 'function') {\n    try {\n      return store.normalizeOwnGearRecord(entry);\n    } catch (error) {\n      void error;\n    }\n  }\n  const moduleApi = resolveOwnGearModule();\n  if (moduleApi && typeof moduleApi.normalizeOwnGearRecord === 'function') {\n    try {\n      return moduleApi.normalizeOwnGearRecord(entry);\n    } catch (error) {\n      console.warn('Unable to normalize own gear entry via module.', error);\n    }\n  }\n  if (!entry || typeof entry !== 'object') {\n    return null;\n  }\n  const rawName = typeof entry.name === 'string' ? entry.name.trim() : '';\n  if (!rawName) {\n    return null;\n  }\n  const normalized = {\n    id: typeof entry.id === 'string' && entry.id.trim() ? entry.id.trim() : generateOwnGearId(),\n    name: rawName,\n  };\n  if (typeof entry.quantity === 'string' && entry.quantity.trim()) {\n    normalized.quantity = entry.quantity.trim();\n  } else if (typeof entry.quantity === 'number' && Number.isFinite(entry.quantity)) {\n    normalized.quantity = String(entry.quantity);\n  }\n  if (typeof entry.notes === 'string' && entry.notes.trim()) {\n    normalized.notes = entry.notes.trim();\n  }\n  if (typeof entry.source === 'string' && entry.source.trim()) {\n    normalized.source = entry.source.trim();\n  }\n  return normalized;\n}\n\nfunction loadStoredOwnGearItems() {\n  const store = getOwnGearStore();\n  if (store && typeof store.loadStoredOwnGearItems === 'function') {\n    try {\n      return store.loadStoredOwnGearItems();\n    } catch (error) {\n      void error;\n    }\n  }\n  const moduleApi = resolveOwnGearModule();\n  if (moduleApi && typeof moduleApi.loadStoredOwnGearItems === 'function') {\n    try {\n      return moduleApi.loadStoredOwnGearItems();\n    } catch (error) {\n      console.warn('Unable to load own gear items via module.', error);\n    }\n  }\n  if (typeof loadOwnGear !== 'function') {\n    return [];\n  }\n  try {\n    const stored = loadOwnGear();\n    if (!Array.isArray(stored)) {\n      return [];\n    }\n    const seenIds = new Set();\n    return stored\n      .map(normalizeOwnGearRecord)\n      .filter((item) => {\n        if (!item) return false;\n        if (seenIds.has(item.id)) {\n          return false;\n        }\n        seenIds.add(item.id);\n        return true;\n      });\n  } catch (error) {\n    console.warn('Failed to load own gear items from storage', error);\n    return [];\n  }\n}\n\nfunction persistOwnGearItems(items = []) {\n  const store = getOwnGearStore();\n  if (store && typeof store.persistOwnGearItems === 'function') {\n    try {\n      return store.persistOwnGearItems(items);\n    } catch (error) {\n      void error;\n    }\n  }\n  const moduleApi = resolveOwnGearModule();\n  if (moduleApi && typeof moduleApi.persistOwnGearItems === 'function') {\n    try {\n      moduleApi.persistOwnGearItems(items);\n      return true;\n    } catch (error) {\n      console.warn('Unable to persist own gear items via module.', error);\n    }\n  }\n  if (typeof saveOwnGear !== 'function') {\n    return false;\n  }\n  const payload = items.map((item) => {\n    const entry = {\n      id: item.id,\n      name: item.name,\n    };\n    if (item.quantity) {\n      entry.quantity = item.quantity;\n    }\n    if (item.notes) {\n      entry.notes = item.notes;\n    }\n    if (item.source) {\n      entry.source = item.source;\n    }\n    return entry;\n  });\n  try {\n    saveOwnGear(payload);\n    if (typeof document !== 'undefined' && typeof CustomEvent === 'function') {\n      document.dispatchEvent(new CustomEvent('own-gear-data-changed'));\n    }\n    return true;\n  } catch (error) {\n    console.warn('Failed to save own gear items', error);\n  }\n  return false;\n}\n\nfunction formatOwnGearQuantityText(quantity) {\n  if (typeof quantity !== 'string') {\n    return '';\n  }\n  const trimmed = quantity.trim();\n  if (!trimmed) {\n    return '';\n  }\n  const numeric = Number(trimmed.replace(',', '.'));\n  if (!Number.isNaN(numeric) && Number.isFinite(numeric)) {\n    const fixed = Math.round(numeric * 1000) / 1000;\n    return String(fixed).replace(/\\.0+$/, '').replace(/(\\.\\d*?)0+$/, '$1');\n  }\n  return trimmed;\n}\n\nfunction openOwnGearDialog() {\n  const view = getOwnGearView();\n  if (view && typeof view.openDialog === 'function') {\n    try {\n      view.openDialog();\n    } catch (error) {\n      void error;\n    }\n  }\n}\n\nfunction applyOwnGearLocalization(lang) {\n  const view = getOwnGearView();\n  if (view && typeof view.applyLocalization === 'function') {\n    try {\n      view.applyLocalization(lang);\n    } catch (error) {\n      void error;\n    }\n  }\n}\nfunction initializeLayoutControls() {\n  setupSideMenu();\n  setupResponsiveControls();\n}\n\nfunction initializeOwnGearManager() {\n  const view = getOwnGearView();\n  if (!view) {\n    return;\n  }\n  try {\n    view.initialize();\n  } catch (error) {\n    void error;\n  }\n  try {\n    exposeCoreRuntimeConstant('openOwnGearDialog', openOwnGearDialog);\n  } catch (error) {\n    void error;\n    const scope = detectOwnGearGlobalScope();\n    if (scope) {\n      scope.openOwnGearDialog = openOwnGearDialog;\n    }\n  }\n}\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  var runLayoutInitialization = () => {\n    initializeLayoutControls();\n    initializeOwnGearManager();\n    initializeContactsModule();\n  };\n\n  var scheduleLayoutInitialization = () => {\n    const invoke = () => {\n      if (typeof window !== 'undefined' && typeof window.setTimeout === 'function') {\n        window.setTimeout(runLayoutInitialization, 0);\n      } else {\n        runLayoutInitialization();\n      }\n    };\n\n    if (document.readyState === 'loading') {\n      document.addEventListener('DOMContentLoaded', invoke, { once: true });\n    } else {\n      invoke();\n    }\n  };\n\n\n}\n\n// Use a Set for O(1) lookups when validating video output types\nconst VIDEO_OUTPUT_TYPES = new Set([\n  '3G-SDI',\n  '6G-SDI',\n  '12G-SDI',\n  'Mini BNC',\n  'HDMI',\n  'Mini HDMI',\n  'Micro HDMI',\n  'DisplayPort'\n]);\n\nconst CORE_NORMALIZED_FLAG_KEY = '__normalized';\n\nvar DEFAULT_FILTER_SIZE = '4x5.65';\nconst CORE_AUTO_BACKUP_NAMESPACE = (() => {\n  if (typeof require === 'function') {\n    try {\n      return require('./app-core-auto-backup.js');\n    } catch (autoBackupRequireError) {\n      void autoBackupRequireError;\n    }\n  }\n\n  let loaderNamespace = null;\n  if (typeof fallbackRequireCoreRuntimeModule === 'function') {\n    loaderNamespace = fallbackRequireCoreRuntimeModule('./app-core-auto-backup.js');\n  } else if (\n    typeof cineRuntimeBootstrapExports === 'object' &&\n    cineRuntimeBootstrapExports &&\n    typeof cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule === 'function'\n  ) {\n    loaderNamespace = cineRuntimeBootstrapExports.fallbackRequireCoreRuntimeModule('./app-core-auto-backup.js');\n  } else {\n    // Last ditch attempt to find it on global scope\n    const globalScope =\n      (typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null) ||\n      (typeof globalThis !== 'undefined' ? globalThis : null) ||\n      (typeof window !== 'undefined' ? window : null) ||\n      (typeof self !== 'undefined' ? self : null) ||\n      (typeof global !== 'undefined' ? global : null);\n\n    if (globalScope && typeof globalScope.fallbackRequireCoreRuntimeModule === 'function') {\n      loaderNamespace = globalScope.fallbackRequireCoreRuntimeModule('./app-core-auto-backup.js');\n    }\n  }\n\n  if (loaderNamespace && typeof loaderNamespace === 'object') {\n    return loaderNamespace;\n  }\n\n  const candidateScopes = [\n    typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null,\n    typeof globalThis !== 'undefined' ? globalThis : null,\n    typeof window !== 'undefined' ? window : null,\n    typeof self !== 'undefined' ? self : null,\n    typeof global !== 'undefined' ? global : null,\n  ];\n\n  for (let index = 0; index < candidateScopes.length; index += 1) {\n    const scope = candidateScopes[index];\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      continue;\n    }\n\n    try {\n      if (scope.CORE_AUTO_BACKUP && typeof scope.CORE_AUTO_BACKUP === 'object') {\n        return scope.CORE_AUTO_BACKUP;\n      }\n    } catch (lookupError) {\n      void lookupError;\n    }\n  }\n\n  return null;\n})();\n\nconst AUTO_BACKUP_NAME_PREFIX =\n  CORE_AUTO_BACKUP_NAMESPACE && typeof CORE_AUTO_BACKUP_NAMESPACE.AUTO_BACKUP_NAME_PREFIX === 'string'\n    ? CORE_AUTO_BACKUP_NAMESPACE.AUTO_BACKUP_NAME_PREFIX\n    : 'auto-backup-';\nconst AUTO_BACKUP_DELETION_PREFIX =\n  CORE_AUTO_BACKUP_NAMESPACE && typeof CORE_AUTO_BACKUP_NAMESPACE.AUTO_BACKUP_DELETION_PREFIX === 'string'\n    ? CORE_AUTO_BACKUP_NAMESPACE.AUTO_BACKUP_DELETION_PREFIX\n    : 'auto-backup-before-delete-';\n\nvar localLogAutoBackupEvent =\n  CORE_AUTO_BACKUP_NAMESPACE && typeof CORE_AUTO_BACKUP_NAMESPACE.logAutoBackupEvent === 'function'\n    ? CORE_AUTO_BACKUP_NAMESPACE.logAutoBackupEvent\n    : function fallbackLogAutoBackupEvent(level, message, detail, meta) {\n      const normalizedLevel = typeof level === 'string' && level ? level.toLowerCase() : 'info';\n      const normalizedMessage = typeof message === 'string' && message ? message : 'Auto backup event';\n\n      if (typeof console === 'undefined' || !console) {\n        return;\n      }\n\n      let fallback = null;\n      if (normalizedLevel === 'error' && typeof console.error === 'function') {\n        fallback = console.error;\n      } else if (normalizedLevel === 'warn' && typeof console.warn === 'function') {\n        fallback = console.warn;\n      } else if (normalizedLevel === 'info' && typeof console.info === 'function') {\n        fallback = console.info;\n      } else if (normalizedLevel === 'debug' && typeof console.debug === 'function') {\n        fallback = console.debug;\n      } else if (typeof console.log === 'function') {\n        fallback = console.log;\n      }\n\n      if (typeof fallback === 'function') {\n        try {\n          fallback.call(console, `[auto - backup] ${normalizedMessage} `, detail || null, meta || null);\n        } catch (fallbackError) {\n          void fallbackError;\n        }\n      }\n    };\n\nconst rawCloneProjectEntryForSetup =\n  CORE_AUTO_BACKUP_NAMESPACE && typeof CORE_AUTO_BACKUP_NAMESPACE.cloneProjectEntryForSetup === 'function'\n    ? CORE_AUTO_BACKUP_NAMESPACE.cloneProjectEntryForSetup\n    : null;\n\nconst rawEnsureAutoBackupsFromProjects =\n  CORE_AUTO_BACKUP_NAMESPACE && typeof CORE_AUTO_BACKUP_NAMESPACE.ensureAutoBackupsFromProjects === 'function'\n    ? CORE_AUTO_BACKUP_NAMESPACE.ensureAutoBackupsFromProjects\n    : null;\n\nvar showAutoBackups = false;\ntry {\n  if (typeof localStorage !== 'undefined') {\n    showAutoBackups = localStorage.getItem('showAutoBackups') === 'true';\n  }\n} catch (e) {\n  localLogAutoBackupEvent('warn', 'Could not load auto backup visibility preference', e);\n}\nfunction cloneProjectEntryForSetup(projectEntry) {\n  if (rawCloneProjectEntryForSetup) {\n    return rawCloneProjectEntryForSetup(projectEntry, {\n      deepClone: CORE_DEEP_CLONE,\n      log: localLogAutoBackupEvent,\n    });\n  }\n\n  if (!projectEntry || typeof projectEntry !== 'object') {\n    return {};\n  }\n\n  try {\n    return CORE_DEEP_CLONE(projectEntry);\n  } catch (cloneError) {\n    localLogAutoBackupEvent('warn', 'Fallback auto backup project clone failed', cloneError);\n    const snapshot = {};\n    for (const key in projectEntry) {\n      if (Object.prototype.hasOwnProperty.call(projectEntry, key)) {\n        snapshot[key] = projectEntry[key];\n      }\n    }\n    return snapshot;\n  }\n}\n\nfunction ensureAutoBackupsFromProjects() {\n  if (!rawEnsureAutoBackupsFromProjects) {\n    return false;\n  }\n\n  return rawEnsureAutoBackupsFromProjects({\n    loadProject: typeof loadProject === 'function' ? loadProject : null,\n    getSetups,\n    storeSetups,\n    log: localLogAutoBackupEvent,\n    cloneProjectEntry: (entry) => cloneProjectEntryForSetup(entry),\n    autoBackupNamePrefix: AUTO_BACKUP_NAME_PREFIX,\n    autoBackupDeletionPrefix: AUTO_BACKUP_DELETION_PREFIX,\n  });\n}\n\nif (showAutoBackups) {\n  try {\n    ensureAutoBackupsFromProjects();\n  } catch (error) {\n    localLogAutoBackupEvent('warn', 'Failed to prepare auto backups from project storage', error);\n  }\n}\n\n// Labels for B-Mount support are defined in translations.js using the keys\n// batteryBMountLabel, totalCurrent336Label and totalCurrent216Label.\n\nfunction getSetups() {\n  return loadSetups();\n}\n\nexposeCoreRuntimeConstant('getSetups', getSetups);\n\nfunction storeSetups(setups) {\n  saveSetups(setups);\n}\n\nexposeCoreRuntimeConstant('storeSetups', storeSetups);\n\nfunction storeDevices(deviceData) {\n  saveDeviceData(deviceData);\n}\n\n\n\nfunction loadSession() {\n  return typeof loadSessionState === 'function' ? loadSessionState() : null;\n}\n\nexposeCoreRuntimeConstant('loadSession', loadSession);\n\nfunction storeSession(state) {\n  if (typeof saveSessionState === 'function') {\n    saveSessionState(state);\n  }\n}\n\nexposeCoreRuntimeConstant('storeSession', storeSession);\n\n/**\n * Toggle a dialog element's visibility, gracefully handling browsers that do\n * not support the dialog `showModal` or `close` APIs. When those methods are\n * unavailable the function falls back to manipulating the `open` attribute\n * directly.\n *\n * @param {HTMLDialogElement} dialog - The dialog to operate on.\n * @param {boolean} shouldOpen - Whether the dialog should be opened or\n *   closed.\n */\nfunction toggleDialog(dialog, shouldOpen) {\n  if (!dialog) return;\n  if (shouldOpen) {\n    if (typeof dialog.showModal === 'function') {\n      dialog.showModal();\n    } else {\n      dialog.setAttribute('open', '');\n    }\n  } else if (typeof dialog.close === 'function') {\n    dialog.close();\n  } else {\n    dialog.removeAttribute('open');\n  }\n}\n\n/**\n * Open a dialog element, falling back to setting the `open` attribute when\n * the `showModal` method is unavailable.\n *\n * @param {HTMLDialogElement} dialog - The dialog to open.\n */\nfunction openDialog(dialog) {\n  toggleDialog(dialog, true);\n}\n\n/**\n * Close a dialog element, removing the `open` attribute if the `close`\n * method is not supported.\n *\n * @param {HTMLDialogElement} dialog - The dialog to close.\n */\nfunction closeDialog(dialog) {\n  toggleDialog(dialog, false);\n}\n\n/**\n * Determine whether a dialog element is currently open.\n *\n * @param {HTMLDialogElement} dialog - The dialog to inspect.\n * @returns {boolean} True if the dialog is open.\n */\nfunction isDialogOpen(dialog) {\n  if (!dialog) return false;\n  if (typeof dialog.open === 'boolean') {\n    if (dialog.open) {\n      return true;\n    }\n    if (typeof dialog.hasAttribute === 'function' && dialog.hasAttribute('open')) {\n      return true;\n    }\n    return false;\n  }\n  return typeof dialog.hasAttribute === 'function' && dialog.hasAttribute('open');\n}\n\n// normalizeDevicesForPersistence declaration moved to top of file to avoid TDZ\nexposeCoreRuntimeConstant('normalizeDevicesForPersistence', normalizeDevicesForPersistence);\n\n\n\n\nfunction resolveUpdateDevicesReferenceFunction() {\n  let directReference = null;\n  try {\n    directReference = typeof updateGlobalDevicesReference === 'function'\n      ? updateGlobalDevicesReference\n      : null;\n  } catch (referenceError) {\n    void referenceError;\n    directReference = null;\n  }\n\n  if (directReference) {\n    return directReference;\n  }\n\n  const candidates = [];\n  const registerCandidate = (scope) => {\n    if (!scope || (typeof scope !== 'object' && typeof scope !== 'function')) {\n      return;\n    }\n    if (candidates.indexOf(scope) !== -1) {\n      return;\n    }\n    candidates.push(scope);\n  };\n\n  try {\n    registerCandidate(typeof CORE_PART1_RUNTIME_SCOPE !== 'undefined' ? CORE_PART1_RUNTIME_SCOPE : null);\n  } catch (corePart1ScopeError) {\n    void corePart1ScopeError;\n  }\n\n  try {\n    registerCandidate(typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null);\n  } catch (coreGlobalScopeError) {\n    void coreGlobalScopeError;\n  }\n\n  try {\n    registerCandidate(typeof DEVICE_GLOBAL_SCOPE !== 'undefined' ? DEVICE_GLOBAL_SCOPE : null);\n  } catch (deviceScopeError) {\n    void deviceScopeError;\n  }\n\n  try {\n    registerCandidate(typeof CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE !== 'undefined' ? CORE_RUNTIME_PRIMARY_SCOPE_CANDIDATE : null);\n  } catch (runtimeCandidateError) {\n    void runtimeCandidateError;\n  }\n\n  registerCandidate(typeof globalThis !== 'undefined' ? globalThis : null);\n  registerCandidate(typeof window !== 'undefined' ? window : null);\n  registerCandidate(typeof self !== 'undefined' ? self : null);\n  registerCandidate(typeof global !== 'undefined' ? global : null);\n\n  for (let index = 0; index < candidates.length; index += 1) {\n    const scope = candidates[index];\n    try {\n      const candidate = scope && scope.updateGlobalDevicesReference;\n      if (typeof candidate === 'function') {\n        return candidate;\n      }\n    } catch (scopeError) {\n      void scopeError;\n    }\n  }\n\n  return null;\n}\n\n// Store a deep copy of the initial 'devices' data as defined in the device files.\n// This 'defaultDevices' will be used when reverting the database.\n// Initialize defaultDevices only if it hasn't been declared yet, to prevent\n// \"already declared\" errors if the script is loaded multiple times.\nif (window.defaultDevices === undefined) {\n  window.defaultDevices = CORE_DEEP_CLONE(window.devices);\n  localMarkDevicesNormalized(window.defaultDevices);\n  unifyDevices(window.defaultDevices);\n}\n\n// Load any saved device data from localStorage\nlet storedDevices = loadDeviceData();\nif (storedDevices) {\n  // Merge stored devices with the defaults so that categories missing\n  // from saved data (e.g. FIZ) fall back to the built-in definitions.\n  const merged = CORE_DEEP_CLONE(window.defaultDevices);\n  for (const [key, value] of Object.entries(storedDevices)) {\n    if (key === 'fiz' && value && typeof value === 'object') {\n      merged.fiz = merged.fiz || {};\n      for (const [sub, subVal] of Object.entries(value)) {\n        merged.fiz[sub] = {\n          ...(merged.fiz[sub] || {}),\n          ...(subVal || {}),\n        };\n      }\n    } else if (merged[key] && typeof merged[key] === 'object') {\n      merged[key] = { ...merged[key], ...(value || {}) };\n    } else {\n      merged[key] = value;\n    }\n  }\n  // Sync global and local reference\n  window.devices = devices = merged;\n  const updateDevicesReferenceFn = resolveUpdateDevicesReferenceFunction();\n  if (typeof updateDevicesReferenceFn === 'function') {\n    try {\n      updateDevicesReferenceFn(devices);\n    } catch (updateDevicesReferenceError) {\n      if (typeof console !== 'undefined' && typeof console.warn === 'function') {\n        console.warn('Failed to update global devices reference during initialization', updateDevicesReferenceError);\n      }\n    }\n  }\n}\nunifyDevices(devices, { force: true });\n\nfunction getBatteryPlateSupport(name) {\n  const cam = devices.cameras && devices.cameras[name];\n  if (!cam || !cam.power || !Array.isArray(cam.power.batteryPlateSupport)) return [];\n  return cam.power.batteryPlateSupport\n    .filter(Boolean)\n    .map(bp => {\n      if (!bp || typeof bp !== 'object') return bp;\n      if (bp.type === 'Gold Mount') {\n        return { ...bp, type: 'Gold-Mount' };\n      }\n      return bp;\n    });\n}\n\nfunction getSupportedBatteryPlates(name) {\n  return getBatteryPlateSupport(name)\n    .map(bp => bp.type)\n    .filter(Boolean);\n}\n\nfunction getAvailableBatteryPlates(name) {\n  const support = getBatteryPlateSupport(name);\n  if (!support.length) return [];\n  const nativeTypes = new Set(\n    support\n      .filter(bp => bp.mount === 'native' && bp.type)\n      .map(bp => bp.type)\n  );\n  if (nativeTypes.size === 1 && nativeTypes.has('B-Mount')) {\n    return ['B-Mount'];\n  }\n  return [...new Set(getSupportedBatteryPlates(name))];\n}\n\nfunction supportsMountCamera(name, mountType) {\n  return getAvailableBatteryPlates(name).includes(mountType);\n}\n\nfunction supportsBMountCamera(name) {\n  return supportsMountCamera(name, 'B-Mount');\n}\n\nfunction supportsGoldMountCamera(name) {\n  return supportsMountCamera(name, 'Gold-Mount');\n}\n\nfunction getBatteriesByMount(mountType) {\n  const out = {};\n  for (const [name, info] of Object.entries(devices?.batteries || {})) {\n    if (info && info.mount_type === mountType) out[name] = info;\n  }\n  return out;\n}\n\nfunction getHotswapsByMount(mountType) {\n  const out = {};\n  for (const [name, info] of Object.entries(devices.batteryHotswaps || {})) {\n    if (info && info.mount_type === mountType) out[name] = info;\n  }\n  return out;\n}\n\nfunction getBatteryMountType(batteryName) {\n  if (!batteryName || batteryName === 'None') {\n    return '';\n  }\n  const info = devices?.batteries?.[batteryName];\n  const mount = info && typeof info.mount_type === 'string' ? info.mount_type : '';\n  return mount || '';\n}\n\nvar batteryPlateRow;\nvar batteryPlateSelect;\n\nfunction normalizeBatteryPlateValue(plateValue, batteryName) {\n  const normalizedPlate = typeof plateValue === 'string' ? plateValue.trim() : '';\n  const derivedMount = getBatteryMountType(batteryName);\n  if (!derivedMount) {\n    return normalizedPlate;\n  }\n  if (!normalizedPlate || normalizedPlate !== derivedMount) {\n    return derivedMount;\n  }\n  return normalizedPlate;\n}\n\nfunction ensureBatteryPlateElements() {\n  if (typeof document === 'undefined') {\n    if (typeof batteryPlateRow === 'undefined') batteryPlateRow = null;\n    if (typeof batteryPlateSelect === 'undefined') batteryPlateSelect = null;\n    return;\n  }\n  batteryPlateRow = document.getElementById('batteryPlateRow');\n  batteryPlateSelect = document.getElementById('batteryPlateSelect');\n}\n\nfunction applyBatteryPlateSelectionFromBattery(batteryName, currentPlateValue) {\n  ensureBatteryPlateElements();\n  const normalizedPlate = typeof currentPlateValue === 'string' ? currentPlateValue.trim() : '';\n  const desiredPlate = normalizeBatteryPlateValue(normalizedPlate, batteryName);\n  if (!batteryPlateSelect || !desiredPlate) {\n    return desiredPlate || normalizedPlate;\n  }\n  const options = Array.from(batteryPlateSelect.options || []);\n  const hasDesiredOption = options.some(option => option && option.value === desiredPlate);\n  if (!hasDesiredOption) {\n    return normalizedPlate;\n  }\n  if (batteryPlateSelect.value !== desiredPlate) {\n    batteryPlateSelect.value = desiredPlate;\n  }\n  return desiredPlate;\n}\n\nfunction getSelectedPlate() {\n  ensureBatteryPlateElements();\n  const camName = typeof cameraSelect?.value === 'string' ? cameraSelect.value : '';\n  const plates = typeof getAvailableBatteryPlates === 'function'\n    ? getAvailableBatteryPlates(camName)\n    : [];\n  if (!Array.isArray(plates) || !plates.length) return null;\n  const plateValue = typeof batteryPlateSelect?.value === 'string' ? batteryPlateSelect.value : '';\n  if (plateValue) {\n    return plateValue;\n  }\n  if (plates.includes('V-Mount')) {\n    return 'V-Mount';\n  }\n  return plates[0];\n}\n\nfunction isSelectedPlateNative(camName) {\n  const plate = getSelectedPlate();\n  const cam = (devices.cameras || {})[camName];\n  if (!plate || !cam || !cam.power || !Array.isArray(cam.power.batteryPlateSupport)) return false;\n  return cam.power.batteryPlateSupport.some(bp => bp.type === plate && bp.mount === 'native');\n}\n\nfunction shortConnLabel(type) {\n  if (!type) return '';\n  return String(type).replace(/\\(.*?\\)/, '').trim();\n}\n\nfunction formatConnLabel(from, to) {\n  const a = shortConnLabel(from);\n  const b = shortConnLabel(to);\n  if (!a) return b || '';\n  if (!b || a.toLowerCase() === b.toLowerCase()) return a;\n  return `${a} to ${b} `;\n}\n\n\nconst hasCamConnector = str => /CAM/i.test(str);\nconst hasLemo7PinConnector = str => /7-pin/i.test(str);\n\n// Collect a list of FIZ connector type strings from a device definition.\nfunction getFizConnectorTypes(device) {\n  if (!device) return [];\n  if (Array.isArray(device.fizConnectors)) {\n    return device.fizConnectors.map(fc => fc.type);\n  }\n  return device.fizConnector ? [device.fizConnector] : [];\n}\n\nfunction controllerCamPort(name) {\n  const isRf = /cforce.*rf/i.test(name) || /RIA-1/i.test(name);\n  if (isRf) return 'Cam';\n  const c = devices.fiz?.controllers?.[name];\n  if (c) {\n    if (/UMC-4/i.test(name)) return '3-Pin R/S';\n    const connStr = getFizConnectorTypes(c).join(', ');\n    if (hasCamConnector(connStr)) return 'Cam';\n    if (hasLemo7PinConnector(connStr)) return 'LEMO 7-pin';\n  }\n  const m = devices.fiz?.motors?.[name];\n  if (m) {\n    const connStr = getFizConnectorTypes(m).join(', ');\n    if (hasCamConnector(connStr)) return 'Cam';\n    if (hasLemo7PinConnector(connStr)) return 'LEMO 7-pin';\n  }\n  if (isArriOrCmotion(name) && !isRf) return 'LBUS';\n  return 'FIZ Port';\n}\n\nfunction controllerDistancePort(name) {\n  const c = devices.fiz?.controllers?.[name];\n  if (/RIA-1/i.test(name) || /UMC-4/i.test(name)) return 'Serial';\n  if (getFizConnectorTypes(c).some(type => /SERIAL/i.test(type))) return 'Serial';\n  return 'LBUS';\n}\n\nfunction controllerPriority(name) {\n  if (/cforce.*rf/i.test(name) || /RIA-1/i.test(name) || /UMC-4/i.test(name)) return 0;\n  if (/Master Grip/i.test(name) || /ZMU-4/i.test(name) || /OCU-1/i.test(name)) return 1;\n  return 2;\n}\n\nfunction motorPriority(name) {\n  const m = devices.fiz?.motors?.[name];\n  if (m && m.internalController && /CAM/i.test(m.fizConnector || '')) return 0;\n  return 1;\n}\nfunction isArriOrCmotion(name) {\n  return /^(ARRI|Arri)/i.test(name) || /cmotion/i.test(name);\n}\n\nfunction isArri(name) {\n  return /arri/i.test(name);\n}\nfunction fizNeedsPower(name) {\n  const d = devices.fiz?.controllers?.[name] || devices.fiz?.motors?.[name];\n  if (!d) return false;\n  const ps = String(d.powerSource || '').toLowerCase();\n  if (ps.includes('internal battery') && !ps.includes('external')) return false;\n  return true;\n}\n\n\nfunction firstConnector(str) {\n  if (!str) return '';\n  return str.split(',')[0].trim();\n}\n\n/**\n * Returns the first FIZ connector for a device, optionally prioritizing\n * connectors that match a set of regular expressions. This consolidates the\n * repeated logic for choosing between `fizConnector` and `fizConnectors` while\n * keeping any existing preference order.\n *\n * @param {object} device - Device object that may include `fizConnector` or\n *   `fizConnectors`.\n * @param {RegExp[]} [preferredMatchers=[]] - Regex patterns to prioritize.\n * @returns {string} The normalized connector label or an empty string if none\n *   is found.\n */\nfunction getFizPort(device, preferredMatchers = []) {\n  if (!device) return '';\n  const connectors = Array.isArray(device.fizConnectors)\n    ? device.fizConnectors\n    : [];\n  for (const matcher of preferredMatchers) {\n    const match = connectors.find(fc => matcher.test(fc.type));\n    if (match) return firstConnector(match.type);\n  }\n  const portStr = device.fizConnector || connectors[0]?.type;\n  return firstConnector(portStr);\n}\n\nfunction cameraFizPort(camName, controllerPort, deviceName = '') {\n  const cam = (devices.cameras || {})[camName];\n  if (!cam || !Array.isArray(cam.fizConnectors) || cam.fizConnectors.length === 0) return 'LBUS';\n  if (!controllerPort) return cam.fizConnectors[0].type;\n\n  // If a non-ARRI FIZ device is attached to an ARRI camera, prefer the EXT port\n  if (isArri(camName) && deviceName && !isArri(deviceName)) {\n    const ext = cam.fizConnectors.find(fc => /ext/i.test(fc.type));\n    if (ext) return ext.type;\n  }\n\n  const norm = shortConnLabel(firstConnector(controllerPort)).toLowerCase();\n  const match = cam.fizConnectors.find(fc => shortConnLabel(fc.type).toLowerCase() === norm);\n  return match ? match.type : cam.fizConnectors[0].type;\n}\n\nfunction controllerFizPort(name) {\n  const c = devices.fiz?.controllers?.[name];\n  if (/UMC-4/i.test(name)) {\n    return getFizPort(c, [/LCS/i]) || 'LCS (LEMO 7-pin)';\n  }\n  const port = getFizPort(c);\n  return port || (isArriOrCmotion(name) ? 'LBUS' : 'Proprietary');\n}\n\nfunction motorFizPort(name) {\n  const m = devices.fiz?.motors?.[name];\n  const port = getFizPort(m);\n  return port || (isArriOrCmotion(name) ? 'LBUS' : 'Proprietary');\n}\n\nfunction distanceFizPort(name) {\n  const d = devices.fiz?.distance?.[name];\n  if (!d) return 'LBUS';\n  const port = getFizPort(d, [/LBUS/i, /SERIAL/i]);\n  if (port) return port;\n  return /preston/i.test(name) ? 'Serial' : 'LBUS';\n}\n\nfunction fizPort(name) {\n  if (devices.fiz?.controllers?.[name]) return controllerFizPort(name);\n  if (devices.fiz?.motors?.[name]) return motorFizPort(name);\n  if (devices.fiz?.distance?.[name]) return distanceFizPort(name);\n  return 'LBUS';\n}\n\nfunction fizPowerPort(name) {\n  if (/cforce.*rf/i.test(name) || /RIA-1/i.test(name)) return 'Cam';\n  return fizPort(name);\n}\n\nfunction sdiRate(type) {\n  const m = /([\\d.]+)G-SDI/i.exec(type || '');\n  if (m) return parseFloat(m[1]);\n  return /SDI/i.test(type || '') ? 1 : null;\n}\nfunction connectionLabel(outType, inType) {\n  if (!outType || !inType) return \"\";\n  if (/HDMI/i.test(outType) && /HDMI/i.test(inType)) return \"HDMI\";\n  if (/SDI/i.test(outType) && /SDI/i.test(inType)) {\n    const rate = Math.min(sdiRate(outType) || 0, sdiRate(inType) || 0) || sdiRate(outType) || sdiRate(inType) || 0;\n    if (rate >= 12) return \"12G-SDI\";\n    if (rate >= 6) return \"6G-SDI\";\n    if (rate >= 3) return \"3G-SDI\";\n    if (rate >= 1.5) return \"1.5G-SDI\";\n    return \"SDI\";\n  }\n  if (/HDMI/i.test(outType)) return \"HDMI\";\n  if (/SDI/i.test(outType)) return \"SDI\";\n  return \"\";\n}\n\n\nfunction updateBatteryPlateVisibility() {\n  ensureBatteryPlateElements();\n  const camName = typeof cameraSelect?.value === 'string' ? cameraSelect.value : '';\n  const plates = typeof getAvailableBatteryPlates === 'function'\n    ? getAvailableBatteryPlates(camName)\n    : [];\n  const applyDependentUpdates = () => {\n    updateViewfinderSettingsVisibility();\n    updateViewfinderExtensionVisibility();\n    updateMonitoringConfigurationOptions();\n  };\n  if (!batteryPlateSelect || !batteryPlateRow) {\n    if (batteryPlateRow && typeof batteryPlateRow.style !== 'undefined') {\n      batteryPlateRow.style.display = 'none';\n    }\n    if (batteryPlateSelect) {\n      batteryPlateSelect.value = '';\n    }\n    applyDependentUpdates();\n    return;\n  }\n  const current = typeof batteryPlateSelect.value === 'string' ? batteryPlateSelect.value : '';\n  batteryPlateSelect.innerHTML = '';\n  if (Array.isArray(plates) && plates.length) {\n    plates.forEach(pt => {\n      const opt = document.createElement('option');\n      opt.value = pt;\n      opt.textContent = pt;\n      batteryPlateSelect.appendChild(opt);\n    });\n    let def = current;\n    if (!plates.includes(def)) {\n      def = plates.includes('V-Mount') ? 'V-Mount' : plates[0];\n    }\n    batteryPlateSelect.value = def;\n    batteryPlateRow.style.display = '';\n  } else {\n    batteryPlateRow.style.display = 'none';\n    batteryPlateSelect.value = '';\n  }\n  applyDependentUpdates();\n}\n\nfunction updateViewfinderSettingsVisibility() {\n  const cam = devices?.cameras?.[cameraSelect?.value];\n  const hasViewfinder = Array.isArray(cam?.viewfinder) && cam.viewfinder.length > 0;\n  const config = monitoringConfigurationSelect?.value;\n  const show = hasViewfinder && (config === 'Viewfinder only' || config === 'Viewfinder and Onboard');\n  if (viewfinderSettingsRow) {\n    if (show) {\n      viewfinderSettingsRow.classList.remove('hidden');\n    } else {\n      viewfinderSettingsRow.classList.add('hidden');\n      const vfSelect = document.getElementById('viewfinderSettings');\n      if (vfSelect && vfSelect.options) {\n        Array.from(vfSelect.options).forEach(o => { o.selected = false; });\n      }\n    }\n  }\n}\n\nfunction updateMonitoringConfigurationOptions() {\n  if (!monitoringConfigurationSelect) return;\n  const cam = devices?.cameras?.[cameraSelect?.value];\n  const hasViewfinder = Array.isArray(cam?.viewfinder) && cam.viewfinder.length > 0;\n  const monitorSelected = monitorSelect && monitorSelect.value && monitorSelect.value !== 'None';\n  const vfOnlyOption = Array.from(monitoringConfigurationSelect.options || [])\n    .find(o => o.value === 'Viewfinder only');\n  if (!vfOnlyOption) return;\n  const show = hasViewfinder && !monitorSelected;\n  vfOnlyOption.hidden = !show;\n  if (monitoringConfigurationUserChanged) {\n    if (!show && monitoringConfigurationSelect.value === 'Viewfinder only') {\n      monitoringConfigurationSelect.value = hasViewfinder ? 'Viewfinder and Onboard' : 'Onboard Only';\n    }\n    updateViewfinderSettingsVisibility();\n    return;\n  }\n\n  if (monitorSelected) {\n    monitoringConfigurationSelect.value = hasViewfinder ? 'Viewfinder and Onboard' : 'Onboard Only';\n  } else if (!hasViewfinder) {\n    monitoringConfigurationSelect.value = 'Onboard Only';\n  } else {\n    monitoringConfigurationSelect.value = 'Viewfinder only';\n  }\n  updateViewfinderSettingsVisibility();\n}\n\nfunction updateViewfinderExtensionVisibility() {\n  const cam = devices?.cameras?.[cameraSelect?.value];\n  const hasViewfinder = Array.isArray(cam?.viewfinder) && cam.viewfinder.length > 0;\n  if (viewfinderExtensionRow) {\n    if (hasViewfinder) {\n      viewfinderExtensionRow.classList.remove('hidden');\n    } else {\n      viewfinderExtensionRow.classList.add('hidden');\n      const vfExtSel = document.getElementById('viewfinderExtension');\n      if (vfExtSel) {\n        vfExtSel.value = '';\n      }\n    }\n  }\n}\n\nfunction updateBatteryLabel() {\n  const label = document.getElementById('batteryLabel');\n  if (!label) return;\n  const langTexts = getLanguageTexts(currentLang);\n  const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n  const helpText = resolveTextEntryInternal(langTexts, fallbackTexts, 'batterySelectHelp', '');\n  if (helpText) {\n    label.setAttribute('data-help', helpText);\n  } else {\n    label.removeAttribute('data-help');\n  }\n  if (getSelectedPlate() === 'B-Mount') {\n    label.textContent = resolveTextEntryInternal(langTexts, fallbackTexts, 'batteryBMountLabel', 'B-Mount Battery:');\n  } else {\n    label.textContent = resolveTextEntryInternal(langTexts, fallbackTexts, 'batteryLabel', 'Battery:');\n  }\n}\n\nvar localParseBatteryCurrentLimit = value => {\n  if (typeof value === 'number') {\n    return Number.isFinite(value) ? value : null;\n  }\n  if (typeof value === 'string') {\n    const trimmed = value.trim();\n    if (!trimmed) {\n      return null;\n    }\n    const normalized = trimmed.replace(/,/g, '.');\n    const parsed = parseFloat(normalized);\n    return Number.isFinite(parsed) ? parsed : null;\n  }\n  return null;\n};\n\nfunction updateBatteryOptions() {\n  if (!batterySelect || !hotswapSelect || !cameraSelect) return;\n  const current = batterySelect.value;\n  const currentSwap = hotswapSelect.value;\n  const plate = getSelectedPlate();\n  const camName = cameraSelect.value;\n  const supportsB = supportsBMountCamera(camName);\n  const supportsGold = supportsGoldMountCamera(camName);\n  let swaps;\n  if (plate === 'B-Mount') {\n    populateSelect(batterySelect, getBatteriesByMount('B-Mount'), true);\n    swaps = getHotswapsByMount('B-Mount');\n  } else if (plate === 'V-Mount') {\n    populateSelect(batterySelect, getBatteriesByMount('V-Mount'), true);\n    swaps = getHotswapsByMount('V-Mount');\n  } else if (plate === 'Gold-Mount') {\n    populateSelect(batterySelect, getBatteriesByMount('Gold-Mount'), true);\n    swaps = getHotswapsByMount('Gold-Mount');\n  } else {\n    let bats = devices.batteries || {};\n    if (!supportsB) {\n      bats = Object.fromEntries(Object.entries(bats).filter(([, b]) => b.mount_type !== 'B-Mount'));\n    }\n    if (!supportsGold) {\n      bats = Object.fromEntries(Object.entries(bats).filter(([, b]) => b.mount_type !== 'Gold-Mount'));\n    }\n    populateSelect(batterySelect, bats, true);\n    swaps = devices.batteryHotswaps || {};\n    if (!supportsB) {\n      swaps = Object.fromEntries(Object.entries(swaps).filter(([, b]) => b.mount_type !== 'B-Mount'));\n    }\n    if (!supportsGold) {\n      swaps = Object.fromEntries(Object.entries(swaps).filter(([, b]) => b.mount_type !== 'Gold-Mount'));\n    }\n  }\n  if (!/FXLion Nano/i.test(current)) {\n    swaps = Object.fromEntries(\n      Object.entries(swaps).filter(([name]) => name !== 'FX-Lion NANO Dual V-Mount Hot-Swap Plate')\n    );\n  }\n\n  // Filter out hotswaps that cannot supply the required current\n  const totalCurrentLow = (totalCurrent12Elem && typeof totalCurrent12Elem.textContent === 'string') ? parseFloat(totalCurrent12Elem.textContent) : 0;\n  if (isFinite(totalCurrentLow) && totalCurrentLow > 0) {\n    swaps = Object.fromEntries(\n      Object.entries(swaps).filter(([, info]) => {\n        const pinLimit = localParseBatteryCurrentLimit(info && info.pinA);\n        return !Number.isFinite(pinLimit) || pinLimit >= totalCurrentLow;\n      })\n    );\n  }\n\n  populateSelect(hotswapSelect, swaps, true);\n  if (batterySelect.options && Array.from(batterySelect.options).some(o => o.value === current)) {\n    batterySelect.value = current;\n  }\n  if (typeof updateFavoriteButton === 'function') {\n    updateFavoriteButton(batterySelect);\n  } else if (typeof enqueueCoreBootTask === 'function') {\n    enqueueCoreBootTask(() => {\n      if (typeof updateFavoriteButton === 'function') {\n        updateFavoriteButton(batterySelect);\n      }\n    });\n  }\n  if (hotswapSelect.options && Array.from(hotswapSelect.options).some(o => o.value === currentSwap)) {\n    hotswapSelect.value = currentSwap;\n  }\n  if (typeof updateFavoriteButton === 'function') {\n    updateFavoriteButton(hotswapSelect);\n  } else if (typeof enqueueCoreBootTask === 'function') {\n    enqueueCoreBootTask(() => {\n      if (typeof updateFavoriteButton === 'function') {\n        updateFavoriteButton(hotswapSelect);\n      }\n    });\n  }\n  updateBatteryLabel();\n}\n\nconst BRAND_KEYWORDS = {\n  arri: 'arri',\n  cmotion: 'cmotion',\n  focusbug: 'focusbug',\n  tilta: 'tilta',\n  preston: 'preston',\n  chrosziel: 'chrosziel',\n  smallrig: 'smallrig',\n  dji: 'dji',\n  redrock: 'redrock',\n  teradek: 'teradek'\n};\n\nfunction detectBrand(name) {\n  if (!name) return null;\n  const n = String(name).trim().toLowerCase();\n  if (n === 'none') return null;\n  for (const [keyword, brand] of Object.entries(BRAND_KEYWORDS)) {\n    if (n.includes(keyword)) return brand;\n  }\n  return 'other';\n}\n\nconst STATUS_CLASS_BY_LEVEL = {\n  info: 'status-message--info',\n  success: 'status-message--success',\n  note: 'status-message--note',\n  warning: 'status-message--warning',\n  danger: 'status-message--danger'\n};\n\nfunction setStatusLevel(element, level) {\n  if (!element) return;\n\n  const severityClasses = Object.values(STATUS_CLASS_BY_LEVEL);\n  if (element.classList) {\n    severityClasses.forEach(cls => element.classList.remove(cls));\n  } else if (typeof element.className === 'string') {\n    const remaining = element.className\n      .split(/\\s+/)\n      .filter(Boolean)\n      .filter(cls => !severityClasses.includes(cls));\n    element.className = remaining.join(' ');\n  }\n\n  const normalized = level && STATUS_CLASS_BY_LEVEL[level] ? level : null;\n  if (normalized) {\n    const severityClass = STATUS_CLASS_BY_LEVEL[normalized];\n    if (element.classList) {\n      if (!element.classList.contains('status-message')) {\n        element.classList.add('status-message');\n      }\n      element.classList.add(severityClass);\n    } else if (typeof element.className === 'string') {\n      const classes = element.className.split(/\\s+/).filter(Boolean);\n      if (!classes.includes('status-message')) {\n        classes.push('status-message');\n      }\n      classes.push(severityClass);\n      element.className = Array.from(new Set(classes)).join(' ');\n    }\n    if (element.dataset) {\n      element.dataset.statusLevel = normalized;\n    } else if (element.setAttribute) {\n      element.setAttribute('data-status-level', normalized);\n    }\n  } else if (element.dataset && 'statusLevel' in element.dataset) {\n    delete element.dataset.statusLevel;\n  } else if (element.removeAttribute) {\n    element.removeAttribute('data-status-level');\n  }\n}\n\nfunction formatStatusMessage(message) {\n  if (typeof message !== 'string' || message.length === 0) {\n    return '';\n  }\n\n  const match = message.match(/^([A-Z--]+(?:[\\s\\u00A0-][A-Z--]+)*)([\\s\\u00A0]*:)([\\s\\u00A0]*)/u);\n  if (match) {\n    const [, label, colonPart, trailingSpace] = match;\n    const rest = message.slice(match[0].length);\n    return `< strong > ${escapeHtml(label)}${escapeHtml(colonPart)}</strong > ${escapeHtml(trailingSpace)}${escapeHtml(rest)} `;\n  }\n\n  return escapeHtml(message);\n}\n\nfunction setStatusMessage(element, message) {\n  if (!element) return;\n  if (!message) {\n    element.textContent = '';\n    return;\n  }\n\n  element.innerHTML = formatStatusMessage(message);\n}\n\nfunction formatCurrentValue(value) {\n  if (!Number.isFinite(value)) return '0';\n  const rounded = Number.parseFloat(value.toFixed(2));\n  if (Number.isNaN(rounded)) return '0';\n  return rounded.toString();\n}\n\nfunction checkFizCompatibility() {\n  const brands = new Set();\n  motorSelects.forEach(sel => { const b = detectBrand(sel && sel.value); if (b) brands.add(b); });\n  controllerSelects.forEach(sel => { const b = detectBrand(sel && sel.value); if (b) brands.add(b); });\n  const distB = detectBrand(distanceSelect && distanceSelect.value);\n  if (distB) brands.add(distB);\n  const cameraBrand = detectBrand(cameraSelect && cameraSelect.value);\n\n  const compatElem = document.getElementById('compatWarning');\n  if (!compatElem) return;\n\n  const langTexts = getLanguageTexts(currentLang);\n  const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n\n  let incompatible = false;\n  const arr = Array.from(brands);\n\n  if (cameraBrand === 'dji' && arr.some(b => b && b !== 'dji')) {\n    incompatible = true;\n  } else if (arr.length > 1) {\n    const allowed = ['arri', 'cmotion', 'focusbug'];\n    if (arr.every(b => allowed.includes(b))) {\n      incompatible = false;\n    } else {\n      const filtered = arr.filter(b => b !== 'other');\n      const distinct = new Set(filtered);\n      if (distinct.size > 1) incompatible = true;\n    }\n  }\n\n  if (incompatible) {\n    const warning = resolveTextEntryInternal(langTexts, fallbackTexts, 'incompatibleFIZWarning', '');\n    setStatusMessage(compatElem, warning);\n    setStatusLevel(compatElem, 'danger');\n  } else {\n    setStatusMessage(compatElem, '');\n    setStatusLevel(compatElem, null);\n  }\n}\n\nfunction checkFizController() {\n  const compatElem = document.getElementById('compatWarning');\n  if (!compatElem) return;\n\n  const motors = motorSelects.map(sel => sel && sel.value).filter(v => v && v !== 'None');\n  if (!motors.length) return;\n\n  const controllers = controllerSelects.map(sel => sel && sel.value).filter(v => v && v !== 'None');\n  const camName = cameraSelect && cameraSelect.value;\n  const cam = (devices.cameras || {})[camName];\n\n  const isAmira = /Arri Amira/i.test(camName);\n  const onlyCforceMiniPlus = motors.length > 0 && motors.every(n => {\n    const lower = n.toLowerCase();\n    return ((lower.includes('cforce mini') && !lower.includes('rf')) || lower.includes('cforce plus'));\n  });\n  const hasRemoteController = controllers.some(n => /ria-1|umc-4|cforce.*rf/i.test(n)) || motors.some(n => /cforce.*rf/i.test(n));\n  if (isAmira && onlyCforceMiniPlus && !hasRemoteController) {\n    const langTexts = getLanguageTexts(currentLang);\n    const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n    const warning = resolveTextEntryInternal(langTexts, fallbackTexts, 'amiraCforceRemoteWarning', '');\n    setStatusMessage(compatElem, warning);\n    setStatusLevel(compatElem, 'danger');\n    return;\n  }\n\n  const cameraHasLBUS = Array.isArray(cam?.fizConnectors) &&\n    cam.fizConnectors.some(fc => /LBUS/i.test(fc.type));\n  let hasController = cameraHasLBUS && /arri/i.test(camName);\n\n  controllers.forEach(name => {\n    const c = devices.fiz.controllers[name];\n    if (!c) return;\n    const connStr = (c.fizConnectors || []).map(fc => fc.type).join(', ');\n    if (/CAM|SERIAL|Motor/i.test(connStr)) hasController = true;\n    if (c.internalController) hasController = true;\n  });\n\n  motors.forEach(name => {\n    const m = devices.fiz.motors[name];\n    if (m && m.internalController) hasController = true;\n  });\n\n  const needController = motors.some(name => {\n    const m = devices.fiz.motors[name];\n    return m && m.internalController === false;\n  });\n\n  if (needController && !hasController) {\n    const langTexts = getLanguageTexts(currentLang);\n    const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n    const warning = resolveTextEntryInternal(langTexts, fallbackTexts, 'missingFIZControllerWarning', '');\n    setStatusMessage(compatElem, warning);\n    setStatusLevel(compatElem, 'danger');\n  }\n}\n\nfunction checkArriCompatibility() {\n  const compatElem = document.getElementById('compatWarning');\n  if (!compatElem || compatElem.textContent) return;\n\n  let motors = motorSelects.map(sel => sel.value).filter(v => v && v !== 'None');\n  motors.sort((a, b) => motorPriority(a) - motorPriority(b));\n  const internalIdx = motors.findIndex(name => devices.fiz?.motors?.[name]?.internalController);\n  const hasInternalMotor = internalIdx !== -1;\n  if (hasInternalMotor && internalIdx > 0) {\n    const [m] = motors.splice(internalIdx, 1);\n    motors.unshift(m);\n  }\n  let controllers = controllerSelects.map(sel => sel.value).filter(v => v && v !== 'None');\n  controllers.sort((a, b) => controllerPriority(a) - controllerPriority(b));\n  const distance = distanceSelect.value;\n\n  const camName = cameraSelect.value;\n  const cam = (devices.cameras || {})[camName];\n  const cameraHasLBUS = Array.isArray(cam?.fizConnectors) &&\n    cam.fizConnectors.some(fc => /LBUS/i.test(fc.type));\n  const builtInController = cameraHasLBUS && /arri/i.test(camName);\n\n  const usesUMC4 = controllers.some(n => /UMC-4/i.test(n));\n  const usesRIA1 = controllers.some(n => /RIA-1/i.test(n));\n  const usesRF = controllers.some(n => /cforce.*rf/i.test(n)) || motors.some(m => /cforce.*rf/i.test(m));\n\n  const camCounts = /(Alexa Mini LF|Alexa Mini|Alexa 35)/i.test(camName);\n  const onlyMasterGrip =\n    controllers.length > 0 &&\n    controllers.every(n => /Master Grip/i.test(n)) &&\n    !camCounts;\n\n  let msg = '';\n  const clmRegex = /CLM-[345]/i;\n  const hasCLM = motors.some(m => clmRegex.test(m));\n  if (hasCLM && !usesUMC4) {\n    msg = resolveTextEntryInternal(getLanguageTexts(currentLang), getLanguageTexts(DEFAULT_LANGUAGE_SAFE), 'arriCLMNoUMC4Warning', '');\n  } else if (usesUMC4 && motors.some(m => !clmRegex.test(m))) {\n    msg = resolveTextEntryInternal(getLanguageTexts(currentLang), getLanguageTexts(DEFAULT_LANGUAGE_SAFE), 'arriUMC4Warning', '');\n  } else if ((usesRIA1 || usesRF) && motors.some(m => clmRegex.test(m))) {\n    msg = resolveTextEntryInternal(getLanguageTexts(currentLang), getLanguageTexts(DEFAULT_LANGUAGE_SAFE), 'arriRIA1Warning', '');\n  } else if (\n    distance &&\n    distance !== 'None' &&\n    !/DJI LiDAR/i.test(distance) &&\n    !(usesUMC4 || usesRIA1 || usesRF || builtInController)\n  ) {\n    msg = resolveTextEntryInternal(getLanguageTexts(currentLang), getLanguageTexts(DEFAULT_LANGUAGE_SAFE), 'distanceControllerWarning', '');\n  } else if (onlyMasterGrip && !usesRF) {\n    msg = resolveTextEntryInternal(getLanguageTexts(currentLang), getLanguageTexts(DEFAULT_LANGUAGE_SAFE), 'masterGripWirelessWarning', '');\n  }\n\n  if (msg) {\n    setStatusMessage(compatElem, msg);\n    const langTexts = getLanguageTexts(currentLang);\n    const fallbackTexts = getLanguageTexts(DEFAULT_LANGUAGE_SAFE);\n    const umcWarning = resolveTextEntryInternal(langTexts, fallbackTexts, 'arriUMC4Warning', '');\n    if (msg === umcWarning && umcWarning) {\n      setStatusLevel(compatElem, 'warning');\n    } else {\n      setStatusLevel(compatElem, 'danger');\n    }\n  }\n}\n\nvar gearItemTranslations = {};\n\nfunction resolveTranslationsRuntime() {\n  var candidateScopes = [];\n\n  function resolveGlobalScopeForTranslations() {\n    if (typeof globalThis !== 'undefined' && globalThis) {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined' && window) {\n      return window;\n    }\n    if (typeof self !== 'undefined' && self) {\n      return self;\n    }\n    if (typeof global !== 'undefined' && global) {\n      return global;\n    }\n    return null;\n  }\n\n  try { candidateScopes.push(typeof CORE_GLOBAL_SCOPE !== 'undefined' ? CORE_GLOBAL_SCOPE : null); } catch (coreScopeError) { void coreScopeError; }\n  candidateScopes.push(resolveGlobalScopeForTranslations());\n\n  for (var index = 0; index < candidateScopes.length; index += 1) {\n    var scope = candidateScopes[index];\n    if (!scope || typeof scope !== 'object') {\n      continue;\n    }\n    try {\n      var runtime = scope.translations;\n      if (runtime && typeof runtime.loadLanguage === 'function') {\n        return runtime;\n      }\n    } catch (scopeError) {\n      void scopeError;\n    }\n  }\n\n  if (typeof translations !== 'undefined' && translations && typeof translations.loadLanguage === 'function') {\n    return translations;\n  }\n\n  /*\n  if (typeof require === 'function') {\n    try {\n      // var requiredTranslations = require('./translations.js');\n      // if (requiredTranslations && typeof requiredTranslations.loadLanguage === 'function') {\n      //   return requiredTranslations;\n      // }\n    } catch (runtimeRequireError) {\n      console.warn('Failed to resolve translations runtime via require', runtimeRequireError);\n    }\n  }\n  */\n\n  return null;\n}\n\nvar translationsRuntime = resolveTranslationsRuntime();\n\n// Load translations when not already present (mainly for tests)\nif (typeof texts === 'undefined') {\n  var translations = null;\n  var globalScope = (function resolveGlobalScopeFallback() {\n    if (typeof globalThis !== 'undefined' && globalThis) {\n      return globalThis;\n    }\n    if (typeof window !== 'undefined' && window) {\n      return window;\n    }\n    if (typeof self !== 'undefined' && self) {\n      return self;\n    }\n    if (typeof global !== 'undefined' && global) {\n      return global;\n    }\n    return null;\n  })();\n\n  if (\n    translationsRuntime &&\n    translationsRuntime.texts &&\n    translationsRuntime.categoryNames &&\n    translationsRuntime.gearItems\n  ) {\n    translations = {\n      texts: translationsRuntime.texts,\n      categoryNames: translationsRuntime.categoryNames,\n      gearItems: translationsRuntime.gearItems,\n    };\n  } else if (\n    globalScope &&\n    globalScope.texts &&\n    globalScope.categoryNames &&\n    globalScope.gearItems\n  ) {\n    translations = {\n      texts: globalScope.texts,\n      categoryNames: globalScope.categoryNames,\n      gearItems: globalScope.gearItems,\n    };\n  }\n\n  if (translations) {\n    if (globalScope) {\n      if (!globalScope.texts && translations.texts) {\n        globalScope.texts = translations.texts;\n      }\n      if (!globalScope.categoryNames && translations.categoryNames) {\n        globalScope.categoryNames = translations.categoryNames;\n      }\n      if (!globalScope.gearItems && translations.gearItems) {\n        globalScope.gearItems = translations.gearItems;\n      }\n    }\n    gearItemTranslations = translations.gearItems || {};\n  } else {\n    gearItemTranslations = {};\n  }\n} else {\n  gearItemTranslations = typeof gearItems !== 'undefined' ? gearItems : {};\n}\n\nvar autoGearHeadingElem = null;\nvar autoGearDescriptionElem = null;\nvar autoGearMonitorDefaultsSection = null;\nvar autoGearMonitorDefaultsHeading = null;\nvar autoGearMonitorDefaultsDescription = null;\nvar autoGearDefaultFocusMonitorSelect = null;\nvar autoGearDefaultHandheldMonitorSelect = null;\nvar autoGearDefaultComboMonitorSelect = null;\nvar autoGearDefaultDirectorMonitorSelect = null;\nvar autoGearDefaultFocusMonitorLabel = null;\nvar autoGearDefaultHandheldMonitorLabel = null;\nvar autoGearDefaultComboMonitorLabel = null;\nvar autoGearDefaultDirectorMonitorLabel = null;\nvar autoGearMonitorDefaultControls = [];\n\nvar autoGearSearchInput = null;\nvar autoGearSearchLabel = null;\nvar autoGearFilterScenarioLabel = null;\nvar autoGearFilterScenarioSelect = null;\nvar autoGearFilterClearButton = null;\nvar autoGearSummarySection = null;\nvar autoGearSummaryHeadingElem = null;\nvar autoGearSummaryDescriptionElem = null;\nvar autoGearSummaryCards = null;\nvar autoGearSummaryDetails = null;\nvar autoGearRulesList = null;\nvar autoGearPresetDescription = null;\nvar autoGearPresetLabel = null;\nvar autoGearPresetSelect = null;\nvar autoGearSavePresetButton = null;\nvar autoGearDeletePresetButton = null;\nvar autoGearAddRuleBtn = null;\nvar autoGearResetFactoryButton = null;\nvar autoGearEditor = null;\nvar autoGearConditionControls = null;\nvar autoGearConditionSelectLabel = null;\nvar autoGearConditionSelect = null;\nvar autoGearConditionAddButton = null;\nvar autoGearConditionList = null;\nvar autoGearAlwaysLabel = null;\nvar autoGearAlwaysHelp = null;\nvar autoGearCameraWeightSection = null;\n\nvar autoGearConditionAddShortcuts = {};\nvar autoGearConditionRemoveButtons = {};\nconst AUTO_GEAR_UI_EXPORTS = (function resolveAutoGearUiExports() {\n  if (typeof resolveCoreSupportModule === 'function') {\n    try {\n      const resolved = resolveCoreSupportModule('cineCoreAutoGearUi', './app-core-auto-gear-ui.js');\n      if (resolved && typeof resolved === 'object') {\n        return resolved;\n      }\n    } catch (autoGearUiResolutionError) {\n      void autoGearUiResolutionError;\n    }\n  }\n\n  try {\n    if (typeof cineCoreAutoGearUi === 'object' && cineCoreAutoGearUi) {\n      return cineCoreAutoGearUi;\n    }\n  } catch (cineCoreAutoGearUiError) {\n    void cineCoreAutoGearUiError;\n  }\n\n  try {\n    const scope =\n      (typeof globalThis !== 'undefined' && globalThis) ||\n      (typeof window !== 'undefined' && window) ||\n      (typeof self !== 'undefined' && self) ||\n      (typeof global !== 'undefined' && global) ||\n      null;\n    if (scope && typeof scope.cineCoreAutoGearUi === 'object' && scope.cineCoreAutoGearUi) {\n      return scope.cineCoreAutoGearUi;\n    }\n  } catch (autoGearUiScopeError) {\n    void autoGearUiScopeError;\n  }\n\n  return {};\n})();\n\nvar autoGearRuleNameInput = (AUTO_GEAR_UI_EXPORTS.autoGearRuleNameInput !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearRuleNameInput : null);\nvar autoGearRuleNameLabel = (AUTO_GEAR_UI_EXPORTS.autoGearRuleNameLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearRuleNameLabel : null);\nvar autoGearScenariosSelect = (AUTO_GEAR_UI_EXPORTS.autoGearScenariosSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenariosSelect : null);\nvar autoGearScenariosLabel = (AUTO_GEAR_UI_EXPORTS.autoGearScenariosLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenariosLabel : null);\nvar autoGearScenarioModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioModeLabel : null);\nvar autoGearScenarioMultiplierContainer = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioMultiplierContainer !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioMultiplierContainer : null);\nvar autoGearScenarioBaseSelect = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioBaseSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioBaseSelect : null);\nvar autoGearScenarioBaseLabel = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioBaseLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioBaseLabel : null);\nvar autoGearScenarioFactorInput = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioFactorInput !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioFactorInput : null);\nvar autoGearScenarioFactorLabel = (AUTO_GEAR_UI_EXPORTS.autoGearScenarioFactorLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearScenarioFactorLabel : null);\nvar autoGearShootingDaysMode = (AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysMode !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysMode : null);\nvar autoGearShootingDaysInput = (AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysInput !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysInput : null);\nvar autoGearShootingDaysLabel = (AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysLabel : null);\nvar autoGearShootingDaysHelp = (AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysHelp !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysHelp : null);\nvar autoGearShootingDaysValueLabel = (AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysValueLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearShootingDaysValueLabel : null);\nvar autoGearMatteboxSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMatteboxSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMatteboxSelect : null);\nvar autoGearMatteboxLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMatteboxLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMatteboxLabel : null);\nvar autoGearMatteboxModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMatteboxModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMatteboxModeLabel : null);\nvar autoGearMatteboxModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMatteboxModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMatteboxModeSelect : null);\nvar autoGearCameraHandleSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleSelect : null);\nvar autoGearCameraHandleLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleLabel : null);\nvar autoGearCameraHandleModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleModeLabel : null);\nvar autoGearCameraHandleModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraHandleModeSelect : null);\nvar autoGearViewfinderExtensionSelect = (AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionSelect : null);\nvar autoGearViewfinderExtensionLabel = (AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionLabel : null);\nvar autoGearViewfinderExtensionModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionModeLabel : null);\nvar autoGearViewfinderExtensionModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearViewfinderExtensionModeSelect : null);\nvar autoGearDeliveryResolutionSelect = (AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionSelect : null);\nvar autoGearDeliveryResolutionLabel = (AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionLabel : null);\nvar autoGearDeliveryResolutionModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionModeLabel : null);\nvar autoGearDeliveryResolutionModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDeliveryResolutionModeSelect : null);\nvar autoGearVideoDistributionSelect = (AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionSelect : null);\nvar autoGearVideoDistributionLabel = (AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionLabel : null);\nvar autoGearVideoDistributionModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionModeLabel : null);\nvar autoGearVideoDistributionModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearVideoDistributionModeSelect : null);\nvar autoGearCameraSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCameraSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraSelect : null);\nvar autoGearCameraLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraLabel : null);\nvar autoGearCameraModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraModeLabel : null);\nvar autoGearCameraModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCameraModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraModeSelect : null);\nvar autoGearOwnGearLabel = (AUTO_GEAR_UI_EXPORTS.autoGearOwnGearLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearOwnGearLabel : null);\nvar autoGearOwnGearModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearOwnGearModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearOwnGearModeLabel : null);\nvar autoGearOwnGearModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearOwnGearModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearOwnGearModeSelect : null);\nvar autoGearOwnGearSelect = (AUTO_GEAR_UI_EXPORTS.autoGearOwnGearSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearOwnGearSelect : null);\nvar autoGearCameraWeightLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightLabel : null);\nvar autoGearCameraWeightOperator = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightOperator !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightOperator : null);\nvar autoGearCameraWeightOperatorLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightOperatorLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightOperatorLabel : null);\nvar autoGearCameraWeightValueInput = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightValueInput !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightValueInput : null);\nvar autoGearCameraWeightValueLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightValueLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightValueLabel : null);\nvar autoGearCameraWeightHelp = (AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightHelp !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCameraWeightHelp : null);\nvar autoGearMonitorSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMonitorSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMonitorSelect : null);\nvar autoGearMonitorLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMonitorLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMonitorLabel : null);\nvar autoGearMonitorModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMonitorModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMonitorModeLabel : null);\nvar autoGearMonitorModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMonitorModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMonitorModeSelect : null);\nvar autoGearTripodHeadBrandSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandSelect : null);\nvar autoGearTripodHeadBrandLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandLabel : null);\nvar autoGearTripodHeadBrandModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandModeLabel : null);\nvar autoGearTripodHeadBrandModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodHeadBrandModeSelect : null);\nvar autoGearTripodBowlSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlSelect : null);\nvar autoGearTripodBowlLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlLabel : null);\nvar autoGearTripodBowlModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlModeLabel : null);\nvar autoGearTripodBowlModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodBowlModeSelect : null);\nvar autoGearTripodTypesSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesSelect : null);\nvar autoGearTripodTypesLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesLabel : null);\nvar autoGearTripodTypesModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesModeLabel : null);\nvar autoGearTripodTypesModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodTypesModeSelect : null);\nvar autoGearTripodSpreaderSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderSelect : null);\nvar autoGearTripodSpreaderLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderLabel : null);\nvar autoGearTripodSpreaderModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderModeLabel : null);\nvar autoGearTripodSpreaderModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearTripodSpreaderModeSelect : null);\nvar autoGearCrewPresentSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentSelect : null);\nvar autoGearCrewPresentLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentLabel : null);\nvar autoGearCrewPresentModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentModeLabel : null);\nvar autoGearCrewPresentModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewPresentModeSelect : null);\nvar autoGearCrewAbsentSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentSelect : null);\nvar autoGearCrewAbsentLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentLabel : null);\nvar autoGearCrewAbsentModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentModeLabel : null);\nvar autoGearCrewAbsentModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearCrewAbsentModeSelect : null);\nvar autoGearWirelessSelect = (AUTO_GEAR_UI_EXPORTS.autoGearWirelessSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearWirelessSelect : null);\nvar autoGearWirelessLabel = (AUTO_GEAR_UI_EXPORTS.autoGearWirelessLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearWirelessLabel : null);\nvar autoGearWirelessModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearWirelessModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearWirelessModeLabel : null);\nvar autoGearWirelessModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearWirelessModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearWirelessModeSelect : null);\nvar autoGearMotorsSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMotorsSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMotorsSelect : null);\nvar autoGearMotorsLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMotorsLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMotorsLabel : null);\nvar autoGearMotorsModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearMotorsModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMotorsModeLabel : null);\nvar autoGearMotorsModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearMotorsModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearMotorsModeSelect : null);\nvar autoGearControllersSelect = (AUTO_GEAR_UI_EXPORTS.autoGearControllersSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearControllersSelect : null);\nvar autoGearControllersLabel = (AUTO_GEAR_UI_EXPORTS.autoGearControllersLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearControllersLabel : null);\nvar autoGearControllersModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearControllersModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearControllersModeLabel : null);\nvar autoGearControllersModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearControllersModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearControllersModeSelect : null);\nvar autoGearDistanceSelect = (AUTO_GEAR_UI_EXPORTS.autoGearDistanceSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDistanceSelect : null);\nvar autoGearDistanceLabel = (AUTO_GEAR_UI_EXPORTS.autoGearDistanceLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDistanceLabel : null);\nvar autoGearDistanceModeLabel = (AUTO_GEAR_UI_EXPORTS.autoGearDistanceModeLabel !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDistanceModeLabel : null);\nvar autoGearDistanceModeSelect = (AUTO_GEAR_UI_EXPORTS.autoGearDistanceModeSelect !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearDistanceModeSelect : null);\nvar autoGearConditionLabels = (AUTO_GEAR_UI_EXPORTS.autoGearConditionLabels !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearConditionLabels : {});\nvar autoGearConditionSelects = (AUTO_GEAR_UI_EXPORTS.autoGearConditionSelects !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearConditionSelects : {});\nvar autoGearConditionLogicLabels = (AUTO_GEAR_UI_EXPORTS.autoGearConditionLogicLabels !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearConditionLogicLabels : {});\nvar autoGearConditionLogicSelects = (AUTO_GEAR_UI_EXPORTS.autoGearConditionLogicSelects !== undefined ? AUTO_GEAR_UI_EXPORTS.autoGearConditionLogicSelects : {});\n\nconst getAutoGearScenarioModeSelectElementRef =\n  typeof AUTO_GEAR_UI_EXPORTS.getAutoGearScenarioModeSelectElement === 'function'\n    ? AUTO_GEAR_UI_EXPORTS.getAutoGearScenarioModeSelectElement\n    : () => AUTO_GEAR_UI_EXPORTS.autoGearScenarioModeSelectElement || null;\n\nconst setAutoGearScenarioModeSelectElementRef =\n  typeof AUTO_GEAR_UI_EXPORTS.setAutoGearScenarioModeSelectElement === 'function'\n    ? AUTO_GEAR_UI_EXPORTS.setAutoGearScenarioModeSelectElement\n    : value => {\n      AUTO_GEAR_UI_EXPORTS.autoGearScenarioModeSelectElement = value || null;\n    };\n\nlet autoGearScenarioModeSelectElement = getAutoGearScenarioModeSelectElementRef();\nsetAutoGearScenarioModeSelectElementRef(autoGearScenarioModeSelectElement);\n\nvar AUTO_GEAR_CONDITION_KEYS = Array.isArray(AUTO_GEAR_UI_EXPORTS.AUTO_GEAR_CONDITION_KEYS)\n  ? AUTO_GEAR_UI_EXPORTS.AUTO_GEAR_CONDITION_KEYS\n  : [\n    'always',\n    'scenarios',\n    'shootingDays',\n    'mattebox',\n    'cameraHandle',\n    'viewfinderExtension',\n    'deliveryResolution',\n    'videoDistribution',\n    'camera',\n    'ownGear',\n    'cameraWeight',\n    'monitor',\n    'tripodHeadBrand',\n    'tripodBowl',\n    'tripodTypes',\n    'tripodSpreader',\n    'crewPresent',\n    'crewAbsent',\n    'wireless',\n    'motors',\n    'controllers',\n    'distance',\n  ];\n\nconst AUTO_GEAR_REPEATABLE_CONDITIONS =\n  AUTO_GEAR_UI_EXPORTS.AUTO_GEAR_REPEATABLE_CONDITIONS instanceof Set\n    ? AUTO_GEAR_UI_EXPORTS.AUTO_GEAR_REPEATABLE_CONDITIONS\n    : new Set([\n      'scenarios',\n      'mattebox',\n      'cameraHandle',\n      'viewfinderExtension',\n      'deliveryResolution',\n      'videoDistribution',\n      'camera',\n      'ownGear',\n      'monitor',\n      'tripodHeadBrand',\n      'tripodBowl',\n      'tripodTypes',\n      'tripodSpreader',\n      'crewPresent',\n      'crewAbsent',\n      'wireless',\n      'motors',\n      'controllers',\n      'distance',\n    ]);\n\nvar AUTO_GEAR_CONDITION_FALLBACK_LABELS =\n  AUTO_GEAR_UI_EXPORTS.AUTO_GEAR_CONDITION_FALLBACK_LABELS || {\n    always: 'Always include',\n    scenarios: 'Required scenarios',\n    shootingDays: 'Shooting days condition',\n    mattebox: 'Mattebox options',\n    cameraHandle: 'Camera handles',\n    viewfinderExtension: 'Viewfinder extension',\n    deliveryResolution: 'Delivery resolution',\n    videoDistribution: 'Video distribution',\n    camera: 'Camera',\n    ownGear: 'Own gear items',\n    cameraWeight: 'Camera weight',\n    monitor: 'Onboard monitor',\n    tripodHeadBrand: 'Tripod head brand',\n    tripodBowl: 'Tripod bowl size',\n    tripodTypes: 'Tripod types',\n    tripodSpreader: 'Tripod spreader',\n    crewPresent: 'Crew present',\n    crewAbsent: 'Crew absent',\n    wireless: 'Wireless transmitter',\n    motors: 'FIZ motors',\n    controllers: 'FIZ controllers',\n    distance: 'FIZ distance devices',\n  }; function resolveFocusScalePreference() {\n    if (typeof resolveGlobalFocusScalePreference === 'function') {\n      try {\n        const resolved = resolveGlobalFocusScalePreference();\n        if (resolved === 'imperial' || resolved === 'metric') {\n          return resolved;\n        }\n        if (typeof resolved === 'string') {\n          const trimmedResolved = resolved.trim().toLowerCase();\n          if (trimmedResolved === 'imperial' || trimmedResolved === 'metric') {\n            return trimmedResolved;\n          }\n        }\n      } catch (focusScaleNormalizeError) {\n        console.warn(\n          'resolveGlobalFocusScalePreference helper threw an error while resolving a focus scale label',\n          focusScaleNormalizeError,\n        );\n      }\n    }\n\n    if (typeof focusScalePreference === 'string') {\n      const trimmedPreference = focusScalePreference.trim().toLowerCase();\n      if (trimmedPreference === 'imperial' || trimmedPreference === 'metric') {\n        return trimmedPreference;\n      }\n    }\n\n    return '';\n  }\n\nfunction normalizeFocusScaleForLabel(value) {\n  const attemptNormalize = (candidate) => {\n    if (typeof normalizeFocusScale === 'function') {\n      try {\n        const normalized = normalizeFocusScale(candidate);\n        if (normalized === 'imperial' || normalized === 'metric') {\n          return normalized;\n        }\n        if (normalized === '' || normalized === null) {\n          return '';\n        }\n      } catch (normalizeError) {\n        console.warn(\n          'normalizeFocusScale helper threw an error while resolving a focus scale label',\n          normalizeError,\n        );\n      }\n    }\n    if (typeof candidate === 'string') {\n      const trimmed = candidate.trim().toLowerCase();\n      if (trimmed === 'imperial') {\n        return 'imperial';\n      }\n      if (trimmed === 'metric') {\n        return 'metric';\n      }\n      if (!trimmed) {\n        return '';\n      }\n    }\n    return '';\n  };\n\n  const directNormalized = attemptNormalize(value);\n  if (\n    directNormalized === '' &&\n    (typeof value === 'undefined' || value === null || (typeof value === 'string' && !value.trim()))\n  ) {\n    const preference = resolveFocusScalePreference();\n    const normalizedPreference = attemptNormalize(preference);\n    if (normalizedPreference === 'imperial' || normalizedPreference === 'metric') {\n      return normalizedPreference;\n    }\n  }\n\n  return directNormalized;\n}\n\nfunction getFocusScaleLabelForLang(lang = currentLang, scale) {\n  const normalized = normalizeFocusScaleForLabel(scale);\n  const textsForLang = getLanguageTexts(lang) || {};\n  const fallbackTexts = getLanguageTexts('en') || {};\n  const metricLabel =\n    textsForLang.focusScaleMetric ||\n    fallbackTexts.focusScaleMetric ||\n    textsForLang.focusScaleSetting ||\n    fallbackTexts.focusScaleSetting ||\n    'Metric';\n  const imperialLabel =\n    textsForLang.focusScaleImperial ||\n    fallbackTexts.focusScaleImperial ||\n    textsForLang.focusScaleSetting ||\n    fallbackTexts.focusScaleSetting ||\n    'Imperial';\n  if (normalized === 'imperial') {\n    return imperialLabel;\n  }\n  if (normalized === 'metric') {\n    return metricLabel;\n  }\n  if (typeof scale === 'string') {\n    const trimmed = scale.trim();\n    if (trimmed) {\n      return trimmed;\n    }\n  }\n  return (\n    textsForLang.focusScaleSetting ||\n    textsForLang.lensFocusScaleLabel ||\n    fallbackTexts.focusScaleSetting ||\n    fallbackTexts.lensFocusScaleLabel ||\n    metricLabel\n  );\n}\n\nconst DEFAULT_LANGUAGE_SAFE = (function resolveDefaultLanguageSafe() {\n  const candidateResolvers = [\n    function resolveFromLexicalBinding() {\n      try {\n        if (typeof DEFAULT_LANGUAGE === 'string' && DEFAULT_LANGUAGE) {\n          return DEFAULT_LANGUAGE;\n        }\n      } catch (defaultLanguageLookupError) {\n        void defaultLanguageLookupError;\n      }\n      return null;\n    },\n    function resolveFromLocaleModule() {\n      try {\n        if (\n          typeof LOCALE_MODULE === 'object' &&\n          LOCALE_MODULE &&\n          typeof LOCALE_MODULE.DEFAULT_LANGUAGE === 'string' &&\n          LOCALE_MODULE.DEFAULT_LANGUAGE\n        ) {\n          return LOCALE_MODULE.DEFAULT_LANGUAGE;\n        }\n      } catch (localeModuleResolutionError) {\n        void localeModuleResolutionError;\n      }\n      return null;\n    },\n    function resolveFromLocalizationAccessors() {\n      try {\n        if (\n          typeof ACTIVE_LOCALIZATION_ACCESSORS === 'object' &&\n          ACTIVE_LOCALIZATION_ACCESSORS &&\n          typeof ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage === 'string' &&\n          ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage\n        ) {\n          return ACTIVE_LOCALIZATION_ACCESSORS.defaultLanguage;\n        }\n      } catch (accessorResolutionError) {\n        void accessorResolutionError;\n      }\n      return null;\n    },\n    function resolveFromGlobalScope() {\n      try {\n        const globalScope =\n          (typeof globalThis !== 'undefined' && globalThis) ||\n          (typeof window !== 'undefined' && window) ||\n          (typeof self !== 'undefined' && self) ||\n          (typeof global !== 'undefined' && global) ||\n          null;\n        if (\n          globalScope &&\n          typeof globalScope.DEFAULT_LANGUAGE === 'string' &&\n          globalScope.DEFAULT_LANGUAGE\n        ) {\n          return globalScope.DEFAULT_LANGUAGE;\n        }\n        if (\n          globalScope &&\n          typeof globalScope.CPP_DEFAULT_LANGUAGE_SAFE === 'string' &&\n          globalScope.CPP_DEFAULT_LANGUAGE_SAFE\n        ) {\n          return globalScope.CPP_DEFAULT_LANGUAGE_SAFE;\n        }\n      } catch (globalScopeResolutionError) {\n        void globalScopeResolutionError;\n      }\n      return null;\n    },\n  ];\n\n  for (let index = 0; index < candidateResolvers.length; index += 1) {\n    const resolved = candidateResolvers[index]();\n    if (typeof resolved === 'string' && resolved) {\n      return resolved;\n    }\n  }\n\n  return 'en';\n})();\n\nif (translationsRuntime && typeof translationsRuntime.loadLanguage === 'function') {\n  try {\n    var runtimeLoadResult = translationsRuntime.loadLanguage(DEFAULT_LANGUAGE_SAFE);\n    if (runtimeLoadResult && typeof runtimeLoadResult.then === 'function') {\n      runtimeLoadResult.catch(function handleDefaultLanguageLoadError(error) {\n        console.warn('Failed to eagerly load default translations', error);\n      });\n    }\n  } catch (defaultRuntimeError) {\n    console.warn('Failed to trigger default translation load', defaultRuntimeError);\n  }\n}\n\nconst SUPPORTED_LANGUAGES = (() => {\n  const known = new Set();\n  const addLanguage = value => {\n    if (typeof value !== 'string') {\n      return;\n    }\n    const normalized = value.trim().toLowerCase();\n    if (!normalized) {\n      return;\n    }\n    known.add(normalized);\n    const short = normalized.slice(0, 2);\n    if (short && short !== normalized) {\n      known.add(short);\n    }\n  };\n\n  if (typeof texts === 'object' && texts !== null) {\n    Object.keys(texts).forEach(addLanguage);\n  }\n\n  if (translationsRuntime && typeof translationsRuntime === 'object') {\n    if (\n      translationsRuntime.texts &&\n      typeof translationsRuntime.texts === 'object'\n    ) {\n      Object.keys(translationsRuntime.texts).forEach(addLanguage);\n    }\n\n    if (typeof translationsRuntime.getAvailableLanguages === 'function') {\n      try {\n        const runtimeLanguages = translationsRuntime.getAvailableLanguages();\n        if (Array.isArray(runtimeLanguages)) {\n          runtimeLanguages.forEach(addLanguage);\n        }\n      } catch (availableLanguagesError) {\n        console.warn(\n          'Failed to read available languages from translations runtime',\n          availableLanguagesError,\n        );\n      }\n    }\n  }\n\n  addLanguage(DEFAULT_LANGUAGE_SAFE);\n\n  return Array.from(known);\n})();\n\nfunction resolveLanguagePreference(candidate) {\n  if (!candidate) {\n    return { language: DEFAULT_LANGUAGE_SAFE, matched: false };\n  }\n\n  const normalized = String(candidate).toLowerCase();\n  if (SUPPORTED_LANGUAGES.includes(normalized)) {\n    return { language: normalized, matched: true };\n  }\n\n  const short = normalized.slice(0, 2);\n  if (SUPPORTED_LANGUAGES.includes(short)) {\n    return { language: short, matched: true };\n  }\n\n  return { language: DEFAULT_LANGUAGE_SAFE, matched: false };\n}\n\ntry {\n  const globalScope =\n    (typeof globalThis !== 'undefined' && globalThis) ||\n    (typeof window !== 'undefined' && window) ||\n    (typeof self !== 'undefined' && self) ||\n    (typeof global !== 'undefined' && global) ||\n    null;\n  if (globalScope && typeof globalScope === 'object') {\n    if (\n      typeof globalScope.CPP_DEFAULT_LANGUAGE_SAFE !== 'string' ||\n      !globalScope.CPP_DEFAULT_LANGUAGE_SAFE\n    ) {\n      globalScope.CPP_DEFAULT_LANGUAGE_SAFE = DEFAULT_LANGUAGE_SAFE;\n    }\n    if (\n      typeof globalScope.DEFAULT_LANGUAGE !== 'string' ||\n      !globalScope.DEFAULT_LANGUAGE\n    ) {\n      globalScope.DEFAULT_LANGUAGE = DEFAULT_LANGUAGE_SAFE;\n    }\n  }\n} catch (assignDefaultLanguageScopeError) {\n  void assignDefaultLanguageScopeError;\n}\n\n// Determine initial language (default English)\nvar currentLang = DEFAULT_LANGUAGE_SAFE;\nvar updateHelpQuickLinksForLanguage;\nvar updateHelpResultsSummaryText;\nlet lastRuntimeHours = null;\ntry {\n  const savedLang = localStorage.getItem(\"language\");\n  const resolvedSaved = resolveLanguagePreference(savedLang);\n  if (savedLang && resolvedSaved.matched) {\n    currentLang = resolvedSaved.language;\n  }\n  // Auto-detection disabled to enforce English default\n  /* else if (typeof navigator !== \"undefined\") {\n    const navLangs = Array.isArray(navigator.languages)\n      ? navigator.languages\n      : [navigator.language];\n    for (const lang of navLangs) {\n      const resolvedNavigator = resolveLanguagePreference(lang);\n      if (resolvedNavigator.matched) {\n        currentLang = resolvedNavigator.language;\n        break;\n      }\n    }\n  } */\n} catch (e) {\n  console.warn(\"Could not load language from localStorage\", e);\n}\n\ntry {\n  if (typeof document !== \"undefined\" && document && document.documentElement) {\n    document.documentElement.lang = currentLang;\n  }\n} catch (setLangError) {\n  void setLangError;\n}\n\n// Synchronize language selector with the initial currentLang value\nconst syncLanguageSelectorsWithCurrentLang = () => {\n  try {\n    if (typeof document !== \"undefined\" && document) {\n      const languageSelectElement = document.getElementById(\"languageSelect\");\n      if (languageSelectElement) {\n        languageSelectElement.value = currentLang;\n      }\n      const settingsLanguageElement = document.getElementById(\"settingsLanguage\");\n      if (settingsLanguageElement) {\n        settingsLanguageElement.value = currentLang;\n      }\n    }\n  } catch (syncError) {\n    console.warn(\"Could not synchronize language selectors with initial language\", syncError);\n  }\n};\n\n// Try to sync immediately (in case DOM is already loaded)\nsyncLanguageSelectorsWithCurrentLang();\n\n// Also sync on DOMContentLoaded to handle early script execution\nif (typeof document !== \"undefined\" && document) {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', syncLanguageSelectorsWithCurrentLang, { once: true });\n  } else {\n    // DOM already loaded, sync again to be safe\n    syncLanguageSelectorsWithCurrentLang();\n  }\n}\n\n// Helper to apply translations to all UI text\nasync function setLanguage(lang, options = {}) {\n  const requested = typeof lang === \"string\" ? lang : \"\";\n  const resolved = resolveLanguagePreference(requested);\n  let normalizedLang = resolved.language;\n\n  if (\n    translationsRuntime &&\n    typeof translationsRuntime.resolveLocaleKey === 'function'\n  ) {\n    try {\n      normalizedLang = translationsRuntime.resolveLocaleKey(normalizedLang);\n    } catch (resolveError) {\n      console.warn('Failed to normalize language via runtime', resolveError);\n    }\n  }\n\n  if (translationsRuntime && typeof translationsRuntime.loadLanguage === 'function') {\n    try {\n      if (typeof translationsRuntime.showLoadingState === 'function') {\n        translationsRuntime.showLoadingState(normalizedLang);\n      }\n      const loadResult = translationsRuntime.loadLanguage(normalizedLang);\n      if (loadResult && typeof loadResult.then === 'function') {\n        await loadResult;\n      }\n    } catch (loadError) {\n      console.warn(`Failed to load translations for \"${normalizedLang}\"`, loadError);\n    } finally {\n      if (typeof translationsRuntime.clearLoadingState === 'function') {\n        translationsRuntime.clearLoadingState();\n      }\n    }\n  }\n\n  const translationSource =\n    (typeof texts === 'object' && texts) ||\n    (translationsRuntime && translationsRuntime.texts) ||\n    {};\n\n  if (!translationSource[normalizedLang]) {\n    console.warn(\n      `Missing translation bundle for \"${normalizedLang}\".Falling back to ${DEFAULT_LANGUAGE_SAFE}.`\n    );\n    normalizedLang = DEFAULT_LANGUAGE_SAFE;\n  }\n  if (\n    requested &&\n    normalizedLang === DEFAULT_LANGUAGE_SAFE &&\n    !resolved.matched &&\n    requested.slice(0, 2).toLowerCase() !== DEFAULT_LANGUAGE_SAFE\n  ) {\n    console.warn(\n      `Unsupported language preference \"${requested}\".Falling back to ${DEFAULT_LANGUAGE_SAFE}.`\n    );\n  }\n\n  lang = normalizedLang;\n  if (!translationSource[lang] && translationSource[DEFAULT_LANGUAGE_SAFE]) {\n    translationSource[lang] = translationSource[DEFAULT_LANGUAGE_SAFE];\n  }\n  const previousLang = currentLang;\n  currentLang = lang;\n  ensureInstallPromptElements();\n  const shouldDispatchLanguageChange = previousLang !== lang;\n  const dispatchLanguageChange = () => {\n    if (\n      typeof window !== \"undefined\" &&\n      typeof window.dispatchEvent === \"function\" &&\n      typeof Event === \"function\"\n    ) {\n      try {\n        window.dispatchEvent(new Event(\"languagechange\"));\n      } catch (dispatchError) {\n        console.warn(\"Failed to dispatch languagechange event\", dispatchError);\n      }\n    }\n  };\n  if (shouldDispatchLanguageChange) {\n    if (typeof queueMicrotask === \"function\") {\n      queueMicrotask(dispatchLanguageChange);\n    } else if (typeof setTimeout === \"function\") {\n      setTimeout(dispatchLanguageChange, 0);\n    } else {\n      dispatchLanguageChange();\n    }\n  }\n  // persist selected language\n  try {\n    localStorage.setItem(\"language\", lang);\n  } catch (e) {\n    console.warn(\"Could not save language to localStorage\", e);\n  }\n  // ensure dropdown reflects the active language\n  if (languageSelect) {\n    languageSelect.value = lang;\n  }\n  if (settingsLanguage) {\n    settingsLanguage.value = lang;\n  }\n  // update html lang attribute for better persistence\n  document.documentElement.lang = lang;\n  // Document title and main heading share the same text\n  document.title = translationSource[lang].appTitle;\n  if (document.getElementById(\"mainTitle\")) document.getElementById(\"mainTitle\").textContent = translationSource[lang].appTitle;\n  if (document.getElementById(\"tagline\")) document.getElementById(\"tagline\").textContent = translationSource[lang].tagline;\n  const doc = typeof document !== \"undefined\" ? document : null;\n  const runtimeScope = getCoreGlobalObject();\n  const attemptRefreshDeviceLists = () => {\n    let refreshFn = null;\n    if (typeof refreshDeviceLists === 'function') {\n      refreshFn = refreshDeviceLists;\n    } else if (runtimeScope && typeof runtimeScope.refreshDeviceLists === 'function') {\n      refreshFn = runtimeScope.refreshDeviceLists.bind(runtimeScope);\n    }\n\n    if (typeof refreshFn !== 'function') {\n      return false;\n    }\n\n    try {\n      refreshFn();\n    } catch (refreshError) {\n      console.warn('setLanguage: refreshDeviceLists execution failed', refreshError);\n    }\n    return true;\n  };\n\n  if (!attemptRefreshDeviceLists()) {\n    const retryRefresh = () => {\n      attemptRefreshDeviceLists();\n    };\n    if (typeof queueMicrotask === 'function') {\n      queueMicrotask(retryRefresh);\n    } else if (typeof setTimeout === 'function') {\n      setTimeout(retryRefresh, 0);\n    }\n  }\n  const fallbackLocale = translationSource[DEFAULT_LANGUAGE_SAFE] || {};\n  const normalizeTemperatureUnitSafe = unit => {\n    if (typeof normalizeTemperatureUnit === \"function\") {\n      try {\n        return normalizeTemperatureUnit(unit);\n      } catch (normalizeError) {\n        console.warn(\n          \"normalizeTemperatureUnit helper threw an error; falling back to safe normalization\",\n          normalizeError,\n        );\n      }\n    }\n    if (typeof unit === \"string\") {\n      const trimmed = unit.trim().toLowerCase();\n      if (\n        trimmed === CORE_TEMPERATURE_UNITS?.fahrenheit ||\n        trimmed === \"fahrenheit\" ||\n        trimmed === \"f\"\n      ) {\n        return CORE_TEMPERATURE_UNITS?.fahrenheit || \"fahrenheit\";\n      }\n      if (\n        trimmed === CORE_TEMPERATURE_UNITS?.celsius ||\n        trimmed === \"celsius\" ||\n        trimmed === \"c\"\n      ) {\n        return CORE_TEMPERATURE_UNITS?.celsius || \"celsius\";\n      }\n    }\n    return CORE_TEMPERATURE_UNITS?.celsius || \"celsius\";\n  };\n  const FALLBACK_NORMALIZE_FOCUS_SCALE = value => {\n    if (typeof value === \"string\") {\n      const trimmed = value.trim().toLowerCase();\n      if (trimmed === \"imperial\" || trimmed === \"feet\" || trimmed === \"ft\") {\n        return \"imperial\";\n      }\n      if (trimmed === \"metric\" || trimmed === \"metre\" || trimmed === \"meter\" || trimmed === \"m\") {\n        return \"metric\";\n      }\n    }\n    return \"metric\";\n  };\n\n  const ensureNormalizeFocusScaleHelper = () => {\n    if (typeof normalizeFocusScale === \"function\") {\n      return normalizeFocusScale;\n    }\n    const scope =\n      typeof globalThis !== \"undefined\"\n        ? globalThis\n        : typeof window !== \"undefined\"\n          ? window\n          : typeof self !== \"undefined\"\n            ? self\n            : typeof global !== \"undefined\"\n              ? global\n              : null;\n    if (scope && typeof scope.normalizeFocusScale === \"function\") {\n      return scope.normalizeFocusScale;\n    }\n    if (scope) {\n      try {\n        Object.defineProperty(scope, \"normalizeFocusScale\", {\n          value: FALLBACK_NORMALIZE_FOCUS_SCALE,\n          writable: true,\n          configurable: true,\n        });\n      } catch (defineError) {\n        scope.normalizeFocusScale = FALLBACK_NORMALIZE_FOCUS_SCALE;\n      }\n    }\n    return FALLBACK_NORMALIZE_FOCUS_SCALE;\n  };\n\n  ensureNormalizeFocusScaleHelper();\n\n  const normalizeFocusScaleSafe = value => {\n    if (typeof normalizeFocusScale === \"function\") {\n      try {\n        const normalized = normalizeFocusScale(value);\n        if (normalized === \"imperial\" || normalized === \"metric\") {\n          return normalized;\n        }\n      } catch (normalizeError) {\n        console.warn(\n          \"normalizeFocusScale helper threw an error; falling back to safe normalization\",\n          normalizeError,\n        );\n      }\n    }\n    return FALLBACK_NORMALIZE_FOCUS_SCALE(value);\n  };\n  const resolveFocusScalePreference = () => {\n    const tryNormalize = candidate => {\n      if (typeof candidate === \"string\" && candidate) {\n        return normalizeFocusScaleSafe(candidate);\n      }\n      return null;\n    };\n    const sources = [\n      () =>\n        typeof focusScalePreference !== \"undefined\"\n          ? focusScalePreference\n          : null,\n      () =>\n        typeof sessionFocusScale !== \"undefined\"\n          ? sessionFocusScale\n          : null,\n      () => {\n        try {\n          const getter =\n            runtimeScope &&\n              runtimeScope.preferences &&\n              typeof runtimeScope.preferences.getFocusScale === \"function\"\n              ? runtimeScope.preferences.getFocusScale\n              : null;\n          if (getter) {\n            return getter();\n          }\n        } catch (focusScaleError) {\n          console.warn(\n            \"Failed to resolve focus scale preference from runtime scope; using fallback\",\n            focusScaleError,\n          );\n        }\n        return null;\n      },\n    ];\n    for (const getSource of sources) {\n      const resolved = tryNormalize(getSource());\n      if (resolved) {\n        return resolved;\n      }\n    }\n    return \"metric\";\n  };\n  const resolveLocaleString = key => {\n    if (!key) return \"\";\n    const bundle = texts[lang];\n    const value = bundle && typeof bundle[key] === \"string\" ? bundle[key] : null;\n    if (value && value.trim()) {\n      return value;\n    }\n    const fallbackValue =\n      typeof fallbackLocale[key] === \"string\" ? fallbackLocale[key] : \"\";\n    return fallbackValue;\n  };\n  const applyTextContent = (element, key, fallbackValue = \"\") => {\n    if (!element) return;\n    const text = resolveLocaleString(key) || fallbackValue;\n    element.textContent = text;\n  };\n  const createHelpLink = (\n    href,\n    text,\n    { target, highlight, isButton = true } = {}\n  ) => {\n    if (!doc) {\n      return null;\n    }\n    const link = doc.createElement(\"a\");\n    link.className = isButton ? \"help-link button-link\" : \"help-link\";\n    link.href = href;\n    if (target) {\n      link.setAttribute(\"data-help-target\", target);\n    }\n    if (highlight) {\n      link.setAttribute(\"data-help-highlight\", highlight);\n    }\n    link.textContent = text;\n    return link;\n  };\n  const applySuggestionTemplate = (element, key, builders = []) => {\n    if (!element || !doc) return;\n    const template = resolveLocaleString(key);\n    element.innerHTML = \"\";\n    if (!template) {\n      element.setAttribute(\"hidden\", \"\");\n      return;\n    }\n    element.removeAttribute(\"hidden\");\n    const fragment = doc.createDocumentFragment();\n    const regex = /%(?:(\\d+)\\$)?s/g;\n    let lastIndex = 0;\n    let autoIndex = 0;\n    let match;\n    while ((match = regex.exec(template)) !== null) {\n      const start = match.index;\n      if (start > lastIndex) {\n        fragment.appendChild(doc.createTextNode(template.slice(lastIndex, start)));\n      }\n      const index =\n        typeof match[1] === \"string\"\n          ? Math.max(parseInt(match[1], 10) - 1, 0)\n          : autoIndex++;\n      const builder = builders[index];\n      if (typeof builder === \"function\") {\n        const node = builder();\n        if (node) {\n          fragment.appendChild(node);\n        }\n      }\n      lastIndex = regex.lastIndex;\n    }\n    if (lastIndex < template.length) {\n      fragment.appendChild(doc.createTextNode(template.slice(lastIndex)));\n    }\n    element.appendChild(fragment);\n  };\n  const applySuggestionText = (element, key) => {\n    if (!element) return;\n    const text = resolveLocaleString(key);\n    element.textContent = text;\n    if (!text) {\n      element.setAttribute(\"hidden\", \"\");\n    } else {\n      element.removeAttribute(\"hidden\");\n    }\n  };\n  const resolveRuntimeValue = (name) => {\n    if (!name) return undefined;\n    if (runtimeScope && typeof runtimeScope === \"object\") {\n      try {\n        if (name in runtimeScope) {\n          return runtimeScope[name];\n        }\n      } catch (scopeError) {\n        void scopeError;\n      }\n    }\n    if (typeof globalThis !== \"undefined\" && globalThis !== runtimeScope) {\n      try {\n        if (name in globalThis) {\n          return globalThis[name];\n        }\n      } catch (globalError) {\n        void globalError;\n      }\n    }\n    return undefined;\n  };\n  const registerResolvedElement = (globalName, element) => {\n    if (!globalName || !element) {\n      return element;\n    }\n    try {\n      exposeCoreRuntimeConstant(globalName, element);\n    } catch (exposeError) {\n      void exposeError;\n    }\n    return element;\n  };\n  const resolveElement = (globalName, elementId) => {\n    let existing = null;\n    try {\n      existing = resolveRuntimeValue(globalName);\n    } catch (resolveError) {\n      console.warn(\n        `Failed to resolve runtime value for \"${globalName}\"`,\n        resolveError,\n      );\n      existing = null;\n    }\n\n    if (existing && typeof existing === \"object\") {\n      return existing;\n    }\n\n    if (doc && typeof doc.getElementById === \"function\" && elementId) {\n      try {\n        const element = doc.getElementById(elementId);\n        return registerResolvedElement(globalName, element);\n      } catch (resolveDomError) {\n        console.warn(\n          `Failed to resolve document element \"${elementId}\"`,\n          resolveDomError,\n        );\n        return null;\n      }\n    }\n\n    return null;\n  };\n  const settingsShowAutoBackupsEl = resolveElement(\n    \"settingsShowAutoBackups\",\n    \"settingsShowAutoBackups\"\n  );\n  const backupSettingsButton = resolveElement(\"backupSettings\", \"backupSettings\");\n  const backupDiffToggleButtonEl = resolveElement(\n    \"backupDiffToggleButton\",\n    \"backupDiffToggleButton\"\n  );\n  const backupDiffHeadingEl = resolveElement(\"backupDiffHeading\", \"backupDiffHeading\");\n  const backupDiffIntroEl = resolveElement(\"backupDiffIntro\", \"backupDiffIntro\");\n  const backupDiffPrimaryLabelEl = resolveElement(\n    \"backupDiffPrimaryLabel\",\n    \"backupDiffPrimaryLabel\"\n  );\n  const backupDiffPrimarySelectEl = resolveElement(\n    \"backupDiffPrimarySelect\",\n    \"backupDiffPrimary\"\n  );\n  const backupDiffSecondaryLabelEl = resolveElement(\n    \"backupDiffSecondaryLabel\",\n    \"backupDiffSecondaryLabel\"\n  );\n  const backupDiffSecondarySelectEl = resolveElement(\n    \"backupDiffSecondarySelect\",\n    \"backupDiffSecondary\"\n  );\n  const backupDiffEmptyStateEl = resolveElement(\n    \"backupDiffEmptyState\",\n    \"backupDiffEmptyState\"\n  );\n  const backupDiffNotesLabelEl = resolveElement(\n    \"backupDiffNotesLabel\",\n    \"backupDiffNotesLabel\"\n  );\n  const backupDiffNotesEl = resolveElement(\"backupDiffNotes\", \"backupDiffNotes\");\n  const backupDiffExportButtonEl = resolveElement(\n    \"backupDiffExportButton\",\n    \"backupDiffExport\"\n  );\n  const backupDiffCloseButtonEl = resolveElement(\n    \"backupDiffCloseButton\",\n    \"backupDiffClose\"\n  );\n  const restoreRehearsalButton = resolveElement(\n    \"restoreRehearsalButton\",\n    \"restoreRehearsalButton\"\n  );\n  const restoreRehearsalHeading = resolveElement(\n    \"restoreRehearsalHeading\",\n    \"restoreRehearsalHeading\"\n  );\n  const restoreRehearsalIntro = resolveElement(\n    \"restoreRehearsalIntro\",\n    \"restoreRehearsalIntro\"\n  );\n  const restoreRehearsalModeLabel = resolveElement(\n    \"restoreRehearsalModeLabel\",\n    \"restoreRehearsalModeLabel\"\n  );\n  const restoreRehearsalModeBackupText = resolveElement(\n    \"restoreRehearsalModeBackupText\",\n    \"restoreRehearsalModeBackupText\"\n  );\n  const restoreRehearsalModeProjectText = resolveElement(\n    \"restoreRehearsalModeProjectText\",\n    \"restoreRehearsalModeProjectText\"\n  );\n  const restoreRehearsalFileLabel = resolveElement(\n    \"restoreRehearsalFileLabel\",\n    \"restoreRehearsalFileLabel\"\n  );\n  const restoreRehearsalBrowse = resolveElement(\n    \"restoreRehearsalBrowse\",\n    \"restoreRehearsalBrowse\"\n  );\n  const restoreRehearsalFileName = resolveElement(\n    \"restoreRehearsalFileName\",\n    \"restoreRehearsalFileName\"\n  );\n  const restoreRehearsalStatus = resolveElement(\n    \"restoreRehearsalStatus\",\n    \"restoreRehearsalStatus\"\n  );\n  const restoreRehearsalRuleHeading = resolveElement(\n    \"restoreRehearsalRuleHeading\",\n    \"restoreRehearsalRuleHeading\"\n  );\n  const restoreRehearsalRuleIntro = resolveElement(\n    \"restoreRehearsalRuleIntro\",\n    \"restoreRehearsalRuleIntro\"\n  );\n  const restoreRehearsalRuleEmpty = resolveElement(\n    \"restoreRehearsalRuleEmpty\",\n    \"restoreRehearsalRuleEmpty\"\n  );\n  const restoreRehearsalTableCaption = resolveElement(\n    \"restoreRehearsalTableCaption\",\n    \"restoreRehearsalTableCaption\"\n  );\n  const restoreRehearsalMetricHeader = resolveElement(\n    \"restoreRehearsalMetricHeader\",\n    \"restoreRehearsalMetricHeader\"\n  );\n  const restoreRehearsalLiveHeader = resolveElement(\n    \"restoreRehearsalLiveHeader\",\n    \"restoreRehearsalLiveHeader\"\n  );\n  const restoreRehearsalSandboxHeader = resolveElement(\n    \"restoreRehearsalSandboxHeader\",\n    \"restoreRehearsalSandboxHeader\"\n  );\n  const restoreRehearsalDifferenceHeader = resolveElement(\n    \"restoreRehearsalDifferenceHeader\",\n    \"restoreRehearsalDifferenceHeader\"\n  );\n  const restoreRehearsalCloseButton = resolveElement(\n    \"restoreRehearsalCloseButton\",\n    \"restoreRehearsalClose\"\n  );\n  const restoreRehearsalProceedButton = resolveElement(\n    \"restoreRehearsalProceedButton\",\n    \"restoreRehearsalProceed\"\n  );\n  const restoreRehearsalAbortButton = resolveElement(\n    \"restoreRehearsalAbortButton\",\n    \"restoreRehearsalAbort\"\n  );\n  if (skipLink) skipLink.textContent = texts[lang].skipToContent;\n  const offlineElem = document.getElementById(\"offlineIndicator\");\n  if (offlineElem) {\n    const offlineLabel = texts[lang].offlineIndicator;\n    const offlineNotice = texts[lang].reloadAppOfflineNotice || offlineLabel;\n    const offlineHelp = texts[lang].offlineIndicatorHelp || offlineNotice;\n    const isExplicitlyOffline =\n      typeof navigator !== 'undefined' && typeof navigator.onLine === 'boolean'\n        ? navigator.onLine === false\n        : false;\n\n    if (offlineElem.dataset) {\n      offlineElem.dataset.baseLabel = offlineLabel;\n      offlineElem.dataset.baseHelp = offlineHelp;\n      offlineElem.dataset.forceReloadNotice = offlineNotice;\n      offlineElem.dataset.degradedLabel = texts[lang].offlineIndicatorDegraded || offlineNotice;\n      offlineElem.dataset.degradedHelp = texts[lang].offlineIndicatorDegradedHelp || offlineHelp;\n      offlineElem.dataset.reasonCacheFallback = texts[lang].offlineIndicatorReasonCacheFallback || offlineNotice;\n      offlineElem.dataset.reasonGetFailed = texts[lang].offlineIndicatorReasonGetFailed || offlineNotice;\n      offlineElem.dataset.reasonTimeout = texts[lang].offlineIndicatorReasonTimeout || offlineNotice;\n      offlineElem.dataset.reasonUnreachable = texts[lang].offlineIndicatorReasonUnreachable || offlineNotice;\n      offlineElem.dataset.reasonReloadBlocked = texts[lang].offlineIndicatorReasonReloadBlocked || offlineNotice;\n      offlineElem.dataset.reasonUnknown = texts[lang].offlineIndicatorReasonUnknown || offlineHelp;\n    }\n\n    if (isExplicitlyOffline) {\n      offlineElem.textContent = offlineNotice;\n      offlineElem.setAttribute('data-help', offlineNotice);\n      offlineElem.removeAttribute('hidden');\n    } else {\n      offlineElem.textContent = offlineLabel;\n      offlineElem.setAttribute('data-help', offlineHelp);\n    }\n  }\n  applyInstallTexts(lang);\n  const legalLinks = LEGAL_LINKS[lang] || LEGAL_LINKS.en;\n  const impressumElem = document.getElementById(\"impressumLink\");\n  if (impressumElem) {\n    impressumElem.textContent = texts[lang].impressum;\n    if (legalLinks?.imprint) {\n      impressumElem.setAttribute(\"href\", legalLinks.imprint);\n    }\n  }\n  const privacyElem = document.getElementById(\"privacyLink\");\n  if (privacyElem) {\n    privacyElem.textContent = texts[lang].privacy;\n    if (legalLinks?.privacy) {\n      privacyElem.setAttribute(\"href\", legalLinks.privacy);\n    }\n  }\n  // Section headings with descriptive hover help\n  const setupManageHeadingElem = document.getElementById(\"setupManageHeading\");\n  if (setupManageHeadingElem) {\n    setupManageHeadingElem.textContent = texts[lang].setupManageHeading;\n    setupManageHeadingElem.setAttribute(\n      \"data-help\",\n      texts[lang].setupManageHeadingHelp\n    );\n  }\n\n  const deviceSelectionHeadingElem = document.getElementById(\"deviceSelectionHeading\");\n  if (deviceSelectionHeadingElem) {\n    deviceSelectionHeadingElem.textContent = texts[lang].deviceSelectionHeading;\n    deviceSelectionHeadingElem.setAttribute(\n      \"data-help\",\n      texts[lang].deviceSelectionHeadingHelp\n    );\n  }\n\n  const resultsHeadingElem = document.getElementById(\"resultsHeading\");\n  if (resultsHeadingElem) {\n    resultsHeadingElem.textContent = texts[lang].resultsHeading; // Heading text and hover help both come from the active locale\n    resultsHeadingElem.setAttribute(\n      \"data-help\",\n      texts[lang].resultsHeadingHelp\n    );\n  }\n\n  const deviceManagerHeadingElem = document.getElementById(\"deviceManagerHeading\");\n  if (deviceManagerHeadingElem) {\n    deviceManagerHeadingElem.textContent = texts[lang].deviceManagerHeading;\n    deviceManagerHeadingElem.setAttribute(\n      \"data-help\",\n      texts[lang].deviceManagerHeadingHelp\n    );\n  }\n\n  const batteryComparisonHeadingElem = document.getElementById(\"batteryComparisonHeading\");\n  const batteryComparisonDescriptionElem = document.getElementById(\n    \"batteryComparisonDescription\"\n  );\n  const batteryTableElem = document.getElementById(\"batteryTable\");\n\n  const setupDiagramHeadingElem = document.getElementById(\"setupDiagramHeading\");\n  if (setupDiagramHeadingElem) {\n    setupDiagramHeadingElem.textContent = texts[lang].setupDiagramHeading;\n    setupDiagramHeadingElem.setAttribute(\n      \"data-help\",\n      texts[lang].setupDiagramHeadingHelp\n    );\n  }\n\n  const sideMenuLinks = document.querySelectorAll(\"#sideMenu [data-nav-key]\");\n  sideMenuLinks.forEach((link) => {\n    if (!link || !link.dataset) {\n      return;\n    }\n    const navKey = link.dataset.navKey;\n    if (!navKey) {\n      return;\n    }\n    const label = texts[lang][navKey];\n    if (label) {\n      if (\n        navKey === 'contactsNav' &&\n        typeof setButtonLabelWithIconBinding === 'function' &&\n        link?.tagName === 'BUTTON'\n      ) {\n        setButtonLabelWithIconBinding(\n          link,\n          label,\n          (typeof ICON_GLYPHS === 'object' && ICON_GLYPHS && ICON_GLYPHS.contacts)\n            ? ICON_GLYPHS.contacts\n            : iconGlyph('\\\\uF404', ICON_FONT_KEYS.UICONS)\n        );\n      } else {\n        link.textContent = label;\n      }\n      link.setAttribute(\"aria-label\", label);\n    }\n    const helpKey = `${navKey}Help`;\n    const helpText = texts[lang][helpKey];\n    if (helpText) {\n      link.setAttribute(\"title\", helpText);\n      link.setAttribute(\"data-help\", helpText);\n    } else {\n      if (navKey === 'projectRequirementsNav') {\n        const checkKey = `${navKey}Help`;\n        if (texts[lang] && !texts[lang][checkKey]) {\n          console.warn(`[Cine Power Planner] Missing help text for ${navKey} in lang ${lang} `);\n        }\n      }\n      link.removeAttribute(\"title\");\n      link.removeAttribute(\"data-help\");\n    }\n  });\n  applyOwnGearLocalization(lang);\n  // Setup manager labels and buttons\n  const savedSetupsLabelElem = document.getElementById(\"savedSetupsLabel\");\n  if (savedSetupsLabelElem) {\n    savedSetupsLabelElem.textContent = texts[lang].savedSetupsLabel;\n    savedSetupsLabelElem.setAttribute(\"data-help\", texts[lang].setupSelectHelp);\n  }\n  const setupNameLabelElem = document.getElementById(\"setupNameLabel\");\n  if (setupNameLabelElem) {\n    setupNameLabelElem.textContent = texts[lang].setupNameLabel;\n    setupNameLabelElem.setAttribute(\"data-help\", texts[lang].setupNameHelp);\n  }\n  if (typeof deleteSetupBtn !== 'undefined' && deleteSetupBtn) {\n    setButtonLabelWithIconBinding(deleteSetupBtn, texts[lang].deleteSetupBtn, ICON_GLYPHS.trash);\n  }\n  const sharedLinkLabelElem = document.getElementById(\"sharedLinkLabel\");\n  if (sharedLinkLabelElem) {\n    sharedLinkLabelElem.textContent = texts[lang].sharedLinkLabel;\n    sharedLinkLabelElem.setAttribute(\"data-help\", texts[lang].sharedLinkHelp);\n  }\n  if (typeof applySharedLinkBtn !== 'undefined' && applySharedLinkBtn) {\n    setButtonLabelWithIconBinding(\n      applySharedLinkBtn,\n      texts[lang].loadSharedLinkBtn,\n      ICON_GLYPHS.fileImport\n    );\n  }\n\n  // Descriptive hover help for setup management controls\n  // Descriptive hover help for setup management controls\n  const safeSetupSelect = typeof setupSelect !== 'undefined' ? setupSelect : document.getElementById('setupSelect');\n  if (safeSetupSelect) {\n    safeSetupSelect.setAttribute(\"data-help\", texts[lang].setupSelectHelp);\n  }\n  const safeSetupNameInput = typeof setupNameInput !== 'undefined' ? setupNameInput : document.getElementById('setupNameInput');\n  if (safeSetupNameInput) {\n    safeSetupNameInput.setAttribute(\"data-help\", texts[lang].setupNameHelp);\n  }\n\n  const safeDeleteSetupBtn = deleteSetupBtn;\n  if (safeDeleteSetupBtn && typeof safeDeleteSetupBtn.setAttribute === 'function') {\n    safeDeleteSetupBtn.setAttribute(\"title\", texts[lang].deleteSetupHelp);\n    safeDeleteSetupBtn.setAttribute(\"aria-label\", texts[lang].deleteSetupHelp);\n    safeDeleteSetupBtn.setAttribute(\"data-help\", texts[lang].deleteSetupHelp);\n  }\n\n  const safeSaveSetupBtn = saveSetupBtn;\n  if (safeSaveSetupBtn) {\n    safeSaveSetupBtn.setAttribute(\"title\", texts[lang].saveSetupHelp);\n    safeSaveSetupBtn.setAttribute(\"aria-label\", texts[lang].saveSetupHelp);\n    safeSaveSetupBtn.setAttribute(\"data-help\", texts[lang].saveSetupHelp);\n  }\n\n  const safeGenerateOverviewBtn = generateOverviewBtn;\n  if (safeGenerateOverviewBtn) {\n    safeGenerateOverviewBtn.setAttribute(\"title\", texts[lang].generateOverviewBtn);\n    safeGenerateOverviewBtn.setAttribute(\"data-help\", texts[lang].generateOverviewHelp);\n  }\n\n  const safeGenerateGearListBtn = generateGearListBtn;\n  if (safeGenerateGearListBtn) {\n    safeGenerateGearListBtn.setAttribute(\"title\", texts[lang].generateGearListBtn);\n    safeGenerateGearListBtn.setAttribute(\"data-help\", texts[lang].generateGearListHelp);\n  }\n\n  try {\n    const deleteGearListHelp =\n      texts[lang].deleteGearListBtnHelp || texts[lang].deleteGearListBtn;\n    const safeDeleteGearListProjectBtn = deleteGearListProjectBtn;\n    if (safeDeleteGearListProjectBtn && typeof safeDeleteGearListProjectBtn.setAttribute === 'function') {\n      setButtonLabelWithIconBinding(\n        safeDeleteGearListProjectBtn,\n        texts[lang].deleteGearListBtn,\n        ICON_GLYPHS.trash\n      );\n      safeDeleteGearListProjectBtn.setAttribute(\"title\", deleteGearListHelp);\n      safeDeleteGearListProjectBtn.setAttribute(\"data-help\", deleteGearListHelp);\n      safeDeleteGearListProjectBtn.setAttribute(\"aria-label\", deleteGearListHelp);\n    }\n  } catch (err) {\n    console.warn(\"Error setting deleteGearListProjectBtn attributes\", err);\n  }\n\n  const editProjectBtnElem = document.getElementById(\"editProjectBtn\");\n  if (editProjectBtnElem && typeof editProjectBtnElem.setAttribute === 'function') {\n    editProjectBtnElem.textContent = texts[lang].editProjectBtn;\n    editProjectBtnElem.setAttribute(\"title\", texts[lang].editProjectBtn);\n    editProjectBtnElem.setAttribute(\"data-help\", texts[lang].editProjectBtn);\n  }\n  const addExtraGearBtnElem = document.getElementById(\"addExtraGearBtn\");\n  if (addExtraGearBtnElem && typeof addExtraGearBtnElem.setAttribute === 'function') {\n    const extraLabel = texts[lang].addExtraGearBtn || texts.en?.addExtraGearBtn || \"Add temporary extra gear\";\n    addExtraGearBtnElem.textContent = extraLabel;\n    addExtraGearBtnElem.setAttribute(\"title\", extraLabel);\n    addExtraGearBtnElem.setAttribute(\"data-help\", extraLabel);\n  }\n\n  if (shareSetupBtn) {\n    shareSetupBtn.setAttribute(\"title\", texts[lang].shareSetupBtn);\n    shareSetupBtn.setAttribute(\"data-help\", texts[lang].shareSetupHelp);\n  }\n\n  if (shareDialogHeadingElem) {\n    const heading = texts[lang].shareDialogTitle\n      || texts.en?.shareDialogTitle\n      || shareDialogHeadingElem.textContent;\n    shareDialogHeadingElem.textContent = heading;\n  }\n\n  if (shareFilenameLabelElem) {\n    const filenameLabel = texts[lang].shareFilenameLabel\n      || texts.en?.shareFilenameLabel\n      || shareFilenameLabelElem.textContent;\n    shareFilenameLabelElem.textContent = filenameLabel;\n  }\n\n  if (shareConfirmBtn) {\n    const confirmLabel = texts[lang].shareDialogConfirm\n      || texts.en?.shareDialogConfirm\n      || shareConfirmBtn.textContent;\n    setButtonLabelWithIconBinding(shareConfirmBtn, confirmLabel, ICON_GLYPHS.fileExport);\n    shareConfirmBtn.setAttribute('title', confirmLabel);\n    shareConfirmBtn.setAttribute('aria-label', confirmLabel);\n    shareConfirmBtn.setAttribute('data-help', texts[lang].shareSetupHelp);\n  }\n\n  if (shareCancelBtn) {\n    const cancelLabel = texts[lang].shareDialogCancel\n      || texts.en?.shareDialogCancel\n      || shareCancelBtn.textContent;\n    setButtonLabelWithIconBinding(shareCancelBtn, cancelLabel, ICON_GLYPHS.circleX);\n    shareCancelBtn.setAttribute('title', cancelLabel);\n    shareCancelBtn.setAttribute('aria-label', cancelLabel);\n  }\n\n  if (shareIncludeAutoGearText) {\n    const label = texts[lang].shareIncludeAutoGearLabel\n      || texts.en?.shareIncludeAutoGearLabel\n      || shareIncludeAutoGearText.textContent;\n    shareIncludeAutoGearText.textContent = label;\n    const help = texts[lang].shareIncludeAutoGearHelp\n      || texts.en?.shareIncludeAutoGearHelp\n      || label;\n    if (shareIncludeAutoGearLabelElem && typeof shareIncludeAutoGearLabelElem.setAttribute === 'function') {\n      shareIncludeAutoGearLabelElem.setAttribute('data-help', help);\n    }\n    if (shareIncludeAutoGearCheckbox) {\n      shareIncludeAutoGearCheckbox.setAttribute('aria-label', label);\n    }\n  }\n\n  if (shareIncludeOwnedGearText) {\n    const label = texts[lang].shareIncludeOwnedGearLabel\n      || texts.en?.shareIncludeOwnedGearLabel\n      || shareIncludeOwnedGearText.textContent;\n    shareIncludeOwnedGearText.textContent = label;\n    const help = texts[lang].shareIncludeOwnedGearHelp\n      || texts.en?.shareIncludeOwnedGearHelp\n      || label;\n    if (shareIncludeOwnedGearLabelElem && typeof shareIncludeOwnedGearLabelElem.setAttribute === 'function') {\n      shareIncludeOwnedGearLabelElem.setAttribute('data-help', help);\n    }\n    if (shareIncludeOwnedGearCheckbox) {\n      shareIncludeOwnedGearCheckbox.setAttribute('aria-label', label);\n    }\n  }\n\n  let sharedImportLegendText = sharedImportLegend ? sharedImportLegend.textContent : '';\n  if (sharedImportDialogHeading) {\n    const title = texts[lang].sharedImportDialogTitle\n      || texts.en?.sharedImportDialogTitle\n      || sharedImportDialogHeading.textContent;\n    sharedImportDialogHeading.textContent = title;\n  }\n  if (sharedImportDialogMessage) {\n    const message = texts[lang].sharedImportDialogMessage\n      || texts.en?.sharedImportDialogMessage\n      || sharedImportDialogMessage.textContent;\n    sharedImportDialogMessage.textContent = message;\n    sharedImportDialogMessage.setAttribute('data-help', message);\n  }\n  if (sharedImportConfirmBtn) {\n    const label = texts[lang].sharedImportDialogConfirm\n      || texts.en?.sharedImportDialogConfirm\n      || sharedImportConfirmBtn.textContent;\n    setButtonLabelWithIconBinding(sharedImportConfirmBtn, label, ICON_GLYPHS.check);\n    sharedImportConfirmBtn.setAttribute('data-help', label);\n  }\n  if (sharedImportCancelBtn) {\n    const label = texts[lang].sharedImportDialogCancel\n      || texts.en?.sharedImportDialogCancel\n      || sharedImportCancelBtn.textContent;\n    setButtonLabelWithIconBinding(sharedImportCancelBtn, label, ICON_GLYPHS.circleX);\n    sharedImportCancelBtn.setAttribute('data-help', label);\n  }\n  if (sharedImportLegend) {\n    const legend = texts[lang].sharedImportAutoGearLabel\n      || texts.en?.sharedImportAutoGearLabel\n      || sharedImportLegend.textContent;\n    sharedImportLegend.textContent = legend;\n    sharedImportLegendText = legend;\n    if (sharedImportOptions) {\n      sharedImportOptions.setAttribute('data-help', legend);\n    }\n  }\n  if (sharedImportModeSelect && sharedImportLegendText) {\n    sharedImportModeSelect.setAttribute('aria-label', sharedImportLegendText);\n    sharedImportModeSelect.setAttribute('data-help', sharedImportLegendText);\n  }\n  if (sharedImportModeNoneOption) {\n    const label = texts[lang].sharedImportAutoGearNone\n      || texts.en?.sharedImportAutoGearNone\n      || sharedImportModeNoneOption.textContent;\n    sharedImportModeNoneOption.textContent = label;\n    const help = texts[lang].sharedImportAutoGearNoneHelp\n      || texts.en?.sharedImportAutoGearNoneHelp\n      || label;\n    sharedImportModeNoneOption.setAttribute('data-help', help);\n    sharedImportModeNoneOption.setAttribute('title', help);\n    sharedImportModeNoneOption.setAttribute('aria-label', label);\n  }\n  if (sharedImportModeProjectOption) {\n    const label = texts[lang].sharedImportAutoGearProject\n      || texts.en?.sharedImportAutoGearProject\n      || sharedImportModeProjectOption.textContent;\n    sharedImportModeProjectOption.textContent = label;\n    const help = texts[lang].sharedImportAutoGearProjectHelp\n      || texts.en?.sharedImportAutoGearProjectHelp\n      || label;\n    sharedImportModeProjectOption.setAttribute('data-help', help);\n    sharedImportModeProjectOption.setAttribute('title', help);\n    sharedImportModeProjectOption.setAttribute('aria-label', label);\n  }\n  if (sharedImportModeGlobalOption) {\n    const label = texts[lang].sharedImportAutoGearGlobal\n      || texts.en?.sharedImportAutoGearGlobal\n      || sharedImportModeGlobalOption.textContent;\n    sharedImportModeGlobalOption.textContent = label;\n    const help = texts[lang].sharedImportAutoGearGlobalHelp\n      || texts.en?.sharedImportAutoGearGlobalHelp\n      || label;\n    sharedImportModeGlobalOption.setAttribute('data-help', help);\n    sharedImportModeGlobalOption.setAttribute('title', help);\n    sharedImportModeGlobalOption.setAttribute('aria-label', label);\n  }\n\n  if (applySharedLinkBtn) {\n    applySharedLinkBtn.setAttribute(\"title\", texts[lang].loadSharedLinkBtn);\n    applySharedLinkBtn.setAttribute(\"data-help\", texts[lang].applySharedLinkHelp);\n  }\n\n  if (runtimeFeedbackBtn) {\n    runtimeFeedbackBtn.setAttribute(\"title\", texts[lang].runtimeFeedbackBtn);\n    runtimeFeedbackBtn.setAttribute(\"data-help\", texts[lang].runtimeFeedbackBtnHelp);\n    setButtonLabelWithIconBinding(runtimeFeedbackBtn, texts[lang].runtimeFeedbackBtn, ICON_GLYPHS.feedback);\n  }\n  // Update the \"-- New Setup --\" option text\n  if (setupSelect && setupSelect.options && setupSelect.options.length > 0) {\n    setupSelect.options[0].textContent = texts[lang].newSetupOption;\n  }\n  checkSetupChanged();\n  // Device selection labels with help\n  const cameraLabelElem = document.getElementById(\"cameraLabel\");\n  if (cameraLabelElem) {\n    cameraLabelElem.textContent = texts[lang].cameraLabel;\n    cameraLabelElem.setAttribute(\"data-help\", texts[lang].cameraSelectHelp);\n  }\n\n  const monitorLabelElem = document.getElementById(\"monitorLabel\");\n  if (monitorLabelElem) {\n    monitorLabelElem.textContent = texts[lang].monitorLabel;\n    monitorLabelElem.setAttribute(\"data-help\", texts[lang].monitorSelectHelp);\n  }\n\n  const videoLabelElem = document.getElementById(\"videoLabel\");\n  if (videoLabelElem) {\n    videoLabelElem.textContent = texts[lang].videoLabel;\n    videoLabelElem.setAttribute(\"data-help\", texts[lang].videoSelectHelp);\n  }\n\n  const cageLabelElem = document.getElementById(\"cageLabel\");\n  if (cageLabelElem) {\n    cageLabelElem.textContent = texts[lang].cageLabel;\n    cageLabelElem.setAttribute(\"data-help\", texts[lang].cageSelectHelp);\n  }\n\n  const distanceLabelElem = document.getElementById(\"distanceLabel\");\n  if (distanceLabelElem) {\n    distanceLabelElem.textContent = texts[lang].distanceLabel;\n    distanceLabelElem.setAttribute(\"data-help\", texts[lang].distanceSelectHelp);\n  }\n\n  const batteryPlateLabelElem = document.getElementById(\"batteryPlateLabel\");\n  if (batteryPlateLabelElem) {\n    batteryPlateLabelElem.textContent = texts[lang].batteryPlateLabel;\n    batteryPlateLabelElem.setAttribute(\"data-help\", texts[lang].batteryPlateSelectHelp);\n  }\n\n  const batteryHotswapLabelElem = document.getElementById(\"batteryHotswapLabel\");\n  if (batteryHotswapLabelElem) {\n    batteryHotswapLabelElem.textContent = texts[lang].batteryHotswapLabel;\n    batteryHotswapLabelElem.setAttribute(\"data-help\", texts[lang].batteryHotswapSelectHelp);\n  }\n\n  updateBatteryLabel();\n  // FIZ legend and labels\n  const fizLegendElem = document.getElementById(\"fizLegend\");\n  if (fizLegendElem) {\n    fizLegendElem.textContent = texts[lang].fizLegend;\n    fizLegendElem.setAttribute(\"data-help\", texts[lang].fizLegendHelp);\n  }\n  const fizMotorsLabelElem = document.getElementById(\"fizMotorsLabel\");\n  if (fizMotorsLabelElem) {\n    fizMotorsLabelElem.textContent = texts[lang].fizMotorsLabel;\n    fizMotorsLabelElem.setAttribute(\"data-help\", texts[lang].fizMotorsHelp);\n  }\n  const fizControllersLabelElem = document.getElementById(\"fizControllersLabel\");\n  if (fizControllersLabelElem) {\n    fizControllersLabelElem.textContent = texts[lang].fizControllersLabel;\n    fizControllersLabelElem.setAttribute(\n      \"data-help\",\n      texts[lang].fizControllersHelp\n    );\n  }\n  document\n    .querySelectorAll('#motorNotesLabel,#controllerNotesLabel,#distanceNotesLabel')\n    .forEach(el => {\n      el.textContent = texts[lang].notesLabel;\n    });\n\n  var cineResultsModule = typeof cineResults === 'object' ? cineResults : null;\n  var resultsLocalizationApplied = false;\n  if (cineResultsModule && typeof cineResultsModule.localizeResultsSection === 'function') {\n    try {\n      resultsLocalizationApplied = cineResultsModule.localizeResultsSection({\n        lang: lang,\n        langTexts: texts[lang] || {},\n        fallbackTexts: texts.en || {},\n        document: document,\n        breakdownListElem:\n          typeof breakdownListElem !== 'undefined' && breakdownListElem\n            ? breakdownListElem\n            : null,\n        elements: {\n          totalPowerLabel: document.getElementById('totalPowerLabel'),\n          batteryCountLabel: document.getElementById('batteryCountLabel'),\n          pinWarning: typeof pinWarnElem !== 'undefined' ? pinWarnElem : null,\n          dtapWarning: typeof dtapWarnElem !== 'undefined' ? dtapWarnElem : null,\n          hotswapWarning: typeof hotswapWarnElem !== 'undefined' ? hotswapWarnElem : null,\n          powerWarningTitle:\n            typeof powerWarningTitleElem !== 'undefined' ? powerWarningTitleElem : null,\n          powerWarningLimitsHeading:\n            typeof powerWarningLimitsHeadingElem !== 'undefined'\n              ? powerWarningLimitsHeadingElem\n              : null,\n          powerWarningAdvice:\n            typeof powerWarningAdviceElem !== 'undefined' ? powerWarningAdviceElem : null,\n          powerWarningCloseBtn:\n            typeof powerWarningCloseBtn !== 'undefined' ? powerWarningCloseBtn : null,\n          batteryLifeUnit: document.getElementById('batteryLifeUnit'),\n          batteryLifeLabel:\n            typeof batteryLifeLabelElem !== 'undefined'\n              ? batteryLifeLabelElem\n              : document.getElementById('batteryLifeLabel'),\n          runtimeAverageNote:\n            typeof runtimeAverageNoteElem !== 'undefined'\n              ? runtimeAverageNoteElem\n              : document.getElementById('runtimeAverageNote'),\n          tempNote: document.getElementById('temperatureNote'),\n        },\n        refreshTotalCurrentLabels:\n          typeof refreshTotalCurrentLabels === 'function'\n            ? refreshTotalCurrentLabels\n            : null,\n        updateMountVoltageSettingLabels:\n          typeof updateMountVoltageSettingLabels === 'function'\n            ? updateMountVoltageSettingLabels\n            : null,\n        getCurrentSetupKey:\n          typeof getCurrentSetupKey === 'function' ? getCurrentSetupKey : null,\n        renderFeedbackTable:\n          typeof renderFeedbackTable === 'function' ? renderFeedbackTable : null,\n        dispatchTemperatureNoteRender:\n          typeof dispatchTemperatureNoteRender === 'function'\n            ? dispatchTemperatureNoteRender\n            : null,\n        refreshFeedbackTemperatureLabel:\n          typeof refreshFeedbackTemperatureLabel === 'function'\n            ? refreshFeedbackTemperatureLabel\n            : null,\n        updateFeedbackTemperatureOptions:\n          typeof updateFeedbackTemperatureOptions === 'function'\n            ? updateFeedbackTemperatureOptions\n            : null,\n        lastRuntimeHours:\n          typeof lastRuntimeHours !== 'undefined' ? lastRuntimeHours : null,\n        temperatureUnit:\n          typeof temperatureUnit !== 'undefined' ? temperatureUnit : null,\n        setButtonLabelWithIcon:\n          typeof setButtonLabelWithIconBinding === 'function'\n            ? setButtonLabelWithIconBinding\n            : null,\n        iconGlyphs: typeof ICON_GLYPHS !== 'undefined' ? ICON_GLYPHS : null,\n      });\n    } catch (cineResultsError) {\n      console.warn('cineResults.localizeResultsSection failed', cineResultsError);\n      resultsLocalizationApplied = false;\n    }\n  }\n\n  var batteryComparisonLocalized = false;\n  if (\n    cineResultsModule &&\n    typeof cineResultsModule.localizeBatteryComparisonSection === \"function\"\n  ) {\n    try {\n      batteryComparisonLocalized = cineResultsModule.localizeBatteryComparisonSection({\n        lang: lang,\n        langTexts: texts[lang] || {},\n        fallbackTexts: texts.en || {},\n        document: document,\n        batteryComparisonHeading: batteryComparisonHeadingElem,\n        batteryComparisonDescription: batteryComparisonDescriptionElem,\n        batteryComparisonTable: batteryTableElem,\n      });\n    } catch (cineResultsError) {\n      console.warn(\"cineResults.localizeBatteryComparisonSection failed\", cineResultsError);\n      batteryComparisonLocalized = false;\n    }\n  }\n\n  if (!batteryComparisonLocalized) {\n    if (batteryComparisonHeadingElem) {\n      batteryComparisonHeadingElem.textContent = texts[lang].batteryComparisonHeading;\n      batteryComparisonHeadingElem.setAttribute(\n        \"data-help\",\n        texts[lang].batteryComparisonHeadingHelp\n      );\n    }\n    if (batteryComparisonDescriptionElem) {\n      batteryComparisonDescriptionElem.textContent =\n        texts[lang].batteryComparisonDescription;\n      if (texts[lang].batteryComparisonDescriptionHelp) {\n        batteryComparisonDescriptionElem.setAttribute(\n          \"data-help\",\n          texts[lang].batteryComparisonDescriptionHelp\n        );\n      } else {\n        batteryComparisonDescriptionElem.removeAttribute(\"data-help\");\n      }\n    }\n    if (batteryTableElem) {\n      if (texts[lang].batteryComparisonTableHelp) {\n        batteryTableElem.setAttribute(\n          \"data-help\",\n          texts[lang].batteryComparisonTableHelp\n        );\n      } else {\n        batteryTableElem.removeAttribute(\"data-help\");\n      }\n    }\n  }\n\n  if (!resultsLocalizationApplied) {\n    // Results labels\n    const resultsPlainSummaryElem = document.getElementById(\"resultsPlainSummary\");\n    if (resultsPlainSummaryElem) {\n      resultsPlainSummaryElem.setAttribute(\n        \"data-help\",\n        texts[lang].resultsPlainSummaryHelp\n      );\n    }\n    const resultsPlainSummaryTitleElem = document.getElementById(\"resultsPlainSummaryTitle\");\n    if (resultsPlainSummaryTitleElem) {\n      resultsPlainSummaryTitleElem.textContent = texts[lang].resultsPlainSummaryTitle;\n    }\n    const resultsPlainSummaryTextElem = document.getElementById(\"resultsPlainSummaryText\");\n    if (resultsPlainSummaryTextElem) {\n      resultsPlainSummaryTextElem.textContent = texts[lang].resultsPlainSummaryPrompt;\n    }\n    const resultsPlainSummaryNoteElem = document.getElementById(\"resultsPlainSummaryNote\");\n    if (resultsPlainSummaryNoteElem) {\n      resultsPlainSummaryNoteElem.textContent = texts[lang].resultsPlainSummaryNote;\n    }\n    const breakdownListTarget =\n      typeof breakdownListElem !== \"undefined\" && breakdownListElem\n        ? breakdownListElem\n        : document.getElementById('breakdownList');\n    if (breakdownListTarget) {\n      breakdownListTarget.setAttribute(\"data-help\", texts[lang].breakdownListHelp);\n    }\n\n    const totalPowerLabelElem = document.getElementById(\"totalPowerLabel\");\n    if (totalPowerLabelElem && texts[lang]) {\n      totalPowerLabelElem.textContent = texts[lang].totalPowerLabel;\n      totalPowerLabelElem.setAttribute(\"data-help\", texts[lang].totalPowerHelp);\n    }\n\n    if (typeof refreshTotalCurrentLabels === 'function') {\n      refreshTotalCurrentLabels(lang);\n    }\n    updateMountVoltageSettingLabels(lang);\n\n    const batteryCountLabelElem = document.getElementById(\"batteryCountLabel\");\n    if (batteryCountLabelElem) {\n      batteryCountLabelElem.textContent = texts[lang].batteryCountLabel;\n      batteryCountLabelElem.setAttribute(\n        \"data-help\",\n        texts[lang].batteryCountHelp\n      );\n    }\n\n    if (pinWarnElem)\n      pinWarnElem.setAttribute(\"data-help\", texts[lang].pinWarningHelp);\n    if (dtapWarnElem)\n      dtapWarnElem.setAttribute(\"data-help\", texts[lang].dtapWarningHelp);\n    if (hotswapWarnElem)\n      hotswapWarnElem.setAttribute(\"data-help\", texts[lang].hotswapWarningHelp);\n    if (powerWarningTitleElem)\n      powerWarningTitleElem.textContent = texts[lang].powerWarningTitle;\n    if (powerWarningLimitsHeadingElem)\n      powerWarningLimitsHeadingElem.textContent = texts[lang].powerWarningLimitsHeading;\n    if (powerWarningAdviceElem)\n      powerWarningAdviceElem.textContent = texts[lang].powerWarningAdvice;\n    if (powerWarningCloseBtn)\n      setButtonLabelWithIconBinding(powerWarningCloseBtn, texts[lang].powerWarningClose, ICON_GLYPHS.check);\n    const unitElem = document.getElementById(\"batteryLifeUnit\");\n    if (unitElem) unitElem.textContent = texts[lang].batteryLifeUnit;\n    const fb = renderFeedbackTable(getCurrentSetupKey());\n    if (batteryLifeLabelElem) {\n      let label = texts[lang].batteryLifeLabel;\n      if (fb) {\n        const userNote = texts[lang].runtimeUserCountNote.replace('{count}', fb.count);\n        const idx = label.indexOf(')');\n        if (idx !== -1) {\n          label = `${label.slice(0, idx)}, ${userNote}${label.slice(idx)} `;\n        }\n      }\n      batteryLifeLabelElem.textContent = label;\n      batteryLifeLabelElem.setAttribute(\n        \"data-help\",\n        texts[lang].batteryLifeHelp\n      );\n    }\n    if (runtimeAverageNoteElem) {\n      runtimeAverageNoteElem.textContent =\n        fb && fb.count > 4 ? texts[lang].runtimeAverageNote : '';\n    }\n    dispatchTemperatureNoteRender(lastRuntimeHours);\n    if (typeof refreshFeedbackTemperatureLabel === 'function') {\n      refreshFeedbackTemperatureLabel(lang, temperatureUnit);\n    }\n    updateFeedbackTemperatureOptions(lang, temperatureUnit);\n    const tempNoteElem = document.getElementById(\"temperatureNote\");\n    if (tempNoteElem)\n      tempNoteElem.setAttribute(\"data-help\", texts[lang].temperatureNoteHelp);\n  }\n\n  // Device manager section localization\n  const safeSetText = (id, text) => {\n    const el = document.getElementById(id);\n    if (el && text !== undefined) el.textContent = text;\n    return el;\n  };\n  const safeSetAttr = (id, attr, value) => {\n    const el = document.getElementById(id);\n    if (el && attr && value !== undefined) el.setAttribute(attr, value);\n    return el;\n  };\n\n  safeSetText(\"addDeviceHeading\", texts[lang].addDeviceHeading);\n  safeSetText(\"categoryLabel\", texts[lang].categoryLabel);\n  safeSetText(\"subcategoryLabel\", texts[lang].subcategoryLabel);\n  safeSetText(\"deviceNameLabel\", texts[lang].deviceNameLabel);\n  safeSetText(\"consumptionLabel\", texts[lang].consumptionLabel);\n  safeSetText(\"capacityLabel\", texts[lang].capacityLabel);\n  safeSetText(\"pinLabel\", texts[lang].pinLabel);\n  safeSetText(\"dtapLabel\", texts[lang].dtapLabel);\n  safeSetText(\"cameraWattLabel\", texts[lang].cameraWattLabel);\n  safeSetText(\"cameraVoltageLabel\", texts[lang].cameraVoltageLabel);\n  safeSetText(\"cameraPortTypeLabel\", texts[lang].cameraPortTypeLabel);\n  safeSetText(\"cameraPlatesLabel\", texts[lang].cameraPlatesLabel);\n  safeSetText(\"cameraMediaLabel\", texts[lang].cameraMediaLabel);\n  safeSetText(\"cameraLensMountLabel\", texts[lang].cameraLensMountLabel);\n  safeSetText(\"cameraPowerDistLabel\", texts[lang].powerDistributionLabel);\n  safeSetText(\"cameraVideoOutputsLabel\", texts[lang].videoOutputsLabel);\n  safeSetText(\"cameraFIZConnectorLabel\", texts[lang].fizConnectorLabel);\n  safeSetText(\"cameraViewfinderLabel\", texts[lang].viewfinderLabel);\n  safeSetText(\"cameraTimecodeLabel\", texts[lang].timecodeLabel);\n  safeSetText(\"powerInputsHeading\", texts[lang].powerInputsHeading);\n  safeSetText(\"powerDistributionHeading\", texts[lang].powerDistributionHeading);\n  safeSetText(\"videoOutputsHeading\", texts[lang].videoOutputsHeading);\n  safeSetText(\"fizConnectorHeading\", texts[lang].fizConnectorHeading);\n  safeSetText(\"mediaHeading\", texts[lang].mediaHeading);\n  safeSetText(\"viewfinderHeading\", texts[lang].viewfinderHeading);\n  safeSetText(\"lensMountHeading\", texts[lang].lensMountHeading);\n  const lensDeviceMountHeadingElem = safeSetText(\"lensDeviceMountHeading\", texts[lang].lensDeviceMountHeading);\n  const lensDeviceMountLabelElem = safeSetText(\"lensDeviceMountLabel\", texts[lang].lensDeviceMountLabel);\n  if (lensDeviceMountLabelElem) {\n    safeSetAttr(\"lensDeviceMountLabel\", 'data-help', texts[lang].lensDeviceMountHelp);\n  }\n  const lensFocusScaleLabelElem = safeSetText(\"lensFocusScaleUnitLabel\", texts[lang].lensFocusScaleLabel || texts[lang].focusScaleSetting);\n  if (lensFocusScaleLabelElem) {\n    const focusScaleLabel = texts[lang].lensFocusScaleLabel || texts[lang].focusScaleSetting;\n    const focusScaleHelp = texts[lang].lensFocusScaleHelp\n      || texts[lang].lensFocusScaleLabel\n      || texts[lang].focusScaleSettingHelp\n      || focusScaleLabel;\n    safeSetAttr(\"lensFocusScaleUnitLabel\", 'data-help', focusScaleHelp);\n    if (lensFocusScaleSelect) {\n      lensFocusScaleSelect.setAttribute('data-help', focusScaleHelp);\n      lensFocusScaleSelect.setAttribute('aria-label', focusScaleLabel);\n    }\n  }\n  updateLensFocusScaleSelectOptions(lang);\n  safeSetText(\"timecodeHeading\", texts[lang].timecodeHeading);\n  safeSetText(\"monitorScreenSizeLabel\", texts[lang].monitorScreenSizeLabel);\n  safeSetText(\"monitorBrightnessLabel\", texts[lang].monitorBrightnessLabel);\n  safeSetText(\"monitorWattLabel\", texts[lang].monitorWattLabel);\n  safeSetText(\"monitorVoltageLabel\", texts[lang].monitorVoltageLabel);\n  safeSetText(\"monitorPortTypeLabel\", texts[lang].monitorPortTypeLabel);\n  safeSetText(\"monitorVideoInputsHeading\", texts[lang].monitorVideoInputsHeading);\n  safeSetText(\"monitorVideoOutputsHeading\", texts[lang].monitorVideoOutputsHeading);\n  safeSetText(\"monitorVideoInputsLabel\", texts[lang].monitorVideoInputsLabel);\n  safeSetText(\"monitorVideoOutputsLabel\", texts[lang].monitorVideoOutputsLabel);\n  safeSetText(\"monitorWirelessTxLabel\", texts[lang].monitorWirelessTxLabel);\n  const monitorLatencyLabelElem = safeSetText(\"monitorLatencyLabel\", texts[lang].monitorLatencyLabel);\n  if (monitorLatencyLabelElem) {\n    const monitorLatencyHelpText = texts[lang].monitorLatencyHelp;\n    if (monitorLatencyHelpText) {\n      monitorLatencyLabelElem.setAttribute('data-help', monitorLatencyHelpText);\n      monitorLatencyLabelElem.setAttribute('title', monitorLatencyHelpText);\n      if (monitorLatencyInput) {\n        monitorLatencyInput.setAttribute('data-help', monitorLatencyHelpText);\n        monitorLatencyInput.setAttribute('title', monitorLatencyHelpText);\n      }\n    } else {\n      monitorLatencyLabelElem.removeAttribute('data-help');\n      monitorLatencyLabelElem.removeAttribute('title');\n      if (monitorLatencyInput) {\n        monitorLatencyInput.removeAttribute('data-help');\n        monitorLatencyInput.removeAttribute('title');\n      }\n    }\n  }\n  safeSetText(\"monitorAudioOutputLabel\", texts[lang].monitorAudioOutputLabel);\n  safeSetText(\"viewfinderDetailsHeading\", texts[lang].viewfinderDetailsHeading);\n  safeSetText(\"viewfinderScreenSizeLabel\", texts[lang].viewfinderScreenSizeLabel);\n  safeSetText(\"viewfinderBrightnessLabel\", texts[lang].viewfinderBrightnessLabel);\n  safeSetText(\"viewfinderWattLabel\", texts[lang].viewfinderWattLabel);\n  safeSetText(\"viewfinderVoltageLabel\", texts[lang].viewfinderVoltageLabel);\n  safeSetText(\"viewfinderPortTypeLabel\", texts[lang].viewfinderPortTypeLabel);\n  safeSetText(\"viewfinderVideoInputsHeading\", texts[lang].viewfinderVideoInputsHeading);\n  safeSetText(\"viewfinderVideoOutputsHeading\", texts[lang].viewfinderVideoOutputsHeading);\n  safeSetText(\"viewfinderVideoInputsLabel\", texts[lang].viewfinderVideoInputsLabel);\n  safeSetText(\"viewfinderVideoOutputsLabel\", texts[lang].viewfinderVideoOutputsLabel);\n  safeSetText(\"viewfinderWirelessTxLabel\", texts[lang].viewfinderWirelessTxLabel);\n  const viewfinderLatencyLabelElem = safeSetText(\"viewfinderLatencyLabel\", texts[lang].viewfinderLatencyLabel);\n  if (viewfinderLatencyLabelElem) {\n    viewfinderLatencyLabelElem.textContent = texts[lang].viewfinderLatencyLabel;\n    const viewfinderLatencyHelpText = texts[lang].viewfinderLatencyHelp;\n    if (viewfinderLatencyHelpText) {\n      viewfinderLatencyLabelElem.setAttribute('data-help', viewfinderLatencyHelpText);\n      viewfinderLatencyLabelElem.setAttribute('title', viewfinderLatencyHelpText);\n      if (viewfinderLatencyInput) {\n        viewfinderLatencyInput.setAttribute('data-help', viewfinderLatencyHelpText);\n        viewfinderLatencyInput.setAttribute('title', viewfinderLatencyHelpText);\n      }\n    } else {\n      viewfinderLatencyLabelElem.removeAttribute('data-help');\n      viewfinderLatencyLabelElem.removeAttribute('title');\n      if (viewfinderLatencyInput) {\n        viewfinderLatencyInput.removeAttribute('data-help');\n        viewfinderLatencyInput.removeAttribute('title');\n      }\n    }\n  }\n  safeSetText(\"videoPowerInputsHeading\", texts[lang].videoPowerInputsHeading || texts[lang].powerInputsHeading || 'Power Inputs');\n  const videoPowerLabelElem = document.getElementById(\"videoPowerInputLabel\");\n  if (videoPowerLabelElem) {\n    videoPowerLabelElem.textContent = texts[lang].videoPowerInputLabel || texts[lang].powerInputsHeading;\n    const powerHelp = texts[lang].videoPowerInputHelp || '';\n    if (powerHelp) {\n      videoPowerLabelElem.setAttribute('data-help', powerHelp);\n      videoPowerLabelElem.setAttribute('title', powerHelp);\n    } else {\n      videoPowerLabelElem.removeAttribute('data-help');\n      videoPowerLabelElem.removeAttribute('title');\n    }\n  }\n  safeSetText(\"videoVideoInputsHeading\", texts[lang].videoVideoInputsHeading);\n  safeSetText(\"videoVideoInputsLabel\", texts[lang].videoVideoInputsLabel);\n  safeSetText(\"videoVideoOutputsHeading\", texts[lang].videoVideoOutputsHeading);\n  safeSetText(\"videoVideoOutputsLabel\", texts[lang].videoVideoOutputsLabel);\n  safeSetText(\"monitorDetailsHeading\", texts[lang].monitorDetailsHeading);\n  safeSetText(\"monitorPowerHeading\", texts[lang].monitorPowerHeading);\n\n  // Determine text for Add/Update button\n  const addDeviceLabel = (texts[lang] && texts[lang].addDeviceBtn) || \"Add\";\n  const updateDeviceLabel = (texts[lang] && texts[lang].updateDeviceBtn) || \"Update\";\n  const addDeviceBtnElem = document.getElementById(\"addDeviceBtn\");\n  if (addDeviceBtnElem) {\n    if (addDeviceBtnElem.dataset && addDeviceBtnElem.dataset.mode === \"edit\") {\n      setButtonLabelWithIconBinding(addDeviceBtnElem, updateDeviceLabel, ICON_GLYPHS.save);\n      addDeviceBtnElem.setAttribute('data-help', (texts[lang] && texts[lang].updateDeviceBtnHelp) || \"\");\n    } else {\n      setButtonLabelWithIconBinding(addDeviceBtnElem, addDeviceLabel, ICON_GLYPHS.add);\n      addDeviceBtnElem.setAttribute('data-help', (texts[lang] && texts[lang].addDeviceBtnHelp) || \"\");\n    }\n  }\n  const cancelEditBtnElem = document.getElementById(\"cancelEditBtn\");\n  if (cancelEditBtnElem) {\n    setButtonLabelWithIconBinding(cancelEditBtnElem, texts[lang].cancelEditBtn, ICON_GLYPHS.circleX);\n    cancelEditBtnElem.setAttribute('data-help', texts[lang].cancelEditBtnHelp);\n  }\n  const exportBtnElem = document.getElementById(\"exportDataBtn\");\n  if (exportBtnElem) {\n    setButtonLabelWithIconBinding(exportBtnElem, texts[lang].exportDataBtn, ICON_GLYPHS.fileExport);\n    exportBtnElem.setAttribute('data-help', texts[lang].exportDataHelp);\n  }\n  const importDataBtnElem = document.getElementById(\"importDataBtn\");\n  if (importDataBtnElem) {\n    setButtonLabelWithIconBinding(importDataBtnElem, texts[lang].importDataBtn, ICON_GLYPHS.fileImport);\n    importDataBtnElem.setAttribute('data-help', texts[lang].importDataHelp);\n  }\n  // Placeholders for inputs\n  if (typeof setupNameInput !== 'undefined' && setupNameInput) setupNameInput.placeholder = (texts[lang].setupNameLabel || \"\").replace(\":\", \"\");\n  if (typeof newNameInput !== 'undefined' && newNameInput) newNameInput.placeholder = texts[lang].placeholder_deviceName;\n  if (typeof newWattInput !== 'undefined' && newWattInput) newWattInput.placeholder = texts[lang].placeholder_watt;\n  if (typeof newCapacityInput !== 'undefined' && newCapacityInput) newCapacityInput.placeholder = texts[lang].placeholder_capacity;\n  if (typeof newPinAInput !== 'undefined' && newPinAInput) newPinAInput.placeholder = texts[lang].placeholder_pin;\n  if (typeof newDtapAInput !== 'undefined' && newDtapAInput) newDtapAInput.placeholder = texts[lang].placeholder_dtap;\n  if (typeof cameraVoltageInput !== 'undefined' && cameraVoltageInput) cameraVoltageInput.placeholder = texts[lang].placeholder_voltage;\n  if (typeof monitorVoltageInput !== 'undefined' && monitorVoltageInput) monitorVoltageInput.placeholder = texts[lang].placeholder_voltage;\n\n  updateDeviceManagerLocalization(lang);\n\n  // Toggle device manager button text (depends on current visibility)\n  const toggleDeviceBtnElem = document.getElementById(\"toggleDeviceManager\");\n  const deviceManagerSectionElem = document.getElementById(\"device-manager\");\n  if (deviceManagerSectionElem && toggleDeviceBtnElem) {\n    if (deviceManagerSectionElem.classList.contains('hidden')) {\n      setButtonLabelWithIconBinding(toggleDeviceBtnElem, texts[lang].toggleDeviceManager, ICON_GLYPHS.gears);\n      toggleDeviceBtnElem.setAttribute(\"title\", texts[lang].toggleDeviceManager);\n      toggleDeviceBtnElem.setAttribute(\"data-help\", texts[lang].toggleDeviceManagerHelp);\n      toggleDeviceBtnElem.setAttribute(\"aria-expanded\", \"false\");\n    } else {\n      setButtonLabelWithIconBinding(toggleDeviceBtnElem, texts[lang].hideDeviceManager, ICON_GLYPHS.minus);\n      toggleDeviceBtnElem.setAttribute(\"title\", texts[lang].hideDeviceManager);\n      toggleDeviceBtnElem.setAttribute(\"data-help\", texts[lang].hideDeviceManagerHelp);\n      toggleDeviceBtnElem.setAttribute(\"aria-expanded\", \"true\");\n    }\n  }\n\n  // Update newCategory select option texts\n  const newCategorySelectElem = document.getElementById(\"newCategory\");\n  if (newCategorySelectElem && newCategorySelectElem.options) {\n    Array.from(newCategorySelectElem.options).forEach(opt => {\n      opt.textContent = getCategoryLabel(opt.value, lang);\n    });\n  }\n  // Update \"None\" option text in all dropdowns\n  const noneMap = { de: \"Keine Auswahl\", es: \"Ninguno\", fr: \"Aucun\" };\n  document.querySelectorAll('select option[value=\"None\"]').forEach(opt => {\n    opt.textContent = noneMap[lang] || \"None\";\n  });\n  // Save language preference\n  try {\n    localStorage.setItem(\"language\", lang);\n  } catch (e) {\n    console.warn(\"Could not save language to localStorage\", e);\n  }\n  // Recalculate and update dynamic content (results, breakdown, battery comparison)\n  if (typeof refreshDeviceLists === 'function') {\n    refreshDeviceLists();\n  } else if (typeof window !== 'undefined' && typeof window.refreshDeviceLists === 'function') {\n    window.refreshDeviceLists();\n  }\n  applyFilters();\n  if (!options?.skipUpdateCalculations) {\n    updateCalculations();\n  }\n\n  const existingDevicesHeading =\n    typeof document !== 'undefined'\n      ? document.getElementById('existingDevicesHeading')\n      : null;\n  if (existingDevicesHeading) {\n    existingDevicesHeading.textContent = texts[lang].existingDevicesHeading;\n  }\n  if (darkModeToggle) {\n    darkModeToggle.setAttribute(\"title\", texts[lang].darkModeLabel);\n    darkModeToggle.setAttribute(\"aria-label\", texts[lang].darkModeLabel);\n    darkModeToggle.setAttribute(\n      \"data-help\",\n      texts[lang].darkModeHelp || texts[lang].darkModeLabel\n    );\n  }\n  if (pinkModeToggle) {\n    pinkModeToggle.setAttribute(\"title\", texts[lang].pinkModeLabel);\n    pinkModeToggle.setAttribute(\"aria-label\", texts[lang].pinkModeLabel);\n    pinkModeToggle.setAttribute(\n      \"data-help\",\n      texts[lang].pinkModeHelp || texts[lang].pinkModeLabel\n    );\n  }\n  if (settingsButton) {\n    settingsButton.setAttribute(\"title\", texts[lang].settingsButton);\n    settingsButton.setAttribute(\"aria-label\", texts[lang].settingsButton);\n    settingsButton.setAttribute(\n      \"data-help\",\n      texts[lang].settingsButtonHelp || texts[lang].settingsButton\n    );\n  }\n  const settingsTitleElem = document.getElementById(\"settingsTitle\");\n  if (settingsTitleElem) {\n    settingsTitleElem.textContent = texts[lang].settingsHeading;\n    settingsTitleElem.setAttribute(\n      \"data-help\",\n      texts[lang].settingsHeadingHelp || texts[lang].settingsHeading\n    );\n  }\n  const settingsTablistRef = document.getElementById(\"settingsTablist\");\n  if (settingsTablistRef) {\n    const sectionsLabel =\n      texts[lang].settingsSectionsLabel ||\n      texts.en?.settingsSectionsLabel ||\n      settingsTablistRef.getAttribute('aria-label') ||\n      texts[lang].settingsHeading ||\n      'Settings sections';\n    settingsTablistRef.setAttribute('aria-label', sectionsLabel);\n  }\n  const getSettingsTabLabelText = button => {\n    if (!button || typeof button !== 'object') return '';\n    const labelNode = button.querySelector?.('.settings-tab-label');\n    if (labelNode && typeof labelNode.textContent === 'string') {\n      const trimmed = labelNode.textContent.trim();\n      if (trimmed) return trimmed;\n    }\n    return typeof button.textContent === 'string' ? button.textContent.trim() : '';\n  };\n  const summarizeSettingsTabHelp = helpText => {\n    if (typeof helpText !== 'string') return '';\n    const trimmed = helpText.trim();\n    if (!trimmed) return '';\n    const sentenceMatch = trimmed.match(/^[^.!?]*[.!?]/u);\n    if (sentenceMatch && sentenceMatch[0]) {\n      const sentence = sentenceMatch[0].trim();\n      if (sentence.length >= 24 || trimmed.length <= 90) {\n        return sentence;\n      }\n    }\n    if (trimmed.length <= 90) return trimmed;\n    const truncated = trimmed.slice(0, 90);\n    let cutIndex = truncated.length;\n    while (cutIndex > 0 && truncated[cutIndex - 1] && truncated[cutIndex - 1].trim() !== '') {\n      cutIndex -= 1;\n    }\n    const safeCut = cutIndex > 0 ? truncated.slice(0, cutIndex).trimEnd() : '';\n    return `${safeCut || truncated.trim()}`;\n  };\n  const applySettingsTabLabel = (button, labelValue, helpValue) => {\n    if (!button) return;\n    const label = (labelValue || getSettingsTabLabelText(button) || '').trim();\n    const labelElement = button.querySelector?.('.settings-tab-label');\n    if (labelElement) {\n      labelElement.textContent = label;\n    } else {\n      button.textContent = label;\n    }\n    if (label) {\n      button.setAttribute('aria-label', label);\n    } else {\n      button.removeAttribute('aria-label');\n    }\n    const help = (helpValue || label || '').trim();\n    if (help) {\n      button.setAttribute('data-help', help);\n      button.setAttribute('title', help);\n    } else {\n      button.removeAttribute('data-help');\n      button.removeAttribute('title');\n    }\n    const summary = summarizeSettingsTabHelp(help);\n    if (summary) {\n      button.setAttribute('data-summary', summary);\n    } else {\n      button.removeAttribute('data-summary');\n    }\n    const captionElement = button.querySelector?.('.settings-tab-caption');\n    if (captionElement) {\n      const captionText = summary || label;\n      captionElement.textContent = captionText;\n      if (captionText) {\n        captionElement.removeAttribute('hidden');\n      } else {\n        captionElement.setAttribute('hidden', '');\n      }\n    }\n  };\n  if (settingsTabGeneral) {\n    const generalLabel =\n      texts[lang].settingsTabGeneral ||\n      texts.en?.settingsTabGeneral ||\n      getSettingsTabLabelText(settingsTabGeneral) ||\n      'General';\n    const generalHelp =\n      texts[lang].settingsTabGeneralHelp ||\n      texts.en?.settingsTabGeneralHelp ||\n      texts[lang].settingsHeadingHelp ||\n      generalLabel;\n    applySettingsTabLabel(settingsTabGeneral, generalLabel, generalHelp);\n    if (generalSettingsHeading) {\n      generalSettingsHeading.textContent = generalLabel;\n      generalSettingsHeading.setAttribute('data-help', generalHelp);\n    }\n    if (generalLanguageHeading) {\n      const sectionHeading =\n        texts[lang].generalSectionLanguageHeading ||\n        texts.en?.generalSectionLanguageHeading ||\n        generalLanguageHeading.textContent;\n      generalLanguageHeading.textContent = sectionHeading;\n    }\n    if (generalAppearanceHeading) {\n      const sectionHeading =\n        texts[lang].generalSectionAppearanceHeading ||\n        texts.en?.generalSectionAppearanceHeading ||\n        generalAppearanceHeading.textContent;\n      generalAppearanceHeading.textContent = sectionHeading;\n    }\n    if (generalTypographyHeading) {\n      const sectionHeading =\n        texts[lang].generalSectionTypographyHeading ||\n        texts.en?.generalSectionTypographyHeading ||\n        generalTypographyHeading.textContent;\n      generalTypographyHeading.textContent = sectionHeading;\n    }\n    if (generalBrandingHeading) {\n      const sectionHeading =\n        texts[lang].generalSectionBrandingHeading ||\n        texts.en?.generalSectionBrandingHeading ||\n        generalBrandingHeading.textContent;\n      generalBrandingHeading.textContent = sectionHeading;\n    }\n    documentationTrackerController.updateLocalization({\n      language: lang,\n      texts: texts[lang] || {},\n      fallbackTexts: texts[DEFAULT_LANGUAGE_SAFE] || texts.en || {},\n    });\n    if (documentationTrackerController.isInitialized()) {\n      documentationTrackerController.render();\n    }\n  }\n  applySettingsTabLabel(\n    settingsTabAutoGear,\n    texts[lang].settingsTabAutoGear ||\n    texts.en?.settingsTabAutoGear ||\n    texts[lang].autoGearHeading ||\n    texts.en?.autoGearHeading,\n    texts[lang].settingsTabAutoGearHelp ||\n    texts.en?.settingsTabAutoGearHelp ||\n    texts[lang].autoGearHeadingHelp ||\n    texts.en?.autoGearHeadingHelp\n  );\n  applySettingsTabLabel(\n    settingsTabAccessibility,\n    texts[lang].settingsTabAccessibility ||\n    texts.en?.settingsTabAccessibility ||\n    texts[lang].accessibilityHeading ||\n    texts.en?.accessibilityHeading,\n    texts[lang].settingsTabAccessibilityHelp ||\n    texts.en?.settingsTabAccessibilityHelp ||\n    texts[lang].accessibilityHeadingHelp ||\n    texts.en?.accessibilityHeadingHelp\n  );\n  applySettingsTabLabel(\n    settingsTabBackup,\n    texts[lang].settingsTabBackup ||\n    texts.en?.settingsTabBackup ||\n    texts[lang].backupHeading ||\n    texts.en?.backupHeading,\n    texts[lang].settingsTabBackupHelp ||\n    texts.en?.settingsTabBackupHelp ||\n    texts[lang].backupHeadingHelp ||\n    texts.en?.backupHeadingHelp\n  );\n  applySettingsTabLabel(\n    settingsTabData,\n    texts[lang].settingsTabData ||\n    texts.en?.settingsTabData ||\n    texts[lang].dataHeading ||\n    texts.en?.dataHeading,\n    texts[lang].settingsTabDataHelp ||\n    texts.en?.settingsTabDataHelp ||\n    texts[lang].dataHeadingHelp ||\n    texts.en?.dataHeadingHelp\n  );\n  applySettingsTabLabel(\n    settingsTabAbout,\n    texts[lang].settingsTabAbout ||\n    texts.en?.settingsTabAbout ||\n    texts[lang].aboutHeading ||\n    texts.en?.aboutHeading,\n    texts[lang].settingsTabAboutHelp ||\n    texts.en?.settingsTabAboutHelp ||\n    texts[lang].aboutHeadingHelp ||\n    texts.en?.aboutHeadingHelp\n  );\n  const settingsLanguageLabel = document.getElementById(\"settingsLanguageLabel\");\n  if (settingsLanguageLabel) {\n    settingsLanguageLabel.textContent = texts[lang].languageSetting;\n    const languageHelp =\n      texts[lang].settingsLanguageHelp || texts[lang].languageSetting;\n    settingsLanguageLabel.setAttribute(\"data-help\", languageHelp);\n    if (settingsLanguage) {\n      settingsLanguage.setAttribute(\"data-help\", languageHelp);\n      settingsLanguage.setAttribute(\"aria-label\", texts[lang].languageSetting);\n    }\n  }\n  const settingsDarkLabel = document.getElementById(\"settingsDarkModeLabel\");\n  if (settingsDarkLabel) {\n    settingsDarkLabel.textContent = texts[lang].darkModeSetting;\n    const darkModeHelp =\n      texts[lang].settingsDarkModeHelp || texts[lang].darkModeSetting;\n    settingsDarkLabel.setAttribute(\"data-help\", darkModeHelp);\n    if (settingsDarkMode) {\n      settingsDarkMode.setAttribute(\"data-help\", darkModeHelp);\n      settingsDarkMode.setAttribute(\"aria-label\", texts[lang].darkModeSetting);\n    }\n  }\n  const settingsPinkLabel = document.getElementById(\"settingsPinkModeLabel\");\n  if (settingsPinkLabel) {\n    settingsPinkLabel.textContent = texts[lang].pinkModeSetting;\n    const pinkModeHelp =\n      texts[lang].settingsPinkModeHelp || texts[lang].pinkModeSetting;\n    settingsPinkLabel.setAttribute(\"data-help\", pinkModeHelp);\n    if (settingsPinkMode) {\n      settingsPinkMode.setAttribute(\"data-help\", pinkModeHelp);\n      settingsPinkMode.setAttribute(\"aria-label\", texts[lang].pinkModeSetting);\n    }\n  }\n  const accentLabel = document.getElementById(\"accentColorLabel\");\n  const accentHelp = texts[lang].accentColorHelp || texts[lang].accentColorSetting;\n  if (accentLabel) {\n    accentLabel.textContent = texts[lang].accentColorSetting;\n    accentLabel.setAttribute(\"data-help\", accentHelp);\n  }\n  if (accentColorInput) {\n    accentColorInput.setAttribute(\"data-help\", accentHelp);\n    accentColorInput.setAttribute(\"aria-label\", texts[lang].accentColorSetting);\n  }\n  if (cameraColorsDescription) {\n    const description =\n      texts[lang].cameraColorSettingDescription ||\n      texts.en?.cameraColorSettingDescription ||\n      cameraColorsDescription.textContent;\n    cameraColorsDescription.textContent = description;\n  }\n  const cameraColorHelpTemplate =\n    texts[lang].cameraColorInputHelp ||\n    texts.en?.cameraColorInputHelp ||\n    '';\n  const cameraColorLabelEntries = [\n    ['A', cameraColorALabel, cameraColorA],\n    ['B', cameraColorBLabel, cameraColorB],\n    ['C', cameraColorCLabel, cameraColorC],\n    ['D', cameraColorDLabel, cameraColorD],\n    ['E', cameraColorELabel, cameraColorE],\n  ];\n  cameraColorLabelEntries.forEach(([letter, labelElement, inputElement]) => {\n    if (!labelElement) {\n      return;\n    }\n    const key = `cameraColor${letter} Label`;\n    const labelText = texts[lang][key]\n      || texts.en?.[key]\n      || labelElement.textContent;\n    labelElement.textContent = labelText;\n    const helpText = cameraColorHelpTemplate ? cameraColorHelpTemplate.replace('%s', letter) : '';\n    if (helpText) {\n      labelElement.setAttribute('data-help', helpText);\n    } else {\n      labelElement.removeAttribute('data-help');\n    }\n    if (inputElement) {\n      if (helpText) {\n        inputElement.setAttribute('data-help', helpText);\n        inputElement.setAttribute('aria-label', helpText);\n      } else {\n        inputElement.removeAttribute('data-help');\n        inputElement.setAttribute('aria-label', labelText);\n      }\n    }\n  });\n  if (accentColorResetButton) {\n    const accentResetLabel =\n      (texts[lang] && texts[lang].accentColorReset) ||\n      (texts.en && texts.en.accentColorReset) ||\n      accentColorResetButton.textContent ||\n      'Reset to default';\n    const accentResetHelp =\n      (texts[lang] && texts[lang].accentColorResetHelp) || accentHelp;\n    accentColorResetButton.textContent = accentResetLabel;\n    accentColorResetButton.setAttribute('data-help', accentResetHelp);\n    accentColorResetButton.setAttribute('aria-label', accentResetHelp);\n    accentColorResetButton.setAttribute('title', accentResetHelp);\n  }\n  const settingsTemperatureUnitLabel = document.getElementById('settingsTemperatureUnitLabel');\n  if (settingsTemperatureUnitLabel) {\n    settingsTemperatureUnitLabel.textContent = texts[lang].temperatureUnitSetting;\n    const tempUnitHelp =\n      texts[lang].temperatureUnitSettingHelp || texts[lang].temperatureUnitSetting;\n    settingsTemperatureUnitLabel.setAttribute('data-help', tempUnitHelp);\n    if (typeof settingsTemperatureUnit !== 'undefined' && settingsTemperatureUnit) {\n      settingsTemperatureUnit.setAttribute('data-help', tempUnitHelp);\n      settingsTemperatureUnit.setAttribute('aria-label', texts[lang].temperatureUnitSetting);\n      Array.from(settingsTemperatureUnit.options || []).forEach(option => {\n        if (!option) return;\n        const normalized = normalizeTemperatureUnitSafe(option.value);\n        option.textContent = getTemperatureUnitLabelForLang(lang, normalized);\n      });\n      settingsTemperatureUnit.value = temperatureUnit;\n    }\n  }\n  const settingsFocusScaleLabel = document.getElementById('settingsFocusScaleLabel');\n  if (settingsFocusScaleLabel) {\n    settingsFocusScaleLabel.textContent = texts[lang].focusScaleSetting;\n    const focusScaleHelp =\n      texts[lang].focusScaleSettingHelp || texts[lang].focusScaleSetting;\n    settingsFocusScaleLabel.setAttribute('data-help', focusScaleHelp);\n    if (typeof settingsFocusScale !== 'undefined' && settingsFocusScale) {\n      settingsFocusScale.setAttribute('data-help', focusScaleHelp);\n      settingsFocusScale.setAttribute('aria-label', texts[lang].focusScaleSetting);\n      Array.from(settingsFocusScale.options || []).forEach(option => {\n        if (!option) return;\n        const normalized = normalizeFocusScaleSafe(option.value);\n        option.textContent = getFocusScaleLabelForLang(lang, normalized);\n      });\n      settingsFocusScale.value = resolveFocusScalePreference();\n    }\n  }\n  const fontSizeLabel = document.getElementById(\"settingsFontSizeLabel\");\n  if (fontSizeLabel) {\n    fontSizeLabel.textContent = texts[lang].fontSizeSetting;\n    const sizeHelp =\n      texts[lang].fontSizeSettingHelp || texts[lang].fontSizeSetting;\n    fontSizeLabel.setAttribute(\"data-help\", sizeHelp);\n    if (settingsFontSize) {\n      settingsFontSize.setAttribute(\"data-help\", sizeHelp);\n      settingsFontSize.setAttribute(\"aria-label\", texts[lang].fontSizeSetting);\n    }\n  }\n  const fontFamilyLabel = document.getElementById(\"settingsFontFamilyLabel\");\n  if (fontFamilyLabel) {\n    fontFamilyLabel.textContent = texts[lang].fontFamilySetting;\n    const familyHelp =\n      texts[lang].fontFamilySettingHelp || texts[lang].fontFamilySetting;\n    fontFamilyLabel.setAttribute(\"data-help\", familyHelp);\n    if (settingsFontFamily) {\n      settingsFontFamily.setAttribute(\"data-help\", familyHelp);\n      settingsFontFamily.setAttribute(\"aria-label\", texts[lang].fontFamilySetting);\n    }\n  }\n  if (localFontsButton) {\n    const localFontsHelp =\n      texts[lang].localFontsButtonHelp || localFontsButton.textContent;\n    localFontsButton.setAttribute(\"data-help\", localFontsHelp);\n    localFontsButton.setAttribute(\"title\", localFontsHelp);\n    localFontsButton.setAttribute(\"aria-label\", localFontsHelp);\n  }\n  if (bundledFontGroup) {\n    const builtInLabel =\n      (texts[lang] && texts[lang].bundledFontsGroup) ||\n      (texts.en && texts.en.bundledFontsGroup) ||\n      bundledFontGroup.label;\n    if (builtInLabel) bundledFontGroup.label = builtInLabel;\n  }\n  if (localFontsGroup) {\n    const localLabel =\n      (texts[lang] && texts[lang].localFontsGroup) ||\n      (texts.en && texts.en.localFontsGroup) ||\n      localFontsGroup.label;\n    if (localLabel) localFontsGroup.label = localLabel;\n  }\n  if (localFontsButton) {\n    const localFontsLabel =\n      (texts[lang] && texts[lang].localFontsButton) ||\n      (texts.en && texts.en.localFontsButton) ||\n      localFontsButton.textContent;\n    if (localFontsLabel) {\n      setButtonLabelWithIconBinding(localFontsButton, localFontsLabel, ICON_GLYPHS.add);\n      localFontsButton.setAttribute('aria-label', localFontsLabel);\n      localFontsButton.setAttribute('title', localFontsLabel);\n    }\n  }\n  if (localFontsStatus && localFontsStatus.dataset.statusKey) {\n    const statusKey = localFontsStatus.dataset.statusKey;\n    const arg = localFontsStatus.dataset.statusArg;\n    let template =\n      (texts[lang] && texts[lang][statusKey]) ||\n      (texts.en && texts.en[statusKey]) ||\n      '';\n    if (template && arg !== undefined && arg !== null) {\n      template = template.replace('%s', arg);\n    } else if (!template && arg !== undefined && arg !== null) {\n      template = arg;\n    }\n    localFontsStatus.textContent = template;\n  }\n  const settingsLogoLabel = document.getElementById(\"settingsLogoLabel\");\n  if (settingsLogoLabel) {\n    settingsLogoLabel.textContent = texts[lang].logoSetting;\n    const logoHelp = texts[lang].logoSettingHelp || texts[lang].logoSetting;\n    settingsLogoLabel.setAttribute(\"data-help\", logoHelp);\n    if (settingsLogo) {\n      settingsLogo.setAttribute(\"data-help\", logoHelp);\n      settingsLogo.setAttribute(\"aria-label\", texts[lang].logoSetting);\n    }\n  }\n  if (autoGearHeadingElem) {\n    autoGearHeadingElem.textContent = texts[lang].autoGearHeading || texts.en?.autoGearHeading || 'Automatic Gear Rules';\n    const headingHelp = texts[lang].autoGearHeadingHelp || texts.en?.autoGearHeadingHelp;\n    if (headingHelp) autoGearHeadingElem.setAttribute('data-help', headingHelp);\n  }\n  if (autoGearDescriptionElem) {\n    autoGearDescriptionElem.textContent = texts[lang].autoGearDescription || texts.en?.autoGearDescription || '';\n  }\n  if (autoGearMonitorDefaultsHeading) {\n    const heading = texts[lang].autoGearMonitorDefaultsHeading\n      || texts.en?.autoGearMonitorDefaultsHeading\n      || autoGearMonitorDefaultsHeading.textContent;\n    autoGearMonitorDefaultsHeading.textContent = heading;\n  }\n  if (autoGearMonitorDefaultsDescription) {\n    const description = texts[lang].autoGearMonitorDefaultsDescription\n      || texts.en?.autoGearMonitorDefaultsDescription\n      || autoGearMonitorDefaultsDescription.textContent;\n    autoGearMonitorDefaultsDescription.textContent = description;\n  }\n  autoGearMonitorDefaultControls.forEach(control => {\n    if (!control) return;\n    const labelKey = AUTO_GEAR_MONITOR_DEFAULT_LABEL_KEYS[control.key];\n    const labelText = labelKey\n      ? texts[lang][labelKey]\n      || texts.en?.[labelKey]\n      || control.label?.textContent\n      : control.label?.textContent;\n    if (control.label && labelText) {\n      control.label.textContent = labelText;\n      control.label.setAttribute('data-help', labelText);\n    }\n    if (control.select && labelText) {\n      control.select.setAttribute('aria-label', labelText);\n      control.select.setAttribute('data-help', labelText);\n    }\n  });\n  callCoreFunctionIfAvailable('updateAutoGearMonitorDefaultOptions', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearMonitorDefaultsControls', [], { defer: true });\n  if (autoGearPresetDescription) {\n    autoGearPresetDescription.textContent = texts[lang].autoGearPresetDescription\n      || texts.en?.autoGearPresetDescription\n      || '';\n  }\n  if (autoGearPresetLabel) {\n    const label = texts[lang].autoGearPresetLabel\n      || texts.en?.autoGearPresetLabel\n      || autoGearPresetLabel.textContent;\n    const help = texts[lang].autoGearPresetDescription\n      || texts.en?.autoGearPresetDescription\n      || label;\n    autoGearPresetLabel.textContent = label;\n    autoGearPresetLabel.setAttribute('data-help', help);\n    if (autoGearPresetSelect) {\n      autoGearPresetSelect.setAttribute('aria-label', label);\n      autoGearPresetSelect.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearSavePresetButton) {\n    const label = texts[lang].autoGearSavePresetButton\n      || texts.en?.autoGearSavePresetButton\n      || autoGearSavePresetButton.textContent;\n    setButtonLabelWithIconBinding(autoGearSavePresetButton, label, ICON_GLYPHS.save);\n    autoGearSavePresetButton.setAttribute('data-help', label);\n    autoGearSavePresetButton.setAttribute('aria-label', label);\n  }\n  if (autoGearDeletePresetButton) {\n    const label = texts[lang].autoGearDeletePresetButton\n      || texts.en?.autoGearDeletePresetButton\n      || autoGearDeletePresetButton.textContent;\n    setButtonLabelWithIconBinding(autoGearDeletePresetButton, label, ICON_GLYPHS.trash);\n    autoGearDeletePresetButton.setAttribute('data-help', label);\n    autoGearDeletePresetButton.setAttribute('aria-label', label);\n  }\n  if (autoGearAddRuleBtn) {\n    const label = texts[lang].autoGearAddRule || texts.en?.autoGearAddRule || autoGearAddRuleBtn.textContent;\n    setButtonLabelWithIconBinding(autoGearAddRuleBtn, label, ICON_GLYPHS.add);\n    const help = texts[lang].autoGearHeadingHelp || texts.en?.autoGearHeadingHelp || label;\n    autoGearAddRuleBtn.setAttribute('data-help', help);\n  }\n  if (autoGearResetFactoryButton) {\n    const label = texts[lang].autoGearResetFactoryButton\n      || texts.en?.autoGearResetFactoryButton\n      || autoGearResetFactoryButton.textContent;\n    const help = texts[lang].autoGearResetFactoryHelp\n      || texts.en?.autoGearResetFactoryHelp\n      || label;\n    setButtonLabelWithIconBinding(autoGearResetFactoryButton, label, ICON_GLYPHS.reload);\n    autoGearResetFactoryButton.setAttribute('data-help', help);\n    autoGearResetFactoryButton.setAttribute('title', help);\n    autoGearResetFactoryButton.setAttribute('aria-label', label);\n  }\n  if (autoGearExportButton) {\n    const label = texts[lang].autoGearExportButton\n      || texts.en?.autoGearExportButton\n      || autoGearExportButton.textContent;\n    const help = texts[lang].autoGearExportHelp\n      || texts.en?.autoGearExportHelp\n      || label;\n    setButtonLabelWithIconBinding(autoGearExportButton, label, ICON_GLYPHS.fileExport);\n    autoGearExportButton.setAttribute('data-help', help);\n    autoGearExportButton.setAttribute('title', help);\n    autoGearExportButton.setAttribute('aria-label', label);\n  }\n  if (autoGearImportButton) {\n    const label = texts[lang].autoGearImportButton\n      || texts.en?.autoGearImportButton\n      || autoGearImportButton.textContent;\n    const help = texts[lang].autoGearImportHelp\n      || texts.en?.autoGearImportHelp\n      || label;\n    setButtonLabelWithIconBinding(autoGearImportButton, label, ICON_GLYPHS.fileImport);\n    autoGearImportButton.setAttribute('data-help', help);\n    autoGearImportButton.setAttribute('title', help);\n    autoGearImportButton.setAttribute('aria-label', label);\n  }\n  if (autoGearSearchLabel) {\n    const label = texts[lang].autoGearSearchLabel\n      || texts.en?.autoGearSearchLabel\n      || autoGearSearchLabel.textContent;\n    const help = texts[lang].autoGearSearchHelp\n      || texts.en?.autoGearSearchHelp\n      || label;\n    autoGearSearchLabel.textContent = label;\n    autoGearSearchLabel.setAttribute('data-help', help);\n    if (autoGearSearchInput) {\n      const placeholder = texts[lang].autoGearSearchPlaceholder\n        || texts.en?.autoGearSearchPlaceholder\n        || autoGearSearchInput.getAttribute('placeholder')\n        || '';\n      autoGearSearchInput.setAttribute('placeholder', placeholder);\n      autoGearSearchInput.setAttribute('aria-label', label);\n      autoGearSearchInput.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearFilterScenarioLabel) {\n    const label = texts[lang].autoGearFilterScenarioLabel\n      || texts.en?.autoGearFilterScenarioLabel\n      || autoGearFilterScenarioLabel.textContent;\n    const help = texts[lang].autoGearFilterScenarioHelp\n      || texts.en?.autoGearFilterScenarioHelp\n      || label;\n    autoGearFilterScenarioLabel.textContent = label;\n    autoGearFilterScenarioLabel.setAttribute('data-help', help);\n    if (autoGearFilterScenarioSelect) {\n      autoGearFilterScenarioSelect.setAttribute('aria-label', label);\n      autoGearFilterScenarioSelect.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearFilterClearButton) {\n    const label = texts[lang].autoGearFilterClear\n      || texts.en?.autoGearFilterClear\n      || autoGearFilterClearButton.textContent;\n    setButtonLabelWithIconBinding(autoGearFilterClearButton, label, ICON_GLYPHS.circleX);\n    autoGearFilterClearButton.setAttribute('data-help', label);\n    autoGearFilterClearButton.setAttribute('aria-label', label);\n  }\n  refreshAutoGearScenarioFilterOptions(getAutoGearRules());\n  if (autoGearBackupsHeading) {\n    autoGearBackupsHeading.textContent = texts[lang].autoGearBackupsHeading\n      || texts.en?.autoGearBackupsHeading\n      || autoGearBackupsHeading.textContent;\n  }\n  if (autoGearBackupsDescription) {\n    const description = texts[lang].autoGearBackupsDescription\n      || texts.en?.autoGearBackupsDescription\n      || '';\n    autoGearBackupsDescription.textContent = description;\n    if (description) {\n      autoGearBackupsDescription.setAttribute('data-help', description);\n    }\n  }\n  if (autoGearShowBackupsLabel) {\n    const label = texts[lang].autoGearShowBackupsLabel\n      || texts.en?.autoGearShowBackupsLabel\n      || autoGearShowBackupsLabel.textContent;\n    const help = texts[lang].autoGearShowBackupsHelp\n      || texts.en?.autoGearShowBackupsHelp\n      || label;\n    autoGearShowBackupsLabel.textContent = label;\n    autoGearShowBackupsLabel.setAttribute('data-help', help);\n    if (autoGearShowBackupsCheckbox) {\n      autoGearShowBackupsCheckbox.setAttribute('aria-label', label);\n      autoGearShowBackupsCheckbox.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearBackupsHiddenNotice) {\n    const hiddenText = texts[lang].autoGearBackupsHidden\n      || texts.en?.autoGearBackupsHidden\n      || autoGearBackupsHiddenNotice.textContent;\n    autoGearBackupsHiddenNotice.textContent = hiddenText;\n  }\n  if (autoGearBackupRetentionLabel) {\n    const label = texts[lang].autoGearBackupRetentionLabel\n      || texts.en?.autoGearBackupRetentionLabel\n      || autoGearBackupRetentionLabel.textContent;\n    const help = texts[lang].autoGearBackupRetentionHelp\n      || texts.en?.autoGearBackupRetentionHelp\n      || label;\n    autoGearBackupRetentionLabel.textContent = label;\n    autoGearBackupRetentionLabel.setAttribute('data-help', help);\n    if (autoGearBackupRetentionInput) {\n      autoGearBackupRetentionInput.setAttribute('aria-label', label);\n      autoGearBackupRetentionInput.setAttribute('title', label);\n    }\n  }\n  if (autoGearBackupRetentionSummary) {\n    callCoreFunctionIfAvailable('renderAutoGearBackupRetentionControls', [], { defer: true });\n  }\n  if (autoGearBackupSelectLabel) {\n    const label = texts[lang].autoGearBackupSelectLabel\n      || texts.en?.autoGearBackupSelectLabel\n      || autoGearBackupSelectLabel.textContent;\n    autoGearBackupSelectLabel.textContent = label;\n    if (autoGearBackupSelect) {\n      autoGearBackupSelect.setAttribute('aria-label', label);\n      autoGearBackupSelect.setAttribute('title', label);\n    }\n  }\n  if (autoGearBackupRestoreButton) {\n    const label = texts[lang].autoGearBackupRestore\n      || texts.en?.autoGearBackupRestore\n      || autoGearBackupRestoreButton.textContent;\n    setButtonLabelWithIconBinding(autoGearBackupRestoreButton, label, ICON_GLYPHS.fileImport);\n    autoGearBackupRestoreButton.setAttribute('aria-label', label);\n    autoGearBackupRestoreButton.setAttribute('title', label);\n  }\n  if (autoGearBackupEmptyMessage) {\n    const emptyText = texts[lang].autoGearBackupEmpty\n      || texts.en?.autoGearBackupEmpty\n      || autoGearBackupEmptyMessage.textContent;\n    autoGearBackupEmptyMessage.textContent = emptyText;\n  }\n  if (autoGearBackupSelect) {\n    callCoreFunctionIfAvailable('renderAutoGearBackupControls', [], { defer: true });\n  }\n  if (autoGearRuleNameLabel) {\n    const label = texts[lang].autoGearRuleNameLabel || texts.en?.autoGearRuleNameLabel || autoGearRuleNameLabel.textContent;\n    autoGearRuleNameLabel.textContent = label;\n    const help = texts[lang].autoGearRuleNameHelp || texts.en?.autoGearRuleNameHelp || label;\n    autoGearRuleNameLabel.setAttribute('data-help', help);\n    if (autoGearRuleNameInput) {\n      autoGearRuleNameInput.setAttribute('data-help', help);\n      autoGearRuleNameInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearConditionSelectLabel) {\n    const label = texts[lang].autoGearConditionSelectLabel\n      || texts.en?.autoGearConditionSelectLabel\n      || autoGearConditionSelectLabel.textContent\n      || 'Add a condition';\n    const help = texts[lang].autoGearConditionSelectHelp\n      || texts.en?.autoGearConditionSelectHelp\n      || label;\n    autoGearConditionSelectLabel.textContent = label;\n    autoGearConditionSelectLabel.setAttribute('data-help', help);\n    if (autoGearConditionSelect) {\n      autoGearConditionSelect.setAttribute('aria-label', label);\n      autoGearConditionSelect.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearConditionAddButton) {\n    const label = texts[lang].autoGearAddCondition\n      || texts.en?.autoGearAddCondition\n      || autoGearConditionAddButton.textContent\n      || 'Add condition';\n    setButtonLabelWithIconBinding(autoGearConditionAddButton, label, ICON_GLYPHS.add);\n    autoGearConditionAddButton.setAttribute('aria-label', label);\n    autoGearConditionAddButton.setAttribute('data-help', label);\n  }\n  if (autoGearAlwaysLabel) {\n    const label = texts[lang].autoGearAlwaysLabel\n      || texts.en?.autoGearAlwaysLabel\n      || autoGearAlwaysLabel.textContent\n      || 'Always include';\n    const help = texts[lang].autoGearAlwaysHelp\n      || texts.en?.autoGearAlwaysHelp\n      || label;\n    autoGearAlwaysLabel.textContent = label;\n    autoGearAlwaysLabel.setAttribute('data-help', help);\n    if (autoGearAlwaysHelp) {\n      autoGearAlwaysHelp.textContent = help;\n      autoGearAlwaysHelp.setAttribute('data-help', help);\n    }\n  }\n  configureAutoGearConditionButtons();\n  refreshAutoGearConditionPicker();\n  updateAutoGearConditionAddButtonState();\n  if (autoGearScenariosLabel) {\n    const label = texts[lang].autoGearScenariosLabel || texts.en?.autoGearScenariosLabel || autoGearScenariosLabel.textContent;\n    autoGearScenariosLabel.textContent = label;\n    const help = texts[lang].autoGearScenariosHelp || texts.en?.autoGearScenariosHelp || label;\n    autoGearScenariosLabel.setAttribute('data-help', help);\n    if (autoGearScenariosSelect) {\n      autoGearScenariosSelect.setAttribute('data-help', help);\n      autoGearScenariosSelect.setAttribute('aria-label', label);\n    }\n    if (autoGearScenarioModeLabel) {\n      const modeLabel = texts[lang].autoGearScenarioModeLabel\n        || texts.en?.autoGearScenarioModeLabel\n        || autoGearScenarioModeLabel.textContent\n        || 'Scenario matching';\n      const modeHelp = texts[lang].autoGearScenarioModeHelp\n        || texts.en?.autoGearScenarioModeHelp\n        || modeLabel;\n      autoGearScenarioModeLabel.textContent = modeLabel;\n      autoGearScenarioModeLabel.setAttribute('data-help', modeHelp);\n      if (autoGearScenarioModeSelectElement) {\n        autoGearScenarioModeSelectElement.setAttribute('data-help', modeHelp);\n        autoGearScenarioModeSelectElement.setAttribute('aria-label', modeLabel);\n      }\n    }\n    if (autoGearScenarioBaseLabel) {\n      const baseLabel = texts[lang].autoGearScenarioBaseLabel\n        || texts.en?.autoGearScenarioBaseLabel\n        || autoGearScenarioBaseLabel.textContent\n        || 'Base scenario';\n      const baseHelp = texts[lang].autoGearScenarioBaseHelp\n        || texts.en?.autoGearScenarioBaseHelp\n        || baseLabel;\n      autoGearScenarioBaseLabel.textContent = baseLabel;\n      autoGearScenarioBaseLabel.setAttribute('data-help', baseHelp);\n      if (autoGearScenarioBaseSelect) {\n        autoGearScenarioBaseSelect.setAttribute('data-help', baseHelp);\n        autoGearScenarioBaseSelect.setAttribute('aria-label', baseLabel);\n      }\n    }\n    if (autoGearScenarioFactorLabel) {\n      const factorLabel = texts[lang].autoGearScenarioFactorLabel\n        || texts.en?.autoGearScenarioFactorLabel\n        || autoGearScenarioFactorLabel.textContent\n        || 'Multiplier factor';\n      const factorHelp = texts[lang].autoGearScenarioFactorHelp\n        || texts.en?.autoGearScenarioFactorHelp\n        || factorLabel;\n      autoGearScenarioFactorLabel.textContent = factorLabel;\n      autoGearScenarioFactorLabel.setAttribute('data-help', factorHelp);\n      if (autoGearScenarioFactorInput) {\n        autoGearScenarioFactorInput.setAttribute('data-help', factorHelp);\n        autoGearScenarioFactorInput.setAttribute('aria-label', factorLabel);\n      }\n    }\n  }\n  if (autoGearShootingDaysLabel) {\n    const label = texts[lang].autoGearShootingDaysLabel\n      || texts.en?.autoGearShootingDaysLabel\n      || autoGearShootingDaysLabel.textContent\n      || 'Shooting days condition';\n    const help = texts[lang].autoGearShootingDaysHelp\n      || texts.en?.autoGearShootingDaysHelp\n      || label;\n    const minimumLabel = texts[lang].autoGearShootingDaysModeMinimum\n      || texts.en?.autoGearShootingDaysModeMinimum\n      || 'Minimum';\n    const maximumLabel = texts[lang].autoGearShootingDaysModeMaximum\n      || texts.en?.autoGearShootingDaysModeMaximum\n      || 'Maximum';\n    const everyLabel = texts[lang].autoGearShootingDaysModeEvery\n      || texts.en?.autoGearShootingDaysModeEvery\n      || 'Every';\n    const valueLabel = texts[lang].autoGearShootingDaysValueLabel\n      || texts.en?.autoGearShootingDaysValueLabel\n      || 'Shooting days value';\n    autoGearShootingDaysLabel.textContent = label;\n    autoGearShootingDaysLabel.setAttribute('data-help', help);\n    if (autoGearShootingDaysMode) {\n      autoGearShootingDaysMode.setAttribute('data-help', help);\n      autoGearShootingDaysMode.setAttribute('aria-label', label);\n      Array.from(autoGearShootingDaysMode.options || []).forEach(option => {\n        if (!option || typeof option.value !== 'string') return;\n        if (option.value === 'minimum') {\n          option.textContent = minimumLabel;\n        } else if (option.value === 'maximum') {\n          option.textContent = maximumLabel;\n        } else if (option.value === 'every') {\n          option.textContent = everyLabel;\n        }\n      });\n    }\n    if (autoGearShootingDaysValueLabel) {\n      autoGearShootingDaysValueLabel.textContent = valueLabel;\n      autoGearShootingDaysValueLabel.setAttribute('data-help', help);\n    }\n    if (autoGearShootingDaysInput) {\n      autoGearShootingDaysInput.setAttribute('data-help', help);\n      autoGearShootingDaysInput.setAttribute('aria-label', valueLabel || label);\n    }\n    if (autoGearShootingDaysHelp) {\n      autoGearShootingDaysHelp.textContent = help;\n      autoGearShootingDaysHelp.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearMatteboxLabel) {\n    const label = texts[lang].autoGearMatteboxLabel || texts.en?.autoGearMatteboxLabel || autoGearMatteboxLabel.textContent;\n    autoGearMatteboxLabel.textContent = label;\n    const help = texts[lang].autoGearMatteboxHelp || texts.en?.autoGearMatteboxHelp || label;\n    autoGearMatteboxLabel.setAttribute('data-help', help);\n    if (autoGearMatteboxSelect) {\n      autoGearMatteboxSelect.setAttribute('data-help', help);\n      autoGearMatteboxSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCameraHandleLabel) {\n    const label = texts[lang].autoGearCameraHandleLabel || texts.en?.autoGearCameraHandleLabel || autoGearCameraHandleLabel.textContent;\n    autoGearCameraHandleLabel.textContent = label;\n    const help = texts[lang].autoGearCameraHandleHelp || texts.en?.autoGearCameraHandleHelp || label;\n    autoGearCameraHandleLabel.setAttribute('data-help', help);\n    if (autoGearCameraHandleSelect) {\n      autoGearCameraHandleSelect.setAttribute('data-help', help);\n      autoGearCameraHandleSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearViewfinderExtensionLabel) {\n    const label = texts[lang].autoGearViewfinderExtensionLabel || texts.en?.autoGearViewfinderExtensionLabel || autoGearViewfinderExtensionLabel.textContent;\n    autoGearViewfinderExtensionLabel.textContent = label;\n    const help = texts[lang].autoGearViewfinderExtensionHelp || texts.en?.autoGearViewfinderExtensionHelp || label;\n    autoGearViewfinderExtensionLabel.setAttribute('data-help', help);\n    if (autoGearViewfinderExtensionSelect) {\n      autoGearViewfinderExtensionSelect.setAttribute('data-help', help);\n      autoGearViewfinderExtensionSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearDeliveryResolutionLabel) {\n    const label = texts[lang].autoGearDeliveryResolutionLabel || texts.en?.autoGearDeliveryResolutionLabel || autoGearDeliveryResolutionLabel.textContent;\n    autoGearDeliveryResolutionLabel.textContent = label;\n    const help = texts[lang].autoGearDeliveryResolutionHelp || texts.en?.autoGearDeliveryResolutionHelp || label;\n    autoGearDeliveryResolutionLabel.setAttribute('data-help', help);\n    if (autoGearDeliveryResolutionSelect) {\n      autoGearDeliveryResolutionSelect.setAttribute('data-help', help);\n      autoGearDeliveryResolutionSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearVideoDistributionLabel) {\n    const label = texts[lang].autoGearVideoDistributionLabel || texts.en?.autoGearVideoDistributionLabel || autoGearVideoDistributionLabel.textContent;\n    autoGearVideoDistributionLabel.textContent = label;\n    const help = texts[lang].autoGearVideoDistributionHelp || texts.en?.autoGearVideoDistributionHelp || label;\n    autoGearVideoDistributionLabel.setAttribute('data-help', help);\n    if (autoGearVideoDistributionSelect) {\n      autoGearVideoDistributionSelect.setAttribute('data-help', help);\n      autoGearVideoDistributionSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCameraLabel) {\n    const label = texts[lang].autoGearCameraLabel || texts.en?.autoGearCameraLabel || autoGearCameraLabel.textContent;\n    autoGearCameraLabel.textContent = label;\n    const help = texts[lang].autoGearCameraHelp || texts.en?.autoGearCameraHelp || label;\n    autoGearCameraLabel.setAttribute('data-help', help);\n    if (autoGearCameraSelect) {\n      autoGearCameraSelect.setAttribute('data-help', help);\n      autoGearCameraSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearOwnGearLabel) {\n    const label = texts[lang].autoGearConditionOwnGearLabel\n      || texts[lang].autoGearOwnGearLabel\n      || texts.en?.autoGearConditionOwnGearLabel\n      || texts.en?.autoGearOwnGearLabel\n      || autoGearOwnGearLabel.textContent;\n    const help = texts[lang].autoGearConditionOwnGearHelp\n      || texts.en?.autoGearConditionOwnGearHelp\n      || texts[lang].autoGearOwnGearHelp\n      || texts.en?.autoGearOwnGearHelp\n      || label;\n    autoGearOwnGearLabel.textContent = label;\n    autoGearOwnGearLabel.setAttribute('data-help', help);\n    if (autoGearOwnGearSelect) {\n      autoGearOwnGearSelect.setAttribute('data-help', help);\n      autoGearOwnGearSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCameraWeightLabel) {\n    const label = texts[lang].autoGearCameraWeightLabel\n      || texts.en?.autoGearCameraWeightLabel\n      || autoGearCameraWeightLabel.textContent\n      || 'Camera weight';\n    const help = texts[lang].autoGearCameraWeightHelp\n      || texts.en?.autoGearCameraWeightHelp\n      || label;\n    autoGearCameraWeightLabel.textContent = label;\n    autoGearCameraWeightLabel.setAttribute('data-help', help);\n  }\n  if (autoGearCameraWeightOperatorLabel) {\n    const label = texts[lang].autoGearCameraWeightOperatorLabel\n      || texts.en?.autoGearCameraWeightOperatorLabel\n      || autoGearCameraWeightOperatorLabel.textContent\n      || 'Weight comparison';\n    autoGearCameraWeightOperatorLabel.textContent = label;\n    autoGearCameraWeightOperatorLabel.setAttribute('data-help', label);\n    if (autoGearCameraWeightOperator) {\n      autoGearCameraWeightOperator.setAttribute('data-help', label);\n      autoGearCameraWeightOperator.setAttribute('aria-label', label);\n      const greaterLabel = texts[lang].autoGearCameraWeightOperatorGreater\n        || texts.en?.autoGearCameraWeightOperatorGreater\n        || 'Heavier than';\n      const lessLabel = texts[lang].autoGearCameraWeightOperatorLess\n        || texts.en?.autoGearCameraWeightOperatorLess\n        || 'Lighter than';\n      const equalLabel = texts[lang].autoGearCameraWeightOperatorEqual\n        || texts.en?.autoGearCameraWeightOperatorEqual\n        || 'Exactly';\n      Array.from(autoGearCameraWeightOperator.options || []).forEach(option => {\n        if (!option) return;\n        if (option.value === 'greater') {\n          option.textContent = greaterLabel;\n        } else if (option.value === 'less') {\n          option.textContent = lessLabel;\n        } else if (option.value === 'equal') {\n          option.textContent = equalLabel;\n        }\n      });\n    }\n  }\n  if (autoGearCameraWeightValueLabel) {\n    const label = texts[lang].autoGearCameraWeightValueLabel\n      || texts.en?.autoGearCameraWeightValueLabel\n      || autoGearCameraWeightValueLabel.textContent\n      || 'Weight threshold (grams)';\n    const help = texts[lang].autoGearCameraWeightHelp\n      || texts.en?.autoGearCameraWeightHelp\n      || label;\n    autoGearCameraWeightValueLabel.textContent = label;\n    autoGearCameraWeightValueLabel.setAttribute('data-help', help);\n    if (autoGearCameraWeightValueInput) {\n      autoGearCameraWeightValueInput.setAttribute('data-help', help);\n      autoGearCameraWeightValueInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCameraWeightHelp) {\n    const help = texts[lang].autoGearCameraWeightHelp\n      || texts.en?.autoGearCameraWeightHelp\n      || autoGearCameraWeightHelp.textContent\n      || '';\n    autoGearCameraWeightHelp.textContent = help;\n    if (help) {\n      autoGearCameraWeightHelp.setAttribute('data-help', help);\n    }\n  }\n  if (autoGearMonitorLabel) {\n    const label = texts[lang].autoGearMonitorLabel || texts.en?.autoGearMonitorLabel || autoGearMonitorLabel.textContent;\n    autoGearMonitorLabel.textContent = label;\n    const help = texts[lang].autoGearMonitorHelp || texts.en?.autoGearMonitorHelp || label;\n    autoGearMonitorLabel.setAttribute('data-help', help);\n    if (autoGearMonitorSelect) {\n      autoGearMonitorSelect.setAttribute('data-help', help);\n      autoGearMonitorSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearTripodHeadBrandLabel) {\n    const label = texts[lang].autoGearTripodHeadBrandLabel\n      || texts.en?.autoGearTripodHeadBrandLabel\n      || autoGearTripodHeadBrandLabel.textContent;\n    autoGearTripodHeadBrandLabel.textContent = label;\n    const help = texts[lang].autoGearTripodHeadBrandHelp\n      || texts.en?.autoGearTripodHeadBrandHelp\n      || label;\n    autoGearTripodHeadBrandLabel.setAttribute('data-help', help);\n    if (autoGearTripodHeadBrandSelect) {\n      autoGearTripodHeadBrandSelect.setAttribute('data-help', help);\n      autoGearTripodHeadBrandSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearTripodBowlLabel) {\n    const label = texts[lang].autoGearTripodBowlLabel\n      || texts.en?.autoGearTripodBowlLabel\n      || autoGearTripodBowlLabel.textContent;\n    autoGearTripodBowlLabel.textContent = label;\n    const help = texts[lang].autoGearTripodBowlHelp\n      || texts.en?.autoGearTripodBowlHelp\n      || label;\n    autoGearTripodBowlLabel.setAttribute('data-help', help);\n    if (autoGearTripodBowlSelect) {\n      autoGearTripodBowlSelect.setAttribute('data-help', help);\n      autoGearTripodBowlSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearTripodTypesLabel) {\n    const label = texts[lang].autoGearTripodTypesLabel\n      || texts.en?.autoGearTripodTypesLabel\n      || autoGearTripodTypesLabel.textContent;\n    autoGearTripodTypesLabel.textContent = label;\n    const help = texts[lang].autoGearTripodTypesHelp\n      || texts.en?.autoGearTripodTypesHelp\n      || label;\n    autoGearTripodTypesLabel.setAttribute('data-help', help);\n    if (autoGearTripodTypesSelect) {\n      autoGearTripodTypesSelect.setAttribute('data-help', help);\n      autoGearTripodTypesSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearTripodSpreaderLabel) {\n    const label = texts[lang].autoGearTripodSpreaderLabel\n      || texts.en?.autoGearTripodSpreaderLabel\n      || autoGearTripodSpreaderLabel.textContent;\n    autoGearTripodSpreaderLabel.textContent = label;\n    const help = texts[lang].autoGearTripodSpreaderHelp\n      || texts.en?.autoGearTripodSpreaderHelp\n      || label;\n    autoGearTripodSpreaderLabel.setAttribute('data-help', help);\n    if (autoGearTripodSpreaderSelect) {\n      autoGearTripodSpreaderSelect.setAttribute('data-help', help);\n      autoGearTripodSpreaderSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCrewPresentLabel) {\n    const label = texts[lang].autoGearCrewPresentLabel\n      || texts.en?.autoGearCrewPresentLabel\n      || autoGearCrewPresentLabel.textContent;\n    autoGearCrewPresentLabel.textContent = label;\n    const help = texts[lang].autoGearCrewPresentHelp\n      || texts.en?.autoGearCrewPresentHelp\n      || label;\n    autoGearCrewPresentLabel.setAttribute('data-help', help);\n    if (autoGearCrewPresentSelect) {\n      autoGearCrewPresentSelect.setAttribute('data-help', help);\n      autoGearCrewPresentSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearCrewAbsentLabel) {\n    const label = texts[lang].autoGearCrewAbsentLabel\n      || texts.en?.autoGearCrewAbsentLabel\n      || autoGearCrewAbsentLabel.textContent;\n    autoGearCrewAbsentLabel.textContent = label;\n    const help = texts[lang].autoGearCrewAbsentHelp\n      || texts.en?.autoGearCrewAbsentHelp\n      || label;\n    autoGearCrewAbsentLabel.setAttribute('data-help', help);\n    if (autoGearCrewAbsentSelect) {\n      autoGearCrewAbsentSelect.setAttribute('data-help', help);\n      autoGearCrewAbsentSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearWirelessLabel) {\n    const label = texts[lang].autoGearWirelessLabel || texts.en?.autoGearWirelessLabel || autoGearWirelessLabel.textContent;\n    autoGearWirelessLabel.textContent = label;\n    const help = texts[lang].autoGearWirelessHelp || texts.en?.autoGearWirelessHelp || label;\n    autoGearWirelessLabel.setAttribute('data-help', help);\n    if (autoGearWirelessSelect) {\n      autoGearWirelessSelect.setAttribute('data-help', help);\n      autoGearWirelessSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearMotorsLabel) {\n    const label = texts[lang].autoGearMotorsLabel || texts.en?.autoGearMotorsLabel || autoGearMotorsLabel.textContent;\n    autoGearMotorsLabel.textContent = label;\n    const help = texts[lang].autoGearMotorsHelp || texts.en?.autoGearMotorsHelp || label;\n    autoGearMotorsLabel.setAttribute('data-help', help);\n    if (autoGearMotorsSelect) {\n      autoGearMotorsSelect.setAttribute('data-help', help);\n      autoGearMotorsSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearControllersLabel) {\n    const label = texts[lang].autoGearControllersLabel || texts.en?.autoGearControllersLabel || autoGearControllersLabel.textContent;\n    autoGearControllersLabel.textContent = label;\n    const help = texts[lang].autoGearControllersHelp || texts.en?.autoGearControllersHelp || label;\n    autoGearControllersLabel.setAttribute('data-help', help);\n    if (autoGearControllersSelect) {\n      autoGearControllersSelect.setAttribute('data-help', help);\n      autoGearControllersSelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearDistanceLabel) {\n    const label = texts[lang].autoGearDistanceLabel || texts.en?.autoGearDistanceLabel || autoGearDistanceLabel.textContent;\n    autoGearDistanceLabel.textContent = label;\n    const help = texts[lang].autoGearDistanceHelp || texts.en?.autoGearDistanceHelp || label;\n    autoGearDistanceLabel.setAttribute('data-help', help);\n    if (autoGearDistanceSelect) {\n      autoGearDistanceSelect.setAttribute('data-help', help);\n      autoGearDistanceSelect.setAttribute('aria-label', label);\n    }\n  }\n  const logicLabelText = texts[lang].autoGearConditionLogicLabel\n    || texts.en?.autoGearConditionLogicLabel\n    || 'Match behavior';\n  const logicHelpText = texts[lang].autoGearConditionLogicHelp\n    || texts.en?.autoGearConditionLogicHelp\n    || logicLabelText;\n  const logicOptionTexts = {\n    all: texts[lang]?.autoGearConditionLogicAll\n      || texts.en?.autoGearConditionLogicAll\n      || 'Require every selected value',\n    any: texts[lang]?.autoGearConditionLogicAny\n      || texts.en?.autoGearConditionLogicAny\n      || 'Match any selected value',\n    none: texts[lang]?.autoGearConditionLogicNone\n      || texts.en?.autoGearConditionLogicNone\n      || 'Require none of the selected values',\n    multiplier: texts[lang]?.autoGearConditionLogicMultiplier\n      || texts.en?.autoGearConditionLogicMultiplier\n      || 'Multiply by matched values',\n  };\n  Object.entries(autoGearConditionLogicSelects).forEach(([key, select]) => {\n    const label = autoGearConditionLogicLabels[key];\n    if (label) {\n      label.textContent = logicLabelText;\n      label.setAttribute('data-help', logicHelpText);\n    }\n    if (select) {\n      select.setAttribute('aria-label', logicLabelText);\n      select.setAttribute('data-help', logicHelpText);\n      select.setAttribute('title', logicHelpText);\n      Array.from(select.options || []).forEach(option => {\n        if (!option) return;\n        const optionText = logicOptionTexts[option.value];\n        if (optionText) option.textContent = optionText;\n      });\n    }\n  });\n  if (autoGearAddItemsHeading) {\n    autoGearAddItemsHeading.textContent = texts[lang].autoGearAddItemsHeading || texts.en?.autoGearAddItemsHeading || autoGearAddItemsHeading.textContent;\n  }\n  if (autoGearAddOwnGearLabel) {\n    const label = texts[lang].autoGearOwnGearLabel || texts.en?.autoGearOwnGearLabel || autoGearAddOwnGearLabel.textContent;\n    const help = texts[lang].autoGearOwnGearHelp || texts.en?.autoGearOwnGearHelp || label;\n    const placeholder = texts[lang].autoGearOwnGearPlaceholder || texts.en?.autoGearOwnGearPlaceholder || '';\n    autoGearAddOwnGearLabel.textContent = label;\n    autoGearAddOwnGearLabel.setAttribute('data-help', help);\n    if (autoGearAddOwnGearSelect) {\n      autoGearAddOwnGearSelect.setAttribute('aria-label', label);\n      autoGearAddOwnGearSelect.setAttribute('data-help', help);\n      if (placeholder) {\n        autoGearAddOwnGearSelect.setAttribute('data-placeholder', placeholder);\n      } else {\n        autoGearAddOwnGearSelect.removeAttribute('data-placeholder');\n      }\n    }\n  }\n  if (autoGearAddItemLabel) {\n    const label = texts[lang].autoGearAddItemLabel || texts.en?.autoGearAddItemLabel || autoGearAddItemLabel.textContent;\n    const hint = texts[lang].autoGearAddMultipleHint || texts.en?.autoGearAddMultipleHint || '';\n    const helpText = hint ? `${label}  ${hint} ` : label;\n    autoGearAddItemLabel.textContent = label;\n    autoGearAddItemLabel.setAttribute('data-help', helpText);\n    if (autoGearAddNameInput) {\n      autoGearAddNameInput.setAttribute('aria-label', label);\n      autoGearAddNameInput.setAttribute('data-help', helpText);\n      if (hint) {\n        autoGearAddNameInput.setAttribute('placeholder', hint);\n      } else {\n        autoGearAddNameInput.removeAttribute('placeholder');\n      }\n    }\n  }\n  if (autoGearAddCategoryLabel) {\n    const label = texts[lang].autoGearAddCategoryLabel || texts.en?.autoGearAddCategoryLabel || autoGearAddCategoryLabel.textContent;\n    autoGearAddCategoryLabel.textContent = label;\n    if (autoGearAddCategorySelect) {\n      autoGearAddCategorySelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearAddQuantityLabel) {\n    const label = texts[lang].autoGearAddQuantityLabel || texts.en?.autoGearAddQuantityLabel || autoGearAddQuantityLabel.textContent;\n    autoGearAddQuantityLabel.textContent = label;\n    if (autoGearAddQuantityInput) {\n      autoGearAddQuantityInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearAddScreenSizeLabel) {\n    const label = texts[lang].autoGearAddScreenSizeLabel || texts.en?.autoGearAddScreenSizeLabel || autoGearAddScreenSizeLabel.textContent;\n    autoGearAddScreenSizeLabel.textContent = label;\n    if (autoGearAddScreenSizeInput) {\n      autoGearAddScreenSizeInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearAddSelectorTypeLabel) {\n    const label = texts[lang].autoGearAddSelectorTypeLabel || texts.en?.autoGearAddSelectorTypeLabel || autoGearAddSelectorTypeLabel.textContent;\n    autoGearAddSelectorTypeLabel.textContent = label;\n    if (autoGearAddSelectorTypeSelect) {\n      autoGearAddSelectorTypeSelect.setAttribute('aria-label', label);\n      const noneLabel = texts[lang].autoGearSelectorNoneOption || texts.en?.autoGearSelectorNoneOption || 'No selector';\n      const monitorLabel = texts[lang].autoGearSelectorMonitorOption || texts.en?.autoGearSelectorMonitorOption || 'Monitor selector';\n      const directorLabel = texts[lang].autoGearSelectorDirectorOption || texts.en?.autoGearSelectorDirectorOption || 'Director monitor selector';\n      const tripodHeadLabel = texts[lang].autoGearSelectorTripodHeadOption || texts.en?.autoGearSelectorTripodHeadOption || 'Tripod head selector';\n      const tripodBowlLabel = texts[lang].autoGearSelectorTripodBowlOption || texts.en?.autoGearSelectorTripodBowlOption || 'Tripod bowl selector';\n      const tripodTypesLabel = texts[lang].autoGearSelectorTripodTypesOption || texts.en?.autoGearSelectorTripodTypesOption || 'Tripod type selector';\n      const tripodSpreaderLabel = texts[lang].autoGearSelectorTripodSpreaderOption || texts.en?.autoGearSelectorTripodSpreaderOption || 'Tripod spreader selector';\n      const selectorLabels = new Map([\n        ['none', noneLabel],\n        ['monitor', monitorLabel],\n        ['directorMonitor', directorLabel],\n        ['tripodHeadBrand', tripodHeadLabel],\n        ['tripodBowl', tripodBowlLabel],\n        ['tripodTypes', tripodTypesLabel],\n        ['tripodSpreader', tripodSpreaderLabel],\n      ]);\n      Array.from(autoGearAddSelectorTypeSelect.options || []).forEach(opt => {\n        const text = selectorLabels.get(opt.value);\n        if (text) opt.textContent = text;\n      });\n    }\n  }\n  if (autoGearAddSelectorDefaultLabel) {\n    const label = texts[lang].autoGearAddSelectorDefaultLabel || texts.en?.autoGearAddSelectorDefaultLabel || autoGearAddSelectorDefaultLabel.textContent;\n    autoGearAddSelectorDefaultLabel.textContent = label;\n    if (autoGearAddSelectorDefaultInput) {\n      autoGearAddSelectorDefaultInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearAddNotesLabel) {\n    const label = texts[lang].autoGearAddNotesLabel || texts.en?.autoGearAddNotesLabel || autoGearAddNotesLabel.textContent;\n    autoGearAddNotesLabel.textContent = label;\n    if (autoGearAddNotesInput) {\n      autoGearAddNotesInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearAddItemButton) {\n    if (typeof updateAutoGearItemButtonState === 'function') {\n      updateAutoGearItemButtonState('add');\n    }\n  }\n  if (autoGearRemoveItemsHeading) {\n    autoGearRemoveItemsHeading.textContent = texts[lang].autoGearRemoveItemsHeading || texts.en?.autoGearRemoveItemsHeading || autoGearRemoveItemsHeading.textContent;\n  }\n  if (autoGearRemoveOwnGearLabel) {\n    const label = texts[lang].autoGearOwnGearLabel || texts.en?.autoGearOwnGearLabel || autoGearRemoveOwnGearLabel.textContent;\n    const help = texts[lang].autoGearOwnGearHelp || texts.en?.autoGearOwnGearHelp || label;\n    const placeholder = texts[lang].autoGearOwnGearPlaceholder || texts.en?.autoGearOwnGearPlaceholder || '';\n    autoGearRemoveOwnGearLabel.textContent = label;\n    autoGearRemoveOwnGearLabel.setAttribute('data-help', help);\n    if (autoGearRemoveOwnGearSelect) {\n      autoGearRemoveOwnGearSelect.setAttribute('aria-label', label);\n      autoGearRemoveOwnGearSelect.setAttribute('data-help', help);\n      if (placeholder) {\n        autoGearRemoveOwnGearSelect.setAttribute('data-placeholder', placeholder);\n      } else {\n        autoGearRemoveOwnGearSelect.removeAttribute('data-placeholder');\n      }\n    }\n  }\n  if (autoGearRemoveItemLabel) {\n    const label = texts[lang].autoGearRemoveItemLabel || texts.en?.autoGearRemoveItemLabel || autoGearRemoveItemLabel.textContent;\n    const hint = texts[lang].autoGearRemoveMultipleHint || texts.en?.autoGearRemoveMultipleHint || '';\n    const helpText = hint ? `${label}  ${hint} ` : label;\n    autoGearRemoveItemLabel.textContent = label;\n    autoGearRemoveItemLabel.setAttribute('data-help', helpText);\n    if (autoGearRemoveNameInput) {\n      autoGearRemoveNameInput.setAttribute('aria-label', label);\n      autoGearRemoveNameInput.setAttribute('data-help', helpText);\n      if (hint) {\n        autoGearRemoveNameInput.setAttribute('placeholder', hint);\n      } else {\n        autoGearRemoveNameInput.removeAttribute('placeholder');\n      }\n    }\n  }\n  if (autoGearRemoveCategoryLabel) {\n    const label = texts[lang].autoGearRemoveCategoryLabel || texts.en?.autoGearRemoveCategoryLabel || autoGearRemoveCategoryLabel.textContent;\n    autoGearRemoveCategoryLabel.textContent = label;\n    if (autoGearRemoveCategorySelect) {\n      autoGearRemoveCategorySelect.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearRemoveQuantityLabel) {\n    const label = texts[lang].autoGearRemoveQuantityLabel || texts.en?.autoGearRemoveQuantityLabel || autoGearRemoveQuantityLabel.textContent;\n    autoGearRemoveQuantityLabel.textContent = label;\n    if (autoGearRemoveQuantityInput) {\n      autoGearRemoveQuantityInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearRemoveScreenSizeLabel) {\n    const label = texts[lang].autoGearRemoveScreenSizeLabel || texts.en?.autoGearRemoveScreenSizeLabel || autoGearRemoveScreenSizeLabel.textContent;\n    autoGearRemoveScreenSizeLabel.textContent = label;\n    if (autoGearRemoveScreenSizeInput) {\n      autoGearRemoveScreenSizeInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearRemoveSelectorTypeLabel) {\n    const label = texts[lang].autoGearRemoveSelectorTypeLabel || texts.en?.autoGearRemoveSelectorTypeLabel || autoGearRemoveSelectorTypeLabel.textContent;\n    autoGearRemoveSelectorTypeLabel.textContent = label;\n    if (autoGearRemoveSelectorTypeSelect) {\n      autoGearRemoveSelectorTypeSelect.setAttribute('aria-label', label);\n      const noneLabel = texts[lang].autoGearSelectorNoneOption || texts.en?.autoGearSelectorNoneOption || 'No selector';\n      const monitorLabel = texts[lang].autoGearSelectorMonitorOption || texts.en?.autoGearSelectorMonitorOption || 'Monitor selector';\n      const directorLabel = texts[lang].autoGearSelectorDirectorOption || texts.en?.autoGearSelectorDirectorOption || 'Director monitor selector';\n      const tripodHeadLabel = texts[lang].autoGearSelectorTripodHeadOption || texts.en?.autoGearSelectorTripodHeadOption || 'Tripod head selector';\n      const tripodBowlLabel = texts[lang].autoGearSelectorTripodBowlOption || texts.en?.autoGearSelectorTripodBowlOption || 'Tripod bowl selector';\n      const tripodTypesLabel = texts[lang].autoGearSelectorTripodTypesOption || texts.en?.autoGearSelectorTripodTypesOption || 'Tripod type selector';\n      const tripodSpreaderLabel = texts[lang].autoGearSelectorTripodSpreaderOption || texts.en?.autoGearSelectorTripodSpreaderOption || 'Tripod spreader selector';\n      const selectorLabels = new Map([\n        ['none', noneLabel],\n        ['monitor', monitorLabel],\n        ['directorMonitor', directorLabel],\n        ['tripodHeadBrand', tripodHeadLabel],\n        ['tripodBowl', tripodBowlLabel],\n        ['tripodTypes', tripodTypesLabel],\n        ['tripodSpreader', tripodSpreaderLabel],\n      ]);\n      Array.from(autoGearRemoveSelectorTypeSelect.options || []).forEach(opt => {\n        const text = selectorLabels.get(opt.value);\n        if (text) opt.textContent = text;\n      });\n    }\n  }\n  if (autoGearRemoveSelectorDefaultLabel) {\n    const label = texts[lang].autoGearRemoveSelectorDefaultLabel || texts.en?.autoGearRemoveSelectorDefaultLabel || autoGearRemoveSelectorDefaultLabel.textContent;\n    autoGearRemoveSelectorDefaultLabel.textContent = label;\n    if (autoGearRemoveSelectorDefaultInput) {\n      autoGearRemoveSelectorDefaultInput.setAttribute('aria-label', label);\n    }\n  }\n  if (autoGearRemoveNotesLabel) {\n    const label = texts[lang].autoGearRemoveNotesLabel || texts.en?.autoGearRemoveNotesLabel || autoGearRemoveNotesLabel.textContent;\n    autoGearRemoveNotesLabel.textContent = label;\n    if (autoGearRemoveNotesInput) {\n      autoGearRemoveNotesInput.setAttribute('aria-label', label);\n    }\n  }\n  updateAutoGearOwnGearOptions();\n  if (autoGearDraftImpactHeading) {\n    const heading = texts[lang].autoGearDraftImpactHeading\n      || texts.en?.autoGearDraftImpactHeading\n      || autoGearDraftImpactHeading.textContent;\n    autoGearDraftImpactHeading.textContent = heading;\n  }\n  if (autoGearDraftImpactDescription) {\n    const description = texts[lang].autoGearDraftImpactDescription\n      || texts.en?.autoGearDraftImpactDescription\n      || autoGearDraftImpactDescription.textContent;\n    autoGearDraftImpactDescription.textContent = description;\n    if (autoGearDraftImpactHeading) {\n      autoGearDraftImpactHeading.setAttribute('data-help', description);\n    }\n    if (autoGearDraftImpactContainer) {\n      autoGearDraftImpactContainer.setAttribute('data-help', description);\n    }\n  }\n  if (autoGearDraftWarningHeading) {\n    const heading = texts[lang].autoGearDraftWarningHeading\n      || texts.en?.autoGearDraftWarningHeading\n      || autoGearDraftWarningHeading.textContent;\n    autoGearDraftWarningHeading.textContent = heading;\n  }\n  if (autoGearRemoveItemButton) {\n    if (typeof updateAutoGearItemButtonState === 'function') {\n      updateAutoGearItemButtonState('remove');\n    }\n  }\n  if (autoGearSaveRuleButton) {\n    const label = texts[lang].autoGearSaveRule || texts.en?.autoGearSaveRule || autoGearSaveRuleButton.textContent;\n    setButtonLabelWithIconBinding(autoGearSaveRuleButton, label);\n    autoGearSaveRuleButton.setAttribute('data-help', label);\n  }\n  if (autoGearCancelEditButton) {\n    const label = texts[lang].autoGearCancelEdit || texts.en?.autoGearCancelEdit || autoGearCancelEditButton.textContent;\n    setButtonLabelWithIconBinding(autoGearCancelEditButton, label, ICON_GLYPHS.circleX);\n    autoGearCancelEditButton.setAttribute('data-help', label);\n  }\n  if (autoGearAddCategorySelect) {\n    populateAutoGearCategorySelect(autoGearAddCategorySelect, autoGearAddCategorySelect.value);\n  }\n  if (autoGearRemoveCategorySelect) {\n    populateAutoGearCategorySelect(autoGearRemoveCategorySelect, autoGearRemoveCategorySelect.value);\n  }\n  syncAutoGearMonitorFieldVisibility();\n  if (autoGearScenariosSelect) {\n    refreshAutoGearScenarioOptions(autoGearEditorDraft?.scenarios);\n  }\n  if (autoGearMatteboxSelect) {\n    refreshAutoGearMatteboxOptions(autoGearEditorDraft?.mattebox);\n  }\n  if (autoGearCameraHandleSelect) {\n    refreshAutoGearCameraHandleOptions(autoGearEditorDraft?.cameraHandle);\n  }\n  if (autoGearViewfinderExtensionSelect) {\n    refreshAutoGearViewfinderExtensionOptions(autoGearEditorDraft?.viewfinderExtension);\n  }\n  if (autoGearDeliveryResolutionSelect) {\n    refreshAutoGearDeliveryResolutionOptions(autoGearEditorDraft?.deliveryResolution);\n  }\n  if (autoGearVideoDistributionSelect) {\n    refreshAutoGearVideoDistributionOptions(autoGearEditorDraft?.videoDistribution);\n  }\n  callCoreFunctionIfAvailable(\n    'seedAutoGearRulesFromCurrentProject',\n    [],\n    { defer: true }\n  );\n  callCoreFunctionIfAvailable('renderAutoGearRulesList', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearDraftLists', [], { defer: true });\n  callCoreFunctionIfAvailable('updateAutoGearCatalogOptions', [], { defer: true });\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n  callCoreFunctionIfAvailable('applyAutoGearBackupVisibility', [], { defer: true });\n  const contrastLabel = document.getElementById(\"settingsHighContrastLabel\");\n  if (contrastLabel) {\n    contrastLabel.textContent = texts[lang].highContrastSetting;\n    const contrastHelp =\n      texts[lang].highContrastSettingHelp || texts[lang].highContrastSetting;\n    contrastLabel.setAttribute(\"data-help\", contrastHelp);\n    if (settingsHighContrast) {\n      settingsHighContrast.setAttribute(\"data-help\", contrastHelp);\n      settingsHighContrast.setAttribute(\n        \"aria-label\",\n        texts[lang].highContrastSetting\n      );\n    }\n  }\n  const accessibilityHeading = document.getElementById(\"accessibilityHeading\");\n  if (accessibilityHeading) {\n    accessibilityHeading.textContent = texts[lang].accessibilityHeading;\n    accessibilityHeading.setAttribute(\n      \"data-help\",\n      texts[lang].accessibilityHeadingHelp || texts[lang].accessibilityHeading\n    );\n  }\n  const backupHeading = document.getElementById(\"backupHeading\");\n  if (backupHeading) {\n    backupHeading.textContent = texts[lang].backupHeading;\n    backupHeading.setAttribute(\n      \"data-help\",\n      texts[lang].backupHeadingHelp || texts[lang].backupHeading\n    );\n  }\n  const projectBackupsHeading =\n    typeof document !== 'undefined'\n      ? document.getElementById('projectBackupsHeading')\n      : null;\n  if (projectBackupsHeading) {\n    const headingText = texts[lang].projectBackupsHeading || \"Project Backups\";\n    projectBackupsHeading.textContent = headingText;\n    const descriptionText = texts[lang].projectBackupsDescription || \"\";\n    if (descriptionText) {\n      projectBackupsHeading.setAttribute(\"data-help\", descriptionText);\n    } else {\n      projectBackupsHeading.removeAttribute(\"data-help\");\n    }\n  }\n  const projectBackupsDescription =\n    typeof document !== 'undefined'\n      ? document.getElementById('projectBackupsDescription')\n      : null;\n  if (projectBackupsDescription) {\n    const descriptionText = texts[lang].projectBackupsDescription || \"\";\n    if (descriptionText) {\n      projectBackupsDescription.textContent = descriptionText;\n      projectBackupsDescription.hidden = false;\n    } else {\n      projectBackupsDescription.textContent = \"\";\n      projectBackupsDescription.hidden = true;\n    }\n  }\n  if (dataHeading) {\n    dataHeading.textContent = texts[lang].dataHeading;\n    const dataHelp = texts[lang].dataHeadingHelp || texts[lang].dataHeading;\n    dataHeading.setAttribute(\"data-help\", dataHelp);\n  }\n  if (storageSummaryIntro) {\n    storageSummaryIntro.textContent = texts[lang].storageSummaryIntro;\n  }\n  if (storageSummaryFootnote) {\n    storageSummaryFootnote.textContent = texts[lang].storageSummaryFootnote;\n  }\n  if (storageSummaryEmpty) {\n    storageSummaryEmpty.textContent = texts[lang].storageSummaryEmpty;\n  }\n  if (storagePersistenceHeading) {\n    const headingText = texts[lang].storagePersistenceHeading\n      || texts.en?.storagePersistenceHeading\n      || storagePersistenceHeading.textContent;\n    storagePersistenceHeading.textContent = headingText;\n    const headingHelp = texts[lang].storagePersistenceHeadingHelp\n      || texts.en?.storagePersistenceHeadingHelp\n      || headingText;\n    storagePersistenceHeading.setAttribute('data-help', headingHelp);\n  }\n  if (storagePersistenceIntro) {\n    storagePersistenceIntro.textContent = texts[lang].storagePersistenceIntro\n      || texts.en?.storagePersistenceIntro\n      || storagePersistenceIntro.textContent;\n  }\n  if (storagePersistenceRequestButton) {\n    const requestLabel = texts[lang].storagePersistenceRequest\n      || texts.en?.storagePersistenceRequest\n      || storagePersistenceRequestButton.textContent;\n    setButtonLabelWithIconBinding(storagePersistenceRequestButton, requestLabel, ICON_GLYPHS.save);\n    storagePersistenceRequestButton.dataset.defaultLabel = requestLabel;\n    const requestHelp = texts[lang].storagePersistenceRequestHelp\n      || texts.en?.storagePersistenceRequestHelp\n      || requestLabel;\n    storagePersistenceRequestButton.setAttribute('data-help', requestHelp);\n    storagePersistenceRequestButton.setAttribute('title', requestHelp);\n    storagePersistenceRequestButton.setAttribute('aria-label', requestHelp);\n  }\n  if (storagePersistenceStatus) {\n    const idleText = texts[lang].storagePersistenceStatusIdle\n      || texts.en?.storagePersistenceStatusIdle\n      || storagePersistenceStatus.textContent;\n    storagePersistenceStatus.textContent = idleText;\n    storagePersistenceStatus.setAttribute('data-help', idleText);\n  }\n  callCoreFunctionIfAvailable('renderStoragePersistenceStatus', [], { defer: true });\n  if (storageActionsHeading) {\n    const headingText = texts[lang].storageActionsHeading\n      || texts.en?.storageActionsHeading\n      || storageActionsHeading.textContent;\n    storageActionsHeading.textContent = headingText;\n    const headingHelp = texts[lang].storageActionsHeadingHelp\n      || texts.en?.storageActionsHeadingHelp\n      || headingText;\n    storageActionsHeading.setAttribute('data-help', headingHelp);\n  }\n  if (storageActionsIntro) {\n    storageActionsIntro.textContent = texts[lang].storageActionsIntro\n      || texts.en?.storageActionsIntro\n      || storageActionsIntro.textContent;\n  }\n  if (storageBackupNowButton) {\n    const backupLabel = texts[lang].storageBackupNow\n      || texts.en?.storageBackupNow\n      || storageBackupNowButton.textContent;\n    setButtonLabelWithIconBinding(storageBackupNowButton, backupLabel, ICON_GLYPHS.fileExport);\n    const backupHelp = texts[lang].storageBackupNowHelp\n      || texts.en?.storageBackupNowHelp\n      || backupLabel;\n    storageBackupNowButton.setAttribute('data-help', backupHelp);\n    storageBackupNowButton.setAttribute('title', backupHelp);\n  }\n  if (storageOpenBackupTabButton) {\n    const openLabel = texts[lang].storageOpenBackupTab\n      || texts.en?.storageOpenBackupTab\n      || storageOpenBackupTabButton.textContent;\n    setButtonLabelWithIconBinding(storageOpenBackupTabButton, openLabel, ICON_GLYPHS.settingsBackup);\n    const openHelp = texts[lang].storageOpenBackupTabHelp\n      || texts.en?.storageOpenBackupTabHelp\n      || openLabel;\n    storageOpenBackupTabButton.setAttribute('data-help', openHelp);\n    storageOpenBackupTabButton.setAttribute('title', openHelp);\n  }\n  if (storageStatusHeading) {\n    const statusHeading = texts[lang].storageStatusHeading\n      || texts.en?.storageStatusHeading\n      || storageStatusHeading.textContent;\n    storageStatusHeading.textContent = statusHeading;\n    const statusHelp = texts[lang].storageStatusHeadingHelp\n      || texts.en?.storageStatusHeadingHelp\n      || statusHeading;\n    storageStatusHeading.setAttribute('data-help', statusHelp);\n  }\n  if (storageStatusLastProjectLabel) {\n    storageStatusLastProjectLabel.textContent = texts[lang].storageStatusLastProjectLabel\n      || texts.en?.storageStatusLastProjectLabel\n      || storageStatusLastProjectLabel.textContent;\n  }\n  if (storageStatusLastAutoBackupLabel) {\n    storageStatusLastAutoBackupLabel.textContent = texts[lang].storageStatusLastAutoBackupLabel\n      || texts.en?.storageStatusLastAutoBackupLabel\n      || storageStatusLastAutoBackupLabel.textContent;\n  }\n  if (storageStatusLastFullBackupLabel) {\n    storageStatusLastFullBackupLabel.textContent = texts[lang].storageStatusLastFullBackupLabel\n      || texts.en?.storageStatusLastFullBackupLabel\n      || storageStatusLastFullBackupLabel.textContent;\n  }\n  const statusDefaultText = texts[lang].storageStatusNever\n    || texts.en?.storageStatusNever\n    || (storageStatusLastProjectValue ? storageStatusLastProjectValue.textContent : '');\n  if (storageStatusLastProjectValue) {\n    storageStatusLastProjectValue.textContent = statusDefaultText;\n  }\n  if (storageStatusLastAutoBackupValue) {\n    storageStatusLastAutoBackupValue.textContent = statusDefaultText;\n  }\n  if (storageStatusLastFullBackupValue) {\n    storageStatusLastFullBackupValue.textContent = statusDefaultText;\n  }\n  if (storageStatusReminder) {\n    storageStatusReminder.textContent = '';\n    storageStatusReminder.setAttribute('hidden', '');\n    storageStatusReminder.classList.remove('storage-status-reminder--warning', 'storage-status-reminder--ok');\n    storageStatusReminder.removeAttribute('data-help');\n  }\n  if (loggingSection) {\n    const sectionHelp = texts[lang].loggingSectionHelp\n      || texts[lang].loggingHeadingHelp\n      || texts.en?.loggingHeadingHelp\n      || '';\n    if (sectionHelp) {\n      loggingSection.setAttribute('data-help', sectionHelp);\n    } else {\n      loggingSection.removeAttribute('data-help');\n    }\n  }\n  if (loggingHeading) {\n    const headingText = texts[lang].loggingHeading\n      || texts.en?.loggingHeading\n      || loggingHeading.textContent\n      || 'Diagnostics log';\n    loggingHeading.textContent = headingText;\n    const headingHelp = texts[lang].loggingHeadingHelp\n      || texts.en?.loggingHeadingHelp\n      || headingText;\n    loggingHeading.setAttribute('data-help', headingHelp);\n  }\n  if (loggingIntro) {\n    loggingIntro.textContent = texts[lang].loggingIntro\n      || texts.en?.loggingIntro\n      || loggingIntro.textContent;\n  }\n  if (loggingLevelFilterLabel) {\n    const filterLabel = texts[lang].loggingLevelFilterLabel\n      || texts.en?.loggingLevelFilterLabel\n      || loggingLevelFilterLabel.textContent;\n    loggingLevelFilterLabel.textContent = filterLabel;\n    loggingLevelFilterLabel.setAttribute('data-help', filterLabel);\n  }\n  if (loggingLevelFilter) {\n    const optionTexts = {\n      all: texts[lang].loggingLevelFilterAll || texts.en?.loggingLevelFilterAll || 'All levels',\n      info: texts[lang].loggingLevelFilterInfo || texts.en?.loggingLevelFilterInfo || 'Info and above',\n      warn: texts[lang].loggingLevelFilterWarn || texts.en?.loggingLevelFilterWarn || 'Warnings and errors',\n      error: texts[lang].loggingLevelFilterError || texts.en?.loggingLevelFilterError || 'Errors only',\n    };\n    Array.from(loggingLevelFilter.options || []).forEach(option => {\n      if (!option || typeof option.value !== 'string') return;\n      const key = option.value;\n      if (Object.prototype.hasOwnProperty.call(optionTexts, key)) {\n        option.textContent = optionTexts[key];\n      }\n    });\n    const filterHelp = texts[lang].loggingLevelFilterHelp\n      || texts.en?.loggingLevelFilterHelp\n      || '';\n    if (filterHelp) {\n      loggingLevelFilter.setAttribute('data-help', filterHelp);\n    } else {\n      loggingLevelFilter.removeAttribute('data-help');\n    }\n  }\n  if (loggingNamespaceFilterLabel) {\n    const namespaceLabel = texts[lang].loggingNamespaceFilterLabel\n      || texts.en?.loggingNamespaceFilterLabel\n      || loggingNamespaceFilterLabel.textContent;\n    loggingNamespaceFilterLabel.textContent = namespaceLabel;\n  }\n  if (loggingNamespaceFilter) {\n    const placeholder = texts[lang].loggingNamespaceFilterPlaceholder\n      || texts.en?.loggingNamespaceFilterPlaceholder\n      || '';\n    if (placeholder) {\n      loggingNamespaceFilter.setAttribute('placeholder', placeholder);\n    }\n    const namespaceHelp = texts[lang].loggingNamespaceFilterHelp\n      || texts.en?.loggingNamespaceFilterHelp\n      || placeholder;\n    if (namespaceHelp) {\n      loggingNamespaceFilter.setAttribute('data-help', namespaceHelp);\n      if (loggingNamespaceFilterLabel) {\n        loggingNamespaceFilterLabel.setAttribute('data-help', namespaceHelp);\n      }\n    }\n    if (loggingNamespaceFilterHelp) {\n      loggingNamespaceFilterHelp.textContent = namespaceHelp;\n      if (namespaceHelp) {\n        loggingNamespaceFilterHelp.removeAttribute('hidden');\n      } else {\n        loggingNamespaceFilterHelp.setAttribute('hidden', '');\n      }\n    }\n  }\n  if (loggingHistoryLimitLabel) {\n    const historyLabel = texts[lang].loggingHistoryLimitLabel\n      || texts.en?.loggingHistoryLimitLabel\n      || loggingHistoryLimitLabel.textContent;\n    loggingHistoryLimitLabel.textContent = historyLabel;\n  }\n  if (loggingHistoryLimitHelp) {\n    const historyHelp = texts[lang].loggingHistoryLimitHelp\n      || texts.en?.loggingHistoryLimitHelp\n      || loggingHistoryLimitHelp.textContent;\n    loggingHistoryLimitHelp.textContent = historyHelp;\n  }\n  if (loggingHistoryLimit) {\n    const limitHelp = texts[lang].loggingHistoryLimitHelp\n      || texts.en?.loggingHistoryLimitHelp\n      || '';\n    if (limitHelp) {\n      loggingHistoryLimit.setAttribute('data-help', limitHelp);\n    } else {\n      loggingHistoryLimit.removeAttribute('data-help');\n    }\n    const limitAria = texts[lang].loggingHistoryLimitAria\n      || texts.en?.loggingHistoryLimitAria\n      || '';\n    if (limitAria) {\n      loggingHistoryLimit.setAttribute('aria-label', limitAria);\n    }\n  }\n  if (loggingConsoleOutputLabel) {\n    const consoleLabel = texts[lang].loggingConsoleOutputLabel\n      || texts.en?.loggingConsoleOutputLabel\n      || loggingConsoleOutputLabel.textContent;\n    loggingConsoleOutputLabel.textContent = consoleLabel;\n  }\n  if (loggingConsoleOutputHelp) {\n    const consoleHelp = texts[lang].loggingConsoleOutputHelp\n      || texts.en?.loggingConsoleOutputHelp\n      || loggingConsoleOutputHelp.textContent;\n    loggingConsoleOutputHelp.textContent = consoleHelp;\n  }\n  if (loggingCaptureConsoleLabel) {\n    const consoleCaptureLabel = texts[lang].loggingCaptureConsoleLabel\n      || texts.en?.loggingCaptureConsoleLabel\n      || loggingCaptureConsoleLabel.textContent;\n    loggingCaptureConsoleLabel.textContent = consoleCaptureLabel;\n  }\n  if (loggingCaptureConsoleHelp) {\n    const consoleCaptureHelp = texts[lang].loggingCaptureConsoleHelp\n      || texts.en?.loggingCaptureConsoleHelp\n      || loggingCaptureConsoleHelp.textContent;\n    loggingCaptureConsoleHelp.textContent = consoleCaptureHelp;\n  }\n  if (loggingCaptureErrorsLabel) {\n    const captureLabel = texts[lang].loggingCaptureErrorsLabel\n      || texts.en?.loggingCaptureErrorsLabel\n      || loggingCaptureErrorsLabel.textContent;\n    loggingCaptureErrorsLabel.textContent = captureLabel;\n  }\n  if (loggingCaptureErrorsHelp) {\n    const captureHelp = texts[lang].loggingCaptureErrorsHelp\n      || texts.en?.loggingCaptureErrorsHelp\n      || loggingCaptureErrorsHelp.textContent;\n    loggingCaptureErrorsHelp.textContent = captureHelp;\n  }\n  if (loggingPersistSessionLabel) {\n    const persistLabel = texts[lang].loggingPersistSessionLabel\n      || texts.en?.loggingPersistSessionLabel\n      || loggingPersistSessionLabel.textContent;\n    loggingPersistSessionLabel.textContent = persistLabel;\n  }\n  if (loggingPersistSessionHelp) {\n    const persistHelp = texts[lang].loggingPersistSessionHelp\n      || texts.en?.loggingPersistSessionHelp\n      || loggingPersistSessionHelp.textContent;\n    loggingPersistSessionHelp.textContent = persistHelp;\n  }\n  if (loggingExportButton) {\n    const exportLabel = texts[lang].loggingExportButton\n      || texts.en?.loggingExportButton\n      || loggingExportButton.textContent;\n    setButtonLabelWithIconBinding(loggingExportButton, exportLabel, ICON_GLYPHS.fileExport);\n    loggingExportButton.setAttribute('data-help', exportLabel);\n    loggingExportButton.setAttribute('title', exportLabel);\n    loggingExportButton.setAttribute('aria-label', exportLabel);\n  }\n  if (loggingExportHelp) {\n    const exportHelp = texts[lang].loggingExportHelp\n      || texts.en?.loggingExportHelp\n      || loggingExportHelp.textContent;\n    loggingExportHelp.textContent = exportHelp;\n    loggingExportHelp.setAttribute('data-help', exportHelp);\n  }\n  if (loggingStatus) {\n    const statusText = texts[lang].loggingStatusIdle\n      || texts.en?.loggingStatusIdle\n      || '';\n    loggingStatus.textContent = statusText;\n    if (statusText) {\n      loggingStatus.setAttribute('data-help', statusText);\n    }\n  }\n  if (loggingEmpty) {\n    const emptyText = texts[lang].loggingEmptyState\n      || texts.en?.loggingEmptyState\n      || loggingEmpty.textContent;\n    loggingEmpty.textContent = emptyText;\n    if (emptyText) {\n      loggingEmpty.setAttribute('data-help', emptyText);\n    }\n  }\n  if (loggingUnavailable) {\n    loggingUnavailable.textContent = texts[lang].loggingUnavailable\n      || texts.en?.loggingUnavailable\n      || loggingUnavailable.textContent;\n  }\n  const showAutoBackupsLabel = document.getElementById(\"settingsShowAutoBackupsLabel\");\n  if (showAutoBackupsLabel) {\n    showAutoBackupsLabel.textContent = texts[lang].showAutoBackupsSetting;\n    const autoBackupsHelp =\n      texts[lang].showAutoBackupsHelp || texts[lang].showAutoBackupsSetting;\n    showAutoBackupsLabel.setAttribute(\"data-help\", autoBackupsHelp);\n    if (settingsShowAutoBackupsEl) {\n      settingsShowAutoBackupsEl.setAttribute(\"data-help\", autoBackupsHelp);\n      settingsShowAutoBackupsEl.setAttribute(\n        \"aria-label\",\n        texts[lang].showAutoBackupsSetting\n      );\n    }\n  }\n  if (backupDiffToggleButtonEl) {\n    const compareLabel = texts[lang].versionCompareButton || 'Compare versions';\n    setButtonLabelWithIconBinding(backupDiffToggleButtonEl, compareLabel, ICON_GLYPHS.note);\n    const compareHelp = texts[lang].versionCompareButtonHelp || compareLabel;\n    backupDiffToggleButtonEl.setAttribute('data-help', compareHelp);\n    backupDiffToggleButtonEl.setAttribute('title', compareHelp);\n  }\n  if (backupDiffHeadingEl) {\n    backupDiffHeadingEl.textContent = texts[lang].versionCompareHeading || 'Version comparison';\n  }\n  if (backupDiffIntroEl) {\n    backupDiffIntroEl.textContent = texts[lang].versionCompareIntro || '';\n  }\n  if (backupDiffPrimaryLabelEl) {\n    const primaryLabel = texts[lang].versionComparePrimaryLabel || 'Baseline version';\n    backupDiffPrimaryLabelEl.textContent = primaryLabel;\n    if (backupDiffPrimarySelectEl) {\n      backupDiffPrimarySelectEl.setAttribute('aria-label', primaryLabel);\n    }\n  }\n  if (backupDiffSecondaryLabelEl) {\n    const compareLabelText = texts[lang].versionCompareSecondaryLabel || 'Comparison version';\n    backupDiffSecondaryLabelEl.textContent = compareLabelText;\n    if (backupDiffSecondarySelectEl) {\n      backupDiffSecondarySelectEl.setAttribute('aria-label', compareLabelText);\n    }\n  }\n  if (backupDiffEmptyStateEl) {\n    backupDiffEmptyStateEl.textContent =\n      texts[lang].versionCompareEmpty\n      || 'Save a project or wait for auto-backups to start comparing versions.';\n  }\n  if (backupDiffNotesLabelEl) {\n    backupDiffNotesLabelEl.textContent = texts[lang].versionCompareNotesLabel || 'Incident notes';\n  }\n  if (backupDiffNotesEl) {\n    const placeholder = texts[lang].versionCompareNotesPlaceholder\n      || 'Record context, on-set observations, or required follow-up.';\n    backupDiffNotesEl.placeholder = placeholder;\n  }\n  if (backupDiffExportButtonEl) {\n    const exportLabel = texts[lang].versionCompareExport || 'Export log';\n    setButtonLabelWithIconBinding(backupDiffExportButtonEl, exportLabel, ICON_GLYPHS.fileExport);\n    const exportHelp = texts[lang].versionCompareExportHelp || exportLabel;\n    backupDiffExportButtonEl.setAttribute('data-help', exportHelp);\n    backupDiffExportButtonEl.setAttribute('title', exportHelp);\n  }\n  if (backupDiffCloseButtonEl) {\n    const closeLabel = texts[lang].versionCompareClose\n      || texts[lang].cancelSettings\n      || 'Close';\n    setButtonLabelWithIconBinding(backupDiffCloseButtonEl, closeLabel, ICON_GLYPHS.circleX);\n  }\n  if (backupSettingsButton) {\n    const backupLabel = texts[lang].backupSettings;\n    setButtonLabelWithIconBinding(backupSettingsButton, backupLabel, ICON_GLYPHS.fileExport);\n    const backupHelp =\n      texts[lang].backupSettingsHelp || backupLabel;\n    backupSettingsButton.setAttribute(\"data-help\", backupHelp);\n    backupSettingsButton.setAttribute(\"title\", backupHelp);\n    backupSettingsButton.setAttribute(\"aria-label\", backupHelp);\n  }\n  if (restoreSettings) {\n    const restoreLabel = texts[lang].restoreSettings;\n    setButtonLabelWithIconBinding(restoreSettings, restoreLabel, ICON_GLYPHS.fileImport);\n    const restoreHelp =\n      texts[lang].restoreSettingsHelp || restoreLabel;\n    restoreSettings.setAttribute(\"data-help\", restoreHelp);\n    restoreSettings.setAttribute(\"title\", restoreHelp);\n    restoreSettings.setAttribute(\"aria-label\", restoreHelp);\n  }\n  if (restoreRehearsalButton) {\n    const rehearsalLabel = texts[lang].restoreRehearsalButton || 'Restore rehearsal';\n    setButtonLabelWithIconBinding(restoreRehearsalButton, rehearsalLabel, ICON_GLYPHS.load);\n    const rehearsalHelp = texts[lang].restoreRehearsalButtonHelp || rehearsalLabel;\n    restoreRehearsalButton.setAttribute('data-help', rehearsalHelp);\n    restoreRehearsalButton.setAttribute('title', rehearsalHelp);\n    restoreRehearsalButton.setAttribute('aria-label', rehearsalHelp);\n  }\n  if (restoreRehearsalHeading) {\n    restoreRehearsalHeading.textContent = texts[lang].restoreRehearsalHeading || restoreRehearsalHeading.textContent;\n  }\n  if (restoreRehearsalIntro) {\n    restoreRehearsalIntro.textContent = texts[lang].restoreRehearsalIntro || restoreRehearsalIntro.textContent;\n  }\n  if (restoreRehearsalModeLabel) {\n    restoreRehearsalModeLabel.textContent = texts[lang].restoreRehearsalModeLabel || restoreRehearsalModeLabel.textContent;\n  }\n  if (restoreRehearsalModeBackupText) {\n    restoreRehearsalModeBackupText.textContent = texts[lang].restoreRehearsalModeBackup || restoreRehearsalModeBackupText.textContent;\n  }\n  if (restoreRehearsalModeProjectText) {\n    restoreRehearsalModeProjectText.textContent = texts[lang].restoreRehearsalModeProject || restoreRehearsalModeProjectText.textContent;\n  }\n  if (restoreRehearsalFileLabel) {\n    restoreRehearsalFileLabel.textContent = texts[lang].restoreRehearsalFileLabel || restoreRehearsalFileLabel.textContent;\n  }\n  if (restoreRehearsalBrowse) {\n    const browseLabel = texts[lang].restoreRehearsalFileButton || 'Choose file';\n    setButtonLabelWithIconBinding(restoreRehearsalBrowse, browseLabel, ICON_GLYPHS.fileImport);\n    restoreRehearsalBrowse.setAttribute('data-help', browseLabel);\n    restoreRehearsalBrowse.setAttribute('title', browseLabel);\n    restoreRehearsalBrowse.setAttribute('aria-label', browseLabel);\n  }\n  if (restoreRehearsalFileName) {\n    restoreRehearsalFileName.textContent = texts[lang].restoreRehearsalNoFile || restoreRehearsalFileName.textContent;\n  }\n  if (restoreRehearsalStatus) {\n    restoreRehearsalStatus.textContent = texts[lang].restoreRehearsalReady || '';\n  }\n  if (restoreRehearsalRuleHeading) {\n    restoreRehearsalRuleHeading.textContent = texts[lang].restoreRehearsalRuleHeading\n      || texts.en?.restoreRehearsalRuleHeading\n      || restoreRehearsalRuleHeading.textContent;\n  }\n  if (restoreRehearsalRuleIntro) {\n    restoreRehearsalRuleIntro.textContent = texts[lang].restoreRehearsalRuleIntro\n      || texts.en?.restoreRehearsalRuleIntro\n      || restoreRehearsalRuleIntro.textContent;\n  }\n  if (restoreRehearsalRuleEmpty) {\n    restoreRehearsalRuleEmpty.textContent = texts[lang].restoreRehearsalRuleEmpty\n      || texts.en?.restoreRehearsalRuleEmpty\n      || restoreRehearsalRuleEmpty.textContent;\n  }\n  if (restoreRehearsalTableCaption) {\n    restoreRehearsalTableCaption.textContent = texts[lang].restoreRehearsalTableCaption || restoreRehearsalTableCaption.textContent;\n  }\n  if (restoreRehearsalMetricHeader) {\n    restoreRehearsalMetricHeader.textContent = texts[lang].restoreRehearsalMetricColumn || restoreRehearsalMetricHeader.textContent;\n  }\n  if (restoreRehearsalLiveHeader) {\n    restoreRehearsalLiveHeader.textContent = texts[lang].restoreRehearsalLiveColumn || restoreRehearsalLiveHeader.textContent;\n  }\n  if (restoreRehearsalSandboxHeader) {\n    restoreRehearsalSandboxHeader.textContent = texts[lang].restoreRehearsalSandboxColumn || restoreRehearsalSandboxHeader.textContent;\n  }\n  if (restoreRehearsalDifferenceHeader) {\n    restoreRehearsalDifferenceHeader.textContent = texts[lang].restoreRehearsalDifferenceColumn || restoreRehearsalDifferenceHeader.textContent;\n  }\n  const resolvedRestoreRehearsalCloseButton =\n    typeof restoreRehearsalCloseButton !== 'undefined'\n      ? restoreRehearsalCloseButton\n      : resolveElement('restoreRehearsalCloseButton', 'restoreRehearsalClose');\n\n  if (resolvedRestoreRehearsalCloseButton) {\n    const closeLabel = texts[lang].restoreRehearsalClose || texts[lang].cancelSettings || 'Close';\n    setButtonLabelWithIconBinding(resolvedRestoreRehearsalCloseButton, closeLabel, ICON_GLYPHS.circleX);\n    resolvedRestoreRehearsalCloseButton.setAttribute('title', closeLabel);\n    resolvedRestoreRehearsalCloseButton.setAttribute('aria-label', closeLabel);\n  }\n  if (restoreRehearsalProceedButton) {\n    const proceedLabel = texts[lang].restoreRehearsalProceed\n      || texts.en?.restoreRehearsalProceed\n      || 'Resume restore rehearsal';\n    const proceedHelp = texts[lang].restoreRehearsalProceedHelp\n      || texts.en?.restoreRehearsalProceedHelp\n      || proceedLabel;\n    setButtonLabelWithIconBinding(restoreRehearsalProceedButton, proceedLabel, ICON_GLYPHS.check);\n    restoreRehearsalProceedButton.setAttribute('data-help', proceedHelp);\n    restoreRehearsalProceedButton.setAttribute('title', proceedHelp);\n    restoreRehearsalProceedButton.setAttribute('aria-label', proceedHelp);\n  }\n  if (restoreRehearsalAbortButton) {\n    const abortLabel = texts[lang].restoreRehearsalAbort\n      || texts.en?.restoreRehearsalAbort\n      || 'Abort rehearsal';\n    const abortHelp = texts[lang].restoreRehearsalAbortHelp\n      || texts.en?.restoreRehearsalAbortHelp\n      || abortLabel;\n    setButtonLabelWithIconBinding(restoreRehearsalAbortButton, abortLabel, ICON_GLYPHS.circleX);\n    restoreRehearsalAbortButton.setAttribute('data-help', abortHelp);\n    restoreRehearsalAbortButton.setAttribute('title', abortHelp);\n    restoreRehearsalAbortButton.setAttribute('aria-label', abortHelp);\n  }\n  if (factoryResetButton) {\n    const resetLabel = texts[lang].factoryResetButton || \"Factory reset\";\n    const resetHelp =\n      texts[lang].factoryResetButtonHelp || resetLabel;\n    setButtonLabelWithIconBinding(factoryResetButton, resetLabel, ICON_GLYPHS.reload);\n    factoryResetButton.setAttribute(\"data-help\", resetHelp);\n    factoryResetButton.setAttribute(\"title\", resetHelp);\n    factoryResetButton.setAttribute(\"aria-label\", resetHelp);\n  }\n  const aboutHeading = document.getElementById(\"aboutHeading\");\n  if (aboutHeading) {\n    aboutHeading.textContent = texts[lang].aboutHeading;\n    aboutHeading.setAttribute(\n      \"data-help\",\n      texts[lang].aboutHeadingHelp || texts[lang].aboutHeading\n    );\n  }\n  const aboutVersionElem =\n    typeof document !== 'undefined' ? document.getElementById('aboutVersion') : null;\n  if (aboutVersionElem)\n    aboutVersionElem.textContent = `${texts[lang].versionLabel} ${APP_VERSION} `;\n  const supportLinkConfigs = [\n    { id: 'supportLink', textKey: 'supportLink', helpKey: 'supportLinkHelp' },\n    { id: 'reportBugLink', textKey: 'reportBugLink', helpKey: 'reportBugLinkHelp' },\n    { id: 'suggestFeatureLink', textKey: 'suggestFeatureLink', helpKey: 'suggestFeatureLinkHelp' },\n  ];\n  const langTexts = (texts && texts[lang]) || {};\n  const fallbackTexts = (texts && texts.en) || {};\n  supportLinkConfigs.forEach(config => {\n    const link =\n      typeof document !== 'undefined' ? document.getElementById(config.id) : null;\n    if (!link) {\n      return;\n    }\n    const label =\n      (typeof langTexts[config.textKey] === 'string' && langTexts[config.textKey]) ||\n      (typeof fallbackTexts[config.textKey] === 'string' && fallbackTexts[config.textKey]) ||\n      link.textContent;\n    link.textContent = label;\n    const help =\n      (typeof langTexts[config.helpKey] === 'string' && langTexts[config.helpKey]) ||\n      (typeof fallbackTexts[config.helpKey] === 'string' && fallbackTexts[config.helpKey]) ||\n      label;\n    link.setAttribute('data-help', help);\n    link.setAttribute('title', help);\n    link.setAttribute('aria-label', help);\n  });\n  if (settingsSave) {\n    const label = texts[lang].saveSettings || texts.en?.saveSettings || settingsSave.textContent;\n    setButtonLabelWithIconBinding(settingsSave, label);\n    const saveHelp = texts[lang].saveSettingsHelp || texts[lang].saveSettings || label;\n    settingsSave.setAttribute(\"data-help\", saveHelp);\n    settingsSave.setAttribute(\"title\", saveHelp);\n    settingsSave.setAttribute(\"aria-label\", saveHelp);\n  }\n  if (settingsCancel) {\n    const cancelLabel =\n      texts[lang].cancelSettings || texts.en?.cancelSettings || settingsCancel.textContent;\n    setButtonLabelWithIconBinding(settingsCancel, cancelLabel, ICON_GLYPHS.circleX);\n    const cancelHelp =\n      texts[lang].cancelSettingsHelp || texts[lang].cancelSettings || cancelLabel;\n    settingsCancel.setAttribute(\"data-help\", cancelHelp);\n    settingsCancel.setAttribute(\"title\", cancelHelp);\n    settingsCancel.setAttribute(\"aria-label\", cancelHelp);\n  }\n  const menuToggle = document.getElementById(\"menuToggle\");\n  if (menuToggle) {\n    const menuLabel =\n      texts[lang].menuToggleLabel ||\n      texts.en?.menuToggleLabel ||\n      menuToggle.getAttribute(\"aria-label\") ||\n      \"Menu\";\n    const closeLabel =\n      texts[lang].sideMenuClose ||\n      texts.en?.sideMenuClose ||\n      menuToggle.dataset.closeLabel ||\n      \"Close menu\";\n    const closeHelp = texts[lang].sideMenuCloseHelp || closeLabel;\n    menuToggle.setAttribute(\"title\", menuLabel);\n    menuToggle.setAttribute(\"aria-label\", menuLabel);\n    const menuHelp = texts[lang].menuToggleHelp || menuLabel;\n    menuToggle.setAttribute(\"data-help\", menuHelp);\n    menuToggle.dataset.menuLabel = menuLabel;\n    menuToggle.dataset.menuHelp = menuHelp;\n    menuToggle.dataset.closeLabel = closeLabel;\n    menuToggle.dataset.closeHelp = closeHelp;\n  }\n  const sideMenu = document.getElementById(\"sideMenu\");\n  if (sideMenu) {\n    const sideMenuHelp = texts[lang].sideMenuHelp;\n    if (sideMenuHelp) {\n      sideMenu.setAttribute(\"data-help\", sideMenuHelp);\n    } else {\n      sideMenu.removeAttribute(\"data-help\");\n    }\n  }\n  const sideMenuTitle = document.getElementById(\"sideMenuTitle\");\n  if (sideMenuTitle) {\n    const titleLabel =\n      texts[lang].sideMenuTitle ||\n      texts.en?.sideMenuTitle ||\n      sideMenuTitle.textContent;\n    sideMenuTitle.textContent = titleLabel;\n    const titleHelp =\n      texts[lang].sideMenuTitleHelp ||\n      texts[lang].sideMenuHelp ||\n      titleLabel;\n    sideMenuTitle.setAttribute(\"data-help\", titleHelp);\n  }\n  const closeMenuButton = document.getElementById(\"closeMenuButton\");\n  const closeMenuLabel = document.getElementById(\"closeMenuLabel\");\n  if (closeMenuButton) {\n    const closeLabel =\n      texts[lang].sideMenuClose ||\n      texts.en?.sideMenuClose ||\n      closeMenuButton.getAttribute(\"aria-label\") ||\n      \"Close menu\";\n    const closeHelp = texts[lang].sideMenuCloseHelp || closeLabel;\n    closeMenuButton.setAttribute(\"aria-label\", closeLabel);\n    closeMenuButton.setAttribute(\"title\", closeHelp);\n    closeMenuButton.setAttribute(\"data-help\", closeHelp);\n    if (closeMenuLabel) {\n      closeMenuLabel.textContent = closeLabel;\n    }\n  }\n  if (typeof window !== 'undefined') window.openSideMenu = openSideMenu;\n  if (reloadButton) {\n    const reloadLabel = texts[lang].reloadAppLabel;\n    const reloadHelp = texts[lang].reloadAppHelp || reloadLabel;\n    const offlineNotice = texts[lang].reloadAppOfflineNotice || reloadLabel;\n    reloadButton.setAttribute('title', reloadLabel);\n    reloadButton.setAttribute('aria-label', reloadLabel);\n    reloadButton.setAttribute('data-help', reloadHelp);\n    if (reloadButton.dataset) {\n      reloadButton.dataset.onlineTitle = reloadLabel;\n      reloadButton.dataset.onlineHelp = reloadHelp;\n      reloadButton.dataset.offlineNotice = offlineNotice;\n    }\n    if (reloadButton.hasAttribute('aria-disabled')) {\n      reloadButton.setAttribute('title', offlineNotice);\n      reloadButton.setAttribute('data-help', offlineNotice);\n    }\n  }\n  if (featureSearch) {\n    featureSearch.setAttribute(\"placeholder\", texts[lang].featureSearchPlaceholder);\n    featureSearch.setAttribute(\"aria-label\", texts[lang].featureSearchLabel);\n    featureSearch.setAttribute(\n      \"data-help\",\n      texts[lang].featureSearchHelp || texts[lang].featureSearchLabel\n    );\n  }\n  if (helpButton) {\n    helpButton.setAttribute(\n      \"title\",\n      texts[lang].helpButtonTitle || texts[lang].helpButtonLabel\n    );\n    helpButton.setAttribute(\"aria-label\", texts[lang].helpButtonLabel);\n    helpButton.setAttribute(\n      \"data-help\",\n      texts[lang].helpButtonHelp ||\n      texts[lang].helpButtonTitle ||\n      texts[lang].helpButtonLabel\n    );\n    const helpShortcutList = texts[lang].helpButtonShortcuts;\n    if (typeof helpShortcutList === 'string' && helpShortcutList.trim()) {\n      helpButton.setAttribute('data-shortcuts', helpShortcutList);\n    } else {\n      helpButton.removeAttribute('data-shortcuts');\n    }\n    const helpAriaShortcuts =\n      texts[lang].helpButtonAriaShortcuts ||\n      'F1 Control+Slash Meta+Slash Shift+Slash KeyH';\n    if (typeof helpAriaShortcuts === 'string' && helpAriaShortcuts.trim()) {\n      helpButton.setAttribute('aria-keyshortcuts', helpAriaShortcuts);\n    } else {\n      helpButton.removeAttribute('aria-keyshortcuts');\n    }\n    if (hoverHelpButton) {\n      setButtonLabelWithIconBinding(hoverHelpButton, texts[lang].hoverHelpButtonLabel, ICON_GLYPHS.note);\n      hoverHelpButton.setAttribute(\"aria-label\", texts[lang].hoverHelpButtonLabel);\n      hoverHelpButton.setAttribute(\n        \"data-help\",\n        texts[lang].hoverHelpButtonHelp || texts[lang].hoverHelpButtonLabel\n      );\n    }\n    if (helpSearch) {\n      helpSearch.setAttribute(\"placeholder\", texts[lang].helpSearchPlaceholder);\n      helpSearch.setAttribute(\"aria-label\", texts[lang].helpSearchLabel);\n      helpSearch.setAttribute(\n        \"data-help\",\n        texts[lang].helpSearchHelp || texts[lang].helpSearchLabel\n      );\n    }\n    if (helpSearchClear) {\n      helpSearchClear.setAttribute(\"title\", texts[lang].helpSearchClear);\n      helpSearchClear.setAttribute(\"aria-label\", texts[lang].helpSearchClear);\n      helpSearchClear.setAttribute(\n        \"data-help\",\n        texts[lang].helpSearchClearHelp || texts[lang].helpSearchClear\n      );\n    }\n    if (closeHelpBtn) {\n      setButtonLabelWithIconBinding(closeHelpBtn, texts[lang].helpClose, ICON_GLYPHS.circleX);\n      closeHelpBtn.setAttribute(\"title\", texts[lang].helpClose);\n      closeHelpBtn.setAttribute(\"aria-label\", texts[lang].helpClose);\n      closeHelpBtn.setAttribute(\n        \"data-help\",\n        texts[lang].helpCloseHelp || texts[lang].helpClose\n      );\n    }\n    if (document.getElementById(\"helpTitle\")) {\n      document.getElementById(\"helpTitle\").textContent = texts[lang].helpTitle;\n    }\n    if (helpNoResults) {\n      applyTextContent(\n        helpNoResults,\n        \"helpNoResults\",\n        \"No help topics match your search. Try shorter keywords, synonyms or clear the field to browse everything.\"\n      );\n    }\n    if (helpNoResultsSuggestionsHeading) {\n      applyTextContent(\n        helpNoResultsSuggestionsHeading,\n        \"helpNoResultsSuggestionsHeading\",\n        \"Need a different result?\"\n      );\n    }\n    if (helpNoResultsSuggestionsIntro) {\n      applyTextContent(\n        helpNoResultsSuggestionsIntro,\n        \"helpNoResultsSuggestionsIntro\",\n        \"Try these steps to get back on track while keeping your data safe:\"\n      );\n    }\n    const quickStartHeading =\n      doc && doc.querySelector ? doc.querySelector(\"#helpQuickStartGuide h4\") : null;\n    if (quickStartHeading) {\n      const fallback = quickStartHeading.textContent || \"Quick start checklist\";\n      applyTextContent(quickStartHeading, \"helpQuickStartChecklistTitle\", fallback);\n    }\n    const onboardingCopyElement = doc ? doc.getElementById(\"helpOnboardingTutorialCopy\") : null;\n    if (onboardingCopyElement) {\n      const fallbackCopy = onboardingCopyElement.textContent || \"to walk through every workflow before configuring your first project.\";\n      applyTextContent(onboardingCopyElement, \"helpOnboardingTutorialCopy\", fallbackCopy);\n    }\n    const dataSafetyHeading =\n      doc && doc.querySelector ? doc.querySelector(\"#helpDataSafety h4\") : null;\n    if (dataSafetyHeading) {\n      const fallback = dataSafetyHeading.textContent || \"Protect your work\";\n      applyTextContent(dataSafetyHeading, \"helpDataSafetyTitle\", fallback);\n    }\n    const restoreDrillHeading = doc ? doc.getElementById(\"helpRestoreDrillHeading\") : null;\n    if (restoreDrillHeading) {\n      const fallback = restoreDrillHeading.textContent || \"Restore rehearsal drill\";\n      applyTextContent(restoreDrillHeading, \"helpRestoreDrillTitle\", fallback);\n    }\n    const restoreDrillNote = doc ? doc.getElementById(\"helpRestoreDrillNote\") : null;\n    if (restoreDrillNote) {\n      const fallback =\n        restoreDrillNote.textContent\n        || \"Record the filename, timestamp and verification results in your backup log before closing the rehearsal so every drill leaves behind a documented recovery point.\";\n      applyTextContent(restoreDrillNote, \"helpRestoreDrillNote\", fallback);\n    }\n    if (helpDataAuditHeading) {\n      const fallback = helpDataAuditHeading.textContent || \"Monthly data health check\";\n      applyTextContent(helpDataAuditHeading, \"helpDataAuditTitle\", fallback);\n    }\n    applySuggestionTemplate(\n      helpDataAuditStep1,\n      \"helpDataAuditStep1\",\n      [\n        () =>\n          createHelpLink(\n            \"#settingsButton\",\n            resolveLocaleString(\"settingsButton\") || \"Settings\",\n            {\n              target: \"#settingsButton\",\n            },\n          ),\n        () =>\n          createHelpLink(\n            \"#dataHeading\",\n            resolveLocaleString(\"dataHeading\") || \"Data & Storage\",\n            {\n              target: \"#dataHeading\",\n              highlight: \"#settingsDialog\",\n            },\n          ),\n        () =>\n          createHelpLink(\n            \"#storageBackupNow\",\n            resolveLocaleString(\"storageBackupNow\") || \"Download full backup\",\n            {\n              target: \"#storageBackupNow\",\n              highlight: \"#storageActions\",\n            },\n          ),\n        () =>\n          createHelpLink(\n            \"#storageActionsHeading\",\n            resolveLocaleString(\"storageActionsHeading\") || \"Quick safeguards\",\n            {\n              target: \"#storageActionsHeading\",\n              highlight: \"#storageActions\",\n              isButton: false,\n            },\n          ),\n      ],\n    );\n    applySuggestionTemplate(\n      helpDataAuditStep2,\n      \"helpDataAuditStep2\",\n      [\n        () =>\n          createHelpLink(\n            \"#shareSetupBtn\",\n            resolveLocaleString(\"shareSetupBtn\") || \"Export Project\",\n            {\n              target: \"#shareSetupBtn\",\n              highlight: \"#setup-manager\",\n            },\n          ),\n      ],\n    );\n    applySuggestionTemplate(\n      helpDataAuditStep3,\n      \"helpDataAuditStep3\",\n      [\n        () =>\n          createHelpLink(\n            \"#reloadButton\",\n            resolveLocaleString(\"reloadAppLabel\") || \"Force reload\",\n            {\n              target: \"#reloadButton\",\n            },\n          ),\n        () =>\n          createHelpLink(\n            \"#offlineIndicator\",\n            resolveLocaleString(\"offlineIndicator\") || \"Offline\",\n            {\n              target: \"#offlineIndicator\",\n            },\n          ),\n        () =>\n          createHelpLink(\n            \"#applySharedLinkBtn\",\n            resolveLocaleString(\"loadSharedLinkBtn\") || \"Import Project\",\n            {\n              target: \"#applySharedLinkBtn\",\n              highlight: \"#setup-manager\",\n            },\n          ),\n      ],\n    );\n    applySuggestionTemplate(\n      helpDataAuditStep4,\n      \"helpDataAuditStep4\",\n      [\n        () =>\n          createHelpLink(\n            \"#restoreRehearsalButton\",\n            resolveLocaleString(\"restoreRehearsalButton\") || \"Restore rehearsal\",\n            {\n              target: \"#restoreRehearsalButton\",\n              highlight: \"#restoreRehearsalSection\",\n            },\n          ),\n        () => {\n          const code = doc.createElement(\"code\");\n          code.textContent = \"window.cineRuntime.verifyCriticalFlows({ warnOnFailure: true })\";\n          return code;\n        },\n      ],\n    );\n    if (helpDataAuditNote) {\n      const fallback =\n        helpDataAuditNote.textContent\n        || \"Log the results in your backup rotation checklist so you always know which copies were verified offline.\";\n      applyTextContent(helpDataAuditNote, \"helpDataAuditNote\", fallback);\n    }\n    applySuggestionTemplate(\n      helpNoResultsSuggestionClear,\n      \"helpNoResultsSuggestionClear\",\n      [\n        () =>\n          createHelpLink(\n            \"#helpSearchClear\",\n            resolveLocaleString(\"helpSearchClear\") || \"Clear search\",\n            {\n              target: \"#helpSearchClear\",\n              highlight: \"#helpSearchContainer\",\n            }\n          ),\n      ]\n    );\n    applySuggestionText(helpNoResultsSuggestionSynonyms, \"helpNoResultsSuggestionSynonyms\");\n    applySuggestionTemplate(\n      helpNoResultsSuggestionQuickStart,\n      \"helpNoResultsSuggestionQuickStart\",\n      [\n        () =>\n          createHelpLink(\n            \"#helpQuickStartGuide\",\n            resolveLocaleString(\"helpQuickStartChecklistTitle\")\n            || \"Quick start checklist\",\n            {\n              target: \"#helpQuickStartGuide\",\n              highlight: \"#helpQuickStartGuide\",\n            }\n          ),\n      ]\n    );\n    applySuggestionTemplate(\n      helpNoResultsSuggestionBackup,\n      \"helpNoResultsSuggestionBackup\",\n      [\n        () =>\n          createHelpLink(\n            \"#helpDataSafety\",\n            resolveLocaleString(\"helpDataSafetyTitle\") || \"Protect your work\",\n            {\n              target: \"#helpDataSafety\",\n              highlight: \"#helpDataSafety\",\n            }\n          ),\n        () =>\n          createHelpLink(\n            \"#helpRestoreDrillHeading\",\n            resolveLocaleString(\"helpRestoreDrillTitle\") || \"Restore rehearsal drill\",\n            {\n              target: \"#helpRestoreDrillHeading\",\n              highlight: \"#helpDataSafety\",\n              isButton: false,\n            }\n          ),\n      ]\n    );\n    if (typeof updateHelpResultsSummaryText === 'function') {\n      updateHelpResultsSummaryText();\n    }\n    if (typeof updateHelpQuickLinksForLanguage === 'function') {\n      updateHelpQuickLinksForLanguage(lang);\n    }\n  }\n\n  // NEW SETUP MANAGEMENT BUTTONS TEXTS\n  setButtonLabelWithIconBinding(\n    document.getElementById(\"generateOverviewBtn\"),\n    texts[lang].generateOverviewBtn,\n    ICON_GLYPHS.overview\n  );\n  setButtonLabelWithIconBinding(\n    document.getElementById(\"generateGearListBtn\"),\n    texts[lang].generateGearListBtn,\n    ICON_GLYPHS.gearList\n  );\n  setButtonLabelWithIconBinding(\n    document.getElementById(\"shareSetupBtn\"),\n    texts[lang].shareSetupBtn,\n    ICON_GLYPHS.fileExport\n  );\n  const exportRevert = document.getElementById(\"exportAndRevertBtn\");\n  if (exportRevert) {\n    setButtonLabelWithIconBinding(exportRevert, texts[lang].exportAndRevertBtn, ICON_GLYPHS.reload);\n    exportRevert.setAttribute('data-help', texts[lang].exportAndRevertBtnHelp);\n  }\n\n  const downloadDiagramButton =\n    (typeof downloadDiagramBtn !== 'undefined' && downloadDiagramBtn)\n    || (\n      typeof document !== 'undefined'\n        && document\n        && typeof document.getElementById === 'function'\n        ? document.getElementById('downloadDiagram')\n        : null\n    );\n\n  if (downloadDiagramButton) {\n    downloadDiagramButton.textContent = texts[lang].downloadDiagramBtn;\n    downloadDiagramButton.setAttribute(\"title\", texts[lang].downloadDiagramBtn);\n    downloadDiagramButton.setAttribute(\"aria-label\", texts[lang].downloadDiagramBtn);\n    downloadDiagramButton.setAttribute(\"data-help\", texts[lang].downloadDiagramHelp);\n  }\n  if (gridSnapToggleBtn) {\n    setButtonLabelWithIconBinding(gridSnapToggleBtn, texts[lang].gridSnapToggle, ICON_GLYPHS.magnet);\n    gridSnapToggleBtn.setAttribute(\"title\", texts[lang].gridSnapToggle);\n    gridSnapToggleBtn.setAttribute(\"aria-label\", texts[lang].gridSnapToggle);\n    gridSnapToggleBtn.setAttribute(\"data-help\", texts[lang].gridSnapToggleHelp);\n    let snapActive = false;\n    try {\n      snapActive = Boolean(getGridSnapState());\n    } catch (gridSnapReadError) {\n      void gridSnapReadError;\n      try {\n        snapActive = Boolean(gridSnap);\n      } catch (legacyGridSnapError) {\n        void legacyGridSnapError;\n      }\n    }\n    gridSnapToggleBtn.setAttribute('aria-pressed', snapActive ? 'true' : 'false');\n  }\n  const resetViewBtn =\n    typeof document !== 'undefined' ? document.getElementById('resetView') : null;\n  if (resetViewBtn) {\n    setButtonLabelWithIconBinding(resetViewBtn, texts[lang].resetViewBtn, ICON_GLYPHS.resetView);\n    resetViewBtn.setAttribute(\"title\", texts[lang].resetViewBtn);\n    resetViewBtn.setAttribute(\"aria-label\", texts[lang].resetViewBtn);\n    resetViewBtn.setAttribute(\"data-help\", texts[lang].resetViewHelp);\n  }\n  const zoomInBtn =\n    typeof document !== 'undefined' ? document.getElementById('zoomIn') : null;\n  if (zoomInBtn) {\n    setButtonLabelWithIconBinding(zoomInBtn, '', ICON_GLYPHS.add);\n    zoomInBtn.setAttribute(\"title\", texts[lang].zoomInLabel);\n    zoomInBtn.setAttribute(\"aria-label\", texts[lang].zoomInLabel);\n    zoomInBtn.setAttribute(\"data-help\", texts[lang].zoomInHelp);\n  }\n  const zoomOutBtn =\n    typeof document !== 'undefined' ? document.getElementById('zoomOut') : null;\n  if (zoomOutBtn) {\n    setButtonLabelWithIconBinding(zoomOutBtn, '', ICON_GLYPHS.minus);\n    zoomOutBtn.setAttribute(\"title\", texts[lang].zoomOutLabel);\n    zoomOutBtn.setAttribute(\"aria-label\", texts[lang].zoomOutLabel);\n    zoomOutBtn.setAttribute(\"data-help\", texts[lang].zoomOutHelp);\n  }\n  const diagramHint =\n    typeof document !== 'undefined' ? document.getElementById('diagramHint') : null;\n  if (diagramHint) {\n    diagramHint.textContent = texts[lang].diagramMoveHint;\n  }\n  const fallbackProjectForm = texts.en && texts.en.projectForm ? texts.en.projectForm : {};\n  const projectFormTexts = texts[lang].projectForm || fallbackProjectForm;\n  if (projectFormTexts) {\n    resolveContactsDomRefs();\n    const setLabelText = (element, key) => {\n      if (!element) return;\n      const value = projectFormTexts[key] || fallbackProjectForm[key];\n      if (value) element.textContent = value;\n    };\n    const setPlaceholder = (element, key) => {\n      if (!element) return;\n      const value = projectFormTexts[key] || fallbackProjectForm[key];\n      if (value) element.setAttribute('placeholder', value);\n    };\n    const setOptionText = (element, key) => {\n      if (!element) return;\n      const value = projectFormTexts[key] || fallbackProjectForm[key];\n      if (value) element.textContent = value;\n    };\n    setLabelText(projectDialogHeading, 'heading');\n    setLabelText(projectNameLabel, 'projectName');\n    setLabelText(productionCompanyLabel, 'productionCompany');\n    setLabelText(productionCompanyAddressLabel, 'productionCompanyAddress');\n    setLabelText(productionCompanyStreetLabel, 'productionCompanyStreet');\n    setLabelText(productionCompanyStreet2Label, 'productionCompanyStreet2');\n    setLabelText(productionCompanyCityLabel, 'productionCompanyCity');\n    setLabelText(productionCompanyRegionLabel, 'productionCompanyRegion');\n    setLabelText(productionCompanyPostalCodeLabel, 'productionCompanyPostalCode');\n    setLabelText(productionCompanyCountryLabel, 'productionCompanyCountry');\n    setPlaceholder(productionCompanyStreetInput, 'productionCompanyStreetPlaceholder');\n    setPlaceholder(productionCompanyStreet2Input, 'productionCompanyStreet2Placeholder');\n    setPlaceholder(productionCompanyCityInput, 'productionCompanyCityPlaceholder');\n    setPlaceholder(productionCompanyRegionInput, 'productionCompanyRegionPlaceholder');\n    setPlaceholder(productionCompanyPostalCodeInput, 'productionCompanyPostalCodePlaceholder');\n    setPlaceholder(productionCompanyCountryInput, 'productionCompanyCountryPlaceholder');\n    setLabelText(rentalHouseLabel, 'rentalHouse');\n    setLabelText(crewHeadingElem, 'crewHeading');\n    if (crewLabelElem) {\n      const crewLabelText = projectFormTexts.crewHeading || fallbackProjectForm.crewHeading;\n      if (crewLabelText) {\n        crewLabelElem.textContent = `${crewLabelText}: `;\n      }\n    }\n    setLabelText(prepLabelElem, 'prepLabel');\n    setLabelText(shootLabelElem, 'shootLabel');\n    setLabelText(returnLabelElem, 'returnLabel');\n    setLabelText(deliveryResolutionLabel, 'deliveryResolution');\n    setLabelText(recordingResolutionLabel, 'recordingResolution');\n    setLabelText(sensorModeLabel, 'sensorMode');\n    setLabelText(aspectRatioLabel, 'aspectRatio');\n    setLabelText(codecLabel, 'codec');\n    setLabelText(baseFrameRateLabel, 'baseFrameRate');\n    setLabelText(recordingFrameRateLabel, 'recordingFrameRate');\n    if (recordingFrameRateHintElem) {\n      const rangeTemplate =\n        projectFormTexts.recordingFrameRateRangeHint ||\n        fallbackProjectForm.recordingFrameRateRangeHint ||\n        '';\n      const defaultHint =\n        projectFormTexts.recordingFrameRateDefaultHint ||\n        fallbackProjectForm.recordingFrameRateDefaultHint ||\n        '';\n      if (rangeTemplate) {\n        recordingFrameRateHintElem.setAttribute('data-range-template', rangeTemplate);\n      } else {\n        recordingFrameRateHintElem.removeAttribute('data-range-template');\n      }\n      if (defaultHint) {\n        recordingFrameRateHintElem.setAttribute('data-default-message', defaultHint);\n        recordingFrameRateHintElem.textContent = defaultHint;\n        recordingFrameRateHintElem.hidden = false;\n      } else {\n        recordingFrameRateHintElem.removeAttribute('data-default-message');\n        recordingFrameRateHintElem.textContent = '';\n        recordingFrameRateHintElem.hidden = true;\n      }\n    }\n    if (slowMotionLegendElem) {\n      const legendText = projectFormTexts.slowMotionHeading || fallbackProjectForm.slowMotionHeading;\n      if (legendText) slowMotionLegendElem.textContent = legendText;\n    }\n    setLabelText(slowMotionRecordingResolutionLabel, 'slowMotionRecordingResolution');\n    setLabelText(slowMotionSensorModeLabel, 'slowMotionSensorMode');\n    setLabelText(slowMotionAspectRatioLabel, 'slowMotionAspectRatio');\n    setLabelText(slowMotionBaseFrameRateLabel, 'slowMotionBaseFrameRate');\n    setLabelText(slowMotionRecordingFrameRateLabel, 'slowMotionRecordingFrameRate');\n    if (slowMotionRecordingFrameRateHintElem) {\n      const slowRangeTemplate =\n        projectFormTexts.slowMotionRecordingFrameRateRangeHint ||\n        fallbackProjectForm.slowMotionRecordingFrameRateRangeHint ||\n        '';\n      const slowDefaultHint =\n        projectFormTexts.slowMotionRecordingFrameRateDefaultHint ||\n        fallbackProjectForm.slowMotionRecordingFrameRateDefaultHint ||\n        '';\n      if (slowRangeTemplate) {\n        slowMotionRecordingFrameRateHintElem.setAttribute('data-range-template', slowRangeTemplate);\n      } else {\n        slowMotionRecordingFrameRateHintElem.removeAttribute('data-range-template');\n      }\n      if (slowDefaultHint) {\n        slowMotionRecordingFrameRateHintElem.setAttribute('data-default-message', slowDefaultHint);\n        slowMotionRecordingFrameRateHintElem.textContent = slowDefaultHint;\n        slowMotionRecordingFrameRateHintElem.hidden = false;\n      } else {\n        slowMotionRecordingFrameRateHintElem.removeAttribute('data-default-message');\n        slowMotionRecordingFrameRateHintElem.textContent = '';\n        slowMotionRecordingFrameRateHintElem.hidden = true;\n      }\n    }\n    setLabelText(lensesHeadingElem, 'lensesHeading');\n    setLabelText(lensManufacturerLabel, 'lensManufacturerStep');\n    setLabelText(lensSeriesLabel, 'lensSeriesStep');\n    setLabelText(lensesLabelElem, 'lensesLabel');\n    setLabelText(lensSelectionsHeadingElem, 'lensSelectionsLabel');\n    setLabelText(lensSelectionsHintElem, 'lensSelectionsHint');\n    setOptionText(lensManufacturerPlaceholderOption, 'lensManufacturerPlaceholder');\n    setOptionText(lensSeriesPlaceholderOption, 'lensSeriesPlaceholder');\n    if (lensSeriesEmptyElem) {\n      const seriesEmptyText = projectFormTexts.lensSeriesEmpty || fallbackProjectForm.lensSeriesEmpty;\n      if (seriesEmptyText) lensSeriesEmptyElem.textContent = seriesEmptyText;\n    }\n    if (lensOptionsEmptyElem) {\n      const optionsEmptyText = projectFormTexts.lensOptionsEmpty || fallbackProjectForm.lensOptionsEmpty;\n      if (optionsEmptyText) lensOptionsEmptyElem.textContent = optionsEmptyText;\n    }\n    if (lensSelectionChipsElem) {\n      const removeTemplate = projectFormTexts.lensRemoveLabel || fallbackProjectForm.lensRemoveLabel;\n      const mountLabelText = projectFormTexts.lensMountLabel || fallbackProjectForm.lensMountLabel;\n      if (removeTemplate) lensSelectionChipsElem.setAttribute('data-remove-template', removeTemplate);\n      if (mountLabelText) lensSelectionChipsElem.setAttribute('data-mount-label', mountLabelText);\n    }\n    if (lensSelectionManager && typeof lensSelectionManager.refreshCatalog === 'function') {\n      try {\n        lensSelectionManager.refreshCatalog({ preserveSelections: true, skipEvent: true, skipDirty: true });\n      } catch (catalogRefreshError) {\n        void catalogRefreshError;\n      }\n    }\n    setLabelText(riggingHeadingElem, 'riggingHeading');\n    setLabelText(requiredScenariosLabel, 'requiredScenarios');\n    updateRequiredScenariosTranslations(lang);\n    setLabelText(cameraHandleLabel, 'cameraHandle');\n    setLabelText(viewfinderExtensionLabel, 'viewfinderExtension');\n    setLabelText(matteboxFilterHeadingElem, 'matteboxFilterHeading');\n    setLabelText(matteboxLabel, 'mattebox');\n    setLabelText(filterLabel, 'filter');\n    setLabelText(storageHeading, 'storageHeading');\n    setLabelText(storageNeedsLabel, 'storageNeedsLabel');\n    updateStorageRequirementTranslations(projectFormTexts, fallbackProjectForm);\n    updateStorageRequirementTypeOptions();\n    setLabelText(monitoringHeadingElem, 'monitoringHeading');\n    setLabelText(monitoringConfigurationLabel, 'monitoringConfiguration');\n    setLabelText(viewfinderSettingsLabel, 'viewfinderSettings');\n    setLabelText(frameGuidesLabel, 'frameGuides');\n    setLabelText(aspectMaskOpacityLabel, 'aspectMaskOpacity');\n    setLabelText(videoDistributionLabel, 'videoDistribution');\n    setLabelText(monitorUserButtonsLabel, 'monitorUserButtons');\n    setLabelText(cameraUserButtonsLabel, 'cameraUserButtons');\n    setLabelText(viewfinderUserButtonsLabel, 'viewfinderUserButtons');\n    setLabelText(tripodPreferencesHeading, 'tripodPreferencesHeading');\n    setLabelText(tripodHeadBrandLabel, 'tripodHeadBrand');\n    setLabelText(tripodBowlLabel, 'tripodBowl');\n    setLabelText(tripodTypesLabel, 'tripodTypes');\n    setLabelText(tripodSpreaderLabel, 'tripodSpreader');\n    if (viewfinderExtensionSelect && viewfinderExtensionSelect.options.length >= 2) {\n      const noneLabel = projectFormTexts.viewfinderExtensionNone || fallbackProjectForm.viewfinderExtensionNone;\n      const yesLabel = projectFormTexts.viewfinderExtensionYes || fallbackProjectForm.viewfinderExtensionYes;\n      if (noneLabel) viewfinderExtensionSelect.options[0].textContent = noneLabel;\n      if (yesLabel) viewfinderExtensionSelect.options[1].textContent = yesLabel;\n    }\n    const projectCancelButton =\n      typeof document !== 'undefined'\n        ? document.getElementById('projectCancel')\n        : null;\n    const cancelText =\n      projectFormTexts.cancel ||\n      fallbackProjectForm.cancel ||\n      (projectCancelButton\n        ? projectCancelButton.textContent\n        : projectDialogCloseBtn?.getAttribute('aria-label')) ||\n      'Cancel';\n    if (projectCancelButton) {\n      setButtonLabelWithIconBinding(projectCancelButton, cancelText, ICON_GLYPHS.circleX);\n    }\n    if (projectDialogCloseBtn) {\n      projectDialogCloseBtn.innerHTML = iconMarkup(ICON_GLYPHS.circleX, 'btn-icon');\n      projectDialogCloseBtn.setAttribute('aria-label', cancelText);\n      projectDialogCloseBtn.setAttribute('title', cancelText);\n      projectDialogCloseBtn.setAttribute('data-help', cancelText);\n    }\n    if (projectSubmitBtn) {\n      const submitText = projectFormTexts.submit || fallbackProjectForm.submit;\n      if (submitText) {\n        setButtonLabelWithIconBinding(projectSubmitBtn, submitText, ICON_GLYPHS.check);\n        projectSubmitBtn.setAttribute('aria-label', submitText);\n      }\n    }\n    const crewPlaceholders = {\n      name: projectFormTexts.crewNamePlaceholder || fallbackProjectForm.crewNamePlaceholder,\n      phone: projectFormTexts.crewPhonePlaceholder || fallbackProjectForm.crewPhonePlaceholder,\n      email: projectFormTexts.crewEmailPlaceholder || fallbackProjectForm.crewEmailPlaceholder,\n      website: projectFormTexts.crewWebsitePlaceholder || fallbackProjectForm.crewWebsitePlaceholder\n    };\n    const crewRoleLabels = texts[lang].crewRoles || (texts.en && texts.en.crewRoles) || {};\n    const fallbackContacts = texts.en?.contacts || {};\n    const contactsTexts = texts[lang]?.contacts || fallbackContacts;\n    if (contactsDialogHeading && contactsTexts.heading) {\n      contactsDialogHeading.textContent = contactsTexts.heading;\n    }\n    if (contactsDialogDescription && contactsTexts.description) {\n      contactsDialogDescription.textContent = contactsTexts.description;\n    }\n    if (contactsAddButtonLabel && contactsTexts.addContactButton) {\n      contactsAddButtonLabel.textContent = contactsTexts.addContactButton;\n    }\n    if (contactsAddButton && contactsTexts.addContactButton) {\n      contactsAddButton.setAttribute('aria-label', contactsTexts.addContactButton);\n      contactsAddButton.setAttribute('data-help', contactsTexts.addContactButton);\n    }\n    if (contactsImportButtonLabel && contactsTexts.importButton) {\n      contactsImportButtonLabel.textContent = contactsTexts.importButton;\n    }\n    if (contactsImportButton && contactsTexts.importButton) {\n      contactsImportButton.setAttribute('aria-label', contactsTexts.importButton);\n      contactsImportButton.setAttribute('data-help', contactsTexts.importButton);\n    }\n    if (contactsImportHint && contactsTexts.importHint) {\n      contactsImportHint.textContent = contactsTexts.importHint;\n    }\n    if (contactsEmptyState && contactsTexts.emptyState) {\n      contactsEmptyState.textContent = contactsTexts.emptyState;\n    }\n    if (userProfileHeading && contactsTexts.userProfileHeading) {\n      userProfileHeading.textContent = contactsTexts.userProfileHeading;\n    }\n    if (userProfileDescription && contactsTexts.userProfileDescription) {\n      userProfileDescription.textContent = contactsTexts.userProfileDescription;\n    }\n    if (userProfileNameLabel && contactsTexts.userProfileNameLabel) {\n      userProfileNameLabel.textContent = contactsTexts.userProfileNameLabel;\n    }\n    if (userProfileNameInput && contactsTexts.userProfileNamePlaceholder) {\n      userProfileNameInput.setAttribute('placeholder', contactsTexts.userProfileNamePlaceholder);\n    }\n    if (userProfileRoleLabel && contactsTexts.userProfileRoleLabel) {\n      userProfileRoleLabel.textContent = contactsTexts.userProfileRoleLabel;\n    }\n    if (userProfileRoleInput) {\n      const profileSnapshot = profileController?.getUserProfileSnapshot\n        ? profileController.getUserProfileSnapshot()\n        : { role: '' };\n      populateUserProfileRoleSelect({\n        selected: profileSnapshot.role || ''\n      });\n    }\n    if (userProfilePhoneLabel && contactsTexts.userProfilePhoneLabel) {\n      userProfilePhoneLabel.textContent = contactsTexts.userProfilePhoneLabel;\n    }\n    if (userProfilePhoneInput && contactsTexts.userProfilePhonePlaceholder) {\n      userProfilePhoneInput.setAttribute('placeholder', contactsTexts.userProfilePhonePlaceholder);\n    }\n    if (userProfileEmailLabel && contactsTexts.userProfileEmailLabel) {\n      userProfileEmailLabel.textContent = contactsTexts.userProfileEmailLabel;\n    }\n    if (userProfileEmailInput && contactsTexts.userProfileEmailPlaceholder) {\n      userProfileEmailInput.setAttribute('placeholder', contactsTexts.userProfileEmailPlaceholder);\n    }\n    if (userProfileHint && contactsTexts.userProfileHint) {\n      userProfileHint.textContent = contactsTexts.userProfileHint;\n    }\n    if (userProfileAvatarButtonLabel && contactsTexts.userProfileAvatarButton) {\n      userProfileAvatarButtonLabel.textContent = contactsTexts.userProfileAvatarButton;\n    }\n    if (userProfileAvatarButton && contactsTexts.userProfileAvatarButton) {\n      userProfileAvatarButton.setAttribute('aria-label', contactsTexts.userProfileAvatarButton);\n      userProfileAvatarButton.removeAttribute('data-help');\n      userProfileAvatarButton.removeAttribute('title');\n    }\n    if (userProfileAvatarClearButton && contactsTexts.userProfileAvatarRemove) {\n      userProfileAvatarClearButton.textContent = contactsTexts.userProfileAvatarRemove;\n      userProfileAvatarClearButton.setAttribute('aria-label', contactsTexts.userProfileAvatarRemove);\n    }\n    if (avatarOptionsTitleElem && contactsTexts.avatarOptionsTitle) {\n      avatarOptionsTitleElem.textContent = contactsTexts.avatarOptionsTitle;\n    }\n    if (avatarOptionsDescriptionElem && contactsTexts.avatarOptionsDescription) {\n      avatarOptionsDescriptionElem.textContent = contactsTexts.avatarOptionsDescription;\n    }\n    if (avatarOptionsCloseLabel && contactsTexts.avatarOptionsClose) {\n      avatarOptionsCloseLabel.textContent = contactsTexts.avatarOptionsClose;\n    }\n    if (avatarOptionsCloseButton && contactsTexts.avatarOptionsClose) {\n      avatarOptionsCloseButton.setAttribute('aria-label', contactsTexts.avatarOptionsClose);\n      avatarOptionsCloseButton.setAttribute('title', contactsTexts.avatarOptionsClose);\n      avatarOptionsCloseButton.setAttribute('data-help', contactsTexts.avatarOptionsClose);\n    }\n    if (avatarOptionsDeleteButton && contactsTexts.avatarDelete) {\n      setButtonLabelWithIconBinding(avatarOptionsDeleteButton, contactsTexts.avatarDelete, ICON_GLYPHS.trash);\n      avatarOptionsDeleteButton.setAttribute('aria-label', contactsTexts.avatarDelete);\n      avatarOptionsDeleteButton.setAttribute('title', contactsTexts.avatarDelete);\n      avatarOptionsDeleteButton.setAttribute('data-help', contactsTexts.avatarDelete);\n    }\n    if (avatarOptionsEditButton && contactsTexts.avatarEditAction) {\n      setButtonLabelWithIconBinding(avatarOptionsEditButton, contactsTexts.avatarEditAction, ICON_GLYPHS.sliders);\n      avatarOptionsEditButton.setAttribute('aria-label', contactsTexts.avatarEditAction);\n      avatarOptionsEditButton.setAttribute('title', contactsTexts.avatarEditAction);\n      avatarOptionsEditButton.setAttribute('data-help', contactsTexts.avatarEditAction);\n    }\n    if (avatarOptionsChangeButton && contactsTexts.avatarChange) {\n      setButtonLabelWithIconBinding(avatarOptionsChangeButton, contactsTexts.avatarChange, ICON_GLYPHS.camera);\n      avatarOptionsChangeButton.setAttribute('aria-label', contactsTexts.avatarChange);\n      avatarOptionsChangeButton.setAttribute('title', contactsTexts.avatarChange);\n      avatarOptionsChangeButton.setAttribute('data-help', contactsTexts.avatarChange);\n    }\n    if (avatarEditZoomLabelElem && contactsTexts.avatarEditZoomLabel) {\n      avatarEditZoomLabelElem.textContent = contactsTexts.avatarEditZoomLabel;\n    }\n    if (contactsCloseButton && contactsTexts.close) {\n      contactsCloseButton.textContent = contactsTexts.close;\n    }\n    renderContactsList();\n    document.querySelectorAll('#crewContainer .person-row').forEach(row => {\n      const roleSelect = row.querySelector('select');\n      if (roleSelect) {\n        const currentValue = roleSelect.value;\n        Array.from(roleSelect.options).forEach(opt => {\n          const roleKey = opt.value;\n          opt.textContent = crewRoleLabels[roleKey] || roleKey;\n        });\n        roleSelect.value = currentValue;\n      }\n      const nameInput = row.querySelector('.person-name');\n      if (nameInput && crewPlaceholders.name) nameInput.placeholder = crewPlaceholders.name;\n      const phoneInput = row.querySelector('.person-phone');\n      if (phoneInput && crewPlaceholders.phone) phoneInput.placeholder = crewPlaceholders.phone;\n      const emailInput = row.querySelector('.person-email');\n      if (emailInput && crewPlaceholders.email) emailInput.placeholder = crewPlaceholders.email;\n      const websiteInput = row.querySelector('.person-website');\n      if (websiteInput && crewPlaceholders.website) websiteInput.placeholder = crewPlaceholders.website;\n      const contactSelect = row.querySelector('.person-contact-select');\n      if (contactSelect) {\n        setContactSelectOptions(contactSelect, contactSelect.value);\n      }\n      const saveButton = row.querySelector('.person-save-contact');\n      if (saveButton) {\n        setButtonLabelWithIconBinding(saveButton, getContactsText('saveContact', 'Save to contacts'), ICON_GLYPHS.save);\n      }\n      const manageButton = row.querySelector('.person-manage-contacts');\n      if (manageButton) {\n        setButtonLabelWithIconBinding(manageButton, getContactsText('openManager', 'Open contacts'), ICON_GLYPHS.gears);\n      }\n      updateRowLinkedBadge(row);\n    });\n    const stripTrailingPunctuation = value => (typeof value === 'string' ? value.replace(/[\\s\\u00a0]*[:]\\s*$/, '') : value);\n    const addEntryLabel = projectFormTexts.addEntry || fallbackProjectForm.addEntry || 'Add';\n    if (addPersonBtn) {\n      const crewLabel = stripTrailingPunctuation(projectFormTexts.crewHeading || fallbackProjectForm.crewHeading || 'Crew');\n      const label = `${addEntryLabel} ${crewLabel} `.trim();\n      setButtonLabelWithIconBinding(addPersonBtn, label, ICON_GLYPHS.add);\n      addPersonBtn.setAttribute('aria-label', label);\n      addPersonBtn.setAttribute('data-help', label);\n    }\n    if (addPrepBtn) {\n      const prepLabel = stripTrailingPunctuation(projectFormTexts.prepLabel || fallbackProjectForm.prepLabel || 'Prep');\n      const label = `${addEntryLabel} ${prepLabel} `.trim();\n      setButtonLabelWithIconBinding(addPrepBtn, label, ICON_GLYPHS.add);\n      addPrepBtn.setAttribute('aria-label', label);\n      addPrepBtn.setAttribute('data-help', label);\n    }\n    if (addShootBtn) {\n      const shootLabel = stripTrailingPunctuation(projectFormTexts.shootLabel || fallbackProjectForm.shootLabel || 'Shoot');\n      const label = `${addEntryLabel} ${shootLabel} `.trim();\n      setButtonLabelWithIconBinding(addShootBtn, label, ICON_GLYPHS.add);\n      addShootBtn.setAttribute('aria-label', label);\n      addShootBtn.setAttribute('data-help', label);\n    }\n    if (addReturnBtn) {\n      const returnLabel = stripTrailingPunctuation(projectFormTexts.returnLabel || fallbackProjectForm.returnLabel || 'Return Day');\n      const label = `${addEntryLabel} ${returnLabel} `.trim();\n      setButtonLabelWithIconBinding(addReturnBtn, label, ICON_GLYPHS.add);\n      addReturnBtn.setAttribute('aria-label', label);\n      addReturnBtn.setAttribute('data-help', label);\n    }\n  }\n  if (iosPwaHelpTitle) iosPwaHelpTitle.textContent = texts[lang].iosPwaHelpTitle;\n  if (iosPwaHelpIntro) iosPwaHelpIntro.textContent = texts[lang].iosPwaHelpIntro;\n  if (iosPwaHelpStep1) iosPwaHelpStep1.textContent = texts[lang].iosPwaHelpStep1;\n  if (iosPwaHelpStep2) iosPwaHelpStep2.textContent = texts[lang].iosPwaHelpStep2;\n  if (iosPwaHelpStep3) iosPwaHelpStep3.textContent = texts[lang].iosPwaHelpStep3;\n  if (iosPwaHelpStep4) iosPwaHelpStep4.textContent = texts[lang].iosPwaHelpStep4;\n  if (iosPwaHelpNote) iosPwaHelpNote.textContent = texts[lang].iosPwaHelpNote;\n  if (iosPwaHelpClose) {\n    const closeText = texts[lang].iosPwaHelpClose;\n    setButtonLabelWithIconBinding(iosPwaHelpClose, closeText, ICON_GLYPHS.check);\n    iosPwaHelpClose.setAttribute('aria-label', closeText);\n  }\n\n  document.querySelectorAll('.favorite-toggle').forEach(btn => {\n    btn.setAttribute('aria-label', texts[lang].favoriteToggleLabel);\n    btn.setAttribute('title', texts[lang].favoriteToggleLabel);\n    btn.setAttribute(\n      'data-help',\n      texts[lang].favoriteToggleHelp || texts[lang].favoriteToggleLabel\n    );\n  });\n  ensureGearListActions();\n  updateDiagramLegend();\n  updateStorageSummary();\n  callCoreFunctionIfAvailable('populateFeatureSearch', [], { defer: true });\n}\n\n// Reference elements (DOM Elements)\nvar cameraSelect = document.getElementById(\"cameraSelect\");\nif (typeof window !== 'undefined') window.cameraSelect = cameraSelect;\n\nvar monitorSelect = document.getElementById(\"monitorSelect\");\nif (typeof window !== 'undefined') window.monitorSelect = monitorSelect;\n\nvar videoSelect = document.getElementById(\"videoSelect\");\nif (typeof window !== 'undefined') window.videoSelect = videoSelect;\n\nvar videoDistributionSelect = document.getElementById(\"videoDistribution\");\nif (typeof window !== 'undefined') window.videoDistributionSelect = videoDistributionSelect;\n\nvar cageSelect = document.getElementById(\"cageSelect\");\nif (typeof window !== 'undefined') window.cageSelect = cageSelect;\nvar motorSelects = [\n  document.getElementById(\"motor1Select\"),\n  document.getElementById(\"motor2Select\"),\n  document.getElementById(\"motor3Select\"),\n  document.getElementById(\"motor4Select\")\n];\nif (typeof window !== 'undefined') window.motorSelects = motorSelects;\n\nvar controllerSelects = [\n  document.getElementById(\"controller1Select\"),\n  document.getElementById(\"controller2Select\"),\n  document.getElementById(\"controller3Select\"),\n  document.getElementById(\"controller4Select\")\n];\nif (typeof window !== 'undefined') window.controllerSelects = controllerSelects;\n\nvar distanceSelect = document.getElementById(\"distanceSelect\");\nif (typeof window !== 'undefined') window.distanceSelect = distanceSelect;\n\nvar batterySelect = document.getElementById(\"batterySelect\");\nif (typeof window !== 'undefined') window.batterySelect = batterySelect;\n\nvar hotswapSelect = document.getElementById(\"batteryHotswapSelect\");\nif (typeof window !== 'undefined') window.hotswapSelect = hotswapSelect;\n\nvar lensSelect = document.getElementById(\"lenses\");\nif (typeof window !== 'undefined') window.lensSelect = lensSelect;\nvar requiredScenariosSelect = document.getElementById(\"requiredScenarios\");\nvar requiredScenariosSummary = document.getElementById(\"requiredScenariosSummary\");\nvar remoteHeadOption = requiredScenariosSelect ?\n  requiredScenariosSelect.querySelector('option[value=\"Remote Head\"]') : null;\nif (typeof window !== 'undefined') window.remoteHeadOption = remoteHeadOption;\n\nvar tripodPreferencesSection = document.getElementById(\"tripodPreferencesSection\");\nvar tripodPreferencesRow = document.getElementById(\"tripodPreferencesRow\");\nvar tripodPreferencesHeading = document.getElementById(\"tripodPreferencesHeading\");\nvar tripodHeadBrandSelect = document.getElementById(\"tripodHeadBrand\");\nif (typeof window !== 'undefined') window.tripodHeadBrandSelect = tripodHeadBrandSelect;\n\nvar tripodBowlSelect = document.getElementById(\"tripodBowl\");\nif (typeof window !== 'undefined') window.tripodBowlSelect = tripodBowlSelect;\n\nvar tripodTypesSelect = document.getElementById(\"tripodTypes\");\nif (typeof window !== 'undefined') window.tripodTypesSelect = tripodTypesSelect;\n\nvar tripodSpreaderSelect = document.getElementById(\"tripodSpreader\");\nif (typeof window !== 'undefined') window.tripodSpreaderSelect = tripodSpreaderSelect;\n\nvar monitoringConfigurationSelect = document.getElementById(\"monitoringConfiguration\");\nconst viewfinderSettingsRow = document.getElementById(\"viewfinderSettingsRow\");\nconst viewfinderExtensionRow = document.getElementById(\"viewfinderExtensionRow\");\nconst projectDialogHeading = document.getElementById(\"projectDialogHeading\");\nvar projectDialogCloseBtn = document.getElementById(\"projectDialogClose\");\nconst projectNameLabel = document.getElementById(\"projectNameLabel\");\nconst productionCompanyLabel = document.getElementById(\"productionCompanyLabel\");\nconst productionCompanyAddressLabel = document.getElementById(\"productionCompanyAddressLabel\");\nconst productionCompanyStreetLabel = document.getElementById(\"productionCompanyStreetLabel\");\nconst productionCompanyStreet2Label = document.getElementById(\"productionCompanyStreet2Label\");\nconst productionCompanyCityLabel = document.getElementById(\"productionCompanyCityLabel\");\nconst productionCompanyRegionLabel = document.getElementById(\"productionCompanyRegionLabel\");\nconst productionCompanyPostalCodeLabel = document.getElementById(\"productionCompanyPostalCodeLabel\");\nconst productionCompanyCountryLabel = document.getElementById(\"productionCompanyCountryLabel\");\nconst productionCompanyStreetInput = document.getElementById(\"productionCompanyStreet\");\nconst productionCompanyStreet2Input = document.getElementById(\"productionCompanyStreet2\");\nconst productionCompanyCityInput = document.getElementById(\"productionCompanyCity\");\nconst productionCompanyRegionInput = document.getElementById(\"productionCompanyRegion\");\nconst productionCompanyPostalCodeInput = document.getElementById(\"productionCompanyPostalCode\");\nconst productionCompanyCountryInput = document.getElementById(\"productionCompanyCountry\");\nconst rentalHouseLabel = document.getElementById(\"rentalHouseLabel\");\nconst crewHeadingElem = document.getElementById(\"crewHeading\");\nconst crewLabelElem = document.getElementById(\"crewLabel\");\nconst prepLabelElem = document.getElementById(\"prepLabel\");\nconst shootLabelElem = document.getElementById(\"shootLabel\");\nconst returnLabelElem = document.getElementById(\"returnLabel\");\nconst deliveryResolutionLabel = document.getElementById(\"deliveryResolutionLabel\");\nconst deliveryResolutionSelect = document.getElementById(\"deliveryResolution\");\nconst recordingResolutionLabel = document.getElementById(\"recordingResolutionLabel\");\nconst recordingFrameRateLabel = document.getElementById(\"recordingFrameRateLabel\");\nconst recordingFrameRateHintElem = document.getElementById(\"recordingFrameRateHint\");\nconst slowMotionLegendElem = document.getElementById(\"slowMotionFrameRateLegend\");\nconst slowMotionRecordingResolutionLabel = document.getElementById(\"slowMotionRecordingResolutionLabel\");\nconst slowMotionSensorModeLabel = document.getElementById(\"slowMotionSensorModeLabel\");\nconst slowMotionAspectRatioLabel = document.getElementById(\"slowMotionAspectRatioLabel\");\nconst slowMotionBaseFrameRateLabel = document.getElementById(\"slowMotionBaseFrameRateLabel\");\nconst slowMotionRecordingFrameRateLabel = document.getElementById(\"slowMotionRecordingFrameRateLabel\");\nconst slowMotionRecordingFrameRateHintElem = document.getElementById(\"slowMotionRecordingFrameRateHint\");\nconst sensorModeLabel = document.getElementById(\"sensorModeLabel\");\nconst aspectRatioLabel = document.getElementById(\"aspectRatioLabel\");\nconst codecLabel = document.getElementById(\"codecLabel\");\nconst baseFrameRateLabel = document.getElementById(\"baseFrameRateLabel\");\nconst lensManufacturerLabel = document.getElementById(\"lensManufacturerLabel\");\nconst lensManufacturerPlaceholderOption = document.getElementById(\"lensManufacturerPlaceholder\");\nconst lensSeriesLabel = document.getElementById(\"lensSeriesLabel\");\nconst lensSeriesPlaceholderOption = document.getElementById(\"lensSeriesPlaceholder\");\nconst lensSeriesEmptyElem = document.getElementById(\"lensSeriesEmpty\");\nconst lensOptionsEmptyElem = document.getElementById(\"lensOptionsEmpty\");\nconst lensesHeadingElem = document.getElementById(\"lensesHeading\");\nconst lensesLabelElem = document.getElementById(\"lensesLabel\");\nconst lensSelectionsHeadingElem = document.getElementById(\"lensSelectionsLabel\");\nconst lensSelectionsHintElem = document.getElementById(\"lensSelectionsHint\");\nconst lensSelectionChipsElem = document.getElementById(\"lensSelectionChips\");\nconst riggingHeadingElem = document.getElementById(\"riggingHeading\");\nconst requiredScenariosLabel = document.getElementById(\"requiredScenariosLabel\");\nconst cameraHandleLabel = document.getElementById(\"cameraHandleLabel\");\nconst viewfinderExtensionLabel = document.getElementById(\"viewfinderExtensionLabel\");\nconst viewfinderExtensionSelect = document.getElementById(\"viewfinderExtension\");\nconst matteboxFilterHeadingElem = document.getElementById(\"matteboxFilterHeading\");\nconst matteboxLabel = document.getElementById(\"matteboxLabel\");\nconst filterLabel = document.getElementById(\"filterLabel\");\nconst storageHeading = document.getElementById(\"storageHeading\");\nconst storageNeedsLabel = document.getElementById(\"storageNeedsLabel\");\nconst monitoringHeadingElem = document.getElementById(\"monitoringHeading\");\nconst monitoringConfigurationLabel = document.getElementById(\"monitoringConfigurationLabel\");\nconst viewfinderSettingsLabel = document.getElementById(\"viewfinderSettingsLabel\");\nconst frameGuidesLabel = document.getElementById(\"frameGuidesLabel\");\nconst aspectMaskOpacityLabel = document.getElementById(\"aspectMaskOpacityLabel\");\nconst videoDistributionLabel = document.getElementById(\"videoDistributionLabel\");\nconst monitorUserButtonsLabel = document.getElementById(\"monitorUserButtonsLabel\");\nconst cameraUserButtonsLabel = document.getElementById(\"cameraUserButtonsLabel\");\nconst viewfinderUserButtonsLabel = document.getElementById(\"viewfinderUserButtonsLabel\");\nconst tripodHeadBrandLabel = document.getElementById(\"tripodHeadBrandLabel\");\nconst tripodBowlLabel = document.getElementById(\"tripodBowlLabel\");\nconst tripodTypesLabel = document.getElementById(\"tripodTypesLabel\");\nconst tripodSpreaderLabel = document.getElementById(\"tripodSpreaderLabel\");\nconst projectSubmitBtn = document.getElementById(\"projectSubmit\");\nvar crewContainer = document.getElementById(\"crewContainer\");\nconst addPersonBtn = document.getElementById(\"addPersonBtn\");\n\nvar prepContainer = document.getElementById(\"prepContainer\");\nconst addPrepBtn = document.getElementById(\"addPrepBtn\");\nvar shootContainer = document.getElementById(\"shootContainer\");\nconst addShootBtn = document.getElementById(\"addShootBtn\");\nvar returnContainer = document.getElementById(\"returnContainer\");\nconst addReturnBtn = document.getElementById(\"addReturnBtn\");\nvar storageNeedsContainer = document.getElementById(\"storageNeedsContainer\");\nvar contactsDialog = null;\nvar contactsForm = null;\nvar contactsDialogHeading = null;\nvar contactsDialogDescription = null;\nvar contactsAddButton = null;\nvar contactsAddButtonLabel = null;\nvar contactsImportButton = null;\nvar contactsImportButtonLabel = null;\nvar contactsImportInput = null;\nvar contactsImportHint = null;\nvar contactsList = null;\nvar contactsEmptyState = null;\nvar contactsCloseButton = null;\nvar contactsAnnouncement = null;\nvar openContactsBtn = null;\nvar userProfileSection = null;\nvar userProfileHeading = null;\nvar userProfileDescription = null;\nvar userProfileNameInput = null;\nvar userProfileNameLabel = null;\nvar userProfileRoleInput = null;\nvar userProfileRoleLabel = null;\nvar userProfilePhoneInput = null;\nvar userProfilePhoneLabel = null;\nvar userProfileEmailInput = null;\nvar userProfileEmailLabel = null;\nvar userProfileHint = null;\nvar userProfileAvatarContainer = null;\nvar userProfileAvatarButton = null;\nvar userProfileAvatarButtonLabel = null;\nvar userProfileAvatarInput = null;\nvar userProfileAvatarClearButton = null;\nvar avatarOptionsDialog = null;\nvar avatarOptionsForm = null;\nvar avatarOptionsTitleElem = null;\nvar avatarOptionsDescriptionElem = null;\nvar avatarOptionsCloseButton = null;\nvar avatarOptionsCloseLabel = null;\nvar avatarOptionsPreview = null;\nvar avatarOptionsDeleteButton = null;\nvar avatarOptionsEditButton = null;\nvar avatarOptionsChangeButton = null;\nvar avatarEditViewport = null;\nvar avatarEditImage = null;\nvar avatarPlaceholder = null;\nvar avatarControls = null;\nvar avatarEditZoomInput = null;\nvar avatarEditZoomLabelElem = null;\nvar avatarOptionsContext = null;\nvar avatarEditState = null;\nvar avatarEditLastViewportSize = 0;\nvar avatarUploadInput = null;\nvar avatarSaveButton = null;\nvar avatarCancelButton = null;\n\nfunction resolveContactsDomRefs() {\n  if (typeof document === 'undefined') return;\n  contactsDialog = contactsDialog || document.getElementById('contactsDialog');\n  contactsForm = contactsForm || document.getElementById('contactsForm');\n  contactsDialogHeading = contactsDialogHeading || document.getElementById('contactsDialogHeading');\n  contactsDialogDescription =\n    contactsDialogDescription || document.getElementById('contactsDialogDescription');\n  contactsAddButton = contactsAddButton || document.getElementById('contactsAddButton');\n  contactsAddButtonLabel = contactsAddButtonLabel || document.getElementById('contactsAddButtonLabel');\n  contactsImportButton = contactsImportButton || document.getElementById('contactsImportButton');\n  contactsImportButtonLabel =\n    contactsImportButtonLabel || document.getElementById('contactsImportButtonLabel');\n  contactsImportInput = contactsImportInput || document.getElementById('contactsImportInput');\n  contactsImportHint = contactsImportHint || document.getElementById('contactsImportHint');\n  contactsList = contactsList || document.getElementById('contactsList');\n  contactsEmptyState = contactsEmptyState || document.getElementById('contactsEmptyState');\n  contactsCloseButton = contactsCloseButton || document.getElementById('contactsCloseButton');\n  contactsAnnouncement = contactsAnnouncement || document.getElementById('contactsAnnouncement');\n  openContactsBtn = openContactsBtn || document.getElementById('openContactsBtn');\n  userProfileSection = userProfileSection || document.getElementById('contactsUserProfile');\n  userProfileHeading = userProfileHeading || document.getElementById('contactsUserProfileHeading');\n  userProfileDescription = userProfileDescription || document.getElementById('contactsUserProfileDescription');\n  userProfileNameInput = userProfileNameInput || document.getElementById('userProfileName');\n  userProfileNameLabel = userProfileNameLabel || document.getElementById('userProfileNameLabel');\n  userProfileRoleInput = userProfileRoleInput || document.getElementById('userProfileRole');\n  userProfileRoleLabel = userProfileRoleLabel || document.getElementById('userProfileRoleLabel');\n  userProfilePhoneInput = userProfilePhoneInput || document.getElementById('userProfilePhone');\n  userProfilePhoneLabel = userProfilePhoneLabel || document.getElementById('userProfilePhoneLabel');\n  userProfileEmailInput = userProfileEmailInput || document.getElementById('userProfileEmail');\n  userProfileEmailLabel = userProfileEmailLabel || document.getElementById('userProfileEmailLabel');\n  userProfileHint = userProfileHint || document.getElementById('userProfileHint');\n  userProfileAvatarContainer = userProfileAvatarContainer || document.getElementById('userProfileAvatar');\n  userProfileAvatarButton = userProfileAvatarButton || document.getElementById('userProfileAvatarButton');\n  userProfileAvatarButtonLabel = userProfileAvatarButtonLabel || document.getElementById('userProfileAvatarButtonLabel');\n  userProfileAvatarInput = userProfileAvatarInput || document.getElementById('userProfileAvatarInput');\n  userProfileAvatarClearButton = userProfileAvatarClearButton || document.getElementById('userProfileAvatarClear');\n  avatarOptionsDialog = avatarOptionsDialog || document.getElementById('avatarOptionsDialog');\n  avatarOptionsForm = avatarOptionsForm || document.getElementById('avatarOptionsForm');\n  avatarOptionsTitleElem = avatarOptionsTitleElem || document.getElementById('avatarOptionsTitle');\n  avatarOptionsDescriptionElem =\n    avatarOptionsDescriptionElem || document.getElementById('avatarOptionsDescription');\n  avatarOptionsCloseButton = avatarOptionsCloseButton || document.getElementById('avatarOptionsClose');\n  avatarOptionsCloseLabel = avatarOptionsCloseLabel || document.getElementById('avatarOptionsCloseLabel');\n  avatarEditViewport = avatarEditViewport || document.getElementById('avatarEditViewport');\n  avatarEditImage = avatarEditImage || document.getElementById('avatarEditImage');\n  avatarPlaceholder = avatarPlaceholder || document.getElementById('avatarPlaceholder');\n  avatarControls = avatarControls || document.getElementById('avatarControls');\n  avatarEditZoomInput = avatarEditZoomInput || document.getElementById('avatarEditZoom');\n  avatarEditZoomLabelElem = avatarEditZoomLabelElem || document.getElementById('avatarEditZoomLabel');\n  avatarUploadInput = avatarUploadInput || document.getElementById('avatarUploadInput');\n  avatarOptionsDeleteButton = avatarOptionsDeleteButton || document.getElementById('avatarDeleteButton');\n  avatarSaveButton = avatarSaveButton || document.getElementById('avatarSaveButton');\n  avatarCancelButton = avatarCancelButton || document.getElementById('avatarCancelButton');\n}\n\nvar monitoringConfigurationUserChanged = false;\n\nvar crewRoles = [\n  // Camera\n  'DoP',\n  'Steadicam Operator',\n  'Camera Operator',\n  'B-Camera Operator',\n  'Drone Operator',\n  'DIT',\n  '1st AC',\n  '2nd AC',\n  'Video Operator',\n\n  // Grip\n  'Key Grip',\n  'Dolly Grip',\n  'Best Boy Grip',\n  'Rigging Grip',\n  'Grip',\n\n  // Lighting\n  'Key Gaffer',\n  'Gaffer',\n  'Rigging Gaffer',\n  'Best Boy Electric',\n  'Electrician',\n\n  // Director\n  'Director',\n  'Assistant Director',\n\n  // Production\n  'Producer',\n  'Production Manager',\n  'Production Assistant'\n];\n\nfunction getCrewRoleLabels() {\n  const lang = typeof currentLang === 'string' ? currentLang : 'en';\n  return texts?.[lang]?.crewRoles || texts?.en?.crewRoles || {};\n}\n\nfunction populateUserProfileRoleSelect(options = {}) {\n  resolveContactsDomRefs();\n  if (!userProfileRoleInput) return;\n  const doc = userProfileRoleInput.ownerDocument || (typeof document !== 'undefined' ? document : null);\n  if (!doc) return;\n  const roleLabels = getCrewRoleLabels();\n  const placeholderDefault = getContactsText('rolePlaceholder', 'Select role');\n  const placeholderText = getContactsText('userProfileRolePlaceholder', placeholderDefault) || placeholderDefault;\n  const selectedValue =\n    options && typeof options.selected === 'string'\n      ? options.selected\n      : profileController?.getUserProfileSnapshot\n        ? profileController.getUserProfileSnapshot().role\n        : '';\n\n  const previousScrollTop = userProfileRoleInput.scrollTop;\n  userProfileRoleInput.textContent = '';\n\n  const placeholderOption = doc.createElement('option');\n  placeholderOption.value = '';\n  placeholderOption.textContent = placeholderText;\n  userProfileRoleInput.appendChild(placeholderOption);\n\n  crewRoles.forEach(roleKey => {\n    const opt = doc.createElement('option');\n    opt.value = roleKey;\n    opt.textContent = roleLabels[roleKey] || roleKey;\n    userProfileRoleInput.appendChild(opt);\n  });\n\n  const normalizedValue = typeof selectedValue === 'string' ? selectedValue.trim() : '';\n  if (normalizedValue && !crewRoles.includes(normalizedValue)) {\n    const extraOption = doc.createElement('option');\n    extraOption.value = normalizedValue;\n    extraOption.textContent = roleLabels[normalizedValue] || normalizedValue;\n    userProfileRoleInput.appendChild(extraOption);\n  }\n\n  userProfileRoleInput.value = normalizedValue || '';\n  userProfileRoleInput.scrollTop = previousScrollTop;\n}\n\nfunction ensureUserProfileRoleOption(roleValue) {\n  resolveContactsDomRefs();\n  if (!userProfileRoleInput) return;\n  const normalized = typeof roleValue === 'string' ? roleValue.trim() : '';\n  if (!normalized) return;\n  const hasOption = Array.from(userProfileRoleInput.options || []).some(opt => opt.value === normalized);\n  if (hasOption) return;\n  const doc = userProfileRoleInput.ownerDocument || (typeof document !== 'undefined' ? document : null);\n  if (!doc) return;\n  const roleLabels = getCrewRoleLabels();\n  const opt = doc.createElement('option');\n  opt.value = normalized;\n  opt.textContent = roleLabels[normalized] || normalized;\n  userProfileRoleInput.appendChild(opt);\n}\n\n\nvar projectFieldIcons = {\n  productionCompany: PRODUCTION_COMPANY_ICON,\n  productionCompanyAddress: ICON_GLYPHS.pin,\n  rentalHouse: RENTAL_HOUSE_ICON,\n  rentalHouseContact: ICON_GLYPHS.contacts,\n  rentalHouseAddress: ICON_GLYPHS.pin,\n  crew: iconGlyph('\\uF404', ICON_FONT_KEYS.UICONS),\n  prepDays: iconGlyph('\\uE312', ICON_FONT_KEYS.UICONS),\n  returnDays: iconGlyph('\\uE312', ICON_FONT_KEYS.UICONS),\n  shootingDays: iconGlyph('\\uE311', ICON_FONT_KEYS.UICONS),\n  deliveryResolution: iconGlyph('\\uEF69', ICON_FONT_KEYS.UICONS),\n  recordingResolution: ICON_GLYPHS.camera,\n  recordingFrameRate: iconGlyph('\\uE46F', ICON_FONT_KEYS.UICONS),\n  slowMotionRecordingResolution: ICON_GLYPHS.camera,\n  slowMotionRecordingFrameRate: iconGlyph('\\uE46F', ICON_FONT_KEYS.UICONS),\n  aspectRatio: ASPECT_RATIO_ICON,\n  codec: ICON_GLYPHS.codec,\n  baseFrameRate: iconGlyph('\\uE46F', ICON_FONT_KEYS.UICONS),\n  slowMotionBaseFrameRate: iconGlyph('\\uE46F', ICON_FONT_KEYS.UICONS),\n  sensorMode: ICON_GLYPHS.sensor,\n  slowMotionSensorMode: ICON_GLYPHS.sensor,\n  slowMotionAspectRatio: ASPECT_RATIO_ICON,\n  requiredScenarios: REQUIRED_SCENARIOS_ICON,\n  lenses: iconGlyph('\\uE0A3', ICON_FONT_KEYS.UICONS),\n  cameraHandle: iconGlyph('\\uF2DC', ICON_FONT_KEYS.UICONS),\n  viewfinderExtension: iconGlyph('\\uE338', ICON_FONT_KEYS.UICONS),\n  gimbal: iconGlyph('\\uEA9C', ICON_FONT_KEYS.UICONS),\n  monitoringSupport: MONITORING_SUPPORT_ICON,\n  monitoringConfiguration: iconGlyph('\\uF0D0', ICON_FONT_KEYS.UICONS),\n  monitorUserButtons: iconGlyph('\\uF0D1', ICON_FONT_KEYS.UICONS),\n  cameraUserButtons: iconGlyph('\\uF0D1', ICON_FONT_KEYS.UICONS),\n  viewfinderUserButtons: iconGlyph('\\uF0D1', ICON_FONT_KEYS.UICONS),\n  storageRequirements: ICON_GLYPHS.save\n};\n\nfunction updateSelectIconBoxes(sel) {\n  if (!sel) return;\n  const multiSelected = sel.multiple\n    ? Array.from(sel.selectedOptions || [])\n    : [];\n  const hasValue = sel.multiple\n    ? multiSelected.some(opt => typeof opt.value === 'string' ? opt.value.trim() !== '' : !!opt.value)\n    : (typeof sel.value === 'string'\n      ? sel.value.trim() !== ''\n      : (sel.value !== null && sel.value !== undefined && String(sel.value).trim() !== ''));\n  sel.classList.toggle('select-placeholder', !hasValue);\n  if (sel.id === 'requiredScenarios') {\n    return;\n  }\n  const parent = sel.parentNode;\n  if (!parent || typeof parent.querySelector !== 'function') {\n    return;\n  }\n  let container = parent.querySelector('.icon-box-summary');\n  if (!container) {\n    container = document.createElement('div');\n    container.className = 'icon-box-summary';\n    parent.insertBefore(container, sel.nextSibling);\n  }\n  container.innerHTML = '';\n  const opts = sel.multiple\n    ? multiSelected\n    : (hasValue && sel.selectedIndex >= 0 ? [sel.options[sel.selectedIndex]] : []);\n  opts.forEach(opt => {\n    const box = document.createElement('span');\n    box.className = 'icon-box';\n    const iconSpan = document.createElement('span');\n    iconSpan.className = 'icon icon-glyph';\n    let glyph = projectFieldIcons[sel.name] || ICON_GLYPHS.pin;\n    if (opt.dataset.icon) {\n      glyph = iconGlyph(opt.dataset.icon, opt.dataset.iconFont || ICON_FONT_KEYS.UICONS);\n    }\n    applyIconGlyph(iconSpan, glyph);\n    box.appendChild(iconSpan);\n    box.appendChild(document.createTextNode(opt.value));\n    container.appendChild(box);\n  });\n}\n\ntry {\n  if (typeof globalThis !== 'undefined' && typeof globalThis.updateSelectIconBoxes !== 'function') {\n    globalThis.updateSelectIconBoxes = updateSelectIconBoxes;\n  }\n} catch (assignSelectIconError) {\n  console.warn('Failed to expose updateSelectIconBoxes globally', assignSelectIconError);\n}\n\nfunction getLocalizedPathText(path, fallback = '') {\n  if (!path) return fallback;\n  const keys = Array.isArray(path) ? path : typeof path === 'string' ? [path] : [];\n  if (!keys.length) return fallback;\n  const langTexts = (texts && texts[currentLang]) || {};\n  const fallbackTexts = (texts && texts.en) || {};\n  const resolve = (source) => keys.reduce((acc, key) => {\n    if (acc && Object.prototype.hasOwnProperty.call(acc, key)) {\n      return acc[key];\n    }\n    return undefined;\n  }, source);\n  const localized = resolve(langTexts);\n  if (localized !== undefined && localized !== null && localized !== '') {\n    return String(localized);\n  }\n  const fallbackValue = resolve(fallbackTexts);\n  if (fallbackValue !== undefined && fallbackValue !== null && fallbackValue !== '') {\n    return String(fallbackValue);\n  }\n  return fallback;\n}\n\nfunction configureIconOnlyButton(button, glyph, options = {}) {\n  if (!button) return;\n  const {\n    contextPaths = [],\n    fallbackContext = '',\n    actionKey = 'addEntry'\n  } = options || {};\n  setButtonLabelWithIconBinding(button, '', glyph || ICON_GLYPHS.add);\n  const actionLabel = getLocalizedPathText(['projectForm', actionKey], actionKey === 'removeEntry' ? 'Remove' : 'Add');\n  const paths = Array.isArray(contextPaths) ? contextPaths : [contextPaths];\n  let contextLabel = '';\n  for (const path of paths) {\n    if (!path) continue;\n    const resolved = getLocalizedPathText(path, '');\n    if (resolved) {\n      contextLabel = resolved;\n      break;\n    }\n  }\n  if (!contextLabel && typeof fallbackContext === 'string') {\n    contextLabel = fallbackContext;\n  }\n  const normalizedContext = contextLabel ? contextLabel.replace(/[:]\\s*$/, '').trim() : '';\n  const combinedLabel = [actionLabel, normalizedContext].filter(Boolean).join(' ').trim();\n  if (combinedLabel) {\n    button.setAttribute('aria-label', combinedLabel);\n    button.setAttribute('title', combinedLabel);\n  }\n}\n\nexposeCoreRuntimeConstant('configureIconOnlyButton', configureIconOnlyButton);\n\nlet generatedFieldIdCounter = 0;\n\nfunction sanitizeForId(value, fallback = 'field') {\n  if (value === undefined || value === null) return fallback;\n  const normalized = String(value)\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-+|-+$/g, '');\n  return normalized || fallback;\n}\n\nfunction ensureElementId(element, baseText = 'field') {\n  if (!element) return '';\n  if (element.id) return element.id;\n  const base = sanitizeForId(baseText, 'field');\n  let id = '';\n  do {\n    generatedFieldIdCounter += 1;\n    id = `${base} -${generatedFieldIdCounter} `;\n  } while (document.getElementById(id));\n  element.id = id;\n  return id;\n}\n\nfunction createHiddenLabel(forId, text) {\n  const label = document.createElement('label');\n  label.className = 'visually-hidden';\n  label.setAttribute('for', forId);\n  label.textContent = typeof text === 'string' ? text : '';\n  return label;\n}\n\ntry {\n  if (typeof globalThis !== 'undefined') {\n    if (typeof globalThis.ensureElementId !== 'function') {\n      globalThis.ensureElementId = ensureElementId;\n    }\n    if (typeof globalThis.createHiddenLabel !== 'function') {\n      globalThis.createHiddenLabel = createHiddenLabel;\n    }\n  }\n} catch (globalAssignError) {\n  console.warn('Failed to expose accessibility helpers globally', globalAssignError);\n}\n\nfunction getProjectFormText(key, defaultValue = '') {\n  const fallbackProjectForm = texts?.en?.projectForm || {};\n  const projectFormTexts = texts?.[currentLang]?.projectForm || fallbackProjectForm;\n  const localized = projectFormTexts && typeof projectFormTexts[key] === 'string'\n    ? projectFormTexts[key].trim()\n    : '';\n  if (localized) return localized;\n  const fallback = fallbackProjectForm && typeof fallbackProjectForm[key] === 'string'\n    ? fallbackProjectForm[key].trim()\n    : '';\n  return fallback || defaultValue;\n}\n\nconst CONTACTS_STORAGE_KEY_DEFAULT = 'cameraPowerPlanner_contacts';\n\nfunction resolveContactsStorageKey() {\n  try {\n    const moduleApi = resolveContactsModule();\n    if (moduleApi && typeof moduleApi.CONTACTS_STORAGE_KEY === 'string' && moduleApi.CONTACTS_STORAGE_KEY) {\n      return moduleApi.CONTACTS_STORAGE_KEY;\n    }\n  } catch (error) {\n    console.warn('Failed to resolve contacts storage key via module.', error);\n  }\n  return CONTACTS_STORAGE_KEY_DEFAULT;\n}\nvar contactsCache = [];\nvar contactsInitialized = false;\n\nconst profileController = localCreateProfileController({\n  loadProfile: () => {\n    try {\n      return typeof loadUserProfile === 'function' ? loadUserProfile() : null;\n    } catch (loadError) {\n      console.warn('Failed to resolve stored user profile', loadError);\n      return null;\n    }\n  },\n  saveProfile: profile => {\n    if (typeof saveUserProfile === 'function') {\n      try {\n        saveUserProfile(profile);\n      } catch (saveError) {\n        console.warn('Failed to persist user profile', saveError);\n      }\n    }\n  },\n  announce: message => announceContactsMessage(message),\n  getText: getContactsText,\n  dispatchChange: () => dispatchGearProviderDataChanged('user-profile')\n});\n\nfunction getContactsText(key, defaultValue = '') {\n  const fallbackContacts = texts?.en?.contacts || {};\n  const contactsTexts = texts?.[currentLang]?.contacts || fallbackContacts;\n  const localized = contactsTexts && typeof contactsTexts[key] === 'string'\n    ? contactsTexts[key].trim()\n    : '';\n  if (localized) return localized;\n  const fallback = fallbackContacts && typeof fallbackContacts[key] === 'string'\n    ? fallbackContacts[key].trim()\n    : '';\n  return fallback || defaultValue;\n}\n\nfunction generateContactId() {\n  const moduleApi = resolveContactsModule();\n  if (moduleApi && typeof moduleApi.generateContactId === 'function') {\n    try {\n      return moduleApi.generateContactId();\n    } catch (error) {\n      console.warn('Unable to generate contact id via module.', error);\n    }\n  }\n  return `contact - ${Date.now().toString(36)} -${Math.random().toString(36).slice(2, 8)} `;\n}\n\nfunction sanitizeContactValue(value) {\n  return sanitizeContactValueHelper(value);\n}\n\nfunction normalizeContactEntry(entry) {\n  return normalizeContactEntryHelper(entry);\n}\n\nfunction sortContacts(list) {\n  return sortContactsHelper(list);\n}\n\nfunction loadStoredContacts() {\n  const moduleApi = resolveContactsModule();\n  if (moduleApi && typeof moduleApi.loadStoredContacts === 'function') {\n    try {\n      return moduleApi.loadStoredContacts();\n    } catch (error) {\n      console.warn('Unable to load contacts via module.', error);\n    }\n  }\n  if (typeof localStorage === 'undefined') return [];\n  try {\n    const storageKey = resolveContactsStorageKey();\n    const raw = localStorage.getItem(storageKey);\n    if (!raw) return [];\n    const parsed = JSON.parse(raw);\n    if (!Array.isArray(parsed)) return [];\n    return sortContacts(parsed);\n  } catch (error) {\n    console.warn('Failed to load contacts from storage', error);\n    return [];\n  }\n}\n\nfunction saveContactsToStorage(contacts) {\n  const moduleApi = resolveContactsModule();\n  if (moduleApi && typeof moduleApi.saveContactsToStorage === 'function') {\n    try {\n      moduleApi.saveContactsToStorage(contacts);\n      return;\n    } catch (error) {\n      console.warn('Unable to save contacts via module.', error);\n    }\n  }\n  if (typeof localStorage === 'undefined') return;\n  try {\n    const storageKey = resolveContactsStorageKey();\n    localStorage.setItem(storageKey, JSON.stringify(contacts));\n  } catch (error) {\n    console.warn('Failed to save contacts to storage', error);\n  }\n}\n\nfunction getContactById(id) {\n  if (!id) return null;\n  return contactsCache.find(contact => contact.id === id) || null;\n}\n\nfunction getContactDisplayLabel(contact) {\n  if (!contact) return '';\n  const roleLabels = texts?.[currentLang]?.crewRoles || texts?.en?.crewRoles || {};\n  const base = contact.name || contact.email || contact.phone || contact.website || contact.role || contact.id;\n  const roleLabel = contact.role ? (roleLabels[contact.role] || contact.role) : '';\n  if (base && roleLabel && roleLabel !== base) {\n    return `${base}  ${roleLabel} `;\n  }\n  return base || roleLabel || contact.id;\n}\n\nfunction ensureContactForImportedOwner(ownerName, options = {}) {\n  const contactOptions = options && typeof options === 'object' ? options : {};\n  const primaryName = typeof sanitizeContactValue === 'function'\n    ? sanitizeContactValue(ownerName)\n    : (typeof ownerName === 'string' ? ownerName.trim() : '');\n  const fallbackLabel = typeof sanitizeContactValue === 'function'\n    ? sanitizeContactValue(contactOptions.fallbackLabel)\n    : (typeof contactOptions.fallbackLabel === 'string' ? contactOptions.fallbackLabel.trim() : '');\n  const roleValue = typeof sanitizeContactValue === 'function'\n    ? sanitizeContactValue(contactOptions.role)\n    : (typeof contactOptions.role === 'string' ? contactOptions.role.trim() : '');\n  const baseName = primaryName || fallbackLabel;\n  if (!baseName) {\n    return null;\n  }\n\n  let existing = null;\n  if (contactOptions.contactId) {\n    existing = getContactById(contactOptions.contactId);\n  }\n  if (!existing) {\n    const targetName = baseName.toLowerCase();\n    existing = contactsCache.find(contact => {\n      if (!contact) return false;\n      const contactName = (contact.name || '').trim().toLowerCase();\n      if (contactName && contactName === targetName) {\n        return true;\n      }\n      if (typeof getContactDisplayLabel === 'function') {\n        const display = (getContactDisplayLabel(contact) || '').trim().toLowerCase();\n        if (display && display === targetName) {\n          return true;\n        }\n      }\n      return false;\n    }) || null;\n  }\n\n  if (existing) {\n    const label = typeof getContactDisplayLabel === 'function'\n      ? getContactDisplayLabel(existing) || baseName\n      : (existing.name || baseName);\n    return { value: `contact:${existing.id} `, label, contact: existing };\n  }\n\n  const now = Date.now();\n  const contact = normalizeContactEntry({\n    id: generateContactId(),\n    name: baseName,\n    role: roleValue,\n    phone: '',\n    email: '',\n    website: '',\n    avatar: '',\n    createdAt: now,\n    updatedAt: now,\n  });\n  contactsCache.push(contact);\n  contactsCache = sortContacts(contactsCache);\n  saveContactsToStorage(contactsCache);\n  if (typeof renderContactsList === 'function') {\n    renderContactsList();\n  }\n  if (typeof updateContactPickers === 'function') {\n    updateContactPickers();\n  }\n  if (typeof updateCalculations === 'function') updateCalculations();\n  const label = typeof getContactDisplayLabel === 'function'\n    ? getContactDisplayLabel(contact) || baseName\n    : baseName;\n  return { value: `contact:${contact.id} `, label, contact };\n}\nif (typeof window !== 'undefined') window.updateTripodOptions = updateTripodOptions;\n\nfunction setContactSelectOptions(select, selectedId) {\n  if (!select) return;\n  const currentValue = typeof selectedId === 'string' ? selectedId : select.value;\n  let optionLang = select.lang;\n  if (!optionLang && typeof document !== 'undefined' && document && document.documentElement) {\n    optionLang = document.documentElement.lang || '';\n  }\n  if (!optionLang) {\n    optionLang = currentLang || DEFAULT_LANGUAGE_SAFE;\n  }\n  const optionDirection = select.dir ||\n    localResolveDocumentDirection(optionLang || currentLang || DEFAULT_LANGUAGE_SAFE);\n  while (select.firstChild) {\n    select.removeChild(select.firstChild);\n  }\n  const placeholder = document.createElement('option');\n  placeholder.value = '';\n  placeholder.textContent = getContactsText('selectPlaceholder', 'Select contact');\n  localApplyLocaleMetadata(placeholder, optionLang, optionDirection);\n  select.appendChild(placeholder);\n  contactsCache.forEach(contact => {\n    const option = document.createElement('option');\n    option.value = contact.id;\n    option.textContent = getContactDisplayLabel(contact);\n    localApplyLocaleMetadata(option, optionLang, optionDirection);\n    if (contact.id === currentValue) {\n      option.selected = true;\n    }\n    select.appendChild(option);\n  });\n  if (currentValue && !contactsCache.some(contact => contact.id === currentValue)) {\n    const fallback = document.createElement('option');\n    fallback.value = currentValue;\n    fallback.textContent = getContactsText('missingContactFallback', 'Saved contact');\n    fallback.selected = true;\n    localApplyLocaleMetadata(fallback, optionLang, optionDirection);\n    select.appendChild(fallback);\n  }\n}\n\nfunction updateContactPickers() {\n  if (!crewContainer) return;\n  const selects = crewContainer.querySelectorAll('.person-contact-select');\n  selects.forEach(select => setContactSelectOptions(select));\n  dispatchGearProviderDataChanged('contacts');\n}\n\nfunction getAvatarInitial(value) {\n  if (typeof value === 'string') {\n    const trimmed = value.trim();\n    if (trimmed) return trimmed.charAt(0).toUpperCase();\n  }\n  return '';\n}\n\nfunction updateAvatarVisual(container, avatarValue, fallbackName, initialClass) {\n  if (!container) return;\n  const visual = container.querySelector('.person-avatar-visual, .contact-card-avatar-visual');\n  if (!visual) return;\n  while (visual.firstChild) {\n    visual.removeChild(visual.firstChild);\n  }\n  if (avatarValue && localIsSafeImageUrl(avatarValue)) {\n    const img = document.createElement('img');\n    img.src = avatarValue;\n    img.alt = '';\n    visual.appendChild(img);\n  } else {\n    const span = document.createElement('span');\n    span.className = initialClass;\n    span.textContent = getAvatarInitial(fallbackName);\n    visual.appendChild(span);\n  }\n}\n\nfunction setRowAvatar(row, avatarValue, options = {}) {\n  if (!row) return;\n  const dataInput = row.querySelector('.person-avatar-data');\n  if (dataInput) {\n    dataInput.value = avatarValue || '';\n  }\n  const nameInput = row.querySelector('.person-name');\n  const fallbackName = options && Object.prototype.hasOwnProperty.call(options, 'name')\n    ? options.name\n    : nameInput?.value;\n  const avatarContainer = row.querySelector('.person-avatar');\n  updateAvatarVisual(avatarContainer, avatarValue, fallbackName, 'person-avatar-initial');\n}\n\nfunction parseDataUrlMimeType(dataUrl) {\n  if (typeof dataUrl !== 'string' || !dataUrl.startsWith('data:')) return '';\n  const separatorIndex = dataUrl.indexOf(';');\n  if (separatorIndex === -1) return '';\n  return dataUrl.slice('data:'.length, separatorIndex).trim();\n}\n\nfunction updateAvatarOptionsPreview(avatarValue, fallbackName) {\n  resolveContactsDomRefs();\n  if (!avatarOptionsPreview) return;\n  updateAvatarVisual(avatarOptionsPreview, avatarValue || '', fallbackName || '', 'contact-card-avatar-initial');\n}\n\nfunction refreshAvatarOptionsActions() {\n  const avatarValue = typeof avatarOptionsContext?.getAvatar === 'function'\n    ? avatarOptionsContext.getAvatar()\n    : '';\n  const hasAvatar = Boolean(avatarValue);\n  const editingActive = Boolean(avatarEditState && avatarEditState.active);\n  const setState = (button, disabled) => {\n    if (!button) return;\n    button.disabled = disabled;\n    button.setAttribute('aria-disabled', disabled ? 'true' : 'false');\n  };\n  setState(avatarOptionsDeleteButton, !hasAvatar || editingActive);\n  setState(avatarOptionsEditButton, !hasAvatar || editingActive);\n  setState(avatarOptionsChangeButton, editingActive);\n}\n\nfunction stopAvatarEditing(options = {}) {\n  const { restoreFocus = false } = options || {};\n  if (avatarControls) {\n    avatarControls.classList.add('hidden');\n  }\n  if (avatarEditViewport) {\n    try {\n      avatarEditViewport.releasePointerCapture(avatarEditState?.pointerId ?? -1);\n    } catch (error) {\n      void error;\n    }\n    if (restoreFocus) {\n      avatarEditViewport.blur();\n    }\n  }\n  if (avatarEditImage) {\n    avatarEditImage.removeAttribute('style');\n  }\n  avatarEditState = null;\n  const currentAvatar = typeof avatarOptionsContext?.getAvatar === 'function'\n    ? avatarOptionsContext.getAvatar()\n    : '';\n  const fallbackName = typeof avatarOptionsContext?.getName === 'function'\n    ? avatarOptionsContext.getName()\n    : '';\n  updateAvatarOptionsPreview(currentAvatar, fallbackName);\n  updateAvatarOptionsPreview(currentAvatar, fallbackName);\n  // refreshAvatarOptionsActions();\n}\n\nfunction closeAvatarOptionsDialog() {\n  if (!avatarOptionsDialog) return;\n  stopAvatarEditing();\n  avatarOptionsContext = null;\n  closeDialog(avatarOptionsDialog);\n}\n\nfunction handleAvatarOptionsDialogClosed() {\n  stopAvatarEditing();\n  avatarOptionsContext = null;\n}\n\nfunction openAvatarOptionsDialog(context = null) {\n  console.log('openAvatarOptionsDialog called', context);\n  resolveContactsDomRefs();\n  console.log('avatarOptionsDialog ref:', avatarOptionsDialog);\n  if (!avatarOptionsDialog) return;\n  avatarOptionsContext = context || null;\n  const avatarValue = typeof context?.getAvatar === 'function' ? context.getAvatar() : '';\n  const fallbackName = typeof context?.getName === 'function' ? context.getName() : '';\n  updateAvatarOptionsPreview(avatarValue, fallbackName);\n  stopAvatarEditing();\n  stopAvatarEditing();\n  // refreshAvatarOptionsActions();\n  openDialog(avatarOptionsDialog);\n  if (avatarOptionsChangeButton && !avatarOptionsChangeButton.disabled) {\n    try {\n      avatarOptionsChangeButton.focus();\n    } catch (error) {\n      void error;\n    }\n  }\n}\n\nfunction clampAvatarEditOffsets(state) {\n  if (!state) return;\n  const minX = Math.min(0, state.viewportSize - state.displayWidth);\n  const minY = Math.min(0, state.viewportSize - state.displayHeight);\n  state.offsetX = Math.max(minX, Math.min(0, state.offsetX));\n  state.offsetY = Math.max(minY, Math.min(0, state.offsetY));\n}\n\nfunction updateAvatarEditMetrics(state) {\n  if (!state || !state.image) return;\n  const width = state.image.naturalWidth || state.image.width || 0;\n  const height = state.image.naturalHeight || state.image.height || 0;\n  const displayWidth = width * state.baseScale * state.zoom;\n  const displayHeight = height * state.baseScale * state.zoom;\n  state.displayWidth = displayWidth;\n  state.displayHeight = displayHeight;\n  clampAvatarEditOffsets(state);\n  if (avatarEditImage) {\n    avatarEditImage.style.width = `${displayWidth} px`;\n    avatarEditImage.style.height = `${displayHeight} px`;\n    avatarEditImage.style.transform = `translate(${state.offsetX}px, ${state.offsetY}px)`;\n  }\n}\n\nfunction measureAvatarEditViewportSize() {\n  resolveContactsDomRefs();\n  if (!avatarEditViewport) return 0;\n  let restoreHidden = false;\n  let previousVisibility = '';\n  let previousPointerEvents = '';\n  if (avatarEditViewport && avatarEditViewport.classList.contains('hidden')) {\n    restoreHidden = true;\n    previousVisibility = avatarEditViewport.style.visibility || '';\n    previousPointerEvents = avatarEditViewport.style.pointerEvents || '';\n    avatarEditViewport.style.visibility = 'hidden';\n    avatarEditViewport.style.pointerEvents = 'none';\n    avatarEditViewport.classList.remove('hidden');\n  }\n  let viewportSize = 0;\n  try {\n    const viewportRect = avatarEditViewport.getBoundingClientRect();\n    viewportSize = Math.round(\n      Math.max(\n        avatarEditViewport.offsetWidth || 0,\n        viewportRect.width || 0,\n        viewportRect.height || 0\n      )\n    );\n  } finally {\n    if (restoreHidden && avatarEditViewport) {\n      avatarEditViewport.classList.add('hidden');\n      avatarEditViewport.style.visibility = previousVisibility;\n      avatarEditViewport.style.pointerEvents = previousPointerEvents;\n    }\n  }\n  if (!viewportSize && avatarEditLastViewportSize) {\n    return avatarEditLastViewportSize;\n  }\n  if (viewportSize) {\n    avatarEditLastViewportSize = viewportSize;\n  }\n  return viewportSize;\n}\n\nfunction initializeAvatarEditState(dataUrl) {\n  resolveContactsDomRefs();\n  if (!avatarEditViewport || !avatarEditImage) return;\n  if (!dataUrl) {\n    announceContactsMessage(getContactsText('avatarMissingImage', 'Add a photo before editing.'));\n    return;\n  }\n  const viewportSize = measureAvatarEditViewportSize();\n  if (!viewportSize) {\n    announceContactsMessage(getContactsText('avatarEditUnavailable', 'Photo editor unavailable.'));\n    return;\n  }\n  const image = new Image();\n  image.decoding = 'async';\n  const mime = parseDataUrlMimeType(dataUrl);\n  image.onload = () => {\n    if (!image.naturalWidth || !image.naturalHeight) {\n      announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n      return;\n    }\n    const baseScale = Math.max(\n      viewportSize / image.naturalWidth,\n      viewportSize / image.naturalHeight\n    );\n    avatarEditState = {\n      active: true,\n      dataUrl,\n      image,\n      mime,\n      viewportSize,\n      baseScale,\n      zoom: 1,\n      offsetX: (viewportSize - image.naturalWidth * baseScale) / 2,\n      offsetY: (viewportSize - image.naturalHeight * baseScale) / 2,\n      pointerId: null,\n      pointerStartX: 0,\n      pointerStartY: 0,\n      offsetStartX: 0,\n      offsetStartY: 0,\n      displayWidth: 0,\n      displayHeight: 0\n    };\n    avatarEditImage.src = dataUrl;\n\n    // Unified Interface Updates\n    if (avatarEditViewport) avatarEditViewport.classList.add('has-image');\n    if (avatarControls) avatarControls.classList.remove('hidden');\n\n    if (avatarEditZoomInput) {\n      avatarEditZoomInput.value = '100';\n    }\n    updateAvatarEditMetrics(avatarEditState);\n    // refreshAvatarOptionsActions(); // Removed as actions are simplified\n    try {\n      avatarEditViewport.focus();\n    } catch (error) {\n      void error;\n    }\n  };\n  image.onerror = () => {\n    announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n  };\n  image.src = dataUrl;\n}\n\nfunction startAvatarEditing() {\n  const avatarValue = typeof avatarOptionsContext?.getAvatar === 'function' ? avatarOptionsContext.getAvatar() : '';\n\n  // Reset UI state\n  resolveContactsDomRefs();\n  if (avatarEditViewport) avatarEditViewport.classList.remove('has-image');\n  if (avatarControls) avatarControls.classList.add('hidden');\n  if (avatarEditImage) {\n    avatarEditImage.src = '';\n    avatarEditImage.removeAttribute('style');\n  }\n\n  if (!avatarValue) {\n    // No avatar, just show placeholder (handled by CSS via missing .has-image)\n    return;\n  }\n  initializeAvatarEditState(avatarValue);\n}\n\nfunction handleAvatarEditZoomInputChange(event) {\n  if (!avatarEditState || !avatarEditState.active) return;\n  const value = Number(event?.target?.value) || 100;\n  const normalized = Math.max(50, value) / 100;\n  const prevWidth = avatarEditState.displayWidth || 1;\n  const prevHeight = avatarEditState.displayHeight || 1;\n  const centerX = -avatarEditState.offsetX + avatarEditState.viewportSize / 2;\n  const centerY = -avatarEditState.offsetY + avatarEditState.viewportSize / 2;\n  const ratioX = centerX / prevWidth;\n  const ratioY = centerY / prevHeight;\n  avatarEditState.zoom = normalized;\n  updateAvatarEditMetrics(avatarEditState);\n  const targetCenterX = avatarEditState.displayWidth * ratioX;\n  const targetCenterY = avatarEditState.displayHeight * ratioY;\n  avatarEditState.offsetX = -(targetCenterX - avatarEditState.viewportSize / 2);\n  avatarEditState.offsetY = -(targetCenterY - avatarEditState.viewportSize / 2);\n  clampAvatarEditOffsets(avatarEditState);\n  updateAvatarEditMetrics(avatarEditState);\n}\n\nfunction handleAvatarEditPointerDown(event) {\n  if (!avatarEditState || !avatarEditState.active || !avatarEditViewport) return;\n  if (avatarEditState.pointerId !== null) return;\n  avatarEditState.pointerId = event.pointerId;\n  avatarEditState.pointerStartX = event.clientX;\n  avatarEditState.pointerStartY = event.clientY;\n  avatarEditState.offsetStartX = avatarEditState.offsetX;\n  avatarEditState.offsetStartY = avatarEditState.offsetY;\n  try {\n    avatarEditViewport.setPointerCapture(event.pointerId);\n  } catch (error) {\n    void error;\n  }\n  event.preventDefault();\n}\n\nfunction handleAvatarEditPointerMove(event) {\n  if (!avatarEditState || !avatarEditState.active) return;\n  if (avatarEditState.pointerId !== event.pointerId) return;\n  const deltaX = event.clientX - avatarEditState.pointerStartX;\n  const deltaY = event.clientY - avatarEditState.pointerStartY;\n  avatarEditState.offsetX = avatarEditState.offsetStartX + deltaX;\n  avatarEditState.offsetY = avatarEditState.offsetStartY + deltaY;\n  clampAvatarEditOffsets(avatarEditState);\n  updateAvatarEditMetrics(avatarEditState);\n  event.preventDefault();\n}\n\nfunction clearAvatarEditPointerState() {\n  if (!avatarEditState) return;\n  avatarEditState.pointerId = null;\n}\n\nfunction handleAvatarEditPointerUp(event) {\n  if (!avatarEditState || !avatarEditState.active) return;\n  if (avatarEditState.pointerId !== event.pointerId) return;\n  clearAvatarEditPointerState();\n  if (avatarEditViewport) {\n    try {\n      avatarEditViewport.releasePointerCapture(event.pointerId);\n    } catch (error) {\n      void error;\n    }\n  }\n  event.preventDefault();\n}\n\nfunction handleAvatarEditPointerCancel(event) {\n  if (!avatarEditState || !avatarEditState.active) return;\n  if (avatarEditState.pointerId !== event.pointerId) return;\n  clearAvatarEditPointerState();\n  if (avatarEditViewport) {\n    try {\n      avatarEditViewport.releasePointerCapture(event.pointerId);\n    } catch (error) {\n      void error;\n    }\n  }\n}\n\nfunction handleAvatarEditKeyDown(event) {\n  if (!avatarEditState || !avatarEditState.active) return;\n  const step = event.shiftKey ? 10 : 2;\n  let moved = false;\n  switch (event.key) {\n    case 'ArrowUp':\n      avatarEditState.offsetY -= step;\n      moved = true;\n      break;\n    case 'ArrowDown':\n      avatarEditState.offsetY += step;\n      moved = true;\n      break;\n    case 'ArrowLeft':\n      avatarEditState.offsetX -= step;\n      moved = true;\n      break;\n    case 'ArrowRight':\n      avatarEditState.offsetX += step;\n      moved = true;\n      break;\n    default:\n      break;\n  }\n  if (moved) {\n    clampAvatarEditOffsets(avatarEditState);\n    updateAvatarEditMetrics(avatarEditState);\n    event.preventDefault();\n  }\n}\n\nfunction exportAvatarEditResult() {\n  if (!avatarEditState || !avatarEditState.image) return '';\n  const scale = avatarEditState.baseScale * avatarEditState.zoom;\n  if (!scale) return '';\n  const cropSize = avatarEditState.viewportSize / scale;\n  const sourceX = Math.max(0, Math.min(\n    avatarEditState.image.naturalWidth - cropSize,\n    (-avatarEditState.offsetX) / scale\n  ));\n  const sourceY = Math.max(0, Math.min(\n    avatarEditState.image.naturalHeight - cropSize,\n    (-avatarEditState.offsetY) / scale\n  ));\n  const canvas = document.createElement('canvas');\n  canvas.width = CONTACT_AVATAR_MAX_DIMENSION;\n  canvas.height = CONTACT_AVATAR_MAX_DIMENSION;\n  const ctx = canvas.getContext('2d');\n  if (!ctx) return '';\n  ctx.clearRect(0, 0, canvas.width, canvas.height);\n  ctx.drawImage(\n    avatarEditState.image,\n    sourceX,\n    sourceY,\n    cropSize,\n    cropSize,\n    0,\n    0,\n    canvas.width,\n    canvas.height\n  );\n  const mime = avatarEditState.mime && avatarEditState.mime.startsWith('image/')\n    ? avatarEditState.mime\n    : 'image/png';\n  try {\n    return canvas.toDataURL(mime);\n  } catch (error) {\n    void error;\n    try {\n      return canvas.toDataURL('image/png');\n    } catch (fallbackError) {\n      void fallbackError;\n      return '';\n    }\n  }\n}\n\nfunction applyAvatarEditChanges() {\n  if (!avatarEditState || !avatarEditState.active) return;\n  const dataUrl = exportAvatarEditResult();\n  if (!dataUrl) {\n    announceContactsMessage(getContactsText('avatarEditFailed', 'Could not update the photo framing.'));\n    return;\n  }\n  if (typeof avatarOptionsContext?.onEditSave === 'function') {\n    avatarOptionsContext.onEditSave(dataUrl);\n  }\n  const fallbackName = typeof avatarOptionsContext?.getName === 'function' ? avatarOptionsContext.getName() : '';\n  updateAvatarOptionsPreview(dataUrl, fallbackName);\n  stopAvatarEditing({ restoreFocus: true });\n  closeAvatarOptionsDialog();\n}\n\nfunction handleAvatarDeleteAction() {\n  if (typeof avatarOptionsContext?.onDelete === 'function') {\n    avatarOptionsContext.onDelete();\n  }\n  const avatarValue = typeof avatarOptionsContext?.getAvatar === 'function' ? avatarOptionsContext.getAvatar() : '';\n  const fallbackName = typeof avatarOptionsContext?.getName === 'function' ? avatarOptionsContext.getName() : '';\n  updateAvatarOptionsPreview(avatarValue, fallbackName);\n  updateAvatarOptionsPreview(avatarValue, fallbackName);\n  // refreshAvatarOptionsActions();\n  if (!avatarValue) {\n    closeAvatarOptionsDialog();\n  }\n}\n\nfunction handleAvatarChangeAction() {\n  if (typeof avatarOptionsContext?.onChange === 'function') {\n    avatarOptionsContext.onChange();\n  }\n}\n\nfunction handleAvatarEditAction() {\n  startAvatarEditing();\n}\n\nfunction handleAvatarEditCancel() {\n  stopAvatarEditing({ restoreFocus: true });\n}\n\nfunction handleAvatarDrop(event) {\n  if (!event) return;\n  event.preventDefault();\n  event.stopPropagation();\n  if (avatarEditViewport) avatarEditViewport.classList.remove('drag-over');\n  const file = event.dataTransfer && event.dataTransfer.files && event.dataTransfer.files[0];\n  if (file) {\n    processAvatarFile(file);\n  }\n}\n\nfunction handleAvatarDragOver(event) {\n  if (!event) return;\n  event.preventDefault();\n  event.stopPropagation();\n  if (avatarEditViewport) avatarEditViewport.classList.add('drag-over');\n}\n\nfunction handleAvatarDragLeave(event) {\n  if (!event) return;\n  event.preventDefault();\n  event.stopPropagation();\n  if (avatarEditViewport) avatarEditViewport.classList.remove('drag-over');\n}\n\nfunction handleAvatarUpload(event) {\n  const file = event.target && event.target.files && event.target.files[0];\n  if (file) {\n    processAvatarFile(file);\n  }\n  if (event.target) event.target.value = '';\n}\n\nfunction processAvatarFile(file) {\n  localReadAvatarFile(file, dataUrl => {\n    const fallbackName = typeof avatarOptionsContext?.getName === 'function' ? avatarOptionsContext.getName() : '';\n    updateAvatarOptionsPreview(dataUrl, fallbackName);\n\n    // Initialize edit state directly with the new image data\n    // This ensures the zoom slider works with the new image immediately\n    initializeAvatarEditState(dataUrl);\n\n  }, reason => {\n    announceContactsMessage(getContactsText('avatarReadError', 'Could not read image.'));\n  });\n}\n\nfunction handleAvatarSave() {\n  // If we have an active edit state (which we should if we loaded an image), export it.\n  if (avatarEditState && avatarEditState.active) {\n    const dataUrl = exportAvatarEditResult();\n    if (dataUrl && typeof avatarOptionsContext?.onEditSave === 'function') {\n      avatarOptionsContext.onEditSave(dataUrl);\n    }\n  } else {\n    // If no edit state (e.g. just opened and clicked save without touching anything),\n    // effectively no-op or save current.\n    // If we just uploaded a file but didn't trigger edit state (unlikely with my logic above),\n    // we might lose the upload.\n    // So ensuring startAvatarEditing is called on upload is key.\n  }\n  closeAvatarOptionsDialog();\n}\n\nfunction handleAvatarOptionsDialogPointerDown(event) {\n  if (!avatarOptionsDialog || !isDialogOpen(avatarOptionsDialog)) return;\n  if (event && typeof event.button === 'number' && event.button !== 0) return;\n  const target = event?.target || null;\n  const elementTarget = (typeof Element !== 'undefined' && target instanceof Element) ? target : null;\n  const path = typeof event?.composedPath === 'function' ? event.composedPath() : null;\n  if (avatarOptionsForm) {\n    if (elementTarget && avatarOptionsForm.contains(elementTarget)) {\n      return;\n    }\n    if (Array.isArray(path) && path.includes(avatarOptionsForm)) {\n      return;\n    }\n  }\n  if (avatarEditState && avatarEditState.active) {\n    applyAvatarEditChanges();\n    return;\n  }\n  closeAvatarOptionsDialog();\n}\n\nfunction dispatchGearProviderDataChanged(reason) {\n  if (typeof document === 'undefined') return;\n  try {\n    document.dispatchEvent(new CustomEvent('gear-provider-data-changed', {\n      detail: { reason }\n    }));\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction getContactsSnapshot() {\n  return contactsCache.map(contact => {\n    if (!contact || typeof contact !== 'object') {\n      return null;\n    }\n    const createdAt = Number.isFinite(contact.createdAt) ? contact.createdAt : Date.now();\n    const updatedAt = Number.isFinite(contact.updatedAt) ? contact.updatedAt : createdAt;\n    const snapshot = {\n      id: contact.id,\n      name: contact.name || '',\n      role: contact.role || '',\n      phone: contact.phone || '',\n      email: contact.email || '',\n      website: contact.website || '',\n      notes: contact.notes || '',\n      avatar: contact.avatar || '',\n      createdAt,\n      updatedAt,\n    };\n    const label = typeof getContactDisplayLabel === 'function'\n      ? getContactDisplayLabel(contact)\n      : (contact.label || snapshot.name || snapshot.email || snapshot.phone || snapshot.id || '');\n    if (label) {\n      snapshot.label = label;\n    }\n    return snapshot;\n  }).filter(Boolean);\n}\n\nfunction assignUserProfileState(updates = {}) {\n  if (!profileController || typeof profileController.assignUserProfileState !== 'function') return;\n  profileController.assignUserProfileState(updates);\n}\n\nfunction getUserProfileSnapshot() {\n  if (!profileController || typeof profileController.getUserProfileSnapshot !== 'function') {\n    return { name: '', role: '', avatar: '', phone: '', email: '' };\n  }\n  return profileController.getUserProfileSnapshot();\n}\n\nfunction applyUserProfileToDom(options = {}) {\n  resolveContactsDomRefs();\n  const profile = getUserProfileSnapshot();\n  const preserveTarget = options && options.preserveSelectionTarget\n    ? options.preserveSelectionTarget\n    : (options && options.preserveSelection ? document.activeElement : null);\n  if (userProfileNameInput) {\n    if (preserveTarget === userProfileNameInput) {\n      const start = userProfileNameInput.selectionStart;\n      const end = userProfileNameInput.selectionEnd;\n      userProfileNameInput.value = profile.name;\n      try {\n        userProfileNameInput.setSelectionRange(start, end);\n      } catch (error) {\n        void error;\n      }\n    } else {\n      userProfileNameInput.value = profile.name;\n    }\n  }\n  if (userProfileRoleInput) {\n    ensureUserProfileRoleOption(profile.role);\n    if (preserveTarget !== userProfileRoleInput) {\n      userProfileRoleInput.value = profile.role || '';\n    }\n  }\n  if (userProfilePhoneInput) {\n    if (preserveTarget === userProfilePhoneInput) {\n      const start = userProfilePhoneInput.selectionStart;\n      const end = userProfilePhoneInput.selectionEnd;\n      userProfilePhoneInput.value = profile.phone;\n      try {\n        userProfilePhoneInput.setSelectionRange(start, end);\n      } catch (error) {\n        void error;\n      }\n    } else {\n      userProfilePhoneInput.value = profile.phone;\n    }\n  }\n  if (userProfileEmailInput) {\n    if (preserveTarget === userProfileEmailInput) {\n      const start = userProfileEmailInput.selectionStart;\n      const end = userProfileEmailInput.selectionEnd;\n      userProfileEmailInput.value = profile.email;\n      try {\n        userProfileEmailInput.setSelectionRange(start, end);\n      } catch (error) {\n        void error;\n      }\n    } else {\n      userProfileEmailInput.value = profile.email;\n    }\n  }\n  if (userProfileAvatarContainer) {\n    updateAvatarVisual(userProfileAvatarContainer, profile.avatar || '', profile.name, 'contact-card-avatar-initial');\n  }\n  if (userProfileAvatarClearButton) {\n    const hasAvatar = Boolean(profile.avatar);\n    userProfileAvatarClearButton.disabled = !hasAvatar;\n    userProfileAvatarClearButton.setAttribute('aria-disabled', hasAvatar ? 'false' : 'true');\n  }\n}\n\nfunction loadUserProfileState() {\n  if (!profileController || typeof profileController.load !== 'function') {\n    applyUserProfileToDom();\n    return;\n  }\n  profileController.load();\n  applyUserProfileToDom();\n}\n\nfunction setAvatar(dataUrl) {\n  assignUserProfileState({ avatar: typeof dataUrl === 'string' ? dataUrl : '' });\n  persistUserProfileState();\n}\n\nfunction clearAvatar() {\n  assignUserProfileState({ avatar: '' });\n  persistUserProfileState();\n}\n\n// Explicitly expose to global scope if not already present\nif (typeof window !== 'undefined') {\n  if (typeof window.setAvatar !== 'function') {\n    window.setAvatar = setAvatar;\n  }\n  if (typeof window.clearAvatar !== 'function') {\n    window.clearAvatar = clearAvatar;\n  }\n  if (typeof window.assignUserProfileState !== 'function') {\n    window.assignUserProfileState = assignUserProfileState;\n  }\n  if (typeof window.persistUserProfileState !== 'function') {\n    window.persistUserProfileState = persistUserProfileState;\n  }\n}\n\nfunction persistUserProfileState(options = {}) {\n  if (!profileController || typeof profileController.schedulePersist !== 'function') {\n    return;\n  }\n  const activeElement = typeof document !== 'undefined' ? document.activeElement : null;\n  const preserveTarget =\n    activeElement === userProfileNameInput\n      || activeElement === userProfileRoleInput\n      || activeElement === userProfilePhoneInput\n      || activeElement === userProfileEmailInput\n      ? activeElement\n      : null;\n  profileController.schedulePersist({ announce: Boolean(options && options.announce) });\n  applyUserProfileToDom({ preserveSelectionTarget: preserveTarget });\n}\n\nfunction handleUserProfileNameInput() {\n  if (!userProfileNameInput) return;\n  const rawValue = typeof userProfileNameInput.value === 'string' ? userProfileNameInput.value : '';\n  const profile = getUserProfileSnapshot();\n  if (rawValue.trim() === profile.name.trim()) {\n    return;\n  }\n  if (profileController && typeof profileController.handleFieldInput === 'function') {\n    profileController.handleFieldInput('name', rawValue);\n  } else {\n    assignUserProfileState({ name: rawValue });\n  }\n  persistUserProfileState();\n}\n\nfunction handleUserProfileRoleInput() {\n  if (!userProfileRoleInput) return;\n  const rawValue = typeof userProfileRoleInput.value === 'string' ? userProfileRoleInput.value : '';\n  const normalizedValue = rawValue.trim();\n  const profile = getUserProfileSnapshot();\n  if (normalizedValue === profile.role.trim()) {\n    return;\n  }\n  ensureUserProfileRoleOption(normalizedValue);\n  if (profileController && typeof profileController.handleFieldInput === 'function') {\n    profileController.handleFieldInput('role', normalizedValue);\n  } else {\n    assignUserProfileState({ role: normalizedValue });\n  }\n  persistUserProfileState();\n}\n\nfunction handleUserProfilePhoneInput() {\n  if (!userProfilePhoneInput) return;\n  const rawValue = typeof userProfilePhoneInput.value === 'string' ? userProfilePhoneInput.value : '';\n  const profile = getUserProfileSnapshot();\n  if (rawValue.trim() === profile.phone.trim()) {\n    return;\n  }\n  if (profileController && typeof profileController.handleFieldInput === 'function') {\n    profileController.handleFieldInput('phone', rawValue);\n  } else {\n    assignUserProfileState({ phone: rawValue });\n  }\n  persistUserProfileState();\n}\n\nfunction handleUserProfileEmailInput() {\n  if (!userProfileEmailInput) return;\n  const rawValue = typeof userProfileEmailInput.value === 'string' ? userProfileEmailInput.value : '';\n  const profile = getUserProfileSnapshot();\n  if (rawValue.trim() === profile.email.trim()) {\n    return;\n  }\n  if (profileController && typeof profileController.handleFieldInput === 'function') {\n    profileController.handleFieldInput('email', rawValue);\n  } else {\n    assignUserProfileState({ email: rawValue });\n  }\n  persistUserProfileState();\n}\n\nfunction handleUserProfileFieldBlur() {\n  if (profileController && typeof profileController.handleFieldBlur === 'function') {\n    profileController.handleFieldBlur();\n  }\n}\n\nfunction handleUserProfileAvatarCleared() {\n  const profile = getUserProfileSnapshot();\n  if (!profile.avatar) {\n    return;\n  }\n  assignUserProfileState({ avatar: '' });\n  persistUserProfileState();\n  announceContactsMessage(getContactsText('avatarCleared', 'Profile photo removed.'));\n  if (isDialogOpen(avatarOptionsDialog)) {\n    closeAvatarOptionsDialog();\n  }\n}\n\nfunction handleUserProfileAvatarButtonClick() {\n  const profile = getUserProfileSnapshot();\n  const hasAvatar = Boolean(profile && profile.avatar);\n  console.log('handleUserProfileAvatarButtonClick', { hasAvatar, profile });\n  if (!hasAvatar && userProfileAvatarInput && typeof userProfileAvatarInput.click === 'function') {\n    try {\n      userProfileAvatarInput.click();\n      return;\n    } catch (error) {\n      void error;\n    }\n  }\n  openAvatarOptionsDialog({\n    getAvatar: () => getUserProfileSnapshot().avatar || '',\n    getName: () => getUserProfileSnapshot().name || userProfileNameInput?.value || '',\n    onDelete: () => {\n      handleUserProfileAvatarCleared();\n    },\n    onChange: () => {\n      if (userProfileAvatarInput && typeof userProfileAvatarInput.click === 'function') {\n        try {\n          userProfileAvatarInput.click();\n        } catch (error) {\n          void error;\n        }\n      }\n    },\n    onEditSave: dataUrl => {\n      if (!dataUrl) return;\n      assignUserProfileState({\n        name: getUserProfileSnapshot().name || userProfileNameInput?.value || '',\n        avatar: dataUrl\n      });\n      persistUserProfileState();\n      announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n      closeAvatarOptionsDialog();\n    }\n  });\n}\n\nfunction handleUserProfileAvatarInputChange() {\n  if (!userProfileAvatarInput) return;\n  const [file] = userProfileAvatarInput.files || [];\n  if (!file) {\n    return;\n  }\n  localReadAvatarFile(file, dataUrl => {\n    const profile = getUserProfileSnapshot();\n    assignUserProfileState({\n      name: profile.name || '',\n      avatar: dataUrl\n    });\n    persistUserProfileState();\n    announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n    if (isDialogOpen(avatarOptionsDialog)) {\n      closeAvatarOptionsDialog();\n    }\n  }, reason => {\n    if (reason === 'tooLarge') {\n      announceContactsMessage(getContactsText('avatarTooLarge', 'Choose an image under 300 KB.'));\n    } else {\n      announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n    }\n  });\n  userProfileAvatarInput.value = '';\n}\n\nfunction refreshRowAvatarInitial(row) {\n  if (!row) return;\n  const dataInput = row.querySelector('.person-avatar-data');\n  if (dataInput && dataInput.value) return;\n  const nameInput = row.querySelector('.person-name');\n  const avatarContainer = row.querySelector('.person-avatar');\n  updateAvatarVisual(avatarContainer, '', nameInput ? nameInput.value : '', 'person-avatar-initial');\n}\n\nfunction detachCrewRowContact(row, options = {}) {\n  if (!row) return;\n  const { preserveSelect = false } = options || {};\n  delete row.dataset.contactId;\n  if (!preserveSelect) {\n    const contactSelect = row.querySelector('.person-contact-select');\n    if (contactSelect) contactSelect.value = '';\n  }\n  updateRowLinkedBadge(row);\n}\n\nfunction updateRowLinkedBadge(row) {\n  if (!row) return;\n  const badge = row.querySelector('.person-linked-badge');\n  if (!badge) return;\n  const contactId = row.dataset.contactId;\n  const isUserProfileLinked = row.dataset.userProfileLinked === '1';\n  if (contactId) {\n    const contact = getContactById(contactId);\n    const baseLabel = getContactsText('linkedBadge', 'Linked to contact');\n    if (contact && contact.name) {\n      badge.textContent = `${baseLabel}: ${contact.name} `;\n    } else {\n      badge.textContent = baseLabel;\n    }\n    badge.hidden = false;\n    return;\n  }\n  if (isUserProfileLinked) {\n    badge.textContent = getContactsText('linkedProfileBadge', 'Linked to user profile');\n    badge.hidden = false;\n    return;\n  }\n  badge.textContent = getContactsText('linkedBadge', 'Linked to contact');\n  badge.hidden = true;\n}\n\nfunction handleCrewRowManualChange(row, immediate = false) {\n  if (typeof window !== 'undefined' && window.cineSuppressAutosave) {\n    return;\n  }\n  if (!row || row.dataset.syncingContact === '1') return;\n  const wasLinked = Boolean(row.dataset.contactId);\n  if (wasLinked) {\n    detachCrewRowContact(row);\n    announceContactsMessage(getContactsText('contactDetached', 'Crew row disconnected from saved contact.'));\n  }\n  refreshRowAvatarInitial(row);\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n  scheduleProjectAutoSave(immediate);\n}\n\n\n\n\nfunction handleAvatarFileSelection(row, file) {\n  localReadAvatarFile(\n    file,\n    dataUrl => {\n      setRowAvatar(row, dataUrl);\n      if (row.dataset.contactId) {\n        detachCrewRowContact(row);\n      }\n      if (typeof markProjectFormDataDirty === 'function') {\n        markProjectFormDataDirty();\n      }\n      scheduleProjectAutoSave(true);\n      announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n      if (isDialogOpen(avatarOptionsDialog)) {\n        closeAvatarOptionsDialog();\n      }\n    },\n    reason => {\n      if (reason === 'tooLarge') {\n        announceContactsMessage(getContactsText('avatarTooLarge', 'Choose an image under 300 KB.'));\n      } else {\n        announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n      }\n    }\n  );\n}\n\nfunction announceContactsMessage(message) {\n  resolveContactsDomRefs();\n  if (!contactsAnnouncement) return;\n  contactsAnnouncement.textContent = message || '';\n}\n\nfunction applyContactToCrewRow(row, contact, options = {}) {\n  if (!row || !contact) return;\n  const { skipDirty = false, skipAnnouncement = false } = options || {};\n  const snapshot = getCrewRowSnapshot(row) || {};\n  const merged = typeof localCreateCrewRowSync === 'function'\n    ? localCreateCrewRowSync(snapshot, contact)\n    : {\n      role: contact.role || '',\n      name: contact.name || '',\n      phone: contact.phone || '',\n      email: contact.email || '',\n      website: contact.website || '',\n      avatar: contact.avatar || '',\n      contactId: contact.id || ''\n    };\n  row.dataset.syncingContact = '1';\n  try {\n    const roleSel = row.querySelector('select[name=\"crewRole\"]');\n    if (roleSel) {\n      if (merged.role && !Array.from(roleSel.options).some(opt => opt.value === merged.role)) {\n        const opt = document.createElement('option');\n        opt.value = merged.role;\n        const roleLabels = texts?.[currentLang]?.crewRoles || texts?.en?.crewRoles || {};\n        opt.textContent = roleLabels[merged.role] || merged.role;\n        roleSel.appendChild(opt);\n      }\n      if (merged.role) {\n        roleSel.value = merged.role;\n      }\n    }\n    const nameInput = row.querySelector('.person-name');\n    if (nameInput) nameInput.value = merged.name || '';\n    const phoneInput = row.querySelector('.person-phone');\n    if (phoneInput) phoneInput.value = merged.phone || '';\n    const emailInput = row.querySelector('.person-email');\n    if (emailInput) emailInput.value = merged.email || '';\n    const websiteInput = row.querySelector('.person-website');\n    if (websiteInput) websiteInput.value = merged.website || '';\n    setRowAvatar(row, merged.avatar || '', { name: merged.name });\n    row.dataset.contactId = merged.contactId || contact.id;\n    const contactSelect = row.querySelector('.person-contact-select');\n    if (contactSelect) {\n      setContactSelectOptions(contactSelect, merged.contactId || contact.id);\n    }\n  } finally {\n    delete row.dataset.syncingContact;\n  }\n  updateRowLinkedBadge(row);\n  if (!skipDirty && typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n  if (!skipDirty) {\n    scheduleProjectAutoSave(true);\n  }\n  if (!skipAnnouncement) {\n    announceContactsMessage(getContactsText('contactApplied', 'Crew row updated from contact.'));\n  }\n}\n\nfunction updateCrewRowsForContact(contact) {\n  if (!crewContainer || !contact) return;\n  const rows = crewContainer.querySelectorAll('.person-row');\n  rows.forEach(row => {\n    if (row.dataset.contactId === contact.id) {\n      applyContactToCrewRow(row, contact, { skipAnnouncement: true });\n    }\n  });\n}\n\nfunction getCrewRowSnapshot(row) {\n  if (!row) return null;\n  const roleSel = row.querySelector('select[name=\"crewRole\"]');\n  const nameInput = row.querySelector('.person-name');\n  const phoneInput = row.querySelector('.person-phone');\n  const emailInput = row.querySelector('.person-email');\n  const websiteInput = row.querySelector('.person-website');\n  const avatarInput = row.querySelector('.person-avatar-data');\n  return {\n    role: sanitizeContactValue(roleSel?.value || ''),\n    name: sanitizeContactValue(nameInput?.value || ''),\n    phone: sanitizeContactValue(phoneInput?.value || ''),\n    email: sanitizeContactValue(emailInput?.value || ''),\n    website: sanitizeContactValue(websiteInput?.value || ''),\n    avatar: sanitizeContactValue(avatarInput?.value || ''),\n    contactId: sanitizeContactValue(row.dataset.contactId || '')\n  };\n}\n\nfunction deleteContact(contactId) {\n  if (!contactId) return;\n  const index = contactsCache.findIndex(contact => contact.id === contactId);\n  if (index === -1) return;\n  contactsCache.splice(index, 1);\n  contactsCache = sortContacts(contactsCache);\n  saveContactsToStorage(contactsCache);\n  renderContactsList();\n  updateContactPickers();\n  if (crewContainer) {\n    const rows = crewContainer.querySelectorAll('.person-row');\n    rows.forEach(row => {\n      if (row.dataset.contactId === contactId) {\n        detachCrewRowContact(row);\n      }\n    });\n  }\n  announceContactsMessage(getContactsText('contactDeleted', 'Contact removed. Project rows keep their details.'));\n}\n\nfunction saveCrewRowAsContact(row) {\n  const snapshot = getCrewRowSnapshot(row);\n  if (!snapshot) return;\n  if (!snapshot.name && !snapshot.email && !snapshot.phone && !snapshot.website) {\n    announceContactsMessage(getContactsText('contactMissingDetails', 'Enter a name, email, phone number or website before saving this contact.'));\n    return;\n  }\n  const now = Date.now();\n  if (snapshot.contactId) {\n    const existing = getContactById(snapshot.contactId);\n    if (existing) {\n      existing.name = snapshot.name || existing.name;\n      existing.role = snapshot.role || existing.role;\n      existing.phone = snapshot.phone || existing.phone;\n      existing.email = snapshot.email || existing.email;\n      existing.website = snapshot.website || existing.website;\n      if (snapshot.avatar) {\n        existing.avatar = snapshot.avatar;\n      } else if (!existing.avatar) {\n        delete existing.avatar;\n      }\n      existing.updatedAt = now;\n      contactsCache = sortContacts(contactsCache);\n      saveContactsToStorage(contactsCache);\n      renderContactsList({ focusContactId: existing.id });\n      updateContactPickers();\n      updateCrewRowsForContact(existing);\n      announceContactsMessage(getContactsText('contactUpdated', 'Contact updated.'));\n      return;\n    }\n  }\n\n  const newContact = normalizeContactEntry({\n    id: snapshot.contactId || generateContactId(),\n    name: snapshot.name,\n    role: snapshot.role,\n    phone: snapshot.phone,\n    email: snapshot.email,\n    website: snapshot.website,\n    avatar: snapshot.avatar,\n    createdAt: now,\n    updatedAt: now\n  });\n  contactsCache.push(newContact);\n  contactsCache = sortContacts(contactsCache);\n  saveContactsToStorage(contactsCache);\n  renderContactsList({ focusContactId: newContact.id });\n  updateContactPickers();\n  applyContactToCrewRow(row, newContact, { skipAnnouncement: true });\n  announceContactsMessage(getContactsText('contactSaved', 'Contact saved for future projects.'));\n}\n\nfunction parseVCard(text) {\n  return parseVCardEntries(text, { sanitize: sanitizeContactValue });\n}\n\nfunction mergeImportedContacts(imported) {\n  if (!Array.isArray(imported) || !imported.length) {\n    announceContactsMessage(getContactsText('importNone', 'No new contacts found in the file.'));\n    return { added: 0, updated: 0 };\n  }\n  const result = mergeImportedContactEntries({\n    existing: contactsCache,\n    imported,\n    now: () => Date.now(),\n    generateContactId\n  });\n  const { contacts, added = 0, updated = 0 } = result;\n  contactsCache = Array.isArray(contacts) ? contacts : contactsCache;\n  saveContactsToStorage(contactsCache);\n  renderContactsList();\n  updateContactPickers();\n  if (Array.isArray(contacts)) {\n    contacts.forEach(contact => updateCrewRowsForContact(contact));\n  }\n  if (added || updated) {\n    const template = getContactsText('importSummary', '{added} added, {updated} updated.');\n    announceContactsMessage(template.replace('{added}', added).replace('{updated}', updated));\n  } else {\n    announceContactsMessage(getContactsText('importNone', 'No new contacts found in the file.'));\n  }\n  return { added, updated };\n}\n\nfunction createContactCard(contact) {\n  const card = document.createElement('article');\n  card.className = 'contact-card';\n  card.setAttribute('role', 'listitem');\n  card.dataset.contactId = contact.id;\n\n  const header = document.createElement('div');\n  header.className = 'contact-card-header';\n\n  const avatarContainer = document.createElement('div');\n  avatarContainer.className = 'contact-card-avatar';\n  const avatarVisual = document.createElement('div');\n  avatarVisual.className = 'contact-card-avatar-visual';\n  avatarContainer.appendChild(avatarVisual);\n  updateAvatarVisual(avatarContainer, contact.avatar || '', contact.name, 'contact-card-avatar-initial');\n  const avatarButton = document.createElement('button');\n  avatarButton.type = 'button';\n  const avatarLabel = getContactsText('avatarChange', 'Change photo');\n  avatarButton.setAttribute('aria-label', avatarLabel);\n  avatarButton.removeAttribute('title');\n  avatarButton.removeAttribute('data-help');\n  avatarButton.innerHTML = '';\n  avatarContainer.appendChild(avatarButton);\n  const avatarInput = document.createElement('input');\n  avatarInput.type = 'file';\n  avatarInput.accept = 'image/*';\n  avatarInput.className = 'visually-hidden';\n  avatarInput.tabIndex = -1;\n  avatarContainer.appendChild(avatarInput);\n  header.appendChild(avatarContainer);\n\n  const title = document.createElement('strong');\n  title.textContent = contact.name || getContactsText('contactFallbackName', 'Crew contact');\n  header.appendChild(title);\n\n  card.appendChild(header);\n\n  const fields = document.createElement('div');\n  fields.className = 'contact-card-fields';\n\n  const roleLabels = texts?.[currentLang]?.crewRoles || texts?.en?.crewRoles || {};\n\n  const nameInput = document.createElement('input');\n  nameInput.type = 'text';\n  nameInput.value = contact.name || '';\n  const nameFieldId = ensureElementId(nameInput, `${contact.id} -name`);\n  const nameLabel = document.createElement('label');\n  nameLabel.setAttribute('for', nameFieldId);\n  nameLabel.textContent = getContactsText('nameLabel', 'Name');\n  const nameWrapper = document.createElement('div');\n  nameWrapper.className = 'contact-field';\n  nameWrapper.append(nameLabel, nameInput);\n  fields.appendChild(nameWrapper);\n\n  const roleSelect = document.createElement('select');\n  const roleFieldId = ensureElementId(roleSelect, `${contact.id} -role`);\n  const rolePlaceholder = document.createElement('option');\n  rolePlaceholder.value = '';\n  rolePlaceholder.textContent = getContactsText('rolePlaceholder', 'Select role');\n  roleSelect.appendChild(rolePlaceholder);\n  crewRoles.forEach(role => {\n    const option = document.createElement('option');\n    option.value = role;\n    option.textContent = roleLabels[role] || role;\n    roleSelect.appendChild(option);\n  });\n  if (contact.role && !crewRoles.includes(contact.role)) {\n    const extraOption = document.createElement('option');\n    extraOption.value = contact.role;\n    extraOption.textContent = roleLabels[contact.role] || contact.role;\n    roleSelect.appendChild(extraOption);\n  }\n  roleSelect.value = contact.role || '';\n  const roleLabelElem = document.createElement('label');\n  roleLabelElem.setAttribute('for', roleFieldId);\n  roleLabelElem.textContent = getContactsText('roleLabel', 'Crew role');\n  const roleWrapper = document.createElement('div');\n  roleWrapper.className = 'contact-field';\n  roleWrapper.append(roleLabelElem, roleSelect);\n  fields.appendChild(roleWrapper);\n\n  const phoneInput = document.createElement('input');\n  phoneInput.type = 'tel';\n  phoneInput.value = contact.phone || '';\n  const phoneFieldId = ensureElementId(phoneInput, `${contact.id} -phone`);\n  const phoneLabelElem = document.createElement('label');\n  phoneLabelElem.setAttribute('for', phoneFieldId);\n  phoneLabelElem.textContent = getContactsText('phoneLabel', 'Phone');\n  const phoneWrapper = document.createElement('div');\n  phoneWrapper.className = 'contact-field';\n  phoneWrapper.append(phoneLabelElem, phoneInput);\n  fields.appendChild(phoneWrapper);\n\n  const emailInput = document.createElement('input');\n  emailInput.type = 'email';\n  emailInput.value = contact.email || '';\n  const emailFieldId = ensureElementId(emailInput, `${contact.id} -email`);\n  const emailLabelElem = document.createElement('label');\n  emailLabelElem.setAttribute('for', emailFieldId);\n  emailLabelElem.textContent = getContactsText('emailLabel', 'Email');\n  const emailWrapper = document.createElement('div');\n  emailWrapper.className = 'contact-field';\n  emailWrapper.append(emailLabelElem, emailInput);\n  fields.appendChild(emailWrapper);\n\n  const websiteInput = document.createElement('input');\n  websiteInput.type = 'url';\n  websiteInput.inputMode = 'url';\n  websiteInput.autocomplete = 'url';\n  websiteInput.value = contact.website || '';\n  websiteInput.placeholder = getContactsText('websitePlaceholder', 'https://example.com');\n  const websiteFieldId = ensureElementId(websiteInput, `${contact.id} -website`);\n  const websiteLabelElem = document.createElement('label');\n  websiteLabelElem.setAttribute('for', websiteFieldId);\n  websiteLabelElem.textContent = getContactsText('websiteLabel', 'Website');\n  const websiteWrapper = document.createElement('div');\n  websiteWrapper.className = 'contact-field';\n  websiteWrapper.append(websiteLabelElem, websiteInput);\n  fields.appendChild(websiteWrapper);\n\n  card.appendChild(fields);\n\n  const actions = document.createElement('div');\n  actions.className = 'contact-card-actions';\n\n  const useButton = document.createElement('button');\n  useButton.type = 'button';\n  setButtonLabelWithIconBinding(useButton, getContactsText('useInProject', 'Add to project crew'), ICON_GLYPHS.add);\n  useButton.addEventListener('click', () => {\n    createCrewRow({ ...contact, contactId: contact.id });\n    closeDialog(contactsDialog);\n    announceContactsMessage(getContactsText('contactAddedToProject', 'Contact added to the current project.'));\n  });\n  actions.appendChild(useButton);\n\n  const deleteButton = document.createElement('button');\n  deleteButton.type = 'button';\n  setButtonLabelWithIconBinding(deleteButton, getContactsText('deleteContact', 'Delete contact'), ICON_GLYPHS.trash);\n  deleteButton.addEventListener('click', () => {\n    const confirmMessage = getContactsText('deleteConfirm', 'Remove this contact? Project rows will keep their details.');\n    const performDelete = () => deleteContact(contact.id);\n\n    if (typeof window.cineShowConfirmDialog === 'function') {\n      window.cineShowConfirmDialog({\n        title: getContactsText('deleteContact', 'Delete contact'),\n        message: confirmMessage,\n        confirmLabel: getContactsText('deleteButton', 'Delete') || 'Delete',\n        cancelLabel: getContactsText('cancel', 'Cancel') || 'Cancel',\n        danger: true,\n        onConfirm: performDelete,\n      });\n      return;\n    }\n\n    console.warn('Missing window.cineShowConfirmDialog for delete contact');\n  });\n  actions.appendChild(deleteButton);\n\n  card.appendChild(actions);\n\n  const persist = (resort = false) => {\n    contact.updatedAt = Date.now();\n    saveContactsToStorage(contactsCache);\n    updateContactPickers();\n    updateCrewRowsForContact(contact);\n    if (resort) {\n      contactsCache = sortContacts(contactsCache);\n      renderContactsList({ focusContactId: contact.id });\n    }\n  };\n\n  nameInput.addEventListener('input', () => {\n    contact.name = sanitizeContactValue(nameInput.value);\n    title.textContent = contact.name || getContactsText('contactFallbackName', 'Crew contact');\n    updateAvatarVisual(avatarContainer, contact.avatar || '', contact.name, 'contact-card-avatar-initial');\n    persist();\n  });\n  nameInput.addEventListener('blur', event => {\n    const nextActive = event?.relatedTarget\n      || (typeof document !== 'undefined' ? document.activeElement : null);\n    if (nextActive && nextActive !== nameInput && card.contains(nextActive)) {\n      persist();\n      return;\n    }\n    persist(true);\n  });\n\n  roleSelect.addEventListener('change', () => {\n    contact.role = sanitizeContactValue(roleSelect.value);\n    persist();\n  });\n  phoneInput.addEventListener('input', () => {\n    contact.phone = sanitizeContactValue(phoneInput.value);\n    persist();\n  });\n  emailInput.addEventListener('input', () => {\n    contact.email = sanitizeContactValue(emailInput.value);\n    persist();\n  });\n  websiteInput.addEventListener('input', () => {\n    contact.website = sanitizeContactValue(websiteInput.value);\n    persist();\n  });\n\n  avatarButton.addEventListener('click', () => {\n    if (!contact.avatar && avatarInput && typeof avatarInput.click === 'function') {\n      try {\n        avatarInput.click();\n        return;\n      } catch (error) {\n        void error;\n      }\n    }\n    openAvatarOptionsDialog({\n      getAvatar: () => contact.avatar || '',\n      getName: () => contact.name || '',\n      onDelete: () => {\n        if (!contact.avatar) return;\n        contact.avatar = '';\n        updateAvatarVisual(avatarContainer, '', contact.name, 'contact-card-avatar-initial');\n        persist();\n        announceContactsMessage(getContactsText('avatarCleared', 'Profile photo removed.'));\n      },\n      onChange: () => {\n        if (avatarInput && typeof avatarInput.click === 'function') {\n          try {\n            avatarInput.click();\n          } catch (error) {\n            void error;\n          }\n        }\n      },\n      onEditSave: dataUrl => {\n        if (!dataUrl) return;\n        contact.avatar = dataUrl;\n        updateAvatarVisual(avatarContainer, dataUrl, contact.name, 'contact-card-avatar-initial');\n        persist();\n        announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n      }\n    });\n  });\n\n  avatarInput.addEventListener('change', () => {\n    const [file] = avatarInput.files || [];\n    if (!file) return;\n    localReadAvatarFile(file, dataUrl => {\n      contact.avatar = dataUrl;\n      updateAvatarVisual(avatarContainer, dataUrl, contact.name, 'contact-card-avatar-initial');\n      persist();\n      announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n      if (isDialogOpen(avatarOptionsDialog)) {\n        closeAvatarOptionsDialog();\n      }\n    }, reason => {\n      if (reason === 'tooLarge') {\n        announceContactsMessage(getContactsText('avatarTooLarge', 'Choose an image under 300 KB.'));\n      } else {\n        announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n      }\n    });\n    avatarInput.value = '';\n  });\n\n  return { card, focusTarget: nameInput };\n}\n\nfunction renderContactsList(options = {}) {\n  resolveContactsDomRefs();\n  if (!contactsList) return;\n  const { focusContactId = null } = options || {};\n  while (contactsList.firstChild) {\n    contactsList.removeChild(contactsList.firstChild);\n  }\n  if (!contactsCache.length) {\n    if (contactsEmptyState) contactsEmptyState.hidden = false;\n    return;\n  }\n  if (contactsEmptyState) contactsEmptyState.hidden = true;\n  let focusTarget = null;\n  contactsCache.forEach(contact => {\n    const { card, focusTarget: target } = createContactCard(contact);\n    contactsList.appendChild(card);\n    if (focusContactId && contact.id === focusContactId) {\n      focusTarget = target;\n    }\n  });\n  if (focusTarget) {\n    requestAnimationFrame(() => focusTarget.focus());\n  }\n}\n\nfunction enableAvatarDragAndDrop(container, onFile) {\n  if (!container) return;\n\n  const handleDragOver = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    container.classList.add('avatar-drag-over');\n  };\n\n  const handleDragLeave = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    container.classList.remove('avatar-drag-over');\n  };\n\n  const handleDrop = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    container.classList.remove('avatar-drag-over');\n\n    const file = event.dataTransfer && event.dataTransfer.files && event.dataTransfer.files[0];\n    if (file) {\n      onFile(file);\n    }\n  };\n\n  container.addEventListener('dragenter', handleDragOver);\n  container.addEventListener('dragover', handleDragOver);\n  container.addEventListener('dragleave', handleDragLeave);\n  container.addEventListener('drop', handleDrop);\n}\n\nfunction initializeContactsModule() {\n  console.log('initializeContactsModule called');\n  resolveContactsDomRefs();\n\n  // Only return if we are fully initialized with critical elements\n  if (contactsInitialized && contactsList && userProfileAvatarButton) {\n    return;\n  }\n\n  console.log('initializeContactsModule running (re-init or first run)');\n\n  contactsCache = loadStoredContacts();\n  loadUserProfileState();\n  populateUserProfileRoleSelect();\n  renderContactsList();\n  updateContactPickers();\n  applyUserProfileToDom();\n\n  console.log('userProfileAvatarButton found (first-run):', !!userProfileAvatarButton);\n  if (userProfileNameInput) {\n    userProfileNameInput.addEventListener('input', handleUserProfileNameInput);\n    userProfileNameInput.addEventListener('blur', handleUserProfileFieldBlur);\n  }\n  if (userProfileRoleInput) {\n    userProfileRoleInput.addEventListener('input', handleUserProfileRoleInput);\n    userProfileRoleInput.addEventListener('change', handleUserProfileRoleInput);\n    userProfileRoleInput.addEventListener('blur', handleUserProfileFieldBlur);\n  }\n  if (userProfilePhoneInput) {\n    userProfilePhoneInput.addEventListener('input', handleUserProfilePhoneInput);\n    userProfilePhoneInput.addEventListener('blur', handleUserProfileFieldBlur);\n  }\n  if (userProfileEmailInput) {\n    userProfileEmailInput.addEventListener('input', handleUserProfileEmailInput);\n    userProfileEmailInput.addEventListener('blur', handleUserProfileFieldBlur);\n  }\n  if (userProfileAvatarButton) {\n    userProfileAvatarButton.addEventListener('click', handleUserProfileAvatarButtonClick);\n  }\n  if (userProfileAvatarClearButton) {\n    userProfileAvatarClearButton.addEventListener('click', handleUserProfileAvatarCleared);\n  }\n  if (userProfileAvatarInput) {\n    userProfileAvatarInput.addEventListener('change', handleUserProfileAvatarInputChange);\n  }\n\n  if (userProfileAvatarContainer) {\n    enableAvatarDragAndDrop(userProfileAvatarContainer, (file) => {\n      localReadAvatarFile(file, dataUrl => {\n        const profile = getUserProfileSnapshot();\n        assignUserProfileState({\n          name: profile.name || '',\n          avatar: dataUrl\n        });\n        persistUserProfileState();\n        announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n        if (isDialogOpen(avatarOptionsDialog)) {\n          closeAvatarOptionsDialog();\n        }\n      }, reason => {\n        if (reason === 'tooLarge') {\n          announceContactsMessage(getContactsText('avatarTooLarge', 'Choose an image under 300 KB.'));\n        } else {\n          announceContactsMessage(getContactsText('avatarReadError', 'Could not read the selected image.'));\n        }\n      });\n    });\n  }\n\n  if (contactsAddButton) {\n    contactsAddButton.addEventListener('click', () => {\n      const newContact = normalizeContactEntry({\n        id: generateContactId(),\n        name: '',\n        role: '',\n        phone: '',\n        email: '',\n        avatar: '',\n        createdAt: Date.now(),\n        updatedAt: Date.now()\n      });\n      contactsCache.push(newContact);\n      renderContactsList({ focusContactId: newContact.id });\n      saveContactsToStorage(contactsCache);\n      updateContactPickers();\n      announceContactsMessage(getContactsText('contactDraftCreated', 'New contact ready. Fill in the details.'));\n    });\n  }\n\n  if (contactsImportButton && contactsImportInput) {\n    contactsImportButton.addEventListener('click', () => contactsImportInput.click());\n    contactsImportInput.addEventListener('change', () => {\n      const [file] = contactsImportInput.files || [];\n      if (!file) return;\n      file.text()\n        .then(text => mergeImportedContacts(parseVCard(text)))\n        .catch(() => {\n          announceContactsMessage(getContactsText('importError', 'Could not import the selected file.'));\n        })\n        .finally(() => {\n          contactsImportInput.value = '';\n        });\n    });\n  }\n\n  avatarOptionsCloseButton?.addEventListener('click', () => closeAvatarOptionsDialog());\n  avatarOptionsForm?.addEventListener('submit', event => event.preventDefault());\n  avatarOptionsDialog?.addEventListener('cancel', event => {\n    event.preventDefault();\n    closeAvatarOptionsDialog();\n  });\n  avatarOptionsDialog?.addEventListener('close', handleAvatarOptionsDialogClosed);\n  avatarOptionsDialog?.addEventListener('pointerdown', handleAvatarOptionsDialogPointerDown);\n  avatarOptionsDialog?.addEventListener('pointerdown', handleAvatarOptionsDialogPointerDown);\n  // avatarOptionsDeleteButton?.addEventListener('click', handleAvatarDeleteAction); // Removed from UI\n\n  // New bindings\n  // Unified Interface Bindings\n  if (avatarEditViewport) {\n    avatarEditViewport.addEventListener('dragenter', handleAvatarDragOver);\n    avatarEditViewport.addEventListener('dragover', handleAvatarDragOver);\n    avatarEditViewport.addEventListener('dragleave', handleAvatarDragLeave);\n    avatarEditViewport.addEventListener('drop', handleAvatarDrop);\n    avatarEditViewport.addEventListener('click', () => avatarUploadInput && avatarUploadInput.click());\n\n    // Pointer events for panning\n    avatarEditViewport.addEventListener('pointerdown', handleAvatarEditPointerDown);\n    avatarEditViewport.addEventListener('pointermove', handleAvatarEditPointerMove);\n    avatarEditViewport.addEventListener('pointerup', handleAvatarEditPointerUp);\n    avatarEditViewport.addEventListener('pointercancel', handleAvatarEditPointerCancel);\n    avatarEditViewport.addEventListener('keydown', handleAvatarEditKeyDown);\n  }\n\n  avatarUploadInput?.addEventListener('change', handleAvatarUpload);\n  avatarSaveButton?.addEventListener('click', handleAvatarSave);\n  avatarCancelButton?.addEventListener('click', () => closeAvatarOptionsDialog());\n\n  avatarEditZoomInput?.addEventListener('input', handleAvatarEditZoomInputChange);\n  avatarEditZoomInput?.addEventListener('change', handleAvatarEditZoomInputChange);\n\n  contactsCloseButton?.addEventListener('click', () => closeDialog(contactsDialog));\n\n  contactsForm?.addEventListener('submit', event => {\n    event.preventDefault();\n    closeDialog(contactsDialog);\n  });\n\n  contactsDialog?.addEventListener('cancel', event => {\n    event.preventDefault();\n    closeDialog(contactsDialog);\n  });\n\n  contactsDialog?.addEventListener('click', event => {\n    if (event.target === contactsDialog) {\n      closeDialog(contactsDialog);\n    }\n  });\n\n  openContactsBtn?.addEventListener('click', event => {\n    event.preventDefault();\n    openDialog(contactsDialog);\n  });\n  if (contactsList && userProfileAvatarButton) {\n    contactsInitialized = true;\n  }\n}\n\nfunction createCrewRow(data = {}) {\n  if (!crewContainer) {\n    if (typeof document !== 'undefined') {\n      crewContainer = document.getElementById(\"crewContainer\");\n    }\n  }\n  if (!crewContainer) return;\n  const row = document.createElement('div');\n  row.className = 'person-row';\n\n  if (data.userProfileLinked) {\n    row.dataset.userProfileLinked = '1';\n  }\n\n  let documentLang = '';\n  if (typeof document !== 'undefined' && document && document.documentElement) {\n    documentLang = document.documentElement.lang || '';\n  }\n  const rowLanguage = documentLang || currentLang || DEFAULT_LANGUAGE_SAFE;\n  const rowDirection = localResolveDocumentDirection(rowLanguage);\n  localApplyLocaleMetadata(row, rowLanguage, rowDirection);\n\n  const fallbackProjectForm = (typeof texts !== 'undefined' && texts?.en?.projectForm) || {};\n  const projectFormTexts = (typeof texts !== 'undefined' && texts?.[currentLang]?.projectForm) || fallbackProjectForm;\n  const roleLabels = (typeof texts !== 'undefined' && (texts?.[currentLang]?.crewRoles || texts?.en?.crewRoles)) || {};\n\n  const crewRoleLabelText = projectFormTexts.crewRoleLabel || fallbackProjectForm.crewRoleLabel || 'Crew role';\n  const crewNameLabelText = projectFormTexts.crewNameLabel || fallbackProjectForm.crewNameLabel || 'Crew member name';\n  const crewPhoneLabelText = projectFormTexts.crewPhoneLabel || fallbackProjectForm.crewPhoneLabel || 'Crew member phone';\n  const crewEmailLabelText = projectFormTexts.crewEmailLabel || fallbackProjectForm.crewEmailLabel || 'Crew member email';\n  const crewWebsiteLabelText = projectFormTexts.crewWebsiteLabel || fallbackProjectForm.crewWebsiteLabel || 'Crew member website';\n  const crewContactLabelText = getContactsText('selectLabel', 'Saved contacts');\n  const avatarChangeLabel = getContactsText('avatarChange', 'Change photo');\n\n  const avatarDataInput = document.createElement('input');\n  avatarDataInput.type = 'hidden';\n  avatarDataInput.className = 'person-avatar-data';\n  avatarDataInput.value = typeof data.avatar === 'string' ? data.avatar : '';\n  row.appendChild(avatarDataInput);\n\n  const avatarContainer = document.createElement('div');\n  avatarContainer.className = 'person-avatar';\n  const avatarVisual = document.createElement('div');\n  avatarVisual.className = 'person-avatar-visual';\n  avatarContainer.appendChild(avatarVisual);\n  const avatarButton = document.createElement('button');\n  avatarButton.type = 'button';\n  avatarButton.setAttribute('aria-label', avatarChangeLabel);\n  avatarButton.removeAttribute('title');\n  avatarButton.removeAttribute('data-help');\n  avatarButton.innerHTML = '';\n  avatarContainer.appendChild(avatarButton);\n  const avatarFileInput = document.createElement('input');\n  avatarFileInput.type = 'file';\n  avatarFileInput.accept = 'image/*';\n  avatarFileInput.className = 'visually-hidden';\n  avatarFileInput.tabIndex = -1;\n  avatarContainer.appendChild(avatarFileInput);\n\n  enableAvatarDragAndDrop(avatarContainer, (file) => {\n    handleAvatarFileSelection(row, file);\n  });\n\n  const roleSel = document.createElement('select');\n  roleSel.name = 'crewRole';\n  roleSel.className = 'person-role-select';\n  localApplyLocaleMetadata(roleSel, rowLanguage, rowDirection);\n  crewRoles.forEach(r => {\n    const opt = document.createElement('option');\n    opt.value = r;\n    opt.textContent = roleLabels[r] || r;\n    localApplyLocaleMetadata(opt, rowLanguage, rowDirection);\n    roleSel.appendChild(opt);\n  });\n  if (data.role && !crewRoles.includes(data.role)) {\n    const opt = document.createElement('option');\n    opt.value = data.role;\n    opt.textContent = roleLabels[data.role] || data.role;\n    localApplyLocaleMetadata(opt, rowLanguage, rowDirection);\n    roleSel.appendChild(opt);\n  }\n  if (data.role) {\n    roleSel.value = data.role;\n  } else if (roleSel.options.length > 0) {\n    roleSel.selectedIndex = 0;\n  }\n\n  const nameInput = document.createElement('input');\n  nameInput.type = 'text';\n  nameInput.name = 'crewName';\n  nameInput.className = 'person-name';\n  nameInput.placeholder = projectFormTexts.crewNamePlaceholder || fallbackProjectForm.crewNamePlaceholder || 'Name';\n  nameInput.value = data.name || '';\n  localApplyLocaleMetadata(nameInput, rowLanguage, rowDirection);\n\n  const phoneInput = document.createElement('input');\n  phoneInput.type = 'tel';\n  phoneInput.name = 'crewPhone';\n  phoneInput.className = 'person-phone';\n  phoneInput.placeholder = projectFormTexts.crewPhonePlaceholder || fallbackProjectForm.crewPhonePlaceholder || 'Phone';\n  phoneInput.value = data.phone || '';\n  localApplyLocaleMetadata(phoneInput, rowLanguage, rowDirection);\n\n  const emailInput = document.createElement('input');\n  emailInput.type = 'email';\n  emailInput.name = 'crewEmail';\n  emailInput.className = 'person-email';\n  emailInput.placeholder = projectFormTexts.crewEmailPlaceholder || fallbackProjectForm.crewEmailPlaceholder || 'Email';\n  emailInput.value = data.email || '';\n  localApplyLocaleMetadata(emailInput, rowLanguage, rowDirection);\n\n  const websiteInput = document.createElement('input');\n  websiteInput.type = 'text';\n  websiteInput.inputMode = 'url';\n  websiteInput.autocomplete = 'url';\n  websiteInput.name = 'crewWebsite';\n  websiteInput.className = 'person-website';\n  websiteInput.placeholder = projectFormTexts.crewWebsitePlaceholder || fallbackProjectForm.crewWebsitePlaceholder || 'Website';\n  websiteInput.value = data.website || '';\n  localApplyLocaleMetadata(websiteInput, rowLanguage, rowDirection);\n\n  const contactSelect = document.createElement('select');\n  contactSelect.className = 'person-contact-select';\n  localApplyLocaleMetadata(contactSelect, rowLanguage, rowDirection);\n  setContactSelectOptions(contactSelect, data.contactId);\n\n  const roleLabel = createHiddenLabel(ensureElementId(roleSel, crewRoleLabelText), crewRoleLabelText);\n  const nameLabel = createHiddenLabel(ensureElementId(nameInput, crewNameLabelText), crewNameLabelText);\n  const phoneLabel = createHiddenLabel(ensureElementId(phoneInput, crewPhoneLabelText), crewPhoneLabelText);\n  const emailLabel = createHiddenLabel(ensureElementId(emailInput, crewEmailLabelText), crewEmailLabelText);\n  const websiteLabel = createHiddenLabel(ensureElementId(websiteInput, crewWebsiteLabelText), crewWebsiteLabelText);\n  const contactLabel = createHiddenLabel(ensureElementId(contactSelect, crewContactLabelText), crewContactLabelText);\n\n  const linkedBadge = document.createElement('span');\n  linkedBadge.className = 'person-linked-badge';\n  if (data.userProfileLinked) {\n    linkedBadge.textContent = getContactsText('linkedProfileBadge', 'Linked to user profile');\n    linkedBadge.hidden = false;\n  } else {\n    linkedBadge.textContent = getContactsText('linkedBadge', 'Linked to contact');\n    linkedBadge.hidden = true;\n  }\n  const saveContactBtn = document.createElement('button');\n  saveContactBtn.type = 'button';\n  saveContactBtn.className = 'person-save-contact';\n  setButtonLabelWithIconBinding(saveContactBtn, getContactsText('saveContact', 'Save to contacts'), ICON_GLYPHS.save);\n  saveContactBtn.addEventListener('click', () => saveCrewRowAsContact(row));\n\n  const manageContactsBtn = document.createElement('button');\n  manageContactsBtn.type = 'button';\n  manageContactsBtn.className = 'person-manage-contacts';\n  setButtonLabelWithIconBinding(manageContactsBtn, getContactsText('openManager', 'Open contacts'), ICON_GLYPHS.gears);\n  manageContactsBtn.addEventListener('click', () => openDialog(contactsDialog));\n\n  const removeBtn = document.createElement('button');\n  removeBtn.type = 'button';\n  removeBtn.className = 'person-remove-btn';\n  const removeBase = texts[currentLang]?.projectForm?.removeEntry\n    || texts.en?.projectForm?.removeEntry\n    || 'Remove';\n  const crewHeading = texts[currentLang]?.projectForm?.crewHeading\n    || texts.en?.projectForm?.crewHeading\n    || 'Crew';\n  const removeCrewLabel = `${removeBase} ${crewHeading} `.trim();\n  removeBtn.innerHTML = iconMarkup(ICON_GLYPHS.minus, 'btn-icon');\n  removeBtn.setAttribute('aria-label', removeCrewLabel);\n  removeBtn.setAttribute('title', removeCrewLabel);\n  removeBtn.setAttribute('data-help', removeCrewLabel);\n  removeBtn.addEventListener('click', () => {\n    row.remove();\n    if (typeof markProjectFormDataDirty === 'function') {\n      markProjectFormDataDirty();\n    }\n    scheduleProjectAutoSave();\n  });\n\n  const actions = document.createElement('div');\n  actions.className = 'person-actions';\n  actions.append(saveContactBtn, manageContactsBtn, removeBtn);\n\n  [roleLabel, nameLabel, phoneLabel, emailLabel, websiteLabel, contactLabel].forEach(label => row.appendChild(label));\n  row.appendChild(avatarContainer);\n  row.appendChild(contactSelect);\n  row.appendChild(linkedBadge);\n  row.appendChild(roleSel);\n  row.appendChild(nameInput);\n  row.appendChild(phoneInput);\n  row.appendChild(emailInput);\n  row.appendChild(websiteInput);\n  row.appendChild(actions);\n\n  if (data.contactId) {\n    row.dataset.contactId = data.contactId;\n  }\n\n  setRowAvatar(row, avatarDataInput.value, { name: data.name });\n  updateRowLinkedBadge(row);\n\n  avatarButton.addEventListener('click', () => {\n    if (!avatarDataInput.value && avatarFileInput && typeof avatarFileInput.click === 'function') {\n      try {\n        avatarFileInput.click();\n        return;\n      } catch (error) {\n        void error;\n      }\n    }\n    openAvatarOptionsDialog({\n      getAvatar: () => avatarDataInput.value || '',\n      getName: () => nameInput.value || '',\n      onDelete: () => {\n        if (!avatarDataInput.value) return;\n        setRowAvatar(row, '');\n        handleCrewRowManualChange(row);\n        announceContactsMessage(getContactsText('avatarCleared', 'Profile photo removed.'));\n      },\n      onChange: () => {\n        if (avatarFileInput && typeof avatarFileInput.click === 'function') {\n          try {\n            avatarFileInput.click();\n          } catch (error) {\n            void error;\n          }\n        }\n      },\n      onEditSave: dataUrl => {\n        if (!dataUrl) return;\n        setRowAvatar(row, dataUrl, { name: nameInput.value });\n        if (row.dataset.contactId) {\n          detachCrewRowContact(row);\n        }\n        handleCrewRowManualChange(row);\n        announceContactsMessage(getContactsText('avatarUpdated', 'Profile photo updated.'));\n      }\n    });\n  });\n\n  avatarFileInput.addEventListener('change', () => {\n    const [file] = avatarFileInput.files || [];\n    if (file) {\n      handleAvatarFileSelection(row, file);\n    }\n    avatarFileInput.value = '';\n  });\n\n  roleSel.addEventListener('change', () => handleCrewRowManualChange(row, false));\n  nameInput.addEventListener('input', () => {\n    refreshRowAvatarInitial(row);\n    // handleCrewRowManualChange(row, false); // Covered by form level listener\n  });\n  // phoneInput/emailInput/websiteInput listeners removed, covered by form level listener\n\n  contactSelect.addEventListener('change', () => {\n    const selectedId = contactSelect.value;\n    if (!selectedId) {\n      detachCrewRowContact(row, { preserveSelect: true });\n      handleCrewRowManualChange(row);\n      return;\n    }\n    const contact = getContactById(selectedId);\n    if (contact) {\n      applyContactToCrewRow(row, contact);\n    } else {\n      announceContactsMessage(getContactsText('contactMissingDetails', 'Saved contact not available.'));\n      detachCrewRowContact(row, { preserveSelect: true });\n    }\n  });\n\n  crewContainer.appendChild(row);\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n}\n\nif (typeof window !== 'undefined') {\n  window.createCrewRow = createCrewRow;\n  window.createPrepRow = createPrepRow;\n  window.createShootRow = createShootRow;\n  window.createReturnRow = createReturnRow;\n}\n\nfunction createPrepRow(data = {}) {\n  if (!prepContainer) return;\n  const row = document.createElement('div');\n  row.className = 'period-row';\n  const start = document.createElement('input');\n  start.type = 'date';\n  start.name = 'prepStart';\n  start.className = 'prep-start';\n  start.value = data.start || '';\n  start.setAttribute('aria-labelledby', 'prepLabel');\n  const span = document.createElement('span');\n  span.textContent = 'to';\n  const end = document.createElement('input');\n  end.type = 'date';\n  end.name = 'prepEnd';\n  end.className = 'prep-end';\n  end.value = data.end || '';\n  end.setAttribute('aria-labelledby', 'prepLabel');\n  const removeBtn = document.createElement('button');\n  removeBtn.type = 'button';\n  const removeBase = texts[currentLang]?.projectForm?.removeEntry\n    || texts.en?.projectForm?.removeEntry\n    || 'Remove';\n  const prepLabelText = texts[currentLang]?.projectForm?.prepLabel || texts.en?.projectForm?.prepLabel || 'Prep';\n  const removePrepLabel = `${removeBase} ${prepLabelText} `.trim();\n  removeBtn.innerHTML = iconMarkup(ICON_GLYPHS.minus, 'btn-icon');\n  removeBtn.setAttribute('aria-label', removePrepLabel);\n  removeBtn.setAttribute('title', removePrepLabel);\n  removeBtn.setAttribute('data-help', removePrepLabel);\n  removeBtn.addEventListener('click', () => {\n    row.remove();\n    if (typeof markProjectFormDataDirty === 'function') {\n      markProjectFormDataDirty();\n    }\n    scheduleProjectAutoSave();\n  });\n  row.append(start, span, end, removeBtn);\n  prepContainer.appendChild(row);\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n}\n\nfunction createShootRow(data = {}) {\n  if (!shootContainer) return;\n  const row = document.createElement('div');\n  row.className = 'period-row';\n  const start = document.createElement('input');\n  start.type = 'date';\n  start.name = 'shootStart';\n  start.className = 'shoot-start';\n  start.value = data.start || '';\n  start.setAttribute('aria-labelledby', 'shootLabel');\n  const span = document.createElement('span');\n  span.textContent = 'to';\n  const end = document.createElement('input');\n  end.type = 'date';\n  end.name = 'shootEnd';\n  end.className = 'shoot-end';\n  end.value = data.end || '';\n  end.setAttribute('aria-labelledby', 'shootLabel');\n  const removeBtn = document.createElement('button');\n  removeBtn.type = 'button';\n  const removeBase = texts[currentLang]?.projectForm?.removeEntry\n    || texts.en?.projectForm?.removeEntry\n    || 'Remove';\n  const shootLabelText = texts[currentLang]?.projectForm?.shootLabel || texts.en?.projectForm?.shootLabel || 'Shoot';\n  const removeShootLabel = `${removeBase} ${shootLabelText} `.trim();\n  removeBtn.innerHTML = iconMarkup(ICON_GLYPHS.minus, 'btn-icon');\n  removeBtn.setAttribute('aria-label', removeShootLabel);\n  removeBtn.setAttribute('title', removeShootLabel);\n  removeBtn.setAttribute('data-help', removeShootLabel);\n  removeBtn.addEventListener('click', () => {\n    row.remove();\n    if (typeof markProjectFormDataDirty === 'function') {\n      markProjectFormDataDirty();\n    }\n    scheduleProjectAutoSave();\n  });\n  row.append(start, span, end, removeBtn);\n  shootContainer.appendChild(row);\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n}\n\nfunction createReturnRow(data = {}) {\n  if (!returnContainer) return;\n  const row = document.createElement('div');\n  row.className = 'period-row';\n  const start = document.createElement('input');\n  start.type = 'date';\n  start.name = 'returnStart';\n  start.className = 'return-start';\n  start.value = data.start || '';\n  start.setAttribute('aria-labelledby', 'returnLabel');\n  const span = document.createElement('span');\n  span.textContent = 'to';\n  const end = document.createElement('input');\n  end.type = 'date';\n  end.name = 'returnEnd';\n  end.className = 'return-end';\n  end.value = data.end || '';\n  end.setAttribute('aria-labelledby', 'returnLabel');\n  const removeBtn = document.createElement('button');\n  removeBtn.type = 'button';\n  const removeBase = texts[currentLang]?.projectForm?.removeEntry\n    || texts.en?.projectForm?.removeEntry\n    || 'Remove';\n  const returnLabelText = texts[currentLang]?.projectForm?.returnLabel\n    || texts.en?.projectForm?.returnLabel\n    || 'Return Day';\n  const removeReturnLabel = `${removeBase} ${returnLabelText} `.trim();\n  removeBtn.innerHTML = iconMarkup(ICON_GLYPHS.minus, 'btn-icon');\n  removeBtn.setAttribute('aria-label', removeReturnLabel);\n  removeBtn.setAttribute('title', removeReturnLabel);\n  removeBtn.setAttribute('data-help', removeReturnLabel);\n  removeBtn.addEventListener('click', () => {\n    row.remove();\n    if (typeof markProjectFormDataDirty === 'function') {\n      markProjectFormDataDirty();\n    }\n    scheduleProjectAutoSave();\n  });\n  row.append(start, span, end, removeBtn);\n  returnContainer.appendChild(row);\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n}\n\nfunction formatCapacity(value, unit) {\n  const num = Number(value);\n  if (!Number.isFinite(num) || num <= 0) return '';\n  const formatted = Number.isInteger(num)\n    ? String(num)\n    : num.toLocaleString(undefined, { maximumFractionDigits: 2, minimumFractionDigits: 0 });\n  return `${formatted} ${unit} `;\n}\n\nfunction gatherMediaEntriesForType(type) {\n  const entries = [];\n  if (!type) return entries;\n  const cameraDb = devices?.cameras || {};\n  const selectedName = typeof cameraSelect?.value === 'string' ? cameraSelect.value : '';\n  const addEntries = cam => {\n    if (!cam || !Array.isArray(cam.recordingMedia)) return;\n    cam.recordingMedia.forEach(media => {\n      if (media && media.type === type) {\n        entries.push(media);\n      }\n    });\n  };\n  if (selectedName && cameraDb[selectedName]) {\n    addEntries(cameraDb[selectedName]);\n  }\n  Object.keys(cameraDb).forEach(name => {\n    if (name === selectedName) return;\n    addEntries(cameraDb[name]);\n  });\n  return entries;\n}\n\nfunction getAvailableStorageMediaTypes() {\n  const cameraDb = devices?.cameras || {};\n  const mediaDb = devices?.gearList?.media || {};\n  const typeOrder = [];\n  const normalizedTypes = new Set();\n\n  const addType = value => {\n    if (!value || typeof value !== 'string') return;\n    const trimmed = value.trim();\n    if (!trimmed) return;\n    const normalized = trimmed.toLowerCase();\n    if (normalizedTypes.has(normalized)) return;\n    normalizedTypes.add(normalized);\n    typeOrder.push(trimmed);\n  };\n\n  const selectedName = typeof cameraSelect?.value === 'string' ? cameraSelect.value : '';\n\n  // If a camera is selected, strictly limit to its supported media types\n  if (selectedName && cameraDb[selectedName]) {\n    const cam = cameraDb[selectedName];\n    (cam.recordingMedia || []).forEach(media => {\n      if (media && media.type) {\n        addType(media.type);\n      }\n    });\n    return typeOrder;\n  }\n\n  // Otherwise, gather all known types from cameras and gearList\n  const addCameraTypes = cam => {\n    if (!cam) return;\n    (cam.recordingMedia || []).forEach(media => {\n      if (media && media.type) {\n        addType(media.type);\n      }\n    });\n  };\n\n  Object.values(cameraDb).forEach(cam => addCameraTypes(cam));\n\n  // Helper to traverse nested mediaDb\n  const traverseMedia = (obj) => {\n    Object.values(obj).forEach(info => {\n      if (!info) return;\n      // Heuristic: if it has brand/model/type, it's an item. Else if object, recurse.\n      if (info.brand || info.model || info.type || info.capacityGB || info.capacity) {\n        if (info.type) addType(info.type);\n        const interfaceStr = typeof info.interface === 'string' ? info.interface.trim() : '';\n        if (interfaceStr) {\n          addType(interfaceStr);\n        }\n        if (Array.isArray(info.supportedMedia)) {\n          info.supportedMedia.forEach(mediaType => addType(mediaType));\n        }\n      } else if (typeof info === 'object') {\n        traverseMedia(info);\n      }\n    });\n  };\n  traverseMedia(mediaDb);\n\n  return typeOrder.sort(localeSort);\n}\n\nfunction getStorageVariantOptions(type) {\n  const variants = [];\n  if (!type) return variants;\n  const normalizedType = type.toLowerCase();\n\n  // Gather flattened items\n  const items = [];\n  const mediaDb = devices?.gearList?.media || {};\n  const traverse = (obj) => {\n    Object.entries(obj).forEach(([key, value]) => {\n      if (!value) return;\n      if (value.brand || value.model || value.type || value.capacityGB || value.capacity) {\n        items.push({ id: key, ...value });\n      } else if (typeof value === 'object') {\n        traverse(value);\n      }\n    });\n  };\n  traverse(mediaDb);\n\n  const seen = new Set();\n  const addVariant = (value, label) => {\n    if (!value || seen.has(value)) return;\n    const lowerLabel = (label || value).toLowerCase();\n    if (\n      lowerLabel.includes('dual slots') ||\n      lowerLabel.includes('slot 1') ||\n      lowerLabel === 'adapter' ||\n      lowerLabel.includes('via adapter') ||\n      lowerLabel === 'red pro'\n    ) {\n      return;\n    }\n\n    // Heuristic: Require at least one digit (e.g. \"64GB\", \"2.0\", \"1TB\") to ensure\n    // we don't show bare brand names like \"SanDisk\" without a size.\n    if (!/\\d/.test(lowerLabel)) {\n      return;\n    }\n\n    variants.push({ value, label: label || value });\n    seen.add(value);\n  };\n\n  items.forEach(info => {\n    // strict match on type property if available, otherwise fallback to loose string matching\n    let matches = false;\n    if (info.type) {\n      matches = info.type.toLowerCase() === normalizedType;\n    }\n    // Fallback or loose match if type property is missing or for wider search coverage\n    if (!matches) {\n      const fields = [info.id, info.model, info.interface];\n      matches = fields.some(field => typeof field === 'string' && field.toLowerCase().includes(normalizedType));\n    }\n\n    if (!matches) return;\n\n    const parts = [];\n    if (info.brand) parts.push(info.brand);\n    const model = info.model || '';\n    if (model && (!info.brand || model.toLowerCase() !== info.brand.toLowerCase())) {\n      parts.push(model);\n    }\n    const capacityGb = Number(info.capacityGB || info.capacity);\n    const capacityTb = Number(info.capacityTb);\n    let capacityLabel = '';\n    if (Number.isFinite(capacityGb) && capacityGb > 0) {\n      if (capacityGb >= 1000) {\n        capacityLabel = formatCapacity(capacityGb / 1000, 'TB');\n      } else {\n        capacityLabel = formatCapacity(capacityGb, 'GB');\n      }\n    } else if (Number.isFinite(capacityTb) && capacityTb > 0) {\n      capacityLabel = formatCapacity(capacityTb, 'TB');\n    }\n    if (capacityLabel) parts.push(capacityLabel);\n\n    // Use the ID (key) as the value for uniqueness and persistence, label for display\n    addVariant(info.id, parts.length ? parts.join('  ') : info.id);\n  });\n\n  const noteVariants = new Set();\n  gatherMediaEntriesForType(type).forEach(media => {\n    const notes = typeof media?.notes === 'string' ? media.notes : '';\n    if (!notes) return;\n    notes.split(/[,;/]/).forEach(part => {\n      const trimmed = part.trim();\n      if (trimmed) noteVariants.add(trimmed);\n    });\n  });\n  noteVariants.forEach(note => {\n    // Only add note variants if they don't look like duplicates of existing real items?\n    // For now, keep them as \"Generic Type Note\"\n    const value = `${type} ${note} `.trim();\n    addVariant(value, note);\n  });\n\n  if (!variants.length) {\n    addVariant(type, type);\n  }\n\n  return variants.sort((a, b) => localeSort(a.label, b.label));\n}\n\nfunction updateStorageVariantOptions(select, type, selectedValue) {\n  if (!select) return;\n  const options = getStorageVariantOptions(type);\n  const placeholder = getProjectFormText('storageVariantPlaceholder', 'Select brand & size');\n  const previous = selectedValue !== undefined ? selectedValue : select.value;\n  select.innerHTML = '';\n  const blank = document.createElement('option');\n  blank.value = '';\n  blank.textContent = placeholder;\n  select.appendChild(blank);\n  options.forEach(opt => {\n    const option = document.createElement('option');\n    option.value = opt.value;\n    option.textContent = opt.label;\n    select.appendChild(option);\n  });\n  if (previous) {\n    const hasMatch = select.options && Array.from(select.options).some(opt => opt.value === previous);\n    if (!hasMatch) {\n      const fallback = document.createElement('option');\n      fallback.value = previous;\n      fallback.textContent = previous;\n      fallback.dataset.extraOption = 'true';\n      select.appendChild(fallback);\n    }\n    select.value = previous;\n  } else {\n    select.value = '';\n  }\n}\n\nfunction updateStorageRequirementTypeOptions() {\n  if (!storageNeedsContainer) return;\n  const types = getAvailableStorageMediaTypes();\n  const placeholder = getProjectFormText('storageTypePlaceholder', 'Select media type');\n  Array.from(storageNeedsContainer.querySelectorAll('.storage-row')).forEach(row => {\n    const typeSelect = row.querySelector('.storage-type');\n    const variantSelect = row.querySelector('.storage-variant');\n    if (!typeSelect) return;\n    const previous = typeSelect.value;\n    const previousVariant = variantSelect ? variantSelect.value : '';\n    typeSelect.innerHTML = '';\n    const blank = document.createElement('option');\n    blank.value = '';\n    blank.textContent = placeholder;\n    typeSelect.appendChild(blank);\n    types.forEach(typeOption => {\n      const option = document.createElement('option');\n      option.value = typeOption;\n      option.textContent = typeOption;\n      typeSelect.appendChild(option);\n    });\n    if (previous) {\n      const hasMatch = types.includes(previous);\n      if (!hasMatch) {\n        const fallback = document.createElement('option');\n        fallback.value = previous;\n        fallback.textContent = previous;\n        fallback.dataset.extraOption = 'true';\n        typeSelect.appendChild(fallback);\n      }\n      typeSelect.value = previous;\n    } else {\n      typeSelect.value = '';\n    }\n    updateStorageVariantOptions(variantSelect, typeSelect.value, previousVariant);\n  });\n}\nif (typeof window !== 'undefined') {\n  window.getAvailableStorageMediaTypes = getAvailableStorageMediaTypes;\n  window.getStorageVariantOptions = getStorageVariantOptions;\n  window.updateStorageRequirementTypeOptions = updateStorageRequirementTypeOptions;\n  window.createStorageRequirementRow = createStorageRequirementRow;\n}\n\nfunction createStorageRequirementRow(data = {}) {\n  if (!storageNeedsContainer) return null;\n  const row = document.createElement('div');\n  row.className = 'storage-row form-row';\n\n  const quantityInput = document.createElement('input');\n  quantityInput.type = 'number';\n  quantityInput.min = '1';\n  quantityInput.step = '1';\n  quantityInput.name = 'storageQuantity';\n  quantityInput.className = 'storage-quantity';\n  const quantityValue = Number(data.quantity);\n  if (Number.isFinite(quantityValue) && quantityValue > 0) {\n    quantityInput.value = quantityValue;\n  }\n  const quantityLabelText = getProjectFormText('storageQuantityLabel', 'Quantity');\n  const quantityId = ensureElementId(quantityInput, quantityLabelText);\n  const quantityLabel = document.createElement('label');\n  quantityLabel.className = 'form-row-label storage-quantity-label';\n  quantityLabel.setAttribute('for', quantityId);\n  quantityLabel.textContent = quantityLabelText;\n  quantityLabel.dataset.storageLabelKey = 'storageQuantityLabel';\n  // quantityInput listeners removed, covered by form level listener\n  // variantSelect listeners removed, covered by form level listener\n  // notesInput listeners removed, covered by form level listener\n\n  const typeSelect = document.createElement('select');\n  typeSelect.name = 'storageMediaType';\n  typeSelect.className = 'storage-type';\n  typeSelect.value = typeof data.type === 'string' ? data.type : '';\n  const typeLabelText = getProjectFormText('storageTypeLabel', 'Media type');\n  const typeLabel = createHiddenLabel(ensureElementId(typeSelect, typeLabelText), typeLabelText);\n  typeLabel.dataset.storageLabelKey = 'storageTypeLabel';\n\n  const variantSelect = document.createElement('select');\n  variantSelect.name = 'storageMediaVariant';\n  variantSelect.className = 'storage-variant';\n  variantSelect.value = typeof data.variant === 'string' ? data.variant : '';\n  const variantLabelText = getProjectFormText('storageVariantLabel', 'Brand & capacity');\n  const variantLabel = createHiddenLabel(ensureElementId(variantSelect, variantLabelText), variantLabelText);\n  variantLabel.dataset.storageLabelKey = 'storageVariantLabel';\n\n  const notesInput = document.createElement('input');\n  notesInput.type = 'text';\n  notesInput.name = 'storageMediaNotes';\n  notesInput.className = 'storage-notes';\n  notesInput.value = typeof data.notes === 'string' ? data.notes : '';\n  notesInput.placeholder = getProjectFormText('storageNotesPlaceholder', '');\n  const notesLabelText = getProjectFormText('storageNotesLabel', 'Notes');\n  const notesLabel = createHiddenLabel(ensureElementId(notesInput, notesLabelText), notesLabelText);\n  notesLabel.dataset.storageLabelKey = 'storageNotesLabel';\n\n  typeSelect.addEventListener('change', () => {\n    updateStorageVariantOptions(variantSelect, typeSelect.value);\n    scheduleProjectAutoSave();\n  });\n\n  const removeBtn = document.createElement('button');\n  removeBtn.type = 'button';\n  const removeBase = getProjectFormText('removeEntry', 'Remove');\n  const storageLabel = getProjectFormText('storageNeedsLabel', 'Recording media needs');\n  const removeLabel = `${removeBase} ${storageLabel} `.trim();\n  removeBtn.innerHTML = iconMarkup(ICON_GLYPHS.minus, 'btn-icon');\n  removeBtn.setAttribute('aria-label', removeLabel);\n  removeBtn.setAttribute('title', removeLabel);\n  removeBtn.setAttribute('data-help', removeLabel);\n  removeBtn.dataset.storageActionKey = 'storageRemoveEntry';\n  removeBtn.addEventListener('click', () => {\n    row.remove();\n    if (!storageNeedsContainer.querySelector('.storage-row')) {\n      createStorageRequirementRow();\n    } else {\n      updateStorageRequirementTypeOptions();\n    }\n    if (typeof markProjectFormDataDirty === 'function') {\n      markProjectFormDataDirty();\n    }\n    scheduleProjectAutoSave();\n  });\n\n  const duplicateBtn = document.createElement('button');\n  duplicateBtn.type = 'button';\n  duplicateBtn.className = 'storage-duplicate-btn';\n  duplicateBtn.innerHTML = iconMarkup(ICON_GLYPHS.add, 'btn-icon');\n  duplicateBtn.dataset.storageActionKey = 'storageDuplicateEntry';\n  const duplicateLabel = getProjectFormText('storageDuplicateEntry', 'Duplicate media row');\n  duplicateBtn.setAttribute('aria-label', duplicateLabel);\n  duplicateBtn.setAttribute('title', duplicateLabel);\n  duplicateBtn.setAttribute('data-help', duplicateLabel);\n  duplicateBtn.addEventListener('click', () => {\n    const entry = {\n      quantity: quantityInput ? quantityInput.value : '',\n      type: typeSelect ? typeSelect.value : '',\n      variant: variantSelect ? variantSelect.value : '',\n      notes: notesInput ? notesInput.value : ''\n    };\n    const newRow = createStorageRequirementRow(entry);\n    if (newRow && typeof storageNeedsContainer?.insertBefore === 'function') {\n      storageNeedsContainer.insertBefore(newRow, row.nextSibling);\n      const focusField = newRow.querySelector('.storage-quantity');\n      if (focusField) {\n        focusField.focus();\n        if (typeof focusField.select === 'function') {\n          focusField.select();\n        }\n      }\n    }\n    scheduleProjectAutoSave();\n  });\n\n  const actionContainer = document.createElement('div');\n  actionContainer.className = 'storage-row-actions';\n  actionContainer.append(duplicateBtn, removeBtn);\n\n  row.append(\n    quantityLabel,\n    quantityInput,\n    typeLabel,\n    typeSelect,\n    variantLabel,\n    variantSelect,\n    notesLabel,\n    notesInput,\n    actionContainer\n  );\n\n  storageNeedsContainer.appendChild(row);\n  updateStorageRequirementTypeOptions();\n  if (typeof markProjectFormDataDirty === 'function') {\n    markProjectFormDataDirty();\n  }\n  return row;\n}\n\n\nfunction updateRequiredScenariosTranslations(lang) {\n  const select = document.getElementById(\"requiredScenarios\");\n  if (!select) return;\n  const currentTexts = texts[lang] || {};\n  const scenarios = currentTexts.scenarios || {};\n  const fallback = texts.en && texts.en.scenarios ? texts.en.scenarios : {};\n\n  if (select.options) {\n    Array.from(select.options).forEach(option => {\n      const key = option.value;\n      const translated = scenarios[key] || fallback[key] || option.value;\n      option.textContent = translated;\n    });\n  }\n}\n\nfunction updateStorageRequirementTranslations(projectFormTexts, fallbackProjectForm) {\n  const headingText = projectFormTexts.storageHeading\n    || fallbackProjectForm.storageHeading\n    || 'Storage & Media';\n  if (storageHeading) storageHeading.textContent = headingText;\n\n  const labelText = projectFormTexts.storageNeedsLabel\n    || fallbackProjectForm.storageNeedsLabel\n    || 'Recording media needs:';\n  if (storageNeedsLabel) storageNeedsLabel.textContent = labelText;\n\n  const updateLabel = key => {\n    const text = projectFormTexts[key] || fallbackProjectForm[key];\n    if (!text) return;\n    document.querySelectorAll(`#storageNeedsContainer [data-storage-label-key=\"${key}\"]`).forEach(label => {\n      label.textContent = text;\n    });\n  };\n  ['storageQuantityLabel', 'storageTypeLabel', 'storageVariantLabel', 'storageNotesLabel'].forEach(updateLabel);\n\n  const typePlaceholder = projectFormTexts.storageTypePlaceholder\n    || fallbackProjectForm.storageTypePlaceholder\n    || 'Select media type';\n  const variantPlaceholder = projectFormTexts.storageVariantPlaceholder\n    || fallbackProjectForm.storageVariantPlaceholder\n    || 'Select brand & size';\n  const notesPlaceholder = projectFormTexts.storageNotesPlaceholder\n    || fallbackProjectForm.storageNotesPlaceholder\n    || '';\n\n  const duplicateActionLabel = projectFormTexts.storageDuplicateEntry\n    || fallbackProjectForm.storageDuplicateEntry\n    || 'Duplicate media row';\n  const removeBase = projectFormTexts.removeEntry\n    || fallbackProjectForm.removeEntry\n    || 'Remove';\n\n  document.querySelectorAll('#storageNeedsContainer .storage-type').forEach(select => {\n    if (!select.options) return;\n    const firstOption = select.options[0];\n    if (firstOption) firstOption.textContent = typePlaceholder;\n  });\n  document.querySelectorAll('#storageNeedsContainer .storage-variant').forEach(select => {\n    if (!select.options) return;\n    const firstOption = select.options[0];\n    if (firstOption) firstOption.textContent = variantPlaceholder;\n  });\n  document.querySelectorAll('#storageNeedsContainer .storage-notes').forEach(input => {\n    input.placeholder = notesPlaceholder;\n  });\n  document.querySelectorAll('#storageNeedsContainer [data-storage-action-key=\"storageDuplicateEntry\"]').forEach(button => {\n    button.setAttribute('aria-label', duplicateActionLabel);\n    button.setAttribute('title', duplicateActionLabel);\n    button.setAttribute('data-help', duplicateActionLabel);\n  });\n  const storageRemoveLabel = `${removeBase} ${labelText} `.trim();\n  document.querySelectorAll('#storageNeedsContainer [data-storage-action-key=\"storageRemoveEntry\"]').forEach(button => {\n    button.setAttribute('aria-label', storageRemoveLabel);\n    button.setAttribute('title', storageRemoveLabel);\n    button.setAttribute('data-help', storageRemoveLabel);\n  });\n}\n\n\nif (addPersonBtn) {\n  addPersonBtn.addEventListener('click', () => {\n    createCrewRow();\n  });\n}\nif (addPrepBtn) {\n  addPrepBtn.addEventListener('click', () => createPrepRow());\n}\nif (addShootBtn) {\n  addShootBtn.addEventListener('click', () => createShootRow());\n}\nif (addReturnBtn) {\n  addReturnBtn.addEventListener('click', () => createReturnRow());\n}\nfunction updateTripodOptions() {\n  const headBrand = tripodHeadBrandSelect ? tripodHeadBrandSelect.value : '';\n  const bowl = tripodBowlSelect ? tripodBowlSelect.value : '';\n  const headOpts = (tripodHeadBrandSelect && tripodHeadBrandSelect.options) ? Array.from(tripodHeadBrandSelect.options) : [];\n  const bowlOpts = (tripodBowlSelect && tripodBowlSelect.options) ? Array.from(tripodBowlSelect.options) : [];\n  headOpts.forEach(o => { o.hidden = false; });\n  bowlOpts.forEach(o => { o.hidden = false; });\n  if (headBrand === 'OConnor') {\n    const opt = bowlOpts.find(o => o.value === '75mm bowl');\n    if (opt) opt.hidden = true;\n    if (tripodBowlSelect.value === '75mm bowl') tripodBowlSelect.value = '';\n  }\n  if (headBrand === 'Sachtler') {\n    const opt = bowlOpts.find(o => o.value === 'Mitchell Mount');\n    if (opt) opt.hidden = true;\n    if (tripodBowlSelect.value === 'Mitchell Mount') tripodBowlSelect.value = '';\n  }\n  if (bowl === '75mm bowl') {\n    const opt = headOpts.find(o => o.value === 'OConnor');\n    if (opt) opt.hidden = true;\n    if (tripodHeadBrandSelect.value === 'OConnor') tripodHeadBrandSelect.value = '';\n  }\n  if (bowl === 'Mitchell Mount') {\n    const opt = headOpts.find(o => o.value === 'Sachtler');\n    if (opt) opt.hidden = true;\n    if (tripodHeadBrandSelect.value === 'Sachtler') tripodHeadBrandSelect.value = '';\n  }\n}\nif (typeof window !== 'undefined') window.updateTripodOptions = updateTripodOptions;\n\nvar totalPowerElem = document.getElementById(\"totalPower\") || document.getElementById(\"heroTotalDraw\");\nvar totalCurrent144Elem = document.getElementById(\"totalCurrent144\") || document.getElementById(\"heroCurrent144\");\nvar totalCurrent12Elem = document.getElementById(\"totalCurrent12\") || document.getElementById(\"heroCurrent12\");\nvar batteryLifeElem = document.getElementById(\"batteryLife\") || document.getElementById(\"heroRuntime\");\nvar batteryLifeLabelElem = document.getElementById(\"batteryLifeLabel\");\nvar runtimeAverageNoteElem = document.getElementById(\"runtimeAverageNote\");\nvar batteryCountElem = document.getElementById(\"batteryCount\") || document.getElementById(\"heroBatteryCount\");\nvar pinWarnElem = document.getElementById(\"pinWarning\");\nvar dtapWarnElem = document.getElementById(\"dtapWarning\");\nvar hotswapWarnElem = document.getElementById(\"hotswapWarning\");\nvar powerWarningDialog = document.getElementById(\"powerWarningDialog\");\nvar powerWarningTitleElem = document.getElementById(\"powerWarningTitle\");\nvar powerWarningMessageElem = document.getElementById(\"powerWarningMessage\");\nvar powerWarningLimitsHeadingElem = document.getElementById(\"powerWarningLimitsHeading\");\nvar powerWarningPinsDetailElem = document.getElementById(\"powerWarningPinsDetail\");\nvar powerWarningDtapDetailElem = document.getElementById(\"powerWarningDtapDetail\");\nvar powerWarningAdviceElem = document.getElementById(\"powerWarningAdvice\");\nvar powerWarningCloseBtn = document.getElementById(\"powerWarningCloseBtn\");\nvar heroCard = document.getElementById(\"heroCard\");\nvar heroTotalDraw = document.getElementById(\"heroTotalDraw\");\nvar heroAvailablePower = document.getElementById(\"heroAvailablePower\");\nvar heroBatteryLabel = document.getElementById(\"heroBatteryLabel\");\nvar heroRuntime = document.getElementById(\"heroRuntime\");\nvar heroCurrent144 = document.getElementById(\"heroCurrent144\");\nvar heroCurrent12 = document.getElementById(\"heroCurrent12\");\nvar heroBatteryCount = document.getElementById(\"heroBatteryCount\");\n\nvar powerDiagramElem = document.getElementById(\"powerDiagram\");\nvar powerDiagramBarElem = document.getElementById(\"powerDiagramBar\");\nvar maxPowerTextElem = document.getElementById(\"maxPowerText\");\nvar powerDiagramLegendElem = document.getElementById(\"powerDiagramLegend\");\n\nlet currentPowerWarningKey = '';\nlet dismissedPowerWarningKey = '';\n\nfunction updatePowerSummary() {\n  // Placeholder to prevent ReferenceError\n  // This function is intended to update the plain text summary of power usage.\n  // Currently implemented as a no-op to resolve the runtime error.\n}\n\nfunction closePowerWarningDialog(options = {}) {\n  if (!powerWarningDialog) return;\n  if (isDialogOpen(powerWarningDialog)) {\n    closeDialog(powerWarningDialog);\n  } else if (powerWarningDialog.removeAttribute) {\n    powerWarningDialog.removeAttribute('open');\n  }\n  currentPowerWarningKey = '';\n  if (!options.keepDismissed) {\n    dismissedPowerWarningKey = '';\n  }\n}\n\nfunction dismissPowerWarningDialog() {\n  if (!powerWarningDialog) return;\n  if (currentPowerWarningKey) {\n    dismissedPowerWarningKey = currentPowerWarningKey;\n  }\n  closePowerWarningDialog({ keepDismissed: true });\n}\n\nfunction showPowerWarningDialog(context) {\n  if (!powerWarningDialog) return;\n  const {\n    batteryName,\n    current,\n    hasPinLimit,\n    pinLimit,\n    hasDtapRating,\n    dtapLimit,\n    dtapAllowed,\n  } = context || {};\n\n  const safeBatteryName = batteryName && batteryName.trim() ? batteryName.trim() : (batterySelect?.value || '');\n  const formattedCurrent = formatCurrentValue(Number(current) || 0);\n  const langTexts = texts[currentLang] || texts.en || {};\n  const messageTemplate = langTexts.powerWarningMessage || texts.en?.powerWarningMessage || '';\n  const message = messageTemplate\n    ? messageTemplate\n      .replace(/\\{battery\\}/g, safeBatteryName)\n      .replace(/\\{current\\}/g, formattedCurrent)\n    : `${safeBatteryName} exceeds every available output(${formattedCurrent}A).`;\n  if (powerWarningMessageElem) {\n    powerWarningMessageElem.textContent = message;\n  }\n\n  const pinsDetail = hasPinLimit\n    ? (langTexts.powerWarningPinsDetail || texts.en?.powerWarningPinsDetail || 'Pins limit: {max}A')\n      .replace(/\\{max\\}/g, formatCurrentValue(Number(pinLimit) || 0))\n    : (langTexts.powerWarningPinsUnavailable || texts.en?.powerWarningPinsUnavailable || 'Pins limit unavailable.');\n  if (powerWarningPinsDetailElem) {\n    powerWarningPinsDetailElem.textContent = pinsDetail;\n  }\n\n  let dtapDetail = '';\n  if (hasDtapRating && dtapAllowed) {\n    dtapDetail = (langTexts.powerWarningDtapDetail || texts.en?.powerWarningDtapDetail || 'D-Tap limit: {max}A')\n      .replace(/\\{max\\}/g, formatCurrentValue(Number(dtapLimit) || 0));\n  } else if (hasDtapRating && !dtapAllowed) {\n    dtapDetail = langTexts.powerWarningDtapBlocked || texts.en?.powerWarningDtapBlocked || 'D-Tap cannot be used with the current configuration.';\n  } else {\n    dtapDetail = langTexts.powerWarningDtapUnavailable || texts.en?.powerWarningDtapUnavailable || 'No D-Tap output is available.';\n  }\n  if (powerWarningDtapDetailElem) {\n    powerWarningDtapDetailElem.textContent = dtapDetail;\n  }\n\n  const keyParts = [\n    safeBatteryName,\n    formattedCurrent,\n    hasPinLimit ? formatCurrentValue(Number(pinLimit) || 0) : 'no-pin',\n    hasDtapRating ? formatCurrentValue(Number(dtapLimit) || 0) : 'no-dtap',\n    dtapAllowed ? 'dtap-allowed' : 'dtap-blocked'\n  ];\n  const nextKey = keyParts.join('|');\n\n  if (dismissedPowerWarningKey && dismissedPowerWarningKey !== nextKey) {\n    dismissedPowerWarningKey = '';\n  }\n\n  currentPowerWarningKey = nextKey;\n\n  if (dismissedPowerWarningKey === nextKey) {\n    return;\n  }\n\n  if (!isDialogOpen(powerWarningDialog)) {\n    openDialog(powerWarningDialog);\n  }\n}\n\nif (powerWarningCloseBtn) {\n  powerWarningCloseBtn.addEventListener('click', dismissPowerWarningDialog);\n}\nif (powerWarningDialog) {\n  powerWarningDialog.addEventListener('cancel', event => {\n    event.preventDefault();\n    dismissPowerWarningDialog();\n  });\n}\n\nfunction drawPowerDiagram(availableWatt, segments, maxPinA) {\n  // [Added by Agent] Calculate total immediately to support V2 stats sync\n  const total = (segments || []).reduce((sum, s) => sum + s.power, 0);\n\n  // [Added by Agent] Update total draw text immediately so V2 observer picks it up\n  if (heroTotalDraw) {\n    heroTotalDraw.textContent = `${total.toFixed(0)} W`;\n  }\n\n  // 1. Handle Hero Card Visibility\n  if (!heroCard) return;\n\n  if (!availableWatt || availableWatt <= 0) {\n    heroCard.classList.add(\"hidden\");\n    if (powerDiagramElem) powerDiagramElem.classList.add(\"hidden\");\n    if (powerDiagramBarElem) powerDiagramBarElem.innerHTML = \"\";\n    if (powerDiagramLegendElem) powerDiagramLegendElem.innerHTML = \"\";\n    if (maxPowerTextElem) {\n      maxPowerTextElem.textContent = \"\";\n      setStatusLevel(maxPowerTextElem, null);\n    }\n    return;\n  }\n  heroCard.classList.remove(\"hidden\");\n  if (powerDiagramElem) powerDiagramElem.classList.remove(\"hidden\");\n  if (powerDiagramBarElem) powerDiagramBarElem.innerHTML = \"\";\n  if (powerDiagramLegendElem) powerDiagramLegendElem.innerHTML = \"\";\n\n  const ratio = total / availableWatt;\n\n  // 2. Update Hero Metrics\n  // Total / Available\n  if (heroTotalDraw) {\n    // Text updated above\n\n    // Glow Effect\n    heroTotalDraw.classList.remove('glow-safe', 'glow-warning', 'glow-danger');\n    if (ratio > 1.0) {\n      heroTotalDraw.classList.add('glow-danger');\n    } else if (ratio >= 0.8) {\n      heroTotalDraw.classList.add('glow-warning');\n    } else {\n      heroTotalDraw.classList.add('glow-safe');\n    }\n  }\n\n  if (heroAvailablePower) {\n    heroAvailablePower.textContent = `${availableWatt.toFixed(0)} W`;\n  }\n\n  // Battery Label\n  if (heroBatteryLabel && batterySelect && batterySelect.options) {\n    const selectedOption = batterySelect.options[batterySelect.selectedIndex];\n    const batteryName = selectedOption ? selectedOption.text : '';\n    heroBatteryLabel.textContent = `Camera Setup draws ${total.toFixed(0)}W from the ${availableWatt.toFixed(0)}W available on the ${batteryName} `;\n  }\n\n  // Currents & Battery Count (Calculated in results.js, but we can update DOM here if passed or access global/scope)\n  // Actually, results.js calculates these. We should probably let results.js update them directly \n  // OR we can move the calculation logic here? \n  // Better: results.js calls drawPowerDiagram. We can update the DOM elements in results.js \n  // OR pass the values to this function.\n  // For now, let's assume results.js will update heroCurrent144, heroCurrent12, heroBatteryCount directly\n  // since it has the calculated values (totalCurrentHigh, totalCurrentLow, batteriesNeeded).\n  // So we just handle the visual diagram here.\n\n  // 3. Render Standalone Power Diagram\n  if (powerDiagramBarElem && powerDiagramLegendElem) {\n    const MAX_WIDTH = 100; // Use percentage for width calculation if we want responsive\n    // Actually, the old logic used pixels based on 300px max width. \n    // Let's use percentage width for the segments to be responsive.\n    const scale = 100 / Math.max(availableWatt, total);\n    const limitPos = availableWatt * scale;\n\n    // Create inner wrapper for segments to handle rounded corners and overflow\n    const barInner = document.createElement(\"div\");\n    barInner.className = \"power-bar-inner\";\n    powerDiagramBarElem.appendChild(barInner);\n\n    segments.forEach(seg => {\n      const widthPercent = seg.power * scale;\n      if (widthPercent <= 0) return;\n\n      const div = document.createElement(\"div\");\n      div.className = `segment ${seg.className} `; // Use 'segment' class as per CSS\n      div.style.width = `${widthPercent}% `;\n      div.setAttribute(\"title\", `${seg.label} ${seg.power.toFixed(1)} W`);\n      barInner.appendChild(div);\n\n      const legendItem = document.createElement(\"span\");\n      const swatch = document.createElement(\"span\");\n      swatch.className = `swatch ${seg.className} `;\n      legendItem.appendChild(swatch);\n      legendItem.appendChild(document.createTextNode(seg.label.replace(/:$/, \"\")));\n      powerDiagramLegendElem.appendChild(legendItem);\n    });\n\n    // Over-usage overlay\n    if (total > availableWatt) {\n      const over = document.createElement(\"div\");\n      over.className = \"over-usage\";\n      over.style.left = `${limitPos}% `;\n      over.style.right = '0'; // Fill the rest\n      // Wait, if total > available, the bar width is based on total. \n      // So limitPos is at availableWatt. \n      // The over-usage should start at limitPos and go to the end.\n      barInner.appendChild(over);\n    }\n\n    // Limit Line (outside inner wrapper to avoid clipping)\n    const limit = document.createElement(\"div\");\n    limit.className = \"limit-line\";\n    limit.style.left = `${limitPos}% `;\n    if (typeof maxPinA === 'number' && maxPinA > 0) {\n      const label = document.createElement(\"span\");\n      label.className = \"limit-label\";\n      label.textContent = `${texts[currentLang].pinLabel} ${maxPinA} A`;\n      limit.appendChild(label);\n    }\n    powerDiagramBarElem.appendChild(limit);\n\n    if (powerDiagramElem) {\n      powerDiagramElem.classList.toggle(\"over\", total > availableWatt);\n    }\n  }\n\n  if (maxPowerTextElem) {\n    // We can keep this or remove it since it's redundant with Hero\n    // User said \"Remove redundant text from outside of the hero section\".\n    // But \"available power\" might be useful context for the diagram.\n    // Let's keep it minimal or remove if it duplicates the \"140 W / 240 W\" in Hero.\n    // The prompt said \"Add the available power metric to the total power draw... Remove redundant text\".\n    // So likely we don't need it here anymore.\n    maxPowerTextElem.textContent = \"\";\n  }\n}\n\nvar setupSelect = document.getElementById(\"setupSelect\");\nvar setupNameInput = document.getElementById(\"setupName\");\nvar saveSetupBtn = document.getElementById(\"saveSetupBtn\");\nvar deleteSetupBtn = document.getElementById(\"deleteSetupBtn\");\nvar shareSetupBtn = document.getElementById(\"shareSetupBtn\");\nvar sharedLinkRow = document.getElementById(\"sharedLinkRow\");\nvar sharedLinkInput = document.getElementById(\"sharedLinkInput\");\nvar shareLinkMessage = document.getElementById(\"shareLinkMessage\");\n\nfunction sanitizeShareFilename(name) {\n  if (!name) return '';\n  const trimmed = String(name).trim();\n  if (!trimmed) return '';\n  const sanitized = trimmed\n    .replace(/[\\\\/:*?\"<>|]+/g, '_')\n    .replace(/\\s+/g, ' ')\n    .replace(/^\\.+/, '')\n    .replace(/\\.+$/, '')\n    .trim();\n  return sanitized;\n}\n\nfunction ensureJsonExtension(filename) {\n  if (!filename) return '';\n  return /\\.json$/i.test(filename) ? filename : `${filename}.json`;\n}\n\nfunction getDefaultShareFilename(setupName) {\n  const sanitized = sanitizeShareFilename(setupName);\n  return sanitized || 'project';\n}\n\nfunction promptForSharedFilename(setupName) {\n  const defaultName = getDefaultShareFilename(setupName);\n  const template = getLocalizedText('shareFilenamePrompt') || '';\n  const promptMessage = template.includes('{defaultName}')\n    ? template.replace('{defaultName}', defaultName)\n    : template || 'Enter a name for the exported project file:';\n  if (typeof window !== 'undefined' && typeof window.prompt === 'function') {\n    const response = window.prompt(promptMessage, defaultName);\n    if (response === null) {\n      return null;\n    }\n    const sanitized = sanitizeShareFilename(response);\n    if (!sanitized) {\n      const invalidMessage =\n        getLocalizedText('shareFilenameInvalid')\n        || 'Please enter a valid file name to continue.';\n      if (typeof window.alert === 'function') {\n        window.alert(invalidMessage);\n      }\n      return null;\n    }\n    return ensureJsonExtension(sanitized);\n  }\n  return ensureJsonExtension(defaultName);\n}\n\nfunction confirmAutoGearSelection(defaultInclude) {\n  const confirmMessage =\n    getLocalizedText('shareIncludeAutoGearConfirm')\n    || 'Include automatic gear rules in the shared file? Select OK to include them or Cancel to skip.';\n\n  return new Promise((resolve) => {\n    if (typeof window.cineShowConfirmDialog === 'function') {\n      window.cineShowConfirmDialog({\n        title: getLocalizedText('shareIncludeAutoGearTitle') || 'Include Auto Gear Rules?',\n        message: confirmMessage,\n        confirmLabel: getLocalizedText('include') || 'Include',\n        cancelLabel: getLocalizedText('skip') || 'Skip',\n        onConfirm: () => resolve(true),\n        onCancel: () => resolve(false),\n      });\n      return;\n    }\n\n    console.warn('Missing window.cineShowConfirmDialog for confirmAutoGearSelection');\n    resolve(!!defaultInclude);\n  });\n}\nvar shareDialog = document.getElementById(\"shareDialog\");\nvar shareForm = document.getElementById(\"shareForm\");\nconst shareDialogHeadingElem = document.getElementById(\"shareDialogHeading\");\nvar shareFilenameInput = document.getElementById(\"shareFilename\");\nconst shareFilenameLabelElem = document.getElementById(\"shareFilenameLabel\");\nvar shareFilenameMessage = document.getElementById(\"shareFilenameMessage\");\nvar shareCancelBtn = document.getElementById(\"shareCancelBtn\");\nconst shareConfirmBtn = document.getElementById(\"shareConfirmBtn\");\nconst shareIncludeAutoGearText = document.getElementById(\"shareIncludeAutoGearText\");\nvar shareIncludeAutoGearLabelElem = document.getElementById(\"shareIncludeAutoGearLabel\");\nconst shareIncludeOwnedGearText = document.getElementById(\"shareIncludeOwnedGearText\");\nvar shareIncludeOwnedGearLabelElem = document.getElementById(\"shareIncludeOwnedGearLabel\");\nvar shareIncludeAutoGearCheckbox = document.getElementById(\"shareIncludeAutoGear\");\nvar shareIncludeOwnedGearCheckbox = document.getElementById(\"shareIncludeOwnedGear\");\nif (shareFilenameInput && shareFilenameMessage) {\n  shareFilenameInput.setAttribute('aria-describedby', 'shareFilenameMessage');\n}\nvar sharedImportDialog = document.getElementById(\"sharedImportDialog\");\nvar sharedImportForm = document.getElementById(\"sharedImportForm\");\nconst sharedImportDialogHeading = document.getElementById(\"sharedImportDialogHeading\");\nconst sharedImportDialogMessage = document.getElementById(\"sharedImportDialogMessage\");\nconst sharedImportMetadata = document.getElementById(\"sharedImportMetadata\");\nconst sharedImportOptions = document.getElementById(\"sharedImportOptions\");\nconst sharedImportLegend = document.getElementById(\"sharedImportLegend\");\nvar sharedImportModeSelect = document.getElementById(\"sharedImportModeSelect\");\nconst sharedImportModeNoneOption = document.getElementById(\"sharedImportModeNoneOption\");\nconst sharedImportModeProjectOption = document.getElementById(\"sharedImportModeProjectOption\");\nconst sharedImportModeGlobalOption = document.getElementById(\"sharedImportModeGlobalOption\");\nconst sharedImportConfirmBtn = document.getElementById(\"sharedImportConfirmBtn\");\nvar sharedImportCancelBtn = document.getElementById(\"sharedImportCancelBtn\");\nif (sharedImportModeSelect) {\n  Array.from(sharedImportModeSelect.options || []).forEach(option => {\n    if (option.value === \"none\") return;\n    option.disabled = true;\n  });\n}\nvar sharedImportPromptActive = false;\nvar pendingSharedLinkListener = null;\nvar lastSetupName = setupSelect ? setupSelect.value : '';\nvar applySharedLinkBtn = document.getElementById(\"applySharedLinkBtn\");\nconst sharedKeyMap = {\n  setupName: \"s\",\n  camera: \"c\",\n  monitor: \"m\",\n  video: \"v\",\n  cage: \"g\",\n  motors: \"o\",\n  controllers: \"r\",\n  distance: \"d\",\n  batteryPlate: \"p\",\n  battery: \"b\",\n  batteryHotswap: \"h\",\n  powerSelection: \"w\",\n  projectInfo: \"i\",\n  projectHtml: \"q\",\n  gearSelectors: \"e\",\n  gearList: \"l\",\n  ownedGearMarkers: \"u\",\n  changedDevices: \"x\",\n  feedback: \"f\",\n  autoGearRules: \"a\",\n  autoGearCoverage: \"z\",\n  diagramPositions: \"y\",\n  metadata: \"t\",\n  contacts: \"n\",\n};\nconst sharedKeyMapKeys = Object.keys(sharedKeyMap);\nconst sharedHasOwn = Object.prototype.hasOwnProperty;\n\nvar lastSharedSetupData = null;\nvar lastSharedAutoGearRules = null;\nvar sharedImportPreviousPresetId = '';\nvar sharedImportProjectPresetActive = false;\nlet sharedImportPreparedForImport = false;\n\nfunction resolveSharedImportLocalVersion() {\n  if (typeof ACTIVE_APP_VERSION === 'string') {\n    const trimmedActive = ACTIVE_APP_VERSION.trim();\n    if (trimmedActive) {\n      return trimmedActive;\n    }\n  }\n  if (typeof APP_VERSION === 'string') {\n    const trimmed = APP_VERSION.trim();\n    if (trimmed) {\n      return trimmed;\n    }\n  }\n  return '';\n}\n\nfunction formatSharedImportTimestamp(timestamp) {\n  if (typeof timestamp !== 'string') {\n    return '';\n  }\n  const normalized = timestamp.trim();\n  if (!normalized) {\n    return '';\n  }\n  const parsed = new Date(normalized);\n  if (Number.isNaN(parsed.valueOf())) {\n    return normalized;\n  }\n  try {\n    return parsed.toLocaleString(undefined, {\n      year: 'numeric',\n      month: 'short',\n      day: '2-digit',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  } catch (error) {\n    console.warn('Unable to format shared import timestamp.', error);\n    return normalized;\n  }\n}\n\nfunction formatSharedImportMetadataSummary(metadata) {\n  if (!metadata || typeof metadata !== 'object') {\n    return '';\n  }\n\n  const localeTexts = texts[currentLang] || texts.en || {};\n  const englishTexts = texts.en || {};\n  const parts = [];\n\n  if (typeof metadata.exportedAt === 'string' && metadata.exportedAt.trim()) {\n    const formattedTimestamp = formatSharedImportTimestamp(metadata.exportedAt);\n    const timestampTemplate = localeTexts.sharedImportMetadataTimestamp\n      || englishTexts.sharedImportMetadataTimestamp\n      || 'Exported {timestamp}';\n    parts.push(timestampTemplate.replace('{timestamp}', formattedTimestamp));\n  }\n\n  const metadataVersion = typeof metadata.version === 'string' ? metadata.version.trim() : '';\n  if (metadataVersion) {\n    const localVersion = resolveSharedImportLocalVersion();\n    if (localVersion && localVersion !== metadataVersion) {\n      const mismatchTemplate = localeTexts.sharedImportMetadataVersionMismatch\n        || englishTexts.sharedImportMetadataVersionMismatch\n        || 'Planner version {importVersion} (current build {appVersion})';\n      parts.push(\n        mismatchTemplate\n          .replace('{importVersion}', metadataVersion)\n          .replace('{appVersion}', localVersion),\n      );\n    } else {\n      const versionTemplate = localeTexts.sharedImportMetadataVersion\n        || englishTexts.sharedImportMetadataVersion\n        || 'Planner version {version}';\n      parts.push(versionTemplate.replace('{version}', metadataVersion));\n    }\n  }\n\n  if (metadata.includesAutoGearRules) {\n    const autoGearText = localeTexts.sharedImportMetadataIncludesAutoGear\n      || englishTexts.sharedImportMetadataIncludesAutoGear\n      || 'Includes automatic gear rules';\n    parts.push(autoGearText);\n  }\n\n  if (metadata.includesOwnedGearMarkers) {\n    const ownedGearText = localeTexts.sharedImportMetadataIncludesOwnedGear\n      || englishTexts.sharedImportMetadataIncludesOwnedGear\n      || 'Marks owned gear items';\n    parts.push(ownedGearText);\n  }\n\n  return parts.join('  ');\n}\n\nfunction updateSharedImportMetadataSummary(metadata) {\n  if (!sharedImportMetadata) {\n    return;\n  }\n  const summary = formatSharedImportMetadataSummary(metadata);\n  if (summary) {\n    sharedImportMetadata.textContent = summary;\n    sharedImportMetadata.classList.remove('hidden');\n  } else {\n    sharedImportMetadata.textContent = '';\n    sharedImportMetadata.classList.add('hidden');\n  }\n}\n\nfunction cloneSharedImportValue(value) {\n  if (value == null) return null;\n  try {\n    return CORE_DEEP_CLONE(value);\n  } catch (error) {\n    console.warn('Failed to clone shared import value', error);\n    return null;\n  }\n}\n\nfunction storeSharedImportData(data, rules) {\n  lastSharedSetupData = cloneSharedImportValue(data);\n  lastSharedAutoGearRules = cloneSharedImportValue(rules);\n}\n\nfunction clearStoredSharedImportData() {\n  lastSharedSetupData = null;\n  lastSharedAutoGearRules = null;\n  sharedImportPreparedForImport = false;\n  updateSharedImportMetadataSummary(null);\n}\n\nfunction resetSharedImportStateForFactoryReset() {\n  clearStoredSharedImportData();\n  sharedImportPromptActive = false;\n  if (sharedImportDialog) {\n    closeDialog(sharedImportDialog);\n  }\n  if (typeof configureSharedImportOptions === 'function') {\n    configureSharedImportOptions([]);\n  }\n  if (sharedLinkInput) {\n    if (\n      pendingSharedLinkListener\n      && typeof sharedLinkInput.removeEventListener === 'function'\n    ) {\n      sharedLinkInput.removeEventListener('change', pendingSharedLinkListener);\n    }\n    sharedLinkInput.value = '';\n  }\n  pendingSharedLinkListener = null;\n  sharedImportPreviousPresetId = '';\n  sharedImportProjectPresetActive = false;\n}\n\nfunction deactivateSharedImportProjectPreset() {\n  if (!sharedImportProjectPresetActive) return;\n  const targetPresetId = sharedImportPreviousPresetId || '';\n  callCoreFunctionIfAvailable(\n    'setActiveAutoGearPresetId',\n    [targetPresetId, { persist: false, skipRender: true }],\n    { defer: true }\n  );\n  sharedImportProjectPresetActive = false;\n  sharedImportPreviousPresetId = '';\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n}\n\nfunction activateSharedImportProjectPreset(presetId) {\n  if (!presetId) return;\n  if (!sharedImportProjectPresetActive) {\n    sharedImportPreviousPresetId = activeAutoGearPresetId || '';\n  }\n  sharedImportProjectPresetActive = true;\n  callCoreFunctionIfAvailable(\n    'setActiveAutoGearPresetId',\n    [presetId, { persist: false, skipRender: true }],\n    { defer: true }\n  );\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n}\n\nfunction getSharedImportProjectName(sharedData) {\n  if (!sharedData || typeof sharedData !== 'object') return '';\n  const projectName = sharedData.projectInfo && typeof sharedData.projectInfo.projectName === 'string'\n    ? sharedData.projectInfo.projectName.trim()\n    : '';\n  if (projectName) return projectName;\n  if (typeof sharedData.setupName === 'string') {\n    const normalized = sharedData.setupName.trim();\n    if (normalized) return normalized;\n  }\n  return '';\n}\n\nfunction getSharedImportPresetLabel(sharedData) {\n  const langTexts = texts[currentLang] || texts.en || {};\n  const fallback = langTexts.sharedImportAutoGearPresetFallback\n    || texts.en?.sharedImportAutoGearPresetFallback\n    || 'Shared automatic gear rules';\n  const projectName = getSharedImportProjectName(sharedData);\n  if (!projectName) {\n    return fallback;\n  }\n  const template = langTexts.sharedImportAutoGearPresetName\n    || texts.en?.sharedImportAutoGearPresetName\n    || '%s';\n  if (template.includes('%s')) {\n    return formatWithPlaceholdersSafe(template, projectName);\n  }\n  return `${template} ${projectName} `.trim();\n}\n\nfunction ensureSharedAutoGearPreset(rules, sharedData) {\n  const normalizedRules = Array.isArray(rules)\n    ? rules.map(normalizeAutoGearRule).filter(Boolean)\n    : [];\n  if (!normalizedRules.length) return null;\n  const label = getSharedImportPresetLabel(sharedData);\n  const fingerprint = createAutoGearRulesFingerprint(normalizedRules);\n  let preset = autoGearPresets.find(entry => entry.fingerprint === fingerprint) || null;\n  const fallback = texts[currentLang]?.sharedImportAutoGearPresetFallback\n    || texts.en?.sharedImportAutoGearPresetFallback\n    || 'Shared automatic gear rules';\n  if (preset) {\n    if (label && preset.label !== label && preset.label === fallback) {\n      preset = { ...preset, label };\n      autoGearPresets = autoGearPresets.map(entry => (entry.id === preset.id ? preset : entry));\n      autoGearPresets = sortAutoGearPresets(autoGearPresets.slice());\n      persistAutoGearPresets(autoGearPresets);\n      callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n    }\n    return preset;\n  }\n  const normalizedPreset = normalizeAutoGearPreset({\n    id: generateAutoGearId('preset'),\n    label,\n    rules: normalizedRules,\n  });\n  if (!normalizedPreset) return null;\n  autoGearPresets.push(normalizedPreset);\n  autoGearPresets = sortAutoGearPresets(autoGearPresets.slice());\n  persistAutoGearPresets(autoGearPresets);\n  if (autoGearAutoPresetIdState) {\n    callCoreFunctionIfAvailable(\n      'setAutoGearAutoPresetId',\n      ['', { persist: true, skipRender: true }],\n      { defer: true }\n    );\n  }\n  callCoreFunctionIfAvailable('renderAutoGearPresetsControls', [], { defer: true });\n  return normalizedPreset;\n}\n\nfunction configureSharedImportOptions(sharedRules) {\n  if (!sharedImportModeSelect) {\n    return Array.isArray(sharedRules) && sharedRules.length > 0;\n  }\n  const hasRules = Array.isArray(sharedRules) && sharedRules.length > 0;\n  const options = Array.from(sharedImportModeSelect.options || []);\n  options.forEach(option => {\n    if (option.value === 'none') {\n      option.disabled = false;\n      option.selected = !hasRules;\n    } else {\n      option.disabled = !hasRules;\n      option.selected = hasRules && option.value === 'project';\n    }\n  });\n  return hasRules;\n}\n\nfunction sharedImportRulesDiffer(sharedRules) {\n  if (!Array.isArray(sharedRules) || !sharedRules.length) return false;\n  if (typeof getAutoGearRules !== 'function') return true;\n  try {\n    const currentRules = getAutoGearRules();\n    return stableStringify(sharedRules) !== stableStringify(currentRules || []);\n  } catch (error) {\n    console.warn('Failed to compare automatic gear rules', error);\n    return true;\n  }\n}\n\nfunction applyStoredSharedImport() {\n  if (lastSharedSetupData === null) return;\n  reapplySharedImportSelection();\n}\n\nfunction finalizeSharedImportPrompt() {\n  sharedImportPromptActive = false;\n  if (sharedImportDialog) closeDialog(sharedImportDialog);\n}\n\nfunction openSharedImportPrompt() {\n  if (!sharedImportDialog) return;\n  sharedImportPromptActive = true;\n  openDialog(sharedImportDialog);\n  const focusTarget = sharedImportModeSelect || sharedImportConfirmBtn || sharedImportCancelBtn;\n  if (focusTarget && typeof focusTarget.focus === 'function') {\n    focusTarget.focus();\n  }\n}\n\nfunction processSharedProjectData(data) {\n  try {\n    sharedImportPromptActive = false;\n    const parsed = typeof data === 'string' ? JSON.parse(data) : data;\n    const sharedRules = Array.isArray(parsed.autoGearRules) ? parsed.autoGearRules : null;\n    sharedImportPreparedForImport = false;\n    prepareSharedImportContext();\n    storeSharedImportData(parsed, sharedRules);\n    updateSharedImportMetadataSummary(parsed && parsed.metadata);\n    const hasRules = configureSharedImportOptions(sharedRules);\n    const shouldPrompt = hasRules && sharedImportRulesDiffer(sharedRules) && !!sharedImportDialog;\n    if (shouldPrompt) {\n      openSharedImportPrompt();\n      return;\n    }\n    applyStoredSharedImport();\n  } catch (error) {\n    clearStoredSharedImportData();\n    console.error('Failed to parse shared project', error);\n    alert(texts[currentLang].invalidSharedLink);\n  }\n}\n\nfunction readSharedProjectFile(file) {\n  if (!file) return;\n  const reader = new FileReader();\n  reader.onload = () => {\n    processSharedProjectData(reader.result);\n  };\n  reader.onerror = () => {\n    console.error('Failed to load shared project file', reader.error);\n    clearStoredSharedImportData();\n    alert(texts[currentLang].invalidSharedLink);\n  };\n  reader.readAsText(file);\n}\n\nfunction prepareSharedImportContext() {\n  if (sharedImportPreparedForImport) {\n    return;\n  }\n  sharedImportPreparedForImport = true;\n\n  try {\n    if (typeof scheduleProjectAutoSave === 'function') {\n      scheduleProjectAutoSave(true);\n    } else if (typeof saveCurrentSession === 'function') {\n      saveCurrentSession();\n      if (typeof saveCurrentGearList === 'function') {\n        saveCurrentGearList();\n      }\n    }\n  } catch (error) {\n    console.warn('Failed to persist current project before shared import', error);\n  }\n\n  let selectionCleared = false;\n  if (setupSelect && typeof setupSelect.dispatchEvent === 'function') {\n    try {\n      const currentValue = typeof setupSelect.value === 'string' ? setupSelect.value : '';\n      const typedName = setupNameInput && typeof setupNameInput.value === 'string'\n        ? setupNameInput.value.trim()\n        : '';\n      const previousSelection = typeof lastSetupName === 'string' ? lastSetupName : '';\n      const shouldDispatch = Boolean(currentValue || previousSelection || typedName);\n      setupSelect.value = '';\n      if (shouldDispatch) {\n        setupSelect.dispatchEvent(new Event('change'));\n      }\n      selectionCleared = true;\n    } catch (error) {\n      console.warn('Failed to reset setup selection before shared import', error);\n    }\n  }\n\n  if (selectionCleared && setupNameInput) {\n    try {\n      if (setupNameInput.value) {\n        setupNameInput.value = '';\n        setupNameInput.dispatchEvent(new Event('input'));\n      }\n    } catch (error) {\n      console.warn('Failed to reset setup name before shared import', error);\n    }\n  }\n}\n\nfunction reapplySharedImportSelection() {\n  if (lastSharedSetupData === null) return;\n  const storedData = cloneSharedImportValue(lastSharedSetupData);\n  if (!storedData) return;\n  const storedRules = cloneSharedImportValue(lastSharedAutoGearRules);\n  const mode = resolveSharedImportMode(storedRules);\n  applySharedSetup(storedData, {\n    autoGearMode: mode,\n    sharedAutoGearRules: storedRules,\n  });\n  updateCalculations();\n}\n\nfunction resolveSharedImportMode(sharedRules) {\n  const hasRules = Array.isArray(sharedRules) && sharedRules.length > 0;\n  if (!sharedImportModeSelect) {\n    return hasRules ? 'project' : 'none';\n  }\n  const selectedValues = Array.from(sharedImportModeSelect.selectedOptions || [])\n    .map(option => option.value)\n    .filter(value => value === 'none' || value === 'project' || value === 'global');\n  if (!hasRules) {\n    return 'none';\n  }\n  let modes = Array.from(new Set(selectedValues));\n  if (!modes.length) {\n    return 'project';\n  }\n  if (modes.length > 1 && modes.includes('none')) {\n    modes = modes.filter(value => value !== 'none');\n  }\n  if (!modes.length) {\n    return 'project';\n  }\n  if (modes.length === 1) {\n    return modes[0];\n  }\n  return modes;\n}\n\nfunction encodeSharedSetup(setup) {\n  if (!setup || typeof setup !== 'object') {\n    return {};\n  }\n\n  const out = {};\n  for (let index = 0; index < sharedKeyMapKeys.length; index += 1) {\n    const key = sharedKeyMapKeys[index];\n    if (key === 'gearList' || key === 'projectHtml') {\n      continue;\n    }\n    const value = setup[key];\n    if (value != null) {\n      out[sharedKeyMap[key]] = value;\n    }\n  }\n  return out;\n}\n\nfunction decodeSharedSetup(setup) {\n  if (!setup || typeof setup !== 'object') return {};\n\n  let hasLongKeys = false;\n  let hasShortKeys = false;\n  const pendingKeys = [];\n\n  for (let index = 0; index < sharedKeyMapKeys.length; index += 1) {\n    const key = sharedKeyMapKeys[index];\n    const short = sharedKeyMap[key];\n    const longPresent = sharedHasOwn.call(setup, key);\n    const shortPresent = sharedHasOwn.call(setup, short);\n\n    if (longPresent) {\n      hasLongKeys = true;\n    }\n    if (shortPresent) {\n      hasShortKeys = true;\n      if (!longPresent && setup[short] != null) {\n        pendingKeys.push(key);\n      }\n    }\n  }\n\n  if (!hasLongKeys && !hasShortKeys) {\n    return {};\n  }\n\n  if (!hasLongKeys) {\n    const expanded = {};\n    for (let index = 0; index < sharedKeyMapKeys.length; index += 1) {\n      const key = sharedKeyMapKeys[index];\n      const short = sharedKeyMap[key];\n      const value = setup[short];\n      if (value != null) {\n        expanded[key] = value;\n      }\n    }\n    return expanded;\n  }\n\n  if (!pendingKeys.length) {\n    return setup;\n  }\n\n  const merged = { ...setup };\n  for (let index = 0; index < pendingKeys.length; index += 1) {\n    const key = pendingKeys[index];\n    if (!sharedHasOwn.call(merged, key)) {\n      const short = sharedKeyMap[key];\n      const value = setup[short];\n      if (value != null) {\n        merged[key] = value;\n      }\n    }\n  }\n  return merged;\n}\nvar deviceManagerSection =\n  (typeof deviceManagerSection !== 'undefined' && deviceManagerSection)\n    ? deviceManagerSection\n    : (typeof document !== 'undefined' && typeof document.getElementById === 'function')\n      ? document.getElementById('device-manager')\n      : null;\n\nvar toggleDeviceBtn =\n  (typeof toggleDeviceBtn !== 'undefined' && toggleDeviceBtn)\n    ? toggleDeviceBtn\n    : (typeof document !== 'undefined' && typeof document.getElementById === 'function')\n      ? document.getElementById('toggleDeviceManager')\n      : null;\nvar deviceListContainerRef = null;\n\nfunction resolveDeviceListContainer() {\n  const container = document.getElementById('deviceListContainer');\n  if (container) {\n    deviceListContainerRef = container;\n    return container;\n  }\n  return deviceListContainerRef;\n}\nconst deviceManagerLists = (() => {\n  const globalScope =\n    (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE)\n      ? CORE_GLOBAL_SCOPE\n      : (typeof globalThis !== 'undefined' && globalThis)\n        ? globalThis\n        : (typeof window !== 'undefined' && window)\n          ? window\n          : (typeof self !== 'undefined' && self)\n            ? self\n            : (typeof global !== 'undefined' && global)\n              ? global\n              : null;\n\n  if (\n    globalScope &&\n    globalScope.deviceManagerLists &&\n    globalScope.deviceManagerLists instanceof Map\n  ) {\n    return globalScope.deviceManagerLists;\n  }\n\n  const created = new Map();\n  if (globalScope && typeof globalScope === 'object') {\n    try {\n      globalScope.deviceManagerLists = created;\n    } catch (assignError) {\n      void assignError;\n      globalScope.deviceManagerLists = created;\n    }\n  }\n  return created;\n})();\n\nvar filterHelperScope = (() => {\n  if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE) return CORE_GLOBAL_SCOPE;\n  if (typeof globalThis !== 'undefined' && globalThis) return globalThis;\n  if (typeof window !== 'undefined' && window) return window;\n  if (typeof self !== 'undefined' && self) return self;\n  if (typeof global !== 'undefined' && global) return global;\n  return null;\n})();\n\nfunction fallbackFilterSelect(selectElem, filterValue) {\n  if (!selectElem || typeof selectElem !== \"object\") {\n    return;\n  }\n  const text = (filterValue || \"\").toLowerCase();\n  Array.from(selectElem.options || []).forEach(option => {\n    if (!option || typeof option !== \"object\") return;\n    const isMatch =\n      option.value === \"None\"\n      || text === \"\"\n      || (option.textContent || \"\").toLowerCase().includes(text);\n    option.hidden = !isMatch;\n    option.disabled = !isMatch;\n  });\n}\n\nfunction fallbackFilterDeviceList(listElem, filterValue) {\n  if (!listElem || typeof listElem !== \"object\") {\n    return;\n  }\n  const text = (filterValue || \"\").toLowerCase();\n  Array.from(listElem.querySelectorAll ? listElem.querySelectorAll(\"li\") : []).forEach(item => {\n    if (!item || typeof item !== \"object\") return;\n    const summary = item.querySelector ? item.querySelector(\".device-summary span\") : null;\n    const content = summary && typeof summary.textContent === \"string\" ? summary.textContent.toLowerCase() : \"\";\n    item.style.display = text === \"\" || content.includes(text) ? \"\" : \"none\";\n  });\n}\n\nfunction fallbackAddInputClearButton(inputElem, callback) {\n  if (!inputElem || typeof inputElem !== \"object\" || typeof inputElem.insertAdjacentElement !== \"function\") {\n    return;\n  }\n  const translationSource =\n    (typeof texts === \"object\" && texts)\n    || (typeof window !== \"undefined\" && typeof window.texts === \"object\" && window.texts)\n    || null;\n  const clearLabel =\n    (translationSource && translationSource[currentLang] && translationSource[currentLang].clearFilter)\n    || \"Clear filter\";\n  const clearBtn = document.createElement(\"button\");\n  clearBtn.type = \"button\";\n  clearBtn.className = \"clear-input-btn\";\n  clearBtn.innerHTML = iconMarkup(ICON_GLYPHS.circleX, \"clear-icon\");\n  clearBtn.setAttribute(\"aria-label\", clearLabel);\n  clearBtn.title = clearLabel;\n  clearBtn.hidden = true;\n  clearBtn.addEventListener(\"click\", () => {\n    inputElem.value = \"\";\n    if (typeof callback === \"function\") {\n      callback();\n    }\n    if (typeof inputElem.focus === \"function\") {\n      inputElem.focus();\n    }\n  });\n  inputElem.insertAdjacentElement(\"afterend\", clearBtn);\n  const toggle = () => {\n    clearBtn.hidden = !inputElem.value;\n  };\n  inputElem.addEventListener(\"input\", toggle);\n  toggle();\n}\n\nfunction fallbackBindFilterInput(inputElem, callback) {\n  if (!inputElem || typeof inputElem !== \"object\") {\n    return;\n  }\n  const handler = typeof callback === \"function\" ? callback : () => { };\n  inputElem.addEventListener(\"input\", handler);\n  inputElem.addEventListener(\"keydown\", event => {\n    if (event && event.key === \"Escape\") {\n      inputElem.value = \"\";\n      handler();\n    }\n  });\n  fallbackAddInputClearButton(inputElem, handler);\n}\n\nfunction ensureFilterHelpers() {\n  const scope = filterHelperScope && typeof filterHelperScope === \"object\"\n    ? filterHelperScope\n    : {};\n  const attachHelper = (key, fn) => {\n    if (typeof scope[key] === \"function\") {\n      return;\n    }\n    try {\n      scope[key] = fn;\n    } catch (assignError) {\n      try {\n        Object.defineProperty(scope, key, {\n          configurable: true,\n          writable: true,\n          value: fn,\n        });\n      } catch (defineError) {\n        void defineError;\n      }\n    }\n  };\n  attachHelper(\"filterSelect\", fallbackFilterSelect);\n  attachHelper(\"filterDeviceList\", fallbackFilterDeviceList);\n  attachHelper(\"bindFilterInput\", fallbackBindFilterInput);\n  attachHelper(\"addInputClearButton\", fallbackAddInputClearButton);\n  return scope;\n}\n\nensureFilterHelpers();\n\nfunction applyFilters() {\n  const helpers = ensureFilterHelpers();\n  const filterFn = typeof helpers.filterDeviceList === \"function\"\n    ? helpers.filterDeviceList\n    : fallbackFilterDeviceList;\n  if (!(deviceManagerLists instanceof Map)) {\n    return;\n  }\n  deviceManagerLists.forEach(entry => {\n    if (!entry || typeof entry !== \"object\") {\n      return;\n    }\n    const { list, filterInput } = entry;\n    if (!list || typeof list !== \"object\") {\n      return;\n    }\n    const value = filterInput && typeof filterInput.value === \"string\"\n      ? filterInput.value\n      : \"\";\n    try {\n      filterFn(list, value);\n    } catch (filterError) {\n      console.warn(\"Failed to apply device manager filters\", filterError);\n    }\n  });\n}\nconst DEVICE_MANAGER_DEFAULT_ORDER = Object.freeze([\n  \"cameras\",\n  \"viewfinders\",\n  \"monitors\",\n  \"video\",\n  \"wirelessReceivers\",\n  \"directorMonitors\",\n  \"iosVideo\",\n  \"lenses\",\n  \"fiz.motors\",\n  \"fiz.controllers\",\n  \"fiz.handUnits\",\n  \"fiz.distance\",\n  \"batteries\",\n  \"batteryHotswaps\",\n  \"accessories.batteries\",\n  \"accessories.powerPlates\",\n  \"accessories.cables\",\n  \"accessories.cages\",\n  \"accessories.cameraSupport\",\n  \"accessories.cameraStabiliser\",\n  \"accessories.chargers\",\n  \"accessories.videoAssist\",\n  \"accessories.media\",\n  \"accessories.cardReaders\",\n  \"accessories.filters\",\n  \"accessories.matteboxes\",\n  \"accessories.rigging\",\n  \"accessories.grip\",\n  \"accessories.sliders\",\n  \"accessories.tripodHeads\",\n  \"accessories.tripods\",\n  \"accessories.carts\",\n]);\n\nfunction getDeviceManagerPreferredOrder() {\n  const scopeCandidate = filterHelperScope;\n  const scopedOrder =\n    scopeCandidate && Array.isArray(scopeCandidate.deviceManagerPreferredOrder)\n      ? scopeCandidate.deviceManagerPreferredOrder\n      : null;\n\n  if (scopedOrder && scopedOrder.every(entry => typeof entry === 'string' && entry)) {\n    return scopedOrder;\n  }\n\n  return DEVICE_MANAGER_DEFAULT_ORDER;\n}\n\nfunction normalizeCategoryKey(key) {\n  if (!key) return null;\n  if (key === \"accessories\" || key === \"fiz\" || key === \"filterOptions\") return null;\n  if (key.startsWith(\"accessories.cables.\")) return \"accessories.cables\";\n  if (key === \"videoAssist\" && devices?.accessories?.videoAssist) return \"accessories.videoAssist\";\n  if (key === \"media\" && devices?.accessories?.media) return \"accessories.media\";\n  if (key === \"cardReaders\" && devices?.accessories?.cardReaders) return \"accessories.cardReaders\";\n  return key;\n}\n\nfunction getCategoryLabel(categoryKey, lang = currentLang) {\n  if (!categoryKey) return \"\";\n  const langNames = (typeof categoryNames === \"object\" && categoryNames && categoryNames[lang]) || {};\n  if (langNames[categoryKey]) return langNames[categoryKey];\n  const fallbackNames = (typeof categoryNames === \"object\" && categoryNames && categoryNames.en) || {};\n  if (fallbackNames[categoryKey]) return fallbackNames[categoryKey];\n  if (categoryKey === 'batteries' || categoryKey === 'accessories.batteries') {\n    return lang === 'en' ? 'Battery' : (lang === 'de' ? 'Akku' : 'Battery');\n  }\n  const parts = categoryKey.split('.');\n  return parts.map(part => humanizeKey(part)).join(' ');\n}\n\nfunction collectDeviceManagerCategories() {\n  const categories = new Set();\n  const addCategory = (key) => {\n    const normalized = normalizeCategoryKey(key);\n    if (!normalized) return;\n    categories.add(normalized);\n  };\n\n  const traverseSchema = (node, path = []) => {\n    if (path.length > 20) return;\n    if (!node || typeof node !== 'object') {\n      return;\n    }\n    if (Array.isArray(node.attributes)) {\n      const depth = path.length;\n      const topLevelKey = path[0];\n      if (\n        depth === 1 ||\n        (depth > 1 && (topLevelKey === 'accessories' || topLevelKey === 'fiz'))\n      ) {\n        addCategory(path.join('.'));\n      }\n    }\n    Object.entries(node).forEach(([childKey, value]) => {\n      if (childKey === 'attributes') {\n        return;\n      }\n      if (value && typeof value === 'object') {\n        traverseSchema(value, path.concat(childKey));\n      }\n    });\n  };\n\n  if (deviceSchema) {\n    traverseSchema(deviceSchema, []);\n  }\n\n  const addFromData = (data) => {\n    if (!data || typeof data !== 'object' || Array.isArray(data)) return;\n    Object.entries(data).forEach(([key, value]) => {\n      if (key === 'accessories') {\n        if (value && typeof value === 'object') {\n          Object.entries(value).forEach(([subKey, subValue]) => {\n            if (subValue && typeof subValue === 'object' && !Array.isArray(subValue)) {\n              addCategory(`accessories.${subKey} `);\n            }\n          });\n        }\n      } else if (key === 'fiz') {\n        if (value && typeof value === 'object') {\n          Object.entries(value).forEach(([subKey, subValue]) => {\n            if (subValue && typeof subValue === 'object' && !Array.isArray(subValue)) {\n              addCategory(`fiz.${subKey} `);\n            }\n          });\n        }\n      } else if (value && typeof value === 'object' && !Array.isArray(value)) {\n        addCategory(key);\n      }\n    });\n  };\n\n  addFromData(devices);\n\n  const sorted = Array.from(categories);\n  const preferredOrder = getDeviceManagerPreferredOrder();\n  const orderMap = new Map(preferredOrder.map((key, index) => [key, index]));\n  sorted.sort((a, b) => {\n    const idxA = orderMap.has(a) ? orderMap.get(a) : preferredOrder.length;\n    const idxB = orderMap.has(b) ? orderMap.get(b) : preferredOrder.length;\n    if (idxA !== idxB) return idxA - idxB;\n    return a.localeCompare(b);\n  });\n  return sorted;\n}\n\nfunction createDeviceCategorySection(categoryKey) {\n  const container = resolveDeviceListContainer();\n  if (!container || deviceManagerLists.has(categoryKey)) return deviceManagerLists.get(categoryKey) || null;\n  const section = document.createElement('div');\n  section.className = 'device-category';\n  const sanitizedId = categoryKey.replace(/[^a-z0-9]+/gi, '_');\n  const heading = document.createElement('h4');\n  heading.id = `category_${sanitizedId} `;\n  heading.dataset.categoryKey = categoryKey;\n  section.appendChild(heading);\n  const filterInput = document.createElement('input');\n  filterInput.type = 'search';\n  filterInput.className = 'list-filter';\n  filterInput.id = `${sanitizedId} ListFilter`;\n  filterInput.dataset.categoryKey = categoryKey;\n  const filterLabel = createHiddenLabel(ensureElementId(filterInput, `${sanitizedId} -list - filter`), `Filter ${categoryKey} `);\n  section.appendChild(filterLabel);\n  section.appendChild(filterInput);\n  const list = document.createElement('ul');\n  list.className = 'device-ul';\n  const listId = sanitizedId === 'cameras' ? 'cameraList' : `${sanitizedId} List`;\n  list.id = listId;\n  if (sanitizedId === 'cameras') {\n    list.setAttribute('data-current-id', 'camerasList');\n  }\n  section.appendChild(list);\n  container.appendChild(section);\n\n  const resolveFilterScope = () => {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    if (typeof window !== 'undefined') return window;\n    if (typeof self !== 'undefined') return self;\n    if (typeof global !== 'undefined') return global;\n    return null;\n  };\n\n  const attachFilterBinding = () => {\n    const scope = resolveFilterScope();\n    const bindFn = scope && scope.bindFilterInput;\n    const filterFn = scope && scope.filterDeviceList;\n    if (typeof bindFn !== 'function' || typeof filterFn !== 'function') {\n      return false;\n    }\n    bindFn(filterInput, () => filterFn(list, filterInput.value));\n    return true;\n  };\n\n  if (!attachFilterBinding()) {\n    enqueueCoreBootTask(() => {\n      attachFilterBinding();\n    });\n  }\n  const entry = { section, heading, filterInput, filterLabel, list, sanitizedId };\n  deviceManagerLists.set(categoryKey, entry);\n  return entry;\n}\n\nfunction updateDeviceManagerLocalization(lang = currentLang) {\n  if (!deviceManagerLists.size) return;\n  const placeholderTemplate = (texts[lang] && texts[lang].placeholder_filter) || 'Filter {item}...';\n  const clearLabel = (texts[lang] && texts[lang].clearFilter) || 'Clear filter';\n  const librarySearchInput = document.getElementById('deviceLibrarySearch');\n  const librarySearchLabel = document.getElementById('deviceLibrarySearchLabel');\n  const librarySearchHelp = (texts[lang] && texts[lang].deviceLibrarySearchHelp) ||\n    'Filter all categories and press Enter to jump to the best match.';\n  const librarySearchPlaceholder = (texts[lang] && texts[lang].deviceLibrarySearchPlaceholder) ||\n    'Search all device categories';\n  const librarySearchLabelText = (texts[lang] && texts[lang].deviceLibrarySearchLabel) ||\n    'Search entire library';\n  if (librarySearchLabel) {\n    librarySearchLabel.textContent = librarySearchLabelText;\n  }\n  if (librarySearchInput) {\n    librarySearchInput.placeholder = librarySearchPlaceholder;\n    librarySearchInput.setAttribute('aria-label', librarySearchPlaceholder);\n    librarySearchInput.setAttribute('data-help', librarySearchHelp);\n    librarySearchInput.setAttribute('autocomplete', 'off');\n    librarySearchInput.setAttribute('autocorrect', 'off');\n    librarySearchInput.setAttribute('autocapitalize', 'off');\n    librarySearchInput.setAttribute('spellcheck', 'false');\n  }\n  deviceManagerLists.forEach((entry, categoryKey) => {\n    const label = getCategoryLabel(categoryKey, lang);\n    if (entry.heading) {\n      entry.heading.textContent = label;\n    }\n    if (entry.filterInput) {\n      const placeholder = placeholderTemplate.replace('{item}', label.toLowerCase());\n      entry.filterInput.placeholder = placeholder;\n      entry.filterInput.setAttribute('aria-label', placeholder);\n      entry.filterInput.setAttribute('autocomplete', 'off');\n      entry.filterInput.setAttribute('autocorrect', 'off');\n      entry.filterInput.setAttribute('autocapitalize', 'off');\n      entry.filterInput.setAttribute('spellcheck', 'false');\n      entry.filterInput.setAttribute('inputmode', 'search');\n      if (entry.filterLabel) {\n        const labelText = placeholder.replace(/\\s*(?:\\.{3}|\\u2026)$/, '');\n        entry.filterLabel.textContent = labelText;\n      }\n      const clearBtn = entry.filterInput.nextElementSibling;\n      if (clearBtn && clearBtn.classList.contains('clear-input-btn')) {\n        clearBtn.setAttribute('aria-label', clearLabel);\n        clearBtn.title = clearLabel;\n      }\n    }\n  });\n\n  const applyLibraryLocalization =\n    filterHelperScope && typeof filterHelperScope.updateDeviceLibrarySearchLocalization === 'function'\n      ? filterHelperScope.updateDeviceLibrarySearchLocalization\n      : null;\n  if (applyLibraryLocalization) {\n    applyLibraryLocalization();\n  }\n}\n\nfunction syncDeviceManagerCategories() {\n  const container = resolveDeviceListContainer();\n  if (!container) {\n    return;\n  }\n  const categories = collectDeviceManagerCategories();\n  const desiredSet = new Set(categories);\n  const existingKeys = Array.from(deviceManagerLists.keys());\n  categories.forEach(categoryKey => {\n    if (!deviceManagerLists.has(categoryKey)) {\n      createDeviceCategorySection(categoryKey);\n    }\n  });\n  existingKeys.forEach(categoryKey => {\n    if (!desiredSet.has(categoryKey)) {\n      const entry = deviceManagerLists.get(categoryKey);\n      if (entry && entry.section && entry.section.parentNode) {\n        entry.section.parentNode.removeChild(entry.section);\n      }\n      deviceManagerLists.delete(categoryKey);\n    }\n  });\n  categories.forEach(categoryKey => {\n    const entry = deviceManagerLists.get(categoryKey);\n    if (entry && entry.section) {\n      container.appendChild(entry.section);\n    }\n  });\n  updateDeviceManagerLocalization(currentLang);\n}\n\nexposeCoreRuntimeConstant('syncDeviceManagerCategories', syncDeviceManagerCategories);\n\nfunction getCurrentProjectName() {\n  const typedName =\n    (setupNameInput && typeof setupNameInput.value === 'string'\n      ? setupNameInput.value.trim()\n      : '') || '';\n  if (typedName) {\n    return typedName;\n  }\n  return (setupSelect && setupSelect.value) || '';\n}\n\nexposeCoreRuntimeConstant('getCurrentProjectName', getCurrentProjectName);\n\nfunction normalizeSetupName(value) {\n  if (typeof value !== 'string') {\n    return '';\n  }\n  return value.trim();\n}\n\nfunction getSetupNameState() {\n  const rawTyped =\n    setupNameInput && typeof setupNameInput.value === 'string'\n      ? setupNameInput.value\n      : '';\n  const rawSelected =\n    setupSelect && typeof setupSelect.value === 'string'\n      ? setupSelect.value\n      : '';\n  const typedName = normalizeSetupName(rawTyped);\n  const selectedName = normalizeSetupName(rawSelected);\n  const typedNameHasTrailingWhitespace = Boolean(\n    typedName\n    && typeof rawTyped === 'string'\n    && /\\s$/.test(rawTyped),\n  );\n  const renameInProgress = Boolean(\n    selectedName\n    && typedName\n    && typedName !== selectedName,\n  );\n  const storageKey = selectedName || typedName || '';\n  return {\n    typedName,\n    selectedName,\n    renameInProgress,\n    storageKey,\n    typedNameHasTrailingWhitespace,\n  };\n}\n\nfunction createProjectInfoSnapshotForStorage(baseInfo, options = {}) {\n  if (baseInfo == null || typeof baseInfo !== 'object') {\n    return baseInfo == null ? null : baseInfo;\n  }\n  const { projectNameOverride } = options;\n  if (typeof projectNameOverride !== 'string' || !projectNameOverride) {\n    return baseInfo;\n  }\n  if (\n    typeof baseInfo.projectName === 'string'\n    && normalizeSetupName(baseInfo.projectName) === projectNameOverride\n  ) {\n    return baseInfo;\n  }\n  return { ...baseInfo, projectName: projectNameOverride };\n}\n\nfunction getCurrentProjectStorageKey(options = {}) {\n  const typedName =\n    setupNameInput && typeof setupNameInput.value === 'string'\n      ? setupNameInput.value.trim()\n      : '';\n  const selectedName =\n    setupSelect && typeof setupSelect.value === 'string'\n      ? setupSelect.value.trim()\n      : '';\n\n  if (options.allowTyped && typedName) {\n    return typedName;\n  }\n\n  if (selectedName) {\n    return selectedName;\n  }\n\n  if (!setupSelect) {\n    return '';\n  }\n\n  if (\n    typedName &&\n    Array.from((setupSelect && setupSelect.options) || []).some(\n      option => option && option.value === typedName\n    )\n  ) {\n    return typedName;\n  }\n\n  return '';\n}\nvar newCategorySelect = document.getElementById(\"newCategory\");\nvar newSubcategorySelect = document.getElementById(\"newSubcategory\");\nvar subcategoryFieldDiv = document.getElementById(\"subcategoryField\");\nvar newNameInput = document.getElementById(\"newName\");\nvar newWattInput = document.getElementById(\"newWatt\");\nvar wattFieldDiv = document.getElementById(\"wattField\");\nvar dynamicFieldsDiv = document.getElementById(\"dynamicFields\");\nvar cameraFieldsDiv = document.getElementById(\"cameraFields\");\nvar cameraWattInput = document.getElementById(\"cameraWatt\");\nvar cameraVoltageInput = document.getElementById(\"cameraVoltage\");\nvar cameraPortTypeInput = document.getElementById(\"cameraPortType\");\nvar monitorFieldsDiv = document.getElementById(\"monitorFields\");\nvar monitorScreenSizeInput = document.getElementById(\"monitorScreenSize\");\nvar monitorBrightnessInput = document.getElementById(\"monitorBrightness\");\nvar monitorWattInput = document.getElementById(\"monitorWatt\");\nvar monitorVoltageInput = document.getElementById(\"monitorVoltage\");\nvar monitorPortTypeInput = document.getElementById(\"monitorPortType\");\nvar monitorVideoInputsContainer = document.getElementById(\"monitorVideoInputsContainer\");\nvar lensFieldsDiv = document.getElementById(\"lensFields\");\nvar lensMountOptionsContainer = document.getElementById(\"lensMountOptionsContainer\");\n\nfunction populateCategoryOptions() {\n  if (!newCategorySelect && typeof document !== 'undefined') {\n    newCategorySelect = document.getElementById('newCategory');\n  }\n  if (!newCategorySelect) return;\n  if (newCategorySelect.options) {\n    newCategorySelect.options.length = 0;\n  } else {\n    newCategorySelect.innerHTML = '';\n  }\n  const addOpt = (val) => {\n    const opt = document.createElement('option');\n    opt.value = val;\n    opt.textContent = getCategoryLabel(val, currentLang);\n    newCategorySelect.appendChild(opt);\n  };\n\n  // Add categories from schema when available\n  if (deviceSchema) {\n    const categoriesToAdd = new Set();\n    if (deviceSchema.accessories) {\n      for (const [sub, obj] of Object.entries(deviceSchema.accessories)) {\n        if (sub === 'cables') {\n          categoriesToAdd.add('accessories.cables');\n        } else if (obj && obj.attributes) {\n          categoriesToAdd.add(`accessories.${sub}`);\n        }\n      }\n    }\n    for (const [key, obj] of Object.entries(deviceSchema)) {\n      if (key === 'accessories' || key === 'fiz') continue;\n      if (obj && obj.attributes) categoriesToAdd.add(key);\n    }\n\n    // Sort categories alphabetically by their labels for a better UI experience\n    const sortedCategories = Array.from(categoriesToAdd).sort((a, b) => {\n      const labelA = getCategoryLabel(a, currentLang);\n      const labelB = getCategoryLabel(b, currentLang);\n      return labelA.localeCompare(labelB, currentLang);\n    });\n\n    for (const catKey of sortedCategories) {\n      addOpt(catKey);\n    }\n\n    if (deviceSchema.fiz) {\n      for (const [sub, obj] of Object.entries(deviceSchema.fiz)) {\n        if (obj && obj.attributes) addOpt(`fiz.${sub}`);\n      }\n    }\n\n    // Trigger change event to initialize the form fields for the default selection\n    if (newCategorySelect && typeof newCategorySelect.dispatchEvent === 'function') {\n      try {\n        newCategorySelect.dispatchEvent(new Event('change', { bubbles: true }));\n      } catch (dispatchError) {\n        console.warn('Failed to dispatch change event in populateCategoryOptions', dispatchError);\n      }\n    }\n  }\n\n  // Include any categories present in the device database that were not in the schema\n  if (typeof devices === 'object') {\n    const existing = new Set(newCategorySelect.options ? Array.from(newCategorySelect.options).map(o => o.value) : []);\n    const addIfMissing = (val) => {\n      if (!existing.has(val)) {\n        addOpt(val);\n        existing.add(val);\n      }\n    };\n    for (const [key, obj] of Object.entries(devices)) {\n      if (key === 'accessories') {\n        for (const sub of Object.keys(obj || {})) {\n          addIfMissing(`accessories.${sub}`);\n        }\n      } else if (key === 'fiz') {\n        for (const sub of Object.keys(obj || {})) {\n          addIfMissing(`fiz.${sub}`);\n        }\n      } else if (obj && typeof obj === 'object' && !Array.isArray(obj)) {\n        addIfMissing(key);\n      }\n    }\n  }\n}\n\npopulateCategoryOptions();\n\nfunction getCategoryContainer(categoryKey, subcategory, { create = false } = {}) {\n  if (!categoryKey) {\n    return null;\n  }\n  if (categoryKey === 'accessories.cables') {\n    if (!subcategory) {\n      return null;\n    }\n    if (!devices.accessories) {\n      if (!create) return null;\n      devices.accessories = {};\n    }\n    if (!devices.accessories.cables) {\n      if (!create) return null;\n      devices.accessories.cables = {};\n    }\n    if (!devices.accessories.cables[subcategory]) {\n      if (!create) return null;\n      devices.accessories.cables[subcategory] = {};\n    }\n    return devices.accessories.cables[subcategory];\n  }\n\n  if (categoryKey.includes('.')) {\n    const [mainCat, rawSubCat] = categoryKey.split('.');\n    const subCat = rawSubCat ? rawSubCat.trim() : rawSubCat;\n    if (!devices[mainCat]) {\n      if (!create) return null;\n      devices[mainCat] = {};\n    }\n    if (!devices[mainCat][subCat]) {\n      if (!create) return null;\n      devices[mainCat][subCat] = {};\n    }\n    return devices[mainCat][subCat];\n  }\n\n  if (!devices[categoryKey]) {\n    if (!create) return null;\n    devices[categoryKey] = {};\n  }\n  return devices[categoryKey];\n}\n\nfunction removeOriginalDeviceEntry(originalCategory, originalSubcategory, originalName, newCategory, newSubcategory, newName) {\n  if (!originalCategory || !originalName) {\n    return;\n  }\n  const movedCategory = originalCategory !== newCategory;\n  const movedSubcategory =\n    originalCategory === 'accessories.cables' && originalSubcategory !== newSubcategory;\n  const renamed = originalName !== newName;\n  if (!movedCategory && !movedSubcategory && !renamed) {\n    return;\n  }\n\n  const container = getCategoryContainer(\n    originalCategory,\n    originalCategory === 'accessories.cables' ? originalSubcategory : null,\n    { create: false }\n  );\n  if (!container || !Object.prototype.hasOwnProperty.call(container, originalName)) {\n    return;\n  }\n  delete container[originalName];\n  if (\n    originalCategory === 'accessories.cables' &&\n    originalSubcategory &&\n    devices.accessories?.cables\n  ) {\n    const existing = devices.accessories.cables[originalSubcategory];\n    if (!existing || typeof existing !== 'object') {\n      devices.accessories.cables[originalSubcategory] = {};\n    }\n  }\n}\nvar monitorVideoOutputsContainer = document.getElementById(\"monitorVideoOutputsContainer\");\n\nexposeCoreRuntimeConstant('getCategoryContainer', getCategoryContainer);\nexposeCoreRuntimeConstant('removeOriginalDeviceEntry', removeOriginalDeviceEntry);\nvar monitorWirelessTxInput = document.getElementById(\"monitorWirelessTx\");\nvar monitorLatencyInput = document.getElementById(\"monitorLatency\");\nvar monitorAudioOutputInput = document.getElementById(\"monitorAudioOutput\");\nvar viewfinderFieldsDiv = document.getElementById(\"viewfinderFields\");\nvar viewfinderScreenSizeInput = document.getElementById(\"viewfinderScreenSize\");\nvar viewfinderBrightnessInput = document.getElementById(\"viewfinderBrightness\");\nvar viewfinderWattInput = document.getElementById(\"viewfinderWatt\");\nvar viewfinderVoltageInput = document.getElementById(\"viewfinderVoltage\");\nvar viewfinderPortTypeInput = document.getElementById(\"viewfinderPortType\");\nvar viewfinderVideoInputsContainer = document.getElementById(\"viewfinderVideoInputsContainer\");\nvar viewfinderVideoOutputsContainer = document.getElementById(\"viewfinderVideoOutputsContainer\");\nvar viewfinderWirelessTxInput = document.getElementById(\"viewfinderWirelessTx\");\nvar viewfinderLatencyInput = document.getElementById(\"viewfinderLatency\");\nvar videoFieldsDiv = document.getElementById(\"videoFields\");\nvar videoPowerInputsContainer = document.getElementById(\"videoPowerInputsContainer\");\nvar videoVideoInputsContainer = document.getElementById(\"videoVideoInputsContainer\");\nvar videoVideoOutputsContainer = document.getElementById(\"videoVideoOutputsContainer\");\nvar videoFrequencyInput = document.getElementById(\"videoFrequency\");\nvar videoLatencyInput = document.getElementById(\"videoLatency\");\n\nfunction resolveFeedbackTemperatureBounds() {\n  const min = typeof FEEDBACK_TEMPERATURE_MIN_VALUE === 'number'\n    ? FEEDBACK_TEMPERATURE_MIN_VALUE\n    : typeof FEEDBACK_TEMPERATURE_MIN === 'number'\n      ? FEEDBACK_TEMPERATURE_MIN\n      : -20;\n  const max = typeof FEEDBACK_TEMPERATURE_MAX_VALUE === 'number'\n    ? FEEDBACK_TEMPERATURE_MAX_VALUE\n    : typeof FEEDBACK_TEMPERATURE_MAX_LIMIT === 'number'\n      ? FEEDBACK_TEMPERATURE_MAX_LIMIT\n      : 50;\n  return { min, max };\n}\n\nfunction ensureFeedbackTemperatureOptions(select) {\n  if (!select) return;\n  const { min, max } = resolveFeedbackTemperatureBounds();\n  const expectedOptions = max - min + 2;\n  const storedMin = select.getAttribute('data-temp-min');\n  const storedMax = select.getAttribute('data-temp-max');\n  if (\n    select.options.length === expectedOptions\n    && storedMin === String(min)\n    && storedMax === String(max)\n  ) {\n    return;\n  }\n  const previousValue = select.value;\n  select.innerHTML = '';\n  const emptyOpt = document.createElement('option');\n  emptyOpt.value = '';\n  emptyOpt.textContent = '';\n  select.appendChild(emptyOpt);\n  for (let temp = min; temp <= max; temp += 1) {\n    const opt = document.createElement('option');\n    opt.value = String(temp);\n    opt.textContent = String(temp);\n    select.appendChild(opt);\n  }\n  select.setAttribute('data-temp-min', String(min));\n  select.setAttribute('data-temp-max', String(max));\n  if (previousValue) {\n    const previousOption = Array.from(select.options).find(option => option.value === previousValue);\n    if (previousOption) {\n      select.value = previousValue;\n    }\n  }\n}\n\nfunction refreshFeedbackTemperatureLabel(lang = currentLang, unit) {\n  const labelText = getTemperatureColumnLabelForLang(\n    lang,\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  const label = document.getElementById('fbTemperatureLabelText');\n  if (label) {\n    label.textContent = `${labelText}:`;\n  }\n  const helpLinks = document.querySelectorAll('a.help-link[href=\"#fbTemperature\"]');\n  helpLinks.forEach(link => {\n    if (link) {\n      link.textContent = labelText;\n    }\n  });\n}\n\nfunction updateFeedbackTemperatureOptions(lang = currentLang, unit) {\n  const tempSelect = document.getElementById('fbTemperature');\n  if (!tempSelect) return;\n  ensureFeedbackTemperatureOptions(tempSelect);\n  const resolvedLang = typeof lang === 'string' ? lang : currentLang;\n  const resolvedUnit = typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit;\n  const symbol = getTemperatureUnitSymbolForLang(resolvedLang, resolvedUnit);\n  Array.from(tempSelect.options).forEach(option => {\n    if (!option) return;\n    if (option.value === '') {\n      option.textContent = '';\n      return;\n    }\n    const numeric = Number(option.value);\n    if (!Number.isFinite(numeric)) {\n      option.textContent = option.value;\n      return;\n    }\n    const formatted = typeof formatTemperatureForDisplay === 'function'\n      ? formatTemperatureForDisplay(numeric, {\n        unit: resolvedUnit,\n        lang: resolvedLang,\n        includeSign: false,\n      })\n      : '';\n    option.textContent = formatted || `${numeric} ${symbol}`.trim();\n  });\n}\n\nif (typeof window !== 'undefined') {\n  window.ensureFeedbackTemperatureOptions = ensureFeedbackTemperatureOptions;\n  window.refreshFeedbackTemperatureLabel = refreshFeedbackTemperatureLabel;\n  window.updateFeedbackTemperatureOptions = updateFeedbackTemperatureOptions;\n}\n\nfunction normalizeTemperatureUnit(unit) {\n  if (typeof unit === 'string') {\n    const normalized = unit.trim().toLowerCase();\n    if (normalized === CORE_TEMPERATURE_UNITS.fahrenheit) {\n      return CORE_TEMPERATURE_UNITS.fahrenheit;\n    }\n    if (normalized === CORE_TEMPERATURE_UNITS.celsius) {\n      return CORE_TEMPERATURE_UNITS.celsius;\n    }\n  }\n  if (unit === CORE_TEMPERATURE_UNITS.fahrenheit) {\n    return CORE_TEMPERATURE_UNITS.fahrenheit;\n  }\n  return CORE_TEMPERATURE_UNITS.celsius;\n}\n\nfunction getRuntimeTemperatureUnit() {\n  const fallbackUnitCandidates = [];\n  if (typeof temperatureUnit !== 'undefined') {\n    fallbackUnitCandidates.push(temperatureUnit);\n  }\n  if (typeof CORE_GLOBAL_SCOPE !== 'undefined' && CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n    fallbackUnitCandidates.push(CORE_GLOBAL_SCOPE.temperatureUnit);\n  }\n  if (typeof globalThis !== 'undefined' && globalThis && typeof globalThis === 'object') {\n    fallbackUnitCandidates.push(globalThis.temperatureUnit);\n  }\n  if (typeof window !== 'undefined' && window && typeof window === 'object') {\n    fallbackUnitCandidates.push(window.temperatureUnit);\n  }\n  if (typeof self !== 'undefined' && self && typeof self === 'object') {\n    fallbackUnitCandidates.push(self.temperatureUnit);\n  }\n  if (typeof global !== 'undefined' && global && typeof global === 'object') {\n    fallbackUnitCandidates.push(global.temperatureUnit);\n  }\n\n  for (let index = 0; index < fallbackUnitCandidates.length; index += 1) {\n    const candidate = fallbackUnitCandidates[index];\n    if (typeof candidate === 'string' && candidate) {\n      return candidate;\n    }\n  }\n\n  return CORE_TEMPERATURE_UNITS.celsius;\n}\n\nfunction convertCelsiusToUnit(value, unit) {\n  const numeric = Number(value);\n  if (!Number.isFinite(numeric)) {\n    return Number.NaN;\n  }\n  const resolvedUnit = normalizeTemperatureUnit(\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  if (resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit) {\n    return (numeric * 9) / 5 + 32;\n  }\n  return numeric;\n}\n\nfunction getTemperatureUnitSymbolForLang(lang = currentLang, unit) {\n  const resolvedUnit = normalizeTemperatureUnit(\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  const textsForLang = getLanguageTexts(lang);\n  const fallbackTexts = getLanguageTexts('en');\n  const key =\n    resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit\n      ? 'temperatureUnitSymbolFahrenheit'\n      : 'temperatureUnitSymbolCelsius';\n  return (\n    textsForLang[key] ||\n    fallbackTexts[key] ||\n    (resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit ? 'F' : 'C')\n  );\n}\n\nfunction getTemperatureUnitLabelForLang(lang = currentLang, unit) {\n  const resolvedUnit = normalizeTemperatureUnit(\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  const textsForLang = getLanguageTexts(lang);\n  const fallbackTexts = getLanguageTexts('en');\n  const key =\n    resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit\n      ? 'temperatureUnitFahrenheit'\n      : 'temperatureUnitCelsius';\n  return (\n    textsForLang[key] ||\n    fallbackTexts[key] ||\n    (resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit ? 'Fahrenheit (F)' : 'Celsius (C)')\n  );\n}\n\nfunction getTemperatureColumnLabelForLang(lang = currentLang, unit) {\n  const textsForLang = getLanguageTexts(lang);\n  const fallbackTexts = getLanguageTexts('en');\n  const baseLabel =\n    textsForLang.temperatureLabel || fallbackTexts.temperatureLabel || 'Temperature';\n  const symbol = getTemperatureUnitSymbolForLang(\n    lang,\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  return `${baseLabel} (${symbol})`;\n}\n\nfunction formatTemperatureForDisplay(celsius, options = {}) {\n  const {\n    unit,\n    lang = currentLang,\n    includeSign = true,\n  } = options || {};\n  const resolvedUnit = normalizeTemperatureUnit(\n    typeof unit === 'undefined' ? getRuntimeTemperatureUnit() : unit\n  );\n  let converted = convertCelsiusToUnit(celsius, resolvedUnit);\n  if (!Number.isFinite(converted)) {\n    return '';\n  }\n  const textsForLang = getLanguageTexts(lang);\n  const fallbackTexts = getLanguageTexts('en');\n  const formatter =\n    resolvedUnit === CORE_TEMPERATURE_UNITS.fahrenheit\n      ? textsForLang.temperatureFormatterFahrenheit || fallbackTexts.temperatureFormatterFahrenheit\n      : textsForLang.temperatureFormatterCelsius || fallbackTexts.temperatureFormatterCelsius;\n  if (typeof formatter === 'function') {\n    return formatter(converted, { includeSign });\n  }\n  const rounded = Math.round(converted * 10) / 10;\n  const formatted = includeSign && rounded > 0 ? `+ ${rounded} ` : String(rounded);\n  const symbol = getTemperatureUnitSymbolForLang(lang, resolvedUnit);\n  return `${formatted} ${symbol} `.trim();\n}\n\n(function installViewfinderFallbacks() {\n  const scope =\n    (typeof globalThis !== 'undefined' && globalThis)\n    || (typeof window !== 'undefined' && window)\n    || (typeof self !== 'undefined' && self)\n    || (typeof global !== 'undefined' && global)\n    || {};\n\n  const hasDocument = typeof document !== 'undefined' && !!document && typeof document.createElement === 'function';\n\n  const ensureFunction = (name, factory) => {\n    if (typeof scope[name] === 'function') {\n      return scope[name];\n    }\n    const created = typeof factory === 'function' ? factory() : factory;\n    if (typeof created === 'function') {\n      try {\n        scope[name] = created;\n      } catch (assignError) {\n        void assignError;\n      }\n    }\n    return created;\n  };\n\n  const ensureArrayBinding = (name, values) => {\n    if (Array.isArray(scope[name])) {\n      return scope[name];\n    }\n    const copy = Array.isArray(values) ? values.slice() : [];\n    try {\n      scope[name] = copy;\n    } catch (assignError) {\n      void assignError;\n      scope[name] = copy;\n    }\n    return scope[name];\n  };\n\n  const defaultVideoPortOptions = ['3G-SDI', '6G-SDI', '12G-SDI', 'Mini BNC', 'HDMI', 'Mini HDMI', 'Micro HDMI'];\n  const defaultViewfinderTypes = ['Electronic Viewfinder', 'Optical Viewfinder', 'LCD Monitor', 'OLED Viewfinder'];\n  const defaultViewfinderConnectors = ['BNC', 'Mini BNC', 'HDMI', 'Mini HDMI', 'Micro HDMI'];\n\n  const safeLocaleSort = typeof localeSort === 'function'\n    ? localeSort\n    : (a, b) => String(a || '').localeCompare(String(b || ''), undefined, { sensitivity: 'base' });\n\n  const readDevices = () => (typeof devices !== 'undefined' && devices && typeof devices === 'object') ? devices : {};\n\n  const collectValues = (defaults, collector) => {\n    const values = new Set((defaults || []).filter(Boolean));\n    try {\n      collector(values);\n    } catch (collectionError) {\n      void collectionError;\n    }\n    return Array.from(values).filter(Boolean).sort(safeLocaleSort);\n  };\n\n  const collectViewfinderTypes = () => {\n    const result = collectValues(defaultViewfinderTypes, valueSet => {\n      const data = readDevices();\n      Object.values(data.cameras || {}).forEach(camera => {\n        if (!camera) return;\n        const list = Array.isArray(camera.viewfinder) ? camera.viewfinder : [];\n        list.forEach(entry => {\n          const type = typeof entry?.type === 'string' ? entry.type.trim() : '';\n          if (type) valueSet.add(type);\n        });\n      });\n    });\n    ensureArrayBinding('viewfinderTypeOptions', result);\n    return result;\n  };\n\n  const collectViewfinderConnectors = () => {\n    const result = collectValues(defaultViewfinderConnectors, valueSet => {\n      const data = readDevices();\n      Object.values(data.cameras || {}).forEach(camera => {\n        if (!camera) return;\n        const list = Array.isArray(camera.viewfinder) ? camera.viewfinder : [];\n        list.forEach(entry => {\n          const connector = typeof entry?.connector === 'string' ? entry.connector.trim() : '';\n          if (connector) valueSet.add(connector);\n        });\n      });\n    });\n    ensureArrayBinding('viewfinderConnectorOptions', result);\n    return result;\n  };\n\n  const collectVideoPortOptions = () => {\n    const result = collectValues(defaultVideoPortOptions, valueSet => {\n      const data = readDevices();\n      const appendPorts = list => {\n        if (!Array.isArray(list)) return;\n        list.forEach(entry => {\n          if (typeof entry === 'string') {\n            const normalized = entry.trim();\n            if (normalized) valueSet.add(normalized);\n            return;\n          }\n          const type = typeof entry?.type === 'string' ? entry.type.trim() : '';\n          if (type) valueSet.add(type);\n          const portType = typeof entry?.portType === 'string' ? entry.portType.trim() : '';\n          if (portType) valueSet.add(portType);\n        });\n      };\n      Object.values(data.cameras || {}).forEach(camera => {\n        if (!camera) return;\n        appendPorts(camera.videoInputs);\n        appendPorts(camera.videoOutputs);\n      });\n      Object.values(data.monitors || {}).forEach(monitor => {\n        if (!monitor) return;\n        appendPorts(monitor.videoInputs);\n        appendPorts(monitor.videoOutputs);\n      });\n    });\n    return result;\n  };\n\n  ensureFunction('getAllViewfinderTypes', () => collectViewfinderTypes);\n  ensureFunction('getAllViewfinderConnectors', () => collectViewfinderConnectors);\n\n  if (!hasDocument) {\n    ensureFunction('setViewfinders', () => function noopSetViewfinders() { });\n    ensureFunction('getViewfinders', () => function noopGetViewfinders() { return []; });\n    ensureFunction('clearViewfinders', () => function noopClearViewfinders() { });\n    ensureFunction('setViewfinderVideoInputs', () => function noopSetViewfinderVideoInputs() { });\n    ensureFunction('getViewfinderVideoInputs', () => function noopGetViewfinderVideoInputs() { return []; });\n    ensureFunction('clearViewfinderVideoInputs', () => function noopClearViewfinderVideoInputs() { });\n    ensureFunction('setViewfinderVideoOutputs', () => function noopSetViewfinderVideoOutputs() { });\n    ensureFunction('getViewfinderVideoOutputs', () => function noopGetViewfinderVideoOutputs() { return []; });\n    ensureFunction('clearViewfinderVideoOutputs', () => function noopClearViewfinderVideoOutputs() { });\n    return;\n  }\n\n  const resolveContainer = id => {\n    if (!hasDocument || typeof document?.getElementById !== 'function') {\n      return null;\n    }\n    try {\n      return document.getElementById(id);\n    } catch (resolveError) {\n      void resolveError;\n      return null;\n    }\n  };\n\n  const viewfinderContainerEl = resolveContainer('viewfinderContainer');\n  const viewfinderInputsContainerEl = resolveContainer('viewfinderVideoInputsContainer');\n  const viewfinderOutputsContainerEl = resolveContainer('viewfinderVideoOutputsContainer');\n\n  const ensureContainers = [\n    ['setViewfinders', viewfinderContainerEl],\n    ['getViewfinders', viewfinderContainerEl],\n    ['clearViewfinders', viewfinderContainerEl],\n  ];\n\n  const missingRequiredContainer = ensureContainers.some(([name, container]) => {\n    if (container) {\n      return false;\n    }\n    ensureFunction(name, () => (name === 'getViewfinders' ? () => [] : () => { }));\n    return true;\n  });\n\n  if (missingRequiredContainer) {\n    return;\n  }\n\n  let fallbackIdCounter = 0;\n  const ensureElementId = (element, baseText) => {\n    if (!element) {\n      return '';\n    }\n    if (element.id) {\n      return element.id;\n    }\n    const base = typeof baseText === 'string' && baseText ? baseText : 'field';\n    fallbackIdCounter += 1;\n    const candidate = `${base.toLowerCase().replace(/[^a-z0-9]+/g, '-') || 'field'} -${fallbackIdCounter} `;\n    try {\n      element.id = candidate;\n    } catch (assignError) {\n      void assignError;\n    }\n    return element.id || candidate;\n  };\n\n  const createHiddenLabel = (id, text) => {\n    const label = document.createElement('label');\n    label.className = 'visually-hidden';\n    if (id) {\n      label.setAttribute('for', id);\n    }\n    label.textContent = typeof text === 'string' ? text : '';\n    return label;\n  };\n\n  const createFieldWithLabel = (field, labelText) => {\n    const wrapper = document.createElement('div');\n    wrapper.className = 'field-with-label';\n    wrapper.dataset.label = labelText;\n    const fieldId = ensureElementId(field, labelText);\n    wrapper.appendChild(createHiddenLabel(fieldId, labelText));\n    wrapper.appendChild(field);\n    return wrapper;\n  };\n\n  const populateSelectOptions = (select, options, value) => {\n    if (!select) {\n      return;\n    }\n    const seen = new Set();\n    select.innerHTML = '';\n    const addOption = (val, label) => {\n      if (seen.has(val)) {\n        return;\n      }\n      const option = document.createElement('option');\n      option.value = val;\n      option.textContent = typeof label === 'string' ? label : val;\n      select.appendChild(option);\n      seen.add(val);\n    };\n    addOption('', '');\n    options.forEach(optVal => {\n      if (typeof optVal !== 'string') {\n        return;\n      }\n      const trimmed = optVal.trim();\n      if (!trimmed) {\n        return;\n      }\n      addOption(trimmed, trimmed);\n    });\n    if (typeof value === 'string' && value && !seen.has(value)) {\n      addOption(value, value);\n    }\n    select.value = typeof value === 'string' ? value : '';\n  };\n\n  const createViewfinderRow = (type = '', resolution = '', connector = '', notes = '') => {\n    const row = document.createElement('div');\n    row.className = 'form-row';\n\n    const typeSelect = document.createElement('select');\n    typeSelect.className = 'viewfinder-type-select';\n    typeSelect.name = 'viewfinderType';\n    populateSelectOptions(typeSelect, collectViewfinderTypes(), typeof type === 'string' ? type.trim() : '');\n    row.appendChild(createFieldWithLabel(typeSelect, 'Type'));\n\n    const resolutionInput = document.createElement('input');\n    resolutionInput.type = 'text';\n    resolutionInput.name = 'viewfinderResolution';\n    resolutionInput.placeholder = 'Resolution';\n    resolutionInput.value = typeof resolution === 'string' ? resolution : '';\n    row.appendChild(createFieldWithLabel(resolutionInput, 'Resolution'));\n\n    const connectorSelect = document.createElement('select');\n    connectorSelect.className = 'viewfinder-connector-select';\n    connectorSelect.name = 'viewfinderConnector';\n    populateSelectOptions(connectorSelect, collectViewfinderConnectors(), typeof connector === 'string' ? connector.trim() : '');\n    row.appendChild(createFieldWithLabel(connectorSelect, 'Connector'));\n\n    const notesInput = document.createElement('input');\n    notesInput.type = 'text';\n    notesInput.name = 'viewfinderNotes';\n    notesInput.placeholder = 'Notes';\n    notesInput.value = typeof notes === 'string' ? notes : '';\n    row.appendChild(createFieldWithLabel(notesInput, 'Notes'));\n\n    const addBtn = document.createElement('button');\n    addBtn.type = 'button';\n    configureIconOnlyButton(addBtn, ICON_GLYPHS.add, {\n      contextPaths: ['viewfinderHeading', ['cameraViewfinderLabel']],\n      fallbackContext: 'Viewfinder',\n      actionKey: 'addEntry',\n    });\n    addBtn.addEventListener('click', () => {\n      row.after(createViewfinderRow());\n    });\n    row.appendChild(addBtn);\n\n    const removeBtn = document.createElement('button');\n    removeBtn.type = 'button';\n    configureIconOnlyButton(removeBtn, ICON_GLYPHS.minus, {\n      contextPaths: ['viewfinderHeading', ['cameraViewfinderLabel']],\n      fallbackContext: 'Viewfinder',\n      actionKey: 'removeEntry',\n    });\n    removeBtn.addEventListener('click', () => {\n      if (viewfinderContainerEl && viewfinderContainerEl.children.length > 1) {\n        row.remove();\n      } else {\n        Array.from(row.querySelectorAll('select, input')).forEach(field => {\n          if (field) {\n            field.value = '';\n          }\n        });\n      }\n    });\n    row.appendChild(removeBtn);\n\n    return row;\n  };\n\n  const createViewfinderVideoRow = (container, name, contextHeadingId, contextLabelId, fallbackContext, value = '') => {\n    if (!container) {\n      return null;\n    }\n    const row = document.createElement('div');\n    row.className = 'form-row';\n    const select = document.createElement('select');\n    select.name = name;\n    select.className = `${name} -select`;\n    populateSelectOptions(select, collectVideoPortOptions(), typeof value === 'string' ? value.trim() : '');\n    row.appendChild(createFieldWithLabel(select, 'Type'));\n\n    const addBtn = document.createElement('button');\n    addBtn.type = 'button';\n    configureIconOnlyButton(addBtn, ICON_GLYPHS.add, {\n      contextPaths: [contextHeadingId, [contextLabelId]],\n      fallbackContext,\n      actionKey: 'addEntry',\n    });\n    addBtn.addEventListener('click', () => {\n      row.after(createViewfinderVideoRow(container, name, contextHeadingId, contextLabelId, fallbackContext));\n    });\n    row.appendChild(addBtn);\n\n    const removeBtn = document.createElement('button');\n    removeBtn.type = 'button';\n    configureIconOnlyButton(removeBtn, ICON_GLYPHS.minus, {\n      contextPaths: [contextHeadingId, [contextLabelId]],\n      fallbackContext,\n      actionKey: 'removeEntry',\n    });\n    removeBtn.addEventListener('click', () => {\n      if (container.children.length > 1) {\n        row.remove();\n      } else {\n        select.value = '';\n      }\n    });\n    row.appendChild(removeBtn);\n\n    return row;\n  };\n\n  const setViewfindersFallback = list => {\n    if (!viewfinderContainerEl) {\n      return;\n    }\n    viewfinderContainerEl.innerHTML = '';\n    const entries = Array.isArray(list) ? list : [];\n    if (!entries.length) {\n      viewfinderContainerEl.appendChild(createViewfinderRow());\n      return;\n    }\n    entries.forEach(entry => {\n      const type = typeof entry?.type === 'string' ? entry.type : '';\n      const resolution = typeof entry?.resolution === 'string' ? entry.resolution : '';\n      const connector = typeof entry?.connector === 'string' ? entry.connector : '';\n      const notes = typeof entry?.notes === 'string' ? entry.notes : '';\n      viewfinderContainerEl.appendChild(createViewfinderRow(type, resolution, connector, notes));\n    });\n  };\n\n  const getViewfindersFallback = () => {\n    if (!viewfinderContainerEl) {\n      return [];\n    }\n    return Array.from(viewfinderContainerEl.querySelectorAll('.form-row')).map(row => {\n      const [typeSelect, resolutionInput, connectorSelect, notesInput] = row.querySelectorAll('select, input');\n      return {\n        type: typeSelect ? typeSelect.value : '',\n        resolution: resolutionInput ? resolutionInput.value : '',\n        connector: connectorSelect ? connectorSelect.value : '',\n        notes: notesInput ? notesInput.value : '',\n      };\n    }).filter(entry => entry.type);\n  };\n\n  const clearViewfindersFallback = () => {\n    setViewfindersFallback([]);\n  };\n\n  const setViewfinderVideoInputsFallback = list => {\n    if (!viewfinderInputsContainerEl) {\n      return;\n    }\n    viewfinderInputsContainerEl.innerHTML = '';\n    const entries = Array.isArray(list) ? list : [];\n    if (!entries.length) {\n      const row = createViewfinderVideoRow(\n        viewfinderInputsContainerEl,\n        'viewfinderVideoInput',\n        'viewfinderVideoInputsHeading',\n        'viewfinderVideoInputsLabel',\n        'Video Inputs'\n      );\n      if (row) {\n        viewfinderInputsContainerEl.appendChild(row);\n      }\n      return;\n    }\n    entries.forEach(entry => {\n      const value = typeof entry === 'string' ? entry : (typeof entry?.type === 'string' ? entry.type : '');\n      const row = createViewfinderVideoRow(\n        viewfinderInputsContainerEl,\n        'viewfinderVideoInput',\n        'viewfinderVideoInputsHeading',\n        'viewfinderVideoInputsLabel',\n        'Video Inputs',\n        value\n      );\n      if (row) {\n        viewfinderInputsContainerEl.appendChild(row);\n      }\n    });\n  };\n\n  const getViewfinderVideoInputsFallback = () => {\n    if (!viewfinderInputsContainerEl) {\n      return [];\n    }\n    return Array.from(viewfinderInputsContainerEl.querySelectorAll('select')).map(select => ({\n      type: select.value,\n    })).filter(entry => entry.type);\n  };\n\n  const clearViewfinderVideoInputsFallback = () => {\n    setViewfinderVideoInputsFallback([]);\n  };\n\n  const setViewfinderVideoOutputsFallback = list => {\n    if (!viewfinderOutputsContainerEl) {\n      return;\n    }\n    viewfinderOutputsContainerEl.innerHTML = '';\n    const entries = Array.isArray(list) ? list : [];\n    if (!entries.length) {\n      const row = createViewfinderVideoRow(\n        viewfinderOutputsContainerEl,\n        'viewfinderVideoOutput',\n        'viewfinderVideoOutputsHeading',\n        'viewfinderVideoOutputsLabel',\n        'Video Outputs'\n      );\n      if (row) {\n        viewfinderOutputsContainerEl.appendChild(row);\n      }\n      return;\n    }\n    entries.forEach(entry => {\n      const value = typeof entry === 'string' ? entry : (typeof entry?.type === 'string' ? entry.type : '');\n      const row = createViewfinderVideoRow(\n        viewfinderOutputsContainerEl,\n        'viewfinderVideoOutput',\n        'viewfinderVideoOutputsHeading',\n        'viewfinderVideoOutputsLabel',\n        'Video Outputs',\n        value\n      );\n      if (row) {\n        viewfinderOutputsContainerEl.appendChild(row);\n      }\n    });\n  };\n\n  const getViewfinderVideoOutputsFallback = () => {\n    if (!viewfinderOutputsContainerEl) {\n      return [];\n    }\n    return Array.from(viewfinderOutputsContainerEl.querySelectorAll('select')).map(select => ({\n      type: select.value,\n    })).filter(entry => entry.type);\n  };\n\n  const clearViewfinderVideoOutputsFallback = () => {\n    setViewfinderVideoOutputsFallback([]);\n  };\n\n  ensureFunction('setViewfinders', () => setViewfindersFallback);\n  ensureFunction('getViewfinders', () => getViewfindersFallback);\n  ensureFunction('clearViewfinders', () => clearViewfindersFallback);\n  ensureFunction('setViewfinderVideoInputs', () => setViewfinderVideoInputsFallback);\n  ensureFunction('getViewfinderVideoInputs', () => getViewfinderVideoInputsFallback);\n  ensureFunction('clearViewfinderVideoInputs', () => clearViewfinderVideoInputsFallback);\n  ensureFunction('setViewfinderVideoOutputs', () => setViewfinderVideoOutputsFallback);\n  ensureFunction('getViewfinderVideoOutputs', () => getViewfinderVideoOutputsFallback);\n  ensureFunction('clearViewfinderVideoOutputs', () => clearViewfinderVideoOutputsFallback);\n\n  if (viewfinderContainerEl && !viewfinderContainerEl.children.length) {\n    setViewfindersFallback([]);\n  }\n  if (viewfinderInputsContainerEl && !viewfinderInputsContainerEl.children.length) {\n    setViewfinderVideoInputsFallback([]);\n  }\n  if (viewfinderOutputsContainerEl && !viewfinderOutputsContainerEl.children.length) {\n    setViewfinderVideoOutputsFallback([]);\n  }\n})();\n\nfunction showFormSection(section) {\n  if (!section) return;\n  section.classList.remove('hidden');\n  if (typeof section.removeAttribute === 'function') {\n    section.removeAttribute('hidden');\n  }\n  section.hidden = false;\n  section.style.display = '';\n}\n\nfunction hideFormSection(section) {\n  if (!section) return;\n  section.classList.add('hidden');\n  if (typeof section.setAttribute === 'function') {\n    section.setAttribute('hidden', '');\n  }\n  section.hidden = true;\n  section.style.display = 'none';\n}\nconst addDeviceForm = wattFieldDiv ? wattFieldDiv.parentNode : null;\nfunction placeWattField(category, data) {\n  // Use locally resolved elements to avoid stale references from previous tests\n  const form = document.getElementById(\"addDeviceForm\");\n  const watt = document.getElementById(\"wattField\");\n  const video = document.getElementById(\"videoFields\");\n  const camera = document.getElementById(\"cameraFields\");\n\n  if (!watt || !form) return;\n\n  const isVideoLike =\n    category === \"video\" ||\n    category === \"wirelessReceivers\" ||\n    category === \"iosVideo\";\n\n  try {\n    if (isVideoLike && video && video.parentNode === form) {\n      form.insertBefore(watt, video);\n    } else if (camera && camera.parentNode === form) {\n      form.insertBefore(watt, camera);\n    } else {\n      form.appendChild(watt);\n    }\n  } catch (err) {\n    console.warn('placeWattField failed to insert element safely', err);\n  }\n}\n\ntry {\n  exposeCoreRuntimeConstant('placeWattField', placeWattField);\n} catch (error) {\n  void error;\n  if (typeof window !== 'undefined') window.placeWattField = placeWattField;\n}\nvar motorFieldsDiv = document.getElementById(\"motorFields\");\nvar motorConnectorInput = document.getElementById(\"motorConnector\");\nvar motorInternalInput = document.getElementById(\"motorInternal\");\nvar motorTorqueInput = document.getElementById(\"motorTorque\");\nvar motorGearInput = document.getElementById(\"motorGearTypes\");\nvar motorNotesInput = document.getElementById(\"motorNotes\");\nvar controllerFieldsDiv = document.getElementById(\"controllerFields\");\nvar controllerConnectorInput = document.getElementById(\"controllerConnector\");\nvar controllerPowerInput = document.getElementById(\"controllerPower\");\nvar controllerBatteryInput = document.getElementById(\"controllerBattery\");\nvar controllerConnectivityInput = document.getElementById(\"controllerConnectivity\");\nvar controllerNotesInput = document.getElementById(\"controllerNotes\");\nvar distanceFieldsDiv = document.getElementById(\"distanceFields\");\nvar distanceConnectionInput = document.getElementById(\"distanceConnection\");\nvar distanceMethodInput = document.getElementById(\"distanceMethod\");\nvar distanceRangeInput = document.getElementById(\"distanceRange\");\nvar distanceAccuracyInput = document.getElementById(\"distanceAccuracy\");\nvar distanceOutputInput = document.getElementById(\"distanceOutput\");\nvar distanceNotesInput = document.getElementById(\"distanceNotes\");\nconst batteryPlatesContainer = document.getElementById(\"batteryPlatesContainer\");\nconst cameraMediaContainer = document.getElementById(\"cameraMediaContainer\");\nconst lensMountContainer = document.getElementById(\"lensMountContainer\");\nvar lensFocusScaleSelect = document.getElementById(\"lensFocusScaleUnit\");\nconst powerDistContainer = document.getElementById(\"powerDistContainer\");\nconst videoOutputsContainer = document.getElementById(\"videoOutputsContainer\");\nconst fizConnectorContainer = document.getElementById(\"fizConnectorContainer\");\n\nvar viewfinderContainer = document.getElementById(\"viewfinderContainer\");\nconst timecodeContainer = document.getElementById(\"timecodeContainer\");\nvar batteryFieldsDiv = document.getElementById(\"batteryFields\");\nvar newCapacityInput = document.getElementById(\"newCapacity\");\nvar newPinAInput = document.getElementById(\"newPinA\");\nvar newDtapAInput = document.getElementById(\"newDtapA\");\nvar dtapRow = newDtapAInput ? newDtapAInput.parentElement : null;\nvar addDeviceBtn = document.getElementById(\"addDeviceBtn\");\nvar cancelEditBtn = document.getElementById(\"cancelEditBtn\");\nvar exportBtn = document.getElementById(\"exportDataBtn\");\nvar exportOutput = document.getElementById(\"exportOutput\");\nvar importFileInput = document.getElementById(\"importFileInput\");\nvar importDataBtn = document.getElementById(\"importDataBtn\");\nvar skipLink = document.getElementById(\"skipLink\");\n\nfunction resolveGlobalFocusScalePreference() {\n  const scope =\n    (typeof globalThis !== 'undefined' && globalThis)\n    || (typeof window !== 'undefined' && window)\n    || (typeof self !== 'undefined' && self)\n    || (typeof global !== 'undefined' && global)\n    || null;\n  const scopePreference = scope && typeof scope.focusScalePreference === 'string'\n    ? scope.focusScalePreference\n    : null;\n  const rawPreference = scopePreference\n    || (typeof focusScalePreference === 'string' ? focusScalePreference : null)\n    || 'metric';\n  if (typeof normalizeFocusScale === 'function') {\n    try {\n      const normalized = normalizeFocusScale(rawPreference);\n      if (normalized === 'imperial' || normalized === 'metric') {\n        return normalized;\n      }\n    } catch (focusScaleNormalizeError) {\n      void focusScaleNormalizeError;\n    }\n  }\n  const normalized = typeof rawPreference === 'string' ? rawPreference.trim().toLowerCase() : '';\n  return normalized === 'imperial' ? 'imperial' : 'metric';\n}\n\nconst monitorExcludedAttributes = [\n  \"screenSizeInches\",\n  \"brightnessNits\",\n  \"power\",\n  \"powerDrawWatts\",\n  \"videoInputs\",\n  \"videoOutputs\",\n  \"wirelessTx\",\n  \"latencyMs\",\n  \"audioOutput\"\n];\n\nvar categoryExcludedAttrs = {\n  batteries: [\"capacity\", \"pinA\", \"dtapA\", \"pinV\"],\n  batteryHotswaps: [\"capacity\", \"pinA\", \"dtapA\"],\n  \"accessories.batteries\": [\"capacity\", \"pinA\", \"dtapA\", \"pinV\"],\n  \"accessories.batteryHotswaps\": [\"capacity\", \"pinA\", \"dtapA\"],\n  cameras: [\"powerDrawWatts\", \"power\", \"recordingMedia\", \"lensMount\", \"videoOutputs\", \"fizConnectors\", \"viewfinder\", \"timecode\"],\n  lenses: [\"mount\", \"mountOptions\", \"focusScale\"],\n  monitors: monitorExcludedAttributes,\n  directorMonitors: monitorExcludedAttributes,\n  viewfinders: [\"screenSizeInches\", \"brightnessNits\", \"power\", \"powerDrawWatts\", \"videoInputs\", \"videoOutputs\", \"wirelessTx\", \"latencyMs\"],\n  video: [\"powerDrawWatts\", \"power\", \"videoInputs\", \"videoOutputs\", \"frequency\", \"latencyMs\"],\n  wirelessReceivers: [\"powerDrawWatts\", \"power\", \"videoInputs\", \"videoOutputs\", \"frequency\", \"latencyMs\"],\n  iosVideo: [\"powerDrawWatts\", \"power\", \"videoInputs\", \"videoOutputs\", \"frequency\", \"latencyMs\"],\n  \"fiz.motors\": [\"fizConnectors\", \"gearTypes\", \"internalController\", \"notes\", \"powerDrawWatts\", \"torqueNm\"],\n  \"fiz.controllers\": [\"batteryType\", \"connectivity\", \"fizConnectors\", \"internalController\", \"notes\", \"powerDrawWatts\", \"powerSource\"],\n  \"fiz.distance\": [\"accuracy\", \"connectionCompatibility\", \"measurementMethod\", \"measurementRange\", \"notes\", \"outputDisplay\", \"powerDrawWatts\"]\n};\n\nfunction updateLensFocusScaleSelectOptions(lang = currentLang, { preserveValue = true } = {}) {\n  if (!lensFocusScaleSelect) {\n    return;\n  }\n\n  const previousValue = preserveValue ? lensFocusScaleSelect.value : '';\n  const language = typeof lang === 'string' ? lang : currentLang;\n  const languageTexts = texts && language && texts[language] ? texts[language] : texts?.en || {};\n  const defaultLabelBase = languageTexts.lensFocusScaleDefault\n    || languageTexts.focusScaleSetting\n    || 'Use global focus scale';\n  const metricLabel = languageTexts.focusScaleMetric || 'Metric';\n  const imperialLabel = languageTexts.focusScaleImperial || 'Imperial';\n  const globalPreference = resolveGlobalFocusScalePreference();\n  const defaultLabel =\n    globalPreference === 'imperial'\n      ? `${defaultLabelBase} (${imperialLabel})`\n      : `${defaultLabelBase} (${metricLabel})`;\n\n  const desiredValue = previousValue && (previousValue === 'metric' || previousValue === 'imperial')\n    ? previousValue\n    : '';\n\n  lensFocusScaleSelect.innerHTML = '';\n\n  const addOption = (value, label) => {\n    const option = document.createElement('option');\n    option.value = value;\n    option.textContent = label;\n    lensFocusScaleSelect.appendChild(option);\n  };\n\n  addOption('', defaultLabel);\n  addOption('metric', metricLabel);\n  addOption('imperial', imperialLabel);\n\n  lensFocusScaleSelect.value = desiredValue;\n}\n\nconst schemaFieldConfigs = {\n  '*': {\n    brand: { type: 'text', placeholder: 'ARRI' },\n    model: { type: 'text', placeholder: 'Mini LF' },\n    notes: { type: 'textarea', rows: 3, placeholder: 'Additional notes' }\n  },\n  batteries: {\n    mount_type: { type: 'text', placeholder: 'V-Mount' },\n    pinV: { type: 'number', step: '0.1', suffix: 'V' },\n    weight_g: { type: 'number', step: '1', suffix: 'g' }\n  },\n  'accessories.batteries': {\n    mount_type: { type: 'text', placeholder: 'V-Mount' },\n    pinV: { type: 'number', step: '0.1', suffix: 'V' },\n    weight_g: { type: 'number', step: '1', suffix: 'g' }\n  },\n  batteryHotswaps: {\n    mount_type: { type: 'text', placeholder: 'Gold Mount' },\n    pinV: { type: 'number', step: '0.1', suffix: 'V' },\n    weight_g: { type: 'number', step: '1', suffix: 'g' }\n  },\n  cameras: {\n    recordingCodecs: { type: 'list', placeholder: 'ProRes 422 HQ' },\n    frameRates: { type: 'list', placeholder: '4K 120 fps' },\n    resolutions: { type: 'list', placeholder: '4.5K Open Gate' },\n    sensorModes: { type: 'list', placeholder: 'LF Open Gate' },\n    viewfinder: { type: 'json', rows: 4 },\n    timecode: { type: 'json', rows: 3 },\n    weight_g: { type: 'number', step: '1', suffix: 'g' }\n  },\n  monitors: {\n    audioInput: { type: 'text', placeholder: '3.5mm stereo' },\n    audioIo: { type: 'text', placeholder: 'SDI / HDMI' },\n    audioOutput: { type: 'text', placeholder: '3.5mm stereo' },\n    bluetooth: { type: 'boolean' },\n    latencyMs: { type: 'text', placeholder: '< 1ms' },\n    wireless: { type: 'text', placeholder: 'Bolt 6' },\n    wirelessRX: { type: 'boolean' },\n    wirelessTx: { type: 'boolean' }\n  },\n  directorMonitors: {\n    audioInput: { type: 'text', placeholder: '3.5mm stereo' },\n    audioIo: { type: 'text', placeholder: 'SDI / HDMI' },\n    audioOutput: { type: 'text', placeholder: '3.5mm stereo' },\n    bluetooth: { type: 'boolean' },\n    latencyMs: { type: 'text', placeholder: '< 1ms' },\n    wireless: { type: 'text', placeholder: 'Bolt 6' },\n    wirelessRX: { type: 'boolean' },\n    wirelessTx: { type: 'boolean' }\n  },\n  video: {\n    frequency: { type: 'text', placeholder: '5 GHz' },\n    latencyMs: { type: 'text', placeholder: '1 ms' }\n  },\n  wirelessReceivers: {\n    frequency: { type: 'text', placeholder: '5 GHz' },\n    latencyMs: { type: 'text', placeholder: '1 ms' }\n  },\n  iosVideo: {\n    frequency: { type: 'text', placeholder: '5 GHz' },\n    latencyMs: { type: 'text', placeholder: '1 ms' }\n  },\n  'fiz.motors': {\n    gearTypes: { type: 'list', placeholder: '0.8 MOD' },\n    internalController: { type: 'boolean' }\n  },\n  'fiz.controllers': {\n    connectivity: { type: 'text', placeholder: '2.4 GHz' },\n    internalController: { type: 'boolean' }\n  },\n  'fiz.distance': {\n    accuracy: { type: 'text', placeholder: ' 1\"' }\n  }\n};\n\nfunction formatAttributeLabel(attr) {\n  return attr\n    .replace(/([A-Z])/g, ' $1')\n    .replace(/_/g, ' ')\n    .replace(/^./, ch => ch.toUpperCase())\n    .trim();\n}\n\nfunction resolveSchemaFieldConfig(category, attr) {\n  if (!category) return schemaFieldConfigs['*'][attr] || null;\n  const parts = category.split('.');\n  while (parts.length) {\n    const key = parts.join('.');\n    if (schemaFieldConfigs[key] && schemaFieldConfigs[key][attr]) {\n      return schemaFieldConfigs[key][attr];\n    }\n    parts.pop();\n  }\n  return schemaFieldConfigs['*'][attr] || null;\n}\n\nfunction autoRows(text, min = 3, max = 10) {\n  if (!text) return min;\n  const lines = text.split('\\n').length + 1;\n  return Math.max(min, Math.min(max, lines));\n}\n\nfunction normalizeSchemaListValues(value) {\n  if (Array.isArray(value)) {\n    return value\n      .map(item => (item === null || item === undefined ? '' : String(item).trim()))\n      .filter(Boolean);\n  }\n  if (typeof value === 'string') {\n    return value\n      .split(/\\r?\\n/)\n      .map(item => item.trim())\n      .filter(Boolean);\n  }\n  return [];\n}\n\nfunction createSchemaListControl(options) {\n  const {\n    attrId,\n    labelText,\n    values = [],\n    placeholder = ''\n  } = options || {};\n\n  const ensureId = typeof ensureElementId === 'function'\n    ? ensureElementId\n    : (element, baseText) => {\n      if (!element) return '';\n      if (element.id) return element.id;\n      const base = (baseText || 'field').toString().toLowerCase().replace(/[^a-z0-9]+/g, '-') || 'field';\n      let counter = 0;\n      let candidate = '';\n      do {\n        counter += 1;\n        candidate = `${base} -${counter} `;\n      } while (typeof document !== 'undefined' && document.getElementById(candidate));\n      try {\n        element.id = candidate;\n      } catch (assignError) {\n        void assignError;\n      }\n      return element.id || candidate;\n    };\n\n  const createLabel = typeof createHiddenLabel === 'function'\n    ? createHiddenLabel\n    : (forId, text) => {\n      const label = document.createElement('label');\n      label.className = 'visually-hidden';\n      if (forId) label.setAttribute('for', forId);\n      label.textContent = typeof text === 'string' ? text : '';\n      return label;\n    };\n\n  const container = document.createElement('div');\n  container.className = 'schema-list-control';\n  container.id = attrId;\n  container.dataset.attrType = 'list';\n\n  const listBody = document.createElement('div');\n  listBody.className = 'schema-list-body';\n\n  const normalizedValues = normalizeSchemaListValues(values);\n  const normalizedPlaceholder = typeof placeholder === 'string' ? placeholder : '';\n  const fallbackContext = typeof labelText === 'string' && labelText ? labelText : attrId || '';\n\n  const createRow = (initialValue = '') => {\n    const row = document.createElement('div');\n    row.className = 'schema-list-row';\n\n    const inputWrapper = document.createElement('div');\n    inputWrapper.className = 'schema-list-row-input';\n\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.className = 'schema-input schema-list-input';\n    input.dataset.listItem = 'true';\n    if (normalizedPlaceholder) {\n      input.placeholder = normalizedPlaceholder;\n    }\n    input.value = initialValue === null || initialValue === undefined ? '' : String(initialValue);\n\n    const inputId = ensureId(input, `${attrId || 'list'} -item`);\n    inputWrapper.appendChild(createLabel(inputId, labelText));\n    inputWrapper.appendChild(input);\n\n    const actions = document.createElement('div');\n    actions.className = 'schema-list-row-actions';\n\n    const addBtn = document.createElement('button');\n    addBtn.type = 'button';\n    if (typeof configureIconOnlyButton === 'function' && typeof ICON_GLYPHS !== 'undefined') {\n      configureIconOnlyButton(addBtn, ICON_GLYPHS.add, {\n        fallbackContext,\n        actionKey: 'addEntry',\n      });\n    } else {\n      addBtn.textContent = '+';\n      addBtn.setAttribute('aria-label', 'Add');\n    }\n\n    addBtn.addEventListener('click', () => {\n      const newRow = createRow('');\n      row.after(newRow);\n      const nextInput = newRow.querySelector('[data-list-item=\"true\"]');\n      if (nextInput && typeof nextInput.focus === 'function') {\n        nextInput.focus();\n      }\n    });\n\n    const removeBtn = document.createElement('button');\n    removeBtn.type = 'button';\n    if (typeof configureIconOnlyButton === 'function' && typeof ICON_GLYPHS !== 'undefined') {\n      configureIconOnlyButton(removeBtn, ICON_GLYPHS.minus, {\n        fallbackContext,\n        actionKey: 'removeEntry',\n      });\n    } else {\n      removeBtn.textContent = '';\n      removeBtn.setAttribute('aria-label', 'Remove');\n    }\n\n    removeBtn.addEventListener('click', () => {\n      const rows = Array.from(listBody.querySelectorAll('.schema-list-row'));\n      if (rows.length > 1) {\n        row.remove();\n        return;\n      }\n      input.value = '';\n      if (typeof input.focus === 'function') {\n        input.focus();\n      }\n    });\n\n    actions.appendChild(addBtn);\n    actions.appendChild(removeBtn);\n\n    row.appendChild(inputWrapper);\n    row.appendChild(actions);\n    return row;\n  };\n\n  if (normalizedValues.length) {\n    normalizedValues.forEach(val => {\n      listBody.appendChild(createRow(val));\n    });\n  } else {\n    listBody.appendChild(createRow(''));\n  }\n\n  container.appendChild(listBody);\n\n  return container;\n}\n\nfunction createSchemaField(category, attr, value) {\n  const config = resolveSchemaFieldConfig(category, attr) || {};\n  const attrId = `attr - ${attr} `;\n  const labelText = config.label || formatAttributeLabel(attr);\n  let inputType = config.type;\n\n  if (!inputType) {\n    if (Array.isArray(value)) {\n      inputType = value.every(item => typeof item === 'string') ? 'list' : 'json';\n    } else if (typeof value === 'number') {\n      inputType = 'number';\n    } else if (typeof value === 'boolean') {\n      inputType = 'boolean';\n    } else if (value && typeof value === 'object') {\n      inputType = 'json';\n    } else {\n      inputType = 'text';\n    }\n  }\n\n  if (inputType === 'boolean') {\n    const row = document.createElement('div');\n    row.className = 'form-row schema-form-row';\n\n    const label = document.createElement('label');\n    label.setAttribute('for', attrId);\n    label.textContent = labelText;\n    row.appendChild(label);\n\n    const controlContainer = document.createElement('div');\n    controlContainer.className = 'schema-control schema-control--checkbox';\n    const inlineWrap = document.createElement('div');\n    inlineWrap.className = 'schema-control-inline';\n\n    const input = document.createElement('input');\n    input.type = 'checkbox';\n    input.id = attrId;\n    input.className = 'schema-input schema-input--checkbox';\n    input.dataset.attrType = 'boolean';\n    input.checked = value === undefined ? !!config.default : !!value;\n    inlineWrap.appendChild(input);\n\n    controlContainer.appendChild(inlineWrap);\n    if (config.help) {\n      const help = document.createElement('p');\n      help.className = 'schema-field-help';\n      help.textContent = config.help;\n      controlContainer.appendChild(help);\n    }\n\n    row.appendChild(controlContainer);\n    return row;\n  }\n\n  const row = document.createElement('div');\n  row.className = 'form-row schema-form-row';\n  const label = document.createElement('label');\n  label.setAttribute('for', attrId);\n  label.textContent = labelText;\n  row.appendChild(label);\n\n  let control;\n  if (inputType === 'list') {\n    control = createSchemaListControl({\n      attrId,\n      labelText,\n      values: value,\n      placeholder: config.placeholder\n    });\n  } else if (inputType === 'json' || inputType === 'textarea') {\n    control = document.createElement('textarea');\n    control.className = 'schema-input schema-input--textarea';\n    control.id = attrId;\n    const textValue = value === undefined || value === null\n      ? ''\n      : inputType === 'list' && Array.isArray(value)\n        ? value.join('\\n')\n        : typeof value === 'string'\n          ? value\n          : JSON.stringify(value, null, 2);\n    control.value = textValue;\n    control.rows = config.rows || autoRows(control.value);\n  } else {\n    control = document.createElement('input');\n    control.className = 'schema-input';\n    control.id = attrId;\n    control.type = inputType === 'number' ? 'number' : 'text';\n    if (inputType === 'number') {\n      if (config.step) control.step = config.step;\n    }\n    if (value !== undefined && value !== null) {\n      control.value = value;\n    }\n  }\n\n  if (control && control.dataset) {\n    control.dataset.attrType = inputType;\n  }\n  if (config.placeholder && !control.value) {\n    control.placeholder = config.placeholder;\n  }\n\n  const controlContainer = document.createElement('div');\n  controlContainer.className = 'schema-control';\n  const inlineWrap = document.createElement('div');\n  inlineWrap.className = 'schema-control-inline';\n  inlineWrap.appendChild(control);\n  if (config.suffix) {\n    const suffix = document.createElement('span');\n    suffix.className = 'schema-field-suffix';\n    suffix.textContent = config.suffix;\n    inlineWrap.appendChild(suffix);\n  }\n  controlContainer.appendChild(inlineWrap);\n\n  if (config.help) {\n    const help = document.createElement('p');\n    help.className = 'schema-field-help';\n    help.textContent = config.help;\n    controlContainer.appendChild(help);\n  }\n\n  row.appendChild(controlContainer);\n\n  return row;\n}\n\nfunction getSchemaAttributesForCategory(category) {\n  if (!deviceSchema) return [];\n  const parts = category.split('.');\n  let node = deviceSchema;\n  for (const p of parts) {\n    node = node && node[p];\n    if (!node) return [];\n  }\n  return Array.isArray(node.attributes) ? node.attributes : [];\n}\n\nfunction getCombinedCategoryAttributes(category, data = {}, exclude = []) {\n  const seen = new Set();\n  const attrs = [];\n  const skip = (attr) => !attr || exclude.includes(attr) || seen.has(attr);\n\n  const schemaAttrs = getSchemaAttributesForCategory(category);\n\n  for (const attr of schemaAttrs) {\n    if (skip(attr)) continue;\n    seen.add(attr);\n    attrs.push(attr);\n  }\n\n  if (data && typeof data === 'object' && !Array.isArray(data)) {\n    for (const key of Object.keys(data)) {\n      if (skip(key)) continue;\n      seen.add(key);\n      attrs.push(key);\n    }\n  }\n\n  return attrs;\n}\n\nfunction clearDynamicFields() {\n  if (!dynamicFieldsDiv) return;\n  dynamicFieldsDiv.innerHTML = '';\n  dynamicFieldsDiv.hidden = true;\n  if (dynamicFieldsDiv.dataset) {\n    delete dynamicFieldsDiv.dataset.attrs;\n  }\n}\n\nfunction buildDynamicFields(category, data = {}, exclude = []) {\n  if (typeof dynamicFieldsDiv === 'undefined' || !dynamicFieldsDiv) {\n    if (typeof document !== 'undefined') {\n      window.dynamicFieldsDiv = document.getElementById('dynamicFields');\n    }\n    if (!dynamicFieldsDiv) {\n      return;\n    }\n  }\n  const attrs = getCombinedCategoryAttributes(category, data, exclude);\n  dynamicFieldsDiv.innerHTML = '';\n  if (!attrs.length) {\n    dynamicFieldsDiv.hidden = true;\n    if (dynamicFieldsDiv.dataset) {\n      delete dynamicFieldsDiv.dataset.attrs;\n    }\n    return;\n  }\n  dynamicFieldsDiv.hidden = false;\n  if (dynamicFieldsDiv.dataset) {\n    dynamicFieldsDiv.dataset.attrs = JSON.stringify(attrs);\n  }\n  const list = document.createElement('div');\n  list.className = 'schema-attribute-list';\n  for (const attr of attrs) {\n    const value = data && data[attr] !== undefined ? data[attr] : undefined;\n    list.appendChild(createSchemaField(category, attr, value));\n  }\n  dynamicFieldsDiv.appendChild(list);\n  console.log('[buildDynamicFields] Successfully added', attrs.length, 'fields');\n}\n\nconst COLLECTED_DYNAMIC_ATTRS_SYMBOL =\n  typeof Symbol === 'function' ? Symbol('collectedDynamicAttrs') : '__collectedDynamicAttrs';\n\nfunction markCollectedDynamicAttributes(target, attrs) {\n  if (!target || !Array.isArray(attrs)) {\n    return;\n  }\n  try {\n    Object.defineProperty(target, COLLECTED_DYNAMIC_ATTRS_SYMBOL, {\n      configurable: true,\n      enumerable: false,\n      value: attrs.slice(),\n    });\n  } catch (error) {\n    void error;\n  }\n}\n\nfunction getCollectedDynamicAttributes(source) {\n  if (!source || typeof source !== 'object') {\n    return [];\n  }\n  const attrs = source[COLLECTED_DYNAMIC_ATTRS_SYMBOL];\n  return Array.isArray(attrs) ? attrs : [];\n}\n\nfunction removeClearedDynamicAttributes(target, attrs, values) {\n  if (!target || !Array.isArray(attrs)) {\n    return;\n  }\n  attrs.forEach(attr => {\n    if (\n      Object.prototype.hasOwnProperty.call(target, attr) &&\n      !Object.prototype.hasOwnProperty.call(values, attr)\n    ) {\n      delete target[attr];\n    }\n  });\n}\n\nfunction collectDynamicFieldValues(category, exclude = []) {\n  let attrs = [];\n  let rawDynamicFieldAttrs = '';\n  const excludeSnapshot = Array.isArray(exclude) ? exclude.slice() : exclude;\n  if (dynamicFieldsDiv && dynamicFieldsDiv.dataset && dynamicFieldsDiv.dataset.attrs) {\n    rawDynamicFieldAttrs = String(dynamicFieldsDiv.dataset.attrs);\n    try {\n      const parsed = JSON.parse(rawDynamicFieldAttrs);\n      if (Array.isArray(parsed)) {\n        attrs = parsed;\n      }\n    } catch (err) {\n      const LOG_ATTR_SNIPPET_LIMIT = 500;\n      const rawAttrsSnippet = rawDynamicFieldAttrs.slice(0, LOG_ATTR_SNIPPET_LIMIT);\n      console.warn('Failed to parse dynamic field attributes', {\n        error: err,\n        rawAttrsSnippet,\n        rawAttrsTruncated: rawDynamicFieldAttrs.length > LOG_ATTR_SNIPPET_LIMIT,\n        category,\n        exclude: excludeSnapshot,\n      });\n    }\n  }\n  if (!attrs.length) {\n    attrs = getCombinedCategoryAttributes(category, {}, exclude);\n  }\n  const filteredAttrs = attrs.filter(attr => !exclude.includes(attr));\n  const result = {};\n  for (const attr of filteredAttrs) {\n    const el = document.getElementById(`attr - ${attr} `);\n    if (!el) {\n      continue;\n    }\n    const type = el.dataset.attrType || el.type;\n    if (type === 'boolean') {\n      result[attr] = el.checked;\n      continue;\n    }\n    if (type === 'list') {\n      const listInputs = Array.from(el.querySelectorAll('[data-list-item=\"true\"]'));\n      let list = [];\n      if (listInputs.length) {\n        list = listInputs\n          .map(input => (typeof input.value === 'string' ? input.value.trim() : ''))\n          .filter(Boolean);\n      } else if (typeof el.value === 'string') {\n        list = el.value\n          .split('\\n')\n          .map(item => item.trim())\n          .filter(Boolean);\n      }\n      if (list.length) {\n        result[attr] = list;\n      }\n      continue;\n    }\n    if (type === 'json') {\n      const raw = el.value.trim();\n      if (raw) {\n        try {\n          result[attr] = JSON.parse(raw);\n        } catch {\n          result[attr] = raw;\n        }\n      }\n      continue;\n    }\n    if (type === 'number') {\n      const num = parseFloat(el.value);\n      if (!isNaN(num)) {\n        result[attr] = num;\n      }\n      continue;\n    }\n    if (el.value !== '') {\n      result[attr] = el.value;\n    }\n  }\n  markCollectedDynamicAttributes(result, filteredAttrs);\n  return result;\n}\n\nfunction cloneDynamicFieldTarget(target) {\n  const clone = {};\n  if (\n    typeof Object.getPrototypeOf === 'function' &&\n    typeof Object.setPrototypeOf === 'function'\n  ) {\n    try {\n      Object.setPrototypeOf(clone, Object.getPrototypeOf(target));\n    } catch (protoError) {\n      void protoError;\n    }\n  }\n\n  const keys =\n    typeof Reflect !== 'undefined' && typeof Reflect.ownKeys === 'function'\n      ? Reflect.ownKeys(target)\n      : Object.getOwnPropertyNames(target);\n\n  for (let index = 0; index < keys.length; index += 1) {\n    const key = keys[index];\n\n    let descriptor;\n    try {\n      descriptor = Object.getOwnPropertyDescriptor(target, key);\n    } catch (descError) {\n      descriptor = null;\n    }\n\n    if (!descriptor) {\n      continue;\n    }\n\n    const nextDescriptor = {\n      configurable: true,\n      enumerable: !!descriptor.enumerable,\n    };\n\n    if (Object.prototype.hasOwnProperty.call(descriptor, 'value')) {\n      nextDescriptor.value = descriptor.value;\n      nextDescriptor.writable = true;\n    } else {\n      nextDescriptor.get = descriptor.get;\n      nextDescriptor.set = descriptor.set;\n    }\n\n    try {\n      Object.defineProperty(clone, key, nextDescriptor);\n    } catch (defineError) {\n      void defineError;\n      clone[key] = descriptor.value;\n    }\n  }\n\n  return clone;\n}\n\nfunction ensureWritableDynamicFieldTarget(target, attrs) {\n  if (!target || typeof target !== 'object') {\n    return {};\n  }\n\n  let requiresClone = false;\n\n  try {\n    if (typeof Object.isExtensible === 'function' && !Object.isExtensible(target)) {\n      requiresClone = true;\n    }\n  } catch (extensibleError) {\n    void extensibleError;\n  }\n\n  if (!requiresClone && Array.isArray(attrs)) {\n    for (let index = 0; index < attrs.length; index += 1) {\n      const attr = attrs[index];\n      let descriptor;\n      try {\n        descriptor = Object.getOwnPropertyDescriptor(target, attr);\n      } catch (descriptorError) {\n        descriptor = null;\n      }\n      if (\n        descriptor &&\n        Object.prototype.hasOwnProperty.call(descriptor, 'writable') &&\n        descriptor.writable === false &&\n        descriptor.configurable === false\n      ) {\n        requiresClone = true;\n        break;\n      }\n    }\n  }\n\n  if (!requiresClone) {\n    return target;\n  }\n\n  return cloneDynamicFieldTarget(target);\n}\n\nfunction applyDynamicFieldValues(target, category, exclude = []) {\n  const values = collectDynamicFieldValues(category, exclude);\n  const attrs = getCollectedDynamicAttributes(values);\n  let writableTarget = ensureWritableDynamicFieldTarget(target, attrs);\n\n  try {\n    Object.assign(writableTarget, values);\n  } catch (assignError) {\n    const fallbackTarget = cloneDynamicFieldTarget(writableTarget);\n    try {\n      Object.assign(fallbackTarget, values);\n      writableTarget = fallbackTarget;\n    } catch (fallbackError) {\n      console.error('Failed to apply dynamic field values', fallbackError);\n    }\n  }\n\n  removeClearedDynamicAttributes(writableTarget, attrs, values);\n  return writableTarget;\n}\nvar languageSelect = document.getElementById(\"languageSelect\");\nvar settingsTablist = document.getElementById(\"settingsTablist\");\nvar pinkModeToggle = document.getElementById(\"pinkModeToggle\");\nvar pinkModeHelpIcon = document.getElementById(\"pinkModeHelpIcon\");\nvar darkModeToggle = document.getElementById(\"darkModeToggle\");\nvar helpButton = document.getElementById(\"helpButton\");\nvar reloadButton = document.getElementById(\"reloadButton\");\nvar helpDialog = document.getElementById(\"helpDialog\");\nvar closeHelpBtn = document.getElementById(\"closeHelp\");\nvar helpSearch = document.getElementById(\"helpSearch\");\nvar helpNoResults = document.getElementById(\"helpNoResults\");\nvar helpNoResultsSuggestions = document.getElementById(\"helpNoResultsSuggestions\");\nvar helpNoResultsSuggestionsHeading = document.getElementById(\"helpNoResultsSuggestionsHeading\");\nvar helpNoResultsSuggestionsIntro = document.getElementById(\"helpNoResultsSuggestionsIntro\");\nvar helpNoResultsSuggestionClear = document.getElementById(\"helpNoResultsSuggestionClear\");\nvar helpNoResultsSuggestionSynonyms = document.getElementById(\"helpNoResultsSuggestionSynonyms\");\nvar helpNoResultsSuggestionQuickStart = document.getElementById(\"helpNoResultsSuggestionQuickStart\");\nvar helpNoResultsSuggestionBackup = document.getElementById(\"helpNoResultsSuggestionBackup\");\nvar helpDataAuditHeading = document.getElementById(\"helpDataAuditHeading\");\nvar helpDataAuditStep1 = document.getElementById(\"helpDataAuditStep1\");\nvar helpDataAuditStep2 = document.getElementById(\"helpDataAuditStep2\");\nvar helpDataAuditStep3 = document.getElementById(\"helpDataAuditStep3\");\nvar helpDataAuditStep4 = document.getElementById(\"helpDataAuditStep4\");\nvar helpDataAuditNote = document.getElementById(\"helpDataAuditNote\");\nvar helpResultsSummary = document.getElementById(\"helpResultsSummary\");\nvar helpResultsAssist = document.getElementById(\"helpResultsAssist\");\nvar helpSearchClear = document.getElementById(\"helpSearchClear\");\nvar helpSectionsContainer = document.getElementById(\"helpSections\");\nvar helpQuickLinksNav = document.getElementById(\"helpQuickLinks\");\nvar helpQuickLinksHeading = document.getElementById(\"helpQuickLinksHeading\");\nvar helpQuickLinksList = document.getElementById(\"helpQuickLinksList\");\nvar installPromptBanner;\nvar installPromptBannerText;\nvar installPromptBannerAction;\nvar installPromptBannerIcon;\nvar installPromptBannerDismiss;\nvar installGuideDialog;\nvar installGuideTitle;\nvar installGuideIntro;\nvar installGuideSteps;\nvar installGuideNote;\nvar installGuideMigration;\nvar installGuideMigrationTitle;\nvar installGuideMigrationIntro;\nvar installGuideMigrationSteps;\nvar installGuideMigrationNote;\nvar installGuideClose;\nvar iosPwaHelpDialog = document.getElementById(\"iosPwaHelpDialog\");\nvar iosPwaHelpTitle;\nvar iosPwaHelpIntro;\nvar iosPwaHelpStep1;\nvar installPromptElementsInitialized = false;\n\nfunction ensureInstallPromptElements() {\n  if (installPromptElementsInitialized && installPromptBanner) {\n    return;\n  }\n  if (typeof document === 'undefined') {\n    installPromptElementsInitialized = true;\n    installPromptBanner = installPromptBanner || null;\n    installPromptBannerText = installPromptBannerText || null;\n    installPromptBannerAction = installPromptBannerAction || null;\n    installPromptBannerIcon = installPromptBannerIcon || null;\n    installPromptBannerDismiss = installPromptBannerDismiss || null;\n    installGuideDialog = installGuideDialog || null;\n    installGuideTitle = installGuideTitle || null;\n    installGuideIntro = installGuideIntro || null;\n    installGuideSteps = installGuideSteps || null;\n    installGuideNote = installGuideNote || null;\n    installGuideMigration = installGuideMigration || null;\n    installGuideMigrationTitle = installGuideMigrationTitle || null;\n    installGuideMigrationIntro = installGuideMigrationIntro || null;\n    installGuideMigrationSteps = installGuideMigrationSteps || null;\n    installGuideMigrationNote = installGuideMigrationNote || null;\n    installGuideClose = installGuideClose || null;\n    iosPwaHelpTitle = iosPwaHelpTitle || null;\n    iosPwaHelpIntro = iosPwaHelpIntro || null;\n    iosPwaHelpStep1 = iosPwaHelpStep1 || null;\n    return;\n  }\n\n  installPromptBanner = document.getElementById('installPromptBanner');\n  installPromptBannerText = document.getElementById('installPromptBannerText');\n  installPromptBannerAction = document.getElementById('installPromptBannerAction');\n  installPromptBannerIcon = document.getElementById('installPromptBannerIcon');\n  installPromptBannerDismiss = document.getElementById('installPromptBannerDismiss');\n  installGuideDialog = document.getElementById('installGuideDialog');\n  installGuideTitle = document.getElementById('installGuideTitle');\n  installGuideIntro = document.getElementById('installGuideIntro');\n  installGuideSteps = document.getElementById('installGuideSteps');\n  installGuideNote = document.getElementById('installGuideNote');\n  installGuideMigration = document.getElementById('installGuideMigration');\n  installGuideMigrationTitle = document.getElementById('installGuideMigrationTitle');\n  installGuideMigrationIntro = document.getElementById('installGuideMigrationIntro');\n  installGuideMigrationSteps = document.getElementById('installGuideMigrationSteps');\n  installGuideMigrationNote = document.getElementById('installGuideMigrationNote');\n  installGuideClose = document.getElementById('installGuideClose');\n  iosPwaHelpTitle = document.getElementById('iosPwaHelpTitle');\n  iosPwaHelpIntro = document.getElementById('iosPwaHelpIntro');\n  iosPwaHelpStep1 = document.getElementById('iosPwaHelpStep1');\n  installPromptElementsInitialized = true;\n}\nconst syncResetButtonGlobal =\n  (typeof globalThis !== 'undefined'\n    && globalThis\n    && typeof globalThis.syncMountVoltageResetButtonGlobal === 'function'\n    ? globalThis.syncMountVoltageResetButtonGlobal\n    : null)\n  || (typeof syncMountVoltageResetButtonGlobal === 'function'\n    ? syncMountVoltageResetButtonGlobal\n    : function noopSyncMountVoltageResetButtonGlobal() { });\n\nconst mountVoltageSectionElem = document.getElementById('mountVoltageSettings');\nconst mountVoltageHeadingElem = document.getElementById('mountVoltageHeading');\nconst mountVoltageDescriptionElem = document.getElementById('mountVoltageDescription');\nconst mountVoltageNoteElem = document.getElementById('mountVoltageNote');\nconst mountVoltageResetButton = document.getElementById('mountVoltageReset');\nsyncResetButtonGlobal(mountVoltageResetButton);\nconst mountVoltageTitleElems = {\n  V: document.getElementById('mountVoltageVTitle'),\n  Gold: document.getElementById('mountVoltageGoldTitle'),\n  B: document.getElementById('mountVoltageBTitle'),\n};\n\nconst mountVoltageInputs = {\n  'V-Mount': {\n    high: document.getElementById('mountVoltageVHigh'),\n    low: document.getElementById('mountVoltageVLow'),\n    highLabel: document.getElementById('mountVoltageVHighLabel'),\n    lowLabel: document.getElementById('mountVoltageVLowLabel'),\n  },\n  'Gold-Mount': {\n    high: document.getElementById('mountVoltageGoldHigh'),\n    low: document.getElementById('mountVoltageGoldLow'),\n    highLabel: document.getElementById('mountVoltageGoldHighLabel'),\n    lowLabel: document.getElementById('mountVoltageGoldLowLabel'),\n  },\n  'B-Mount': {\n    high: document.getElementById('mountVoltageBHigh'),\n    low: document.getElementById('mountVoltageBLow'),\n    highLabel: document.getElementById('mountVoltageBHighLabel'),\n    lowLabel: document.getElementById('mountVoltageBLowLabel'),\n  },\n};\n\nconst mountVoltageNamespace =\n  typeof setMountVoltageDomReferences === 'function'\n    ? { setDomReferences: setMountVoltageDomReferences }\n    : CORE_GLOBAL_SCOPE\n      && typeof CORE_GLOBAL_SCOPE === 'object'\n      && CORE_GLOBAL_SCOPE.cineCoreMountVoltage\n      && typeof CORE_GLOBAL_SCOPE.cineCoreMountVoltage.setMountVoltageDomReferences === 'function'\n      ? { setDomReferences: CORE_GLOBAL_SCOPE.cineCoreMountVoltage.setMountVoltageDomReferences }\n      : null;\n\nif (mountVoltageNamespace && typeof mountVoltageNamespace.setDomReferences === 'function') {\n  mountVoltageNamespace.setDomReferences({\n    section: mountVoltageSectionElem,\n    heading: mountVoltageHeadingElem,\n    description: mountVoltageDescriptionElem,\n    note: mountVoltageNoteElem,\n    resetButton: mountVoltageResetButton,\n    titles: mountVoltageTitleElems,\n    inputs: mountVoltageInputs,\n  });\n} else if (CORE_GLOBAL_SCOPE && typeof CORE_GLOBAL_SCOPE === 'object') {\n  try {\n    CORE_GLOBAL_SCOPE.mountVoltageInputs = mountVoltageInputs;\n  } catch (mountVoltageInputsAssignError) {\n    void mountVoltageInputsAssignError;\n  }\n}\n\nif (typeof updateMountVoltageInputsFromState === 'function') {\n  updateMountVoltageInputsFromState();\n}\nif (typeof updateMountVoltageSettingLabels === 'function') {\n  updateMountVoltageSettingLabels(currentLang);\n}\nconst iosPwaHelpStep2 = document.getElementById(\"iosPwaHelpStep2\");\nconst iosPwaHelpStep3 = document.getElementById(\"iosPwaHelpStep3\");\n\nsetPinkModeIconSequence(PINK_MODE_ICON_FALLBACK_MARKUP);\n\nif (typeof window !== 'undefined' && typeof document !== 'undefined') {\n  loadPinkModeIconsFromFiles().catch(() => { });\n}\nconst iosPwaHelpStep4 = document.getElementById(\"iosPwaHelpStep4\");\nconst iosPwaHelpNote = document.getElementById(\"iosPwaHelpNote\");\nvar iosPwaHelpClose = document.getElementById(\"iosPwaHelpClose\");\n\nvar installBannerSetupComplete = false;\nvar currentInstallGuidePlatform = null;\nvar lastActiveBeforeInstallGuide = null;\nvar lastActiveBeforeIosHelp = null;\n\nfunction parseRgbComponent(value) {\n  if (typeof value === 'number' && Number.isFinite(value)) {\n    return Math.max(0, Math.min(255, Math.round(value)));\n  }\n  if (typeof value !== 'string') return null;\n  const trimmed = value.trim();\n  if (!trimmed) return null;\n  if (trimmed.endsWith('%')) {\n    const percent = Number.parseFloat(trimmed.slice(0, -1));\n    if (Number.isNaN(percent)) return null;\n    return Math.max(0, Math.min(255, Math.round((percent / 100) * 255)));\n  }\n  const numeric = Number.parseFloat(trimmed);\n  if (Number.isNaN(numeric)) return null;\n  return Math.max(0, Math.min(255, Math.round(numeric)));\n}\n\nfunction parseColorToRgb(color) {\n  if (typeof color !== 'string') return null;\n  const trimmed = color.trim();\n  if (!trimmed) return null;\n  const hexMatch = trimmed.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i);\n  if (hexMatch) {\n    const hex = hexMatch[1];\n    if (hex.length === 3) {\n      return {\n        r: Number.parseInt(hex[0] + hex[0], 16),\n        g: Number.parseInt(hex[1] + hex[1], 16),\n        b: Number.parseInt(hex[2] + hex[2], 16),\n      };\n    }\n    return {\n      r: Number.parseInt(hex.slice(0, 2), 16),\n      g: Number.parseInt(hex.slice(2, 4), 16),\n      b: Number.parseInt(hex.slice(4, 6), 16),\n    };\n  }\n  const rgbMatch = trimmed.match(/^rgba?\\(([^)]+)\\)$/i);\n  if (rgbMatch) {\n    const parts = rgbMatch[1].split(',');\n    if (parts.length < 3) return null;\n    const [r, g, b] = parts;\n    const red = parseRgbComponent(r);\n    const green = parseRgbComponent(g);\n    const blue = parseRgbComponent(b);\n    if ([red, green, blue].some(component => component === null)) return null;\n    return { r: red, g: green, b: blue };\n  }\n  return null;\n}\n\nfunction computeRelativeLuminance(rgb) {\n  if (!rgb || typeof rgb !== 'object') return 0;\n  const clamp = component => {\n    const numeric = Number(component);\n    if (!Number.isFinite(numeric)) return 0;\n    return Math.min(1, Math.max(0, numeric / 255));\n  };\n  const transform = value =>\n    value <= 0.03928\n      ? value / 12.92\n      : Math.pow((value + 0.055) / 1.055, 2.4);\n  const red = transform(clamp(rgb.r));\n  const green = transform(clamp(rgb.g));\n  const blue = transform(clamp(rgb.b));\n  return 0.2126 * red + 0.7152 * green + 0.0722 * blue;\n}\n\nfunction isIosDevice() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.isIosDevice === 'function') {\n      return Boolean(helpModuleApi.isIosDevice());\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('isIosDevice() failed', error);\n    }\n  }\n  return false;\n}\n\nfunction isAndroidDevice() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.isAndroidDevice === 'function') {\n      return Boolean(helpModuleApi.isAndroidDevice());\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('isAndroidDevice() failed', error);\n    }\n  }\n  return false;\n}\n\nfunction isStandaloneDisplayMode() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.isStandaloneDisplayMode === 'function') {\n      return Boolean(helpModuleApi.isStandaloneDisplayMode());\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('isStandaloneDisplayMode() failed', error);\n    }\n  }\n  return false;\n}\n\nfunction hasDismissedIosPwaHelp() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.hasDismissedIosPwaHelp === 'function') {\n      return Boolean(helpModuleApi.hasDismissedIosPwaHelp());\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('hasDismissedIosPwaHelp() failed', error);\n    }\n  }\n  return false;\n}\n\nfunction markIosPwaHelpDismissed() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.markIosPwaHelpDismissed === 'function') {\n      helpModuleApi.markIosPwaHelpDismissed();\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('markIosPwaHelpDismissed() failed', error);\n    }\n  }\n}\n\nfunction getInstallBannerDismissedInSession() {\n  if (!installBannerGlobalScope || typeof installBannerGlobalScope !== 'object') {\n    return false;\n  }\n  if (typeof installBannerGlobalScope.installBannerDismissedInSession !== 'boolean') {\n    installBannerGlobalScope.installBannerDismissedInSession = false;\n    return false;\n  }\n  return installBannerGlobalScope.installBannerDismissedInSession;\n}\n\nfunction setInstallBannerDismissedInSession(value) {\n  if (!installBannerGlobalScope || typeof installBannerGlobalScope !== 'object') {\n    return;\n  }\n  installBannerGlobalScope.installBannerDismissedInSession = Boolean(value);\n}\n\nfunction hasDismissedInstallBanner() {\n  if (getInstallBannerDismissedInSession()) return true;\n  if (typeof localStorage === 'undefined') return false;\n  try {\n    const storedValue = localStorage.getItem(INSTALL_BANNER_DISMISSED_KEY);\n    const dismissed = storedValue === '1';\n    if (dismissed) {\n      setInstallBannerDismissedInSession(true);\n    }\n    return dismissed;\n  } catch (error) {\n    console.warn('Could not read install banner dismissal flag', error);\n    return getInstallBannerDismissedInSession();\n  }\n}\n\nfunction markInstallBannerDismissed() {\n  setInstallBannerDismissedInSession(true);\n  if (typeof localStorage === 'undefined') return;\n  try {\n    localStorage.setItem(INSTALL_BANNER_DISMISSED_KEY, '1');\n  } catch (error) {\n    console.warn('Could not store install banner dismissal', error);\n  }\n}\n\nfunction shouldShowInstallBanner() {\n  ensureInstallPromptElements();\n  if (!installPromptBanner) return false;\n  if (isStandaloneDisplayMode()) return false;\n  if (hasDismissedInstallBanner()) return false;\n  return isIosDevice() || isAndroidDevice();\n}\n\nfunction updateInstallBannerVisibility() {\n  ensureInstallPromptElements();\n  if (!installPromptBanner) return;\n  const shouldShow = shouldShowInstallBanner();\n  const root = typeof document !== 'undefined' ? document.documentElement : null;\n  if (root && typeof root.classList !== 'undefined') {\n    root.classList.toggle('install-banner-visible', shouldShow);\n  }\n  if (shouldShow) {\n    installPromptBanner.removeAttribute('hidden');\n    updateInstallBannerColors();\n    updateInstallBannerPosition();\n  } else {\n    installPromptBanner.setAttribute('hidden', '');\n    setInstallBannerOffset(0);\n    installPromptBanner.style.removeProperty('top');\n  }\n}\n\nfunction updateInstallBannerColors() {\n  ensureInstallPromptElements();\n  if (!installPromptBanner) return;\n  if (typeof window === 'undefined' || typeof window.getComputedStyle !== 'function') {\n    return;\n  }\n  try {\n    const root = document.documentElement;\n    if (!root) return;\n    const computed = window.getComputedStyle(root);\n    const accentValue = computed.getPropertyValue('--accent-color').trim();\n    if (!accentValue) {\n      installPromptBanner.style.removeProperty('--install-banner-text-color');\n      return;\n    }\n    const rgb = parseColorToRgb(accentValue);\n    if (!rgb) return;\n    const luminance = computeRelativeLuminance(rgb);\n    const textColor = luminance > 0.55 ? '#000000' : '#ffffff';\n    installPromptBanner.style.setProperty('--install-banner-text-color', textColor);\n  } catch (error) {\n    console.warn('Unable to update install banner colors', error);\n  }\n}\n\nfunction renderInstallGuideContent(platform, lang = currentLang) {\n  ensureInstallPromptElements();\n  if (!installGuideDialog) return;\n  const fallbackTexts = texts.en || {};\n  const langTexts = texts[lang] || fallbackTexts;\n  const isIos = platform === 'ios';\n\n  const titleKey = isIos ? 'installHelpTitleIos' : 'installHelpTitleAndroid';\n  const introKey = isIos ? 'installHelpIntroIos' : 'installHelpIntroAndroid';\n  const stepsKey = isIos ? 'installHelpStepsIos' : 'installHelpStepsAndroid';\n  const noteKey = isIos ? 'installHelpNoteIos' : 'installHelpNoteAndroid';\n\n  const title = langTexts[titleKey] || fallbackTexts[titleKey] || '';\n  if (installGuideTitle) installGuideTitle.textContent = title;\n\n  const intro = langTexts[introKey] || fallbackTexts[introKey] || '';\n  if (installGuideIntro) installGuideIntro.textContent = intro;\n\n  const stepsSource = langTexts[stepsKey];\n  const fallbackStepsSource = fallbackTexts[stepsKey];\n  const toArray = value => {\n    if (!value) return [];\n    return Array.isArray(value) ? value : [value];\n  };\n  const steps = toArray(stepsSource);\n  const fallbackSteps = toArray(fallbackStepsSource);\n  const effectiveSteps = steps.length ? steps : fallbackSteps;\n  if (installGuideSteps) {\n    installGuideSteps.textContent = '';\n    effectiveSteps.forEach(step => {\n      if (!step) return;\n      const li = document.createElement('li');\n      li.textContent = step;\n      installGuideSteps.appendChild(li);\n    });\n  }\n\n  const note = langTexts[noteKey] || fallbackTexts[noteKey] || '';\n  if (installGuideNote) installGuideNote.textContent = note;\n\n  installGuideDialog.setAttribute('data-platform', platform);\n\n  if (!installGuideMigration || !installGuideMigrationTitle || !installGuideMigrationIntro || !installGuideMigrationSteps || !installGuideMigrationNote) {\n    return;\n  }\n\n  if (isIos) {\n    installGuideMigration.removeAttribute('hidden');\n    const migrationTitle = langTexts.installHelpMigrationTitle || fallbackTexts.installHelpMigrationTitle || '';\n    installGuideMigrationTitle.textContent = migrationTitle;\n    const migrationIntro = langTexts.iosPwaHelpIntro || fallbackTexts.iosPwaHelpIntro || '';\n    installGuideMigrationIntro.textContent = migrationIntro;\n    const migrationSteps = [\n      langTexts.iosPwaHelpStep1 || fallbackTexts.iosPwaHelpStep1,\n      langTexts.iosPwaHelpStep2 || fallbackTexts.iosPwaHelpStep2,\n      langTexts.iosPwaHelpStep3 || fallbackTexts.iosPwaHelpStep3,\n      langTexts.iosPwaHelpStep4 || fallbackTexts.iosPwaHelpStep4,\n    ].filter(Boolean);\n    installGuideMigrationSteps.textContent = '';\n    migrationSteps.forEach(step => {\n      const li = document.createElement('li');\n      li.textContent = step;\n      installGuideMigrationSteps.appendChild(li);\n    });\n    const migrationNote = langTexts.iosPwaHelpNote || fallbackTexts.iosPwaHelpNote || '';\n    installGuideMigrationNote.textContent = migrationNote;\n  } else {\n    installGuideMigration.setAttribute('hidden', '');\n    installGuideMigrationTitle.textContent = '';\n    installGuideMigrationIntro.textContent = '';\n    installGuideMigrationSteps.textContent = '';\n    installGuideMigrationNote.textContent = '';\n  }\n}\n\nfunction openInstallGuide(platform) {\n  ensureInstallPromptElements();\n  if (!installGuideDialog) return;\n  currentInstallGuidePlatform = platform;\n  lastActiveBeforeInstallGuide = document.activeElement;\n  renderInstallGuideContent(platform);\n  installGuideDialog.removeAttribute('hidden');\n  const focusTarget = installGuideClose || installGuideDialog.querySelector('button, [href], [tabindex]:not([tabindex=\"-1\"])');\n  if (focusTarget && typeof focusTarget.focus === 'function') {\n    try {\n      focusTarget.focus();\n    } catch {\n      focusTarget.focus();\n    }\n  }\n}\n\nfunction closeInstallGuide() {\n  ensureInstallPromptElements();\n  if (!installGuideDialog) return;\n  installGuideDialog.setAttribute('hidden', '');\n  currentInstallGuidePlatform = null;\n  if (lastActiveBeforeInstallGuide && typeof lastActiveBeforeInstallGuide.focus === 'function') {\n    try {\n      lastActiveBeforeInstallGuide.focus();\n    } catch {\n      lastActiveBeforeInstallGuide.focus();\n    }\n  }\n}\n\nfunction setupInstallBanner() {\n  ensureInstallPromptElements();\n  if (!installPromptBanner) return false;\n\n  if (installBannerSetupComplete) {\n    applyInstallTexts(currentLang);\n    updateInstallBannerColors();\n    updateInstallBannerVisibility();\n    updateInstallBannerPosition();\n    return true;\n  }\n\n  installBannerSetupComplete = true;\n\n  if (installPromptBannerIcon && typeof applyIconGlyph === 'function') {\n    applyIconGlyph(installPromptBannerIcon, ICON_GLYPHS.installApp);\n  }\n\n  if (installPromptBannerAction) {\n    installPromptBannerAction.addEventListener('click', event => {\n      event.preventDefault();\n      const platform = isIosDevice() ? 'ios' : 'android';\n      openInstallGuide(platform);\n    });\n  }\n\n  if (installPromptBannerDismiss) {\n    installPromptBannerDismiss.addEventListener('click', event => {\n      event.preventDefault();\n      event.stopPropagation();\n      markInstallBannerDismissed();\n      updateInstallBannerVisibility();\n    });\n  }\n\n  if (installGuideClose) {\n    installGuideClose.addEventListener('click', () => {\n      closeInstallGuide();\n    });\n  }\n\n  if (installGuideDialog) {\n    installGuideDialog.addEventListener('click', event => {\n      if (event.target === installGuideDialog) {\n        closeInstallGuide();\n      }\n    });\n  }\n\n  applyInstallTexts(currentLang);\n  updateInstallBannerColors();\n  updateInstallBannerVisibility();\n  updateInstallBannerPosition();\n\n  if (typeof window !== 'undefined') {\n    window.addEventListener('resize', updateInstallBannerPosition);\n    window.addEventListener('appinstalled', updateInstallBannerVisibility);\n    if (typeof window.matchMedia === 'function') {\n      try {\n        const media = window.matchMedia('(display-mode: standalone)');\n        const handleChange = () => updateInstallBannerVisibility();\n        if (typeof media.addEventListener === 'function') {\n          media.addEventListener('change', handleChange);\n        } else if (typeof media.addListener === 'function') {\n          media.addListener(handleChange);\n        }\n      } catch (error) {\n        console.warn('matchMedia display-mode listener failed', error);\n      }\n    }\n  }\n\n  return true;\n}\n\nfunction applyInstallTexts(lang) {\n  ensureInstallPromptElements();\n  const fallbackTexts = texts.en || {};\n  const langTexts = texts[lang] || fallbackTexts;\n  const bannerText = langTexts.installBannerText || fallbackTexts.installBannerText || '';\n  if (installPromptBannerText && bannerText) {\n    installPromptBannerText.textContent = bannerText;\n  }\n  if (installPromptBanner) {\n    if (bannerText) {\n      installPromptBanner.setAttribute('aria-label', bannerText);\n      installPromptBanner.setAttribute('title', bannerText);\n    } else {\n      installPromptBanner.removeAttribute('aria-label');\n      installPromptBanner.removeAttribute('title');\n    }\n  }\n  if (installPromptBannerAction) {\n    if (bannerText) {\n      installPromptBannerAction.setAttribute('aria-label', bannerText);\n      installPromptBannerAction.setAttribute('title', bannerText);\n    } else {\n      installPromptBannerAction.removeAttribute('aria-label');\n      installPromptBannerAction.removeAttribute('title');\n    }\n  }\n\n  const closeLabel = langTexts.installHelpClose || fallbackTexts.installHelpClose || '';\n  const dismissLabel =\n    langTexts.installBannerDismiss ||\n    fallbackTexts.installBannerDismiss ||\n    closeLabel ||\n    '';\n\n  if (installPromptBannerDismiss) {\n    const labelText = dismissLabel || '';\n    if (typeof setButtonLabelWithIconBinding === 'function') {\n      setButtonLabelWithIconBinding(installPromptBannerDismiss, '', ICON_GLYPHS.circleX);\n    }\n    Array.from(installPromptBannerDismiss.querySelectorAll('.visually-hidden')).forEach(node => {\n      if (node && node.parentNode === installPromptBannerDismiss) {\n        installPromptBannerDismiss.removeChild(node);\n      }\n    });\n    if (labelText) {\n      installPromptBannerDismiss.setAttribute('aria-label', labelText);\n      installPromptBannerDismiss.setAttribute('title', labelText);\n      const hiddenLabel = document.createElement('span');\n      hiddenLabel.className = 'visually-hidden';\n      hiddenLabel.textContent = labelText;\n      installPromptBannerDismiss.appendChild(hiddenLabel);\n    } else {\n      installPromptBannerDismiss.removeAttribute('aria-label');\n      installPromptBannerDismiss.removeAttribute('title');\n    }\n  }\n\n  if (installGuideClose) {\n    if (closeLabel && typeof setButtonLabelWithIconBinding === 'function') {\n      setButtonLabelWithIconBinding(installGuideClose, closeLabel, ICON_GLYPHS.circleX);\n      installGuideClose.setAttribute('aria-label', closeLabel);\n      installGuideClose.setAttribute('title', closeLabel);\n    } else if (!closeLabel) {\n      installGuideClose.removeAttribute('aria-label');\n      installGuideClose.removeAttribute('title');\n    }\n  }\n\n  if (installGuideDialog && !installGuideDialog.hasAttribute('hidden') && currentInstallGuidePlatform) {\n    renderInstallGuideContent(currentInstallGuidePlatform, lang);\n  }\n\n  updateInstallBannerPosition();\n  updateInstallBannerColors();\n}\n\nfunction shouldShowIosPwaHelp() {\n  try {\n    if (helpModuleApi && typeof helpModuleApi.shouldShowIosPwaHelp === 'function') {\n      return Boolean(helpModuleApi.shouldShowIosPwaHelp(() => iosPwaHelpDialog));\n    }\n  } catch (error) {\n    if (typeof console !== 'undefined' && console && typeof console.warn === 'function') {\n      console.warn('shouldShowIosPwaHelp() failed', error);\n    }\n  }\n  return false;\n}\n\nfunction openIosPwaHelp() {\n  if (!iosPwaHelpDialog) return;\n  if (!shouldShowIosPwaHelp()) return;\n  lastActiveBeforeIosHelp = document.activeElement;\n  iosPwaHelpDialog.removeAttribute('hidden');\n  const focusTarget = iosPwaHelpClose || iosPwaHelpDialog.querySelector('button, [href], [tabindex]:not([tabindex=\"-1\"])');\n  if (focusTarget && typeof focusTarget.focus === 'function') {\n    try {\n      focusTarget.focus();\n    } catch {\n      focusTarget.focus();\n    }\n  }\n}\n\nfunction closeIosPwaHelp(storeDismissal = false) {\n  if (!iosPwaHelpDialog) return;\n  iosPwaHelpDialog.setAttribute('hidden', '');\n  if (storeDismissal) {\n    markIosPwaHelpDismissed();\n  }\n  if (lastActiveBeforeIosHelp && typeof lastActiveBeforeIosHelp.focus === 'function') {\n    try {\n      lastActiveBeforeIosHelp.focus();\n    } catch {\n      lastActiveBeforeIosHelp.focus();\n    }\n  }\n}\n\nfunction maybeShowIosPwaHelp() {\n  openIosPwaHelp();\n}\n\nif (iosPwaHelpClose) {\n  iosPwaHelpClose.addEventListener('click', () => closeIosPwaHelp(true));\n}\n\nif (iosPwaHelpDialog) {\n  iosPwaHelpDialog.addEventListener('click', event => {\n    if (event.target === iosPwaHelpDialog) {\n      closeIosPwaHelp(true);\n    }\n  });\n}\n\ndocument.addEventListener('keydown', event => {\n  if (event.key !== 'Escape' && event.key !== 'Esc') return;\n  let handled = false;\n  if (iosPwaHelpDialog && !iosPwaHelpDialog.hasAttribute('hidden')) {\n    closeIosPwaHelp(true);\n    handled = true;\n  }\n  if (installGuideDialog && !installGuideDialog.hasAttribute('hidden')) {\n    closeInstallGuide();\n    handled = true;\n  }\n  if (handled) {\n    event.preventDefault();\n  }\n});\nvar hoverHelpButton = document.getElementById(\"hoverHelpButton\");\nvar settingsButton = document.getElementById(\"settingsButton\");\nconst settingsButtonIcon = settingsButton?.querySelector?.('.settings-button-icon');\nvar settingsDialog = document.getElementById(\"settingsDialog\");\nif (settingsButton) {\n  settingsButton.setAttribute('data-allow-hover-help', '');\n}\nif (settingsButtonIcon) {\n  applyIconGlyph(settingsButtonIcon, ICON_GLYPHS.gears);\n  settingsButtonIcon.setAttribute('aria-hidden', 'true');\n}\nif (settingsDialog) {\n  settingsDialog.setAttribute('data-allow-hover-help', '');\n}\n// settingsTablist defined globally above\nconst settingsTabButtons = settingsTablist\n  ? Array.from(settingsTablist.querySelectorAll('[role=\"tab\"]'))\n  : [];\nconst settingsTabsContainer = settingsTablist\n  ? settingsTablist.closest('.settings-tabs-container') || settingsTablist\n  : null;\nconst settingsTabsScrollPrev = document.getElementById('settingsTabsScrollPrev');\nconst settingsTabsScrollNext = document.getElementById('settingsTabsScrollNext');\nlet settingsTabsOverflowFrame = 0;\n\nconst SETTINGS_TABS_SIDEBAR_QUERY = '(max-width: 720px)';\nconst settingsTabsOrientationQuery =\n  typeof window !== 'undefined' && typeof window.matchMedia === 'function'\n    ? window.matchMedia(SETTINGS_TABS_SIDEBAR_QUERY)\n    : null;\n\nfunction applySettingsTabsOrientation(matches) {\n  if (!settingsTablist) return;\n  settingsTablist.setAttribute('aria-orientation', matches ? 'vertical' : 'horizontal');\n  scheduleSettingsTabsOverflowUpdate();\n}\n\nif (settingsTabsOrientationQuery) {\n  try {\n    applySettingsTabsOrientation(settingsTabsOrientationQuery.matches);\n    const handleSettingsTabsOrientationChange = event => {\n      applySettingsTabsOrientation(event.matches);\n    };\n    if (typeof settingsTabsOrientationQuery.addEventListener === 'function') {\n      settingsTabsOrientationQuery.addEventListener('change', handleSettingsTabsOrientationChange);\n    } else if (typeof settingsTabsOrientationQuery.addListener === 'function') {\n      settingsTabsOrientationQuery.addListener(handleSettingsTabsOrientationChange);\n    }\n  } catch {\n    applySettingsTabsOrientation(false);\n  }\n} else if (settingsTablist) {\n  settingsTablist.setAttribute('aria-orientation', 'horizontal');\n}\n\nfunction updateSettingsTabsOverflowIndicators() {\n  if (!settingsTablist || !settingsTabsContainer) {\n    if (settingsTabsScrollPrev) {\n      settingsTabsScrollPrev.hidden = true;\n    }\n    if (settingsTabsScrollNext) {\n      settingsTabsScrollNext.hidden = true;\n    }\n    return;\n  }\n\n  const scrollWidth = typeof settingsTablist.scrollWidth === 'number'\n    ? settingsTablist.scrollWidth\n    : 0;\n  const clientWidth = typeof settingsTablist.clientWidth === 'number'\n    ? settingsTablist.clientWidth\n    : 0;\n  const rawScrollLeft = typeof settingsTablist.scrollLeft === 'number'\n    ? settingsTablist.scrollLeft\n    : Number(settingsTablist.scrollLeft) || 0;\n  const maxScrollLeft = Math.max(0, scrollWidth - clientWidth);\n  const scrollLeft = Math.min(maxScrollLeft, Math.max(0, rawScrollLeft));\n  const canScroll = scrollWidth > clientWidth + 4;\n  const atStart = !canScroll || scrollLeft <= 1;\n  const atEnd = !canScroll || Math.abs(scrollWidth - clientWidth - scrollLeft) <= 1;\n\n  settingsTabsContainer.classList.toggle('is-scrollable', canScroll);\n  settingsTabsContainer.classList.toggle('is-at-start', atStart);\n  settingsTabsContainer.classList.toggle('is-at-end', atEnd);\n\n  if (settingsTabsScrollPrev) {\n    settingsTabsScrollPrev.hidden = !canScroll;\n    settingsTabsScrollPrev.disabled = atStart;\n  }\n\n  if (settingsTabsScrollNext) {\n    settingsTabsScrollNext.hidden = !canScroll;\n    settingsTabsScrollNext.disabled = atEnd;\n  }\n}\n\nfunction scheduleSettingsTabsOverflowUpdate() {\n  if (!settingsTablist) return;\n\n  if (\n    typeof window !== 'undefined' &&\n    typeof window.requestAnimationFrame === 'function'\n  ) {\n    if (settingsTabsOverflowFrame) {\n      if (typeof window.cancelAnimationFrame === 'function') {\n        window.cancelAnimationFrame(settingsTabsOverflowFrame);\n      }\n      settingsTabsOverflowFrame = 0;\n    }\n\n    settingsTabsOverflowFrame = window.requestAnimationFrame(() => {\n      settingsTabsOverflowFrame = 0;\n      updateSettingsTabsOverflowIndicators();\n    });\n  } else {\n    updateSettingsTabsOverflowIndicators();\n  }\n}\n\nfunction scrollSettingsTabs(direction) {\n  if (!settingsTablist) return;\n\n  const distance = settingsTablist.clientWidth\n    ? settingsTablist.clientWidth * 0.75\n    : 200;\n  const amount = direction * distance;\n\n  if (typeof settingsTablist.scrollBy === 'function') {\n    try {\n      settingsTablist.scrollBy({ left: amount, behavior: 'smooth' });\n    } catch {\n      settingsTablist.scrollLeft += amount;\n    }\n  } else {\n    settingsTablist.scrollLeft += amount;\n  }\n\n  scheduleSettingsTabsOverflowUpdate();\n}\n\nif (settingsTabsScrollPrev) {\n  settingsTabsScrollPrev.addEventListener('click', () => {\n    scrollSettingsTabs(-1);\n  });\n}\n\nif (settingsTabsScrollNext) {\n  settingsTabsScrollNext.addEventListener('click', () => {\n    scrollSettingsTabs(1);\n  });\n}\n\nif (settingsTablist) {\n  let settingsTabsPassiveOptions = false;\n  if (typeof window !== 'undefined' && typeof window.addEventListener === 'function') {\n    try {\n      const passiveTestHandler = () => { };\n      const passiveTestOptions = Object.defineProperty({}, 'passive', {\n        get() {\n          settingsTabsPassiveOptions = { passive: true };\n          return false;\n        },\n      });\n      window.addEventListener('testPassive', passiveTestHandler, passiveTestOptions);\n      window.removeEventListener('testPassive', passiveTestHandler, passiveTestOptions);\n    } catch {\n      settingsTabsPassiveOptions = false;\n    }\n  }\n\n  settingsTablist.addEventListener(\n    'scroll',\n    () => {\n      scheduleSettingsTabsOverflowUpdate();\n    },\n    settingsTabsPassiveOptions\n  );\n\n  if (typeof window !== 'undefined' && typeof window.addEventListener === 'function') {\n    window.addEventListener('resize', scheduleSettingsTabsOverflowUpdate, settingsTabsPassiveOptions);\n  }\n}\n\n\nvar settingsTabPanels = settingsDialog\n  ? Array.from(settingsDialog.querySelectorAll('.settings-panel'))\n  : [];\nvar settingsTabGeneral = document.getElementById('settingsTab-general');\nvar settingsTabAutoGear = document.getElementById('settingsTab-autoGear');\nvar settingsTabAccessibility = document.getElementById('settingsTab-accessibility');\nvar settingsTabBackup = document.getElementById('settingsTab-backup');\nvar settingsTabData = document.getElementById('settingsTab-data');\nvar settingsTabAbout = document.getElementById('settingsTab-about');\nvar settingsTabIconAssignments = [\n  [settingsTabGeneral, ICON_GLYPHS.settingsGeneral],\n  [settingsTabAutoGear, ICON_GLYPHS.settingsAutoGear],\n  [settingsTabAccessibility, ICON_GLYPHS.settingsAccessibility],\n  [settingsTabBackup, ICON_GLYPHS.settingsBackup],\n  [settingsTabData, ICON_GLYPHS.settingsData],\n  [settingsTabAbout, ICON_GLYPHS.settingsAbout]\n];\nsettingsTabIconAssignments.forEach(([button, glyph]) => {\n  if (!button || !glyph) return;\n  const iconElement = button.querySelector?.('.settings-tab-icon');\n  if (!iconElement) return;\n  applyIconGlyph(iconElement, glyph);\n  iconElement.setAttribute('aria-hidden', 'true');\n});\nconst generalSettingsHeading = document.getElementById('generalSettingsHeading');\nconst generalLanguageHeading = document.getElementById('generalLanguageHeading');\nconst generalAppearanceHeading = document.getElementById('generalAppearanceHeading');\nconst generalTypographyHeading = document.getElementById('generalTypographyHeading');\nconst generalBrandingHeading = document.getElementById('generalBrandingHeading');\nconst generalCameraColorsHeading = document.getElementById('generalCameraColorsHeading');\nconst cameraColorsDescription = document.getElementById('cameraColorsDescription');\nconst cameraColorALabel = document.getElementById('cameraColorALabel');\nconst cameraColorBLabel = document.getElementById('cameraColorBLabel');\nconst cameraColorCLabel = document.getElementById('cameraColorCLabel');\nconst cameraColorDLabel = document.getElementById('cameraColorDLabel');\nconst cameraColorELabel = document.getElementById('cameraColorELabel');\nvar cameraColorA = document.getElementById('cameraColorA');\nvar cameraColorB = document.getElementById('cameraColorB');\nvar cameraColorC = document.getElementById('cameraColorC');\nvar cameraColorD = document.getElementById('cameraColorD');\nvar cameraColorE = document.getElementById('cameraColorE');\nvar settingsLanguage = document.getElementById(\"settingsLanguage\");\nvar settingsDarkMode = document.getElementById(\"settingsDarkMode\");\nvar settingsPinkMode = document.getElementById(\"settingsPinkMode\");\nvar accentColorInput = document.getElementById(\"accentColorInput\");\nvar accentColorResetButton = document.getElementById(\"accentColorReset\");\nvar settingsTemperatureUnit = document.getElementById('settingsTemperatureUnit');\nvar settingsFocusScale = document.getElementById('settingsFocusScale');\nvar settingsFontSize = document.getElementById(\"settingsFontSize\");\nvar settingsFontFamily = document.getElementById(\"settingsFontFamily\");\nvar localFontsButton = document.getElementById(\"localFontsButton\");\nvar localFontsInput = document.getElementById(\"localFontsInput\");\nvar localFontsStatus = document.getElementById(\"localFontsStatus\");\nvar localFontsGroup = document.getElementById(\"localFontsGroup\");\nconst bundledFontGroup = document.getElementById(\"bundledFontOptions\");\nvar settingsLogo = document.getElementById(\"settingsLogo\");\nvar settingsLogoPreview = document.getElementById(\"settingsLogoPreview\");\nconst documentationTrackerController = (() => {\n  const manager =\n    SETTINGS_DOCUMENTATION_TRACKER_TOOLS &&\n      typeof SETTINGS_DOCUMENTATION_TRACKER_TOOLS.createDocumentationTrackerManager === 'function'\n      ? (() => {\n        try {\n          return SETTINGS_DOCUMENTATION_TRACKER_TOOLS.createDocumentationTrackerManager({\n            document: typeof document !== 'undefined' ? document : null,\n          });\n        } catch (documentationTrackerCreateError) {\n          console.warn(\n            'Failed to create documentation tracker manager',\n            documentationTrackerCreateError,\n          );\n          return null;\n        }\n      })()\n      : null;\n\n  if (manager) {\n    return {\n      initialize() {\n        try {\n          manager.initialize();\n        } catch (documentationTrackerInitError) {\n          console.warn(\n            'Failed to initialise documentation tracker',\n            documentationTrackerInitError,\n          );\n        }\n      },\n      updateLocalization(localization) {\n        try {\n          manager.updateLocalization(localization);\n        } catch (documentationTrackerLocaleError) {\n          console.warn(\n            'Failed to update documentation tracker localisation',\n            documentationTrackerLocaleError,\n          );\n        }\n      },\n      render() {\n        try {\n          manager.render();\n        } catch (documentationTrackerRenderError) {\n          console.warn(\n            'Failed to render documentation tracker',\n            documentationTrackerRenderError,\n          );\n        }\n      },\n      isInitialized() {\n        try {\n          return typeof manager.isInitialized === 'function'\n            ? manager.isInitialized() === true\n            : false;\n        } catch (documentationTrackerStateError) {\n          void documentationTrackerStateError;\n        }\n        return false;\n      },\n    };\n  }\n\n  const noop = () => { };\n  return {\n    initialize: noop,\n    updateLocalization: noop,\n    render: noop,\n    isInitialized() {\n      return false;\n    },\n  };\n})();\n\nvar activeSettingsTabId = '';\nif (settingsTabButtons.length) {\n  const initiallySelected = settingsTabButtons.find(button => button.getAttribute('aria-selected') === 'true');\n  activeSettingsTabId = initiallySelected?.id || settingsTabButtons[0].id;\n  try {\n    const storedTab = localStorage.getItem('settingsActiveTab');\n    if (storedTab && settingsTabButtons.some(button => button.id === storedTab)) {\n      activeSettingsTabId = storedTab;\n    }\n  } catch (e) {\n    console.warn('Could not load settings tab preference', e);\n  }\n}\n\nfunction activateSettingsTab(tabId, options = {}) {\n  if (!settingsTabButtons.length) return;\n  const { focusTab = false } = options || {};\n  let target = settingsTabButtons.find(button => button.id === tabId);\n  if (!target) {\n    target = settingsTabButtons[0];\n  }\n  if (!target) return;\n\n  settingsTabButtons.forEach(button => {\n    const selected = button === target;\n    button.setAttribute('aria-selected', selected ? 'true' : 'false');\n    button.tabIndex = selected ? 0 : -1;\n    if (selected && focusTab) {\n      try {\n        button.focus({ preventScroll: true });\n      } catch {\n        button.focus();\n      }\n    }\n    button.classList.toggle('active', selected);\n  });\n\n  settingsTabPanels.forEach(panel => {\n    if (!panel) return;\n    const labelledBy = panel.getAttribute('aria-labelledby') || '';\n    const labelledIds = labelledBy\n      .split(/\\s+/)\n      .map(id => id.trim())\n      .filter(Boolean);\n    if (labelledIds.includes(target.id)) {\n      panel.removeAttribute('hidden');\n    } else {\n      panel.setAttribute('hidden', '');\n    }\n  });\n\n  if (\n    settingsTablist &&\n    typeof settingsTablist.scrollWidth === 'number' &&\n    typeof settingsTablist.clientWidth === 'number' &&\n    settingsTablist.scrollWidth > settingsTablist.clientWidth + 4 &&\n    typeof target.scrollIntoView === 'function'\n  ) {\n    try {\n      target.scrollIntoView({ block: 'nearest', inline: 'center', behavior: 'smooth' });\n    } catch {\n      target.scrollIntoView();\n    }\n  }\n\n  scheduleSettingsTabsOverflowUpdate();\n\n  activeSettingsTabId = target.id;\n  try {\n    if (typeof safeSetLocalStorage === 'function') {\n      safeSetLocalStorage('settingsActiveTab', activeSettingsTabId);\n    } else {\n      localStorage.setItem('settingsActiveTab', activeSettingsTabId);\n    }\n  } catch (e) {\n    console.warn('Could not save settings tab preference', e);\n  }\n}\ndocumentationTrackerController.initialize();\nif (settingsTabButtons.length) {\n  activateSettingsTab(activeSettingsTabId);\n  settingsTabButtons.forEach(button => {\n    button.addEventListener('click', () => {\n      activateSettingsTab(button.id);\n    });\n    button.addEventListener('keydown', event => {\n      const { key } = event;\n      if (!key) return;\n      if (!['ArrowLeft', 'ArrowUp', 'ArrowRight', 'ArrowDown', 'Home', 'End'].includes(key)) {\n        return;\n      }\n      event.preventDefault();\n      const currentIndex = settingsTabButtons.indexOf(button);\n      if (currentIndex === -1) return;\n      let nextIndex = currentIndex;\n      if (key === 'ArrowLeft' || key === 'ArrowUp') {\n        nextIndex = (currentIndex - 1 + settingsTabButtons.length) % settingsTabButtons.length;\n      } else if (key === 'ArrowRight' || key === 'ArrowDown') {\n        nextIndex = (currentIndex + 1) % settingsTabButtons.length;\n      } else if (key === 'Home') {\n        nextIndex = 0;\n      } else if (key === 'End') {\n        nextIndex = settingsTabButtons.length - 1;\n      }\n      const nextTab = settingsTabButtons[nextIndex];\n      if (nextTab) {\n        activateSettingsTab(nextTab.id, { focusTab: true });\n      }\n    });\n  });\n}\n\nif (storageOpenBackupTabButton) {\n  storageOpenBackupTabButton.addEventListener('click', () => {\n    activateSettingsTab('settingsTab-backup', { focusTab: true });\n    const backupButton = document.getElementById('backupSettings');\n    if (backupButton && typeof backupButton.focus === 'function') {\n      try {\n        backupButton.focus({ preventScroll: true });\n      } catch {\n        backupButton.focus();\n      }\n    }\n  });\n}\n\n\n\nvar autoGearConditionConfigs = AUTO_GEAR_CONDITION_KEYS.reduce((acc, key) => {\n  const section = localAutoGearConditionSections[key] || null;\n  acc[key] = {\n    key,\n    section,\n    label: autoGearConditionLabels[key] || null,\n    select: autoGearConditionSelects[key] || null,\n    addShortcut: autoGearConditionAddShortcuts[key] || null,\n    removeButton: autoGearConditionRemoveButtons[key] || null,\n    logicLabel: autoGearConditionLogicLabels[key] || null,\n    logicSelect: autoGearConditionLogicSelects[key] || null,\n  };\n  if (section) {\n    section.setAttribute('aria-hidden', section.hidden ? 'true' : 'false');\n  }\n  return acc;\n}, {});\n\n\n\nconst autoGearExports = (typeof AUTO_GEAR_UI_EXPORTS !== 'undefined' ? AUTO_GEAR_UI_EXPORTS : (globalThis.AUTO_GEAR_UI_EXPORTS || {}));\n\nconst refreshAutoGearShootingDaysValue =\n  typeof autoGearExports.refreshAutoGearShootingDaysValue === 'function'\n    ? autoGearExports.refreshAutoGearShootingDaysValue\n    : function refreshAutoGearShootingDaysValue() { };\n\nconst refreshAutoGearScenarioOptions =\n  typeof autoGearExports.refreshAutoGearScenarioOptions === 'function'\n    ? autoGearExports.refreshAutoGearScenarioOptions\n    : function refreshAutoGearScenarioOptions() { };\n\nconst refreshAutoGearScenarioBaseSelect =\n  typeof autoGearExports.refreshAutoGearScenarioBaseSelect === 'function'\n    ? autoGearExports.refreshAutoGearScenarioBaseSelect\n    : function refreshAutoGearScenarioBaseSelect() { };\n\nconst refreshAutoGearMatteboxOptions =\n  typeof autoGearExports.refreshAutoGearMatteboxOptions === 'function'\n    ? autoGearExports.refreshAutoGearMatteboxOptions\n    : function refreshAutoGearMatteboxOptions() { };\n\nconst refreshAutoGearCameraHandleOptions =\n  typeof autoGearExports.refreshAutoGearCameraHandleOptions === 'function'\n    ? autoGearExports.refreshAutoGearCameraHandleOptions\n    : function refreshAutoGearCameraHandleOptions() { };\n\nconst refreshAutoGearViewfinderExtensionOptions =\n  typeof autoGearExports.refreshAutoGearViewfinderExtensionOptions === 'function'\n    ? autoGearExports.refreshAutoGearViewfinderExtensionOptions\n    : function refreshAutoGearViewfinderExtensionOptions() { };\n\nconst refreshAutoGearDeliveryResolutionOptions =\n  typeof autoGearExports.refreshAutoGearDeliveryResolutionOptions === 'function'\n    ? autoGearExports.refreshAutoGearDeliveryResolutionOptions\n    : function refreshAutoGearDeliveryResolutionOptions() { };\n\nconst refreshAutoGearVideoDistributionOptions =\n  typeof autoGearExports.refreshAutoGearVideoDistributionOptions === 'function'\n    ? autoGearExports.refreshAutoGearVideoDistributionOptions\n    : function refreshAutoGearVideoDistributionOptions() { };\n\nconst collectAutoGearSelectedValues =\n  typeof autoGearExports.collectAutoGearSelectedValues === 'function'\n    ? autoGearExports.collectAutoGearSelectedValues\n    : function collectAutoGearSelectedValues() { return []; };\n\nvar autoGearConditionRefreshers = {\n  always: null,\n  scenarios: refreshAutoGearScenarioOptions,\n  shootingDays: refreshAutoGearShootingDaysValue,\n  mattebox: refreshAutoGearMatteboxOptions,\n  cameraHandle: refreshAutoGearCameraHandleOptions,\n  viewfinderExtension: refreshAutoGearViewfinderExtensionOptions,\n  deliveryResolution: refreshAutoGearDeliveryResolutionOptions,\n  videoDistribution: refreshAutoGearVideoDistributionOptions,\n  camera: createDeferredAutoGearRefresher('refreshAutoGearCameraOptions'),\n  ownGear: refreshAutoGearOwnGearConditionOptions,\n  cameraWeight: createDeferredAutoGearRefresher('refreshAutoGearCameraWeightCondition'),\n  monitor: createDeferredAutoGearRefresher('refreshAutoGearMonitorOptions'),\n  tripodHeadBrand: createDeferredAutoGearRefresher('refreshAutoGearTripodHeadOptions'),\n  tripodBowl: createDeferredAutoGearRefresher('refreshAutoGearTripodBowlOptions'),\n  tripodTypes: createDeferredAutoGearRefresher('refreshAutoGearTripodTypesOptions'),\n  tripodSpreader: createDeferredAutoGearRefresher('refreshAutoGearTripodSpreaderOptions'),\n  crewPresent: selected =>\n    callCoreFunctionIfAvailable(\n      'refreshAutoGearCrewOptions',\n      [autoGearCrewPresentSelect, selected, 'crewPresent'],\n      { defer: true },\n    ),\n  crewAbsent: selected =>\n    callCoreFunctionIfAvailable(\n      'refreshAutoGearCrewOptions',\n      [autoGearCrewAbsentSelect, selected, 'crewAbsent'],\n      { defer: true },\n    ),\n  wireless: createDeferredAutoGearRefresher('refreshAutoGearWirelessOptions'),\n  motors: createDeferredAutoGearRefresher('refreshAutoGearMotorsOptions'),\n  controllers: createDeferredAutoGearRefresher('refreshAutoGearControllersOptions'),\n  distance: createDeferredAutoGearRefresher('refreshAutoGearDistanceOptions'),\n};\nvar autoGearActiveConditions = (typeof window !== 'undefined' && window.autoGearActiveConditions) || new Set();\nif (typeof window !== 'undefined' && !window.autoGearActiveConditions) window.autoGearActiveConditions = autoGearActiveConditions;\n\nfunction getAutoGearConditionConfig(key) {\n  if (!key) return null;\n  if (Object.prototype.hasOwnProperty.call(autoGearConditionConfigs, key)) {\n    return autoGearConditionConfigs[key];\n  }\n  return null;\n}\n\n// AUTO_GEAR_CONDITION_FALLBACK_LABELS is defined earlier in this file (around line 6776)\n\nfunction getAutoGearConditionLabel(key) {\n  const config = getAutoGearConditionConfig(key);\n  if (config && config.label && typeof config.label.textContent === 'string') {\n    const text = config.label.textContent.trim();\n    if (text) return text;\n  }\n  const fallback = AUTO_GEAR_CONDITION_FALLBACK_LABELS[key];\n  if (typeof fallback === 'string' && fallback) {\n    return fallback;\n  }\n  if (typeof key === 'string' && key) {\n    return key.replace(/([A-Z])/g, ' $1').replace(/^./, char => char.toUpperCase());\n  }\n  return '';\n}\n\nfunction isAutoGearConditionActive(key) {\n  return autoGearActiveConditions.has(key);\n}\n\nfunction refreshAutoGearConditionPicker() {\n  if (!autoGearConditionSelect) return;\n  const previousValue = autoGearConditionSelect.value || '';\n  const placeholderLabel = texts[currentLang]?.autoGearConditionPlaceholder\n    || texts.en?.autoGearConditionPlaceholder\n    || 'Choose a condition';\n  autoGearConditionSelect.innerHTML = '';\n  const placeholder = document.createElement('option');\n  placeholder.value = '';\n  placeholder.textContent = placeholderLabel;\n  autoGearConditionSelect.appendChild(placeholder);\n  const available = AUTO_GEAR_CONDITION_KEYS.filter(key => {\n    if (!autoGearActiveConditions.has(key)) {\n      return true;\n    }\n    return AUTO_GEAR_REPEATABLE_CONDITIONS.has(key);\n  });\n  available.forEach(key => {\n    const option = document.createElement('option');\n    option.value = key;\n    option.textContent = getAutoGearConditionLabel(key);\n    autoGearConditionSelect.appendChild(option);\n  });\n  if (previousValue && available.includes(previousValue)) {\n    autoGearConditionSelect.value = previousValue;\n  } else {\n    autoGearConditionSelect.value = '';\n  }\n  autoGearConditionSelect.disabled = available.length === 0;\n}\n\nfunction updateAutoGearConditionAddButtonState() {\n  const hasSelection = autoGearConditionSelect && autoGearConditionSelect.value;\n  const disabledPicker = autoGearConditionSelect ? autoGearConditionSelect.disabled : true;\n  if (autoGearConditionAddButton) {\n    autoGearConditionAddButton.disabled = !hasSelection || disabledPicker;\n  }\n  const hasAvailable = AUTO_GEAR_CONDITION_KEYS.some(key => {\n    if (!autoGearActiveConditions.has(key)) {\n      return true;\n    }\n    return AUTO_GEAR_REPEATABLE_CONDITIONS.has(key);\n  });\n  AUTO_GEAR_CONDITION_KEYS.forEach(key => {\n    const shortcut = autoGearConditionAddShortcuts[key];\n    if (shortcut) {\n      shortcut.disabled = !hasAvailable;\n    }\n  });\n}\n\nfunction focusAutoGearConditionSection(key, options = {}) {\n  const config = getAutoGearConditionConfig(key);\n  if (!config || !config.section) {\n    return;\n  }\n  const { section, select } = config;\n  const { flash = false } = options || {};\n  if (section.hidden) {\n    section.hidden = false;\n    section.setAttribute('aria-hidden', 'false');\n  }\n  if (flash && section.classList) {\n    section.classList.add('auto-gear-condition-flash');\n    const schedule = typeof window !== 'undefined' && typeof window.setTimeout === 'function'\n      ? window.setTimeout\n      : setTimeout;\n    schedule(() => {\n      section.classList.remove('auto-gear-condition-flash');\n    }, 1200);\n  }\n  const target = select || section.querySelector('select, input, button');\n  if (!target) return;\n  try {\n    target.focus({ preventScroll: true });\n  } catch {\n    target.focus();\n  }\n}\n\nfunction notifyAutoGearConditionRepeat(key) {\n  if (typeof showNotification !== 'function') {\n    return;\n  }\n  const template = texts[currentLang]?.autoGearConditionRepeatHint\n    || texts.en?.autoGearConditionRepeatHint\n    || '';\n  if (!template) return;\n  const label = getAutoGearConditionLabel(key);\n  let message;\n  if (label) {\n    message = template.replace('{condition}', label);\n  } else if (template.includes(' {condition}')) {\n    message = template.replace(' {condition}', '');\n  } else {\n    message = template.replace('{condition}', '');\n  }\n  if (message) {\n    showNotification('info', message);\n  }\n}\n\nfunction handleAutoGearConditionShortcut() {\n  if (!autoGearConditionSelect) {\n    focusAutoGearConditionPicker();\n    return;\n  }\n  if (autoGearConditionSelect.disabled) {\n    focusAutoGearConditionPicker();\n    return;\n  }\n  const availableOptions = Array.from(autoGearConditionSelect.options || [])\n    .filter(option => option.value);\n  if (availableOptions.length === 1) {\n    autoGearConditionSelect.value = availableOptions[0].value;\n    addAutoGearConditionFromPicker();\n    return;\n  }\n  focusAutoGearConditionPicker();\n}\n\nfunction addAutoGearCondition(key, options = {}) {\n  const config = getAutoGearConditionConfig(key);\n  if (!config) return false;\n  if (autoGearActiveConditions.has(key)) {\n    if (AUTO_GEAR_REPEATABLE_CONDITIONS.has(key)) {\n      focusAutoGearConditionSection(key, { flash: true });\n      notifyAutoGearConditionRepeat(key);\n      return true;\n    }\n    if (options.focus !== false && config.select) {\n      try {\n        config.select.focus({ preventScroll: true });\n      } catch {\n        config.select.focus();\n      }\n    }\n    return false;\n  }\n  autoGearActiveConditions.add(key);\n  if (config.section) {\n    config.section.hidden = false;\n    config.section.setAttribute('aria-hidden', 'false');\n  }\n  if (autoGearEditorDraft) {\n    if (key === 'always') {\n      autoGearEditorDraft.always = ['always'];\n    } else if (key === 'shootingDays') {\n      if (!autoGearEditorDraft.shootingDays) {\n        autoGearEditorDraft.shootingDays = null;\n      }\n    } else if (!Array.isArray(autoGearEditorDraft[key])) {\n      autoGearEditorDraft[key] = [];\n    }\n  }\n  let values;\n  if (key === 'always') {\n    values = ['always'];\n  } else if (key === 'shootingDays') {\n    if (options.initialValues) {\n      values = options.initialValues;\n    } else if (autoGearEditorDraft?.shootingDays) {\n      values = autoGearEditorDraft.shootingDays;\n    } else {\n      values = null;\n    }\n  } else {\n    values = Array.isArray(options.initialValues)\n      ? options.initialValues\n      : (Array.isArray(autoGearEditorDraft?.[key]) ? autoGearEditorDraft[key] : []);\n  }\n  const refresher = autoGearConditionRefreshers[key];\n  if (typeof refresher === 'function') {\n    refresher(values);\n  }\n  if (config.logicSelect) {\n    const property = AUTO_GEAR_CONDITION_LOGIC_FIELDS[key];\n    const stored = property && autoGearEditorDraft\n      ? normalizeAutoGearConditionLogic(autoGearEditorDraft[property])\n      : 'all';\n    config.logicSelect.value = stored;\n    config.logicSelect.disabled = false;\n  }\n  if (autoGearConditionSelect) {\n    autoGearConditionSelect.value = '';\n  }\n  refreshAutoGearConditionPicker();\n  updateAutoGearConditionAddButtonState();\n  if (options.focus !== false && config.select) {\n    try {\n      config.select.focus({ preventScroll: true });\n    } catch {\n      config.select.focus();\n    }\n  }\n  return true;\n}\n\nfunction addAutoGearConditionFromPicker() {\n  if (!autoGearConditionSelect) return false;\n  const key = autoGearConditionSelect.value;\n  if (!key) {\n    focusAutoGearConditionPicker();\n    return false;\n  }\n  const result = addAutoGearCondition(key, { focus: true });\n  if (result && autoGearConditionSelect) {\n    autoGearConditionSelect.value = '';\n  }\n  updateAutoGearConditionAddButtonState();\n  return result;\n}\n\nfunction removeAutoGearCondition(key, options = {}) {\n  const config = getAutoGearConditionConfig(key);\n  if (!config) return false;\n  if (!autoGearActiveConditions.has(key)) return false;\n  autoGearActiveConditions.delete(key);\n  if (config.section) {\n    config.section.hidden = true;\n    config.section.setAttribute('aria-hidden', 'true');\n  }\n  if (config.logicSelect) {\n    config.logicSelect.value = 'all';\n    config.logicSelect.disabled = true;\n  }\n  if (!options.preserveDraft && autoGearEditorDraft) {\n    if (key === 'always') {\n      autoGearEditorDraft.always = [];\n    } else if (key === 'shootingDays') {\n      autoGearEditorDraft.shootingDays = null;\n    } else if (key === 'cameraWeight') {\n      autoGearEditorDraft.cameraWeight = null;\n    } else if (Array.isArray(autoGearEditorDraft[key])) {\n      autoGearEditorDraft[key] = [];\n    }\n    const property = AUTO_GEAR_CONDITION_LOGIC_FIELDS[key];\n    if (property) {\n      autoGearEditorDraft[property] = 'all';\n      if (autoGearEditorDraft.conditionLogic && typeof autoGearEditorDraft.conditionLogic === 'object') {\n        delete autoGearEditorDraft.conditionLogic[key];\n      }\n    }\n  }\n  if (config.select) {\n    Array.from(config.select.options || []).forEach(option => {\n      option.selected = false;\n    });\n    config.select.value = '';\n  }\n  if (key === 'cameraWeight') {\n    if (autoGearCameraWeightOperator) {\n      autoGearCameraWeightOperator.value = 'greater';\n    }\n    if (autoGearCameraWeightValueInput) {\n      autoGearCameraWeightValueInput.value = '';\n    }\n  }\n  if (key === 'shootingDays') {\n    if (autoGearShootingDaysMode) {\n      autoGearShootingDaysMode.value = 'minimum';\n    }\n    if (autoGearShootingDaysInput) {\n      autoGearShootingDaysInput.value = '';\n    }\n  }\n  const refresher = autoGearConditionRefreshers[key];\n  if (typeof refresher === 'function') {\n    if (key === 'shootingDays') {\n      refresher(null);\n    } else {\n      refresher([]);\n    }\n  }\n  refreshAutoGearConditionPicker();\n  updateAutoGearConditionAddButtonState();\n  if (options.focusPicker) {\n    focusAutoGearConditionPicker();\n  }\n  return true;\n}\n\nfunction clearAllAutoGearConditions(options = {}) {\n  const { preserveDraft = false } = options || {};\n  Array.from(autoGearActiveConditions).forEach(key => {\n    removeAutoGearCondition(key, { preserveDraft, focusPicker: false });\n  });\n  AUTO_GEAR_CONDITION_KEYS.forEach(key => {\n    if (autoGearActiveConditions.has(key)) return;\n    const config = getAutoGearConditionConfig(key);\n    if (!config) return;\n    if (config.section) {\n      config.section.hidden = true;\n      config.section.setAttribute('aria-hidden', 'true');\n    }\n    if (!preserveDraft && autoGearEditorDraft) {\n      if (key === 'always') {\n        autoGearEditorDraft.always = [];\n      } else if (key === 'shootingDays') {\n        autoGearEditorDraft.shootingDays = null;\n      } else if (key === 'cameraWeight') {\n        autoGearEditorDraft.cameraWeight = null;\n      } else if (Array.isArray(autoGearEditorDraft[key])) {\n        autoGearEditorDraft[key] = [];\n      }\n      const property = AUTO_GEAR_CONDITION_LOGIC_FIELDS[key];\n      if (property) {\n        autoGearEditorDraft[property] = 'all';\n        if (autoGearEditorDraft.conditionLogic && typeof autoGearEditorDraft.conditionLogic === 'object') {\n          delete autoGearEditorDraft.conditionLogic[key];\n        }\n      }\n    }\n    if (config.select) {\n      Array.from(config.select.options || []).forEach(option => {\n        option.selected = false;\n      });\n      config.select.value = '';\n    }\n    if (config.logicSelect) {\n      config.logicSelect.value = 'all';\n      config.logicSelect.disabled = true;\n    }\n    if (key === 'cameraWeight') {\n      if (autoGearCameraWeightOperator) {\n        autoGearCameraWeightOperator.value = 'greater';\n      }\n      if (autoGearCameraWeightValueInput) {\n        autoGearCameraWeightValueInput.value = '';\n      }\n    }\n    if (key === 'shootingDays') {\n      if (autoGearShootingDaysMode) {\n        autoGearShootingDaysMode.value = 'minimum';\n      }\n      if (autoGearShootingDaysInput) {\n        autoGearShootingDaysInput.value = '';\n      }\n    }\n    const refresher = autoGearConditionRefreshers[key];\n    if (typeof refresher === 'function') {\n      if (key === 'shootingDays') {\n        const source = preserveDraft ? autoGearEditorDraft?.shootingDays : null;\n        refresher(source || null);\n      } else {\n        refresher(preserveDraft ? autoGearEditorDraft?.[key] : []);\n      }\n    }\n  });\n  autoGearActiveConditions.clear();\n  refreshAutoGearConditionPicker();\n  updateAutoGearConditionAddButtonState();\n}\n\nfunction initializeAutoGearConditionsFromDraft() {\n  clearAllAutoGearConditions({ preserveDraft: true });\n  AUTO_GEAR_CONDITION_KEYS.forEach(key => {\n    let hasValue = false;\n    let values = [];\n    if (key === 'always') {\n      values = autoGearEditorDraft?.always && autoGearEditorDraft.always.length ? ['always'] : [];\n      hasValue = values.length > 0;\n    } else if (key === 'shootingDays') {\n      const condition = autoGearEditorDraft?.shootingDays\n        ? normalizeAutoGearShootingDaysCondition(autoGearEditorDraft.shootingDays)\n        : null;\n      if (condition) {\n        values = condition;\n        hasValue = true;\n      }\n    } else if (key === 'cameraWeight') {\n      const condition = autoGearEditorDraft?.cameraWeight || null;\n      if (condition && typeof condition === 'object') {\n        values = condition;\n        hasValue = true;\n      }\n    } else if (Array.isArray(autoGearEditorDraft?.[key])) {\n      values = autoGearEditorDraft[key].filter(value => {\n        if (typeof value === 'number') {\n          return Number.isFinite(value) && value > 0;\n        }\n        if (typeof value === 'string') {\n          return value.trim();\n        }\n        return false;\n      });\n      hasValue = values.length > 0;\n    }\n    if (hasValue) {\n      addAutoGearCondition(key, { focus: false, initialValues: values });\n    } else {\n      const refresher = autoGearConditionRefreshers[key];\n      if (typeof refresher === 'function') {\n        if (key === 'shootingDays') {\n          refresher(null);\n        } else {\n          refresher([]);\n        }\n      }\n      const config = getAutoGearConditionConfig(key);\n      if (config) {\n        if (config.section) {\n          config.section.hidden = true;\n          config.section.setAttribute('aria-hidden', 'true');\n        }\n        if (config.select) {\n          config.select.value = '';\n        }\n        if (key === 'shootingDays') {\n          if (autoGearShootingDaysMode) {\n            autoGearShootingDaysMode.value = 'minimum';\n          }\n          if (autoGearShootingDaysInput) {\n            autoGearShootingDaysInput.value = '';\n          }\n        }\n      }\n    }\n  });\n  refreshAutoGearConditionPicker();\n  updateAutoGearConditionAddButtonState();\n  if (autoGearScenarioModeSelectElement && autoGearEditorDraft) {\n    autoGearScenarioModeSelectElement.value = normalizeAutoGearScenarioLogic(autoGearEditorDraft.scenarioLogic);\n  }\n  if (autoGearScenarioFactorInput) {\n    const storedMultiplier = autoGearEditorDraft\n      ? normalizeAutoGearScenarioMultiplier(autoGearEditorDraft.scenarioMultiplier)\n      : 1;\n    autoGearScenarioFactorInput.value = String(storedMultiplier);\n  }\n  applyAutoGearScenarioSettings(getAutoGearScenarioSelectedValues());\n}\n\nrefreshAutoGearConditionPicker();\nupdateAutoGearConditionAddButtonState();\nconfigureAutoGearConditionButtons();\nif (autoGearShootingDaysMode) {\n  const handleShootingDaysModeChange = () => {\n    updateAutoGearShootingDaysDraft();\n    callCoreFunctionIfAvailable('renderAutoGearDraftImpact', [], { defer: true });\n  };\n  autoGearShootingDaysMode.addEventListener('input', handleShootingDaysModeChange);\n  autoGearShootingDaysMode.addEventListener('change', handleShootingDaysModeChange);\n}\nif (autoGearShootingDaysInput) {\n  const handleShootingDaysValueInput = () => {\n    updateAutoGearShootingDaysDraft();\n    callCoreFunctionIfAvailable('renderAutoGearDraftImpact', [], { defer: true });\n  };\n  autoGearShootingDaysInput.addEventListener('input', handleShootingDaysValueInput);\n  autoGearShootingDaysInput.addEventListener('change', handleShootingDaysValueInput);\n  autoGearShootingDaysInput.addEventListener('blur', handleShootingDaysValueInput);\n}\nObject.entries(autoGearConditionLogicSelects).forEach(([key, select]) => {\n  if (!select) return;\n  const property = AUTO_GEAR_CONDITION_LOGIC_FIELDS[key];\n  const handleLogicChange = () => {\n    const normalized = normalizeAutoGearConditionLogic(select.value);\n    select.value = normalized;\n    if (autoGearEditorDraft && property) {\n      autoGearEditorDraft[property] = normalized;\n      if (!autoGearEditorDraft.conditionLogic || typeof autoGearEditorDraft.conditionLogic !== 'object') {\n        autoGearEditorDraft.conditionLogic = {};\n      }\n      if (normalized === 'all') {\n        delete autoGearEditorDraft.conditionLogic[key];\n      } else {\n        autoGearEditorDraft.conditionLogic[key] = normalized;\n      }\n    }\n    callCoreFunctionIfAvailable('renderAutoGearDraftImpact', [], { defer: true });\n  };\n  select.addEventListener('input', handleLogicChange);\n  select.addEventListener('change', handleLogicChange);\n});\nif (autoGearCameraWeightOperator) {\n  const handleCameraWeightOperatorChange = () => {\n    updateAutoGearCameraWeightDraft();\n    callCoreFunctionIfAvailable('renderAutoGearDraftImpact', [], { defer: true });\n  };\n  autoGearCameraWeightOperator.addEventListener('input', handleCameraWeightOperatorChange);\n  autoGearCameraWeightOperator.addEventListener('change', handleCameraWeightOperatorChange);\n}\nif (autoGearCameraWeightValueInput) {\n  const handleCameraWeightValueInput = () => {\n    updateAutoGearCameraWeightDraft();\n    callCoreFunctionIfAvailable('renderAutoGearDraftImpact', [], { defer: true });\n  };\n  autoGearCameraWeightValueInput.addEventListener('input', handleCameraWeightValueInput);\n  autoGearCameraWeightValueInput.addEventListener('change', handleCameraWeightValueInput);\n  autoGearCameraWeightValueInput.addEventListener('blur', handleCameraWeightValueInput);\n}\nvar autoGearAddItemsHeading = document.getElementById('autoGearAddItemsHeading');\nvar autoGearAddOwnGearLabel = document.getElementById('autoGearAddOwnGearLabel');\nvar autoGearAddItemLabel = document.getElementById('autoGearAddItemLabel');\nvar autoGearAddCategoryLabel = document.getElementById('autoGearAddCategoryLabel');\nvar autoGearAddQuantityLabel = document.getElementById('autoGearAddQuantityLabel');\nvar autoGearAddScreenSizeLabel = document.getElementById('autoGearAddScreenSizeLabel');\nvar autoGearAddSelectorTypeLabel = document.getElementById('autoGearAddSelectorTypeLabel');\nvar autoGearAddSelectorDefaultLabel = document.getElementById('autoGearAddSelectorDefaultLabel');\nvar autoGearAddNotesLabel = document.getElementById('autoGearAddNotesLabel');\nvar autoGearAddOwnGearSelect = document.getElementById('autoGearAddOwnGear');\nvar autoGearAddNameInput = document.getElementById('autoGearAddName');\nvar autoGearAddCategorySelect = document.getElementById('autoGearAddCategory');\nvar autoGearAddQuantityInput = document.getElementById('autoGearAddQuantity');\nvar autoGearAddScreenSizeInput = document.getElementById('autoGearAddScreenSize');\nvar autoGearAddSelectorTypeSelect = document.getElementById('autoGearAddSelectorType');\nvar autoGearAddSelectorDefaultInput = document.getElementById('autoGearAddSelectorDefault');\nvar autoGearAddNotesInput = document.getElementById('autoGearAddNotes');\nvar autoGearAddItemButton = document.getElementById('autoGearAddItemButton');\nvar autoGearAddList = document.getElementById('autoGearAddList');\nvar autoGearRemoveItemsHeading = document.getElementById('autoGearRemoveItemsHeading');\nvar autoGearRemoveOwnGearLabel = document.getElementById('autoGearRemoveOwnGearLabel');\nvar autoGearRemoveItemLabel = document.getElementById('autoGearRemoveItemLabel');\nvar autoGearRemoveCategoryLabel = document.getElementById('autoGearRemoveCategoryLabel');\nvar autoGearRemoveQuantityLabel = document.getElementById('autoGearRemoveQuantityLabel');\nvar autoGearRemoveScreenSizeLabel = document.getElementById('autoGearRemoveScreenSizeLabel');\nvar autoGearRemoveSelectorTypeLabel = document.getElementById('autoGearRemoveSelectorTypeLabel');\nvar autoGearRemoveSelectorDefaultLabel = document.getElementById('autoGearRemoveSelectorDefaultLabel');\nvar autoGearRemoveNotesLabel = document.getElementById('autoGearRemoveNotesLabel');\nvar autoGearRemoveOwnGearSelect = document.getElementById('autoGearRemoveOwnGear');\nvar autoGearRemoveNameInput = document.getElementById('autoGearRemoveName');\nvar autoGearRemoveCategorySelect = document.getElementById('autoGearRemoveCategory');\nvar autoGearRemoveQuantityInput = document.getElementById('autoGearRemoveQuantity');\nvar autoGearRemoveScreenSizeInput = document.getElementById('autoGearRemoveScreenSize');\nvar autoGearRemoveSelectorTypeSelect = document.getElementById('autoGearRemoveSelectorType');\nvar autoGearRemoveSelectorDefaultInput = document.getElementById('autoGearRemoveSelectorDefault');\nvar autoGearRemoveNotesInput = document.getElementById('autoGearRemoveNotes');\nvar autoGearRemoveItemButton = document.getElementById('autoGearRemoveItemButton');\nvar autoGearRemoveList = document.getElementById('autoGearRemoveList');\nvar autoGearDraftImpactContainer = document.getElementById('autoGearDraftImpact');\nvar autoGearDraftImpactHeading = document.getElementById('autoGearDraftImpactHeading');\nvar autoGearDraftImpactDescription = document.getElementById('autoGearDraftImpactDescription');\nvar autoGearDraftImpactList = document.getElementById('autoGearDraftImpactList');\nvar autoGearDraftWarningContainer = document.getElementById('autoGearDraftWarningContainer');\nvar autoGearDraftWarningHeading = document.getElementById('autoGearDraftWarningHeading');\nvar autoGearDraftWarningList = document.getElementById('autoGearDraftWarningList');\nvar autoGearSaveRuleButton = document.getElementById('autoGearSaveRule');\nvar autoGearCancelEditButton = document.getElementById('autoGearCancelEdit');\nvar autoGearItemCatalog = document.getElementById('autoGearItemCatalog');\n\nupdateAutoGearOwnGearOptions();\n\nif (typeof document !== 'undefined' && document) {\n  document.addEventListener('own-gear-data-changed', () => {\n    invalidateAutoGearOwnGearCache();\n    updateAutoGearOwnGearOptions();\n    updateAutoGearCatalogOptions();\n  });\n}\n\nfunction enableAutoGearMultiSelectToggle(select) {\n  if (!select || !select.multiple) return;\n\n  const handlePointerToggle = event => {\n    if (!select.multiple || event.defaultPrevented) return;\n\n    const isPointerEvent = typeof PointerEvent !== 'undefined' && event instanceof PointerEvent;\n    if (isPointerEvent && event.pointerType && event.pointerType !== 'mouse') {\n      return;\n    }\n\n    if (typeof event.button === 'number' && event.button !== 0) {\n      return;\n    }\n\n    if (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey) {\n      return;\n    }\n\n    const option = event.target instanceof HTMLOptionElement ? event.target : null;\n    if (!option || option.disabled) {\n      return;\n    }\n\n    event.preventDefault();\n\n    option.selected = !option.selected;\n\n    const dispatchEvent = type => {\n      try {\n        const evt = new Event(type, { bubbles: true });\n        select.dispatchEvent(evt);\n      } catch {\n        const evt = document.createEvent('Event');\n        evt.initEvent(type, true, true);\n        select.dispatchEvent(evt);\n      }\n    };\n\n    dispatchEvent('input');\n    dispatchEvent('change');\n\n    if (typeof select.focus === 'function') {\n      try {\n        select.focus({ preventScroll: true });\n      } catch {\n        select.focus();\n      }\n    }\n  };\n\n  if (typeof window !== 'undefined' && typeof window.PointerEvent !== 'undefined') {\n    select.addEventListener('pointerdown', handlePointerToggle);\n  } else {\n    select.addEventListener('mousedown', handlePointerToggle);\n  }\n}\n\n[\n  autoGearScenariosSelect,\n  autoGearMatteboxSelect,\n  autoGearCameraHandleSelect,\n  autoGearViewfinderExtensionSelect,\n  autoGearVideoDistributionSelect,\n  autoGearCameraSelect,\n  autoGearOwnGearSelect,\n  autoGearMonitorSelect,\n  autoGearCrewPresentSelect,\n  autoGearCrewAbsentSelect,\n  autoGearWirelessSelect,\n  autoGearMotorsSelect,\n  autoGearControllersSelect,\n  autoGearDistanceSelect,\n].forEach(enableAutoGearMultiSelectToggle);\n\nvar autoGearAddScreenSizeField = autoGearAddScreenSizeInput?.closest('.auto-gear-field')\n  || autoGearAddScreenSizeLabel?.closest('.auto-gear-field')\n  || null;\nvar autoGearAddSelectorTypeField = autoGearAddSelectorTypeSelect?.closest('.auto-gear-field')\n  || autoGearAddSelectorTypeLabel?.closest('.auto-gear-field')\n  || null;\nvar autoGearAddSelectorDefaultField = autoGearAddSelectorDefaultInput?.closest('.auto-gear-field')\n  || autoGearAddSelectorDefaultLabel?.closest('.auto-gear-field')\n  || null;\nvar autoGearRemoveScreenSizeField = autoGearRemoveScreenSizeInput?.closest('.auto-gear-field')\n  || autoGearRemoveScreenSizeLabel?.closest('.auto-gear-field')\n  || null;\nvar autoGearRemoveSelectorTypeField = autoGearRemoveSelectorTypeSelect?.closest('.auto-gear-field')\n  || autoGearRemoveSelectorTypeLabel?.closest('.auto-gear-field')\n  || null;\nvar autoGearRemoveSelectorDefaultField = autoGearRemoveSelectorDefaultInput?.closest('.auto-gear-field')\n  || autoGearRemoveSelectorDefaultLabel?.closest('.auto-gear-field')\n  || null;\n\nautoGearAddMonitorFieldGroup = {\n  select: autoGearAddCategorySelect,\n  screenSizeField: autoGearAddScreenSizeField,\n  screenSizeInput: autoGearAddScreenSizeInput,\n  selectorTypeField: autoGearAddSelectorTypeField,\n  selectorTypeSelect: autoGearAddSelectorTypeSelect,\n  selectorDefaultField: autoGearAddSelectorDefaultField,\n  selectorDefaultInput: autoGearAddSelectorDefaultInput,\n};\n\nautoGearRemoveMonitorFieldGroup = {\n  select: autoGearRemoveCategorySelect,\n  screenSizeField: autoGearRemoveScreenSizeField,\n  screenSizeInput: autoGearRemoveScreenSizeInput,\n  selectorTypeField: autoGearRemoveSelectorTypeField,\n  selectorTypeSelect: autoGearRemoveSelectorTypeSelect,\n  selectorDefaultField: autoGearRemoveSelectorDefaultField,\n  selectorDefaultInput: autoGearRemoveSelectorDefaultInput,\n};\n\nautoGearMonitorDefaultGroups = [\n  {\n    selectorTypeSelect: autoGearAddSelectorTypeSelect,\n    selectorDefaultInput: autoGearAddSelectorDefaultInput,\n  },\n  {\n    selectorTypeSelect: autoGearRemoveSelectorTypeSelect,\n    selectorDefaultInput: autoGearRemoveSelectorDefaultInput,\n  },\n].filter(group => group.selectorDefaultInput);\n\nfunction syncAutoGearMonitorFieldVisibility() {\n  const updateFn = typeof window !== 'undefined' && window.updateAutoGearMonitorFieldGroup;\n  if (typeof updateFn !== 'function') return;\n  if (autoGearAddMonitorFieldGroup) {\n    updateFn(autoGearAddMonitorFieldGroup);\n  }\n  if (autoGearRemoveMonitorFieldGroup) {\n    updateFn(autoGearRemoveMonitorFieldGroup);\n  }\n}\n\nexposeCoreRuntimeConstant('syncAutoGearMonitorFieldVisibility', syncAutoGearMonitorFieldVisibility);\nvar autoGearExportButton = document.getElementById('autoGearExport');\nvar autoGearImportButton = document.getElementById('autoGearImport');\nvar autoGearImportInput = document.getElementById('autoGearImportInput');\nvar autoGearBackupsSection = document.getElementById('autoGearBackupsSection');\nvar autoGearBackupsHeading = document.getElementById('autoGearBackupsHeading');\nvar autoGearBackupsDescription = document.getElementById('autoGearBackupsDescription');\nvar autoGearBackupSelectLabel = document.getElementById('autoGearBackupSelectLabel');\nvar autoGearBackupSelect = document.getElementById('autoGearBackupSelect');\nvar autoGearBackupRestoreButton = document.getElementById('autoGearBackupRestore');\nvar autoGearBackupControls = document.getElementById('autoGearBackupControls');\nvar autoGearBackupEmptyMessage = document.getElementById('autoGearBackupEmpty');\nvar autoGearBackupRetentionLabel = document.getElementById('autoGearBackupRetentionLabel');\nvar autoGearBackupRetentionInput = document.getElementById('autoGearBackupRetention');\nvar autoGearBackupRetentionSummary = document.getElementById('autoGearBackupRetentionSummary');\nvar autoGearBackupRetentionWarning = document.getElementById('autoGearBackupRetentionWarning');\nvar autoGearShowBackupsCheckbox = document.getElementById('autoGearShowBackups');\nvar autoGearShowBackupsLabel = document.getElementById('autoGearShowBackupsLabel');\nvar autoGearBackupsHiddenNotice = document.getElementById('autoGearBackupsHidden');\nconst dataHeading = document.getElementById(\"dataHeading\");\nconst storageSummaryIntro = document.getElementById(\"storageSummaryIntro\");\nconst storageSummaryList = document.getElementById(\"storageSummaryList\");\nif (typeof globalThis !== 'undefined') {\n  globalThis.storageSummaryList = storageSummaryList;\n}\nconst storageSummaryEmpty = document.getElementById(\"storageSummaryEmpty\");\nconst storageSummaryFootnote = document.getElementById(\"storageSummaryFootnote\");\nconst storagePersistenceSection = document.getElementById(\"storagePersistence\");\nconst storagePersistenceHeading = document.getElementById(\"storagePersistenceHeading\");\nconst storagePersistenceIntro = document.getElementById(\"storagePersistenceIntro\");\nconst storagePersistenceRequestButton = document.getElementById(\"storagePersistenceRequest\");\nconst storagePersistenceStatus = document.getElementById(\"storagePersistenceStatus\");\nvar storageActionsHeading = document.getElementById('storageActionsHeading');\nvar storageActionsIntro = document.getElementById('storageActionsIntro');\nvar storageBackupNowButton = document.getElementById('storageBackupNow');\nvar storageOpenBackupTabButton = document.getElementById('storageOpenBackupTab');\nvar storageStatusHeading = document.getElementById('storageStatusHeading');\nvar storageStatusLastProjectLabel = document.getElementById('storageStatusLastProjectLabel');\nvar storageStatusLastProjectValue = document.getElementById('storageStatusLastProjectValue');\nvar storageStatusLastAutoBackupLabel = document.getElementById('storageStatusLastAutoBackupLabel');\nvar storageStatusLastAutoBackupValue = document.getElementById('storageStatusLastAutoBackupValue');\nvar storageStatusLastFullBackupLabel = document.getElementById('storageStatusLastFullBackupLabel');\nvar storageStatusLastFullBackupValue = document.getElementById('storageStatusLastFullBackupValue');\nvar storageStatusReminder = document.getElementById('storageStatusReminder');\nconst loggingSection = document.getElementById('loggingSection');\nconst loggingHeading = document.getElementById('loggingHeading');\nconst loggingIntro = document.getElementById('loggingIntro');\nconst loggingLevelFilterLabel = document.getElementById('loggingLevelFilterLabel');\nconst loggingLevelFilter = document.getElementById('loggingLevelFilter');\nconst loggingNamespaceFilterLabel = document.getElementById('loggingNamespaceFilterLabel');\nconst loggingNamespaceFilter = document.getElementById('loggingNamespaceFilter');\nconst loggingNamespaceFilterHelp = document.getElementById('loggingNamespaceFilterHelp');\nconst loggingHistoryLimitLabel = document.getElementById('loggingHistoryLimitLabel');\nconst loggingHistoryLimit = document.getElementById('loggingHistoryLimit');\nconst loggingHistoryLimitHelp = document.getElementById('loggingHistoryLimitHelp');\nconst loggingConsoleOutputLabel = document.getElementById('loggingConsoleOutputLabel');\nconst loggingConsoleOutputHelp = document.getElementById('loggingConsoleOutputHelp');\nconst loggingCaptureConsoleLabel = document.getElementById('loggingCaptureConsoleLabel');\nconst loggingCaptureConsoleHelp = document.getElementById('loggingCaptureConsoleHelp');\nconst loggingCaptureErrorsLabel = document.getElementById('loggingCaptureErrorsLabel');\nconst loggingCaptureErrorsHelp = document.getElementById('loggingCaptureErrorsHelp');\nconst loggingPersistSessionLabel = document.getElementById('loggingPersistSessionLabel');\nconst loggingPersistSessionHelp = document.getElementById('loggingPersistSessionHelp');\nconst loggingExportButton = document.getElementById('loggingExportBtn');\nconst loggingExportHelp = document.getElementById('loggingExportHelp');\nconst loggingStatus = document.getElementById('loggingStatus');\nconst loggingEmpty = document.getElementById('loggingEmpty');\nconst loggingUnavailable = document.getElementById('loggingUnavailable');\n\nif (autoGearBackupRetentionInput) {\n  const queueAutoGearRetentionHandler = handlerName => {\n    callCoreFunctionIfAvailable(handlerName, [], { defer: true });\n  };\n\n  autoGearBackupRetentionInput.addEventListener('input', () => {\n    queueAutoGearRetentionHandler('handleAutoGearBackupRetentionInput');\n  });\n  autoGearBackupRetentionInput.addEventListener('blur', () => {\n    queueAutoGearRetentionHandler('handleAutoGearBackupRetentionBlur');\n  });\n  autoGearBackupRetentionInput.addEventListener('change', () => {\n    queueAutoGearRetentionHandler('handleAutoGearBackupRetentionChange');\n  });\n}\n\nfunction computeAutoGearMultiSelectSize(optionCount, {\n  fallback,\n  minRows = AUTO_GEAR_MULTI_SELECT_MIN_ROWS,\n  maxRows = AUTO_GEAR_MULTI_SELECT_MAX_ROWS,\n} = {}) {\n  const effectiveFallback = Number.isFinite(fallback) && fallback >= minRows\n    ? fallback\n    : minRows;\n  if (!Number.isFinite(optionCount) || optionCount <= 0) {\n    return effectiveFallback;\n  }\n  const boundedMax = Number.isFinite(maxRows) && maxRows >= minRows ? maxRows : minRows;\n  return Math.max(minRows, Math.min(optionCount, boundedMax));\n}\n\nfunction setAutoGearSearchQuery(value) {\n  const nextValue = typeof value === 'string' ? value : '';\n  if (autoGearSearchQuery === nextValue) return;\n  autoGearSearchQuery = nextValue;\n  callCoreFunctionIfAvailable('renderAutoGearRulesList', [], { defer: true });\n}\n\nfunction setAutoGearScenarioFilter(value) {\n  const nextValue = typeof value === 'string' && value !== 'all' ? value : 'all';\n  if (autoGearScenarioFilter === nextValue) return;\n  autoGearScenarioFilter = nextValue;\n  callCoreFunctionIfAvailable('renderAutoGearRulesList', [], { defer: true });\n}\n\nfunction clearAutoGearFilters() {\n  autoGearSearchQuery = '';\n  autoGearScenarioFilter = 'all';\n  autoGearSummaryFocus = 'all';\n  if (autoGearSearchInput && autoGearSearchInput.value !== '') {\n    autoGearSearchInput.value = '';\n  }\n  if (autoGearFilterScenarioSelect && autoGearFilterScenarioSelect.value !== 'all') {\n    autoGearFilterScenarioSelect.value = 'all';\n  }\n  callCoreFunctionIfAvailable('renderAutoGearRulesList', [], { defer: true });\n  if (autoGearSearchInput && typeof autoGearSearchInput.focus === 'function') {\n    try {\n      autoGearSearchInput.focus({ preventScroll: true });\n    } catch {\n      autoGearSearchInput.focus();\n    }\n  }\n}\n\nfunction autoGearRuleMatchesScenario(rule, scenarioValue) {\n  if (!scenarioValue || scenarioValue === 'all') return true;\n  if (!rule || !Array.isArray(rule.scenarios)) return false;\n  return rule.scenarios.some(value => value === scenarioValue);\n}\n\nfunction autoGearRuleMatchesSearch(rule, query) {\n  const normalizedQuery = typeof query === 'string' ? query.trim().toLowerCase() : '';\n  if (!normalizedQuery) return true;\n  const haystack = [];\n  const pushValues = values => {\n    if (!Array.isArray(values)) return;\n    values.forEach(value => {\n      if (typeof value === 'string' && value) {\n        haystack.push(value);\n      }\n    });\n  };\n  if (rule && typeof rule.label === 'string') {\n    haystack.push(rule.label);\n  }\n  if (rule && rule.always) {\n    haystack.push('always');\n    const alwaysText = texts[currentLang]?.autoGearAlwaysMeta\n      || texts.en?.autoGearAlwaysMeta\n      || 'Always active';\n    if (alwaysText) {\n      haystack.push(alwaysText);\n    }\n  }\n  pushValues(rule?.scenarios);\n  pushValues(rule?.mattebox);\n  pushValues(rule?.cameraHandle);\n  pushValues(rule?.viewfinderExtension);\n  pushValues(rule?.deliveryResolution);\n  pushValues(rule?.videoDistribution);\n  pushValues(rule?.camera);\n  pushValues(rule?.monitor);\n  pushValues(rule?.crewPresent);\n  pushValues(rule?.crewAbsent);\n  pushValues(rule?.wireless);\n  pushValues(rule?.motors);\n  pushValues(rule?.controllers);\n  pushValues(rule?.distance);\n  const shootingCondition = normalizeAutoGearShootingDaysCondition(rule?.shootingDays);\n  if (shootingCondition) {\n    const shootingLabel = texts[currentLang]?.autoGearShootingDaysLabel\n      || texts.en?.autoGearShootingDaysLabel\n      || 'Shooting days condition';\n    const minimumLabel = texts[currentLang]?.autoGearShootingDaysModeMinimum\n      || texts.en?.autoGearShootingDaysModeMinimum\n      || 'Minimum';\n    const maximumLabel = texts[currentLang]?.autoGearShootingDaysModeMaximum\n      || texts.en?.autoGearShootingDaysModeMaximum\n      || 'Maximum';\n    const everyLabel = texts[currentLang]?.autoGearShootingDaysModeEvery\n      || texts.en?.autoGearShootingDaysModeEvery\n      || 'Every';\n    if (shootingLabel) {\n      haystack.push(shootingLabel);\n    }\n    haystack.push(String(shootingCondition.value));\n    if (shootingCondition.mode === 'minimum') {\n      haystack.push(minimumLabel);\n    } else if (shootingCondition.mode === 'maximum') {\n      haystack.push(maximumLabel);\n    } else if (shootingCondition.mode === 'every') {\n      haystack.push(everyLabel);\n    }\n  }\n  const collectItems = items => {\n    if (!Array.isArray(items)) return;\n    items.forEach(item => {\n      if (!item || typeof item !== 'object') return;\n      if (typeof item.name === 'string' && item.name) {\n        haystack.push(item.name);\n      }\n      if (typeof item.notes === 'string' && item.notes) {\n        haystack.push(item.notes);\n      }\n      if (typeof item.category === 'string' && item.category) {\n        haystack.push(item.category);\n      }\n      if (typeof item.screenSize === 'string' && item.screenSize) {\n        haystack.push(item.screenSize);\n      }\n      if (item.selector && typeof item.selector === 'object') {\n        if (typeof item.selector.type === 'string' && item.selector.type) {\n          haystack.push(item.selector.type);\n        }\n        if (typeof item.selector.default === 'string' && item.selector.default) {\n          haystack.push(item.selector.default);\n        }\n      }\n      haystack.push(safeFormatAutoGearItemSummary(item));\n    });\n  };\n  collectItems(rule?.add);\n  collectItems(rule?.remove);\n  return haystack.some(value =>\n    typeof value === 'string' && value.toLowerCase().includes(normalizedQuery)\n  );\n}\n\nconst AUTO_GEAR_SCENARIO_FALLBACK_VALUES = Object.freeze([\n  'Indoor',\n  'Outdoor',\n  'Studio',\n  'Tripod',\n  'Handheld',\n  'Easyrig',\n  'Cine Saddle',\n  'Steadybag',\n  'Dolly',\n  'Slider',\n  'Steadicam',\n  'Gimbal',\n  'Trinity',\n  'Rollcage',\n  'Car Mount',\n  'Jib',\n  'Undersling mode',\n  'Crane',\n  'Remote Head',\n  'Extreme cold (snow)',\n  'Extreme rain',\n  'Extreme heat',\n  'Rain Machine',\n  'Slow Motion',\n  'Battery Belt',\n]);\n\nfunction getAutoGearScenarioFallbackOptions() {\n  const normalizeEntry = entry => {\n    if (!entry || typeof entry !== 'object') {\n      return null;\n    }\n\n    const { value, label } = entry;\n    if (typeof value !== 'string') {\n      return null;\n    }\n\n    const trimmedValue = value.trim();\n    if (!trimmedValue) {\n      return null;\n    }\n\n    const displayLabel =\n      typeof label === 'string' && label.trim()\n        ? label.trim()\n        : trimmedValue;\n\n    return { value: trimmedValue, label: displayLabel };\n  };\n\n  const resolveFromSession = () => {\n    const sessionEntries = callCoreFunctionIfAvailable(\n      'getRequiredScenarioOptionEntries',\n      [],\n      { defaultValue: null },\n    );\n\n    if (Array.isArray(sessionEntries) && sessionEntries.length) {\n      const normalized = sessionEntries\n        .map(normalizeEntry)\n        .filter(Boolean);\n      if (normalized.length) {\n        return normalized;\n      }\n    }\n    return null;\n  };\n\n  const resolveFromScenarioIcons = () => {\n    const scope = getCoreGlobalObject();\n    const scenarioIcons = scope && scope.scenarioIcons;\n    if (!scenarioIcons || typeof scenarioIcons !== 'object') {\n      return null;\n    }\n\n    const entries = Object.keys(scenarioIcons)\n      .filter(key => typeof key === 'string')\n      .map(key => key.trim())\n      .filter(Boolean)\n      .map(value => ({ value, label: value }));\n\n    return entries.length ? entries : null;\n  };\n\n  const resolveFromFallbackValues = () =>\n    AUTO_GEAR_SCENARIO_FALLBACK_VALUES.map(value => ({ value, label: value }));\n\n  return (\n    resolveFromSession()\n    || resolveFromScenarioIcons()\n    || resolveFromFallbackValues()\n  ).sort((a, b) => localeSort(a.label, b.label));\n}\n\nfunction collectAutoGearScenarioFilterOptions(rules) {\n  const options = new Map();\n  const source = document.getElementById('requiredScenarios');\n  if (source) {\n    Array.from(source.options || []).forEach(option => {\n      const value = typeof option.value === 'string' ? option.value.trim() : '';\n      if (!value) return;\n      const label = option.textContent || value;\n      if (!options.has(value)) {\n        options.set(value, label);\n      }\n    });\n  }\n  if (Array.isArray(rules)) {\n    rules.forEach(rule => {\n      if (!rule || !Array.isArray(rule.scenarios)) return;\n      rule.scenarios.forEach(value => {\n        if (typeof value !== 'string') return;\n        const trimmed = value.trim();\n        if (!trimmed) return;\n        if (!options.has(trimmed)) {\n          options.set(trimmed, trimmed);\n        }\n      });\n    });\n  }\n  if (!options.size) {\n    getAutoGearScenarioFallbackOptions().forEach(({ value, label }) => {\n      if (!options.has(value)) {\n        options.set(value, label);\n      }\n    });\n  }\n  return Array.from(options.entries())\n    .map(([value, label]) => ({ value, label }))\n    .sort((a, b) => localeSort(a.label, b.label));\n}\n\nfunction refreshAutoGearScenarioFilterOptions(rules) {\n  if (!autoGearFilterScenarioSelect) return autoGearScenarioFilter;\n  const options = collectAutoGearScenarioFilterOptions(rules);\n  const anyLabel = texts[currentLang]?.autoGearFilterScenarioAny\n    || texts.en?.autoGearFilterScenarioAny\n    || 'All scenarios';\n  autoGearFilterScenarioSelect.innerHTML = '';\n  const anyOption = document.createElement('option');\n  anyOption.value = 'all';\n  anyOption.textContent = anyLabel;\n  autoGearFilterScenarioSelect.appendChild(anyOption);\n  options.forEach(({ value, label }) => {\n    const option = document.createElement('option');\n    option.value = value;\n    option.textContent = label;\n    if (value === autoGearScenarioFilter) {\n      option.selected = true;\n    }\n    autoGearFilterScenarioSelect.appendChild(option);\n  });\n  const optionsAvailable = options.length > 0;\n  autoGearFilterScenarioSelect.disabled = !optionsAvailable;\n  if (!optionsAvailable && autoGearScenarioFilter !== 'all') {\n    autoGearScenarioFilter = 'all';\n  } else if (\n    autoGearScenarioFilter !== 'all' &&\n    !options.some(option => option.value === autoGearScenarioFilter)\n  ) {\n    autoGearScenarioFilter = 'all';\n  }\n  autoGearFilterScenarioSelect.value = autoGearScenarioFilter;\n  return autoGearScenarioFilter;\n}\n\nfunction cloneAutoGearDraftItem(item) {\n  const normalized = normalizeAutoGearItem(item);\n  if (normalized) return normalized;\n  return {\n    id: generateAutoGearId('item'),\n    name: '',\n    category: '',\n    quantity: 1,\n    screenSize: '',\n    selectorType: 'none',\n    selectorDefault: '',\n    selectorEnabled: false,\n    notes: '',\n    ownGearId: '',\n    ownGearLabel: '',\n  };\n}\n\nfunction createAutoGearDraft(rule) {\n  if (rule) {\n    const scenarioLogic = normalizeAutoGearScenarioLogic(rule.scenarioLogic);\n    const matteboxLogic = readAutoGearConditionLogic(rule, 'mattebox');\n    const cameraHandleLogic = readAutoGearConditionLogic(rule, 'cameraHandle');\n    const viewfinderExtensionLogic = readAutoGearConditionLogic(rule, 'viewfinderExtension');\n    const deliveryResolutionLogic = readAutoGearConditionLogic(rule, 'deliveryResolution');\n    const videoDistributionLogic = readAutoGearConditionLogic(rule, 'videoDistribution');\n    const cameraLogic = readAutoGearConditionLogic(rule, 'camera');\n    const ownGearLogic = readAutoGearConditionLogic(rule, 'ownGear');\n    const monitorLogic = readAutoGearConditionLogic(rule, 'monitor');\n    const crewPresentLogic = readAutoGearConditionLogic(rule, 'crewPresent');\n    const crewAbsentLogic = readAutoGearConditionLogic(rule, 'crewAbsent');\n    const wirelessLogic = readAutoGearConditionLogic(rule, 'wireless');\n    const motorsLogic = readAutoGearConditionLogic(rule, 'motors');\n    const controllersLogic = readAutoGearConditionLogic(rule, 'controllers');\n    const distanceLogic = readAutoGearConditionLogic(rule, 'distance');\n    const draftConditionLogic = {};\n    if (scenarioLogic !== 'all') draftConditionLogic.scenarios = scenarioLogic;\n    if (matteboxLogic !== 'all') draftConditionLogic.mattebox = matteboxLogic;\n    if (cameraHandleLogic !== 'all') draftConditionLogic.cameraHandle = cameraHandleLogic;\n    if (viewfinderExtensionLogic !== 'all') draftConditionLogic.viewfinderExtension = viewfinderExtensionLogic;\n    if (deliveryResolutionLogic !== 'all') draftConditionLogic.deliveryResolution = deliveryResolutionLogic;\n    if (videoDistributionLogic !== 'all') draftConditionLogic.videoDistribution = videoDistributionLogic;\n    if (cameraLogic !== 'all') draftConditionLogic.camera = cameraLogic;\n    if (ownGearLogic !== 'all') draftConditionLogic.ownGear = ownGearLogic;\n    if (monitorLogic !== 'all') draftConditionLogic.monitor = monitorLogic;\n    if (crewPresentLogic !== 'all') draftConditionLogic.crewPresent = crewPresentLogic;\n    if (crewAbsentLogic !== 'all') draftConditionLogic.crewAbsent = crewAbsentLogic;\n    if (wirelessLogic !== 'all') draftConditionLogic.wireless = wirelessLogic;\n    if (motorsLogic !== 'all') draftConditionLogic.motors = motorsLogic;\n    if (controllersLogic !== 'all') draftConditionLogic.controllers = controllersLogic;\n    if (distanceLogic !== 'all') draftConditionLogic.distance = distanceLogic;\n    return {\n      id: rule.id,\n      label: rule.label || '',\n      always: rule.always ? ['always'] : [],\n      scenarioLogic,\n      scenarioPrimary: normalizeAutoGearScenarioPrimary(rule.scenarioPrimary),\n      scenarioMultiplier: normalizeAutoGearScenarioMultiplier(rule.scenarioMultiplier),\n      scenarios: Array.isArray(rule.scenarios) ? rule.scenarios.slice() : [],\n      mattebox: Array.isArray(rule.mattebox) ? rule.mattebox.slice() : [],\n      cameraHandle: Array.isArray(rule.cameraHandle) ? rule.cameraHandle.slice() : [],\n      viewfinderExtension: Array.isArray(rule.viewfinderExtension) ? rule.viewfinderExtension.slice() : [],\n      deliveryResolution: Array.isArray(rule.deliveryResolution) ? rule.deliveryResolution.slice() : [],\n      videoDistribution: Array.isArray(rule.videoDistribution) ? rule.videoDistribution.slice() : [],\n      camera: Array.isArray(rule.camera) ? rule.camera.slice() : [],\n      ownGear: Array.isArray(rule.ownGear) ? rule.ownGear.slice() : [],\n      cameraWeight: rule.cameraWeight\n        ? normalizeAutoGearCameraWeightCondition(rule.cameraWeight) || null\n        : null,\n      monitor: Array.isArray(rule.monitor) ? rule.monitor.slice() : [],\n      crewPresent: Array.isArray(rule.crewPresent) ? rule.crewPresent.slice() : [],\n      crewAbsent: Array.isArray(rule.crewAbsent) ? rule.crewAbsent.slice() : [],\n      wireless: Array.isArray(rule.wireless) ? rule.wireless.slice() : [],\n      motors: Array.isArray(rule.motors) ? rule.motors.slice() : [],\n      controllers: Array.isArray(rule.controllers) ? rule.controllers.slice() : [],\n      distance: Array.isArray(rule.distance) ? rule.distance.slice() : [],\n      shootingDays: normalizeAutoGearShootingDaysCondition(rule.shootingDays),\n      add: Array.isArray(rule.add) ? rule.add.map(cloneAutoGearDraftItem) : [],\n      remove: Array.isArray(rule.remove) ? rule.remove.map(cloneAutoGearDraftItem) : [],\n      matteboxLogic,\n      cameraHandleLogic,\n      viewfinderExtensionLogic,\n      deliveryResolutionLogic,\n      videoDistributionLogic,\n      cameraLogic,\n      ownGearLogic,\n      monitorLogic,\n      crewPresentLogic,\n      crewAbsentLogic,\n      wirelessLogic,\n      motorsLogic,\n      controllersLogic,\n      distanceLogic,\n      conditionLogic: draftConditionLogic,\n    };\n  }\n  return {\n    id: generateAutoGearId('rule'),\n    label: '',\n    always: [],\n    scenarioLogic: 'all',\n    scenarioPrimary: '',\n    scenarioMultiplier: 1,\n    scenarios: [],\n    mattebox: [],\n    cameraHandle: [],\n    viewfinderExtension: [],\n    deliveryResolution: [],\n    videoDistribution: [],\n    camera: [],\n    ownGear: [],\n    cameraWeight: null,\n    monitor: [],\n    crewPresent: [],\n    crewAbsent: [],\n    wireless: [],\n    motors: [],\n    controllers: [],\n    distance: [],\n    shootingDays: null,\n    add: [],\n    remove: [],\n    matteboxLogic: 'all',\n    cameraHandleLogic: 'all',\n    viewfinderExtensionLogic: 'all',\n    deliveryResolutionLogic: 'all',\n    videoDistributionLogic: 'all',\n    cameraLogic: 'all',\n    ownGearLogic: 'all',\n    monitorLogic: 'all',\n    crewPresentLogic: 'all',\n    crewAbsentLogic: 'all',\n    wirelessLogic: 'all',\n    motorsLogic: 'all',\n    controllersLogic: 'all',\n    distanceLogic: 'all',\n    conditionLogic: {},\n  };\n}\n\nfunction getCrewRoleEntries() {\n  const langTexts = texts[currentLang] || texts.en || {};\n  const crewRoleMap = langTexts.crewRoles || texts.en?.crewRoles || {};\n  const seen = new Set();\n  const entries = [];\n  Object.entries(crewRoleMap).forEach(([value, label]) => {\n    if (typeof value !== 'string') return;\n    const trimmedValue = value.trim();\n    if (!trimmedValue) return;\n    const key = trimmedValue.toLowerCase();\n    if (seen.has(key)) return;\n    seen.add(key);\n    const displayLabel = typeof label === 'string' && label.trim() ? label.trim() : trimmedValue;\n    entries.push({ value: trimmedValue, label: displayLabel });\n  });\n  return entries.sort((a, b) => a.label.localeCompare(b.label, undefined, { sensitivity: 'base' }));\n}\n\nexposeCoreRuntimeConstant('setupInstallBanner', setupInstallBanner);\nexposeCoreRuntimeConstant('maybeShowIosPwaHelp', maybeShowIosPwaHelp);\nexposeCoreRuntimeConstant('updateSelectIconBoxes', updateSelectIconBoxes);\nexposeCoreRuntimeConstant('updateGlobalDevicesReference', updateGlobalDevicesReference);\nexposeCoreRuntimeConstant('setLanguage', setLanguage);\nexposeCoreRuntimeConstant('configureIconOnlyButton', configureIconOnlyButton);\nexposeCoreRuntimeConstant('encodeSharedSetup', encodeSharedSetup);\nexposeCoreRuntimeConstant('decodeSharedSetup', decodeSharedSetup);\nexposeCoreRuntimeConstant('iconMarkup', iconMarkup);\nexposeCoreRuntimeConstant('ICON_GLYPHS', ICON_GLYPHS);\nexposeCoreRuntimeConstant('iconGlyph', iconGlyph);\nexposeCoreRuntimeConstant('resolveIconGlyph', resolveIconGlyph);\nexposeCoreRuntimeConstant('applyIconGlyph', applyIconGlyph);\nexposeCoreRuntimeConstant('positionSvgMarkup', positionSvgMarkup);\nexposeCoreRuntimeConstant('formatSvgCoordinate', formatSvgCoordinate);\nconst CORE_RUNTIME_CONSTANTS = {\n  CORE_GLOBAL_SCOPE,\n  CORE_BOOT_QUEUE_KEY,\n  CORE_BOOT_QUEUE,\n  CORE_SHARED,\n  INSTALL_BANNER_DISMISSED_KEY,\n  AUTO_GEAR_ANY_MOTOR_TOKEN,\n  AUTO_GEAR_BACKUP_RETENTION_MIN_VALUE,\n  AUTO_GEAR_BACKUP_RETENTION_MAX,\n  AUTO_GEAR_FLEX_MULTI_SELECT_MIN_ROWS,\n  AUTO_GEAR_MONITOR_DEFAULT_TYPES,\n  GEAR_LIST_CATEGORIES,\n  TEMPERATURE_STORAGE_KEY: CORE_TEMPERATURE_STORAGE_KEY,\n  TEMPERATURE_UNITS: CORE_TEMPERATURE_UNITS,\n  TEMPERATURE_SCENARIOS,\n  FOCUS_SCALE_STORAGE_KEY,\n  FOCUS_SCALE_VALUES: focusScaleValues,\n  FEEDBACK_TEMPERATURE_MIN: globalThis.FEEDBACK_TEMPERATURE_MIN_VALUE,\n  FEEDBACK_TEMPERATURE_MAX: globalThis.FEEDBACK_TEMPERATURE_MAX_VALUE,\n};\n\n// Ensure mount voltage helpers remain reachable from the session layer.\nObject.assign(CORE_RUNTIME_CONSTANTS, MOUNT_VOLTAGE_RUNTIME_EXPORTS);\n\n\n\nexposeCoreRuntimeConstants(CORE_RUNTIME_CONSTANTS);\n\nexposeCoreRuntimeBindings({\n  updatePowerSummary: {\n    get: () => updatePowerSummary,\n  },\n  drawPowerDiagram: {\n    get: () => drawPowerDiagram,\n  },\n  safeGenerateConnectorSummary: {\n    get: () => sessionSafeGenerateConnectorSummary,\n    set: value => {\n      if (typeof value === 'function') {\n        sessionSafeGenerateConnectorSummary = value;\n      }\n    },\n  },\n  baseAutoGearRules: {\n    get: () => baseAutoGearRulesState,\n    set: value => {\n      if (Array.isArray(value)) {\n        baseAutoGearRulesState = value;\n      }\n    },\n  },\n  autoGearAutoPresetId: {\n    get: () => autoGearAutoPresetIdState,\n    set: value => {\n      if (typeof value === 'string') {\n        autoGearAutoPresetIdState = value;\n      } else if (value === null || typeof value === 'undefined') {\n        autoGearAutoPresetIdState = '';\n      }\n    },\n  },\n  autoGearScenarioModeSelect: {\n    get: () => autoGearScenarioModeSelectElement,\n    set: value => {\n      autoGearScenarioModeSelectElement = value || null;\n      setAutoGearScenarioModeSelectElementRef(autoGearScenarioModeSelectElement);\n    },\n  },\n  pinkModeIconRotationTimer: {\n    get: () =>\n      typeof getPinkModeIconRotationTimer === 'function'\n        ? getPinkModeIconRotationTimer()\n        : null,\n    set: value => {\n      if (typeof setPinkModeIconRotationTimer === 'function') {\n        setPinkModeIconRotationTimer(value);\n      }\n    },\n  },\n  pinkModeIconIndex: {\n    get: () =>\n      typeof getPinkModeIconIndex === 'function'\n        ? getPinkModeIconIndex()\n        : 0,\n    set: value => {\n      if (typeof setPinkModeIconIndex === 'function') {\n        setPinkModeIconIndex(value);\n      }\n    },\n  },\n});\nvar scheduleLayoutInitialization = function () {\n  if (typeof initializeLayoutControls === 'function') {\n    if (typeof requestAnimationFrame === 'function') {\n      requestAnimationFrame(initializeLayoutControls);\n    } else {\n      setTimeout(initializeLayoutControls, 0);\n    }\n  }\n}\n\nscheduleLayoutInitialization();\n\nif (typeof globalThis !== 'undefined') {\n  globalThis.encodeSharedSetup = encodeSharedSetup;\n  globalThis.decodeSharedSetup = decodeSharedSetup;\n}\n\nfunction initAppCoreNewDomReferences() {\n  if (initAppCoreNewDomReferences.done) return;\n  initAppCoreNewDomReferences.done = true;\n\n  if (typeof document === 'undefined') return;\n\n  localAutoGearConditionSections = {\n    always: document.getElementById('autoGearCondition-always'),\n    scenarios: document.getElementById('autoGearCondition-scenarios'),\n    shootingDays: document.getElementById('autoGearCondition-shootingDays'),\n    mattebox: document.getElementById('autoGearCondition-mattebox'),\n    cameraHandle: document.getElementById('autoGearCondition-cameraHandle'),\n    viewfinderExtension: document.getElementById('autoGearCondition-viewfinderExtension'),\n    deliveryResolution: document.getElementById('autoGearCondition-deliveryResolution'),\n    videoDistribution: document.getElementById('autoGearCondition-videoDistribution'),\n    camera: document.getElementById('autoGearCondition-camera'),\n    ownGear: document.getElementById('autoGearCondition-ownGear'),\n    cameraWeight: document.getElementById('autoGearCondition-cameraWeight'),\n    monitor: document.getElementById('autoGearCondition-monitor'),\n    tripodHeadBrand: document.getElementById('autoGearCondition-tripodHeadBrand'),\n    tripodBowl: document.getElementById('autoGearCondition-tripodBowl'),\n    tripodTypes: document.getElementById('autoGearCondition-tripodTypes'),\n    tripodSpreader: document.getElementById('autoGearCondition-tripodSpreader'),\n    crewPresent: document.getElementById('autoGearCondition-crewPresent'),\n    crewAbsent: document.getElementById('autoGearCondition-crewAbsent'),\n    wireless: document.getElementById('autoGearCondition-wireless'),\n    motors: document.getElementById('autoGearCondition-motors'),\n    controllers: document.getElementById('autoGearCondition-controllers'),\n    distance: document.getElementById('autoGearCondition-distance'),\n  };\n\n  autoGearHeadingElem = document.getElementById('autoGearHeading');\n  autoGearDescriptionElem = document.getElementById('autoGearDescription');\n  autoGearMonitorDefaultsSection = document.getElementById('autoGearMonitorDefaultsSection');\n  autoGearMonitorDefaultsHeading = document.getElementById('autoGearMonitorDefaultsHeading');\n  autoGearMonitorDefaultsDescription = document.getElementById('autoGearMonitorDefaultsDescription');\n  autoGearDefaultFocusMonitorSelect = document.getElementById('autoGearDefaultFocusMonitor');\n  autoGearDefaultHandheldMonitorSelect = document.getElementById('autoGearDefaultHandheldMonitor');\n  autoGearDefaultComboMonitorSelect = document.getElementById('autoGearDefaultComboMonitor');\n  autoGearDefaultDirectorMonitorSelect = document.getElementById('autoGearDefaultDirectorMonitor');\n  autoGearDefaultFocusMonitorLabel = document.getElementById('autoGearDefaultFocusMonitorLabel');\n  autoGearDefaultHandheldMonitorLabel = document.getElementById('autoGearDefaultHandheldMonitorLabel');\n  autoGearDefaultComboMonitorLabel = document.getElementById('autoGearDefaultComboMonitorLabel');\n  autoGearDefaultDirectorMonitorLabel = document.getElementById('autoGearDefaultDirectorMonitorLabel');\n\n  autoGearSearchInput = document.getElementById('autoGearSearch');\n  autoGearSearchLabel = document.getElementById('autoGearSearchLabel');\n  autoGearFilterScenarioLabel = document.getElementById('autoGearFilterScenarioLabel');\n  autoGearFilterScenarioSelect = document.getElementById('autoGearFilterScenario');\n  autoGearFilterClearButton = document.getElementById('autoGearFilterClear');\n  autoGearSummarySection = document.getElementById('autoGearSummary');\n  autoGearSummaryHeadingElem = document.getElementById('autoGearSummaryHeading');\n  autoGearSummaryDescriptionElem = document.getElementById('autoGearSummaryDescription');\n  autoGearSummaryCards = document.getElementById('autoGearSummaryCards');\n  autoGearSummaryDetails = document.getElementById('autoGearSummaryDetails');\n  autoGearRulesList = document.getElementById('autoGearRulesList');\n  autoGearPresetDescription = document.getElementById('autoGearPresetDescription');\n  autoGearPresetLabel = document.getElementById('autoGearPresetLabel');\n  autoGearPresetSelect = document.getElementById('autoGearPresetSelect');\n  autoGearSavePresetButton = document.getElementById('autoGearSavePreset');\n  autoGearDeletePresetButton = document.getElementById('autoGearDeletePreset');\n  autoGearAddRuleBtn = document.getElementById('autoGearAddRule');\n  autoGearResetFactoryButton = document.getElementById('autoGearResetFactory');\n  autoGearEditor = document.getElementById('autoGearEditor');\n  autoGearConditionControls = document.getElementById('autoGearConditionControls');\n  autoGearConditionSelectLabel = document.getElementById('autoGearConditionSelectLabel');\n  autoGearConditionSelect = document.getElementById('autoGearConditionSelect');\n  autoGearConditionAddButton = document.getElementById('autoGearConditionAdd');\n  autoGearConditionList = document.getElementById('autoGearConditionList');\n  autoGearAlwaysLabel = document.getElementById('autoGearAlwaysLabel');\n  autoGearAlwaysHelp = document.getElementById('autoGearAlwaysHelp');\n  autoGearCameraWeightSection = document.getElementById('autoGearCondition-cameraWeight');\n\n  autoGearMonitorDefaultControls = [\n    {\n      key: 'focus',\n      select: autoGearDefaultFocusMonitorSelect, // These will be null initially\n      label: autoGearDefaultFocusMonitorLabel,   // These will be null initially\n    },\n    {\n      key: 'handheld7',\n      select: autoGearDefaultHandheldMonitorSelect,\n      label: autoGearDefaultHandheldMonitorLabel,\n    },\n    {\n      key: 'combo15',\n      select: autoGearDefaultComboMonitorSelect,\n      label: autoGearDefaultComboMonitorLabel,\n    },\n    {\n      key: 'director15',\n      select: autoGearDefaultDirectorMonitorSelect,\n      label: autoGearDefaultDirectorMonitorLabel,\n    },\n  ];\n\n  autoGearMonitorDefaultControls.forEach(control => {\n    if (!control || !control.select) return;\n    control.select.addEventListener('change', event => {\n      setAutoGearMonitorDefault(control.key, event.target.value);\n    });\n  });\n\n  autoGearConditionAddShortcuts = {\n    always: localAutoGearConditionSections.always?.querySelector('.auto-gear-condition-add') || null,\n    scenarios: localAutoGearConditionSections.scenarios?.querySelector('.auto-gear-condition-add') || null,\n    shootingDays: localAutoGearConditionSections.shootingDays?.querySelector('.auto-gear-condition-add') || null,\n    mattebox: localAutoGearConditionSections.mattebox?.querySelector('.auto-gear-condition-add') || null,\n    cameraHandle: localAutoGearConditionSections.cameraHandle?.querySelector('.auto-gear-condition-add') || null,\n    viewfinderExtension: localAutoGearConditionSections.viewfinderExtension?.querySelector('.auto-gear-condition-add') || null,\n    deliveryResolution: localAutoGearConditionSections.deliveryResolution?.querySelector('.auto-gear-condition-add') || null,\n    videoDistribution: localAutoGearConditionSections.videoDistribution?.querySelector('.auto-gear-condition-add') || null,\n    camera: localAutoGearConditionSections.camera?.querySelector('.auto-gear-condition-add') || null,\n    ownGear: localAutoGearConditionSections.ownGear?.querySelector('.auto-gear-condition-add') || null,\n    cameraWeight: localAutoGearConditionSections.cameraWeight?.querySelector('.auto-gear-condition-add') || null,\n    monitor: localAutoGearConditionSections.monitor?.querySelector('.auto-gear-condition-add') || null,\n    tripodHeadBrand: localAutoGearConditionSections.tripodHeadBrand?.querySelector('.auto-gear-condition-add') || null,\n    tripodBowl: localAutoGearConditionSections.tripodBowl?.querySelector('.auto-gear-condition-add') || null,\n    tripodTypes: localAutoGearConditionSections.tripodTypes?.querySelector('.auto-gear-condition-add') || null,\n    tripodSpreader: localAutoGearConditionSections.tripodSpreader?.querySelector('.auto-gear-condition-add') || null,\n    crewPresent: localAutoGearConditionSections.crewPresent?.querySelector('.auto-gear-condition-add') || null,\n    crewAbsent: localAutoGearConditionSections.crewAbsent?.querySelector('.auto-gear-condition-add') || null,\n    wireless: localAutoGearConditionSections.wireless?.querySelector('.auto-gear-condition-add') || null,\n    motors: localAutoGearConditionSections.motors?.querySelector('.auto-gear-condition-add') || null,\n    controllers: localAutoGearConditionSections.controllers?.querySelector('.auto-gear-condition-add') || null,\n    distance: localAutoGearConditionSections.distance?.querySelector('.auto-gear-condition-add') || null,\n  };\n\n  autoGearConditionRemoveButtons = {\n    always: localAutoGearConditionSections.always?.querySelector('.auto-gear-condition-remove') || null,\n    scenarios: localAutoGearConditionSections.scenarios?.querySelector('.auto-gear-condition-remove') || null,\n    shootingDays: localAutoGearConditionSections.shootingDays?.querySelector('.auto-gear-condition-remove') || null,\n    mattebox: localAutoGearConditionSections.mattebox?.querySelector('.auto-gear-condition-remove') || null,\n    cameraHandle: localAutoGearConditionSections.cameraHandle?.querySelector('.auto-gear-condition-remove') || null,\n    viewfinderExtension: localAutoGearConditionSections.viewfinderExtension?.querySelector('.auto-gear-condition-remove') || null,\n    deliveryResolution: localAutoGearConditionSections.deliveryResolution?.querySelector('.auto-gear-condition-remove') || null,\n    videoDistribution: localAutoGearConditionSections.videoDistribution?.querySelector('.auto-gear-condition-remove') || null,\n    camera: localAutoGearConditionSections.camera?.querySelector('.auto-gear-condition-remove') || null,\n    ownGear: localAutoGearConditionSections.ownGear?.querySelector('.auto-gear-condition-remove') || null,\n    cameraWeight: localAutoGearConditionSections.cameraWeight?.querySelector('.auto-gear-condition-remove') || null,\n    monitor: localAutoGearConditionSections.monitor?.querySelector('.auto-gear-condition-remove') || null,\n    tripodHeadBrand: localAutoGearConditionSections.tripodHeadBrand?.querySelector('.auto-gear-condition-remove') || null,\n    tripodBowl: localAutoGearConditionSections.tripodBowl?.querySelector('.auto-gear-condition-remove') || null,\n    tripodTypes: localAutoGearConditionSections.tripodTypes?.querySelector('.auto-gear-condition-remove') || null,\n    tripodSpreader: localAutoGearConditionSections.tripodSpreader?.querySelector('.auto-gear-condition-remove') || null,\n    crewPresent: localAutoGearConditionSections.crewPresent?.querySelector('.auto-gear-condition-remove') || null,\n    crewAbsent: localAutoGearConditionSections.crewAbsent?.querySelector('.auto-gear-condition-remove') || null,\n    wireless: localAutoGearConditionSections.wireless?.querySelector('.auto-gear-condition-remove') || null,\n    motors: localAutoGearConditionSections.motors?.querySelector('.auto-gear-condition-remove') || null,\n    controllers: localAutoGearConditionSections.controllers?.querySelector('.auto-gear-condition-remove') || null,\n    distance: localAutoGearConditionSections.distance?.querySelector('.auto-gear-condition-remove') || null,\n  };\n\n  if (autoGearAddRuleBtn) {\n    autoGearAddRuleBtn.setAttribute('aria-controls', 'autoGearEditor');\n    autoGearAddRuleBtn.setAttribute(\n      'aria-expanded',\n      autoGearEditor && !autoGearEditor.hidden ? 'true' : 'false'\n    );\n  }\n  if (autoGearEditor) {\n    autoGearEditor.setAttribute('aria-hidden', autoGearEditor.hidden ? 'true' : 'false');\n  }\n}\n\nif (typeof document !== 'undefined') {\n  if (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', initAppCoreNewDomReferences);\n  } else {\n    initAppCoreNewDomReferences();\n  }\n}\n\n\n\nif (typeof window !== 'undefined') window.AppCore = AppCore;\n\nif (typeof window !== 'undefined') {\n  window.syncAutoGearRulesFromStorage = syncAutoGearRulesFromStorage;\n  window.clearProjectAutoGearRules = clearProjectAutoGearRules;\n  window.resetSharedImportStateForFactoryReset = resetSharedImportStateForFactoryReset;\n  window.getCssVariableValue = getCssVariableValue;\n  window.autoGearRuleMatchesScenario = autoGearRuleMatchesScenario;\n  window.autoGearRuleMatchesSearch = autoGearRuleMatchesSearch;\n  window.getAutoGearRules = getAutoGearRules;\n  window.refreshAutoGearScenarioFilterOptions = refreshAutoGearScenarioFilterOptions;\n  window.normalizeAutoGearCameraWeightCondition = normalizeAutoGearCameraWeightCondition;\n  window.formatAutoGearCameraWeight = formatAutoGearCameraWeight;\n  window.findAutoGearOwnGearById = findAutoGearOwnGearById;\n}\n\nconsole.log('DEBUG: app-core-new-1.js FINISHED');\n\nexport {\n  encodeSharedSetup,\n  decodeSharedSetup,\n  closeSideMenu,\n  openSideMenu,\n  setupSideMenu,\n  setupResponsiveControls,\n  updateTripodOptions,\n  detectBrand,\n  connectionLabel\n};\n","console.log('DEBUG: main.js parsing started');\nimport './scripts/shims/vite-global-patches.js';\nimport './scripts/force-populate.js';\n\n// Phase 2: Import shim modules\nconsole.log('DEBUG: main.js imports START');\n\n// Data Imports (Must load before App Core)\nimport rentalHouses from './data/rental-houses.js';\nimport devices, { cineDevices } from './data/devices/index.js';\n\n// Legacy Global Exposure\nif (typeof window !== 'undefined') {\n    window.rentalHouses = rentalHouses;\n    window.devices = devices;\n    window.cineDevices = cineDevices;\n}\n\nimport './scripts/translations.js';\nimport './scripts/core/app-core-pink-mode.js';\nimport './scripts/auto-gear/ui.js';\n\nimport storage from './modules/storage-shim.js';\nimport * as translations from './modules/translations-shim.js';\nimport './scripts/shims/legacy-globals-shim.js';\n// Phase 3a: Auto Gear Storage (Must load before app-core-new-1.js)\nimport * as autoGearNormalizers from './scripts/auto-gear/normalizers.js';\nimport * as autoGearStorage from './scripts/auto-gear/storage.js';\n\n// Expose Auto Gear Storage helpers to global scope for legacy code\nif (typeof window !== 'undefined') {\n    Object.assign(window, autoGearStorage);\n    Object.assign(window, autoGearNormalizers);\n}\n\n// Phase 10: App Core Bootstrap\nimport './scripts/core/app-core-runtime-support.js';\nimport './scripts/core/app-core-bootstrap.js';\n\n// Phase 4: Converted Core Modules (ESM)\nimport './scripts/modules/base.js';\nimport './scripts/modules/registry.js';\nimport './scripts/modules/localization.js';\nimport './scripts/modules/icons.js';\nimport './scripts/modules/device-normalization.js';\nimport './scripts/modules/logging.js';\nimport './scripts/modules/persistence.js';\nimport './scripts/modules/environment.js';\nimport './scripts/modules/environment-bridge.js';\nimport './scripts/modules/offline.js';\nimport './scripts/modules/globals.js';\nimport './scripts/modules/system.js';\nimport './scripts/modules/context.js';\nimport './scripts/modules/architecture-helpers.js';\nimport './scripts/modules/architecture.js';\nimport './scripts/modules/runtime.js';\nimport './scripts/modules/settings-and-appearance.js';\n\nconsole.log(' Vite entry point (main.js) loaded');\nwindow.__viteMainLoaded = true;\n\n// Log that Vite and shims are working\nconsole.log('[Vite] Entry point loaded successfully');\n\n// Phase 3: Initialize V2 UI (Hybrid Mode)\n// Core Modules\nimport './scripts/globals-bootstrap.js';\nimport './scripts/core/modules/app-core/localization-fixed.js'; // MUST load before runtime-shared\nimport { processCoreBootQueue } from './scripts/runtime/bootstrap.js';\nimport './scripts/core/app-core-runtime-global-tools.js';\nimport './scripts/core/app-core-runtime-candidate-scopes.js';\nimport './scripts/core/app-core-runtime-helpers.js';\nimport './scripts/core/app-core-runtime-shared.js';\nimport './scripts/core/app-core-environment.js';\nimport './scripts/core/modules/ui-cache.js';\nimport './scripts/core/app-core-ui-helpers.js';\nimport './scripts/core/app-core-text.js';\n\nimport './scripts/core/app-core-new-1.js';\n/*\nimport './scripts/core/app-core-new-2.js';\n...\n*/\n"],"file":"main-P40cA4Iv.js"}