# Tasks

- [x] Fix `downloadSharedProject` ReferenceError in `app-session.js` <!-- id: 0 -->
- [x] Investigate and fix infinite recursion in `updateCalculations` <!-- id: 1 -->
    - [x] Check definition of `updateCalculations` in `app-core-new-2.js` <!-- id: 2 -->
    - [x] Ensure `app-session.js` wrapper doesn't call itself <!-- id: 3 -->
- [x] Migrate `app-session.js` specific logic to ESM modules <!-- id: 4 -->
    - [x] Extract `notifications.js` and add unit tests <!-- id: 5 -->
    - [x] Extract `session-runtime.js` and add unit tests <!-- id: 6 -->
    - [x] Migrate `web-lock-manager` to `ProjectLockService` with legacy adapter <!-- id: 7 -->
- [x] Migrate Settings & Appearance Logic <!-- id: 8 -->
    - [x] Refactor `settings-and-appearance.js` to ESM <!-- id: 9 -->
    - [x] Update `app-session.js` to import settings module directly <!-- id: 10 -->
    - [x] Remove dynamic appearance binding from `app-session.js` <!-- id: 11 -->
- [x] Session Migration - Phase 3 (URL Handling) <!-- id: 12 -->
    - [x] Create `src/scripts/modules/core/url-handler.js` <!-- id: 13 -->
    - [x] Extract `applySharedSetupFromUrl` and URL cleanup logic <!-- id: 14 -->
    - [x] Refactor `app-session.js` to use `UrlHandler` <!-- id: 15 -->
    - [x] Verify Shared Setup URL loading <!-- id: 16 -->
- [x] Session Migration - Phase 4 (Event Binding) <!-- id: 17 -->
    - [x] Analyze event listener dependencies <!-- id: 18 -->
    - [x] Create `src/scripts/modules/core/event-binder.js` <!-- id: 19 -->
    - [x] Extract event setup logic <!-- id: 20 -->
    - [x] Refactor `app-session.js` to use `EventBinder` <!-- id: 21 -->
- [x] Session Migration - Phase 5 (Project Storage) <!-- id: 22 -->
    - [x] Create `src/scripts/modules/core/project-storage-manager.js` <!-- id: 23 -->
    - [x] Extract `resolveActiveProjectStorageKey` and revision logic <!-- id: 24 -->
    - [x] Extract `scheduleProjectStorageSync` <!-- id: 25 -->
    - [x] Refactor `app-session.js` to use `ProjectStorageManager` <!-- id: 26 -->
- [x] Session Migration - Phase 6 (Backup & Export) <!-- id: 27 -->
    - [x] Create `start_server` workflow <!-- id: 28 -->
    - [x] Create `src/scripts/modules/core/project-transfer-manager.js` <!-- id: 29 -->
    - [x] Extract `downloadSharedProject` logic (New module created, app-session refactored) <!-- id: 30 -->
    - [x] Refactor `app-session.js` to use `ProjectTransferManager` <!-- id: 31 -->
    - [x] Verify Backup & Export functionality (Code reviewed and linted) <!-- id: 32 -->
- [x] Session Migration - Phase 7 (Logging Module) <!-- id: 33 -->
    - [x] Create `src/scripts/modules/core/logging-manager.js` <!-- id: 34 -->
    - [x] Extract logging logic from `app-session.js` <!-- id: 35 -->
    - [x] Refactor `app-session.js` to use `LoggingManager` <!-- id: 36 -->
- [x] Session Migration - Phase 8 (Restore Compatibility) <!-- id: 38 -->
    - [x] Create `src/scripts/modules/core/restore-compatibility-manager.js` <!-- id: 39 -->
    - [x] Extract `verifyRestoredBackupIntegrity` and helper logic <!-- id: 40 -->
    - [x] Refactor `app-session.js` to use `RestoreCompatibilityManager` <!-- id: 41 -->
    - [x] Verify functionality <!-- id: 42 -->
