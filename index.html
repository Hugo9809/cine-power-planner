<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Camera Power Planner</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&display=swap" rel="stylesheet">
</head>
<body>
  <div id="langSelector">
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="de">Deutsch</option>
    </select>
    <button id="darkModeToggle" title="Toggle dark mode">☾</button>
  </div>

  <h1 id="mainTitle">Camera Power Consumption App</h1>
  <p id="tagline">Plan your camera setup and calculate power consumption &amp; battery life.</p>

  <section id="setup-manager">
    <h2 id="setupManageHeading">Manage Setup</h2>
    <label for="setupSelect" id="savedSetupsLabel">Saved Setups:</label>
    <select id="setupSelect">
      <option value="">-- New Setup --</option>
      </select>
    <button id="deleteSetupBtn" title="Delete selected setup">Delete</button>
    <br/>
    <label for="setupName" id="setupNameLabel">Setup Name:</label>
    <input type="text" id="setupName" placeholder="Setup name" />
    <button id="saveSetupBtn">Save</button>

    <!-- Moved Setup Actions here -->
    <h3 id="setupActionsHeading" style="margin-top: 1em;">Setup Actions</h3>
    <button id="exportSetupsBtn">Export All Setups</button>
    <button id="importSetupsBtn">Import Setups</button>
    <input type="file" id="importSetupsInput" accept=".json" style="display: none;" />
    <button id="generateOverviewBtn">Generate Overview</button>
  </section>

  <section id="setup-config">
    <h2 id="deviceSelectionHeading">Device Selection</h2>
      <div class="form-row">
        <label for="cameraSelect" id="cameraLabel">Camera:</label>
        <select id="cameraSelect"></select>
      </div>
      <div class="form-row">
        <label for="monitorSelect" id="monitorLabel">Monitor:</label>
        <select id="monitorSelect"></select>
      </div>
      <div class="form-row">
        <label for="videoSelect" id="videoLabel">Wireless Video:</label>
        <select id="videoSelect"></select>
      </div>

    <fieldset>
      <legend id="fizLegend">FIZ (Follow Focus) Systems</legend>
      <div class="form-row">
        <label for="motor1Select" id="fizMotorsLabel">FIZ Motors:</label>
        <select id="motor1Select"></select>
      </div>
      <div class="form-row">
        <label for="motor2Select"></label>
        <select id="motor2Select"></select>
      </div>
      <div class="form-row">
        <label for="motor3Select"></label>
        <select id="motor3Select"></select>
      </div>
      <div class="form-row">
        <label for="motor4Select"></label>
        <select id="motor4Select"></select>
      </div>
      <div class="form-row">
        <label for="controller1Select" id="fizControllersLabel">FIZ Controllers:</label>
        <select id="controller1Select"></select>
      </div>
      <div class="form-row">
        <label for="controller2Select"></label>
        <select id="controller2Select"></select>
      </div>
      <div class="form-row">
        <label for="controller3Select"></label>
        <select id="controller3Select"></select>
      </div>
      <div class="form-row">
        <label for="controller4Select"></label>
        <select id="controller4Select"></select>
      </div>
      <div class="form-row">
        <label for="distanceSelect" id="distanceLabel">Distance Sensor:</label>
        <select id="distanceSelect"></select>
      </div>
    </fieldset>

    <div class="form-row">
      <label for="batterySelect" id="batteryLabel">V-Mount Battery:</label>
      <select id="batterySelect"></select>
    </div>
  </section>

  <section id="results">
    <h2 id="resultsHeading">Results</h2>
    <ul id="breakdownList">
      <!-- Device breakdown will be inserted here by script.js -->
    </ul>
    <p><strong><span id="totalPowerLabel">Total Consumption:</span></strong> <span id="totalPower">0.0</span> W</p>
    <p><strong><span id="totalCurrent144Label">Total Current (at 14.4V):</span></strong> <span id="totalCurrent144">0.00</span> A</p>
    <p><strong><span id="totalCurrent12Label">Total Current (at 12V):</span></strong> <span id="totalCurrent12">0.00</span> A</p>
    <p><strong><span id="batteryLifeLabel">Runtime (estimated):</span></strong> <span id="batteryLife">0.00</span> <span id="batteryLifeUnit">hrs</span></p>
    <p id="pinWarning" style="color: red; font-weight: bold;"></p>
    <p id="dtapWarning" style="color: red; font-weight: bold;"></p>
  </section>

  <section id="batteryComparison" style="display:none;">
    <h2 id="batteryComparisonHeading">Battery Comparison</h2>
    <div id="batteryTableContainer">
      <table id="batteryTable"></table>
    </div>
  </section>

  <button id="toggleDeviceManager">Edit Device Data…</button>

  <section id="device-manager" style="display:none;">
    <h2 id="deviceManagerHeading">Manage Device Database</h2>
    <div style="margin-bottom: 10px;"> <!-- Changed from form-row to a generic div for button grouping -->
<h3 id="addDeviceHeading" style="margin-top: 1em;">Add New Device</h3>
    <div class="form-row">
      <label for="newCategory" id="categoryLabel">Category:</label>
      <select id="newCategory">
        <option value="cameras">Camera</option>
        <option value="monitors">Monitor</option>
        <option value="video">Wireless Video</option>
        <option value="fiz.motors">FIZ Motor</option>
        <option value="fiz.controllers">FIZ Controller</option>
        <option value="fiz.distance">FIZ Distance</option>
        <option value="batteries">V-Mount Battery</option>
      </select>
    </div>
    <div class="form-row">
      <label for="newName" id="deviceNameLabel">Name:</label>
      <input type="text" id="newName" placeholder="Device name" />
    </div>
    <div class="form-row" id="wattField">
      <label for="newWatt" id="consumptionLabel">Consumption (W):</label>
      <input type="number" id="newWatt" step="0.1" placeholder="e.g. 12.5" />
    </div>
    <div id="batteryFields" style="display:none;">
      <div class="form-row">
        <label for="newCapacity" id="capacityLabel">Capacity (Wh):</label>
        <input type="number" id="newCapacity" step="0.1" placeholder="e.g. 98" />
      </div>
      <div class="form-row">
        <label for="newPinA" id="pinLabel">Max Pin A:</label>
        <input type="number" id="newPinA" step="0.1" placeholder="e.g. 10" />
      </div>
      <div class="form-row">
        <label for="newDtapA" id="dtapLabel">Max D-Tap A:</label>
        <input type="number" id="newDtapA" step="0.1" placeholder="e.g. 5" />
      </div>
    </div>
    <button id="addDeviceBtn">Add</button>
      <button id="exportDataBtn">Export Database</button>
      <button id="importDataBtn">Import Database</button>
      <input type="file" id="importFileInput" accept=".json" style="display: none;" />
      <button id="exportAndRevertBtn">Export and Revert to default Database</button>
    </div>
    <textarea id="exportOutput" readonly style="display:none; width:100%; height:100px; margin-top: 10px;"></textarea>

    <h3 style="margin-top: 1em;">Existing Devices</h3>
    <div class="device-list-container">
      <div class="device-category">
        <h4 id="category_cameras">Cameras</h4>
        <input type="text" class="list-search" data-target="cameraList" placeholder="Search..." />
        <ul id="cameraList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_monitors">Monitors</h4>
        <input type="text" class="list-search" data-target="monitorList" placeholder="Search..." />
        <ul id="monitorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_video">Wireless Video</h4>
        <input type="text" class="list-search" data-target="videoList" placeholder="Search..." />
        <ul id="videoList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_motors">FIZ Motors</h4>
        <input type="text" class="list-search" data-target="motorList" placeholder="Search..." />
        <ul id="motorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_controllers">FIZ Controllers</h4>
        <input type="text" class="list-search" data-target="controllerList" placeholder="Search..." />
        <ul id="controllerList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_distance">FIZ Distance</h4>
        <input type="text" class="list-search" data-target="distanceList" placeholder="Search..." />
        <ul id="distanceList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_batteries">V-Mount Batteries</h4>
        <input type="text" class="list-search" data-target="batteryList" placeholder="Search..." />
        <ul id="batteryList" class="device-ul"></ul>
      </div>
    </div>
  </section>

  <script src="data.js"></script>
  <script src="storage.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
