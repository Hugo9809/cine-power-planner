<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Plan your camera setup and calculate power consumption &amp; battery life." />
  <meta property="og:title" content="Camera Power Planner" />
  <meta property="og:description" content="Plan your camera setup and calculate power consumption &amp; battery life." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="favicon.ico" />
  <meta name="theme-color" content="#ffffff" />
  <title>Camera Power Planner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
  <link rel="manifest" href="manifest.webmanifest">
</head>
<body>
  <a href="#mainContent" class="skip-link" id="skipLink">Skip to content</a>
  <div id="langSelector">
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="de">Deutsch</option>
      <option value="es">Espa√±ol</option>
      <option value="fr">Fran√ßais</option>
      <option value="it">Italiano</option>
    </select>
    <button id="darkModeToggle" title="Toggle dark mode" aria-label="Toggle dark mode">üåô</button>
    <button id="pinkModeToggle" title="Toggle pink mode" aria-label="Toggle pink mode">üê¥</button>
    <button id="helpButton" aria-haspopup="dialog" aria-controls="helpDialog" title="Help">?</button>
  </div>

  <main id="mainContent">

  <h1 id="mainTitle">Camera Power Consumption App</h1>
  <p id="tagline">Plan your camera setup and calculate power consumption &amp; battery life.</p>

  <section id="setup-manager">
    <h2 id="setupManageHeading">Manage Setup</h2>
    <div class="form-row">
      <label for="setupSelect" id="savedSetupsLabel">Saved Setups:</label>
      <select id="setupSelect">
        <option value="">-- New Setup --</option>
      </select>
      <button id="deleteSetupBtn" title="Delete selected setup">Delete</button>
    </div>
    <div class="form-row">
      <label for="setupName" id="setupNameLabel">Setup Name:</label>
      <input type="text" id="setupName" placeholder="Setup name" />
      <button id="saveSetupBtn">Save</button>
    </div>
    <!-- Moved Setup Actions here -->
    <h3 id="setupActionsHeading">Setup Actions</h3>
    <button id="exportSetupsBtn">Export All Setups</button>
    <button id="importSetupsBtn">Import Setups</button>
    <input type="file" id="importSetupsInput" accept=".json" class="hidden" />
    <button id="generateOverviewBtn">Generate Overview</button>
    <button id="shareSetupBtn">Share Setup Link</button>
    <button id="clearSetupBtn">Clear Current Setup</button>
  </section>

  <section id="setup-config">
    <h2 id="deviceSelectionHeading">Device Selection</h2>
      <div class="form-row">
        <label for="cameraSelect" id="cameraLabel">Camera:</label>
        <div class="select-wrapper">
          <input type="text" id="cameraFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="cameraSelect"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="monitorSelect" id="monitorLabel">Monitor:</label>
        <div class="select-wrapper">
          <input type="text" id="monitorFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="monitorSelect"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="videoSelect" id="videoLabel">Wireless Video:</label>
        <div class="select-wrapper">
          <input type="text" id="videoFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="videoSelect"></select>
        </div>
      </div>

    <fieldset>
      <legend id="fizLegend">FIZ (Follow Focus) Systems</legend>
      <div class="form-row">
        <label for="motor1Select" id="fizMotorsLabel">FIZ Motors:</label>
        <div class="select-wrapper">
          <input type="text" id="motorFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="motor1Select"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="motor2Select"></label>
        <select id="motor2Select"></select>
      </div>
      <div class="form-row">
        <label for="motor3Select"></label>
        <select id="motor3Select"></select>
      </div>
      <div class="form-row">
        <label for="motor4Select"></label>
        <select id="motor4Select"></select>
      </div>
      <div class="form-row">
        <label for="controller1Select" id="fizControllersLabel">FIZ Controllers:</label>
        <div class="select-wrapper">
          <input type="text" id="controllerFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="controller1Select"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="controller2Select"></label>
        <select id="controller2Select"></select>
      </div>
      <div class="form-row">
        <label for="controller3Select"></label>
        <select id="controller3Select"></select>
      </div>
      <div class="form-row">
        <label for="controller4Select"></label>
        <select id="controller4Select"></select>
      </div>
    <div class="form-row">
      <label for="distanceSelect" id="distanceLabel">Distance Sensor:</label>
      <div class="select-wrapper">
        <input type="text" id="distanceFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
        <select id="distanceSelect"></select>
      </div>
    </div>
    <div class="form-row hidden" id="batteryPlateRow">
      <label for="batteryPlateSelect" id="batteryPlateLabel">Battery Plate:</label>
      <select id="batteryPlateSelect"></select>
    </div>
  </fieldset>

    <div class="form-row">
      <label for="batterySelect" id="batteryLabel">V-Mount Battery:</label>
      <div class="select-wrapper">
        <input type="text" id="batteryFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
        <select id="batterySelect"></select>
      </div>
    </div>
  </section>

  <section id="results">
    <h2 id="resultsHeading">Results</h2>
    <ul id="breakdownList">
      <!-- Device breakdown will be inserted here by script.js -->
    </ul>
    <p><strong><span id="totalPowerLabel">Total Consumption:</span></strong> <span id="totalPower">0.0</span> W</p>
    <p><strong><span id="totalCurrent144Label">Total Current (at 14.4V):</span></strong> <span id="totalCurrent144">0.00</span> A</p>
    <p><strong><span id="totalCurrent12Label">Total Current (at 12V):</span></strong> <span id="totalCurrent12">0.00</span> A</p>
    <p><strong><span id="batteryLifeLabel">Runtime (estimated):</span></strong> <span id="batteryLife">0.00</span> <span id="batteryLifeUnit">hrs</span> <span id="runtimeAverageNote"></span></p>
    <p><strong><span id="batteryCountLabel">Batteries for 10h shoot (incl. spare):</span></strong> <span id="batteryCount">‚Äì</span></p>
    <p id="pinWarning" role="status" aria-live="polite" aria-describedby="batteryLabel"></p>
    <p id="dtapWarning" role="status" aria-live="polite" aria-describedby="batteryLabel"></p>
    <div id="temperatureNote"></div>
    <button id="runtimeFeedbackBtn" type="button">Submit User Runtime Feedback</button>
    <div id="feedbackTableContainer" class="hidden">
      <table id="userFeedbackTable" class="hidden"></table>
    </div>
  </section>

  <section id="setupDiagram">
    <h2 id="setupDiagramHeading">Setup Diagram</h2>
    <p id="compatWarning" role="status" aria-live="polite"></p>
    <p id="diagramDesc" class="visually-hidden">Visual representation of connected devices.</p>
    <div id="diagramArea" role="img" aria-label="Setup diagram" aria-describedby="diagramDesc">
      <div id="diagramPopup" class="diagram-popup"></div>
    </div>
    <div id="diagramLegend" class="diagram-legend"></div>
    <div class="diagram-controls">
      <button id="zoomOut" type="button" title="Zoom out" aria-label="Zoom out">-</button>
      <button id="zoomIn" type="button" title="Zoom in" aria-label="Zoom in">+</button>
      <button id="downloadDiagram" type="button">Download Diagram</button>
      <button id="gridSnapToggle" type="button">Snap to Grid</button>
    </div>
    <p id="diagramHint" class="diagram-hint"></p>
  </section>

  <section id="batteryComparison" class="hidden">
    <h2 id="batteryComparisonHeading">Battery Comparison</h2>
    <div id="batteryTableContainer">
      <table id="batteryTable"></table>
    </div>
  </section>

  <button id="toggleDeviceManager">Edit Device Data‚Ä¶</button>

  <section id="device-manager" class="hidden">
    <h2 id="deviceManagerHeading">Manage Device Database</h2>
    <div class="button-group"> <!-- Changed from form-row to a generic div for button grouping -->
<h3 id="addDeviceHeading">Add New Device</h3>
    <div class="form-row">
      <label for="newCategory" id="categoryLabel">Category:</label>
      <select id="newCategory">
        <option value="cameras">Camera</option>
        <option value="monitors">Monitor</option>
        <option value="video">Wireless Video</option>
        <option value="fiz.motors">FIZ Motor</option>
        <option value="fiz.controllers">FIZ Controller</option>
        <option value="fiz.distance">FIZ Distance</option>
        <option value="batteries">V-Mount Battery</option>
      </select>
    </div>
    <div class="form-row">
      <label for="newName" id="deviceNameLabel">Name:</label>
      <input type="text" id="newName" placeholder="Device name" />
    </div>
    <div class="form-row" id="wattField">
      <label for="newWatt" id="consumptionLabel">Consumption (W):</label>
      <input type="number" id="newWatt" step="0.1" placeholder="e.g. 12.5" />
    </div>
    <div id="cameraFields" class="hidden">
      <div class="camera-subsection">
        <h4 id="powerInputsHeading">Power Inputs</h4>
        <div class="form-row">
          <label for="cameraWatt" id="cameraWattLabel">Power Draw (W):</label>
          <input type="number" id="cameraWatt" step="0.1" />
        </div>
        <div class="form-row">
          <label for="cameraVoltage" id="cameraVoltageLabel">Voltage Range:</label>
          <input type="text" id="cameraVoltage" />
        </div>
        <div class="form-row">
          <label for="cameraPortType" id="cameraPortTypeLabel">Port Type:</label>
          <select id="cameraPortType"></select>
        </div>
        <div class="form-row">
          <label id="cameraPlatesLabel">Battery Plates:</label>
          <div id="batteryPlatesContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="powerDistributionHeading">Power Distribution</h4>
        <div class="form-row">
          <label id="cameraPowerDistLabel">Outputs:</label>
          <div id="powerDistContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="videoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="cameraVideoOutputsLabel">Outputs:</label>
          <div id="videoOutputsContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="fizConnectorHeading">FIZ Connector</h4>
        <div class="form-row">
          <label id="cameraFIZConnectorLabel">Connectors:</label>
          <div id="fizConnectorContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="mediaHeading">Media</h4>
        <div class="form-row">
          <label id="cameraMediaLabel">Recording Media:</label>
          <div id="cameraMediaContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="viewfinderHeading">Viewfinder</h4>
        <div class="form-row">
          <label id="cameraViewfinderLabel">Viewfinders:</label>
          <div id="viewfinderContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="lensMountHeading">Lens Mount</h4>
        <div class="form-row">
          <label id="cameraLensMountLabel">Lens Mount:</label>
          <div id="lensMountContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="timecodeHeading">Timecode</h4>
        <div class="form-row">
          <label id="cameraTimecodeLabel">Timecode:</label>
          <div id="timecodeContainer" class="flex-1"></div>
        </div>
      </div>
    </div>
    <div id="monitorFields" class="hidden">
      <div class="monitor-subsection">
        <h4 id="monitorDetailsHeading">Monitor Details</h4>
        <div class="form-row">
          <label for="monitorScreenSize" id="monitorScreenSizeLabel">Screen Size (in):</label>
          <input type="number" id="monitorScreenSize" step="0.1" />
        </div>
        <div class="form-row">
          <label for="monitorBrightness" id="monitorBrightnessLabel">Brightness (nits):</label>
          <input type="number" id="monitorBrightness" step="1" />
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorPowerHeading">Power Input</h4>
        <div class="form-row">
          <label for="monitorWatt" id="monitorWattLabel">Power Draw (W):</label>
          <input type="number" id="monitorWatt" step="0.1" />
        </div>
        <div class="form-row">
          <label for="monitorVoltage" id="monitorVoltageLabel">Voltage Range:</label>
          <input type="text" id="monitorVoltage" />
        </div>
        <div class="form-row">
          <label for="monitorPortType" id="monitorPortTypeLabel">Port Type:</label>
          <select id="monitorPortType"></select>
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorVideoInputsHeading">Video Inputs</h4>
        <div class="form-row">
          <label id="monitorVideoInputsLabel">Inputs:</label>
          <div id="monitorVideoInputsContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorVideoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="monitorVideoOutputsLabel">Outputs:</label>
          <div id="monitorVideoOutputsContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="form-row">
        <label for="monitorWirelessTx" id="monitorWirelessTxLabel">Wireless TX:</label>
        <input type="checkbox" id="monitorWirelessTx" />
      </div>
      <div class="form-row">
        <label for="monitorLatency" id="monitorLatencyLabel">Latency:</label>
        <input type="text" id="monitorLatency" />
      </div>
      <div class="form-row">
        <label for="monitorAudioOutput" id="monitorAudioOutputLabel">Audio Output:</label>
        <input type="text" id="monitorAudioOutput" />
      </div>
    </div>
    <div id="videoFields" class="hidden">
      <div class="form-row">
        <label for="videoPower" id="videoPowerInputLabel">Power Input:</label>
        <input type="text" id="videoPower" />
      </div>
      <div class="video-subsection">
        <h4 id="videoVideoInputsHeading">Video Inputs</h4>
        <div class="form-row">
          <label id="videoVideoInputsLabel">Inputs:</label>
          <div id="videoVideoInputsContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="video-subsection">
        <h4 id="videoVideoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="videoVideoOutputsLabel">Outputs:</label>
          <div id="videoVideoOutputsContainer" class="flex-1"></div>
        </div>
      </div>
      <div class="form-row">
        <label for="videoFrequency" id="videoFrequencyLabel">Frequency:</label>
        <input type="text" id="videoFrequency" />
      </div>
      <div class="form-row">
        <label for="videoLatency" id="videoLatencyLabel">Latency:</label>
        <input type="text" id="videoLatency" />
      </div>
    </div>
    <div id="motorFields" class="hidden">
      <div class="form-row">
        <label for="motorConnector" id="motorConnectorLabel">Connector:</label>
        <select id="motorConnector"></select>
      </div>
      <div class="form-row">
        <label for="motorInternal" id="motorInternalLabel">Internal Controller:</label>
        <input type="checkbox" id="motorInternal" />
      </div>
      <div class="form-row">
        <label for="motorTorque" id="motorTorqueLabel">Torque (Nm):</label>
        <input type="number" id="motorTorque" step="0.1" />
      </div>
      <div class="form-row">
        <label for="motorGearTypes" id="motorGearLabel">Gear Types:</label>
        <input type="text" id="motorGearTypes" />
      </div>
      <div class="form-row">
        <label for="motorNotes" id="motorNotesLabel">Notes:</label>
        <input type="text" id="motorNotes" />
      </div>
    </div>
    <div id="controllerFields" class="hidden">
      <div class="form-row">
        <label for="controllerConnector" id="controllerConnectorLabel">Connector:</label>
        <select id="controllerConnector"></select>
      </div>
      <div class="form-row">
        <label for="controllerPower" id="controllerPowerLabel">Power Source:</label>
        <select id="controllerPower"></select>
      </div>
      <div class="form-row">
        <label for="controllerBattery" id="controllerBatteryLabel">Battery Type:</label>
        <select id="controllerBattery"></select>
      </div>
      <div class="form-row">
        <label for="controllerConnectivity" id="controllerConnectivityLabel">Connectivity:</label>
        <select id="controllerConnectivity"></select>
      </div>
      <div class="form-row">
        <label for="controllerNotes" id="controllerNotesLabel">Notes:</label>
        <input type="text" id="controllerNotes" />
      </div>
    </div>
    <div id="distanceFields" class="hidden">
      <div class="form-row">
        <label for="distanceConnection" id="distanceConnectionLabel">Connection:</label>
        <select id="distanceConnection"></select>
      </div>
      <div class="form-row">
        <label for="distanceMethod" id="distanceMethodLabel">Method:</label>
        <select id="distanceMethod"></select>
      </div>
      <div class="form-row">
        <label for="distanceRange" id="distanceRangeLabel">Range:</label>
        <input type="text" id="distanceRange" />
      </div>
      <div class="form-row">
        <label for="distanceAccuracy" id="distanceAccuracyLabel">Accuracy:</label>
        <input type="text" id="distanceAccuracy" />
      </div>
      <div class="form-row">
        <label for="distanceOutput" id="distanceOutputLabel">Display:</label>
        <select id="distanceOutput"></select>
      </div>
      <div class="form-row">
        <label for="distanceNotes" id="distanceNotesLabel">Notes:</label>
        <input type="text" id="distanceNotes" />
      </div>
    </div>
    <div id="batteryFields" class="hidden">
      <div class="form-row">
        <label for="newCapacity" id="capacityLabel">Capacity (Wh):</label>
        <input type="number" id="newCapacity" step="0.1" placeholder="e.g. 98" />
      </div>
      <div class="form-row">
        <label for="newPinA" id="pinLabel">Max Pin A:</label>
        <input type="number" id="newPinA" step="0.1" placeholder="e.g. 10" />
      </div>
      <div class="form-row">
        <label for="newDtapA" id="dtapLabel">Max D-Tap A:</label>
        <input type="number" id="newDtapA" step="0.1" placeholder="e.g. 5" />
      </div>
    </div>
    <button id="addDeviceBtn">Add</button>
    <button id="cancelEditBtn" class="hidden">Cancel</button>
      <button id="exportDataBtn">Export Database</button>
      <button id="importDataBtn">Import Database</button>
      <input type="file" id="importFileInput" accept=".json" class="hidden" />
      <button id="exportAndRevertBtn">Export and Revert to default Database</button>
    </div>
    <textarea id="exportOutput" class="hidden" readonly></textarea>

    <h3 id="existingDevicesHeading">Existing Devices</h3>
    <div class="device-list-container">
      <div class="device-category">
        <h4 id="category_cameras">Cameras</h4>
        <input type="text" id="cameraListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="cameraList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_monitors">Monitors</h4>
        <input type="text" id="monitorListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="monitorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_video">Wireless Video</h4>
        <input type="text" id="videoListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="videoList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_motors">FIZ Motors</h4>
        <input type="text" id="motorListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="motorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_controllers">FIZ Controllers</h4>
        <input type="text" id="controllerListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="controllerList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_distance">FIZ Distance</h4>
        <input type="text" id="distanceListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="distanceList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_batteries">V-Mount Batteries</h4>
        <input type="text" id="batteryListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="batteryList" class="device-ul"></ul>
      </div>
    </div>
  </section>
  </main>

  <div id="helpDialog" role="dialog" aria-modal="true" aria-labelledby="helpTitle" tabindex="-1" hidden>
    <div class="help-content">
      <button id="closeHelp">Close</button>
      <h2 id="helpTitle">How to use</h2>
      <input type="text" id="helpSearch" placeholder="Search help topics..." aria-label="Search help topics" />
      <p id="helpNoResults" aria-live="polite" hidden>No results found.</p>
      <div id="helpSections">
        <section data-help-section id="featuresOverview">
          <h3><span class="help-icon" aria-hidden="true">‚ú®</span>Features at a Glance</h3>
          <ul>
            <li>Plan complete camera rigs and compute power draw and battery life.</li>
            <li>Save multiple setups, export or import them and print overviews.</li>
            <li>Visualize power and video connections with an interactive diagram‚Äîdrag to rearrange, zoom and download the layout.</li>
            <li>Compare battery runtimes and check against safe output limits.</li>
            <li>Customize the device database with your own gear.</li>
            <li>Open a searchable help dialog with step-by-step guides and FAQ.</li>
            <li>Switch languages, toggle dark or playful pink themes and work fully offline. Theme settings persist.</li>
            <li>Cameras with both V- and B-Mount plates let you swap battery types; the list updates automatically.</li>
          </ul>
        </section>
        <section data-help-section id="gettingStarted">
          <h3><span class="help-icon" aria-hidden="true">üöÄ</span>Getting Started</h3>
          <ol>
            <li>Select a camera, monitor and other devices from the dropdown menus.</li>
            <li>Use the search boxes inside each dropdown to quickly filter the lists.</li>
            <li>Choose a battery to update total draw and estimated runtime.</li>
          </ol>
        </section>
        <section data-help-section id="managingSetups">
          <h3><span class="help-icon" aria-hidden="true">üóÇÔ∏è</span>Managing Setups</h3>
          <ul>
            <li>Use <strong>Save</strong> to store the current configuration in your browser.</li>
            <li>Import, export or delete setups via the <em>Setup Actions</em> section.</li>
            <li><strong>Share Setup Link</strong> copies a URL for the current configuration.</li>
            <li><strong>Clear Current Setup</strong> removes all selected devices.</li>
            <li><strong>Generate Overview</strong> produces a printable summary of any saved setup.</li>
          </ul>
        </section>
        <section data-help-section id="powerCalculator">
          <h3><span class="help-icon" aria-hidden="true">‚ö°</span>Power Calculator</h3>
          <ul>
            <li>Select a battery to see estimated runtime, current draw and required batteries for a 10&nbsp;h shoot (incl. spare).</li>
            <li>A temperature note helps account for runtime changes in hot or cold conditions.</li>
            <li>Warnings appear if the configuration exceeds battery output limits.</li>
            <li>The optional <strong>Battery Comparison</strong> panel shows runtimes for all batteries at once.</li>
          </ul>
        </section>
        <section data-help-section id="calculationDetails">
          <h3><span class="help-icon" aria-hidden="true">üßÆ</span>Calculation Details</h3>
          <ul>
            <li>Each device contributes its power draw in watts to <em>Total Consumption</em>.</li>
            <li>Current at 14.4¬†V (33.6¬†V for B‚ÄëMount) and 12¬†V (21.6¬†V for B‚ÄëMount) equals total watts divided by voltage.</li>
            <li>Runtime&nbsp;=&nbsp;battery capacity (Wh)&nbsp;√∑&nbsp;total consumption.</li>
            <li>
              User-submitted runtimes are adjusted for temperature and weighted before
              averaging:
              <ul>
                <li>Temperature: √ó2 at ‚â§‚àí20‚ÄØ¬∞C, √ó1.6 at ‚â§‚àí10‚ÄØ¬∞C, √ó1.25 at ‚â§0‚ÄØ¬∞C.</li>
                <li>Resolution: ‚â•12K √ó3, ‚â•8K √ó2, ‚â•4K √ó1.5, ‚â•1080p √ó1; lower scales with 1080p.</li>
                <li>Frame rate scales linearly from 24‚ÄØfps (e.g. 48‚ÄØfps = √ó2).</li>
                <li>Wi‚ÄëFi adds 10‚ÄØ%; monitor entries below spec are weighted by their brightness ratio.</li>
                <li>
                  Codec factors: RAW/BRAW/ARRIRAW/R3D/CinemaDNG/Canon RAW/X‚ÄëOCN √ó1;
                  ProRes √ó1.1; DNx/AVID √ó1.2; All‚ÄëIntra √ó1.3; H.264/AVC √ó1.5; H.265/HEVC √ó1.7.
                </li>
                <li>The final weight reflects each device's share of total power draw.</li>
              </ul>
            </li>
            <li>Warnings highlight when current approaches or exceeds main or D‚ÄëTap output ratings.</li>
          </ul>
        </section>
        <section data-help-section id="runtimeFeedbackHelp">
          <h3><span class="help-icon" aria-hidden="true">üìù</span>User Runtime Feedback</h3>
          <ul>
            <li>Click <strong>Submit User Runtime Feedback</strong> below the runtime to add your own measurement.</li>
            <li>Include temperature and humidity for more accurate weighting.</li>
            <li>Your entries are stored locally and refine the runtime estimate.</li>
          </ul>
        </section>
        <section data-help-section id="setupDiagramHelp">
          <h3><span class="help-icon" aria-hidden="true">üó∫Ô∏è</span>Setup Diagram</h3>
          <ul>
            <li>Visualizes power and video connections between selected devices.</li>
            <li>Drag nodes to rearrange the layout; use +/‚Äì buttons to zoom.</li>
            <li>Export the diagram as SVG or JPG via the <em>Download</em> button.</li>
            <li>Icons denote device types and warn when FIZ brands are incompatible.</li>
            <li>Hover or tap devices to see popup details.</li>
          </ul>
        </section>
        <section data-help-section id="deviceEditorHelp">
          <h3><span class="help-icon" aria-hidden="true">üõ†Ô∏è</span>Device Database Editor</h3>
          <ul>
            <li>Open with <em>Edit Device Data‚Ä¶</em> to add, modify or remove devices.</li>
            <li>Changes are stored locally; use <em>Export</em> and <em>Import</em> to share databases.</li>
            <li><em>Revert</em> restores defaults from <code>data.js</code>.</li>
          </ul>
        </section>
        <section data-help-section id="deviceCategoriesHelp">
          <h3><span class="help-icon" aria-hidden="true">üìÅ</span>Device Categories</h3>
          <ul>
            <li><strong>Camera</strong> (1)</li>
            <li><strong>Monitor</strong> (optional)</li>
            <li><strong>Wireless Video</strong> (optional)</li>
            <li><strong>FIZ Motors</strong> (0‚Äì4)</li>
            <li><strong>FIZ Controllers</strong> (0‚Äì4)</li>
            <li><strong>Distance Sensor</strong> (0‚Äì1)</li>
            <li><strong>Battery Plate</strong> (on supported cameras)</li>
            <li><strong>V‚Äë or B‚ÄëMount Battery</strong> (0‚Äì1)</li>
          </ul>
          <p>The number in parentheses shows how many of that type you can select.</p>
        </section>
        <section data-help-section id="searchFiltering">
          <h3><span class="help-icon" aria-hidden="true">üîç</span>Search & Filtering</h3>
          <ul>
            <li>Every dropdown and list can be filtered via its search box.</li>
            <li>The help dialog itself is searchable using the field at the top.</li>
          </ul>
        </section>
        <section data-help-section id="helpDialogHelp">
          <h3><span class="help-icon" aria-hidden="true">‚ùì</span>Help Dialog</h3>
          <ul>
            <li>Open with the <strong>?</strong> button or press <kbd>?</kbd>, <kbd>H</kbd> or <kbd>F1</kbd>.</li>
            <li>Use the search field to filter topics; the query resets when closed.</li>
            <li>Close the dialog with <kbd>Escape</kbd> or by clicking outside.</li>
          </ul>
        </section>
        <section data-help-section id="languageHelp">
          <h3><span class="help-icon" aria-hidden="true">üåê</span>Language</h3>
          <ul>
            <li>Use the dropdown in the top right to switch languages.</li>
            <li>Your choice is remembered for the next visit.</li>
          </ul>
        </section>
        <section data-help-section id="darkModeHelp">
          <h3><span class="help-icon" aria-hidden="true">üåì</span>Dark Mode</h3>
          <ul>
            <li>Click the moon button to toggle dark mode.</li>
            <li>The setting persists between visits.</li>
          </ul>
        </section>
        <section data-help-section id="pinkModeHelp">
          <h3><span class="help-icon" aria-hidden="true">ü¶Ñ</span>Pink Mode</h3>
          <ul>
            <li>Click the horse button for a pink unicorn theme that accents buttons and headings.</li>
            <li>The setting persists between visits and works in light or dark mode.</li>
          </ul>
        </section>
        <section data-help-section id="shortcuts">
          <h3><span class="help-icon" aria-hidden="true">‚å®Ô∏è</span>Keyboard Shortcuts</h3>
          <ul>
            <li><kbd>?</kbd>, <kbd>H</kbd> or <kbd>F1</kbd> ‚Äì toggle help</li>
            <li><kbd>Escape</kbd> ‚Äì close dialogs</li>
            <li>Type in dropdowns to filter options</li>
          </ul>
        </section>
        <section data-help-section id="faq">
          <h3><span class="help-icon" aria-hidden="true">‚ùì</span>FAQ</h3>
          <details class="faq-item">
            <summary>How do I save a setup?</summary>
            <p>Enter a name in the Setup Name field and click Save. It will then appear in the Saved Setups list.</p>
          </details>
          <details class="faq-item">
            <summary>Can I export my setups?</summary>
            <p>Yes. Use the Export All Setups button to download a JSON file containing every saved setup.</p>
          </details>
          <details class="faq-item">
            <summary>How do I edit device data?</summary>
            <p>Click the <em>Edit Device Data‚Ä¶</em> button to open the database editor where you can add, change or remove devices.</p>
          </details>
          <details class="faq-item">
            <summary>How is battery runtime calculated?</summary>
            <p>The app divides the selected battery's capacity (in watt-hours) by the total power consumption of your devices. For example, a 98&nbsp;Wh battery powering a 24&nbsp;W setup is estimated to run for about 4&nbsp;hours.</p>
          </details>
          <details class="faq-item">
            <summary>What do the warning colors mean?</summary>
            <p>Orange messages indicate the setup is nearing the battery's output limit. Red warnings mean the estimated current exceeds the safe rating and could damage the battery.</p>
          </details>
          <details class="faq-item">
            <summary>Where are my setups saved?</summary>
            <p>Setups and device edits are stored in your browser's <code>localStorage</code>. Use Export/Import to back them up or share them.</p>
          </details>
          <details class="faq-item">
            <summary>Does the planner work offline?</summary>
            <p>Yes. Once the fonts and database are cached on first load, all features continue to work without an internet connection.</p>
          </details>
          <details class="faq-item">
            <summary>How do I reset everything to the defaults?</summary>
            <p>Open the device editor and choose <em>Export and Revert</em> to restore the default database. Delete setups individually using the Delete button.</p>
          </details>
          <details class="faq-item">
            <summary>How do I change the language?</summary>
            <p>Use the dropdown in the top right to pick a language. The planner remembers your choice for the next visit.</p>
          </details>
          <details class="faq-item">
            <summary>How can I print a setup overview?</summary>
            <p>Save the setup, then click <em>Generate Overview</em> in Setup Actions and print from the new tab.</p>
          </details>
          <details class="faq-item">
            <summary>How do I compare different batteries?</summary>
            <p>The Battery Comparison section shows estimated run time for all batteries once a configuration is calculated.</p>
          </details>
          <details class="faq-item">
            <summary>How do I import or export the device database?</summary>
            <p>Open the Device Database Editor and use the <em>Export</em> button to download your current database as JSON. Use <em>Import</em> to load a JSON file and replace your local data.</p>
          </details>
          <details class="faq-item">
            <summary>Can I edit or add devices?</summary>
            <p>Yes. In the Device Database Editor you can create new devices, change existing ones or delete entries. The changes appear immediately in the dropdown menus.</p>
          </details>
          <details class="faq-item">
            <summary>What does the Setup Diagram show?</summary>
            <p>The diagram illustrates how power and video cables connect between your chosen devices. Drag the nodes to arrange them and use the buttons to zoom or download an image.</p>
          </details>
          <details class="faq-item">
            <summary>Which device categories are available?</summary>
            <p>Categories include Camera, Monitor, Wireless Video, FIZ Motors, FIZ Controllers, Distance Sensor, Battery Plate and V‚Äë/B‚ÄëMount Battery.</p>
          </details>
          <details class="faq-item">
            <summary>Where does the device data come from?</summary>
            <p>The default database is defined in <code>data.js</code> from manufacturer specifications. You can modify or replace it via the Device Database Editor.</p>
          </details>
        </section>
      </div>
    </div>
  </div>

  <dialog id="feedbackDialog">
    <form id="feedbackForm" method="dialog">
      <h3>User Runtime Feedback</h3>

      <fieldset>
        <legend>üìã Basic Info</legend>
        <div class="form-row"><label>User:<input type="text" id="fbUsername" required></label></div>
        <div class="form-row"><label>Date:<input type="date" id="fbDate" required></label></div>
        <div class="form-row">
          <label>Location:<input type="text" id="fbLocation"></label>
          <button type="button" id="fbUseLocationBtn">Use Current Location</button>
        </div>
      </fieldset>

      <fieldset>
        <legend>üé• Camera Setup</legend>
        <div class="form-row"><label>Camera:<input type="text" id="fbCamera" readonly></label></div>
        <div class="form-row"><label>Battery Plate:<input type="text" id="fbBatteryPlate" readonly></label></div>
        <div class="form-row"><label>Lens Mount:<input list="mountOptions" id="fbLensMount"></label></div>
        <div class="form-row"><label>Res:<input list="resolutionOptions" id="fbResolution"></label></div>
        <div class="form-row"><label>Codec:<input list="codecOptions" id="fbCodec"></label></div>
        <div class="form-row"><label>FPS:<input list="framerateOptions" id="fbFramerate"></label></div>
        <div class="form-row"><label>Camera WIFI:<select id="fbWifi"><option value="on">On</option><option value="off">Off</option></select></label></div>
        <div class="form-row"><label>Firmware:<input type="text" id="fbFirmware"></label></div>
      </fieldset>

      <fieldset>
        <legend>üîã Power &amp; Accessories</legend>
        <div class="form-row"><label>Battery:<input type="text" id="fbBattery" readonly></label></div>
        <div class="form-row"><label>Battery Age:<input type="number" id="fbBatteryAge"></label></div>
        <div class="form-row"><label>Wireless Video:<input type="text" id="fbWirelessVideo" readonly></label></div>
        <div class="form-row"><label>Monitor:<input type="text" id="fbMonitor" readonly></label></div>
        <div class="form-row"><label>Monitor Brightness:<input type="text" id="fbMonitorBrightness"></label></div>
        <div class="form-row"><label>Lens:<input type="text" id="fbLens"></label></div>
        <div class="form-row"><label>Lens Data:<select id="fbLensData"><option value="">--</option><option value="on">On</option><option value="off">Off</option></select></label></div>
        <div class="form-row"><label>FIZ Controllers:<input type="text" id="fbControllers" readonly></label></div>
        <div class="form-row"><label>FIZ Motors:<input type="text" id="fbMotors" readonly></label></div>
        <div class="form-row"><label>FIZ Distance:<select id="fbDistance" disabled></select></label></div>
      </fieldset>

      <fieldset>
        <legend>üå°Ô∏è Environment</legend>
        <div class="form-row"><label>Temp (¬∞C):<select id="fbTemperature"></select></label></div>
        <div class="form-row"><label>Humidity:<select id="fbHumidity"></select></label></div>
        <div class="form-row"><label>Charging:<select id="fbCharging"><option value="yes">Yes</option><option value="no">No</option></select></label></div>
        <div class="form-row"><label>Runtime (hrs):<input type="number" step="0.01" id="fbRuntime" required></label></div>
        <div class="form-row"><label>Batteries Used per Day:<input type="number" id="fbBatteriesPerDay"></label></div>
      </fieldset>

      <div class="form-row button-row">
        <button type="submit" id="fbSubmit">Save &amp; Submit</button>
        <button type="button" id="fbCancel">Cancel</button>
      </div>
    </form>

    <datalist id="mountOptions">
      <option value="PL"></option>
      <option value="EF"></option>
      <option value="E"></option>
      <option value="MFT"></option>
      <option value="RF"></option>
    </datalist>
    <datalist id="resolutionOptions">
      <option value="1080p"></option>
      <option value="2K"></option>
      <option value="4K"></option>
      <option value="6K"></option>
      <option value="8K"></option>
    </datalist>
    <datalist id="codecOptions">
      <option value="ARRIRAW"></option>
      <option value="BRAW"></option>
      <option value="Canon RAW"></option>
      <option value="CinemaDNG"></option>
      <option value="R3D"></option>
      <option value="ProRes RAW"></option>
      <option value="ProRes"></option>
      <option value="DNxHD"></option>
      <option value="DNxHR"></option>
      <option value="DNxHQ"></option>
      <option value="XAVC-I"></option>
      <option value="XAVC-L"></option>
      <option value="XAVC-S"></option>
      <option value="XAVC HS"></option>
      <option value="H.264"></option>
      <option value="H.264 All-I"></option>
      <option value="H.265"></option>
      <option value="H.265 All-I"></option>
      <option value="AVC-Intra"></option>
      <option value="AVCHD"></option>
      <option value="HEVC"></option>
      <option value="X-OCN"></option>
    </datalist>
    <datalist id="framerateOptions">
      <option value="23.98"></option>
      <option value="24"></option>
      <option value="25"></option>
      <option value="30"></option>
      <option value="50"></option>
      <option value="60"></option>
      <option value="120"></option>
    </datalist>
  </dialog>
  <script src="data.js"></script>
  <script src="storage.js"></script>
  <script src="translations.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/lz-string@1.5.0/libs/lz-string.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
