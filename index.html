<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Camera Power Planner</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div id="langSelector">
    <select id="languageSelect">
      <option value="en">English</option>
      <option value="de">Deutsch</option>
      <option value="es">Español</option>
      <option value="fr">Français</option>
    </select>
    <button id="darkModeToggle" title="Toggle dark mode" aria-label="Toggle dark mode">☾</button>
  </div>

  <h1 id="mainTitle">Camera Power Consumption App</h1>
  <p id="tagline">Plan your camera setup and calculate power consumption &amp; battery life.</p>

  <section id="setup-manager">
    <h2 id="setupManageHeading">Manage Setup</h2>
    <div class="form-row">
      <label for="setupSelect" id="savedSetupsLabel">Saved Setups:</label>
      <select id="setupSelect">
        <option value="">-- New Setup --</option>
      </select>
      <button id="deleteSetupBtn" title="Delete selected setup">Delete</button>
    </div>
    <div class="form-row">
      <label for="setupName" id="setupNameLabel">Setup Name:</label>
      <input type="text" id="setupName" placeholder="Setup name" />
      <button id="saveSetupBtn">Save</button>
    </div>

    <!-- Moved Setup Actions here -->
    <h3 id="setupActionsHeading" style="margin-top: 1em;">Setup Actions</h3>
    <button id="exportSetupsBtn">Export All Setups</button>
    <button id="importSetupsBtn">Import Setups</button>
    <input type="file" id="importSetupsInput" accept=".json" style="display: none;" />
    <button id="generateOverviewBtn">Generate Overview</button>
  </section>

  <section id="setup-config">
    <h2 id="deviceSelectionHeading">Device Selection</h2>
      <div class="form-row">
        <label for="cameraSelect" id="cameraLabel">Camera:</label>
        <div class="select-wrapper">
          <input type="text" id="cameraFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="cameraSelect"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="monitorSelect" id="monitorLabel">Monitor:</label>
        <div class="select-wrapper">
          <input type="text" id="monitorFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="monitorSelect"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="videoSelect" id="videoLabel">Wireless Video:</label>
        <div class="select-wrapper">
          <input type="text" id="videoFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="videoSelect"></select>
        </div>
      </div>

    <fieldset>
      <legend id="fizLegend">FIZ (Follow Focus) Systems</legend>
      <div class="form-row">
        <label for="motor1Select" id="fizMotorsLabel">FIZ Motors:</label>
        <div class="select-wrapper">
          <input type="text" id="motorFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="motor1Select"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="motor2Select"></label>
        <select id="motor2Select"></select>
      </div>
      <div class="form-row">
        <label for="motor3Select"></label>
        <select id="motor3Select"></select>
      </div>
      <div class="form-row">
        <label for="motor4Select"></label>
        <select id="motor4Select"></select>
      </div>
      <div class="form-row">
        <label for="controller1Select" id="fizControllersLabel">FIZ Controllers:</label>
        <div class="select-wrapper">
          <input type="text" id="controllerFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
          <select id="controller1Select"></select>
        </div>
      </div>
      <div class="form-row">
        <label for="controller2Select"></label>
        <select id="controller2Select"></select>
      </div>
      <div class="form-row">
        <label for="controller3Select"></label>
        <select id="controller3Select"></select>
      </div>
      <div class="form-row">
        <label for="controller4Select"></label>
        <select id="controller4Select"></select>
      </div>
    <div class="form-row">
      <label for="distanceSelect" id="distanceLabel">Distance Sensor:</label>
      <div class="select-wrapper">
        <input type="text" id="distanceFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
        <select id="distanceSelect"></select>
      </div>
    </div>
    <div class="form-row" id="batteryPlateRow" style="display:none;">
      <label for="batteryPlateSelect" id="batteryPlateLabel">Battery Plate:</label>
      <select id="batteryPlateSelect"></select>
    </div>
  </fieldset>

    <div class="form-row">
      <label for="batterySelect" id="batteryLabel">V-Mount Battery:</label>
      <div class="select-wrapper">
        <input type="text" id="batteryFilter" class="filter-input" placeholder="Filter..." aria-label="Filter" />
        <select id="batterySelect"></select>
      </div>
    </div>
  </section>

  <section id="results">
    <h2 id="resultsHeading">Results</h2>
    <ul id="breakdownList">
      <!-- Device breakdown will be inserted here by script.js -->
    </ul>
    <p><strong><span id="totalPowerLabel">Total Consumption:</span></strong> <span id="totalPower">0.0</span> W</p>
    <p><strong><span id="totalCurrent144Label">Total Current (at 14.4V):</span></strong> <span id="totalCurrent144">0.00</span> A</p>
    <p><strong><span id="totalCurrent12Label">Total Current (at 12V):</span></strong> <span id="totalCurrent12">0.00</span> A</p>
    <p><strong><span id="batteryLifeLabel">Runtime (estimated):</span></strong> <span id="batteryLife">0.00</span> <span id="batteryLifeUnit">hrs</span></p>
    <p id="pinWarning" style="color: red; font-weight: bold;" role="status" aria-live="polite"></p>
  <p id="dtapWarning" style="color: red; font-weight: bold;" role="status" aria-live="polite"></p>
  </section>

  <section id="setupDiagram">
    <h2 id="setupDiagramHeading">Setup Diagram</h2>
    <p id="compatWarning" style="color: red; font-weight: bold;" role="status" aria-live="polite"></p>
    <div id="diagramArea" role="img" aria-label="Setup diagram"></div>
  </section>

  <section id="batteryComparison" style="display:none;">
    <h2 id="batteryComparisonHeading">Battery Comparison</h2>
    <div id="batteryTableContainer">
      <table id="batteryTable"></table>
    </div>
  </section>

  <button id="toggleDeviceManager">Edit Device Data…</button>

  <section id="device-manager" style="display:none;">
    <h2 id="deviceManagerHeading">Manage Device Database</h2>
    <div style="margin-bottom: 10px;"> <!-- Changed from form-row to a generic div for button grouping -->
<h3 id="addDeviceHeading" style="margin-top: 1em;">Add New Device</h3>
    <div class="form-row">
      <label for="newCategory" id="categoryLabel">Category:</label>
      <select id="newCategory">
        <option value="cameras">Camera</option>
        <option value="monitors">Monitor</option>
        <option value="video">Wireless Video</option>
        <option value="fiz.motors">FIZ Motor</option>
        <option value="fiz.controllers">FIZ Controller</option>
        <option value="fiz.distance">FIZ Distance</option>
        <option value="batteries">V-Mount Battery</option>
      </select>
    </div>
    <div class="form-row">
      <label for="newName" id="deviceNameLabel">Name:</label>
      <input type="text" id="newName" placeholder="Device name" />
    </div>
    <div class="form-row" id="wattField">
      <label for="newWatt" id="consumptionLabel">Consumption (W):</label>
      <input type="number" id="newWatt" step="0.1" placeholder="e.g. 12.5" />
    </div>
    <div id="cameraFields" style="display:none;">
      <div class="camera-subsection">
        <h4 id="powerInputsHeading">Power Inputs</h4>
        <div class="form-row">
          <label for="cameraWatt" id="cameraWattLabel">Power Draw (W):</label>
          <input type="number" id="cameraWatt" step="0.1" />
        </div>
        <div class="form-row">
          <label for="cameraVoltage" id="cameraVoltageLabel">Voltage Range:</label>
          <input type="text" id="cameraVoltage" />
        </div>
        <div class="form-row">
          <label for="cameraPortType" id="cameraPortTypeLabel">Port Type:</label>
          <select id="cameraPortType"></select>
        </div>
        <div class="form-row">
          <label id="cameraPlatesLabel">Battery Plates:</label>
          <div id="batteryPlatesContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="powerDistributionHeading">Power Distribution</h4>
        <div class="form-row">
          <label id="cameraPowerDistLabel">Outputs:</label>
          <div id="powerDistContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="videoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="cameraVideoOutputsLabel">Outputs:</label>
          <div id="videoOutputsContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="fizConnectorHeading">FIZ Connector</h4>
        <div class="form-row">
          <label id="cameraFIZConnectorLabel">Connectors:</label>
          <div id="fizConnectorContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="mediaHeading">Media</h4>
        <div class="form-row">
          <label id="cameraMediaLabel">Recording Media:</label>
          <div id="cameraMediaContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="viewfinderHeading">Viewfinder</h4>
        <div class="form-row">
          <label id="cameraViewfinderLabel">Viewfinders:</label>
          <div id="viewfinderContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="lensMountHeading">Lens Mount</h4>
        <div class="form-row">
          <label id="cameraLensMountLabel">Lens Mount:</label>
          <div id="lensMountContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="camera-subsection">
        <h4 id="timecodeHeading">Timecode</h4>
        <div class="form-row">
          <label id="cameraTimecodeLabel">Timecode:</label>
          <div id="timecodeContainer" style="flex:1;"></div>
        </div>
      </div>
    </div>
    <div id="monitorFields" style="display:none;">
      <div class="monitor-subsection">
        <h4 id="monitorDetailsHeading">Monitor Details</h4>
        <div class="form-row">
          <label for="monitorScreenSize" id="monitorScreenSizeLabel">Screen Size (in):</label>
          <input type="number" id="monitorScreenSize" step="0.1" />
        </div>
        <div class="form-row">
          <label for="monitorBrightness" id="monitorBrightnessLabel">Brightness (nits):</label>
          <input type="number" id="monitorBrightness" step="1" />
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorPowerHeading">Power Input</h4>
        <div class="form-row">
          <label for="monitorWatt" id="monitorWattLabel">Power Draw (W):</label>
          <input type="number" id="monitorWatt" step="0.1" />
        </div>
        <div class="form-row">
          <label for="monitorVoltage" id="monitorVoltageLabel">Voltage Range:</label>
          <input type="text" id="monitorVoltage" />
        </div>
        <div class="form-row">
          <label for="monitorPortType" id="monitorPortTypeLabel">Port Type:</label>
          <select id="monitorPortType"></select>
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorVideoInputsHeading">Video Inputs</h4>
        <div class="form-row">
          <label id="monitorVideoInputsLabel">Inputs:</label>
          <div id="monitorVideoInputsContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="monitor-subsection">
        <h4 id="monitorVideoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="monitorVideoOutputsLabel">Outputs:</label>
          <div id="monitorVideoOutputsContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="form-row">
        <label for="monitorWirelessTx" id="monitorWirelessTxLabel">Wireless TX:</label>
        <input type="checkbox" id="monitorWirelessTx" />
      </div>
      <div class="form-row">
        <label for="monitorAudioOutput" id="monitorAudioOutputLabel">Audio Output:</label>
        <input type="text" id="monitorAudioOutput" />
      </div>
    </div>
    <div id="videoFields" style="display:none;">
      <div class="form-row">
        <label for="videoPower" id="videoPowerInputLabel">Power Input:</label>
        <input type="text" id="videoPower" />
      </div>
      <div class="video-subsection">
        <h4 id="videoVideoInputsHeading">Video Inputs</h4>
        <div class="form-row">
          <label id="videoVideoInputsLabel">Inputs:</label>
          <div id="videoVideoInputsContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="video-subsection">
        <h4 id="videoVideoOutputsHeading">Video Outputs</h4>
        <div class="form-row">
          <label id="videoVideoOutputsLabel">Outputs:</label>
          <div id="videoVideoOutputsContainer" style="flex:1;"></div>
        </div>
      </div>
      <div class="form-row">
        <label for="videoFrequency" id="videoFrequencyLabel">Frequency:</label>
        <input type="text" id="videoFrequency" />
      </div>
      <div class="form-row">
        <label for="videoLatency" id="videoLatencyLabel">Latency:</label>
        <input type="text" id="videoLatency" />
      </div>
    </div>
    <div id="motorFields" style="display:none;">
      <div class="form-row">
        <label for="motorConnector" id="motorConnectorLabel">Connector:</label>
        <select id="motorConnector"></select>
      </div>
      <div class="form-row">
        <label for="motorInternal" id="motorInternalLabel">Internal Controller:</label>
        <input type="checkbox" id="motorInternal" />
      </div>
      <div class="form-row">
        <label for="motorTorque" id="motorTorqueLabel">Torque (Nm):</label>
        <input type="number" id="motorTorque" step="0.1" />
      </div>
      <div class="form-row">
        <label for="motorGearTypes" id="motorGearLabel">Gear Types:</label>
        <input type="text" id="motorGearTypes" />
      </div>
      <div class="form-row">
        <label for="motorNotes" id="motorNotesLabel">Notes:</label>
        <input type="text" id="motorNotes" />
      </div>
    </div>
    <div id="controllerFields" style="display:none;">
      <div class="form-row">
        <label for="controllerConnector" id="controllerConnectorLabel">Connector:</label>
        <select id="controllerConnector"></select>
      </div>
      <div class="form-row">
        <label for="controllerPower" id="controllerPowerLabel">Power Source:</label>
        <select id="controllerPower"></select>
      </div>
      <div class="form-row">
        <label for="controllerBattery" id="controllerBatteryLabel">Battery Type:</label>
        <select id="controllerBattery"></select>
      </div>
      <div class="form-row">
        <label for="controllerConnectivity" id="controllerConnectivityLabel">Connectivity:</label>
        <select id="controllerConnectivity"></select>
      </div>
      <div class="form-row">
        <label for="controllerNotes" id="controllerNotesLabel">Notes:</label>
        <input type="text" id="controllerNotes" />
      </div>
    </div>
    <div id="distanceFields" style="display:none;">
      <div class="form-row">
        <label for="distanceConnection" id="distanceConnectionLabel">Connection:</label>
        <select id="distanceConnection"></select>
      </div>
      <div class="form-row">
        <label for="distanceMethod" id="distanceMethodLabel">Method:</label>
        <select id="distanceMethod"></select>
      </div>
      <div class="form-row">
        <label for="distanceRange" id="distanceRangeLabel">Range:</label>
        <input type="text" id="distanceRange" />
      </div>
      <div class="form-row">
        <label for="distanceAccuracy" id="distanceAccuracyLabel">Accuracy:</label>
        <input type="text" id="distanceAccuracy" />
      </div>
      <div class="form-row">
        <label for="distanceOutput" id="distanceOutputLabel">Display:</label>
        <select id="distanceOutput"></select>
      </div>
      <div class="form-row">
        <label for="distanceNotes" id="distanceNotesLabel">Notes:</label>
        <input type="text" id="distanceNotes" />
      </div>
    </div>
    <div id="batteryFields" style="display:none;">
      <div class="form-row">
        <label for="newCapacity" id="capacityLabel">Capacity (Wh):</label>
        <input type="number" id="newCapacity" step="0.1" placeholder="e.g. 98" />
      </div>
      <div class="form-row">
        <label for="newPinA" id="pinLabel">Max Pin A:</label>
        <input type="number" id="newPinA" step="0.1" placeholder="e.g. 10" />
      </div>
      <div class="form-row">
        <label for="newDtapA" id="dtapLabel">Max D-Tap A:</label>
        <input type="number" id="newDtapA" step="0.1" placeholder="e.g. 5" />
      </div>
    </div>
    <button id="addDeviceBtn">Add</button>
    <button id="cancelEditBtn" style="display:none;">Cancel</button>
      <button id="exportDataBtn">Export Database</button>
      <button id="importDataBtn">Import Database</button>
      <input type="file" id="importFileInput" accept=".json" style="display: none;" />
      <button id="exportAndRevertBtn">Export and Revert to default Database</button>
    </div>
    <textarea id="exportOutput" readonly style="display:none; width:100%; height:100px; margin-top: 10px;"></textarea>

    <h3 id="existingDevicesHeading" style="margin-top: 1em;">Existing Devices</h3>
    <div class="device-list-container">
      <div class="device-category">
        <h4 id="category_cameras">Cameras</h4>
        <input type="text" id="cameraListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="cameraList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_monitors">Monitors</h4>
        <input type="text" id="monitorListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="monitorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_video">Wireless Video</h4>
        <input type="text" id="videoListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="videoList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_motors">FIZ Motors</h4>
        <input type="text" id="motorListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="motorList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_controllers">FIZ Controllers</h4>
        <input type="text" id="controllerListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="controllerList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_fiz_distance">FIZ Distance</h4>
        <input type="text" id="distanceListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="distanceList" class="device-ul"></ul>
      </div>
      <div class="device-category">
        <h4 id="category_batteries">V-Mount Batteries</h4>
        <input type="text" id="batteryListFilter" class="list-filter" placeholder="Filter..." aria-label="Filter" />
        <ul id="batteryList" class="device-ul"></ul>
      </div>
    </div>
  </section>

  <script src="data.js"></script>
  <script src="storage.js"></script>
  <script src="translations.js"></script>
  <script src="script.js"></script>
</body>
</html>
