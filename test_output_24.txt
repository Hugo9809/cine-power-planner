
> cine-power-planner@1.0.47 test
> npm run check:pink-mode-icons && npm run build:auto-gear && npm run lint && npm run check-consistency && npm run test:jest tests/dom/projectAutosave.test.js


> cine-power-planner@1.0.47 check:pink-mode-icons
> node tools/generatePinkModeAnimatedIcons.js --check

Pink mode animated icon store is up to date.

> cine-power-planner@1.0.47 build:auto-gear
> tsc -p tsconfig.auto-gear.json


> cine-power-planner@1.0.47 lint
> eslint .


> cine-power-planner@1.0.47 check-consistency
> node tools/checkConsistency.js

All devices have required fields.
Service worker asset manifest is up to date.

> cine-power-planner@1.0.47 test:jest
> node --max-old-space-size=3072 ./node_modules/jest/bin/jest.js --runInBand tests/dom/projectAutosave.test.js

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    DEBUG: loadRuntime failed (expected during bisection): ICON_FONT_KEYS is not defined

      at Object.log (tests/dom/projectAutosave.test.js:22:15)

  console.log
    DEBUG: JSDOM click working after loadRuntime

      at Object.log (tests/dom/projectAutosave.test.js:32:15)

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

  console.log
    script.js: Executing wrapper with 11 parts

      at Object.log (src/scripts/script.js:89:11)

  console.log
    script.js: app-session.js index: -1

      at Object.log (src/scripts/script.js:90:11)

  console.log
    script.js: Starting part: modules/icons.js

      at join (src/scripts/script.js:76:5)

  console.log
    script.js: Finished part: modules/icons.js

      at src/scripts/script.js:378:9

  console.log
    script.js: Starting part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:381:9

  console.log
    script.js: Finished part: core/app-core-runtime-scopes.js

      at src/scripts/script.js:611:9

  console.log
    script.js: Starting part: core/app-core-runtime-support.js

      at src/scripts/script.js:614:9

  console.log
    script.js: Finished part: core/app-core-runtime-support.js

      at src/scripts/script.js:1520:9

  console.log
    script.js: Starting part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1523:9

  console.log
    script.js: Finished part: core/app-core-runtime-candidate-scopes.js

      at src/scripts/script.js:1958:9

  console.log
    script.js: Starting part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:1961:9

  console.log
    script.js: Finished part: core/app-core-runtime-helpers.js

      at src/scripts/script.js:2642:9

  console.log
    script.js: Starting part: core/app-core-text.js

      at src/scripts/script.js:2645:9

  console.log
    script.js: Finished part: core/app-core-text.js

      at src/scripts/script.js:2815:9

  console.log
    script.js: Starting part: core/app-core-environment.js

      at src/scripts/script.js:2818:9

  console.log
    script.js: Finished part: core/app-core-environment.js

      at src/scripts/script.js:4735:9

  console.log
    script.js: Starting part: core/app-core-bootstrap.js

      at src/scripts/script.js:4738:9

  console.log
    script.js: Finished part: core/app-core-bootstrap.js

      at src/scripts/script.js:4894:9

  console.log
    script.js: Starting part: core/app-core-runtime-shared.js

      at src/scripts/script.js:4897:9

  console.log
    script.js: Finished part: core/app-core-runtime-shared.js

      at src/scripts/script.js:5209:9

  console.log
    script.js: Starting part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5212:9

  console.log
    script.js: Finished part: core/app-core-runtime-ui.js

      at src/scripts/script.js:5505:9

  console.log
    script.js: Starting part: core/app-core-new-1.js

      at src/scripts/script.js:5508:9

FAIL dom tests/dom/projectAutosave.test.js
  project autosave
    ✓ sanity check jsdom behavior (73 ms)
    ✕ persists project data to localStorage when form changes (189 ms)
    ✕ autosaves partially filled crew entries (139 ms)
    ✕ saves pending project edits when switching setups without waiting for autosave timer (127 ms)
    ✕ does not overwrite other project requirements when typing a different project name (125 ms)
    ✕ blank project entries remain empty when editing another project (123 ms)
    ✕ switching to a new setup keeps previously saved requirements intact (119 ms)

  ● project autosave › persists project data to localStorage when form changes

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:38:17)

  ● project autosave › autosaves partially filled crew entries

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:98:17)

  ● project autosave › saves pending project edits when switching setups without waiting for autosave timer

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:152:17)

  ● project autosave › does not overwrite other project requirements when typing a different project name

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:238:17)

  ● project autosave › blank project entries remain empty when editing another project

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:311:17)

  ● project autosave › switching to a new setup keeps previously saved requirements intact

    ReferenceError: ICON_FONT_KEYS is not defined



      at src/scripts/script.js:6126:53
      at Object.call (src/scripts/script.js:91:11)
      at require (tests/helpers/runtimeLoader.js:123:22)
      at loadRuntime (tests/helpers/scriptEnvironment.js:240:13)
      at isolateModules (tests/helpers/scriptEnvironment.js:238:8)
      at Object.setupScriptEnvironment (tests/dom/projectAutosave.test.js:373:17)

Test Suites: 1 failed, 1 total
Tests:       6 failed, 1 passed, 7 total
Snapshots:   0 total
Time:        1.228 s, estimated 2 s
Ran all test suites matching tests/dom/projectAutosave.test.js.
Test Suites: 1 failed, 1 total
Tests:       6 failed, 1 passed, 7 total
Snapshots:   0 total
Time:        1.23 s, estimated 2 s
Ran all test suites matching tests/dom/projectAutosave.test.js.
