# Emergency Recovery Playbook

Use this playbook when a workstation shows signs of data loss, a restore fails,
or a release introduces unexpected persistence issues. The goal is to preserve
every available snapshot, restore safely through the sandbox, and document the
outcome for offline audits.

## When to initiate

- A restore raises missing-section warnings or fails to complete.
- Projects, gear lists, contacts, or preferences appear missing after a reload.
- Auto-backups stop downloading or the local vault banner reports queued files.
- The Backup guardian row reports issues you cannot resolve immediately.

## Immediate stabilization (do this before troubleshooting)

1. **Pause edits.** Stop making changes so new data does not overwrite existing
   snapshots or autosave mirrors.
2. **Capture a manual backup now.** Run **Settings → Backup & Restore → Backup**
   to export `planner-backup.json` before any remediation steps.
3. **Export queued backups.** If a banner indicates queued backups, open the
   local backup vault and export every JSON file to offline media.
4. **Record the runtime status.** Open **Settings → Data & Storage** and record
   the Backup guardian status plus the latest activity timestamps. Add the data
   to the verification log.

## Recovery paths

### Restore from a planner backup

1. Open **Settings → Backup & Restore → Restore rehearsal**.
2. Import the latest `planner-backup.json` into the sandbox.
3. Review the compatibility alert generated by
   `verifyRestoredBackupIntegrity()` and record any missing sections along with
   the safety backup filename created before import.
4. If the sandbox looks correct, promote the restore and immediately run a
   manual save so the autosave ledger captures the recovery.

### Restore from project bundles

1. Import each project bundle into the restore rehearsal sandbox.
2. Verify the project list, gear data, contacts and runtime notes are complete.
3. Promote only after the sandbox matches expectations, then export a new full
   planner backup to capture the recovered state.

### Recover from queued backup vault files

1. Export each queued backup JSON file from the vault to offline media.
2. Restore the newest file in the sandbox and verify the state matches
   expectations.
3. Archive older vault files as secondary recovery points.

## Verification and documentation

- Capture screenshots of the compatibility summary and any warning banners.
- Save the autosave ledger entry that records the restore promotion.
- Store backup files, vault exports, and verification logs together.
- Update `docs/ops/verification-log-template.md` and attach the evidence to the
  release or incident packet.

## After recovery

1. Run the [Operations Checklist](operations-checklist.md) to confirm save,
   share, import, backup and restore workflows behave normally.
2. Regenerate offline bundles if any assets or data schemas changed.
3. Update the documentation references in `docs/` and localized `README.*.md`
   files so offline teams receive the corrected workflow.
